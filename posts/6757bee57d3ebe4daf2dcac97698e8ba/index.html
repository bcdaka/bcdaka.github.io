<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>鸿蒙HarmonyOS实战：创建NDK工程、毕昇编译器 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/6757bee57d3ebe4daf2dcac97698e8ba/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="鸿蒙HarmonyOS实战：创建NDK工程、毕昇编译器">
  <meta property="og:description" content="NDK适用场景 适合使用NDK的场景：应用涉及如下场景时，适合采用NDK开发
性能敏感的场景，如游戏、物理模拟等计算密集型场景。
需要复用已有C或C&#43;&#43;库的场景。
需要针对CPU特性进行专项定制库的场景，如Neon加速。
不建议使用NDK的场景：应用涉及如下场景时，不建议采用NDK开发
纯C或C&#43;&#43;的应用。
希望在尽可能多的HarmonyOS设备上保持兼容的应用。
NDK必备 为顺利进行NDK开发，开发者需要先掌握必要的基本概念及基础知识。
NDK基本 Node-APINode-APINode-API
曾用名NAPI，是HarmonyOS中提供ArkTS/JS与C/C&#43;&#43;跨语言调用的接口，是NDK接口中的一部分。该接口是在Node.js提供的Node-API基础上扩展而来，但与Node.js中的Node-API不完全兼容。
C API
HarmonyOS NDK的曾用名，不再使用。
前置知识 Linux C语言编程知识
内核、libc基础库基于POSIX等标准扩展而来，掌握基本的Linux C编程知识能够更好的帮助理解HarmonyOS NDK开发。
CMake使用知识
CMake是HarmonyOS默认支持的构建系统。请先通过CMake官方文档了解基础用法。
Node Addons开发知识
ArkTS采用Node-API作为跨语言调用接口，熟悉基本的Node Addons开发模式，可以更好理解NDK中Node-API的使用。
Clang/LLVM编译器使用知识
具备一定的Clang/LLVM编译器基础知识，能够帮助开发者编译出更优的Native动态库。
NDK目录 build目录：放置预定义的toolchain脚本文件ohos.toolchain.cmake
CMake编译时需要读取该文件中的默认值，比如编译器架构、C&#43;&#43;库链接方式等，因此在编译时会通过CMAKE_TOOLCHAIN_FILE指出该文件的路径，便于CMake在编译时定位到该文件。
build-tools文件夹：放置NDK提供的编译工具
# 键入下一行命令查看CMake的版本 cmake -version # 结果 cmake version 3.16.5 CMake suite maintained and supported by Kitware (kitware.com/cmake). llvm文件夹：放置NDK提供的编译器
NDK常用模块 下表介绍了NDK的常用模块。
模块模块简介标准C库以musl为基础提供的标准C库接口。标准C&#43;&#43;库C&#43;&#43;运行时库libc&#43;&#43;_shared。日志打印日志到系统的HiLog接口。Node-API当需要实现ArkTS/JS和C/C&#43;&#43;之间的交互时，可以使用Node-API。libuv三方异步IO库。zlibzlib库，提供基本的数据压缩、解压接口。Rawfile应用资源访问接口，可以读取应用中打包的各种资源。XComponentArkUI XComponent组件提供surface与触屏事件等接口，方便开发者开发高性能图形应用。Drawing系统提供的2D图形库，可以在surface进行绘制。OpenGL系统提供的OpenGL 3D图形接口。OpenSL ES用于2D、3D音频加速的接口库。 创建NDK工程 下面通过DevEco Studio的NDK工程模板，来演示如何创建一个NDK工程。
不同DevEco Studio版本的向导界面、模板默认参数等会有所不同，请根据实际工程需要，创建工程或修改工程参数。
通过如下两种方式，打开工程创建向导界面。
如果当前未打开任何工程，可以在DevEco Studio的欢迎页，选择Create Project开始创建一个新NDK工程。如果已经打开了工程，可以在菜单栏选择File &gt; New &gt; Create Project来创建一个新NDK工程。 根据工程创建向导，选择Native C&#43;&#43;工程模板，然后单击Next。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-20T15:59:35+08:00">
    <meta property="article:modified_time" content="2024-08-20T15:59:35+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">鸿蒙HarmonyOS实战：创建NDK工程、毕昇编译器</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3 id="ndk适用场景">NDK适用场景</h3> 
<p><strong>适合使用NDK的场景：应用涉及如下场景时，适合采用NDK开发</strong></p> 
<ul><li> <p>性能敏感的场景，如游戏、物理模拟等计算密集型场景。</p> </li><li> <p>需要复用已有C或C++库的场景。</p> </li><li> <p>需要针对CPU特性进行专项定制库的场景，如Neon加速。</p> </li></ul> 
<p><strong>不建议使用NDK的场景：应用涉及如下场景时，不建议采用NDK开发</strong></p> 
<ul><li> <p>纯C或C++的应用。</p> </li><li> <p>希望在尽可能多的HarmonyOS设备上保持兼容的应用。</p> </li></ul> 
<h3 id="ndk必备基础知识">NDK必备</h3> 
<p>为顺利进行NDK开发，开发者需要先掌握必要的基本概念及基础知识。</p> 
<h4 id="ndk基本概念">NDK基本</h4> 
<ul><li> <p>Node-APINode-APINode-API</p> <p>曾用名NAPI，是HarmonyOS中提供ArkTS/JS与C/C++跨语言调用的接口，是NDK接口中的一部分。该接口是在Node.js提供的Node-API基础上扩展而来，但与Node.js中的Node-API不完全兼容。</p> </li><li> <p><strong>C API</strong></p> <p>HarmonyOS NDK的曾用名，不再使用。</p> </li></ul> 
<h4 id="前置知识">前置知识</h4> 
<ul><li> <p><strong>Linux C语言编程知识</strong></p> <p>内核、libc基础库基于POSIX等标准扩展而来，掌握基本的Linux C编程知识能够更好的帮助理解HarmonyOS NDK开发。</p> </li><li> <p><strong>CMake使用知识</strong></p> <p>CMake是HarmonyOS默认支持的构建系统。请先通过CMake官方文档了解基础用法。</p> </li><li> <p><strong>Node Addons开发知识</strong></p> <p>ArkTS采用Node-API作为跨语言调用接口，熟悉基本的Node Addons开发模式，可以更好理解NDK中Node-API的使用。</p> </li><li> <p><strong>Clang/LLVM编译器使用知识</strong></p> <p>具备一定的Clang/LLVM编译器基础知识，能够帮助开发者编译出更优的Native动态库。</p> </li></ul> 
<h4 id="ndk目录简介">NDK目录</h4> 
<ul><li> <p>build目录：放置预定义的toolchain脚本文件ohos.toolchain.cmake</p> <p class="img-center"><img alt="" height="76" src="https://images2.imgbox.com/d7/2b/QvSpZQaU_o.png" width="347"></p> <p>CMake编译时需要读取该文件中的默认值，比如编译器架构、C++库链接方式等，因此在编译时会通过CMAKE_TOOLCHAIN_FILE指出该文件的路径，便于CMake在编译时定位到该文件。</p> </li><li> <p>build-tools文件夹：放置NDK提供的编译工具</p> <pre><code># 键入下一行命令查看CMake的版本
cmake -version
# 结果
cmake version 3.16.5
CMake suite maintained and supported by Kitware (kitware.com/cmake).</code></pre> </li><li> <p>llvm文件夹：放置NDK提供的编译器</p> <p class="img-center"><img alt="" height="115" src="https://images2.imgbox.com/16/8a/lNBNE6iT_o.png" width="883"></p> </li></ul> 
<h3 id="ndk常用模块">NDK常用模块</h3> 
<p>下表介绍了NDK的常用模块。</p> 
<table><thead><tr><th id="mcps1.3.8.3.1.3.1.1">模块</th><th id="mcps1.3.8.3.1.3.1.2">模块简介</th></tr></thead><tbody><tr><td>标准C库</td><td>以musl为基础提供的标准C库接口。</td></tr><tr><td>标准C++库</td><td>C++运行时库libc++_shared。</td></tr><tr><td>日志</td><td>打印日志到系统的HiLog接口。</td></tr><tr><td>Node-API</td><td>当需要实现ArkTS/JS和C/C++之间的交互时，可以使用Node-API。</td></tr><tr><td>libuv</td><td>三方异步IO库。</td></tr><tr><td>zlib</td><td>zlib库，提供基本的数据压缩、解压接口。</td></tr><tr><td>Rawfile</td><td>应用资源访问接口，可以读取应用中打包的各种资源。</td></tr><tr><td>XComponent</td><td>ArkUI XComponent组件提供surface与触屏事件等接口，方便开发者开发高性能图形应用。</td></tr><tr><td>Drawing</td><td>系统提供的2D图形库，可以在surface进行绘制。</td></tr><tr><td>OpenGL</td><td>系统提供的OpenGL 3D图形接口。</td></tr><tr><td>OpenSL ES</td><td>用于2D、3D音频加速的接口库。</td></tr></tbody></table> 
<h2>创建NDK工程</h2> 
<p>下面通过DevEco Studio的NDK工程模板，来演示如何创建一个NDK工程。</p> 
<p>不同DevEco Studio版本的向导界面、模板默认参数等会有所不同，请根据实际工程需要，创建工程或修改工程参数。</p> 
<ol><li> <p>通过如下两种方式，打开工程创建向导界面。</p> 
  <ul><li>如果当前未打开任何工程，可以在DevEco Studio的欢迎页，选择<strong>Create Project</strong>开始创建一个新NDK工程。</li><li>如果已经打开了工程，可以在菜单栏选择<strong>File &gt; New &gt; Create Project</strong>来创建一个新NDK工程。</li></ul></li><li> <p>根据工程创建向导，选择Native C++工程模板，然后单击<strong>Next</strong>。</p> <p class="img-center"><img alt="" height="610" src="https://images2.imgbox.com/c9/c2/nhf4bEYO_o.png" width="963"></p> </li><li> <p>在工程配置页面，根据向导配置工程的基本信息后，单击<strong>Finish。</strong>工具会自动生成示例代码和相关资源，等待工程创建完成。</p> <p>在工程entry/src/main目录下会包含cpp目录</p> <p>                                 <img alt="" height="336" src="https://images2.imgbox.com/af/ca/mfrvLc1O_o.png" width="275"></p> <h3 id="section9398118131718" style="background-color:transparent;">毕昇编译器</h3> <p>毕昇编译器是基于LLVM开源软件开发的一款用于C/C++等语言的native编译器，能将C/C++代码工程编译链接成可以在设备上运行的二进制。在无需改动用户代码的条件下，相比业界主流的开源LLVM或GCC编译器，毕昇编译器能提供更强大的优化能力，使编译链接出来的二进制的运行时长更短、指令数更少，帮助提升应用在设备上的运行流畅度。</p> <h3 id="section16877114219172">能力范围</h3> <p>毕昇编译器提供将C/C++代码工程编译链接成可以在设备上运行的二进制的基本能力，主要包括以下三方面：</p> </li><li>编译能力：将C/C++源码文件编译成汇编文件，汇编文件是指使用汇编语言编写的文件。</li><li>汇编能力：将汇编文件汇编成可重定向文件，可重定向文件是ELF格式的二进制文件，但不能直接放在设备上运行。</li><li>链接能力：将一个或多个可重定向文件一起链接成一个可执行的二进制文件。</li></ol> 
<h3 id="section17255219186">亮点特征</h3> 
<p>毕昇编译器相对于LLVM/GCC编译器有以下特点。</p> 
<ul><li>循环优化增强</li></ul> 
<p>针对循环相关的编译优化，毕昇编译器在场景识别、结构变换等方面做了改进和增强。例如在社区LLVM已有的Loop Distribution优化上，毕昇编译器相比开源LLVM编译器，能额外识别出循环内不同代码块间数据依赖关系、以及不同代码块运行的迭代次数差别，从而能对更多的循环进行loop distribution优化。</p> 
<p class="img-center"><img alt="" height="892" src="https://images2.imgbox.com/90/29/5uym1bMD_o.png" width="1200"></p> 
<p>Figure 1 毕昇编译器Loop Distribution优化增强示例</p> 
<ul><li>矢量化优化增强</li></ul> 
<p>毕昇编译器在矢量化优化方面，相比开源LLVM编译器，不仅能将更多的循环做矢量化转换，还在矢量化指令选择上更高效。例如下面示例中，开源LLVM编译器虽然做了矢量化，但使用了5条矢量指令；而毕昇编译器只需要使用2条矢量指令，最终产生的二进制效率更优。</p> 
<p class="img-center"><img alt="" height="475" src="https://images2.imgbox.com/72/cc/zGtEPmXj_o.png" width="766"></p> 
<p>Figure 2 毕昇编译器矢量化优化增强示例</p> 
<h3 id="section1450716302183">毕昇编译器使用指导</h3> 
<p><strong>在DevEco Studio 中使用毕昇编译器：</strong></p> 
<p>开发者可以获取DevEco Studio 5.0.3.402及以上的版本，在HarmonyOS应用的工程级build-profile.json5中简单配置即可使用毕昇编译器：在runtimeOS为HarmonyOS的时候，设置nativeCompiler为BiSheng，即可使用毕昇编译器构建HarmonyOS工程的C/C++代码。</p> 
<p><img alt="" height="232" src="https://images2.imgbox.com/66/e0/XLuHUI8o_o.png" width="413"></p> 
<h3><strong>最后</strong></h3> 
<p>小编在之前的鸿蒙系统扫盲中，有很多朋友给我留言，不同的角度的问了一些问题，我明显感觉到一点，那就是许多人参与鸿蒙开发，但是又不知道从哪里下手，因为资料太多，太杂，教授的人也多，无从选择。有很多小伙伴不知道学习哪些鸿蒙开发技术？不知道需要重点掌握哪些鸿蒙应用开发知识点？而且学习时频繁踩坑，最终浪费大量时间。所以有一份实用的<strong>鸿蒙（HarmonyOS NEXT）资料</strong>用来跟着学习是非常有必要的。 </p> 
<p><strong>为了确保高效学习，建议规划清晰的学习路线，涵盖以下关键阶段：</strong></p> 
<hr> 
<h2><a id="_10"></a></h2> 
<p><strong> 鸿蒙（HarmonyOS NEXT）最新学习路线</strong></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/b7/34/Kcg0CC9Z_o.png" width="1200">​</p> 
<p><strong>该路线图包含<span style="color:#fe2c24;">基础技能、就业必备技能、多媒体技术、六大电商APP、进阶高级技能、实战就业级设备开发</span>，不仅补充了华为官网未涉及的解决方案</strong></p> 
<p><strong>路线图适合人群：</strong></p> 
<p><strong>IT开发人员：</strong>想要拓展职业边界<br><strong>零基础小白：</strong>鸿蒙爱好者，希望从0到1学习，增加一项技能。<br><strong>技术提升/进阶跳槽：</strong>发展瓶颈期，提升职场竞争力，快速掌握鸿蒙技术</p> 
<p><strong>2.视频学习资料+学习PDF文档</strong></p> 
<p>这份鸿蒙（HarmonyOS NEXT）资料包含了鸿蒙开发必掌握的核心知识要点，内容包含了<strong>（ArkTS、ArkUI开发组件、Stage模型、多端部署、分布式应用开发、音频、视频、WebGL、OpenHarmony多媒体技术、Napi组件、OpenHarmony内核、（南向驱动、嵌入式等）鸿蒙项目实战等等）鸿蒙（HarmonyOS NEXT）</strong>技术知识点。</p> 
<p><strong>HarmonyOS Next 最新全套视频教程</strong></p> 
<p><img alt="" height="804" src="https://images2.imgbox.com/93/27/gmAa7UzX_o.png" width="1088"></p> 
<p>  <strong>纯血版鸿蒙全套学习资料（面试、文档、全套视频等）              </strong></p> 
<p><img alt="" height="245" src="https://images2.imgbox.com/3f/b2/XFn9kzBN_o.png" width="618">​​</p> 
<p><strong><strong>总结</strong></strong></p> 
<p><strong>参与鸿蒙开发，你要先认清适合你的方向，如果是想从事鸿蒙应用开发方向的话，可以参考本文的学习路径，简单来说就是：为了确保高效学习，建议规划清晰的学习路线</strong></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/1c/3a/yAQeNv9a_o.jpg"></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d40c920999311e570e4232e328115d90/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【vue】编辑器段落对应材料同步滚动交互</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1ea84f6b4cf323adb3797b653e165589/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">音频导出后为什么效果变差了 FL Studio音频导出设置推荐</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>