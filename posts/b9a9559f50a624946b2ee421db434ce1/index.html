<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>18 张图手把手教你使用 Canal Adapter 同步 MySQL 数据到 ES8，建议收藏！ - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/b9a9559f50a624946b2ee421db434ce1/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="18 张图手把手教你使用 Canal Adapter 同步 MySQL 数据到 ES8，建议收藏！">
  <meta property="og:description" content="要将 MySQL 的数据同步到 ES8 中总共有如下几个配置，每一个都是必须的
1.MySQL 开启 binlog 日志，并且选择 ROW 模式；
2.初始化 Canal 数据库，并且增加对应的数据库账号和开启 slave 权限；
3.启动 Canal Server 和 Canal Adapter 并配置对应 ES8 的适配器；
4.安装 ES8 并且提前创建对应的数据索引，否则同步不成功。
MySQL 相关配置 检查 MySQL 当前是否开启 binlog，执行如下命令
mysql&gt; show variables like &#39;%log_bin%&#39;; 如果没有开启，则通过修改 my.cnf 配置文件来进行开启，并且配置成 ROW 模式。
开启 binlog cat /etc/my.cnf # log_bin [mysqld] log-bin = /var/lib/mysql/binlogs/mysql-bin #开启binlog binlog-format = ROW #选择row模式 server_id = 1 #配置mysql replication需要定义，不能和canal的slaveId重复 配置 Canal 专属账号 创建一个独立的 canal 账号，并且授权查询和 SLAVE 以及 REPLICATION 权限，账号密码可以自定义，这里都设置成了 canal，这个账号密码后续配置 canal 的时候都会用到。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-15T09:01:45+08:00">
    <meta property="article:modified_time" content="2024-04-15T09:01:45+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">18 张图手把手教你使用 Canal Adapter 同步 MySQL 数据到 ES8，建议收藏！</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>要将 <code>MySQL</code> 的数据同步到 <code>ES8</code> 中总共有如下几个配置，每一个都是必须的</p> 
<p>1.<code>MySQL</code> 开启 <code>binlog</code> 日志，并且选择 <code>ROW</code> 模式；</p> 
<p>2.初始化 <code>Canal</code> 数据库，并且增加对应的数据库账号和开启 <code>slave</code> 权限；</p> 
<p>3.启动 <code>Canal Server</code> 和 <code>Canal Adapter</code> 并配置对应 <code>ES8</code> 的适配器；</p> 
<p>4.安装 <code>ES8</code> 并且提前创建对应的数据索引，否则同步不成功。</p> 
<h2>MySQL 相关配置</h2> 
<p>检查 <code>MySQL</code> 当前是否开启 <code>binlog</code>，执行如下命令</p> 
<pre><code>mysql&gt; show variables like '%log_bin%';
</code></pre> 
<p></p> 
<p class="img-center"><img alt="图片" height="445" src="https://images2.imgbox.com/54/e3/QaDdJ2Bb_o.png" width="1080"></p> 
<p>如果没有开启，则通过修改 <code>my.cnf</code> 配置文件来进行开启，并且配置成 <code>ROW</code> 模式。</p> 
<h3>开启 binlog</h3> 
<pre><code>cat /etc/my.cnf
# log_bin
[mysqld]
log-bin = /var/lib/mysql/binlogs/mysql-bin #开启binlog
binlog-format = ROW #选择row模式
server_id = 1 #配置mysql replication需要定义，不能和canal的slaveId重复
</code></pre> 
<h3>配置 Canal 专属账号</h3> 
<p>创建一个独立的 <code>canal</code> 账号，并且授权查询和 <code>SLAVE</code> 以及 <code>REPLICATION</code> 权限，账号密码可以自定义，这里都设置成了 <code>canal</code>，这个账号密码后续配置 <code>canal</code> 的时候都会用到。</p> 
<pre><code>CREATE USER canal IDENTIFIED BY 'canal';  
GRANT SELECT, REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO 'canal'@'%';
FLUSH PRIVILEGES;
</code></pre> 
<h2>安装 Canal</h2> 
<p><code>https://github.com/alibaba/canal/releases</code></p> 
<p>wget <code>https://github.com/alibaba/canal/releases/download/canal-1.1.7/canal.deployer-1.1.7.tar.gz</code></p> 
<p>wget <code>https://github.com/alibaba/canal/releases/download/canal-1.1.7/canal.adapter-1.1.7.tar.gz</code></p> 
<p><code>Canal Adapter</code> 数据订阅的方式支持两种，直连 <code>Canal Server</code> 或者 订阅 <code>Kafka/RocketMQ</code> 的消息，我们这里是单机，所以直连 Server。</p> 
<h3>启动 Canal Server</h3> 
<p>解压 <code>canal.deployer</code> 压缩包，修改 <code>deployer/conf/example/instance.properties</code> 配置文件，将下面的属性配置成自己设置的值</p> 
<pre><code>canal.instance.master.address=127.0.0.1:3306 

canal.instance.dbUsername = canal  
canal.instance.dbPassword = canal
</code></pre> 
<p>然后启动 <code>Server</code></p> 
<pre><code>./bin/startup.sh
</code></pre> 
<p>查看日志</p> 
<pre><code># 查看 server 日志
tail -f logs/canal/canal.log
# 查看 instance 日志
tail -f logs/example/example.log
</code></pre> 
<h3>配置 Canal Adapter</h3> 
<p><code>Canal Adapter</code> 的配置分配启动器的配置文件和适配器的配置问题，启动器的配置文件为 <code>application.yml</code> 主要用来配置协议以及配置使用什么适配器。</p> 
<h4>启动器配置</h4> 
<pre><code>server:
  port: 8081
spring:
  jackson:
    date-format: yyyy-MM-dd HH:mm:ss
    time-zone: GMT+8
    default-property-inclusion: non_null

canal.conf:
  mode: tcp #tcp kafka rocketMQ rabbitMQ
  flatMessage: true
  zookeeperHosts:
  syncBatchSize: 1000
  retries: -1
  timeout:
  accessKey:
  secretKey:
  consumerProperties:
    # canal tcp consumer
    canal.tcp.server.host: 127.0.0.1:11111
    canal.tcp.zookeeper.hosts:
    canal.tcp.batch.size: 500
    canal.tcp.username:
    canal.tcp.password:
    # kafka consumer
    # kafka.bootstrap.servers: 127.0.0.1:9092
    # kafka.enable.auto.commit: false
    # kafka.auto.commit.interval.ms: 1000
    # kafka.auto.offset.reset: latest
    # kafka.request.timeout.ms: 40000
    # kafka.session.timeout.ms: 30000
    # kafka.isolation.level: read_committed
    # kafka.max.poll.records: 1000
    # rocketMQ consumer
    # rocketmq.namespace:
    # rocketmq.namesrv.addr: 127.0.0.1:9876
    # rocketmq.batch.size: 1000
    # rocketmq.enable.message.trace: false
    # rocketmq.customized.trace.topic:
    # rocketmq.access.channel:
    # rocketmq.subscribe.filter:
    # rabbitMQ consumer
    # rabbitmq.host:
    # rabbitmq.virtual.host:
    # rabbitmq.username:
    # rabbitmq.password:
    # rabbitmq.resource.ownerId:

  srcDataSources:
    defaultDS:
      url: jdbc:mysql://127.0.0.1:3306/ry-vue?useUnicode=true
      username: root
      password: 123456
  canalAdapters:
  - instance: example # canal instance Name or mq topic name
    groups:
    - groupId: g1
      outerAdapters:
        - name: es8
          key: es-key
          hosts: https://127.0.0.1:9200 # 127.0.0.1:9200 for rest mode
          properties:
            mode: rest # transport or rest
            security.auth: elastic:oQuOvvZWZ_Yl*MP4Qdx+
            security.ca.path: /etc/canal/http_ca.crt
            cluster.name: docker-cluster
        - name: logger
#      - name: rdb
#        key: mysql1
#        properties:
#          jdbc.driverClassName: com.mysql.jdbc.Driver
#          jdbc.url: jdbc:mysql://127.0.0.1:3306/mytest2?useUnicode=true
#          jdbc.username: root
#          jdbc.password: 121212
#          druid.stat.enable: false
#          druid.stat.slowSqlMillis: 1000
#      - name: rdb
#        key: oracle1
#        properties:
#          jdbc.driverClassName: oracle.jdbc.OracleDriver
#          jdbc.url: jdbc:oracle:thin:@localhost:49161:XE
#          jdbc.username: mytest
#          jdbc.password: m121212
#      - name: rdb
#        key: postgres1
#        properties:
#          jdbc.driverClassName: org.postgresql.Driver
#          jdbc.url: jdbc:postgresql://localhost:5432/postgres
#          jdbc.username: postgres
#          jdbc.password: 121212
#          threads: 1
#          commitSize: 3000
#      - name: hbase
#        properties:
#          hbase.zookeeper.quorum: 127.0.0.1
#          hbase.zookeeper.property.clientPort: 2181
#          zookeeper.znode.parent: /hbase

#      - name: kudu
#        key: kudu
#        properties:
#          kudu.master.address: 127.0.0.1 # ',' split multi address
#      - name: phoenix
#        key: phoenix
#        properties:
#          jdbc.driverClassName: org.apache.phoenix.jdbc.PhoenixDriver
#          jdbc.url: jdbc:phoenix:127.0.0.1:2181:/hbase/db
#          jdbc.username:
#          jdbc.password:
</code></pre> 
<p>简单说明<code>srcDataSources</code>：表示需要同步的数据库的配置信息</p> 
<p><code>canalAdapters</code>：<code>canal</code> 的适配器配置，下面可以配置多个 <code>instance</code></p> 
<p><code>instance</code>：需要跟我们上面启动 <code>Canal Server</code> 里面的 <code>instance</code> 一致，默认为 <code>example</code></p> 
<p><code>outerAdapters</code>：表示我们需要使用的适配器的列表</p> 
<p><code>name</code>：表示我们使用的是哪个适配器，<code>es8</code> 表示使用的是 <code>es8</code> 适配器，其他的可以参考解压后的 <code>conf</code> 下面的目录名称</p> 
<p><code>properties</code>：<code>properties</code> 下面会有几个重要的配置，分别是协议类型 <code>mode</code>，<code>ES</code>8 的账号密码 <code>security.auth</code>，以及集群名称 <code>cluster.name</code>，还有一个 <code>security.ca.path CA</code> 证书路径，这一项在官方的代码中输出没有的，因为官方并不支持 <code>ES8</code> 的 <code>TL</code>S 认证，对应 ES8 的部署的时候需要关闭 <code>ES8</code> 的安全功能，我这边自己基于源码做了一下改造支持，感兴趣可以看 <code>Github</code> 上面的源码 <code>https://github.com/zhuSilence/canal/commit/d5dba78b78183b7de1472cdc6500ac2c8dba6b66</code>。</p> 
<h4>适配器配置</h4> 
<p>在上面的启动器的配置中我们已经配置了 <code>ES8</code> 作为适配器，那具体要同步的是哪张表，以及对应的 <code>ES</code> 中是索引是哪个怎么配置呢？这些配置就放在适配器的配置里面，每一个适配器的配置都是一个想要同步到 <code>ES</code> 的模板配置。</p> 
<p>这里假设我有两张表，结构如下，一张主表 <code>ead_advertiser</code>，一张从表 <code>ead_advertiser_setting</code>，是一个一对多的关系。</p> 
<pre><code>CREATE TABLE `ead_advertiser` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '广告主信息表',
  `user_id` bigint(20) NOT NULL COMMENT '关联的登录用户 id',
  `advertiser_name` varchar(45) NOT NULL COMMENT '广告主主体名称',
  `advertiser_email` varchar(255) NOT NULL COMMENT '广告主主体邮箱',
  `advertiser_phone` varchar(20) NOT NULL COMMENT '广告主主体联系方式',
  `advertiser_type` tinyint(1) unsigned NOT NULL DEFAULT '0' COMMENT '广告主类型0 广告主 1 代理商',
  `status` tinyint(4) unsigned NOT NULL DEFAULT '1' COMMENT '状态-1 删除 0 禁用 1 正常',
  `gmt_create` datetime NOT NULL COMMENT '创建时间',
  `gmt_update` datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_email` (`advertiser_email`) COMMENT '邮箱唯一索引',
  UNIQUE KEY `uk_phone` (`advertiser_phone`) COMMENT '手机号唯一索引'
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8mb4 COMMENT='广告主信息表';


CREATE TABLE `ead_advertiser_setting` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT 'ead_advertise 配置信息表主键',
  `advertiser_id` bigint(20) NOT NULL COMMENT '主表 id',
  `setting_key` varchar(255) NOT NULL COMMENT '扩展字段 key',
  `setting_value` varchar(255) DEFAULT NULL COMMENT '扩展字段 value',
  `gmt_create` datetime NOT NULL COMMENT '创建时间',
  `gmt_update` datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_advertiser_id_setting_key` (`advertiser_id`,`setting_key`) USING BTREE COMMENT 'key 唯一索引',
  KEY `idx_advertiser_id` (`advertiser_id`) COMMENT '广告主 id 索引'
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8mb4 COMMENT='广告主信息扩展表';
</code></pre> 
<p>数据如下所示</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="212" src="https://images2.imgbox.com/8a/c3/j7a6AMH6_o.png" width="1080"></p> 
<p></p> 
<p class="img-center"><img alt="图片" height="264" src="https://images2.imgbox.com/c4/66/l0KTn7it_o.png" width="1080"></p> 
<p>现在想把这两张表形成一张大宽表，<code>setting_key</code> 里面的内容作为一个独立的列拼接在主表上面，然后将拼接后的数据同步到 <code>ES</code> 中。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="188" src="https://images2.imgbox.com/65/00/xz5seFpK_o.png" width="1080"></p> 
<p>转换的 <code>SQL</code> 如下</p> 
<pre><code>SELECT
 a.id AS _id,
 a.user_id AS user_id,
 a.advertiser_name AS advertiser_name,
 a.advertiser_email AS advertiser_email,
 a.advertiser_phone AS advertiser_phone,
 a.advertiser_type AS advertiser_type,
 a.status AS status,
 a.gmt_create AS gmt_create,
 a.gmt_update AS gmt_update,
 c.advertiser_id AS advertiser_id,
 c._sign_time AS _sign_time,
 c._sign_account AS _sign_account 
FROM
 ead_advertiser a
 LEFT JOIN (
 SELECT
  b.advertiser_id AS advertiser_id,
  max((
   CASE
     b.setting_key 
     WHEN '_sign_time' THEN
     b.setting_value ELSE '' 
    END 
    )) AS _sign_time,
   max((
    CASE
      b.setting_key 
      WHEN '_sign_account' THEN
      b.setting_value ELSE '' 
     END 
     )) AS _sign_account 
   FROM
    ead_advertiser_setting b 
   GROUP BY
    b.advertiser_id 
    ) c ON ((
    a.id = c.advertiser_id 
 ))
</code></pre> 
<p>那么对应的适配的配置如下所示</p> 
<pre><code>dataSourceKey: defaultDS
destination: example
outerAdapterKey: es-key
groupId: g1
esMapping:
  _index: search-advertiser_info
  _id: _id
  upsert: true
  #pk: id
  sql: "SELECT a.id AS _id,a.user_id AS user_id,a.advertiser_name AS advertiser_name,a.advertiser_email AS advertiser_email,a.advertiser_phone AS advertiser_phone,a.advertiser_type AS advertiser_type,a.status AS status,a.gmt_create AS gmt_create,a.gmt_update AS gmt_update,c.advertiser_id AS advertiser_id,c._sign_time AS _sign_time,c._sign_account AS _sign_account FROM ead_advertiser a LEFT JOIN (SELECT b.advertiser_id AS advertiser_id, max((CASE b.setting_key WHEN '_sign_time' THEN b.setting_value ELSE '' END )) AS _sign_time,max((CASE b.setting_key WHEN '_sign_account' THEN b.setting_value ELSE '' END )) AS _sign_account FROM ead_advertiser_setting b GROUP BY b.advertiser_id ) c ON ((a.id = c.advertiser_id ))"
  #  objFields:
  #    _labels: array:;
  #etlCondition: " where a.gmt_update&gt;='{0}'"
  commitBatch: 1
</code></pre> 
<p>简单说明：</p> 
<p><code>dataSourceKey: defaultDS</code></p> 
<p><code>destination: example</code></p> 
<p><code>outerAdapterKey: es-key</code></p> 
<p><code>groupId: g1</code></p> 
<p>上面的几个配置，都需要跟启动器里面的配置保持一致。</p> 
<p><code>esMappin</code>g：该配置是表示的是如何将 <code>MySQL</code> 的数据同步到 <code>ES</code> 中，配置比较复杂，其中</p> 
<p><code>_index</code> 表示 <code>ES</code> 的索引（需要提前创建）；</p> 
<p><code>_id</code> 和 <code>pk</code> 二选一配置，表示使用查询出来的哪个字段作为唯一值；</p> 
<p><code>upsert</code> 表示对应主键的数据不存在的时候执行插入动作，存在的时候执行更新动作；</p> 
<p><code>sql</code>：表示要同步的数据，这个的 <code>SQL</code> 形式要求会比较严格</p> 
<p><code>sql</code> 支持多表关联自由组合, 但是有一定的限制:</p> 
<ol><li> <p>主表不能为子查询语句</p> </li><li> <p>只能使用 <code>left outer join</code> 即最左表一定要是主表</p> </li><li> <p>关联从表如果是子查询不能有多张表</p> </li><li> <p>主 <code>sql</code> 中不能有 <code>where</code> 查询条件(从表子查询中可以有 <code>where</code> 条件但是不推荐, 可能会造成数据同步的不一致, 比如修改了 <code>where</code> 条件中的字段内容)</p> </li><li> <p>关联条件只允许主外键的'='操作不能出现其他常量判断比如: <code>on a.role_id=b.id and b.statues=1</code></p> </li><li> <p>关联条件必须要有一个字段出现在主查询语句中比如: <code>on a.role_id=b.id</code> 其中的 <code>a.role_id</code> 或者 <code>b.id</code> 必须出现在主 <code>select</code> 语句中</p> </li></ol> 
<h4>全量 ETL</h4> 
<p>配置好了启动器和适配器过后，我们就可以启动 <code>Canal Adapter</code> 了，在解压缩的目录中执行如下命令</p> 
<pre><code># 启动启动器
./bin/startup.sh
# 查看日志
tail -f adapter.log
</code></pre> 
<p>输出如下日志，表示启动成功</p> 
<pre><code>2024-04-14 16:11:17.746 [main] INFO  c.a.o.canal.adapter.launcher.loader.CanalAdapterLoader - Start adapter for canal-client mq topic: example-g1 succeed
2024-04-14 16:11:17.746 [Thread-4] INFO  c.a.otter.canal.adapter.launcher.loader.AdapterProcessor - =============&gt; Start to connect destination: example &lt;=============
2024-04-14 16:11:17.746 [main] INFO  c.a.o.canal.adapter.launcher.loader.CanalAdapterService - ## the canal client adapters are running now ......
2024-04-14 16:11:17.769 [main] INFO  c.a.otter.canal.adapter.launcher.CanalAdapterApplication - Started CanalAdapterApplication in 5.912 seconds (JVM running for 7.732)
2024-04-14 16:11:17.963 [Thread-4] INFO  c.a.otter.canal.adapter.launcher.loader.AdapterProcessor - =============&gt; Subscribe destination: example succeed &lt;=============
</code></pre> 
<p>首次执行的时候，我们可以通过 ETL 功能，将全量的数据或者根据执行条件过滤后的数据同步到 ES8 中，如果要添加过滤条件，则需要在适配器的配置中增加如下配置和条件。</p> 
<pre><code>etlCondition: " where xxx"
</code></pre> 
<p>通过执行如下命令进行全量 ETL</p> 
<pre><code>curl -X POST http://127.0.0.1:8081/etl/es8/search-advertiser_info.yml
</code></pre> 
<p><code>search-advertiser_info.yml</code> 则为适配器文件的名称。</p> 
<p>在执行上面的命令之前，我们可以通过 <code>kibana</code> 看到 <code>ES</code> 中对应的索引里面 <code>Document</code> 数量为 0</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="585" src="https://images2.imgbox.com/60/0a/DyA6MJYD_o.png" width="1080"></p> 
<p>执行上述命令，日志如下</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="93" src="https://images2.imgbox.com/38/85/jKCjNtt1_o.png" width="1080"></p> 
<p>img</p> 
<p>再次查询 <code>ES</code>，发现已经成功写入了五条数据。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="540" src="https://images2.imgbox.com/61/78/aZOeWQgA_o.png" width="1080"></p> 
<p>通过查询，可以看到有五条数据</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="495" src="https://images2.imgbox.com/66/5b/3hriABSc_o.png" width="1080"></p> 
<h4>增量同步</h4> 
<p>这里我们挑选 id 为 4 的这条数据来看下更新后是否会自动同步，当前 id = 4 的数据如下</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="134" src="https://images2.imgbox.com/77/a9/GV2RdkCP_o.png" width="1080"></p> 
<p>ES8 中的数据如下</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="569" src="https://images2.imgbox.com/c4/35/FKBkqczv_o.png" width="1080"></p> 
<p>然后我们修改一下 <code>MySQL</code> 中的数据，将 <code>advertiser_phon</code>e 修改为 <code>111111</code>，首先数据库中数据已经变了</p> 
<p class="img-center"><img alt="图片" height="212" src="https://images2.imgbox.com/f0/a4/0Y7ZEeP0_o.png" width="1080"></p> 
<p>其次在 <code>Canal Adapter</code> 的日志中我们也可以看到如下日志</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="136" src="https://images2.imgbox.com/15/af/mNVTk3lL_o.png" width="1080"></p> 
<p>与此同时我们再次查询 <code>ES</code> 发现数据也更新了</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="541" src="https://images2.imgbox.com/c7/e0/EGzfFQR8_o.png" width="1080"></p> 
<p>同时我们再通过给 id 为 4 的记录增加两个扩展字段，</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="257" src="https://images2.imgbox.com/7b/94/Svguv7d3_o.png" width="1080"></p> 
<p></p> 
<p class="img-center"><img alt="图片" height="134" src="https://images2.imgbox.com/e7/b8/hhEvIJxc_o.png" width="1080"></p> 
<p><code>ES</code> 中的数据也同步更新了，至此整个数据从<code>MySQL</code> 同步的 <code>ES8</code> 已经基本实现了，后续其他的表也按照这种方式接入即可。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="528" src="https://images2.imgbox.com/61/73/YDGoP99p_o.png" width="1080"></p> 
<h2>使用 Docker 安装 ES8</h2> 
<p><code>Docker</code> 安装 <code>ES8</code> 比较简单，按照官方文档直接操作就好了，这边就不演示了<code> https://www.elastic.co/guide/en/elasticsearch/reference/current/docker.html</code></p> 
<h2 style="background-color:transparent;">总结</h2> 
<p>今天给大家完成的演示了一下如何将 <code>MySQL</code> 的数据通过 <code>Canal Adapter</code> 同步到 <code>ES</code>，功能很强大，但是实操的过程中还是会遇到很多问题的，感兴趣的小伙伴一定要自己动手实操一下，相信会有收获的。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b5fcb83b1d2a4c4e7df3890402da03cb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">如何直接给AI程序代码？拯救毕设流程图绘制</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/389deabea5408cee9e0d0df4f0ea7063/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Tesseract4Android：一款强大的OCR识别库，助力移动应用开发</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>