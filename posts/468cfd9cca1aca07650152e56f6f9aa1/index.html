<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Java 将word转为PDF的三种方式和处理在服务器上下载后乱码的格式_java word转pdf - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/468cfd9cca1aca07650152e56f6f9aa1/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Java 将word转为PDF的三种方式和处理在服务器上下载后乱码的格式_java word转pdf">
  <meta property="og:description" content="如果这里找不到的话，可以使用命令 fc-list 查看一下有没有，如果没有或者出现该命令不可用的情况，那就需要先安装基础字体：使用命令：yum -y install fontconfig ，完成之后就能看到/user/share/fonts 了
2：找到Windows中的字体，将字体上传到这个 my-fonts中
这里面有很多字体，我们需要的是中文字体，可以选择性上传，选择需要的中文字体上传，比如宋体，要和你文件模板中字体一致就行。上传到my-fonts文件夹下
3：安装
接着根据当前目录下的字体建立scale文件,
切换到my-fonts目录下执行命令：mkfontscale
若提示mkfontscale command not found,则运行yum install mkfontscale
接着建立dir文件：mkfontdir
使用命令：vi /etc/fonts/fonts.conf 修改配置文件，添加：&lt;dir&gt;/usr/share/fonts/my-fonts&lt;/dir&gt;
添加后：
然后运行：fc-cache
fc-list #查看字体列表
4：赋予权限
chmod 777 /usr/share/fonts/my-fonts
chmod 755 /usr/share/fonts/my-fonts/*
使用命令查看： fc-list :lang=zh
2：Word转PDF实现的几种方式 1：使用POI的方式将word转换为PDF
引入依赖：
&lt;dependency&gt; &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt; &lt;artifactId&gt;fr.opensagres.poi.xwpf.converter.pdf-gae&lt;/artifactId&gt; &lt;version&gt;2.0.1&lt;/version&gt; &lt;/dependency&gt; 在关闭流之前添加并修改reponse中.docx为.pdf
response.setHeader(&#34;Content-Disposition&#34;, &#34;attachment; filename=&#34; &#43; java.net.URLEncoder.encode(&#34;日报-&#34;&#43;datetime&#43;&#34;.pdf&#34;, &#34;UTF-8&#34;)); //转为PDF PdfOptions options = PdfOptions.create(); PdfConverter.getInstance().convert(document, outStream, options); //下面再是转word里面最后的代码，关闭流 2：使用aspose.words的Document方式将word转换为PDF
1：下载jar包：jar包下载
2：将jar包放入项目中resources目录下的lib文件夹中：
3：将jar包转为library
转换后就会出现上面图中箭头处的样子可以打开。
4：引入jar包依赖：
&lt;dependency&gt; &lt;groupId&gt;com.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-05T12:48:23+08:00">
    <meta property="article:modified_time" content="2024-04-05T12:48:23+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Java 将word转为PDF的三种方式和处理在服务器上下载后乱码的格式_java word转pdf</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>如果这里找不到的话，可以使用命令 <code>fc-list</code> 查看一下有没有，如果没有或者出现该命令不可用的情况，那就需要先安装基础字体：使用命令：<code>yum -y install fontconfig</code> ，完成之后就能看到/user/share/fonts 了</p> 
<p>2：<strong>找到Windows中的字体，将字体上传到这个 my-fonts中</strong><br> <img src="https://images2.imgbox.com/67/39/AiWhEEec_o.png" alt="在这里插入图片描述"><br> 这里面有很多字体，我们需要的是中文字体，可以选择性上传，选择需要的中文字体上传，比如宋体，要和你文件模板中字体一致就行。上传到my-fonts文件夹下</p> 
<p>3：<strong>安装</strong><br> 接着根据当前目录下的字体建立scale文件,<br> 切换到my-fonts目录下执行命令：<code>mkfontscale</code><br> 若提示<code>mkfontscale command not found</code>,则运行<code>yum install mkfontscale</code></p> 
<p>接着建立dir文件：<code>mkfontdir</code><br> 使用命令：<code>vi /etc/fonts/fonts.conf</code> 修改配置文件，添加：<code>&lt;dir&gt;/usr/share/fonts/my-fonts&lt;/dir&gt;</code><br> 添加后：<br> <img src="https://images2.imgbox.com/1a/51/kwXmP9d0_o.png" alt="在这里插入图片描述"></p> 
<p>然后运行：<code>fc-cache</code><br> <code>fc-list</code> #查看字体列表</p> 
<p>4：赋予权限<br> chmod 777 /usr/share/fonts/my-fonts<br> chmod 755 /usr/share/fonts/my-fonts/*</p> 
<p>使用命令查看： fc-list :lang=zh</p> 
<h4><a id="2WordPDF_32"></a>2：Word转PDF实现的几种方式</h4> 
<p>1：<strong>使用POI的方式将word转换为PDF</strong><br> 引入依赖：</p> 
<pre><code>&lt;dependency&gt;
      &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt;
      &lt;artifactId&gt;fr.opensagres.poi.xwpf.converter.pdf-gae&lt;/artifactId&gt;
      &lt;version&gt;2.0.1&lt;/version&gt;
&lt;/dependency&gt;

</code></pre> 
<p>在关闭流之前添加并修改reponse中.docx为.pdf</p> 
<pre><code>response.setHeader("Content-Disposition", "attachment; filename=" + java.net.URLEncoder.encode("日报-"+datetime+".pdf", "UTF-8"));
//转为PDF
PdfOptions options = PdfOptions.create();
PdfConverter.getInstance().convert(document, outStream, options);
//下面再是转word里面最后的代码，关闭流

</code></pre> 
<p>2：<strong>使用aspose.words的Document方式将word转换为PDF</strong><br> 1：下载jar包：<a href="" rel="nofollow">jar包下载</a><br> 2：将jar包放入项目中resources目录下的lib文件夹中：<br> <img src="https://images2.imgbox.com/fe/d0/T5qT3zLd_o.png" alt="在这里插入图片描述"><br> 3：将jar包转为library<br> <img src="https://images2.imgbox.com/e6/71/kwHlllz6_o.png" alt="在这里插入图片描述"><br> 转换后就会出现上面图中箭头处的样子可以打开。</p> 
<p>4：引入jar包依赖：</p> 
<pre><code>&lt;dependency&gt;
            &lt;groupId&gt;com.aspose.words&lt;/groupId&gt;
            &lt;artifactId&gt;aspose-words&lt;/artifactId&gt;
            &lt;version&gt;15.8.0&lt;/version&gt;
            &lt;scope&gt;system&lt;/scope&gt;
            &lt;systemPath&gt;${project.basedir}/src/main/resources/lib/aspose-words-15.8.0-jdk16.jar&lt;/systemPath&gt;
&lt;/dependency&gt;

</code></pre> 
<p>在打包的依赖中添加：</p> 
<pre><code>			&lt;plugin&gt;
                &lt;configuration&gt;
                    &lt;includeSystemScope&gt;true&lt;/includeSystemScope&gt;
                &lt;/configuration&gt;
			&lt;/plugin&gt;

</code></pre> 
<p>5：转换</p> 
<pre><code>String s = "&lt;License&gt;&lt;Data&gt;&lt;Products&gt;&lt;Product&gt;Aspose.Total for Java&lt;/Product&gt;&lt;Product&gt;Aspose.Words for Java&lt;/Product&gt;&lt;/Products&gt;&lt;EditionType&gt;Enterprise&lt;/EditionType&gt;&lt;SubscriptionExpiry&gt;20991231&lt;/SubscriptionExpiry&gt;&lt;LicenseExpiry&gt;20991231&lt;/LicenseExpiry&gt;&lt;SerialNumber&gt;8bfe198c-7f0c-4ef8-8ff0-acc3237bf0d7&lt;/SerialNumber&gt;&lt;/Data&gt;&lt;Signature&gt;sNLLKGMUdF0r8O1kKilWAGdgfs2BvJb/2Xp8p5iuDVfZXmhppo+d0Ran1P9TKdjV4ABwAgKXxJ3jcQTqE/2IRfqwnPf8itN8aFZlV3TJPYeD3yWE7IT55Gz6EijUpC7aKeoohTb4w2fpox58wWoF3SNp6sK6jDfiAUGEHYJ9pjU=&lt;/Signature&gt;&lt;/License&gt;";
		//去除水印
        ByteArrayInputStream is = new ByteArrayInputStream(s.getBytes());
        License license = new License();
        license.setLicense(is);

		//将XWPFDocument转换为InputStream
        ByteArrayOutputStream b = new ByteArrayOutputStream();
        //这里的document=XWPFDocument document，在下面的word转换中
        document.write(b);
        InputStream inputStream = new ByteArrayInputStream(b.toByteArray());
        
        //这里的Document 的引入是
        //import com.aspose.words.Document;
		//import com.aspose.words.License;
		//import com.aspose.words.SaveFormat;
        Document doc = new Document(inputStream);
        doc.save(outStream, SaveFormat.PDF);
        b.close();
        inputStream.close();
        //下面再是转word里面最后的代码，关闭流

</code></pre> 
<p>3：<strong>使用documents4j 的方式将word转换为PDF</strong></p> 
<p>1：引入依赖：</p> 
<pre><code>        &lt;!-- word 转 pdf   通过documents4j实现    --&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;com.documents4j&lt;/groupId&gt;
            &lt;artifactId&gt;documents4j-local&lt;/artifactId&gt;
            &lt;version&gt;1.0.3&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.documents4j&lt;/groupId&gt;
            &lt;artifactId&gt;documents4j-transformer-msoffice-word&lt;/artifactId&gt;
            &lt;version&gt;1.0.3&lt;/version&gt;
        &lt;/dependency&gt;

</code></pre> 
<p>2：转换如下：</p> 
<pre><code>		//将XWPFDocument转换为InputStream


**自我介绍一下，小编13年上海交大毕业，曾经在小公司待过，也去过华为、OPPO等大厂，18年进入阿里一直到现在。**

**深知大多数Linux运维工程师，想要提升技能，往往是自己摸索成长或者是报班学习，但对于培训机构动则几千的学费，着实压力不小。自己不成体系的自学效果低效又漫长，而且极易碰到天花板技术停滞不前！**

**因此收集整理了一份《2024年Linux运维全套学习资料》，初衷也很简单，就是希望能够帮助到想自学提升又不知道该从何学起的朋友，同时减轻大家的负担。**
![img](https://img-blog.csdnimg.cn/img_convert/6e5af033d0ad418390566db235b8eca1.png)
![img](https://img-blog.csdnimg.cn/img_convert/f93c263fd16ef44fc634eebd68b0c63c.png)
![img](https://img-blog.csdnimg.cn/img_convert/5be9ba00d353db0b26f21bac84b07015.png)
![img](https://img-blog.csdnimg.cn/img_convert/3ca1691bb6f24f2d96348c6644290d6c.png)
![img](https://img-blog.csdnimg.cn/img_convert/90a0cb167d944bd48744cec7789c6824.png)

**既有适合小白学习的零基础资料，也有适合3年以上经验的小伙伴深入学习提升的进阶课程，基本涵盖了95%以上Linux运维知识点，真正体系化！**

**由于文件比较大，这里只是将部分目录大纲截图出来，每个节点里面都包含大厂面经、学习笔记、源码讲义、实战项目、讲解视频，并且后续会持续更新**

**如果你觉得这些内容对你有帮助，可以添加VX：vip1024b （备注Linux运维获取）**
![img](https://img-blog.csdnimg.cn/img_convert/47b3839a7fcc16b82ab9cc5b4cd38bda.jpeg)



为了做好运维面试路上的助攻手，特整理了上百道 **【运维技术栈面试题集锦】** ，让你面试不慌心不跳，高薪offer怀里抱！

这次整理的面试题，**小到shell、MySQL，大到K8s等云原生技术栈，不仅适合运维新人入行面试需要，还适用于想提升进阶跳槽加薪的运维朋友。**

![](https://img-blog.csdnimg.cn/img_convert/d6035d202e9601aef2f7321456ee2e68.png)

本份面试集锦涵盖了

*   **174 道运维工程师面试题**
*   **128道k8s面试题**
*   **108道shell脚本面试题**
*   **200道Linux面试题**
*   **51道docker面试题**
*   **35道Jenkis面试题**
*   **78道MongoDB面试题**
*   **17道ansible面试题**
*   **60道dubbo面试题**
*   **53道kafka面试**
*   **18道mysql面试题**
*   **40道nginx面试题**
*   **77道redis面试题**
*   **28道zookeeper**

**总计 1000+ 道面试题， 内容 又全含金量又高**

*   **174道运维工程师面试题**

&gt; 1、什么是运维?

&gt; 2、在工作中，运维人员经常需要跟运营人员打交道，请问运营人员是做什么工作的?

&gt; 3、现在给你三百台服务器，你怎么对他们进行管理?

&gt; 4、简述raid0 raid1raid5二种工作模式的工作原理及特点

&gt; 5、LVS、Nginx、HAproxy有什么区别?工作中你怎么选择?

&gt; 6、Squid、Varinsh和Nginx有什么区别，工作中你怎么选择?

&gt; 7、Tomcat和Resin有什么区别，工作中你怎么选择?

&gt; 8、什么是中间件?什么是jdk?

&gt; 9、讲述一下Tomcat8005、8009、8080三个端口的含义？

&gt; 10、什么叫CDN?

&gt; 11、什么叫网站灰度发布?

&gt; 12、简述DNS进行域名解析的过程?

&gt; 13、RabbitMQ是什么东西?

&gt; 14、讲一下Keepalived的工作原理?

&gt; 15、讲述一下LVS三种模式的工作过程?

&gt; 16、mysql的innodb如何定位锁问题，mysql如何减少主从复制延迟?

&gt; 17、如何重置mysql root密码?

[**一个人可以走的很快，但一群人才能走的更远。如果你从事以下工作或对以下感兴趣，欢迎戳这里加入程序员的圈子，让我们一起学习成长！**](https://bbs.csdn.net/forums/4304bb5a486d4c3ab8389e65ecb71ac0)

**AI人工智能、Android移动开发、AIGC大模型、C C#、Go语言、Java、Linux运维、云计算、MySQL、PMP、网络安全、Python爬虫、UE5、UI设计、Unity3D、Web前端开发、产品经理、车载开发、大数据、鸿蒙、计算机网络、嵌入式物联网、软件测试、数据结构与算法、音视频开发、Flutter、IOS开发、PHP开发、.NET、安卓逆向、云计算**

sdn.net/forums/4304bb5a486d4c3ab8389e65ecb71ac0)

**AI人工智能、Android移动开发、AIGC大模型、C C#、Go语言、Java、Linux运维、云计算、MySQL、PMP、网络安全、Python爬虫、UE5、UI设计、Unity3D、Web前端开发、产品经理、车载开发、大数据、鸿蒙、计算机网络、嵌入式物联网、软件测试、数据结构与算法、音视频开发、Flutter、IOS开发、PHP开发、.NET、安卓逆向、云计算**

</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0e32aed36d196550ddad9b9287f68dc4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Python】无法将“pip”项识别为 cmdlet、函数、脚本文件或可运行程序的名称解决方案</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ae9696106ae5f21a7744e1e854de0f48/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【开发环境】Mac 安装 Visual Studio Code ② ( 装 C/C&#43;&#43; 扩展 | 安装配置 Code Runner 扩展插件 | 运行 C 语言程序 )</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>