<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于Java和GDAL实现的GeoJSON数据读取与入库实践 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/dbb0bb8667db8a4a6e0118e4dc113725/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="基于Java和GDAL实现的GeoJSON数据读取与入库实践">
  <meta property="og:description" content="目录
前言
一、基础数据介绍
1、 数据格式
2、数据参数
二、空间数据库设计
1、主体表模型
2、DDL语句与空间索引
三、GDAL解析及入库
1、GDAL中GeoJSON驱动
2、解析GeoJSON
3、Java模型
4、数据入库
总结
前言 在面向空间的矢量数据处理过程当中，虽然shapefile等文件是常用矢量文件的载体。也是大多数应用用来支持矢量文件存储的对象。其实除了shagefile这种格式，还有很多种格式。今天介绍一种在webgis比较常见的数据格式，它就是GeoJSON。
GeoJSON是一种对各种地理数据结构进行编码的格式，基于Javascript对象表示法(JavaScript Object Notation, 简称JSON)的地理空间信息数据交换格式。GeoJSON对象可以表示几何、特征或者特征集合。GeoJSON支持下面这几种几何类型：点、线、面、多点、多线、多面和几何集合。GeoJSON里的特征包含一个几何对象和其他属性，特征集合表示一系列特征。
一个完整的GeoJSON数据结构总是一个（JSON术语里的）对象。在GeoJSON里，对象由名/值对--也称作成员的集合组成。对每个成员来说，名字总是字符串。成员的值要么是字符串、数字、对象、数组，要么是下面文本常量中的一个：&#34;true&#34;,&#34;false&#34;和&#34;null&#34;。数组的值是上面所说的元素组成。
GeoJSON的格式
GeoJSON总是由一个单独的对象组成。这个对象（指的是下面的GeoJSON对象）表示几何、特征或者特征集合。
GeoJSON对象可能有任何数目成员（名/值对）。
GeoJSON对象必须有一个名字为&#34;type&#34;的成员。这个成员的值是由GeoJSON对象的类型所确定的字符串。
type成员的值必须是下面之一：&#34;Point&#34;, &#34;MultiPoint&#34;, &#34;LineString&#34;, &#34;MultiLineString&#34;, &#34;Polygon&#34;, &#34;MultiPolygon&#34;, &#34;GeometryCollection&#34;, &#34;Feature&#34;, 或者 &#34;FeatureCollection&#34;。这些值分别对应：点、多点、线、多线、面、多面、几何集合、特征、特征集合。
GeoJSON对象可能有一个可选的&#34;crs&#34;成员，它的值必须是一个坐标参考系统的对象。
GeoJSON对象可能有一个&#34;bbox&#34;成员，它的值必须是边界框数组。
{ &#34;type&#34;: &#34;FeatureCollection&#34;, &#34;features&#34;: [{ &#34;type&#34;: &#34;Feature&#34;, &#34;geometry&#34;: { &#34;type&#34;: &#34;Point&#34;, &#34;coordinates&#34;: [102.0, 0.5] }, &#34;properties&#34;: { &#34;prop0&#34;: &#34;value0&#34; } }, { &#34;type&#34;: &#34;Feature&#34;, &#34;geometry&#34;: { &#34;type&#34;: &#34;LineString&#34;, &#34;coordinates&#34;: [[102.0, 0.0], [103.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-28T06:45:00+08:00">
    <meta property="article:modified_time" content="2024-04-28T06:45:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于Java和GDAL实现的GeoJSON数据读取与入库实践</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2><a id="_0"></a></h2> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="-toc" style="margin-left:0px;"></p> 
<p id="%E5%89%8D%E8%A8%80-toc" style="margin-left:0px;"><a href="#%E5%89%8D%E8%A8%80" rel="nofollow">前言</a></p> 
<p id="%E4%B8%80%E3%80%81%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E4%BB%8B%E7%BB%8D-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E4%BB%8B%E7%BB%8D" rel="nofollow">一、基础数据介绍</a></p> 
<p id="1%E3%80%81%20%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F-toc" style="margin-left:40px;"><a href="#1%E3%80%81%20%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F" rel="nofollow">1、 数据格式</a></p> 
<p id="2%E3%80%81%E6%95%B0%E6%8D%AE%E5%8F%82%E6%95%B0-toc" style="margin-left:40px;"><a href="#2%E3%80%81%E6%95%B0%E6%8D%AE%E5%8F%82%E6%95%B0" rel="nofollow">2、数据参数</a></p> 
<p id="%E4%BA%8C%E3%80%81%E7%A9%BA%E9%97%B4%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%E7%A9%BA%E9%97%B4%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1" rel="nofollow">二、空间数据库设计</a></p> 
<p id="1%E3%80%81%E4%B8%BB%E4%BD%93%E8%A1%A8%E6%A8%A1%E5%9E%8B-toc" style="margin-left:40px;"><a href="#1%E3%80%81%E4%B8%BB%E4%BD%93%E8%A1%A8%E6%A8%A1%E5%9E%8B" rel="nofollow">1、主体表模型</a></p> 
<p id="2%E3%80%81DDL%E8%AF%AD%E5%8F%A5%E4%B8%8E%E7%A9%BA%E9%97%B4%E7%B4%A2%E5%BC%95-toc" style="margin-left:40px;"><a href="#2%E3%80%81DDL%E8%AF%AD%E5%8F%A5%E4%B8%8E%E7%A9%BA%E9%97%B4%E7%B4%A2%E5%BC%95" rel="nofollow">2、DDL语句与空间索引</a></p> 
<p id="%E4%B8%89%E3%80%81GDAL%E8%A7%A3%E6%9E%90%E5%8F%8A%E5%85%A5%E5%BA%93-toc" style="margin-left:0px;"><a href="#%E4%B8%89%E3%80%81GDAL%E8%A7%A3%E6%9E%90%E5%8F%8A%E5%85%A5%E5%BA%93" rel="nofollow">三、GDAL解析及入库</a></p> 
<p id="1%E3%80%81GDAL%E4%B8%ADGeoJSON%E9%A9%B1%E5%8A%A8-toc" style="margin-left:40px;"><a href="#1%E3%80%81GDAL%E4%B8%ADGeoJSON%E9%A9%B1%E5%8A%A8" rel="nofollow">1、GDAL中GeoJSON驱动</a></p> 
<p id="2%E3%80%81%E8%A7%A3%E6%9E%90GeoJSON-toc" style="margin-left:40px;"><a href="#2%E3%80%81%E8%A7%A3%E6%9E%90GeoJSON" rel="nofollow">2、解析GeoJSON</a></p> 
<p id="3%E3%80%81Java%E6%A8%A1%E5%9E%8B-toc" style="margin-left:40px;"><a href="#3%E3%80%81Java%E6%A8%A1%E5%9E%8B" rel="nofollow">3、Java模型</a></p> 
<p id="4%E3%80%81%E6%95%B0%E6%8D%AE%E5%85%A5%E5%BA%93-toc" style="margin-left:40px;"><a href="#4%E3%80%81%E6%95%B0%E6%8D%AE%E5%85%A5%E5%BA%93" rel="nofollow">4、数据入库</a></p> 
<p id="%E6%80%BB%E7%BB%93-toc" style="margin-left:0px;"><a href="#%E6%80%BB%E7%BB%93" rel="nofollow">总结</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="%E5%89%8D%E8%A8%80">前言</h2> 
<p>        在面向空间的矢量数据处理过程当中，虽然shapefile等文件是常用矢量文件的载体。也是大多数应用用来支持矢量文件存储的对象。其实除了shagefile这种格式，还有很多种格式。今天介绍一种在webgis比较常见的数据格式，它就是GeoJSON。</p> 
<p>        GeoJSON是一种对各种地理数据结构进行编码的格式，基于Javascript对象表示法(JavaScript Object Notation, 简称JSON)的地理空间信息数据交换格式。GeoJSON对象可以表示几何、特征或者特征集合。GeoJSON支持下面这几种几何类型：点、线、面、多点、多线、多面和几何集合。GeoJSON里的特征包含一个几何对象和其他属性，特征集合表示一系列特征。</p> 
<p>        一个完整的GeoJSON数据结构总是一个（JSON术语里的）对象。在GeoJSON里，对象由名/值对--也称作成员的集合组成。对每个成员来说，名字总是字符串。成员的值要么是字符串、数字、对象、数组，要么是下面文本常量中的一个："true","false"和"null"。数组的值是上面所说的元素组成。</p> 
<p>        <strong>GeoJSON的格式</strong></p> 
<p>GeoJSON总是由一个单独的对象组成。这个对象（指的是下面的GeoJSON对象）表示几何、特征或者特征集合。</p> 
<ul><li> <p>GeoJSON对象可能有任何数目成员（名/值对）。</p> </li><li> <p>GeoJSON对象必须有一个名字为"type"的成员。这个成员的值是由GeoJSON对象的类型所确定的字符串。</p> </li><li> <p>type成员的值必须是下面之一："Point", "MultiPoint", "LineString", "MultiLineString", "Polygon", "MultiPolygon", "GeometryCollection", "Feature", 或者 "FeatureCollection"。这些值分别对应：点、多点、线、多线、面、多面、几何集合、特征、特征集合。</p> </li><li> <p>GeoJSON对象可能有一个可选的"crs"成员，它的值必须是一个坐标参考系统的对象。</p> </li><li> <p>GeoJSON对象可能有一个"bbox"成员，它的值必须是边界框数组。</p> </li></ul> 
<pre><code class="language-javascript">{
    "type": "FeatureCollection",
    "features": [{
            "type": "Feature",
            "geometry": {
                "type": "Point",
                "coordinates": [102.0, 0.5]
            },
            "properties": {
                "prop0": "value0"
            }
        }, {
            "type": "Feature",
            "geometry": {
                "type": "LineString",
                "coordinates": [[102.0, 0.0], [103.0, 1.0], [104.0, 0.0], [105.0, 1.0]]
            },
            "properties": {
                "prop0": "value0",
                "prop1": 0.0
            }
        }, {
            "type": "Feature",
            "geometry": {
                "type": "Polygon",
                "coordinates": [[100.0, 0.0], [101.0, 0.0], [101.0, 1.0], [100.0, 1.0], [100.0, 0.0]]
            },
            "properties": {
                "prop0": "value0",
                "prop1": {
                    "this": "that"
                }
            }
        }
    ]
}</code></pre> 
<p>        本文将重点讲解在Java中如何调用GDAL进行GeoJSON矢量数据处理，首先使用QGIS工具展示待处理的地名GeoJSON数据，然后介绍在PostGIS空间数据库中创建空间表，最后介绍基于Java语言调用GDAL将GeoJSON进行空间数据入库。如果当前您也有GeoJSON数据的处理，不妨来博客指导一二。</p> 
<h2 id="%E4%B8%80%E3%80%81%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E4%BB%8B%E7%BB%8D">一、基础数据介绍</h2> 
<p>        今天要处理的示例数据是地名数据，原始数据由<strong>GISer last </strong>分享，大家有兴趣的可以在他的个人公众号下回复消息，及时获取信息。时间大概是2015年左右的全国分级数据，有省会城市地名、地级市地名、县级市地名、区县地名等，都是以GeoJSON形式的保存的。       </p> 
<p>        本小节以Qgis为例，对下载下来的GeoJSON数据进行处理。包括空间可视化、属性数据展示、地图标注等。GeoJSON其实也是一种json，只是在普通的json上面增加了空间数据的属性和规范。所以我们可以直接使用文本的形式来进行数据的编辑与展示。</p> 
<h3 id="1%E3%80%81%20%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F">1、 数据格式</h3> 
<p>        地名数据主要是一些点位数据，除了在乡镇一级数据条数多一点之外，其它都还可以都没有超过MB。下面使用Qgis对这些数据打开来看一下。</p> 
<p class="img-center"><img alt="" height="262" src="https://images2.imgbox.com/62/95/9RgPdiml_o.png" width="583"></p> 
<p>        将GeoJSON数据加载到Qgis当中去之后，查看这些空间数据的属性。比如投影信息、属性信息等等。为了方便数据的展示，辅助添加了省级行政区划矢量数据。打开相关标注后，可以看到x效果如下：</p> 
<p class="img-center"><img alt="" height="323" src="https://images2.imgbox.com/a2/e2/zi99flmK_o.png" width="607"></p> 
<p style="text-align:center;"> 省会地名数据示意图</p> 
<p class="img-center"><img alt="" height="335" src="https://images2.imgbox.com/62/c7/8dvHGOoN_o.png" width="647"></p> 
<p style="text-align:center;"> 地级市地名示意图</p> 
<p class="img-center"><img alt="" height="345" src="https://images2.imgbox.com/65/02/oy0sR46q_o.png" width="667"></p> 
<p style="text-align:center;"> 县级市地名示意图</p> 
<h3 id="2%E3%80%81%E6%95%B0%E6%8D%AE%E5%8F%82%E6%95%B0">2、数据参数</h3> 
<p>        在qgis中查看数据的属性信息，可以看到如下信息。</p> 
<table align="center" border="1" cellpadding="1" cellspacing="1"><tbody><tr><td style="width:67px;">序号</td><td style="width:182px;">参数</td><td style="width:432px;">说明</td></tr><tr><td style="width:67px;">1</td><td style="width:182px;">存储类型</td><td style="width:432px;"> <p>GeoJSON</p> </td></tr><tr><td style="width:67px;">2</td><td style="width:182px;">编码</td><td style="width:432px;">UTF-8</td></tr><tr><td style="width:67px;">3</td><td style="width:182px;">几何图形</td><td style="width:432px;"> <p>Point (Point)</p> </td></tr><tr><td style="width:67px;">4</td><td style="width:182px;">坐标参考系</td><td style="width:432px;"> <p>EPSG:4326 - WGS 84 - 地理的</p> </td></tr><tr><td style="width:67px;">5</td><td style="width:182px;">范围</td><td style="width:432px;"> <p>87.6149638000000550,20.0500348290000261 : 126.5286520170000131,45.8019539320000604</p> </td></tr><tr><td style="width:67px;">6</td><td style="width:182px;">单位</td><td style="width:432px;">度</td></tr></tbody></table> 
<p>        数据属性信息如下：</p> 
<table align="center" border="1" cellpadding="1" cellspacing="1"><tbody><tr><td style="width:120px;">序号</td><td style="width:201px;">属性名</td><td style="width:163px;">数据类型</td><td style="width:264px;">说明</td></tr><tr><td style="width:120px;">1</td><td style="width:201px;">NAME</td><td style="width:163px;">String</td><td style="width:264px;">地名</td></tr><tr><td style="width:120px;">2</td><td style="width:201px;">PIINYIN</td><td style="width:163px;">String</td><td style="width:264px;">地名拼音</td></tr><tr><td style="width:120px;">3</td><td style="width:201px;">CLASS</td><td style="width:163px;">String</td><td style="width:264px;">类型</td></tr><tr><td style="width:120px;">4</td><td style="width:201px;">BZ</td><td style="width:163px;">String</td><td style="width:264px;">备注</td></tr><tr><td style="width:120px;">5</td><td style="width:201px;">SLX</td><td style="width:163px;">String</td><td style="width:264px;">应该是标记，暂无特殊含义</td></tr></tbody></table> 
<p class="img-center"><img alt="" height="345" src="https://images2.imgbox.com/0b/df/ZyTwSdaa_o.png" width="652"></p> 
<table align="center" border="1" cellpadding="1" cellspacing="1"><tbody><tr><td>序号</td><td>数据名称</td><td>数据条数</td></tr><tr><td>1</td><td>省会城市地名</td><td>29</td></tr><tr><td>2</td><td>地级市地名</td><td>283</td></tr><tr><td>3</td><td>县级市地名</td><td>339</td></tr><tr><td>4</td><td>区县地名</td><td>2567</td></tr></tbody></table> 
<p> 有了上面的数据参数基础和属性数据基础之后。下面我们介绍如何进行空间数据库表的设计。</p> 
<h2 id="%E4%BA%8C%E3%80%81%E7%A9%BA%E9%97%B4%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1">二、空间数据库设计</h2> 
<p>        为了将GeoJSON数据保存到空间数据，我们需要设计对应的数据库表。这里我们采用PostGIS数据库，数据表采用PostGIS中的空间表。本小节将重点讲解讲解空间表的设计。</p> 
<h3 id="1%E3%80%81%E4%B8%BB%E4%BD%93%E8%A1%A8%E6%A8%A1%E5%9E%8B">1、主体表模型</h3> 
<p>        为了实现数据对象到数据库物理模型的对应。针对上述业务，我们建立1对1的映射。保留原有空间属性的独立性，同时增加表主键以及关键的空间信息字段geom。为了后续我们方便的对空间数据进行空间索引查询，在geom列上，我们构建了关键的GIST空间索引。</p> 
<p class="img-center"><img alt="" height="272" src="https://images2.imgbox.com/0f/fc/DVnz1czT_o.png" width="655"></p> 
<h3 id="2%E3%80%81DDL%E8%AF%AD%E5%8F%A5%E4%B8%8E%E7%A9%BA%E9%97%B4%E7%B4%A2%E5%BC%95">2、DDL语句与空间索引</h3> 
<p>        请注意，空间索引必须要创建，否则在进行空间查询时性能很慢。提前新建好索引，对后续的性能提升有很大的帮助。</p> 
<pre><code class="language-sql">CREATE TABLE "public"."biz_geographic_name" (
  "pk_id" int8 NOT NULL,
  "name" varchar(255) COLLATE "pg_catalog"."default" NOT NULL,
  "pinyin" varchar(255) COLLATE "pg_catalog"."default",
  "classz" varchar(4) COLLATE "pg_catalog"."default",
  "bz" varchar(100) COLLATE "pg_catalog"."default",
  "slx" varchar(20) COLLATE "pg_catalog"."default",
  "geom" "public"."geometry" NOT NULL,
  CONSTRAINT "pk_biz_geographic_name" PRIMARY KEY ("pk_id")
)
;

ALTER TABLE "public"."biz_geographic_name" 
  OWNER TO "ghy01";

CREATE INDEX "idex_biz_geographic_name_classz" ON "public"."biz_geographic_name" USING btree (
  "classz" COLLATE "pg_catalog"."default" "pg_catalog"."text_ops" ASC NULLS LAST
);

CREATE INDEX "idx_biz_geographic_name_geom" ON "public"."biz_geographic_name" USING gist (
  "geom" "public"."gist_geometry_ops_2d"
);

COMMENT ON COLUMN "public"."biz_geographic_name"."pk_id" IS '主键id';

COMMENT ON COLUMN "public"."biz_geographic_name"."name" IS '地名';

COMMENT ON COLUMN "public"."biz_geographic_name"."pinyin" IS '汉语拼音';

COMMENT ON COLUMN "public"."biz_geographic_name"."classz" IS 'classz';

COMMENT ON COLUMN "public"."biz_geographic_name"."bz" IS '备注';

COMMENT ON COLUMN "public"."biz_geographic_name"."slx" IS 'slx';

COMMENT ON COLUMN "public"."biz_geographic_name"."geom" IS '空间对象';

COMMENT ON TABLE "public"."biz_geographic_name" IS '地名基础信息表，用于存储中国范围内的地名信息';</code></pre> 
<p>        至此，我们完成了地名表的空间数据库表的设计，同时根据业务需要，创建了数据索引。 </p> 
<h2 id="%E4%B8%89%E3%80%81GDAL%E8%A7%A3%E6%9E%90%E5%8F%8A%E5%85%A5%E5%BA%93">三、GDAL解析及入库</h2> 
<p>        本节主要讲解如何利用GDAL来进行数据的解析，使用详细的代码讲解如何解析GeoJSON数据，最后调用MP框架实现将GeoJSON数据保存到空间数据库。</p> 
<h3 id="1%E3%80%81GDAL%E4%B8%ADGeoJSON%E9%A9%B1%E5%8A%A8">1、GDAL中GeoJSON驱动</h3> 
<p>        在Gdal中，针对不同的数据格式，使用不同的驱动包来解析支持。与解析shapefile的方式一致。解析GeoJSON使用GeoJSON驱动。此驱动程序实现对访问编码在中的功能的读/写支持 GeoJSON 格式。GeoJSON是一种基于 JavaScript Object Notation<br> (JSON) . JSON是一种用于数据交换的轻量级纯文本格式，GeoJSON只不过是它对地理内容的专门化。</p> 
<ul><li> <p><strong>FLATTEN_NESTED_ATTRIBUTES</strong> =是/否：是否递归地探索嵌套对象并生成扁平OGR属性。默认为否。</p> </li><li> <p><strong>NESTED_ATTRIBUTE_SEPARATOR</strong> =字符：嵌套属性组件之间的分隔符。默认为“</p> </li><li> <p><strong>FEATURE_SERVER_PAGING</strong> =是/否：是否使用ArcGIS功能服务终结点自动滚动结果。</p> </li><li> <p><strong>NATIVE_DATA</strong> =是/否：（GDAL&gt;=2.1）是否在FeatureCollection和Feature级别存储本机JSon表示。默认为否。此选项可用于通过保留一些额外的JSon对象来改进从GeoJSON到GeoJSON的往返，否则OGR抽象将忽略这些额外的JSon对象。请注意，ogr2ogr在默认情况下启用此选项，除非指定其-noNativeData开关。</p> </li><li> <p><strong>ARRAY_AS_STRING</strong> =YES/NO：（GDAL&gt;=2.1）是否将字符串、整数或实数的JSon数组作为OGR字符串公开。默认为“否”。也可以使用 <code>OGR_GEOJSON_ARRAY_AS_STRING</code> 配置选项。</p> </li><li> <p><strong>DATE_AS_STRING</strong> =YES/NO：（GDAL&gt;=3.0.3）是使用专用的OGR日期/时间/日期时间类型还是作为OGR字符串公开日期/时间/日期时间内容。默认值为NO（即检测到日期/时间/日期-时间）。也可以用 <code>OGR_GEOJSON_DATE_AS_STRING</code> 配置选项。</p> </li></ul> 
<h3 id="2%E3%80%81%E8%A7%A3%E6%9E%90GeoJSON">2、解析GeoJSON</h3> 
<p>        在Java中解析GeoJSON的关键代码如下：</p> 
<pre><code class="language-java">@Test
public void readDjsGeoJSON() {
	// 指定文件的名字和路径
	String strVectorFile = "path/2015省市区县乡镇地名数据/地名点_地级市.geojson";
	// 注册所有的驱动
	ogr.RegisterAll();
	gdal.SetConfigOption("GDAL_FILENAME_IS_UTF8", "YES");
	gdal.SetConfigOption("SHAPE_ENCODING", "UTF-8");
	String strDriverName = "GeoJSON";
	org.gdal.ogr.Driver oDriver = ogr.GetDriverByName(strDriverName);
	if (oDriver == null) {
		System.out.println(strDriverName + " 驱动不可用！\n");
		return;
	}
	DataSource dataSource = oDriver.Open(strVectorFile);
	Layer layer = dataSource.GetLayer(0);
	SpatialReference spatialReference = layer.GetSpatialRef();
	String srid = spatialReference.GetAttrValue("AUTHORITY", 1);
	long featureCount = layer.GetFeatureCount();
	List&lt;GeographicName&gt; list = new ArrayList&lt;GeographicName&gt;();
	for (int i = 0; i &lt; featureCount; i++) {
		Feature feature = layer.GetFeature(i);
		String name = feature.GetFieldAsString("NAME");
		String pinyin = feature.GetFieldAsString("PINYIN");
		String classz = feature.GetFieldAsString("CLASS");
		String bz = feature.GetFieldAsString("BZ");
		String slx = feature.GetFieldAsString("SLX");
		Geometry geom = feature.GetGeometryRef();
		//step 1、生成原始wkt
		String wkt = geom.ExportToWkt();
		wkt = "SRID=" + srid +";" + wkt;//拼接srid，实现动态写入
		list.add(new GeographicName(name, pinyin, classz, bz, slx, wkt));
		System.out.println("name=" + name + "\tclassz=" + classz+ "\twkt="+ wkt);
	}
	geographicNameService.saveBatch(list,300);
	dataSource.delete();
	gdal.GDALDestroyDriverManager();
}</code></pre> 
<h3 id="3%E3%80%81Java%E6%A8%A1%E5%9E%8B">3、Java模型</h3> 
<p>        下面提供基础的Java实体模型，其它比如Mapper和Service对象，不进行代码说明。</p> 
<pre><code class="language-java">package com.yelang.project.extend.earthquake.domain;
import java.io.Serializable;
import com.baomidou.mybatisplus.annotation.TableField;
import com.baomidou.mybatisplus.annotation.TableId;
import com.baomidou.mybatisplus.annotation.TableName;
import com.yelang.framework.handler.PgGeometryTypeHandler;
import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;
import lombok.ToString;

@Data
@ToString
@AllArgsConstructor
@NoArgsConstructor
@TableName(value ="biz_geographic_name",autoResultMap = true)
public class GeographicName implements Serializable{
	private static final long serialVersionUID = -3694849578429480952L;
	@TableId(value = "pk_id")
	private Long pkId;
	private String name;
	private String pinyin;
	private String classz;
	private String bz;
	private String slx;
	public GeographicName(String name, String pinyin, String classz, String bz, String slx, String geom) {
		super();
		this.name = name;
		this.pinyin = pinyin;
		this.classz = classz;
		this.bz = bz;
		this.slx = slx;
		this.geom = geom;
	}
	@TableField(typeHandler = PgGeometryTypeHandler.class)
	private String geom;
	@TableField(exist=false)
	private String geomJson;  
}</code></pre> 
<h3 id="4%E3%80%81%E6%95%B0%E6%8D%AE%E5%85%A5%E5%BA%93">4、数据入库</h3> 
<p>        使用junit进行代码测试，将数据批量插入到数据库中。</p> 
<p class="img-center"><img alt="" height="358" src="https://images2.imgbox.com/f8/1c/nHBAb9t7_o.png" width="638"></p> 
<p>        在程序的控制台中可以看到以下的输出，表名在执行数据库的插入操作：</p> 
<p class="img-center"><img alt="" height="329" src="https://images2.imgbox.com/b9/8f/iOlQlV74_o.png" width="638"></p> 
<p>        最后来数据库中是否有批量插入的地名信息，使用以下查询语句：</p> 
<pre><code class="language-sql">select * from biz_geographic_name;</code></pre> 
<p class="img-center"><img alt="" height="358" src="https://images2.imgbox.com/f7/f5/QWX96g0U_o.png" width="673"></p> 
<p>        使用navicat可以连接数据库，看到在数据库中已经成功的将地级市的地名数据插入到空间数据中。 </p> 
<h2 id="%E6%80%BB%E7%BB%93">总结</h2> 
<p>        以上就是本文的主要内容，本文将重点讲解在Java中如何调用GDAL进行GeoJSON矢量数据处理，首先使用QGIS工具展示待处理的地名GeoJSON数据，然后介绍在PostGIS空间数据库中创建空间表，最后介绍基于Java语言调用GDAL将GeoJSON进行空间数据入库。文章行文仓促，定有不足支持，关于文章的任何不足之处，都欢迎各位朋友在评论区留言批评指正交流，不慎感谢。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8bab8215df48e1092caafae60753589d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">解决Cannot set up a python SDK at Python问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ac87e4ddcb256cbd5e08103da80bfafd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">.NET操作RabbitMQ(全球最简单实现)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>