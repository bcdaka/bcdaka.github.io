<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ã€Pythonã€‘PyWebIO åˆä½“éªŒï¼šç”¨ Python å†™ç½‘é¡µ - ç¼–ç¨‹å¤§å’–</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/69db44dcecddcd3fa47ce818d5f95de3/">
  <meta property="og:site_name" content="ç¼–ç¨‹å¤§å’–">
  <meta property="og:title" content="ã€Pythonã€‘PyWebIO åˆä½“éªŒï¼šç”¨ Python å†™ç½‘é¡µ">
  <meta property="og:description" content="ç›®å½• å‰è¨€1 ä½¿ç”¨æ–¹æ³•1.1 å®‰è£… Pywebio1.2 è¾“å‡ºå†…å®¹1.3 è¾“å…¥å†…å®¹ 2 ç¤ºä¾‹ç¨‹åº2.1 BMI è®¡ç®—å™¨2.2 Markdown ç¼–è¾‘å™¨2.3 èŠå¤©å®¤2.4 äº”å­æ£‹ å‰è¨€ å‰ä¸¤å¤©æ­£åœ¨é€› Githubï¼Œå¶ç„¶çœ‹åˆ°ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„é¡¹ç›®ï¼šPyWebIoã€‚
è¿™æ˜¯ä¸€ä¸ª Python ç¬¬ä¸‰æ–¹åº“ï¼Œå¯ä»¥åªç”¨ Python è¯­è¨€å†™å‡ºä¸€ä¸ªç½‘é¡µï¼Œè€Œä¸”æ”¯æŒ Flaskï¼ŒDjangoï¼ŒTornado ç­‰ web æ¡†æ¶ã€‚
ç”šè‡³ï¼Œå®ƒå¯ä»¥æ”¯æŒæ•°æ®å¯è§†åŒ–å›¾è¡¨çš„ç»˜åˆ¶ï¼Œè¿˜æä¾›äº†ä¸€è¡Œå‡½æ•°æ¸²æŸ“ Markdown æ–‡æœ¬ã€‚
é‚£ä¹ˆè¯ä¸å¤šè¯´ï¼Œæ­£ç‰‡å¼€å§‹â€”â€”
ä»“åº“åœ°å€ï¼šhttps://github.com/pywebio/PyWebIO
1 ä½¿ç”¨æ–¹æ³• 1.1 å®‰è£… Pywebio æ‰“å¼€ CMDï¼Œåœ¨é‡Œé¢è¾“å…¥ä»¥ä¸‹ä»£ç ï¼š
pip install pywebio å¦‚æœé€Ÿåº¦å¤ªæ…¢ï¼Œå»ºè®®ä½¿ç”¨å›½å†…é•œåƒï¼š
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple pywebio 1.2 è¾“å‡ºå†…å®¹ put_text() è¾“å‡ºæ–‡å­—put_table() è¾“å‡ºè¡¨æ ¼put_markdown() è¾“å‡º markdown å†…å®¹put_file() è¾“å‡ºæ–‡ä»¶ä¸‹è½½é“¾æ¥put_image() è¾“å‡ºå›¾ç‰‡put_button() è¾“å‡ºæŒ‰é’® è¯·çœ‹ç¤ºä¾‹ç¨‹åºï¼š
from pywebio.output import * def main(): # æ–‡æœ¬è¾“å‡º put_text(&#34;Hello world!">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-09T17:49:45+08:00">
    <meta property="article:modified_time" content="2024-08-09T17:49:45+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§å’–" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§å’–</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ã€Pythonã€‘PyWebIO åˆä½“éªŒï¼šç”¨ Python å†™ç½‘é¡µ</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>ç›®å½•</h4> 
 <ul><li><ul><li><a href="#_1" rel="nofollow">å‰è¨€</a></li><li><a href="#1__13" rel="nofollow">1 ä½¿ç”¨æ–¹æ³•</a></li><li><ul><li><a href="#11__Pywebio_15" rel="nofollow">1.1 å®‰è£… Pywebio</a></li><li><a href="#12__29" rel="nofollow">1.2 è¾“å‡ºå†…å®¹</a></li><li><a href="#13__65" rel="nofollow">1.3 è¾“å…¥å†…å®¹</a></li></ul> 
   </li><li><a href="#2__80" rel="nofollow">2 ç¤ºä¾‹ç¨‹åº</a></li><li><ul><li><a href="#21_BMI__86" rel="nofollow">2.1 BMI è®¡ç®—å™¨</a></li><li><a href="#22_Markdown__113" rel="nofollow">2.2 Markdown ç¼–è¾‘å™¨</a></li><li><a href="#23__148" rel="nofollow">2.3 èŠå¤©å®¤</a></li><li><a href="#24__231" rel="nofollow">2.4 äº”å­æ£‹</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_1"></a>å‰è¨€</h3> 
<p>å‰ä¸¤å¤©æ­£åœ¨é€› Githubï¼Œå¶ç„¶çœ‹åˆ°ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„é¡¹ç›®ï¼š<strong>PyWebIo</strong>ã€‚</p> 
<p>è¿™æ˜¯ä¸€ä¸ª Python ç¬¬ä¸‰æ–¹åº“ï¼Œå¯ä»¥åªç”¨ Python è¯­è¨€å†™å‡ºä¸€ä¸ªç½‘é¡µï¼Œè€Œä¸”æ”¯æŒ Flaskï¼ŒDjangoï¼ŒTornado ç­‰ web æ¡†æ¶ã€‚</p> 
<p>ç”šè‡³ï¼Œå®ƒå¯ä»¥æ”¯æŒæ•°æ®å¯è§†åŒ–å›¾è¡¨çš„ç»˜åˆ¶ï¼Œè¿˜æä¾›äº†ä¸€è¡Œå‡½æ•°æ¸²æŸ“ Markdown æ–‡æœ¬ã€‚</p> 
<p>é‚£ä¹ˆè¯ä¸å¤šè¯´ï¼Œæ­£ç‰‡å¼€å§‹â€”â€”</p> 
<blockquote> 
 <p>ä»“åº“åœ°å€ï¼š<a href="https://github.com/pywebio/PyWebIO">https://github.com/pywebio/PyWebIO</a></p> 
</blockquote> 
<h3><a id="1__13"></a>1 ä½¿ç”¨æ–¹æ³•</h3> 
<h4><a id="11__Pywebio_15"></a>1.1 å®‰è£… Pywebio</h4> 
<p>æ‰“å¼€ CMDï¼Œåœ¨é‡Œé¢è¾“å…¥ä»¥ä¸‹ä»£ç ï¼š</p> 
<pre><code class="prism language-cmd">pip install pywebio
</code></pre> 
<p>å¦‚æœé€Ÿåº¦å¤ªæ…¢ï¼Œå»ºè®®ä½¿ç”¨å›½å†…é•œåƒï¼š</p> 
<pre><code class="prism language-cmd">pip install -i https://pypi.tuna.tsinghua.edu.cn/simple pywebio
</code></pre> 
<h4><a id="12__29"></a>1.2 è¾“å‡ºå†…å®¹</h4> 
<ul><li><code>put_text()</code> è¾“å‡ºæ–‡å­—</li><li><code>put_table()</code> è¾“å‡ºè¡¨æ ¼</li><li><code>put_markdown()</code> è¾“å‡º markdown å†…å®¹</li><li><code>put_file()</code> è¾“å‡ºæ–‡ä»¶ä¸‹è½½é“¾æ¥</li><li><code>put_image()</code> è¾“å‡ºå›¾ç‰‡</li><li><code>put_button()</code> è¾“å‡ºæŒ‰é’®</li></ul> 
<p>è¯·çœ‹ç¤ºä¾‹ç¨‹åºï¼š</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pywebio<span class="token punctuation">.</span>output <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># æ–‡æœ¬è¾“å‡º</span>
    put_text<span class="token punctuation">(</span><span class="token string">"Hello world!"</span><span class="token punctuation">)</span>
    
    <span class="token comment"># è¡¨æ ¼è¾“å‡º</span>
    put_table<span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token punctuation">[</span><span class="token string">'å•†å“'</span><span class="token punctuation">,</span> <span class="token string">'ä»·æ ¼'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">'è‹¹æœ'</span><span class="token punctuation">,</span> <span class="token string">'5.5'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">'é¦™è•‰'</span><span class="token punctuation">,</span> <span class="token string">'7'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
  
    <span class="token comment"># Markdownè¾“å‡º</span>
    put_markdown<span class="token punctuation">(</span><span class="token string">'~~åˆ é™¤çº¿~~'</span><span class="token punctuation">)</span>
  
    <span class="token comment"># æ–‡ä»¶è¾“å‡º</span>
    put_file<span class="token punctuation">(</span><span class="token string">'hello_word.txt'</span><span class="token punctuation">,</span> <span class="token string">b'hello word!'</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><a href="https://imgse.com/i/pkzLkTI" rel="nofollow"><img src="https://images2.imgbox.com/97/66/vvjbnWF9_o.png" alt="pkzLkTI.png"></a></p> 
<h4><a id="13__65"></a>1.3 è¾“å…¥å†…å®¹</h4> 
<ul><li><code>input()</code> å’Œ python ä¸€æ ·çš„å‡½æ•°æ¬¸</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pywebio<span class="token punctuation">.</span><span class="token builtin">input</span> <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"è¯·è¾“å…¥ä½ çš„åå­—ï¼š"</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/49/eb/LXSKxIoM_o.gif" alt=""></p> 
<h3><a id="2__80"></a>2 ç¤ºä¾‹ç¨‹åº</h3> 
<p>è¿™äº›éƒ½æ˜¯å®˜æ–¹ç»™å‡ºçš„å®ä¾‹ï¼Œä»£ç éƒ½ä¸åˆ° 100 è¡Œï¼</p> 
<blockquote> 
 <p>å®˜æ–¹é¡¹ç›®åœ°å€ï¼š<a href="https://pywebio-demos.pywebio.online/" rel="nofollow">https://pywebio-demos.pywebio.online/</a></p> 
</blockquote> 
<h4><a id="21_BMI__86"></a>2.1 BMI è®¡ç®—å™¨</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pywebio<span class="token punctuation">.</span><span class="token builtin">input</span> <span class="token keyword">import</span> <span class="token builtin">input</span><span class="token punctuation">,</span> FLOAT
<span class="token keyword">from</span> pywebio<span class="token punctuation">.</span>output <span class="token keyword">import</span> put_text
  
<span class="token keyword">def</span> <span class="token function">bmi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    height <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Your Height(cm)ï¼š"</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span>FLOAT<span class="token punctuation">)</span>
    weight <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Your Weight(kg)ï¼š"</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span>FLOAT<span class="token punctuation">)</span>
  
    BMI <span class="token operator">=</span> weight <span class="token operator">/</span> <span class="token punctuation">(</span>height <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span>
  
    top_status <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">14.9</span><span class="token punctuation">,</span> <span class="token string">'Severely underweight'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">18.4</span><span class="token punctuation">,</span> <span class="token string">'Underweight'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  <span class="token punctuation">(</span><span class="token number">22.9</span><span class="token punctuation">,</span> <span class="token string">'Normal'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">27.5</span><span class="token punctuation">,</span> <span class="token string">'Overweight'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  <span class="token punctuation">(</span><span class="token number">40.0</span><span class="token punctuation">,</span> <span class="token string">'Moderately obese'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span><span class="token string">'inf'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'Severely obese'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  
    <span class="token keyword">for</span> top<span class="token punctuation">,</span> status <span class="token keyword">in</span> top_status<span class="token punctuation">:</span>
        <span class="token keyword">if</span> BMI <span class="token operator">&lt;=</span> top<span class="token punctuation">:</span>
            put_text<span class="token punctuation">(</span><span class="token string">'Your BMI: %.1f, category: %s'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>BMI<span class="token punctuation">,</span> status<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
  
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    bmi<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/9b/90/cej41XnO_o.gif" alt=""></p> 
<h4><a id="22_Markdown__113"></a>2.2 Markdown ç¼–è¾‘å™¨</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pywebio <span class="token keyword">import</span> start_server

<span class="token keyword">from</span> pywebio<span class="token punctuation">.</span>output <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> pywebio<span class="token punctuation">.</span>pin <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> pywebio<span class="token punctuation">.</span>session <span class="token keyword">import</span> set_env<span class="token punctuation">,</span> download


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Markdown Previewer"""</span>
    set_env<span class="token punctuation">(</span>output_animation<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

    put_markdown<span class="token punctuation">(</span><span class="token triple-quoted-string string">"""# Markdown Live Preview
    The online markdown editor with live preview. The source code of this application is [here](https://github.com/wang0618/PyWebIO/blob/dev/demos/markdown_previewer.py).
    ## Write your Markdown
    """</span><span class="token punctuation">)</span>
    put_textarea<span class="token punctuation">(</span><span class="token string">'md_text'</span><span class="token punctuation">,</span> rows<span class="token operator">=</span><span class="token number">18</span><span class="token punctuation">,</span> code<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'mode'</span><span class="token punctuation">:</span> <span class="token string">'markdown'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    put_buttons<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Download content'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">lambda</span> <span class="token keyword">_</span><span class="token punctuation">:</span> download<span class="token punctuation">(</span><span class="token string">'saved.md'</span><span class="token punctuation">,</span> pin<span class="token punctuation">.</span>md_text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> small<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    put_markdown<span class="token punctuation">(</span><span class="token string">'## Preview'</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        change_detail <span class="token operator">=</span> pin_wait_change<span class="token punctuation">(</span><span class="token string">'md_text'</span><span class="token punctuation">)</span>
        <span class="token keyword">with</span> use_scope<span class="token punctuation">(</span><span class="token string">'md'</span><span class="token punctuation">,</span> clear<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            put_markdown<span class="token punctuation">(</span>change_detail<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sanitize<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    start_server<span class="token punctuation">(</span>main<span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8080</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/69/61/9tODPVmC_o.gif" alt=""></p> 
<h4><a id="23__148"></a>2.3 èŠå¤©å®¤</h4> 
<pre><code class="prism language-python"><span class="token keyword">import</span> asyncio

<span class="token keyword">from</span> pywebio <span class="token keyword">import</span> start_server
<span class="token keyword">from</span> pywebio<span class="token punctuation">.</span><span class="token builtin">input</span> <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> pywebio<span class="token punctuation">.</span>output <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> pywebio<span class="token punctuation">.</span>session <span class="token keyword">import</span> defer_call<span class="token punctuation">,</span> info <span class="token keyword">as</span> session_info<span class="token punctuation">,</span> run_async

MAX_MESSAGES_CNT <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">**</span> <span class="token number">4</span>

chat_msgs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment"># The chat message history. The item is (name, message content)</span>
online_users <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">t</span><span class="token punctuation">(</span>eng<span class="token punctuation">,</span> chinese<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""return English or Chinese text according to the user's browser language"""</span>
    <span class="token keyword">return</span> chinese <span class="token keyword">if</span> <span class="token string">'zh'</span> <span class="token keyword">in</span> session_info<span class="token punctuation">.</span>user_language <span class="token keyword">else</span> eng


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">refresh_msg</span><span class="token punctuation">(</span>my_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""send new message to current session"""</span>
    <span class="token keyword">global</span> chat_msgs
    last_idx <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>chat_msgs<span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> m <span class="token keyword">in</span> chat_msgs<span class="token punctuation">[</span>last_idx<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> my_name<span class="token punctuation">:</span>  <span class="token comment"># only refresh message that not sent by current user</span>
                put_markdown<span class="token punctuation">(</span><span class="token string">'`%s`: %s'</span> <span class="token operator">%</span> m<span class="token punctuation">,</span> sanitize<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> scope<span class="token operator">=</span><span class="token string">'msg-box'</span><span class="token punctuation">)</span>

        <span class="token comment"># remove expired message</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>chat_msgs<span class="token punctuation">)</span> <span class="token operator">&gt;</span> MAX_MESSAGES_CNT<span class="token punctuation">:</span>
            chat_msgs <span class="token operator">=</span> chat_msgs<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>chat_msgs<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>

        last_idx <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>chat_msgs<span class="token punctuation">)</span>


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""PyWebIO chat room

    You can chat with everyone currently online.
    """</span>
    <span class="token keyword">global</span> chat_msgs

    put_markdown<span class="token punctuation">(</span>t<span class="token punctuation">(</span><span class="token string">"## PyWebIO chat room\nWelcome to the chat room, you can chat with all the people currently online. You can open this page in multiple tabs of your browser to simulate a multi-user environment. This application uses less than 90 lines of code, the source code is [here](https://github.com/wang0618/PyWebIO/blob/dev/demos/chat_room.py)"</span><span class="token punctuation">,</span> <span class="token string">"## PyWebIOèŠå¤©å®¤\næ¬¢è¿æ¥åˆ°èŠå¤©å®¤ï¼Œä½ å¯ä»¥å’Œå½“å‰æ‰€æœ‰åœ¨çº¿çš„äººèŠå¤©ã€‚ä½ å¯ä»¥åœ¨æµè§ˆå™¨çš„å¤šä¸ªæ ‡ç­¾é¡µä¸­æ‰“å¼€æœ¬é¡µé¢æ¥æµ‹è¯•èŠå¤©æ•ˆæœã€‚æœ¬åº”ç”¨ä½¿ç”¨ä¸åˆ°90è¡Œä»£ç å®ç°ï¼Œæºä»£ç [é“¾æ¥](https://github.com/wang0618/PyWebIO/blob/dev/demos/chat_room.py)"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    put_scrollable<span class="token punctuation">(</span>put_scope<span class="token punctuation">(</span><span class="token string">'msg-box'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">,</span> keep_bottom<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    nickname <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token builtin">input</span><span class="token punctuation">(</span>t<span class="token punctuation">(</span><span class="token string">"Your nickname"</span><span class="token punctuation">,</span> <span class="token string">"è¯·è¾“å…¥ä½ çš„æ˜µç§°"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> validate<span class="token operator">=</span><span class="token keyword">lambda</span> n<span class="token punctuation">:</span> t<span class="token punctuation">(</span><span class="token string">'This name is already been used'</span><span class="token punctuation">,</span> <span class="token string">'æ˜µç§°å·²è¢«ä½¿ç”¨'</span><span class="token punctuation">)</span> <span class="token keyword">if</span> n <span class="token keyword">in</span> online_users <span class="token keyword">or</span> n <span class="token operator">==</span> <span class="token string">'ğŸ“¢'</span> <span class="token keyword">else</span> <span class="token boolean">None</span><span class="token punctuation">)</span>

    online_users<span class="token punctuation">.</span>add<span class="token punctuation">(</span>nickname<span class="token punctuation">)</span>
    chat_msgs<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'ğŸ“¢'</span><span class="token punctuation">,</span> <span class="token string">'`%s` joins the room. %s users currently online'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>nickname<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>online_users<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    put_markdown<span class="token punctuation">(</span><span class="token string">'`ğŸ“¢`: `%s` join the room. %s users currently online'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>nickname<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>online_users<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sanitize<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> scope<span class="token operator">=</span><span class="token string">'msg-box'</span><span class="token punctuation">)</span>

    <span class="token decorator annotation punctuation">@defer_call</span>
    <span class="token keyword">def</span> <span class="token function">on_close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        online_users<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>nickname<span class="token punctuation">)</span>
        chat_msgs<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'ğŸ“¢'</span><span class="token punctuation">,</span> <span class="token string">'`%s` leaves the room. %s users currently online'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>nickname<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>online_users<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    refresh_task <span class="token operator">=</span> run_async<span class="token punctuation">(</span>refresh_msg<span class="token punctuation">(</span>nickname<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> <span class="token keyword">await</span> input_group<span class="token punctuation">(</span>t<span class="token punctuation">(</span><span class="token string">'Send message'</span><span class="token punctuation">,</span> <span class="token string">'å‘é€æ¶ˆæ¯'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
            <span class="token builtin">input</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'msg'</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span>t<span class="token punctuation">(</span><span class="token string">'Message content supports inline Markdown syntax'</span><span class="token punctuation">,</span> <span class="token string">'æ¶ˆæ¯å†…å®¹æ”¯æŒè¡Œå†…Markdownè¯­æ³•'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            actions<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'cmd'</span><span class="token punctuation">,</span> buttons<span class="token operator">=</span><span class="token punctuation">[</span>t<span class="token punctuation">(</span><span class="token string">'Send'</span><span class="token punctuation">,</span> <span class="token string">'å‘é€'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> t<span class="token punctuation">(</span><span class="token string">'Multiline Input'</span><span class="token punctuation">,</span> <span class="token string">'å¤šè¡Œè¾“å…¥'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token string">'label'</span><span class="token punctuation">:</span> t<span class="token punctuation">(</span><span class="token string">'Exit'</span><span class="token punctuation">,</span> <span class="token string">'é€€å‡º'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token string">'cancel'</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span> validate<span class="token operator">=</span><span class="token keyword">lambda</span> d<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">'msg'</span><span class="token punctuation">,</span> <span class="token string">'Message content cannot be empty'</span><span class="token punctuation">)</span> <span class="token keyword">if</span> d<span class="token punctuation">[</span><span class="token string">'cmd'</span><span class="token punctuation">]</span> <span class="token operator">==</span> t<span class="token punctuation">(</span><span class="token string">'Send'</span><span class="token punctuation">,</span> <span class="token string">'å‘é€'</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token keyword">not</span> d<span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span> <span class="token keyword">else</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> data <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            <span class="token keyword">break</span>
        <span class="token keyword">if</span> data<span class="token punctuation">[</span><span class="token string">'cmd'</span><span class="token punctuation">]</span> <span class="token operator">==</span> t<span class="token punctuation">(</span><span class="token string">'Multiline Input'</span><span class="token punctuation">,</span> <span class="token string">'å¤šè¡Œè¾“å…¥'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            data<span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'\n'</span> <span class="token operator">+</span> <span class="token keyword">await</span> textarea<span class="token punctuation">(</span><span class="token string">'Message content'</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span>t<span class="token punctuation">(</span><span class="token string">'Message content supports Markdown syntax'</span><span class="token punctuation">,</span> <span class="token string">'æ¶ˆæ¯å†…å®¹æ”¯æŒMarkdownè¯­æ³•'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        put_markdown<span class="token punctuation">(</span><span class="token string">'`%s`: %s'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>nickname<span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sanitize<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> scope<span class="token operator">=</span><span class="token string">'msg-box'</span><span class="token punctuation">)</span>
        chat_msgs<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>nickname<span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    refresh_task<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    toast<span class="token punctuation">(</span><span class="token string">"You have left the chat room"</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    start_server<span class="token punctuation">(</span>main<span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/12/63/Y0sImCSO_o.gif" alt=""></p> 
<h4><a id="24__231"></a>2.4 äº”å­æ£‹</h4> 
<pre><code class="prism language-python"><span class="token keyword">import</span> time

<span class="token keyword">from</span> pywebio <span class="token keyword">import</span> session<span class="token punctuation">,</span> start_server
<span class="token keyword">from</span> pywebio<span class="token punctuation">.</span>output <span class="token keyword">import</span> <span class="token operator">*</span>

goboard_size <span class="token operator">=</span> <span class="token number">15</span>
<span class="token comment"># -1 -&gt; none, 0 -&gt; black, 1 -&gt; white</span>
goboard <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> goboard_size
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>goboard_size<span class="token punctuation">)</span>
<span class="token punctuation">]</span>


<span class="token keyword">def</span> <span class="token function">winner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># return winner piece, return None if no winner</span>
    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> goboard_size <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> goboard_size <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># check if (x,y) is the win center</span>
            <span class="token keyword">if</span> goboard<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">and</span> <span class="token builtin">any</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
                <span class="token builtin">all</span><span class="token punctuation">(</span>goboard<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">==</span> goboard<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token keyword">for</span> m<span class="token punctuation">,</span> n <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token builtin">all</span><span class="token punctuation">(</span>goboard<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">==</span> goboard<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token keyword">for</span> m<span class="token punctuation">,</span> n <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token builtin">all</span><span class="token punctuation">(</span>goboard<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">==</span> goboard<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token keyword">for</span> m<span class="token punctuation">,</span> n <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> y <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">,</span> y <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token builtin">all</span><span class="token punctuation">(</span>goboard<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">==</span> goboard<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token keyword">for</span> m<span class="token punctuation">,</span> n <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> y <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">,</span> y <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">'âš«'</span><span class="token punctuation">,</span> <span class="token string">'âšª'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>goboard<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">]</span>


session_id <span class="token operator">=</span> <span class="token number">0</span>          <span class="token comment"># auto incremented id for each session</span>
current_turn <span class="token operator">=</span> <span class="token number">0</span>        <span class="token comment"># 0 for black, 1 for white</span>
player_count <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>   <span class="token comment"># count of player for two roles</span>


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Online Shared Gomoku Game

    A web based Gomoku (AKA GoBang, Five in a Row) game made with PyWebIO under 100 lines of Python code."""</span>
    <span class="token keyword">global</span> session_id<span class="token punctuation">,</span> current_turn<span class="token punctuation">,</span> goboard
    <span class="token keyword">if</span> winner<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># The current game is over, reset game</span>
        goboard <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> goboard_size <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>goboard_size<span class="token punctuation">)</span><span class="token punctuation">]</span>
        current_turn <span class="token operator">=</span> <span class="token number">0</span>

    my_turn <span class="token operator">=</span> session_id <span class="token operator">%</span> <span class="token number">2</span>
    my_chess <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'âš«'</span><span class="token punctuation">,</span> <span class="token string">'âšª'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>my_turn<span class="token punctuation">]</span>
    session_id <span class="token operator">+=</span> <span class="token number">1</span>
    player_count<span class="token punctuation">[</span>my_turn<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>

    <span class="token decorator annotation punctuation">@session<span class="token punctuation">.</span>defer_call</span>
    <span class="token keyword">def</span> <span class="token function">player_exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        player_count<span class="token punctuation">[</span>my_turn<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span>

    session<span class="token punctuation">.</span>set_env<span class="token punctuation">(</span>output_animation<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    put_html<span class="token punctuation">(</span><span class="token triple-quoted-string string">"""&lt;style&gt; table th, table td { padding: 0px !important;} button {padding: .75rem!important; margin:0!important} &lt;/style&gt;"""</span><span class="token punctuation">)</span>  <span class="token comment"># Custom styles to make the board more beautiful</span>

    put_markdown<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"""# Online Shared Gomoku Game
    All online players are assigned to two groups (black and white) and share this game. You can open this page in multiple tabs of your browser to simulate multiple users. This application uses less than 100 lines of code, the source code is [here](https://github.com/wang0618/PyWebIO/blob/dev/demos/gomoku_game.py)
    Currently online player: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>player_count<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string"> for âš«, </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>player_count<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string"> for âšª. Your role is </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>my_chess<span class="token punctuation">}</span></span><span class="token string">.
    """</span></span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">set_stone</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">global</span> current_turn
        <span class="token keyword">if</span> current_turn <span class="token operator">!=</span> my_turn<span class="token punctuation">:</span>
            toast<span class="token punctuation">(</span><span class="token string">"It's not your turn!!"</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'error'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
        x<span class="token punctuation">,</span> y <span class="token operator">=</span> pos
        goboard<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> my_turn
        current_turn <span class="token operator">=</span> <span class="token punctuation">(</span>current_turn <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span>

    <span class="token decorator annotation punctuation">@use_scope</span><span class="token punctuation">(</span><span class="token string">'goboard'</span><span class="token punctuation">,</span> clear<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">show_goboard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        table <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token punctuation">[</span>
                put_buttons<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">dict</span><span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">' '</span><span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'light'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> onclick<span class="token operator">=</span>set_stone<span class="token punctuation">)</span> <span class="token keyword">if</span> cell <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">else</span> <span class="token punctuation">[</span><span class="token string">' âš«'</span><span class="token punctuation">,</span> <span class="token string">' âšª'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>cell<span class="token punctuation">]</span>
                <span class="token keyword">for</span> y<span class="token punctuation">,</span> cell <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
            <span class="token punctuation">]</span>
            <span class="token keyword">for</span> x<span class="token punctuation">,</span> row <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>goboard<span class="token punctuation">)</span>
        <span class="token punctuation">]</span>
        put_table<span class="token punctuation">(</span>table<span class="token punctuation">)</span>

    show_goboard<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token keyword">not</span> winner<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> use_scope<span class="token punctuation">(</span><span class="token string">'msg'</span><span class="token punctuation">,</span> clear<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            current_turn_copy <span class="token operator">=</span> current_turn
            <span class="token keyword">if</span> current_turn_copy <span class="token operator">==</span> my_turn<span class="token punctuation">:</span>
                put_text<span class="token punctuation">(</span><span class="token string">"It's your turn!"</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                put_row<span class="token punctuation">(</span><span class="token punctuation">[</span>put_text<span class="token punctuation">(</span><span class="token string">"Your opponent's turn, waiting... "</span><span class="token punctuation">)</span><span class="token punctuation">,</span> put_loading<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">(</span><span class="token string">'width:1.5em; height:1.5em'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token string">'auto 1fr'</span><span class="token punctuation">)</span>
            <span class="token keyword">while</span> current_turn <span class="token operator">==</span> current_turn_copy <span class="token keyword">and</span> <span class="token keyword">not</span> session<span class="token punctuation">.</span>get_current_session<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>closed<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># wait for next move</span>
                time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
            show_goboard<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">with</span> use_scope<span class="token punctuation">(</span><span class="token string">'msg'</span><span class="token punctuation">,</span> clear<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        put_text<span class="token punctuation">(</span><span class="token string">'Game over. The winner is %s!\nRefresh page to start a new round.'</span> <span class="token operator">%</span> winner<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    start_server<span class="token punctuation">(</span>main<span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8080</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a3/c7/jNATer94_o.gif" alt=""></p> 
<hr> 
<p>ç¨å¾®è¯•äº†è¯•è¿™ä¸ªç¬¬ä¸‰æ–¹åº“ï¼Œæ„Ÿè§‰åŠŸèƒ½ååˆ†çš„å¼ºå¤§ã€‚</p> 
<p>ä¸åªæ˜¯ä¸Šé¢çš„é¡¹ç›®ï¼Œå®ƒè¿˜æœ‰ä¸åŒé£æ ¼ï¼Œèƒ½ç»˜åˆ¶ä¸åŒå›¾è¡¨ï¼Œé›†æˆwebæ¡†æ¶ã€‚</p> 
<p>æœ‰äº†è¿™ä¸ªåº“ï¼Œæˆ‘ä»¬å°±å¯ä»¥è½»æ¾åœ°å°† Python ç¨‹åºå±•ç¤ºåœ¨ç½‘é¡µä¸Šï¼Œä¹Ÿå°±æ˜¯å®ç°ä½¿ç”¨ Python å¼€å‘å‰ç«¯ï¼</p> 
<p>æœ¬æ–‡å°±åˆ°è¿™é‡Œï¼Œå¦‚æœå–œæ¬¢çš„è¯åˆ«æœ›<strong>ç‚¹èµæ”¶è—</strong>ï¼æ‹œ~</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9173cd4b4202848bf8ccc546da10874f/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">Rustå®ç°æ„å»ºå™¨æ¨¡å¼å’Œä½¿ç”¨Bonåº“ä¸­çš„æ„å»ºå™¨</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a5e160c6490c0ac98f7a49d2a6ae8156/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">ä¿ç ”è€ƒç ”æœºè¯•æ”»ç•¥ï¼šç¬¬äºŒç« â€”â€”å…¥é—¨ç»å…¸ï¼ˆ2ï¼‰</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§å’–.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>