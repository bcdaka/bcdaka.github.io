<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>AI 绘画Stable Diffusion 研究（十五）SD Embedding详解 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/6ea2e792ca48f3fcf95723c294febf3a/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="AI 绘画Stable Diffusion 研究（十五）SD Embedding详解">
  <meta property="og:description" content="大家好，我是风雨无阻。
本期内容：
Embedding是什么？Embedding有什么作用？Embedding如何下载安装？如何使用Embedding？ 大家还记得 AI 绘画Stable Diffusion 研究（七） 一文读懂 Stable Diffusion 工作原理 这篇文章中，曾提到过词嵌入（Embedding）吗？
我们来简单回顾一下：Embedding 将输入的tokens转换为一个连续的向量，然后stable diffusion再将 Embedding 向量 通过text transformer转换后，作为模型输入，进行训练。
那在上一篇中只是简单提到了Embedding， 对于我们实际使用stable diffusion过程中，可能很多朋友对Embedding的概念还不是很清楚。今天我们就来详细介绍一下Embedding， 它到底是干嘛的？有什么作用？以及应该怎么安装和使用Embedding ？
一、Embedding 的介绍
1、Embedding是什么？
Embedding 又名 textual inversion 中文名：“嵌入或文本反转”。
在计算机科学中，Embedding是将高维数据映射到低维空间的过程。
在图像处理中，Embedding通常用于将图像转换为向量表示，以便进行机器学习和深度学习任务。
在使用stable diffusion进行绘画时，Embedding可以用于将输入的图像转换为向量表示，以便于算法对其进行处理和生成新的图像。这种技术可以使算法更加高效地处理图像数据，并提高生成图像的质量和准确性。
2、Embedding有什么作用？
通俗来讲，Embedding 的作用就是对提示词进行打包。
如果你有做 UI 的经验，那么应该知道组件的概念。
在 Stable Diffusion 中，Embedding 技术就可以被理解为一种组件，它可以将输入数据转换成向量表示，方便模型进行处理和生成。
在日常使用中，Embedding 技术通常用于控制人物的动作和特征，或者生成特定的画风。
我们来举例，思考一个问题：
如果我们直接使用原版本的stable diffusion 文生图功能， 不使用stable diffusion 任何插件，我们应该怎么来生成如下的图片呢？
想必大家首先想到的是，写一大堆的提示词来进行控制生成，类似例如：
masterpiece, high-quality,1girl,clothes with Pink pattern,(brown hair), pinkearphones, green pattern on the earphones, blue tights, white gloves, ((pinkpattern on the clothes)), cat pattern on the face, detailed eyes, (pink theme), rabbitdecoration on the chest, green word pattern, sewing line on the clothes, long hair.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-08-24T21:56:22+08:00">
    <meta property="article:modified_time" content="2023-08-24T21:56:22+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">AI 绘画Stable Diffusion 研究（十五）SD Embedding详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <br> 
<p>大家好，我是风雨无阻。</p> 
<p><strong>本期内容：</strong></p> 
<ul><li>Embedding是什么？</li><li>Embedding有什么作用？</li><li>Embedding如何下载安装？</li><li>如何使用Embedding？</li></ul> 
<br> 
<p>大家还记得 <a href="https://blog.csdn.net/lizhong2008/article/details/132257722">AI 绘画Stable Diffusion 研究（七） 一文读懂 Stable Diffusion 工作原理</a> 这篇文章中，曾提到过词嵌入（Embedding）吗？</p> 
<br> 
<p>我们来简单回顾一下：Embedding 将输入的tokens转换为一个连续的向量，然后stable diffusion再将 Embedding 向量 通过<code>text transformer</code>转换后，作为模型输入，进行训练。</p> 
<br> 
<p>那在上一篇中只是简单提到了Embedding， 对于我们实际使用stable diffusion过程中，可能很多朋友对Embedding的概念还不是很清楚。今天我们就来详细介绍一下Embedding， 它到底是干嘛的？有什么作用？以及应该怎么安装和使用Embedding ？</p> 
<br> 
<p><strong>一、Embedding 的介绍</strong></p> 
<br> 
<p><strong>1、Embedding是什么？</strong></p> 
<br> 
<p>Embedding 又名 textual inversion 中文名：“嵌入或文本反转”。</p> 
<p>在计算机科学中，Embedding是将高维数据映射到低维空间的过程。</p> 
<p>在图像处理中，Embedding通常用于将图像转换为向量表示，以便进行机器学习和深度学习任务。</p> 
<br> 
<p>在使用stable diffusion进行绘画时，Embedding可以用于将输入的图像转换为向量表示，以便于算法对其进行处理和生成新的图像。这种技术可以使算法更加高效地处理图像数据，并提高生成图像的质量和准确性。</p> 
<br> 
<p><strong>2、Embedding有什么作用？</strong></p> 
<br> 
<p>通俗来讲，Embedding 的作用就是对提示词进行打包。</p> 
<p>如果你有做 UI 的经验，那么应该知道组件的概念。</p> 
<p>在 Stable Diffusion 中，Embedding 技术就可以被理解为一种组件，它可以将输入数据转换成向量表示，方便模型进行处理和生成。</p> 
<p>在日常使用中，Embedding 技术通常用于控制人物的动作和特征，或者生成特定的画风。</p> 
<br> 
<p>我们来举例，思考一个问题：</p> 
<p>如果我们直接使用原版本的stable diffusion 文生图功能， 不使用stable diffusion 任何插件，我们应该怎么来生成如下的图片呢？</p> 
<br> 
<p><img src="https://images2.imgbox.com/53/22/ZOVjijKo_o.png" alt="在这里插入图片描述"></p> 
<br> 
<p>想必大家首先想到的是，写一大堆的提示词来进行控制生成，类似例如：</p> 
<pre><code>masterpiece, high-quality,1girl,clothes with Pink pattern,(brown hair), pinkearphones, green pattern on the earphones, blue tights, white gloves, ((pinkpattern on the clothes)), cat pattern on the face, detailed eyes, (pink theme), rabbitdecoration on the chest, green word pattern, sewing line on the clothes, long hair.thin girl, delicate face, beautiful face, melon face, skin full of details, pinkbackground, white gloves, thin neck, Sexy figure, (brown eyes:1.2), smile, wearingwhite shoes, green patterns, blushing,.....以下省略N个tag
</code></pre> 
<br> 
<p>但是，如果我们引入Embedding 后，只需要如下的提示词就可以生成上面的图：</p> 
<pre><code> masterpiece, high-quality,corneo dva
</code></pre> 
<br> 
<p>通过上面的问题，相信大家已经对 Embedding 的作用有所理解了吧。</p> 
<br> 
<p><strong>3、Embedding 的特点</strong></p> 
<br> 
<p>相比于其他模型来说（如 LORA），Embedding 文件的大小只有几十 KB。</p> 
<p>除了还原度对比 LORA 差一些外，在存储和使用上却更方便。</p> 
<br> 
<p><strong>总而言之：</strong></p> 
<p>Embedding 技术将输入数据转换为向量表示，为模型的处理和生成提供了便利。</p> 
<p>通过使用 Embedding，我们可以更加轻松地生成符合预期的样本，而不需要手动输入大量的描述词汇。</p> 
<br> 
<p><strong>二、Embedding下载和安装</strong></p> 
<br> 
<p>既然Embedding 这么便利，我们一定得好好用起来，那么在哪里可以下载呢？</p> 
<p>主要还是在<a href="https://civitai.com/" rel="nofollow">c站</a>下载。</p> 
<p>接下来，就跟着我的演示步骤，实际操作一下吧。</p> 
<br> 
<p><strong>第一步，打开<a href="https://civitai.com/" rel="nofollow">c站</a>，搜索 Embedding</strong></p> 
<br> 
<p><img src="https://images2.imgbox.com/2a/59/fm7xWog8_o.png" alt="在这里插入图片描述"></p> 
<br> 
<p><strong>第二步，选择喜欢的Embedding 下载</strong></p> 
<br> 
<p>这里演示，我们选择这个骑马的外星人，点击“Download”下载：</p> 
<p><img src="https://images2.imgbox.com/01/1a/dXhBXkCq_o.png" alt="在这里插入图片描述"></p> 
<br> 
<p>下载后，我们得到 16-token-negative-deliberate-neg.pt 这个文件。</p> 
<br> 
<p><strong>第三步 Embedding安装</strong></p> 
<br> 
<p>将文件 16-token-negative-deliberate-neg.pt 拷贝到 sd-webui-aki-v4.2\embeddings 目录下。</p> 
<br> 
<pre><code>\sd-webui-aki-v4.2\embeddings
</code></pre> 
<br> 
<p><img src="https://images2.imgbox.com/b6/02/qjY7lYI9_o.png" alt="在这里插入图片描述"></p> 
<p>记得重启stable diffusion 才能生效。</p> 
<br> 
<p><strong>三、Embedding 的使用</strong></p> 
<br> 
<p><strong>1、功能栏区域，选择文生图，然后选择右侧生成按钮下方 “显示/隐藏扩展模型” 图标</strong></p> 
<br> 
<p>如图：</p> 
<p><img src="https://images2.imgbox.com/b3/da/nwSrwT82_o.png" alt="在这里插入图片描述"></p> 
<br> 
<p>切换到嵌入式 （Enbedding）标签页面 ：</p> 
<p><img src="https://images2.imgbox.com/85/47/WFgVoYsS_o.png" alt="在这里插入图片描述"></p> 
<br> 
<p><strong>2、根据 Enbedding 模型演示图片 参数进行设置</strong></p> 
<br> 
<ul><li> <p>正向提示词输入</p> <pre><code>an astronaut riding a horse on the moon, 8k uhd
</code></pre> <br> </li><li> <p>反向提示词输入</p> <pre><code>3d render
</code></pre> </li></ul> 
<br> 
<ul><li>选择下方刚刚安装的Enbedding ： 16-token-negative-deliberate-neg</li></ul> 
<br> 
<p><img src="https://images2.imgbox.com/ec/b6/3Kfv4jrh_o.png" alt="在这里插入图片描述"></p> 
<br> 
<p>反向提示词输入框中会自动添加 16-token-negative-deliberate-neg 模型提示词</p> 
<br> 
<p>如图：</p> 
<p><img src="https://images2.imgbox.com/8c/e9/9xlfbLUY_o.png" alt="在这里插入图片描述"></p> 
<br> 
<ul><li> <p>采样方法设置 ： Euler</p> </li><li> <p>迭代步数设置：50</p> </li><li> <p>勾选高清分辨率修复</p> </li><li> <p>随机种子设置：43</p> <br> </li></ul> 
<p><img src="https://images2.imgbox.com/49/45/CE7M9O4r_o.png" alt="在这里插入图片描述"></p> 
<br> 
<p><strong>4、点击“生成”按钮，查看效果</strong></p> 
<br> 
<p><img src="https://images2.imgbox.com/9e/63/iuMdI55v_o.png" alt="在这里插入图片描述"></p> 
<br> 
<p>由此可见 Embedding真是一个很有用东西，通过简单的一个提示词就作出有自己特色的作品，感兴趣的朋友赶快玩起来吧～</p> 
<br>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bf1dedafd76e602050cb2c4dbd1e24a9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【错误记录】Android Studio 中 Kotlin 版本报错 ( Module was compiled with an incompatible version of Kotlin. T )</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f3dd078b180290da24896badb16abc9c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">提高Stable Diffusion十倍计算速度以及解决内存崩溃问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>