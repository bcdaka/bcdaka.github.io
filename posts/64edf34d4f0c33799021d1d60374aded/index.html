<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【QT】Qt 文件操作 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/64edf34d4f0c33799021d1d60374aded/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【QT】Qt 文件操作">
  <meta property="og:description" content="qt 文件 qt 文件1. Qt 文件概述2. 输入输出设备类3. 文件读写类4. 文件和目录信息类 qt 文件 1. Qt 文件概述 文件操作是应用程序必不可少的部分。Qt 作为⼀个通用开发库，提供了跨平台的文件操作能力。 Qt 提供了很多关于文件的类，通过这些类能够对文件系统进行操作，如文件读写、文件信息获取、文件复制或重命名等。
2. 输入输出设备类 在 Qt 中，文件读写的类为 QFile 。QFile 的父类为 QFileDevice ，QFileDevice 提供了文件交互操作的底层功能。 QFileDevice 的父类是 QIODevice，QIODevice 的父类为 QObject 。
QIODevice 是 Qt 中所有输入输出设备（input/output device，简称 I/O 设备）的基础类，I/O 设备就是能进行数据输入和输出的设备，例如文件是⼀种 I/O 设备，网络通信中的 socket 是 I/O 设备， 串口、蓝牙等通信接口也是 I/O 设备，所以它们也是从 QIODevice 继承来的。Qt 中主要的一些 I/O 设备类的继承关系如下图所示：
上图中各类的说明如下：
QFile 是用于文件操作和文件数据读写的类，使用 QFile 可以读写任意格式的文件QSaveFile 是用于安全保存文件的类。使⽤ QSaveFile 保存文件时，它会先把数据写⼊一个临时文件，成功提交后才将数据写入最终的文件。如果保存过程中出现错误，临时文件里的数据不会被写入最终文件，这样就能确保最终文件中不会丢失数据或被写入部分数据。 在保存比较打的文件或复杂格式的文件时可以使用这个类，例如从网络上下载文件等QTemporaryFile 是用于创建临时文件的类。使用函数 QTemporaryFile::open() 就能创建一个文件名唯一的临时文件，在 QTemporaryFile 对象被删除时，临时文件被自动删除QTcpSocket 和 QUdpSocket 是分别实现了 TCP 和 UDP 的类QSerialPort 是实现了串口通信的类，通过这个类可以实现计算机与串口设备的通信QBluetoothSocket 是用于蓝牙通信的类。手机和平板计算机等移动设备有蓝牙通信模块，笔记本电脑⼀般也有蓝牙通信模块。通过 QBluetoothSocket 类，就可以编写蓝牙通信程。如编程实现笔记本电脑与手机的蓝牙通信QProcess 类用于启动外部程序，并且可以给程序传递参数QBuffer 以⼀个 QByteArray 对象作为数据缓冲区，将 QByteArray 对象当作⼀个 I/O 设备来读写 3.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-02T20:47:21+08:00">
    <meta property="article:modified_time" content="2024-08-02T20:47:21+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【QT】Qt 文件操作</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>qt 文件</h4> 
 <ul><li><a href="#qt__3" rel="nofollow">qt 文件</a></li><li><ul><li><a href="#1_Qt__5" rel="nofollow">1. Qt 文件概述</a></li><li><a href="#2__11" rel="nofollow">2. 输入输出设备类</a></li><li><a href="#3__35" rel="nofollow">3. 文件读写类</a></li><li><a href="#4__129" rel="nofollow">4. 文件和目录信息类</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="qt__3"></a>qt 文件</h2> 
<h3><a id="1_Qt__5"></a>1. Qt 文件概述</h3> 
<p>文件操作是应用程序必不可少的部分。Qt 作为⼀个通用开发库，提供了跨平台的文件操作能力。 Qt 提供了很多关于文件的类，通过这些类能够对文件系统进行操作，如文件读写、文件信息获取、文件复制或重命名等。</p> 
<h3><a id="2__11"></a>2. 输入输出设备类</h3> 
<p>在 Qt 中，文件读写的类为 <strong>QFile</strong> 。<strong>QFile</strong> 的父类为 <strong>QFileDevice</strong> ，<strong>QFileDevice</strong> 提供了文件交互操作的底层功能。 <strong>QFileDevice</strong> 的父类是 <strong>QIODevice</strong>，<strong>QIODevice</strong> 的父类为 <strong>QObject</strong> 。</p> 
<p><strong>QIODevice</strong> 是 Qt 中所有输入输出设备（input/output device，简称 I/O 设备）的基础类，I/O 设备就是能进行数据输入和输出的设备，例如文件是⼀种 I/O 设备，网络通信中的 <strong>socket</strong> 是 I/O 设备， 串口、蓝牙等通信接口也是 I/O 设备，所以它们也是从 <strong>QIODevice</strong> 继承来的。Qt 中主要的一些 I/O 设备类的继承关系如下图所示：</p> 
<p><img src="https://images2.imgbox.com/c0/1f/MMhsTNcr_o.png" alt="在这里插入图片描述"></p> 
<p>上图中各类的说明如下：</p> 
<ul><li><strong>QFile</strong> 是用于文件操作和文件数据读写的类，使用 <strong>QFile</strong> 可以读写任意格式的文件</li><li><strong>QSaveFile</strong> 是用于安全保存文件的类。使⽤ <strong>QSaveFile</strong> 保存文件时，它会先把数据写⼊一个临时文件，成功提交后才将数据写入最终的文件。如果保存过程中出现错误，临时文件里的数据不会被写入最终文件，这样就能确保最终文件中不会丢失数据或被写入部分数据。 在保存比较打的文件或复杂格式的文件时可以使用这个类，例如从网络上下载文件等</li><li><strong>QTemporaryFile</strong> 是用于创建临时文件的类。使用函数 <strong>QTemporaryFile::open()</strong> 就能创建一个文件名唯一的临时文件，在 <strong>QTemporaryFile</strong> 对象被删除时，临时文件被自动删除</li><li><strong>QTcpSocket</strong> 和 <strong>QUdpSocket</strong> 是分别实现了 TCP 和 UDP 的类</li><li><strong>QSerialPort</strong> 是实现了串口通信的类，通过这个类可以实现计算机与串口设备的通信</li><li><strong>QBluetoothSocket</strong> 是用于蓝牙通信的类。手机和平板计算机等移动设备有蓝牙通信模块，笔记本电脑⼀般也有蓝牙通信模块。通过 <strong>QBluetoothSocket</strong> 类，就可以编写蓝牙通信程。如编程实现笔记本电脑与手机的蓝牙通信</li><li><strong>QProcess</strong> 类用于启动外部程序，并且可以给程序传递参数</li><li><strong>QBuffer</strong> 以⼀个 <strong>QByteArray</strong> 对象作为数据缓冲区，将 <strong>QByteArray</strong> 对象当作⼀个 I/O 设备来读写</li></ul> 
<h3><a id="3__35"></a>3. 文件读写类</h3> 
<p>在 Qt 中，文件的读写主要是通过 <strong>QFile</strong> 类来实现。在 <strong>QFile</strong> 类中提供了一些用来读写文件的方法。对于文件的操作主要有：</p> 
<ul><li>读数据：<strong>QFile</strong> 类中提供了多个方法用于读取文件内容；如 <strong>read()</strong>、<strong>readAll()</strong>、<strong>readLine()</strong> 等</li><li>写数据：<strong>QFile</strong> 类中提供了多个方法⽤于往文件中写内容；如 <strong>write()</strong>、**writeData()**等</li><li>关闭文件：文件使用结束后必须用函数 <strong>close()</strong> 关闭文件</li></ul> 
<p>访问⼀个设备之前，需要使⽤ <strong>open()</strong> 函数打开该设备，⽽且必须指定正确的打开模式，<strong>QIODevice</strong> 中所有的打开模式由 <strong>QIODevice::OpenMode</strong> 枚举变量定义，其取值如下：</p> 
<p><img src="https://images2.imgbox.com/03/a5/7hsbr9fR_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/02/63/Q3kCiTkl_o.png" alt="在这里插入图片描述"></p> 
<p><strong>示例代码：读取文件内容</strong></p> 
<ol><li>新建 Qt 项⽬，在 UI ⽂件中拖⼊⼀个 LineEdit，⼀个pushButton，⼀个 TextEdit。当点击按钮时，弹出窗⼝选择要读取的⽂件，并将读取到的内容在 TextEdit 中显⽰；</li></ol> 
<p><img src="https://images2.imgbox.com/6d/f9/tYbLCIZ8_o.png" alt="在这里插入图片描述"></p> 
<ol start="2"><li> <p>在 “widget.cpp” ⽂件中实现对应功能；</p> <pre><code> 		#include &lt;QFileDialog&gt;
 		
 		Widget::Widget(QWidget *parent)
 		    : QWidget(parent)
 		    , ui(new Ui::Widget)
 		{
 		    ui-&gt;setupUi(this);
 		    connect(ui-&gt;pushButton, &amp;QPushButton::clicked, [=](){
 		        QString path = QFileDialog::getOpenFileName(this, "打开文件", "D:\\QtProject");
 		        ui-&gt;lineEdit-&gt;setText(path);
 		
 		        QFile file(path); // path 代表文件路径
 		
 		        // 打开文件
 		        file.open(QIODevice::ReadOnly); // 以只读的方式打开文件
 		
 		        QString str = file.readAll();
 		
 		        ui-&gt;textEdit-&gt;setText(str);
 		
 		        // 关闭文件
 		        file.close();
 		    });
 		}
</code></pre> </li></ol> 
<p>实现效果如下，点击选取文件时，就会在 <strong>D:\QtProject</strong> 路径下打开文件夹，继续选取具体的文件就会将选取到的文件读取到 textEdit 中：</p> 
<p><img src="https://images2.imgbox.com/2b/16/Csf95mfp_o.png" alt="在这里插入图片描述"></p> 
<p><strong>示例代码2：写文件</strong></p> 
<p>在上述示例代码的基础上修改 “widget.cpp” 文件:</p> 
<pre><code>			Widget::Widget(QWidget *parent)
			    : QWidget(parent)
			    , ui(new Ui::Widget)
			{
			    ui-&gt;setupUi(this);
			    connect(ui-&gt;pushButton, &amp;QPushButton::clicked, [=](){
			        QString path = QFileDialog::getOpenFileName(this, "打开文件", "D:\\QtProject");
			        ui-&gt;lineEdit-&gt;setText(path);
			
			        QFile file(path); // path 代表文件路径
			
			        // 写文件
			        // 打开文件，进行写操作
			        file.open(QIODevice::Append); // 以追加的方式进行写
			        file.write("bbbbbbbbbbb");
			
			        // 关闭文件
			        file.close();
			    });
			}
</code></pre> 
<p>执行效果如下，先选取上面的 1.txt 文件，然后再打开该文件的时候，就会发现后面已经加上了对应的内容：</p> 
<p><img src="https://images2.imgbox.com/49/27/pwwdSrue_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4__129"></a>4. 文件和目录信息类</h3> 
<p><strong>QFileInfo</strong> 是 Qt 提供的一个用于获取文件和目录信息的类，如获取文件名、文件大小、文件修改日期等。<strong>QFileInfo</strong> 类中提供了很多的方法，常用的有：</p> 
<ul><li><strong>isDir()</strong> 检查该文件是否是目录；</li><li><strong>isExecutable()</strong> 检查该文件是否是可执行文件；</li><li><strong>fileName()</strong> 获得文件名；</li><li><strong>completeBaseName()</strong> 获取完整的文件名；</li><li><strong>suffix()</strong> 获取文件后缀名；</li><li><strong>completeSuffix()</strong> 获取完整的文件后缀；</li><li><strong>size()</strong> 获取文件大小；</li><li><strong>isFile()</strong> 判断是否为文件；</li><li><strong>fileTime()</strong> 获取文件创建时间、修改时间、最近访问时间等；</li></ul> 
<p><strong>示例代码：</strong></p> 
<p>在 “widget.cpp” 文件中添加如下代码：</p> 
<pre><code>			#include &lt;QFileDialog&gt;
			#include &lt;QFileInfo&gt;
			#include &lt;QDebug&gt;
			#include &lt;QDateTime&gt;
			
			Widget::Widget(QWidget *parent)
			    : QWidget(parent)
			    , ui(new Ui::Widget)
			{
			    ui-&gt;setupUi(this);
			    connect(ui-&gt;pushButton, &amp;QPushButton::clicked, [=](){
			        QString path = QFileDialog::getOpenFileName(this, "打开文件", "D:\\QtProject");
			
			        // QFileInfo 文件信息类
			        QFileInfo fileinfo(path);
			
			        // 文件名
			        qDebug() &lt;&lt; "文件名为: " &lt;&lt; fileinfo.fileName().toUtf8().data();
			
			        // 文件后缀名
			        qDebug() &lt;&lt; "文件后缀名为: " &lt;&lt; fileinfo.suffix().toUtf8().data();
			
			        // 文件大小
			        qDebug() &lt;&lt; "文件大小为: " &lt;&lt; fileinfo.size();
			
			        // 文件路径
			        qDebug() &lt;&lt; "文件路径为: " &lt;&lt; fileinfo.path().toUtf8().data();
			
			        // 判断是否为文件
			        qDebug() &lt;&lt; "是否为文件: " &lt;&lt; fileinfo.isFile();
			
			        // 文件创建时间
			        QDateTime time1 = fileinfo.fileTime(QFileDevice::FileBirthTime);
			        qDebug() &lt;&lt; "创建时间为: " &lt;&lt; time1.toString("yyyy-MM-dd hh:mm:ss").toUtf8().data();
			
			        // 文件最后修改时间
			        QDateTime time2 = fileinfo.lastModified();
			        qDebug() &lt;&lt; "最后修改时间为: " &lt;&lt; time2.toString("yyyy-MM-dd hh:mm:ss").toUtf8().data();
			
			        // 判断是否为文件夹
			        qDebug() &lt;&lt; "是否为文件夹: " &lt;&lt; fileinfo.isDir();
			    });
			}
</code></pre> 
<p>我们打开 1.txt 文件后打印的信息如下：</p> 
<p><img src="https://images2.imgbox.com/a8/02/PNz9YYuC_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/57fc2a7c4fc7cd1f327ea9fddf46bb9a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">B&#43;树与B*树：扩展B树的高级应用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/54729870629ba044ce1d4b8fbca1061d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">GoLang 安装</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>