<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python酷库之旅-第三方库openpyxl(20) - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/6acefca7a7be9a5bf3c56e16c2bb60bb/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Python酷库之旅-第三方库openpyxl(20)">
  <meta property="og:description" content="目录
一、 openpyxl库的由来
1、背景
2、起源
3、发展
4、特点
4-1、支持.xlsx格式
4-2、读写Excel文件
4-3、操作单元格
4-4、创建和修改工作表
4-5、样式设置
4-6、图表和公式
4-7、支持数字和日期格式
二、openpyxl库的优缺点
1、优点
1-1、支持现代Excel格式
1-2、功能丰富
1-3、易于使用
1-4、与Excel兼容性
1-5、性能良好
1-6、社区支持
1-7、跨平台
2、缺点
2-1、不支持旧版格式
2-2、某些特性支持有限
2-3、内存占用
2-4、文档和示例可能不足
2-5、依赖关系
2-6、学习曲线
三、openpyxl库的用途
1、读取Excel文件
2、写入Excel文件
3、修改Excel文件
4、自动化
5、与Excel交互
6、数据迁移和转换
7、创建模板化的报告
四、如何学好openpyxl库？
1、获取openpyxl库的属性和方法
2、获取openpyxl库的帮助信息
3、实战案例
3-241、设置单元格区域的除对角框线以外的全部边框
3-242、删除单元格区域的全部边框
3-243、设置单元格的颜色和背景
3-244、设置单元格的格式
3-245、设置单元格的对齐方式
3-246、缩小单元格内容以全部显示
3-247、设定/删除单元格的输入规则和信息提示(有效性设置)
3-248、为单元格设置条件格式/删除条件格式
3-249、为单元格插入指向工作簿内部的超链接/删除超链接
3-250、为单元格插入指向工作簿外部的超链接/删除超链接
3-251、为单元格添加批注/删除批注
3-252、修改单元格的批注
3-253、为单元格区域定义名称/删除名称(Name属性)
3-254、为单元格区域定义名称/删除名称(Add方法)
3-255、自动调整单元格大小
3-256、自动调整工作表全部单元格的大小
3-257、设置单元格的大小(以磅为单位)
3-258、设置单元格的大小(以cm为单位)
3-259、设置单元格的大小(以in为单位)
3-260、锁定单元格/解除单元格锁定
五、推荐阅读
1、Python筑基之旅
2、Python函数之旅
3、Python算法之旅
4、Python魔法之旅
5、博客个人主页
一、 openpyxl库的由来 openpyxl库的由来可以总结为以下几点：">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-02T07:33:18+08:00">
    <meta property="article:modified_time" content="2024-07-02T07:33:18+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python酷库之旅-第三方库openpyxl(20)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong><span style="color:#1a439c;">目录</span></strong></p> 
<p id="%E4%B8%80%E3%80%81%20openpyxl%E5%BA%93%E7%9A%84%E7%94%B1%E6%9D%A5-toc" style="margin-left:80px;"><strong><a href="#%E4%B8%80%E3%80%81%20openpyxl%E5%BA%93%E7%9A%84%E7%94%B1%E6%9D%A5" rel="nofollow"><span style="color:#1a439c;">一、 openpyxl库的由来</span></a></strong></p> 
<p id="1%E3%80%81%E8%83%8C%E6%99%AF-toc" style="margin-left:120px;"><strong><a href="#1%E3%80%81%E8%83%8C%E6%99%AF" rel="nofollow"><span style="color:#1a439c;">1、背景</span></a></strong></p> 
<p id="2%E3%80%81%E8%B5%B7%E6%BA%90-toc" style="margin-left:120px;"><strong><a href="#2%E3%80%81%E8%B5%B7%E6%BA%90" rel="nofollow"><span style="color:#1a439c;">2、起源</span></a></strong></p> 
<p id="3%E3%80%81%E5%8F%91%E5%B1%95-toc" style="margin-left:120px;"><strong><a href="#3%E3%80%81%E5%8F%91%E5%B1%95" rel="nofollow"><span style="color:#1a439c;">3、发展</span></a></strong></p> 
<p id="4%E3%80%81%E7%89%B9%E7%82%B9-toc" style="margin-left:120px;"><strong><a href="#4%E3%80%81%E7%89%B9%E7%82%B9" rel="nofollow"><span style="color:#1a439c;">4、特点</span></a></strong></p> 
<p id="4-1%E3%80%81%E6%94%AF%E6%8C%81.xlsx%E6%A0%BC%E5%BC%8F-toc" style="margin-left:160px;"><strong><a href="#4-1%E3%80%81%E6%94%AF%E6%8C%81.xlsx%E6%A0%BC%E5%BC%8F" rel="nofollow"><span style="color:#1a439c;">4-1、支持.xlsx格式</span></a></strong></p> 
<p id="4-2%E3%80%81%E8%AF%BB%E5%86%99Excel%E6%96%87%E4%BB%B6-toc" style="margin-left:160px;"><strong><a href="#4-2%E3%80%81%E8%AF%BB%E5%86%99Excel%E6%96%87%E4%BB%B6" rel="nofollow"><span style="color:#1a439c;">4-2、读写Excel文件</span></a></strong></p> 
<p id="4-3%E3%80%81%E6%93%8D%E4%BD%9C%E5%8D%95%E5%85%83%E6%A0%BC-toc" style="margin-left:160px;"><strong><a href="#4-3%E3%80%81%E6%93%8D%E4%BD%9C%E5%8D%95%E5%85%83%E6%A0%BC" rel="nofollow"><span style="color:#1a439c;">4-3、操作单元格</span></a></strong></p> 
<p id="4-4%E3%80%81%E5%88%9B%E5%BB%BA%E5%92%8C%E4%BF%AE%E6%94%B9%E5%B7%A5%E4%BD%9C%E8%A1%A8-toc" style="margin-left:160px;"><strong><a href="#4-4%E3%80%81%E5%88%9B%E5%BB%BA%E5%92%8C%E4%BF%AE%E6%94%B9%E5%B7%A5%E4%BD%9C%E8%A1%A8" rel="nofollow"><span style="color:#1a439c;">4-4、创建和修改工作表</span></a></strong></p> 
<p id="4-5%E3%80%81%E6%A0%B7%E5%BC%8F%E8%AE%BE%E7%BD%AE-toc" style="margin-left:160px;"><strong><a href="#4-5%E3%80%81%E6%A0%B7%E5%BC%8F%E8%AE%BE%E7%BD%AE" rel="nofollow"><span style="color:#1a439c;">4-5、样式设置</span></a></strong></p> 
<p id="4-6%E3%80%81%E5%9B%BE%E8%A1%A8%E5%92%8C%E5%85%AC%E5%BC%8F-toc" style="margin-left:160px;"><strong><a href="#4-6%E3%80%81%E5%9B%BE%E8%A1%A8%E5%92%8C%E5%85%AC%E5%BC%8F" rel="nofollow"><span style="color:#1a439c;">4-6、图表和公式</span></a></strong></p> 
<p id="4-7%E3%80%81%E6%94%AF%E6%8C%81%E6%95%B0%E5%AD%97%E5%92%8C%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F-toc" style="margin-left:160px;"><strong><a href="#4-7%E3%80%81%E6%94%AF%E6%8C%81%E6%95%B0%E5%AD%97%E5%92%8C%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F" rel="nofollow"><span style="color:#1a439c;">4-7、支持数字和日期格式</span></a></strong></p> 
<p id="%E4%BA%8C%E3%80%81openpyxl%E5%BA%93%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9-toc" style="margin-left:80px;"><strong><a href="#%E4%BA%8C%E3%80%81openpyxl%E5%BA%93%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9" rel="nofollow"><span style="color:#1a439c;">二、openpyxl库的优缺点</span></a></strong></p> 
<p id="1%E3%80%81%E4%BC%98%E7%82%B9-toc" style="margin-left:120px;"><strong><a href="#1%E3%80%81%E4%BC%98%E7%82%B9" rel="nofollow"><span style="color:#1a439c;">1、优点</span></a></strong></p> 
<p id="1-1%E3%80%81%E6%94%AF%E6%8C%81%E7%8E%B0%E4%BB%A3Excel%E6%A0%BC%E5%BC%8F-toc" style="margin-left:160px;"><strong><a href="#1-1%E3%80%81%E6%94%AF%E6%8C%81%E7%8E%B0%E4%BB%A3Excel%E6%A0%BC%E5%BC%8F" rel="nofollow"><span style="color:#1a439c;">1-1、支持现代Excel格式</span></a></strong></p> 
<p id="1-2%E3%80%81%E5%8A%9F%E8%83%BD%E4%B8%B0%E5%AF%8C-toc" style="margin-left:160px;"><strong><a href="#1-2%E3%80%81%E5%8A%9F%E8%83%BD%E4%B8%B0%E5%AF%8C" rel="nofollow"><span style="color:#1a439c;">1-2、功能丰富</span></a></strong></p> 
<p id="1-3%E3%80%81%E6%98%93%E4%BA%8E%E4%BD%BF%E7%94%A8-toc" style="margin-left:160px;"><strong><a href="#1-3%E3%80%81%E6%98%93%E4%BA%8E%E4%BD%BF%E7%94%A8" rel="nofollow"><span style="color:#1a439c;">1-3、易于使用</span></a></strong></p> 
<p id="1-4%E3%80%81%E4%B8%8EExcel%E5%85%BC%E5%AE%B9%E6%80%A7-toc" style="margin-left:160px;"><strong><a href="#1-4%E3%80%81%E4%B8%8EExcel%E5%85%BC%E5%AE%B9%E6%80%A7" rel="nofollow"><span style="color:#1a439c;">1-4、与Excel兼容性</span></a></strong></p> 
<p id="1-5%E3%80%81%E6%80%A7%E8%83%BD%E8%89%AF%E5%A5%BD-toc" style="margin-left:160px;"><strong><a href="#1-5%E3%80%81%E6%80%A7%E8%83%BD%E8%89%AF%E5%A5%BD" rel="nofollow"><span style="color:#1a439c;">1-5、性能良好</span></a></strong></p> 
<p id="1-6%E3%80%81%E7%A4%BE%E5%8C%BA%E6%94%AF%E6%8C%81-toc" style="margin-left:160px;"><strong><a href="#1-6%E3%80%81%E7%A4%BE%E5%8C%BA%E6%94%AF%E6%8C%81" rel="nofollow"><span style="color:#1a439c;">1-6、社区支持</span></a></strong></p> 
<p id="1-7%E3%80%81%E8%B7%A8%E5%B9%B3%E5%8F%B0-toc" style="margin-left:160px;"><strong><a href="#1-7%E3%80%81%E8%B7%A8%E5%B9%B3%E5%8F%B0" rel="nofollow"><span style="color:#1a439c;">1-7、跨平台</span></a></strong></p> 
<p id="2%E3%80%81%E7%BC%BA%E7%82%B9-toc" style="margin-left:120px;"><strong><a href="#2%E3%80%81%E7%BC%BA%E7%82%B9" rel="nofollow"><span style="color:#1a439c;">2、缺点</span></a></strong></p> 
<p id="2-1%E3%80%81%E4%B8%8D%E6%94%AF%E6%8C%81%E6%97%A7%E7%89%88%E6%A0%BC%E5%BC%8F-toc" style="margin-left:160px;"><strong><a href="#2-1%E3%80%81%E4%B8%8D%E6%94%AF%E6%8C%81%E6%97%A7%E7%89%88%E6%A0%BC%E5%BC%8F" rel="nofollow"><span style="color:#1a439c;">2-1、不支持旧版格式</span></a></strong></p> 
<p id="2-2%E3%80%81%E6%9F%90%E4%BA%9B%E7%89%B9%E6%80%A7%E6%94%AF%E6%8C%81%E6%9C%89%E9%99%90-toc" style="margin-left:160px;"><strong><a href="#2-2%E3%80%81%E6%9F%90%E4%BA%9B%E7%89%B9%E6%80%A7%E6%94%AF%E6%8C%81%E6%9C%89%E9%99%90" rel="nofollow"><span style="color:#1a439c;">2-2、某些特性支持有限</span></a></strong></p> 
<p id="2-3%E3%80%81%E5%86%85%E5%AD%98%E5%8D%A0%E7%94%A8-toc" style="margin-left:160px;"><strong><a href="#2-3%E3%80%81%E5%86%85%E5%AD%98%E5%8D%A0%E7%94%A8" rel="nofollow"><span style="color:#1a439c;">2-3、内存占用</span></a></strong></p> 
<p id="2-4%E3%80%81%E6%96%87%E6%A1%A3%E5%92%8C%E7%A4%BA%E4%BE%8B%E5%8F%AF%E8%83%BD%E4%B8%8D%E8%B6%B3-toc" style="margin-left:160px;"><strong><a href="#2-4%E3%80%81%E6%96%87%E6%A1%A3%E5%92%8C%E7%A4%BA%E4%BE%8B%E5%8F%AF%E8%83%BD%E4%B8%8D%E8%B6%B3" rel="nofollow"><span style="color:#1a439c;">2-4、文档和示例可能不足</span></a></strong></p> 
<p id="2-5.%E3%80%81%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB-toc" style="margin-left:160px;"><strong><a href="#2-5.%E3%80%81%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB" rel="nofollow"><span style="color:#1a439c;">2-5、依赖关系</span></a></strong></p> 
<p id="2-6%E3%80%81%E5%AD%A6%E4%B9%A0%E6%9B%B2%E7%BA%BF-toc" style="margin-left:160px;"><strong><a href="#2-6%E3%80%81%E5%AD%A6%E4%B9%A0%E6%9B%B2%E7%BA%BF" rel="nofollow"><span style="color:#1a439c;">2-6、学习曲线</span></a></strong></p> 
<p id="%E4%B8%89%E3%80%81openpyxl%E5%BA%93%E7%9A%84%E7%94%A8%E9%80%94-toc" style="margin-left:80px;"><strong><a href="#%E4%B8%89%E3%80%81openpyxl%E5%BA%93%E7%9A%84%E7%94%A8%E9%80%94" rel="nofollow"><span style="color:#1a439c;">三、openpyxl库的用途</span></a></strong></p> 
<p id="1%E3%80%81%E8%AF%BB%E5%8F%96Excel%E6%96%87%E4%BB%B6-toc" style="margin-left:120px;"><strong><a href="#1%E3%80%81%E8%AF%BB%E5%8F%96Excel%E6%96%87%E4%BB%B6" rel="nofollow"><span style="color:#1a439c;">1、读取Excel文件</span></a></strong></p> 
<p id="2%E3%80%81%E5%86%99%E5%85%A5Excel%E6%96%87%E4%BB%B6-toc" style="margin-left:120px;"><strong><a href="#2%E3%80%81%E5%86%99%E5%85%A5Excel%E6%96%87%E4%BB%B6" rel="nofollow"><span style="color:#1a439c;">2、写入Excel文件</span></a></strong></p> 
<p id="3%E3%80%81%E4%BF%AE%E6%94%B9Excel%E6%96%87%E4%BB%B6-toc" style="margin-left:120px;"><strong><a href="#3%E3%80%81%E4%BF%AE%E6%94%B9Excel%E6%96%87%E4%BB%B6" rel="nofollow"><span style="color:#1a439c;">3、修改Excel文件</span></a></strong></p> 
<p id="4%E3%80%81%E8%87%AA%E5%8A%A8%E5%8C%96-toc" style="margin-left:120px;"><strong><a href="#4%E3%80%81%E8%87%AA%E5%8A%A8%E5%8C%96" rel="nofollow"><span style="color:#1a439c;">4、自动化</span></a></strong></p> 
<p id="5%E3%80%81%E4%B8%8EExcel%E4%BA%A4%E4%BA%92-toc" style="margin-left:120px;"><strong><a href="#5%E3%80%81%E4%B8%8EExcel%E4%BA%A4%E4%BA%92" rel="nofollow"><span style="color:#1a439c;">5、与Excel交互</span></a></strong></p> 
<p id="6%E3%80%81%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E5%92%8C%E8%BD%AC%E6%8D%A2-toc" style="margin-left:120px;"><strong><a href="#6%E3%80%81%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E5%92%8C%E8%BD%AC%E6%8D%A2" rel="nofollow"><span style="color:#1a439c;">6、数据迁移和转换</span></a></strong></p> 
<p id="7%E3%80%81%E5%88%9B%E5%BB%BA%E6%A8%A1%E6%9D%BF%E5%8C%96%E7%9A%84%E6%8A%A5%E5%91%8A-toc" style="margin-left:120px;"><strong><a href="#7%E3%80%81%E5%88%9B%E5%BB%BA%E6%A8%A1%E6%9D%BF%E5%8C%96%E7%9A%84%E6%8A%A5%E5%91%8A" rel="nofollow"><span style="color:#1a439c;">7、创建模板化的报告</span></a></strong></p> 
<p id="%E5%9B%9B%E3%80%81%E5%A6%82%E4%BD%95%E5%AD%A6%E5%A5%BDopenpyxl%E5%BA%93%EF%BC%9F-toc" style="margin-left:80px;"><strong><a href="#%E5%9B%9B%E3%80%81%E5%A6%82%E4%BD%95%E5%AD%A6%E5%A5%BDopenpyxl%E5%BA%93%EF%BC%9F" rel="nofollow"><span style="color:#1a439c;">四、如何学好openpyxl库？</span></a></strong></p> 
<p id="1%E3%80%81%E8%8E%B7%E5%8F%96xlrd%E5%BA%93%E7%9A%84%E5%B1%9E%E6%80%A7%E5%92%8C%E6%96%B9%E6%B3%95-toc" style="margin-left:120px;"><strong><a href="#1%E3%80%81%E8%8E%B7%E5%8F%96xlrd%E5%BA%93%E7%9A%84%E5%B1%9E%E6%80%A7%E5%92%8C%E6%96%B9%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">1、获取openpyxl库的属性和方法</span></a></strong></p> 
<p id="2%E3%80%81%E8%8E%B7%E5%8F%96xlrd%E5%BA%93%E7%9A%84%E5%B8%AE%E5%8A%A9%E4%BF%A1%E6%81%AF-toc" style="margin-left:120px;"><strong><a href="#2%E3%80%81%E8%8E%B7%E5%8F%96xlrd%E5%BA%93%E7%9A%84%E5%B8%AE%E5%8A%A9%E4%BF%A1%E6%81%AF" rel="nofollow"><span style="color:#1a439c;">2、获取openpyxl库的帮助信息</span></a></strong></p> 
<p id="3%E3%80%81%E7%94%A8%E6%B3%95%E7%B2%BE%E8%AE%B2-toc" style="margin-left:120px;"><strong><a href="#3%E3%80%81%E7%94%A8%E6%B3%95%E7%B2%BE%E8%AE%B2" rel="nofollow"><span style="color:#1a439c;">3、实战案例</span></a></strong></p> 
<p id="3-1%E3%80%81cellname%E5%87%BD%E6%95%B0-toc" style="margin-left:160px;"><strong><a href="#3-1%E3%80%81cellname%E5%87%BD%E6%95%B0" rel="nofollow"><span style="color:#1a439c;">3-241、设置单元格区域的除对角框线以外的全部边框</span></a></strong></p> 
<p id="3-242%E3%80%81%E5%88%A0%E9%99%A4%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E7%9A%84%E5%85%A8%E9%83%A8%E8%BE%B9%E6%A1%86-toc" style="margin-left:160px;"><strong><a href="#3-242%E3%80%81%E5%88%A0%E9%99%A4%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E7%9A%84%E5%85%A8%E9%83%A8%E8%BE%B9%E6%A1%86" rel="nofollow"><span style="color:#1a439c;">3-242、删除单元格区域的全部边框</span></a></strong></p> 
<p id="3-243%E3%80%81%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E9%A2%9C%E8%89%B2%E5%92%8C%E8%83%8C%E6%99%AF-toc" style="margin-left:160px;"><strong><a href="#3-243%E3%80%81%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E9%A2%9C%E8%89%B2%E5%92%8C%E8%83%8C%E6%99%AF" rel="nofollow"><span style="color:#1a439c;">3-243、设置单元格的颜色和背景</span></a></strong></p> 
<p id="3-244%E3%80%81%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E6%A0%BC%E5%BC%8F-toc" style="margin-left:160px;"><strong><a href="#3-244%E3%80%81%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E6%A0%BC%E5%BC%8F" rel="nofollow"><span style="color:#1a439c;">3-244、设置单元格的格式</span></a></strong></p> 
<p id="3-245%E3%80%81%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E5%AF%B9%E9%BD%90%E6%96%B9%E5%BC%8F-toc" style="margin-left:160px;"><strong><a href="#3-245%E3%80%81%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E5%AF%B9%E9%BD%90%E6%96%B9%E5%BC%8F" rel="nofollow"><span style="color:#1a439c;">3-245、设置单元格的对齐方式</span></a></strong></p> 
<p id="3-246%E3%80%81%E7%BC%A9%E5%B0%8F%E5%8D%95%E5%85%83%E6%A0%BC%E5%86%85%E5%AE%B9%E4%BB%A5%E5%85%A8%E9%83%A8%E6%98%BE%E7%A4%BA-toc" style="margin-left:160px;"><strong><a href="#3-246%E3%80%81%E7%BC%A9%E5%B0%8F%E5%8D%95%E5%85%83%E6%A0%BC%E5%86%85%E5%AE%B9%E4%BB%A5%E5%85%A8%E9%83%A8%E6%98%BE%E7%A4%BA" rel="nofollow"><span style="color:#1a439c;">3-246、缩小单元格内容以全部显示</span></a></strong></p> 
<p id="3-247%E3%80%81%E8%AE%BE%E5%AE%9A%2F%E5%88%A0%E9%99%A4%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E8%BE%93%E5%85%A5%E8%A7%84%E5%88%99%E5%92%8C%E4%BF%A1%E6%81%AF%E6%8F%90%E7%A4%BA(%E6%9C%89%E6%95%88%E6%80%A7%E8%AE%BE%E7%BD%AE)-toc" style="margin-left:160px;"><strong><a href="#3-247%E3%80%81%E8%AE%BE%E5%AE%9A%2F%E5%88%A0%E9%99%A4%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E8%BE%93%E5%85%A5%E8%A7%84%E5%88%99%E5%92%8C%E4%BF%A1%E6%81%AF%E6%8F%90%E7%A4%BA%28%E6%9C%89%E6%95%88%E6%80%A7%E8%AE%BE%E7%BD%AE%29" rel="nofollow"><span style="color:#1a439c;">3-247、设定/删除单元格的输入规则和信息提示(有效性设置)</span></a></strong></p> 
<p id="3-248%E3%80%81%E4%B8%BA%E5%8D%95%E5%85%83%E6%A0%BC%E8%AE%BE%E7%BD%AE%E6%9D%A1%E4%BB%B6%E6%A0%BC%E5%BC%8F%2F%E5%88%A0%E9%99%A4%E6%9D%A1%E4%BB%B6%E6%A0%BC%E5%BC%8F-toc" style="margin-left:160px;"><strong><a href="#3-248%E3%80%81%E4%B8%BA%E5%8D%95%E5%85%83%E6%A0%BC%E8%AE%BE%E7%BD%AE%E6%9D%A1%E4%BB%B6%E6%A0%BC%E5%BC%8F%2F%E5%88%A0%E9%99%A4%E6%9D%A1%E4%BB%B6%E6%A0%BC%E5%BC%8F" rel="nofollow"><span style="color:#1a439c;">3-248、为单元格设置条件格式/删除条件格式</span></a></strong></p> 
<p id="3-249%E3%80%81%E4%B8%BA%E5%8D%95%E5%85%83%E6%A0%BC%E6%8F%92%E5%85%A5%E6%8C%87%E5%90%91%E5%B7%A5%E4%BD%9C%E7%B0%BF%E5%86%85%E9%83%A8%E7%9A%84%E8%B6%85%E9%93%BE%E6%8E%A5%2F%E5%88%A0%E9%99%A4%E8%B6%85%E9%93%BE%E6%8E%A5-toc" style="margin-left:160px;"><strong><a href="#3-249%E3%80%81%E4%B8%BA%E5%8D%95%E5%85%83%E6%A0%BC%E6%8F%92%E5%85%A5%E6%8C%87%E5%90%91%E5%B7%A5%E4%BD%9C%E7%B0%BF%E5%86%85%E9%83%A8%E7%9A%84%E8%B6%85%E9%93%BE%E6%8E%A5%2F%E5%88%A0%E9%99%A4%E8%B6%85%E9%93%BE%E6%8E%A5" rel="nofollow"><span style="color:#1a439c;">3-249、为单元格插入指向工作簿内部的超链接/删除超链接</span></a></strong></p> 
<p id="3-250%E3%80%81%E4%B8%BA%E5%8D%95%E5%85%83%E6%A0%BC%E6%8F%92%E5%85%A5%E6%8C%87%E5%90%91%E5%B7%A5%E4%BD%9C%E7%B0%BF%E5%A4%96%E9%83%A8%E7%9A%84%E8%B6%85%E9%93%BE%E6%8E%A5%2F%E5%88%A0%E9%99%A4%E8%B6%85%E9%93%BE%E6%8E%A5-toc" style="margin-left:160px;"><strong><a href="#3-250%E3%80%81%E4%B8%BA%E5%8D%95%E5%85%83%E6%A0%BC%E6%8F%92%E5%85%A5%E6%8C%87%E5%90%91%E5%B7%A5%E4%BD%9C%E7%B0%BF%E5%A4%96%E9%83%A8%E7%9A%84%E8%B6%85%E9%93%BE%E6%8E%A5%2F%E5%88%A0%E9%99%A4%E8%B6%85%E9%93%BE%E6%8E%A5" rel="nofollow"><span style="color:#1a439c;">3-250、为单元格插入指向工作簿外部的超链接/删除超链接</span></a></strong></p> 
<p id="3-251%E3%80%81%E4%B8%BA%E5%8D%95%E5%85%83%E6%A0%BC%E6%B7%BB%E5%8A%A0%E6%89%B9%E6%B3%A8%2F%E5%88%A0%E9%99%A4%E6%89%B9%E6%B3%A8-toc" style="margin-left:160px;"><strong><a href="#3-251%E3%80%81%E4%B8%BA%E5%8D%95%E5%85%83%E6%A0%BC%E6%B7%BB%E5%8A%A0%E6%89%B9%E6%B3%A8%2F%E5%88%A0%E9%99%A4%E6%89%B9%E6%B3%A8" rel="nofollow"><span style="color:#1a439c;">3-251、为单元格添加批注/删除批注</span></a></strong></p> 
<p id="3-252%E3%80%81%E4%BF%AE%E6%94%B9%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E6%89%B9%E6%B3%A8-toc" style="margin-left:160px;"><strong><a href="#3-252%E3%80%81%E4%BF%AE%E6%94%B9%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E6%89%B9%E6%B3%A8" rel="nofollow"><span style="color:#1a439c;">3-252、修改单元格的批注</span></a></strong></p> 
<p id="3-253%E3%80%81%E4%B8%BA%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E5%AE%9A%E4%B9%89%E5%90%8D%E7%A7%B0%2F%E5%88%A0%E9%99%A4%E5%90%8D%E7%A7%B0(Name%E5%B1%9E%E6%80%A7)-toc" style="margin-left:160px;"><strong><a href="#3-253%E3%80%81%E4%B8%BA%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E5%AE%9A%E4%B9%89%E5%90%8D%E7%A7%B0%2F%E5%88%A0%E9%99%A4%E5%90%8D%E7%A7%B0%28Name%E5%B1%9E%E6%80%A7%29" rel="nofollow"><span style="color:#1a439c;">3-253、为单元格区域定义名称/删除名称(Name属性)</span></a></strong></p> 
<p id="3-254%E3%80%81%E4%B8%BA%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E5%AE%9A%E4%B9%89%E5%90%8D%E7%A7%B0%2F%E5%88%A0%E9%99%A4%E5%90%8D%E7%A7%B0(Add%E6%96%B9%E6%B3%95)-toc" style="margin-left:160px;"><strong><a href="#3-254%E3%80%81%E4%B8%BA%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E5%AE%9A%E4%B9%89%E5%90%8D%E7%A7%B0%2F%E5%88%A0%E9%99%A4%E5%90%8D%E7%A7%B0%28Add%E6%96%B9%E6%B3%95%29" rel="nofollow"><span style="color:#1a439c;">3-254、为单元格区域定义名称/删除名称(Add方法)</span></a></strong></p> 
<p id="3-255%E3%80%81%E8%87%AA%E5%8A%A8%E8%B0%83%E6%95%B4%E5%8D%95%E5%85%83%E6%A0%BC%E5%A4%A7%E5%B0%8F-toc" style="margin-left:160px;"><strong><a href="#3-255%E3%80%81%E8%87%AA%E5%8A%A8%E8%B0%83%E6%95%B4%E5%8D%95%E5%85%83%E6%A0%BC%E5%A4%A7%E5%B0%8F" rel="nofollow"><span style="color:#1a439c;">3-255、自动调整单元格大小</span></a></strong></p> 
<p id="3-256%E3%80%81%E8%87%AA%E5%8A%A8%E8%B0%83%E6%95%B4%E5%B7%A5%E4%BD%9C%E8%A1%A8%E5%85%A8%E9%83%A8%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E5%A4%A7%E5%B0%8F-toc" style="margin-left:160px;"><strong><a href="#3-256%E3%80%81%E8%87%AA%E5%8A%A8%E8%B0%83%E6%95%B4%E5%B7%A5%E4%BD%9C%E8%A1%A8%E5%85%A8%E9%83%A8%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E5%A4%A7%E5%B0%8F" rel="nofollow"><span style="color:#1a439c;">3-256、自动调整工作表全部单元格的大小</span></a></strong></p> 
<p id="3-257%E3%80%81%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E5%A4%A7%E5%B0%8F(%E4%BB%A5%E7%A3%85%E4%B8%BA%E5%8D%95%E4%BD%8D)-toc" style="margin-left:160px;"><strong><a href="#3-257%E3%80%81%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E5%A4%A7%E5%B0%8F%28%E4%BB%A5%E7%A3%85%E4%B8%BA%E5%8D%95%E4%BD%8D%29" rel="nofollow"><span style="color:#1a439c;">3-257、设置单元格的大小(以磅为单位)</span></a></strong></p> 
<p id="3-258%E3%80%81%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E5%A4%A7%E5%B0%8F(%E4%BB%A5cm%E4%B8%BA%E5%8D%95%E4%BD%8D)-toc" style="margin-left:160px;"><strong><a href="#3-258%E3%80%81%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E5%A4%A7%E5%B0%8F%28%E4%BB%A5cm%E4%B8%BA%E5%8D%95%E4%BD%8D%29" rel="nofollow"><span style="color:#1a439c;">3-258、设置单元格的大小(以cm为单位)</span></a></strong></p> 
<p id="3-259%E3%80%81%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E5%A4%A7%E5%B0%8F(%E4%BB%A5in%E4%B8%BA%E5%8D%95%E4%BD%8D)-toc" style="margin-left:160px;"><strong><a href="#3-259%E3%80%81%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E5%A4%A7%E5%B0%8F%28%E4%BB%A5in%E4%B8%BA%E5%8D%95%E4%BD%8D%29" rel="nofollow"><span style="color:#1a439c;">3-259、设置单元格的大小(以in为单位)</span></a></strong></p> 
<p id="3-260%E3%80%81%E9%94%81%E5%AE%9A%E5%8D%95%E5%85%83%E6%A0%BC%2F%E8%A7%A3%E9%99%A4%E5%8D%95%E5%85%83%E6%A0%BC%E9%94%81%E5%AE%9A-toc" style="margin-left:160px;"><strong><a href="#3-260%E3%80%81%E9%94%81%E5%AE%9A%E5%8D%95%E5%85%83%E6%A0%BC%2F%E8%A7%A3%E9%99%A4%E5%8D%95%E5%85%83%E6%A0%BC%E9%94%81%E5%AE%9A" rel="nofollow"><span style="color:#1a439c;">3-260、锁定单元格/解除单元格锁定</span></a></strong></p> 
<p id="%E4%BA%94%E3%80%81%E6%8E%A8%E8%8D%90%E9%98%85%E8%AF%BB-toc" style="margin-left:80px;"><strong><a href="#%E4%BA%94%E3%80%81%E6%8E%A8%E8%8D%90%E9%98%85%E8%AF%BB" rel="nofollow"><span style="color:#1a439c;">五、推荐阅读</span></a></strong></p> 
<p id="1%E3%80%81-toc" style="margin-left:120px;"><strong><a href="#1%E3%80%81" rel="nofollow"><span style="color:#1a439c;">1、Python筑基之旅</span></a></strong></p> 
<p id="2%E3%80%81-toc" style="margin-left:120px;"><strong><a href="#2%E3%80%81" rel="nofollow"><span style="color:#1a439c;">2、Python函数之旅</span></a></strong></p> 
<p id="3%E3%80%81-toc" style="margin-left:120px;"><strong><a href="#3%E3%80%81" rel="nofollow"><span style="color:#1a439c;">3、Python算法之旅</span></a></strong></p> 
<p id="4%E3%80%81-toc" style="margin-left:120px;"><strong><a href="#4%E3%80%81" rel="nofollow"><span style="color:#1a439c;">4、Python魔法之旅</span></a></strong></p> 
<p id="5%E3%80%81%C2%A0-toc" style="margin-left:120px;"><strong><a href="#5%E3%80%81%C2%A0" rel="nofollow"><span style="color:#1a439c;">5、博客个人主页</span></a></strong></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/3f/7c/9wWs8rjO_o.gif"></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/67/9f/DJSywP5P_o.png"></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/10/02/tQTZm9Bj_o.gif"></p> 
<h4 id="%E4%B8%80%E3%80%81%20openpyxl%E5%BA%93%E7%9A%84%E7%94%B1%E6%9D%A5">一、 openpyxl库的由来</h4> 
<p>        openpyxl库的由来可以总结为以下几点：</p> 
<h5 id="1%E3%80%81%E8%83%8C%E6%99%AF">1、背景</h5> 
<p>        在openpyxl库诞生之前，Python中缺乏一个专门用于读取和编写Office Open XML格式(如Excel 2010及更高版本的.xlsx文件)的库。</p> 
<h5 id="2%E3%80%81%E8%B5%B7%E6%BA%90">2、起源</h5> 
<p>        openpyxl库的创建是为了解决上述提到的Python在处理Excel文件时的不足，它的开发受到了PHPExcel团队的启发，因为openpyxl最初是基于PHPExcel的。</p> 
<h5 id="3%E3%80%81%E5%8F%91%E5%B1%95">3、发展</h5> 
<p>        随着时间的推移，openpyxl逐渐发展成为一个功能强大的Python库，专门用于处理Excel文件。它支持Excel 2010及更高版本的文件格式，并提供了丰富的API，用于读取、写入、修改Excel文件。</p> 
<h5 id="4%E3%80%81%E7%89%B9%E7%82%B9">4、特点</h5> 
<h6 id="4-1%E3%80%81%E6%94%AF%E6%8C%81.xlsx%E6%A0%BC%E5%BC%8F">4-1、支持.xlsx格式</h6> 
<p>        openpyxl主要用于处理Excel 2010及更新版本的.xlsx文件。</p> 
<h6 id="4-2%E3%80%81%E8%AF%BB%E5%86%99Excel%E6%96%87%E4%BB%B6">4-2、读写Excel文件</h6> 
<p>        使用openpyxl可以读取现有的Excel文件，获取数据，修改数据，并保存到新的文件中。</p> 
<h6 id="4-3%E3%80%81%E6%93%8D%E4%BD%9C%E5%8D%95%E5%85%83%E6%A0%BC">4-3、操作单元格</h6> 
<p>        openpyxl允许用户按行、列或具体的单元格进行数据的读取和写入。</p> 
<h6 id="4-4%E3%80%81%E5%88%9B%E5%BB%BA%E5%92%8C%E4%BF%AE%E6%94%B9%E5%B7%A5%E4%BD%9C%E8%A1%A8">4-4、创建和修改工作表</h6> 
<p>        用户可以创建新的工作表，复制和删除现有的工作表，设置工作表的属性等。</p> 
<h6 id="4-5%E3%80%81%E6%A0%B7%E5%BC%8F%E8%AE%BE%E7%BD%AE">4-5、样式设置</h6> 
<p>        openpyxl支持设置单元格的字体、颜色、边框等样式。</p> 
<h6 id="4-6%E3%80%81%E5%9B%BE%E8%A1%A8%E5%92%8C%E5%85%AC%E5%BC%8F">4-6、图表和公式</h6> 
<p>        用户可以通过openpyxl创建图表、添加公式等。</p> 
<h6 id="4-7%E3%80%81%E6%94%AF%E6%8C%81%E6%95%B0%E5%AD%97%E5%92%8C%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F">4-7、支持数字和日期格式</h6> 
<p>        openpyxl能够正确处理数字和日期格式，确保在Excel中显示正确的格式。</p> 
<p>        综上所述，openpyxl库的出现填补了Python在处理Excel文件时的空白，经过不断的发展和完善，成为了一个功能丰富、易于使用的Python库。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/26/e6/jJf4W0Kx_o.png"></p> 
<h4 id="%E4%BA%8C%E3%80%81openpyxl%E5%BA%93%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9">二、openpyxl库的<span style="color:#1c7331;">优</span><span style="color:#fe2c24;">缺</span>点</h4> 
<p>        <span style="color:#fe2c24;"><strong>openpyxl库</strong></span>是一个<span style="color:#fe2c24;"><strong>用于读写Excel 2010 xlsx/xlsm/xltx/xltm文件的Python库</strong></span>，它基于Python，并且对于处理Excel文件提供了很多便利的功能，其主要<strong><span style="color:#1c7331;">优</span><span style="color:#fe2c24;">缺</span></strong>点有：</p> 
<h5 id="1%E3%80%81%E4%BC%98%E7%82%B9"><span style="color:#1c7331;"><strong>1、优点</strong></span></h5> 
<h6 id="1-1%E3%80%81%E6%94%AF%E6%8C%81%E7%8E%B0%E4%BB%A3Excel%E6%A0%BC%E5%BC%8F"><span style="color:#1c7331;"><strong>1-1、支持现代Excel格式</strong></span></h6> 
<p>        openpyxl支持.xlsx格式的Excel文件，这是Excel 2010及更高版本使用的格式，也是目前广泛使用的格式。</p> 
<h6 id="1-2%E3%80%81%E5%8A%9F%E8%83%BD%E4%B8%B0%E5%AF%8C"><span style="color:#1c7331;"><strong>1-2、功能丰富</strong></span></h6> 
<p>        openpyxl提供了<span style="color:#fe2c24;"><strong>创建、修改和保存Excel工作簿、工作表、单元格、图表、公式、图像</strong></span>等功能。</p> 
<h6 id="1-3%E3%80%81%E6%98%93%E4%BA%8E%E4%BD%BF%E7%94%A8"><span style="color:#1c7331;"><strong>1-3、易于使用</strong></span></h6> 
<p>        openpyxl的API设计得相对直观，使得Python开发者能够很容易地掌握和使用。</p> 
<h6 id="1-4%E3%80%81%E4%B8%8EExcel%E5%85%BC%E5%AE%B9%E6%80%A7"><span style="color:#1c7331;"><strong>1-4、与Excel兼容性</strong></span></h6> 
<p>        openpyxl能够处理Excel文件中的很多复杂特性，如公式、样式、条件格式等，这确保了与Excel的良好兼容性。</p> 
<h6 id="1-5%E3%80%81%E6%80%A7%E8%83%BD%E8%89%AF%E5%A5%BD"><span style="color:#1c7331;"><strong>1-5、性能良好</strong></span></h6> 
<p>        在处理大型Excel文件时，openpyxl通常能够保持较好的性能。</p> 
<h6 id="1-6%E3%80%81%E7%A4%BE%E5%8C%BA%E6%94%AF%E6%8C%81"><span style="color:#1c7331;"><strong>1-6、社区支持</strong></span></h6> 
<p>        openpyxl是一个开源项目，拥有活跃的社区支持和维护，这意味着开发者可以获得帮助和修复错误的快速响应。</p> 
<h6 id="1-7%E3%80%81%E8%B7%A8%E5%B9%B3%E5%8F%B0"><span style="color:#1c7331;"><strong>1-7、跨平台</strong></span></h6> 
<p>        openpyxl可以在不同的操作系统上运行，包括Windows、Linux和macOS等。</p> 
<h5 id="2%E3%80%81%E7%BC%BA%E7%82%B9"><span style="color:#fe2c24;"><strong>2、缺点</strong></span></h5> 
<h6 id="2-1%E3%80%81%E4%B8%8D%E6%94%AF%E6%8C%81%E6%97%A7%E7%89%88%E6%A0%BC%E5%BC%8F"><span style="color:#fe2c24;"><strong>2-1、不支持旧版格式</strong></span></h6> 
<p>        openpyxl不支持较旧的.xls格式(Excel 97-2003)。如果需要处理这种格式的文件，需要使用其他库如xlrd和xlwt(尽管这些库也面临一些兼容性和维护问题)。</p> 
<h6 id="2-2%E3%80%81%E6%9F%90%E4%BA%9B%E7%89%B9%E6%80%A7%E6%94%AF%E6%8C%81%E6%9C%89%E9%99%90"><span style="color:#fe2c24;"><strong>2-2、某些特性支持有限</strong></span></h6> 
<p>        虽然openpyxl支持许多Excel特性，但可能对于某些高级或特定的Excel功能支持有限或不支持。</p> 
<h6 id="2-3%E3%80%81%E5%86%85%E5%AD%98%E5%8D%A0%E7%94%A8"><span style="color:#fe2c24;"><strong>2-3、内存占用</strong></span></h6> 
<p>        在处理大型Excel文件时，openpyxl可能会占用较多的内存。这是因为openpyxl会将整个工作簿加载到内存中。</p> 
<h6 id="2-4%E3%80%81%E6%96%87%E6%A1%A3%E5%92%8C%E7%A4%BA%E4%BE%8B%E5%8F%AF%E8%83%BD%E4%B8%8D%E8%B6%B3"><span style="color:#fe2c24;"><strong>2-4、文档和示例可能不足</strong></span></h6> 
<p>        尽管openpyxl的文档相对完整，但对于某些高级功能或特定用例，可能缺乏足够的示例或详细解释。</p> 
<h6 id="2-5.%E3%80%81%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB"><span style="color:#fe2c24;"><strong>2-5、依赖关系</strong></span></h6> 
<p>        openpyxl依赖于lxml和et_xmlfile这两个Python库来处理XML和Excel文件，在某些环境中，可能需要额外安装这些依赖项。</p> 
<h6 id="2-6%E3%80%81%E5%AD%A6%E4%B9%A0%E6%9B%B2%E7%BA%BF"><span style="color:#fe2c24;"><strong>2-6、学习曲线</strong></span></h6> 
<p>        虽然openpyxl的API设计得相对直观，但对于初学者来说，可能需要一些时间来熟悉和掌握其用法。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/a9/79/trGiJ02q_o.png"></p> 
<h4 id="%E4%B8%89%E3%80%81openpyxl%E5%BA%93%E7%9A%84%E7%94%A8%E9%80%94">三、openpyxl库的用途</h4> 
<p>        openpyxl是一个用于读写Excel 2010 xlsx/xlsm/xltx/xltm文件的Python库。它是用Python编写的，不需要Microsoft Excel，并且支持多种Excel数据类型，包括图表、图像、公式等，其主要用途有：</p> 
<h5 id="1%E3%80%81%E8%AF%BB%E5%8F%96Excel%E6%96%87%E4%BB%B6">1、读取Excel文件</h5> 
<p>        你可以使用openpyxl来读取 Excel 文件中的数据，如单元格值、工作表名称、公式等，它支持多种数据类型，如字符串、数字、日期等。</p> 
<h5 id="2%E3%80%81%E5%86%99%E5%85%A5Excel%E6%96%87%E4%BB%B6">2、写入Excel文件</h5> 
<p>        使用openpyxl，你可以创建新的Excel文件或向现有文件添加数据，你可以设置单元格的字体、颜色、边框等样式，你还可以添加图表、图像和其他复杂的Excel功能。</p> 
<h5 id="3%E3%80%81%E4%BF%AE%E6%94%B9Excel%E6%96%87%E4%BB%B6">3、修改Excel文件</h5> 
<p>        你可以使用openpyxl来修改现有的Excel文件，如更改单元格值、添加或删除工作表等，这对于自动化数据处理和报告生成非常有用。</p> 
<h5 id="4%E3%80%81%E8%87%AA%E5%8A%A8%E5%8C%96">4、自动化</h5> 
<p>        openpyxl可以与其他Python库和框架(如 pandas、numpy、matplotlib 等)结合使用，以自动化数据处理和分析任务。你可以编写脚本来从多个数据源收集数据，将数据整合到 Excel 文件中，并执行各种数据分析任务。</p> 
<h5 id="5%E3%80%81%E4%B8%8EExcel%E4%BA%A4%E4%BA%92">5、与Excel交互</h5> 
<p>        如果你正在开发需要与Excel交互的应用程序或工具，openpyxl可以提供一个强大的API来处理Excel文件，它允许你读取和写入Excel文件，而无需依赖Microsoft Excel或其他第三方库。</p> 
<h5 id="6%E3%80%81%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E5%92%8C%E8%BD%AC%E6%8D%A2">6、数据迁移和转换</h5> 
<p>        使用openpyxl，你可以轻松地将数据从Excel文件迁移到其他数据库或文件格式，或将其他数据源的数据导入到Excel文件中。</p> 
<h5 id="7%E3%80%81%E5%88%9B%E5%BB%BA%E6%A8%A1%E6%9D%BF%E5%8C%96%E7%9A%84%E6%8A%A5%E5%91%8A">7、创建模板化的报告</h5> 
<p>        你可以使用openpyxl来创建模板化的Excel报告，并在需要时填充数据，这对于需要定期生成具有一致格式和布局的报告的场景非常有用。</p> 
<p>        总之，openpyxl是一个功能强大的库，可用于在Python中处理Excel文件，它提供了灵活的API来读取、写入、修改和自动化Excel文件的各个方面。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/03/c2/nyjCevvA_o.png"></p> 
<h4 id="%E5%9B%9B%E3%80%81%E5%A6%82%E4%BD%95%E5%AD%A6%E5%A5%BDopenpyxl%E5%BA%93%EF%BC%9F">四、如何学好openpyxl库？</h4> 
<h5 id="1%E3%80%81%E8%8E%B7%E5%8F%96xlrd%E5%BA%93%E7%9A%84%E5%B1%9E%E6%80%A7%E5%92%8C%E6%96%B9%E6%B3%95">1、获取openpyxl库的属性和方法</h5> 
<p>        用print()和dir()两个函数获取openpyxl库所有属性和方法的列表</p> 
<pre><code class="language-python"># ['DEBUG', 'DEFUSEDXML', 'LXML', 'NUMPY', 'Workbook', '__author__', '__author_email__', '__builtins__', '__cached__', 
# '__doc__', '__file__', '__license__', '__loader__', '__maintainer_email__', '__name__', '__package__', '__path__',
# '__spec__', '__url__', '__version__', '_constants', 'cell', 'chart', 'chartsheet', 'comments', 'compat', 'constants',
# 'descriptors', 'drawing', 'formatting', 'formula', 'load_workbook', 'open', 'packaging', 'pivot', 'reader', 'styles',
# 'utils', 'workbook', 'worksheet', 'writer', 'xml']</code></pre> 
<h5 id="2%E3%80%81%E8%8E%B7%E5%8F%96xlrd%E5%BA%93%E7%9A%84%E5%B8%AE%E5%8A%A9%E4%BF%A1%E6%81%AF">2、获取openpyxl库的帮助信息</h5> 
<p>        用help()函数获取openpyxl库的帮助信息</p> 
<pre><code class="language-python">Help on package openpyxl:

NAME
    openpyxl - # Copyright (c) 2010-2024 openpyxl

PACKAGE CONTENTS
    _constants
    cell (package)
    chart (package)
    chartsheet (package)
    comments (package)
    compat (package)
    descriptors (package)
    drawing (package)
    formatting (package)
    formula (package)
    packaging (package)
    pivot (package)
    reader (package)
    styles (package)
    utils (package)
    workbook (package)
    worksheet (package)
    writer (package)
    xml (package)

SUBMODULES
    constants

DATA
    DEBUG = False
    DEFUSEDXML = False
    LXML = True
    NUMPY = True
    __author_email__ = 'charlie.clark@clark-consulting.eu'
    __license__ = 'MIT'
    __maintainer_email__ = 'openpyxl-users@googlegroups.com'
    __url__ = 'https://openpyxl.readthedocs.io'

VERSION
    3.1.3

AUTHOR
    See AUTHORS

FILE
    e:\python_workspace\pythonproject\lib\site-packages\openpyxl\__init__.py</code></pre> 
<h5 id="3%E3%80%81%E7%94%A8%E6%B3%95%E7%B2%BE%E8%AE%B2">3、实战案例</h5> 
<h6 id="3-1%E3%80%81cellname%E5%87%BD%E6%95%B0">3-241、设置单元格区域的除对角框线以外的全部边框</h6> 
<pre><code class="language-python"># 3-241、设置单元格区域的除对角框线以外的全部边框
from openpyxl import Workbook
from openpyxl.styles import Border, Side
# 创建一个新的工作簿和工作表
wb = Workbook()
ws = wb.active
# 定义边框样式
thin_side = Side(border_style="thin", color="000000")
border = Border(left=thin_side, right=thin_side, top=thin_side, bottom=thin_side)
# 设定要应用边框的单元格区域
start_row, start_col = 2, 2
end_row, end_col = 5, 5
# 为单元格区域设置边框
for row in range(start_row, end_row + 1):
    for col in range(start_col, end_col + 1):
        cell = ws.cell(row=row, column=col)
        if row == start_row:
            cell.border = Border(top=thin_side, left=thin_side, right=thin_side)
        elif row == end_row:
            cell.border = Border(bottom=thin_side, left=thin_side, right=thin_side)
        else:
            cell.border = Border(left=thin_side, right=thin_side)
# 保存工作簿
wb.save("border_example.xlsx")</code></pre> 
<h6 id="3-242%E3%80%81%E5%88%A0%E9%99%A4%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E7%9A%84%E5%85%A8%E9%83%A8%E8%BE%B9%E6%A1%86">3-242、删除单元格区域的全部边框</h6> 
<pre><code class="language-python"># 3-242、删除单元格区域的全部边框
from openpyxl import Workbook
from openpyxl.styles import Border, Side
# 创建一个新的工作簿和工作表
wb = Workbook()
ws = wb.active
# 定义一个空边框样式
no_border = Border(left=Side(border_style=None),
                   right=Side(border_style=None),
                   top=Side(border_style=None),
                   bottom=Side(border_style=None))
# 设定要删除边框的单元格区域
start_row, start_col = 2, 2
end_row, end_col = 5, 5
# 为单元格区域删除边框
for row in range(start_row, end_row + 1):
    for col in range(start_col, end_col + 1):
        cell = ws.cell(row=row, column=col)
        cell.border = no_border
# 保存工作簿
wb.save("no_border_example.xlsx")</code></pre> 
<h6 id="3-243%E3%80%81%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E9%A2%9C%E8%89%B2%E5%92%8C%E8%83%8C%E6%99%AF">3-243、设置单元格的颜色和背景</h6> 
<pre><code class="language-python"># 3-243、设置单元格的颜色和背景
from openpyxl import Workbook
from openpyxl.styles import PatternFill
# 创建一个新的工作簿和工作表
wb = Workbook()
ws = wb.active
# 定义填充样式
fill = PatternFill(start_color="FFFF00",  # 设置背景色为黄色
                   end_color="FFFF00",
                   fill_type="solid")
# 设置要应用背景色的单元格区域
start_row, start_col = 2, 2
end_row, end_col = 5, 5
# 为单元格区域设置背景色
for row in range(start_row, end_row + 1):
    for col in range(start_col, end_col + 1):
        cell = ws.cell(row=row, column=col)
        cell.fill = fill
# 保存工作簿
wb.save("colored_cells_example.xlsx")</code></pre> 
<h6 id="3-244%E3%80%81%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E6%A0%BC%E5%BC%8F">3-244、设置单元格的格式</h6> 
<pre><code class="language-python"># 3-244、设置单元格的格式
# 3-244-1、设置单元格的字体
from openpyxl import Workbook
from openpyxl.styles import Font
# 创建一个新的工作簿和工作表
wb = Workbook()
ws = wb.active
# 定义字体样式
font = Font(name='Arial', size=12, bold=True, italic=True, color='FF0000')
# 设置单元格字体
cell = ws['A1']
cell.value = 'Hello, Openpyxl!'
cell.font = font
# 保存工作簿
wb.save("formatted_font_example.xlsx")

# 3-244-2、设置单元格的边框
from openpyxl import Workbook
from openpyxl.styles import Border, Side
# 创建一个新的工作簿和工作表
wb = Workbook()
ws = wb.active
# 定义边框样式
thin_border = Border(left=Side(style='thin'),
                     right=Side(style='thin'),
                     top=Side(style='thin'),
                     bottom=Side(style='thin'))
# 设置单元格边框
cell = ws['B2']
cell.value = 'Border Example'
cell.border = thin_border
# 保存工作簿
wb.save("formatted_border_example.xlsx")

# 3-244-3、设置单元格的对齐方式
from openpyxl import Workbook
from openpyxl.styles import Alignment
# 创建一个新的工作簿和工作表
wb = Workbook()
ws = wb.active
# 定义对齐方式
alignment = Alignment(horizontal='center', vertical='center')
# 设置单元格对齐方式
cell = ws['C3']
cell.value = 'Center Aligned'
cell.alignment = alignment
# 保存工作簿
wb.save("formatted_alignment_example.xlsx")

# 3-244-4、设置单元格的填充颜色
from openpyxl import Workbook
from openpyxl.styles import PatternFill
# 创建一个新的工作簿和工作表
wb = Workbook()
ws = wb.active
# 定义填充样式
fill = PatternFill(start_color="FFFF00",  # 黄色
                   end_color="FFFF00",
                   fill_type="solid")
# 设置单元格填充颜色
cell = ws['D4']
cell.value = 'Filled Color'
cell.fill = fill
# 保存工作簿
wb.save("formatted_fill_example.xlsx")

# 3-244-5、综合示例
from openpyxl import Workbook
from openpyxl.styles import Font, Border, Side, Alignment, PatternFill
# 创建一个新的工作簿和工作表
wb = Workbook()
ws = wb.active
# 定义字体、边框、对齐方式和填充样式
font = Font(name='Arial', size=12, bold=True, color='FF0000')
thin_border = Border(left=Side(style='thin'),
                     right=Side(style='thin'),
                     top=Side(style='thin'),
                     bottom=Side(style='thin'))
alignment = Alignment(horizontal='center', vertical='center')
fill = PatternFill(start_color="FFFF00", end_color="FFFF00", fill_type="solid")
# 设置单元格格式
cell = ws['E5']
cell.value = 'Formatted Cell'
cell.font = font
cell.border = thin_border
cell.alignment = alignment
cell.fill = fill
# 保存工作簿
wb.save("formatted_cell_example.xlsx")</code></pre> 
<h6 id="3-245%E3%80%81%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E5%AF%B9%E9%BD%90%E6%96%B9%E5%BC%8F">3-245、设置单元格的对齐方式</h6> 
<pre><code class="language-python"># 3-245、设置单元格的对齐方式
from openpyxl import Workbook
from openpyxl.styles import Alignment
# 创建一个新的工作簿和工作表
wb = Workbook()
ws = wb.active
# 定义对齐方式
alignment = Alignment(horizontal='center', vertical='center')
# 设置单元格对齐方式
cell = ws['C3']
cell.value = 'Center Aligned'
cell.alignment = alignment
# 保存工作簿
wb.save("formatted_alignment_example.xlsx")</code></pre> 
<h6 id="3-246%E3%80%81%E7%BC%A9%E5%B0%8F%E5%8D%95%E5%85%83%E6%A0%BC%E5%86%85%E5%AE%B9%E4%BB%A5%E5%85%A8%E9%83%A8%E6%98%BE%E7%A4%BA">3-246、缩小单元格内容以全部显示</h6> 
<pre><code class="language-python"># 3-246、缩小单元格内容以全部显示
from openpyxl import Workbook
from openpyxl.styles import Alignment
# 创建一个新的工作簿和工作表
wb = Workbook()
ws = wb.active
# 设置单元格内容
cell = ws['A1']
cell.value = 'This is a very long text that needs to fit into a single cell by shrinking the font size.'
# 设置单元格对齐方式并启用缩小以适应单元格
cell.alignment = Alignment(shrinkToFit=True)
# 保存工作簿
wb.save("shrink_to_fit_example.xlsx")</code></pre> 
<h6 id="3-247%E3%80%81%E8%AE%BE%E5%AE%9A%2F%E5%88%A0%E9%99%A4%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E8%BE%93%E5%85%A5%E8%A7%84%E5%88%99%E5%92%8C%E4%BF%A1%E6%81%AF%E6%8F%90%E7%A4%BA(%E6%9C%89%E6%95%88%E6%80%A7%E8%AE%BE%E7%BD%AE)">3-247、设定/删除单元格的输入规则和信息提示(有效性设置)</h6> 
<pre><code class="language-python"># 3-247、设定/删除单元格的输入规则和信息提示(有效性设置)
# 3-247-1、设置单元格的输入规则和信息提示
from openpyxl import Workbook
from openpyxl.worksheet.datavalidation import DataValidation
# 创建一个新的工作簿和工作表
wb = Workbook()
ws = wb.active
# 创建一个数据有效性对象，设置为整数类型，限制范围在1到10之间
dv = DataValidation(type="whole", operator="between", formula1=1, formula2=10, showErrorMessage=True)
# 设置输入提示
dv.promptTitle = "输入规则"
dv.prompt = "请输入一个1到10之间的整数。"
dv.showInputMessage = True
# 设置错误提示
dv.errorTitle = "输入错误"
dv.error = "输入值必须在1到10之间。"
dv.showErrorMessage = True
# 将数据有效性对象添加到单元格范围内
ws.add_data_validation(dv)
dv.add(ws["A1"])
# 设置单元格的值以进行测试
ws["A1"] = 5
# 保存工作簿
wb.save("data_validation_example.xlsx")

# 3-247-2、删除单元格的输入规则和信息提示
from openpyxl import load_workbook
# 加载已有的工作簿和工作表
wb = load_workbook("data_validation_example.xlsx")
ws = wb.active
# 查找并删除数据有效性对象
for dv in ws.data_validations.dataValidation:
    if "A1" in dv.cells:
        ws.data_validations.dataValidation.remove(dv)
        break
# 保存工作簿
wb.save("data_validation_removed_example.xlsx")</code></pre> 
<h6 id="3-248%E3%80%81%E4%B8%BA%E5%8D%95%E5%85%83%E6%A0%BC%E8%AE%BE%E7%BD%AE%E6%9D%A1%E4%BB%B6%E6%A0%BC%E5%BC%8F%2F%E5%88%A0%E9%99%A4%E6%9D%A1%E4%BB%B6%E6%A0%BC%E5%BC%8F">3-248、为单元格设置条件格式/删除条件格式</h6> 
<pre><code class="language-python"># 3-248、为单元格设置条件格式/删除条件格式
# 3-248-1、设置单元格的条件格式
from openpyxl import Workbook
from openpyxl.formatting.rule import ColorScale, Rule
from openpyxl.styles import Color
# 创建一个新的工作簿和工作表
wb = Workbook()
ws = wb.active
# 设置一些示例数据
for i in range(1, 11):
    ws[f'A{i}'] = i
# 创建一个颜色渐变规则
color_scale_rule = ColorScale(cfvo=['min', 'max'],
                              color=[Color('FF0000'), Color('00FF00')])
# 创建一个条件格式规则对象
rule = Rule(type='colorScale', colorScale=color_scale_rule)
# 将条件格式应用到单元格范围
ws.conditional_formatting.add('A1:A10', rule)
# 保存工作簿
wb.save("conditional_formatting_example.xlsx")

# 3-248-2、删除单元格的条件格式
from openpyxl import load_workbook
# 加载已有的工作簿和工作表
wb = load_workbook("conditional_formatting_example.xlsx")
ws = wb.active
# 移除条件格式
ws.conditional_formatting.remove('A1:A10')
# 保存工作簿
wb.save("conditional_formatting_removed_example.xlsx")</code></pre> 
<h6 id="3-249%E3%80%81%E4%B8%BA%E5%8D%95%E5%85%83%E6%A0%BC%E6%8F%92%E5%85%A5%E6%8C%87%E5%90%91%E5%B7%A5%E4%BD%9C%E7%B0%BF%E5%86%85%E9%83%A8%E7%9A%84%E8%B6%85%E9%93%BE%E6%8E%A5%2F%E5%88%A0%E9%99%A4%E8%B6%85%E9%93%BE%E6%8E%A5">3-249、为单元格插入指向工作簿内部的超链接/删除超链接</h6> 
<pre><code class="language-python"># 3-249、为单元格插入指向工作簿内部的超链接/删除超链接
# 3-249-1、为单元格插入指向工作簿内部的超链接
from openpyxl import Workbook
from openpyxl.utils import get_column_letter
# 创建一个新的工作簿和工作表
wb = Workbook()
ws1 = wb.active
ws1.title = "Sheet1"
# 创建第二个工作表
ws2 = wb.create_sheet(title="Sheet2")
# 在Sheet2中写入一些示例数据
ws2['A1'] = "This is Sheet2"
# 在Sheet1的单元格A1中插入指向Sheet2单元格A1的超链接
ws1['A1'] = "Go to Sheet2"
ws1['A1'].hyperlink = "#Sheet2!A1"
ws1['A1'].style = "Hyperlink"
# 保存工作簿
wb.save("hyperlink_example.xlsx")

# 3-249-2、删除单元格中的超链接
from openpyxl import load_workbook
# 加载已有的工作簿和工作表
wb = load_workbook("hyperlink_example.xlsx")
ws = wb["Sheet1"]
# 删除单元格A1中的超链接
ws['A1'].hyperlink = None
# 保存工作簿
wb.save("hyperlink_removed_example.xlsx")</code></pre> 
<h6 id="3-250%E3%80%81%E4%B8%BA%E5%8D%95%E5%85%83%E6%A0%BC%E6%8F%92%E5%85%A5%E6%8C%87%E5%90%91%E5%B7%A5%E4%BD%9C%E7%B0%BF%E5%A4%96%E9%83%A8%E7%9A%84%E8%B6%85%E9%93%BE%E6%8E%A5%2F%E5%88%A0%E9%99%A4%E8%B6%85%E9%93%BE%E6%8E%A5">3-250、为单元格插入指向工作簿外部的超链接/删除超链接</h6> 
<pre><code class="language-python"># 3-250、为单元格插入指向工作簿外部的超链接/删除超链接
# 3-250-1、为单元格插入指向工作簿外部的超链接
from openpyxl import Workbook
# 创建一个新的工作簿和工作表
wb = Workbook()
ws = wb.active
ws.title = "Sheet1"
# 在单元格A1中插入指向外部URL的超链接
ws['A1'] = "OpenAI Website"
ws['A1'].hyperlink = "https://www.openai.com"
ws['A1'].style = "Hyperlink"
# 保存工作簿
wb.save("external_hyperlink_example.xlsx")

# 3-250-2、删除单元格中的超链接
from openpyxl import load_workbook
# 加载已有的工作簿和工作表
wb = load_workbook("external_hyperlink_example.xlsx")
ws = wb["Sheet1"]
# 删除单元格A1中的超链接
ws['A1'].hyperlink = None
# 保存工作簿
wb.save("hyperlink_removed_example.xlsx")</code></pre> 
<h6 id="3-251%E3%80%81%E4%B8%BA%E5%8D%95%E5%85%83%E6%A0%BC%E6%B7%BB%E5%8A%A0%E6%89%B9%E6%B3%A8%2F%E5%88%A0%E9%99%A4%E6%89%B9%E6%B3%A8">3-251、为单元格添加批注/删除批注</h6> 
<pre><code class="language-python"># 3-251、为单元格添加批注/删除批注
# 3-251-1、为单元格添加批注
from openpyxl import Workbook
from openpyxl.comments import Comment
# 创建一个新的工作簿和工作表
wb = Workbook()
ws = wb.active
ws.title = "Sheet1"
# 创建一个批注并添加到单元格A1
comment_text = "这是一个批注"
comment_author = "Author Name"
comment = Comment(comment_text, comment_author)
ws['A1'].comment = comment
# 保存工作簿
wb.save("comment_added_example.xlsx")

# 3-251-2、删除单元格中的批注
from openpyxl import load_workbook
# 加载已有的工作簿和工作表
wb = load_workbook("comment_added_example.xlsx")
ws = wb["Sheet1"]
# 删除单元格A1中的批注
ws['A1'].comment = None
# 保存工作簿
wb.save("comment_removed_example.xlsx")</code></pre> 
<h6 id="3-252%E3%80%81%E4%BF%AE%E6%94%B9%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E6%89%B9%E6%B3%A8">3-252、修改单元格的批注</h6> 
<pre><code class="language-python"># 3-252、修改单元格的批注
from openpyxl import load_workbook
from openpyxl.comments import Comment
# 加载已有的工作簿和工作表
wb = load_workbook("comment_added_example.xlsx")
ws = wb["Sheet1"]
# 检查单元格A1是否已有批注
if ws['A1'].comment:
    # 获取现有批注
    existing_comment = ws['A1'].comment
    # 修改批注内容
    new_comment_text = "这是修改后的批注"
    existing_comment.text = new_comment_text
else:
    # 如果没有批注，创建一个新的批注
    new_comment_text = "这是一个新的批注"
    comment_author = "New Author"
    new_comment = Comment(new_comment_text, comment_author)
    ws['A1'].comment = new_comment
# 保存工作簿
wb.save("comment_modified_example.xlsx")</code></pre> 
<h6 id="3-253%E3%80%81%E4%B8%BA%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E5%AE%9A%E4%B9%89%E5%90%8D%E7%A7%B0%2F%E5%88%A0%E9%99%A4%E5%90%8D%E7%A7%B0(Name%E5%B1%9E%E6%80%A7)">3-253、为单元格区域定义名称/删除名称(Name属性)</h6> 
<pre><code class="language-python"># 3-253、为单元格区域定义名称/删除名称(Name属性)
# 3-253-1、定义单元格区域名称示例代码
from openpyxl import load_workbook
# 加载已有的工作簿和工作表
wb = load_workbook("example.xlsx")
ws = wb["Sheet1"]
# 为单元格区域定义名称
# 假设我们要为A1:B2区域定义名称为MyNamedRange
wb.create_named_range("MyNamedRange", ws, "A1:B2")
# 保存工作簿
wb.save("example_with_named_range.xlsx")

# 3-253-2、删除单元格区域名称示例代码
from openpyxl import load_workbook
# 加载已有的工作簿
wb = load_workbook("example_with_named_range.xlsx")
# 删除名称
if "MyNamedRange" in wb.defined_names:
    del wb.defined_names["MyNamedRange"]
# 保存工作簿
wb.save("example_without_named_range.xlsx")</code></pre> 
<h6 id="3-254%E3%80%81%E4%B8%BA%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E5%AE%9A%E4%B9%89%E5%90%8D%E7%A7%B0%2F%E5%88%A0%E9%99%A4%E5%90%8D%E7%A7%B0(Add%E6%96%B9%E6%B3%95)">3-254、为单元格区域定义名称/删除名称(Add方法)</h6> 
<pre><code class="language-python"># 3-254、为单元格区域定义名称/删除名称(Add方法)
# 3-254-1、定义单元格区域名称示例代码
from openpyxl import load_workbook
from openpyxl.workbook.defined_name import DefinedName
# 加载已有的工作簿和工作表
wb = load_workbook("example.xlsx")
ws = wb["Sheet1"]
# 使用add方法为单元格区域定义名称
# 假设我们要为A1:B2区域定义名称为MyNamedRange
named_range = DefinedName(name="MyNamedRange", attr_text="Sheet1!$A$1:$B$2")
wb.defined_names.add(named_range)
# 保存工作簿
wb.save("example_with_named_range.xlsx")

# 3-254-2、删除单元格区域名称示例代码
from openpyxl import load_workbook
# 加载已有的工作簿
wb = load_workbook("example_with_named_range.xlsx")
# 删除名称
if "MyNamedRange" in wb.defined_names:
    del wb.defined_names["MyNamedRange"]
# 保存工作簿
wb.save("example_without_named_range.xlsx")</code></pre> 
<h6 id="3-255%E3%80%81%E8%87%AA%E5%8A%A8%E8%B0%83%E6%95%B4%E5%8D%95%E5%85%83%E6%A0%BC%E5%A4%A7%E5%B0%8F">3-255、自动调整单元格大小</h6> 
<pre><code class="language-python"># 3-255、自动调整单元格大小
# 3-255-1、自动调整列宽
from openpyxl import load_workbook
from openpyxl.utils import get_column_letter
# 加载工作簿和工作表
wb = load_workbook("example.xlsx")
ws = wb.active
# 遍历所有列并计算最大内容长度
for col in ws.columns:
    max_length = 0
    column = col[0].column_letter # 获取列字母
    for cell in col:
        try:
            if len(str(cell.value)) &gt; max_length:
                max_length = len(cell.value)
        except:
            pass
    adjusted_width = (max_length + 2)
    ws.column_dimensions[column].width = adjusted_width
# 保存工作簿
wb.save("example_adjusted_columns.xlsx")

# 3-255-2、自动调整行高
from openpyxl import load_workbook
# 加载工作簿和工作表
wb = load_workbook("example.xlsx")
ws = wb.active
# 遍历所有行并计算最大内容高度
for row in ws.iter_rows():
    max_height = 0
    for cell in row:
        try:
            if len(str(cell.value)) &gt; max_height:
                max_height = len(cell.value)
        except:
            pass
    adjusted_height = (max_height + 2)
    ws.row_dimensions[row[0].row].height = adjusted_height
# 保存工作簿
wb.save("example_adjusted_rows.xlsx")</code></pre> 
<h6 id="3-256%E3%80%81%E8%87%AA%E5%8A%A8%E8%B0%83%E6%95%B4%E5%B7%A5%E4%BD%9C%E8%A1%A8%E5%85%A8%E9%83%A8%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E5%A4%A7%E5%B0%8F">3-256、自动调整工作表全部单元格的大小</h6> 
<pre><code class="language-python"># 3-256、自动调整工作表全部单元格的大小
from openpyxl import load_workbook
from openpyxl.utils import get_column_letter
# 加载工作簿和工作表
wb = load_workbook("example.xlsx")
ws = wb.active
# 初始化列宽和行高的字典
col_widths = {}
row_heights = {}
# 遍历所有单元格
for row in ws.iter_rows():
    for cell in row:
        if cell.value:
            # 获取当前单元格的列字母和行号
            col_letter = get_column_letter(cell.column)
            row_number = cell.row
            # 计算并更新列宽
            col_width = len(str(cell.value)) + 2
            if col_letter in col_widths:
                if col_width &gt; col_widths[col_letter]:
                    col_widths[col_letter] = col_width
            else:
                col_widths[col_letter] = col_width
            # 计算并更新行高
            row_height = (len(str(cell.value)) // 10 + 1) * 15
            if row_number in row_heights:
                if row_height &gt; row_heights[row_number]:
                    row_heights[row_number] = row_height
            else:
                row_heights[row_number] = row_height
# 设置列宽
for col_letter, col_width in col_widths.items():
    ws.column_dimensions[col_letter].width = col_width
# 设置行高
for row_number, row_height in row_heights.items():
    ws.row_dimensions[row_number].height = row_height
# 保存工作簿
wb.save("example_adjusted.xlsx")</code></pre> 
<h6 id="3-257%E3%80%81%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E5%A4%A7%E5%B0%8F(%E4%BB%A5%E7%A3%85%E4%B8%BA%E5%8D%95%E4%BD%8D)">3-257、设置单元格的大小(以磅为单位)</h6> 
<pre><code class="language-python"># 3-257、设置单元格的大小(以磅为单位)
from openpyxl import load_workbook
from openpyxl.utils import get_column_letter
# 加载工作簿和工作表
wb = load_workbook("example.xlsx")
ws = wb.active
# 设置行高，单位为磅
def set_row_height(ws, row, height):
    ws.row_dimensions[row].height = height
# 设置列宽，估算单位为磅
def set_column_width(ws, col, width):
    col_letter = get_column_letter(col)
    # 经验公式：列宽单位约为字符宽度的单位
    ws.column_dimensions[col_letter].width = width
# 示例：设置第1行高度为20磅
set_row_height(ws, 1, 20)
# 示例：设置第1列宽度为10个字符宽度
set_column_width(ws, 1, 10)
# 保存工作簿
wb.save("example_adjusted.xlsx")</code></pre> 
<h6 id="3-258%E3%80%81%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E5%A4%A7%E5%B0%8F(%E4%BB%A5cm%E4%B8%BA%E5%8D%95%E4%BD%8D)">3-258、设置单元格的大小(以cm为单位)</h6> 
<pre><code class="language-python"># 3-258、设置单元格的大小(以cm为单位)
from openpyxl import load_workbook
from openpyxl.utils import get_column_letter
# 加载工作簿和工作表
wb = load_workbook("example.xlsx")
ws = wb.active
# 转换函数：厘米到磅
def cm_to_points(cm):
    return cm * 28.3465
# 转换函数：厘米到列宽（估算）
def cm_to_column_width(cm):
    # 1字符宽度约为0.1726厘米
    return cm / 0.1726
# 设置行高，以厘米为单位
def set_row_height_cm(ws, row, height_cm):
    height_points = cm_to_points(height_cm)
    ws.row_dimensions[row].height = height_points
# 设置列宽，以厘米为单位
def set_column_width_cm(ws, col, width_cm):
    width_chars = cm_to_column_width(width_cm)
    col_letter = get_column_letter(col)
    ws.column_dimensions[col_letter].width = width_chars
# 示例：设置第1行高度为2厘米
set_row_height_cm(ws, 1, 2)
# 示例：设置第1列宽度为2厘米
set_column_width_cm(ws, 1, 2)
# 保存工作簿
wb.save("example_adjusted.xlsx")</code></pre> 
<h6 id="3-259%E3%80%81%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E5%A4%A7%E5%B0%8F(%E4%BB%A5in%E4%B8%BA%E5%8D%95%E4%BD%8D)">3-259、设置单元格的大小(以in为单位)</h6> 
<pre><code class="language-python"># 3-259、设置单元格的大小(以in为单位)
from openpyxl import load_workbook
from openpyxl.utils import get_column_letter
# 加载工作簿和工作表
wb = load_workbook("example.xlsx")
ws = wb.active
# 转换函数：英寸到磅
def inches_to_points(inches):
    return inches * 72
# 转换函数：英寸到列宽（估算）
def inches_to_column_width(inches):
    # 1字符宽度约为0.68英寸
    return inches / 0.1726
# 设置行高，以英寸为单位
def set_row_height_in(ws, row, height_in):
    height_points = inches_to_points(height_in)
    ws.row_dimensions[row].height = height_points
# 设置列宽，以英寸为单位
def set_column_width_in(ws, col, width_in):
    width_chars = inches_to_column_width(width_in)
    col_letter = get_column_letter(col)
    ws.column_dimensions[col_letter].width = width_chars
# 示例：设置第1行高度为1英寸
set_row_height_in(ws, 1, 1)
# 示例：设置第1列宽度为1英寸
set_column_width_in(ws, 1, 1)
# 保存工作簿
wb.save("example_adjusted.xlsx")</code></pre> 
<h6 id="3-260%E3%80%81%E9%94%81%E5%AE%9A%E5%8D%95%E5%85%83%E6%A0%BC%2F%E8%A7%A3%E9%99%A4%E5%8D%95%E5%85%83%E6%A0%BC%E9%94%81%E5%AE%9A">3-260、锁定单元格/解除单元格锁定</h6> 
<pre><code class="language-python"># 3-260、锁定单元格/解除单元格锁定
from openpyxl import load_workbook
from openpyxl.worksheet.protection import SheetProtection
# 加载工作簿和工作表
wb = load_workbook("example.xlsx")
ws = wb.active
# 锁定单元格
def lock_cell(ws, cell_coordinate):
    cell = ws[cell_coordinate]
    cell.protection = SheetProtection(locked=True)
# 解除单元格锁定
def unlock_cell(ws, cell_coordinate):
    cell = ws[cell_coordinate]
    cell.protection = SheetProtection(locked=False)
# 锁定A1单元格
lock_cell(ws, 'A1')
# 解除A2单元格锁定
unlock_cell(ws, 'A2')
# 保护工作表，使锁定生效
ws.protection.sheet = True
ws.protection.password = "your_password"  # 可选：设置密码保护
# 保存工作簿
wb.save("example_protected.xlsx")</code></pre> 
<h4 id="%E4%BA%94%E3%80%81%E6%8E%A8%E8%8D%90%E9%98%85%E8%AF%BB">五、推荐阅读</h4> 
<h5 id="1%E3%80%81">1、<a href="https://myelsa1024.blog.csdn.net/article/details/139241094?spm=1001.2014.3001.5502" rel="nofollow" title="Python筑基之旅">Python筑基之旅</a></h5> 
<h5 id="2%E3%80%81">2、<a href="https://myelsa1024.blog.csdn.net/article/details/138916144?spm=1001.2014.3001.5502" rel="nofollow" title="Python函数之旅">Python函数之旅</a></h5> 
<h5 id="3%E3%80%81">3、<a href="https://blog.csdn.net/ygb_1024/article/details/136889623?spm=1001.2014.3001.5501" title="Python算法之旅">Python算法之旅</a></h5> 
<h5 id="4%E3%80%81">4、<a href="https://myelsa1024.blog.csdn.net/article/details/139555733" rel="nofollow" title="Python魔法之旅">Python魔法之旅</a></h5> 
<h5 id="5%E3%80%81%C2%A0">5、<a href="https://blog.csdn.net/ygb_1024?spm=1010.2135.3001.5421" title="博客个人主页">博客个人主页</a></h5>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1a482b8e492d6fdead17029d3ff491cd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">摸鱼大数据——Spark基础——Spark On Yarn环境配置和部署</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/31e8f3ac4c5851af96dc2cc56169906f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">微信小程序留言板1</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>