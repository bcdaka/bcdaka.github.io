<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python求解微分方程，详细版（部分含Matlab） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/c3cc61b26f838809baae1dc0145c7668/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Python求解微分方程，详细版（部分含Matlab）">
  <meta property="og:description" content="一、什么是微分方程 （一）什么是微分方程 微分方程（differential equation）：表示未知函数、未知函数的导数与自变量之间的关系的方程，叫做微分方程。
（二）微分方程分类 如果自变量的个数只有一个，称为常微分方程（Ordinary differential equation，ODE）；如果自变量的个数不止一个，称为偏微分方程（Partial differential equation，PDE）。
线性微分方程（Linear differential equation）：若未知函数与其导数（偏导数）是一次有理整式，则称该微分方程是线性的。
微分方程组：用两个及以上的关系式表示的微分方程称为微分方程组。
1、常微分方程 一般 n 阶常微分方程具有如下形式：
而 n 阶线性常微分方程具有如下形式：
在牛顿力学中，位移，速度，时间三者之间的关系就是最简单的一阶线性常微分方程：
d x / d t = v ( t )
其中自变量是t，未知函数是x，未知函数的导数是 v 。再比如传染病模型，是一阶非线性常微分方程：
d x / d t=k*x*(n-x)
其中自变量是t表示某一时刻；x 是未知函数，表示t时刻染病人数；k是传染系数；n是该地区总人数。
常见常微分方程的表达式表示如下：
令那么 n 阶常微分方程可用一阶方程组代替：
2、偏微分方程 设Ω是 Rⁿ中的一个集合， x =(x1,x2,…, xn）表示Ω上的一点。
u = u ( x ):Ω→ R表示一个 n元函数。记：
其中，(i1, i2 ,…, ik）是集合｛1,2,…, n ｝中k个元素的任意排列。那么一般的
k阶偏微分方程具有如下形式：
k 阶线性偏微分方程具有如下形式：">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-04T08:30:00+08:00">
    <meta property="article:modified_time" content="2024-06-04T08:30:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python求解微分方程，详细版（部分含Matlab）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 style="text-align:center;"><img alt="" height="247" src="https://images2.imgbox.com/35/fd/2AlvuOEL_o.jpg" width="247"></h2> 
<h2 style="text-align:justify;"><strong><strong>一、什么是微分方程</strong></strong></h2> 
<h3 style="text-align:justify;"><strong><strong>（一）什么是微分方程</strong></strong></h3> 
<p style="margin-left:.0001pt;text-align:justify;">微分方程（differential equation）：表示未知函数、未知函数的导数与自变量之间的关系的方程，叫做微分方程。</p> 
<h3 style="text-align:justify;"><strong><strong>（二）微分方程分类</strong></strong></h3> 
<p style="text-align:justify;"><img alt="" height="410" src="https://images2.imgbox.com/0e/64/kuSJgI8y_o.png" width="690"></p> 
<p style="margin-left:.0001pt;text-align:justify;">        如果自变量的个数只有一个，称为常微分方程（Ordinary differential equation，ODE）；如果自变量的个数不止一个，称为偏微分方程（Partial differential equation，PDE）。</p> 
<p style="margin-left:.0001pt;text-align:justify;">        线性微分方程（Linear differential equation）：若未知函数与其导数（偏导数）是一次有理整式，则称该微分方程是线性的。</p> 
<p style="margin-left:.0001pt;text-align:justify;">        微分方程组：用两个及以上的关系式表示的微分方程称为微分方程组。</p> 
<h4 style="margin-left:.0001pt;text-align:justify;"><strong><strong>1、</strong></strong><strong><strong>常微分方程</strong></strong></h4> 
<p style="margin-left:.0001pt;text-align:justify;">一般 n 阶常微分方程具有如下形式：</p> 
<p style="text-align:justify;"><img alt="" height="87" src="https://images2.imgbox.com/00/8d/toPJjdoJ_o.png" width="433"></p> 
<p style="margin-left:.0001pt;text-align:justify;">而 n 阶线性常微分方程具有如下形式：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="90" src="https://images2.imgbox.com/17/c6/ZXuRCJge_o.png" width="692"></p> 
<p style="margin-left:.0001pt;text-align:justify;">在牛顿力学中，位移，速度，时间三者之间的关系就是最简单的一阶线性常微分方程：</p> 
<p style="margin-left:.0001pt;text-align:justify;"> d x / d t = v ( t )</p> 
<p style="margin-left:.0001pt;text-align:justify;">其中自变量是t，未知函数是x，未知函数的导数是 v 。再比如传染病模型，是一阶非线性常微分方程：</p> 
<p style="margin-left:.0001pt;text-align:justify;">d x / d t=k*x*(n-x)</p> 
<p style="margin-left:.0001pt;text-align:justify;">其中自变量是t表示某一时刻；x 是未知函数，表示t时刻染病人数；k是传染系数；n是该地区总人数。</p> 
<p style="margin-left:.0001pt;text-align:justify;">常见常微分方程的表达式表示如下：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="535" src="https://images2.imgbox.com/88/2e/bJVririd_o.png" width="636"></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">令<img alt="" height="45" src="https://images2.imgbox.com/5c/49/k47qCX6p_o.png" width="240">那么 n 阶常微分方程可用一阶方程组代替：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="187" src="https://images2.imgbox.com/eb/8b/FWmp8T62_o.png" width="328"></p> 
<h4 style="margin-left:.0001pt;text-align:justify;"><strong><strong>2、偏微分方程</strong></strong></h4> 
<p style="margin-left:.0001pt;text-align:justify;">设Ω是 Rⁿ中的一个集合， x =(x1,x2,…, xn）表示Ω上的一点。</p> 
<p style="margin-left:.0001pt;text-align:justify;"> u = u ( x ):Ω→ R表示一个 n元函数。记：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="99" src="https://images2.imgbox.com/af/28/PjRR3NhU_o.png" width="329"></p> 
<p style="margin-left:.0001pt;text-align:justify;">其中，(i1, i2 ,…, ik）是集合｛1,2,…, n ｝中k个元素的任意排列。那么一般的</p> 
<p style="margin-left:.0001pt;text-align:justify;">k阶偏微分方程具有如下形式：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="62" src="https://images2.imgbox.com/00/cb/MTlQklNf_o.png" width="501"></p> 
<p style="margin-left:.0001pt;text-align:justify;">k 阶线性偏微分方程具有如下形式：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="75" src="https://images2.imgbox.com/75/64/bUtCo0rl_o.png" width="283"></p> 
<p style="margin-left:.0001pt;text-align:justify;">其中<img alt="" height="28" src="https://images2.imgbox.com/6e/8f/SPl9Dohh_o.png" width="96"></p> 
<p style="margin-left:.0001pt;text-align:justify;">和 f 是给定函数；<img alt="" height="31" src="https://images2.imgbox.com/be/de/oT5X5uON_o.png" width="171">表示多重指标：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="57" src="https://images2.imgbox.com/6e/d5/eMyBvwA9_o.png" width="366"></p> 
<p style="margin-left:.0001pt;text-align:justify;">其中，<img alt="" height="30" src="https://images2.imgbox.com/12/5b/sS2IxzF0_o.png" width="104">和 f 是给定函数。</p> 
<p style="margin-left:.0001pt;text-align:justify;">下面是一些经典的微分方程：</p> 
<p style="margin-left:.0001pt;text-align:justify;">拉普拉斯方程（ Laplace equation ）是最经典的二阶线性偏微分方程：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="83" src="https://images2.imgbox.com/32/fd/taR89U77_o.png" width="375"></p> 
<p style="margin-left:.0001pt;text-align:justify;">拉普拉斯方程也称为调和方程（ Harmonic equation )。调和方程的解称为调和函数( Harmonic function )。</p> 
<p style="margin-left:.0001pt;text-align:justify;">另外，还有三个典型的二阶线性偏微分方程：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="154" src="https://images2.imgbox.com/d1/31/1EmbRQ2U_o.png" width="457"></p> 
<p style="margin-left:.0001pt;text-align:justify;">在 Rm中，二阶线性偏微分方程的一般形式为：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="83" src="https://images2.imgbox.com/ce/2c/VPBgZOFZ_o.png" width="495"></p> 
<p style="margin-left:.0001pt;text-align:justify;">其中：  </p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="47" src="https://images2.imgbox.com/85/20/awi4cCGC_o.png" width="314"></p> 
<h3 style="margin-left:.0001pt;text-align:justify;"><strong><strong>（三）微分方程求解步骤</strong></strong></h3> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<h4 style="margin-left:.0001pt;text-align:justify;"><strong><strong>1、确定微分方程的类型</strong></strong></h4> 
<p style="margin-left:.0001pt;text-align:justify;">微分方程可以分为常微分方程和偏微分方程两大类。在解微分方程之前，需要先确定方程的类型，以便选择合适的方法进行求解。</p> 
<h4 style="margin-left:.0001pt;text-align:justify;"><strong><strong>2、确定微分方程的阶数</strong></strong></h4> 
<p style="margin-left:.0001pt;text-align:justify;">微分方程的阶数是指未知函数的最高阶导数的阶数。根据微分方程的阶数，可以选择不同的解法。常见的微分方程阶数有一阶、二阶和高阶微分方程。</p> 
<h4 style="margin-left:.0001pt;text-align:justify;"><strong><strong>3、将微分方程转化为标准形式</strong></strong></h4> 
<p style="margin-left:.0001pt;text-align:justify;">将微分方程转化为标准形式是解微分方程的关键一步。标准形式可以简化微分方程的求解过程，使问题更清晰明了。转化的方法包括变量代换、换元法、特殊函数等。</p> 
<h4 style="margin-left:.0001pt;text-align:justify;"><strong><strong>4、求解微分方程</strong></strong></h4> 
<p style="margin-left:.0001pt;text-align:justify;">根据微分方程的类型和阶数，选择合适的求解方法。常见的求解方法包括分离变量法、齐次方程法、线性方程法、变量替换法、级数展开法等。</p> 
<h4 style="margin-left:.0001pt;text-align:justify;"><strong><strong>5、验证解的正确性</strong></strong></h4> 
<p style="margin-left:.0001pt;text-align:justify;">解得微分方程后，需要对解进行验证，确保解符合原微分方程。验证的方法可以通过将解代入原方程，检验等式是否成立，或者对解进行导数运算，验证导数是否满足原方程。</p> 
<h4 style="margin-left:.0001pt;text-align:justify;"><strong><strong>6、给出特解或通解</strong></strong></h4> 
<p style="margin-left:.0001pt;text-align:justify;">根据微分方程的边界条件和初始条件，确定特解或通解。特解是满足特定条件的解，而通解是包含所有特解的解集。通过给定的条件，可以求解出特解或确定通解的形式。</p> 
<h4 style="margin-left:.0001pt;text-align:justify;"><strong><strong>7、可视化分析</strong></strong></h4> 
<p style="margin-left:.0001pt;text-align:justify;">在解的方程后，可进行可视化分析，将解表达为函数图像或曲线。通过可视化分析，可以更直观的理解微分方程的意义和解的特性。</p> 
<h2 style="background-color:transparent;text-align:justify;"><strong><strong>二、</strong></strong><strong><strong>用python语言求解微分方程的办法</strong></strong></h2> 
<h3 style="text-align:justify;"><strong><strong>（一）一阶微分方程</strong></strong></h3> 
<h4 style="background-color:transparent;text-align:justify;"><strong><strong>1、一阶线性微分方程</strong></strong><strong><strong>（python和Matlab）</strong></strong></h4> 
<p style="margin-left:.0001pt;text-align:justify;">例如：</p> 
<p style="margin-left:.0001pt;text-align:justify;">对一阶线性微分方程g’(x)-g(x)=0求其通解以及当x=0时，g(x)=1的特解</p> 
<p style="margin-left:.0001pt;text-align:justify;">求解代码如下：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="156" src="https://images2.imgbox.com/45/db/bPRrM5Tf_o.png" width="692"></p> 
<p style="margin-left:.0001pt;text-align:justify;">pprint()输出结果如下：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="227" src="https://images2.imgbox.com/86/90/7xuWQOJ9_o.png" width="696"></p> 
<p style="margin-left:.0001pt;text-align:justify;">print()输出结果如下：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="285" src="https://images2.imgbox.com/04/d5/l9KSt91q_o.png" width="692"></p> 
<p style="margin-left:.0001pt;text-align:justify;">一阶微分方程绘图：</p> 
<p style="margin-left:.0001pt;text-align:justify;">对一阶微分方程：g’(x)-g(x)=0</p> 
<p style="margin-left:.0001pt;text-align:justify;">初值条件为：g(x)=1；</p> 
<p style="margin-left:.0001pt;text-align:justify;">绘图代码及结果如下：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="316" src="https://images2.imgbox.com/ec/5e/Rw7t0GXj_o.png" width="692"></p> 
<p style="margin-left:.0001pt;text-align:justify;">Matlab写法：一阶线性微分方程g’(x)-g(x)=0通解以及当x=0时，g(x)=1的特解</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="322" src="https://images2.imgbox.com/81/71/TIBtxIZx_o.png" width="373"></p> 
<p style="margin-left:.0001pt;text-align:justify;">特解：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="325" src="https://images2.imgbox.com/21/b0/mHR5oW7Y_o.png" width="373"></p> 
<p style="margin-left:.0001pt;text-align:justify;">用Matlab写了这一点是因为这学期选了一个科学计数法的网课选修课，它里边讲Matlab，所以对它有一点接触，但不多，刚好提到可以用这个写作业，有点好奇，所以就在网上找了破解版下载了，目前只会求解一阶微分方程和简单的二阶微分方程，还不会画图。解析式求解如下图：</p> 
<p style="margin-left:.0001pt;text-align:justify;">对二阶微分方程y ’’- y =0求解：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="272" src="https://images2.imgbox.com/e2/31/GERimmUP_o.png" width="351"></p> 
<h4 style="background-color:transparent;margin-left:.0001pt;text-align:justify;"><strong><strong>2.一阶非线性微分方程</strong></strong></h4> 
<p style="margin-left:.0001pt;text-align:justify;">例如：</p> 
<p style="margin-left:.0001pt;text-align:justify;">对一阶非线性微分方程g’(x)-g(x)²=0求其通解以及当x=0时，g(x)=-1的特解。代码如下：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="145" src="https://images2.imgbox.com/95/c2/MobTxNAf_o.png" width="692"></p> 
<p style="margin-left:.0001pt;text-align:justify;">pprint()输出：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="367" src="https://images2.imgbox.com/cd/65/MqHSkqPC_o.png" width="692"></p> 
<p style="margin-left:.0001pt;text-align:justify;">print()输出：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="293" src="https://images2.imgbox.com/3e/a5/F3tWlssz_o.png" width="693"></p> 
<h3 style="text-align:justify;"><strong><strong>（二）二阶微分方程</strong></strong></h3> 
<p style="margin-left:.0001pt;text-align:justify;">例如：g’’(x)-2g’(x)+g(x)-sin x =0</p> 
<p style="margin-left:.0001pt;text-align:justify;">初值条件：g(0)=1, g(1)=2；</p> 
<p style="margin-left:.0001pt;text-align:justify;">求其通解和特解代码如下：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="470" src="https://images2.imgbox.com/26/79/zNbP3v3t_o.png" width="692"></p> 
<p style="margin-left:.0001pt;text-align:justify;">print()输出：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="311" src="https://images2.imgbox.com/96/7c/Bj1m8lx3_o.png" width="692"></p> 
<p style="margin-left:.0001pt;text-align:justify;">二阶微分方程绘图：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="background-color:#ffffff;">二阶方程，需要化成两个一阶方程组成的方程组</span><span style="background-color:#ffffff;">，把每个得到的方程组化成y</span><span style="background-color:#ffffff;">’</span><span style="background-color:#ffffff;">= f ( x , y ) 形式，这里的</span><span style="background-color:#ffffff;">x</span><span style="background-color:#ffffff;">和y是相对每个方程而言的，因为要求的是数值解，所以需要确定好参数值和初始条件，在odeint中默认输入y = </span><span style="background-color:#ffffff;">0</span><span style="background-color:#ffffff;">时因变量的值；确定自变量范围并解方程，绘制图像。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;">解微分方程：y’’(t) - b*y’(t) + y(t) - sin t=0，其中b为参数, 令b=2，先化成两个一阶微分方程，如下图所示：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="215" src="https://images2.imgbox.com/56/78/igEFEDky_o.png" width="690"></p> 
<p style="margin-left:.0001pt;text-align:justify;">代码如下：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="609" src="https://images2.imgbox.com/86/7b/63mQNZEZ_o.png" width="692"></p> 
<p style="margin-left:.0001pt;text-align:justify;">图形如下：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="525" src="https://images2.imgbox.com/e0/54/0hODNMuT_o.png" width="692"></p> 
<h3 style="text-align:justify;"><strong><strong>（三）高阶微分方程</strong></strong></h3> 
<p style="margin-left:.0001pt;text-align:justify;">例如：</p> 
<p style="margin-left:.0001pt;text-align:justify;">四解微分方程g’’’’(x)-2g’’’(x)+5g’’(x)=0</p> 
<p style="margin-left:.0001pt;text-align:justify;">初值条件：</p> 
<p style="margin-left:.0001pt;text-align:justify;">g(0)=1,  g(1)=2,  g(2)=3,  g(3)=4</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="316" src="https://images2.imgbox.com/d6/71/rfqCFoad_o.png" width="693"></p> 
<p style="margin-left:.0001pt;text-align:justify;">print()输出:</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="229" src="https://images2.imgbox.com/5c/54/kPOp3EsI_o.png" width="691"></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>如有错误，望大家批评指正！感激不尽！</strong></p> 
<p style="margin-left:.0001pt;text-align:center;"><img alt="" height="247" src="https://images2.imgbox.com/e5/00/GKZMghS8_o.jpg" width="247"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/42eff2d090101514170c9d268afb1f56/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">HTML跳动的爱心</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c6ed85ad63856b681e6cd4f6d2baf7ae/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">让开发更高效：Windows 平台下 Clang 和 Clangd 的安装与配置</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>