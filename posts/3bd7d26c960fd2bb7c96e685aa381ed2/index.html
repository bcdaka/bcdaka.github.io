<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于Python爬虫&#43;机器学习的长沙市租房价格预测研究 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/3bd7d26c960fd2bb7c96e685aa381ed2/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="基于Python爬虫&#43;机器学习的长沙市租房价格预测研究">
  <meta property="og:description" content="🤵‍♂️ 个人主页：@艾派森的个人主页
✍🏻作者简介：Python学习者
🐋 希望大家多多支持，我们一起进步！😄
如果文章对你有帮助的话，
欢迎评论 💬点赞👍🏻 收藏 📂加关注&#43;
写在前面 最近有粉丝问我“什么 AI 工具好”，其实还是得看自己的使用场景，很难说有最好用，只有最合自己胃口的。对我来说，好用的 AI 工具满足几个标准：
使用方便。用的时候不要太麻烦，最好一键就能启用功能丰富。这样可以覆盖绝大多数的使用场景性能一流。决定上限价格实惠。这很重要 以前我用 ChatGPT 最多，主要是当时没别的可选，就它最厉害，但现在大模型之间的性能差距越来越小，所以慢慢地其他工具就一块用了，比如 Claude、Kimi，AI 搜索的 Perplexity，综合起来看，我目前用得频率最高、也是最顺手的 AI 工具反而是一个浏览器插件“灵办 AI”。功能挺多，该有的都有，比如：
AI 对话翻译阅读（网页&#43;文档）联网搜索AI 写作..... 感兴趣的小伙伴点击下方链接即可免费注册使用：（推荐使用电脑）
https://ilingban.com/browser_extension/?from=aps
目录
1.项目背景
2.数据集介绍
3.技术工具
4.实验过程
4.1导入数据
4.2数据预处理
4.3数据可视化
4.4特征工程
4.5构建模型
4.6特征重要性
4.7模型预测 源代码
1.项目背景 在当今数字化快速发展的时代，数据已成为驱动决策和预测未来的重要力量。房地产市场作为国民经济的重要组成部分，其价格的波动不仅直接影响着居民的生活水平，也反映了国家宏观经济的运行状况。长沙市，作为湖南省的省会城市，近年来随着经济的快速发展和城市化进程的加速，租房市场也呈现出蓬勃发展的态势。
然而，租房价格的波动受到多种因素的影响，包括供求关系、地理位置、房屋类型、装修状况、交通便捷性、周边设施等。这些因素之间相互交织，形成了复杂的动态系统，使得租房价格的预测变得尤为困难。传统的预测方法，如基于经验或简单统计的预测，往往难以准确反映市场变化，且难以适应复杂多变的市场环境。
为了更准确地预测长沙市租房价格，本研究将采用基于Python爬虫和机器学习的方法。Python爬虫技术可以从互联网上大量抓取相关的租房数据，包括房源信息、价格、地理位置、房屋类型等，为后续的机器学习模型提供丰富的数据基础。而机器学习技术则可以通过对大量数据的分析和学习，自动发现数据中的规律和模式，从而实现对租房价格的准确预测。
具体来说，本研究将分为以下几个步骤：首先，利用Python爬虫技术从各大租房网站和平台上抓取相关的租房数据；其次，对抓取的数据进行清洗、预处理和特征工程，提取出与租房价格相关的关键特征；然后，选择合适的机器学习算法（如线性回归、决策树、随机森林、神经网络等），构建租房价格预测模型；最后，通过模型训练和验证，不断优化模型参数，提高预测精度。
本研究旨在通过Python爬虫和机器学习技术的结合，实现对长沙市租房价格的准确预测，为政府决策、房地产开发商、租赁企业和租户等提供有价值的参考信息。同时，本研究也将为机器学习在房地产价格预测领域的应用提供新的思路和方法，具有一定的理论意义和实践价值。
2.数据集介绍 本实验数据集来源于房天下官网，通过使用python爬虫获取了长沙市的租房数据
获取了房屋租金、交付方式、房屋户型、房屋面积、装修情况、校区、地址、配套设施、房源亮点等字段信息，具体如下图所示。 3.技术工具 Python版本:3.9
代码编辑器：jupyter notebook
4.实验过程 4.1导入数据 导入数据分析的第三方库并加载数据集
查看数据大小
查看数据基本信息
查看数据描述性统计
4.2数据预处理 统计缺失值情况
发现个别变量存在少量或大量缺失值
这里我们先直接删除“楼层”和“距地铁距离”这两个变量（因为这两个变量缺失值较多），最后统一删除缺失值
处理“房屋租金”变量，只提取出金额数值
处理房屋面积，只提取出数值">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-12T16:12:28+08:00">
    <meta property="article:modified_time" content="2024-08-12T16:12:28+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于Python爬虫&#43;机器学习的长沙市租房价格预测研究</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p> <img alt="" src="https://images2.imgbox.com/56/78/5t7W4qfl_o.gif"></p> 
<blockquote> 
 <p>🤵‍♂️ 个人主页<a href="https://blog.csdn.net/m0_64336780" title="：@艾派森的个人主页">：@艾派森的个人主页</a></p> 
 <p>✍🏻作者简介：Python学习者<br> 🐋 希望大家多多支持，我们一起进步！😄<br> 如果文章对你有帮助的话，<br> 欢迎评论 💬点赞👍🏻 收藏 📂加关注+</p> 
</blockquote> 
<hr> 
<h2 id="%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2">写在前面</h2> 
<p style="margin-left:0cm;">最近有粉丝问我“什么 AI 工具好”，其实还是得看自己的使用场景，很难说有最好用，只有最合自己胃口的。对我来说，好用的 AI 工具满足几个标准：</p> 
<ol><li style="text-align:justify;"><strong>使用方便</strong>。用的时候不要太麻烦，最好一键就能启用</li><li style="text-align:justify;"><strong>功能丰富</strong>。这样可以覆盖绝大多数的使用场景</li><li style="text-align:justify;"><strong>性能一流</strong>。决定上限</li><li style="text-align:justify;"><strong>价格实惠</strong>。这很重要</li></ol> 
<p style="margin-left:0cm;">以前我用 ChatGPT 最多，主要是当时没别的可选，就它最厉害，但现在大模型之间的性能差距越来越小，所以慢慢地其他工具就一块用了，比如 Claude、Kimi，AI 搜索的 Perplexity，综合起来看，我目前用得频率最高、也是最顺手的 AI 工具反而是一个浏览器插件<strong>“<a class="link-info" href="https://ilingban.com/browser_extension/?from=aps" rel="nofollow" title="灵办 AI">灵办 AI</a>”</strong>。功能挺多，该有的都有，比如：</p> 
<ul><li style="text-align:justify;">AI 对话</li><li style="text-align:justify;">翻译</li><li style="text-align:justify;">阅读（网页+文档）</li><li style="text-align:justify;">联网搜索</li><li style="text-align:justify;">AI 写作</li><li style="text-align:justify;">.....</li></ul> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/bc/f7/pLICV6bt_o.png"></p> 
<p>感兴趣的小伙伴点击下方链接即可免费注册使用：（推荐使用电脑）</p> 
<p><a href="https://ilingban.com/browser_extension/?from=aps" rel="nofollow" title="https://ilingban.com/browser_extension/?from=aps">https://ilingban.com/browser_extension/?from=aps</a></p> 
<hr> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="1.%E9%A1%B9%E7%9B%AE%E8%83%8C%E6%99%AF-toc" style="margin-left:0px;"><a href="#1.%E9%A1%B9%E7%9B%AE%E8%83%8C%E6%99%AF" rel="nofollow">1.项目背景</a></p> 
<p id="2.%E6%95%B0%E6%8D%AE%E9%9B%86%E4%BB%8B%E7%BB%8D-toc" style="margin-left:0px;"><a href="#2.%E6%95%B0%E6%8D%AE%E9%9B%86%E4%BB%8B%E7%BB%8D" rel="nofollow">2.数据集介绍</a></p> 
<p id="3.%E6%8A%80%E6%9C%AF%E5%B7%A5%E5%85%B7-toc" style="margin-left:0px;"><a href="#3.%E6%8A%80%E6%9C%AF%E5%B7%A5%E5%85%B7" rel="nofollow">3.技术工具</a></p> 
<p id="4.%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-toc" style="margin-left:0px;"><a href="#4.%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B" rel="nofollow">4.实验过程</a></p> 
<p id="4.1%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE-toc" style="margin-left:40px;"><a href="#4.1%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE" rel="nofollow">4.1导入数据</a></p> 
<p id="4.2%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86-toc" style="margin-left:40px;"><a href="#4.2%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86" rel="nofollow">4.2数据预处理</a></p> 
<p id="4.3%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96-toc" style="margin-left:40px;"><a href="#4.3%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96" rel="nofollow">4.3数据可视化</a></p> 
<p id="4.4%E7%89%B9%E5%BE%81%E5%B7%A5%E7%A8%8B-toc" style="margin-left:40px;"><a href="#4.4%E7%89%B9%E5%BE%81%E5%B7%A5%E7%A8%8B" rel="nofollow">4.4特征工程</a></p> 
<p id="4.5%E6%9E%84%E5%BB%BA%E6%A8%A1%E5%9E%8B-toc" style="margin-left:40px;"><a href="#4.5%E6%9E%84%E5%BB%BA%E6%A8%A1%E5%9E%8B" rel="nofollow">4.5构建模型</a></p> 
<p id="4.6%E7%89%B9%E5%BE%81%E9%87%8D%E8%A6%81%E6%80%A7-toc" style="margin-left:40px;"><a href="#4.6%E7%89%B9%E5%BE%81%E9%87%8D%E8%A6%81%E6%80%A7" rel="nofollow">4.6特征重要性</a></p> 
<p id="4.7%E6%A8%A1%E5%9E%8B%E9%A2%84%E6%B5%8B%C2%A0-toc" style="margin-left:40px;"><a href="#4.7%E6%A8%A1%E5%9E%8B%E9%A2%84%E6%B5%8B%C2%A0" rel="nofollow">4.7模型预测 </a></p> 
<p id="%E6%BA%90%E4%BB%A3%E7%A0%81-toc" style="margin-left:40px;"><a href="#%E6%BA%90%E4%BB%A3%E7%A0%81" rel="nofollow">源代码</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="1.%E9%A1%B9%E7%9B%AE%E8%83%8C%E6%99%AF">1.项目背景</h2> 
<p>        在当今数字化快速发展的时代，数据已成为驱动决策和预测未来的重要力量。房地产市场作为国民经济的重要组成部分，其价格的波动不仅直接影响着居民的生活水平，也反映了国家宏观经济的运行状况。长沙市，作为湖南省的省会城市，近年来随着经济的快速发展和城市化进程的加速，租房市场也呈现出蓬勃发展的态势。</p> 
<p>        然而，租房价格的波动受到多种因素的影响，包括供求关系、地理位置、房屋类型、装修状况、交通便捷性、周边设施等。这些因素之间相互交织，形成了复杂的动态系统，使得租房价格的预测变得尤为困难。传统的预测方法，如基于经验或简单统计的预测，往往难以准确反映市场变化，且难以适应复杂多变的市场环境。</p> 
<p>        为了更准确地预测长沙市租房价格，本研究将采用基于Python爬虫和机器学习的方法。Python爬虫技术可以从互联网上大量抓取相关的租房数据，包括房源信息、价格、地理位置、房屋类型等，为后续的机器学习模型提供丰富的数据基础。而机器学习技术则可以通过对大量数据的分析和学习，自动发现数据中的规律和模式，从而实现对租房价格的准确预测。</p> 
<p>        具体来说，本研究将分为以下几个步骤：首先，利用Python爬虫技术从各大租房网站和平台上抓取相关的租房数据；其次，对抓取的数据进行清洗、预处理和特征工程，提取出与租房价格相关的关键特征；然后，选择合适的机器学习算法（如线性回归、决策树、随机森林、神经网络等），构建租房价格预测模型；最后，通过模型训练和验证，不断优化模型参数，提高预测精度。</p> 
<p>        本研究旨在通过Python爬虫和机器学习技术的结合，实现对长沙市租房价格的准确预测，为政府决策、房地产开发商、租赁企业和租户等提供有价值的参考信息。同时，本研究也将为机器学习在房地产价格预测领域的应用提供新的思路和方法，具有一定的理论意义和实践价值。</p> 
<h2 id="2.%E6%95%B0%E6%8D%AE%E9%9B%86%E4%BB%8B%E7%BB%8D">2.数据集介绍</h2> 
<p>        本实验数据集来源于房天下官网，通过使用python爬虫获取了长沙市的租房数据</p> 
<p><img alt="" height="869" src="https://images2.imgbox.com/27/73/HmFOY3Iw_o.png" width="1200"></p> 
<p>获取了房屋租金、交付方式、房屋户型、房屋面积、装修情况、校区、地址、配套设施、房源亮点等字段信息，具体如下图所示。 </p> 
<p><img alt="" height="817" src="https://images2.imgbox.com/e1/a9/C0ZnOVGE_o.png" width="1200"></p> 
<h2 id="3.%E6%8A%80%E6%9C%AF%E5%B7%A5%E5%85%B7">3.技术工具</h2> 
<p>Python版本:3.9</p> 
<p>代码编辑器：jupyter notebook</p> 
<h2 id="4.%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B">4.实验过程</h2> 
<h3 id="4.1%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE">4.1导入数据</h3> 
<p>导入数据分析的第三方库并加载数据集</p> 
<p><img alt="" height="275" src="https://images2.imgbox.com/6f/1b/utZCBphd_o.png" width="591"></p> 
<p><img alt="" height="485" src="https://images2.imgbox.com/a9/ae/dViM0muJ_o.png" width="1200"></p> 
<p>查看数据大小</p> 
<p><img alt="" height="80" src="https://images2.imgbox.com/98/4f/tXQweKJ9_o.png" width="281"></p> 
<p>查看数据基本信息</p> 
<p><img alt="" height="537" src="https://images2.imgbox.com/5b/47/ze3y0cZu_o.png" width="393"></p> 
<p>查看数据描述性统计</p> 
<p><img alt="" height="665" src="https://images2.imgbox.com/a9/8a/11RucTgd_o.png" width="787"></p> 
<h3 id="4.2%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86">4.2数据预处理</h3> 
<p>统计缺失值情况</p> 
<p><img alt="" height="414" src="https://images2.imgbox.com/db/01/XwitG0lq_o.png" width="346"></p> 
<p>发现个别变量存在少量或大量缺失值</p> 
<p>这里我们先直接删除“楼层”和“距地铁距离”这两个变量（因为这两个变量缺失值较多），最后统一删除缺失值</p> 
<p><img alt="" height="92" src="https://images2.imgbox.com/53/01/3ahE8EHd_o.png" width="501"></p> 
<p> 处理“房屋租金”变量，只提取出金额数值</p> 
<p><img alt="" height="340" src="https://images2.imgbox.com/4c/d7/1ucPqHpC_o.png" width="649"></p> 
<p>处理房屋面积，只提取出数值</p> 
<p><img alt="" height="340" src="https://images2.imgbox.com/61/7b/HjMRdxZZ_o.png" width="562"></p> 
<h3 id="4.3%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96">4.3数据可视化</h3> 
<p><img alt="" height="663" src="https://images2.imgbox.com/14/ad/l7Bmxg5z_o.png" width="718"></p> 
<p><img alt="" height="661" src="https://images2.imgbox.com/85/87/xP2cT110_o.png" width="791"></p> 
<p><img alt="" height="600" src="https://images2.imgbox.com/7b/06/dIAcKR8b_o.png" width="788"></p> 
<p><img alt="" height="657" src="https://images2.imgbox.com/86/ea/PO5Ji2Dp_o.png" width="783"></p> 
<p><img alt="" height="636" src="https://images2.imgbox.com/48/e4/TI3kwd3P_o.png" width="783"></p> 
<p><img alt="" height="662" src="https://images2.imgbox.com/1f/25/QPcohoLj_o.png" width="792"></p> 
<p><img alt="" height="575" src="https://images2.imgbox.com/7f/44/kxh8reCv_o.png" width="620"></p> 
<p><img alt="" height="662" src="https://images2.imgbox.com/1d/ed/TfyKGqH2_o.png" width="818"></p> 
<p><img alt="" height="657" src="https://images2.imgbox.com/45/3c/kKyKgoML_o.png" width="809"></p> 
<p><img alt="" height="576" src="https://images2.imgbox.com/99/d0/io9V16k3_o.png" width="626"></p> 
<p><img alt="" height="663" src="https://images2.imgbox.com/b6/d3/ML12NTWn_o.png" width="814"></p> 
<p><img alt="" height="561" src="https://images2.imgbox.com/9a/8b/OVn7vKi2_o.png" width="614"></p> 
<p><img alt="" height="665" src="https://images2.imgbox.com/3c/13/Yyr4J0Py_o.png" width="784"></p> 
<p><img alt="" height="776" src="https://images2.imgbox.com/70/a8/TXIgsRZv_o.png" width="984"></p> 
<p>自定义一个画词云图的函数</p> 
<p><img alt="" height="824" src="https://images2.imgbox.com/f4/d5/AB67rTDB_o.png" width="1109"></p> 
<p>做出房源亮点词云图 </p> 
<p><img alt="" height="277" src="https://images2.imgbox.com/8f/c6/16GkiOoM_o.png" width="1200"></p> 
<p><img alt="" height="800" src="https://images2.imgbox.com/20/73/uYmb3IUv_o.png" width="800"></p> 
<p> 做出配套设施词云图</p> 
<p><img alt="" height="96" src="https://images2.imgbox.com/31/2f/KN7QPeyA_o.png" width="1200"></p> 
<p><img alt="" height="800" src="https://images2.imgbox.com/94/dc/eXv6yAW2_o.png" width="800"></p> 
<h3 id="4.4%E7%89%B9%E5%BE%81%E5%B7%A5%E7%A8%8B">4.4特征工程</h3> 
<p>筛选特征</p> 
<p><img alt="" height="603" src="https://images2.imgbox.com/6d/51/fvoCc0Q7_o.png" width="689"></p> 
<p>对非数值变量进行编码处理</p> 
<p><img alt="" height="645" src="https://images2.imgbox.com/1a/a4/QoqGdKwR_o.png" width="551"></p> 
<p>准备建模所需数据，即特征变量X和目标变量y，接着拆分数据集为训练集和测试集，其中测试集比例为0.2</p> 
<p><img alt="" height="246" src="https://images2.imgbox.com/f8/5d/fLBe19p2_o.png" width="770"></p> 
<h3 id="4.5%E6%9E%84%E5%BB%BA%E6%A8%A1%E5%9E%8B">4.5构建模型</h3> 
<p>定义一个训练模型并输出模型的评估指标</p> 
<p><img alt="" height="322" src="https://images2.imgbox.com/d9/85/YkpqYhha_o.png" width="703"></p> 
<p>构建多元回归模型</p> 
<p><img alt="" height="246" src="https://images2.imgbox.com/80/3c/ziVRhCcJ_o.png" width="478"></p> 
<p><img alt="" height="436" src="https://images2.imgbox.com/de/15/gtgRgN71_o.png" width="594"></p> 
<p>构建KNN模型</p> 
<p><img alt="" height="256" src="https://images2.imgbox.com/17/2f/nuS2NHXT_o.png" width="476"></p> 
<p><img alt="" height="436" src="https://images2.imgbox.com/40/ca/RQnWOzmb_o.png" width="608"><img alt="" height="250" src="https://images2.imgbox.com/e7/4a/h93G16pW_o.png" width="463"></p> 
<p><img alt="" height="436" src="https://images2.imgbox.com/ef/87/ZqySHNlk_o.png" width="594"></p> 
<p><img alt="" height="249" src="https://images2.imgbox.com/0d/61/OZJ5Ga8b_o.png" width="479"></p> 
<p><img alt="" height="436" src="https://images2.imgbox.com/ac/54/R3P05nxP_o.png" width="594"></p> 
<p><img alt="" height="248" src="https://images2.imgbox.com/12/6d/X2F3V5HG_o.png" width="521"></p> 
<p><img alt="" height="436" src="https://images2.imgbox.com/d0/06/TCbHn45w_o.png" width="594"></p> 
<p><img alt="" height="472" src="https://images2.imgbox.com/18/b5/jShWNhK2_o.png" width="714"></p> 
<p><img alt="" height="436" src="https://images2.imgbox.com/51/7f/yZ2pkjfP_o.png" width="594"></p> 
<p>从上面构建的模型中，XGBoost模型的准确率最高，为0.98 ，故我们选择其作为最终模型。</p> 
<h3 id="4.6%E7%89%B9%E5%BE%81%E9%87%8D%E8%A6%81%E6%80%A7">4.6特征重要性</h3> 
<p>获取模型特征重要性并排序打印输出，最后进行可视化展示</p> 
<p><img alt="" height="447" src="https://images2.imgbox.com/79/a9/HvvgJxTz_o.png" width="458"></p> 
<p><img alt="" height="531" src="https://images2.imgbox.com/4e/f6/5uKGFlDx_o.png" width="874"></p> 
<h3 id="4.7%E6%A8%A1%E5%9E%8B%E9%A2%84%E6%B5%8B%C2%A0">4.7模型预测 </h3> 
<p> <img alt="" height="587" src="https://images2.imgbox.com/73/ff/laZOnAlV_o.png" width="274"></p> 
<p>将预测结果可视化展示 </p> 
<p><img alt="" height="193" src="https://images2.imgbox.com/53/21/JoGAFHZT_o.png" width="702"></p> 
<p><img alt="" height="530" src="https://images2.imgbox.com/2f/72/4fzWykSX_o.png" width="862"></p> 
<h3 id="%E6%BA%90%E4%BB%A3%E7%A0%81">源代码</h3> 
<pre><code class="language-python">import matplotlib.pylab as plt
import numpy as np
import seaborn as sns
import pandas as pd
plt.rcParams['font.sans-serif'] = ['SimHei'] #解决中文显示
plt.rcParams['axes.unicode_minus'] = False   #解决符号无法显示
sns.set(font='SimHei')
import warnings
warnings.filterwarnings('ignore')

df = pd.read_csv('长沙租房数据.csv') # 导入数据
df.head() # 查看数据前五行
df.shape # 查看数据大小
df.info() # 查看数据基本信息
df.describe().T # 查看数据描述性统计
df.isnull().sum() # 统计缺失值情况
df.drop(['距地铁距离','楼层'],axis=1,inplace=True)
df.dropna(inplace=True)
df['房屋租金'] = df['房屋租金'].apply(lambda x:int(x.split('元')[0]))
df['房屋租金']
df['房屋面积'] = df['房屋面积'].apply(lambda x:int(x[:-2]))
df['房屋面积']
sns.boxplot(data=df,x='房屋租金')
plt.show()
sns.histplot(data=df,x='房屋租金',kde=True)
plt.show()
sns.boxplot(data=df,y='房屋面积')
plt.show()
sns.histplot(data=df,x='房屋面积',kde=True)
plt.show()
plt.scatter(x=df['房屋面积'],y=df['房屋租金'])
plt.show()
sns.countplot(data=df,x='交付方式')
plt.show()
df['出租方式'].value_counts().plot(kind='pie',autopct='%.2f%%')
plt.show()
sns.boxplot(data=df,y='房屋租金',x='交付方式')
plt.show()
sns.boxplot(data=df,y='房屋租金',x='出租方式')
plt.show()
df['房屋朝向'].value_counts().plot(kind='pie',autopct='%.2f%%')
plt.show()
sns.barplot(data=df,x='房屋朝向',y='房屋租金')
plt.show()
df['房屋装修'].value_counts().plot(kind='pie',autopct='%.2f%%')
plt.show()
sns.barplot(data=df,x='房屋装修',y='房屋租金')
plt.show()
# 相关性分析
sns.heatmap(df.corr(),vmax=1,annot=True,linewidths=0.5,cbar=False,cmap='YlGnBu',annot_kws={'fontsize':18})
plt.xticks(fontsize=20)
plt.yticks(fontsize=20)
plt.title('各个因素之间的相关系数',fontsize=20)
plt.show()
import jieba
import collections
import re
import stylecloud
from PIL import Image

def draw_WorldCloud(df,pic_name,color='black'):
    data =  ''.join([item for item in df])
    # 文本预处理 ：去除一些无用的字符只提取出中文出来
    new_data = re.findall('[\u4e00-\u9fa5]+', data, re.S)
    new_data = "".join(new_data)
    # 文本分词
    seg_list_exact = jieba.cut(new_data, cut_all=True)
    result_list = []
    with open('停用词库.txt', encoding='utf-8') as f: #可根据需要打开停用词库，然后加上不想显示的词语
        con = f.readlines()
        stop_words = set()
        for i in con:
            i = i.replace("\n", "")   # 去掉读取每一行数据的\n
            stop_words.add(i)

    for word in seg_list_exact:
        if word not in stop_words and len(word) &gt; 1:
            result_list.append(word)
    word_counts = collections.Counter(result_list)

    # 词频统计：获取前100最高频的词
    word_counts_top = word_counts.most_common(100)
    print(word_counts_top)

    # 绘制词云图
    stylecloud.gen_stylecloud(text=' '.join(result_list[:500]), # 提取500个词进行绘图
                            collocations=False, # 是否包括两个单词的搭配（二字组）
                            font_path=r'C:\Windows\Fonts\msyh.ttc', #设置字体，参考位置为  C:\Windows\Fonts\ ，根据里面的字体编号来设置
                            size=800, # stylecloud 的大小
                            palette='cartocolors.qualitative.Bold_7', # 调色板，调色网址： https://jiffyclub.github.io/palettable/
                            background_color=color, # 背景颜色
                            icon_name='fas fa-circle', # 形状的图标名称 蒙版网址：https://fontawesome.com/icons?d=gallery&amp;p=2&amp;c=chat,shopping,travel&amp;m=free
                            gradient='horizontal', # 梯度方向
                            max_words=2000, # stylecloud 可包含的最大单词数
                            max_font_size=150, # stylecloud 中的最大字号
                            stopwords=True, # 布尔值，用于筛除常见禁用词
                            output_name=f'{pic_name}.png') # 输出图片
    # 打开图片展示
    img=Image.open(f'{pic_name}.png')
    img.show()
draw_WorldCloud(df['房源亮点'],'房源亮点词云图') # 词云图可视化
draw_WorldCloud(df['配套设施'],'配套设施词云图') # 词云图可视化
# 编码处理
df['交付方式'].replace({'押一付三':0,'押一付一':1,'面议':2,'押一付二':3,'年付':4,'半年付':5},inplace=True)
df['房屋朝向'].replace({'东':0,'南':1,'西':2,'北':3,'南北':4,'东南':5,'东西':6,'西北':7,'不限':8},inplace=True)
df['房屋装修'].replace({'毛坯':0,'简装修':1,'精装修':2,'豪华装修':3},inplace=True)
# 特征筛选
new_df = df[['房屋租金', '交付方式',  '房屋面积', '房屋朝向','房屋装修',]]
new_df
from sklearn.model_selection import train_test_split
# 准备数据
X = new_df.drop('房屋租金',axis=1)
y = new_df['房屋租金']
# 划分数据集
X_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.2,random_state=42)
print('训练集大小:',X_train.shape[0])
print('测试集大小:',X_test.shape[0])
from sklearn.metrics import r2_score,mean_absolute_error,mean_squared_error
# 定义一个训练模型并输出模型的评估指标
def train_model(ml_model):
    print("Model is: ", ml_model)
    model = ml_model.fit(X_train, y_train)
    print("Training score: ", model.score(X_train,y_train))
    predictions = model.predict(X_test)
    r2score = r2_score(y_test, predictions)
    print("r2 score is: ", r2score)
    print('MAE:', mean_absolute_error(y_test,predictions))
    print('MSE:', mean_squared_error(y_test,predictions))
    print('RMSE:', np.sqrt(mean_squared_error(y_test,predictions)))
    # 真实值和预测值的差值
    sns.distplot(y_test - predictions)
# 构建多元线性回归
from sklearn.linear_model import LinearRegression
lg = LinearRegression()
train_model(lg)
# 构建knn回归
from sklearn.neighbors import KNeighborsRegressor
knn = KNeighborsRegressor()
train_model(knn)
# 构建决策树回归
from sklearn.tree import DecisionTreeRegressor
tree = DecisionTreeRegressor()
train_model(tree)
# 构建随机森林回归
from sklearn.ensemble import RandomForestRegressor
forest = RandomForestRegressor()
train_model(forest)
# GBDT回归
from sklearn.ensemble import GradientBoostingRegressor
gbdt = GradientBoostingRegressor()
train_model(gbdt)
# 构建xgboost回归模型
from xgboost import XGBRegressor
xgb = XGBRegressor()
train_model(xgb)
# 特征重要性评分
feat_labels = X_train.columns[0:]
importances = xgb.feature_importances_
indices = np.argsort(importances)[::-1]
index_list = []
value_list = []
for f,j in zip(range(X_train.shape[1]),indices):
    index_list.append(feat_labels[j])
    value_list.append(importances[j])
    print(f + 1, feat_labels[j], importances[j])
plt.figure(figsize=(10,6))
plt.barh(index_list[::-1],value_list[::-1])
plt.yticks(fontsize=12)
plt.title('各特征重要程度排序',fontsize=14)
plt.show()
# 模型预测
y_pred = xgb.predict(X_test)
result_df = pd.DataFrame()
result_df['真实值'] = y_test
result_df['预测值'] = y_pred
result_df.head(10)
# 模型预测可视化
plt.figure(figsize=(10,6))  
plt.plot(range(len(y_test))[:200],y_pred[:200],'b',label='predict')
plt.plot(range(len(y_test))[:200],y_test[:200],'r',label='test')
plt.legend(loc='upper right',fontsize=15)
plt.xlabel('the number of house',fontdict={'weight': 'normal', 'size': 15})
plt.ylabel('value of Price',fontdict={'weight': 'normal', 'size': 15})
plt.show()
import joblib
joblib.dump(xgb,'model.pkl')
new_df
x_data = pd.DataFrame(data=[['面议',141,'南','简装修']],columns=['交付方式','房屋面积','房屋朝向','房屋装修'])
x_data
# 编码处理
x_data['交付方式'].replace({'押一付三':0,'押一付一':1,'面议':2,'押一付二':3,'年付':4,'半年付':5},inplace=True)
x_data['房屋朝向'].replace({'东':0,'南':1,'西':2,'北':3,'南北':4,'东南':5,'东西':6,'西北':7,'不限':8},inplace=True)
x_data['房屋装修'].replace({'毛坯':0,'简装修':1,'精装修':2,'豪华装修':3},inplace=True)
x_data
model = joblib.load('model.pkl')
result = model.predict(x_data)[0]
result
</code></pre> 
<p style="text-align:center;"><span style="color:#000000;">资料获取，更多粉丝福利，关注下方公众号获取</span></p> 
<p style="margin-left:0px;text-align:center;"><span style="color:#4d4d4d;"><span style="background-color:#ffffff;"><img alt="在这里插入图片描述" src="https://images2.imgbox.com/65/47/s2LSRMud_o.gif"></span></span></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/33f0f2b1a5d384d74475e55cf01512df/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">算法：魔法字典</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c4868e4ed29dd06e2d9c688a7b3a60bc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">css实现水滴效果图</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>