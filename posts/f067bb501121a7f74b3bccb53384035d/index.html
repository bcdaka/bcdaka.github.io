<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用Docker部署DataX3.0&#43;DataX-Web - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/f067bb501121a7f74b3bccb53384035d/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="使用Docker部署DataX3.0&#43;DataX-Web">
  <meta property="og:description" content="1、准备基础镜像，开通所需端口 先查看3306和9527端口是否开放，如果未开放先在防火墙添加
firewall-cmd --zone=public --add-port=3306/tcp --permanent firewall-cmd --zone=public --add-port=9527/tcp --permanent firewall-cmd --reload systemctl stop docker systemctl restart docker 拉取镜像
docker pull linshellfeng/datax_web:3.0.1 或者
docker pull swr.cn-north-1.myhuaweicloud.com/softwares/datax-web:2.1.2 注意：datax_web:3.0.1镜像已经整合了datax3.0和datax-web，整合后的镜像大小约990M
2、初始化数据库 下载DataX-Web源码
https://github.com/WeiYe-Jing/datax-web 1.IDEA编译打包 下载链接：https://pan.baidu.com/s/13a8nIpz6FL8y4fdE94trjQ 提取码：data 2.官方提供的版本tar版本包 https://pan.baidu.com/s/13yoqhGpD00I82K4lOYtQhg 提取码：cpsk 创建数据库
mysql&gt; create database datax_web; 解压DataX-Web压缩包
# 找到 bin/db/datax_web.sql 文件，进行初始化 3、在宿主机创建挂载文件 在宿主机创建/usr/datax/datax-web/datax-admin/conf目录，并将bootstrap.properties拷贝到/usr/datax/datax-web/datax-admin/conf目录下，该文件用来配置datax-web连接数据库的信息，ip地址和xxxxxx需要按实际情况填写。
bootstrap.properties内容参考如下：
#Database DB_HOST=192.168.1.xx DB_PORT=3306 DB_USERNAME=datax_web DB_PASSWORD=xxxxxx DB_DATABASE=datax_web_db 4、启动容器 docker run -d --name datax_web -p 9527:9527 -v /usr/datax/datax-web/datax-admin/conf/bootstrap.properties:/home/datax/datax-web-2.1.2/modules/datax-admin/conf/bootstrap.properties linshellfeng/datax_web:3.0.1 或者
docker run -d --name datax_web -p 9527:9527 -v /usr/datax/datax-web/datax-admin/conf/bootstrap.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-02-27T16:22:12+08:00">
    <meta property="article:modified_time" content="2024-02-27T16:22:12+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用Docker部署DataX3.0&#43;DataX-Web</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3></h3> 
<h4>1、准备基础镜像，开通所需端口</h4> 
<p>先查看3306和9527端口是否开放，如果未开放先在防火墙添加</p> 
<pre><code>firewall-cmd --zone=public --add-port=3306/tcp --permanent
firewall-cmd --zone=public --add-port=9527/tcp --permanent
firewall-cmd --reload
systemctl stop docker
systemctl restart docker</code></pre> 
<p>拉取镜像</p> 
<pre><code>docker pull linshellfeng/datax_web:3.0.1</code></pre> 
<p>或者</p> 
<pre><code>docker pull swr.cn-north-1.myhuaweicloud.com/softwares/datax-web:2.1.2</code></pre> 
<p>注意：datax_web:3.0.1镜像已经整合了datax3.0和datax-web，整合后的镜像大小约990M</p> 
<h4>2、初始化数据库</h4> 
<p>下载DataX-Web源码</p> 
<pre><code>https://github.com/WeiYe-Jing/datax-web
1.IDEA编译打包
下载链接：https://pan.baidu.com/s/13a8nIpz6FL8y4fdE94trjQ 提取码：data
2.官方提供的版本tar版本包
https://pan.baidu.com/s/13yoqhGpD00I82K4lOYtQhg 提取码：cpsk</code></pre> 
<p>创建数据库</p> 
<pre><code>mysql&gt; create database datax_web;</code></pre> 
<p>解压DataX-Web压缩包</p> 
<pre><code># 找到 bin/db/datax_web.sql 文件，进行初始化</code></pre> 
<h4>3、在宿主机创建挂载文件</h4> 
<p>在宿主机创建/usr/datax/datax-web/datax-admin/conf目录，并将bootstrap.properties拷贝到/usr/datax/datax-web/datax-admin/conf目录下，该文件用来配置datax-web连接数据库的信息，ip地址和xxxxxx需要按实际情况填写。</p> 
<p>bootstrap.properties内容参考如下：</p> 
<pre><code>#Database
DB_HOST=192.168.1.xx
DB_PORT=3306
DB_USERNAME=datax_web
DB_PASSWORD=xxxxxx
DB_DATABASE=datax_web_db</code></pre> 
<h4>4、启动容器</h4> 
<pre><code>docker run -d --name datax_web -p 9527:9527 -v /usr/datax/datax-web/datax-admin/conf/bootstrap.properties:/home/datax/datax-web-2.1.2/modules/datax-admin/conf/bootstrap.properties linshellfeng/datax_web:3.0.1</code></pre> 
<p>或者</p> 
<pre><code>docker run -d --name datax_web -p 9527:9527 -v /usr/datax/datax-web/datax-admin/conf/bootstrap.properties:/home/datax/datax-web-2.1.2/modules/datax-admin/conf/bootstrap.properties swr.cn-north-1.myhuaweicloud.com/softwares/datax-web:2.1.2</code></pre> 
<h4>5、进入容器内部（非必要步骤，用来测试datax_web容器是否正常启动）</h4> 
<p>docker exec -it datax_web /bin/bash</p> 
<h4>6、测试是否datax-web服务是否正常启动</h4> 
<p>在容器内：curl http://127.0.0.1:9527/index.html<br> 使用浏览器访问宿主机服务：http://宿主机ip:9527/index.html</p> 
<p>使用admin/123456登录后及时修改密码</p> 
<h4>7、异常处理</h4> 
<p>当运行时：</p> 
<p><span style="color:#be191c;">[AnalysisStatistics.analysisStatisticsLog-53] com.alibaba.datax.common.exception.DataXException: Code:[Framework-03], Description:[DataX引擎配置错误，该问题通常是由于DataX安装错误引起，请联系您的运维解决 .]. - 在有总bps限速条件下，单个channel的bps值不能为空，也不能为非正数。</span><br> 在<span style="color:#be191c;">com\alibaba\datax\core\util\container\CoreConstant.java</span>源码中</p> 
<pre><code>public static final String DATAX_JOB_SETTING_SPEED_BYTE = "job.setting.speed.byte";

public static final String DATAX_JOB_SETTING_SPEED_RECORD = "job.setting.speed.record";



public static final String DATAX_CORE_TRANSPORT_CHANNEL_SPEED_BYTE = "core.transport.channel.speed.byte";

public static final String DATAX_CORE_TRANSPORT_CHANNEL_SPEED_RECORD = "core.transport.channel.speed.record";
</code></pre> 
<p><span style="color:#be191c;">com\alibaba\datax\core\job\JobContainer.java</span>源码中</p> 
<pre><code>boolean isByteLimit = (this.configuration.getInt(
                CoreConstant.DATAX_JOB_SETTING_SPEED_BYTE, 0) &gt; 0);
if (isByteLimit) {
            long globalLimitedByteSpeed = this.configuration.getInt(
                    CoreConstant.DATAX_JOB_SETTING_SPEED_BYTE, 10 * 1024 * 1024);

            // 在byte流控情况下，单个Channel流量最大值必须设置，否则报错！
            Long channelLimitedByteSpeed = this.configuration
                    .getLong(CoreConstant.DATAX_CORE_TRANSPORT_CHANNEL_SPEED_BYTE);
            if (channelLimitedByteSpeed == null || channelLimitedByteSpeed &lt;= 0) {
                throw DataXException.asDataXException(
                        FrameworkErrorCode.CONFIG_ERROR,
                        "在有总bps限速条件下，单个channel的bps值不能为空，也不能为非正数");
            }

</code></pre> 
<p>即下方的<span style="color:#be191c;">core.transport.channel.speed.byte</span>和<span style="color:#be191c;">job.setting.speed.byte</span>需要同时进行设置或全都不设置</p> 
<pre><code>{
  "core": {
    "transport": {
      "channel": {
        "speed": {
          "byte": 2000000   #大于0的数
        }
      }
    }
  },
  "job": {
    "setting": {
      "speed": {
        "channel": 3,
        "byte": 1048576  #大于0的数
      },

</code></pre> 
<p><span style="color:#be191c;">com\alibaba\datax\core\job\JobContainer.java</span>源码中</p> 
<pre><code>boolean isRecordLimit = (this.configuration.getInt(
                CoreConstant.DATAX_JOB_SETTING_SPEED_RECORD, 0)) &gt; 0;
        if (isRecordLimit) {
            long globalLimitedRecordSpeed = this.configuration.getInt(
                    CoreConstant.DATAX_JOB_SETTING_SPEED_RECORD, 100000);

            Long channelLimitedRecordSpeed = this.configuration.getLong(
                    CoreConstant.DATAX_CORE_TRANSPORT_CHANNEL_SPEED_RECORD);
            if (channelLimitedRecordSpeed == null || channelLimitedRecordSpeed &lt;= 0) {
                throw DataXException.asDataXException(FrameworkErrorCode.CONFIG_ERROR,
                        "在有总tps限速条件下，单个channel的tps值不能为空，也不能为非正数");
            }

</code></pre> 
<p>即构建的json文件中的<span style="color:#be191c;">core.transport.channel.speed.record</span>和<span style="color:#be191c;">job.setting.speed.record</span>需要同时进行设置或全都不设置。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fb26371cfd5cde58f2a85c2c1c69c835/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【DFS简单题汇总】递归与递推</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a33dfb9f13e19be52004ca1e8ce70e09/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">JAVA PDF 给PDF添加文字/图片水印（指定内容），并且设置位置</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>