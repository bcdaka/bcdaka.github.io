<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vue前端实现导出页面为word(两种方法) - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/5f5b48aeb1c5fcfe7d47102d7aada5dc/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="vue前端实现导出页面为word(两种方法)">
  <meta property="og:description" content="将vue页面导出为word文档，不用写模板，直接导出即可。 第一种方法(简单版) 第一步：安装所需依赖 npm install html-docx-js -S npm install file-saver -S 第二步：创建容器，页面使用方法 注意：在当前页面引入依赖
import FileSaver from &#34;file-saver&#34;; import htmlDocx from &#34;html-docx-js/dist/html-docx&#34;;** 第二种方法（需要使用jquery） 第一步：安装所需依赖 npm install jquery --save npm install file-saver 第二步：创建两个js文件，一个是jquery文件(jq.js)，一个是插件js的文件(jquery.wordexport.js)，我把这两个js文件都放到utils文件夹下，注意：使用的时候一定要注意引用路径。这两个js文件代码我都放到文章最后（有一个插件没有依赖包，所以需要自己创建一个js文件（jquery.wordexport.js）） 第三步：在需要导出的页面引入文件 import $ from &#34;@/utils/jq&#34;; // 文件引入路径一定要正确，这是第二步创建的js文件（jq.js） import saveAs from &#34;file-saver/dist/FileSaver&#34;; import &#34;@/utils/jquery.wordexport&#34;; // 文件引入路径一定要正确，这是第二步创建的js文件(jquery.wordexport.js) 第三步：页面使用方法 注意：如果导出的时候出现bug，大多是因为文件路径引入有问题，再次排查路径引入
jq.js import $ from &#34;jquery&#34;; window.$ = $; window.jQuery = $; export default $; jquery.wordexport.js if (typeof jQuery !== &#34;undefined&#34; &amp;&amp; typeof saveAs !">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-17T15:39:51+08:00">
    <meta property="article:modified_time" content="2024-05-17T15:39:51+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vue前端实现导出页面为word(两种方法)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="vueword_0"></a>将vue页面导出为word文档，不用写模板，直接导出即可。</h2> 
<h2><a id="_2"></a>第一种方法(简单版)</h2> 
<h3><a id="_5"></a>第一步：安装所需依赖</h3> 
<pre><code class="prism language-javascript">npm install html<span class="token operator">-</span>docx<span class="token operator">-</span>js <span class="token operator">-</span><span class="token constant">S</span>
npm install file<span class="token operator">-</span>saver <span class="token operator">-</span><span class="token constant">S</span>
</code></pre> 
<h3><a id="_13"></a>第二步：创建容器，页面使用方法</h3> 
<p><img src="https://images2.imgbox.com/c5/0a/7skX1RE3_o.png" alt="在这里插入图片描述"></p> 
<p>注意：在当前页面引入依赖</p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> FileSaver <span class="token keyword">from</span> <span class="token string">"file-saver"</span><span class="token punctuation">;</span> 
<span class="token keyword">import</span> htmlDocx <span class="token keyword">from</span> <span class="token string">"html-docx-js/dist/html-docx"</span><span class="token punctuation">;</span><span class="token operator">**</span>
</code></pre> 
<h2><a id="jquery_26"></a>第二种方法（需要使用jquery）</h2> 
<h3><a id="_28"></a>第一步：安装所需依赖</h3> 
<pre><code class="prism language-javascript">npm install jquery <span class="token operator">--</span>save
npm install file<span class="token operator">-</span>saver
</code></pre> 
<h3><a id="jsjqueryjqjsjsjquerywordexportjsjsutilsjsjsjquerywordexportjs_35"></a>第二步：创建两个js文件，一个是jquery文件(jq.js)，一个是插件js的文件(jquery.wordexport.js)，我把这两个js文件都放到utils文件夹下，注意：使用的时候一定要注意引用路径。这两个js文件代码我都放到文章最后（有一个插件没有依赖包，所以需要自己创建一个js文件（jquery.wordexport.js））</h3> 
<h3><a id="_37"></a>第三步：在需要导出的页面引入文件</h3> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> $ <span class="token keyword">from</span> <span class="token string">"@/utils/jq"</span><span class="token punctuation">;</span> <span class="token comment">// 文件引入路径一定要正确，这是第二步创建的js文件（jq.js）</span>
<span class="token keyword">import</span> saveAs <span class="token keyword">from</span> <span class="token string">"file-saver/dist/FileSaver"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">"@/utils/jquery.wordexport"</span><span class="token punctuation">;</span> <span class="token comment">// 文件引入路径一定要正确，这是第二步创建的js文件(jquery.wordexport.js)</span>
</code></pre> 
<h3><a id="_45"></a>第三步：页面使用方法</h3> 
<p><img src="https://images2.imgbox.com/61/69/MHzXxoNd_o.png" alt="在这里插入图片描述"></p> 
<p><strong>注意：如果导出的时候出现bug，大多是因为文件路径引入有问题，再次排查路径引入</strong></p> 
<h3><a id="jqjs_50"></a>jq.js</h3> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> $ <span class="token keyword">from</span> <span class="token string">"jquery"</span><span class="token punctuation">;</span>
  window<span class="token punctuation">.</span>$ <span class="token operator">=</span> $<span class="token punctuation">;</span>
  window<span class="token punctuation">.</span>jQuery <span class="token operator">=</span> $<span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> $<span class="token punctuation">;</span>
</code></pre> 
<h3><a id="jquerywordexportjs_59"></a>jquery.wordexport.js</h3> 
<pre><code class="prism language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> jQuery <span class="token operator">!==</span> <span class="token string">"undefined"</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> saveAs <span class="token operator">!==</span> <span class="token string">"undefined"</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">$</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      $<span class="token punctuation">.</span>fn<span class="token punctuation">.</span><span class="token function-variable function">wordExport</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">fileName</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          fileName <span class="token operator">=</span> <span class="token keyword">typeof</span> fileName <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">?</span> fileName <span class="token operator">:</span> <span class="token string">"jQuery-Word-Export"</span><span class="token punctuation">;</span>
          <span class="token keyword">var</span> <span class="token keyword">static</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
              <span class="token literal-property property">mhtml</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                  <span class="token literal-property property">top</span><span class="token operator">:</span>
                    <span class="token string">"Mime-Version: 1.0\nContent-Base: "</span> <span class="token operator">+</span>
                    location<span class="token punctuation">.</span>href <span class="token operator">+</span>
                    <span class="token string">'\nContent-Type: Multipart/related; boundary="NEXT.ITEM-BOUNDARY";type="text/html"\n\n--NEXT.ITEM-BOUNDARY\nContent-Type: text/html; charset="utf-8"\nContent-Location: '</span> <span class="token operator">+</span>
                    location<span class="token punctuation">.</span>href <span class="token operator">+</span>
                    <span class="token string">"\n\n&lt;!DOCTYPE html&gt;\n"</span> <span class="token operator">+</span>
                    <span class="token string">'&lt;html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" xmlns="http://www.w3.org/TR/REC-html40"&gt;\n_html_&lt;/html&gt;'</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">head</span><span class="token operator">:</span>
                    <span class="token string">'&lt;head&gt;\n&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;\n&lt;style&gt;\n_styles_\n&lt;/style&gt;\n&lt;!--[if gte mso 9]&gt;&lt;xml&gt;&lt;w:WordDocument&gt;&lt;w:View&gt;Print&lt;/w:View&gt;&lt;w:TrackMoves&gt;false&lt;/w:TrackMoves&gt;&lt;w:TrackFormatting/&gt;&lt;w:ValidateAgainstSchemas/&gt;&lt;w:SaveIfXMLInvalid&gt;false&lt;/w:SaveIfXMLInvalid&gt;&lt;w:IgnoreMixedContent&gt;false&lt;/w:IgnoreMixedContent&gt;&lt;w:AlwaysShowPlaceholderText&gt;false&lt;/w:AlwaysShowPlaceholderText&gt;&lt;w:DoNotPromoteQF/&gt;&lt;w:LidThemeOther&gt;EN-US&lt;/w:LidThemeOther&gt;&lt;w:LidThemeAsian&gt;ZH-CN&lt;/w:LidThemeAsian&gt;&lt;w:LidThemeComplexScript&gt;X-NONE&lt;/w:LidThemeComplexScript&gt;&lt;w:Compatibility&gt;&lt;w:BreakWrappedTables/&gt;&lt;w:SnapToGridInCell/&gt;&lt;w:WrapTextWithPunct/&gt;&lt;w:UseAsianBreakRules/&gt;&lt;w:DontGrowAutofit/&gt;&lt;w:SplitPgBreakAndParaMark/&gt;&lt;w:DontVertAlignCellWithSp/&gt;&lt;w:DontBreakConstrainedForcedTables/&gt;&lt;w:DontVertAlignInTxbx/&gt;&lt;w:Word11KerningPairs/&gt;&lt;w:CachedColBalance/&gt;&lt;w:UseFELayout/&gt;&lt;/w:Compatibility&gt;&lt;w:BrowserLevel&gt;MicrosoftInternetExplorer4&lt;/w:BrowserLevel&gt;&lt;m:mathPr&gt;&lt;m:mathFont m:val="Cambria Math"/&gt;&lt;m:brkBin m:val="before"/&gt;&lt;m:brkBinSub m:val="--"/&gt;&lt;m:smallFrac m:val="off"/&gt;&lt;m:dispDef/&gt;&lt;m:lMargin m:val="0"/&gt; &lt;m:rMargin m:val="0"/&gt;&lt;m:defJc m:val="centerGroup"/&gt;&lt;m:wrapIndent m:val="1440"/&gt;&lt;m:intLim m:val="subSup"/&gt;&lt;m:naryLim m:val="undOvr"/&gt;&lt;/m:mathPr&gt;&lt;/w:WordDocument&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;/head&gt;\n'</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token string">"&lt;body&gt;_body_&lt;/body&gt;"</span><span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">;</span>
          <span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
              <span class="token literal-property property">maxWidth</span><span class="token operator">:</span> <span class="token number">624</span><span class="token punctuation">,</span><span class="token comment">//最大宽度</span>
          <span class="token punctuation">}</span><span class="token punctuation">;</span>
          <span class="token comment">// Clone selected element before manipulating it</span>
          <span class="token keyword">var</span> markup <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

          <span class="token comment">// Remove hidden elements from the output</span>
          markup<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
              <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token string">':hidden'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                  self<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

          <span class="token comment">// Embed all images using Data URLs</span>
          <span class="token keyword">var</span> images <span class="token operator">=</span> <span class="token function">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">var</span> img <span class="token operator">=</span> markup<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token comment">// var img = new Image(); 用这一行的话，WPS不显示图片，用上面的——只兼容office Word。</span>
          <span class="token keyword">var</span> mhtmlBottom <span class="token operator">=</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
          <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> img<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
              <span class="token comment">// Calculate dimensions of output image</span>
              <span class="token keyword">var</span> w <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>img<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>width <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> options<span class="token punctuation">.</span>maxWidth <span class="token operator">:</span> img<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>width<span class="token punctuation">,</span> options<span class="token punctuation">.</span>maxWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token keyword">var</span> h <span class="token operator">=</span> <span class="token punctuation">(</span>img<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>height <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> options<span class="token punctuation">.</span>defaultLength <span class="token operator">:</span> img<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>height<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>w <span class="token operator">/</span> <span class="token punctuation">(</span>img<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>width <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> options<span class="token punctuation">.</span>maxWidth <span class="token operator">:</span> img<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>width<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

              <span class="token comment">// Create canvas for converting image to data URL</span>
              <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"CANVAS"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> w<span class="token punctuation">;</span>
              canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> h<span class="token punctuation">;</span>
              <span class="token comment">// Draw image to canvas</span>
              <span class="token keyword">var</span> context <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              context<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token comment">// Get data URL encoding of image</span>
              <span class="token keyword">var</span> uri <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">"image/png"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token comment">// console.log(i+":"+uri);</span>
              <span class="token function">$</span><span class="token punctuation">(</span>img<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"src"</span><span class="token punctuation">,</span> img<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>
              img<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>width <span class="token operator">=</span> w<span class="token punctuation">;</span>
              img<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>height <span class="token operator">=</span> h<span class="token punctuation">;</span>

              mhtmlBottom <span class="token operator">+=</span> <span class="token string">"--NEXT.ITEM-BOUNDARY\n"</span><span class="token punctuation">;</span>
              mhtmlBottom <span class="token operator">+=</span> <span class="token string">"Content-Location: "</span> <span class="token operator">+</span> uri <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
              mhtmlBottom <span class="token operator">+=</span> <span class="token string">"Content-Type: "</span> <span class="token operator">+</span> uri<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>uri<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> uri<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">";"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
              mhtmlBottom <span class="token operator">+=</span> <span class="token string">"Content-Transfer-Encoding: "</span> <span class="token operator">+</span> uri<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>uri<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">";"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> uri<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n\n"</span><span class="token punctuation">;</span>
              mhtmlBottom <span class="token operator">+=</span> uri<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>uri<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n\n"</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>

          mhtmlBottom <span class="token operator">+=</span> <span class="token string">"--NEXT.ITEM-BOUNDARY--"</span><span class="token punctuation">;</span>

          <span class="token comment">//TODO: load css from included stylesheet</span>
          <span class="token keyword">var</span> styles <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>

          <span class="token comment">// Aggregate parts of the file together</span>
          <span class="token keyword">var</span> fileContent <span class="token operator">=</span> <span class="token keyword">static</span><span class="token punctuation">.</span>mhtml<span class="token punctuation">.</span>top<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"_html_"</span><span class="token punctuation">,</span> <span class="token keyword">static</span><span class="token punctuation">.</span>mhtml<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"_styles_"</span><span class="token punctuation">,</span> styles<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">static</span><span class="token punctuation">.</span>mhtml<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"_body_"</span><span class="token punctuation">,</span> markup<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> mhtmlBottom<span class="token punctuation">;</span>

          <span class="token comment">// Create a Blob with the file contents</span>
          <span class="token keyword">var</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>fileContent<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
              <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"application/msword;charset=utf-8"</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token function">saveAs</span><span class="token punctuation">(</span>blob<span class="token punctuation">,</span> fileName <span class="token operator">+</span> <span class="token string">".doc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 注意：不要改成docx，不然会打不开！！！</span>
          
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>jQuery<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> jQuery <span class="token operator">===</span> <span class="token string">"undefined"</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"jQuery Word Export: missing dependency (jQuery)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> saveAs <span class="token operator">===</span> <span class="token string">"undefined"</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"jQuery Word Export: missing dependency (FileSaver.js)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ded44612f84428af35f4a41613df8f21/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Spring Cloud系列—Spring Cloud Gateway服务网关的部署与使用指南</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d33a9257469d764edd46a3fa9f182aeb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【flutter】 Running Gradle task ‘assembleDebug‘...超时问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>