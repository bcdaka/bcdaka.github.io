<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>spring boot3解决跨域的几种方式 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/c89a3c7931f88f84e4b2245dffa28212/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="spring boot3解决跨域的几种方式">
  <meta property="og:description" content="⛰️个人主页: 蒾酒
🔥系列专栏：《spring boot实战》
目录
1.前言
2.何为跨域
3.跨域问题出现特征
4.方式一：使用 @CrossOrigin 注解
5.方式二：自定义 WebMvcConfigurer
6.方式3：使用 Filter 进行跨域配置
7.最后
1.前言 本文介绍了spring boot中三种解决跨域问题的方式，坚持看完相信对你有帮助。
同时欢迎订阅springboot系列专栏，持续分享spring boot的使用经验。
2.何为跨域 跨域问题是指在 Web 开发中，一个网页的 JavaScript 代码通过 AJAX 请求后端服务器接口时，如果请求的目标地址与当前页面的地址不在同一个域（域名、端口或协议任何一项不同），就会产生跨域问题。这种情况下，根据浏览器的安全机制（同源策略）就会会限制页面的跨域请求，以防止恶意网站对其他网站的访问和操作，保护用户信息安全。
3.跨域问题出现特征 1.没有状态码信息
如果你看到某个请求似乎“失败了”，但并没有具体的HTTP状态码，这可能是因为浏览器出于安全原因阻止了对响应的访问。在开发者工具的网络(Network)面板中，这样的请求可能会被标记为“cancelled”或者没有显示状态码。
2.控制台报错
浏览器通常会在控制台(Console)中打印一条错误消息，说明因为CORS策略，请求被阻止了
4.方式一：使用 @CrossOrigin 注解 这是最直接简单的方式，可以精确控制所有接口
使用方法：在你的控制器类或者控制器方法上添加 @CrossOrigin 注解，可以精确控制某个控制器类、以及下面的某个方法的允许跨域的来源、允许的请求头、允许的请求方法等配置。
示例代码：
@RestController @RequestMapping(&#34;/user&#34;) @CrossOrigin(origins = &#34;*&#34;)//允许所有来源的请求跨域 @Tag(name = &#34;用户模块&#34;) public class UserController { private final UserService userService; public UserController(UserService userService) { this.userService = userService; } @PostMapping(&#34;/login&#34;) @Operation(summary = &#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-27T16:38:45+08:00">
    <meta property="article:modified_time" content="2024-04-27T16:38:45+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">spring boot3解决跨域的几种方式</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><img alt="" height="68" src="https://images2.imgbox.com/0b/5d/cU2RThK7_o.jpg" width="68"></p> 
<p><span style="color:#4da8ee;">⛰️<a href="https://so.csdn.net/so/search?q=%E4%B8%AA%E4%BA%BA%E4%B8%BB%E9%A1%B5&amp;spm=1001.2101.3001.7020" title="个人主页">个人主页</a>:     <a href="https://blog.csdn.net/qq_62262918?spm=1011.2266.3001.5343" title="蒾酒">蒾酒</a></span></p> 
<p><span style="color:#faa572;">🔥系列专栏：<a href="https://blog.csdn.net/qq_62262918/category_12571219.html?spm=1001.2014.3001.5482" title="《spring boot实战》">《spring boot实战》</a></span></p> 
<hr> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="1.%E5%89%8D%E8%A8%80-toc" style="margin-left:0px;"><a href="#1.%E5%89%8D%E8%A8%80" rel="nofollow">1.前言</a></p> 
<p id="1.%E4%BD%95%E4%B8%BA%E8%B7%A8%E5%9F%9F-toc" style="margin-left:0px;"><a href="#1.%E4%BD%95%E4%B8%BA%E8%B7%A8%E5%9F%9F" rel="nofollow">2.何为跨域</a></p> 
<p id="%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98%E5%87%BA%E7%8E%B0%E7%89%B9%E5%BE%81-toc" style="margin-left:0px;"><a href="#%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98%E5%87%BA%E7%8E%B0%E7%89%B9%E5%BE%81" rel="nofollow">3.跨域问题出现特征</a></p> 
<p id="%E6%96%B9%E5%BC%8F%E4%B8%80%EF%BC%9A%E4%BD%BF%E7%94%A8%20%40CrossOrigin%20%E6%B3%A8%E8%A7%A3-toc" style="margin-left:0px;"><a href="#%E6%96%B9%E5%BC%8F%E4%B8%80%EF%BC%9A%E4%BD%BF%E7%94%A8%20%40CrossOrigin%20%E6%B3%A8%E8%A7%A3" rel="nofollow">4.方式一：使用 @CrossOrigin 注解</a></p> 
<p id="%E6%96%B9%E5%BC%8F%E4%BA%8C%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%20WebMvcConfigurer-toc" style="margin-left:0px;"><a href="#%E6%96%B9%E5%BC%8F%E4%BA%8C%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%20WebMvcConfigurer" rel="nofollow">5.方式二：自定义 WebMvcConfigurer</a></p> 
<p id="%E6%96%B9%E5%BC%8F3%EF%BC%9A%E4%BD%BF%E7%94%A8%20Filter%20%E8%BF%9B%E8%A1%8C%E8%B7%A8%E5%9F%9F%E9%85%8D%E7%BD%AE-toc" style="margin-left:0px;"><a href="#%E6%96%B9%E5%BC%8F3%EF%BC%9A%E4%BD%BF%E7%94%A8%20Filter%20%E8%BF%9B%E8%A1%8C%E8%B7%A8%E5%9F%9F%E9%85%8D%E7%BD%AE" rel="nofollow">6.方式3：使用 Filter 进行跨域配置</a></p> 
<p id="%E6%9C%80%E5%90%8E-toc" style="margin-left:0px;"><a href="#%E6%9C%80%E5%90%8E" rel="nofollow">7.最后</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="1.%E5%89%8D%E8%A8%80">1.前言</h2> 
<p>本文介绍了spring boot中三种解决跨域问题的方式，坚持看完相信对你有帮助。</p> 
<p>同时欢迎订阅springboot系列专栏，持续分享spring boot的使用经验。</p> 
<p></p> 
<h2 id="1.%E4%BD%95%E4%B8%BA%E8%B7%A8%E5%9F%9F">2.何为跨域</h2> 
<p>跨域问题是指在 Web 开发中，一个网页的 JavaScript 代码通过 AJAX 请求后端服务器接口时，如果请求的<span style="background-color:#ffd900;">目标地址</span>与<span style="background-color:#ffd900;">当前页面的地址</span>不在同一个域（<span style="background-color:#ffd900;">域名</span>、<span style="background-color:#ffd900;">端口</span>或<span style="background-color:#ffd900;">协议</span>任何一项不同），就会产生跨域问题。这种情况下，根据浏览器的安全机制（<span style="background-color:#ffd900;">同源策略</span>）就会会限制页面的跨域请求，以防止恶意网站对其他网站的访问和操作，保护用户信息安全。</p> 
<h3></h3> 
<h2 id="%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98%E5%87%BA%E7%8E%B0%E7%89%B9%E5%BE%81">3.跨域问题出现特征</h2> 
<p><strong>1.没有状态码信息</strong></p> 
<p>如果你看到某个请求似乎“失败了”，但并没有具体的HTTP状态码，这可能是因为浏览器出于安全原因阻止了对响应的访问。在开发者工具的网络(Network)面板中，这样的请求可能会被标记为“cancelled”或者没有显示状态码。</p> 
<p><img alt="" height="178" src="https://images2.imgbox.com/a0/22/RspVdRlw_o.png" width="1171"></p> 
<p><strong>2.控制台报错</strong></p> 
<p>浏览器通常会在控制台(Console)中打印一条错误消息，说明因为CORS策略，请求被阻止了</p> 
<p><img alt="" height="87" src="https://images2.imgbox.com/b5/88/JLLFEsHc_o.png" width="1125"></p> 
<p></p> 
<h2 id="%E6%96%B9%E5%BC%8F%E4%B8%80%EF%BC%9A%E4%BD%BF%E7%94%A8%20%40CrossOrigin%20%E6%B3%A8%E8%A7%A3">4.方式一：使用 @CrossOrigin 注解</h2> 
<p>这是最直接简单的方式，可以精确控制所有接口</p> 
<p>使用方法：在你的控制器类或者控制器方法上添加 @CrossOrigin 注解，可以精确控制某个控制器类、以及下面的某个方法的允许跨域的来源、允许的请求头、允许的请求方法等配置。</p> 
<p>示例代码：</p> 
<pre><code class="language-java">@RestController
@RequestMapping("/user")
@CrossOrigin(origins = "*")//允许所有来源的请求跨域
@Tag(name = "用户模块")
public class UserController {
    private final UserService userService;

    public UserController(UserService userService) {
        this.userService = userService;
    }

    @PostMapping("/login")
    @Operation(summary = "用户登录")
    public UserLoginVO login(@RequestBody @Validated UserLoginDTO userLoginDTO) {
        return userService.login(userLoginDTO);
    }

}</code></pre> 
<blockquote> 
 <p>这种方式解决跨域需要在每个控制器上加注解，属于重复劳动对于不需要精确控制的场景属于重复劳动。可以看下下面方式</p> 
</blockquote> 
<p></p> 
<h2 id="%E6%96%B9%E5%BC%8F%E4%BA%8C%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%20WebMvcConfigurer">5.方式二：自定义 WebMvcConfigurer</h2> 
<p>通过实现 WebMvcConfigurer 接口来自定义 WebMvc 配置，并覆盖 addCorsMappings 方法以配置全局跨域规则。</p> 
<p>示例代码：</p> 
<pre><code class="language-java">import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.CorsRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

/**
 * @author mijiupro
 */
@Configuration
public class WebConfig implements WebMvcConfigurer {
    @Override
    public void addCorsMappings(CorsRegistry registry) {
        registry.addMapping("/**") // 对所有路径生效
                .allowedOrigins("*") //允许所有源地址
                // .allowedOrigins("https://mijiupro.com","https://mijiu.com ") // 允许的源地址（数组）
                .allowedMethods("GET", "POST", "PUT", "DELETE") // 允许的请求方法
                .allowedHeaders("*"); // 允许的请求头
    }
}</code></pre> 
<blockquote> 
 <p>这种方式实现了全局的配置，但是无法细腻到控制某个方法</p> 
</blockquote> 
<p></p> 
<h2 id="%E6%96%B9%E5%BC%8F3%EF%BC%9A%E4%BD%BF%E7%94%A8%20Filter%20%E8%BF%9B%E8%A1%8C%E8%B7%A8%E5%9F%9F%E9%85%8D%E7%BD%AE">6.方式3：使用 Filter 进行跨域配置</h2> 
<p>创建一个跨域过滤器，在其中设置允许的跨域规则，并将该过滤器添加到 Spring Boot 的过滤器链中。</p> 
<p>示例代码：</p> 
<pre><code class="language-java">import jakarta.servlet.*;
import jakarta.servlet.http.HttpServletResponse;
import org.springframework.stereotype.Component;

import java.io.IOException;

/**
 * @author mijiupro
 */
@Component
public class CorsFilter implements Filter {

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)
            throws IOException, ServletException {
        // 将 ServletResponse 转换为 HttpServletResponse
        HttpServletResponse httpResponse = (HttpServletResponse) response;

        // 设置允许跨域请求的源地址
        httpResponse.setHeader("Access-Control-Allow-Origin", "https://mijiupro.com");

        // 设置允许的请求方法
        httpResponse.setHeader("Access-Control-Allow-Methods", "GET, POST, PUT, DELETE");

        // 设置允许的请求头
        httpResponse.setHeader("Access-Control-Allow-Headers", "*");

        // 继续执行 Filter 链
        chain.doFilter(request, response);
    }
}</code></pre> 
<h2 id="%E6%9C%80%E5%90%8E">7.最后</h2> 
<blockquote> 
 <p>这三种spring boot中解决跨域的方式通常第二种跟第一种使用的最多，对于不需要细腻控制到某个接口方法的推荐使用第二种全局配置解决。</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f91cdc0939efb87de2e1cd0d11ce3731/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Spring Boot3自定义异常及全局异常捕获</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/08030a2c7f9c3459a5e6cab6bbc4983b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">spring boot3token拦截器链的设计与实现</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>