<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>我的数据仓库与数据挖掘期末大作业重置版 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/9041da3d121c3329e43dc7286575fb8c/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="我的数据仓库与数据挖掘期末大作业重置版">
  <meta property="og:description" content="文章目录 我的数据仓库与数据挖掘期末大作业重置版准备工作预设定及导入相对应的库库的导入调整 Jupyter Notebook 的预设定调整 MatPlotLib 和 Pandas 的输出设置 任务 1：预测问题数据的保存和读取数据的分析和预处理模型的选择和构建线性回归一元多项式回归 拟合预测拟合优度的评估 任务 2：聚类分析问题数据的保存和读取数据的分析和预处理聚类的实现聚类结果有效性评估 任务 3：Apriori 关联规则算法数据的保存和读取数据的分析和预处理Apriori 关联规则算法流程设计和计算关联规则挖掘和输出结果的分析 任务 4：层次分析法决策问题层次分析法的准则构造建立层次结构模型通过 Python 计算 APH 层次分析法层次分析法的代码实现一致性检验的基本步骤 我的数据仓库与数据挖掘期末大作业重置版 这是之前已经完成的任务，原本是我的数据仓库与数据挖掘课程的作业。里面都是比较入门的东西，没什么难度。之前学这门课的时候，上了一整个学期的课，几乎都在讲解数学原理。作为数学科目挂了四门的理工蠢材，我整个学期都听得云里雾里，到了学期末的时候突然告诉我们说期末大作业要用 Python 来写。
我当时的反应就是：
啊？
Python？
啊这，您玩儿我呢？一整个学期过去了关于 Python 的事情只字未提，现在只剩下一个星期了您跟我说要用 Python 交期末作业…… 你这样我很尴尬啊。
然后只好赶鸭子上架，学了三小时速通 Python 直接开始写报告。这个作业本来是小组作业，但是我们“小组”很尴尬地只有两个人，而学了 Python 的只有我一个。到最后只好提交了一些狗屁不通的代码（我自己都看不懂），勉勉强强把这件事情糊弄过去了。
于是我决定现在重新把这几个任务做一遍，一雪前耻。总的来说，这几个入门级别的任务还算是比较考验数据分析综合能力的（？）。
本文我希望实现的效果就是对于这四个实验能够做到事无巨细，把所有以前没有弄明白的问题全都弄懂。代码不一定都是自己写的，但是要确保自己能看懂。
希望有一定的参考价值。
准备工作 安装 Python ，本次实验的版本为 Python 3.9.10在 Visual Stdio Code 中安装 Jupyter 插件，搭建开发环境使用 pip 安装需要的各种库 在终端中执行如下命令：
pip requests # http 请求库，不先安装的话后续装其他库会报错 pip install numpy pandas matplotlib scikit-learn itertools 下面介绍各个库的功能以及用途。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-10-21T16:38:45+08:00">
    <meta property="article:modified_time" content="2023-10-21T16:38:45+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">我的数据仓库与数据挖掘期末大作业重置版</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_1" rel="nofollow">我的数据仓库与数据挖掘期末大作业重置版</a></li><li><ul><li><a href="#_21" rel="nofollow">准备工作</a></li><li><a href="#_64" rel="nofollow">预设定及导入相对应的库</a></li><li><ul><li><a href="#_66" rel="nofollow">库的导入</a></li><li><a href="#_Jupyter_Notebook__91" rel="nofollow">调整 Jupyter Notebook 的预设定</a></li><li><a href="#_MatPlotLib__Pandas__101" rel="nofollow">调整 MatPlotLib 和 Pandas 的输出设置</a></li></ul> 
   </li><li><a href="#_1_120" rel="nofollow">任务 1：预测问题</a></li><li><ul><li><a href="#_142" rel="nofollow">数据的保存和读取</a></li><li><a href="#_255" rel="nofollow">数据的分析和预处理</a></li><li><a href="#_366" rel="nofollow">模型的选择和构建</a></li><li><ul><li><a href="#_368" rel="nofollow">线性回归</a></li><li><a href="#_596" rel="nofollow">一元多项式回归</a></li></ul> 
    </li><li><a href="#_627" rel="nofollow">拟合预测</a></li><li><a href="#_720" rel="nofollow">拟合优度的评估</a></li></ul> 
   </li><li><a href="#_2_773" rel="nofollow">任务 2：聚类分析问题</a></li><li><ul><li><a href="#_791" rel="nofollow">数据的保存和读取</a></li><li><a href="#_937" rel="nofollow">数据的分析和预处理</a></li><li><a href="#_1060" rel="nofollow">聚类的实现</a></li><li><a href="#_1203" rel="nofollow">聚类结果有效性评估</a></li></ul> 
   </li><li><a href="#_3Apriori__1297" rel="nofollow">任务 3：Apriori 关联规则算法</a></li><li><ul><li><a href="#_1320" rel="nofollow">数据的保存和读取</a></li><li><a href="#_1512" rel="nofollow">数据的分析和预处理</a></li><li><a href="#Apriori__1663" rel="nofollow">Apriori 关联规则算法流程设计和计算</a></li><li><a href="#_1841" rel="nofollow">关联规则挖掘和输出结果的分析</a></li></ul> 
   </li><li><a href="#_4_2000" rel="nofollow">任务 4：层次分析法决策问题</a></li><li><ul><li><a href="#_2040" rel="nofollow">层次分析法的准则构造</a></li><li><a href="#_2083" rel="nofollow">建立层次结构模型</a></li><li><a href="#_Python__APH__2150" rel="nofollow">通过 Python 计算 APH 层次分析法</a></li><li><a href="#_2215" rel="nofollow">层次分析法的代码实现</a></li><li><ul><li><a href="#_2217" rel="nofollow">一致性检验的基本步骤</a></li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>我的数据仓库与数据挖掘期末大作业重置版</h2> 
<p>这是之前已经完成的任务，原本是我的数据仓库与数据挖掘课程的作业。里面都是比较入门的东西，没什么难度。之前学这门课的时候，上了一整个学期的课，几乎都在讲解数学原理。作为数学科目挂了四门的理工蠢材，我整个学期都听得云里雾里，到了学期末的时候突然告诉我们说期末大作业要用 Python 来写。</p> 
<p>我当时的反应就是：</p> 
<p>啊？</p> 
<p>Python？</p> 
<p>啊这，您玩儿我呢？一整个学期过去了关于 Python 的事情只字未提，现在只剩下一个星期了您跟我说要用 Python 交期末作业…… 你这样我很尴尬啊。</p> 
<p>然后只好赶鸭子上架，学了三小时速通 Python 直接开始写报告。这个作业本来是小组作业，但是我们“小组”很尴尬地只有两个人，而学了 Python 的只有我一个。到最后只好提交了一些狗屁不通的代码（我自己都看不懂），勉勉强强把这件事情糊弄过去了。</p> 
<p>于是我决定现在重新把这几个任务做一遍，一雪前耻。总的来说，这几个入门级别的任务还算是比较考验数据分析综合能力的（？）。</p> 
<p><strong>本文我希望实现的效果就是对于这四个实验能够做到事无巨细，把所有以前没有弄明白的问题全都弄懂。代码不一定都是自己写的，但是要确保自己能看懂。</strong></p> 
<p>希望有一定的参考价值。</p> 
<h3><a id="_21"></a>准备工作</h3> 
<ol><li>安装 Python ，本次实验的版本为 Python 3.9.10</li><li>在 Visual Stdio Code 中安装 Jupyter 插件，搭建开发环境</li><li>使用 pip 安装需要的各种库</li></ol> 
<p>在终端中执行如下命令：</p> 
<pre><code class="prism language-bash">pip requests <span class="token comment"># http 请求库，不先安装的话后续装其他库会报错</span>
pip <span class="token function">install</span> numpy pandas matplotlib scikit-learn itertools 
</code></pre> 
<p>下面介绍各个库的功能以及用途。</p> 
<p><strong>数据分析老熟人：Pandas、MatPlotLib、NumPy</strong></p> 
<p>其中，Pandas 主要是用于从 Excel 表格中读取数据，以及对数据进行挖掘分析。官方网站为 <a href="https://pandas.pydata.org/docs/" rel="nofollow">pandas - Python Data Analysis Library</a><br> ，技术文档查阅 <a href="https://pandas.pydata.org/docs/" rel="nofollow">这个链接</a>。</p> 
<p>matplotlib 是常见的图形库，用于绘制图表。官方网站为：<a href="https://matplotlib.org/" rel="nofollow">Matplotlib: Visualization with Python</a></p> 
<p>numpy 是常用的数学计算库。官方网站为：<a href="https://numpy.org/" rel="nofollow">NumPy</a></p> 
<p>itertools 是对数据进行排列组合需要用到的。<br> ，找到的技术文档在 <a href="https://docs.python.org/3/library/itertools.html" rel="nofollow">itertools — Functions creating iterators for efficient looping</a></p> 
<p>由于本次实验需要用到大量的数学建模相关的内容，我们选择了 Python 的 scikit-learn 库，<strong>该库常用于大量的数学建模和机器学习等领域，对于完成本次任务来说非常的理想</strong>。库要求 Python 版本大于或等于 3.5 。</p> 
<p>官方网站在 <a href="https://scikit-learn.org/stable/" rel="nofollow">scikit-learn : Machine Learining in Python</a></p> 
<p>以下是官方技术文档对于该库的介绍：</p> 
<blockquote> 
 <p>scikit-learn是基于Python语言的机器学习库，具有：</p> 
 <ul><li>简单高效的数据分析工具</li><li>可在多种环境中重复使用</li><li>建立在 Numpy，Scipy 以及 matplotlib 等数据科学库之上</li><li>开源且可商用的 - 基于 BSD 许可</li></ul> 
</blockquote> 
<p>官方文档托管在 <code>Read my Docs</code> 平台上。关于库的更多信息，可以查阅 <a href="https://www.sklearncn.cn/" rel="nofollow">sklearn中文文档</a></p> 
<h3><a id="_64"></a>预设定及导入相对应的库</h3> 
<h4><a id="_66"></a>库的导入</h4> 
<p>以下的几个库是四个任务中几乎都要用到的工具包。通过如下代码导入库：</p> 
<pre><code class="prism language-python"><span class="token string">" 系统相关的库 "</span>
<span class="token keyword">import</span> os
<span class="token keyword">import</span> sys

<span class="token string">" 数据分析相关的库 "</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token string">"结果可视化"</span>
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns

<span class="token string">" 用于查询概率分布表 "</span>
<span class="token keyword">from</span> scipy <span class="token keyword">import</span> stats

<span class="token string">" 对数据进行排列组合的库 "</span>
<span class="token keyword">import</span> itertools
</code></pre> 
<h4><a id="_Jupyter_Notebook__91"></a>调整 Jupyter Notebook 的预设定</h4> 
<p>预设定如下，指定文档中的所有图片保存为 <code>.svg</code> 格式。这样的好处是可以避免图片显示模糊，同时也不需要提前设置 MatPlotLib 的图片分辨率，方便了我们的绘图。</p> 
<pre><code class="prism language-python"><span class="token operator">%</span>matplotlib inline
<span class="token operator">%</span>config InlineBackend<span class="token punctuation">.</span>figure_format <span class="token operator">=</span> <span class="token string">'svg'</span>
</code></pre> 
<h4><a id="_MatPlotLib__Pandas__101"></a>调整 MatPlotLib 和 Pandas 的输出设置</h4> 
<pre><code class="prism language-python">plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">.</span>update<span class="token punctuation">(</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment"># "figure.figsize":(8, 6),    # 画布尺寸默认 8x6</span>
        <span class="token comment"># "figure.dpi":100,           # 图片清晰度为 100p</span>
        <span class="token string">"font.sans-serif"</span><span class="token punctuation">:</span><span class="token string">'SimHei'</span><span class="token punctuation">,</span> <span class="token comment"># 字体为黑体，否则会出现中文乱码</span>
        <span class="token string">"axes.unicode_minus"</span><span class="token punctuation">:</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token comment"># 解决负号不显示的问题</span>
        <span class="token string">"image.cmap"</span><span class="token punctuation">:</span><span class="token string">'viridis'</span>      <span class="token comment"># 设置颜色映射为 'viridis' 颜色表</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

<span class="token string">" pandas 设定自由列表最多为 10 行 "</span>
<span class="token comment"># DataFrame 太长的话可能会不便于阅读</span>
pd<span class="token punctuation">.</span>options<span class="token punctuation">.</span>display<span class="token punctuation">.</span>max_rows <span class="token operator">=</span> <span class="token number">10</span> 
</code></pre> 
<h3><a id="_1_120"></a>任务 1：预测问题</h3> 
<p>表 1 是 15 座城市写字楼出租率与每平方米月租金的数据。设月租金为自变量，出租率为因变量，请采用适当的回归模型进行回归预测并进行显著性检验。当显著性水平为 0.05 时，对于给定的月租金值，预测相应的出租率。</p> 
<table><thead><tr><th>地区编号</th><th>出租率（%）</th><th>每平方米月租金（元）</th></tr></thead><tbody><tr><td>1</td><td>70.6</td><td>99</td></tr><tr><td>2</td><td>69.8</td><td>74</td></tr><tr><td>3</td><td>73.4</td><td>83</td></tr><tr><td>4</td><td>67.1</td><td>70</td></tr><tr><td>5</td><td>70.1</td><td>84</td></tr><tr><td>6</td><td>68.7</td><td>65</td></tr><tr><td>7</td><td>63.4</td><td>67</td></tr><tr><td>8</td><td>73.5</td><td>105</td></tr><tr><td>9</td><td>71.4</td><td>95</td></tr><tr><td>10</td><td>80.7</td><td>107</td></tr><tr><td>11</td><td>71.2</td><td>86</td></tr><tr><td>12</td><td>62.0</td><td>86</td></tr><tr><td>13</td><td>78.7</td><td>106</td></tr><tr><td>14</td><td>69.5</td><td>70</td></tr><tr><td>15</td><td>68.7</td><td>81</td></tr></tbody></table> 
<h4><a id="_142"></a>数据的保存和读取</h4> 
<p>将数据保存在 <code>./data/forRegression.csv</code>。表头改为英文，防止 pandas 在读取的时候出错。</p> 
<pre><code class="prism language-python"><span class="token comment"># 读取数据</span>
df_1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./data/forRegression.csv'</span><span class="token punctuation">)</span>

<span class="token comment"># 查看数据框</span>
df_1
</code></pre> 
<div> 
</div> 
<table border="1" class="dataframe"><thead><tr><th></th><th>ID</th><th>rate</th><th>price</th></tr></thead><tbody><tr><th>0</th><td>1</td><td>70.6</td><td>99</td></tr><tr><th>1</th><td>2</td><td>69.8</td><td>74</td></tr><tr><th>2</th><td>3</td><td>73.4</td><td>83</td></tr><tr><th>3</th><td>4</td><td>67.1</td><td>70</td></tr><tr><th>4</th><td>5</td><td>70.1</td><td>84</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td></tr><tr><th>10</th><td>11</td><td>71.2</td><td>86</td></tr><tr><th>11</th><td>12</td><td>62.0</td><td>86</td></tr><tr><th>12</th><td>13</td><td>78.7</td><td>106</td></tr><tr><th>13</th><td>14</td><td>69.5</td><td>70</td></tr><tr><th>14</th><td>15</td><td>68.7</td><td>81</td></tr></tbody></table> 
<p>15 rows × 3 columns</p> 
<h4><a id="_255"></a>数据的分析和预处理</h4> 
<p>从数据的性质上来说，这是一组非时间序列的面板数据。</p> 
<p>由于数据点的数量连 30 都不到，进行正态检验是没有意义的。我们这里选择直接输出输出数据序列的相关性系数表：</p> 
<pre><code class="prism language-python">df_1<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span> 
</code></pre> 
<div> 
</div> 
<table border="1" class="dataframe"><thead><tr><th></th><th>ID</th><th>rate</th><th>price</th></tr></thead><tbody><tr><th>ID</th><td>1.000000</td><td>0.086229</td><td>0.162063</td></tr><tr><th>rate</th><td>0.086229</td><td>1.000000</td><td>0.706684</td></tr><tr><th>price</th><td>0.162063</td><td>0.706684</td><td>1.000000</td></tr></tbody></table> 
<p>这里还可以利用 seaborn 库进行可视化，绘制相关性热力图：</p> 
<pre><code class="prism language-python">mask <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>df_1<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment">#定义一个大小一致全为零的矩阵  用布尔类型覆盖原来的类型</span>
mask<span class="token punctuation">[</span>np<span class="token punctuation">.</span>triu_indices_from<span class="token punctuation">(</span>mask<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">=</span> <span class="token boolean">True</span>      <span class="token comment">#返回矩阵的上三角，并将其设置为true</span>
sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>df_1<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mask<span class="token operator">=</span>mask<span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">"coolwarm"</span><span class="token punctuation">,</span> annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>&lt;Axes: &gt;
</code></pre> 
<p><img src="https://images2.imgbox.com/52/cc/Y4RkXipE_o.png" alt="在这里插入图片描述"></p> 
<p>可以看见，这里 <code>price</code> 和 <code>rate</code> 的相关性系数大于等于 0.5，呈现显著性线性相关；</p> 
<p>对数据进行可视化，计算数据框中各个数据序列的相关性，寻找预测依据：</p> 
<pre><code class="prism language-python"><span class="token comment"># 绘制成散点图的形式</span>
df_1<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'rate'</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x <span class="token operator">=</span><span class="token string">'price'</span><span class="token punctuation">,</span> y <span class="token operator">=</span><span class="token string">'rate'</span><span class="token punctuation">,</span> kind<span class="token operator">=</span><span class="token string">'scatter'</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>&lt;Axes: xlabel='price', ylabel='rate'&gt;
</code></pre> 
<p><img src="https://images2.imgbox.com/77/78/QHh3DOIW_o.png" alt="在这里插入图片描述"></p> 
<p>数据样本点的数量实在是太少了，划分训练集和测试集的意义也不大。</p> 
<h4><a id="_366"></a>模型的选择和构建</h4> 
<h5><a id="_368"></a>线性回归</h5> 
<p>从图中可以看出两者呈现正相关关系。因此，我们首先一元线性回归的方法。</p> 
<p><code>statsmodels.api</code> 工具包提供了线性回归分析的 <code>OLS</code> 工具。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> statsmodels<span class="token punctuation">.</span>api <span class="token keyword">as</span> sm
</code></pre> 
<p>整理数据。这里为 <code>x</code> 添加截距项的工作就是在 <code>x</code> 矩阵的左边增加一列 1。</p> 
<pre><code class="prism language-python">x <span class="token operator">=</span> df_1<span class="token punctuation">[</span><span class="token string">'price'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values
y <span class="token operator">=</span> df_1<span class="token punctuation">[</span><span class="token string">'rate'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values
X <span class="token operator">=</span> sm<span class="token punctuation">.</span>add_constant<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token comment"># 为 x 添加截距项</span>
X<span class="token punctuation">,</span> y
</code></pre> 
<pre><code>(array([[  1.,  99.],
        [  1.,  74.],
        [  1.,  83.],
        [  1.,  70.],
        [  1.,  84.],
        [  1.,  65.],
        [  1.,  67.],
        [  1., 105.],
        [  1.,  95.],
        [  1., 107.],
        [  1.,  86.],
        [  1.,  86.],
        [  1., 106.],
        [  1.,  70.],
        [  1.,  81.]]),
 array([70.6, 69.8, 73.4, 67.1, 70.1, 68.7, 63.4, 73.5, 71.4, 80.7, 71.2,
        62. , 78.7, 69.5, 68.7]))
</code></pre> 
<p>线性回归模型可以表示为：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          y 
         
        
          = 
         
         
         
           β 
          
         
           0 
          
         
        
          + 
         
         
         
           β 
          
         
           1 
          
         
         
         
           x 
          
         
           1 
          
         
        
          + 
         
         
         
           β 
          
         
           2 
          
         
         
         
           x 
          
         
           2 
          
         
        
          + 
         
        
          ⋯ 
         
        
          + 
         
         
         
           β 
          
         
           n 
          
         
         
         
           x 
          
         
           n 
          
         
        
          + 
         
        
          η 
         
        
       
         y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_n x_n + \eta 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0528em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0528em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0528em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0528em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0528em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0528em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0528em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0528em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">η</span></span></span></span></span></span></p> 
<p>其中，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         y 
        
       
      
        y 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span></span></span></span></span> 是因变量，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          x 
         
        
          1 
         
        
       
         , 
        
        
        
          x 
         
        
          2 
         
        
       
         , 
        
       
         ⋯ 
        
        
        
          x 
         
        
          n 
         
        
       
      
        x_1, x_2, \cdots x_n 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 是自变量， 是对应的系数，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         η 
        
       
      
        \eta 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">η</span></span></span></span></span> 是误差项。所有的 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         x 
        
       
      
        x 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span> 都写为一个矩阵的形式，即：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
           
           
             X 
            
           
          
          
           
            
             
            
              = 
             
            
              [ 
             
             
             
               X 
              
             
               1 
              
             
            
              , 
             
             
             
               X 
              
             
               2 
              
             
            
              , 
             
            
              ⋯ 
             
             
             
               X 
              
             
               n 
              
             
            
              ] 
             
            
           
          
         
         
          
           
            
           
          
          
           
            
             
            
              = 
             
             
             
               [ 
              
              
               
                
                 
                  
                  
                    x 
                   
                   
                   
                     1 
                    
                   
                     , 
                    
                   
                     1 
                    
                   
                  
                 
                
                
                 
                  
                  
                    x 
                   
                   
                   
                     1 
                    
                   
                     , 
                    
                   
                     2 
                    
                   
                  
                 
                
                
                 
                 
                   ⋯ 
                  
                 
                
                
                 
                  
                  
                    x 
                   
                   
                   
                     1 
                    
                   
                     , 
                    
                   
                     n 
                    
                   
                  
                 
                
               
               
                
                 
                  
                  
                    x 
                   
                   
                   
                     2 
                    
                   
                     , 
                    
                   
                     1 
                    
                   
                  
                 
                
                
                 
                  
                  
                    x 
                   
                   
                   
                     2 
                    
                   
                     , 
                    
                   
                     2 
                    
                   
                  
                 
                
                
                 
                 
                   ⋯ 
                  
                 
                
                
                 
                  
                  
                    x 
                   
                   
                   
                     2 
                    
                   
                     , 
                    
                   
                     n 
                    
                   
                  
                 
                
               
               
                
                 
                  
                  
                    ⋮ 
                   
                   
                    
                   
                  
                 
                
                
                 
                  
                  
                    ⋮ 
                   
                   
                    
                   
                  
                 
                
                
                 
                 
                   ⋱ 
                  
                 
                
                
                 
                  
                  
                    ⋮ 
                   
                   
                    
                   
                  
                 
                
               
               
                
                 
                  
                  
                    x 
                   
                   
                   
                     m 
                    
                   
                     , 
                    
                   
                     1 
                    
                   
                  
                 
                
                
                 
                  
                  
                    x 
                   
                   
                   
                     m 
                    
                   
                     , 
                    
                   
                     2 
                    
                   
                  
                 
                
                
                 
                 
                   ⋯ 
                  
                 
                
                
                 
                  
                  
                    x 
                   
                   
                   
                     m 
                    
                   
                     , 
                    
                   
                     n 
                    
                   
                  
                 
                
               
              
             
               ] 
              
             
            
           
          
         
        
       
         \begin{aligned} X &amp;= [X_1, X_2, \cdots X_n] \\ &amp;= \begin{bmatrix} x_{1, 1} &amp; x_{1, 2} &amp; \cdots &amp; x_{1, n} \\ x_{2, 1} &amp; x_{2, 2} &amp; \cdots &amp; x_{2, n} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ x_{m, 1} &amp; x_{m, 2} &amp; \cdots &amp; x_{m, n} \\ \end{bmatrix} \end{aligned} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 7.26em; vertical-align: -3.38em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.88em;"><span class="" style="top: -8.02em;"><span class="pstrut" style="height: 4.98em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span></span></span><span class="" style="top: -4.38em;"><span class="pstrut" style="height: 4.98em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.38em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.88em;"><span class="" style="top: -8.02em;"><span class="pstrut" style="height: 4.98em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">]</span></span></span><span class="" style="top: -4.38em;"><span class="pstrut" style="height: 4.98em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 7.4em;"></span><span class="" style="width: 0.667em; height: 5.4em;"> 
                      <svg width="0.667em" height="5.400em" viewbox="0 0 667 5400"> 
                       <path d="M403 1759 V84 H666 V0 H319 V1759 v1800 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v1800 v1759 h84z"></path> 
                      </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.98em;"><span class="" style="top: -5.8275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -4.6275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -2.7675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width: 0em; border-top-width: 1.5em; bottom: 0em;"></span></span></span></span><span class="" style="top: -1.5675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.48em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.98em;"><span class="" style="top: -5.8275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -4.6275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -2.7675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width: 0em; border-top-width: 1.5em; bottom: 0em;"></span></span></span></span><span class="" style="top: -1.5675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.48em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.98em;"><span class="" style="top: -5.64em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="minner">⋯</span></span></span><span class="" style="top: -4.44em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="minner">⋯</span></span></span><span class="" style="top: -2.58em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="minner">⋱</span></span></span><span class="" style="top: -1.38em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="minner">⋯</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.48em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.98em;"><span class="" style="top: -5.8275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -4.6275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -2.7675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width: 0em; border-top-width: 1.5em; bottom: 0em;"></span></span></span></span><span class="" style="top: -1.5675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.48em;"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 7.4em;"></span><span class="" style="width: 0.667em; height: 5.4em;"> 
                      <svg width="0.667em" height="5.400em" viewbox="0 0 667 5400"> 
                       <path d="M347 1759 V0 H0 V84 H263 V1759 v1800 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v1800 v1759 h84z"></path> 
                      </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.38em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>当我们将截距项引入模型后，可以将其视为一个额外的特征变量 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          x 
         
        
          0 
         
        
       
      
        x_0 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>（即添加了一列 1），并且对应的系数是 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          β 
         
        
          0 
         
        
       
      
        \beta_0 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0528em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0528em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>。因此，上述模型可以重写为：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          y 
         
        
          = 
         
         
         
           β 
          
         
           0 
          
         
         
         
           x 
          
         
           0 
          
         
        
          + 
         
         
         
           β 
          
         
           1 
          
         
         
         
           x 
          
         
           1 
          
         
        
          + 
         
         
         
           β 
          
         
           2 
          
         
         
         
           x 
          
         
           2 
          
         
        
          + 
         
        
          . 
         
        
          . 
         
        
          . 
         
        
          + 
         
         
         
           β 
          
         
           n 
          
         
         
         
           x 
          
         
           n 
          
         
        
          + 
         
        
          η 
         
        
          , 
         
        
          ( 
         
         
         
           x 
          
         
           0 
          
         
        
          = 
         
        
          1 
         
        
          ) 
         
        
       
         y = \beta_0 x_0 + \beta_1 x_1 + \beta_2 x_2 + ... + \beta_n x_n + \eta, (x_0 = 1) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0528em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0528em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0528em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0528em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0528em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0528em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord">...</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0528em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0528em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">η</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></span></p> 
<p>对于写成矩阵形式的 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         X 
        
       
      
        X 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span></span></span></span></span>，则有：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
           
           
             X 
            
           
          
          
           
            
             
            
              = 
             
            
              [ 
             
             
             
               X 
              
              
              
                o 
               
              
                n 
               
              
                e 
               
              
                s 
               
              
             
            
              , 
             
             
             
               X 
              
             
               1 
              
             
            
              , 
             
             
             
               X 
              
             
               2 
              
             
            
              , 
             
            
              ⋯ 
             
             
             
               X 
              
             
               n 
              
             
            
              ] 
             
            
           
          
         
         
          
           
            
           
          
          
           
            
             
            
              = 
             
             
             
               [ 
              
              
               
                
                 
                 
                   1 
                  
                 
                
                
                 
                  
                  
                    x 
                   
                   
                   
                     1 
                    
                   
                     , 
                    
                   
                     1 
                    
                   
                  
                 
                
                
                 
                  
                  
                    x 
                   
                   
                   
                     1 
                    
                   
                     , 
                    
                   
                     2 
                    
                   
                  
                 
                
                
                 
                 
                   ⋯ 
                  
                 
                
                
                 
                  
                  
                    x 
                   
                   
                   
                     1 
                    
                   
                     , 
                    
                   
                     n 
                    
                   
                  
                 
                
               
               
                
                 
                 
                   1 
                  
                 
                
                
                 
                  
                  
                    x 
                   
                   
                   
                     2 
                    
                   
                     , 
                    
                   
                     1 
                    
                   
                  
                 
                
                
                 
                  
                  
                    x 
                   
                   
                   
                     2 
                    
                   
                     , 
                    
                   
                     2 
                    
                   
                  
                 
                
                
                 
                 
                   ⋯ 
                  
                 
                
                
                 
                  
                  
                    x 
                   
                   
                   
                     2 
                    
                   
                     , 
                    
                   
                     n 
                    
                   
                  
                 
                
               
               
                
                 
                  
                  
                    ⋮ 
                   
                   
                    
                   
                  
                 
                
                
                 
                  
                  
                    ⋮ 
                   
                   
                    
                   
                  
                 
                
                
                 
                  
                  
                    ⋮ 
                   
                   
                    
                   
                  
                 
                
                
                 
                 
                   ⋱ 
                  
                 
                
                
                 
                  
                  
                    ⋮ 
                   
                   
                    
                   
                  
                 
                
               
               
                
                 
                 
                   1 
                  
                 
                
                
                 
                  
                  
                    x 
                   
                   
                   
                     m 
                    
                   
                     , 
                    
                   
                     1 
                    
                   
                  
                 
                
                
                 
                  
                  
                    x 
                   
                   
                   
                     m 
                    
                   
                     , 
                    
                   
                     2 
                    
                   
                  
                 
                
                
                 
                 
                   ⋯ 
                  
                 
                
                
                 
                  
                  
                    x 
                   
                   
                   
                     m 
                    
                   
                     , 
                    
                   
                     n 
                    
                   
                  
                 
                
               
              
             
               ] 
              
             
            
           
          
         
        
       
         \begin{aligned} X &amp;= [X_{ones}, X_1, X_2, \cdots X_n] \\ &amp;= \begin{bmatrix} 1 &amp; x_{1, 1} &amp; x_{1, 2} &amp; \cdots &amp; x_{1, n} \\ 1 &amp; x_{2, 1} &amp; x_{2, 2} &amp; \cdots &amp; x_{2, n} \\ \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ 1 &amp; x_{m, 1} &amp; x_{m, 2} &amp; \cdots &amp; x_{m, n} \\ \end{bmatrix} \end{aligned} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 7.26em; vertical-align: -3.38em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.88em;"><span class="" style="top: -8.02em;"><span class="pstrut" style="height: 4.98em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span></span></span><span class="" style="top: -4.38em;"><span class="pstrut" style="height: 4.98em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.38em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.88em;"><span class="" style="top: -8.02em;"><span class="pstrut" style="height: 4.98em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">es</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">]</span></span></span><span class="" style="top: -4.38em;"><span class="pstrut" style="height: 4.98em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 7.4em;"></span><span class="" style="width: 0.667em; height: 5.4em;"> 
                      <svg width="0.667em" height="5.400em" viewbox="0 0 667 5400"> 
                       <path d="M403 1759 V84 H666 V0 H319 V1759 v1800 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v1800 v1759 h84z"></path> 
                      </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.98em;"><span class="" style="top: -5.8275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -4.6275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -2.7675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width: 0em; border-top-width: 1.5em; bottom: 0em;"></span></span></span></span><span class="" style="top: -1.5675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.48em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.98em;"><span class="" style="top: -5.8275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -4.6275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -2.7675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width: 0em; border-top-width: 1.5em; bottom: 0em;"></span></span></span></span><span class="" style="top: -1.5675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.48em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.98em;"><span class="" style="top: -5.8275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -4.6275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -2.7675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width: 0em; border-top-width: 1.5em; bottom: 0em;"></span></span></span></span><span class="" style="top: -1.5675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.48em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.98em;"><span class="" style="top: -5.64em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="minner">⋯</span></span></span><span class="" style="top: -4.44em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="minner">⋯</span></span></span><span class="" style="top: -2.58em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="minner">⋱</span></span></span><span class="" style="top: -1.38em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="minner">⋯</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.48em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.98em;"><span class="" style="top: -5.8275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -4.6275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -2.7675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width: 0em; border-top-width: 1.5em; bottom: 0em;"></span></span></span></span><span class="" style="top: -1.5675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.48em;"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 7.4em;"></span><span class="" style="width: 0.667em; height: 5.4em;"> 
                      <svg width="0.667em" height="5.400em" viewbox="0 0 667 5400"> 
                       <path d="M347 1759 V0 H0 V84 H263 V1759 v1800 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v1800 v1759 h84z"></path> 
                      </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.38em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>这样做的好处是，在进行参数估计和预测时，模型会考虑到数据中存在的偏移量，并提供更准确和可靠的结果。</p> 
<p>进行回归计算：</p> 
<pre><code class="prism language-python">LinearRegr <span class="token operator">=</span> sm<span class="token punctuation">.</span>OLS<span class="token punctuation">(</span>y<span class="token punctuation">,</span> X<span class="token punctuation">)</span>
result <span class="token operator">=</span> LinearRegr<span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token punctuation">)</span>
result<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>D:\Python\Python39\Lib\site-packages\scipy\stats\_stats_py.py:1806: UserWarning: kurtosistest only valid for n&gt;=20 ... continuing anyway, n=15
  warnings.warn("kurtosistest only valid for n&gt;=20 ... continuing "
</code></pre> 
<table class="simpletable"><caption>
   OLS Regression Results 
 </caption><tbody><tr><th>Dep. Variable:</th><td>y</td><th> R-squared: </th><td> 0.499</td></tr><tr><th>Model:</th><td>OLS</td><th> Adj. R-squared: </th><td> 0.461</td></tr><tr><th>Method:</th><td>Least Squares</td><th> F-statistic: </th><td> 12.97</td></tr><tr><th>Date:</th><td>Sat, 21 Oct 2023</td><th> Prob (F-statistic):</th><td>0.00322</td></tr><tr><th>Time:</th><td>16:14:36</td><th> Log-Likelihood: </th><td> -39.328</td></tr><tr><th>No. Observations:</th><td> 15</td><th> AIC: </th><td> 82.66</td></tr><tr><th>Df Residuals:</th><td> 13</td><th> BIC: </th><td> 84.07</td></tr><tr><th>Df Model:</th><td> 1</td><th> </th><td> </td></tr><tr><th>Covariance Type:</th><td>nonrobust</td><th> </th><td> </td></tr></tbody></table> 
<table class="simpletable"><tbody><tr><td></td><th>coef</th><th>std err</th><th>t</th><th>P&gt;|t|</th><th>[0.025</th><th>0.975]</th></tr><tr><th>const</th><td> 50.3409</td><td> 5.697</td><td> 8.836</td><td> 0.000</td><td> 38.033</td><td> 62.649</td></tr><tr><th>x1</th><td> 0.2376</td><td> 0.066</td><td> 3.601</td><td> 0.003</td><td> 0.095</td><td> 0.380</td></tr></tbody></table> 
<table class="simpletable"><tbody><tr><th>Omnibus:</th><td> 5.249</td><th> Durbin-Watson: </th><td> 2.313</td></tr><tr><th>Prob(Omnibus):</th><td> 0.072</td><th> Jarque-Bera (JB): </th><td> 2.538</td></tr><tr><th>Skew:</th><td>-0.917</td><th> Prob(JB): </th><td> 0.281</td></tr><tr><th>Kurtosis:</th><td> 3.836</td><th> Cond. No. </th><td> 533.</td></tr></tbody></table> 
<br> 
<br>Notes: 
<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified. 
<p>运行时告警：</p> 
<pre><code>D:\Python\Python39\Lib\site-packages\scipy\stats\_stats_py.py:1806: UserWarning: kurtosistest only valid for n&gt;=20 ... continuing anyway, n=15
  warnings.warn("kurtosistest only valid for n&gt;=20 ... continuing "
</code></pre> 
<p>这说明我们的原始数据太少了。</p> 
<ul><li> <p>如果在 Jupyter 中使用 <code>result.summary()</code> 输出回归结果的总结，结果就会以 HTML 表格形式输出；</p> </li><li> <p>如果在 Jupyter 中使用 <code>print(result.summary())</code>，则输出是写作纯文本形式的表格。</p> </li></ul> 
<p>输出模型参数：</p> 
<pre><code class="prism language-python">result<span class="token punctuation">.</span>params
</code></pre> 
<pre><code>array([50.34093838,  0.23762592])
</code></pre> 
<pre><code class="prism language-python">beta_0 <span class="token operator">=</span> result<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
beta_1 <span class="token operator">=</span> result<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
beta_0<span class="token punctuation">,</span> beta_1
</code></pre> 
<pre><code>(50.34093837916325, 0.23762591886741113)
</code></pre> 
<p>线性回归模型的可视化结果如下：</p> 
<pre><code class="prism language-python"><span class="token comment"># 拟合线</span>
plot_line <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>plot_line<span class="token punctuation">,</span> 
         beta_0 <span class="token operator">+</span> plot_line<span class="token operator">*</span>beta_1<span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'poly reg'</span><span class="token punctuation">)</span>
<span class="token comment"># 原始数据点</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'data'</span><span class="token punctuation">)</span>
<span class="token string">" 图例 "</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"15 座城市写字楼出租率与每平方米月租金关系的线性拟合预测结果"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"每平方米月租金（元）"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"出租率（%）"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/cf/8e/f8FiR7VZ_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_596"></a>一元多项式回归</h5> 
<p>由于线性拟合结果不符合预期，所以我们可以采用一元多项式回归的方法。</p> 
<p>多项式预测可以用下面的式子来表示：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          y 
         
        
          = 
         
         
         
           β 
          
         
           0 
          
         
        
          + 
         
         
         
           β 
          
         
           1 
          
         
        
          x 
         
        
          + 
         
         
         
           β 
          
         
           2 
          
         
         
         
           x 
          
         
           2 
          
         
        
          + 
         
        
          ⋯ 
         
        
          + 
         
         
         
           β 
          
         
           n 
          
         
         
         
           x 
          
         
           n 
          
         
        
          + 
         
        
          ϵ 
         
        
       
         y = \beta_0 + \beta_1 x + \beta_2 x^2 + \cdots + \beta_n x^n + \epsilon 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0528em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0528em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0528em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0528em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.0585em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0528em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0528em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9088em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0528em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0528em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7144em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span></span></p> 
<p>其中，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ϵ 
        
       
      
        \epsilon 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span> 为预测误差，即 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ϵ 
        
       
         = 
        
        
        
          y 
         
        
          ^ 
         
        
       
         − 
        
       
         y 
        
       
      
        \epsilon = \hat y - y 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6944em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span></span></span></span></span>。</p> 
<p>从而有<strong>预测模型为</strong>：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           y 
          
         
           ^ 
          
         
        
          = 
         
         
         
           β 
          
         
           0 
          
         
        
          + 
         
         
         
           β 
          
         
           1 
          
         
        
          x 
         
        
          + 
         
         
         
           β 
          
         
           2 
          
         
         
         
           x 
          
         
           2 
          
         
        
          + 
         
        
          ⋯ 
         
        
          + 
         
         
         
           β 
          
         
           n 
          
         
         
         
           x 
          
         
           n 
          
         
        
       
         \hat y = \beta_0 + \beta_1 x + \beta_2 x^2 + \cdots + \beta_n x^n 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6944em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0528em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0528em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0528em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0528em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.0585em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0528em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0528em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9088em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0528em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0528em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7144em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>从原始数据中选择 <code>price</code> 和 <code>rate</code> 两列，作为多项式拟合的数据。</p> 
<p>要注意：</p> 
<ol><li>使用 <code>DataFrame.values</code> 将 <code>Series</code> 类型转为 <code>array</code> 类型</li><li>使用 <code>array.reshape(-1, 1)</code> 进行数据序列的转置</li></ol> 
<pre><code class="prism language-python">x <span class="token operator">=</span> df_1<span class="token punctuation">[</span><span class="token string">'price'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> df_1<span class="token punctuation">[</span><span class="token string">'rate'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values
</code></pre> 
<h4><a id="_627"></a>拟合预测</h4> 
<p>导入以下几个模块。</p> 
<p>其中，</p> 
<ul><li><code>Pipeline</code> 用于将数据处理的流程封装为管道</li><li><code>LinearRegression</code> 用于一元线性拟合</li><li><code>PolynomialFeatures</code> 用于多项式拟合</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>pipeline <span class="token keyword">import</span> Pipeline
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LinearRegression
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> PolynomialFeatures
</code></pre> 
<p>使用 <code>Pipline</code> 封装的数据处理流程，如下所示。要注意这里有一个<strong>多项式项数选择</strong>的问题，也就是说：我们现在不知道这个多项式应该有多少项。在这里用 <code>degree</code> 这个参数来设置多项式的项数；</p> 
<p>我们设置一个变量 <code>n</code> 用来表示多项式的项数，则有 <code>degree = n</code>。</p> 
<pre><code class="prism language-python">n <span class="token operator">=</span> <span class="token number">8</span> <span class="token comment"># 多项式拟合的项数</span>

<span class="token comment"># 使用 Pipline 封装的数据处理流程</span>
nonLinearRegr <span class="token operator">=</span> Pipeline<span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token punctuation">(</span> <span class="token string">'poly'</span><span class="token punctuation">,</span> PolynomialFeatures<span class="token punctuation">(</span> degree <span class="token operator">=</span> n <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span> <span class="token string">'clf'</span><span class="token punctuation">,</span> LinearRegression<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span>
        
<span class="token comment"># 拟合</span>
nonLinearRegr<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
</code></pre> 
<div id="sk-container-id-1" class="sk-top-container"> 
 <div class="sk-text-repr-fallback"> 
  <pre>Pipeline(steps=[('poly', PolynomialFeatures(degree=8)),
<pre><code>            (&amp;#x27;clf&amp;#x27;, LinearRegression())])&lt;/pre&gt;&lt;b&gt;In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. &lt;br /&gt;On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.&lt;/b&gt;&lt;/div&gt;&lt;div class="sk-container" hidden&gt;&lt;div class="sk-item sk-dashed-wrapped"&gt;&lt;div class="sk-label-container"&gt;&lt;div class="sk-label sk-toggleable"&gt;&lt;input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" &gt;&lt;label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow"&gt;Pipeline&lt;/label&gt;&lt;div class="sk-toggleable__content"&gt;&lt;pre&gt;Pipeline(steps=[(&amp;#x27;poly&amp;#x27;, PolynomialFeatures(degree=8)),
            (&amp;#x27;clf&amp;#x27;, LinearRegression())])&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="sk-serial"&gt;&lt;div class="sk-item"&gt;&lt;div class="sk-estimator sk-toggleable"&gt;&lt;input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" &gt;&lt;label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow"&gt;PolynomialFeatures&lt;/label&gt;&lt;div class="sk-toggleable__content"&gt;&lt;pre&gt;PolynomialFeatures(degree=8)&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="sk-item"&gt;&lt;div class="sk-estimator sk-toggleable"&gt;&lt;input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox" &gt;&lt;label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow"&gt;LinearRegression&lt;/label&gt;&lt;div class="sk-toggleable__content"&gt;&lt;pre&gt;LinearRegression()&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;
</code></pre>
</pre> 
 </div> 
</div> 
<p>然后我们可以进行绘图，查看拟合的效果。</p> 
<p>要注意使用 <code>plt.plot()</code> 进行绘图的时候，如果代入的是原始数据 <code>x</code>，则需要对数据点进行排序。但是在这里我直接用 <code>np.linspace()</code> 生成了向量空间，所以只需要进行转置然后传递给 <code>nonLinearRegr.predict()</code> 就可以绘制出曲线了。</p> 
<pre><code class="prism language-python"><span class="token string">" 绘图属性 "</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token string">" 图线部分 "</span>
<span class="token comment"># 原始数据点</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'data'</span><span class="token punctuation">)</span>
<span class="token comment"># 拟合曲线</span>
plot_line <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>plot_line<span class="token punctuation">,</span> nonLinearRegr<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>plot_line<span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'poly reg'</span><span class="token punctuation">)</span>
<span class="token string">" 图例 "</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"15 座城市写字楼出租率与每平方米月租金关系的多项式拟合预测结果"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"每平方米月租金（元）"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"出租率（%）"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d1/03/CL0Rs1eK_o.png" alt="在这里插入图片描述"></p> 
<p>查看模型的各项参数。其中，<code>model_params</code> 为各个项的系数，<code>model_intercept</code> 为模型的截距。</p> 
<p>使用 <code>named_steps</code> 找到 <code>Pipeline</code> 中具体的 <code>step</code> 的属性。</p> 
<pre><code class="prism language-python">model_params <span class="token operator">=</span> nonLinearRegr<span class="token punctuation">.</span>named_steps<span class="token punctuation">[</span><span class="token string">'clf'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>coef_
model_intercept <span class="token operator">=</span> nonLinearRegr<span class="token punctuation">.</span>named_steps<span class="token punctuation">[</span><span class="token string">'clf'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>intercept_

<span class="token keyword">print</span><span class="token punctuation">(</span> <span class="token string">"model params : \n"</span><span class="token punctuation">,</span> model_params <span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span> <span class="token string">"model intercept : "</span><span class="token punctuation">,</span> model_intercept <span class="token punctuation">)</span>
</code></pre> 
<pre><code>model params : 
 [ 0.00000000e+00  1.26935458e-02 -4.19706768e-02 -8.84001999e-01
  3.91306487e-02 -7.33777122e-04  7.12112095e-06 -3.53289531e-08
  7.11623122e-11]
model intercept :  9349.608367578356
</code></pre> 
<h4><a id="_720"></a>拟合优度的评估</h4> 
<p>接下来要对模型进行拟合优度的检验：利用 <code>sklearn.metrics</code> 中的 <code>r2_score</code> 可以很容易地完成这个操作。</p> 
<pre><code class="prism language-python"><span class="token string">" 导入模块 "</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> r2_score

y_pred <span class="token operator">=</span> nonLinearRegr<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

r2 <span class="token operator">=</span> r2_score<span class="token punctuation">(</span>y<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"R2 score : "</span><span class="token punctuation">,</span> r2<span class="token punctuation">)</span>
</code></pre> 
<pre><code>R2 score :  0.7412986594955968
</code></pre> 
<p>下表展示了在不同的 degree 下的 R2 的值，数据来源于反复多次的测试：</p> 
<table><thead><tr><th>degree</th><th>R2 score</th></tr></thead><tbody><tr><td>0</td><td>0.0</td></tr><tr><td>1</td><td>0.49940</td></tr><tr><td>2</td><td>0.57992</td></tr><tr><td>3</td><td>0.65680</td></tr><tr><td>4</td><td>0.66935</td></tr><tr><td>5</td><td>0.67006</td></tr><tr><td>6</td><td>0.66895</td></tr><tr><td>7</td><td>0.66960</td></tr><tr><td>8</td><td>0.74130</td></tr><tr><td>9</td><td>0.73710</td></tr></tbody></table> 
<p>对于 <code>degree &gt; 9</code> 的点，这里不再列出，因为数值不再比上述的 R2 值更小。R2 的值一般在 0 到 1 之间，越接近 1，说明模型越能解释这些数据点。从表中可以看出：当 <code>degree = 8</code> 的时候，R2 = 0.74130，最为理想。</p> 
<p>故可知，模型为：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
           
            
            
              y 
             
            
              ^ 
             
            
           
          
          
           
            
             
            
              = 
             
            
              9349.608367578356 
             
            
           
          
         
         
          
           
            
           
          
          
           
            
             
            
              + 
             
            
              1.26935458 
             
            
              × 
             
            
              1 
             
             
             
               0 
              
              
              
                − 
               
              
                2 
               
              
             
            
              x 
             
            
           
          
         
         
          
           
            
           
          
          
           
            
             
            
              − 
             
            
              4.19706768 
             
            
              × 
             
            
              1 
             
             
             
               0 
              
              
              
                − 
               
              
                2 
               
              
             
             
             
               x 
              
             
               2 
              
             
            
           
          
         
         
          
           
            
           
          
          
           
            
             
            
              − 
             
            
              8.84001999 
             
            
              × 
             
            
              1 
             
             
             
               0 
              
              
              
                − 
               
              
                1 
               
              
             
             
             
               x 
              
             
               3 
              
             
            
           
          
         
         
          
           
            
           
          
          
           
            
             
            
              + 
             
            
              3.91306487 
             
            
              × 
             
            
              1 
             
             
             
               0 
              
              
              
                − 
               
              
                2 
               
              
             
             
             
               x 
              
             
               4 
              
             
            
           
          
         
         
          
           
            
           
          
          
           
            
             
            
              − 
             
            
              7.33777122 
             
            
              × 
             
            
              1 
             
             
             
               0 
              
              
              
                − 
               
              
                4 
               
              
             
             
             
               x 
              
             
               5 
              
             
            
           
          
         
         
          
           
            
           
          
          
           
            
             
            
              + 
             
            
              7.12112095 
             
            
              × 
             
            
              1 
             
             
             
               0 
              
              
              
                − 
               
              
                6 
               
              
             
             
             
               x 
              
             
               6 
              
             
            
           
          
         
         
          
           
            
           
          
          
           
            
             
            
              − 
             
            
              3.53289531 
             
            
              × 
             
            
              1 
             
             
             
               0 
              
              
              
                − 
               
              
                8 
               
              
             
             
             
               x 
              
             
               7 
              
             
            
           
          
         
         
          
           
            
           
          
          
           
            
             
            
              + 
             
            
              7.11623122 
             
            
              × 
             
            
              1 
             
             
             
               0 
              
              
              
                − 
               
              
                11 
               
              
             
             
             
               x 
              
             
               8 
              
             
            
           
          
         
        
       
         \begin{split} \hat y &amp;= 9349.608367578356 \\ &amp;+ 1.26935458 \times 10^{-2} x \\ &amp;- 4.19706768 \times 10^{-2} x^{2} \\ &amp;- 8.84001999 \times 10^{-1} x^{3} \\ &amp;+ 3.91306487 \times 10^{-2} x^{4} \\ &amp;- 7.33777122 \times 10^{-4} x^{5} \\ &amp;+ 7.12112095 \times 10^{-6} x^{6} \\ &amp;- 3.53289531 \times 10^{-8} x^{7} \\ &amp;+ 7.11623122 \times 10^{-11} x^{8} \end{split} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 13.6929em; vertical-align: -6.5964em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 7.0964em;"><span class="" style="top: -9.2564em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6944em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -7.7323em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"></span></span><span class="" style="top: -6.2082em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"></span></span><span class="" style="top: -4.6841em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"></span></span><span class="" style="top: -3.16em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"></span></span><span class="" style="top: -1.6359em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"></span></span><span class="" style="top: -0.1118em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"></span></span><span class="" style="top: 1.4123em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"></span></span><span class="" style="top: 2.9364em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.5964em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 7.0964em;"><span class="" style="top: -9.2564em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord">9349.608367578356</span></span></span><span class="" style="top: -7.7323em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">1.26935458</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -6.2082em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">4.19706768</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -4.6841em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">8.84001999</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.16em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">3.91306487</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -1.6359em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">7.33777122</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -0.1118em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">7.12112095</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 1.4123em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">3.53289531</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">8</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 2.9364em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">7.11623122</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">11</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.5964em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p><strong>自此，任务 1 完成。</strong></p> 
<h3><a id="_2_773"></a>任务 2：聚类分析问题</h3> 
<p>表 2 是关于西瓜的密度与甜度数据，请采用基于划分的聚类方法，将该批西瓜划分为合适的簇。</p> 
<table><thead><tr><th>编号</th><th>密度</th><th>含糖率</th><th>编号</th><th>密度</th><th>含糖率</th><th>编号</th><th>密度</th><th>含糖率</th></tr></thead><tbody><tr><td>1</td><td>0.697</td><td>0.460</td><td>11</td><td>0.245</td><td>0.057</td><td>21</td><td>0.748</td><td>0.232</td></tr><tr><td>2</td><td>0.774</td><td>0.376</td><td>12</td><td>0.343</td><td>0.099</td><td>22</td><td>0.714</td><td>0.346</td></tr><tr><td>3</td><td>0.634</td><td>0.264</td><td>13</td><td>0.639</td><td>0.161</td><td>23</td><td>0.483</td><td>0.312</td></tr><tr><td>4</td><td>0.608</td><td>0.318</td><td>14</td><td>0.657</td><td>0.198</td><td>24</td><td>0.478</td><td>0.437</td></tr><tr><td>5</td><td>0.556</td><td>0.215</td><td>15</td><td>0.360</td><td>0.370</td><td>25</td><td>0.525</td><td>0.369</td></tr><tr><td>6</td><td>0.403</td><td>0.237</td><td>16</td><td>0.593</td><td>0.042</td><td>26</td><td>0.751</td><td>0.489</td></tr><tr><td>7</td><td>0.481</td><td>0.149</td><td>17</td><td>0.719</td><td>0.103</td><td>27</td><td>0.532</td><td>0.472</td></tr><tr><td>8</td><td>0.437</td><td>0.211</td><td>18</td><td>0.359</td><td>0.188</td><td>28</td><td>0.473</td><td>0.376</td></tr><tr><td>9</td><td>0.666</td><td>0.091</td><td>19</td><td>0.339</td><td>0.241</td><td>29</td><td>0.725</td><td>0.445</td></tr><tr><td>10</td><td>0.243</td><td>0.267</td><td>20</td><td>0.282</td><td>0.257</td><td>30</td><td>0.446</td><td>0.459</td></tr></tbody></table> 
<h4><a id="_791"></a>数据的保存和读取</h4> 
<p>将数据保存在 <code>./data/forClustering.csv</code>。表头改为英文，防止 pandas 在读取的时候出错。</p> 
<pre><code class="prism language-python"><span class="token comment"># 读取数据</span>
df_2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"./data/forClustering.csv"</span><span class="token punctuation">)</span>

<span class="token comment"># 查看数据框</span>
df_2
</code></pre> 
<div> 
</div> 
<table border="1" class="dataframe"><thead><tr><th></th><th>ID</th><th>density</th><th>sugar_rate</th></tr></thead><tbody><tr><th>0</th><td>1</td><td>0.697</td><td>0.460</td></tr><tr><th>1</th><td>2</td><td>0.774</td><td>0.376</td></tr><tr><th>2</th><td>3</td><td>0.634</td><td>0.264</td></tr><tr><th>3</th><td>4</td><td>0.608</td><td>0.318</td></tr><tr><th>4</th><td>5</td><td>0.556</td><td>0.215</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td></tr><tr><th>25</th><td>26</td><td>0.751</td><td>0.489</td></tr><tr><th>26</th><td>27</td><td>0.532</td><td>0.472</td></tr><tr><th>27</th><td>28</td><td>0.473</td><td>0.376</td></tr><tr><th>28</th><td>29</td><td>0.725</td><td>0.445</td></tr><tr><th>29</th><td>30</td><td>0.446</td><td>0.459</td></tr></tbody></table> 
<p>30 rows × 3 columns</p> 
<p>进行可视化操作，查看数据的基本情况。</p> 
<pre><code class="prism language-python">df_2<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'density'</span><span class="token punctuation">,</span> <span class="token string">'sugar_rate'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span> x <span class="token operator">=</span> <span class="token string">"density"</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token string">"sugar_rate"</span> <span class="token punctuation">)</span>
</code></pre> 
<pre><code>&lt;Axes: xlabel='density', ylabel='sugar_rate'&gt;
</code></pre> 
<p><img src="https://images2.imgbox.com/ce/3d/KguFxs1S_o.png" alt="在这里插入图片描述"></p> 
<p>可以看见数据的分布很随机，通过肉眼观察发现没有什么聚类的依据。</p> 
<p><strong>我们这里选择 K-Means 算法进行聚类分析。</strong></p> 
<p>首先导入 <code>sklearn.cluster</code> 中的 <code>KMeans</code> 模块：</p> 
<pre><code class="prism language-python"><span class="token comment"># sklearn机器学习库 cluster 聚类模块 KMeans 方法</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>cluster <span class="token keyword">import</span> KMeans
</code></pre> 
<h4><a id="_937"></a>数据的分析和预处理</h4> 
<p>初始化一些变量：</p> 
<pre><code class="prism language-python"><span class="token string">" 聚类分析 "</span>
k <span class="token operator">=</span> <span class="token number">4</span> <span class="token comment"># 聚类的数量，可以修改数值来检验和修正聚类的结果以达到更好的预期</span>
iteration <span class="token operator">=</span> <span class="token number">500000</span>  <span class="token comment"># 聚类最大迭代次数</span>
</code></pre> 
<p><strong>选择用于聚类的数据，然后对数据进行标准化处理。</strong></p> 
<p>标准化是一种常见的预处理步骤，旨在将不同尺度和范围的特征转换为具有相似尺度的统一分布。</p> 
<p>具体而言，该代码执行以下操作：</p> 
<ul><li><code>data.mean()</code>：计算数据的均值，即每个特征列的平均值。</li><li><code>data.std()</code>：计算数据的标准差，即每个特征列的标准差。</li><li><code>(data - data.mean())</code>：将每个数据点减去其对应特征列的均值，得到以0为中心的数据。</li><li><code>(data - data.mean())/data.std()</code>：将上述结果除以对应特征列的标准差，从而实现数据标准化。</li></ul> 
<p>通过标准化处理，可以消除不同尺度之间的差异，并确保所有特征都具有相似的重要性。这将有助于聚类算法更好地理解和比较各个特征，并避免某些特征对聚类结果产生过大影响。</p> 
<p>如下面的代码所示：</p> 
<pre><code class="prism language-python">data <span class="token operator">=</span> df_2<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'density'</span><span class="token punctuation">,</span> <span class="token string">'sugar_rate'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

data_standered <span class="token operator">=</span> <span class="token number">1.0</span><span class="token operator">*</span><span class="token punctuation">(</span>data <span class="token operator">-</span> data<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>data<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 数据标准化</span>

<span class="token comment"># 查看标准化后的数据</span>
data_standered
</code></pre> 
<div> 
</div> 
<table border="1" class="dataframe"><thead><tr><th></th><th>density</th><th>sugar_rate</th></tr></thead><tbody><tr><th>0</th><td>1.031876</td><td>1.403363</td></tr><tr><th>1</th><td>1.508603</td><td>0.767192</td></tr><tr><th>2</th><td>0.641827</td><td>-0.081036</td></tr><tr><th>3</th><td>0.480854</td><td>0.327931</td></tr><tr><th>4</th><td>0.158909</td><td>-0.452136</td></tr><tr><th>...</th><td>...</td><td>...</td></tr><tr><th>25</th><td>1.366204</td><td>1.622993</td></tr><tr><th>26</th><td>0.010319</td><td>1.494244</td></tr><tr><th>27</th><td>-0.354965</td><td>0.767192</td></tr><tr><th>28</th><td>1.205231</td><td>1.289761</td></tr><tr><th>29</th><td>-0.522129</td><td>1.395789</td></tr></tbody></table> 
<p>30 rows × 2 columns</p> 
<h4><a id="_1060"></a>聚类的实现</h4> 
<p>从而我们可以进行聚类：</p> 
<pre><code class="prism language-python"><span class="token comment"># 开始聚类</span>
cluster_model <span class="token operator">=</span> KMeans<span class="token punctuation">(</span>n_clusters <span class="token operator">=</span> k<span class="token punctuation">,</span> 
                       n_init <span class="token operator">=</span> <span class="token string">'auto'</span><span class="token punctuation">,</span>
                       max_iter <span class="token operator">=</span> iteration<span class="token punctuation">,</span>
                       <span class="token punctuation">)</span>  <span class="token comment"># 分为k类</span>
cluster_model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>data_standered<span class="token punctuation">)</span>

<span class="token comment"># 查看聚类标签和聚类中心点</span>
labels <span class="token operator">=</span> cluster_model<span class="token punctuation">.</span>labels_
cluster_centers <span class="token operator">=</span> cluster_model<span class="token punctuation">.</span>cluster_centers_

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'labels: \n'</span><span class="token punctuation">,</span> labels<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'cluster centers: \n'</span><span class="token punctuation">,</span> cluster_centers<span class="token punctuation">)</span>
</code></pre> 
<pre><code>labels: 
 [1 1 2 3 2 0 2 0 2 0 0 0 2 2 3 2 2 0 0 0 2 1 3 3 3 1 3 3 1 3]
cluster centers: 
 [[-1.2318022  -0.60644501]
 [ 1.24980844  1.12465918]
 [ 0.63288406 -0.85605371]
 [-0.26132265  0.86659344]]
</code></pre> 
<p>接下来，我们要把产生的 <code>labels</code> 作为一个数据序列追加到数据表格的后面。具体的做法是新建立一个名为 <code>cluster_data</code> 的 <code>DataFrame</code>，包含原始数据点的坐标和新产生的 <code>labels</code>。</p> 
<p>这样做的好处是：<strong>不需要打破脑袋地调整数据的类型或者通过循环遍历的方法，把数据传递给 <code>plt.scatter()</code> 绘制新的彩色散点图，而是可以直接利用 <code>pandas.DataFrame.plot.scatter()</code> 快速绘图。</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># 拼接新的列</span>
cluster_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span> <span class="token punctuation">[</span>data<span class="token punctuation">,</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>labels<span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token string">"class"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># 查看数据</span>
cluster_data
</code></pre> 
<div> 
</div> 
<table border="1" class="dataframe"><thead><tr><th></th><th>density</th><th>sugar_rate</th><th>class</th></tr></thead><tbody><tr><th>0</th><td>0.697</td><td>0.460</td><td>1</td></tr><tr><th>1</th><td>0.774</td><td>0.376</td><td>1</td></tr><tr><th>2</th><td>0.634</td><td>0.264</td><td>2</td></tr><tr><th>3</th><td>0.608</td><td>0.318</td><td>3</td></tr><tr><th>4</th><td>0.556</td><td>0.215</td><td>2</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td></tr><tr><th>25</th><td>0.751</td><td>0.489</td><td>1</td></tr><tr><th>26</th><td>0.532</td><td>0.472</td><td>3</td></tr><tr><th>27</th><td>0.473</td><td>0.376</td><td>3</td></tr><tr><th>28</th><td>0.725</td><td>0.445</td><td>1</td></tr><tr><th>29</th><td>0.446</td><td>0.459</td><td>3</td></tr></tbody></table> 
<p>30 rows × 3 columns</p> 
<h4><a id="_1203"></a>聚类结果有效性评估</h4> 
<p>轮廓系数是一种用于衡量聚类结果质量的指标，它结合了簇内的紧密度和簇间的分离度。对于每个样本点，轮廓系数计算以下两个值：</p> 
<ol><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           a 
          
         
           i 
          
         
        
       
         a_i 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>：表示样本点 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          i 
         
        
       
         i 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span> 到同簇其他样本点的平均距离。这个值越小，说明样本点i与其所在簇中的其他点越相似，簇内紧密度越高。</li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           b 
          
         
           i 
          
         
        
       
         b_i 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>：表示样本点 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          i 
         
        
       
         i 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span> 到最近非同簇样本点的平均距离。这个值越大，说明样本点i与其他簇之间的距离越大，簇间分离度越好。</li></ol> 
<p>基于上述定义，可以计算出每个样本点的轮廓系数：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           s 
          
         
           i 
          
         
        
          = 
         
         
          
           
           
             b 
            
           
             i 
            
           
          
            − 
           
           
           
             a 
            
           
             i 
            
           
          
          
          
            max 
           
          
            ⁡ 
           
          
            ( 
           
           
           
             a 
            
           
             i 
            
           
          
            , 
           
           
           
             b 
            
           
             i 
            
           
          
            ) 
           
          
         
        
       
         s_i = \frac{ {b_i - a_i}}{<!-- -->{\max(a_i, b_i)}} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.3074em; vertical-align: -0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3714em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mop">max</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<p>其中，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          s 
         
        
          i 
         
        
       
      
        s_i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 的取值范围在 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         [ 
        
       
         − 
        
       
         1 
        
       
         , 
        
       
         1 
        
       
         ] 
        
       
      
        [-1, 1] 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span> 之间。如果 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          s 
         
        
          i 
         
        
       
      
        s_i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 接近于1，则表示样本点 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         i 
        
       
      
        i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span> 聚类得很好；如果 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          s 
         
        
          i 
         
        
       
      
        s_i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 接近于 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         − 
        
       
         1 
        
       
      
        -1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span></span>，则表示样本点 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         i 
        
       
      
        i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span> 更应该被分配到其他簇；如果 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          s 
         
        
          i 
         
        
       
      
        s_i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 接近于 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         0 
        
       
      
        0 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0</span></span></span></span></span>，则说明样本点i在两个相邻簇的边界上。</p> 
<p>最终，整个聚类结果的轮廓系数是所有样本点轮廓系数的均值。</p> 
<p>从 <code>sklearn.metrics</code> 中导入 <code>silhouette_samples</code> 用于轮廓系数的计算：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> silhouette_samples
</code></pre> 
<p>计算轮廓系数，输出轮廓系数的平均值。</p> 
<pre><code class="prism language-python">silhouetteCoefArr <span class="token operator">=</span> silhouette_samples<span class="token punctuation">(</span>data<span class="token punctuation">,</span> labels<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Silhouette Coefficient :\n"</span><span class="token punctuation">,</span> silhouetteCoefArr<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Average :"</span><span class="token punctuation">,</span> silhouetteCoefArr<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
</code></pre> 
<pre><code>Silhouette Coefficient :
 [ 0.65104246  0.64242975  0.24242421  0.00209483  0.2896085   0.35932184
 -0.07995893  0.29583778  0.6238602   0.46575515  0.51383016  0.52998268
  0.6276848   0.53971948  0.15671344  0.46917289  0.54889082  0.59270451
  0.52858366  0.51491124  0.12482582  0.49957503  0.40425347  0.62424398
  0.55266821  0.67534809  0.39026287  0.61839613  0.73527657  0.59902927]
Average : 0.45794963065432653
</code></pre> 
<p>下表展示了在不同的 k 值下的各点轮廓系数平均值的大小：</p> 
<table><thead><tr><th>k</th><th>Silhouette Coefficient</th></tr></thead><tbody><tr><td>2</td><td>0.31616125876149975</td></tr><tr><td>3</td><td>0.40381864969538367</td></tr><tr><td>4</td><td>0.46564982452281430</td></tr><tr><td>5</td><td>0.42080559439960324</td></tr><tr><td>6</td><td>0.39701632131985300</td></tr><tr><td>7</td><td>0.40597256901310635</td></tr></tbody></table> 
<p>从表中可以看出，当选择 <code>k = 4</code> 时，轮廓系数均值最接近 1，聚类效果最好。</p> 
<p>最后进行绘图和结果的可视化：</p> 
<pre><code class="prism language-python"><span class="token string">" 设置绘图属性 "</span>
fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 调整图片尺寸和 DPI</span>
ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 保存给 ax，进而传递给 pandas.DataFrame.plot.scatter()</span>

<span class="token string">" 绘图 "</span>
cluster_data<span class="token punctuation">.</span>plot<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>
    x <span class="token operator">=</span> <span class="token string">'density'</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token string">'sugar_rate'</span><span class="token punctuation">,</span> <span class="token comment"># 设置轴</span>
    c <span class="token operator">=</span> cluster_data<span class="token punctuation">[</span><span class="token string">'class'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment"># 按 class 区分颜色</span>
    s <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token comment"># 点的大小</span>
    xlabel <span class="token operator">=</span> <span class="token string">"西瓜密度"</span><span class="token punctuation">,</span> <span class="token comment"># 设置 X 轴标签</span>
    ylabel <span class="token operator">=</span> <span class="token string">"含糖量"</span><span class="token punctuation">,</span> <span class="token comment"># 设置 Y 轴标签</span>
    colormap <span class="token operator">=</span> <span class="token string">'viridis'</span><span class="token punctuation">,</span> <span class="token comment"># matplotlib 预设的颜色</span>
    title <span class="token operator">=</span> <span class="token string">"西瓜的密度与甜度的聚类分析结果"</span><span class="token punctuation">,</span> <span class="token comment"># 标题</span>
    colorbar <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token comment"># 不显示颜色条</span>
    grid <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token comment"># 显示网格线</span>
    ax <span class="token operator">=</span> ax <span class="token comment"># 将 ax 传递过来，实现图片大小和 dpi 的调整</span>
    <span class="token punctuation">)</span>
</code></pre> 
<pre><code>&lt;Axes: title={'center': '西瓜的密度与甜度的聚类分析结果'}, xlabel='西瓜密度', ylabel='含糖量'&gt;
</code></pre> 
<p><img src="https://images2.imgbox.com/ca/14/FQ9Pjluf_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_3Apriori__1297"></a>任务 3：Apriori 关联规则算法</h3> 
<p>考虑表 3 中显示的购物篮事务，在给定最小支持度与最小可信度的前提下，利用 Apriori 算法求出所有的频繁项集与关联规则。</p> 
<table><thead><tr><th>事务ID</th><th>购买项</th></tr></thead><tbody><tr><td>1</td><td>{牛奶，啤酒，尿布}</td></tr><tr><td>2</td><td>{面包，黄油，牛奶}</td></tr><tr><td>3</td><td>{牛奶，尿布，饼干}</td></tr><tr><td>4</td><td>{面包，黄油，饼干}</td></tr><tr><td>5</td><td>{啤酒，饼干，尿布}</td></tr><tr><td>6</td><td>{牛奶，尿布，面包，黄油}</td></tr><tr><td>7</td><td>{面包，黄油，尿布}</td></tr><tr><td>8</td><td>{啤酒，尿布}</td></tr><tr><td>9</td><td>{牛奶，尿布，面包，黄油}</td></tr><tr><td>10</td><td>{啤酒，饼干}</td></tr></tbody></table> 
<p>唉，这个题目有一个最奇怪的地方，就是他跟我说要求我再给定最小支持度和最小可信度的前提下，利用关联规则算法求出所有的频繁项集和关联规则。他这个话刚刚说完，然后最小支持度和最小可信度都没有给我。我就觉得挺迷惑的吧。那我这里自己取一下吧：最小支持度为 4，最小可信度为 0.4</p> 
<p>这部分内容比较复杂。现成的 Python 模块里面没有好用的用于关联规则算法的模块；实际上，在现实生活中，像这样的关联规则算法更多地也是依据实际情况自己写的。</p> 
<p><strong>我们这里参考了这篇博文：<a href="https://blog.csdn.net/weixin_43699672/article/details/103657492">用python实现Apriori算法</a> 里面的一些代码的实现。</strong> 因为实在写得太好了，所以不得不借鉴一下。</p> 
<h4><a id="_1320"></a>数据的保存和读取</h4> 
<p>将数据保存在 <code>./data/forApriori.csv</code>，我们用每一行数据作为一个关联项集的数据样本。如下图所示：</p> 
<p><img src="https://images2.imgbox.com/50/7d/mQMfaBUg_o.png" alt="image"></p> 
<p>这里有一个技巧：关于如何读取数据的问题。</p> 
<p><strong>我们希望 <code>pandas.read_csv()</code> 在读取上述表格的时候把所有的关联项集 <code>DataFrame</code> 的一个列里面。</strong></p> 
<p>但是显然，假如我们使用：</p> 
<pre><code class="prism language-python">df_3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"./data/forApriori.csv"</span><span class="token punctuation">)</span>
df_3
</code></pre> 
<div> 
</div> 
<table border="1" class="dataframe"><thead><tr><th></th><th>牛奶</th><th>啤酒</th><th>尿布</th><th>Unnamed: 3</th></tr></thead><tbody><tr><th>0</th><td>面包</td><td>黄油</td><td>牛奶</td><td>NaN</td></tr><tr><th>1</th><td>牛奶</td><td>尿布</td><td>饼干</td><td>NaN</td></tr><tr><th>2</th><td>啤酒</td><td>饼干</td><td>尿布</td><td>NaN</td></tr><tr><th>3</th><td>牛奶</td><td>尿布</td><td>面包</td><td>黄油</td></tr><tr><th>4</th><td>面包</td><td>黄油</td><td>尿布</td><td>NaN</td></tr><tr><th>5</th><td>啤酒</td><td>尿布</td><td>NaN</td><td>NaN</td></tr><tr><th>6</th><td>牛奶</td><td>尿布</td><td>面包</td><td>黄油</td></tr><tr><th>7</th><td>啤酒</td><td>饼干</td><td>NaN</td><td>NaN</td></tr></tbody></table> 
<p>可以看见产生的 <code>DataFrame</code> 包含了很多 <code>NaN</code> 项。不是很理想。</p> 
<p>可以采取下面的这种方法，<strong>指定分隔符为 <code>.csv</code> 文件里的换行符</strong>：</p> 
<pre><code class="prism language-python">df_3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>
    <span class="token string">"./data/forApriori.csv"</span><span class="token punctuation">,</span> 
    header<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> 
    sep<span class="token operator">=</span><span class="token string">'\t'</span><span class="token punctuation">,</span> 
    encoding<span class="token operator">=</span><span class="token string">'UTF-8'</span>
    <span class="token punctuation">)</span>
df_3
</code></pre> 
<div> 
</div> 
<table border="1" class="dataframe"><thead><tr><th></th><th>0</th></tr></thead><tbody><tr><th>0</th><td>牛奶,啤酒,尿布,</td></tr><tr><th>1</th><td>面包,黄油,牛奶,</td></tr><tr><th>2</th><td>牛奶,尿布,饼干,</td></tr><tr><th>3</th><td>啤酒,饼干,尿布,</td></tr><tr><th>4</th><td>牛奶,尿布,面包,黄油</td></tr><tr><th>5</th><td>面包,黄油,尿布,</td></tr><tr><th>6</th><td>啤酒,尿布,,</td></tr><tr><th>7</th><td>牛奶,尿布,面包,黄油</td></tr><tr><th>8</th><td>啤酒,饼干,,</td></tr></tbody></table> 
<p>通过指定特定的分隔符 <code>sep</code>，可以划定 <code>DataFrame</code> 各个列的范围。这样一来，数据在 CSV 文件里面保存的每一行就都被作为一个样本点读取了。通过这种方法就能获得我们想要的数据框。</p> 
<h4><a id="_1512"></a>数据的分析和预处理</h4> 
<p>首先我们可以看见这里所有的数据都是以文本的形式保存的，这样非常不利于我们进行关于关联规则算法的运算。</p> 
<p>我们现在要用数字来代替这些商品，每一种商品赋予一个数字编号，然后对这些编号进行操作。但是给商品编号并不是一件简单的事情，每个商品只能对应一种编号，编号从 1 开始到 n，n 等于商品的总数量。</p> 
<p>要完成这样的操作，我们总共分三步：</p> 
<ol><li>找出所有的商品，写入一个列表。每一个商品在列表中只出现一次，也就是将所有的商品一字排开。</li><li>给每一种商品编号，创建一个商品和编号一一对应的字典。</li><li>把原来的商品集合转化为由数字组成的数据集合，然后进行 Apriori 关联规则运算</li></ol> 
<p>与此同时，当我们通过关联规则计算之后，获得了新的关联数据，还要通过之前那个将数据和商品名称一一对应的字典，把数据还原成商品，查看最终的结果。</p> 
<pre><code class="prism language-python">goods <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>       <span class="token comment"># 用以储存商品名转换后的数字的列表</span>
goodsList <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>   <span class="token comment"># 商品名字和数值一一对应的字典</span>
apriori_data<span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment"># 转换后的数据</span>
</code></pre> 
<p>实际上，我们说在这里有一个细节的要注意的问题。</p> 
<p><strong>在本文档的开头我就说过这个项目是我之前写的数据仓库与数据挖掘的作业，第一次完成的时候因为能力不足，所以弄得很草率。这一次重新做的时候也发现了一些问题，在第一次尝试完成这个任务的作业里面有一个地方做错了。在这里提及一下，顺便分析一下这个错误产生的原因。也算是增加一些启发性的价值。</strong></p> 
<p>在上文中我写过，本文是参考了博文 <a href="https://blog.csdn.net/weixin_43699672/article/details/103657492">用python实现Apriori算法</a> 的代码实现。实际上这个事情的起因是我第一次做这个任务的时候为了尽快完成作业以便交差，直接搬运了博文里面的代码。我当时吃了不懂 Python 的亏，这次复盘的时候就发现当时的代码里面有一个错误。</p> 
<p>我引用一下原博文的内容：原博文里面有下面的这样一组示例数据：</p> 
<table><thead><tr><th>事务ID</th><th>购买商品</th></tr></thead><tbody><tr><td>001</td><td>面包，黄油，尿布，啤酒</td></tr><tr><td>002</td><td>咖啡，糖，小甜饼，鲑鱼，啤酒</td></tr><tr><td>003</td><td>面包，黄油，咖啡，尿布，啤酒，鸡蛋</td></tr><tr><td>004</td><td>面包，黄油，鲑鱼，鸡</td></tr><tr><td>005</td><td>鸡蛋，面包，黄油</td></tr><tr><td>006</td><td>鲑鱼，尿布，啤酒</td></tr><tr><td>007</td><td>面包，茶，糖鸡蛋</td></tr><tr><td>008</td><td>咖啡，糖，鸡，鸡蛋</td></tr><tr><td>009</td><td>面包，尿布，啤酒，盐</td></tr><tr><td>010</td><td>茶，鸡蛋，小甜饼，尿布，啤酒</td></tr></tbody></table> 
<p>然后博文的作者把下面的一组示例数据写入了 CSV 文件，再用 <code>data = pd.read_csv('test4-1.csv', header=None, sep='\t', encoding='UTF-8')</code> 这样的代码指定了分隔符来读取。</p> 
<pre><code class="prism language-csv">面包,黄油,尿布,啤酒
咖啡,糖,小甜饼,鲑鱼,啤酒
面包,黄油,咖啡,尿布,啤酒,鸡蛋
面包,黄油,鲑鱼,鸡
鸡蛋,面包,黄油
鲑鱼,尿布,啤酒
面包,茶,糖,鸡蛋
咖啡,糖,鸡,鸡蛋
面包,尿布,啤酒,盐
茶,鸡蛋,小甜饼,尿布,啤酒
</code></pre> 
<p>我不知道现在的阅读本文的读者有没有看出这个地方的问题。实际上，这个地方的问题还是比较明显的，就是说这个文字的组织形式不太符合常规的逗号分隔符的 <code>.csv</code> 文件的格式。传统的 <code>.csv</code> 文件为了保证列的数量是相同的，以便在 Excel 之类的表格软件中显示，对于没有任何值的行，会补上逗号。如下，是我们的数据 <code>.csv</code> 文件在文本编辑器里面展示的样子，可以看到在最后一列、倒数第三列存在着相邻的逗号分隔符：</p> 
<pre><code class="prism language-csv">牛奶,啤酒,尿布,
面包,黄油,牛奶,
牛奶,尿布,饼干,
啤酒,饼干,尿布,
牛奶,尿布,面包,黄油
面包,黄油,尿布,
啤酒,尿布,,
牛奶,尿布,面包,黄油
啤酒,饼干,,
</code></pre> 
<p>这样一来，在 Pandas 进行读取的时候，这些没有数值的格子都会被 <code>NaN</code> 给填补上。</p> 
<p>这个时候重点就来了：假如我们下面的代码是直接从原文里面复制粘贴过来的，没有任何针对 <code>NaN</code> 项的处理过程，那么当这些空值项通过代码的时候，是不是就会报错呢？</p> 
<p>实际上，我亲自测试之后发现并不会。<strong>这些 <code>NaN</code> 项会被当做一个特殊的空商品，也被打上一个数字标签，并且合并到字典里去！空字符串所对应的商品编码会变成数字 4，这样一来，在进行关联规则统计的时候，就会多出这样没有意义的一项。</strong></p> 
<p>在下面的代码里面，我通过修改 <code>if i not in goods</code> 这一行代码为 <code>if i not in goods and len(i) != 0</code>，已经把这个问题给解决掉了。</p> 
<p>我们对这里的商品进行编号：读取数据框中的列，把列里面的信息按照逗号分隔符来分割。分割之后遍历分割产生的内容，如果读取到的字符串不在商品列表里面，就将这个商品加入到商品列表里。</p> 
<pre><code class="prism language-python"><span class="token comment"># 对商品进行编号</span>
<span class="token keyword">for</span> key <span class="token keyword">in</span> df_3<span class="token punctuation">.</span>values<span class="token punctuation">:</span>
    key <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    key <span class="token operator">=</span> key<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> key<span class="token punctuation">:</span>
        <span class="token keyword">if</span> i <span class="token keyword">not</span> <span class="token keyword">in</span> goods <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
            goods<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
goods
</code></pre> 
<pre><code>['牛奶', '啤酒', '尿布', '面包', '黄油', '饼干']
</code></pre> 
<p>接下来，我们给每一个商品编号：我们遍历之前找到的包含所有商品名称一字排开的列表 <code>goods</code>，然后给每一个商品一个数字键值。</p> 
<pre><code class="prism language-python"><span class="token comment"># 写入 goodList</span>
<span class="token keyword">for</span> key <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span> <span class="token builtin">len</span><span class="token punctuation">(</span>goods<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">:</span>
    goodsList<span class="token punctuation">[</span> goods<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token punctuation">]</span> <span class="token operator">=</span> key <span class="token operator">+</span> <span class="token number">1</span>
goodsList
</code></pre> 
<pre><code>{'牛奶': 1, '啤酒': 2, '尿布': 3, '面包': 4, '黄油': 5, '饼干': 6}
</code></pre> 
<p>最后我们通过取得的这个 <code>goodsList</code> 字典，把原始数据转化为一个全是数值的二级列表。</p> 
<p>具体的实现就是循环调用 <code>appand</code> 方法，不断在 <code>apriori_data</code> 列表下面追加子列表。在每一次循环开始的时候都把 <code>key_num</code> 列表赋值为空，然后用子循环把商品名对应的数值追加到 <code>key_num</code>，在外层循环结束的时候将 <code>key_num</code> 追加到 <code>apriori_data</code></p> 
<pre><code class="prism language-python"><span class="token comment"># 转换数据</span>
<span class="token keyword">for</span> key <span class="token keyword">in</span> df_3<span class="token punctuation">.</span>values<span class="token punctuation">:</span>
    key_num <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    key <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> key<span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
            key_num<span class="token punctuation">.</span>append<span class="token punctuation">(</span>goodsList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    key_num<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>
    apriori_data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key_num<span class="token punctuation">)</span>
apriori_data
</code></pre> 
<pre><code>[[1, 2, 3],
 [1, 4, 5],
 [1, 3, 6],
 [2, 3, 6],
 [1, 3, 4, 5],
 [3, 4, 5],
 [2, 3],
 [1, 3, 4, 5],
 [2, 6]]
</code></pre> 
<h4><a id="Apriori__1663"></a>Apriori 关联规则算法流程设计和计算</h4> 
<p><strong>让我们来整理一下 Apriori 关联规则算法的流程。</strong></p> 
<p>初始化：生成候选 1 项集</p> 
<p>首先，我们第一步要先生成候选项集，然后判断候选项集中的每一项在原集合中的出现次数；</p> 
<p>第二步，我们将候选项集中的每一项在原集合中的出现次数与最小支持度计数相比较，如果大于最小支持度计数，就把这个候选相机记录为频繁项集，记录下这个频繁项集的支持度</p> 
<p>第三步，循环迭代，生成候选 1 项集到 n 项集，直到发现在上一步迭代的时候，没有产生任何频繁项集为止</p> 
<p>流程图如下所示：</p> 
<div class="mermaid"> 
 <svg id="mermaid-svg-De43u3wkEzMvmamA" width="626.7520751953125" xmlns="http://www.w3.org/2000/svg" height="1219.4443359375" viewbox="0 -0.0000019073486328125 626.7520751953125 1219.4443359375" class="mermaid-svg"> 
  <style>#mermaid-svg-De43u3wkEzMvmamA {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg-De43u3wkEzMvmamA .error-icon{fill:#552222;}#mermaid-svg-De43u3wkEzMvmamA .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-De43u3wkEzMvmamA .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-De43u3wkEzMvmamA .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-De43u3wkEzMvmamA .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-De43u3wkEzMvmamA .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-De43u3wkEzMvmamA .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-De43u3wkEzMvmamA .marker{fill:#333333;stroke:#333333;}#mermaid-svg-De43u3wkEzMvmamA .marker.cross{stroke:#333333;}#mermaid-svg-De43u3wkEzMvmamA svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-De43u3wkEzMvmamA .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg-De43u3wkEzMvmamA .cluster-label text{fill:#333;}#mermaid-svg-De43u3wkEzMvmamA .cluster-label span{color:#333;}#mermaid-svg-De43u3wkEzMvmamA .label text,#mermaid-svg-De43u3wkEzMvmamA span{fill:#333;color:#333;}#mermaid-svg-De43u3wkEzMvmamA .node rect,#mermaid-svg-De43u3wkEzMvmamA .node circle,#mermaid-svg-De43u3wkEzMvmamA .node ellipse,#mermaid-svg-De43u3wkEzMvmamA .node polygon,#mermaid-svg-De43u3wkEzMvmamA .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg-De43u3wkEzMvmamA .node .label{text-align:center;}#mermaid-svg-De43u3wkEzMvmamA .node.clickable{cursor:pointer;}#mermaid-svg-De43u3wkEzMvmamA .arrowheadPath{fill:#333333;}#mermaid-svg-De43u3wkEzMvmamA .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg-De43u3wkEzMvmamA .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg-De43u3wkEzMvmamA .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-svg-De43u3wkEzMvmamA .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-svg-De43u3wkEzMvmamA .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg-De43u3wkEzMvmamA .cluster text{fill:#333;}#mermaid-svg-De43u3wkEzMvmamA .cluster span{color:#333;}#mermaid-svg-De43u3wkEzMvmamA div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-De43u3wkEzMvmamA :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style> 
  <g> 
   <g class="output"> 
    <g class="clusters"></g> 
    <g class="edgePaths"> 
     <g class="edgePath LS-st LE-A" style="opacity: 1;" id="L-st-A"> 
      <path class="path" d="M348.4016351699829,53.983795166015625L348.4016351699829,58.15046183268229C348.4016351699829,62.31712849934896,348.4016351699829,70.6504618326823,348.4849685033162,79.06712849934895C348.5683018366496,87.48379516601562,348.7349685033162,95.98379516601562,348.8183018366496,100.23379516601561L348.9016351699829,104.48379516601561" marker-end="url(#arrowhead696)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead696" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-A LE-B" style="opacity: 1;" id="L-A-B"> 
      <path class="path" d="M348.9016351699829,150.46759223937988L348.8183018366496,154.55092525482178C348.7349685033162,158.63425827026367,348.5683018366496,166.80092430114746,348.4849685033162,175.050923983256C348.4016351699829,183.3009236653646,348.4016351699829,191.6342569986979,348.4016351699829,195.8009236653646L348.4016351699829,199.96759033203125" marker-end="url(#arrowhead697)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead697" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-B LE-For" style="opacity: 1;" id="L-B-For"> 
      <path class="path" d="M301.87485218329357,245.95138549804688L293.44311682617604,250.11805216471353C285.0113814690585,254.28471883138022,268.14791075482344,262.61805216471356,259.7995087310392,271.03471941947936C251.45110670725504,279.4513866742452,251.61777337392172,287.9513878504436,251.70110670725504,292.2013884385428L251.78444004058838,296.45138902664195" marker-end="url(#arrowhead698)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead698" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-For LE-D" style="opacity: 1;" id="L-For-D"> 
      <path class="path" d="M206.94612443314534,397.3630734191988L184.7847723751146,411.0847751884539C162.62342031708388,424.80647695770887,118.3007162010224,452.24988049621896,96.13936414299167,495.0106474675512C73.97801208496094,537.7714144388834,73.97801208496094,595.849544843038,73.97801208496094,624.8886100451151L73.97801208496094,653.9276752471924" marker-end="url(#arrowhead699)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead699" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-D LE-IsleS" style="opacity: 1;" id="L-D-IsleS"> 
      <path class="path" d="M73.97801208496094,699.911470413208L73.97801208496094,726.7852191925049C73.97801208496094,753.6589679718018,73.97801208496094,807.4064655303955,78.04619987536765,843.6266677406501C82.11438766577436,879.8468699509045,90.25076324658778,898.5397768128197,94.3189510369945,907.8862302437774L98.3871388274012,917.232683674735" marker-end="url(#arrowhead700)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead700" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-IsleS LE-W" style="opacity: 1;" id="L-IsleS-W"> 
      <path class="path" d="M128.96586084365836,1089.9768805503845L128.88252751032505,1096.225531021754C128.79919417699173,1102.4741814931233,128.63252751032508,1114.9714824358623,135.72734707149624,1127.635449330012C142.8221666326674,1140.2994162241619,157.17847242167636,1153.1300490697224,164.35662531618084,1159.545365492503L171.53477821068532,1165.9606819152832" marker-end="url(#arrowhead701)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead701" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-W LE-For" style="opacity: 1;" id="L-W-For"> 
      <path class="path" d="M223.11720423782813,1165.9606819152832L230.14488399099102,1159.545365492503C237.17256374415388,1153.1300490697224,251.22792325047965,1140.2994162241619,258.25560300364253,1110.6085398991902C265.2832827568054,1080.9176635742188,265.2832827568054,1034.3665437698364,265.2832827568054,989.9807403882345C265.2832827568054,945.5949370066324,265.2832827568054,903.3744500478109,265.2832827568054,851.5584748586019C265.2832827568054,799.7424996693929,265.2832827568054,738.3310362497965,265.2832827568054,674.7542564074198C265.2832827568054,611.1774765650431,265.2832827568054,545.4353802998861,264.39515926244616,504.9540005504811C263.50703576808695,464.47262080107606,261.7307887793685,449.25195756742306,260.8426652850092,441.6416259505966L259.95454179065,434.0312943337701" marker-end="url(#arrowhead702)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead702" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-IsleS LE-For" style="opacity: 1;" id="L-IsleS-For"> 
      <path class="path" d="M159.54458199934953,917.2326856751916L163.44610326651727,907.8862319108247C167.347624533685,898.5397781464575,175.15066706802045,879.8468706177233,179.05218833518822,839.7946851435581C182.95370960235596,799.7424996693929,182.95370960235596,738.3310362497965,182.95370960235596,674.7542564074198C182.95370960235596,611.1774765650431,182.95370960235596,545.4353802998861,189.79411025889837,501.68429524946333C196.63451091544076,457.93321019904056,210.31531222852553,436.1731363633521,217.15571288506794,425.29309944550795L223.99611354161033,414.41306252766367" marker-end="url(#arrowhead703)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead703" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-For LE-IsA" style="opacity: 1;" id="L-For-IsA"> 
      <path class="path" d="M292.07826844892975,401.9075676754903L308.13119849928614,414.8718537353634C324.18412854964254,427.83613979523653,356.2899886503553,453.7647119149828,377.2460900648122,480.1781128700887C398.202191479269,506.5915138251947,408.0085342074699,533.4897436156604,412.91170557157034,546.9388585108932L417.8148769356708,560.387973406126" marker-end="url(#arrowhead704)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead704" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-IsA LE-B" style="opacity: 1;" id="L-IsA-B"> 
      <path class="path" d="M478.5613792991416,536.7288941001669L479.7199900626951,527.2229590892606C480.87860082624866,517.7170240783543,483.19582235335565,498.7051540565417,484.35443311690915,470.721402622855C485.51304388046265,442.7376511891683,485.51304388046265,405.7820183436076,485.51304388046265,370.9917019208272C485.51304388046265,336.2013854980469,485.51304388046265,303.5763854980469,472.3245303630829,282.6476263847392C459.1360168457031,261.7188672714315,432.7589898109436,252.4863490448162,419.57047629356384,247.87008993150855L406.3819627761841,243.2538308182009" marker-end="url(#arrowhead705)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead705" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-IsA LE-否" style="opacity: 1;" id="L-IsA-否"> 
      <path class="path" d="M460.0176730155945,836.6539473533632L459.93433968226117,840.7372833093009C459.8510063489278,844.8206192652384,459.68433968226117,852.9872911771139,459.6010063489278,874.3488876819611C459.5176730155945,895.7104841868082,459.5176730155945,930.2670052846273,459.5176730155945,947.5452658335367L459.5176730155945,964.8235263824463" marker-end="url(#arrowhead706)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead706" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 0 0 L 0 0 z" style="fill: #333"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-否 LE-ed" style="opacity: 1;" id="L-否-ed"> 
      <path class="path" d="M459.5176730155945,1010.8073215484619L459.5176730155945,1030.2508985201518C459.5176730155945,1049.6944754918416,459.5176730155945,1088.5816294352214,459.5176730155945,1114.3571894963582C459.5176730155945,1140.1327495574951,459.5176730155945,1152.7967157363892,459.5176730155945,1159.1286988258362L459.5176730155945,1165.4606819152832" marker-end="url(#arrowhead707)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead707" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path> 
       </marker> 
      </defs> 
     </g> 
    </g> 
    <g class="edgeLabels"> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-st-A" class="edgeLabel L-LS-st' L-LE-A"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-A-B" class="edgeLabel L-LS-A' L-LE-B"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-B-For" class="edgeLabel L-LS-B' L-LE-For"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform="translate(73.97801208496094,479.693284034729)"> 
      <g transform="translate(-31.990741729736328,-12.991898536682129)" class="label"> 
       <rect rx="0" ry="0" width="63.981483459472656" height="25.983797073364258"></rect> 
       <foreignobject width="63.981483459472656" height="25.983797073364258"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-For-D" class="edgeLabel L-LS-For' L-LE-D">继续遍历</span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-D-IsleS" class="edgeLabel L-LS-D' L-LE-IsleS"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform="translate(128.46586084365845,1127.468783378601)"> 
      <g transform="translate(-7.997685432434082,-12.991898536682129)" class="label"> 
       <rect rx="0" ry="0" width="15.995370864868164" height="25.983797073364258"></rect> 
       <foreignobject width="15.995370864868164" height="25.983797073364258"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-IsleS-W" class="edgeLabel L-LS-IsleS' L-LE-W">是</span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-W-For" class="edgeLabel L-LS-W' L-LE-For"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform="translate(182.95370960235596,676.9195728302002)"> 
      <g transform="translate(-7.997685432434082,-12.991898536682129)" class="label"> 
       <rect rx="0" ry="0" width="15.995370864868164" height="25.983797073364258"></rect> 
       <foreignobject width="15.995370864868164" height="25.983797073364258"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-IsleS-For" class="edgeLabel L-LS-IsleS' L-LE-For">否</span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform="translate(388.3958487510681,479.693284034729)"> 
      <g transform="translate(-31.990741729736328,-12.991898536682129)" class="label"> 
       <rect rx="0" ry="0" width="63.981483459472656" height="25.983797073364258"></rect> 
       <foreignobject width="63.981483459472656" height="25.983797073364258"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-For-IsA" class="edgeLabel L-LS-For' L-LE-IsA">完成遍历</span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform="translate(485.51304388046265,368.8263854980469)"> 
      <g transform="translate(-7.997685432434082,-12.991898536682129)" class="label"> 
       <rect rx="0" ry="0" width="15.995370864868164" height="25.983797073364258"></rect> 
       <foreignobject width="15.995370864868164" height="25.983797073364258"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-IsA-B" class="edgeLabel L-LS-IsA' L-LE-B">是</span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-IsA-否" class="edgeLabel L-LS-IsA' L-LE-否"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-否-ed" class="edgeLabel L-LS-否' L-LE-ed"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
    </g> 
    <g class="nodes"> 
     <g class="node default" style="opacity: 1;" id="flowchart-st-428" transform="translate(348.4016351699829,30.991897583007812)"> 
      <rect rx="22.99189853668213" ry="22.99189853668213" x="-31.743345499038696" y="-22.99189853668213" width="63.48669099807739" height="45.98379707336426" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-15.995370864868164,-12.991898536682129)"> 
        <foreignobject width="31.990741729736328" height="25.983797073364258"> 
         <div style="display: inline-block; white-space: nowrap;">
           开始 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="flowchart-A-429" transform="translate(348.4016351699829,126.97569274902344)"> 
      <polygon points="-15.327932357788086,0 140.28742694854736,0 163.2793254852295,-45.98379707336426 7.663966178894043,-45.98379707336426" transform="translate(-73.9756965637207,22.99189853668213)" class="label-container"></polygon> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-63.9756965637207,-12.991898536682129)"> 
        <foreignobject width="127.9513931274414" height="25.983797073364258"> 
         <div style="display: inline-block; white-space: nowrap;">
           获取全部关联项集 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="flowchart-IsA-430" transform="translate(459.5176730155945,676.9195728302002)"> 
      <polygon points="159.23438501358032,0 318.46877002716064,-159.23438501358032 159.23438501358032,-318.46877002716064 0,-159.23438501358032" transform="translate(-159.23438501358032,159.23438501358032)" class="label-container"></polygon> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-143.93519592285156,-12.991898536682129)"> 
        <foreignobject width="287.8703918457031" height="25.983797073364258"> 
         <div style="display: inline-block; white-space: nowrap;">
           根据上回合频繁项集还能生成候选项集吗 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="flowchart-B-431" transform="translate(348.4016351699829,222.95948791503906)"> 
      <rect rx="0" ry="0" x="-57.98032760620117" y="-22.99189853668213" width="115.96065521240234" height="45.98379707336426" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-47.98032760620117,-12.991898536682129)"> 
        <foreignobject width="95.96065521240234" height="25.983797073364258"> 
         <div style="display: inline-block; white-space: nowrap;">
           生成候选项集 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="flowchart-For-432" transform="translate(251.28444004058838,368.8263854980469)"> 
      <polygon points="72.87500352859497,0 145.75000705718995,-72.87500352859497 72.87500352859497,-145.75000705718995 0,-72.87500352859497" transform="translate(-72.87500352859497,72.87500352859497)" class="label-container"></polygon> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-47.98032760620117,-12.991898536682129)"> 
        <foreignobject width="95.96065521240234" height="25.983797073364258"> 
         <div style="display: inline-block; white-space: nowrap;">
           遍历候选项集 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="flowchart-D-433" transform="translate(73.97801208496094,676.9195728302002)"> 
      <rect rx="0" ry="0" x="-65.97801208496094" y="-22.99189853668213" width="131.95602416992188" height="45.98379707336426" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-55.97801208496094,-12.991898536682129)"> 
        <foreignobject width="111.95602416992188" height="25.983797073364258"> 
         <div style="display: inline-block; white-space: nowrap;">
           计算支持度计数 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="flowchart-IsleS-434" transform="translate(128.46586084365845,987.8154239654541)"> 
      <polygon points="101.66145944595337,0 203.32291889190674,-101.66145944595337 101.66145944595337,-203.32291889190674 0,-101.66145944595337" transform="translate(-101.66145944595337,101.66145944595337)" class="label-container"></polygon> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-79.96527862548828,-12.991898536682129)"> 
        <foreignobject width="159.93055725097656" height="25.983797073364258"> 
         <div style="display: inline-block; white-space: nowrap;">
           大于最小支持度计数吗 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="flowchart-W-435" transform="translate(196.79659128189087,1188.452579498291)"> 
      <polygon points="-15.327932357788086,0 108.2966890335083,0 131.28858757019043,-45.98379707336426 7.663966178894043,-45.98379707336426" transform="translate(-57.98032760620117,22.99189853668213)" class="label-container"></polygon> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-47.98032760620117,-12.991898536682129)"> 
        <foreignobject width="95.96065521240234" height="25.983797073364258"> 
         <div style="display: inline-block; white-space: nowrap;">
           计入频繁项集 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="flowchart-ed-436" transform="translate(459.5176730155945,1188.452579498291)"> 
      <rect rx="22.99189853668213" ry="22.99189853668213" x="-31.743345499038696" y="-22.99189853668213" width="63.48669099807739" height="45.98379707336426" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-15.995370864868164,-12.991898536682129)"> 
        <foreignobject width="31.990741729736328" height="25.983797073364258"> 
         <div style="display: inline-block; white-space: nowrap;">
           结束 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="flowchart-否-455" transform="translate(459.5176730155945,987.8154239654541)"> 
      <rect rx="0" ry="0" x="-17.997685432434082" y="-22.99189853668213" width="35.995370864868164" height="45.98379707336426" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-7.997685432434082,-12.991898536682129)"> 
        <foreignobject width="15.995370864868164" height="25.983797073364258"> 
         <div style="display: inline-block; white-space: nowrap;">
           否 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
    </g> 
   </g> 
  </g> 
 </svg> 
</div> 
<p>确定了算法的流程就可以进行算法的实现了。不过在此之前，还有一个问题，就是我们该如何生成候选项集呢？</p> 
<p>这里显然要用到排列组合的方法，也就是说：</p> 
<ol><li>如果是从头开始执行算法，那么第一个候选项集就是原始的数据集里面所有的商品一字排开</li><li>如果是在算法的某一级循环当中，那么候选项集就要取上一次循环里的所有频繁项集的排列组合</li></ol> 
<p>显然，如果我们想要写一个循环的话，就要遍历从候选 1 项集到候选 n 项集的所有情形。在这种情况下，实际上就是要首先指定生成的候选项集的每一项里面包含了商品的个数（也就是说，当生成候选 i 项集的时候，要把参数 i 传入），然后按照每一项里面的商品个数 i 把我们传入的数据集进行排列组合。</p> 
<p>这里调用了 itertools 库里的组合方法 <code>combinations(p,r)</code></p> 
<ul><li><code>p</code> 是一个list参数</li><li><code>r</code> 是数字，r 长度的 tuple 对象，按顺序排列，没有重复元素</li></ul> 
<p><em>这里要求 <code>r</code> 要小于 <code>p</code> 的长度。如果不小于，那么方法也会正常执行，只不过返回的是空的对象。</em></p> 
<p>为了说明这个方法是如何进行排列组合的，请看下面的示例代码：</p> 
<pre><code class="prism language-python"><span class="token comment"># 用于排列组合的示例列表 list_1</span>
list_1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
<span class="token comment"># 取 list_1 的组合，并转换成 list</span>
list_2 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span> itertools<span class="token punctuation">.</span>combinations<span class="token punctuation">(</span>list_1<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>list_2<span class="token punctuation">)</span>
</code></pre> 
<pre><code>[(1, 2, 3), (1, 2, 4), (1, 3, 4), (2, 3, 4)]
</code></pre> 
<p>可以看到我这里对于列表 1 进行了排列组合，生成了列表 2。</p> 
<p>同时，在代码当中，我们对排列组合的结果取了 <code>list()</code>，之所以这样做，是因为如果不转化成 <code>list</code>，结果返回的是对象地址，而不是组合好的 tuple 对象。</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>itertools<span class="token punctuation">.</span>combinations<span class="token punctuation">(</span>list_1<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>&lt;itertools.combinations object at 0x000001AF88A4E450&gt;
</code></pre> 
<p>接下来我们就可以写出这个用于生成候选项集的函数了。</p> 
<p>因为这个函数是要用在 Apriori 关联规则算法的大循环里面的，所以我们给到一个参数 <code>i</code>，参数 <code>i</code> 代表的是关联规则算法的循环迭代次数，同时也代表生成的项集是候选 <code>i</code> 项集。</p> 
<pre><code class="prism language-python"><span class="token comment"># separate 函数用于将 data 中的数据进行排列组合，i 是组合的大小</span>
<span class="token comment"># 作用是生成候选项集</span>
<span class="token comment"># 简单的来说，当 i = n 的时候，产生 n 项集的随机组合</span>
<span class="token keyword">def</span> <span class="token function">separate</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">:</span>
    a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token comment"># 故技重施</span>
    <span class="token comment"># 创建一个所有项只出现一次的一字排开的列表</span>
    <span class="token keyword">for</span> k <span class="token keyword">in</span> data<span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> k<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token keyword">not</span> <span class="token keyword">in</span> a<span class="token punctuation">:</span>
                a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>k<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 当迭代循环的次数</span>
    <span class="token comment"># 小于等于可以用于重新组合的列表项个数的时候</span>
    <span class="token comment"># 执行下面的操作</span>
    <span class="token comment"># （如果不这样操作，就会产生空列表对象加入 b）</span>
    <span class="token comment"># （b 会变成双层列表）</span>
    <span class="token keyword">if</span> i <span class="token operator">&lt;=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> k <span class="token keyword">in</span> itertools<span class="token punctuation">.</span>combinations<span class="token punctuation">(</span>a<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">:</span>
            b<span class="token punctuation">.</span>append<span class="token punctuation">(</span> <span class="token builtin">list</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token keyword">return</span> b
</code></pre> 
<p>下面就是 Apriori 关联规则算法最核心的部分。我把注释写得非常详细以便人可以看得懂。</p> 
<p>这里用到了递归的方法来优化代码：</p> 
<pre><code class="prism language-python"><span class="token string">" Apriori 算法 "</span>
<span class="token comment"># 其中 s 是最小支持度, data 是数据集, data_iter 是迭代中的数据集,</span>
<span class="token comment"># c 是输出的频繁项集, s 是频繁项集对应的支持度</span>
<span class="token keyword">def</span> <span class="token function">apriori</span><span class="token punctuation">(</span>s_min<span class="token punctuation">,</span> data<span class="token punctuation">,</span> data_iter<span class="token punctuation">,</span> s <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data_iter<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token comment"># 上回合频繁项集不为空时</span>
        goods <span class="token operator">=</span> separate<span class="token punctuation">(</span>data_iter<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token comment"># 生成候选项集</span>
        data_iter <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment"># 初始化用于迭代的数据集为空</span>
        <span class="token keyword">for</span> good <span class="token keyword">in</span> goods<span class="token punctuation">:</span>
            num <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment"># 初始化候选项集支持度计数为 0</span>
            <span class="token keyword">for</span> key <span class="token keyword">in</span> data<span class="token punctuation">:</span>
                <span class="token keyword">if</span> <span class="token builtin">set</span><span class="token punctuation">(</span>good<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token builtin">set</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token comment"># set() 函数为 Python 内置的函数</span>
                <span class="token comment"># 创建一个无序不重复元素集</span>
                <span class="token comment"># 可进行关系测试，删除重复数据</span>
                <span class="token comment"># 还可以计算交集、差集、并集等</span>
                    num <span class="token operator">=</span> num <span class="token operator">+</span> <span class="token number">1</span> <span class="token comment"># 计数候选项集在原始数据里的出现次数</span>
            <span class="token keyword">if</span> num <span class="token operator">&gt;=</span> s_min<span class="token punctuation">:</span> <span class="token comment"># 如果出现次数大于最小支持度计数</span>
                c<span class="token punctuation">.</span>append<span class="token punctuation">(</span>good<span class="token punctuation">)</span> <span class="token comment"># 计入频繁项集</span>
                s<span class="token punctuation">.</span>append<span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token comment"># 同时记录这一频繁项集支持度</span>
                data_iter<span class="token punctuation">.</span>append<span class="token punctuation">(</span>good<span class="token punctuation">)</span>
                <span class="token comment"># 频繁项集计入用于迭代的 data_iter</span>
                <span class="token comment"># c 保存的是所有的频繁项集</span>
                <span class="token comment"># 而 data_iter 保存的是本轮的频繁项集</span>
                <span class="token comment"># 在循环开始的时候清空</span>
                <span class="token comment"># 如果进入递归就会导致死循环</span>
        <span class="token comment"># 递归</span>
        <span class="token comment"># i 是候选项集的项数</span>
        <span class="token comment"># 从频繁 1 项集遍历到频繁 n 项集</span>
        <span class="token comment"># 直到无法生成频繁 n 项集，即 data_iter = []</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"第"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token string">"次迭代："</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span>
        apriori<span class="token punctuation">(</span>s_min<span class="token punctuation">,</span> data<span class="token punctuation">,</span> data_iter<span class="token punctuation">,</span> s<span class="token punctuation">,</span> c<span class="token punctuation">,</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> c<span class="token punctuation">,</span> s
</code></pre> 
<p>这段代码除了实现了功能之外，还非常巧妙地用到了 Python 内置的一个 <code>set()</code> 函数。这个东西因为平时使用比较少，所以很多人可能不知道这个东西是干什么用的。以下是对 <code>set()</code> 的简单介绍：</p> 
<blockquote> 
 <p><code>set()</code> 函数创建一个无序不重复元素集，可进行关系测试，删除重复数据，还可以计算交集、差集、并集等。</p> 
 <p>语法：</p> 
 <pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">set</span><span class="token punctuation">(</span><span class="token punctuation">[</span>iterable<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
 <p>参数说明：<code>iterable</code> - 可迭代对象对象</p> 
 <p>返回值：返回新的集合对象</p> 
</blockquote> 
<p>简单的使用方法可以参考这个快速教程链接 <a href="https://www.runoob.com/python/python-func-set.html" rel="nofollow">Python set () 函数 | 菜鸟教程</a></p> 
<p>接下来我们就可以进行 Apriori 关联规则算法的计算了。我们这里选择最小支持度计数为 4 查找频繁项集：</p> 
<pre><code class="prism language-python">C <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
S <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token comment">#设置最小支持度为4</span>
C<span class="token punctuation">,</span> S <span class="token operator">=</span> apriori<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> apriori_data<span class="token punctuation">,</span> apriori_data<span class="token punctuation">,</span> S<span class="token punctuation">,</span> C<span class="token punctuation">)</span>
</code></pre> 
<pre><code>第 1 次迭代： [[1], [2], [3], [4], [5]]
第 2 次迭代： [[1], [2], [3], [4], [5], [1, 3], [4, 5]]
第 3 次迭代： [[1], [2], [3], [4], [5], [1, 3], [4, 5]]
</code></pre> 
<h4><a id="_1841"></a>关联规则挖掘和输出结果的分析</h4> 
<p>查看一下计算的结果：</p> 
<p>列表 <code>C</code> 保存了所有的关联项集</p> 
<pre><code class="prism language-python">C
</code></pre> 
<pre><code>[[1], [2], [3], [4], [5], [1, 3], [4, 5]]
</code></pre> 
<p>列表 S 保存的是每个项集的支持度计数</p> 
<pre><code class="prism language-python">S
</code></pre> 
<pre><code>[5, 4, 7, 4, 4, 4, 4]
</code></pre> 
<p>然后我们通过之前保存的字典 <code>goodsList</code>，把我们的关联规则，算法运行的结果恢复成商品名的二维列表。</p> 
<pre><code class="prism language-python">C1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> value <span class="token keyword">in</span> C<span class="token punctuation">:</span>
    a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> value<span class="token punctuation">:</span>
        a<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>goodsList<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token builtin">list</span><span class="token punctuation">(</span>goodsList<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token comment"># keys() 方法返回 view 对象。这个视图对象包含列表形式的字典键。</span>
        <span class="token comment"># values()函数返回一个字典中所有的值。</span>
    C1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
C1
</code></pre> 
<pre><code>[['牛奶'], ['啤酒'], ['尿布'], ['面包'], ['黄油'], ['牛奶', '尿布'], ['面包', '黄油']]
</code></pre> 
<p>在上述代码里面我们可以看到，在这段代码里面有一个非常奇怪的表述，是这个样子的：</p> 
<pre><code class="prism language-python"><span class="token builtin">list</span><span class="token punctuation">(</span>goodsList<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token builtin">list</span><span class="token punctuation">(</span>goodsList<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre> 
<p>这个代码因为写得太长了，导致不好理解，让我来解释一下这个代码的意思：</p> 
<ul><li><code>goodsList.keys()</code> 和 <code>goodsList.values()</code> 都是字典对象的方法，分别返回的是字典的键和值。对于我们这里的 <code>goodsList</code>，返回的就是按顺序排列的商品名和商品的数字编号</li><li><code>list(goodsList.values())</code> 把返回的字典的值转化为了一个列表对象，然后通过列表对象的 <code>.index()</code> 方法返回了列表中值为 <code>i</code> 的值的项的下标</li><li><code>list(goodsList.keys())</code> 把返回的字典的键也转化为了一个列表对象。后面的方括号表示取下标为方括号里面的值的列表对象，而方括号里面的值就是我们之前说的商品数字编号列表中值为 <code>i</code> 的值的项的下标</li></ul> 
<p>总的来说，这行代码的原理就是通过使用字典的两种不同的方法，制造出商品数字编号列表和商品名称列表两个列表，然后通过查找商品编号列表中数值等于 i 的项所在的下标去定位这个下标所对应的商品编号所对应的商品名称。这行代码可以说是非常的七拐八绕，但是确实用一行代码就实现了七拐八绕的功能。</p> 
<p>因为这段代码下面还会反复出现，实现的功能也是相同的，所以我这里声明一下，防止在后文当中看不懂。</p> 
<p>我们来看一下现在的输出结果：</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'- 支持度：'</span><span class="token punctuation">,</span> S<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'- 频繁项集：'</span><span class="token punctuation">,</span> C<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'- 对应的商品：'</span><span class="token punctuation">,</span> C1<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'各个频繁项集的支持度：'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>C1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"  "</span><span class="token punctuation">,</span> C1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'的支持度:'</span><span class="token punctuation">,</span> S<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>- 支持度： [5, 4, 7, 4, 4, 4, 4]
- 频繁项集： [[1], [2], [3], [4], [5], [1, 3], [4, 5]]
- 对应的商品： [['牛奶'], ['啤酒'], ['尿布'], ['面包'], ['黄油'], ['牛奶', '尿布'], ['面包', '黄油']]

各个频繁项集的支持度：
   ['牛奶'] 的支持度: 5
   ['啤酒'] 的支持度: 4
   ['尿布'] 的支持度: 7
   ['面包'] 的支持度: 4
   ['黄油'] 的支持度: 4
   ['牛奶', '尿布'] 的支持度: 4
   ['面包', '黄油'] 的支持度: 4
</code></pre> 
<p>接下来，我们通过下面的这个函数定义来实现一下关联规则挖掘。</p> 
<p>关联规则挖掘的逻辑是这样的：对于一个关联项集，取出其中的每一项，计算这一项在这个关联项集合中的置信度（支持度计数与这个集合的支持度计数的比值）。如果这一项的支持度计数与这个集合的支持度计数的比值（置信度）大于等于我们预设的最小置信度，就可以认为这个元素和这个关联项集里的其他元素呈现出关联规则。</p> 
<pre><code class="prism language-python"><span class="token comment">#根据频繁项集获取关联规则</span>
<span class="token comment"># c 是最小置信度，S 是置信度列表，C 是频繁项集</span>
<span class="token keyword">def</span> <span class="token function">get_associationRules</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> S<span class="token punctuation">,</span> C<span class="token punctuation">,</span> goodList<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> key <span class="token keyword">in</span> C<span class="token punctuation">:</span>
        a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment"># 用于保存需要测算关联规则的商品的编号</span>
        b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment"># 用于保存需要测算关联规则的商品的名称</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">:</span> <span class="token comment"># 当 C 中的频繁项集不止一个元素时</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> key<span class="token punctuation">:</span> <span class="token comment"># 遍历 len &gt; 1 的频繁项集</span>
                a<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 把每个频繁项添加到 a，对应的中文商品名存入 b</span>
                b<span class="token punctuation">.</span>append<span class="token punctuation">(</span>
                    <span class="token builtin">list</span><span class="token punctuation">(</span>
                        goodList<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token punctuation">)</span><span class="token punctuation">[</span>
                            <span class="token builtin">list</span><span class="token punctuation">(</span>
                                goodList<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span>
                                <span class="token punctuation">)</span><span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
                            <span class="token punctuation">]</span>
                    <span class="token punctuation">)</span>
 
            <span class="token keyword">for</span> a_value <span class="token keyword">in</span> a<span class="token punctuation">:</span> <span class="token comment"># 对于这个频繁项集中的每一项</span>
                a_value_c <span class="token operator">=</span> S<span class="token punctuation">[</span>C<span class="token punctuation">.</span>index<span class="token punctuation">(</span>a_value<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment"># 取其作为频繁 1 项集时的支持度</span>
                key_c <span class="token operator">=</span> S<span class="token punctuation">[</span>C<span class="token punctuation">.</span>index<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment"># 再取这个频繁 n 项集的支持度</span>

                <span class="token keyword">if</span> key_c <span class="token operator">/</span> a_value_c <span class="token operator">&gt;=</span> c<span class="token punctuation">:</span> <span class="token comment"># 如果支持度比值大于置信度</span>
                    value <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>
                        goodList<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token punctuation">)</span><span class="token punctuation">[</span>
                            <span class="token builtin">list</span><span class="token punctuation">(</span>goodList<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span>
                                 <span class="token punctuation">)</span><span class="token punctuation">.</span>index<span class="token punctuation">(</span>a_value<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                                <span class="token punctuation">)</span>
                            <span class="token punctuation">]</span>
                    d <span class="token operator">=</span> b<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 这里需要用 .copy() 方法而不是直接赋值</span>
                    d<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>value<span class="token punctuation">)</span> 
                    <span class="token comment"># 去掉这个项集里面的原 value 得到的就是关联规则</span>
                    <span class="token comment"># 最后输出结果</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'  '</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>value<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">' ---&gt; '</span><span class="token punctuation">,</span> d<span class="token punctuation">,</span> <span class="token string">' : '</span><span class="token punctuation">,</span> key_c <span class="token operator">/</span> a_value_c<span class="token punctuation">)</span> 
</code></pre> 
<p>在上面的代码里面有一些需要注意的地方，比如这里使用了 <code>d = b.copy()</code>。这是因为在 Python 里面，列表直接赋值得到的是引用，而不是等值的列表。如果直接赋值，那么对 <code>d</code> 的任何操作都会直接对 <code>b</code> 产生相同影响。（虽然这是一个常识，但是我还是为了防止有人忘记或者不知道，所以在这里声明一下。）</p> 
<pre><code class="prism language-python"><span class="token comment"># 输出关联规则</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'关联规则 - 置信度按 0.4 计算：'</span><span class="token punctuation">)</span>
get_associationRules<span class="token punctuation">(</span><span class="token number">0.4</span><span class="token punctuation">,</span> S<span class="token punctuation">,</span> C<span class="token punctuation">,</span> goodsList<span class="token punctuation">)</span>
</code></pre> 
<pre><code>关联规则 - 置信度按 0.4 计算：
   ['牛奶']  ---&gt;  ['尿布']  :  0.8
   ['尿布']  ---&gt;  ['牛奶']  :  0.5714285714285714
   ['面包']  ---&gt;  ['黄油']  :  1.0
   ['黄油']  ---&gt;  ['面包']  :  1.0
</code></pre> 
<p>这就是我们关联规则挖掘的最终结果了。</p> 
<h3><a id="_4_2000"></a>任务 4：层次分析法决策问题</h3> 
<p>某高校正在进行教师的评优工作，现应用层次分析法对待评教师的综合素质进行评价。整个层次结构分为三层，最高层即问题分析的总目标，要评选出优秀教师A；第二层是准则层，包括三种指标学识水平 C1、科研能力 C2、教学工作 C3；第三层是方案层，即参加评优的教师，假设对五位候选教师 P1、P2、P3、P4、P5 进行评优，其中 P2、P3、P4 为任课教师，需要从学识水平、科研能力、教学工作三方面评估其综合素质，教师 P5 是科研人员，只需从学识水平、科研能力两方面衡量其综合素质，教师 P1 是行政人员，只需从学识水平和教学工作两方面衡量。</p> 
<p>三个评价指标的相对重要程度不同，并且各位教师在三个指标上表现不同，具体如下：</p> 
<ul><li>科研能力指标比学识水平指标明显重要</li><li>教学工作指标比学识水平指标稍微重要</li><li>科研能力指标比教学工作指标稍微重要。</li></ul> 
<p>在学识水平上：</p> 
<ul><li>P1 稍微高于 P2，P1 明显高于 P3</li><li>P1 比 P4 处于稍微高与明显高之间</li><li>P1 强烈高于 P5，P2 稍微高于 P3</li><li>P2 比 P4 处于同样高与稍微高之间</li><li>P2 明显高于 P5，P3 比 P5 处于同样高与稍微高之间</li><li>P4 比 P3 处于同样高与稍微高之间</li><li>P4 稍微高于 P5；</li></ul> 
<p>在科研能力上：</p> 
<ul><li>P3 强烈高于 P2</li><li>P4 稍微高于 P2</li><li>P5 明显高于 P2</li><li>P3 明显高于 P4</li><li>P3 比 P5 处于同样高与稍微高之间</li><li>P5 稍微高于 P4</li></ul> 
<p>在教学工作上：</p> 
<ul><li>P1 稍微高于 P3</li><li>P1 稍微高于 P4</li><li>P2 稍微高于 P3</li><li>P2 稍微高于 P4</li><li>P1 与 P2 水平相当</li><li>P3 与 P4 水平相当。</li></ul> 
<p>请采用层次分析法对候选教师的综合素质进行评价排序。</p> 
<h4><a id="_2040"></a>层次分析法的准则构造</h4> 
<p>由于题干条件已经给出了层次准则构造的要求，这里就不需要进行自主设计了。</p> 
<p>根据题干条件，对于上述问题，层次分析准则构造如下：</p> 
<div class="mermaid"> 
 <svg id="mermaid-svg-hxmxN6axDw4zqN8M" width="565.4212646484375" xmlns="http://www.w3.org/2000/svg" height="503.9513854980469" viewbox="-0.000030517578125 0 565.4212646484375 503.9513854980469" class="mermaid-svg"> 
  <style>#mermaid-svg-hxmxN6axDw4zqN8M {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg-hxmxN6axDw4zqN8M .error-icon{fill:#552222;}#mermaid-svg-hxmxN6axDw4zqN8M .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-hxmxN6axDw4zqN8M .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-hxmxN6axDw4zqN8M .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-hxmxN6axDw4zqN8M .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-hxmxN6axDw4zqN8M .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-hxmxN6axDw4zqN8M .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-hxmxN6axDw4zqN8M .marker{fill:#333333;stroke:#333333;}#mermaid-svg-hxmxN6axDw4zqN8M .marker.cross{stroke:#333333;}#mermaid-svg-hxmxN6axDw4zqN8M svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-hxmxN6axDw4zqN8M .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg-hxmxN6axDw4zqN8M .cluster-label text{fill:#333;}#mermaid-svg-hxmxN6axDw4zqN8M .cluster-label span{color:#333;}#mermaid-svg-hxmxN6axDw4zqN8M .label text,#mermaid-svg-hxmxN6axDw4zqN8M span{fill:#333;color:#333;}#mermaid-svg-hxmxN6axDw4zqN8M .node rect,#mermaid-svg-hxmxN6axDw4zqN8M .node circle,#mermaid-svg-hxmxN6axDw4zqN8M .node ellipse,#mermaid-svg-hxmxN6axDw4zqN8M .node polygon,#mermaid-svg-hxmxN6axDw4zqN8M .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg-hxmxN6axDw4zqN8M .node .label{text-align:center;}#mermaid-svg-hxmxN6axDw4zqN8M .node.clickable{cursor:pointer;}#mermaid-svg-hxmxN6axDw4zqN8M .arrowheadPath{fill:#333333;}#mermaid-svg-hxmxN6axDw4zqN8M .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg-hxmxN6axDw4zqN8M .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg-hxmxN6axDw4zqN8M .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-svg-hxmxN6axDw4zqN8M .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-svg-hxmxN6axDw4zqN8M .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg-hxmxN6axDw4zqN8M .cluster text{fill:#333;}#mermaid-svg-hxmxN6axDw4zqN8M .cluster span{color:#333;}#mermaid-svg-hxmxN6axDw4zqN8M div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-hxmxN6axDw4zqN8M :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style> 
  <g> 
   <g class="output"> 
    <g class="clusters"> 
     <g class="cluster" id="flowchart-方案层-529" style="opacity: 1;" transform="translate(282.7106509208679,447.95948791503906)"> 
      <rect width="549.4213018417358" height="95.98379516601562" x="-274.7106509208679" y="-47.99189758300781"></rect> 
      <g class="label" transform="translate(0, -33.99189758300781)" id="mermaid-svg-hxmxN6axDw4zqN8MText"> 
       <g transform="translate(-23.993057250976562,-12.991898536682129)"> 
        <foreignobject width="47.986114501953125" height="25.983797073364258"> 
         <div style="display: inline-block; white-space: nowrap;">
           方案层 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="cluster" id="flowchart-准则层-530" style="opacity: 1;" transform="translate(279.2962989807129,251.97569274902344)"> 
      <rect width="542.5925979614258" height="95.98379516601562" x="-271.2962989807129" y="-47.99189758300781"></rect> 
      <g class="label" transform="translate(0, -33.99189758300781)" id="mermaid-svg-hxmxN6axDw4zqN8MText"> 
       <g transform="translate(-23.993057250976562,-12.991898536682129)"> 
        <foreignobject width="47.986114501953125" height="25.983797073364258"> 
         <div style="display: inline-block; white-space: nowrap;">
           准则层 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="cluster" id="flowchart-目标层-531" style="opacity: 1;" transform="translate(286.958336353302,55.99189758300781)"> 
      <rect width="329.6296339035034" height="95.98379516601562" x="-164.8148169517517" y="-47.99189758300781"></rect> 
      <g class="label" transform="translate(0, -33.99189758300781)" id="mermaid-svg-hxmxN6axDw4zqN8MText"> 
       <g transform="translate(-23.993057250976562,-12.991898536682129)"> 
        <foreignobject width="47.986114501953125" height="25.983797073364258"> 
         <div style="display: inline-block; white-space: nowrap;">
           目标层 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
    </g> 
    <g class="edgePaths"> 
     <g class="edgePath LS-top LE-C1" style="opacity: 1;" id="L-top-C1"> 
      <path class="path" d="M296.92346757160584,78.98379516601562L297.0681679506017,83.1504618326823C297.2128683295976,87.31712849934895,297.50226908758935,95.6504618326823,297.6469694665852,103.98379516601562C297.79166984558105,112.31712849934895,297.79166984558105,120.6504618326823,297.79166984558105,128.98379516601562C297.79166984558105,137.31712849934897,297.79166984558105,145.65046183268228,297.79166984558105,153.98379516601562C297.79166984558105,162.31712849934897,297.79166984558105,170.65046183268228,297.79166984558105,178.98379516601562C297.79166984558105,187.31712849934897,297.79166984558105,195.65046183268228,297.79166984558105,203.98379516601562C297.79166984558105,212.31712849934897,297.79166984558105,220.65046183268228,297.79166984558105,224.81712849934897L297.79166984558105,228.98379516601562" marker-end="url(#arrowhead841)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead841" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 0 0 L 0 0 z" style="fill: #333"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-top LE-C2" style="opacity: 1;" id="L-top-C2"> 
      <path class="path" d="M338.1157445907593,70.8480925988L353.72531270980835,76.37070969333594C369.3348808288574,81.89332678787187,400.55401706695557,92.93856097694375,416.16358518600464,102.62784473814635C431.7731533050537,112.31712849934895,431.7731533050537,120.6504618326823,431.7731533050537,128.98379516601562C431.7731533050537,137.31712849934897,431.7731533050537,145.65046183268228,431.7731533050537,153.98379516601562C431.7731533050537,162.31712849934897,431.7731533050537,170.65046183268228,431.7731533050537,178.98379516601562C431.7731533050537,187.31712849934897,431.7731533050537,195.65046183268228,431.7731533050537,203.98379516601562C431.7731533050537,212.31712849934897,431.7731533050537,220.65046183268228,431.7731533050537,224.81712849934897L431.7731533050537,228.98379516601562" marker-end="url(#arrowhead842)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead842" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 0 0 L 0 0 z" style="fill: #333"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-top LE-C3" style="opacity: 1;" id="L-top-C3"> 
      <path class="path" d="M254.13426113128662,71.22235650073681L239.08024867375693,76.68259627828327C224.0262362162272,82.14283605582975,193.91821130116782,93.06331561092269,178.8641988436381,102.69022205513583C163.8101863861084,112.31712849934895,163.8101863861084,120.6504618326823,163.8101863861084,128.98379516601562C163.8101863861084,137.31712849934897,163.8101863861084,145.65046183268228,163.8101863861084,153.98379516601562C163.8101863861084,162.31712849934897,163.8101863861084,170.65046183268228,163.8101863861084,178.98379516601562C163.8101863861084,187.31712849934897,163.8101863861084,195.65046183268228,163.8101863861084,203.98379516601562C163.8101863861084,212.31712849934897,163.8101863861084,220.65046183268228,163.8101863861084,224.81712849934897L163.8101863861084,228.98379516601562" marker-end="url(#arrowhead843)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead843" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 0 0 L 0 0 z" style="fill: #333"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-C1 LE-P1" style="opacity: 1;" id="L-C1-P1"> 
      <path class="path" d="M255.80092811584473,262.08687777909057L229.5817920366923,268.4003298712474C203.36265595753989,274.71378196340413,150.92438379923502,287.3406861477177,124.7052477200826,297.8208049065411C98.48611164093018,308.30092366536456,98.48611164093018,316.63425699869794,98.48611164093018,324.96759033203125C98.48611164093018,333.30092366536456,98.48611164093018,341.63425699869794,98.48611164093018,349.96759033203125C98.48611164093018,358.30092366536456,98.48611164093018,366.63425699869794,98.48611164093018,374.96759033203125C98.48611164093018,383.30092366536456,98.48611164093018,391.63425699869794,95.56396840289665,399.96759033203125C92.64182516486312,408.30092366536456,86.79753868879607,416.63425699869794,83.87539545076254,420.80092366536456L80.95325221272901,424.96759033203125" marker-end="url(#arrowhead844)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead844" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 0 0 L 0 0 z" style="fill: #333"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-C3 LE-P1" style="opacity: 1;" id="L-C3-P1"> 
      <path class="path" d="M121.81944465637207,270.4670486215297L110.65432119369507,275.38380557328C99.48919773101807,280.3005625250302,77.15895080566406,290.13407642853076,65.99382734298706,299.2175000469477C54.82870388031006,308.30092366536456,54.82870388031006,316.63425699869794,54.82870388031006,324.96759033203125C54.82870388031006,333.30092366536456,54.82870388031006,341.63425699869794,54.82870388031006,349.96759033203125C54.82870388031006,358.30092366536456,54.82870388031006,366.63425699869794,54.82870388031006,374.96759033203125C54.82870388031006,383.30092366536456,54.82870388031006,391.63425699869794,55.696905988688854,399.96759033203125C56.56510809706765,408.30092366536456,58.30151231382524,416.63425699869794,59.16971442220404,420.80092366536456L60.03791653058284,424.96759033203125" marker-end="url(#arrowhead845)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead845" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 0 0 L 0 0 z" style="fill: #333"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-C1 LE-P2" style="opacity: 1;" id="L-C1-P2"> 
      <path class="path" d="M255.80092811584473,270.52219961287545L244.6898169517517,275.4297647327348C233.5787057876587,280.33732985259405,211.35648345947266,290.15246009231265,200.24537229537964,299.2266918788386C189.13426113128662,308.30092366536456,189.13426113128662,316.63425699869794,189.13426113128662,324.96759033203125C189.13426113128662,333.30092366536456,189.13426113128662,341.63425699869794,189.13426113128662,349.96759033203125C189.13426113128662,358.30092366536456,189.13426113128662,366.63425699869794,189.13426113128662,374.96759033203125C189.13426113128662,383.30092366536456,189.13426113128662,391.63425699869794,185.92271713526137,399.96759033203125C182.71117313923608,408.30092366536456,176.28808514718557,416.63425699869794,173.0765411511603,420.80092366536456L169.86499715513506,424.96759033203125" marker-end="url(#arrowhead846)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead846" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 0 0 L 0 0 z" style="fill: #333"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-C2 LE-P2" style="opacity: 1;" id="L-C2-P2"> 
      <path class="path" d="M389.7824115753174,259.59092220788796L352.67592970530194,266.3203668952452C315.56944783528644,273.0498115826024,241.35648409525552,286.5087009573168,204.25000222524008,297.4048123113407C167.1435203552246,308.30092366536456,167.1435203552246,316.63425699869794,167.1435203552246,324.96759033203125C167.1435203552246,333.30092366536456,167.1435203552246,341.63425699869794,167.1435203552246,349.96759033203125C167.1435203552246,358.30092366536456,167.1435203552246,366.63425699869794,167.1435203552246,374.96759033203125C167.1435203552246,383.30092366536456,167.1435203552246,391.63425699869794,165.8412171098582,399.96759033203125C164.53891386449183,408.30092366536456,161.93430737375903,416.63425699869794,160.63200412839262,420.80092366536456L159.32970088302622,424.96759033203125" marker-end="url(#arrowhead847)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead847" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 0 0 L 0 0 z" style="fill: #333"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-C3 LE-P2" style="opacity: 1;" id="L-C3-P2"> 
      <path class="path" d="M142.09638599337933,274.96759033203125L138.16134026797113,279.13425699869794C134.22629454256295,283.30092366536456,126.35620309174656,291.63425699869794,122.42115736633836,299.96759033203125C118.48611164093018,308.30092366536456,118.48611164093018,316.63425699869794,118.48611164093018,324.96759033203125C118.48611164093018,333.30092366536456,118.48611164093018,341.63425699869794,118.48611164093018,349.96759033203125C118.48611164093018,358.30092366536456,118.48611164093018,366.63425699869794,118.48611164093018,374.96759033203125C118.48611164093018,383.30092366536456,118.48611164093018,391.63425699869794,121.4082548789637,399.96759033203125C124.33039811699723,408.30092366536456,130.17468459306428,416.63425699869794,133.0968278310978,420.80092366536456L136.01897106913134,424.96759033203125" marker-end="url(#arrowhead848)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead848" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 0 0 L 0 0 z" style="fill: #333"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-C1 LE-P3" style="opacity: 1;" id="L-C1-P3"> 
      <path class="path" d="M296.99320513499816,274.96759033203125L296.8485047560023,279.13425699869794C296.7038043770064,283.30092366536456,296.41440361901465,291.63425699869794,296.2697032400188,299.96759033203125C296.12500286102295,308.30092366536456,296.12500286102295,316.63425699869794,296.12500286102295,324.96759033203125C296.12500286102295,333.30092366536456,296.12500286102295,341.63425699869794,296.12500286102295,349.96759033203125C296.12500286102295,358.30092366536456,296.12500286102295,366.63425699869794,296.12500286102295,374.96759033203125C296.12500286102295,383.30092366536456,296.12500286102295,391.63425699869794,294.38859864426536,399.96759033203125C292.65219442750777,408.30092366536456,289.1793859939926,416.63425699869794,287.442981777235,420.80092366536456L285.7065775604774,424.96759033203125" marker-end="url(#arrowhead849)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead849" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 0 0 L 0 0 z" style="fill: #333"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-C2 LE-P3" style="opacity: 1;" id="L-C2-P3"> 
      <path class="path" d="M389.7824115753174,262.5280931021713L364.95216433207196,268.7680093071479C340.1219170888265,275.0079255121246,290.46142260233563,287.48775792207795,265.63117535909015,297.89434079372126C240.80092811584473,308.30092366536456,240.80092811584473,316.63425699869794,240.80092811584473,324.96759033203125C240.80092811584473,333.30092366536456,240.80092811584473,341.63425699869794,240.80092811584473,349.96759033203125C240.80092811584473,358.30092366536456,240.80092811584473,366.63425699869794,240.80092811584473,374.96759033203125C240.80092811584473,383.30092366536456,240.80092811584473,391.63425699869794,243.8677717328741,399.96759033203125C246.9346153499035,408.30092366536456,253.06830258396232,416.63425699869794,256.1351462009917,420.80092366536456L259.2019898180211,424.96759033203125" marker-end="url(#arrowhead850)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead850" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 0 0 L 0 0 z" style="fill: #333"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-C3 LE-P3" style="opacity: 1;" id="L-C3-P3"> 
      <path class="path" d="M185.52398677883747,274.96759033203125L189.45903250424567,279.13425699869794C193.39407822965384,283.30092366536456,201.26416968047025,291.63425699869794,205.19921540587845,299.96759033203125C209.13426113128662,308.30092366536456,209.13426113128662,316.63425699869794,209.13426113128662,324.96759033203125C209.13426113128662,333.30092366536456,209.13426113128662,341.63425699869794,209.13426113128662,349.96759033203125C209.13426113128662,358.30092366536456,209.13426113128662,366.63425699869794,209.13426113128662,374.96759033203125C209.13426113128662,383.30092366536456,209.13426113128662,391.63425699869794,217.189816792806,401.5718912990944C225.24537245432535,411.5095255994907,241.3564837773641,423.0514608669502,249.41203943888345,428.82242850067996L257.46759510040283,434.59339613440966" marker-end="url(#arrowhead851)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead851" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 0 0 L 0 0 z" style="fill: #333"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-C1 LE-P4" style="opacity: 1;" id="L-C1-P4"> 
      <path class="path" d="M339.7824115753174,265.2062859583186L358.1697573661804,270.9998366872707C376.55710315704346,276.7933874162228,413.33179473876953,288.380488874127,431.71914052963257,298.3407062697458C450.1064863204956,308.30092366536456,450.1064863204956,316.63425699869794,450.1064863204956,324.96759033203125C450.1064863204956,333.30092366536456,450.1064863204956,341.63425699869794,450.1064863204956,349.96759033203125C450.1064863204956,358.30092366536456,450.1064863204956,366.63425699869794,450.1064863204956,374.96759033203125C450.1064863204956,383.30092366536456,450.1064863204956,391.63425699869794,447.18434308246214,399.96759033203125C444.26219984442855,408.30092366536456,438.4179133683615,416.63425699869794,435.495770130328,420.80092366536456L432.57362689229444,424.96759033203125" marker-end="url(#arrowhead852)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead852" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 0 0 L 0 0 z" style="fill: #333"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-C2 LE-P4" style="opacity: 1;" id="L-C2-P4"> 
      <path class="path" d="M430.9746885944708,274.96759033203125L430.82998821547494,279.13425699869794C430.68528783647906,283.30092366536456,430.3958870784873,291.63425699869794,430.2511866994915,299.96759033203125C430.1064863204956,308.30092366536456,430.1064863204956,316.63425699869794,430.1064863204956,324.96759033203125C430.1064863204956,333.30092366536456,430.1064863204956,341.63425699869794,430.1064863204956,349.96759033203125C430.1064863204956,358.30092366536456,430.1064863204956,366.63425699869794,430.1064863204956,374.96759033203125C430.1064863204956,383.30092366536456,430.1064863204956,391.63425699869794,428.9207472992196,399.96759033203125C427.73500827794373,408.30092366536456,425.36353023539186,416.63425699869794,424.17779121411587,420.80092366536456L422.99205219284,424.96759033203125" marker-end="url(#arrowhead853)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead853" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 0 0 L 0 0 z" style="fill: #333"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-C3 LE-P4" style="opacity: 1;" id="L-C3-P4"> 
      <path class="path" d="M205.80092811584473,262.83071808435847L229.74382956822714,269.0201967923039C253.68673102060953,275.2096755002494,301.57253392537433,287.58863291614034,325.5154353777568,297.9447782907525C349.45833683013916,308.30092366536456,349.45833683013916,316.63425699869794,349.45833683013916,324.96759033203125C349.45833683013916,333.30092366536456,349.45833683013916,341.63425699869794,349.45833683013916,349.96759033203125C349.45833683013916,358.30092366536456,349.45833683013916,366.63425699869794,349.45833683013916,374.96759033203125C349.45833683013916,383.30092366536456,349.45833683013916,391.63425699869794,357.5138924916585,401.5718912990944C365.5694481531779,411.5095255994907,381.6805594762166,423.0514608669502,389.736115137736,428.82242850067996L397.79167079925537,434.59339613440966" marker-end="url(#arrowhead854)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead854" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 0 0 L 0 0 z" style="fill: #333"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-C1 LE-P5" style="opacity: 1;" id="L-C1-P5"> 
      <path class="path" d="M339.7824115753174,261.30659344081926L368.77932532628375,267.7500929226879C397.7762390772502,274.19359240455657,455.7700665791829,287.08059136829394,484.76698033014935,297.69075751682925C513.7638940811157,308.30092366536456,513.7638940811157,316.63425699869794,513.7638940811157,324.96759033203125C513.7638940811157,333.30092366536456,513.7638940811157,341.63425699869794,513.7638940811157,349.96759033203125C513.7638940811157,358.30092366536456,513.7638940811157,366.63425699869794,513.7638940811157,374.96759033203125C513.7638940811157,383.30092366536456,513.7638940811157,391.63425699869794,512.8956919727369,399.96759033203125C512.0274898643581,408.30092366536456,510.29108564760054,416.63425699869794,509.4228835392217,420.80092366536456L508.55468143084295,424.96759033203125" marker-end="url(#arrowhead855)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead855" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 0 0 L 0 0 z" style="fill: #333"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-C2 LE-P5" style="opacity: 1;" id="L-C2-P5"> 
      <path class="path" d="M450.13783799337966,274.96759033203125L453.46594604789897,279.13425699869794C456.79405410241833,283.30092366536456,463.45027021145694,291.63425699869794,466.77837826597624,299.96759033203125C470.1064863204956,308.30092366536456,470.1064863204956,316.63425699869794,470.1064863204956,324.96759033203125C470.1064863204956,333.30092366536456,470.1064863204956,341.63425699869794,470.1064863204956,349.96759033203125C470.1064863204956,358.30092366536456,470.1064863204956,366.63425699869794,470.1064863204956,374.96759033203125C470.1064863204956,383.30092366536456,470.1064863204956,391.63425699869794,473.0286295585291,399.96759033203125C475.95077279656266,408.30092366536456,481.7950592726297,416.63425699869794,484.7172025106632,420.80092366536456L487.63934574869677,424.96759033203125" marker-end="url(#arrowhead856)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead856" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 0 0 L 0 0 z" style="fill: #333"></path> 
       </marker> 
      </defs> 
     </g> 
    </g> 
    <g class="edgeLabels"> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-top-C1" class="edgeLabel L-LS-top' L-LE-C1"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-top-C2" class="edgeLabel L-LS-top' L-LE-C2"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-top-C3" class="edgeLabel L-LS-top' L-LE-C3"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-C1-P1" class="edgeLabel L-LS-C1' L-LE-P1"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-C3-P1" class="edgeLabel L-LS-C3' L-LE-P1"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-C1-P2" class="edgeLabel L-LS-C1' L-LE-P2"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-C2-P2" class="edgeLabel L-LS-C2' L-LE-P2"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-C3-P2" class="edgeLabel L-LS-C3' L-LE-P2"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-C1-P3" class="edgeLabel L-LS-C1' L-LE-P3"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-C2-P3" class="edgeLabel L-LS-C2' L-LE-P3"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-C3-P3" class="edgeLabel L-LS-C3' L-LE-P3"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-C1-P4" class="edgeLabel L-LS-C1' L-LE-P4"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-C2-P4" class="edgeLabel L-LS-C2' L-LE-P4"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-C3-P4" class="edgeLabel L-LS-C3' L-LE-P4"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-C1-P5" class="edgeLabel L-LS-C1' L-LE-P5"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-C2-P5" class="edgeLabel L-LS-C2' L-LE-P5"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
    </g> 
    <g class="nodes"> 
     <g class="node default" style="opacity: 1;" id="flowchart-P1-504" transform="translate(64.82870388031006,447.95948791503906)"> 
      <rect rx="0" ry="0" x="-18.657407760620117" y="-22.99189853668213" width="37.314815521240234" height="45.98379707336426" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-8.657407760620117,-12.991898536682129)"> 
        <foreignobject width="17.314815521240234" height="25.983797073364258"> 
         <div style="display: inline-block; white-space: nowrap;">
           P1 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="flowchart-P2-508" transform="translate(152.1435194015503,447.95948791503906)"> 
      <rect rx="0" ry="0" x="-18.657407760620117" y="-22.99189853668213" width="37.314815521240234" height="45.98379707336426" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-8.657407760620117,-12.991898536682129)"> 
        <foreignobject width="17.314815521240234" height="25.983797073364258"> 
         <div style="display: inline-block; white-space: nowrap;">
           P2 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="flowchart-P3-514" transform="translate(276.12500286102295,447.95948791503906)"> 
      <rect rx="0" ry="0" x="-18.657407760620117" y="-22.99189853668213" width="37.314815521240234" height="45.98379707336426" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-8.657407760620117,-12.991898536682129)"> 
        <foreignobject width="17.314815521240234" height="25.983797073364258"> 
         <div style="display: inline-block; white-space: nowrap;">
           P3 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="flowchart-P4-520" transform="translate(416.4490785598755,447.95948791503906)"> 
      <rect rx="0" ry="0" x="-18.657407760620117" y="-22.99189853668213" width="37.314815521240234" height="45.98379707336426" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-8.657407760620117,-12.991898536682129)"> 
        <foreignobject width="17.314815521240234" height="25.983797073364258"> 
         <div style="display: inline-block; white-space: nowrap;">
           P4 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="flowchart-P5-526" transform="translate(503.7638940811157,447.95948791503906)"> 
      <rect rx="0" ry="0" x="-18.657407760620117" y="-22.99189853668213" width="37.314815521240234" height="45.98379707336426" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-8.657407760620117,-12.991898536682129)"> 
        <foreignobject width="17.314815521240234" height="25.983797073364258"> 
         <div style="display: inline-block; white-space: nowrap;">
           P5 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="flowchart-C1-494" transform="translate(297.79166984558105,251.97569274902344)"> 
      <rect rx="0" ry="0" x="-41.99074172973633" y="-22.99189853668213" width="83.98148345947266" height="45.98379707336426" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-31.990741729736328,-12.991898536682129)"> 
        <foreignobject width="63.981483459472656" height="25.983797073364258"> 
         <div style="display: inline-block; white-space: nowrap;">
           学识水平 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="flowchart-C2-495" transform="translate(431.7731533050537,251.97569274902344)"> 
      <rect rx="0" ry="0" x="-41.99074172973633" y="-22.99189853668213" width="83.98148345947266" height="45.98379707336426" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-31.990741729736328,-12.991898536682129)"> 
        <foreignobject width="63.981483459472656" height="25.983797073364258"> 
         <div style="display: inline-block; white-space: nowrap;">
           科研能力 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="flowchart-C3-496" transform="translate(163.8101863861084,251.97569274902344)"> 
      <rect rx="0" ry="0" x="-41.99074172973633" y="-22.99189853668213" width="83.98148345947266" height="45.98379707336426" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-31.990741729736328,-12.991898536682129)"> 
        <foreignobject width="63.981483459472656" height="25.983797073364258"> 
         <div style="display: inline-block; white-space: nowrap;">
           教学工作 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="flowchart-top-493" transform="translate(296.12500286102295,55.99189758300781)"> 
      <rect rx="0" ry="0" x="-41.99074172973633" y="-22.99189853668213" width="83.98148345947266" height="45.98379707336426" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-31.990741729736328,-12.991898536682129)"> 
        <foreignobject width="63.981483459472656" height="25.983797073364258"> 
         <div style="display: inline-block; white-space: nowrap;">
           优秀教师 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
    </g> 
   </g> 
  </g> 
 </svg> 
</div> 
<h4><a id="_2083"></a>建立层次结构模型</h4> 
<p>构造判断矩阵就是通过各要素之间相互两两比较，并确定各准则层对目标层的权重。</p> 
<p>简单地说，就是把准则层的指标进行两两判断，通常我们使用 Santy 的 1-9 标度方法给出。这一标度方法的结论源于心理学对于人评估某一问题程度的行为的研究，参考如下的表格：</p> 
<table><thead><tr><th>因素 i 比因素 j</th><th>量化值</th></tr></thead><tbody><tr><td>同等重要</td><td>1</td></tr><tr><td>稍微重要</td><td>3</td></tr><tr><td>较强重要</td><td>5</td></tr><tr><td>强烈重要</td><td>7</td></tr><tr><td>极端重要</td><td>9</td></tr><tr><td>两相邻判断的中间值</td><td>2，4，6，8</td></tr></tbody></table> 
<p>实际上，层次分析法里面构造矩阵的方式，可以想象为一个二维表。每一行和每一列都代表一个比较的对象；我们拿每一行的对象和每一列相比较，然后参照上面的准则表，相应的数字填到矩阵里面。打个比方说，比如我们这里想要构造教学工作、学识水平和科研能力三个指标的准则矩阵，那么我们可以这样比较：首先我们拿教学工作和学识水平相比较，根据题干条件的意思，教学工作指标与学识水平指标稍微重要，然后我们把“稍微重要”代入到上面的准则表里面，可以查到稍微重要所对应的量化值为 3，我们就把数字 3 填入到矩阵的第一行第二列里面，第一行代表的就是教学工作指标，而第二列就是学识水平指标。那么这个位置就表明“教学工作指标与学识水平指标相比较”。</p> 
<p>层次分析矩阵构造如下：</p> 
<p>首先是准则矩阵：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           C 
          
          
          
            c 
           
          
            r 
           
          
            i 
           
          
            t 
           
          
            e 
           
          
            r 
           
          
            i 
           
          
            a 
           
          
         
         
         
           ( 
          
          
           
            
             
             
               1 
              
             
            
            
             
              
               
               
                 1 
                
               
                 5 
                
               
              
             
            
            
             
              
               
               
                 1 
                
               
                 3 
                
               
              
             
            
           
           
            
             
             
               5 
              
             
            
            
             
             
               1 
              
             
            
            
             
             
               3 
              
             
            
           
           
            
             
             
               3 
              
             
            
            
             
              
               
               
                 1 
                
               
                 3 
                
               
              
             
            
            
             
             
               1 
              
             
            
           
          
         
           ) 
          
         
        
       
         C_{criteria} \begin{pmatrix} 1 &amp; \dfrac{1}{5} &amp; \dfrac{1}{3} \\ 5 &amp; 1 &amp; 3 \\ 3 &amp; \dfrac{1}{3} &amp; 1 \\ \end{pmatrix} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 5.2149em; vertical-align: -2.3574em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">cr</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">er</span><span class="mord mathnormal mtight">ia</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -4.65em;"><span class="pstrut" style="height: 6.8em;"></span><span class="" style="width: 0.875em; height: 4.8em;"> 
              <svg width="0.875em" height="4.800em" viewbox="0 0 875 4800"> 
               <path d="M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1
c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,
-36,557 l0,1284c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,
949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9
c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,
-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189
l0,-1292c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,
-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z"></path> 
              </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.8574em;"><span class="" style="top: -4.8574em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -3.3314em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">5</span></span></span><span class="" style="top: -1.65em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.3574em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.8574em;"><span class="" style="top: -4.8574em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">5</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -3.3314em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -1.65em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">3</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.3574em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.8574em;"><span class="" style="top: -4.8574em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">3</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -3.3314em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">3</span></span></span><span class="" style="top: -1.65em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.3574em;"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -4.65em;"><span class="pstrut" style="height: 6.8em;"></span><span class="" style="width: 0.875em; height: 4.8em;"> 
              <svg width="0.875em" height="4.800em" viewbox="0 0 875 4800"> 
               <path d="M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,
63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5
c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,1209
c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664
c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11
c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17
c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558
l0,-1344c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,
-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z"></path> 
              </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>可以看到，像这样构造出来的矩阵，所有对角线上的元素都是一，这是因为所有对角线上的元素代表的都是每一个准则，自身和自身比较，所以重要性是完全相等的，同时也可以看到对角线两侧的元素互为倒数，这是因为如果一个指标比另一个指标稍微重要，那么另一个指标比这个指标就是“稍微重要”的倒数。</p> 
<p>然后是方案矩阵：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           C 
          
         
           1 
          
         
        
          = 
         
         
         
           ( 
          
          
           
            
             
             
               1 
              
             
            
            
             
             
               2 
              
             
            
            
             
             
               5 
              
             
            
            
             
             
               4 
              
             
            
            
             
             
               7 
              
             
            
           
           
            
             
              
               
               
                 1 
                
               
                 2 
                
               
              
             
            
            
             
             
               1 
              
             
            
            
             
             
               3 
              
             
            
            
             
             
               2 
              
             
            
            
             
             
               5 
              
             
            
           
           
            
             
              
               
               
                 1 
                
               
                 5 
                
               
              
             
            
            
             
              
               
               
                 1 
                
               
                 3 
                
               
              
             
            
            
             
             
               1 
              
             
            
            
             
              
               
               
                 1 
                
               
                 2 
                
               
              
             
            
            
             
             
               2 
              
             
            
           
           
            
             
              
               
               
                 1 
                
               
                 4 
                
               
              
             
            
            
             
              
               
               
                 1 
                
               
                 2 
                
               
              
             
            
            
             
             
               2 
              
             
            
            
             
             
               1 
              
             
            
            
             
             
               3 
              
             
            
           
           
            
             
              
               
               
                 1 
                
               
                 7 
                
               
              
             
            
            
             
              
               
               
                 1 
                
               
                 5 
                
               
              
             
            
            
             
              
               
               
                 1 
                
               
                 2 
                
               
              
             
            
            
             
              
               
               
                 1 
                
               
                 3 
                
               
              
             
            
            
             
             
               1 
              
             
            
           
          
         
           ) 
          
         
        
       
         C_1 = \begin{pmatrix} 1 &amp; 2 &amp; 5 &amp; 4 &amp; 7 \\ \dfrac{1}{2} &amp; 1 &amp; 3 &amp; 2 &amp; 5 \\ \dfrac{1}{5} &amp; \dfrac{1}{3} &amp; 1 &amp; \dfrac{1}{2} &amp; 2 \\ \dfrac{1}{4} &amp; \dfrac{1}{2} &amp; 2 &amp; 1 &amp; 3 \\ \dfrac{1}{7} &amp; \dfrac{1}{5} &amp; \dfrac{1}{2} &amp; \dfrac{1}{3} &amp; 1 \\ \end{pmatrix} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 9.2298em; vertical-align: -4.3649em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.7499em;"><span class="" style="top: -6.7499em;"><span class="pstrut" style="height: 11em;"></span><span class="" style="width: 0.875em; height: 9em;"> 
              <svg width="0.875em" height="9.000em" viewbox="0 0 875 9000"> 
               <path d="M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1
c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,
-36,557 l0,5484c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,
949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9
c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,
-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189
l0,-5492c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,
-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z"></path> 
              </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.2501em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.8649em;"><span class="" style="top: -7.3463em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -5.6649em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -3.6574em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">5</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -1.65em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">4</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: 0.3574em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">7</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.3649em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.8649em;"><span class="" style="top: -7.3463em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -5.6649em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -3.6574em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">3</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -1.65em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: 0.3574em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">5</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.3649em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.8649em;"><span class="" style="top: -7.3463em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">5</span></span></span><span class="" style="top: -5.6649em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">3</span></span></span><span class="" style="top: -3.6574em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -1.65em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: 0.3574em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.3649em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.8649em;"><span class="" style="top: -7.3463em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">4</span></span></span><span class="" style="top: -5.6649em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -3.6574em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -1.65em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: 0.3574em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">3</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.3649em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.8649em;"><span class="" style="top: -7.3463em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">7</span></span></span><span class="" style="top: -5.6649em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">5</span></span></span><span class="" style="top: -3.6574em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -1.65em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">3</span></span></span><span class="" style="top: 0.3574em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.3649em;"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.7499em;"><span class="" style="top: -6.7499em;"><span class="pstrut" style="height: 11em;"></span><span class="" style="width: 0.875em; height: 9em;"> 
              <svg width="0.875em" height="9.000em" viewbox="0 0 875 9000"> 
               <path d="M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,
63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5
c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,5409
c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664
c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11
c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17
c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558
l0,-5544c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,
-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z"></path> 
              </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.2501em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           C 
          
         
           2 
          
         
        
          = 
         
         
         
           ( 
          
          
           
            
             
             
               1 
              
             
            
            
             
              
               
               
                 1 
                
               
                 7 
                
               
              
             
            
            
             
              
               
               
                 2 
                
               
                 3 
                
               
              
             
            
            
             
              
               
               
                 1 
                
               
                 5 
                
               
              
             
            
            
             
              
             
            
           
           
            
             
             
               7 
              
             
            
            
             
             
               1 
              
             
            
            
             
             
               5 
              
             
            
            
             
             
               2 
              
             
            
            
             
              
             
            
           
           
            
             
             
               3 
              
             
            
            
             
              
               
               
                 1 
                
               
                 5 
                
               
              
             
            
            
             
             
               1 
              
             
            
            
             
              
               
               
                 1 
                
               
                 3 
                
               
              
             
            
            
             
              
             
            
           
           
            
             
             
               5 
              
             
            
            
             
              
               
               
                 1 
                
               
                 2 
                
               
              
             
            
            
             
             
               3 
              
             
            
            
             
             
               1 
              
             
            
            
             
              
             
            
           
          
         
           ) 
          
         
        
       
         C_2 = \begin{pmatrix} 1 &amp; \dfrac{1}{7} &amp; \dfrac{2}{3} &amp; \dfrac{1}{5} &amp; \\ 7 &amp; 1 &amp; 5 &amp; 2 &amp; \\ 3 &amp; \dfrac{1}{5} &amp; 1 &amp; \dfrac{1}{3} &amp; \\ 5 &amp; \dfrac{1}{2} &amp; 3 &amp; 1 &amp; \\ \end{pmatrix} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 7.2223em; vertical-align: -3.3612em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.8499em;"><span class="pstrut" style="height: 9.2em;"></span><span class="" style="width: 0.875em; height: 7.2em;"> 
              <svg width="0.875em" height="7.200em" viewbox="0 0 875 7200"> 
               <path d="M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1
c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,
-36,557 l0,3684c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,
949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9
c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,
-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189
l0,-3692c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,
-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z"></path> 
              </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.8612em;"><span class="" style="top: -5.8612em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -4.3352em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">7</span></span></span><span class="" style="top: -2.6537em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">3</span></span></span><span class="" style="top: -0.6463em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.3612em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.8612em;"><span class="" style="top: -5.8612em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">7</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -4.3352em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -2.6537em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">5</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -0.6463em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.3612em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.8612em;"><span class="" style="top: -5.8612em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">3</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -4.3352em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">5</span></span></span><span class="" style="top: -2.6537em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -0.6463em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.3612em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.8612em;"><span class="" style="top: -5.8612em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">5</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -4.3352em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -2.6537em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">3</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -0.6463em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.3612em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.8612em;"><span class="" style="top: -5.8612em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"></span></span><span class="" style="top: -4.3352em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"></span></span><span class="" style="top: -2.6537em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"></span></span><span class="" style="top: -0.6463em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.3612em;"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.8499em;"><span class="pstrut" style="height: 9.2em;"></span><span class="" style="width: 0.875em; height: 7.2em;"> 
              <svg width="0.875em" height="7.200em" viewbox="0 0 875 7200"> 
               <path d="M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,
63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5
c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,3609
c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664
c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11
c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17
c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558
l0,-3744c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,
-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z"></path> 
              </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           C 
          
         
           3 
          
         
        
          = 
         
         
         
           ( 
          
          
           
            
             
             
               1 
              
             
            
            
             
             
               1 
              
             
            
            
             
             
               3 
              
             
            
            
             
             
               3 
              
             
            
            
             
              
             
            
           
           
            
             
             
               1 
              
             
            
            
             
             
               1 
              
             
            
            
             
             
               3 
              
             
            
            
             
             
               3 
              
             
            
            
             
              
             
            
           
           
            
             
              
               
               
                 1 
                
               
                 3 
                
               
              
             
            
            
             
              
               
               
                 1 
                
               
                 3 
                
               
              
             
            
            
             
             
               1 
              
             
            
            
             
             
               1 
              
             
            
            
             
              
             
            
           
           
            
             
              
               
               
                 1 
                
               
                 3 
                
               
              
             
            
            
             
              
               
               
                 1 
                
               
                 3 
                
               
              
             
            
            
             
             
               1 
              
             
            
            
             
             
               1 
              
             
            
            
             
              
             
            
           
          
         
           ) 
          
         
        
       
         C_3 = \begin{pmatrix} 1 &amp; 1 &amp; 3 &amp; 3 &amp; \\ 1 &amp; 1 &amp; 3 &amp; 3 &amp; \\ \dfrac{1}{3} &amp; \dfrac{1}{3} &amp; 1 &amp; 1 &amp; \\ \dfrac{1}{3} &amp; \dfrac{1}{3} &amp; 1 &amp; 1 &amp; \\ \end{pmatrix} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 6.4149em; vertical-align: -2.9574em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.25em;"><span class="" style="top: -5.25em;"><span class="pstrut" style="height: 8em;"></span><span class="" style="width: 0.875em; height: 6em;"> 
              <svg width="0.875em" height="6.000em" viewbox="0 0 875 6000"> 
               <path d="M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1
c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,
-36,557 l0,2484c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,
949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9
c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,
-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189
l0,-2492c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,
-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z"></path> 
              </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.75em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.4574em;"><span class="" style="top: -5.9389em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -4.7389em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -3.0574em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">3</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -1.05em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">3</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.9574em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.4574em;"><span class="" style="top: -5.9389em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -4.7389em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -3.0574em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">3</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -1.05em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">3</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.9574em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.4574em;"><span class="" style="top: -5.9389em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">3</span></span></span><span class="" style="top: -4.7389em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">3</span></span></span><span class="" style="top: -3.0574em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -1.05em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.9574em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.4574em;"><span class="" style="top: -5.9389em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">3</span></span></span><span class="" style="top: -4.7389em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">3</span></span></span><span class="" style="top: -3.0574em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -1.05em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.9574em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.4574em;"><span class="" style="top: -5.9389em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"></span></span><span class="" style="top: -4.7389em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"></span></span><span class="" style="top: -3.0574em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"></span></span><span class="" style="top: -1.05em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.9574em;"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.25em;"><span class="" style="top: -5.25em;"><span class="pstrut" style="height: 8em;"></span><span class="" style="width: 0.875em; height: 6em;"> 
              <svg width="0.875em" height="6.000em" viewbox="0 0 875 6000"> 
               <path d="M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,
63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5
c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,2409
c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664
c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11
c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17
c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558
l0,-2544c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,
-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z"></path> 
              </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.75em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>根据题干条件的要求：教师 P5 是科研人员，只需从学识水平、科研能力两方面衡量其综合素质，教师 P1 是行政人员，只需从学识水平和教学工作两方面衡量。这就导致了我们所书写的矩阵 C2 和 C3 都只有四行四列。</p> 
<h4><a id="_Python__APH__2150"></a>通过 Python 计算 APH 层次分析法</h4> 
<p>我们这里需要整理一下层次分析法的思路：</p> 
<p><strong>首先我们的数学过程是先对三个矩阵进行一致性检验</strong>。在一般情况下，层次分析法中的判别矩阵都是人根据主观判断写的，因此可能会出现逻辑上的错误。比如矩阵中有A、B、C三个元素的比较，可能会因为人的失误造成 “A 比 B 重要，B 比 C 重要，C 比 A 重要” 的错误判别情形。我们可以通过一致性检验来判断是否出现了这样的情况。</p> 
<p><strong>如果矩阵没有通过一致性检验，那么就要重新构造矩阵，并检查在构造矩阵时有没有逻辑错误</strong>；如果矩阵通过了一致性检验，那么我们就可以继续通过算术方法求解层次分析。（实际上这里还有另外一种基于矩阵的特征值和特征向量的方法，但我们这里就采取最简单的算术方法。）</p> 
<p>我们需要计算权重向量。权重计算的方法是：</p> 
<ol><li>对矩阵进行过优化，这要求将矩阵的每一列相加，然后将这一列的所有元素，除以这一列所有元素相加的和。对矩阵的所有列都进行这样的操作，就能将矩阵归一化。</li><li>将归一化之后的矩阵每一行相加，得到一个加和。然后用这个加和去除以矩阵的行数或者列数（因为矩阵是方形的，所以行数就等于列数）。这会产生出一个权重向量。</li><li>将方案矩阵所产生的权重向量中的每一个数字，分别乘以准则矩阵产生的权重向量中的每一个数字。</li></ol> 
<p>注意：这里不是要将两个向量相乘，而是用向量乘以数字。打个比方说，我们这里有 C1、C2、C3 这三个矩阵，我们假设每一个巨人都产生了一个包含五个元素的权重向量；而在准则层有准则矩阵 C，产生了包含三个元素的权重向量。这个时候我们就要拿 C1 权重向量里的每一个数字都乘以 C 产生的权重向量里的第一个元素；C2 权重向量里的每一个数字都乘以 C 产生的权重向量里的第二个元素；C3 权重向量里的每一个数字都乘以 C 产生的权重向量里的第三个元素</p> 
<p>我们把我们刚才写出来的两级矩阵都写入 Python，保存为 <code>numpy.array()</code> 格式。</p> 
<p>首先是准则矩阵：</p> 
<pre><code class="prism language-python">criteria <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>
    <span class="token punctuation">[</span> 
        <span class="token punctuation">[</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">5</span><span class="token punctuation">,</span>   <span class="token number">1</span><span class="token punctuation">,</span>   <span class="token number">3</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span>   <span class="token number">1</span> <span class="token punctuation">]</span> 
        <span class="token punctuation">]</span> 
    <span class="token punctuation">)</span>
</code></pre> 
<p>接下来针对每个教师写出相应的方案矩阵：</p> 
<pre><code class="prism language-python"><span class="token comment"># 第二级矩阵</span>
C1 <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>
    <span class="token punctuation">[</span> 
        <span class="token punctuation">[</span>	   <span class="token number">1</span><span class="token punctuation">,</span> 	   <span class="token number">2</span><span class="token punctuation">,</span> 	   <span class="token number">5</span><span class="token punctuation">,</span> 	   <span class="token number">4</span><span class="token punctuation">,</span> 	<span class="token number">7</span>   <span class="token punctuation">]</span><span class="token punctuation">,</span> 
	    <span class="token punctuation">[</span>	 <span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span>	   <span class="token number">1</span><span class="token punctuation">,</span> 	   <span class="token number">3</span><span class="token punctuation">,</span> 	   <span class="token number">2</span><span class="token punctuation">,</span> 	<span class="token number">5</span>   <span class="token punctuation">]</span><span class="token punctuation">,</span> 
	    <span class="token punctuation">[</span>	 <span class="token number">1</span><span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">,</span>	 <span class="token number">1</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span>	   <span class="token number">1</span><span class="token punctuation">,</span> 	 <span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span>	<span class="token number">2</span>   <span class="token punctuation">]</span><span class="token punctuation">,</span> 
	    <span class="token punctuation">[</span>	 <span class="token number">1</span><span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">,</span>	 <span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span>	   <span class="token number">2</span><span class="token punctuation">,</span> 	   <span class="token number">1</span><span class="token punctuation">,</span> 	<span class="token number">3</span>   <span class="token punctuation">]</span><span class="token punctuation">,</span> 
	    <span class="token punctuation">[</span>	 <span class="token number">1</span><span class="token operator">/</span><span class="token number">7</span><span class="token punctuation">,</span>	 <span class="token number">1</span><span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">,</span>	 <span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span>	 <span class="token number">1</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span>	<span class="token number">1</span>   <span class="token punctuation">]</span><span class="token punctuation">,</span> 
        <span class="token punctuation">]</span>
    <span class="token punctuation">)</span>
C2 <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>
	<span class="token punctuation">[</span> 
		<span class="token punctuation">[</span>	   <span class="token number">1</span><span class="token punctuation">,</span> 	 <span class="token number">1</span><span class="token operator">/</span><span class="token number">7</span><span class="token punctuation">,</span> 	 <span class="token number">2</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span> 	 <span class="token number">1</span><span class="token operator">/</span><span class="token number">5</span> 	<span class="token punctuation">]</span><span class="token punctuation">,</span> 
	    <span class="token punctuation">[</span>	   <span class="token number">7</span><span class="token punctuation">,</span>	   <span class="token number">1</span><span class="token punctuation">,</span> 	   <span class="token number">5</span><span class="token punctuation">,</span> 	   <span class="token number">2</span> 	<span class="token punctuation">]</span><span class="token punctuation">,</span> 
	    <span class="token punctuation">[</span>	   <span class="token number">3</span><span class="token punctuation">,</span>	 <span class="token number">1</span><span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">,</span>	   <span class="token number">1</span><span class="token punctuation">,</span> 	 <span class="token number">1</span><span class="token operator">/</span><span class="token number">3</span>	<span class="token punctuation">]</span><span class="token punctuation">,</span> 
	    <span class="token punctuation">[</span>	   <span class="token number">5</span><span class="token punctuation">,</span>	 <span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span>	   <span class="token number">3</span><span class="token punctuation">,</span> 	   <span class="token number">1</span> 	<span class="token punctuation">]</span><span class="token punctuation">,</span> 
		<span class="token punctuation">]</span> 
	<span class="token punctuation">)</span>
C3 <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>
    <span class="token punctuation">[</span> 
        <span class="token punctuation">[</span>	   <span class="token number">1</span><span class="token punctuation">,</span> 	   <span class="token number">1</span><span class="token punctuation">,</span> 	   <span class="token number">3</span><span class="token punctuation">,</span> 	   <span class="token number">3</span> 	<span class="token punctuation">]</span><span class="token punctuation">,</span> 
	    <span class="token punctuation">[</span>	   <span class="token number">1</span><span class="token punctuation">,</span>	   <span class="token number">1</span><span class="token punctuation">,</span> 	   <span class="token number">3</span><span class="token punctuation">,</span> 	   <span class="token number">3</span> 	<span class="token punctuation">]</span><span class="token punctuation">,</span> 
	    <span class="token punctuation">[</span>	 <span class="token number">1</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span>	 <span class="token number">1</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span>	   <span class="token number">1</span><span class="token punctuation">,</span> 	   <span class="token number">1</span>	<span class="token punctuation">]</span><span class="token punctuation">,</span> 
	    <span class="token punctuation">[</span>	 <span class="token number">1</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span>	 <span class="token number">1</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span>	   <span class="token number">1</span><span class="token punctuation">,</span> 	   <span class="token number">1</span> 	<span class="token punctuation">]</span><span class="token punctuation">,</span> 
        <span class="token punctuation">]</span> 
    <span class="token punctuation">)</span>
</code></pre> 
<p>可以看见这里矩阵 C2 和 C3 都只有四行四列。造成的结果就是我们后续在计算矩阵的权重向量的时候，这两个矩阵的权重向量会只有四个元素。我在这里的解决办法是给这两个矩阵的权重向量添加一个元素 0。我觉得这样既能够避免在进行矩阵归一化的时候出现除以零的操作，也保证了权重计算不会受到影响。（可能还有更好的解决方案，但我没想到。）</p> 
<h4><a id="_2215"></a>层次分析法的代码实现</h4> 
<h5><a id="_2217"></a>一致性检验的基本步骤</h5> 
<ol><li> <p>计算特征向量（Eigenvector）：使用判断矩阵计算特征向量，表示每个因素相对于其他因素的重要性。这可以通过计算判断矩阵的最大特征值和对应的特征向量来实现。</p> </li><li> <p>计算一致性指标（Consistency Index）：根据特征向量计算一致性指标以评估决策者所提供的数据是否具有一致性。一致性指标通过以下公式计算：</p> </li></ol> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          C 
         
        
          I 
         
        
          = 
         
         
          
           
           
             λ 
            
            
            
              m 
             
            
              a 
             
            
              x 
             
            
           
          
            − 
           
          
            n 
           
          
          
          
            n 
           
          
            − 
           
          
            1 
           
          
         
        
       
         CI = \frac{<!-- -->{\lambda_{max} - n}}{<!-- -->{n - 1}} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mord mathnormal" style="margin-right: 0.0785em;">I</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.1408em; vertical-align: -0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3714em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">1</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7693em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<p>其中，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          λ 
         
         
         
           m 
          
         
           a 
          
         
           x 
          
         
        
       
      
        \lambda_{max} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 是判断矩阵的最大特征值，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         n 
        
       
      
        n 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span> 是判断矩阵的维度（即因素的数量）。</p> 
<ol start="3"><li> <p>计算随机一致性指标（Random Index）：为了将一致性指标与随机一致性进行比较，需要使用随机一致性指标。随机一致性指标是根据判断矩阵的维度计算得出的。</p> </li><li> <p>计算一致性比率（Consistency Ratio）：通过将一致性指标除以随机一致性指标，可以计算出一致性比率，用于评估判断矩阵的一致性。一致性比率的计算公式如下：</p> </li></ol> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          C 
         
        
          R 
         
        
          = 
         
         
          
          
            C 
           
          
            I 
           
          
          
          
            R 
           
          
            I 
           
          
         
        
       
         CR = \frac{<!-- -->{CI}}{<!-- -->{RI}} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0077em;">CR</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.0463em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3603em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="mord mathnormal" style="margin-right: 0.0785em;">I</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mord mathnormal" style="margin-right: 0.0785em;">I</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<p>其中，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         R 
        
       
         I 
        
       
      
        RI 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="mord mathnormal" style="margin-right: 0.0785em;">I</span></span></span></span></span> 是对应于判断矩阵维度的随机一致性指标。不同阶数的矩阵对应的 RI 如下表所示：</p> 
<table><thead><tr><th>阶数 n</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th><th>11</th><th>12</th><th>13</th><th>14</th><th>15</th></tr></thead><tbody><tr><td>RI</td><td>0</td><td>0</td><td>0.58</td><td>0.9</td><td>1.12</td><td>1.24</td><td>1.32</td><td>1.41</td><td>1.45</td><td>1.49</td><td>1.52</td><td>1.54</td><td>1.56</td><td>1.58</td><td>1.59</td></tr></tbody></table> 
<ol start="5"><li>判断一致性：根据给定的判断矩阵和计算得到的一致性比率，可以参考以下常用的判断标准来评估一致性：</li></ol> 
<ul><li>如果 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          C 
         
        
          R 
         
        
          &lt; 
         
        
          0.1 
         
        
       
         CR &lt; 0.1 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7224em; vertical-align: -0.0391em;"></span><span class="mord mathnormal" style="margin-right: 0.0077em;">CR</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0.1</span></span></span></span></span>，则认为判断矩阵具有可接受的一致性；</li><li>如果 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          0.1 
         
        
          ≤ 
         
        
          C 
         
        
          R 
         
        
          &lt; 
         
        
          0.2 
         
        
       
         0.1 \leq CR &lt; 0.2 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7804em; vertical-align: -0.136em;"></span><span class="mord">0.1</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7224em; vertical-align: -0.0391em;"></span><span class="mord mathnormal" style="margin-right: 0.0077em;">CR</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0.2</span></span></span></span></span>，则认为判断矩阵具有可接受的但不太理想的一致性；</li><li>如果 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          C 
         
        
          R 
         
        
          ≥ 
         
        
          0.2 
         
        
       
         CR \geq 0.2 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8193em; vertical-align: -0.136em;"></span><span class="mord mathnormal" style="margin-right: 0.0077em;">CR</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0.2</span></span></span></span></span>，则认为判断矩阵具有不可接受的一致性。</li></ul> 
<p>如果判断矩阵不满足一致性标准，可能需要重新审查和调整判断矩阵，以提高一致性。</p> 
<p>这里代码参考了这篇文章：<a href="https://blog.csdn.net/qq_25990967/article/details/122820595">层次分析法之python</a>，我们定义一个函数用于对各个矩阵进行一致性检验。</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">consistence_test</span><span class="token punctuation">(</span> M<span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token string">""</span> <span class="token punctuation">)</span><span class="token punctuation">:</span>
    RI<span class="token operator">=</span><span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span>    <span class="token number">0</span><span class="token punctuation">,</span>    <span class="token number">0.58</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">,</span>  <span class="token number">1.12</span><span class="token punctuation">,</span> 
         <span class="token number">1.24</span><span class="token punctuation">,</span> <span class="token number">1.32</span><span class="token punctuation">,</span> <span class="token number">1.41</span><span class="token punctuation">,</span> <span class="token number">1.45</span><span class="token punctuation">,</span> <span class="token number">1.49</span><span class="token punctuation">,</span> 
         <span class="token number">1.52</span><span class="token punctuation">,</span> <span class="token number">1.54</span><span class="token punctuation">,</span> <span class="token number">1.56</span><span class="token punctuation">,</span> <span class="token number">1.58</span><span class="token punctuation">,</span> <span class="token number">1.59</span> <span class="token punctuation">]</span>
    <span class="token punctuation">[</span>n<span class="token punctuation">,</span> n<span class="token punctuation">]</span> <span class="token operator">=</span> M<span class="token punctuation">.</span>shape <span class="token comment"># 判别矩阵为方阵，只用 n 接收参数即可</span>
    V<span class="token punctuation">,</span> D <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>eig<span class="token punctuation">(</span>M<span class="token punctuation">)</span>
    max_eig_value <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>V<span class="token punctuation">)</span>
    CI <span class="token operator">=</span> <span class="token punctuation">(</span> max_eig_value <span class="token operator">-</span> n <span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span> n<span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span>
    CR <span class="token operator">=</span> CI <span class="token operator">/</span> RI<span class="token punctuation">[</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> CR <span class="token operator">&gt;=</span> <span class="token number">0.1</span><span class="token punctuation">:</span> <span class="token comment">#判断是否通过一致性检验</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span> name<span class="token punctuation">,</span> <span class="token string">'没有通过一致性检验'</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span> name<span class="token punctuation">,</span> <span class="token string">'成功通过一致性检验'</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>对每一个判别矩阵的一致性检验结果如下。</strong> 可以看到，我们构建的矩阵都通过了检验。实际上这些矩阵都是提干条件给出的，出于题目合理性的考量，理论上都能够通过检验。</p> 
<p>假如在这里出现了矩阵没有通过一致性检验的情况，我们就需要重新构建判别矩阵</p> 
<pre><code class="prism language-python">consistence_test<span class="token punctuation">(</span> criteria<span class="token punctuation">,</span> <span class="token string">"准则矩阵"</span> <span class="token punctuation">)</span>
consistence_test<span class="token punctuation">(</span> C1<span class="token punctuation">,</span> <span class="token string">"C1"</span> <span class="token punctuation">)</span>
consistence_test<span class="token punctuation">(</span> C2<span class="token punctuation">,</span> <span class="token string">"C2"</span> <span class="token punctuation">)</span>
consistence_test<span class="token punctuation">(</span> C3<span class="token punctuation">,</span> <span class="token string">"C3"</span> <span class="token punctuation">)</span>
</code></pre> 
<pre><code>准则矩阵 成功通过一致性检验
C1 成功通过一致性检验
C2 成功通过一致性检验
C3 成功通过一致性检验
</code></pre> 
<p>由于三个矩阵都通过了一致性检验，我们这里就可以进行层次分析法的操作。我们定义一个函数来计算矩阵的权重向量，这里参考了博文 <a href="https://blog.csdn.net/ddjhpxs/article/details/105407103">数学建模–层次分析法（代码Python实现）</a></p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">aph_matix_weight</span><span class="token punctuation">(</span> M<span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token string">""</span> <span class="token punctuation">)</span><span class="token punctuation">:</span> 
    <span class="token comment"># 将判断矩阵按照列归一化（每个元素除以其所在列的和）</span>
    sum_M <span class="token operator">=</span> M<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment">#计算X每列的和</span>
    <span class="token punctuation">(</span> n<span class="token punctuation">,</span> n <span class="token punctuation">)</span> <span class="token operator">=</span> M<span class="token punctuation">.</span>shape  <span class="token comment">#X为方阵，行和列相同，所以用一个 n 来接收</span>
    sum_M <span class="token operator">=</span> np<span class="token punctuation">.</span>tile<span class="token punctuation">(</span> sum_M<span class="token punctuation">,</span> <span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>  <span class="token comment">#将和向量重复 n 行组成新的矩阵</span>
    stand_M <span class="token operator">=</span> M<span class="token operator">/</span>sum_M  <span class="token comment">#标准化 X（ X 中每个元素除以其所在列的和）</span>
    
    <span class="token comment"># 将归一化矩阵每一行求和</span>
    sum_row <span class="token operator">=</span> stand_M<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span> axis <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">)</span>

    <span class="token comment"># 将相加后得到的向量中每个元素除以n即可得到权重向量</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span> name<span class="token punctuation">,</span> <span class="token string">"权重："</span><span class="token punctuation">,</span> sum_row <span class="token operator">/</span> n <span class="token punctuation">)</span>
    <span class="token keyword">return</span> sum_row <span class="token operator">/</span> n
</code></pre> 
<p>权重向量的计算结果如下：</p> 
<pre><code class="prism language-python">criteria_weights <span class="token operator">=</span> aph_matix_weight<span class="token punctuation">(</span> criteria<span class="token punctuation">,</span> <span class="token string">"准则矩阵"</span> <span class="token punctuation">)</span>
C1_weights <span class="token operator">=</span> aph_matix_weight<span class="token punctuation">(</span> C1<span class="token punctuation">,</span> <span class="token string">"C1"</span> <span class="token punctuation">)</span>
C2_weights <span class="token operator">=</span> aph_matix_weight<span class="token punctuation">(</span> C2<span class="token punctuation">,</span> <span class="token string">"C2"</span> <span class="token punctuation">)</span>
C3_weights <span class="token operator">=</span> aph_matix_weight<span class="token punctuation">(</span> C3<span class="token punctuation">,</span> <span class="token string">"C3"</span> <span class="token punctuation">)</span>
</code></pre> 
<pre><code>准则矩阵 权重： [0.10615632 0.63334572 0.26049796]
C1 权重： [0.46159865 0.25616165 0.08802104 0.14233203 0.05188663]
C2 权重： [0.06639717 0.51585369 0.12345376 0.29429538]
C3 权重： [0.375 0.375 0.125 0.125]
</code></pre> 
<p>矩阵 C1 和 C3 都只有四行四列。我们在这里手动为权重向量添加 0 元素：</p> 
<pre><code class="prism language-python">C2_weights <span class="token operator">=</span> np<span class="token punctuation">.</span>insert<span class="token punctuation">(</span>C2_weights<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
C3_weights <span class="token operator">=</span> np<span class="token punctuation">.</span>append<span class="token punctuation">(</span>C3_weights<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span> C2_weights<span class="token punctuation">,</span> C3_weights <span class="token punctuation">)</span>
</code></pre> 
<pre><code>[0.         0.06639717 0.51585369 0.12345376 0.29429538] [0.375 0.375 0.125 0.125 0.   ]
</code></pre> 
<p>将方案矩阵所产生的权重向量中的每一个数字，分别乘以准则矩阵产生的权重向量中的每一个数字（具体过程在上面说过）</p> 
<pre><code class="prism language-python">C1_score <span class="token operator">=</span> C1_weights <span class="token operator">*</span> criteria_weights<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
C2_score <span class="token operator">=</span> C2_weights <span class="token operator">*</span> criteria_weights<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
C3_score <span class="token operator">=</span> C3_weights <span class="token operator">*</span> criteria_weights<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>C1_score<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>C2_score<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>C3_score<span class="token punctuation">)</span>
</code></pre> 
<pre><code>[0.04900162 0.02719318 0.00934399 0.01510945 0.00550809]
[0.         0.04205236 0.32671373 0.07818891 0.18639072]
[0.09768673 0.09768673 0.03256224 0.03256224 0.        ]
</code></pre> 
<p>最后把这些数值加起来，就是各个教师的最终评分。</p> 
<pre><code class="prism language-python">P1_score <span class="token operator">=</span> C1_score<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> C2_score<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> C3_score<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
P2_score <span class="token operator">=</span> C1_score<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> C2_score<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> C3_score<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
P3_score <span class="token operator">=</span> C1_score<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> C2_score<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> C3_score<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
P4_score <span class="token operator">=</span> C1_score<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> C2_score<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> C3_score<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
P5_score <span class="token operator">=</span> C1_score<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> C2_score<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> C3_score<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>
</code></pre> 
<p>输出层次分析结果：</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"P1 权重打分"</span><span class="token punctuation">,</span> P1_score<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"P2 权重打分"</span><span class="token punctuation">,</span> P2_score<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"P3 权重打分"</span><span class="token punctuation">,</span> P3_score<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"P4 权重打分"</span><span class="token punctuation">,</span> P4_score<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"P5 权重打分"</span><span class="token punctuation">,</span> P5_score<span class="token punctuation">)</span>
</code></pre> 
<pre><code>P1 权重打分 0.14668834948594095
P2 权重打分 0.16693227402847738
P3 权重打分 0.36861996335974256
P4 权重打分 0.12586059859545307
P5 权重打分 0.19189881453038599
</code></pre> 
<p>根据层次分析法的最终结果判断，教师 P3 为优秀教师</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/88c45024691bee4925059cabd78fb0a7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Java】Java 11 新特性概览</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/da39832653c51b65aee591792f8a0928/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C#使用Asp.Net创建Web Service接口并调用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>