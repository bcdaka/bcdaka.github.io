<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>@google/model-viewer 导入 改纹理 （http-serve） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/d341fb26febe3d8cf3ad038ef092169c/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="@google/model-viewer 导入 改纹理 （http-serve）">
  <meta property="og:description" content="导入模型 改纹理
效果图
&lt;template&gt; &lt;div&gt; &lt;h1&gt;鞋模型&lt;/h1&gt; &lt;model-viewer style=&#34;width: 300px; height: 300px&#34; id=&#34;my-replace-people&#34; src=&#34;/imgApi/Astronaut.glb&#34; auto-rotate camera-controls &gt; &lt;/model-viewer&gt; &lt;h1&gt;图片贴到模型上&lt;/h1&gt; &lt;div class=&#34;example-wrapper&#34;&gt; &lt;model-viewer id=&#34;my-replace-shop&#34; src=&#34;/imgApi/scene.gltf&#34; auto-rotate camera-controls &gt; &lt;div class=&#34;controls&#34; id=&#34;color-controls&#34;&gt; &lt;button data-color=&#34;#ff0000&#34;&gt;Red&lt;/button&gt; &lt;button data-color=&#34;#00ff00&#34;&gt;Green&lt;/button&gt; &lt;button data-color=&#34;#0000ff&#34;&gt;Blue&lt;/button&gt; &lt;button data-color=&#34;#ffffff&#34;&gt;White&lt;/button&gt; &lt;/div&gt; &lt;div id=&#34;progress-bar&#34;&gt;&lt;/div&gt; &lt;!-- &lt;template #progress-bar&gt;&lt;/template&gt; --&gt; &lt;/model-viewer&gt; &lt;/div&gt; &lt;h1&gt;原模型&lt;/h1&gt; &lt;!-- src=&#34;/imgApittps://res.theuniquer.com/pgc-models/picture.gltf&#34; --&gt; &lt;model-viewer src=&#34;/imgApi/pgc-models_picture.gltf&#34; auto-rotate camera-controls &gt; &lt;/model-viewer&gt; &lt;h1&gt;原图片&lt;/h1&gt; &lt;img style=&#34;width: 100%; height: 100px; object-fit: contain&#34; src=&#34;/imgApi/tietu.jpg&#34; alt=&#34;&#34; /&gt; &lt;h1&gt;图片贴到模型上&lt;/h1&gt; &lt;div class=&#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-14T22:48:54+08:00">
    <meta property="article:modified_time" content="2024-07-14T22:48:54+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">@google/model-viewer 导入 改纹理 （http-serve）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p></p> 
<p>导入模型 改纹理</p> 
<p><img alt="" height="381" src="https://images2.imgbox.com/9a/1c/c6lf8SYR_o.png" width="495"></p> 
<p><img alt="" height="427" src="https://images2.imgbox.com/3a/d6/UUXUKkma_o.png" width="858"></p> 
<p></p> 
<p> 效果图</p> 
<p><img alt="" height="635" src="https://images2.imgbox.com/02/80/49Zodsaz_o.png" width="794"></p> 
<pre><code class="language-javascript">&lt;template&gt;
  &lt;div&gt;
    &lt;h1&gt;鞋模型&lt;/h1&gt;
    &lt;model-viewer
      style="width: 300px; height: 300px"
      id="my-replace-people"
      src="/imgApi/Astronaut.glb"
      auto-rotate
      camera-controls
    &gt;
    &lt;/model-viewer&gt;
    &lt;h1&gt;图片贴到模型上&lt;/h1&gt;
    &lt;div class="example-wrapper"&gt;
      &lt;model-viewer
        id="my-replace-shop"
        src="/imgApi/scene.gltf"
        auto-rotate
        camera-controls
      &gt;
        &lt;div class="controls" id="color-controls"&gt;
          &lt;button data-color="#ff0000"&gt;Red&lt;/button&gt;
          &lt;button data-color="#00ff00"&gt;Green&lt;/button&gt;
          &lt;button data-color="#0000ff"&gt;Blue&lt;/button&gt;
          &lt;button data-color="#ffffff"&gt;White&lt;/button&gt;
        &lt;/div&gt;
        &lt;div id="progress-bar"&gt;&lt;/div&gt;
        &lt;!-- &lt;template #progress-bar&gt;&lt;/template&gt; --&gt;
      &lt;/model-viewer&gt;
    &lt;/div&gt;
    &lt;h1&gt;原模型&lt;/h1&gt;
    &lt;!-- src="/imgApittps://res.theuniquer.com/pgc-models/picture.gltf" --&gt;
    &lt;model-viewer
      src="/imgApi/pgc-models_picture.gltf"
      auto-rotate
      camera-controls
    &gt;
    &lt;/model-viewer&gt;
    &lt;h1&gt;原图片&lt;/h1&gt;
    &lt;img
      style="width: 100%; height: 100px; object-fit: contain"
      src="/imgApi/tietu.jpg"
      alt=""
    /&gt;
    &lt;h1&gt;图片贴到模型上&lt;/h1&gt;
    &lt;div class="example-wrapper"&gt;
      &lt;model-viewer
        id="my-replace-texture"
        src="/imgApi/pgc-models_picture.gltf"
        auto-rotate
        camera-controls
      &gt;
      &lt;/model-viewer&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref, onMounted } from "vue";
import * as THREE from "three";
import { OrbitControls } from "three/examples/jsm/controls/OrbitControls.js";
import { GLTFLoader } from "three/examples/jsm/loaders/GLTFLoader";
import Hammer from "hammerjs";
import { useEventListener } from "@vueuse/core";
import "@google/model-viewer";

const modelContainer = new THREE.Object3D();
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(
  75,
  window.innerWidth / window.innerHeight,
  0.1,
  1000
);
// 在创建渲染器时，添加antiallias:true抗锯齿，让模型看起来更加平滑
const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
// 设置画布分辨率 提高画质
renderer.setPixelRatio(window.devicePixelRatio);
const loader = new GLTFLoader();
let model = null;

// 光源设置
// const ambientLight = new THREE.AmbientLight(0xffffff, 0.5); // 环境光
// scene.add(ambientLight);

// const pointLight = new THREE.PointLight(0xffffff, 1); // 点光源
// pointLight.position.set(10, 10, 10);
// scene.add(pointLight);

// 环境光 (这是一定要的)
const ambientLight = new THREE.AmbientLight(0xffffff, 2);
// scene.add(ambientLight);

// 白色平行光(模型更明亮)
const directionalLight = new THREE.DirectionalLight(0xffffff, 2); // 参数自行调整
directionalLight.position.x = 1;
directionalLight.position.y = 1;
directionalLight.position.z = 80;
directionalLight.target = modelContainer; // target指向模型
scene.add(directionalLight);

// *创建点光源(这个看情况给)
var pointLight = new THREE.PointLight(0xffffff, 500); // 设置点光源的颜色和强度
pointLight.position.set(0, 0, 100); // 设置点光源的位置
scene.add(pointLight);

// 设置阴影
renderer.shadowMap.enabled = true;
renderer.shadowMap.type = THREE.PCFSoftShadowMap;

// 初始化 Three.js 相关设置
camera.position.z = 5;
renderer.setSize(window.innerWidth, window.innerHeight);

function initControls() {
  const controls = new OrbitControls(camera, renderer.domElement);
  // 如果使用animate方法时，将此函数删除
  //controls.addEventListener( 'change', render );
  // 使动画循环使用时阻尼或自转 意思是否有惯性
  controls.enableDamping = true;
  //动态阻尼系数 就是鼠标拖拽旋转灵敏度
  //controls.dampingFactor = 0.25;
  //是否可以缩放
  controls.enableZoom = true;
  //是否自动旋转
  // controls.autoRotate = true;
  controls.autoRotateSpeed = 0.5;
  //设置相机距离原点的最远距离
  // controls.minDistance  = 1;
  //设置相机距离原点的最远距离
  controls.maxDistance = 2000;
  //是否开启右键拖拽
  controls.enablePan = true;
}

// 加载模型
loader.load("/imgApi/Astronaut.glb", (gltf) =&gt; {
  model = gltf.scene;
  model.castShadow = true; // 模型投射阴影
  scene.add(model);
});

// 设置容器
const container = ref(null);

onMounted(() =&gt; {
  const fn = async (modelViewer) =&gt; {
    const targetMaterial = modelViewer.model.materials.find(
      (material) =&gt; material.name == "Center"
    ); //找到材质

    console.log("targetMaterial=");
    console.log(modelViewer.model);
    console.log(modelViewer.model.materials);
    console.log(targetMaterial);
    const targetTexture = await modelViewer.createTexture(
      "/imgApi/red-huawen.jpg"
    ); // 用图片创建纹理
    targetMaterial.pbrMetallicRoughness.baseColorTexture.setTexture(
      targetTexture
    );
  };
  const modelViewer = document.querySelector(
    "model-viewer#my-replace-texture"
    // "model-viewer#my-replace-shop"
  );
  modelViewer.addEventListener("load", () =&gt; {
    fn(modelViewer);
  });

  const modelViewerColor = document.querySelector(
    "model-viewer#my-replace-shop"
  );
  const loadingText = document.getElementById("progress-bar");
  const modelViewerPle = document.querySelector("#my-replace-people");
  modelViewerPle.addEventListener("progress", (event) =&gt; {
    const loaded = event.detail.totalProgress;
    console.log("loading--&gt;");
    console.log(`${(loaded * 100).toFixed(0)}%`);
    if (loadingText) loadingText.innerHTML = `${(loaded * 100).toFixed(0)}%`;
    // loadingText.textContent = `${(loaded * 100).toFixed(0)}%`;
  });
  modelViewerPle.addEventListener("load", async () =&gt; {
    const targetMaterial = modelViewerPle.model.materials.find(
      (material) =&gt; material.name == "Center"
    ); //找到材质
    console.log("modelViewerPle-----&gt;");
    console.log(modelViewerPle);
    console.log(modelViewerPle.model);
    console.log(modelViewerPle.model.materials);
    setTimeout(() =&gt; {
      loadingText.style.display = "none";
    }, 100);
    const targetTexture = await modelViewer.createTexture(
      "/imgApi/red-huawen.jpg"
    ); // 用图片创建纹理
    const [material] = modelViewerPle.model.materials;
    material.pbrMetallicRoughness.baseColorTexture.setTexture(targetTexture);
  });

  modelViewerColor.addEventListener("load", async () =&gt; {
    const targetMaterial = modelViewerColor.model.materials.find(
      (material) =&gt; material.name == "Center"
    ); //找到材质
    console.log("modelViewerColor-----&gt;");
    console.log(modelViewerColor);
    console.log(modelViewerColor.model);
    console.log(modelViewerColor.model.materials);
    const targetTexture = await modelViewer.createTexture(
      "/imgApi/red-huawen.jpg"
    ); // 用图片创建纹理
    const [material] = modelViewerColor.model.materials;
    material.pbrMetallicRoughness.baseColorTexture.setTexture(targetTexture);
  });

  // const targetMateriaShop = modelViewerColor.model.materials.find(
  //     (material) =&gt; material.name == "Center"
  //   ); //找到材质

  document
    .querySelector("#color-controls")
    .addEventListener("click", (event) =&gt; {
      const colorString = event.target.dataset.color;
      const [material] = modelViewerColor.model.materials;
      material.pbrMetallicRoughness.setBaseColorFactor(colorString);
    });
});
&lt;/script&gt;

&lt;style scoped&gt;
.example-wrapper model-viewer {
  width: 50vw;
  height: 50vh;
  margin: 20vh auto 0;
  background-color: #fff;
}
&lt;/style&gt;
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dece040b5ee3fc820b11609c59460fee/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">spdlog一个非常好用的C&#43;&#43;日志库(八): 自定义格式化符号</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c51bcfde826a852cc40e4965246dac98/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">[UTCTF2020]babymips</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>