<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>AI编程新手快速体验SpringCloud Alibaba 集成AI功能 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/d3c7ef7c46f5f79676f81b7e428b98fb/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="AI编程新手快速体验SpringCloud Alibaba 集成AI功能">
  <meta property="og:description" content="上周六写了一篇文章 震撼发布！Spring AI 框架重磅上线，Java 集成 AI 轻松搞定！ 部分同学可能没有科学上网的条件，本地ollama 集成又比较笨重。趁着周六，写一篇基于SpringCloud Alibaba 集成AI的文章。
先简单介绍下 Spring Cloud Alibaba AI。
Spring Cloud Alibaba AI 基于 Spring AI 0.8.1 版本完成通义系列大模型的接入。DashScope灵积模型服务建立在 模型即服务（Model-as-a-Service，MaaS）的理念基础之上，围绕AI各领域模型，通过标准化的API提供包括模型推理、模型微调训练在内的多种模型服务。目前支持的模型主要有：对话、文生图、文生语音，更多功能特性正在适配中。
实践前， Spring AI 0.8.1 最低需要JDK17版本， 公司项目还是JDK8， 先去下载JDK17。下载地址：
https://www.oracle.com/java/technologies/javase/jdk17-archive-downloads.html
springcloud、springboot对应小常识 2023.x 分支对应的是 Spring Cloud 2023 与 Spring Boot 3.2.x，最低支持 JDK 17。 2022.x 分支对应的是 Spring Cloud 2022 与 Spring Boot 3.0.x，最低支持 JDK 17。 2021.x 分支对应的是 Spring Cloud 2021 与 Spring Boot 2.6.x，最低支持 JDK 1.8。 2020.0 分支对应的是 Spring Cloud 2020 与 Spring Boot 2.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-01T11:27:00+08:00">
    <meta property="article:modified_time" content="2024-06-01T11:27:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">AI编程新手快速体验SpringCloud Alibaba 集成AI功能</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>上周六写了一篇文章  <a href="http://mp.weixin.qq.com/s?__biz=MzI5NDAzNzExNw==&amp;mid=2247484753&amp;idx=1&amp;sn=e4cd39df65af66b4a25eed9d4bc6e4a2&amp;chksm=ec69b643db1e3f559c187e7b20319db83c7576b99fac08c1ecc5b1f41c4ec1df0a4d43bc7ebf&amp;scene=21#wechat_redirect" rel="nofollow" title="震撼发布！Spring AI 框架重磅上线，Java 集成 AI 轻松搞定！">震撼发布！Spring AI 框架重磅上线，Java 集成 AI 轻松搞定！</a>    部分同学可能没有科学上网的条件，本地ollama 集成又比较笨重。趁着周六，写一篇基于SpringCloud Alibaba 集成AI的文章。</p> 
<p>先简单介绍下 Spring Cloud Alibaba AI。</p> 
<p>Spring Cloud Alibaba AI 基于 Spring AI 0.8.1 版本完成通义系列大模型的接入。DashScope灵积模型服务建立在 模型即服务（Model-as-a-Service，MaaS）的理念基础之上，围绕AI各领域模型，通过标准化的API提供包括模型推理、模型微调训练在内的多种模型服务。目前支持的模型主要有：对话、文生图、文生语音，更多功能特性正在适配中。</p> 
<p>实践前， Spring AI 0.8.1  最低需要JDK17版本，  公司项目还是JDK8， 先去下载JDK17。下载地址：</p> 
<p> https://www.oracle.com/java/technologies/javase/jdk17-archive-downloads.html</p> 
<pre><code>springcloud、springboot对应小常识
2023.x 分支对应的是 Spring Cloud 2023 与 Spring Boot 3.2.x，最低支持 JDK 17。
2022.x 分支对应的是 Spring Cloud 2022 与 Spring Boot 3.0.x，最低支持 JDK 17。
2021.x 分支对应的是 Spring Cloud 2021 与 Spring Boot 2.6.x，最低支持 JDK 1.8。
2020.0 分支对应的是 Spring Cloud 2020 与 Spring Boot 2.4.x，最低支持 JDK 1.8。
2.2.x 分支对应的是 Spring Cloud Hoxton 与 Spring Boot 2.2.x，最低支持 JDK 1.8。
greenwich 分支对应的是 Spring Cloud Greenwich 与 Spring Boot 2.1.x，最低支持 JDK 1.8。
finchley 分支对应的是 Spring Cloud Finchley 与 Spring Boot 2.0.x，最低支持 JDK 1.8。
1.x 分支对应的是 Spring Cloud Edgware 与 Spring Boot 1.x，最低支持 JDK 1.7。</code></pre> 
<p><br><br> 如果你不想放弃JDK8，可以直接使用dashscope-sdk-java。 看个人选择了</p> 
<p> https://help.aliyun.com/zh/dashscope/developer-reference/install-dashscope-sdk?spm=a2c4g.11186623.0.i7#c2bdbca0cfc8y</p> 
<p>这里SpringCloud Alibaba AI快速学习, 直接去github下载 官方示例：</p> 
<p> https://github.com/alibaba/spring-cloud-alibaba/tree/2023.x/spring-cloud-alibaba-examples/ai-example/spring-cloud-ai-example</p> 
<p>先去阿里云官网https://help.aliyun.com/zh/dashscope/developer-reference/activate-dashscope-and-create-an-api-keyapi-key, 就能快速体验基本的 对话、画图、语音功能了。 新开通有1个月的免费额度，真香。</p> 
<p>具体实操步骤，我直接复制官方的操作说明</p> 
<pre><code>接入 spring-cloud-starter-alibaba-ai
在项目 pom.xml 中加入以下依赖：


&lt;dependency&gt;
    &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-alibaba-ai&lt;/artifactId&gt;
&lt;/dependency&gt;
在 application.yml 配置文件中加入以下配置：


Note: 推荐使用环境变量的方式设置 api-key，避免 api-key 泄露。


export SPRING_CLOUD_AI_TONGYI_API_KEY=sk-a3d73b1709bf4a178c28ed7c8b3b5a45
spring:
  cloud:
    ai:
      tongyi:
        # apiKey is invalid.
        api-key: sk-a3d73b1709bf4a178c28ed7c8b3b5a45
添加如下代码：


controller:


@Autowired
@Qualifier("tongYiSimpleServiceImpl")
private TongYiService tongYiSimpleService;


@GetMapping("/example")
public String completion(
    @RequestParam(value = "message", defaultValue = "Tell me a joke")
    String message
) {


    return tongYiSimpleService.completion(message);
}


service:


private final ChatClient chatClient;


@Autowired
public TongYiSimpleServiceImpl(ChatClient chatClient, StreamingChatClient streamingChatClient) {


    this.chatClient = chatClient;
    this.streamingChatClient = streamingChatClient;
}


@Override
public String completion(String message) {


    Prompt prompt = new Prompt(new UserMessage(message));


    return chatClient.call(prompt).getResult().getOutput().getContent();
}
至此，便完成了最简单的模型接入！和本 example 中的代码略有不同，但 example 中的代码无需修改。可完成对应功能。


启动应用


本 Example 项目支持如下两种启动方式：


IDE 直接启动：找到主类 TongYiApplication，执行 main 方法启动应用。
打包编译后启动：首先执行 mvn clean package 将工程编译打包，进入 target 文件夹执行 java -jar spring-cloud-ai-example.jar 启动应用。</code></pre> 
<p>先简单聊个天,    http://localhost:8080/</p> 
<p><img alt="" height="580" src="https://images2.imgbox.com/a4/7d/ykwhzQuX_o.png" width="1080"><br> 再画个图测试，直接浏览器访问 http://localhost:8080/ai/img?prompt="美女"</p> 
<p><img alt="" height="537" src="https://images2.imgbox.com/dc/8c/tNgXAlFS_o.png" width="1080"></p> 
<p><img alt="" height="1077" src="https://images2.imgbox.com/03/f5/3rO56hhZ_o.png" width="1080"></p> 
<p>再来个语音测试，http://localhost:8080/ai/audio?prompt="你好，我是子晓"，出现本地的音频文件路径。播放效果挺不错。</p> 
<p>springCloud Alibaba集成AI功能是不是很简单， 我们可以根据自己的实际需要对接到业务系统中。虽然我之前就知道springCloud Alibaba AI功能， 前不久国内几大大模型厂商价格战，我才试用了下。真香，程序员的福音，比自己折腾部署大模型方便多了。</p> 
<p><a href="http://mp.weixin.qq.com/s?__biz=MzI5NDAzNzExNw==&amp;mid=2247484729&amp;idx=1&amp;sn=80c58f1d929fb719254b49b7c5bae949&amp;chksm=ec69b62bdb1e3f3d5592b757c1c9af277d4a5ea50baca18192f0a25cbb924fc211db173603b0&amp;scene=21#wechat_redirect" rel="nofollow" title="【人工智能】阿里、百度等大模型搞价格战了，开发者爽了，盘点下国内大模型API价格">【人工智能】阿里、百度等大模型搞价格战了，开发者爽了，盘点下国内大模型API价格</a></p> 
<p></p> 
<p>原文链接：<a href="https://mp.weixin.qq.com/s?__biz=MzI5NDAzNzExNw==&amp;mid=2247484826&amp;idx=1&amp;sn=3bc603d7bd645a169cba9c22bc8a3d7d&amp;chksm=ec69b688db1e3f9ea28a4e79c8430f2ef18c05c09e6496dec739ad9765c6057613b38246b91d&amp;token=1059420712&amp;lang=zh_CN#rd" rel="nofollow" title="【JAVA技术】AI编程新手快速体验SpringCloud Alibaba 集成AI功能">【JAVA技术】AI编程新手快速体验SpringCloud Alibaba 集成AI功能</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/72f682c02b845f6ce9797b614b84f4e7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Mac上Steam安装的游戏已经卸载，但游戏的快捷方式图标仍存在的解决方式</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/671dbac30bc1a6c1af58515a7ac0ed6b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C语言：深入了解（联合体和枚举）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>