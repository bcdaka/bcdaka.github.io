<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>[C#]C#中的ComboBox控件 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/1aaa8b774f25df4ca04e1d1f6533e046/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="[C#]C#中的ComboBox控件">
  <meta property="og:description" content="当使用C#中的ComboBox控件时，你可以通过以下详细方法使用它：
在窗体上放置 ComboBox 控件：
在 Visual Studio 的窗体设计器中，从工具箱中拖动并放置一个 ComboBox 控件到你的窗体上。
设置 ComboBox 的属性：
Items：用于设置或获取 ComboBox 中的选项集合。你可以通过添加项到集合中来动态添加选项。Text：用于设置或获取当前选中项的文本。SelectedIndex：用于设置或获取当前选中项的索引。索引从 0 开始，-1 表示没有选中项。DropDownStyle：用于设置下拉列表的样式。常用的值有： DropDown：显示下拉列表，用户可以从中选择。DropDownList：只显示下拉列表，用户无法手动输入。 处理 ComboBox 的事件：
SelectedIndexChanged：当 ComboBox 的选中项发生改变时触发的事件。你可以通过订阅该事件，在选中项改变时执行特定的操作。 下面是一个示例，演示如何使用 ComboBox 控件：
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-08T07:05:02+08:00">
    <meta property="article:modified_time" content="2024-04-08T07:05:02+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">[C#]C#中的ComboBox控件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>当使用C#中的ComboBox控件时，你可以通过以下详细方法使用它：</strong></p> 
<ul><li> <p>在窗体上放置 <code>ComboBox</code> 控件：<br> 在 Visual Studio 的窗体设计器中，从工具箱中拖动并放置一个 <code>ComboBox</code> 控件到你的窗体上。</p> </li><li> <p>设置 <code>ComboBox</code> 的属性：</p> 
  <ul><li><code>Items</code>：用于设置或获取 <code>ComboBox</code> 中的选项集合。你可以通过添加项到集合中来动态添加选项。</li><li><code>Text</code>：用于设置或获取当前选中项的文本。</li><li><code>SelectedIndex</code>：用于设置或获取当前选中项的索引。索引从 0 开始，-1 表示没有选中项。</li><li><code>DropDownStyle</code>：用于设置下拉列表的样式。常用的值有： 
    <ul><li><code>DropDown</code>：显示下拉列表，用户可以从中选择。</li><li><code>DropDownList</code>：只显示下拉列表，用户无法手动输入。</li></ul></li></ul></li><li> <p>处理 <code>ComboBox</code> 的事件：</p> 
  <ul><li><code>SelectedIndexChanged</code>：当 <code>ComboBox</code> 的选中项发生改变时触发的事件。你可以通过订阅该事件，在选中项改变时执行特定的操作。</li></ul></li></ul> 
<p><strong>下面是一个示例，演示如何使用 ComboBox 控件：</strong></p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> <p>8</p> <p>9</p> <p>10</p> <p>11</p> <p>12</p> <p>13</p> <p>14</p> <p>15</p> <p>16</p> <p>17</p> <p>18</p> <p>19</p> <p>20</p> <p>21</p> <p>22</p> <p>23</p> <p>24</p> <p>25</p> <p>26</p> <p>27</p> <p>28</p> <p>29</p> <p>30</p> <p>31</p> <p>32</p> <p>33</p> <p>34</p> <p>35</p> <p>36</p> <p>37</p> <p>38</p> <p>39</p> <p>40</p> </td><td> <p><code>using</code> <code>System;</code></p> <p><code>using</code> <code>System.Windows.Forms;</code></p> <p><code>namespace</code> <code>ComboBoxExample</code></p> <p><code>{<!-- --></code></p> <p><code>    </code><code>public</code> <code>partial</code> <code>class</code> <code>MainForm : Form</code></p> <p><code>    </code><code>{<!-- --></code></p> <p><code>        </code><code>public</code> <code>MainForm()</code></p> <p><code>        </code><code>{<!-- --></code></p> <p><code>            </code><code>InitializeComponent();</code></p> <p><code>        </code><code>}</code></p> <p><code>        </code><code>private</code> <code>void</code> <code>MainForm_Load(</code><code>object</code> <code>sender, EventArgs e)</code></p> <p><code>        </code><code>{<!-- --></code></p> <p><code>            </code><code>// 初始化 ComboBox 的选项</code></p> <p><code>            </code><code>comboBox.Items.Add(</code><code>"选项1"</code><code>);</code></p> <p><code>            </code><code>comboBox.Items.Add(</code><code>"选项2"</code><code>);</code></p> <p><code>            </code><code>comboBox.Items.Add(</code><code>"选项3"</code><code>);</code></p> <p><code>            </code><code>// 设置默认选中项</code></p> <p><code>            </code><code>comboBox.SelectedIndex = 0;</code></p> <p><code>        </code><code>}</code></p> <p><code>        </code><code>private</code> <code>void</code> <code>comboBox_SelectedIndexChanged(</code><code>object</code> <code>sender, EventArgs e)</code></p> <p><code>        </code><code>{<!-- --></code></p> <p><code>            </code><code>// 当选中项发生改变时触发的事件</code></p> <p><code>            </code><code>string</code> <code>selectedOption = comboBox.SelectedItem.ToString();</code></p> <p><code>            </code><code>MessageBox.Show(</code><code>"选中的选项是："</code> <code>+ selectedOption);</code></p> <p><code>        </code><code>}</code></p> <p><code>        </code><code>private</code> <code>void</code> <code>btnGetSelected_Click(</code><code>object</code> <code>sender, EventArgs e)</code></p> <p><code>        </code><code>{<!-- --></code></p> <p><code>            </code><code>// 获取当前选中项</code></p> <p><code>            </code><code>string</code> <code>selectedOption = comboBox.SelectedItem.ToString();</code></p> <p><code>            </code><code>MessageBox.Show(</code><code>"当前选中的选项是："</code> <code>+ selectedOption);</code></p> <p><code>        </code><code>}</code></p> <p><code>        </code><code>private</code> <code>void</code> <code>btnAddOption_Click(</code><code>object</code> <code>sender, EventArgs e)</code></p> <p><code>        </code><code>{<!-- --></code></p> <p><code>            </code><code>// 添加新选项</code></p> <p><code>            </code><code>string</code> <code>newOption = textBoxNewOption.Text;</code></p> <p><code>            </code><code>comboBox.Items.Add(newOption);</code></p> <p><code>            </code><code>MessageBox.Show(</code><code>"已添加新选项："</code> <code>+ newOption);</code></p> <p><code>        </code><code>}</code></p> <p><code>    </code><code>}</code></p> <p><code>}</code></p> </td></tr></tbody></table> 
<p>在上述示例中，我们创建了一个名为 “MainForm” 的窗体应用程序，并放置了一个 <code>ComboBox</code> 控件和两个按钮和一个文本框。在窗体的加载事件中，我们初始化了 <code>ComboBox</code> 的选项，并将第一个选项设为默认选中。当选中项发生改变时，会触发 <code>SelectedIndexChanged</code> 事件，弹出选中项的消息框。点击按钮时，可以获取当前选中项的文本，或者添加新的选项到 <code>ComboBox</code> 中。</p> 
<p><strong>附更多实例代码</strong></p> 
<p>1.让用户只能选择项。</p> 
<p>很简单，设置ComboBox的属性DropDownStyle为DropDownList即可。</p> 
<p></p> 
<p class="img-center"><img alt="" height="120" src="https://images2.imgbox.com/0a/e4/ItlcF19z_o.jpg" width="284"></p> 
<p>2.往ComboBox中添加新项。</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> </td><td> <p><code>private</code> <code>void</code> <code>Form1_Load(</code><code>object</code> <code>sender, EventArgs e)</code></p> <p><code>       </code><code>{<!-- --></code></p> <p><code>           </code><code>this</code><code>.cmbTest.Items.Add(</code><code>"A"</code><code>);</code></p> <p><code>           </code><code>this</code><code>.cmbTest.Items.Add(</code><code>"B"</code><code>);</code></p> <p><code>           </code><code>this</code><code>.cmbTest.Items.Add(</code><code>"C"</code><code>);</code></p> <p><code>           </code><code>this</code><code>.cmbTest.Items.Add(</code><code>"D"</code><code>);</code></p> <p><code>       </code><code>}</code></p> </td></tr></tbody></table> 
<p>//效果截图如下</p> 
<p></p> 
<p class="img-center"><img alt="" height="114" src="https://images2.imgbox.com/07/f4/ixYj10c9_o.jpg" width="252"></p> 
<p>3.设置默认选择的项。</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> </td><td> <p><code>this</code><code>.cmbTest.SelectedIndex = 3; </code><code>//选择第四项,注意，编号从0开始</code></p> </td></tr></tbody></table> 
<p></p> 
<p class="img-center"><img alt="" height="124" src="https://images2.imgbox.com/f7/d3/wgqwiNHh_o.jpg" width="268"></p> 
<p>4.获取选择的项的文本。</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> </td><td> <p><code>MessageBox.Show(</code><code>this</code><code>.cmbTest.SelectedItem.ToString());</code></p> </td></tr></tbody></table> 
<p></p> 
<p class="img-center"><img alt="" height="267" src="https://images2.imgbox.com/57/d1/sQYbbAMs_o.jpg" width="272"></p> 
<p>5.遍历ComboBox控件中每一项的文本:</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> <p>8</p> <p>9</p> </td><td> <p><code>//从最后一项开始遍历</code></p> <p><code>for</code> <code>(</code><code>int</code> <code>i = </code><code>this</code><code>.cmbRoomId.Items.Count - 1; i &gt;= 0;i-- )</code></p> <p><code>{<!-- --></code></p> <p><code>    </code><code>this</code><code>.cmbRoomId.SelectedIndex=i;</code><code>//选择第i项</code></p> <p><code>    </code><code>if</code> <code>(</code><code>this</code><code>.cmbRoomId.Text.Trim().Equals(</code><code>"Admin"</code><code>))</code><code>//判断项的文本</code></p> <p><code>    </code><code>{<!-- --></code></p> <p><code>        </code><code>break</code><code>;</code><code>//找到就停止遍历</code></p> <p><code>    </code><code>}</code></p> <p><code>}</code></p> </td></tr></tbody></table> 
<p>6.数据绑定：</p> 
<p>在SQL2005数据库中，我有两列renterID和renterName</p> 
<p>//截图如下</p> 
<p></p> 
<p class="img-center"><img alt="" height="167" src="https://images2.imgbox.com/54/e4/cUUghvxd_o.jpg" width="200"></p> 
<p>现在我想让ComboBox控件显示的是renterName,而ComboBox实际的值却是renterID,</p> 
<p>我们如何做呢?</p> 
<p>先看下我们写的SQL语句：select renterId,renterName from Renter</p> 
<p>有了SQL语句，怎么获取数据集DataSet,这个不用我说了吧？</p> 
<p>有了数据集后，我们就可以将其绑定到ComboBox中了。</p> 
<p>代码如下:</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> <p>8</p> <p>9</p> <p>10</p> </td><td> <p><code>string</code> <code>sql=</code><code>"select renterId,renterName from Renter"</code><code>;</code></p> <p><code>//SqlHelper.GetConnection()的作用是获取一个数据库连接对象，这是我自己封装的方法，请灵活应变。    </code></p> <p><code>using</code> <code>(SqlDataAdapter da = </code><code>new</code> <code>SqlDataAdapter(sql,SqlHelper.GetConnection()))</code></p> <p><code>               </code><code>{<!-- --></code></p> <p><code>                    </code><code>DataSet ds = </code><code>new</code> <code>DataSet();</code></p> <p><code>                    </code><code>da.Fill(ds);</code><code>//填充数据集，即获取数据集</code></p> <p><code>                    </code><code>this</code><code>.cmbRenter.DataSource = ds.Tables[0].DefaultView; </code><code>//设置ComboBox的数据源</code></p> <p><code>                    </code><code>this</code><code>.cmbRenter.DisplayMember = </code><code>"renterName"</code><code>; </code><code>//让ComboBox显示renterName列</code></p> <p><code>                    </code><code>this</code><code>.cmbRenter.ValueMember = </code><code>"renterId"</code><code>;  </code><code>//让ComboBox实际的值为renterId列</code></p> <p><code>                </code><code>}</code></p> </td></tr></tbody></table> 
<p>数据绑定好后，我们如何获取renterId的值呢？代码如下：</p> 
<p>MessageBox.Show(this.cmbRenter.SelectedValue.ToString()); </p> 
<p>//效果截图如下：</p> 
<p></p> 
<p class="img-center"><img alt="" height="228" src="https://images2.imgbox.com/9c/dd/Tz10IQs9_o.jpg" width="220"></p> 
<p></p> 
<p class="img-center"><img alt="" height="208" src="https://images2.imgbox.com/91/8d/T342nsJ7_o.jpg" width="211"></p> 
<p></p> 
<p class="img-center"><img alt="" height="222" src="https://images2.imgbox.com/d2/42/sYB3dm6k_o.jpg" width="207"></p> 
<p>希望这篇能帮助你理解和使用 <code>ComboBox</code> 控件的详细方法。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/aec607d80c04537b4efcdc3f1980c585/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Kafka如何保证消息的消费顺序【全局有序、局部有序</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f31576f42cb37b999cc4c94e447e6d1e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">设置 Python pip 源为国内源：阿里云源和清华大学源的最简便方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>