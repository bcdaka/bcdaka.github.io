<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Jenkins安装、配置、部署springboot项目 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/b84bbcec3ddbf97c58b0049b105dbcba/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Jenkins安装、配置、部署springboot项目">
  <meta property="og:description" content="文章目录
前言
一、环境
二、依赖
JDK安装
jdk下载
配置jdk环境变量
​编辑
MAVEN安装
maven下载
配置环境变量
maven仓库配置
git安装
安装git
安装jenkins
下载jenkins
启动jenkins
登录jenkins
安装插件
在线安装插件
jenkins离线安装插件（plugin） 配置jenkins
全局工具配置
配置maven
配置settings.xml
配置maven安装
配置JDK
配置git
系统配置
配置Publish over SSH
配置发布代码的服务器
凭证管理
添加gitea登录账号
测试
git拉取代码
本地部署代码
java脚本启动
docker启动
远程服务器部署
总结
前言 本文通过例子，系统性地讲解jenkins的安装、部署和部署springboot项目。内容覆盖docker、gtiea\免登录，编写shell脚本。
一、环境 操作系统：windows
两台服务器：centos7
服务器A:安装jenkins
服务器B：部署代码
二、依赖 服务器A需安装JDK、MAVEN、git，另外还需可以代码版本托管服务器，用来提交代码。
JDK安装 我是下载jenkins官方的war安装。所以必须需预先安装好JDK。
jdk下载 在window系统下，进入官网：Java Downloads | Oracle 中国，下载jdk17linux版
上传安装包到服务器A 安装上传工具：
yum install lszrz 上传jdk文件：
#创建存放文件的目录 cd /opt mkdir java cd java #上传文件 rz 选择window系统刚下载的jdk包，然后自动上传。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-09T18:34:13+08:00">
    <meta property="article:modified_time" content="2024-07-09T18:34:13+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Jenkins安装、配置、部署springboot项目</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <blockquote> 
 <p></p> 
</blockquote> 
<p><a href="#%E6%96%87%E7%AB%A0%E7%9B%AE%E5%BD%95" rel="nofollow">文章目录</a></p> 
<p id="%E5%89%8D%E8%A8%80-toc" style="margin-left:0px;"><a href="#%E5%89%8D%E8%A8%80" rel="nofollow">前言</a></p> 
<p id="%E4%B8%80%E3%80%81%E7%8E%AF%E5%A2%83-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E7%8E%AF%E5%A2%83" rel="nofollow">一、环境</a></p> 
<p id="%E4%BA%8C%E3%80%81%E4%BE%9D%E8%B5%96-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%E4%BE%9D%E8%B5%96" rel="nofollow">二、依赖</a></p> 
<p id="JDK%E5%AE%89%E8%A3%85-toc" style="margin-left:40px;"><a href="#JDK%E5%AE%89%E8%A3%85" rel="nofollow">JDK安装</a></p> 
<p id="jdk%E4%B8%8B%E8%BD%BD-toc" style="margin-left:80px;"><a href="#jdk%E4%B8%8B%E8%BD%BD" rel="nofollow">jdk下载</a></p> 
<p id="%E9%85%8D%E7%BD%AEjdk%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F-toc" style="margin-left:80px;"><a href="#%E9%85%8D%E7%BD%AEjdk%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F" rel="nofollow">配置jdk环境变量</a></p> 
<p id="%E2%80%8B%E7%BC%96%E8%BE%91-toc" style="margin-left:40px;"><a href="#%E2%80%8B%E7%BC%96%E8%BE%91" rel="nofollow">​编辑</a></p> 
<p id="MAVEN%E5%AE%89%E8%A3%85-toc" style="margin-left:40px;"><a href="#MAVEN%E5%AE%89%E8%A3%85" rel="nofollow">MAVEN安装</a></p> 
<p id="maven%E4%B8%8B%E8%BD%BD-toc" style="margin-left:80px;"><a href="#maven%E4%B8%8B%E8%BD%BD" rel="nofollow">maven下载</a></p> 
<p id="%C2%A0%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F-toc" style="margin-left:80px;"><a href="#%C2%A0%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F" rel="nofollow"> 配置环境变量</a></p> 
<p id="maven%E4%BB%93%E5%BA%93%E9%85%8D%E7%BD%AE-toc" style="margin-left:80px;"><a href="#maven%E4%BB%93%E5%BA%93%E9%85%8D%E7%BD%AE" rel="nofollow">maven仓库配置</a></p> 
<p id="git%E5%AE%89%E8%A3%85-toc" style="margin-left:40px;"><a href="#git%E5%AE%89%E8%A3%85" rel="nofollow">git安装</a></p> 
<p id="%C2%A0%E5%AE%89%E8%A3%85git-toc" style="margin-left:80px;"><a href="#%C2%A0%E5%AE%89%E8%A3%85git" rel="nofollow"> 安装git</a></p> 
<p id="%E5%AE%89%E8%A3%85jenkins-toc" style="margin-left:40px;"><a href="#%E5%AE%89%E8%A3%85jenkins" rel="nofollow">安装jenkins</a></p> 
<p id="%E4%B8%8B%E8%BD%BDjenkins-toc" style="margin-left:80px;"><a href="#%E4%B8%8B%E8%BD%BDjenkins" rel="nofollow">下载jenkins</a></p> 
<p id="%E5%90%AF%E5%8A%A8jenkins-toc" style="margin-left:80px;"><a href="#%E5%90%AF%E5%8A%A8jenkins" rel="nofollow">启动jenkins</a></p> 
<p id="%E7%99%BB%E5%BD%95jenkins-toc" style="margin-left:80px;"><a href="#%E7%99%BB%E5%BD%95jenkins" rel="nofollow">登录jenkins</a></p> 
<p id="%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6-toc" style="margin-left:80px;"><a href="#%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6" rel="nofollow">安装插件</a></p> 
<p id="%E5%9C%A8%E7%BA%BF%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6-toc" style="margin-left:120px;"><a href="#%E5%9C%A8%E7%BA%BF%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6" rel="nofollow">在线安装插件</a></p> 
<p id="jenkins%E7%A6%BB%E7%BA%BF%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6%EF%BC%88plugin%EF%BC%89%C2%A0-toc" style="margin-left:120px;"><a href="#jenkins%E7%A6%BB%E7%BA%BF%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6%EF%BC%88plugin%EF%BC%89%C2%A0" rel="nofollow">jenkins离线安装插件（plugin） </a></p> 
<p id="%E9%85%8D%E7%BD%AEjenkins-toc" style="margin-left:0px;"><a href="#%E9%85%8D%E7%BD%AEjenkins" rel="nofollow">配置jenkins</a></p> 
<p id="%E5%85%A8%E5%B1%80%E5%B7%A5%E5%85%B7%E9%85%8D%E7%BD%AE-toc" style="margin-left:40px;"><a href="#%E5%85%A8%E5%B1%80%E5%B7%A5%E5%85%B7%E9%85%8D%E7%BD%AE" rel="nofollow">全局工具配置</a></p> 
<p id="%E9%85%8D%E7%BD%AEmaven-toc" style="margin-left:80px;"><a href="#%E9%85%8D%E7%BD%AEmaven" rel="nofollow">配置maven</a></p> 
<p id="%E9%85%8D%E7%BD%AEsettings.xml-toc" style="margin-left:120px;"><a href="#%E9%85%8D%E7%BD%AEsettings.xml" rel="nofollow">配置settings.xml</a></p> 
<p id="%E9%85%8D%E7%BD%AEmaven%E5%AE%89%E8%A3%85-toc" style="margin-left:120px;"><a href="#%E9%85%8D%E7%BD%AEmaven%E5%AE%89%E8%A3%85" rel="nofollow">配置maven安装</a></p> 
<p id="%E9%85%8D%E7%BD%AEJDK-toc" style="margin-left:80px;"><a href="#%E9%85%8D%E7%BD%AEJDK" rel="nofollow">配置JDK</a></p> 
<p id="%E9%85%8D%E7%BD%AEgit-toc" style="margin-left:80px;"><a href="#%E9%85%8D%E7%BD%AEgit" rel="nofollow">配置git</a></p> 
<p id="%C2%A0%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE-toc" style="margin-left:40px;"><a href="#%C2%A0%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE" rel="nofollow"> 系统配置</a></p> 
<p id="%C2%A0%E9%85%8D%E7%BD%AEPublish%20over%20SSH-toc" style="margin-left:80px;"><a href="#%C2%A0%E9%85%8D%E7%BD%AEPublish%20over%20SSH" rel="nofollow"> 配置Publish over SSH</a></p> 
<p id="%E9%85%8D%E7%BD%AE%E5%8F%91%E5%B8%83%E4%BB%A3%E7%A0%81%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8-toc" style="margin-left:80px;"><a href="#%E9%85%8D%E7%BD%AE%E5%8F%91%E5%B8%83%E4%BB%A3%E7%A0%81%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8" rel="nofollow">配置发布代码的服务器</a></p> 
<p id="%E5%87%AD%E8%AF%81%E7%AE%A1%E7%90%86-toc" style="margin-left:0px;"><a href="#%E5%87%AD%E8%AF%81%E7%AE%A1%E7%90%86" rel="nofollow">凭证管理</a></p> 
<p id="%E6%B7%BB%E5%8A%A0gitea%E7%99%BB%E5%BD%95%E8%B4%A6%E5%8F%B7-toc" style="margin-left:40px;"><a href="#%E6%B7%BB%E5%8A%A0gitea%E7%99%BB%E5%BD%95%E8%B4%A6%E5%8F%B7" rel="nofollow">添加gitea登录账号</a></p> 
<p id="%C2%A0%E6%B5%8B%E8%AF%95-toc" style="margin-left:0px;"><a href="#%C2%A0%E6%B5%8B%E8%AF%95" rel="nofollow"> 测试</a></p> 
<p id="git%E6%8B%89%E5%8F%96%E4%BB%A3%E7%A0%81-toc" style="margin-left:40px;"><a href="#git%E6%8B%89%E5%8F%96%E4%BB%A3%E7%A0%81" rel="nofollow">git拉取代码</a></p> 
<p id="%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2%E4%BB%A3%E7%A0%81-toc" style="margin-left:40px;"><a href="#%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2%E4%BB%A3%E7%A0%81" rel="nofollow">本地部署代码</a></p> 
<p id="java%E8%84%9A%E6%9C%AC%E5%90%AF%E5%8A%A8-toc" style="margin-left:80px;"><a href="#java%E8%84%9A%E6%9C%AC%E5%90%AF%E5%8A%A8" rel="nofollow">java脚本启动</a></p> 
<p id="docker%E5%90%AF%E5%8A%A8-toc" style="margin-left:80px;"><a href="#docker%E5%90%AF%E5%8A%A8" rel="nofollow">docker启动</a></p> 
<p id="%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2-toc" style="margin-left:40px;"><a href="#%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2" rel="nofollow">远程服务器部署</a></p> 
<p id="%E6%80%BB%E7%BB%93-toc" style="margin-left:0px;"><a href="#%E6%80%BB%E7%BB%93" rel="nofollow">总结</a></p> 
<hr id="hr-toc"> 
<p></p> 
<hr> 
<h2 id="%E5%89%8D%E8%A8%80"><a id="_7"></a>前言</h2> 
<p>本文通过例子，系统性地讲解jenkins的安装、部署和部署springboot项目。内容覆盖docker、gtiea\免登录，编写shell脚本。</p> 
<p></p> 
<h2 id="%E4%B8%80%E3%80%81%E7%8E%AF%E5%A2%83"><a id="pandas_16"></a>一、环境</h2> 
<p>操作系统：windows</p> 
<p>两台服务器：centos7</p> 
<p>服务器A:安装jenkins</p> 
<p>服务器B：部署代码</p> 
<h2 id="%E4%BA%8C%E3%80%81%E4%BE%9D%E8%B5%96"><a id="_19"></a>二、依赖</h2> 
<p>服务器A需安装JDK、MAVEN、git，另外还需可以代码版本托管服务器，用来提交代码。</p> 
<p></p> 
<h3 id="JDK%E5%AE%89%E8%A3%85">JDK安装</h3> 
<p>        我是下载jenkins官方的war安装。所以必须需预先安装好JDK。</p> 
<h4 id="jdk%E4%B8%8B%E8%BD%BD">jdk下载</h4> 
<p>在window系统下，进入官网：<a href="https://www.oracle.com/cn/java/technologies/downloads/#java17" rel="nofollow" title="Java Downloads | Oracle 中国">Java Downloads | Oracle 中国</a>，下载jdk17linux版</p> 
<p><img alt="" height="779" src="https://images2.imgbox.com/63/ab/b6LUo6bW_o.png" width="1200"></p> 
<ul><li>上传安装包到服务器A</li></ul> 
<p>安装上传工具：</p> 
<pre><code class="language-bash">yum install lszrz</code></pre> 
<p>上传jdk文件：</p> 
<pre><code class="language-bash">#创建存放文件的目录
cd /opt

mkdir java

cd java

#上传文件

rz</code></pre> 
<p>选择window系统刚下载的jdk包，然后自动上传。</p> 
<p><img alt="" height="475" src="https://images2.imgbox.com/be/85/oDiYCqb9_o.png" width="721"></p> 
<p>解压文件</p> 
<pre><code class="language-bash">tar -xzvf jdk-17.0.10_linux-x64_bin.tar.gz </code></pre> 
<h4 id="%E9%85%8D%E7%BD%AEjdk%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F">配置jdk环境变量</h4> 
<p> 编辑环境</p> 
<pre><code class="language-bash">/etc/profile</code></pre> 
<h3 id="%E2%80%8B%E7%BC%96%E8%BE%91"><img alt="" height="444" src="https://images2.imgbox.com/86/e3/GwuzCyIB_o.png" width="558"></h3> 
<ul><li>使配置生效</li></ul> 
<p></p> 
<pre><code class="language-bash">source /etc/profile</code></pre> 
<ul><li>查看是否配置成功</li></ul> 
<pre><code class="language-bash">java -version</code></pre> 
<p>如果出现如下界面，说明配置成功</p> 
<p><img alt="" height="73" src="https://images2.imgbox.com/eb/6e/FIoZCP9t_o.png" width="580"></p> 
<p>到此，jdk已经安装成功。</p> 
<p></p> 
<h3 id="MAVEN%E5%AE%89%E8%A3%85">MAVEN安装</h3> 
<p>maven安装过程和jdk比较类似。</p> 
<h4 id="maven%E4%B8%8B%E8%BD%BD">maven下载</h4> 
<p>进入官网：<a href="https://maven.apache.org/download.cgi" rel="nofollow" title="Maven – Download Apache Maven，下载">Maven – Download Apache Maven，下载</a></p> 
<p><img alt="" height="571" src="https://images2.imgbox.com/2c/1a/djp17tAd_o.png" width="902"></p> 
<p> 创建目录</p> 
<pre><code class="language-bash">cd /opt/

mkdir maven</code></pre> 
<p></p> 
<p>进入目录</p> 
<pre><code class="language-bash">cd maven</code></pre> 
<p>上传文件</p> 
<pre><code class="language-bash">rz</code></pre> 
<p>解压文件</p> 
<pre><code class="language-bash">tar -xzrf apache-maven-3.9.6-bin.tar.gz</code></pre> 
<h4 id="%C2%A0%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"> 配置环境变量</h4> 
<pre><code class="language-bash">vi /etc/profile
</code></pre> 
<p><img alt="" height="304" src="https://images2.imgbox.com/93/43/RtRNen8Z_o.png" width="453"></p> 
<p>使配置生效</p> 
<pre><code class="language-bash">source /etc/profile</code></pre> 
<p>验证配置是否成功</p> 
<pre><code class="language-bash">mvn -version</code></pre> 
<p>如果看到下图，即说明配置成功了</p> 
<p></p> 
<p></p> 
<h4 id="maven%E4%BB%93%E5%BA%93%E9%85%8D%E7%BD%AE">maven仓库配置</h4> 
<p>创建仓库目录</p> 
<pre><code class="language-bash">mkdir maven-repository</code></pre> 
<p>配置settings.xml</p> 
<pre><code class="language-bash">cd /opt/maven/apache-maven-3.9.6/conf/</code></pre> 
<p>备份settings.xml（非必须）</p> 
<pre><code class="language-bash">cp settings.xml settings.xml-bak</code></pre> 
<p>在window系统配置好settings.xml（主要是配阿里镜像库），上传到/opt/maven/apache-maven-3.9.6/conf/目录下，覆盖settings.xml。（也可以在linux下自己编辑settings.xml）</p> 
<pre><code class="language-bash">#上传settings.xml

rz</code></pre> 
<p></p> 
<p><img alt="" height="481" src="https://images2.imgbox.com/90/c1/dvLKqpZu_o.png" width="559"></p> 
<p>修改&lt;localRepository&gt;</p> 
<p>vi settings.xml</p> 
<p>修改仓库到刚才创建的目录</p> 
<p><img alt="" height="94" src="https://images2.imgbox.com/1f/5e/acApAxcJ_o.png" width="633"></p> 
<p>修改镜像地址</p> 
<p><img alt="" height="274" src="https://images2.imgbox.com/d5/03/y2px7xmt_o.png" width="664"></p> 
<p></p> 
<p>到此，maven也安装配置完成。</p> 
<h3 id="git%E5%AE%89%E8%A3%85">git安装</h3> 
<p>参考：<a href="https://blog.csdn.net/weixin_44799217/article/details/130784652" title="Centos7系统上安装git命令_centos7安装git命令-CSDN博客">Centos7系统上安装git命令_centos7安装git命令-CSDN博客</a></p> 
<p> 检查是否已经安装git</p> 
<pre><code class="language-bash">git --version</code></pre> 
<h4 id="%C2%A0%E5%AE%89%E8%A3%85git"> 安装git</h4> 
<pre><code class="language-bash">yum -y install git</code></pre> 
<p>查看git安装目录</p> 
<p>主要是给后面的jenkins配置时用</p> 
<pre><code class="language-bash">which git</code></pre> 
<p> <img alt="" height="38" src="https://images2.imgbox.com/32/5c/s7nNOf7o_o.png" width="241"></p> 
<p>到此，jenkins要用的工具已安装完成。接下来安装jenkins。</p> 
<h3 id="%E5%AE%89%E8%A3%85jenkins">安装jenkins</h3> 
<p>进入官网：<a href="https://www.jenkins.io/zh/download/" rel="nofollow" title="Jenkins 的安装和设置">Jenkins 的安装和设置</a></p> 
<h4 id="%E4%B8%8B%E8%BD%BDjenkins">下载jenkins</h4> 
<p>点击下面</p> 
<p><img alt="" height="513" src="https://images2.imgbox.com/83/3f/GGpVvVUF_o.png" width="1200"></p> 
<p></p> 
<p>进入页面，然后拉到页面下面。建议下载较新版本，因为有些老版本安装插件会有问题。</p> 
<p><img alt="" height="596" src="https://images2.imgbox.com/7d/8b/C9PMLe7x_o.png" width="652"></p> 
<p>       创建jenkins目录</p> 
<pre><code class="language-bash">mkdir jenkins_home</code></pre> 
<p>进入目录</p> 
<pre><code class="language-bash">cd jenkins_home</code></pre> 
<p>上传刚下载war</p> 
<pre><code class="language-bash">rz</code></pre> 
<h4 id="%E5%90%AF%E5%8A%A8jenkins">启动jenkins</h4> 
<p>设置端口9091</p> 
<p>注意端口是否被占用，可通过命令查端口。（如果系统已经安装过jenkins，建议清除干净再启动，不然可能会影响到这次的）。如果是在生产上，建议通过后台的方式启动，nohup java -jar ...</p> 
<pre><code class="language-bash"> java -jar jenkins.war --httpPort=9091</code></pre> 
<p>记住密码 </p> 
<p><img alt="" height="245" src="https://images2.imgbox.com/db/8f/Cl8fwYYY_o.png" width="696"></p> 
<h4 id="%E7%99%BB%E5%BD%95jenkins">登录jenkins</h4> 
<p><a href="http://192.168.196.5:9091/login?from=%2F" rel="nofollow" title="http://192.168.196.5:9091/login?from=%2F">http://192.168.196.5:9091/login?from=%2F</a>。</p> 
<p>复制密码，点“继续”登录。</p> 
<p><img alt="" height="965" src="https://images2.imgbox.com/f1/6d/e744b21k_o.png" width="1200"></p> 
<p></p> 
<h4 id="%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6">安装插件</h4> 
<p>安装插件有两种方式，在线自动安装和手工离线安装。</p> 
<h5 id="%E5%9C%A8%E7%BA%BF%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6">在线安装插件</h5> 
<p>新手建议默认安装（在线自动安装）</p> 
<p><img alt="" height="633" src="https://images2.imgbox.com/1f/8a/Xx4BxSa0_o.png" width="827"></p> 
<p>插件安装完之后，出现如下界面，然后设置一个管理员。</p> 
<p><img alt="" height="878" src="https://images2.imgbox.com/99/4c/2LRnrwCv_o.png" width="995"><img alt="" height="879" src="https://images2.imgbox.com/67/7a/zi1cHT8S_o.png" width="982">点击下一步出现如下界面，点击保存并完成</p> 
<p><img alt="" height="863" src="https://images2.imgbox.com/0b/e5/XFa8yJne_o.png" width="982"></p> 
<p>点击开始使用jenkins。可能有点卡，要稍等。。</p> 
<p></p> 
<p></p> 
<p>根据自己需求添加插件。</p> 
<p>我使用代码托管是gitea，打包工具是maven，我是使用ssh的方式把打包好的jar远程部署到另外一台服务器。所以我还需安装gitea、mave和ssh插件。提示：这里的maven插件和之前安装的maven是不同的，这里的插件表明安装了才可以配置相关的maven信息，并且在jenkins运行。</p> 
<p><img alt="" height="820" src="https://images2.imgbox.com/cd/ba/FJm40cLC_o.png" width="1200"></p> 
<p><img alt="" height="545" src="https://images2.imgbox.com/e0/4f/g8rhAWTg_o.png" width="867"></p> 
<p><img alt="" height="490" src="https://images2.imgbox.com/55/54/EAOzfRuG_o.png" width="1200"></p> 
<p>看到如下界面，说明插件已经安装成功。</p> 
<p><img alt="" height="839" src="https://images2.imgbox.com/51/3b/BF6zMqce_o.png" width="890"></p> 
<p>maven和ssh的安装过程同上面，这里就不细讲。</p> 
<p><img alt="" height="284" src="https://images2.imgbox.com/fc/79/FyHUMkrg_o.png" width="711"></p> 
<p><img alt="" height="500" src="https://images2.imgbox.com/5a/4c/mQfN4IBs_o.png" width="826"></p> 
<p>查看已经安装好的插件</p> 
<p><img alt="" height="465" src="https://images2.imgbox.com/5e/97/U5AiVZQG_o.png" width="941"></p> 
<h5 id="jenkins%E7%A6%BB%E7%BA%BF%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6%EF%BC%88plugin%EF%BC%89%C2%A0">jenkins离线安装插件（plugin） </h5> 
<p>如果插件无法自动安装，还可以通过手工安装。</p> 
<p><img alt="" height="431" src="https://images2.imgbox.com/75/1e/X8nI5bRb_o.png" width="1084"></p> 
<p></p> 
<p>下载页面</p> 
<p>找到 releases,并且点击进入该页面，会出现多个版本，下载地址就在download的旁边的direct link，点击之后会下载一个名称后缀为.hpi的文件。</p> 
<p><img alt="" height="826" src="https://images2.imgbox.com/a5/9f/MRXUlVf6_o.png" width="1034"></p> 
<p>手工安装下载下来的插件</p> 
<p><img alt="" height="609" src="https://images2.imgbox.com/b2/ae/1fOGR1N6_o.png" width="830"></p> 
<p><img alt="" height="608" src="https://images2.imgbox.com/05/46/EDPnq0Ff_o.png" width="1001"></p> 
<p><img alt="" height="646" src="https://images2.imgbox.com/ab/ce/pqNZA0vz_o.png" width="772"></p> 
<p>到此，离线安装插件已经完成。</p> 
<p></p> 
<p>补充：</p> 
<p>离线插件也可以通过官网下载<a href="https://plugins.jenkins.io/" rel="nofollow" title="Jenkins Plugins">Jenkins Plugins</a></p> 
<p><img alt="" height="577" src="https://images2.imgbox.com/8e/7b/AdtHjYbL_o.png" width="1200"></p> 
<p>配置国内的清华镜像源 </p> 
<p>自动安装插件如果无法安装，也可以更换jenkins升级站点，把它设为国内站点。</p> 
<p><a href="https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json" rel="nofollow" title="https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json">https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json</a></p> 
<p><img alt="" height="820" src="https://images2.imgbox.com/1c/31/IQ1cEe0O_o.png" width="1200"></p> 
<h2 id="%E9%85%8D%E7%BD%AEjenkins">配置jenkins</h2> 
<h3 id="%E5%85%A8%E5%B1%80%E5%B7%A5%E5%85%B7%E9%85%8D%E7%BD%AE">全局工具配置</h3> 
<p>还记得之前安装的jdk、maven和git吧，这些都是jenkins的工具，现在就可以用上场了。</p> 
<p><img alt="" height="756" src="https://images2.imgbox.com/f5/7d/fWmhTnJq_o.png" width="1200"></p> 
<h4 id="%E9%85%8D%E7%BD%AEmaven">配置maven</h4> 
<h5 id="%E9%85%8D%E7%BD%AEsettings.xml">配置settings.xml</h5> 
<p>找出settings.xml位置。</p> 
<p></p> 
<p><img alt="" height="83" src="https://images2.imgbox.com/b1/3c/p24469BZ_o.png" width="406"></p> 
<p><img alt="" height="526" src="https://images2.imgbox.com/cd/1c/JopVygz0_o.png" width="754"></p> 
<h5 id="%E9%85%8D%E7%BD%AEmaven%E5%AE%89%E8%A3%85">配置maven安装</h5> 
<p>拖到下面，看到maven安装</p> 
<p><img alt="" height="845" src="https://images2.imgbox.com/68/64/84Yoi5Et_o.png" width="541"></p> 
<p>找出maven安装目录</p> 
<p><img alt="" height="77" src="https://images2.imgbox.com/ac/4e/Iavx9lkV_o.png" width="492"></p> 
<p>配置</p> 
<p><img alt="" height="623" src="https://images2.imgbox.com/d2/98/5YUS7HRy_o.png" width="576"></p> 
<h4 id="%E9%85%8D%E7%BD%AEJDK">配置JDK</h4> 
<p>找出jdk的安装目录</p> 
<p><img alt="" height="115" src="https://images2.imgbox.com/06/ab/eMGklOUA_o.png" width="345"></p> 
<p> 配置jdk</p> 
<p><img alt="" height="472" src="https://images2.imgbox.com/62/88/H49vhdAC_o.png" width="639"></p> 
<h4 id="%E9%85%8D%E7%BD%AEgit">配置git</h4> 
<p>找出git安装目录</p> 
<p><img alt="" height="52" src="https://images2.imgbox.com/81/bb/02OpUUFL_o.png" width="305"></p> 
<p>配置</p> 
<p><img alt="" height="443" src="https://images2.imgbox.com/8a/27/L2jN5ekb_o.png" width="514"></p> 
<p></p> 
<h3 id="%C2%A0%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE"> 系统配置</h3> 
<p><img alt="" height="749" src="https://images2.imgbox.com/29/ee/weKRd2JU_o.png" width="805"></p> 
<h4 id="%C2%A0%E9%85%8D%E7%BD%AEPublish%20over%20SSH"> 配置Publish over SSH</h4> 
<p>在服务器上生成私钥和密钥。目的是免登录其他远程服务器。</p> 
<pre><code class="language-bash">#进入目录
cd /root/.ssh/
#生成密钥
ssh-keygen</code></pre> 
<p><img alt="" height="37" src="https://images2.imgbox.com/ea/ba/E0ATYWJr_o.png" width="267"></p> 
<p>私钥：id_rsa 公钥：id_rsa.pub</p> 
<pre><code class="language-bash">cat id_rsa</code></pre> 
<p>把私钥复制好</p> 
<p><img alt="" height="466" src="https://images2.imgbox.com/25/90/lsoyjm4t_o.png" width="470"></p> 
<p>把私钥粘贴到这里。</p> 
<p><img alt="" height="541" src="https://images2.imgbox.com/1d/1d/jvv2EsVP_o.png" width="708"></p> 
<p>如果想要访问那台服务器，还需将公钥发送给远程服务器。</p> 
<p>ssh-copy-id root@远程服务器ip</p> 
<p>执行上述指令后，会要求我们输入该用户的密码进行验证，我们输入密码后，远程服务器验证密码正确便会将该公钥保存该服务器的/root/ .ssh/authorized_key。再次连接远程服务器，不用输入密码即可连接并执行指令。注意authorized_keys是否有读写权限，没有的话还需授权。</p> 
<p></p> 
<p></p> 
<p></p> 
<p>这里可以看到jenkins的主目录，</p> 
<p><img alt="" height="308" src="https://images2.imgbox.com/92/1a/IUCEJ27s_o.png" width="603"></p> 
<h4 id="%E9%85%8D%E7%BD%AE%E5%8F%91%E5%B8%83%E4%BB%A3%E7%A0%81%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8">配置发布代码的服务器</h4> 
<p>jenkins拉取代码并打包好程序之后，如果想发布到其他服务器，还需配置一下远程服务器。</p> 
<p><img alt="" height="826" src="https://images2.imgbox.com/c3/2c/GbIyCM3I_o.png" width="688"></p> 
<p>输入192.168.196.4（远程）这台服务器的密码。（如果在192.168.196.4安装jenkins，这里配的就是192.168.196.5）</p> 
<p><img alt="" height="312" src="https://images2.imgbox.com/da/0d/vqrUhMol_o.png" width="637"></p> 
<p>配置好之后，点击测试。</p> 
<p><img alt="" height="554" src="https://images2.imgbox.com/9b/f9/RrvNOhtC_o.png" width="1200">看到success就表示配置成功了。</p> 
<p>参考图：</p> 
<p><img alt="" height="832" src="https://images2.imgbox.com/b0/85/4qK7XJwj_o.png" width="1158"></p> 
<p></p> 
<p></p> 
<h2 id="%E5%87%AD%E8%AF%81%E7%AE%A1%E7%90%86">凭证管理</h2> 
<p><img alt="" height="753" src="https://images2.imgbox.com/d4/13/BpW5ZIzo_o.png" width="931"></p> 
<p></p> 
<p><img alt="" height="420" src="https://images2.imgbox.com/d3/a9/hRrG2win_o.png" width="658"></p> 
<p><img alt="" height="484" src="https://images2.imgbox.com/d6/e5/fbtTVpNa_o.png" width="1200"></p> 
<h3 id="%E6%B7%BB%E5%8A%A0gitea%E7%99%BB%E5%BD%95%E8%B4%A6%E5%8F%B7">添加gitea登录账号</h3> 
<p>我在gitea上创建一个账号（如名为jenkins），并给这个账号有代码读取权限。</p> 
<p>使用这个登录账号配置凭证。</p> 
<p><img alt="" height="604" src="https://images2.imgbox.com/08/1b/NfqCTVc2_o.png" width="536"></p> 
<p></p> 
<h2 id="%C2%A0%E6%B5%8B%E8%AF%95"> 测试</h2> 
<h3 id="git%E6%8B%89%E5%8F%96%E4%BB%A3%E7%A0%81">git拉取代码</h3> 
<p><img alt="" height="355" src="https://images2.imgbox.com/d7/a5/06HKZGyw_o.png" width="617"></p> 
<p><img alt="" height="882" src="https://images2.imgbox.com/85/7c/b9iBY1t4_o.png" width="736"></p> 
<p>丢弃旧的构建</p> 
<p>保留3天内的或者前10次的构建数据</p> 
<p><img alt="" height="648" src="https://images2.imgbox.com/cc/8a/4RXm2pZN_o.png" width="775"></p> 
<p>配置代码地址。账号为登录gitea的账号和密码。</p> 
<p></p> 
<p><img alt="" height="582" src="https://images2.imgbox.com/72/ef/lRqwr8uV_o.png" width="791"></p> 
<p>配置maven打包。</p> 
<p>clean -Dmaven.test.skip=true package</p> 
<p><img alt="" height="489" src="https://images2.imgbox.com/54/4b/qyX7SPUc_o.png" width="444"></p> 
<p>配置maven仓库配置。</p> 
<p>选择前面配置好的settings.xml。提示：使用默认maven可能会出问题，所以最后选自己配置好的。</p> 
<p><img alt="" height="651" src="https://images2.imgbox.com/fd/d1/9f3ZgkxT_o.png" width="792"></p> 
<p>构建项目</p> 
<p><img alt="" height="881" src="https://images2.imgbox.com/a6/df/vZdl2usv_o.png" width="800"></p> 
<p><img alt="" height="317" src="https://images2.imgbox.com/46/74/Hn1SMVmx_o.png" width="474"></p> 
<p><img alt="" height="653" src="https://images2.imgbox.com/a4/2f/6GLkCkyZ_o.png" width="635"></p> 
<p><img alt="" height="568" src="https://images2.imgbox.com/52/b0/MCyB1OEu_o.png" width="822"></p> 
<p>查看控制台信息</p> 
<p><img alt="" height="804" src="https://images2.imgbox.com/99/2d/NNaapJ9u_o.png" width="1200"></p> 
<p><img alt="" height="897" src="https://images2.imgbox.com/c3/4b/0Qy7yCOZ_o.png" width="1200"></p> 
<p></p> 
<p>从上面信息可看出，代码已经从gitea上拉取下来，并打包成功。</p> 
<p>进入服务器查看，发现打包在这里了。/root/.jenkins/workspace</p> 
<p><img alt="" height="98" src="https://images2.imgbox.com/6b/3f/EtfmNUbi_o.png" width="393"></p> 
<p>接下来就需要部署代码了。</p> 
<h3 id="%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2%E4%BB%A3%E7%A0%81">本地部署代码</h3> 
<p>本地部署，即在jenkins当台服务器上部署。</p> 
<p>选择生成后脚本执行。</p> 
<p><img alt="" height="724" src="https://images2.imgbox.com/cc/a2/NohxMsal_o.png" width="687"></p> 
<h4 id="java%E8%84%9A%E6%9C%AC%E5%90%AF%E5%8A%A8">java脚本启动</h4> 
<p>编写shell脚本</p> 
<p><img alt="" height="293" src="https://images2.imgbox.com/3d/2c/AsnJuWw8_o.png" width="839"></p> 
<p>再次构建，然后查看控制台</p> 
<p><img alt="" height="657" src="https://images2.imgbox.com/7a/90/JtISs81r_o.png" width="1200"></p> 
<p>发现已经启动。</p> 
<h4 id="docker%E5%90%AF%E5%8A%A8">docker启动</h4> 
<p>修改jar打包名，目的为了dockerfile编写方便</p> 
<p><img alt="" height="499" src="https://images2.imgbox.com/c9/6a/x84u00AC_o.png" width="1200"></p> 
<p></p> 
<p>编写dockerfile</p> 
<p><img alt="" height="453" src="https://images2.imgbox.com/c7/d8/50GWoBZr_o.png" width="1200"></p> 
<p>编写shell脚本</p> 
<p>注意：dockerfile是在任务名目录下</p> 
<p><img alt="" height="602" src="https://images2.imgbox.com/d8/c2/9A64qWWD_o.png" width="875"></p> 
<p><img alt="" height="201" src="https://images2.imgbox.com/1c/6c/PrU6SClc_o.png" width="972"></p> 
<p>打开控制台。</p> 
<p><img alt="" height="751" src="https://images2.imgbox.com/ac/1b/0gkylJZJ_o.png" width="977"></p> 
<p>通过日志可知道已经部署成功。可打开浏览器验证。</p> 
<h3 id="%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2">远程服务器部署</h3> 
<p>Add post-build step</p> 
<p><img alt="" height="793" src="https://images2.imgbox.com/bf/08/yhK45Xkp_o.png" width="839"></p> 
<p><img alt="" height="651" src="https://images2.imgbox.com/8f/fe/j0aEnK07_o.png" width="1036"></p> 
<hr> 
<p>编写远程shell脚本</p> 
<p>首先在远程服务器的/app目录下编写一个.sh脚本。jenkins会把jar发布到配置的app/workspace（具体看自己的配置）下。</p> 
<pre><code class="language-bash">[root@localhost ~]# cd /app/workspace/
[root@localhost workspace]# ls
app.jar
[root@localhost workspace]# cd ..
[root@localhost app]# touch app-start.sh
[root@localhost app]# vi app-start.sh 
</code></pre> 
<p>脚本如下（app-start.sh）：</p> 
<pre><code class="language-bash">echo "Stop Procedure : app.jar"
#获取指定项目运行pid
pid=`ps -ef |grep java|grep app.jar | grep -v grep |awk '{print $2}'`
echo 'old Procedure pid:'$pid
 
#pid存在则kill
if [ -n "$pid" ]
then
kill -9 $pid
fi
 
echo 'Start the program : app.jar'
#给项目jar  777权限
 
#进入项目所在目录，在jenkins服务器上配置的工作目录
cd /app/workspace
 
chmod 777 /app/workspace/app.jar
 
echo '-------Starting-------'
#运行项目 （指定时区  指定字符编码  指定输出日志）
nohup java -jar app.jar 2&gt;&amp;1 &amp;
echo 'jar启动完成'</code></pre> 
<p>注意：运行.sh脚本时，如果报无法找到java命令，则使用java全路径执行。 如下脚本</p> 
<pre><code class="language-bash">nohup /opt/java/jdk-17.0.10/bin/java -jar app.jar &gt;app.log 2&gt;&amp; 1 &amp;</code></pre> 
<p>Add post-build step </p> 
<p><img alt="" height="800" src="https://images2.imgbox.com/54/25/7geE1AL9_o.png" width="839"></p> 
<p> 编写启动脚本：</p> 
<pre><code class="language-bash">#注意jenkins配置到192.168.196.5的工作目录：/app/workspace
ssh 192.168.196.5 "rm -rf /app/workspace/*"
scp -r ${WORKSPACE}/target/app.jar 192.168.196.5:/app/workspace/app.jar
ssh 192.168.196.5 "cd /app &amp;&amp; sh app-start.sh"</code></pre> 
<p> <img alt="" height="797" src="https://images2.imgbox.com/c0/63/7O7Zu1UG_o.png" width="1105"></p> 
<p>查看控制台</p> 
<p><img alt="" height="593" src="https://images2.imgbox.com/df/44/Vq0JFQyQ_o.png" width="972"></p> 
<p>以上说明已经部署成功。</p> 
<p>如果远程机使用docker，同样可以写个.sh脚本。</p> 
<p></p> 
<h2 id="%E6%80%BB%E7%BB%93"><a id="_45"></a>总结</h2> 
<p> jenkins是个自动化部署工具，可通过安装各种插件来完成部署。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/be5ff6aea731bf9ec791843edf79b48c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C&#43;&#43;：C&#43;&#43;入门基础|命名空间|输入输出</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ce1c95218a1213bb8e659476be4b4b12/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MySQL篇五：基本查询</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>