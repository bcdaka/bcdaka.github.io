<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Nginx网站服务 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/adb373a6ad9a9c6716fe6a376f093471/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Nginx网站服务">
  <meta property="og:description" content="Nginx网站服务 一、Nginx 服务基础关于Nginx 实验报告资源列表基础环境一、编译安装Nginx安装支持软件创建运行用户、组 二、源码编译及安装1、解包2、配置编译安装3、优化执行路径 三、Nginx 的运行控制1、检查配置文件2、启动、停止 Nginx3、添加 Nginx 系统服务 四、Nginx访问控制1、访问状态统计2、基于账号密码的访问控制3、基于客户端的访问控制 五、Nginx 虚拟主机1、基于域名的虚拟主机2、基于 IP 的虚拟主机3、基于端口的虚拟主机 一、Nginx 服务基础 关于Nginx 一款高性能、轻量级Web服务软件 稳定性高系统资源消耗低对HTTP并发连接的处理能力高 单台物理服务器可支持30 000 ~ 50 000个并发请求 实验报告 资源列表 操作系统配置主机IPCentOS7.3.16112C4Gnginx192.168.72.154 基础环境 关闭防火墙 systemctl stop firewalld systemctl disable firewalld 关闭内核安全机制 setenforce 0 sed -i &#34;s/^SELINUX=.*/SELINUX=disabled/g&#34; /etc/selinux/config 修改主机名 hostnamectl set-hostname nginx 一、编译安装Nginx 安装支持软件 yum -y install pcre-devel zlib-devel gcc&#43;&#43; gcc 创建运行用户、组 useradd -M -s /sbin/nologin nginx # 不创建用户的主目录 # 指定用户的登录shell 二、源码编译及安装 1、解包 tar zxf nginx-1.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-25T22:26:16+08:00">
    <meta property="article:modified_time" content="2024-07-25T22:26:16+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Nginx网站服务</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>Nginx网站服务</h4> 
 <ul><li><a href="#Nginx__1" rel="nofollow">一、Nginx 服务基础</a></li><li><ul><li><a href="#Nginx_2" rel="nofollow">关于Nginx</a></li></ul> 
  </li><li><a href="#_9" rel="nofollow">实验报告</a></li><li><ul><li><a href="#_10" rel="nofollow">资源列表</a></li><li><a href="#_27" rel="nofollow">基础环境</a></li><li><a href="#Nginx_45" rel="nofollow">一、编译安装Nginx</a></li><li><ul><li><a href="#_46" rel="nofollow">安装支持软件</a></li><li><a href="#_51" rel="nofollow">创建运行用户、组</a></li></ul> 
   </li><li><a href="#_58" rel="nofollow">二、源码编译及安装</a></li><li><ul><li><a href="#1_59" rel="nofollow">1、解包</a></li><li><a href="#2_65" rel="nofollow">2、配置编译安装</a></li><li><a href="#3_76" rel="nofollow">3、优化执行路径</a></li></ul> 
   </li><li><a href="#Nginx__82" rel="nofollow">三、Nginx 的运行控制</a></li><li><ul><li><a href="#1_83" rel="nofollow">1、检查配置文件</a></li><li><a href="#2_Nginx_90" rel="nofollow">2、启动、停止 Nginx</a></li><li><a href="#3_Nginx__102" rel="nofollow">3、添加 Nginx 系统服务</a></li></ul> 
   </li><li><a href="#Nginx_140" rel="nofollow">四、Nginx访问控制</a></li><li><ul><li><a href="#1_141" rel="nofollow">1、访问状态统计</a></li><li><a href="#2_154" rel="nofollow">2、基于账号密码的访问控制</a></li><li><a href="#3_180" rel="nofollow">3、基于客户端的访问控制</a></li></ul> 
   </li><li><a href="#Nginx__205" rel="nofollow">五、Nginx 虚拟主机</a></li><li><ul><li><a href="#1_206" rel="nofollow">1、基于域名的虚拟主机</a></li><li><a href="#2_IP__255" rel="nofollow">2、基于 IP 的虚拟主机</a></li><li><a href="#3_312" rel="nofollow">3、基于端口的虚拟主机</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="Nginx__1"></a>一、Nginx 服务基础</h2> 
<h3><a id="Nginx_2"></a>关于Nginx</h3> 
<ul><li>一款高性能、轻量级Web服务软件 
  <ul><li>稳定性高</li><li>系统资源消耗低</li><li>对HTTP并发连接的处理能力高 
    <ul><li>单台物理服务器可支持30 000 ~ 50 000个并发请求</li></ul> </li></ul> </li></ul> 
<h2><a id="_9"></a>实验报告</h2> 
<h3><a id="_10"></a>资源列表</h3> 
<table><tbody><tr><th>操作系统</th><th>配置</th><th>主机</th><th>IP</th></tr><tr><td>CentOS7.3.1611</td><td>2C4G</td><td>nginx</td><td>192.168.72.154</td></tr></tbody></table> 
<h3><a id="_27"></a>基础环境</h3> 
<ul><li>关闭防火墙</li></ul> 
<pre><code class="prism language-python">systemctl stop firewalld
systemctl disable firewalld
</code></pre> 
<ul><li>关闭内核安全机制</li></ul> 
<pre><code class="prism language-python">setenforce <span class="token number">0</span>
sed <span class="token operator">-</span>i <span class="token string">"s/^SELINUX=.*/SELINUX=disabled/g"</span> <span class="token operator">/</span>etc<span class="token operator">/</span>selinux<span class="token operator">/</span>config
</code></pre> 
<ul><li>修改主机名</li></ul> 
<pre><code class="prism language-python">hostnamectl <span class="token builtin">set</span><span class="token operator">-</span>hostname nginx
</code></pre> 
<h3><a id="Nginx_45"></a>一、编译安装Nginx</h3> 
<h4><a id="_46"></a>安装支持软件</h4> 
<pre><code class="prism language-python">yum <span class="token operator">-</span>y install pcre<span class="token operator">-</span>devel zlib<span class="token operator">-</span>devel gcc<span class="token operator">+</span><span class="token operator">+</span> gcc
</code></pre> 
<h4><a id="_51"></a>创建运行用户、组</h4> 
<pre><code class="prism language-python">useradd <span class="token operator">-</span>M <span class="token operator">-</span>s <span class="token operator">/</span>sbin<span class="token operator">/</span>nologin nginx
<span class="token comment"># 不创建用户的主目录</span>
<span class="token comment"># 指定用户的登录shell</span>
</code></pre> 
<h3><a id="_58"></a>二、源码编译及安装</h3> 
<h4><a id="1_59"></a>1、解包</h4> 
<pre><code class="prism language-python">tar zxf nginx<span class="token operator">-</span><span class="token number">1.12</span><span class="token number">.0</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">-</span>C <span class="token operator">/</span>usr<span class="token operator">/</span>src<span class="token operator">/</span>
cd <span class="token operator">/</span>usr<span class="token operator">/</span>src<span class="token operator">/</span>nginx<span class="token operator">-</span><span class="token number">1.12</span><span class="token number">.0</span><span class="token operator">/</span>
</code></pre> 
<h4><a id="2_65"></a>2、配置编译安装</h4> 
<pre><code class="prism language-python"><span class="token punctuation">.</span><span class="token operator">/</span>configure <span class="token operator">-</span><span class="token operator">-</span>prefix<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx <span class="token operator">-</span><span class="token operator">-</span>user<span class="token operator">=</span>nginx <span class="token operator">-</span><span class="token operator">-</span>group<span class="token operator">=</span>nginx <span class="token operator">-</span><span class="token operator">-</span><span class="token keyword">with</span><span class="token operator">-</span>http_stub_status_module
<span class="token comment"># --prefix：指定将 httpd 服务程序安装到哪个目录下，如/usr/local/httpd</span>
<span class="token comment"># --user=nginx：这个选项指定了运行 Nginx 进程的用户</span>
<span class="token comment"># --group=nginx：这个选项指定了运行 Nginx 进程的用户组</span>
<span class="token comment"># --with-http_stub_status_module：这个选项启用了 Nginx 的 HTTP stub_status 模块</span>

make <span class="token operator">&amp;</span><span class="token operator">&amp;</span> make install
</code></pre> 
<h4><a id="3_76"></a>3、优化执行路径</h4> 
<pre><code class="prism language-python">ln <span class="token operator">-</span>s <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>sbin<span class="token operator">/</span>nginx <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>sbin<span class="token operator">/</span>
ls <span class="token operator">-</span>l <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>sbin<span class="token operator">/</span>nginx
</code></pre> 
<h3><a id="Nginx__82"></a>三、Nginx 的运行控制</h3> 
<h4><a id="1_83"></a>1、检查配置文件</h4> 
<pre><code class="prism language-python"><span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># nginx -t</span>
nginx<span class="token punctuation">:</span> the configuration <span class="token builtin">file</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token operator">/</span>nginx<span class="token punctuation">.</span>conf syntax <span class="token keyword">is</span> ok
nginx<span class="token punctuation">:</span> configuration <span class="token builtin">file</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token operator">/</span>nginx<span class="token punctuation">.</span>conf test <span class="token keyword">is</span> successful
</code></pre> 
<h4><a id="2_Nginx_90"></a>2、启动、停止 Nginx</h4> 
<pre><code class="prism language-python"><span class="token punctuation">[</span>root@nginx nginx<span class="token operator">-</span><span class="token number">1.12</span><span class="token number">.0</span><span class="token punctuation">]</span><span class="token comment"># ls /usr/local/nginx/</span>
conf  html  logs  sbin
<span class="token punctuation">[</span>root@nginx nginx<span class="token operator">-</span><span class="token number">1.12</span><span class="token number">.0</span><span class="token punctuation">]</span><span class="token comment"># /usr/local/nginx/sbin/nginx         # 启动 Nginx 服务器</span>
<span class="token punctuation">[</span>root@nginx nginx<span class="token operator">-</span><span class="token number">1.12</span><span class="token number">.0</span><span class="token punctuation">]</span><span class="token comment"># ss -nlpt | grep 80</span>
LISTEN     <span class="token number">0</span>      <span class="token number">128</span>          <span class="token operator">*</span><span class="token punctuation">:</span><span class="token number">80</span>                       <span class="token operator">*</span><span class="token punctuation">:</span><span class="token operator">*</span>                   users<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"nginx"</span><span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">12266</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">"nginx"</span><span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">12265</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 启动 Nginx 服务器之后打开浏览器访问 192.168.72.154</span>
<span class="token punctuation">[</span>root@nginx nginx<span class="token operator">-</span><span class="token number">1.12</span><span class="token number">.0</span><span class="token punctuation">]</span><span class="token comment"># /usr/local/nginx/sbin/nginx -s stop        # 停止 Nginx 服务器</span>
<span class="token punctuation">[</span>root@nginx nginx<span class="token operator">-</span><span class="token number">1.12</span><span class="token number">.0</span><span class="token punctuation">]</span><span class="token comment"># ss -nlpt | grep 80</span>
</code></pre> 
<h4><a id="3_Nginx__102"></a>3、添加 Nginx 系统服务</h4> 
<pre><code class="prism language-python"><span class="token punctuation">[</span>root@nginx nginx<span class="token operator">-</span><span class="token number">1.12</span><span class="token number">.0</span><span class="token punctuation">]</span><span class="token comment"># vi /etc/init.d/nginx</span>
<span class="token punctuation">[</span>root@nginx nginx<span class="token operator">-</span><span class="token number">1.12</span><span class="token number">.0</span><span class="token punctuation">]</span><span class="token comment"># cat /etc/init.d/nginx</span>
<span class="token comment">#!/bin/bash</span>
<span class="token comment"># 必须在运行级2，3，4，5下被启动或关闭，启动的优先级是90，关闭的优先级是10</span>
<span class="token comment"># 90是启动优先级，10是停止优先级，优先级范围是0－100，数字越大，优先级越低</span>
<span class="token comment">#chkconfig: 2345 10 90</span>
<span class="token comment">#description:Nginx Service Control Script</span>
PROG<span class="token operator">=</span><span class="token string">"/usr/local/nginx/sbin/nginx"</span>
PIDF<span class="token operator">=</span><span class="token string">"/usr/local/nginx/logs/nginx.pid"</span>
<span class="token keyword">case</span> <span class="token string">"$1"</span> <span class="token keyword">in</span>
    start<span class="token punctuation">)</span>
        $PROG
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    stop<span class="token punctuation">)</span>
        kill <span class="token operator">-</span>s QUIT $<span class="token punctuation">(</span>cat $PIDF<span class="token punctuation">)</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    restart<span class="token punctuation">)</span>
        $<span class="token number">0</span> stop
        $<span class="token number">0</span> start
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token builtin">reload</span><span class="token punctuation">)</span>
        kill <span class="token operator">-</span>s HUP $<span class="token punctuation">(</span>cat $PIDF<span class="token punctuation">)</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">)</span>
        echo <span class="token string">"Usage: $0 {start|stop|restart|reload}"</span>
        exit <span class="token number">1</span>
esac
exit <span class="token number">0</span>



chmod <span class="token operator">+</span>x <span class="token operator">/</span>etc<span class="token operator">/</span>init<span class="token punctuation">.</span>d<span class="token operator">/</span>nginx
chkconfig <span class="token operator">-</span><span class="token operator">-</span>add nginx
systemctl status nginx
</code></pre> 
<h3><a id="Nginx_140"></a>四、Nginx访问控制</h3> 
<h4><a id="1_141"></a>1、访问状态统计</h4> 
<pre><code class="prism language-python"><span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># vi /usr/local/nginx/conf/nginx.conf</span>
<span class="token comment"># 在 46 行 localhost 下添加以下内容</span>
        location <span class="token operator">/</span>status <span class="token punctuation">{<!-- --></span>
            stub_status on<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># nginx -t</span>
nginx<span class="token punctuation">:</span> the configuration <span class="token builtin">file</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token operator">/</span>nginx<span class="token punctuation">.</span>conf syntax <span class="token keyword">is</span> ok
nginx<span class="token punctuation">:</span> configuration <span class="token builtin">file</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token operator">/</span>nginx<span class="token punctuation">.</span>conf test <span class="token keyword">is</span> successful
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># systemctl start nginx</span>
</code></pre> 
<h4><a id="2_154"></a>2、基于账号密码的访问控制</h4> 
<pre><code class="prism language-python">yum install <span class="token operator">-</span>y httpd<span class="token operator">-</span>tools
htpasswd <span class="token operator">-</span>c <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>passwd<span class="token punctuation">.</span>db test
<span class="token comment"># 设置密码为123</span>

<span class="token comment"># 更改权限为 400</span>
chmod <span class="token number">400</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>passwd<span class="token punctuation">.</span>db
chown nginx <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>passwd<span class="token punctuation">.</span>db
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># ll -d /usr/local/nginx/passwd.db</span>
<span class="token operator">-</span>r<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token number">1</span> nginx root <span class="token number">43</span> <span class="token number">7</span>月  <span class="token number">16</span> <span class="token number">09</span><span class="token punctuation">:</span><span class="token number">46</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>passwd<span class="token punctuation">.</span>db

<span class="token comment"># 修改主配置文件 nginx.conf</span>
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># vi /usr/local/nginx/conf/nginx.conf</span>
<span class="token comment"># 在 47 行 localhost 里添加以下内容</span>
    auth_basic <span class="token string">"secret"</span><span class="token punctuation">;</span>   <span class="token comment"># 添加认证</span>
    auth_basic_user_file <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>passwd<span class="token punctuation">.</span>db<span class="token punctuation">;</span> <span class="token comment"># 指定认证的账户密码文件    </span>

<span class="token comment"># 检测语法、重启服务</span>
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># nginx -t</span>
nginx<span class="token punctuation">:</span> the configuration <span class="token builtin">file</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token operator">/</span>nginx<span class="token punctuation">.</span>conf syntax <span class="token keyword">is</span> ok
nginx<span class="token punctuation">:</span> configuration <span class="token builtin">file</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token operator">/</span>nginx<span class="token punctuation">.</span>conf test <span class="token keyword">is</span> successful
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># systemctl restart nginx</span>
<span class="token comment"># 客户端浏览器访问 192.168.72.154/status</span>
</code></pre> 
<h4><a id="3_180"></a>3、基于客户端的访问控制</h4> 
<pre><code class="prism language-python"><span class="token comment"># deny IP/IP 段：拒绝某个 IP 或 IP 段的客户端访问。</span>
<span class="token comment"># allow IP/IP 段：允许某个 IP 或 IP 段的客户端访问。</span>

<span class="token comment"># 修改主配置文件 nginx.conf</span>
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># vi /usr/local/nginx/conf/nginx.conf</span>
<span class="token comment"># 在 47 行 localhost 里添加以下内容</span>
    deny <span class="token number">192.168</span><span class="token number">.72</span><span class="token number">.1</span><span class="token punctuation">;</span>
    allow <span class="token builtin">all</span><span class="token punctuation">;</span>         

<span class="token comment"># 检测语法、重启服务</span>
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># nginx -t</span>
nginx<span class="token punctuation">:</span> the configuration <span class="token builtin">file</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token operator">/</span>nginx<span class="token punctuation">.</span>conf syntax <span class="token keyword">is</span> ok
nginx<span class="token punctuation">:</span> configuration <span class="token builtin">file</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token operator">/</span>nginx<span class="token punctuation">.</span>conf test <span class="token keyword">is</span> successful
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># systemctl restart nginx</span>
<span class="token comment"># 客户端浏览器访问 192.168.72.154/status 已经访问不到了</span>
<span class="token comment"># 在本机访问</span>
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># curl 192.168.72.154/status</span>
Active connections<span class="token punctuation">:</span> <span class="token number">1</span> 
server accepts handled requests
 <span class="token number">5</span> <span class="token number">5</span> <span class="token number">7</span> 
Reading<span class="token punctuation">:</span> <span class="token number">0</span> Writing<span class="token punctuation">:</span> <span class="token number">1</span> Waiting<span class="token punctuation">:</span> <span class="token number">0</span> 
</code></pre> 
<h3><a id="Nginx__205"></a>五、Nginx 虚拟主机</h3> 
<h4><a id="1_206"></a>1、基于域名的虚拟主机</h4> 
<pre><code class="prism language-python"><span class="token comment"># 修改主配置文件 nginx.conf</span>
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># vi /usr/local/nginx/conf/nginx.conf</span>
<span class="token comment"># 在 33 行 #gizp on; 下里添加以下内容</span>
    server <span class="token punctuation">{<!-- --></span>
        listen       <span class="token number">80</span><span class="token punctuation">;</span>
        server_name  www<span class="token punctuation">.</span>kgc01<span class="token punctuation">.</span>com<span class="token punctuation">;</span>
        location <span class="token operator">/</span> <span class="token punctuation">{<!-- --></span>
            root   html<span class="token operator">/</span>kgc01<span class="token punctuation">;</span>
            index  index<span class="token punctuation">.</span>html index<span class="token punctuation">.</span>htm<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
    server <span class="token punctuation">{<!-- --></span>
        listen       <span class="token number">80</span><span class="token punctuation">;</span>
        server_name  www<span class="token punctuation">.</span>kgc02<span class="token punctuation">.</span>com<span class="token punctuation">;</span>
        location <span class="token operator">/</span> <span class="token punctuation">{<!-- --></span>
            root   html<span class="token operator">/</span>kgc02<span class="token punctuation">;</span>
            index  index<span class="token punctuation">.</span>html index<span class="token punctuation">.</span>htm<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># ls /usr/local/nginx/html/</span>
50x<span class="token punctuation">.</span>html  index<span class="token punctuation">.</span>html
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># mkdir /usr/local/nginx/html/kgc01</span>
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># mkdir /usr/local/nginx/html/kgc02</span>
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># echo 'This is kgc01' &gt; /usr/local/nginx/html/kgc01/index.html</span>
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># echo 'This is kgc02' &gt; /usr/local/nginx/html/kgc02/index.html</span>

<span class="token comment"># 检测语法、重启服务 </span>
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># nginx -t</span>
nginx<span class="token punctuation">:</span> the configuration <span class="token builtin">file</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token operator">/</span>nginx<span class="token punctuation">.</span>conf syntax <span class="token keyword">is</span> ok
nginx<span class="token punctuation">:</span> configuration <span class="token builtin">file</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token operator">/</span>nginx<span class="token punctuation">.</span>conf test <span class="token keyword">is</span> successful
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># systemctl restart nginx</span>

<span class="token comment"># 添加 hosts 映射</span>
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># vi /etc/hosts</span>
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># cat /etc/hosts</span>
<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>   localhost localhost<span class="token punctuation">.</span>localdomain localhost4 localhost4<span class="token punctuation">.</span>localdomain4
<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">1</span>         localhost localhost<span class="token punctuation">.</span>localdomain localhost6 localhost6<span class="token punctuation">.</span>localdomain6
<span class="token number">192.168</span><span class="token number">.72</span><span class="token number">.154</span> www<span class="token punctuation">.</span>kgc01<span class="token punctuation">.</span>com www<span class="token punctuation">.</span>kgc02<span class="token punctuation">.</span>com

<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># curl www.kgc01.com</span>
This <span class="token keyword">is</span> kgc01
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># curl www.kgc02.com</span>
This <span class="token keyword">is</span> kgc02
</code></pre> 
<h4><a id="2_IP__255"></a>2、基于 IP 的虚拟主机</h4> 
<pre><code class="prism language-python"><span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># ifconfig ens33</span>

ens33<span class="token punctuation">:</span> flags<span class="token operator">=</span><span class="token number">4163</span><span class="token operator">&lt;</span>UP<span class="token punctuation">,</span>BROADCAST<span class="token punctuation">,</span>RUNNING<span class="token punctuation">,</span>MULTICAST<span class="token operator">&gt;</span>  mtu <span class="token number">1500</span>
        inet <span class="token number">192.168</span><span class="token number">.72</span><span class="token number">.154</span>  netmask <span class="token number">255.255</span><span class="token number">.255</span><span class="token number">.0</span>  broadcast <span class="token number">192.168</span><span class="token number">.72</span><span class="token number">.255</span>
        inet6 fe80<span class="token punctuation">:</span><span class="token punctuation">:</span>a0df<span class="token punctuation">:</span>8b6<span class="token punctuation">:</span>704a<span class="token punctuation">:</span><span class="token number">2632</span>  prefixlen <span class="token number">64</span>  scopeid <span class="token number">0x20</span><span class="token operator">&lt;</span>link<span class="token operator">&gt;</span>
        ether <span class="token number">00</span><span class="token punctuation">:</span>0c<span class="token punctuation">:</span><span class="token number">29</span><span class="token punctuation">:</span>c9<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>b1  txqueuelen <span class="token number">1000</span>  <span class="token punctuation">(</span>Ethernet<span class="token punctuation">)</span>
        RX packets <span class="token number">64702</span>  <span class="token builtin">bytes</span> <span class="token number">85119679</span> <span class="token punctuation">(</span><span class="token number">81.1</span> MiB<span class="token punctuation">)</span>
        RX errors <span class="token number">0</span>  dropped <span class="token number">0</span>  overruns <span class="token number">0</span>  frame <span class="token number">0</span>
        TX packets <span class="token number">10465</span>  <span class="token builtin">bytes</span> <span class="token number">1088462</span> <span class="token punctuation">(</span><span class="token number">1.0</span> MiB<span class="token punctuation">)</span>
        TX errors <span class="token number">0</span>  dropped <span class="token number">0</span> overruns <span class="token number">0</span>  carrier <span class="token number">0</span>  collisions <span class="token number">0</span>


<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># ifconfig ens33:0 192.168.72.110</span>


<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># ifconfig ens33:0</span>

ens33<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">:</span> flags<span class="token operator">=</span><span class="token number">4163</span><span class="token operator">&lt;</span>UP<span class="token punctuation">,</span>BROADCAST<span class="token punctuation">,</span>RUNNING<span class="token punctuation">,</span>MULTICAST<span class="token operator">&gt;</span>  mtu <span class="token number">1500</span>
        inet <span class="token number">192.168</span><span class="token number">.72</span><span class="token number">.110</span>  netmask <span class="token number">255.255</span><span class="token number">.255</span><span class="token number">.0</span>  broadcast <span class="token number">192.168</span><span class="token number">.72</span><span class="token number">.255</span>
        ether <span class="token number">00</span><span class="token punctuation">:</span>0c<span class="token punctuation">:</span><span class="token number">29</span><span class="token punctuation">:</span>c9<span class="token punctuation">:</span>ff<span class="token punctuation">:</span>b1  txqueuelen <span class="token number">1000</span>  <span class="token punctuation">(</span>Ethernet<span class="token punctuation">)</span>
                  

<span class="token comment"># 修改主配置文件 nginx.conf</span>
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># vi /usr/local/nginx/conf/nginx.conf</span>
<span class="token comment"># 在 33 行 #gizp on; 下里添加以下内容</span>
    server <span class="token punctuation">{<!-- --></span>
        listen       <span class="token number">192.168</span><span class="token number">.72</span><span class="token number">.154</span><span class="token punctuation">;</span>
        server_name  <span class="token number">192.168</span><span class="token number">.72</span><span class="token number">.154</span><span class="token punctuation">;</span>
        location <span class="token operator">/</span> <span class="token punctuation">{<!-- --></span>
            root   html<span class="token operator">/</span>kgc01<span class="token punctuation">;</span>
            index  index<span class="token punctuation">.</span>html index<span class="token punctuation">.</span>htm<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
    server <span class="token punctuation">{<!-- --></span>
        listen       <span class="token number">192.168</span><span class="token number">.72</span><span class="token number">.110</span><span class="token punctuation">;</span>
        server_name  <span class="token number">192.168</span><span class="token number">.72</span><span class="token number">.110</span><span class="token punctuation">;</span>
        location <span class="token operator">/</span> <span class="token punctuation">{<!-- --></span>
            root   html<span class="token operator">/</span>kgc02<span class="token punctuation">;</span>
            index  index<span class="token punctuation">.</span>html index<span class="token punctuation">.</span>htm<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
                   
<span class="token comment"># 检测语法、重启服务 </span>
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># nginx -t</span>
nginx<span class="token punctuation">:</span> the configuration <span class="token builtin">file</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token operator">/</span>nginx<span class="token punctuation">.</span>conf syntax <span class="token keyword">is</span> ok
nginx<span class="token punctuation">:</span> configuration <span class="token builtin">file</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token operator">/</span>nginx<span class="token punctuation">.</span>conf test <span class="token keyword">is</span> successful
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># systemctl restart nginx</span>
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># curl 192.168.72.154</span>
This <span class="token keyword">is</span> kgc01
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># curl 192.168.72.110</span>
This <span class="token keyword">is</span> kgc02
</code></pre> 
<h4><a id="3_312"></a>3、基于端口的虚拟主机</h4> 
<pre><code class="prism language-python"><span class="token comment"># 修改主配置文件 nginx.conf</span>
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># vi /usr/local/nginx/conf/nginx.conf</span>
<span class="token comment"># 在 33 行 #gizp on; 下里添加以下内容</span>
    server <span class="token punctuation">{<!-- --></span>
        listen       <span class="token number">192.168</span><span class="token number">.72</span><span class="token number">.154</span><span class="token punctuation">:</span><span class="token number">81</span><span class="token punctuation">;</span>
        server_name  <span class="token number">192.168</span><span class="token number">.72</span><span class="token number">.154</span><span class="token punctuation">:</span><span class="token number">81</span><span class="token punctuation">;</span>
        location <span class="token operator">/</span> <span class="token punctuation">{<!-- --></span>
            root   html<span class="token operator">/</span>kgc01<span class="token punctuation">;</span>
            index  index<span class="token punctuation">.</span>html index<span class="token punctuation">.</span>htm<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
    server <span class="token punctuation">{<!-- --></span>
        listen       <span class="token number">192.168</span><span class="token number">.72</span><span class="token number">.110</span><span class="token punctuation">:</span><span class="token number">82</span><span class="token punctuation">;</span>
        server_name  <span class="token number">192.168</span><span class="token number">.72</span><span class="token number">.110</span><span class="token punctuation">:</span><span class="token number">82</span><span class="token punctuation">;</span>
        location <span class="token operator">/</span> <span class="token punctuation">{<!-- --></span>
            root   html<span class="token operator">/</span>kgc02<span class="token punctuation">;</span>
            index  index<span class="token punctuation">.</span>html index<span class="token punctuation">.</span>htm<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>


<span class="token comment"># 检测语法、重启服务 </span>
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># nginx -t</span>
nginx<span class="token punctuation">:</span> the configuration <span class="token builtin">file</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token operator">/</span>nginx<span class="token punctuation">.</span>conf syntax <span class="token keyword">is</span> ok
nginx<span class="token punctuation">:</span> configuration <span class="token builtin">file</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token operator">/</span>nginx<span class="token punctuation">.</span>conf test <span class="token keyword">is</span> successful
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># systemctl restart nginx</span>
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># curl 192.168.72.154:81</span>
This <span class="token keyword">is</span> kgc01
<span class="token punctuation">[</span>root@nginx <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># curl 192.168.72.110:82</span>
This <span class="token keyword">is</span> kgc02
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8c7d9e90e3937492291f17f1fdf4edb8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Vscode——如何快速搜索项目工程中的某个文件的位置</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f181074161860971627d619ce442598b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Vue3 &#43; Vite 打包引入图片错误</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>