<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Kafka 命令行操作 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/3023c69fff78a52f300eee4b23da3a01/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Kafka 命令行操作">
  <meta property="og:description" content="版本：3.6.1
1 kafka-topics.sh Create, delete, describe, or change a topic.
创建、删除、描述或更改主题。
Option(选项)Description(描述)翻译–alterAlter the number of partitions and replica assignment. Update the configuration of an existing topic via --alter is no longer supported here (the kafka-configs CLI supports altering topic configs with a --bootstrap-server option).更改分区数和副本分配。此处不再支持通过–alter更新现有主题的配置（kafka configs CLI支持使用–bootstrap server选项更改主题配置）。–at-min-isr-partitionsIf set when describing topics, only show partitions whose isr count is equal to the configured minimum.如果在描述主题时设置，则仅显示isr计数等于配置的最小值的分区。–bootstrap-server &lt;String: server to connect to&gt;REQUIRED: The Kafka server to connect to.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-12T13:35:41+08:00">
    <meta property="article:modified_time" content="2024-01-12T13:35:41+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Kafka 命令行操作</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>版本：3.6.1</p> 
<h3><a id="1_kafkatopicssh_2"></a>1 kafka-topics.sh</h3> 
<p>Create, delete, describe, or change a topic.</p> 
<p>创建、删除、描述或更改主题。</p> 
<table><thead><tr><th>Option(选项)</th><th>Description(描述)</th><th>翻译</th></tr></thead><tbody><tr><td>–alter</td><td>Alter the number of partitions and replica assignment. Update the configuration of an existing topic via --alter is no longer supported here (the kafka-configs CLI supports altering topic configs with a --bootstrap-server option).</td><td>更改分区数和副本分配。此处不再支持通过–alter更新现有主题的配置（kafka configs CLI支持使用–bootstrap server选项更改主题配置）。</td></tr><tr><td>–at-min-isr-partitions</td><td>If set when describing topics, only show partitions whose isr count is equal to the configured minimum.</td><td>如果在描述主题时设置，则仅显示isr计数等于配置的最小值的分区。</td></tr><tr><td>–bootstrap-server &lt;String: server to connect to&gt;</td><td>REQUIRED: The Kafka server to connect to.</td><td>必需：要连接的Kafka服务器。</td></tr><tr><td>–command-config &lt;String: command config property file&gt;</td><td>Property file containing configs to be passed to Admin Client. This is used only with --bootstrap-server option for describing and altering broker configs.</td><td>包含要传递给管理客户端的配置的属性文件。这仅与–bootstrap服务器选项一起使用，用于描述和更改代理配置。</td></tr><tr><td>–config &lt;String: name=value&gt;</td><td>A topic configuration override for the topic being created or altered.</td><td>正在创建或更改的主题的主题配置覆盖。</td></tr><tr><td>–create</td><td>Create a new topic.</td><td>创建一个新的主题。</td></tr><tr><td>–delete</td><td>Delete a topic.</td><td>删除一个主题。</td></tr><tr><td>–delete-config &lt;String: name&gt;</td><td>A topic configuration override to be removed for an existing topic (see the list of configurations under the --config option). Not supported with the --bootstrap-server option.</td><td>为现有主题删除主题配置。（请参阅–config选项下的配置列表）。不支持–bootstrap-server选项。</td></tr><tr><td>–describe</td><td>List details for the given topics.</td><td>列出给定主题的详细信息。</td></tr><tr><td>–exclude-internal</td><td>Exclude internal topics when running list or describe command. The internal topics will be listed by default.</td><td>运行list或describe命令时排除内部主题。默认情况下会列出内部主题。</td></tr><tr><td>–help</td><td>Print usage information.</td><td>打印使用信息。</td></tr><tr><td>–if-exists</td><td>if set when altering or deleting or describing topics, the action will only execute if the topic exists.</td><td>如果在更改、删除或描述主题时设置，则仅当主题存在时才会执行该操作。</td></tr><tr><td>–if-not-exists</td><td>If set when creating topics, the action will only execute if the topic does not already exist.</td><td>如果在创建主题时设置，则仅当主题不存在时才会执行该操作。</td></tr><tr><td>–list</td><td>List all available topics.</td><td>列出所有可用的主题。</td></tr><tr><td>–partitions &lt;Integer: # of partitions&gt;</td><td>The number of partitions for the topic being created or altered (WARNING: If partitions are increased for a topic that has a key, the partition logic or ordering of the messages will be affected). If not supplied for create, defaults to the cluster default.</td><td>正在创建或更改的主题的分区数（警告：如果为具有键的主题增加分区，则分区逻辑或消息顺序将受到影响）。如果未提供用于创建，则默认为集群默认值。</td></tr><tr><td>–replica-assignment &lt;String: broker_id_for_part1_replica1 : broker_id_for_part1_replica2 , broker_id_for_part2_replica1 : broker_id_for_part2_replica2 , …&gt;</td><td>A list of manual partition-to-broker assignments for the topic being created or altered.</td><td>为正在创建或更改的主题分配给代理程序的手动分区列表。</td></tr><tr><td>–replication-factor &lt;Integer: replication factor&gt;</td><td>The replication factor for each partition in the topic being created. If not supplied, defaults to the cluster default.</td><td>正在创建的主题中每个分区的副本。如果未提供，则默认为集群默认值。</td></tr><tr><td>–topic &lt;String: topic&gt;</td><td>The topic to create, alter, describe or delete. It also accepts a regular expression, except for --create option. Put topic name in double quotes and use the ‘’ prefix to escape regular expression symbols; e.g. “test.topic”.</td><td>要创建、更改、描述或删除的主题。它还接受一个正则表达式，但–create选项除外。将主题名称置于双引号中，并使用“\”前缀转义正则表达式符号；例如“test.topic”。</td></tr><tr><td>–topic-id &lt;String: topic-id&gt;</td><td>The topic-id to describe.This is used only with --bootstrap-server option for describing topics.</td><td>要描述的主题id。这仅与用于描述主题的–bootstrap-server选项一起使用。</td></tr><tr><td>–topics-with-overrides</td><td>If set when describing topics, only show topics that have overridden configs.</td><td>如果在描述主题时设置，则仅显示已重写配置的主题。</td></tr><tr><td>–unavailable-partitions</td><td>If set when describing topics, only show partitions whose leader is not available.</td><td>如果在描述主题时设置，则仅显示其leader不可用的分区。</td></tr><tr><td>–under-min-isr-partitions</td><td>If set when describing topics, only show partitions whose isr count is less than the configured minimum.</td><td>如果在描述主题时设置，则仅显示isr计数小于配置的最小值的分区。</td></tr><tr><td>–under-replicated-partitions</td><td>If set when describing topics, only show under replicated partitions.</td><td>如果在描述主题时设置，则仅显示已复制分区</td></tr><tr><td>–version</td><td>Display Kafka version.</td><td>显示Kafka版本。</td></tr></tbody></table> 
<h4><a id="11_topic_37"></a>1.1 查看所有topic</h4> 
<pre><code class="prism language-sh">kafka-topics.sh --bootstrap-server centos701:9092,centos702:9092,centos704:9092 <span class="token parameter variable">--list</span>
</code></pre> 
<h4><a id="12_topic_43"></a>1.2 创建topic</h4> 
<pre><code class="prism language-sh">kafka-topics.sh --bootstrap-server centos701:9092,centos702:9092,centos704:9092 <span class="token parameter variable">--create</span> <span class="token parameter variable">--partitions</span> <span class="token number">1</span> --replication-factor <span class="token number">3</span> <span class="token parameter variable">--topic</span> first
</code></pre> 
<p>–topic 定义topic名</p> 
<p>–replication-factor 定义副本数</p> 
<p>–partitions 定义分区数</p> 
<h4><a id="13_topic_55"></a>1.3 描述topic详情</h4> 
<pre><code class="prism language-sh">kafka-topics.sh --bootstrap-server centos701:9092,centos702:9092,centos704:9092 <span class="token parameter variable">--describe</span> <span class="token parameter variable">--topic</span> first
</code></pre> 
<h4><a id="14_topic_61"></a>1.4 修改topic分区数</h4> 
<pre><code class="prism language-sh">kafka-topics.sh --bootstrap-server centos701:9092,centos702:9092,centos704:9092 <span class="token parameter variable">--alter</span> <span class="token parameter variable">--topic</span> first <span class="token parameter variable">--partitions</span> <span class="token number">3</span>
</code></pre> 
<h4><a id="15_topic_67"></a>1.5 删除topic</h4> 
<pre><code class="prism language-sh">kafka-topics.sh --bootstrap-server centos701:9092,centos702:9092,centos704:9092 <span class="token parameter variable">--delete</span> <span class="token parameter variable">--topic</span> first
</code></pre> 
<h3><a id="2_kafkaconsoleproducersh_73"></a>2 kafka-console-producer.sh</h3> 
<p>This tool helps to read data from standard input and publish it to Kafka.</p> 
<p>该工具从标准输入中读取数据并将其发布到Kafka。</p> 
<table><thead><tr><th>Option(选项)</th><th>Description(描述)</th><th>翻译</th></tr></thead><tbody><tr><td>–batch-size &lt;Integer: size&gt;</td><td>Number of messages to send in a single batch if they are not being sent synchronously. please note that this option will be replaced if max-partition-memory-bytes is also set (default: 16384)</td><td>如果不是同步发送，则在单个批处理中发送的消息数。请注意，如果还设置了最大分区内存字节数(max-partition-memory-bytes)（默认值：16384），则此选项将被替换</td></tr><tr><td>–bootstrap-server &lt;String: server to connect to&gt;</td><td>REQUIRED unless --broker-list(deprecated) is specified. The server(s) to connect to. The broker list string in the form HOST1:PORT1,HOST2:PORT2.</td><td>必需，除非指定了–broker-list（已弃用）。要连接到的服务器。形式为HOST1:PORT1,HOST2:PORT2的broker列表字符串。</td></tr><tr><td>–broker-list &lt;String: broker-list&gt;</td><td>DEPRECATED, use --bootstrap-server instead; ignored if --bootstrap-server is specified. The broker list string in the form HOST1:PORT1,HOST2:PORT2.</td><td>已弃用，请改用–bootstrap-server；如果指定了–bootstrap-server，则忽略。形式为HOST1:PORT1,HOST2:PORT2的broker列表字符串。</td></tr><tr><td>–compression-codec [String:compression-codec]</td><td>The compression codec: either ‘none’, ‘gzip’, ‘snappy’, ‘lz4’, or ‘zstd’.If specified without value, then it defaults to ‘gzip’</td><td>压缩编解码器：“none”、“gzip”、“snappy”、“lz4”或“zstd”。如果未指定值，则默认为“gzip”</td></tr><tr><td>–help</td><td>Print usage information.</td><td>打印使用信息。</td></tr><tr><td>–line-reader &lt;String: reader_class&gt;</td><td>The class name of the class to use for reading lines from standard in. By default each line is read as a separate message. (default: kafka.tools.ConsoleProducer$LineMessageReader)</td><td>用于从中的标准读取行的类的类名。默认情况下，每一行都作为一条单独的消息读取。（默认值：kafka.tools.ConsoleProducer$LineMessageReader）</td></tr><tr><td>–max-block-ms &lt;Long: max block on send&gt;</td><td>The max time that the producer will block for during a send request.(default: 60000)</td><td>生产者在发送请求期间阻止的最长时间。（默认值：60000）</td></tr><tr><td>–max-memory-bytes &lt;Long: total memory in bytes&gt;</td><td>The total memory used by the producer to buffer records waiting to be sent to the server. This is the option to control <code>buffer.memory</code> in producer configs. (default: 33554432)</td><td>生产者用于缓冲等待发送到服务器的记录的总内存。这是在生产者配置中控制“buffer.memory”的选项。（默认值：33554432）</td></tr><tr><td>–max-partition-memory-bytes &lt;Integer: memory in bytes per partition&gt;</td><td>The buffer size allocated for a partition. When records are received which are smaller than this size the producer will attempt to optimistically group them together until this size is reached. This is the option to control <code>batch.size</code> in producer configs. (default: 16384)</td><td>为一个分区分配的缓冲区大小。当接收到小于此大小的记录时，生产者将尝试乐观地将它们组合在一起，直到达到此大小。这是在生产者配置中控制<code>batch.size</code>的选项。（默认值：16384）</td></tr><tr><td>–message-send-max-retries </td><td>Brokers can fail receiving the message for multiple reasons, and being unavailable transiently is just one of them. This property specifies the number of retries before the producer give up and drop this message. This is the option to control <code>retries</code> in producer configs. (default: 3)</td><td>Brokers可能由于多种原因无法接收消息，而暂时不可用只是其中之一。此属性指定生产者放弃并丢弃此消息之前的重试次数。这是在生产者配置中控制·retries·的选项。（默认值：3）</td></tr><tr><td>–metadata-expiry-ms &lt;Long: metadata expiration interval&gt;</td><td>The period of time in milliseconds after which we force a refresh of metadata even if we haven’t seen any leadership changes. This is the option to control <code>metadata.max.age.ms</code> in producer configs. (default:300000)</td><td>以毫秒为单位的一段时间，在此之后，即使我们没有看到任何领导层变动，我们也会强制刷新元数据。这是在生产者配置中控制<code>metadata.max.age.ms</code>的选项。（默认值：300000）</td></tr><tr><td>–producer-property &lt;String: producer_prop&gt;</td><td>A mechanism to pass user-defined properties in the form key=value to the producer.</td><td>将key=value形式的用户定义属性传递给生产者的机制。</td></tr><tr><td>–producer.config &lt;String: config file&gt;</td><td>Producer config properties file. Note that [producer-property] takes precedence over this config.</td><td>生产者配置属性文件。请注意，[producer-property]优先于此配置。</td></tr><tr><td>–property &lt;String: prop&gt;</td><td>A mechanism to pass user-defined properties in the form key=value to the message reader. This allows custom configuration for a user-defined message reader.</td><td>将key=value形式的用户定义属性传递给消息读取器的机制。这允许对用户定义的消息读取器进行自定义配置。</td></tr><tr><td>–reader-config &lt;String: config file&gt;</td><td>Config properties file for the message reader. Note that [property] takes precedence over this config.</td><td>配置消息读取器的属性文件。请注意，[property]优先于此配置。</td></tr><tr><td>–request-required-acks &lt;String: request required acks&gt;</td><td>The required <code>acks</code> of the producer requests (default: -1)</td><td>生产者请求所需的“acks”（默认值：-1）</td></tr><tr><td>–request-timeout-ms &lt;Integer: request timeout ms&gt;</td><td>The ack timeout of the producer requests. Value must be non-negative and non-zero. (default: 1500)</td><td>生产者请求的ack超时。值必须为非负且非零。（默认值：1500）</td></tr><tr><td>–retry-backoff-ms </td><td>Before each retry, the producer refreshes the metadata of relevant topics. Since leader election takes a bit of time, this property specifies the amount of time that the producer waits before refreshing the metadata. This is the option to control <code>retry.backoff.ms</code> in producer configs. (default: 100)</td><td>每次重试之前，生产者都会刷新相关主题的元数据。由于leader选举需要一些时间，因此此属性指定生产者在刷新元数据之前等待的时间。这是在生产者配置中控制“retry.backoff.ms”的选项。（默认值：100）</td></tr><tr><td>–socket-buffer-size &lt;Integer: size&gt;</td><td>The size of the tcp RECV size. This is the option to control <code>send.buffer.bytes</code> in producer configs. (default: 102400)</td><td>tcp RECV size的大小。这是在生产者配置中控制“send.buffer.bytes”的选项。（默认值：102400）</td></tr><tr><td>–sync</td><td>If set message send requests to the brokers are synchronously, one at a time as they arrive.</td><td>如果设置消息发送请求到brokers是同步的，则在它们到达时一次一个。</td></tr><tr><td>–timeout &lt;Long: timeout_ms&gt;</td><td>If set and the producer is running in asynchronous mode, this gives the maximum amount of time a message will queue awaiting sufficient batch size. The value is given in ms. This is the option to control <code>linger.ms</code> in producer configs. (default: 1000)</td><td>如果设置了，并且生产者以异步模式运行，这将为消息排队等待足够的批处理大小提供最长时间。该值以毫秒为单位。这是在生产者配置中控制<code>linger.ms</code>的选项`。（默认值：1000）</td></tr><tr><td>–topic &lt;String: topic&gt;</td><td>REQUIRED: The topic id to produce messages to.</td><td>REQUIRED:要向其生成消息的主题id。</td></tr><tr><td>–version</td><td>Display Kafka version.</td><td>显示Kafka版本。</td></tr></tbody></table> 
<h4><a id="21__105"></a>2.1 发送消息</h4> 
<pre><code class="prism language-sh">kafka-console-producer.sh --bootstrap-server centos701:9092,centos702:9092,centos704:9092 <span class="token parameter variable">--topic</span> first
</code></pre> 
<h3><a id="3_kafkaconsoleconsumersh_111"></a>3 kafka-console-consumer.sh</h3> 
<p>This tool helps to read data from Kafka topics and outputs it to standard output.</p> 
<p>该工具读取Kafka主题中的数据，并将其输出到标准输出。</p> 
<table><thead><tr><th>Option(选项)</th><th>Description(描述)</th><th>翻译</th></tr></thead><tbody><tr><td>–bootstrap-server &lt;String: server to connect to&gt;</td><td>REQUIRED: The server(s) to connect to.</td><td>必需：要连接到的服务器。</td></tr><tr><td>–consumer-property &lt;String: consumer_prop&gt;</td><td>A mechanism to pass user-defined properties in the form key=value to the consumer.</td><td>将key=value形式的用户定义属性传递给消费者的机制。</td></tr><tr><td>–consumer.config &lt;String: config file&gt;</td><td>Consumer config properties file. Note that [consumer-property] takes precedence over this config.</td><td>消费者配置属性文件。请注意，[consumer-property]优先于此配置。</td></tr><tr><td>–enable-systest-events</td><td>Log lifecycle events of the consumer in addition to logging consumed messages. (This is specific for system tests.)</td><td>除了记录所消费的消息之外，还记录消费者的生命周期事件。（这是针对系统测试的。）</td></tr><tr><td>–formatter &lt;String: class&gt;</td><td>The name of a class to use for formatting kafka messages for display. (default: kafka.tools.DefaultMessageFormatter)</td><td>用于格式化要显示的kafka消息的类的名称。（默认值：kafka.tools.DefaultMessageFormatter）</td></tr><tr><td>–formatter-config &lt;String: config file&gt;</td><td>Config properties file to initialize the message formatter. Note that [property] takes precedence over this config.</td><td>配置属性文件以初始化消息格式化程序。请注意，[property]优先于此配置。</td></tr><tr><td>–from-beginning</td><td>If the consumer does not already have an established offset to consume from, start with the earliest message present in the log rather than the latest message.</td><td>如果消费者还没有建立的偏移量，从日志中出现的最早消息开始，而不是从最新消息开始。</td></tr><tr><td>–group &lt;String: consumer group id&gt;</td><td>The consumer group id of the consumer.</td><td>消费者的消费者组id。</td></tr><tr><td>–help</td><td>Print usage information.</td><td>打印使用信息。</td></tr><tr><td>–include &lt;String: Java regex (String)&gt;</td><td>Regular expression specifying list of topics to include for consumption.</td><td>指定要包含以供使用的主题列表的正则表达式。</td></tr><tr><td>–isolation-level </td><td>Set to read_committed in order to filter out transactional messages which are not committed. Set to read_uncommitted to read all messages. (default: read_uncommitted)</td><td>设置为read_committed，以便筛选出未提交的事务性消息。设置为read_uncommitted可读取所有消息。（默认值：read_uncommitted）</td></tr><tr><td>–key-deserializer &lt;String: deserializer for key&gt;</td><td></td><td></td></tr><tr><td>–max-messages &lt;Integer: num_messages&gt;</td><td>The maximum number of messages to consume before exiting. If not set, consumption is continual.</td><td>退出前要消费的最大消息数。如果未设置，则消费是连续的。</td></tr><tr><td>–offset &lt;String: consume offset&gt;</td><td>The offset to consume from (a non-negative number), or ‘earliest’ which means from beginning, or ‘latest’ which means from end (default: latest)</td><td>从（非负数）开始消费的偏移量，或“earliest”表示从开始，或“latest”表示从结束（默认值：最新）</td></tr><tr><td>–partition &lt;Integer: partition&gt;</td><td>The partition to consume from. Consumption starts from the end of the partition unless ‘–offset’ is specified.</td><td>要从中消费的分区。除非指定了“–offset”，否则消费从分区的末尾开始。</td></tr><tr><td>–property &lt;String: prop&gt;</td><td>The properties to initialize the message formatter.</td><td>用于初始化消息格式化程序的配置文件。</td></tr><tr><td>–skip-message-on-error</td><td>If there is an error when processing a message, skip it instead of halt.</td><td>如果在处理消息时出现错误，跳过它而不是停止。</td></tr><tr><td>–timeout-ms &lt;Integer: timeout_ms&gt;</td><td>If specified, exit if no message is available for consumption for the specified interval.</td><td>如果指定了，如果在指定的时间间隔内没有消息可供消费，则退出。</td></tr><tr><td>–topic &lt;String: topic&gt;</td><td>The topic to consume on.</td><td>要消费的主题。</td></tr><tr><td>–value-deserializer &lt;String: deserializer for values&gt;</td><td></td><td></td></tr><tr><td>–version</td><td>Display Kafka version.</td><td>显示Kafka版本。</td></tr><tr><td>–whitelist &lt;String: Java regex (String)&gt;</td><td>DEPRECATED, use --include instead; ignored if --include specified. Regular expression specifying list of topics to include for consumption.</td><td>弃用，请改用–include；如果指定了–include，则忽略。指定要包含以供使用的主题列表的正则表达式。</td></tr></tbody></table> 
<h4><a id="31__142"></a>3.1 消费主题中的数据</h4> 
<pre><code class="prism language-sh">kafka-console-consumer.sh --bootstrap-server centos701:9092,centos702:9092,centos704:9092 <span class="token parameter variable">--topic</span> first
</code></pre> 
<h4><a id="32__148"></a>3.2 从头开始消费数据</h4> 
<pre><code class="prism language-sh">kafka-console-consumer.sh --bootstrap-server centos701:9092,centos702:9092,centos704:9092 --from-beginning <span class="token parameter variable">--topic</span> first
</code></pre> 
<h4><a id="33__154"></a>3.3 指定消费者组消费</h4> 
<pre><code class="prism language-sh">kafka-console-consumer.sh --bootstrap-server centos701:9092,centos702:9092,centos704:9092 --from-beginning <span class="token parameter variable">--topic</span> first <span class="token parameter variable">--group</span> first_group
</code></pre> 
<h4><a id="34__160"></a>3.4 打印时间戳</h4> 
<pre><code class="prism language-sh">kafka-console-consumer.sh --bootstrap-server centos701:9092,centos702:9092,centos704:9092 --from-beginning <span class="token parameter variable">--topic</span> first <span class="token parameter variable">--property</span> <span class="token assign-left variable">print.timestamp</span><span class="token operator">=</span>true
</code></pre> 
<h3><a id="4_kafkaconsumergroupssh_166"></a>4 kafka-consumer-groups.sh</h3> 
<table><thead><tr><th>Option(选项)</th><th>Description(描述)</th><th>翻译</th></tr></thead><tbody><tr><td>–all-groups</td><td>Apply to all consumer groups.</td><td>应用于所有消费者组。</td></tr><tr><td>–all-topics</td><td>Consider all topics assigned to a group in the <code>reset-offsets</code> process.</td><td>在<code>reset-offsets</code>过程中，应用于一个组的所有主题。</td></tr><tr><td>–bootstrap-server &lt;String: server to connect to&gt;</td><td>REQUIRED: The server(s) to connect to.</td><td>必需：要连接到的服务器。</td></tr><tr><td>–by-duration &lt;String: duration&gt;</td><td>Reset offsets to offset by duration from current timestamp. Format: ‘PnDTnHnMnS’</td><td>将偏移量重置为当前时间戳的持续时间偏移量。格式：“PnDTnHnMnS”</td></tr><tr><td>–command-config &lt;String: command config property file&gt;</td><td>Property file containing configs to be passed to Admin Client and Consumer.</td><td>包含要传递给管理客户端和消费者的配置的属性文件。</td></tr><tr><td>–delete</td><td>Pass in groups to delete topic partition offsets and ownership information over the entire consumer group. For instance --group g1 --group g2</td><td>传入消费者组以删除整个消费者组的主题分区偏移和所有权信息。例如 --group g1 --group g2</td></tr><tr><td>–delete-offsets</td><td>Delete offsets of consumer group. Supports one consumer group at the time, and multiple topics.</td><td>删除消费者组的偏移量。一次支持一个消费者组和多个主题。</td></tr><tr><td>–describe</td><td>Describe consumer group and list offset lag (number of messages not yet processed) related to given group.</td><td>描述消费者组并列出与给定组相关的偏移滞后（尚未处理的消息数）。</td></tr><tr><td>–dry-run</td><td>Only show results without executing changes on Consumer Groups. Supported operations: reset-offsets.</td><td>仅显示结果，而不对消费者组执行更改。支持的操作：reset-offsets。</td></tr><tr><td>–execute</td><td>Execute operation. Supported operations: reset-offsets.</td><td>执行操作。支持的操作：reset-offsets。</td></tr><tr><td>–export</td><td>Export operation execution to a CSV file. Supported operations: reset-offsets.</td><td>将操作执行导出到CSV文件。支持的操作：reset-offsets。</td></tr><tr><td>–from-file &lt;String: path to CSV file&gt;</td><td>Reset offsets to values defined in CSV file.</td><td>将偏移重置为CSV文件中定义的值。</td></tr><tr><td>–group &lt;String: consumer group&gt;</td><td>The consumer group we wish to act on.</td><td>我们希望采取行动的消费者组。</td></tr><tr><td>–help</td><td>Print usage information.</td><td>打印使用信息。</td></tr><tr><td>–list</td><td>List all consumer groups.</td><td>列出所有消费者组。</td></tr><tr><td>–members</td><td>Describe members of the group. This option may be used with ‘–describe’ and ‘–bootstrap-server’ options only.<br>Example: --bootstrap-server localhost: 9092 --describe --group group1 --members</td><td>描述小组成员。此选项只能与“–description”和“–bootstrap server”选项一起使用。<br>示例：–bootstrap-server localhost:9092 --describe --group group1–members</td></tr><tr><td>–offsets</td><td>Describe the group and list all topic partitions in the group along with their offset lag. This is the default sub-action of and may be used with ‘–describe’ and ‘–bootstrap-server’ options only.<br>Example: --bootstrap-server localhost: 9092 --describe --group group1 --offsets</td><td>描述组并列出组中的所有主题分区及其偏移滞后。这是的默认子操作，只能与“–description”和“–bootstrap server”选项一起使用。<br>示例：–bootstrap-server localhost: 9092 --describe --group group1 --offsets</td></tr><tr><td>–reset-offsets</td><td>Reset offsets of consumer group. Supports one consumer group at the time, and instances should be inactive.<br>Has 2 execution options: --dry-run (the default) to plan which offsets to reset, and --execute to update the offsets. Additionally, the --export option is used to export the results to a CSV format.<br>You must choose one of the following reset specifications: --to-datetime, --by-duration, --to-earliest, --to-latest, --shift-by, --from-file, --to-current, --to-offset.<br>To define the scope use --all-topics or --topic. One scope must be specified unless you use ‘–from-file’.</td><td>重置消费者组的偏移量。一次支持一个消费者组，并且实例应处于非活动状态。<br>有两个执行选项：–dry-run（默认）计划要重置的偏移量，–execute更新偏移量。此外，–export选项用于将结果导出为CSV格式。<br>您必须选择以下重置规范之一：–to-datetime, --by-duration, --to-earliest, --to-latest, --shift-by, --from-file, --to-current, --to-offset。<br>要定义范围，请使用—all-topics或–topic。除非使用“–from-file”，否则必须指定一个作用域。</td></tr><tr><td>–shift-by &lt;Long: number-of-offsets&gt;</td><td>Reset offsets shifting current offset by ‘n’, where ‘n’ can be positive or negative.</td><td>重置偏移量将当前偏移量偏移“n”，其中“n”可以是正或负。</td></tr><tr><td>–state [String]</td><td>When specified with ‘–describe’, includes the state of the group.<br>Example: --bootstrap-server localhost:9092 --describe --group group1 --state<br>When specified with ‘–list’, it displays the state of all groups. It can also be used to list groups with specific states.<br>Example: --bootstrap-server localhost:9092 --list --state stable,empty<br>This option may be used with ‘–describe’, ‘–list’ and ‘–bootstrap-server’ options only.</td><td>当使用“–describe”指定时，包括组的状态。<br>示例：–bootstrap-server localhost:9092 --describe --group group1 --state<br>当使用“–list”指定时，它将显示所有组的状态。它还可以用于列出具有特定状态的组。<br>示例： --bootstrap-server localhost:9092 --list --state stable,empty<br>此选项只能与“–description”、“–list”和“–bootstrap server”选项一起使用。</td></tr><tr><td>–timeout &lt;Long: timeout (ms)&gt;</td><td>The timeout that can be set for some use cases. For example, it can be used when describing the group to specify the maximum amount of time in milliseconds to wait before the group stabilizes (when the group is just created, or is going through some changes). (default: 5000)</td><td>可以为某些用例设置的超时。例如，在描述组时，可以使用它来指定在组稳定之前（当组刚刚创建或正在进行一些更改时）等待的最大时间（以毫秒为单位）。（默认值：5000）</td></tr><tr><td>–to-current</td><td>Reset offsets to current offset.</td><td>将偏移重置为当前偏移。</td></tr><tr><td>–to-datetime &lt;String: datetime&gt;</td><td>Reset offsets to offset from datetime. Format: ‘YYYY-MM-DDTHH:mm:SS.sss’</td><td>将偏移量重置为来自日期时间的偏移量。格式：‘YYYY-MM-DDTHH:mm:SS.sss’</td></tr><tr><td>–to-earliest</td><td>Reset offsets to earliest offset.</td><td>将偏移重置为最早偏移。</td></tr><tr><td>–to-latest</td><td>Reset offsets to latest offset.</td><td>将偏移重置为最新偏移。</td></tr><tr><td>–to-offset &lt;Long: offset&gt;</td><td>Reset offsets to a specific offset.</td><td>将偏移重置为特定偏移。</td></tr><tr><td>–topic &lt;String: topic&gt;</td><td>The topic whose consumer group information should be deleted or topic whose should be included in the reset offset process. In <code>reset-offsets</code> case, partitions can be specified using this format: <code>topic1:0,1,2</code>, where 0,1,2 are the partition to be included in the process. Reset-offsets also supports multiple topic inputs.</td><td>应删除其消费者组信息的主题或应将其包含在重置偏移过程中的主题。在<code>reset-offsets</code>的情况下，可以使用以下格式指定分区：topic1:0,1,2`，其中0,1,2是要包含在进程中的分区。重置偏移量还支持多个主题输入。</td></tr><tr><td>–verbose</td><td>Provide additional information, if any, when describing the group. This option may be used with ‘–offsets’/‘–members’/‘–state’ and ‘–bootstrap-server’ options only.<br>Example: --bootstrap-server localhost:9092 --describe --group group1 --members --verbose</td><td>在描述消费者组时，如有其他信息，则提供。此选项只能与“–offsets”/“–members”/“–state”和“–bootstrap-server”选项一起使用。<br>示例：–bootstrap-server localhost:9092 --describe --group group1 --members --verbose</td></tr><tr><td>–version</td><td>Display Kafka version.</td><td>显示Kafka版本。</td></tr></tbody></table> 
<h4><a id="41__200"></a>4.1 查看所有消费者组</h4> 
<pre><code class="prism language-sh">kafka-consumer-groups.sh --bootstrap-server centos701:9092,centos702:9092,centos704:9092 <span class="token parameter variable">--list</span>
</code></pre> 
<h4><a id="42__206"></a>4.2 描述指定消费者组</h4> 
<pre><code class="prism language-sh">kafka-consumer-groups.sh --bootstrap-server centos701:9092,centos702:9092,centos704:9092 <span class="token parameter variable">--describe</span> <span class="token parameter variable">--group</span> first_group
</code></pre> 
<h4><a id="43__212"></a>4.3 重置消费偏移</h4> 
<pre><code class="prism language-sh">kafka-consumer-groups.sh --bootstrap-server centos701:9092,centos702:9092,centos704:9092 <span class="token parameter variable">--group</span> fist_group <span class="token parameter variable">--topic</span> first --reset-offsets --to-datetime <span class="token number">2023</span>-10-08T00:00:00.000 <span class="token parameter variable">-execute</span>
</code></pre> 
<h3><a id="5_kafkareassignpartitionssh_218"></a>5 kafka-reassign-partitions.sh</h3> 
<p>This tool helps to move topic partitions between replicas.</p> 
<p>此工具帮助在副本之间移动主题分区。</p> 
<table><thead><tr><th>Option(选项)</th><th>Description(描述)</th><th>翻译</th></tr></thead><tbody><tr><td>–additional</td><td>Execute this reassignment in addition to any other ongoing ones. This option can also be used to change the throttle of an ongoing reassignment.</td><td>除了执行任何其他正在进行的重新分配外，还要执行此重新分配。此选项也可用于更改正在进行的重新分配的限制。</td></tr><tr><td>–bootstrap-server &lt;String: Server(s) to use for bootstrapping&gt;</td><td>REQUIRED: the server(s) to use for bootstrapping.</td><td>必需：用于引导的服务器。</td></tr><tr><td>–broker-list &lt;String: brokerlist&gt;</td><td>The list of brokers to which the partitions need to be reassigned in the form “0,1,2”. This is required if --topics-to-move-json-file is used to generate reassignment configuration</td><td>需要将分区重新分配到的broker列表，格式为“0,1,2”。如果使用–topics-to-move-json-file以生成重新分配配置，则这是必需的</td></tr><tr><td>–cancel</td><td>Cancel an active reassignment.</td><td>取消活动的重新分配。</td></tr><tr><td>–command-config &lt;String: Admin client property file&gt;</td><td>Property file containing configs to be passed to Admin Client.</td><td>包含要传递给管理客户端的配置的属性文件。</td></tr><tr><td>–disable-rack-aware</td><td>Disable rack aware replica assignment</td><td>禁用机架感知复制副本分配</td></tr><tr><td>–execute</td><td>Kick off the reassignment as specified by the --reassignment-json-file option.</td><td>按照–reassignment-json-file选项的指定启动重新分配。</td></tr><tr><td>–generate</td><td>Generate a candidate partition reassignment configuration. Note that this only generates a candidate assignment, it does not execute it.</td><td>生成候选分区重新分配配置。请注意，这只会生成一个候选赋值，而不会执行它。</td></tr><tr><td>–help</td><td>Print usage information.</td><td>打印使用信息。</td></tr><tr><td>–list</td><td>List all active partition reassignments.</td><td>列出所有活动的分区重新分配。</td></tr><tr><td>–preserve-throttles</td><td>Do not modify broker or topic throttles.</td><td>不要修改broker或主题限制。</td></tr><tr><td>–reassignment-json-file &lt;String: manual assignment json file path&gt;</td><td>The JSON file with the partition reassignment configurationThe format to use is - <br>{“partitions”: <br> [{“topic”: “foo”, <br> “partition”: 1, <br> “replicas”: [1,2,3], <br> “log_dirs”: [“dir1”,“dir2”,“dir3”]<br> }], <br>“version”:1 <br>} <br>Note that “log_dirs” is optional. When it is specified, its length must equal the length of the replicas list. The value in this list can be either “any” or the absolution path of the log directory on the broker. If absolute log directory path is specified, the replica will be moved to the specified log directory on the broker.</td><td>带有分区重新分配配置的JSON文件要使用的格式是-<br>{“partitions”: <br> [{“topic”: “foo”, <br> “partition”: 1, <br> “replicas”: [1,2,3], <br> “log_dirs”: [“dir1”,“dir2”,“dir3”]<br> }], <br>“version”:1 <br>} <br>注意，“log-dirs”是可选的。指定时，其长度必须等于"replicas"列表的长度。此列表中的值可以是的“any”或broker日志目录绝对路径。如果指定了日志目录绝对路径，则副本将移动到代理上指定的日志目录。</td></tr><tr><td>–replica-alter-log-dirs-throttle &lt;Long: replicaAlterLogDirsThrottle&gt;</td><td>The movement of replicas between log directories on the same broker will be throttled to this value (bytes/sec). This option can be included with --execute when a reassignment is started, and it can be altered by resubmitting the current reassignment along with the --additional flag. The throttle rate should be at least 1 KB/s. (default: -1)</td><td>同一broker上的日志目录之间的副本移动将被限制为此值（字节/秒）。当重新分配开始时，–execute可以包含此选项，并且可以通过重新提交当前的重新分配以及–additional标志来更改此选项。节流速率应至少为1 KB/s。（默认值：-1）</td></tr><tr><td>–throttle &lt;Long: throttle&gt;</td><td>The movement of partitions between brokers will be throttled to this value (bytes/sec). This option can be included with --execute when a reassignment is started, and it can be altered by resubmitting the current reassignment along with the --additional flag. The throttle rate should be at least 1 KB/s. (default: -1)</td><td>broker之间的分区移动将被限制为此值（字节/秒）。当重新分配开始时，–execute可以包含此选项，并且可以通过重新提交当前的重新分配–additional标志来更改此选项。节流速率应至少为1 KB/s。（默认值：-1）</td></tr><tr><td>–timeout &lt;Long: timeout&gt;</td><td>The maximum time in ms to wait for log directory replica assignment to begin. (default: 10000)</td><td>等待日志目录副本分配开始的最长时间（毫秒）。（默认值：10000）</td></tr><tr><td>–topics-to-move-json-file &lt;String: topics to reassign json file path&gt;</td><td>Generate a reassignment configuration to move the partitions of the specified topics to the list of brokers specified by the --broker-list option. The format to use is - <br>{“topics”: <br> [{“topic”: “foo”},{“topic”: “foo1”}],<br>“version”:1 <br>}</td><td>生成一个重新分配配置，将指定主题的分区移动到–broker-list选项指定的代理列表中。要使用的格式是-<br>{“topics”: <br> [{“topic”: “foo”},{“topic”: “foo1”}],<br>“version”:1 <br>}</td></tr><tr><td>–verify</td><td>Verify if the reassignment completed as specified by the --reassignment-json-file option. If there is a throttle engaged for the replicas specified, and the rebalance has completed, the throttle will be removed</td><td>验证重新分配是否按照–reassignment-json-file选项的指定完成。如果为指定的复制副本启用了节流阀，并且重新平衡已完成，则节流阀将被移除</td></tr><tr><td>–version</td><td>Display Kafka version.</td><td>显示Kafka版本。</td></tr></tbody></table> 
<h4><a id="51__245"></a>5.1 手动调整分区副本</h4> 
<h5><a id="511_topic_247"></a>5.1.1 查看topic分区副本存储情况</h5> 
<pre><code>[root@centos701 ~]# /opt/module/kafka_2.12-3.6.1/bin/kafka-topics.sh --bootstrap-server centos701:9092 --describe --topic first
Topic: first    TopicId: bhIgBX4wQTqn__OP82gpXQ PartitionCount: 3       ReplicationFactor: 3    Configs: 
        Topic: first    Partition: 0    Leader: 702     Replicas: 704,701,702   Isr: 702,701,704
        Topic: first    Partition: 1    Leader: 701     Replicas: 701,702,704   Isr: 702,701,704
        Topic: first    Partition: 2    Leader: 702     Replicas: 702,704,701   Isr: 702,701,704
</code></pre> 
<h5><a id="512__257"></a>5.1.2 创建副本存储计划</h5> 
<pre><code>[root@centos701 ~]# vim /opt/module/kafka_2.12-3.6.1/json/change-replication-factor-first.json
</code></pre> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"version"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string-property property">"partitions"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"topic"</span><span class="token operator">:</span> <span class="token string">"first"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"partition"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token string-property property">"replicas"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token number">701</span><span class="token punctuation">,</span>
                <span class="token number">702</span><span class="token punctuation">,</span>
                <span class="token number">704</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string-property property">"log_dirs"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">"any"</span><span class="token punctuation">,</span>
                <span class="token string">"any"</span><span class="token punctuation">,</span>
                <span class="token string">"any"</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"topic"</span><span class="token operator">:</span> <span class="token string">"first"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"partition"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token string-property property">"replicas"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token number">702</span><span class="token punctuation">,</span>
                <span class="token number">704</span><span class="token punctuation">,</span>
                <span class="token number">701</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string-property property">"log_dirs"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">"any"</span><span class="token punctuation">,</span>
                <span class="token string">"any"</span><span class="token punctuation">,</span>
                <span class="token string">"any"</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"topic"</span><span class="token operator">:</span> <span class="token string">"first"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"partition"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token string-property property">"replicas"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token number">704</span><span class="token punctuation">,</span>
                <span class="token number">701</span><span class="token punctuation">,</span>
                <span class="token number">702</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string-property property">"log_dirs"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">"any"</span><span class="token punctuation">,</span>
                <span class="token string">"any"</span><span class="token punctuation">,</span>
                <span class="token string">"any"</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="513__313"></a>5.1.3 执行副本存储计划</h5> 
<pre><code>[root@centos701 ~]# /opt/module/kafka_2.12-3.6.1/bin/kafka-reassign-partitions.sh --bootstrap-server centos701:9092 --reassignment-json-file /opt/module/kafka_2.12-3.6.1/json/change-replication-factor-first.json --execute
Current partition replica assignment

{"version":1,"partitions":[{"topic":"first","partition":0,"replicas":[704,701,702],"log_dirs":["any","any","any"]},{"topic":"first","partition":1,"replicas":[701,702,704],"log_dirs":["any","any","any"]},{"topic":"first","partition":2,"replicas":[702,704,701],"log_dirs":["any","any","any"]}]}

Save this to use as the --reassignment-json-file option during rollback
Successfully started partition reassignments for first-0,first-1,first-2
</code></pre> 
<h5><a id="514__325"></a>5.1.4 验证副本存储计划</h5> 
<pre><code>[root@centos701 ~]# /opt/module/kafka_2.12-3.6.1/bin/kafka-reassign-partitions.sh --bootstrap-server centos701:9092 --reassignment-json-file /opt/module/kafka_2.12-3.6.1/json/change-replication-factor-first.json --verify
Status of partition reassignment:
Reassignment of partition first-0 is completed.
Reassignment of partition first-1 is completed.
Reassignment of partition first-2 is completed.

Clearing broker-level throttles on brokers 704,701,702
Clearing topic-level throttles on topic first
</code></pre> 
<h5><a id="515__338"></a>5.1.5 查看分区副本存储情况</h5> 
<pre><code>[root@centos701 ~]# /opt/module/kafka_2.12-3.6.1/bin/kafka-topics.sh --bootstrap-server centos701:9092 --describe --topic first
Topic: first    TopicId: bhIgBX4wQTqn__OP82gpXQ PartitionCount: 3       ReplicationFactor: 3    Configs: 
        Topic: first    Partition: 0    Leader: 702     Replicas: 701,702,704   Isr: 702,701,704
        Topic: first    Partition: 1    Leader: 701     Replicas: 702,704,701   Isr: 702,701,704
        Topic: first    Partition: 2    Leader: 702     Replicas: 704,701,702   Isr: 702,701,704
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6ad1dc4be6361f530d6e907ecc5cce5a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【JaveWeb教程】（22） MySQL数据库开发之多表查询：内连接、外连接、子查询 详细代码示例讲解（最全面）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/40ce7a835e3177679cc4564852595301/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Flink CDC 实时抽取 Oracle 数据-排错&amp;调优</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>