<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SQL Server 数据表模糊查询（like 用法）以及查询函数 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/6d4ef7ad18d0cb01b1c9b302c6655dab/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="SQL Server 数据表模糊查询（like 用法）以及查询函数">
  <meta property="og:description" content="文章目录 一、模糊查询（like）二、查询函数 一、模糊查询（like） 在SQL Server Management Studio (SSMS) 中，进行模糊查询主要是通过使用like操作符来实现的。like操作符用于在where语句中搜索列中具有指定模式的数据。
我们在简单例子中来了解：
% 通配符：表示任意数量的字符。
select * from table_name where column_name like &#39;%pattern%&#39;; 这个例子会选择column_name列中包含&#34;pattern&#34;这个词的所有记录,就是不管内容是啥，只要里面包含pattern就会被查询到。
_ 通配符：表示单个字符。
select * from table_name where column_name like &#39;_pattern%&#39;; 这个例子会选择column_name列中以任意单个字符开头，后面跟着&#34;pattern&#34;的所有记录。比如：apattern、bpattern
[] 字符集：匹配括号内的任意单个字符。
select * from table_name where column_name like &#39;[a-c]pattern%&#39;; 这个例子会选择column_name列中以&#34;a&#34;、&#34;b&#34;或&#34;c&#34;开头，后面跟着&#34;pattern&#34;的所有记录。
[^] 或 [!] 负字符集：不匹配括号内的任意单个字符。
select * from table_name where column_name like &#39;[^a-c]pattern%&#39;; 这个例子会排除column_name列中以&#34;a&#34;、&#34;b&#34;或&#34;c&#34;开头的记录，但会选择以其他字符开头后面跟着&#34;pattern&#34;的所有记录。
in 字符集：不匹配括号内的任意单个字符。in 操作符允许在where子句中指定多个值，用来测试某个列的值是否包含在指定的值列表中。如果列的值匹配列表中的任意一个值，那么这个记录就会被选中。
select StudentName,StudentAddress,Birthday from Students where StudentName in(&#39;王小二&#39;,&#39;小丹&#39;) 这条语句选取名字为“王小二”或“小丹”的学生的名字、地址和出生日期。
使用like操作符时，要注意%和_可以放在模式的任何位置，并且可以使用多个通配符来构造复杂的搜索模式。此外，模糊查询可能会影响数据库查询性能，特别是当通配符出现在模式的开始时，因为这会阻止SQL Server使用索引进行搜索。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-21T13:12:10+08:00">
    <meta property="article:modified_time" content="2024-01-21T13:12:10+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SQL Server 数据表模糊查询（like 用法）以及查询函数</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#like_1" rel="nofollow">一、模糊查询（like）</a></li><li><a href="#_37" rel="nofollow">二、查询函数</a></li></ul> 
</div> 
<p></p> 
<h2><a id="like_1"></a>一、模糊查询（like）</h2> 
<p>在SQL Server Management Studio (SSMS) 中，进行模糊查询主要是通过使用<code>like</code>操作符来实现的。<code>like</code>操作符用于在<code>where</code>语句中搜索列中具有指定模式的数据。<br> 我们在简单例子中来了解：</p> 
<ol><li> <p><code>%</code> 通配符：表示任意数量的字符。</p> <pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> table_name <span class="token keyword">where</span> column_name <span class="token operator">like</span> <span class="token string">'%pattern%'</span><span class="token punctuation">;</span>
</code></pre> <p>这个例子会选择<code>column_name</code>列中包含"pattern"这个词的所有记录,就是不管内容是啥，只要里面包含pattern就会被查询到。</p> </li><li> <p><code>_</code> 通配符：表示单个字符。</p> <pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> table_name <span class="token keyword">where</span> column_name <span class="token operator">like</span> <span class="token string">'_pattern%'</span><span class="token punctuation">;</span>
</code></pre> <p>这个例子会选择<code>column_name</code>列中以任意单个字符开头，后面跟着"pattern"的所有记录。比如：apattern、bpattern</p> </li><li> <p><code>[]</code> 字符集：匹配括号内的任意单个字符。</p> <pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> table_name <span class="token keyword">where</span> column_name <span class="token operator">like</span> <span class="token string">'[a-c]pattern%'</span><span class="token punctuation">;</span>
</code></pre> <p>这个例子会选择<code>column_name</code>列中以"a"、"b"或"c"开头，后面跟着"pattern"的所有记录。</p> </li><li> <p><code>[^]</code> 或 <code>[!]</code> 负字符集：不匹配括号内的任意单个字符。</p> <pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> table_name <span class="token keyword">where</span> column_name <span class="token operator">like</span> <span class="token string">'[^a-c]pattern%'</span><span class="token punctuation">;</span>
</code></pre> <p>这个例子会排除<code>column_name</code>列中以"a"、"b"或"c"开头的记录，但会选择以其他字符开头后面跟着"pattern"的所有记录。</p> </li><li> <p><code>in</code> 字符集：不匹配括号内的任意单个字符。in 操作符允许在where子句中指定多个值，用来测试某个列的值是否包含在指定的值列表中。如果列的值匹配列表中的任意一个值，那么这个记录就会被选中。</p> </li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> StudentName<span class="token punctuation">,</span>StudentAddress<span class="token punctuation">,</span>Birthday <span class="token keyword">from</span> Students
<span class="token keyword">where</span> StudentName <span class="token operator">in</span><span class="token punctuation">(</span><span class="token string">'王小二'</span><span class="token punctuation">,</span><span class="token string">'小丹'</span><span class="token punctuation">)</span>
</code></pre> 
<p>这条语句选取名字为“王小二”或“小丹”的学生的名字、地址和出生日期。</p> 
<p>使用<code>like</code>操作符时，要注意<code>%</code>和<code>_</code>可以放在模式的任何位置，并且可以使用多个通配符来构造复杂的搜索模式。此外，模糊查询可能会影响数据库查询性能，特别是当通配符出现在模式的开始时，因为这会阻止SQL Server使用索引进行搜索。</p> 
<h2><a id="_37"></a>二、查询函数</h2> 
<p>我们先来汇总一些比较常用的函数<br> 在SQL Server Management Studio中，可以使用多种内置的查询函数来执行数据检索和转换。这些函数属于不同的类别，如字符串函数、数值函数、日期和时间函数、转换函数等。以下是一些常用的SQL Server查询函数的分类和例子：</p> 
<ol><li> <p><strong>字符串函数</strong>:</p> 
  <ul><li><code>len(string)</code>: 返回字符串的长度。</li><li><code>charindex(substring, string)</code>: 返回子字符串在字符串中的位置。</li><li><code>substring(string, start, length)</code>: 返回字符串的一个子字符串。</li><li><code>replace(string, old_substring, new_substring)</code>: 替换字符串中的所有指定子字符串。</li><li><code>left(string, number_of_chars)</code>: 返回字符串左侧的指定数量的字符。</li><li><code>right(string, number_of_chars)</code>: 返回字符串右侧的指定数量的字符。</li><li><code>lower(string)</code>: 将字符串转换成小写。</li><li><code>upper(string)</code>: 将字符串转换成大写。</li><li><code>trimi(string)</code>: 去掉字符串左侧的空格。</li><li><code>rtrim(string)</code>: 去掉字符串右侧的空格。</li><li><code>concat(string1, string2, ...)</code>: 连接两个或多个字符串。</li></ul> </li><li> <p><strong>数值函数</strong>:</p> 
  <ul><li><code>abs(number)</code>: 返回数字的绝对值。</li><li><code>floor(number)</code>: 返回小于或等于指定数字的最大整数。</li><li><code>ceiling(number)</code>: 返回大于或等于指定数字的最小整数。</li><li><code>round(number, decimals)</code>: 返回数字四舍五入到指定的小数位数后的值。</li><li><code>SUM(column)</code>: 返回某列数值总和。</li><li><code>AVG(column)</code>: 返回某列的平均值。</li><li><code>MIN(column)</code>: 返回某列的最小值。</li><li><code>MAX(column)</code>: 返回某列的最大值。<br> 举个例子：比如我们有一个统计学生分数的表ScoreList</li></ul> </li></ol> 
<pre><code>select sum(Csharp) as C# 总成绩 from ScoreList
select 总人数=count(*)from Students

select MAX(Csharp) as C#最高,MIN(Csharp) as C#最低分,AVG(Csharp) as C#平均分 from ScoreList
</code></pre> 
<p>这些SQL查询语句用于从数据库表中提取特定的统计信息：</p> 
<p><code>select sum(Csharp) as C# 总成绩 from ScoreList</code></p> 
<p>这个查询计算 <code>ScoreList</code> 表中 <code>Csharp</code> 列（代表学生的C#成绩）的值的总和，并将结果命名为 <code>C# 总成绩</code>。查询的结果将是所有记录中C#成绩的总和。</p> 
<p><code>select 总人数=count(*) from Students</code></p> 
<p>这个查询计算 <code>Students</code> 表中的记录数，即学生总数，并将这个数命名为 <code>总人数</code>。<code>count(*)</code> 函数计算表中的记录总数，包括所有的行，无论列值是否为NULL。</p> 
<p><code>select MAX(Csharp) as C#最高,MIN(Csharp) as C#最低分,AVG(Csharp) as C#平均分 from ScoreList</code></p> 
<p>这个查询从 <code>ScoreList</code> 表中提取三个统计数据：</p> 
<ul><li><code>MAX(Csharp) as C#最高</code>：C#成绩的最高值，结果列命名为 <code>C#最高</code>。</li><li><code>MIN(Csharp) as C#最低分</code>：C#成绩的最低值，结果列命名为 <code>C#最低分</code>。</li><li><code>AVG(Csharp) as C#平均分</code>：C#成绩的平均值，结果列命名为 <code>C#平均分</code>。</li></ul> 
<ol start="3"><li> <p><strong>日期和时间函数</strong>:</p> 
  <ul><li><code>getdate()</code>: 返回当前系统的日期和时间。</li><li><code>datepart(part, date)</code>: 返回日期的指定部分（如年、月、日）。</li><li><code>datediff(part, startdate, enddate)</code>: 返回两个日期之间的差异。</li><li><code>dateadd(part, number, date)</code>: 在日期上添加指定的时间间隔。</li></ul> </li><li> <p><strong>转换函数</strong>:</p> 
  <ul><li><code>cast(expression AS data_type)</code>: 将表达式转换为指定的数据类型。</li><li><code>convert(data_type(length), expression, style)</code>: 转换数据类型，并可以使用风格参数。</li></ul> </li><li> <p><strong>聚合函数</strong>:</p> 
  <ul><li><code>count(*)</code>: 计算表中的记录数。</li><li><code>cout(column)</code>: 计算某列非NULL值的数目。</li><li><code>group by</code>: 用于结合聚合函数，按一个或多个列对结果集进行分组。</li></ul> </li><li> <p><strong>其他有用函数</strong>:</p> 
  <ul><li><code>isnull(check_expression, replacement_value)</code>: 检查一个表达式是否为null，如果是，则返回替代值。</li><li><code>coalesce(expression1, expression2, ...)</code>: 返回参数列表中第一个非NULL表达式。</li></ul> </li></ol> 
<p>这些函数可以在查询中单独使用，或者结合其他SQL语句来提高数据处理的能力和灵活性。通过这些函数，可以对数据进行有效的处理和转换，以满足各种复杂的业务逻辑需求。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/eb058c362baa0c84df8b7b4dc2693b85/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">macOS 设置屏幕常亮 不休眠</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0b4e068d71848b2c3424ba29d5fdac8f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">小程序中获取openid的方法？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>