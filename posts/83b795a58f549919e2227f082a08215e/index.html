<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>JavaWeb（四：Ajax与Json） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/83b795a58f549919e2227f082a08215e/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="JavaWeb（四：Ajax与Json）">
  <meta property="og:description" content="一、Ajax 1.定义 Ajax（Asynchronous JavaScript And XML）：异步的 JavaScript 和 XML
AJAX 不是新的编程语言，指的是⼀种交互方式：异步加载。
客户端和服务器的数据交互更新在局部页面的技术，不需要刷新整个页面 --&gt; 局部刷新。
优点：
① 局部刷新，效率更高
② 用户体验更好
2.原理 3.基于 jQuery 的 AJAX 语法 $.ajax({
属性，
})
常用的属性参数：
url请求的后端服务地址type请求方式，默认 getdata请求所携带的参数dataType服务器返回的数据类型：text / jsonsuccess请求成功的回调函数error请求失败的回调函数complete请求完成的回调函数（无论成功或者失败，都会调用） &lt;%@ page contentType=&#34;text/html;charset=UTF-8&#34; language=&#34;java&#34; %&gt; &lt;html&gt; &lt;head&gt; &lt;title&gt;Title&lt;/title&gt; &lt;script type=&#34;text/javascript&#34; src=&#34;js/jquery-3.3.1.min.js&#34;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;input id=&#34;text&#34; type=&#34;text&#34;/&gt;&lt;br/&gt; &lt;input id=&#34;btn&#34; type=&#34;button&#34; value=&#34;提交&#34;/&gt; &lt;script type=&#34;text/javascript&#34;&gt; $(function () { var btn = $(&#34;#btn&#34;); btn.click(function () { $.ajax({ url: &#39;/test&#39;, type: &#39;post&#39;, data: &#39;id=1&#39;, dataType: &#39;text&#39;, success: function (data) { var text = $(&#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-12T20:04:12+08:00">
    <meta property="article:modified_time" content="2024-07-12T20:04:12+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">JavaWeb（四：Ajax与Json）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>一、Ajax</h2> 
<h3>1.定义</h3> 
<p>Ajax（Asynchronous JavaScript And XML）：异步的 JavaScript 和 XML</p> 
<p>AJAX 不是新的编程语言，指的是⼀种交互方式：异步加载。</p> 
<p>客户端和服务器的数据交互更新在局部页面的技术，不需要刷新整个页面 --&gt; 局部刷新。</p> 
<p><strong>优点：</strong></p> 
<p>① 局部刷新，效率更高</p> 
<p>② 用户体验更好</p> 
<h3>2.原理</h3> 
<p><img alt="" height="569" src="https://images2.imgbox.com/9f/3f/eKgTiwAo_o.png" width="933"></p> 
<h3>3.基于 jQuery 的 AJAX 语法</h3> 
<p>$.ajax({<!-- --></p> 
<p>        属性，</p> 
<p>})</p> 
<p><strong>常用的属性参数：</strong></p> 
<table border="1" cellpadding="1" cellspacing="1" style="width:650px;"><tbody><tr><td style="text-align:center;">url</td><td style="text-align:center;">请求的后端服务地址</td></tr><tr><td style="text-align:center;">type</td><td style="text-align:center;">请求方式，默认 get</td></tr><tr><td style="text-align:center;">data</td><td style="text-align:center;">请求所携带的参数</td></tr><tr><td style="text-align:center;">dataType</td><td style="text-align:center;">服务器返回的数据类型：text / json</td></tr><tr><td style="text-align:center;">success</td><td style="text-align:center;">请求成功的回调函数</td></tr><tr><td style="text-align:center;">error</td><td style="text-align:center;">请求失败的回调函数</td></tr><tr><td style="text-align:center;">complete</td><td style="text-align:center;">请求完成的回调函数（无论成功或者失败，都会调用）</td></tr></tbody></table> 
<pre><code class="language-html">&lt;%@ page contentType="text/html;charset=UTF-8" language="java" %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
    &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;input id="text" type="text"/&gt;&lt;br/&gt;
    &lt;input id="btn" type="button" value="提交"/&gt;

    &lt;script type="text/javascript"&gt;
        $(function () {
            var btn = $("#btn");
            btn.click(function () {
                $.ajax({
                    url: '/test',
                    type: 'post',
                    data: 'id=1',
                    dataType: 'text',
                    success: function (data) {
                        var text = $("#text");
                        text.before("&lt;span&gt;" + data + "&lt;/span&gt;&lt;br/&gt;");
                    }
                });
            });
        })
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre> 
<pre><code class="language-java">@WebServlet("/test")
public class TestServlet extends HttpServlet {
    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        String id = req.getParameter("id");
        try {
            Thread.sleep(1500);//1.5s
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        String str = "Hello World";
        resp.getWriter().write(str);
    }
}
</code></pre> 
<p><strong>注意：</strong></p> 
<p>①<span style="color:#fe2c24;"> 不能用表单提交请求（同步请求），改用 jQuery 方式动态绑定事件来提交。</span></p> 
<p>② <span style="color:#fe2c24;">Servlet 不能跳转到 jsp，只能将数据返回（通过 response.getWriter() 将数据写回到页面）。</span></p> 
<p><span style="color:#0d0016;">success 回调函数中的 data，就代表返回的数据。</span></p> 
<p>如果跳转到 jsp 的话，会将 jsp 的整个页面代码作为 data 返回。</p> 
<h3>4.传统的 WEB 数据交互 与 AJAX 数据交互 的区别</h3> 
<p>① 客户端请求的方式不同：</p> 
<p>        传统：浏览器发送同步请求 （form、a）</p> 
<p>        AJAX：异步引擎对象发送异步请求</p> 
<p>② 服务器响应的⽅式不同：</p> 
<p>        传统：响应⼀个完整 JSP 页面（视图）</p> 
<p>        AJAX：响应需要的数据</p> 
<p>③ 客户端处理方式不同：</p> 
<p>        传统：需要等待服务器完成响应并且重新加载整个页面之后，用户才能进行后续的操作。</p> 
<p>        AJAX：动态更新页面中的局部内容，不影响用户的其他操作</p> 
<h2>二、Json</h2> 
<h3>1.定义</h3> 
<p>JavaScript Object Notation：⼀种轻量级数据交互格式，完成 js 与 Java 等后端开发语⾔对象数据之间的转换 。</p> 
<p>客户端和服务器之间传递对象数据，需要用到 JSON 格式。</p> 
<h3>2.使用步骤：</h3> 
<p>① 导入 json 依赖</p> 
<pre><code class="language-XML">        &lt;!-- 添加JSON依赖--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;net.sf.json-lib&lt;/groupId&gt;
            &lt;artifactId&gt;json-lib&lt;/artifactId&gt;
            &lt;version&gt;2.4&lt;/version&gt;
            &lt;!-- 必须添加JDK版本号--&gt;
            &lt;classifier&gt;jdk15&lt;/classifier&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;commons-beanutils&lt;/groupId&gt;
            &lt;artifactId&gt;commons-beanutils&lt;/artifactId&gt;
            &lt;version&gt;1.9.2&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;commons-collections&lt;/groupId&gt;
            &lt;artifactId&gt;commons-collections&lt;/artifactId&gt;
            &lt;version&gt;3.2.1&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;commons-lang&lt;/groupId&gt;
            &lt;artifactId&gt;commons-lang&lt;/artifactId&gt;
            &lt;version&gt;2.5&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;net.sf.ezmorph&lt;/groupId&gt;
            &lt;artifactId&gt;ezmorph&lt;/artifactId&gt;
            &lt;version&gt;1.0.3&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;commons-logging&lt;/groupId&gt;
            &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;
            &lt;version&gt;1.2&lt;/version&gt;
        &lt;/dependency&gt;</code></pre> 
<p>② 将 Java 对象转换为 Json 格式</p> 
<pre><code class="language-java">public class TestServlet extends HttpServlet {
    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws IOException {
        User user = new User(1, "张三", 96.5);
        //处理中文乱码
        resp.setCharacterEncoding("UTF-8");
         //将 Java 对象转为 JSON 格式
        JSONObject jsonObject = JSONObject.fromObject(user);
        resp.getWriter().write(jsonObject.toString());
    }
}</code></pre> 
<p><strong>注意：</strong></p> 
<p>如果是一个普通的 Java 对象，使用 JSONObject.fromObject() 进行转换；</p> 
<p>如果是一个 Java 对象的集合，使用 JSONArray.fromObject() 进行转换；</p> 
<p><span style="color:#fe2c24;">如果是多个 Java 对象的集合，可以创造一个类进行封装，类的属性就是这多个集合。然后返回该对象，如下：</span></p> 
<pre><code class="language-java">public class Location {
    private List&lt;String&gt; cities;//市
    private List&lt;String&gt; areas;//区

    public List&lt;String&gt; getCities() {
        return cities;
    }

    public void setCities(List&lt;String&gt; cities) {
        this.cities = cities;
    }

    public List&lt;String&gt; getAreas() {
        return areas;
    }

    public void setAreas(List&lt;String&gt; areas) {
        this.areas = areas;
    }
}
</code></pre> 
<p>③ Ajax 中以 json 格式返回数据</p> 
<pre><code class="language-html">&lt;%@ page contentType="text/html;charset=UTF-8" language="java" %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
    &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
    编号：&lt;input id="id" type="text"/&gt;&lt;br/&gt;
    姓名：&lt;input id="name" type="text"/&gt;&lt;br/&gt;
    成绩：&lt;input id="score" type="text"/&gt;&lt;br/&gt;
    &lt;input id="btn" type="button" value="提交"/&gt;

    &lt;script type="text/javascript"&gt;
        $(function () {
            var btn = $("#btn");
            btn.click(function () {
                $.ajax({
                    url:'/test',
                    type:'post',
                    dataType:'json',
                    success:function(data){
                        $("#id").val(data.id);
                        $("#name").val(data.name);
                        $("#score").val(data.score);
                    }
                })
            });
        })
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2369b7a05ebfc8b9a0d8fa25663b8721/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Hadoop集群搭建】完全分布式 Hadoop 安装部署及测试</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ab5cb70f28fa381face8b3f2ee173f80/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【微信小程序知识点】转发功能的实现</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>