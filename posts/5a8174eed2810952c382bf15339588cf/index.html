<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python调用MATLAB程序 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/5a8174eed2810952c382bf15339588cf/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Python调用MATLAB程序">
  <meta property="og:description" content="提示：版本要求：Python 3.7，MATLB R2020a
文章目录 前言一、常规方法1.1 MATLAB配置MATLAB Engine API for Python1.2 测试Python 二、解决方案2.1 创建新的Python虚拟环境2.2 MATLAB配置MATLAB Engine API for Python2.3 Python配置MATLAB Engine API for Python 三、调用测试总结 前言 为纪念2024年1月16日浪费的4个小时，而创作本教程，以明晰如何在Python程序中顺利调用MATLAB。同时，在这里，感谢ChatGPT在我调试程序解决bug过程中的知无不言，无私奉献，耐心指导。
关键字：Python调用MATLAB，matlab.engine，MATLAB Engine for Python 一、常规方法 常规方法不一定适合所有可能遇到的情况
1.1 MATLAB配置MATLAB Engine API for Python 打开MATLAB软件（本文中指的是MATLAB R2020a），在命令行输入以下指令并回车执行： fullfile(matlabroot, &#39;extern&#39;, &#39;engines&#39;, &#39;python&#39;) 该命令旨在找到 MATLAB Engine API for Python 安装脚本所在的路径。这里，给出明确的安装脚本所在路径C:\Program Files\MATLAB\R2020a\extern\engines\python，安装脚本为该路径下的python文件setup.py
进入MATLAB Engine API for Python 目录（下面两条指令作用一致）： cd (fullfile(matlabroot,&#39;extern&#39;,&#39;engines&#39;,&#39;python&#39;)) % MATLAB命令窗口 cd /path/to/matlab/extern/engines/python % Windows PowerShell 运行安装脚本： system(&#39;python setup.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-16T15:07:35+08:00">
    <meta property="article:modified_time" content="2024-01-16T15:07:35+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python调用MATLAB程序</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>提示：版本要求：Python 3.7，MATLB R2020a</p> 
</blockquote> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_7" rel="nofollow">前言</a></li><li><a href="#_13" rel="nofollow">一、常规方法</a></li><li><ul><li><a href="#11_MATLABMATLAB_Engine_API_for_Python_16" rel="nofollow">1.1 MATLAB配置MATLAB Engine API for Python</a></li><li><a href="#12_Python_42" rel="nofollow">1.2 测试Python</a></li></ul> 
  </li><li><a href="#_54" rel="nofollow">二、解决方案</a></li><li><ul><li><a href="#21_Python_55" rel="nofollow">2.1 创建新的Python虚拟环境</a></li><li><a href="#22_MATLABMATLAB_Engine_API_for_Python_60" rel="nofollow">2.2 MATLAB配置MATLAB Engine API for Python</a></li><li><a href="#23_PythonMATLAB_Engine_API_for_Python_91" rel="nofollow">2.3 Python配置MATLAB Engine API for Python</a></li></ul> 
  </li><li><a href="#_131" rel="nofollow">三、调用测试</a></li><li><a href="#_144" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_7"></a>前言</h2> 
<p>为纪念2024年1月16日浪费的4个小时，而创作本教程，以明晰如何在Python程序中顺利调用MATLAB。同时，在这里，感谢ChatGPT在我调试程序解决bug过程中的知无不言，无私奉献，耐心指导。</p> 
<p><code>关键字：Python调用MATLAB，matlab.engine，MATLAB Engine for Python </code></p> 
<hr> 
<h2><a id="_13"></a>一、常规方法</h2> 
<p><code>常规方法不一定适合所有可能遇到的情况</code></p> 
<h3><a id="11_MATLABMATLAB_Engine_API_for_Python_16"></a>1.1 MATLAB配置MATLAB Engine API for Python</h3> 
<ul><li>打开MATLAB软件（本文中指的是MATLAB R2020a），在命令行输入以下指令并回车执行：</li></ul> 
<pre><code class="prism language-bash">fullfile<span class="token punctuation">(</span>matlabroot, <span class="token string">'extern'</span>, <span class="token string">'engines'</span>, <span class="token string">'python'</span><span class="token punctuation">)</span>
</code></pre> 
<p>该命令旨在找到 MATLAB Engine API for Python 安装脚本所在的路径。这里，给出明确的安装脚本所在路径<code>C:\Program Files\MATLAB\R2020a\extern\engines\python</code>，安装脚本为该路径下的python文件<code>setup.py</code></p> 
<p><img src="https://images2.imgbox.com/bf/41/GWtxJz3L_o.png" alt="在这里插入图片描述"></p> 
<ul><li>进入MATLAB Engine API for Python 目录（下面两条指令作用一致）：</li></ul> 
<pre><code class="prism language-bash"><span class="token builtin class-name">cd</span> <span class="token punctuation">(</span>fullfile<span class="token punctuation">(</span>matlabroot,<span class="token string">'extern'</span>,<span class="token string">'engines'</span>,<span class="token string">'python'</span><span class="token punctuation">))</span>  % MATLAB命令窗口
<span class="token builtin class-name">cd</span> /path/to/matlab/extern/engines/python               % Windows PowerShell
</code></pre> 
<ul><li>运行安装脚本：</li></ul> 
<pre><code class="prism language-bash">system<span class="token punctuation">(</span><span class="token string">'python setup.py install'</span><span class="token punctuation">)</span>   % MATLAB命令窗口
python setup.py <span class="token function">install</span>             % Windows PowerShell
</code></pre> 
<p><img src="https://images2.imgbox.com/cd/53/mEPFSHjq_o.png" alt="在这里插入图片描述"><br> 正常情况下，这样MATLAB便配置MATLAB Engine API for Python成功了。若报错，请耐心浏览本教程第二部分内容。<br> 报错内容为</p> 
<pre><code>OSError: MATLAB Engine for Python supports Python version 2.7, 3.6, and 3.7, but your version of Python is 3.11
</code></pre> 
<h3><a id="12_Python_42"></a>1.2 测试Python</h3> 
<ul><li>验证安装。打开Python程序，导入：</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matlab<span class="token punctuation">.</span>engine
</code></pre> 
<p><img src="https://images2.imgbox.com/c7/22/q3EPLC8F_o.png" alt="在这里插入图片描述"></p> 
<p>正常情况下，无报错说明Python已经可以调用MATLAB程序了。若报错，请耐心浏览本教程第二部分内容。<br> 报错内容为</p> 
<pre><code>No module named matlab
</code></pre> 
<h2><a id="_54"></a>二、解决方案</h2> 
<h3><a id="21_Python_55"></a>2.1 创建新的Python虚拟环境</h3> 
<p>由于MATLAB R2020a目前只支持Python的三个版本（2.7, 3.6, 3.7），MATLAB默认的Python的环境不再使用（MATLAB R2020a默认的Python是3.11版本），且系统安装的Python环境所对应的版本也不一定是3.7。因此，建议使用conda新建一个Python虚拟环境（安装Anaconda以及配置的内容不再赘述）。假设已经安装了conda，那么，打开Anaconda的Anaconda PowerShell Prompt窗口，输入以下命令并回车执行：</p> 
<pre><code class="prism language-bash">conda create <span class="token parameter variable">-n</span> EAS <span class="token assign-left variable">python</span><span class="token operator">=</span><span class="token number">3.7</span>
</code></pre> 
<h3><a id="22_MATLABMATLAB_Engine_API_for_Python_60"></a>2.2 MATLAB配置MATLAB Engine API for Python</h3> 
<ul><li>查看当前MATLAB的Python版本及路径。在MATLAB命令行输入并执行：</li></ul> 
<pre><code class="prism language-bash">pyversion
</code></pre> 
<p>返回内容为：</p> 
<pre><code>       version: '3.11'
    executable: 'F:\Python\python.EXE'
       library: 'F:\Python\python311.dll'
          home: 'F:\Python'
      isloaded: 0
</code></pre> 
<ul><li>更改MATLAB的Python解释器为新建的Python虚拟环境下的版本（系统默认的conda虚拟环境目录为<code>C:\Users\admin\.conda\envs</code>）：</li></ul> 
<pre><code class="prism language-bash">new_python_path <span class="token operator">=</span> <span class="token string">'C:\Users\admin\.conda\envs\EAS\python'</span><span class="token punctuation">;</span>
pyversion<span class="token punctuation">(</span>new_python_path<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>查看MATLAB的Python版本及路径。在MATLAB命令行输入并执行：</li></ul> 
<pre><code class="prism language-bash">pyversion
</code></pre> 
<p><img src="https://images2.imgbox.com/a7/b6/4Ie5IVoG_o.png" alt="在这里插入图片描述"></p> 
<ul><li>尝试安装MATLAB Engine API for Python。进入MATLAB Engine API for Python 目录，并运行安装脚本：</li></ul> 
<pre><code class="prism language-bash"><span class="token builtin class-name">cd</span> <span class="token punctuation">(</span>fullfile<span class="token punctuation">(</span>matlabroot,<span class="token string">'extern'</span>,<span class="token string">'engines'</span>,<span class="token string">'python'</span><span class="token punctuation">))</span>
system<span class="token punctuation">(</span><span class="token string">'python setup.py install'</span><span class="token punctuation">)</span>
</code></pre> 
<p>若仍然报错，请继续耐心阅读本文。<br> <img src="https://images2.imgbox.com/42/3b/2iwhpCaB_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="23_PythonMATLAB_Engine_API_for_Python_91"></a>2.3 Python配置MATLAB Engine API for Python</h3> 
<p>由于MATLAB无法解决安装及配置问题，在接下来的内容将尝试在Python中解决上述问题。现在的主要目的是在新建的Python虚拟环境中实现matlab.engine的导入，即配置MATLAB Engine API for Python。以下内容在Anaconda的Anaconda PowerShell Prompt窗口中运行。</p> 
<ul><li>激活新建的Python虚拟环境，并进入MATLAB Engine API for Python所在的文件目录：</li></ul> 
<pre><code class="prism language-bash">conda activate EAS
<span class="token builtin class-name">cd</span> <span class="token string">"C:\Program Files\MATLAB\R2020a<span class="token entity" title="\e">\e</span>xtern<span class="token entity" title="\e">\e</span>ngines\python"</span>
</code></pre> 
<ul><li>运行该目录下的安装脚本：</li></ul> 
<pre><code class="prism language-bash">python setup.py <span class="token function">install</span>
</code></pre> 
<p>若报错（拒绝访问），说明未获得权限操作C盘的文件。请使用管理员权限重新打开Anaconda PowerShell Prompt窗口，并执行上述指令。<br> <img src="https://images2.imgbox.com/6c/25/NuHUxhHN_o.png" alt="在这里插入图片描述"></p> 
<ul><li>安装脚本运行成功后将显示：</li></ul> 
<p><img src="https://images2.imgbox.com/74/44/uCRinoyh_o.png" alt="在这里插入图片描述"></p> 
<ul><li>使用pip指令查看是否已成功安装matlabengineforpython：</li></ul> 
<pre><code class="prism language-bash">pip list
</code></pre> 
<p><img src="https://images2.imgbox.com/12/56/b7gaZ6XH_o.png" alt="在这里插入图片描述"></p> 
<ul><li>验证安装。打开Python程序，导入：</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matlab<span class="token punctuation">.</span>engine
</code></pre> 
<p><img src="https://images2.imgbox.com/b7/19/r0HXmlYj_o.png" alt="在这里插入图片描述"><br> 所继续报错，且报错内容为：</p> 
<pre><code>No module named 'matlab.engine'; 'matlab' is not a package
</code></pre> 
<ul><li>调整新建Python虚拟环境的文件结构（本小节是摸索出的结果，不一定靠谱，但是确实解决了问题）</li></ul> 
<p>打开新建的Python虚拟环境的路径<code>C:\Users\admin\.conda\envs\EAS</code>，进入到<code>Lib</code>，找到<code>site-packages</code>文件夹<br> <img src="https://images2.imgbox.com/eb/84/eEmPH4f8_o.png" alt="在这里插入图片描述"><br> 打开<code>site-packages</code>文件夹，找到并打开<code>matlabengineforpython-R2020a-py3.7.egg</code>文件夹，复制该文件夹中的<code>matlab</code>文件夹<br> <img src="https://images2.imgbox.com/97/f9/afJMA3Jf_o.png" alt="在这里插入图片描述"><br> 回退到<code>site-packages</code>文件夹中，即当前路径为<code>C:\Users\admin\.conda\envs\EAS\Lib\site-packages</code>，将文件夹粘贴在当前路径下：<br> <img src="https://images2.imgbox.com/dd/97/e8jvhhGe_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_131"></a>三、调用测试</h2> 
<p>如下图所示，调用的具体要求是：在<code>main.py</code>文件中调用<code>rongliangyunxing.m</code>文件的函数<code>rongliangyunxing</code><br> <img src="https://images2.imgbox.com/2e/70/HqVfpuI8_o.png" alt="在这里插入图片描述"><br> 具体地，函数有一个字符串形式的输入参数，返回一个浮点数：<br> <img src="https://images2.imgbox.com/88/aa/lnSUtRIn_o.png" alt="在这里插入图片描述"><br> python的调用测试程序为：<br> <img src="https://images2.imgbox.com/13/ff/tQbhazFB_o.png" alt="在这里插入图片描述"><br> 运行结果为：<br> <img src="https://images2.imgbox.com/d1/b6/q09FIoOO_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_144"></a>总结</h2> 
<p>没心情总结…</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1da10ebcd4fe3a54747a2458259e3acc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">AndroidStudio开发实现一个音乐播放器</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3d87482f1aa775a080af755d7ef6b182/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Android显示系统SurfaceFlinger详解 超级干货</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>