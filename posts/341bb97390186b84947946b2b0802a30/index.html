<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>DVWA 靶场 JavaScript 通关解析 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/341bb97390186b84947946b2b0802a30/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="DVWA 靶场 JavaScript 通关解析">
  <meta property="og:description" content="前言 DVWA代表Damn Vulnerable Web Application，是一个用于学习和练习Web应用程序漏洞的开源漏洞应用程序。它被设计成一个易于安装和配置的漏洞应用程序，旨在帮助安全专业人员和爱好者了解和熟悉不同类型的Web应用程序漏洞。
DVWA提供了一系列的漏洞场景和练习环境，用户可以通过攻击这些漏洞场景来学习和实践漏洞利用技术。这些漏洞包括常见的安全问题，如SQL注入、跨站脚本攻击（XSS）、文件包含漏洞等。通过攻击这些漏洞，用户可以了解漏洞的原理、影响和防御方法。
DVWA提供了不同的安全级别，从低到高，以满足不同技能水平的用户需求。用户可以根据自己的能力选择适当的安全级别，并进行相应的练习和挑战。
DVWA还提供了一些额外的功能和工具，如Web代理、密码破解、弱密码检测等，以帮助用户更好地理解和处理漏洞问题。
总之，DVWA是一个用于学习和练习Web应用程序漏洞的开源应用程序。它提供了一系列的漏洞场景和练习环境，帮助安全专业人员和爱好者提高对Web应用程序安全的理解和实践能力。通过使用DVWA，用户可以加深对Web应用程序漏洞的认识，并学习如何有效地保护Web应用程序免受攻击。
介绍 JavaScript 攻击是一类通过利用 JavaScript 代码执行漏洞或滥用其特性来进行的网络攻击。这些攻击可以用来窃取敏感信息、劫持用户会话、执行恶意操作等。以下是几种常见的 JavaScript 攻击及其防御方法的详细介绍：
一、跨站脚本攻击 (Cross-Site Scripting, XSS)
1. 存储型 XSS（Stored XSS）
攻击者将恶意 JavaScript 代码存储在目标网站的数据库中。当其他用户访问包含这些恶意代码的页面时，代码会在用户的浏览器中执行，从而窃取用户信息或执行其他恶意操作。
2. 反射型 XSS（Reflected XSS）
恶意 JavaScript 代码通过 URL 参数传递给服务器，服务器在响应中包含这些代码并发送给用户。当用户点击恶意链接时，代码在用户的浏览器中执行。
3. 基于 DOM 的 XSS（DOM-based XSS）
恶意 JavaScript 代码直接修改网页的 DOM 结构，不通过服务器端处理。通常通过修改 URL 或其他客户端输入来实现。
防御措施：
输入验证和输出编码：对用户输入进行严格验证，并在输出到 HTML、JavaScript、CSS 或 URL 时进行正确的编码。内容安全策略 (Content Security Policy, CSP)：使用 CSP 限制浏览器加载和执行的内容，防止执行未授权的脚本。安全框架和库：使用安全的框架和库，自动处理编码和验证（如 Angular、React 等）。 二、跨站请求伪造 (Cross-Site Request Forgery, CSRF)
攻击者诱使受害者在已认证的情况下执行非预期的操作，例如提交表单、发送请求等，从而执行未经授权的操作。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-22T13:19:15+08:00">
    <meta property="article:modified_time" content="2024-06-22T13:19:15+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">DVWA 靶场 JavaScript 通关解析</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>前言</h2> 
<p>DVWA代表Damn Vulnerable Web Application，是一个用于学习和练习Web应用程序漏洞的开源漏洞应用程序。它被设计成一个易于安装和配置的漏洞应用程序，旨在帮助安全专业人员和爱好者了解和熟悉不同类型的Web应用程序漏洞。</p> 
<p>DVWA提供了一系列的漏洞场景和练习环境，用户可以通过攻击这些漏洞场景来学习和实践漏洞利用技术。这些漏洞包括常见的安全问题，如SQL注入、跨站脚本攻击（XSS）、文件包含漏洞等。通过攻击这些漏洞，用户可以了解漏洞的原理、影响和防御方法。</p> 
<p>DVWA提供了不同的安全级别，从低到高，以满足不同技能水平的用户需求。用户可以根据自己的能力选择适当的安全级别，并进行相应的练习和挑战。</p> 
<p>DVWA还提供了一些额外的功能和工具，如Web代理、密码破解、弱密码检测等，以帮助用户更好地理解和处理漏洞问题。</p> 
<p>总之，DVWA是一个用于学习和练习Web应用程序漏洞的开源应用程序。它提供了一系列的漏洞场景和练习环境，帮助安全专业人员和爱好者提高对Web应用程序安全的理解和实践能力。通过使用DVWA，用户可以加深对Web应用程序漏洞的认识，并学习如何有效地保护Web应用程序免受攻击。</p> 
<h2>介绍</h2> 
<p>JavaScript 攻击是一类通过利用 JavaScript 代码执行漏洞或滥用其特性来进行的网络攻击。这些攻击可以用来窃取敏感信息、劫持用户会话、执行恶意操作等。以下是几种常见的 JavaScript 攻击及其防御方法的详细介绍：</p> 
<p><strong>一、跨站脚本攻击 (Cross-Site Scripting, XSS)</strong></p> 
<p>1. 存储型 XSS（Stored XSS）</p> 
<p>攻击者将恶意 JavaScript 代码存储在目标网站的数据库中。当其他用户访问包含这些恶意代码的页面时，代码会在用户的浏览器中执行，从而窃取用户信息或执行其他恶意操作。</p> 
<p>2. 反射型 XSS（Reflected XSS）</p> 
<p>恶意 JavaScript 代码通过 URL 参数传递给服务器，服务器在响应中包含这些代码并发送给用户。当用户点击恶意链接时，代码在用户的浏览器中执行。</p> 
<p>3. 基于 DOM 的 XSS（DOM-based XSS）</p> 
<p>恶意 JavaScript 代码直接修改网页的 DOM 结构，不通过服务器端处理。通常通过修改 URL 或其他客户端输入来实现。</p> 
<p><strong>防御措施</strong>：</p> 
<ul><li>输入验证和输出编码：对用户输入进行严格验证，并在输出到 HTML、JavaScript、CSS 或 URL 时进行正确的编码。</li><li>内容安全策略 (Content Security Policy, CSP)：使用 CSP 限制浏览器加载和执行的内容，防止执行未授权的脚本。</li><li>安全框架和库：使用安全的框架和库，自动处理编码和验证（如 Angular、React 等）。</li></ul> 
<p><strong>二、跨站请求伪造 (Cross-Site Request Forgery, CSRF)</strong></p> 
<p>攻击者诱使受害者在已认证的情况下执行非预期的操作，例如提交表单、发送请求等，从而执行未经授权的操作。</p> 
<p><strong>防御措施</strong>：</p> 
<ul><li>CSRF 令牌：在每个表单或请求中包含唯一的 CSRF 令牌，并在服务器端进行验证。</li><li>同源策略 (SameSite) Cookie：设置 SameSite 属性的 Cookie，防止跨站点请求携带 Cookie。</li><li>双重提交 Cookie：在请求中包含 CSRF 令牌，同时通过 Cookie 发送，服务器验证两者是否一致。</li></ul> 
<p><strong>三、点击劫持 (Clickjacking)</strong></p> 
<p>攻击者使用透明或隐藏的 iframe 覆盖目标网页，当用户点击网页时，实际上点击的是攻击者控制的内容，从而执行恶意操作。</p> 
<p><strong>防御措施</strong>：</p> 
<ul><li>X-Frame-Options 头：通过设置 HTTP 响应头 <code>X-Frame-Options</code> 为 <code>DENY</code> 或 <code>SAMEORIGIN</code>，防止网页被嵌入到 iframe 中。</li><li>Content Security Policy (CSP) 框架策略：使用 CSP 的 <code>frame-ancestors</code> 指令限制页面可以嵌入的父级域。</li></ul> 
<p><strong>四、恶意脚本注入</strong></p> 
<p>攻击者通过输入恶意脚本，在不受信任的环境中执行，从而窃取数据、篡改页面或进行其他恶意操作。</p> 
<p><strong>防御措施</strong>：</p> 
<ul><li>输入验证：严格验证和清理所有用户输入，防止注入恶意脚本。</li><li>输出编码：在输出数据到 HTML、JavaScript、CSS 或 URL 时进行正确的编码，防止脚本执行。</li><li>使用安全的 API：尽量避免直接操作 DOM，使用安全的 API 处理用户输入。</li></ul> 
<p><strong>五、JavaScript 依赖注入攻击</strong></p> 
<p>攻击者通过操控依赖库或供应链，将恶意代码注入到应用中，从而执行恶意操作。</p> 
<p><strong>防御措施</strong>：</p> 
<ul><li>依赖管理：使用可靠的依赖管理工具（如 npm、yarn），并定期更新和检查依赖库。</li><li>安全审计：对依赖库进行安全审计，确保没有已知的漏洞。</li><li>使用锁定文件：使用 <code>package-lock.json</code> 或 <code>yarn.lock</code> 文件锁定依赖版本，防止意外更新到有漏洞的版本。</li></ul> 
<p><strong>六、跨站脚本包含 (Cross-Site Script Inclusion, XSSI)</strong></p> 
<p>攻击者通过引入恶意的 JavaScript 文件，窃取敏感信息或执行恶意操作。</p> 
<p><strong>防御措施</strong>：</p> 
<ul><li>验证来源：确保引入的所有 JavaScript 文件都来自受信任的来源。</li><li>使用 Subresource Integrity (SRI)：使用 SRI 哈希校验引入的资源，确保资源未被篡改。</li><li>内容安全策略 (CSP)：使用 CSP 限制加载的脚本源，防止加载未授权的脚本。</li></ul> 
<p><strong>七、JSON 劫持</strong></p> 
<p>攻击者利用浏览器的 JSON 解析漏洞，窃取跨域 JSON 数据。</p> 
<p><strong>防御措施</strong>：</p> 
<ul><li>防止 JSONP：避免使用 JSONP 或严格控制 JSONP 的使用。</li><li>安全头部：在返回的 JSON 数据前添加安全头部，例如 <code>)]}',\n</code>，使其不被解析为合法的 JavaScript。</li></ul> 
<h2>一、Low</h2> 
<p>打开靶场提示输入 success</p> 
<p class="img-center"><img alt="" height="661" src="https://images2.imgbox.com/b5/15/feHF6Dp3_o.png" width="883"></p> 
<p>输入后提交提示 token 不对</p> 
<p class="img-center"><img alt="" height="429" src="https://images2.imgbox.com/90/d6/nqbuXkJr_o.png" width="701"></p> 
<p>抓包看一下，有提交参数与 token</p> 
<p class="img-center"><img alt="" height="573" src="https://images2.imgbox.com/a7/a6/AVliAaTA_o.png" width="1200"></p> 
<p>重新提交下表单，这次是默认值</p> 
<p class="img-center"><img alt="" height="535" src="https://images2.imgbox.com/9a/e3/jhSjQdlJ_o.png" width="1200"></p> 
<p>发现 token 值是一致的，现在就是要研究如何改变 token 值</p> 
<p>查看页面源代码发现 JS 代码</p> 
<p class="img-center"><img alt="" height="720" src="https://images2.imgbox.com/c9/23/yeEDXQIj_o.png" width="1200"></p> 
<p>这下懂了吧，token 值一直是与 ChangeMe 关联的，难怪报错  </p> 
<pre><code class="language-javascript">function generate_token() {
		var phrase = document.getElementById("phrase").value;
		document.getElementById("token").value = md5(rot13(phrase));
	}

	generate_token();</code></pre> 
<p>所以需要手动重新调用下 token 来更新（输入 success 后）</p> 
<p class="img-center"><img alt="" height="333" src="https://images2.imgbox.com/36/33/de8COTKX_o.png" width="573"></p> 
<p>成功！ </p> 
<p class="img-center"><img alt="" height="380" src="https://images2.imgbox.com/31/a8/pZMobvTB_o.png" width="710"></p> 
<h2 style="background-color:transparent;">二、Medium</h2> 
<p>还是一样的，直接提交不行，先抓包看看</p> 
<p class="img-center"><img alt="" height="601" src="https://images2.imgbox.com/cf/f6/UzTgGZmm_o.png" width="1027"></p> 
<p>可以看到 token 值是倒过来的默认值</p> 
<p class="img-center"><img alt="" height="521" src="https://images2.imgbox.com/e7/b9/zRGVXkeG_o.png" width="1188"></p> 
<p>再次提交默认值确认一下</p> 
<p class="img-center"><img alt="" height="489" src="https://images2.imgbox.com/59/47/jG0jK4iE_o.png" width="666"></p> 
<p>第一种是手动更改 token 值然后放行 </p> 
<p class="img-center"><img alt="" height="527" src="https://images2.imgbox.com/0d/07/te4RS04k_o.png" width="676"></p> 
<p>成功！！！ </p> 
<p><img alt="" height="457" src="https://images2.imgbox.com/ed/1e/fYyWJAeS_o.png" width="790"></p> 
<p>第二种就是看 JS 源码，通过网络请求直接查看</p> 
<p class="img-center"><img alt="" height="411" src="https://images2.imgbox.com/7d/e0/aGsAkqGs_o.png" width="1060"></p> 
<pre><code class="language-javascript">function do_something(e) {
    for (var t = "", n = e.length - 1; n &gt;= 0; n--)
        t += e[n];
    return t
}
setTimeout(function() {
    do_elsesomething("XX")
}, 300);
function do_elsesomething(e) {
    document.getElementById("token").value = do_something(e + document.getElementById("phrase").value + "XX")
}</code></pre> 
<p>道理和第一关一样的，获取的 token 开始是默认值</p> 
<p class="img-center"><img alt="" height="817" src="https://images2.imgbox.com/76/19/Asv2E447_o.png" width="1069"></p> 
<h2>三、High</h2> 
<p>还是先抓包看 token</p> 
<p class="img-center"><img alt="" height="561" src="https://images2.imgbox.com/1d/7b/vAHHKTzz_o.png" width="1181"></p> 
<p>网络请求找到 JS 源码</p> 
<p class="img-center"><img alt="" height="451" src="https://images2.imgbox.com/29/b6/ya3lfRc2_o.png" width="790"></p> 
<pre><code class="language-javascript">var a = ['fromCharCode', 'toString', 'replace', 'BeJ', '\x5cw+', 'Lyg', 'SuR', '(w(){\x273M\x203L\x27;q\x201l=\x273K\x203I\x203J\x20T\x27;q\x201R=1c\x202I===\x271n\x27;q\x20Y=1R?2I:{};p(Y.3N){1R=1O}q\x202L=!1R&amp;&amp;1c\x202M===\x271n\x27;q\x202o=!Y.2S&amp;&amp;1c\x202d===\x271n\x27&amp;&amp;2d.2Q&amp;&amp;2d.2Q.3S;p(2o){Y=3R}z\x20p(2L){Y=2M}q\x202G=!Y.3Q&amp;&amp;1c\x202g===\x271n\x27&amp;&amp;2g.X;q\x202s=1c\x202l===\x27w\x27&amp;&amp;2l.3P;q\x201y=!Y.3H&amp;&amp;1c\x20Z!==\x272T\x27;q\x20m=\x273G\x27.3z(\x27\x27);q\x202w=[-3y,3x,3v,3w];q\x20U=[24,16,8,0];q\x20K=[3A,3B,3F,3E,3D,3C,3T,3U,4d,4c,4b,49,4a,4e,4f,4j,4i,4h,3u,48,47,3Z,3Y,3X,3V,3W,40,41,46,45,43,42,4k,3f,38,36,39,37,34,33,2Y,31,2Z,35,3t,3n,3m,3l,3o,3p,3s,3r,3q,3k,3j,3d,3a,3c,3b,3e,3h,3g,3i,4g];q\x201E=[\x271e\x27,\x2727\x27,\x271G\x27,\x272R\x27];q\x20l=[];p(Y.2S||!1z.1K){1z.1K=w(1x){A\x204C.Q.2U.1I(1x)===\x27[1n\x201z]\x27}}p(1y&amp;&amp;(Y.50||!Z.1N)){Z.1N=w(1x){A\x201c\x201x===\x271n\x27&amp;&amp;1x.1w&amp;&amp;1x.1w.1J===Z}}q\x202m=w(1X,x){A\x20w(s){A\x20O\x20N(x,1d).S(s)[1X]()}};q\x202a=w(x){q\x20P=2m(\x271e\x27,x);p(2o){P=2P(P,x)}P.1T=w(){A\x20O\x20N(x)};P.S=w(s){A\x20P.1T().S(s)};1g(q\x20i=0;i&lt;1E.W;++i){q\x20T=1E[i];P[T]=2m(T,x)}A\x20P};q\x202P=w(P,x){q\x201S=2O(\x222N(\x271S\x27)\x22);q\x201Y=2O(\x222N(\x271w\x27).1Y\x22);q\x202n=x?\x271H\x27:\x271q\x27;q\x202z=w(s){p(1c\x20s===\x272p\x27){A\x201S.2x(2n).S(s,\x274S\x27).1G(\x271e\x27)}z{p(s===2q||s===2T){1u\x20O\x201t(1l)}z\x20p(s.1J===Z){s=O\x202r(s)}}p(1z.1K(s)||Z.1N(s)||s.1J===1Y){A\x201S.2x(2n).S(O\x201Y(s)).1G(\x271e\x27)}z{A\x20P(s)}};A\x202z};q\x202k=w(1X,x){A\x20w(G,s){A\x20O\x201P(G,x,1d).S(s)[1X]()}};q\x202f=w(x){q\x20P=2k(\x271e\x27,x);P.1T=w(G){A\x20O\x201P(G,x)};P.S=w(G,s){A\x20P.1T(G).S(s)};1g(q\x20i=0;i&lt;1E.W;++i){q\x20T=1E[i];P[T]=2k(T,x)}A\x20P};w\x20N(x,1v){p(1v){l[0]=l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0;k.l=l}z{k.l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}p(x){k.C=4I;k.B=4H;k.E=4l;k.F=4U;k.J=4J;k.I=4K;k.H=4L;k.D=4T}z{k.C=4X;k.B=4W;k.E=4Y;k.F=4Z;k.J=4V;k.I=4O;k.H=4F;k.D=4s}k.1C=k.1A=k.L=k.2i=0;k.1U=k.1L=1O;k.2j=1d;k.x=x}N.Q.S=w(s){p(k.1U){A}q\x202h,T=1c\x20s;p(T!==\x272p\x27){p(T===\x271n\x27){p(s===2q){1u\x20O\x201t(1l)}z\x20p(1y&amp;&amp;s.1J===Z){s=O\x202r(s)}z\x20p(!1z.1K(s)){p(!1y||!Z.1N(s)){1u\x20O\x201t(1l)}}}z{1u\x20O\x201t(1l)}2h=1d}q\x20r,M=0,i,W=s.W,l=k.l;4t(M&lt;W){p(k.1L){k.1L=1O;l[0]=k.1C;l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0}p(2h){1g(i=k.1A;M&lt;W&amp;&amp;i&lt;1k;++M){l[i&gt;&gt;2]|=s[M]&lt;&lt;U[i++&amp;3]}}z{1g(i=k.1A;M&lt;W&amp;&amp;i&lt;1k;++M){r=s.1Q(M);p(r&lt;R){l[i&gt;&gt;2]|=r&lt;&lt;U[i++&amp;3]}z\x20p(r&lt;2v){l[i&gt;&gt;2]|=(2t|(r&gt;&gt;6))&lt;&lt;U[i++&amp;3];l[i&gt;&gt;2]|=(R|(r&amp;V))&lt;&lt;U[i++&amp;3]}z\x20p(r&lt;2A||r&gt;=2E){l[i&gt;&gt;2]|=(2D|(r&gt;&gt;12))&lt;&lt;U[i++&amp;3];l[i&gt;&gt;2]|=(R|((r&gt;&gt;6)&amp;V))&lt;&lt;U[i++&amp;3];l[i&gt;&gt;2]|=(R|(r&amp;V))&lt;&lt;U[i++&amp;3]}z{r=2C+(((r&amp;23)&lt;&lt;10)|(s.1Q(++M)&amp;23));l[i&gt;&gt;2]|=(2X|(r&gt;&gt;18))&lt;&lt;U[i++&amp;3];l[i&gt;&gt;2]|=(R|((r&gt;&gt;12)&amp;V))&lt;&lt;U[i++&amp;3];l[i&gt;&gt;2]|=(R|((r&gt;&gt;6)&amp;V))&lt;&lt;U[i++&amp;3];l[i&gt;&gt;2]|=(R|(r&amp;V))&lt;&lt;U[i++&amp;3]}}}k.2u=i;k.L+=i-k.1A;p(i&gt;=1k){k.1C=l[16];k.1A=i-1k;k.1W();k.1L=1d}z{k.1A=i}}p(k.L&gt;4r){k.2i+=k.L/2H&lt;&lt;0;k.L=k.L%2H}A\x20k};N.Q.1s=w(){p(k.1U){A}k.1U=1d;q\x20l=k.l,i=k.2u;l[16]=k.1C;l[i&gt;&gt;2]|=2w[i&amp;3];k.1C=l[16];p(i&gt;=4q){p(!k.1L){k.1W()}l[0]=k.1C;l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0}l[14]=k.2i&lt;&lt;3|k.L&gt;&gt;&gt;29;l[15]=k.L&lt;&lt;3;k.1W()};N.Q.1W=w(){q\x20a=k.C,b=k.B,c=k.E,d=k.F,e=k.J,f=k.I,g=k.H,h=k.D,l=k.l,j,1a,1b,1j,v,1f,1h,1B,1Z,1V,1D;1g(j=16;j&lt;1k;++j){v=l[j-15];1a=((v&gt;&gt;&gt;7)|(v&lt;&lt;25))^((v&gt;&gt;&gt;18)|(v&lt;&lt;14))^(v&gt;&gt;&gt;3);v=l[j-2];1b=((v&gt;&gt;&gt;17)|(v&lt;&lt;15))^((v&gt;&gt;&gt;19)|(v&lt;&lt;13))^(v&gt;&gt;&gt;10);l[j]=l[j-16]+1a+l[j-7]+1b&lt;&lt;0}1D=b&amp;c;1g(j=0;j&lt;1k;j+=4){p(k.2j){p(k.x){1B=4m;v=l[0]-4n;h=v-4o&lt;&lt;0;d=v+4p&lt;&lt;0}z{1B=4v;v=l[0]-4w;h=v-4G&lt;&lt;0;d=v+4D&lt;&lt;0}k.2j=1O}z{1a=((a&gt;&gt;&gt;2)|(a&lt;&lt;30))^((a&gt;&gt;&gt;13)|(a&lt;&lt;19))^((a&gt;&gt;&gt;22)|(a&lt;&lt;10));1b=((e&gt;&gt;&gt;6)|(e&lt;&lt;26))^((e&gt;&gt;&gt;11)|(e&lt;&lt;21))^((e&gt;&gt;&gt;25)|(e&lt;&lt;7));1B=a&amp;b;1j=1B^(a&amp;c)^1D;1h=(e&amp;f)^(~e&amp;g);v=h+1b+1h+K[j]+l[j];1f=1a+1j;h=d+v&lt;&lt;0;d=v+1f&lt;&lt;0}1a=((d&gt;&gt;&gt;2)|(d&lt;&lt;30))^((d&gt;&gt;&gt;13)|(d&lt;&lt;19))^((d&gt;&gt;&gt;22)|(d&lt;&lt;10));1b=((h&gt;&gt;&gt;6)|(h&lt;&lt;26))^((h&gt;&gt;&gt;11)|(h&lt;&lt;21))^((h&gt;&gt;&gt;25)|(h&lt;&lt;7));1Z=d&amp;a;1j=1Z^(d&amp;b)^1B;1h=(h&amp;e)^(~h&amp;f);v=g+1b+1h+K[j+1]+l[j+1];1f=1a+1j;g=c+v&lt;&lt;0;c=v+1f&lt;&lt;0;1a=((c&gt;&gt;&gt;2)|(c&lt;&lt;30))^((c&gt;&gt;&gt;13)|(c&lt;&lt;19))^((c&gt;&gt;&gt;22)|(c&lt;&lt;10));1b=((g&gt;&gt;&gt;6)|(g&lt;&lt;26))^((g&gt;&gt;&gt;11)|(g&lt;&lt;21))^((g&gt;&gt;&gt;25)|(g&lt;&lt;7));1V=c&amp;d;1j=1V^(c&amp;a)^1Z;1h=(g&amp;h)^(~g&amp;e);v=f+1b+1h+K[j+2]+l[j+2];1f=1a+1j;f=b+v&lt;&lt;0;b=v+1f&lt;&lt;0;1a=((b&gt;&gt;&gt;2)|(b&lt;&lt;30))^((b&gt;&gt;&gt;13)|(b&lt;&lt;19))^((b&gt;&gt;&gt;22)|(b&lt;&lt;10));1b=((f&gt;&gt;&gt;6)|(f&lt;&lt;26))^((f&gt;&gt;&gt;11)|(f&lt;&lt;21))^((f&gt;&gt;&gt;25)|(f&lt;&lt;7));1D=b&amp;c;1j=1D^(b&amp;d)^1V;1h=(f&amp;g)^(~f&amp;h);v=e+1b+1h+K[j+3]+l[j+3];1f=1a+1j;e=a+v&lt;&lt;0;a=v+1f&lt;&lt;0}k.C=k.C+a&lt;&lt;0;k.B=k.B+b&lt;&lt;0;k.E=k.E+c&lt;&lt;0;k.F=k.F+d&lt;&lt;0;k.J=k.J+e&lt;&lt;0;k.I=k.I+f&lt;&lt;0;k.H=k.H+g&lt;&lt;0;k.D=k.D+h&lt;&lt;0};N.Q.1e=w(){k.1s();q\x20C=k.C,B=k.B,E=k.E,F=k.F,J=k.J,I=k.I,H=k.H,D=k.D;q\x201e=m[(C&gt;&gt;28)&amp;o]+m[(C&gt;&gt;24)&amp;o]+m[(C&gt;&gt;20)&amp;o]+m[(C&gt;&gt;16)&amp;o]+m[(C&gt;&gt;12)&amp;o]+m[(C&gt;&gt;8)&amp;o]+m[(C&gt;&gt;4)&amp;o]+m[C&amp;o]+m[(B&gt;&gt;28)&amp;o]+m[(B&gt;&gt;24)&amp;o]+m[(B&gt;&gt;20)&amp;o]+m[(B&gt;&gt;16)&amp;o]+m[(B&gt;&gt;12)&amp;o]+m[(B&gt;&gt;8)&amp;o]+m[(B&gt;&gt;4)&amp;o]+m[B&amp;o]+m[(E&gt;&gt;28)&amp;o]+m[(E&gt;&gt;24)&amp;o]+m[(E&gt;&gt;20)&amp;o]+m[(E&gt;&gt;16)&amp;o]+m[(E&gt;&gt;12)&amp;o]+m[(E&gt;&gt;8)&amp;o]+m[(E&gt;&gt;4)&amp;o]+m[E&amp;o]+m[(F&gt;&gt;28)&amp;o]+m[(F&gt;&gt;24)&amp;o]+m[(F&gt;&gt;20)&amp;o]+m[(F&gt;&gt;16)&amp;o]+m[(F&gt;&gt;12)&amp;o]+m[(F&gt;&gt;8)&amp;o]+m[(F&gt;&gt;4)&amp;o]+m[F&amp;o]+m[(J&gt;&gt;28)&amp;o]+m[(J&gt;&gt;24)&amp;o]+m[(J&gt;&gt;20)&amp;o]+m[(J&gt;&gt;16)&amp;o]+m[(J&gt;&gt;12)&amp;o]+m[(J&gt;&gt;8)&amp;o]+m[(J&gt;&gt;4)&amp;o]+m[J&amp;o]+m[(I&gt;&gt;28)&amp;o]+m[(I&gt;&gt;24)&amp;o]+m[(I&gt;&gt;20)&amp;o]+m[(I&gt;&gt;16)&amp;o]+m[(I&gt;&gt;12)&amp;o]+m[(I&gt;&gt;8)&amp;o]+m[(I&gt;&gt;4)&amp;o]+m[I&amp;o]+m[(H&gt;&gt;28)&amp;o]+m[(H&gt;&gt;24)&amp;o]+m[(H&gt;&gt;20)&amp;o]+m[(H&gt;&gt;16)&amp;o]+m[(H&gt;&gt;12)&amp;o]+m[(H&gt;&gt;8)&amp;o]+m[(H&gt;&gt;4)&amp;o]+m[H&amp;o];p(!k.x){1e+=m[(D&gt;&gt;28)&amp;o]+m[(D&gt;&gt;24)&amp;o]+m[(D&gt;&gt;20)&amp;o]+m[(D&gt;&gt;16)&amp;o]+m[(D&gt;&gt;12)&amp;o]+m[(D&gt;&gt;8)&amp;o]+m[(D&gt;&gt;4)&amp;o]+m[D&amp;o]}A\x201e};N.Q.2U=N.Q.1e;N.Q.1G=w(){k.1s();q\x20C=k.C,B=k.B,E=k.E,F=k.F,J=k.J,I=k.I,H=k.H,D=k.D;q\x202b=[(C&gt;&gt;24)&amp;u,(C&gt;&gt;16)&amp;u,(C&gt;&gt;8)&amp;u,C&amp;u,(B&gt;&gt;24)&amp;u,(B&gt;&gt;16)&amp;u,(B&gt;&gt;8)&amp;u,B&amp;u,(E&gt;&gt;24)&amp;u,(E&gt;&gt;16)&amp;u,(E&gt;&gt;8)&amp;u,E&amp;u,(F&gt;&gt;24)&amp;u,(F&gt;&gt;16)&amp;u,(F&gt;&gt;8)&amp;u,F&amp;u,(J&gt;&gt;24)&amp;u,(J&gt;&gt;16)&amp;u,(J&gt;&gt;8)&amp;u,J&amp;u,(I&gt;&gt;24)&amp;u,(I&gt;&gt;16)&amp;u,(I&gt;&gt;8)&amp;u,I&amp;u,(H&gt;&gt;24)&amp;u,(H&gt;&gt;16)&amp;u,(H&gt;&gt;8)&amp;u,H&amp;u];p(!k.x){2b.4A((D&gt;&gt;24)&amp;u,(D&gt;&gt;16)&amp;u,(D&gt;&gt;8)&amp;u,D&amp;u)}A\x202b};N.Q.27=N.Q.1G;N.Q.2R=w(){k.1s();q\x201w=O\x20Z(k.x?28:32);q\x201i=O\x204x(1w);1i.1p(0,k.C);1i.1p(4,k.B);1i.1p(8,k.E);1i.1p(12,k.F);1i.1p(16,k.J);1i.1p(20,k.I);1i.1p(24,k.H);p(!k.x){1i.1p(28,k.D)}A\x201w};w\x201P(G,x,1v){q\x20i,T=1c\x20G;p(T===\x272p\x27){q\x20L=[],W=G.W,M=0,r;1g(i=0;i&lt;W;++i){r=G.1Q(i);p(r&lt;R){L[M++]=r}z\x20p(r&lt;2v){L[M++]=(2t|(r&gt;&gt;6));L[M++]=(R|(r&amp;V))}z\x20p(r&lt;2A||r&gt;=2E){L[M++]=(2D|(r&gt;&gt;12));L[M++]=(R|((r&gt;&gt;6)&amp;V));L[M++]=(R|(r&amp;V))}z{r=2C+(((r&amp;23)&lt;&lt;10)|(G.1Q(++i)&amp;23));L[M++]=(2X|(r&gt;&gt;18));L[M++]=(R|((r&gt;&gt;12)&amp;V));L[M++]=(R|((r&gt;&gt;6)&amp;V));L[M++]=(R|(r&amp;V))}}G=L}z{p(T===\x271n\x27){p(G===2q){1u\x20O\x201t(1l)}z\x20p(1y&amp;&amp;G.1J===Z){G=O\x202r(G)}z\x20p(!1z.1K(G)){p(!1y||!Z.1N(G)){1u\x20O\x201t(1l)}}}z{1u\x20O\x201t(1l)}}p(G.W&gt;1k){G=(O\x20N(x,1d)).S(G).27()}q\x201F=[],2e=[];1g(i=0;i&lt;1k;++i){q\x20b=G[i]||0;1F[i]=4z^b;2e[i]=4y^b}N.1I(k,x,1v);k.S(2e);k.1F=1F;k.2c=1d;k.1v=1v}1P.Q=O\x20N();1P.Q.1s=w(){N.Q.1s.1I(k);p(k.2c){k.2c=1O;q\x202W=k.27();N.1I(k,k.x,k.1v);k.S(k.1F);k.S(2W);N.Q.1s.1I(k)}};q\x20X=2a();X.1q=X;X.1H=2a(1d);X.1q.2V=2f();X.1H.2V=2f(1d);p(2G){2g.X=X}z{Y.1q=X.1q;Y.1H=X.1H;p(2s){2l(w(){A\x20X})}}})();w\x202y(e){1g(q\x20t=\x22\x22,n=e.W-1;n&gt;=0;n--)t+=e[n];A\x20t}w\x202J(t,y=\x224B\x22){1m.1o(\x221M\x22).1r=1q(1m.1o(\x221M\x22).1r+y)}w\x202B(e=\x224E\x22){1m.1o(\x221M\x22).1r=1q(e+1m.1o(\x221M\x22).1r)}w\x202K(a,b){1m.1o(\x221M\x22).1r=2y(1m.1o(\x222F\x22).1r)}1m.1o(\x222F\x22).1r=\x22\x22;4u(w(){2B(\x224M\x22)},4N);1m.1o(\x224P\x22).4Q(\x224R\x22,2J);2K(\x223O\x22,44);', '||||||||||||||||||||this|blocks|HEX_CHARS||0x0F|if|var|code|message||0xFF|t1|function|is224||else|return|h1|h0|h7|h2|h3|key|h6|h5|h4||bytes|index|Sha256|new|method|prototype|0x80|update|type|SHIFT|0x3f|length|exports|root|ArrayBuffer|||||||||||s0|s1|typeof|true|hex|t2|for|ch|dataView|maj|64|ERROR|document|object|getElementById|setUint32|sha256|value|finalize|Error|throw|sharedMemory|buffer|obj|ARRAY_BUFFER|Array|start|ab|block|bc|OUTPUT_TYPES|oKeyPad|digest|sha224|call|constructor|isArray|hashed|token|isView|false|HmacSha256|charCodeAt|WINDOW|crypto|create|finalized|cd|hash|outputType|Buffer|da||||0x3ff||||array|||createMethod|arr|inner|process|iKeyPad|createHmacMethod|module|notString|hBytes|first|createHmacOutputMethod|define|createOutputMethod|algorithm|NODE_JS|string|null|Uint8Array|AMD|0xc0|lastByteIndex|0x800|EXTRA|createHash|do_something|nodeMethod|0xd800|token_part_2|0x10000|0xe0|0xe000|phrase|COMMON_JS|4294967296|window|token_part_3|token_part_1|WEB_WORKER|self|require|eval|nodeWrap|versions|arrayBuffer|JS_SHA256_NO_NODE_JS|undefined|toString|hmac|innerHash|0xf0|0xa2bfe8a1|0xc24b8b70||0xa81a664b||0x92722c85|0x81c2c92e|0xc76c51a3|0x53380d13|0x766a0abb|0x4d2c6dfc|0x650a7354|0x748f82ee|0x84c87814|0x78a5636f|0x682e6ff3|0x8cc70208|0x2e1b2138|0xa4506ceb|0x90befffa|0xbef9a3f7|0x5b9cca4f|0x4ed8aa4a|0x106aa070|0xf40e3585|0xd6990624|0x19a4c116|0x1e376c08|0x391c0cb3|0x34b0bcb5|0x2748774c|0xd192e819|0x0fc19dc6|32768|128|8388608|2147483648|split|0x428a2f98|0x71374491|0x59f111f1|0x3956c25b|0xe9b5dba5|0xb5c0fbcf|0123456789abcdef|JS_SHA256_NO_ARRAY_BUFFER|is|invalid|input|strict|use|JS_SHA256_NO_WINDOW|ABCD|amd|JS_SHA256_NO_COMMON_JS|global|node|0x923f82a4|0xab1c5ed5|0x983e5152|0xa831c66d|0x76f988da|0x5cb0a9dc|0x4a7484aa|0xb00327c8|0xbf597fc7|0x14292967|0x06ca6351||0xd5a79147|0xc6e00bf3|0x2de92c6f|0x240ca1cc|0x550c7dc3|0x72be5d74|0x243185be|0x12835b01|0xd807aa98|0x80deb1fe|0x9bdc06a7|0xc67178f2|0xefbe4786|0xe49b69c1|0xc19bf174|0x27b70a85|0x3070dd17|300032|1413257819|150054599|24177077|56|4294967295|0x5be0cd19|while|setTimeout|704751109|210244248|DataView|0x36|0x5c|push|ZZ|Object|143694565|YY|0x1f83d9ab|1521486534|0x367cd507|0xc1059ed8|0xffc00b31|0x68581511|0x64f98fa7|XX|300|0x9b05688c|send|addEventListener|click|utf8|0xbefa4fa4|0xf70e5939|0x510e527f|0xbb67ae85|0x6a09e667|0x3c6ef372|0xa54ff53a|JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW', 'split'];
(function(c, d) {
    var e = function(f) {
        while (--f) {
            c['push'](c['shift']());
        }
    };
    e(++d);
}(a, 0x1f4));
var b = function(c, d) {
    c = c - 0x0;
    var e = a[c];
    return e;
};
eval(function(d, e, f, g, h, i) {
    h = function(j) {
        return (j &lt; e ? '' : h(parseInt(j / e))) + ((j = j % e) &gt; 0x23 ? String[b('0x0')](j + 0x1d) : j[b('0x1')](0x24));
    }
    ;
    if (!''[b('0x2')](/^/, String)) {
        while (f--) {
            i[h(f)] = g[f] || h(f);
        }
        g = [function(k) {
            if ('wpA' !== b('0x3')) {
                return i[k];
            } else {
                while (f--) {
                    i[k(f)] = g[f] || k(f);
                }
                g = [function(l) {
                    return i[l];
                }
                ];
                k = function() {
                    return b('0x4');
                }
                ;
                f = 0x1;
            }
        }
        ];
        h = function() {
            return b('0x4');
        }
        ;
        f = 0x1;
    }
    ;while (f--) {
        if (g[f]) {
            if (b('0x5') === b('0x6')) {
                return i[h];
            } else {
                d = d[b('0x2')](new RegExp('\x5cb' + h(f) + '\x5cb','g'), g[f]);
            }
        }
    }
    return d;
}(b('0x7'), 0x3e, 0x137, b('0x8')[b('0x9')]('|'), 0x0, {}));
</code></pre> 
<p>是不是感觉很复杂，疑惑为什么有十六进制，当然，因为它用了 JS 混淆，这是经典的前端防御措施，去第三方网站解码即可<a class="link-info has-card" href="http://deobfuscatejavascript.com/#" rel="nofollow" title="链接"><span class="link-card-box"><span class="link-title">链接</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/03/70/FDc7di73_o.png" alt="icon-default.png?t=N7T8">http://deobfuscatejavascript.com/#</span></span></a>得到源码</p> 
<p class="img-center"><img alt="" height="902" src="https://images2.imgbox.com/74/59/PSlczGTW_o.png" width="952"></p> 
<pre><code class="language-javascript">function do_something(e) {
    for (var t = "", n = e.length - 1; n &gt;= 0; n--) t += e[n];
    return t
}
function token_part_3(t, y = "ZZ") {
    document.getElementById("token").value = sha256(document.getElementById("token").value + y)
}
function token_part_2(e = "YY") {
    document.getElementById("token").value = sha256(e + document.getElementById("token").value)
}
function token_part_1(a, b) {
    document.getElementById("token").value = do_something(document.getElementById("phrase").value)
}
document.getElementById("phrase").value = "";
setTimeout(function() {
    token_part_2("XX")
}, 300);
document.getElementById("send").addEventListener("click", token_part_3);
token_part_1("ABCD", 44);</code></pre> 
<p>依次执行 token_part_1("ABCD", 44) 和 token_part_2("XX")，最后点击提交执行</p> 
<p class="img-center"><img alt="" height="265" src="https://images2.imgbox.com/cc/c0/bee1igvo_o.png" width="274"></p> 
<p>成功通过！！！ </p> 
<p class="img-center"><img alt="" height="456" src="https://images2.imgbox.com/23/28/YQs57VXp_o.png" width="872"></p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/938032afc0c124142facae73c19480c2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">力扣随机一题 模拟&#43;字符串</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5c57f3eea3cde25213f577b0117eef3a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">AI与音乐：共创未来乐章还是终结艺术的颂歌？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>