<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android接入谷歌登录 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/24a536d71870b6704a227cbd46dc5b82/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Android接入谷歌登录">
  <meta property="og:description" content="登录谷歌云后台：谷歌后台地址配置OAuth 2.0 客户端 ID，初始化谷歌登录客户端ID用这里的web客户端ID，同时需要配置Android的客户端ID（对应包名与SHA-1证书）在build.gradle中添加 google()，同时在dependencies依赖添加 implementation &#39;com.google.android.gms:play-services-auth:20.2.0&#39; 初始化谷歌登录，把第二步拷贝的客户端ID配置 // 初始化谷歌登录 private void initGoogleSignInClient() { GoogleSignInOptions gso = new GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN) .requestIdToken(&#34;你的客户端ID&#34;) .requestEmail() .build(); // Build a GoogleSignInClient with the options specified by gso. mGoogleSignInClient = GoogleSignIn.getClient(this, gso); } cocos调用谷歌登录 /** * google登录 */ public static void login() { Log.d(TAG, &#34;==&gt;login&#34;); // 使用GoogleSignIn.getLastSignedInAccount方法为当前登录的用户请求个人资料信息。 GoogleSignInAccount account = GoogleSignIn.getLastSignedInAccount(getActivity().getApplicationContext()); // 不存在则请求登录 if (account == null) { Intent signInIntent = mGoogleSignInClient.getSignInIntent(); getActivity().startActivityForResult(signInIntent, RC_SIGN_IN); } else { Log.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-12T19:26:02+08:00">
    <meta property="article:modified_time" content="2024-04-12T19:26:02+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android接入谷歌登录</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <ol><li>登录谷歌云后台：<a class="link-info" href="https://console.cloud.google.com/apis/credentials" rel="nofollow" title="谷歌后台地址">谷歌后台地址</a></li><li>配置OAuth 2.0 客户端 ID，初始化谷歌登录客户端ID用这里的web客户端ID，同时需要配置Android的客户端ID（对应包名与SHA-1证书）<img alt="" height="525" src="https://images2.imgbox.com/2b/f4/u8UORLwE_o.png" width="1200"></li><li>在build.gradle中添加 google()，同时在dependencies依赖添加  <pre>implementation 'com.google.android.gms:play-services-auth:20.2.0'</pre> <img alt="" height="319" src="https://images2.imgbox.com/87/5d/mw6inakS_o.png" width="646"><img alt="" height="182" src="https://images2.imgbox.com/2b/bc/VEVim8gl_o.png" width="897"></li><li>初始化谷歌登录，把第二步拷贝的客户端ID配置 <pre><code>    // 初始化谷歌登录
    private void initGoogleSignInClient() {
        GoogleSignInOptions gso = new GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN)
                .requestIdToken("你的客户端ID")
                .requestEmail()
                .build();
        // Build a GoogleSignInClient with the options specified by gso.
        mGoogleSignInClient = GoogleSignIn.getClient(this, gso);
    }</code></pre> </li><li>cocos调用谷歌登录 <pre><code>    /**
     * google登录
     */
    public static void login() {
        Log.d(TAG, "==&gt;login");
        // 使用GoogleSignIn.getLastSignedInAccount方法为当前登录的用户请求个人资料信息。
        GoogleSignInAccount account = GoogleSignIn.getLastSignedInAccount(getActivity().getApplicationContext());
        // 不存在则请求登录
        if (account == null) {
            Intent signInIntent = mGoogleSignInClient.getSignInIntent();
            getActivity().startActivityForResult(signInIntent, RC_SIGN_IN);
        } else {
            Log.d(TAG, "account != null " + account.toString());
            onLoginResp(account);
        }
    }
    </code></pre> </li><li>处理登录数据返回 <pre><code>    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);
        if( resultCode != RESULT_OK){
            return;
        }
        if (requestCode == RC_SIGN_IN) {
            Task&lt;GoogleSignInAccount&gt; task = GoogleSignIn.getSignedInAccountFromIntent(data);
            try {
                GoogleSignInAccount account = task.getResult(ApiException.class);
                if (account != null &amp;&amp; !account.isExpired()) {
                    Log.d(TAG, "onActivityResult != null" + account.toString());
                    onLoginResp(account);
                } else {
                    Log.w(TAG, "signInResult: null account or expired");
                }
            } catch (ApiException e) {
                Log.w(TAG, "signInResult:failed code=" + e);
                e.printStackTrace();
            }
        }
    }

    // 获取谷歌登录回调
    private static void onLoginResp(GoogleSignInAccount account) {
//         Log.d(TAG, account.toString());
        String token = account.getIdToken();
        String userid = account.getId();
        String nickname = account.getDisplayName();
        String photo = account.getPhotoUrl().toString();
    }</code></pre> <p></p> </li><li>cocos调用谷歌登出 <pre><code>    // 谷歌登出
    public static void singOut(){
        mGoogleSignInClient.signOut().addOnCompleteListener(getActivity(), new OnCompleteListener&lt;Void&gt;() {
            @Override
            public void onComplete(@NonNull Task&lt;Void&gt; task) {
                Log.d(TAG, "==&gt;singOut");
            }
        });
    }</code></pre> </li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4c82321f208a5fec35b04d4c5e2bd347/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">向量数据库Chroma初步了解学习记录</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5ed810183e62e5fd1febc631417aa3b7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Python自动化办公：提升效率，释放潜力（借助AI实现）_学习python实现办公自动化的技能可以培养什么能力</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>