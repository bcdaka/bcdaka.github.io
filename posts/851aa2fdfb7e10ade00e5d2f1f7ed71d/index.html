<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【爱上C&#43;&#43;】详解string类2:模拟实现、深浅拷贝 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/851aa2fdfb7e10ade00e5d2f1f7ed71d/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【爱上C&#43;&#43;】详解string类2:模拟实现、深浅拷贝">
  <meta property="og:description" content="在上一篇文章中我们介绍了string类的基本使用，本篇文章我们将讲解string类一些常用的模拟实现，其中有很多细小的知识点值得我们深入学习。Let’s go！
文章目录 类声明默认成员函数构造函数析构函数拷贝构造函数深浅拷贝问题传统写法现代写法 赋值运算符重载传统写法现代写法 容器操作获取长度：size获取当前容量：capacity查询是否为空：empty扩容：reserve调整字符串大小：resize 字符串访问[]访问迭代器访问 插入类尾插一个字符push_backappend在尾部追加一个string对象在尾部追加一个C风格字符串在尾部追加n个字符 insert在pos位置插入一个字符在pos位置插入一个字符串 operator&#43;= 删除类erase 其他操作swapfind返回字符c在string中第一次出现的位置返回子串s在string中第一次出现的位置 substrprintf_strclearc_str逻辑判断 流操作流插入&lt;&lt;流提取&gt;&gt; 拓展:关于string其他常用函数to_stringstoi 完整代码展示.h文件.cpp文件 类声明 namespace Mystring { // 定义一个字符串类 class string { public: // 公共成员函数和接口 private: // 私有成员变量，限制直接访问底层数据 size_t _capacity = 0; // 字符串的容量 size_t _size = 0; // 字符串的长度 char* _str = nullptr; // 指向字符串数据的指针 const static size_t npos = -1; // 静态常量，表示未找到位置或无效位置 }; } 在C&#43;&#43;中，静态成员变量（static）的定义通常需要在类的外部进行，而非静态成员变量则需要在类的内部进行定义。然而，对于静态成员变量如果其为 const 且为整数类型（包括枚举类型），则可以在类内部直接进行初始化。因此，对于 const static size_t npos = -1; 这样的声明，其允许在类内部直接进行初始化。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-01T14:17:25+08:00">
    <meta property="article:modified_time" content="2024-07-01T14:17:25+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【爱上C&#43;&#43;】详解string类2:模拟实现、深浅拷贝</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <hr> 
<p>在上一篇文章中我们介绍了string类的基本使用，本篇文章我们将讲解string类一些常用的模拟实现，其中有很多细小的知识点值得我们深入学习。Let’s go！<br> </p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_5" rel="nofollow">类声明</a></li><li><a href="#_46" rel="nofollow">默认成员函数</a></li><li><ul><li><a href="#_48" rel="nofollow">构造函数</a></li><li><a href="#_69" rel="nofollow">析构函数</a></li><li><a href="#_94" rel="nofollow">拷贝构造函数</a></li><li><ul><li><a href="#_96" rel="nofollow">深浅拷贝问题</a></li><li><a href="#_108" rel="nofollow">传统写法</a></li><li><a href="#_123" rel="nofollow">现代写法</a></li></ul> 
   </li><li><a href="#_171" rel="nofollow">赋值运算符重载</a></li><li><ul><li><a href="#_173" rel="nofollow">传统写法</a></li><li><a href="#_191" rel="nofollow">现代写法</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_241" rel="nofollow">容器操作</a></li><li><ul><li><a href="#size_243" rel="nofollow">获取长度：size</a></li><li><a href="#capacity_252" rel="nofollow">获取当前容量：capacity</a></li><li><a href="#empty_260" rel="nofollow">查询是否为空：empty</a></li><li><a href="#reserve_268" rel="nofollow">扩容：reserve</a></li><li><a href="#resize_290" rel="nofollow">调整字符串大小：resize</a></li></ul> 
  </li><li><a href="#_324" rel="nofollow">字符串访问</a></li><li><ul><li><a href="#_326" rel="nofollow">[]访问</a></li><li><a href="#_342" rel="nofollow">迭代器访问</a></li></ul> 
  </li><li><a href="#_372" rel="nofollow">插入类</a></li><li><ul><li><a href="#push_back_374" rel="nofollow">尾插一个字符push_back</a></li><li><a href="#append_389" rel="nofollow">append</a></li><li><ul><li><a href="#string_391" rel="nofollow">在尾部追加一个string对象</a></li><li><a href="#C_416" rel="nofollow">在尾部追加一个C风格字符串</a></li><li><a href="#n_431" rel="nofollow">在尾部追加n个字符</a></li></ul> 
   </li><li><a href="#insert_456" rel="nofollow">insert</a></li><li><ul><li><a href="#pos_458" rel="nofollow">在pos位置插入一个字符</a></li><li><a href="#pos_497" rel="nofollow">在pos位置插入一个字符串</a></li></ul> 
   </li><li><a href="#operator_533" rel="nofollow">operator+=</a></li></ul> 
  </li><li><a href="#_552" rel="nofollow">删除类</a></li><li><ul><li><a href="#erase_554" rel="nofollow">erase</a></li></ul> 
  </li><li><a href="#_586" rel="nofollow">其他操作</a></li><li><ul><li><a href="#swap_588" rel="nofollow">swap</a></li><li><a href="#find_599" rel="nofollow">find</a></li><li><ul><li><a href="#cstring_601" rel="nofollow">返回字符c在string中第一次出现的位置</a></li><li><a href="#sstring_617" rel="nofollow">返回子串s在string中第一次出现的位置</a></li></ul> 
   </li><li><a href="#substr_647" rel="nofollow">substr</a></li><li><a href="#printf_str_669" rel="nofollow">printf_str</a></li><li><a href="#clear_688" rel="nofollow">clear</a></li><li><a href="#c_str_698" rel="nofollow">c_str</a></li><li><a href="#_708" rel="nofollow">逻辑判断</a></li></ul> 
  </li><li><a href="#_747" rel="nofollow">流操作</a></li><li><ul><li><a href="#_750" rel="nofollow">流插入&lt;&lt;</a></li><li><a href="#_762" rel="nofollow">流提取&gt;&gt;</a></li></ul> 
  </li><li><a href="#string_795" rel="nofollow">拓展:关于string其他常用函数</a></li><li><ul><li><ul><li><a href="#to_string_797" rel="nofollow">to_string</a></li><li><a href="#stoi_801" rel="nofollow">stoi</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_814" rel="nofollow">完整代码展示</a></li><li><ul><li><a href="#h_816" rel="nofollow">.h文件</a></li><li><a href="#cpp_959" rel="nofollow">.cpp文件</a></li></ul> 
  </li><li><a href="#_1312" rel="nofollow"></a></li></ul> 
</div> 
<br> 
 
<p></p> 
<h2><a id="_5"></a>类声明</h2> 
<pre><code class="prism language-cpp"><span class="token keyword">namespace</span> Mystring
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 定义一个字符串类</span>
    <span class="token keyword">class</span> <span class="token class-name">string</span>
    <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span><span class="token operator">:</span>
        <span class="token comment">// 公共成员函数和接口</span>

    <span class="token keyword">private</span><span class="token operator">:</span>
        <span class="token comment">// 私有成员变量，限制直接访问底层数据</span>

        size_t _capacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">// 字符串的容量</span>
        size_t _size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token comment">// 字符串的长度</span>
        <span class="token keyword">char</span><span class="token operator">*</span> _str <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>   <span class="token comment">// 指向字符串数据的指针</span>
        <span class="token keyword">const</span> <span class="token keyword">static</span> size_t npos <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">// 静态常量，表示未找到位置或无效位置</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>在C++中，静态成员变量（static）的定义通常需要在类的外部进行，而非静态成员变量则需要在类的内部进行定义。然而，对于静态成员变量如果其为 const 且为整数类型（包括枚举类型），则可以在类内部直接进行初始化。因此，对于 const static size_t npos = -1; 这样的声明，其允许在类内部直接进行初始化。<br>对于npos的初始化，下面两种方式都可以</p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">string</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">static</span> <span class="token keyword">const</span> size_t npos <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">string</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">static</span> <span class="token keyword">const</span> size_t npos<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> size_t string<span class="token double-colon punctuation">::</span>npos <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

</code></pre> 
<p>声明变量时可以顺便初始化，这样可以确保对象在创建时具有合适的初始值。<br>结构上使用了命名空间Mystring来避免与标准库中的 std::string 冲突。<br>本篇文章的代码采用声明与定义分离的方式。声明放在string.h文件，定义放在string.cpp文件。.cpp文件中通过包对应头文件以及声明命名空间，然后通过<strong>类名::成员</strong>的方式定义和实现函数。</p> 
<p></p> 
<h2><a id="_46"></a>默认成员函数</h2> 
<p></p> 
<h3><a id="_48"></a>构造函数</h3> 
<p>声明：</p> 
<pre><code class="prism language-cpp"><span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span>str<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//(提供了一个缺省值表示在没有提供参数时，str 默认初始化为一个空字符串</span>
<span class="token comment">//（即一个以 null 结尾的字符数组，其中只有一个字符 '\0'）)</span>
</code></pre> 
<blockquote> 
 <p>这里是 "“不是” "。后者不为空， 有一个空格.</p> 
</blockquote> 
<p>定义：</p> 
<pre><code class="prism language-cpp"><span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str <span class="token punctuation">)</span>		
<span class="token punctuation">{<!-- --></span>
	_size <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span> 	<span class="token comment">// 计算字符串长度</span>
	_capacity <span class="token operator">=</span> _size<span class="token punctuation">;</span>		<span class="token comment">// 初始容量与字符串长度相同</span>
	_str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>_capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 为字符串分配内存空间，多开一个空间用于存放 '\0'</span>
	<span class="token function">strcpy</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// 将参数 str 的内容拷贝到 _str 中</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><code>如 string::string s1("Hello"); </code><br> </p> 
<h3><a id="_69"></a>析构函数</h3> 
<pre><code class="prism language-cpp"><span class="token operator">~</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> _str<span class="token punctuation">;</span><span class="token comment">// 释放字符串的内存空间，使用 delete[] 因为 _str 是数组形式的字符串</span>
	_size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> 	 <span class="token comment">// 将字符串长度置为 0，表示字符串已经被释放</span>
	_capacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">// 将容量置为 0，表示容量无效</span>
	_str <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>  <span class="token comment">// 将指向字符串数据的指针置为 nullptr，防止出现悬空指针</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>析构函数在对象被销毁时自动调用，通常用来释放对象所持有的资源，例如动态分配的内存。</p> 
<blockquote> 
 <p>**拓展：**悬空指针<br> 是指指向已经被释放或者无效的内存地址的指针。当一个指针被赋予了 <code>nullptr</code> 或者指向的内存已经被释放时，这个指针就变成了悬空指针。<br> 在C++中，如果一个对象的析构函数中没有将指针设置为 <code>nullptr</code>，那么当对象被销毁时，其指针成员可能会成为悬空指针。悬空指针引发的问题主要有两个：</p> 
 <ol><li><strong>未定义行为（Undefined Behavior）</strong>：如果试图通过悬空指针访问内存，则会导致未定义行为，这可能会导致程序崩溃或者产生难以预料的结果。</li><li><strong>内存泄漏或重复释放</strong>：悬空指针可能会导致内存泄漏，因为释放过的内存没有被正确释放，或者在程序的其他地方被重新分配，导致对同一块内存的多次释放。</li></ol> 
 <p>在编程中，为了避免悬空指针的问题，通常有以下建议：</p> 
 <ul><li><strong>析构函数中将指针置为</strong> <code>nullptr</code>：在对象被销毁时，确保将指针成员设置为<code>nullptr</code>，这样可以避免在对象的生命周期结束后访问悬空指针。</li><li><strong>使用智能指针</strong>：C++11引入的智能指针（如<code>std::unique_ptr</code>和<code>std::shared_ptr</code>）可以帮助自动管理动态内存，避免手动释放内存和悬空指针问题。</li><li><strong>注意指针的生命周期</strong>：确保在指针可能成为悬空指针的情况下，适时将其置为<code>nullptr</code>，或者避免在对象生命周期结束后继续使用该指针。</li></ul> 
</blockquote> 
<p>通过良好的编程实践和注意内存管理，可以有效避免悬空指针带来的问题，提高程序的健壮性和可靠性。</p> 
<p></p> 
<h3><a id="_94"></a>拷贝构造函数</h3> 
<p></p> 
<h4><a id="_96"></a>深浅拷贝问题</h4> 
<p>如果我们不写拷贝构造函数，编译器会默认生成一个浅拷贝的拷贝构造函数。但是，默认生成的拷贝构造函数只会简单地逐成员进行赋值拷贝，这在处理指针成员变量时会导致严重问题<br> 当使用默认的浅拷贝构造函数时，两个对象会共享同一个内存空间,会导致以下问题<br><img src="https://images2.imgbox.com/99/a5/ZBN0yVMN_o.png" alt="image.png"></p> 
<ul><li><strong>共享内存</strong>：s1 和 s2 共享同一块内存，这意味着修改一个对象会影响另一个对象。</li><li><strong>悬空指针</strong>：当 s1 或 s2 析构时，内存会被释放，另一个对象的指针会变成悬空指针。</li><li><strong>双重释放</strong>：当 s1 和 s2 都析构时，会尝试释放同一块内存两次，导致程序崩溃。</li></ul> 
<p>为了解决浅拷贝带来的问题，我们需要实现一个深拷贝的拷贝构造函数。深拷贝会为新对象分配独立的内存空间，并将原对象的数据复制到新对象中，从而避免共享内存的问题。</p> 
<p><img src="https://images2.imgbox.com/b5/cc/ai3EUxAa_o.png" alt="image.png"></p> 
<p></p> 
<h4><a id="_108"></a>传统写法</h4> 
<pre><code class="prism language-cpp">    <span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 为新对象分配独立的内存空间，并且多分配一个字节用于存储终止符 '\0'</span>
        _str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>s<span class="token punctuation">.</span>_capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">// 将原对象的字符串数据复制到新对象的内存空间</span>
        <span class="token function">strcpy</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 复制原对象的大小和容量</span>
        _size <span class="token operator">=</span> s<span class="token punctuation">.</span>_size<span class="token punctuation">;</span>
        _capacity <span class="token operator">=</span> s<span class="token punctuation">.</span>_capacity<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p></p> 
<h4><a id="_123"></a>现代写法</h4> 
<pre><code class="prism language-cpp">		<span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//使用 std::swap 交换当前对象和临时对象的 _str 指针。</span>
			std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_size<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_size<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//使用 std::swap 交换当前对象和临时对象的 _size 值。</span>
			std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_capacity<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_capacity<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//使用 std::swap 交换当前对象和临时对象的 _capacity 值</span>
		<span class="token punctuation">}</span>
        <span class="token comment">//s2(s1)    //下面的s 就是s1</span>
		<span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>  
        <span class="token operator">:</span><span class="token function">_str</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
        <span class="token punctuation">,</span><span class="token function">_size</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">,</span><span class="token function">_capacity</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			string <span class="token function">tmp</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 注意！是构造 </span>
<span class="token comment">// 使用 s 对象的内部 C 风格字符串 _str 构造一个临时的字符串对象 tmp</span>
			<span class="token function">swap</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// 交换当前对象和临时对象的数据，使当前对象的内容变为 tmp 的内容，临时对象则被销毁</span>
		<span class="token punctuation">}</span>
<span class="token comment">//解析：tmp和s1有一样大的空间，一样的值。然后s2和tmp一交换,那s2就和s1一样了，就完成了。</span>

</code></pre> 
<p><strong>图解： 交换前</strong><br><img src="https://images2.imgbox.com/e1/8f/NwMGeZTt_o.png" alt="image.png"><br><strong>交换后</strong><br><img src="https://images2.imgbox.com/08/10/7oxwznjw_o.png" alt="image.png"><br>在C++中，当我们用<code>string s2(s1)</code>来创建<code>string</code>对象时，<code>s1</code>是用来初始化<code>string s2</code>的源对象。现代写法中的<code>string(const string&amp; s)</code>构造函数会被调用来实现这一点。<br><strong>理解现代写法：</strong><br>在这个构造函数中，我们可以理解成：</p> 
<ol><li><strong>调用构造函数</strong>： 
  <ul><li>当我们写<code>string s2(s1)</code>时，编译器调用<code>string</code>类的拷贝构造函数<code>string(const string&amp; s)</code>。</li><li>这里的<code>s</code>就是<code>s1</code>，表示用<code>s1</code>对象来初始化新创建的<code>s2</code>对象。</li></ul> </li><li><strong>创建临时对象</strong>： 
  <ul><li>在构造函数内部，首先使用<code>s</code>对象（即<code>s1</code>）的内部 C 风格字符串<code>_str</code>来构造一个临时对象<code>tmp</code>。</li><li><code>string tmp(s._str)</code>这行代码会调用另一个构造函数<code>string(const char* str)</code>，用<code>s1</code>对象的字符串数据来初始化临时对象<code>tmp</code>。</li></ul> </li><li><strong>交换数据</strong>： 
  <ul><li>调用<code>swap(tmp)</code>将当前对象（即<code>s2</code>）的成员变量与临时对象<code>tmp</code>的成员变量进行交换。</li><li>在交换之后，<code>s2</code>对象持有了<code>tmp</code>的数据，即持有了<code>s1</code>的数据副本，而<code>tmp</code>则持有了<code>s2</code>的初始数据（在这时通常为空或者默认值）。</li></ul> </li><li><strong>析构临时对象</strong>： 
  <ul><li>当构造函数结束时，临时对象<code>tmp</code>离开作用域，自动析构，释放它持有的资源。</li><li>由于<code>tmp</code>持有的是<code>s2</code>的初始数据（在构造时通常是无效数据），所以释放时不会影响<code>s2</code>，也不会造成资源泄漏。</li></ul> </li></ol> 
<p>这种现代写法通过创建临时对象和交换数据，确保了拷贝构造的简洁性和异常安全性，同时避免了资源泄漏和浅拷贝带来的问题。</p> 
<blockquote> 
 <p>❓为什么要在初始化列表中给 _str 初始化为空指针？<br> string(const string&amp; s)<br> : _str(nullptr)<br> 如果不对它进行处理，一开始指向的是 未定义的（随机值)。在交换之后，这个随机值就给了tmp了，tmp出了作用域后调用析构函数进行释放会对随机值指向的空间进行释放。 这种情况下，系统可能无法正确处理释放操作，从而导致程序崩溃或者其他未定义行为。<br> delete 或者 free 一个空指针是安全的操作，不会导致运行时错误，所以这里把它初始化为nullptr,tmp最后释放空，不会出现问题。</p> 
</blockquote> 
<p></p> 
<h3><a id="_171"></a>赋值运算符重载</h3> 
<p></p> 
<h4><a id="_173"></a>传统写法</h4> 
<pre><code class="prism language-cpp">string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">!=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">)</span> <span class="token comment">// 防止自我赋值</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">char</span><span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>s<span class="token punctuation">.</span>_capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 为临时存储空间分配内存，大小为 s 对象的容量加一（用于存放字符串末尾的 '\0'）</span>
        <span class="token function">strcpy</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将 s 对象的字符串复制到临时存储空间 tmp</span>
        <span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> _str<span class="token punctuation">;</span> <span class="token comment">// 删除当前对象已有的字符串内存</span>
        _str <span class="token operator">=</span> tmp<span class="token punctuation">;</span> <span class="token comment">// 将当前对象的 _str 指向新分配的字符串内存</span>
        _size <span class="token operator">=</span> s<span class="token punctuation">.</span>_size<span class="token punctuation">;</span> <span class="token comment">// 更新当前对象的字符串长度</span>
        _capacity <span class="token operator">=</span> s<span class="token punctuation">.</span>_capacity<span class="token punctuation">;</span> <span class="token comment">// 更新当前对象的容量</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token comment">// 返回当前对象的引用，支持连续赋值操作</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>传统写法图解：<br><img src="https://images2.imgbox.com/31/66/b3vCiAWS_o.png" alt="image.png"><br> </p> 
<h4><a id="_191"></a>现代写法</h4> 
<pre><code class="prism language-cpp"><span class="token comment">//s1=s3</span>
string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span>string s<span class="token punctuation">)</span> <span class="token comment">// 使用传值方式传入参数 s，利用了移动语义</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">swap</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 使用交换函数进行赋值操作，此时 s 是通过拷贝构造函数传入的临时对象</span>
    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token comment">// 返回当前对象的引用，支持连续赋值操作</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>交换前<br><img src="https://images2.imgbox.com/38/75/3SV1Yggu_o.png" alt="image.png"><br>交换后<br><img src="https://images2.imgbox.com/eb/84/az2Bt3yq_o.png" alt="image.png"><br>在 <code>string&amp; operator=(string s)</code> 中使用<strong>传值传参</strong>主要有以下几个原因：</p> 
<ol><li><strong>移动语义的利用</strong>： 
  <ul><li>传值传参允许编译器在需要的时候使用移动语义，这样可以避免不必要的深拷贝，提升性能。</li><li>如果传递的参数是右值（例如，<code>s1 = std::move(s3)</code>），则会调用移动构造函数而不是拷贝构造函数，从而避免了数据的复制。</li></ul> </li><li><strong>简化代码</strong>： 
  <ul><li>通过传值传参，可以在函数体内直接交换当前对象和参数对象的数据。这使得代码更简洁，并且更容易理解和维护。</li></ul> </li><li><strong>异常安全性</strong>： 
  <ul><li>传值传参结合交换操作可以确保资源的正确释放，避免资源泄漏和其他异常问题。</li></ul> </li></ol> 
<p><strong>详细过程解释</strong><br>假设我们有以下赋值操作：<code>s1 = s3;</code></p> 
<ol><li><strong>传值传参</strong>：</li></ol> 
<pre><code class="prism language-cpp">string <span class="token function">s</span><span class="token punctuation">(</span>s3<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 临时对象 s 通过拷贝构造或移动构造函数创建</span>
</code></pre> 
<ul><li>当调用<code>s1 = s3;</code>时，会创建一个临时对象<code>s</code>。这个临时对象<code>s</code>是通过拷贝构造函数（如果<code>s3</code>是左值）或移动构造函数（如果<code>s3</code>是右值）创建的。</li></ul> 
<ol start="2"><li><strong>交换操作</strong>：</li></ol> 
<pre><code class="prism language-cpp"><span class="token function">swap</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 交换 s1 和 s 的数据</span>
</code></pre> 
<ul><li>在赋值运算符的实现中，调用<code>swap(s);</code>。这会交换当前对象<code>s1</code>和临时对象<code>s</code>的内部数据指针。</li></ul> 
<ol start="3"><li><strong>临时对象销毁</strong>：</li></ol> 
<pre><code class="prism language-cpp"><span class="token comment">// 临时对象 s 离开作用域，被销毁，释放旧资源</span>
</code></pre> 
<ul><li>在赋值运算符函数结束时，临时对象<code>s</code>离开作用域并被销毁，其析构函数会释放它所持有的资源。这些资源实际上是原来属于<code>s1</code>的旧资源。</li></ul> 
<ol start="4"><li><strong>返回当前对象</strong>：</li></ol> 
<pre><code class="prism language-cpp"><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token comment">// 返回当前对象的引用</span>
</code></pre> 
<ul><li>返回当前对象<code>s1</code>的引用，以支持连续赋值操作。<br> </li></ul> 
<h2><a id="_241"></a>容器操作</h2> 
<p></p> 
<h3><a id="size_243"></a>获取长度：size</h3> 
<pre><code class="prism language-cpp">		size_t <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>  
<span class="token comment">//考虑到不需要修改，我们加上 const。</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _size<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p></p> 
<h3><a id="capacity_252"></a>获取当前容量：capacity</h3> 
<pre><code class="prism language-cpp">		size_t <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _capacity<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p></p> 
<h3><a id="empty_260"></a>查询是否为空：empty</h3> 
<pre><code class="prism language-cpp">		<span class="token keyword">bool</span> <span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _size <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p></p> 
<h3><a id="reserve_268"></a>扩容：reserve</h3> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">reserve</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 如果请求的容量大于当前的容量，才需要重新分配内存</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">char</span><span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 分配新的内存空间，比请求的容量多一个字符</span>
        <span class="token comment">// 这个额外的字符用于存放字符串结尾的空字符 '\0'，确保字符串的有效性和正确性</span>

        <span class="token function">strcpy</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> _str<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将原字符串内容拷贝到新内存，也会拷贝结尾的 '\0'</span>

        <span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> _str<span class="token punctuation">;</span> <span class="token comment">// 释放原来的内存</span>

        _str <span class="token operator">=</span> tmp<span class="token punctuation">;</span> <span class="token comment">// 更新指针，使其指向新的内存</span>
        _capacity <span class="token operator">=</span> n<span class="token punctuation">;</span> <span class="token comment">// 更新容量</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>扩容扩容，所以n要≥_capacity<br> </p> 
<h3><a id="resize_290"></a>调整字符串大小：resize</h3> 
<p>记得用缺省值,用户在调用 resize 函数时可以选择性地提供第二个参数.<br>假如有一个字符串对象 str，当前大小为 5，内容为 “hello”，容量为 10。调用 str.resize(8, ‘x’) 后 就是 helloxxx\0<br>声明<br><code>void resize(size_t, char c = '\0');</code><br>定义</p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">resize</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">,</span> <span class="token keyword">char</span> c<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 如果新的大小大于当前大小，需要扩展字符串</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> _size<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 如果新的大小大于当前容量，需要扩展内存</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">reserve</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 调用 reserve 函数扩展容量</span>
        <span class="token punctuation">}</span>
        
        <span class="token comment">// 将新的字符填充到扩展后的字符串中</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> _size<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            _str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 如果新的大小小于当前大小，只需更新大小</span>
        _size <span class="token operator">=</span> n<span class="token punctuation">;</span> 
        <span class="token comment">// 注意：此时容量不会改变</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 更新字符串的实际大小，并确保字符串以空字符结尾</span>
    _str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>缩容就直接在下标为n的位置设置为\0即可。<br> </p> 
<h2><a id="_324"></a>字符串访问</h2> 
<p></p> 
<h3><a id="_326"></a>[]访问</h3> 
<pre><code class="prism language-cpp">		<span class="token comment">//仅能访问</span>
		<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">)</span> <span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//assert 括号里为假的时候才会报错</span>
			<span class="token keyword">return</span> _str<span class="token punctuation">[</span>pos<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//访问+修改</span>
		<span class="token keyword">char</span><span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;=</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> _str<span class="token punctuation">[</span>pos<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p></p> 
<h3><a id="_342"></a>迭代器访问</h3> 
<p>迭代器在 C++ 中常常被描述为类似指针的对象，它提供了对容器（比如字符串）中元素的访问和操作。<br>对于模拟实现的字符串类，我们可以直接使用原生指针来作为迭代器，通过 typedef 进行重命名，这样就可以在类中直接使用迭代器。<br>首先，我们使用 typedef 将指针重命名为迭代器，同时定义了常量迭代器：<br><code>typedef char* iterator;</code><br><code>typedef const char* const_iterator;</code></p> 
<pre><code class="prism language-cpp">        <span class="token comment">// 返回字符串的起始位置</span>
		iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _str<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 返回字符串的结束位置'\0' 的下一个位置（即 null 字符的位置）</span>
		iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _str <span class="token operator">+</span> _size<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 返回字符串的起始位置（const 版本，不能修改数据）</span>
<span class="token comment">//常量成员函数</span>
<span class="token comment">//const_iterator begin() const 和 const_iterator end() const 被声明为常量成员函数。</span>
<span class="token comment">//这意味着它们不会修改对象的任何成员变量，并且它们可以被常量对象调用。</span>
   <span class="token comment">//为什么需要最右边的const???</span>
<span class="token comment">//如果没有最后的 const 修饰符，编译器将认为 begin() 和 end() 可能会修改对象。因此，当你试图在一个常量对象上调用这些函数时，会产生编译错误，因为编译器不允许通过常量对象调用非常量成员函数。</span>
		const_iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _str<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 返回字符串的结束位置的下一个位置（const 版本）</span>
		const_iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _str <span class="token operator">+</span> _size<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p>这些函数使得我们可以像操作指针一样操作迭代器，比如使用 ++ 和 – 来移动迭代器指向的位置，或者使用 * 来访问迭代器指向的元素。这样，我们就可以通过迭代器来遍历字符串中的字符了。<br> </p> 
<h2><a id="_372"></a>插入类</h2> 
<p></p> 
<h3><a id="push_back_374"></a>尾插一个字符push_back</h3> 
<pre><code class="prism language-cpp">		<span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">==</span> _capacity<span class="token punctuation">)</span><span class="token comment">//大小和总容量一样的时候，说明不够用了</span>
			<span class="token punctuation">{<!-- --></span>
				size_t newCapacity <span class="token operator">=</span> _capacity <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">4</span> <span class="token operator">:</span> _capacity <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
				<span class="token function">reserve</span><span class="token punctuation">(</span>newCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			_str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>
			_size<span class="token operator">++</span><span class="token punctuation">;</span>
			_str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span><span class="token comment">//一定要处理好\0</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p></p> 
<h3><a id="append_389"></a>append</h3> 
<p></p> 
<h4><a id="string_391"></a>在尾部追加一个string对象</h4> 
<pre><code class="prism language-cpp">string<span class="token operator">&amp;</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 检查是否需要扩展容量</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">.</span>_size <span class="token operator">&gt;=</span> _capacity <span class="token operator">-</span> _size<span class="token punctuation">)</span> <span class="token comment">// 判断是否需要扩容</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">reserve</span><span class="token punctuation">(</span>_capacity <span class="token operator">+</span> str<span class="token punctuation">.</span>_size <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 扩容并预留足够空间</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 复制传入的字符串到当前字符串的末尾</span>
    <span class="token function">strcpy</span><span class="token punctuation">(</span>_str <span class="token operator">+</span> _size<span class="token punctuation">,</span> str<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// _str + _size 是当前字符串尾部</span>
    
    <span class="token comment">// 更新当前字符串的大小</span>
    _size <span class="token operator">+=</span> str<span class="token punctuation">.</span>_size<span class="token punctuation">;</span> <span class="token comment">// 更新_size</span>
    
    <span class="token comment">// 手动设置字符串的结尾</span>
    _str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span> <span class="token comment">// 手动设置字符串尾部的\0</span>
    
    <span class="token comment">// 返回当前对象的引用</span>
    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token comment">// 返回string对象</span>
<span class="token punctuation">}</span>

</code></pre> 
<p></p> 
<h4><a id="C_416"></a>在尾部追加一个C风格字符串</h4> 
<pre><code class="prism language-cpp">		<span class="token keyword">void</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span> <span class="token comment">//注意传的是指针</span>
		<span class="token punctuation">{<!-- --></span>	
			size_t len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">+</span> len <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">reserve</span><span class="token punctuation">(</span>_size <span class="token operator">+</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token comment">//char *strcpy(char *dest, const char *src);   strcat(_str,str)也行，但是效率不行</span>
			<span class="token function">strcpy</span><span class="token punctuation">(</span>_str <span class="token operator">+</span> _size<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
			_size <span class="token operator">+=</span> len<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p></p> 
<h4><a id="n_431"></a>在尾部追加n个字符</h4> 
<pre><code class="prism language-cpp">		<span class="token keyword">void</span> <span class="token function">append</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">,</span> <span class="token keyword">char</span> ch<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">// 检查是否需要扩展容量</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">+</span> n <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">reserve</span><span class="token punctuation">(</span>_size <span class="token operator">+</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 扩展容量以容纳新字符</span>
			<span class="token punctuation">}</span>

			<span class="token comment">// 将字符 ch 追加 n 次到字符串末尾</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				_str<span class="token punctuation">[</span>_size <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token comment">// 更新字符串的大小</span>
			_size <span class="token operator">+=</span> n<span class="token punctuation">;</span>

			<span class="token comment">// 确保字符串以 '\0' 结尾</span>
			_str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p>注意：_size和_capacity是不计算\0的<br> </p> 
<h3><a id="insert_456"></a>insert</h3> 
<p></p> 
<h4><a id="pos_458"></a>在pos位置插入一个字符</h4> 
<blockquote> 
 <p>在 C++ 中，通常情况下，字符串的位置索引 pos 是从 0 开始的，即第一个字符的位置为 0，第二个为 1，依此类推。这种习惯是因为 C++ 中的数组和字符串的索引都是从 0 开始计数的。<br> _str 表示字符串的起始位置，即第一个字符的地址。<br> _str + 1 表示字符串中第二个字符的地址。<br> _str + pos 表示字符串中第 pos 个位置的地址，即要进行插入或其他操作的位置。</p> 
</blockquote> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> <span class="token keyword">char</span> ch<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 确保插入位置在有效范围内</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;=</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// pos 等于 _size 时表示尾插</span>
    
    <span class="token comment">// 检查是否需要扩展容量</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">==</span> _capacity<span class="token punctuation">)</span> <span class="token comment">// 大小和总容量一样的时候，说明不够用了</span>
    <span class="token punctuation">{<!-- --></span>
        size_t newCapacity <span class="token operator">=</span> _capacity <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">4</span> <span class="token operator">:</span> _capacity <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// 扩展容量，最小扩展到 4</span>
        <span class="token function">reserve</span><span class="token punctuation">(</span>newCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 调用 reserve 函数扩展容量</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 从后往前 移动数据以腾出插入位置</span>
    <span class="token keyword">int</span> end <span class="token operator">=</span> _size<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>end <span class="token operator">&gt;=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>pos<span class="token punctuation">)</span> <span class="token comment">// 循环直到 end 小于 pos</span>
    <span class="token punctuation">{<!-- --></span>
        _str<span class="token punctuation">[</span>end <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> _str<span class="token punctuation">[</span>end<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 将当前位置的数据向后移动一位</span>
        <span class="token operator">--</span>end<span class="token punctuation">;</span> <span class="token comment">// end 减 1</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 在指定位置插入新字符</span>
    _str<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span> <span class="token comment">// 在 pos 位置插入字符 ch</span>
    _size<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">// 更新大小</span>
    _str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span> <span class="token comment">// 确保字符串以 '\0' 结尾</span>
<span class="token punctuation">}</span>

</code></pre> 
<blockquote> 
 <p>为什么 while (end &gt;= (int)pos) 要强制转换成int类型呢？<br> 因为end 是一个 size_t 类型的变量，这是一个无符号整数类型。pos 也是 size_t 类型。如果直接比较 end 和 pos，即使 end 被减到负值，由于 size_t 是无符号类型，负值会被当成一个非常大的正整数。这可能会导致无限循环和访问越界。<br> 通过将 pos 强制转换为 int，确保 end 和 pos 在比较时都是有符号整数类型，从而避免了无符号整数类型转换的问题。这种做法保证了在 end 小于 pos 时，循环能正确退出。</p> 
</blockquote> 
<p></p> 
<h4><a id="pos_497"></a>在pos位置插入一个字符串</h4> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 确保插入位置在当前字符串长度范围内</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;=</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 计算要插入字符串的长度</span>
    size_t len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 如果当前容量不足以容纳插入后的新字符串，则增加容量</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">+</span> len <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">reserve</span><span class="token punctuation">(</span>_size <span class="token operator">+</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 调用 reserve 函数扩展容量</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 使用有符号整数类型的 end 变量，以避免无符号整数类型带来的潜在问题</span>
    <span class="token keyword">int</span> end <span class="token operator">=</span> _size<span class="token punctuation">;</span>
    
    <span class="token comment">// 从字符串末尾向前移动字符，以腾出插入位置</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>end <span class="token operator">&gt;=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>pos<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        _str<span class="token punctuation">[</span>end <span class="token operator">+</span> len<span class="token punctuation">]</span> <span class="token operator">=</span> _str<span class="token punctuation">[</span>end<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 将当前位置的数据向后移动 len 位</span>
        <span class="token operator">--</span>end<span class="token punctuation">;</span> <span class="token comment">// end 减 1</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 将新的字符串插入到指定位置</span>
    <span class="token function">strncpy</span><span class="token punctuation">(</span>_str <span class="token operator">+</span> pos<span class="token punctuation">,</span> str<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 使用 strncpy 复制字符串内容，但不包括末尾的 '\0'</span>
    
    <span class="token comment">// 更新字符串的大小</span>
    _size <span class="token operator">+=</span> len<span class="token punctuation">;</span> <span class="token comment">// 新字符串的长度增加</span>
    _str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span> <span class="token comment">// 确保字符串以 '\0' 结尾</span>
<span class="token punctuation">}</span>

</code></pre> 
<p></p> 
<h3><a id="operator_533"></a>operator+=</h3> 
<pre><code class="prism language-cpp">		string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">)</span><span class="token comment">//+=一个字符</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">push_back</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span><span class="token comment">//+=一个 char* 字符串</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">append</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
        string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span> <span class="token comment">//+=一个string对象</span>
        <span class="token punctuation">{<!-- --></span>
        	<span class="token function">append</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
        	<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre> 
<p></p> 
<h2><a id="_552"></a>删除类</h2> 
<p></p> 
<h3><a id="erase_554"></a>erase</h3> 
<p>从pos位置开始，删除长度为len的字符串。若未给出len，则默认删完.<br><code>void erase(size_t pos, size_t len = npos);</code></p> 
<pre><code class="prism language-cpp">		<span class="token keyword">void</span> <span class="token function">erase</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span>size_t len<span class="token punctuation">)</span>  <span class="token comment">//pos 是下标，删除1个就是pos位置的那个</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">//assert(pos &lt;_size);// xxxx size=4,</span>
			<span class="token comment">//assert(_size &gt; 0);</span>
			<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 这里不需要检查 pos &gt;= 0，因为 pos 是无符号类型</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">==</span> npos<span class="token operator">||</span>pos<span class="token operator">+</span>len<span class="token operator">&gt;=</span>_size<span class="token punctuation">)</span><span class="token comment">//要删完</span>
			<span class="token punctuation">{<!-- --></span><span class="token comment">//但我们不用删，直接缩大小，</span>
				_str<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
				_size <span class="token operator">=</span> pos<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span>   
			<span class="token punctuation">{<!-- --></span>
                <span class="token comment">//后面数据挪过去覆盖</span>
				<span class="token comment">// hello,wordl</span>
				<span class="token comment">//       ↑  ↑：pos+len</span>
				<span class="token comment">//      pos   删3个</span>
				<span class="token function">strcpy</span><span class="token punctuation">(</span>_str <span class="token operator">+</span> pos<span class="token punctuation">,</span> _str <span class="token operator">+</span> pos <span class="token operator">+</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
				_size <span class="token operator">-=</span> len<span class="token punctuation">;</span><span class="token comment">//覆盖之后减少_size即可</span>

			<span class="token punctuation">}</span>
			<span class="token comment">//"abcdefghi"。假如pos是3,len是4。pos是下标</span>
			<span class="token comment">//_str 指向字符串的第一个字符，即 'a'。</span>
			<span class="token comment">//_str + pos 指向字符串的第 4 个字符，即 'd'。</span>
			<span class="token comment">//_str + pos + len 指向字符串的第 8 个字符，即 'h'。</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p></p> 
<h2><a id="_586"></a>其他操作</h2> 
<p></p> 
<h3><a id="swap_588"></a>swap</h3> 
<p>尽管标准库中的 std::swap 可以用于交换两个对象，但是它仅在你提供的交换操作对你特定类的成员变量的交换上不能直接进行。<br>标准库的 std::swap 无法直接处理类的私有成员变量的交换，而必须通过类提供的接口进行交换操作。<br>所以 自定义类型要自己写,上面的拷贝构造和赋值重载的现代写法都用到了此处的swap函数</p> 
<pre><code class="prism language-cpp">		<span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
			std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_size<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
			std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_capacity<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_capacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p></p> 
<h3><a id="find_599"></a>find</h3> 
<p></p> 
<h4><a id="cstring_601"></a>返回字符c在string中第一次出现的位置</h4> 
<p><code>size_t find(char ch,size_t pos=0)</code></p> 
<pre><code class="prism language-cpp">		size_t  <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">,</span>size_t pos<span class="token punctuation">)</span><span class="token comment">//半缺省</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span>pos<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> _size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>_str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> ch<span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					<span class="token keyword">return</span> i<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">return</span> npos<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p></p> 
<h4><a id="sstring_617"></a>返回子串s在string中第一次出现的位置</h4> 
<p><code>size_t find(const char* str,size_t pos=0);</code></p> 
<pre><code class="prism language-cpp">size_t <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">,</span> size_t pos <span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 使用 strstr 函数从 _str + pos 位置开始查找子字符串 str</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> ptr <span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>_str <span class="token operator">+</span> pos<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 如果 ptr 为空，表示没有找到子字符串</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ptr <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 返回 npos 表示查找失败</span>
        <span class="token keyword">return</span> npos<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 返回子字符串在字符串中的起始位置</span>
        <span class="token keyword">return</span> ptr <span class="token operator">-</span> _str<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<blockquote> 
 <p>strstr 是 C 语言标准库 （或 &lt;string.h&gt;）中的函数，用于在一个字符串中查找第一次出现另一个字符串的位置。<br> <code>constchar* strstr(constchar* str1, constchar* str2); </code></p> 
 <ul><li>str1：要在其中搜索的主字符串。</li><li>str2：要搜索的子字符串。</li><li>如果 str2 是 str1 的子串，则返回指向 str1 中第一次出现 str2 的位置的指针。</li><li>如果 str2 不是 str1 的子串，则返回 nullptr。</li></ul> 
</blockquote> 
<p></p> 
<h3><a id="substr_647"></a>substr</h3> 
<p>从当前字符串中提取子串。 <br><code>string substr(size_t pos = 0, size_t len = npos);</code></p> 
<pre><code class="prism language-cpp">		string <span class="token function">substr</span><span class="token punctuation">(</span>size_t pos <span class="token punctuation">,</span> size_t len <span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>

			<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
			size_t end <span class="token operator">=</span> pos <span class="token operator">+</span> len<span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">==</span> npos <span class="token operator">||</span> pos <span class="token operator">+</span> len <span class="token operator">&gt;=</span> _size<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				end <span class="token operator">=</span> _size<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			string str<span class="token punctuation">;</span>
			str<span class="token punctuation">.</span><span class="token function">reserve</span><span class="token punctuation">(</span>end <span class="token operator">-</span> pos<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> pos<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> end<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				str <span class="token operator">+=</span> _str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">return</span> str<span class="token punctuation">;</span><span class="token comment">//返回str的拷贝</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p></p> 
<h3><a id="printf_str_669"></a>printf_str</h3> 
<p>打印C风格字符串。C风格字符串是以空字符 ‘\0’ 结尾的字符数组</p> 
<pre><code class="prism language-cpp">        <span class="token keyword">void</span> <span class="token function">printf_str</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token comment">//权限放大，上面的末尾要加const</span>
<span class="token comment">//在C++中，成员函数末尾的const关键字用于指示该函数不会修改对象的状态。这种函数被称为const成员函数，它们对于保证对象的不可变性非常重要。</span>
<span class="token comment">//c_str() 和 size() 都是访问器函数，它们不会修改字符串对象的内容，因此应该声明为const成员函数以确保它们可以在const对象上调用。</span>
<span class="token comment">//这样做不仅符合面向对象的设计理念，还允许用户在const对象上调用这些函数，以便于在const上下文中使用你的类。</span>
<span class="token comment">//而对于const char&amp; operator[](size_t pos) const，它是一个重载的下标运算符，用于访问字符串中指定位置的字符。由于该函数不会修改对象的内容，因此也应该声明为const成员函数。</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token comment">//	s[i]++;    参数加const 就是为了防止这里进行修改。</span>
				cout <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>

			<span class="token punctuation">}</span>
			cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p></p> 
<h3><a id="clear_688"></a>clear</h3> 
<p>清空当前字符串对象，使其变为空字符串</p> 
<pre><code class="prism language-cpp">        <span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			_str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span><span class="token comment">//</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p></p> 
<h3><a id="c_str_698"></a>c_str</h3> 
<p>获取字符串源指针<br>有些场景下，例如使用C语言的字符串操作函数，处理字符串时只能使用char*指针去传参，string为了兼容C字符串操作函数，支持获取字符串源指针，为了不破坏string的数据结构，这个返回的源字符串指针不支持修改，只能访问内容！<br>这个函数非常短小，直接在类中实现！</p> 
<pre><code class="prism language-cpp">		<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> 
		<span class="token punctuation">{<!-- --></span>
            <span class="token function">assert</span><span class="token punctuation">(</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> _str<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p></p> 
<h3><a id="_708"></a>逻辑判断</h3> 
<p>实现了小于和等于，其他的直接复用.<br> 都被声明为 const 成员函数。 const 关键字的作用是告诉编译器这些成员函数不会修改类的成员变量 _str 和 _size。</p> 
<blockquote> 
 <p>在 C++ 中，类的 const 成员函数可以确保在函数内部不会修改对象的任何成员变量，从而提供了对调用者的额外保证。这样的设计有助于代码的可维护性和可理解性。<br> 如果没有将比较操作符声明为 const，则无法在常量对象上调用这些操作符，因为常量对象只能调用 const 成员函数。例如，对于声明为 const 的对象或者在常量上下文中使用的对象（如 const String s1, s2;），可以正常地执行比较操作。</p> 
</blockquote> 
<pre><code class="prism language-cpp"><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token comment">//小于</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token comment">//等于</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token comment">//小于等于</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token generic-function"><span class="token function">this</span> <span class="token generic class-name"><span class="token operator">&lt;</span> s<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">==</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token comment">//大于</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">&lt;=</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&gt;=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token comment">//大于等于</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">&lt;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token comment">//不等</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">==</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<p></p> 
<h2><a id="_747"></a>流操作</h2> 
<p>当我们在 C++ 中定义流插入运算符 &lt;&lt; 和流提取运算符 &gt;&gt; 时，如果将它们定义为类的成员函数，会遇到一个问题：类的成员函数默认会有一个隐含的 this 指针作为第一个参数。这样的话，如果我们试图将 operator&lt;&lt; 或 operator&gt;&gt; 定义为成员函数，形式上会与预期不符，因为它们需要接受两个参数（左操作数和右操作数），而类成员函数形式下只能接受一个参数（除非将其定义为静态成员函数，但这不符合重载运算符的惯用方式）。<br>因此，为了正确地重载这些运算符，我们将它们定义为类的友元函数。友元函数可以在不通过对象接口（即不使用 this 指针）的情况下访问类的私有成员和受保护成员。这种做法不仅符合语法要求，还能保持类的封装性和安全性，因为只有特定的函数（即声明为友元的函数）才能直接访问类的私有部分。<br> </p> 
<h3><a id="_750"></a>流插入&lt;&lt;</h3> 
<pre><code class="prism language-cpp">	ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> ch <span class="token operator">:</span> s<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			out <span class="token operator">&lt;&lt;</span> ch<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> out<span class="token punctuation">;</span><span class="token comment">//返回ostream对象 以支持cout&lt;&lt;s1&lt;&lt;s2&lt;&lt;s3</span>
	<span class="token punctuation">}</span>
</code></pre> 
<p></p> 
<h3><a id="_762"></a>流提取&gt;&gt;</h3> 
<pre><code class="prism language-cpp">	istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span> <span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> in<span class="token punctuation">,</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		s<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 清空当前字符串，以免变成尾插了</span>
		<span class="token keyword">char</span> buff<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 创建一个缓冲区用于暂存读取的字符序列</span>
		<span class="token keyword">char</span> ch <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 从输入流中读取一个字符</span>
		<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 初始化缓冲区索引</span>

		<span class="token comment">// 循环读取字符直到遇到空格或换行符</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">!=</span> <span class="token char">' '</span> <span class="token operator">&amp;&amp;</span> ch <span class="token operator">!=</span> <span class="token char">'\n'</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			buff<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span> <span class="token comment">// 将读取的字符存储到缓冲区中</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">127</span><span class="token punctuation">)</span> <span class="token comment">// 如果缓冲区即将满了</span>
			<span class="token punctuation">{<!-- --></span>
				buff<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span> <span class="token comment">// 在缓冲区末尾添加字符串终止符</span>
				s <span class="token operator">+=</span> buff<span class="token punctuation">;</span> <span class="token comment">// 将缓冲区中的字符序列插入到字符串对象中</span>
				i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 重置缓冲区索引</span>
			<span class="token punctuation">}</span>
			ch <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 读取下一个字符</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 处理剩余的字符序列</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			buff<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span> <span class="token comment">// 在缓冲区末尾添加字符串终止符</span>
			s <span class="token operator">+=</span> buff<span class="token punctuation">;</span> <span class="token comment">// 将缓冲区中的字符序列插入到字符串对象中</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">return</span> in<span class="token punctuation">;</span> <span class="token comment">// 返回输入流对象的引用</span>
	<span class="token punctuation">}</span>
</code></pre> 
<p></p> 
<h2><a id="string_795"></a>拓展:关于string其他常用函数</h2> 
<p></p> 
<h4><a id="to_string_797"></a>to_string</h4> 
<p>to_string 是 C++ 中的一个标准库函数，用于将各种类型的数据转换为对应的字符串表示形式。 <br>头文件:<code>#include&lt;string&gt;</code><br>语法:<code>std::string to_string(类型 value); </code> 类型可以是整数、浮点数。value: 要转换为字符串的数值。 返回转换后的 std::string 类型对象，表示数值的字符串形式。 <img src="https://images2.imgbox.com/7e/67/b9z1psai_o.png" alt="image.png"></p> 
<p></p> 
<h4><a id="stoi_801"></a>stoi</h4> 
<p>stoi 是 C++ 中的一个标准库函数，用于将字符串转换为对应的整数类型。 <br>头文件:<code>#include&lt;string&gt;</code><br><code>int stoi(const std::string&amp; str, size_t* pos = 0, int base = 10);</code></p> 
<ul><li>str: 要转换的字符串。</li><li>pos (可选): 指向 size_t 类型的指针，用于存储第一个无效字符的索引。</li><li>base (可选): 数字的基数，默认为 10。</li></ul> 
<p>返回：</p> 
<ul><li>返回转换后的整数值。</li></ul> 
<p><img src="https://images2.imgbox.com/18/8b/2HORV5wM_o.png" alt="image.png"><br> </p> 
<h2><a id="_814"></a>完整代码展示</h2> 
<p></p> 
<h3><a id="h_816"></a>.h文件</h3> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_CRT_SECURE_NO_WARNINGS</span> <span class="token expression"><span class="token number">1</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;assert.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">namespace</span> Mystring
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">class</span> <span class="token class-name">string</span>
	<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">public</span><span class="token operator">:</span>
		<span class="token keyword">typedef</span> <span class="token keyword">char</span><span class="token operator">*</span> iterator<span class="token punctuation">;</span>
		<span class="token keyword">typedef</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> const_iterator<span class="token punctuation">;</span>

		iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _str<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _str <span class="token operator">+</span> _size<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		const_iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _str<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		const_iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _str <span class="token operator">+</span> _size<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		size_t <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _size<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		size_t <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _capacity<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">bool</span> <span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _size <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">void</span> <span class="token function">printf_str</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				cout <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			_str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span><span class="token comment">//</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">assert</span><span class="token punctuation">(</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> _str<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token operator">~</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
		string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span>string s<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
		<span class="token keyword">void</span> <span class="token function">reserve</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">void</span> <span class="token function">resize</span><span class="token punctuation">(</span>size_t<span class="token punctuation">,</span> <span class="token keyword">char</span> c <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	

		<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
		<span class="token keyword">char</span><span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">)</span><span class="token punctuation">;</span>
	

		<span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">void</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">void</span> <span class="token function">append</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">,</span> <span class="token keyword">char</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
		string<span class="token operator">&amp;</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> <span class="token keyword">char</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
		string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">void</span> <span class="token function">erase</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> size_t len <span class="token operator">=</span> npos<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
		size_t <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">,</span> size_t pos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		size_t <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">,</span> size_t pos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		string <span class="token function">substr</span><span class="token punctuation">(</span>size_t pos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> size_t len <span class="token operator">=</span> npos<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
		<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token comment">//小于</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token comment">//等于</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>


		<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token comment">//小于等于</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token generic-function"><span class="token function">this</span> <span class="token generic class-name"><span class="token operator">&lt;</span> s<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">==</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token comment">//大于</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">&lt;=</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&gt;=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token comment">//大于等于</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">&lt;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token comment">//不等</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">==</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

	<span class="token keyword">private</span><span class="token operator">:</span>
		size_t _capacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		size_t _size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">char</span><span class="token operator">*</span> _str <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>

		<span class="token keyword">const</span> <span class="token keyword">static</span> size_t npos <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>

	istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> in<span class="token punctuation">,</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
	ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p></p> 
<h3><a id="cpp_959"></a>.cpp文件</h3> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_CRT_SECURE_NO_WARNINGS</span> <span class="token expression"><span class="token number">1</span></span></span>
<span class="token comment">//这个是声明和定义分离的版本</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"string16.h"</span></span>



<span class="token keyword">namespace</span> Mystring
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//构造函数</span>
	string<span class="token double-colon punctuation">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_size <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		_capacity <span class="token operator">=</span> _size<span class="token punctuation">;</span>
		_str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>_capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

		<span class="token function">strcpy</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//析构函数</span>
	<span class="token class-name">string</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> _str<span class="token punctuation">;</span>
		_str <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
		_size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		_capacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//拷贝构造 现代写法</span>
	string<span class="token double-colon punctuation">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		string <span class="token function">tmp</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">swap</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//运算符重载</span>
	string<span class="token operator">&amp;</span> string<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span>string s<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">swap</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>


	<span class="token comment">//仅能访问</span>
	<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">&amp;</span> string<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">)</span> <span class="token keyword">const</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//assert 括号里为假的时候才会报错</span>
		<span class="token keyword">return</span> _str<span class="token punctuation">[</span>pos<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//访问+修改</span>
	<span class="token keyword">char</span><span class="token operator">&amp;</span> string<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;=</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> _str<span class="token punctuation">[</span>pos<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>


	<span class="token keyword">void</span> string<span class="token double-colon punctuation">::</span><span class="token function">reserve</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">char</span><span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token function">strcpy</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> _str<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> _str<span class="token punctuation">;</span>
			_str <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
			_capacity <span class="token operator">=</span> n<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> string<span class="token double-colon punctuation">::</span><span class="token function">resize</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">,</span> <span class="token keyword">char</span> c<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> _size<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">reserve</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token punctuation">}</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> _size<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				_str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_size <span class="token operator">=</span> n<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		_str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>



	<span class="token keyword">void</span> string<span class="token double-colon punctuation">::</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">==</span> _capacity<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			size_t newCapacity <span class="token operator">=</span> _capacity <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">4</span> <span class="token operator">:</span> _capacity <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
			<span class="token function">reserve</span><span class="token punctuation">(</span>newCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		_str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>
		_size<span class="token operator">++</span><span class="token punctuation">;</span>
		_str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">void</span> string<span class="token double-colon punctuation">::</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		size_t len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">+</span> len <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">reserve</span><span class="token punctuation">(</span>_size <span class="token operator">+</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token function">strcpy</span><span class="token punctuation">(</span>_str <span class="token operator">+</span> _size<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		_size <span class="token operator">+=</span> len<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	string<span class="token operator">&amp;</span> string<span class="token double-colon punctuation">::</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 检查是否需要扩展容量</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">.</span>_size <span class="token operator">&gt;=</span> _capacity <span class="token operator">-</span> _size<span class="token punctuation">)</span> <span class="token comment">// 判断是否需要扩容</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">reserve</span><span class="token punctuation">(</span>_capacity <span class="token operator">+</span> str<span class="token punctuation">.</span>_size <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 扩容并预留足够空间</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 复制传入的字符串到当前字符串的末尾</span>
		<span class="token function">strcpy</span><span class="token punctuation">(</span>_str <span class="token operator">+</span> _size<span class="token punctuation">,</span> str<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// _str + _size 是当前字符串尾部</span>

		<span class="token comment">// 更新当前字符串的大小</span>
		_size <span class="token operator">+=</span> str<span class="token punctuation">.</span>_size<span class="token punctuation">;</span> <span class="token comment">// 更新_size</span>

		<span class="token comment">// 手动设置字符串的结尾</span>
		_str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span> <span class="token comment">// 手动设置字符串尾部的\0</span>

		<span class="token comment">// 返回当前对象的引用</span>
		<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token comment">// 返回string对象</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">void</span> string<span class="token double-colon punctuation">::</span><span class="token function">append</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">,</span> <span class="token keyword">char</span> ch<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 检查是否需要扩展容量</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">+</span> n <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">reserve</span><span class="token punctuation">(</span>_size <span class="token operator">+</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 扩展容量以容纳新字符</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 将字符 ch 追加 n 次到字符串末尾</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_str<span class="token punctuation">[</span>_size <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 更新字符串的大小</span>
		_size <span class="token operator">+=</span> n<span class="token punctuation">;</span>

		<span class="token comment">// 确保字符串以 '\0' 结尾</span>
		_str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>




	<span class="token keyword">void</span> string<span class="token double-colon punctuation">::</span><span class="token function">insert</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> <span class="token keyword">char</span> ch<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;=</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">==</span> _capacity<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			size_t newCapacity <span class="token operator">=</span> _capacity <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">4</span> <span class="token operator">:</span> _capacity <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
			<span class="token function">reserve</span><span class="token punctuation">(</span>newCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">/*int end = _size;
		while (end &gt;= (int)pos)
		{
			_str[end + 1] = _str[end];
			--end;
		}*/</span>

		size_t end <span class="token operator">=</span> _size <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>end <span class="token operator">&gt;</span> pos<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_str<span class="token punctuation">[</span>end<span class="token punctuation">]</span> <span class="token operator">=</span> _str<span class="token punctuation">[</span>end <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token operator">--</span>end<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		_str<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>
		_size<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">void</span> string<span class="token double-colon punctuation">::</span><span class="token function">insert</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;=</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
		size_t len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">+</span> len <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">reserve</span><span class="token punctuation">(</span>_size <span class="token operator">+</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">int</span> end <span class="token operator">=</span> _size<span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>end <span class="token operator">&gt;=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>pos<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_str<span class="token punctuation">[</span>end <span class="token operator">+</span> len<span class="token punctuation">]</span> <span class="token operator">=</span> _str<span class="token punctuation">[</span>end<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token operator">--</span>end<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token function">strncpy</span><span class="token punctuation">(</span>_str <span class="token operator">+</span> pos<span class="token punctuation">,</span> str<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
		_size <span class="token operator">+=</span> len<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	string<span class="token operator">&amp;</span> string<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">push_back</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	string<span class="token operator">&amp;</span> string<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">append</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>


	<span class="token keyword">void</span> string<span class="token double-colon punctuation">::</span><span class="token function">erase</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> size_t len<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">==</span> npos <span class="token operator">||</span> pos <span class="token operator">+</span> len <span class="token operator">&gt;=</span> _size<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_str<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
			_size <span class="token operator">=</span> pos<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">strcpy</span><span class="token punctuation">(</span>_str <span class="token operator">+</span> pos<span class="token punctuation">,</span> _str <span class="token operator">+</span> pos <span class="token operator">+</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
			_size <span class="token operator">-=</span> len<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">void</span> string<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_size<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
		std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_capacity<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_capacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	size_t string<span class="token double-colon punctuation">::</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">,</span> size_t pos<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> pos<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> _size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>_str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> ch<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token keyword">return</span> i<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">return</span> npos<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	size_t string<span class="token double-colon punctuation">::</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">,</span> size_t pos<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> ptr <span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>_str <span class="token operator">+</span> pos<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>ptr <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> npos<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> ptr <span class="token operator">-</span> _str<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	string string<span class="token double-colon punctuation">::</span><span class="token function">substr</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> size_t len<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
		size_t end <span class="token operator">=</span> pos <span class="token operator">+</span> len<span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">==</span> npos <span class="token operator">||</span> pos <span class="token operator">+</span> len <span class="token operator">&gt;=</span> _size<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			end <span class="token operator">=</span> _size<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		string str<span class="token punctuation">;</span>
		str<span class="token punctuation">.</span><span class="token function">reserve</span><span class="token punctuation">(</span>end <span class="token operator">-</span> pos<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> pos<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> end<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			str <span class="token operator">+=</span> _str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">return</span> str<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>


	ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> ch <span class="token operator">:</span> s<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token generic-function"><span class="token function">out</span> <span class="token generic class-name"><span class="token operator">&lt;&lt;</span> ch<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">return</span> out<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&gt;&gt;</span></span></span><span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> in<span class="token punctuation">,</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		s<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">char</span> buff<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token keyword">char</span> ch <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">!=</span> <span class="token char">' '</span> <span class="token operator">&amp;&amp;</span> ch <span class="token operator">!=</span> <span class="token char">'\n'</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			buff<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">127</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				buff<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
				s <span class="token operator">+=</span> buff<span class="token punctuation">;</span>
				i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			ch <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			buff<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
			s <span class="token operator">+=</span> buff<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">return</span> in<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/d0/15/JFZ8YNmI_o.png" alt="07c03ae6d77b4b153f6d1ec710be7c14_7a80245f0b5f4021a033b3789a9efdeb.png"></p> 
<ol><li>📜 [ 声明 ] 由于作者水平有限，本文有错误和不准确之处在所难免，</li><li>本人也很想知道这些错误，恳望读者批评指正！</li></ol> 
<p></p> 
<h2><a id="_1312"></a></h2>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8e135565881d28ff0db5628f88731bcd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MySQL 死锁问题排查与分析</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a68fd6bb0e443401b6c9dc83a775efd7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">文生图王者登场：Stable Diffusion 3 Medium正式开源</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>