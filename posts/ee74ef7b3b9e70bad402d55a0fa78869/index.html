<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python 读取 通达信 数据 pytdx - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/ee74ef7b3b9e70bad402d55a0fa78869/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="python 读取 通达信 数据 pytdx">
  <meta property="og:description" content="python 读取 通达信 数据 pytdx
pytdx 1.72
https://www.cnpython.com/pypi/pytdx
https://rainx.gitbooks.io/pytdx/content/pytdx_reader.html
pip3 install pytdx
from pytdx.reader import TdxDailyBarReader, TdxFileNotFoundException from pytdx.reader import BlockReader reader = TdxDailyBarReader() df = reader.get_df(&#34;C:\\new_tdx\\vipdoc\\sz\\lday\\sz000001.day&#34;) print(df) df = BlockReader().get_df(&#34;C:\\new_tdx\\T0002\\hq_cache\\block_zs.dat&#34;) print(df) df = reader.get_df(&#34;C:\\new_tdx\\vipdoc\\sh\\lday\\sh601688.day&#34;) print(df) 11
[9843 rows x 4 columns] open high low close amount volume date 2010-02-26 21.01 21.94 21.00 21.06 6.631745e&#43;09 3109136.36 2023-10-09 15.61 15.82 15.32 15.78 7.417075e&#43;08 475096.64 volume — 成交量 47.51万手 475096.64手 一手等于一百股">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-10-10T10:32:52+08:00">
    <meta property="article:modified_time" content="2023-10-10T10:32:52+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python 读取 通达信 数据 pytdx</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>python 读取 通达信 数据 pytdx</p> 
<p>pytdx 1.72<br> <a href="https://www.cnpython.com/pypi/pytdx" rel="nofollow">https://www.cnpython.com/pypi/pytdx</a></p> 
<p><a href="https://rainx.gitbooks.io/pytdx/content/pytdx_reader.html" rel="nofollow">https://rainx.gitbooks.io/pytdx/content/pytdx_reader.html</a></p> 
<p>pip3 install pytdx</p> 
<pre><code class="prism language-c">from pytdx<span class="token punctuation">.</span>reader import TdxDailyBarReader<span class="token punctuation">,</span> TdxFileNotFoundException
from pytdx<span class="token punctuation">.</span>reader import BlockReader

reader <span class="token operator">=</span> <span class="token function">TdxDailyBarReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">get_df</span><span class="token punctuation">(</span><span class="token string">"C:\\new_tdx\\vipdoc\\sz\\lday\\sz000001.day"</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>


df <span class="token operator">=</span> <span class="token function">BlockReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get_df</span><span class="token punctuation">(</span><span class="token string">"C:\\new_tdx\\T0002\\hq_cache\\block_zs.dat"</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

df <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">get_df</span><span class="token punctuation">(</span><span class="token string">"C:\\new_tdx\\vipdoc\\sh\\lday\\sh601688.day"</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre> 
<p>11</p> 
<pre><code class="prism language-c">
<span class="token punctuation">[</span><span class="token number">9843</span> rows x <span class="token number">4</span> columns<span class="token punctuation">]</span>
             open   high    low  close        amount      volume
date
<span class="token number">2010</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">26</span>  <span class="token number">21.01</span>  <span class="token number">21.94</span>  <span class="token number">21.00</span>  <span class="token number">21.06</span>  <span class="token number">6.631745e+09</span>  <span class="token number">3109136.36</span>
<span class="token number">2023</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">09</span>  <span class="token number">15.61</span>  <span class="token number">15.82</span>  <span class="token number">15.32</span>  <span class="token number">15.78</span>  <span class="token number">7.417075e+08</span>   <span class="token number">475096.64</span>
</code></pre> 
<p>volume — 成交量 47.51万手 475096.64手 一手等于一百股<br> amount — 成交额 7.42亿</p> 
<p>最高：15.82 <br> 今开：15.61 <br> 涨停：17.39 <br> 最低：15.32 <br> 昨收：15.81 <br> 成交量：47.51万手<br> 成交额：7.42亿</p> 
<h4><a id="1_45"></a>1</h4> 
<p>通达信软件官方免费提供沪深京日线、5分钟、1分钟k线数据下载，每日盘后提供当日数据下载，数据更新时间也很快，对于想要免费获取可靠数据进行投资的朋友来说是一个不错的选择</p> 
<p>数据下载<br> 通达信数据免费下载操作步骤如下：</p> 
<p>首先，在通达信官网下载通达信金融终端软件<br> 下载完成后将其安装在默认路径C:\new_tdx即可<br> 安装后打开，在菜单栏点击： 选项 --&gt; 盘后数据下载，弹出下面的面板：<br> 勾选日线和实时行情数据， 选择需要下载的对应时间范围的数据， 点击开始下载， 数据会保存到本地。 其中上证数据会下载到C:\new_tdx\vipdoc\sh\lday\sh000009.day， 深证数据会下载到C:\new_tdx\vipdoc\sz\lday\sz000009.day。 注意C:\new_tdx\为安装路径，如果不是使用的默认路径，需要进行更换<br> 数据解析<br> 通过通达信下载的day文件是二进制文件，可以使用手动解析，也可以使用lib库进行解析。下面分别介绍：</p> 
<p>手动解析</p> 
<pre><code class="prism language-c">def <span class="token function">day2csv</span><span class="token punctuation">(</span>source_dir<span class="token punctuation">,</span> file_name<span class="token punctuation">,</span> target_dir<span class="token punctuation">)</span><span class="token operator">:</span>
    # 以二进制方式打开源文件
    source_file <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span>source_dir <span class="token operator">+</span> os<span class="token punctuation">.</span>sep <span class="token operator">+</span> file_name<span class="token punctuation">,</span> <span class="token char">'rb'</span><span class="token punctuation">)</span>
    buf <span class="token operator">=</span> source_file<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    source_file<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    # 打开目标文件
    target_file <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span>target_dir <span class="token operator">+</span> os<span class="token punctuation">.</span>sep <span class="token operator">+</span> file_name<span class="token punctuation">[</span><span class="token operator">:</span> file_name<span class="token punctuation">.</span><span class="token function">rindex</span><span class="token punctuation">(</span><span class="token char">'.'</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token char">'.csv'</span><span class="token punctuation">,</span> <span class="token char">'w'</span><span class="token punctuation">)</span>
    buf_size <span class="token operator">=</span> <span class="token function">len</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span>
    rec_count <span class="token operator">=</span> <span class="token keyword">int</span><span class="token punctuation">(</span>buf_size <span class="token operator">/</span> <span class="token number">32</span><span class="token punctuation">)</span>
    begin <span class="token operator">=</span> <span class="token number">0</span>
    end <span class="token operator">=</span> <span class="token number">32</span>
    header <span class="token operator">=</span> <span class="token function">str</span><span class="token punctuation">(</span><span class="token char">'date'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token char">','</span> <span class="token operator">+</span> <span class="token function">str</span><span class="token punctuation">(</span><span class="token char">'open'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token char">','</span> <span class="token operator">+</span> <span class="token function">str</span><span class="token punctuation">(</span><span class="token char">'high'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token char">','</span> <span class="token operator">+</span> <span class="token function">str</span><span class="token punctuation">(</span><span class="token char">'low'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token char">','</span> \
             <span class="token operator">+</span> <span class="token function">str</span><span class="token punctuation">(</span><span class="token char">'close'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token char">','</span> <span class="token operator">+</span> <span class="token function">str</span><span class="token punctuation">(</span><span class="token char">'amount'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token char">','</span> <span class="token operator">+</span> <span class="token function">str</span><span class="token punctuation">(</span><span class="token char">'volume'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token char">'\n'</span>
    target_file<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>header<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i in <span class="token function">range</span><span class="token punctuation">(</span>rec_count<span class="token punctuation">)</span><span class="token operator">:</span>
        a <span class="token operator">=</span> <span class="token function">unpack</span><span class="token punctuation">(</span><span class="token char">'IIIIIfII'</span><span class="token punctuation">,</span> buf<span class="token punctuation">[</span>begin<span class="token operator">:</span>end<span class="token punctuation">]</span><span class="token punctuation">)</span>
        # 处理date数据
        year <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment">// 10000</span>
        month <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">%</span> <span class="token number">10000</span><span class="token punctuation">)</span> <span class="token comment">// 100</span>
        day <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">%</span> <span class="token number">10000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">100</span>
        date <span class="token operator">=</span> <span class="token char">'{}-{:02d}-{:02d}'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span> month<span class="token punctuation">,</span> day<span class="token punctuation">)</span>

        line <span class="token operator">=</span> date <span class="token operator">+</span> <span class="token char">','</span> <span class="token operator">+</span> <span class="token function">str</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">100.0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token char">','</span> <span class="token operator">+</span> <span class="token function">str</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">100.0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token char">','</span> \
               <span class="token operator">+</span> <span class="token function">str</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">100.0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token char">','</span> <span class="token operator">+</span> <span class="token function">str</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">100.0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token char">','</span> <span class="token operator">+</span> <span class="token function">str</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token char">','</span> \
               <span class="token operator">+</span> <span class="token function">str</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token char">'\n'</span>
        target_file<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>
        begin <span class="token operator">+=</span> <span class="token number">32</span>
        end <span class="token operator">+=</span> <span class="token number">32</span>
    target_file<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>使用mootdx解析<br> 需要安装mootdx库，使用pip install -U mootdx 进行安装</p> 
<pre><code class="prism language-c">from mootdx<span class="token punctuation">.</span>reader import Reader

reader <span class="token operator">=</span> Reader<span class="token punctuation">.</span><span class="token function">factory</span><span class="token punctuation">(</span>market<span class="token operator">=</span><span class="token char">'std'</span><span class="token punctuation">,</span> tdxdir<span class="token operator">=</span><span class="token char">'C:/new_tdx'</span><span class="token punctuation">)</span>

# 读取日线数据
reader<span class="token punctuation">.</span><span class="token function">daily</span><span class="token punctuation">(</span>symbol<span class="token operator">=</span><span class="token char">'600036'</span><span class="token punctuation">)</span>

# 读取<span class="token number">1</span>分钟数据
reader<span class="token punctuation">.</span><span class="token function">minute</span><span class="token punctuation">(</span>symbol<span class="token operator">=</span><span class="token char">'600036'</span><span class="token punctuation">)</span>
</code></pre> 
<p>11</p> 
<pre><code class="prism language-c">from mootdx<span class="token punctuation">.</span>reader import Reader

reader <span class="token operator">=</span> Reader<span class="token punctuation">.</span><span class="token function">factory</span><span class="token punctuation">(</span>market<span class="token operator">=</span><span class="token char">'std'</span><span class="token punctuation">,</span> tdxdir<span class="token operator">=</span><span class="token char">'C:/new_tdx'</span><span class="token punctuation">)</span>

# 读取日线数据
df <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">daily</span><span class="token punctuation">(</span>symbol<span class="token operator">=</span><span class="token char">'600036'</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

# 读取<span class="token number">1</span>分钟数据
df <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">minute</span><span class="token punctuation">(</span>symbol<span class="token operator">=</span><span class="token char">'600036'</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>


</code></pre> 
<p>由于篇幅有限，上面只给了示例代码， 更完整的代码可以关注公众号“诸葛说talk”后加群进行交流</p> 
<p>小结 &amp; 交流<br> 如果对通达信数据下载使用或股票投资感兴趣，请关注公众号后回复“入群”获取邀请加入A股交流群，名额有限，不要错过。</p> 
<p>写文章不易，觉得本文对你有帮助的话，还请帮忙点赞转发赞赏，让笔者有坚持写好文章的动力。</p> 
<p>参考<br> <a href="https://www.tdx.com.cn/soft.html" rel="nofollow">https://www.tdx.com.cn/soft.html</a><br> 这个手动解析函数可能有问题，试了3，5只股票，解析出来的数值都远大于真实值<br> 数据没复权的</p> 
<p><a href="https://www.mootdx.com/zh_CN/latest/" rel="nofollow">https://www.mootdx.com/zh_CN/latest/</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/096a3ecf635a4d22cac278856fdf79aa/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【RabbitMQ 实战】10 消息持久化和存储原理</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/29f24f027021143f97a1d43df5cc0f12/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">解决MySQL8.0报错Client does not support authentication protocol requested by server...问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>