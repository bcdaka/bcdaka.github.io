<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>50个kafka常见面试题及答案，撸完阿里P7见 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/31d2bf8e2c359594f375abb1ad260a3b/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="50个kafka常见面试题及答案，撸完阿里P7见">
  <meta property="og:description" content="LEO:LogEndOffset 当前日志文件中下一条待写信息的offset
HW/LEO这两个都是指最后一条的下一条的位置而不是指最后一条的位置。
LSO:Last Stable Offset 对未完成的事务而言，LSO 的值等于事务中第一条消息的位置(firstUnstableOffset)，对已完成的事务而言，它的值同 HW 相同
LW:Low Watermark 低水位, 代表 AR 集合中最小的 logStartOffset 值
4. Kafka中是怎么体现消息顺序性的？
kafka每个partition中的消息在写入时都是有序的，消费时，每个partition只能被每一个group中的一个消费者消费，保证了消费时也是有序的。
整个topic不保证有序。如果为了保证topic整个有序，那么将partition调整为1.
5. Kafka中的分区器、序列化器、拦截器是否了解？它们之间的处理顺序是什么？
拦截器-&gt;序列化器-&gt;分区器
6. Kafka生产者客户端的整体结构是什么样子的？
7. Kafka生产者客户端中使用了几个线程来处理？分别是什么？
2个，主线程和Sender线程。主线程负责创建消息，然后通过分区器、序列化器、拦截器作用之后缓存到累加器RecordAccumulator中。Sender线程负责将RecordAccumulator中消息发送到kafka中.
9. Kafka的旧版Scala的消费者客户端的设计有什么缺陷？
10. “消费组中的消费者个数如果超过topic的分区，那么就会有消费者消费不到数据”这句话是否正确？如果不正确，那么有没有什么hack的手段？
不正确，通过自定义分区分配策略，可以将一个consumer指定消费所有partition。
11. 消费者提交消费位移时提交的是当前消费到的最新消息的offset还是offset&#43;1?
offset&#43;1
12. 有哪些情形会造成重复消费？
消费者消费后没有commit offset(程序崩溃/强行kill/消费耗时/自动提交偏移情况下unscrible)
13. 那些情景下会造成消息漏消费？
消费者没有处理完消息 提交offset(自动提交偏移 未处理情况下程序异常结束)
14. KafkaConsumer是非线程安全的，那么怎么样实现多线程消费？
1.在每个线程中新建一个KafkaConsumer
2.单线程创建KafkaConsumer，多个处理线程处理消息（难点在于是否要考虑消息顺序性，offset的提交方式）
15. 简述消费者与消费组之间的关系
消费者从属与消费组，消费偏移以消费组为单位。每个消费组可以独立消费主题的所有数据，同一消费组内消费者共同消费主题数据，每个分区只能被同一消费组内一个消费者消费。
16. 当你使用kafka-topics.sh创建（删除）了一个topic之后，Kafka背后会执行什么逻辑？
创建:在zk上/brokers/topics/下节点 kafkabroker会监听节点变化创建主题
删除:调用脚本删除topic会在zk上将topic设置待删除标志，kafka后台有定时的线程会扫描所有需要删除的topic进行删除
17. topic的分区数可不可以增加？如果可以怎么增加？如果不可以，那又是为什么？
可以
18. topic的分区数可不可以减少？如果可以怎么减少？如果不可以，那又是为什么？
不可以
19. 创建topic时如何选择合适的分区数？
根据集群的机器数量和需要的吞吐量来决定适合的分区数
20. Kafka目前有那些内部topic，它们都有什么特征？各自的作用又是什么？">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-25T16:58:00+08:00">
    <meta property="article:modified_time" content="2024-03-25T16:58:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">50个kafka常见面试题及答案，撸完阿里P7见</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>LEO:LogEndOffset 当前日志文件中下一条待写信息的offset</p> 
<p>HW/LEO这两个都是指最后一条的下一条的位置而不是指最后一条的位置。</p> 
<p>LSO:Last Stable Offset 对未完成的事务而言，LSO 的值等于事务中第一条消息的位置(firstUnstableOffset)，对已完成的事务而言，它的值同 HW 相同</p> 
<p>LW:Low Watermark 低水位, 代表 AR 集合中最小的 logStartOffset 值</p> 
<p><strong>4. Kafka中是怎么体现消息顺序性的？</strong></p> 
<p>kafka每个partition中的消息在写入时都是有序的，消费时，每个partition只能被每一个group中的一个消费者消费，保证了消费时也是有序的。</p> 
<p>整个topic不保证有序。如果为了保证topic整个有序，那么将partition调整为1.</p> 
<p><strong>5. Kafka中的分区器、序列化器、拦截器是否了解？它们之间的处理顺序是什么？</strong></p> 
<p>拦截器-&gt;序列化器-&gt;分区器</p> 
<p><strong>6. Kafka生产者客户端的整体结构是什么样子的？</strong></p> 
<p><strong>7. Kafka生产者客户端中使用了几个线程来处理？分别是什么？</strong></p> 
<p>2个，主线程和Sender线程。主线程负责创建消息，然后通过分区器、序列化器、拦截器作用之后缓存到累加器RecordAccumulator中。Sender线程负责将RecordAccumulator中消息发送到kafka中.</p> 
<p><strong>9. Kafka的旧版Scala的消费者客户端的设计有什么缺陷？</strong></p> 
<p><strong>10. “消费组中的消费者个数如果超过topic的分区，那么就会有消费者消费不到数据”这句话是否正确？如果不正确，那么有没有什么hack的手段？</strong></p> 
<p>不正确，通过自定义分区分配策略，可以将一个consumer指定消费所有partition。</p> 
<p><strong>11. 消费者提交消费位移时提交的是当前消费到的最新消息的offset还是offset+1?</strong></p> 
<p>offset+1</p> 
<p><strong>12. 有哪些情形会造成重复消费？</strong></p> 
<p>消费者消费后没有commit offset(程序崩溃/强行kill/消费耗时/自动提交偏移情况下unscrible)</p> 
<p><strong>13. 那些情景下会造成消息漏消费？</strong></p> 
<p>消费者没有处理完消息 提交offset(自动提交偏移 未处理情况下程序异常结束)</p> 
<p><strong>14. KafkaConsumer是非线程安全的，那么怎么样实现多线程消费？</strong></p> 
<p>1.在每个线程中新建一个KafkaConsumer</p> 
<p>2.单线程创建KafkaConsumer，多个处理线程处理消息（难点在于是否要考虑消息顺序性，offset的提交方式）</p> 
<p><strong>15. 简述消费者与消费组之间的关系</strong></p> 
<p>消费者从属与消费组，消费偏移以消费组为单位。每个消费组可以独立消费主题的所有数据，同一消费组内消费者共同消费主题数据，每个分区只能被同一消费组内一个消费者消费。</p> 
<p><strong>16. 当你使用kafka-topics.sh创建（删除）了一个topic之后，Kafka背后会执行什么逻辑？</strong></p> 
<p>创建:在zk上/brokers/topics/下节点 kafkabroker会监听节点变化创建主题</p> 
<p>删除:调用脚本删除topic会在zk上将topic设置待删除标志，kafka后台有定时的线程会扫描所有需要删除的topic进行删除</p> 
<p><strong>17. topic的分区数可不可以增加？如果可以怎么增加？如果不可以，那又是为什么？</strong></p> 
<p>可以</p> 
<p><strong>18. topic的分区数可不可以减少？如果可以怎么减少？如果不可以，那又是为什么？</strong></p> 
<p>不可以</p> 
<p><strong>19. 创建topic时如何选择合适的分区数？</strong></p> 
<p>根据集群的机器数量和需要的吞吐量来决定适合的分区数</p> 
<p><strong>20. Kafka目前有那些内部topic，它们都有什么特征？各自的作用又是什么？</strong></p> 
<p>__consumer_offsets 以下划线开头，保存消费组的偏移</p> 
<p><strong>21. 优先副本是什么？它有什么特殊的作用？</strong></p> 
<p>优先副本 会是默认的leader副本 发生leader变化时重选举会优先选择优先副本作为leader</p> 
<p><strong>22. Kafka有哪几处地方有分区分配的概念？简述大致的过程及原理</strong></p> 
<p>创建主题时</p> 
<p>如果不手动指定分配方式 有两种分配方式</p> 
<p>消费组内分配</p> 
<p><strong>23. 简述Kafka的日志目录结构</strong></p> 
<p>每个partition一个文件夹，包含四类文件.index .log .timeindex leader-epoch-checkpoint</p> 
<p>.index .log .timeindex 三个文件成对出现 前缀为上一个segment的最后一个消息的偏移 log文件中保存了所有的消息 index文件中保存了稀疏的相对偏移的索引 timeindex保存的则是时间索引</p> 
<p>leader-epoch-checkpoint中保存了每一任leader开始写入消息时的offset 会定时更新</p> 
<p>follower被选为leader时会根据这个确定哪些消息可用</p> 
<p><strong>24. Kafka中有那些索引文件？</strong></p> 
<p><strong>先自我介绍一下，小编13年上海交大毕业，曾经在小公司待过，也去过华为、OPPO等大厂，18年进入阿里一直到现在。</strong></p> 
<p><strong>深知大多数初中级Java工程师，想要提升技能，往往是自己摸索成长或者是报班学习，但对于培训机构动则近万的学费，着实压力不小。自己不成体系的自学效果低效又漫长，而且极易碰到天花板技术停滞不前！</strong></p> 
<p><strong>因此收集整理了一份《Java开发全套学习资料》送给大家，初衷也很简单，就是希望能够帮助到想自学提升又不知道该从何学起的朋友，同时减轻大家的负担。</strong></p> 
<p><img src="https://images2.imgbox.com/d4/3d/E0PbPc1Q_o.jpg" alt="img"></p> 
<p><img src="https://images2.imgbox.com/b3/fc/IPMomauW_o.png" alt="img"></p> 
<p><img src="https://images2.imgbox.com/59/1b/HL9vWzNR_o.png" alt="img"></p> 
<p><strong>由于文件比较大，这里只是将部分目录截图出来，每个节点里面都包含大厂面经、学习笔记、源码讲义、实战项目、讲解视频</strong></p> 
<p><strong>如果你觉得这些内容对你有帮助，可以扫码领取！</strong></p> 
<img src="https://images2.imgbox.com/52/fa/BGS2eErM_o.jpg" alt="img"> 
<h2><a id="_164"></a><strong>读者福利</strong></h2> 
<p><img src="https://images2.imgbox.com/76/7f/awRrgwao_o.png" alt="秋招我借这份PDF的复习思路，收获美团，小米，京东等Java岗offer"></p> 
<p><strong>更多笔记分享</strong></p> 
<p><img src="https://images2.imgbox.com/ee/e3/iSDHmmec_o.png" alt="秋招我借这份PDF的复习思路，收获美团，小米，京东等Java岗offer"></p> 
<p>72faed303032d36.jpg" alt=“img” style=“zoom: 33%;” /&gt;</p> 
<h2><a id="_175"></a><strong>读者福利</strong></h2> 
<p>[外链图片转存中…(img-3xxDOOI6-1711357071886)]</p> 
<p><strong>更多笔记分享</strong></p> 
<p>[外链图片转存中…(img-Ltd9OaCi-1711357071886)]</p> 
<p><strong>需要更多Java资料的小伙伴可以帮忙点赞+关注，<a href="https://bbs.csdn.net/topics/618164986">点击传送门</a>，即可免费领取！</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a01f1e947214d9737ec6f047a8eb3198/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【AI】大模型API调研及推荐</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c5dbed389e82de10d92b8819dc2d9b79/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">AIGC丨流式输出技术SSE：前后端实践</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>