<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>日志平台--graylog-web配置、接入微服务日志 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/fb8aaa2cc5e28c6511a6bdf67f989401/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="日志平台--graylog-web配置、接入微服务日志">
  <meta property="og:description" content="系列文章目录 第一章 搭建es集群
第二章 mongodb搭建
第三章 graylog搭建与反向代理
文章目录 系列文章目录前言一、graylog-web界面操作二、分流操作三、分流示例四、graylog查看某个服务的日志五、graylog创建不同用户的流程及权限分类总结 前言 通过第三章内容，已成功搭建完成graylog,并且使用nginx实现了反向代理。因此在本章中，主要是针对graylog-web界面的熟悉、配置、微服务日志接入为目标，展开详细说明。
一、graylog-web界面操作 1、配置graylog 首先在Web管理界面进入System/Inputs，进行如下操作：选择Beats类型,点击 Launch new input。如下图所示 接着填入参数，端口根据需要进行修改，然后保存即可： 2、页面配置:创建sidecar采集器 Web界面进入System/Sidecars Collector根据需要这里选择了：filebeat on Linux paths处填写你Nginx服务器上日志所在位置 hosts处填写Graylog服务器的IP&#43;端口（上面System/Inputs时候填入的端口）： 3、详细的configuration配置说明 #该文件适用于日志目录统一的情况 fields_under_root: true #自定义字段将直接位于输出文档的最外层，而不是嵌套在 fields 子字典中。 fields.collector_node_id: ${sidecar.nodeName} #当 Graylog 集群中有多个 Collector 节点时，这个字段可以用来追踪每个日志事件的来源。 fields.gl2_source_collector: ${sidecar.nodeId} #指定消息的来源采集器，其值为 Sidecar 节点 ID fields.localIp: ${sidecar.nodeName} #指定消息的本地 IP 地址，其值为 Sidecar节点名称 fields.inputType: agent #指定消息的输入类型，其值为“agent”，表示该消息是来自 Agent 的日志数据。 filebeat.registry.flush: 60s #指定 Filebeat 注册表的刷新时间 filebeat.shutdown_timeout: 10s #指定 Filebeat 的关闭超时时间 max_procs: 2 #指定 Filebeat 的最大进程数，默认值为逻辑 CPU 数量的两倍 该参数用于限制 Filebeat 运行时的并发度，防止系统资源被占用过多 filebeat.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-11-11T22:36:19+08:00">
    <meta property="article:modified_time" content="2023-11-11T22:36:19+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">日志平台--graylog-web配置、接入微服务日志</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>系列文章目录</h2> 
<p>第一章 <a href="https://editor.csdn.net/md/?articleId=134210770" rel="nofollow">搭建es集群</a><br> 第二章 <a href="https://blog.csdn.net/weixin_50902636/article/details/134291151">mongodb搭建</a><br> 第三章 <a href="https://blog.csdn.net/weixin_50902636/article/details/134350600">graylog搭建与反向代理</a></p> 
<hr> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_0" rel="nofollow">系列文章目录</a></li><li><a href="#_11" rel="nofollow">前言</a></li><li><a href="#graylogweb_17" rel="nofollow">一、graylog-web界面操作</a></li><li><a href="#_199" rel="nofollow">二、分流操作</a></li><li><a href="#_235" rel="nofollow">三、分流示例</a></li><li><a href="#graylog_263" rel="nofollow">四、graylog查看某个服务的日志</a></li><li><a href="#graylog_266" rel="nofollow">五、graylog创建不同用户的流程及权限分类</a></li><li><a href="#_284" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_11"></a>前言</h2> 
<p>通过第三章内容，已成功搭建完成graylog,并且使用nginx实现了反向代理。因此在本章中，主要是针对graylog-web界面的熟悉、配置、微服务日志接入为目标，展开详细说明。</p> 
<hr> 
<h2><a id="graylogweb_17"></a>一、graylog-web界面操作</h2> 
<pre><code class="prism language-shell"><span class="token number">1</span>、配置graylog
	首先在Web管理界面进入System/Inputs，进行如下操作：选择Beats类型,点击 Launch new input。如下图所示
	接着填入参数，端口根据需要进行修改，然后保存即可：
</code></pre> 
<p><img src="https://images2.imgbox.com/87/c9/vWGRnSEW_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/01/d4/gyIAVjWM_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-shell"><span class="token number">2</span>、页面配置:创建sidecar采集器
	Web界面进入System/Sidecars

	Collector根据需要这里选择了：filebeat on Linux
	paths处填写你Nginx服务器上日志所在位置
	hosts处填写Graylog服务器的IP+端口（上面System/Inputs时候填入的端口）：
</code></pre> 
<p><img src="https://images2.imgbox.com/d5/ed/xxD9YS0V_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/eb/3f/jMYrcq6i_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-shell">	<span class="token number">3</span>、详细的configuration配置说明
</code></pre> 
<pre><code class="prism language-shell"><span class="token comment">#该文件适用于日志目录统一的情况</span>
	fields_under_root: <span class="token boolean">true</span>  <span class="token comment">#自定义字段将直接位于输出文档的最外层，而不是嵌套在 fields 子字典中。</span>
	fields.collector_node_id: <span class="token variable">${sidecar.nodeName}</span> <span class="token comment">#当 Graylog 集群中有多个 Collector 节点时，这个字段可以用来追踪每个日志事件的来源。</span>
	fields.gl2_source_collector: <span class="token variable">${sidecar.nodeId}</span> <span class="token comment">#指定消息的来源采集器，其值为 Sidecar 节点 ID</span>
	fields.localIp: <span class="token variable">${sidecar.nodeName}</span> <span class="token comment">#指定消息的本地 IP 地址，其值为 Sidecar节点名称</span>
	fields.inputType: agent <span class="token comment">#指定消息的输入类型，其值为“agent”，表示该消息是来自 Agent 的日志数据。</span>
	filebeat.registry.flush: 60s <span class="token comment">#指定 Filebeat 注册表的刷新时间</span>
	filebeat.shutdown_timeout: 10s <span class="token comment">#指定 Filebeat 的关闭超时时间</span>
	max_procs: <span class="token number">2</span>  <span class="token comment">#指定 Filebeat 的最大进程数，默认值为逻辑 CPU 数量的两倍  该参数用于限制 Filebeat 运行时的并发度，防止系统资源被占用过多</span>
	filebeat.inputs:
	- type: log
	  enabled: <span class="token boolean">true</span>
	  ignore_older: 48h
	  tail_files: <span class="token boolean">false</span>
	  paths:
	    - /export/Logs/*/app_error.log
	    - /export/Logs/*/app_info.log
	    - /export/Logs/*/system_info.log
	    - /export/Logs/*/system_error.log
	    - /export/Logs/*/all.log
	    - /export/Logs/*/error.log
	    - /export/Logs/*/coredns-66bff467f8-k8n9b.log
	    - /export/Logs/*/coredns-66bff467f8-r5598.log
	    - /export/Logs/*/coredns-66bff467f8-sxsnh.log
	  fields: <span class="token comment">#此处的配置适用于日志城市平台</span>
	    systemCode: Etown <span class="token comment">#系统code</span>
	    appId: coupons  <span class="token comment">#应用code</span>
	  multiline.pattern: <span class="token string">'^[[:space:]]+(at|\.{3})[[:space:]]+\b|^Caused by:|^org|^com|^java.|^\,|^###|^;|^For|^feign|^from|^to|^class|^Desired|^par|^concurrent|^eden|^Metaspace'</span>
	  multiline.negate: <span class="token boolean">false</span> <span class="token comment">#设置为false表示不否定多行模式</span>
	  multiline.match: after  <span class="token comment">#设置为after表示在多行模式下，从当前行的末尾开始匹配</span>
	  multiline.max_lines: <span class="token number">200</span> <span class="token comment">#设置允许的最大行数，超过此限制的多行日志将被截断</span>
	output.logstash:
	   hosts: <span class="token punctuation">[</span><span class="token string">"ip:5044"</span>,<span class="token string">"ip:5044"</span><span class="token punctuation">]</span> <span class="token comment">#此处为graylog地址</span>
	path:
	  data: /var/lib/graylog-sidecar/collectors/filebeat/data
	  logs: /var/lib/graylog-sidecar/collectors/filebeat/log
</code></pre> 
<pre><code class="prism language-yml">	<span class="token comment">#如遇到相同节点日志目录不统一的情况下则需要根据一下配置进行调整</span>
	<span class="token key atrule">fields_under_root</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
	<span class="token key atrule">fields.collector_node_id</span><span class="token punctuation">:</span> $<span class="token punctuation">{<!-- --></span>sidecar.nodeName<span class="token punctuation">}</span>
	<span class="token key atrule">fields.gl2_source_collector</span><span class="token punctuation">:</span> $<span class="token punctuation">{<!-- --></span>sidecar.nodeId<span class="token punctuation">}</span>
	<span class="token key atrule">fields.localIp</span><span class="token punctuation">:</span> $<span class="token punctuation">{<!-- --></span>sidecar.nodeName<span class="token punctuation">}</span>
	<span class="token key atrule">fields.inputType</span><span class="token punctuation">:</span> agent
	<span class="token key atrule">filebeat.registry.flush</span><span class="token punctuation">:</span> 60s
	<span class="token key atrule">filebeat.shutdown_timeout</span><span class="token punctuation">:</span> 10s
	<span class="token key atrule">max_procs</span><span class="token punctuation">:</span> <span class="token number">2</span>
	<span class="token key atrule">filebeat.inputs</span><span class="token punctuation">:</span>
	<span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> log
	  <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
	  <span class="token key atrule">ignore_older</span><span class="token punctuation">:</span> 48h
	  <span class="token key atrule">tail_files</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
	  <span class="token key atrule">paths</span><span class="token punctuation">:</span>
	    <span class="token punctuation">-</span> /export/Logs/xxx/<span class="token important">*/app_error.log</span>
	  <span class="token key atrule">fields</span><span class="token punctuation">:</span>
	    <span class="token key atrule">systemCode</span><span class="token punctuation">:</span> pro
	    <span class="token key atrule">appId</span><span class="token punctuation">:</span> app_pro
	    <span class="token key atrule">serviceId</span><span class="token punctuation">:</span> test1
	  <span class="token key atrule">multiline.pattern</span><span class="token punctuation">:</span> <span class="token string">'^[[:space:]]+(at|\.{3})[[:space:]]+\b|^Caused by:|^org|^com|^java.|^\,|^###|^;|^For|^feign|^from|^to|^class|^Desired|^par|^concurrent|^eden|^Metaspace'</span>
	  <span class="token key atrule">multiline.negate</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
	  <span class="token key atrule">multiline.match</span><span class="token punctuation">:</span> after
	  <span class="token key atrule">multiline.max_lines</span><span class="token punctuation">:</span> <span class="token number">200</span>
	<span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> log
	  <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
	  <span class="token key atrule">ignore_older</span><span class="token punctuation">:</span> 48h
	  <span class="token key atrule">tail_files</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
	  <span class="token key atrule">paths</span><span class="token punctuation">:</span>
	    <span class="token punctuation">-</span> /export/icity/<span class="token important">*/all.log</span>
	  <span class="token key atrule">fields</span><span class="token punctuation">:</span>
	    <span class="token key atrule">systemCode</span><span class="token punctuation">:</span> pro
	    <span class="token key atrule">appId</span><span class="token punctuation">:</span> app_pro
	    <span class="token key atrule">serviceId</span><span class="token punctuation">:</span> test1
	  <span class="token key atrule">multiline.pattern</span><span class="token punctuation">:</span> <span class="token string">'^[[:space:]]+(at|\.{3})[[:space:]]+\b|^Caused by:|^org|^com|^java.|^\,|^###|^;|^For|^feign|^from|^to|^class|^Desired|^par|^concurrent|^eden|^Metaspace'</span>
	  <span class="token key atrule">multiline.negate</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
	  <span class="token key atrule">multiline.match</span><span class="token punctuation">:</span> after
	  <span class="token key atrule">multiline.max_lines</span><span class="token punctuation">:</span> <span class="token number">200</span>
	<span class="token key atrule">output.logstash</span><span class="token punctuation">:</span>
	   <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"ip:5044"</span><span class="token punctuation">,</span><span class="token string">"ip:5044"</span><span class="token punctuation">]</span>
	<span class="token key atrule">path</span><span class="token punctuation">:</span>
	  <span class="token key atrule">data</span><span class="token punctuation">:</span> /var/lib/graylog<span class="token punctuation">-</span>sidecar/collectors/filebeat/data
	  <span class="token key atrule">logs</span><span class="token punctuation">:</span> /var/lib/graylog<span class="token punctuation">-</span>sidecar/collectors/filebeat/log
</code></pre> 
<pre><code class="prism language-yml">	4、管理sidecar并配置日志采集项，与sidecar绑定
	完成后，等待几秒日志便会采集上来，在界面中可以看到相关日志
</code></pre> 
<p><img src="https://images2.imgbox.com/99/39/HnceRRMd_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/4f/a7/D7stKutX_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-shell">	<span class="token number">5</span>、提取日志级别和时间戳配置
	点击其中一条日志，然后右键会出来如箭头所示的文件
</code></pre> 
<p><img src="https://images2.imgbox.com/41/cb/fWb29K0q_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/19/2d/A7WXYgF0_o.png" alt="提取日志级别"><br> <img src="https://images2.imgbox.com/a9/71/kSKXB8Li_o.png" alt="提取时间(%{TIMESTAMP_ISO8601:logTime} )该方式只能提取时间格式为yyyy-MM-dd HH:mm:ss.SSS日志如有其他格式请使用pipeline提取"></p> 
<pre><code class="prism language-shell">	<span class="token number">6</span>、配置日志清洗转换脚本
</code></pre> 
<p><img src="https://images2.imgbox.com/88/88/9EKPD7Gz_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/dd/6b/coMckuOb_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-yml">1、上述图片中添加了三个日志处理规则
第一个 serverId
rule "serverId"
when
  has_field("log_file_path")
then
  let pathArray = split("/"<span class="token punctuation">,</span>to_string($message.log_file_path));
  set_field("serviceId"<span class="token punctuation">,</span>to_string(pathArray<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>)); 如果是/export/Logs/xx.log 就为3;如果是/export/Logs/xx/xxx.log 就为4
end

第二个 Remove filebeat fields prefix(删除filebeat字段前缀)
rule "Remove filebeat fields prefix"
when
  has_field("fields_appId")
then
  rename_field("fields_systemCode"<span class="token punctuation">,</span> "systemCode");
  rename_field("fields_appId"<span class="token punctuation">,</span> "appId");
  rename_field("fields_serviceId"<span class="token punctuation">,</span> "serviceId");
end

第三个 replace timestamp with log even time(将时间戳替换为日志偶数时间)
rule "replace timestamp with log even time"
when
    has_field("logTime")
then
let new_date = parse_date(
        <span class="token key atrule">value</span><span class="token punctuation">:</span> to_string($message.logTime)<span class="token punctuation">,</span>
        <span class="token key atrule">pattern</span><span class="token punctuation">:</span> <span class="token string">"yyyy-MM-dd HH:mm:ss.SSS"</span><span class="token punctuation">,</span>
        <span class="token key atrule">timezone</span><span class="token punctuation">:</span> "Asia/Shanghai");
    set_field("timestamp"<span class="token punctuation">,</span> new_date);
end
可选的转换脚本如果日志格式是非yyyy<span class="token punctuation">-</span>MM<span class="token punctuation">-</span>dd HH<span class="token punctuation">:</span>mm<span class="token punctuation">:</span>ss.SSS格式则需要使用字符串截取等方式提取时间
rule "replace timestamp with log even time"
when
    has_field("timestamp")
then
let eventTime = substring(to_string($message.message)<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> 21);
let new_date = parse_date(
        <span class="token key atrule">value</span><span class="token punctuation">:</span> eventTime<span class="token punctuation">,</span>
        <span class="token key atrule">pattern</span><span class="token punctuation">:</span> <span class="token string">"yy-MM-dd.HH:mm:ss.SSS"</span><span class="token punctuation">,</span>
        <span class="token key atrule">timezone</span><span class="token punctuation">:</span> "Asia/Shanghai");
    set_field("timestamp"<span class="token punctuation">,</span> new_date);
end
</code></pre> 
<pre><code class="prism language-shell">	<span class="token number">7</span>、pipelines规则添加
</code></pre> 
<p><img src="https://images2.imgbox.com/84/4f/pBrNUopE_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/3f/ab/3u8qmRtC_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-shell">	<span class="token number">8</span>、至此,所有关键字均已提取完成
</code></pre> 
<p><img src="https://images2.imgbox.com/14/8f/qQEiMmSp_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_199"></a>二、分流操作</h2> 
<pre><code class="prism language-shell">	分流的意思是创建一定的流规则，然后可以根据此规则，将日志分流，例如hbase的日志放到hbase的流中，然后放到hbase的索引中存储起来.
	因为在实际生产环境中,日志来源并不是单一的,除了应用服务日志外,还有nginx日志、系统日志等.这种时候就会产生重要性的问题,比如,生产环境的nginx访问日志要保存1年。而测试环境的应用服务日志,只需要保存7天就可以了这种不同情况的需求,为了能更好的区分不同类型的日志,我们就可以创建不同的索引,来储存不同类型的日志.比如创建test环境,prod环境的索引来区分环境，创建nginx，web-app等来区分nginx和应用web服务等.
</code></pre> 
<pre><code class="prism language-shell">	<span class="token number">1</span>、创建indices 如下图所示
	elasticsearch是以索引来存储数据的，启动graylog后，会自动生产一个默认的索引,索引地段值就为graylog，如下图。我们还可以在其中配置数据存储限制，可以通过时间，大小，数量来进行存储限制。
	
	<span class="token number">2</span>、分流的相关配置参数
	Title  标题
	Descriptions  描述
	index prefix  索引前缀
	analyzer  分词方法 standard
	index shards  分片数量
	index  replicas  副本数
	Max.number of segments 最大分段数
	Field <span class="token builtin class-name">type</span> refresh interval 字段刷新时间
	<span class="token keyword">select</span> rotation strategy 保存策略  
		时间<span class="token punctuation">(</span>Index <span class="token function">time</span><span class="token punctuation">)</span>、字节大小<span class="token punctuation">(</span>Index size<span class="token punctuation">)</span>、信息统计数量<span class="token punctuation">(</span>Index Msg Count<span class="token punctuation">)</span>
	Rotation period 
		如果保存策略是以时间为单位  这里可以写P1~nD<span class="token punctuation">(</span>天数<span class="token punctuation">)</span>、P1M<span class="token punctuation">(</span>一个月<span class="token punctuation">)</span>、PT6H<span class="token punctuation">(</span><span class="token number">6</span>小时<span class="token punctuation">)</span> 根据实际情况修改
		如果保存策略是以大小为单位   <span class="token number">1073741824</span><span class="token punctuation">(</span>1GB<span class="token punctuation">)</span>、MB 根据实际情况修改
		如果保存策略是以数量为单位    默认是20000000个
	Select retention strategy 选择保留策略
		删除分片<span class="token punctuation">(</span>Delete Index<span class="token punctuation">)</span> 关闭分片<span class="token punctuation">(</span>close index<span class="token punctuation">)</span> 什么也不做<span class="token punctuation">(</span>do nothing<span class="token punctuation">)</span>
	Max number of indices
		如果保留策略是删除分片 ，则设定最大的索引数量，当超过设定的最大索引数量时，会删除旧的索引
</code></pre> 
<p><img src="https://images2.imgbox.com/8b/b5/o8PcTjP3_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/31/13/Mm46tyKN_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/8d/f7/rL0NDaby_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-shell">	<span class="token number">3</span>、点击streams 完成创建流
</code></pre> 
<p><img src="https://images2.imgbox.com/21/40/JObdolIA_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_235"></a>三、分流示例</h2> 
<pre><code class="prism language-shell">	<span class="token number">1</span>、查看一条具体的日志内容,如下图所示
</code></pre> 
<p><img src="https://images2.imgbox.com/72/2a/WhZUseMH_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-shell">	<span class="token number">2</span>、创建流规则
	流规则中Type的类型有以下几种:
	match exactly <span class="token punctuation">(</span>精确匹配<span class="token punctuation">)</span> 设定的Field字段在日志中必须符合设定的value值
	match regular expression<span class="token punctuation">(</span>匹配正则表达式<span class="token punctuation">)</span>
	contain <span class="token punctuation">(</span>包含<span class="token punctuation">)</span>
	greater than<span class="token punctuation">(</span>大于<span class="token punctuation">)</span>
	smaller than<span class="token punctuation">(</span>小于<span class="token punctuation">)</span>
	field presence<span class="token punctuation">(</span>字段存在<span class="token punctuation">)</span> 主要就是告诉graylog只要字段设定的字段是存在的，就放入设定字段的这个stream中，方便我们日后查阅。
	always match <span class="token punctuation">(</span>始终匹配<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e5/b5/e2ITsv5Y_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-shell">	下面配置的那个key就是上图中的，必须符合value才可以进入到这个流中，进而存到流对应的索引中
</code></pre> 
<p><img src="https://images2.imgbox.com/7b/6a/IxjAYb4R_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/dc/85/Y1tj8qt3_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/86/0d/2kWKMrYj_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-shell">	完成规则创建后，点击start即可开启流
</code></pre> 
<p><img src="https://images2.imgbox.com/d4/08/7CyQMT9z_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="graylog_263"></a>四、graylog查看某个服务的日志</h2> 
<p>根据创建的serviceId即可查询到<br> <img src="https://images2.imgbox.com/4c/db/IOBU898m_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="graylog_266"></a>五、graylog创建不同用户的流程及权限分类</h2> 
<pre><code class="prism language-yml">	1、使用管理员帐户登录到Graylog的Web界面。
	2、单击顶部菜单栏中的 “System” 选项卡，然后单击左侧侧边栏中的 “Authentication”。
	3、在 “Authentication” 屏幕上，单击 “Users” 选项卡。
	4、然后单击右上角的 “Create User” 按钮。
	5、在弹出的 “Create User” 窗口中，输入要创建的用户名、电子邮件地址和密码。你还可以选择为此用户分配角色，从而控制他们在Graylog中的访问权限。例如，如果你想让他们只能查看特定的流（stream），则可以为其分配 “Reader” 角色，并授予该流的只读权限。
	6、单击 “Save” 按钮保存新用户。
</code></pre> 
<pre><code class="prism language-yml">	Admin 所有Manager权限，以及可以管理全局用户、角色和仪表板的权限。
	Reader 只能查看和搜索自己有访问权限的数据。不能修改任何配置和内容。
	Sidecar System (Internal) 内部技术角色。授予对Sidecar节点的注册和拉取配置的访问权限（内置）
	Alerts Manager 允许读取和写入所有事件定义和事件通知
	Views Manager 允许读取和写入所有视图和扩展搜索
</code></pre> 
<hr> 
<h2><a id="_284"></a>总结</h2> 
<p>以上就是今天要讲的内容，本文对graylog的界面操作做出了大量的讲解，并配合着graylog中的日志转换规则、清洗脚本等，对原本复杂的日志进行简单化处理，拿到自己想看到的日志字段。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1a5be6ade746b793b5d76aaac86bca1f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【How to learn AI】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3a636304ef00967749a6ea398c651de6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">毕业设计：基于java的宠物领养系统设计与实现</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>