<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>利用 Python 和 IPIDEA：跨境电商与数据采集的完美解决方案 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/e2a30b44d7bb0758cfdc2fa43578e123/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="利用 Python 和 IPIDEA：跨境电商与数据采集的完美解决方案">
  <meta property="og:description" content="目录 实操案例：利用 IPIDEA 进行数据采集步骤一：注册和获取代理IP步骤二：编写数据采集添加错误处理数据存储到 CSV 文件多线程采集数据 步骤三：处理和分析数据 总结 实操案例：利用 IPIDEA 进行数据采集 我们今天用一个具体的案例来展示IPIDEA的功能。该案例可以帮助电商企业在市场竞争中更好地了解竞争对手的产品和定价策略，优化自己的产品选择和定价，最终维持和提升市场竞争力。
步骤一：注册和获取代理IP 首先，我们需要在 IPIDEA官网 注册一个账号，并购买适合我们的代理服务套餐。注册和购买步骤通常包括：
1.IPIDEA 官网：进入官网，点击注册按钮，填写必要的信息创建账号。（ps:他们官网有免费试用哦，想要了解的伙伴可以试用看看）
2.选择合适的代理服务套餐：根据需求选择套餐，通常包括不同数量的代理IP和使用时长。
然后我们需要生成链接，将API加入我们的Python代码中，获取到全球各地的代理IP。以下是具体步骤的截图示例：
步骤二：编写数据采集 接下来，我们将编写一个 Python ，通过 IPIDEA 提供的代理IP来采集亚马逊网站中笔记本电脑商品的数据：https://www.amazon.com/s?k=laptop 。以下是一段详细的示例代码：
import requests from bs4 import BeautifulSoup import csv import time from random import randint # 获取代理IP列表 def get_proxies(): proxies = [] for _ in range(5): # 获取5个代理IP response = requests.get(&#39;http://api.proxy.ipidea.io/getBalanceProxyIp?num=1&amp;return_type=txt&amp;lb=1&amp;sb=0&amp;flow=1&amp;regions=&amp;protocol=http&#39;) proxies.append(response.text.strip()) return proxies # 轮换代理IP def rotate_proxy(proxies): return {&#39;http&#39;: proxies[randint(0, len(proxies)-1)]} # 数据采集函数 def fetch_data(url, proxies): headers = { &#39;User-Agent&#39;: &#39;Mozilla/5.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-03T11:06:27+08:00">
    <meta property="article:modified_time" content="2024-08-03T11:06:27+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">利用 Python 和 IPIDEA：跨境电商与数据采集的完美解决方案</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><ul><li><a href="#_IPIDEA__2" rel="nofollow">实操案例：利用 IPIDEA 进行数据采集</a></li><li><ul><li><a href="#IP_6" rel="nofollow">步骤一：注册和获取代理IP</a></li><li><a href="#_17" rel="nofollow">步骤二：编写数据采集</a></li><li><ul><li><a href="#_93" rel="nofollow">添加错误处理</a></li><li><a href="#_CSV__179" rel="nofollow">数据存储到 CSV 文件</a></li><li><a href="#_197" rel="nofollow">多线程采集数据</a></li></ul> 
    </li><li><a href="#_296" rel="nofollow">步骤三：处理和分析数据</a></li></ul> 
   </li><li><a href="#_336" rel="nofollow">总结</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_IPIDEA__2"></a>实操案例：利用 IPIDEA 进行数据采集</h3> 
<p>我们今天用一个具体的案例来展示IPIDEA的功能。该案例可以帮助电商企业在市场竞争中更好地了解竞争对手的产品和定价策略，优化自己的产品选择和定价，最终维持和提升市场竞争力。</p> 
<h4><a id="IP_6"></a>步骤一：注册和获取代理IP</h4> 
<p>首先，我们需要在 IPIDEA官网 注册一个账号，并购买适合我们的代理服务套餐。注册和购买步骤通常包括：</p> 
<p><strong>1.IPIDEA 官网</strong>：进入官网，点击注册按钮，填写必要的信息创建账号。（ps:他们官网有免费试用哦，想要了解的伙伴可以试用看看）<br> <strong>2.选择合适的代理服务套餐</strong>：根据需求选择套餐，通常包括不同数量的代理IP和使用时长。</p> 
<p>然后我们需要生成链接，将API加入我们的Python代码中，获取到全球各地的代理IP。以下是具体步骤的截图示例：</p> 
<p><img src="https://images2.imgbox.com/d2/9c/yrEUsvyI_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/80/2e/L7Zsv8JV_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_17"></a>步骤二：编写数据采集</h4> 
<p>接下来，我们将编写一个 Python ，通过 IPIDEA 提供的代理IP来采集亚马逊网站中笔记本电脑商品的数据：https://www.amazon.com/s?k=laptop 。以下是一段详细的示例代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup
<span class="token keyword">import</span> csv
<span class="token keyword">import</span> time
<span class="token keyword">from</span> random <span class="token keyword">import</span> randint

<span class="token comment"># 获取代理IP列表</span>
<span class="token keyword">def</span> <span class="token function">get_proxies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    proxies <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 获取5个代理IP</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'http://api.proxy.ipidea.io/getBalanceProxyIp?num=1&amp;return_type=txt&amp;lb=1&amp;sb=0&amp;flow=1&amp;regions=&amp;protocol=http'</span><span class="token punctuation">)</span>
        proxies<span class="token punctuation">.</span>append<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> proxies

<span class="token comment"># 轮换代理IP</span>
<span class="token keyword">def</span> <span class="token function">rotate_proxy</span><span class="token punctuation">(</span>proxies<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span><span class="token string">'http'</span><span class="token punctuation">:</span> proxies<span class="token punctuation">[</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>proxies<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">}</span>

<span class="token comment"># 数据采集函数</span>
<span class="token keyword">def</span> <span class="token function">fetch_data</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> proxies<span class="token punctuation">)</span><span class="token punctuation">:</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'</span><span class="token punctuation">,</span>
        <span class="token string">'Accept-Language'</span><span class="token punctuation">:</span> <span class="token string">'en-US,en;q=0.9'</span><span class="token punctuation">,</span>
        <span class="token string">'Accept-Encoding'</span><span class="token punctuation">:</span> <span class="token string">'gzip, deflate, br'</span><span class="token punctuation">,</span>
        <span class="token string">'Connection'</span><span class="token punctuation">:</span> <span class="token string">'keep-alive'</span><span class="token punctuation">,</span>
        <span class="token string">'DNT'</span><span class="token punctuation">:</span> <span class="token string">'1'</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> attempt <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 重试5次</span>
        proxy <span class="token operator">=</span> rotate_proxy<span class="token punctuation">(</span>proxies<span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> proxies<span class="token operator">=</span>proxy<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
            response<span class="token punctuation">.</span>raise_for_status<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 检查请求是否成功</span>
            <span class="token keyword">return</span> response<span class="token punctuation">.</span>text
        <span class="token keyword">except</span> requests<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>RequestException <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'请求失败（第</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>attempt<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">次尝试），错误: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>e<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 随机等待5到10秒后重试</span>

<span class="token comment"># 设置代理IP</span>
proxies <span class="token operator">=</span> get_proxies<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 目标URL</span>
url <span class="token operator">=</span> <span class="token string">'https://www.amazon.com/s?k=laptop'</span>

response_text <span class="token operator">=</span> fetch_data<span class="token punctuation">(</span>url<span class="token punctuation">,</span> proxies<span class="token punctuation">)</span>

<span class="token keyword">if</span> response_text<span class="token punctuation">:</span>
    soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>response_text<span class="token punctuation">,</span> <span class="token string">'html.parser'</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 提取商品信息</span>
    products <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token string">'data-component-type'</span><span class="token punctuation">:</span> <span class="token string">'s-search-result'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 打开 CSV 文件进行写入</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'products.csv'</span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'w'</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        writer <span class="token operator">=</span> csv<span class="token punctuation">.</span>writer<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>
        writer<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'商品名称'</span><span class="token punctuation">,</span> <span class="token string">'价格'</span><span class="token punctuation">,</span> <span class="token string">'评分'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> product <span class="token keyword">in</span> products<span class="token punctuation">:</span>
            name <span class="token operator">=</span> product<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">'a-size-medium a-color-base a-text-normal'</span><span class="token punctuation">)</span>
            price <span class="token operator">=</span> product<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">'a-price-whole'</span><span class="token punctuation">)</span>
            rating <span class="token operator">=</span> product<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">'a-icon-alt'</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> name <span class="token keyword">and</span> price <span class="token keyword">and</span> rating<span class="token punctuation">:</span>
                writer<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span><span class="token punctuation">[</span>name<span class="token punctuation">.</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> price<span class="token punctuation">.</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rating<span class="token punctuation">.</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'数据采集失败'</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ad/79/Pak2JT4Y_o.png" alt="在这里插入图片描述"><br> 在这个示例中，我们使用了 requests 库来发送 HTTP 请求，并使用 BeautifulSoup 库来解析 HTML 内容。通过设置代理IP，我们可以从目标网站获取商品信息，而不会受到地域不同和IP不稳定的影响。</p> 
<p>为了使代码更加完善，我们可以添加一些额外的功能，比如错误处理、数据存储和多线程等。</p> 
<h5><a id="_93"></a>添加错误处理</h5> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup
<span class="token keyword">import</span> csv
<span class="token keyword">import</span> time
<span class="token keyword">from</span> random <span class="token keyword">import</span> randint
<span class="token keyword">from</span> concurrent<span class="token punctuation">.</span>futures <span class="token keyword">import</span> ThreadPoolExecutor

<span class="token comment"># 获取代理IP列表</span>
<span class="token keyword">def</span> <span class="token function">get_proxies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    proxies <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 获取5个代理IP</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'http://api.proxy.ipidea.io/getBalanceProxyIp?num=1&amp;return_type=txt&amp;lb=1&amp;sb=0&amp;flow=1&amp;regions=&amp;protocol=http'</span><span class="token punctuation">)</span>
        proxies<span class="token punctuation">.</span>append<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> proxies

<span class="token comment"># 轮换代理IP</span>
<span class="token keyword">def</span> <span class="token function">rotate_proxy</span><span class="token punctuation">(</span>proxies<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span><span class="token string">'http'</span><span class="token punctuation">:</span> proxies<span class="token punctuation">[</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>proxies<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">}</span>

<span class="token comment"># 数据采集函数</span>
<span class="token keyword">def</span> <span class="token function">fetch_data</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> proxies<span class="token punctuation">)</span><span class="token punctuation">:</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'</span><span class="token punctuation">,</span>
        <span class="token string">'Accept-Language'</span><span class="token punctuation">:</span> <span class="token string">'en-US,en;q=0.9'</span><span class="token punctuation">,</span>
        <span class="token string">'Accept-Encoding'</span><span class="token punctuation">:</span> <span class="token string">'gzip, deflate, br'</span><span class="token punctuation">,</span>
        <span class="token string">'Connection'</span><span class="token punctuation">:</span> <span class="token string">'keep-alive'</span><span class="token punctuation">,</span>
        <span class="token string">'DNT'</span><span class="token punctuation">:</span> <span class="token string">'1'</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> attempt <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 重试5次</span>
        proxy <span class="token operator">=</span> rotate_proxy<span class="token punctuation">(</span>proxies<span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> proxies<span class="token operator">=</span>proxy<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
            response<span class="token punctuation">.</span>raise_for_status<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 检查请求是否成功</span>
            <span class="token keyword">return</span> response<span class="token punctuation">.</span>text
        <span class="token keyword">except</span> requests<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>RequestException <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'请求失败（第</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>attempt<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">次尝试），错误: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>e<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 随机等待5到10秒后重试</span>

<span class="token keyword">def</span> <span class="token function">scrape_page</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> proxies<span class="token punctuation">)</span><span class="token punctuation">:</span>
    response_text <span class="token operator">=</span> fetch_data<span class="token punctuation">(</span>url<span class="token punctuation">,</span> proxies<span class="token punctuation">)</span>
    <span class="token keyword">if</span> response_text<span class="token punctuation">:</span>
        soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>response_text<span class="token punctuation">,</span> <span class="token string">'html.parser'</span><span class="token punctuation">)</span>
        products <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token string">'data-component-type'</span><span class="token punctuation">:</span> <span class="token string">'s-search-result'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> product <span class="token keyword">in</span> products<span class="token punctuation">:</span>
            name <span class="token operator">=</span> product<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">'a-size-medium a-color-base a-text-normal'</span><span class="token punctuation">)</span>
            price <span class="token operator">=</span> product<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">'a-price-whole'</span><span class="token punctuation">)</span>
            rating <span class="token operator">=</span> product<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">'a-icon-alt'</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> name <span class="token keyword">and</span> price <span class="token keyword">and</span> rating<span class="token punctuation">:</span>
                data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>name<span class="token punctuation">.</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> price<span class="token punctuation">.</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
rating<span class="token punctuation">.</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> data
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'数据采集失败'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">save_to_csv</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'products.csv'</span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'w'</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        writer <span class="token operator">=</span> csv<span class="token punctuation">.</span>writer<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>
        writer<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'商品名称'</span><span class="token punctuation">,</span> <span class="token string">'价格'</span><span class="token punctuation">,</span> <span class="token string">'评分'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        writer<span class="token punctuation">.</span>writerows<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    proxies <span class="token operator">=</span> get_proxies<span class="token punctuation">(</span><span class="token punctuation">)</span>
    urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f'https://www.amazon.com/s?k=laptop&amp;page=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>i<span class="token punctuation">}</span></span><span class="token string">'</span></span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">]</span>  <span class="token comment"># 假设需要爬取前5页</span>
    all_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token keyword">with</span> ThreadPoolExecutor<span class="token punctuation">(</span>max_workers<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">as</span> executor<span class="token punctuation">:</span>
        results <span class="token operator">=</span> executor<span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> url<span class="token punctuation">:</span> scrape_page<span class="token punctuation">(</span>url<span class="token punctuation">,</span> proxies<span class="token punctuation">)</span><span class="token punctuation">,</span> urls<span class="token punctuation">)</span>
        <span class="token keyword">for</span> result <span class="token keyword">in</span> results<span class="token punctuation">:</span>
            all_data<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>result<span class="token punctuation">)</span>

    <span class="token keyword">if</span> all_data<span class="token punctuation">:</span>
        save_to_csv<span class="token punctuation">(</span>all_data<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'没有数据被采集'</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>在 fetch_data 函数中添加了重试机制来进行错误处理</p> 
<h5><a id="_CSV__179"></a>数据存储到 CSV 文件</h5> 
<p>上面的代码已经包含将数据存储到 CSV 文件的功能。每次从页面提取到商品信息后，都会将其写入 <code>products.csv</code> 文件中，可以看到一共采集到了20条商品信息。</p> 
<pre><code class="prism language-python"><span class="token comment"># 打开 CSV 文件进行写入</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'products.csv'</span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'w'</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
    writer <span class="token operator">=</span> csv<span class="token punctuation">.</span>writer<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>
    writer<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'商品名称'</span><span class="token punctuation">,</span> <span class="token string">'价格'</span><span class="token punctuation">,</span> <span class="token string">'评分'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> product <span class="token keyword">in</span> products<span class="token punctuation">:</span>
        name <span class="token operator">=</span> product<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">'a-size-medium a-color-base a-text-normal'</span><span class="token punctuation">)</span>
        price <span class="token operator">=</span> product<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">'a-price-whole'</span><span class="token punctuation">)</span>
        rating <span class="token operator">=</span> product<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">'a-icon-alt'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> name <span class="token keyword">and</span> price <span class="token keyword">and</span> rating<span class="token punctuation">:</span>
            writer<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span><span class="token punctuation">[</span>name<span class="token punctuation">.</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> price<span class="token punctuation">.</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rating<span class="token punctuation">.</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f6/d8/SkprAw53_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_197"></a>多线程采集数据</h5> 
<p>为了提高采集效率，我们还可以使用多线程技术：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup
<span class="token keyword">from</span> concurrent<span class="token punctuation">.</span>futures <span class="token keyword">import</span> ThreadPoolExecutor
<span class="token keyword">import</span> csv
<span class="token keyword">import</span> time
<span class="token keyword">from</span> random <span class="token keyword">import</span> randint

<span class="token comment"># 获取代理IP列表</span>
<span class="token keyword">def</span> <span class="token function">get_proxies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    proxies <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 获取5个代理IP</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'http://api.proxy.ipidea.io/getBalanceProxyIp?num=1&amp;return_type=txt&amp;lb=1&amp;sb=0&amp;flow=1&amp;regions=&amp;protocol=http'</span><span class="token punctuation">)</span>
        proxies<span class="token punctuation">.</span>append<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> proxies

<span class="token comment"># 轮换代理IP</span>
<span class="token keyword">def</span> <span class="token function">rotate_proxy</span><span class="token punctuation">(</span>proxies<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span><span class="token string">'http'</span><span class="token punctuation">:</span> proxies<span class="token punctuation">[</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>proxies<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">}</span>

<span class="token comment"># 数据采集函数</span>
<span class="token keyword">def</span> <span class="token function">fetch_data</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> proxies<span class="token punctuation">)</span><span class="token punctuation">:</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'</span><span class="token punctuation">,</span>
        <span class="token string">'Accept-Language'</span><span class="token punctuation">:</span> <span class="token string">'en-US,en;q=0.9'</span><span class="token punctuation">,</span>
        <span class="token string">'Accept-Encoding'</span><span class="token punctuation">:</span> <span class="token string">'gzip, deflate, br'</span><span class="token punctuation">,</span>
        <span class="token string">'Connection'</span><span class="token punctuation">:</span> <span class="token string">'keep-alive'</span><span class="token punctuation">,</span>
        <span class="token string">'DNT'</span><span class="token punctuation">:</span> <span class="token string">'1'</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> attempt <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 重试5次</span>
        proxy <span class="token operator">=</span> rotate_proxy<span class="token punctuation">(</span>proxies<span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> proxies<span class="token operator">=</span>proxy<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
            response<span class="token punctuation">.</span>raise_for_status<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 检查请求是否成功</span>
            <span class="token keyword">return</span> response<span class="token punctuation">.</span>text
        <span class="token keyword">except</span> requests<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>RequestException <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'请求失败（第</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>attempt<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">次尝试），错误: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>e<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 随机等待5到10秒后重试</span>

<span class="token comment"># 设置代理IP</span>
proxies <span class="token operator">=</span> get_proxies<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 目标URL列表</span>
urls <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">'https://www.amazon.com/s?k=laptop&amp;page=1'</span><span class="token punctuation">,</span>
    <span class="token string">'https://www.amazon.com/s?k=laptop&amp;page=2'</span><span class="token punctuation">,</span>
    <span class="token string">'https://www.amazon.com/s?k=laptop&amp;page=3'</span><span class="token punctuation">,</span>
    <span class="token comment"># 可以根据需要添加更多的页面URL</span>
<span class="token punctuation">]</span>

<span class="token comment"># 数据采集和存储函数</span>
<span class="token keyword">def</span> <span class="token function">fetch_and_store_data</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> proxies<span class="token punctuation">,</span> writer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    response_text <span class="token operator">=</span> fetch_data<span class="token punctuation">(</span>url<span class="token punctuation">,</span> proxies<span class="token punctuation">)</span>
    <span class="token keyword">if</span> response_text<span class="token punctuation">:</span>
        soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>response_text<span class="token punctuation">,</span> <span class="token string">'html.parser'</span><span class="token punctuation">)</span>
        products <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token string">'data-component-type'</span><span class="token punctuation">:</span> <span class="token string">'s-search-result'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> product <span class="token keyword">in</span> products<span class="token punctuation">:</span>
            name <span class="token operator">=</span> product<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">'a-size-medium a-color-base a-text-normal'</span><span class="token punctuation">)</span>
            price <span class="token operator">=</span> product<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">'a-price-whole'</span><span class="token punctuation">)</span>
            rating <span class="token operator">=</span> product<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">'a-icon-alt'</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> name <span class="token keyword">and</span> price <span class="token keyword">and</span> rating<span class="token punctuation">:</span>
                writer<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span><span class="token punctuation">[</span>name<span class="token punctuation">.</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> price<span class="token punctuation">.</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rating<span class="token punctuation">.</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'数据采集失败'</span><span class="token punctuation">)</span>

<span class="token comment"># 打开 CSV 文件进行写入</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'products.csv'</span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'w'</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
    writer <span class="token operator">=</span> csv<span class="token punctuation">.</span>writer<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>
    writer<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'商品名称'</span><span class="token punctuation">,</span> <span class="token string">'价格'</span><span class="token punctuation">,</span> <span class="token string">'评分'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token comment"># 使用多线程进行数据采集</span>
    <span class="token keyword">with</span> ThreadPoolExecutor<span class="token punctuation">(</span>max_workers<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">as</span> executor<span class="token punctuation">:</span>
        futures <span class="token operator">=</span> <span class="token punctuation">[</span>executor<span class="token punctuation">.</span>submit<span class="token punctuation">(</span>fetch_and_store_data<span class="token punctuation">,</span> url<span class="token punctuation">,</span>   
proxies<span class="token punctuation">,</span> writer<span class="token punctuation">)</span> <span class="token keyword">for</span> url <span class="token keyword">in</span> urls<span class="token punctuation">]</span>
        <span class="token keyword">for</span> future <span class="token keyword">in</span> futures<span class="token punctuation">:</span>
            future<span class="token punctuation">.</span>result<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 等待所有线程完成                  </span>
</code></pre> 
<p>采集得到的 CSV 文件内容如下：</p> 
<p><img src="https://images2.imgbox.com/55/5d/kuCCYYNN_o.png" alt="在这里插入图片描述"></p> 
<p>通过添加目标URL列表，我们可以采集到更多的商品数据，这里我们取了前三页，采集到共60条商品信息。</p> 
<pre><code class="prism language-python"><span class="token comment"># 目标URL列表</span>
urls <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">'https://www.amazon.com/s?k=laptop&amp;page=1'</span><span class="token punctuation">,</span>
    <span class="token string">'https://www.amazon.com/s?k=laptop&amp;page=2'</span><span class="token punctuation">,</span>
    <span class="token string">'https://www.amazon.com/s?k=laptop&amp;page=3'</span><span class="token punctuation">,</span>
    <span class="token comment"># 可以根据需要添加更多的页面URL</span>
<span class="token punctuation">]</span>
</code></pre> 
<h4><a id="_296"></a>步骤三：处理和分析数据</h4> 
<p>获取到商品数据后，我们可以使用 Pandas 等数据分析库对数据进行处理和分析。例如：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 读取 CSV 文件中的数据</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'products.csv'</span><span class="token punctuation">)</span>

<span class="token comment"># 去掉价格中的美元符号和逗号，并转换为浮点数</span>
df<span class="token punctuation">[</span><span class="token string">'价格'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'价格'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'[\$,]'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> regex<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">)</span>

<span class="token comment"># 定义价格区间</span>
bins <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">700</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token string">'inf'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'0-100'</span><span class="token punctuation">,</span> <span class="token string">'100-300'</span><span class="token punctuation">,</span> <span class="token string">'300-500'</span><span class="token punctuation">,</span> <span class="token string">'500-700'</span><span class="token punctuation">,</span> <span class="token string">'700-1000'</span><span class="token punctuation">,</span> <span class="token string">'1000以上'</span><span class="token punctuation">]</span>

<span class="token comment"># 将价格分到相应区间</span>
df<span class="token punctuation">[</span><span class="token string">'价格区间'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>cut<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'价格'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bins<span class="token operator">=</span>bins<span class="token punctuation">,</span> labels<span class="token operator">=</span>labels<span class="token punctuation">,</span> right<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token comment"># 统计每个价格区间的商品数量</span>
price_distribution <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'价格区间'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>price_distribution<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b1/ba/0qFvbOzM_o.png" alt="在这里插入图片描述"></p> 
<p>通过上述代码，我们可以对采集到的商品价格数据进行进一步处理和分析。</p> 
<p>以上就是利用 IPIDEA 进行数据采集的一个完整示例。通过这种方式，我们可以轻松地从任意平台获取数据，特别适用于跨境电商相关的应用。无论是用于市场分析还是优化产品策略，都能大大提高工作效率。</p> 
<p>当然我们也可以用官网提供的案例来熟悉具体的操作步骤，包含了常用的 C/C++语言、GO语言、Node.js语言、Php语言、JAVA语言、Python 语言以及 python-selenium 语言。</p> 
<p><img src="https://images2.imgbox.com/39/a0/5fqLAGEV_o.png" alt="在这里插入图片描述"></p> 
<p>经过实操案例，给大家展示了如何利用 IPIDEA 进行数据采集，从注册和获取代理 IP，到编写数据采集，再到处理和分析数据，每一步都体现了 IPIDEA 的便捷和高效。</p> 
<p><img src="https://images2.imgbox.com/59/87/30nVPGgo_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_336"></a>总结</h3> 
<p>通过实操案例，我们展示了如何利用代理服务进行数据采集，从注册和获取代理 IP，到编写数据采集代码，再到处理和分析数据，每一步都体现了这一过程的便捷和高效。代理服务的全球覆盖、高匿名性、安全性和高速稳定连接，使得跨境电商企业能够轻松地从全球各地获取所需数据，提高市场竞争力。同时，这种代理服务在社媒营销和SEO优化等方面的广泛应用，也为用户提供了更多实现目标的可能性。</p> 
<p>总体而言，代理服务是跨境电商和数据采集的强大工具，能够有效提升工作效率和数据质量。如果你正在寻找一款高效、可靠的代理服务，<a href="http://co.ipidea.net/?utm-source=CSDN&amp;utm-keyword=?0729" rel="nofollow">IPIDEA</a> 无疑是我们的更优选择。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/eecc6714b8faf8296d8d1db532948a11/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">贪心算法part03</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/650fe6091fa755f446c61a7c068d73a4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【C语言篇】C语言数据类型和变量</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>