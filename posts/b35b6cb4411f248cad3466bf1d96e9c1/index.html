<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>AI绘画：使用Stable Diffusion ComfyUI进行换脸：IPAdapter FaceID全面教程 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/b35b6cb4411f248cad3466bf1d96e9c1/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="AI绘画：使用Stable Diffusion ComfyUI进行换脸：IPAdapter FaceID全面教程">
  <meta property="og:description" content="在数字艺术和媒体编辑领域，换脸技术已经成为一种流行且强大的工具。它允许创作者将一个人物的面部特征无缝地转移到另一个人物上，创造出令人信服的视觉作品。Stable Diffusion ComfyUI提供了一个高效的平台，让用户能够轻松地实现换脸。本文将详细介绍如何使用ComfyUI中的IPAdapter FaceID插件进行换脸，从安装到实际操作，一步步引导你完成整个过程。
换脸技术简介 换脸技术通过深度学习算法，识别并提取面部特征，然后将这些特征应用到目标图像上。在AI绘画中，保持角色一致性的方法之一就是通过换脸来实现。市面上有许多换脸插件，如Reactor、FaceFusion、Roop等，而IPAdapter推出的FaceID模型因其高效性和准确性而广受欢迎。
安装IPAdapter FaceID插件 在使用IPAdapter FaceID之前，我们需要确保ComfyUI是最新版本，以便兼容最新的插件。
更新ComfyUI 打开ComfyUI管理器。点击“更新全部”以更新ComfyUI到最新版本。如果你位于大陆境内，可能需要切换不同的网络环境（如不同的VPN节点）来成功更新。 安装IPAdapter FaceID Plus节点 有两种方法可以安装IPAdapter FaceID Plus节点：
方法一：通过管理器安装 打开ComfyUI管理器。点击“安装节点”。搜索“ComfyUI_IPAdapter_plus”并点击安装。 方法二：手动安装 访问IPAdapter FaceID Plus的GitHub主页：GitHub - cubiq/ComfyUI_IPAdapter_plus。下载ZIP压缩包。将下载的ZIP压缩包解压到ComfyUI目录下的custom_nodes目录中。如果需要，可以删除文件夹名后的“-main”。 准备工作 在开始换脸之前，确保你已经安装了所有必要的模型和依赖项。
安装模型 下载IPAdapter模型和CLIP_VISION模型。将模型文件存放在ComfyUI的models目录下。 模型文件的huggingface下载地址：https://huggingface.co/h94/IP-Adapter-FaceID/tree/main
ipadapter总共有4个版本的模型，每个模型都包含1个主模型和1个lora模型，建议将这4个版本的模型都下载下来，分别放入相对应的文件夹中：
主模型文件夹：“\ComfyUI_windows_portable\ComfyUI\models\ipadapter”
lora模型文件夹：“\ComfyUI_windows_portable\ComfyUI\models\loras\ipadapter”
点击“管理器”，选择“安装模型”，搜索关键词“clip”，将4个“clip_vision”模型都安装好，其中2个是1.5版的模型，2个是SDXL版的模型，虽然截至到本文发布的时候ipadapter尚未推出faceID的SDXL版模型，但是相信不就之后就会推出SDXL版！
安装InsightFace 检查Python版本是否兼容。下载相应的.whl文件。安装InsightFace库。 insightface是一个Python库，不管是运行reactor插件还是其他的换脸插件，都会用到这个Python库，由于ComfyUI是一个独立的虚拟环境，所以安装insightface库的方法有点特别
首先我们要查看下我们的comfyUI的虚拟环境中的Python版本
第一步：找到根目录下的“python_embeded”文件夹，进入到该文件夹中；
第二步：在该文件夹的路径栏输入“cmd”；
第三步：在弹出的cmd命令窗口中输入“python.exe -V”命令，此时我们就可以查看到我们ComfyUI中的Python版本，我的是“Python 3.11.6”版；
我们在上面一步已经查看了我们自己的Python版本，接下来根据自己的Python版本下载相对应的whl文件：
3.10版：insightface-0.7.3-cp310-cp310-win_amd64.whl
3.11版：insightface-0.7.3-cp311-cp311-win_amd64.whl
将下载下来的whl文件放在“\ComfyUI_windows_portable\python_embeded”文件下面
python -m pip install -U pip python.exe -m pip install insightface-0.7.3-cp311-cp311-win_amd64.whl 创建换脸工作流 现在，终于。当我们顺利完成了上面的所有安装之后，我们已经准备好开始创建换脸工作流。使用“ComfyUI_IPAdapter_plus”节点来进行换脸！比起reactor等换脸插件，“ComfyUI_IPAdapter_plus”的换脸行为发生在图片生成之前，所以最后的效果会更加自然！下面是一个换脸操作的案例：
基础设置 打开ComfyUI并创建一个新的工作流。添加必要的节点，包括“FaceID工作流”节点。 工作流注意事项 确保所有节点正确连接。根据需要调整节点参数。检查模型版本是否与插件兼容。 开始换脸 导入源图像和目标图像。调整FaceID工作流中的参数，如换脸强度、面部特征匹配等。运行工作流并查看换脸效果。 工作流注意事项说明：
ipadapter模型和lora模型一定要匹配；可以根据自己的需要调整lora的权重，数字越大上传的参考图片对生成的图片影响越大，包括画质和构图，适当降低该权重，可以让AI发挥的空间越大，画面越自然，但是换脸效果可能会降低；ipadapter模型中的plus版和plusV2版本在换脸效果上并不比基础版要好，但是在画质上会相对较好；工作流的最后面的组是高清放大和面部修复，该组我已经默认设置为“停用”模式，如果你有需要可以右键“启用该组节点”；高清放大节点中的“降噪”参数设置得越小，高清放大之后的图片人物面部就越接近原图，过大的“降噪”参数会让高清放大之后的人物改变人脸的样式，该参数建议设置在0.05以下！ 结语 通过上述步骤，你现在应该能够使用Stable Diffusion ComfyUI和IPAdapter FaceID插件轻松地进行换脸操作。记住，实践是掌握任何技术的最佳方式，所以不断尝试和调整参数，直到你达到满意的效果。如果你在过程中遇到任何问题，可在相关社区寻求帮助。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-03T08:51:27+08:00">
    <meta property="article:modified_time" content="2024-04-03T08:51:27+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">AI绘画：使用Stable Diffusion ComfyUI进行换脸：IPAdapter FaceID全面教程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>        在数字艺术和媒体编辑领域，换脸技术已经成为一种流行且强大的工具。它允许创作者将一个人物的面部特征无缝地转移到另一个人物上，创造出令人信服的视觉作品。Stable Diffusion ComfyUI提供了一个高效的平台，让用户能够轻松地实现换脸。本文将详细介绍如何使用ComfyUI中的IPAdapter FaceID插件进行换脸，从安装到实际操作，一步步引导你完成整个过程。</p> 
<h3>换脸技术简介</h3> 
<p>       换脸技术通过深度学习算法，识别并提取面部特征，然后将这些特征应用到目标图像上。在AI绘画中，保持角色一致性的方法之一就是通过换脸来实现。市面上有许多换脸插件，如Reactor、FaceFusion、Roop等，而IPAdapter推出的FaceID模型因其高效性和准确性而广受欢迎。</p> 
<h3>安装IPAdapter FaceID插件</h3> 
<p>在使用IPAdapter FaceID之前，我们需要确保ComfyUI是最新版本，以便兼容最新的插件。</p> 
<p class="img-center"><img alt="" height="575" src="https://images2.imgbox.com/56/5e/SnZ3oYsm_o.png" width="1021"></p> 
<h4>更新ComfyUI</h4> 
<ol><li>打开ComfyUI管理器。</li><li>点击“更新全部”以更新ComfyUI到最新版本。</li><li>如果你位于大陆境内，可能需要切换不同的网络环境（如不同的VPN节点）来成功更新。</li></ol> 
<h4>安装IPAdapter FaceID Plus节点</h4> 
<p>有两种方法可以安装IPAdapter FaceID Plus节点：</p> 
<h5>方法一：通过管理器安装</h5> 
<ol><li>打开ComfyUI管理器。</li><li>点击“安装节点”。</li><li>搜索“ComfyUI_IPAdapter_plus”并点击安装。</li></ol> 
<p class="img-center"><img alt="" height="576" src="https://images2.imgbox.com/17/3d/9IxfJumJ_o.png" width="1021"></p> 
<h5></h5> 
<p class="img-center"><img alt="" height="564" src="https://images2.imgbox.com/39/61/nMpZ1OMu_o.png" width="1015"></p> 
<h5>方法二：手动安装</h5> 
<ol><li>访问IPAdapter FaceID Plus的GitHub主页：<a href="https://github.com/cubiq/ComfyUI_IPAdapter_plus" title="GitHub - cubiq/ComfyUI_IPAdapter_plus">GitHub - cubiq/ComfyUI_IPAdapter_plus</a>。</li><li>下载ZIP压缩包。</li><li>将下载的ZIP压缩包解压到ComfyUI目录下的<code>custom_nodes</code>目录中。</li><li>如果需要，可以删除文件夹名后的“-main”。</li></ol> 
<p class="img-center"><img alt="" height="622" src="https://images2.imgbox.com/2b/4f/58LFD3yA_o.png" width="1021"></p> 
<h4></h4> 
<p class="img-center"><img alt="" height="500" src="https://images2.imgbox.com/8b/79/BrFgFxSl_o.png" width="1047"></p> 
<h3>准备工作</h3> 
<p>在开始换脸之前，确保你已经安装了所有必要的模型和依赖项。</p> 
<h4>安装模型</h4> 
<ol><li>下载IPAdapter模型和CLIP_VISION模型。</li><li>将模型文件存放在ComfyUI的<code>models</code>目录下。</li></ol> 
<p>模型文件的huggingface下载地址：<a href="https://caovan.com/go?_=0fc7edf7b2aHR0cHM6Ly9odWdnaW5nZmFjZS5jby9oOTQvSVAtQWRhcHRlci1GYWNlSUQvdHJlZS9tYWlu" rel="nofollow" title="https://huggingface.co/h94/IP-Adapter-FaceID/tree/main">https://huggingface.co/h94/IP-Adapter-FaceID/tree/main</a></p> 
<p>ipadapter总共有4个版本的模型，每个模型都包含1个主模型和1个lora模型，建议将这4个版本的模型都下载下来，分别放入相对应的文件夹中：</p> 
<p>主模型文件夹：“\ComfyUI_windows_portable\ComfyUI\models\ipadapter”</p> 
<p>lora模型文件夹：“\ComfyUI_windows_portable\ComfyUI\models\loras\ipadapter”</p> 
<p class="img-center"><img alt="" height="550" src="https://images2.imgbox.com/d4/6e/HeyUcoLN_o.png" width="1035"></p> 
<h4></h4> 
<p class="img-center"><img alt="" height="551" src="https://images2.imgbox.com/93/0c/9YiW2dZm_o.png" width="947"></p> 
<p class="img-center"><img alt="" height="529" src="https://images2.imgbox.com/41/76/kwdsySIe_o.png" width="1052"></p> 
<p>点击“管理器”，选择“安装模型”，搜索关键词“clip”，将4个“clip_vision”模型都安装好，其中2个是1.5版的模型，2个是SDXL版的模型，虽然截至到本文发布的时候ipadapter尚未推出<a href="https://caovan.com/tag/494" rel="nofollow" title="faceID">faceID</a>的SDXL版模型，但是相信不就之后就会推出SDXL版！</p> 
<p class="img-center"><img alt="" height="561" src="https://images2.imgbox.com/37/dd/TCI6tuM7_o.png" width="1024"></p> 
<p> </p> 
<p class="img-center"><img alt="" height="569" src="https://images2.imgbox.com/5f/84/ftfmTJhq_o.png" width="1019"></p> 
<h4>安装InsightFace</h4> 
<ol><li>检查Python版本是否兼容。</li><li>下载相应的<code>.whl</code>文件。</li><li>安装InsightFace库。</li></ol> 
<p>insightface是一个Python库，不管是运行reactor插件还是其他的<a href="https://caovan.com/tag/381" rel="nofollow" title="换脸">换脸</a>插件，都会用到这个Python库，由于ComfyUI是一个独立的虚拟环境，所以安装insightface库的方法有点特别</p> 
<p>首先我们要查看下我们的comfyUI的虚拟环境中的Python版本</p> 
<p>第一步：找到根目录下的“python_embeded”文件夹，进入到该文件夹中；</p> 
<p>第二步：在该文件夹的路径栏输入“cmd”；</p> 
<p>第三步：在弹出的cmd命令窗口中输入“python.exe -V”命令，此时我们就可以查看到我们ComfyUI中的Python版本，我的是“Python 3.11.6”版；</p> 
<p>我们在上面一步已经查看了我们自己的Python版本，接下来根据自己的Python版本下载相对应的whl文件：</p> 
<p>3.10版：<a href="https://caovan.com/go?_=3d16ef815daHR0cHM6Ly9wYW4ucXVhcmsuY24vcy9iZTYxMGMwNDc2NjI%3D" rel="nofollow" title="insightface-0.7.3-cp310-cp310-win_amd64.whl">insightface-0.7.3-cp310-cp310-win_amd64.whl</a></p> 
<p>3.11版：<a href="https://caovan.com/go?_=7f4e9cc83baHR0cHM6Ly9wYW4ucXVhcmsuY24vcy81NDViMTJkMjMwOWM%3D" rel="nofollow" title="insightface-0.7.3-cp311-cp311-win_amd64.whl">insightface-0.7.3-cp311-cp311-win_amd64.whl</a></p> 
<p>将下载下来的whl文件放在“\ComfyUI_windows_portable\python_embeded”文件下面</p> 
<p><img alt="" height="381" src="https://images2.imgbox.com/1e/25/ZYjHZljB_o.png" width="1012"></p> 
<pre><code class="hljs">python -m pip install -U pip
python.exe -m pip install insightface-0.7.3-cp311-cp311-win_amd64.whl</code></pre> 
<p> </p> 
<p class="img-center"><img alt="" height="552" src="https://images2.imgbox.com/45/25/omrv9o8d_o.png" width="1010"></p> 
<h3>创建换脸工作流</h3> 
<p>现在，终于。当我们顺利完成了上面的所有安装之后，我们已经准备好开始创建换脸工作流。使用“ComfyUI_IPAdapter_plus”节点来进行<a href="https://caovan.com/tag/381" rel="nofollow" title="换脸">换脸</a>！比起reactor等换脸插件，“ComfyUI_IPAdapter_plus”的换脸行为发生在图片生成之前，所以最后的效果会更加自然！下面是一个换脸操作的案例：</p> 
<h4>基础设置</h4> 
<ol><li>打开ComfyUI并创建一个新的工作流。</li><li>添加必要的节点，包括“FaceID工作流”节点。</li></ol> 
<h4>工作流注意事项</h4> 
<ul><li>确保所有节点正确连接。</li><li>根据需要调整节点参数。</li><li>检查模型版本是否与插件兼容。</li></ul> 
<h3>开始换脸</h3> 
<ol><li>导入源图像和目标图像。</li><li>调整FaceID工作流中的参数，如换脸强度、面部特征匹配等。</li><li>运行工作流并查看换脸效果。</li></ol> 
<p><img alt="" height="566" src="https://images2.imgbox.com/3d/38/SESgPJf5_o.png" width="1027"></p> 
<p>工作流注意事项说明：</p> 
<ol><li><a href="https://caovan.com/tag/495" rel="nofollow" title="ipadapter">ipadapter</a>模型和lora模型一定要匹配；</li><li>可以根据自己的需要调整lora的权重，数字越大上传的参考图片对生成的图片影响越大，包括画质和构图，适当降低该权重，可以让AI发挥的空间越大，画面越自然，但是换脸效果可能会降低；</li><li>ipadapter模型中的plus版和plusV2版本在换脸效果上并不比基础版要好，但是在画质上会相对较好；</li><li>工作流的最后面的组是高清放大和面部修复，该组我已经默认设置为“停用”模式，如果你有需要可以右键“启用该组节点”；</li><li>高清放大节点中的“降噪”参数设置得越小，高清放大之后的图片人物面部就越接近原图，过大的“降噪”参数会让高清放大之后的人物改变人脸的样式，该参数建议设置在0.05以下！</li></ol> 
<p> </p> 
<h3>结语</h3> 
<p>通过上述步骤，你现在应该能够使用Stable Diffusion ComfyUI和IPAdapter FaceID插件轻松地进行换脸操作。记住，实践是掌握任何技术的最佳方式，所以不断尝试和调整参数，直到你达到满意的效果。如果你在过程中遇到任何问题，可在相关社区寻求帮助。</p> 
<hr> 
<p>请注意，本文中提到的链接和资源可能需要在实际环境中进行验证和调整。此外，换脸技术涉及隐私和伦理问题，使用时应确保遵守相关法律法规，并尊重个人隐私权。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/510095292f6d6ec299dab088b49e4da1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">基于Leaflet.js和Turf.js的等值线区间自定义及颜色自适应实践</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ca7305915cad241377d6ddc37d054c3d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">通过 itms-services 协议下载安装 IOS 应用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>