<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C#进阶-实现邮箱收发功能 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/47b7e8784e964e893feb2980240bda5c/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="C#进阶-实现邮箱收发功能">
  <meta property="og:description" content="一、C#发送邮件概述 在C#中，发送邮件是一项常见的任务，通常用于实现自动化通知、报警和与用户进行交互等场景。C#提供了多种发送邮件的方式，主要方式包括SMTP协议、POP3协议、IMAP协议、Exchange服务器等。使用这些方式，开发人员可以灵活地发送和接收邮件，满足各种应用场景的需求。
下表是SMTP、POP3、IMAP和Exchange的功能特性对比：
功能特性SMTPPOP3IMAPExchange发送邮件是否否是接收邮件否是是是读取收件箱否是是是删除邮件否是是是标记邮件否可通过其他方式实现是是移动邮件否可通过其他方式实现是是搜索邮件否是是是附件处理是是是是支持加密是是是是安全认证是是是是访问邮件夹否是是是同步邮件夹否是是是会话状态无无有有支持文件夹操作无无是是 SMTP协议常用于发送邮件，POP3和IMAP协议用于接收邮件，而Exchange服务器则提供了更多的功能，包括邮件的发送、接收、管理等。Exchange是一个综合的邮件解决方案，可以提供SMTP、POP3、IMAP等多种协议的支持，而SMTP、POP3和IMAP通常用于与邮件服务器进行通信的底层协议。通过C#中丰富的API和工具，开发人员可以轻松地集成邮件功能到他们的应用程序中，实现高效的邮件通信。
二、C#发送邮件的代码实现 1、SMTP协议 SMTP（Simple Mail Transfer Protocol）是一种标准的网络邮件传输协议，用于在网络上传输电子邮件。在C#中，使用SMTP协议发送邮件是一种常见的方式。
① 发送邮件 使用SMTP协议发送邮件是一种常见的方式。通过指定SMTP服务器和端口，以及提供发件人和收件人的信息，可以发送电子邮件。
以下是使用C#发送邮件的SMTP代码示例：
using System; using System.Net; using System.Net.Mail; class Program { static void Main(string[] args) { try { // 设置发送者的电子邮件地址和密码 string senderEmail = &#34;your-email@example.com&#34;; string senderPassword = &#34;your-password&#34;; // 设置收件人的电子邮件地址 string receiverEmail = &#34;recipient@example.com&#34;; // 创建邮件对象 MailMessage mail = new MailMessage(senderEmail, receiverEmail); mail.Subject = &#34;邮件主题&#34;; mail.Body = &#34;邮件内容&#34;; // 创建SMTP客户端 SmtpClient smtpClient = new SmtpClient(&#34;smtp.example.com&#34;); smtpClient.Port = 587; smtpClient.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-20T00:50:14+08:00">
    <meta property="article:modified_time" content="2024-03-20T00:50:14+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C#进阶-实现邮箱收发功能</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="C_2"></a>一、C#发送邮件概述</h2> 
<p>在C#中，发送邮件是一项常见的任务，通常用于实现自动化通知、报警和与用户进行交互等场景。C#提供了多种发送邮件的方式，主要方式包括SMTP协议、POP3协议、IMAP协议、Exchange服务器等。使用这些方式，开发人员可以灵活地发送和接收邮件，满足各种应用场景的需求。</p> 
<p>下表是SMTP、POP3、IMAP和Exchange的功能特性对比：</p> 
<table><thead><tr><th>功能特性</th><th>SMTP</th><th>POP3</th><th>IMAP</th><th>Exchange</th></tr></thead><tbody><tr><td>发送邮件</td><td>是</td><td>否</td><td>否</td><td>是</td></tr><tr><td>接收邮件</td><td>否</td><td>是</td><td>是</td><td>是</td></tr><tr><td>读取收件箱</td><td>否</td><td>是</td><td>是</td><td>是</td></tr><tr><td>删除邮件</td><td>否</td><td>是</td><td>是</td><td>是</td></tr><tr><td>标记邮件</td><td>否</td><td>可通过其他方式实现</td><td>是</td><td>是</td></tr><tr><td>移动邮件</td><td>否</td><td>可通过其他方式实现</td><td>是</td><td>是</td></tr><tr><td>搜索邮件</td><td>否</td><td>是</td><td>是</td><td>是</td></tr><tr><td>附件处理</td><td>是</td><td>是</td><td>是</td><td>是</td></tr><tr><td>支持加密</td><td>是</td><td>是</td><td>是</td><td>是</td></tr><tr><td>安全认证</td><td>是</td><td>是</td><td>是</td><td>是</td></tr><tr><td>访问邮件夹</td><td>否</td><td>是</td><td>是</td><td>是</td></tr><tr><td>同步邮件夹</td><td>否</td><td>是</td><td>是</td><td>是</td></tr><tr><td>会话状态</td><td>无</td><td>无</td><td>有</td><td>有</td></tr><tr><td>支持文件夹操作</td><td>无</td><td>无</td><td>是</td><td>是</td></tr></tbody></table> 
<p>SMTP协议常用于发送邮件，POP3和IMAP协议用于接收邮件，而Exchange服务器则提供了更多的功能，包括邮件的发送、接收、管理等。Exchange是一个综合的邮件解决方案，可以提供SMTP、POP3、IMAP等多种协议的支持，而SMTP、POP3和IMAP通常用于与邮件服务器进行通信的底层协议。通过C#中丰富的API和工具，开发人员可以轻松地集成邮件功能到他们的应用程序中，实现高效的邮件通信。</p> 
<hr> 
<h2><a id="C_29"></a>二、C#发送邮件的代码实现</h2> 
<h3><a id="1SMTP_30"></a>1、SMTP协议</h3> 
<p>SMTP（Simple Mail Transfer Protocol）是一种标准的网络邮件传输协议，用于在网络上传输电子邮件。在C#中，使用SMTP协议发送邮件是一种常见的方式。</p> 
<h4><a id="__32"></a>① 发送邮件</h4> 
<p>使用SMTP协议发送邮件是一种常见的方式。通过指定SMTP服务器和端口，以及提供发件人和收件人的信息，可以发送电子邮件。</p> 
<p>以下是使用C#发送邮件的SMTP代码示例：</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Mail</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 设置发送者的电子邮件地址和密码</span>
            <span class="token class-name"><span class="token keyword">string</span></span> senderEmail <span class="token operator">=</span> <span class="token string">"your-email@example.com"</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span></span> senderPassword <span class="token operator">=</span> <span class="token string">"your-password"</span><span class="token punctuation">;</span>

            <span class="token comment">// 设置收件人的电子邮件地址</span>
            <span class="token class-name"><span class="token keyword">string</span></span> receiverEmail <span class="token operator">=</span> <span class="token string">"recipient@example.com"</span><span class="token punctuation">;</span>

            <span class="token comment">// 创建邮件对象</span>
            <span class="token class-name">MailMessage</span> mail <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MailMessage</span><span class="token punctuation">(</span>senderEmail<span class="token punctuation">,</span> receiverEmail<span class="token punctuation">)</span><span class="token punctuation">;</span>
            mail<span class="token punctuation">.</span>Subject <span class="token operator">=</span> <span class="token string">"邮件主题"</span><span class="token punctuation">;</span>
            mail<span class="token punctuation">.</span>Body <span class="token operator">=</span> <span class="token string">"邮件内容"</span><span class="token punctuation">;</span>

            <span class="token comment">// 创建SMTP客户端</span>
            <span class="token class-name">SmtpClient</span> smtpClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SmtpClient</span><span class="token punctuation">(</span><span class="token string">"smtp.example.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            smtpClient<span class="token punctuation">.</span>Port <span class="token operator">=</span> <span class="token number">587</span><span class="token punctuation">;</span>
            smtpClient<span class="token punctuation">.</span>Credentials <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">NetworkCredential</span><span class="token punctuation">(</span>senderEmail<span class="token punctuation">,</span> senderPassword<span class="token punctuation">)</span><span class="token punctuation">;</span>
            smtpClient<span class="token punctuation">.</span>EnableSsl <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

            <span class="token comment">// 发送邮件</span>
            smtpClient<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span>mail<span class="token punctuation">)</span><span class="token punctuation">;</span>

            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"邮件发送成功！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"邮件发送失败："</span> <span class="token operator">+</span> ex<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>SMTP协议通常用于发送邮件，而不是接收邮件。要读取收件箱中的邮件，需要使用其他协议或API，如POP3或IMAP。</p> 
<hr> 
<h3><a id="2POP3_83"></a>2、POP3协议</h3> 
<p>POP3（Post Office Protocol 3）是一种用于从邮件服务器接收邮件的标准协议。在C#中，可以使用POP3协议读取收件箱中的邮件。</p> 
<h4><a id="__87"></a>① 读取收件箱</h4> 
<p>使用POP3协议读取收件箱中的邮件是一种常见的方式。通过连接到POP3服务器，并提供用户名和密码，可以检索收件箱中的邮件。</p> 
<p>以下是使用C#读取收件箱中邮件的POP3代码示例：</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">OpenPop<span class="token punctuation">.</span>Pop3</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 设置POP3服务器地址、端口、用户名和密码</span>
            <span class="token class-name"><span class="token keyword">string</span></span> popServer <span class="token operator">=</span> <span class="token string">"pop.example.com"</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">int</span></span> port <span class="token operator">=</span> <span class="token number">995</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span></span> username <span class="token operator">=</span> <span class="token string">"your-username"</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span></span> password <span class="token operator">=</span> <span class="token string">"your-password"</span><span class="token punctuation">;</span>

            <span class="token comment">// 创建POP3客户端</span>
            <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">Pop3Client</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Pop3Client</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                client<span class="token punctuation">.</span><span class="token function">Connect</span><span class="token punctuation">(</span>popServer<span class="token punctuation">,</span> port<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                client<span class="token punctuation">.</span><span class="token function">Authenticate</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// 获取收件箱中的邮件数量</span>
                <span class="token class-name"><span class="token keyword">int</span></span> messageCount <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">GetMessageCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"收件箱中共有 {0} 封邮件"</span><span class="token punctuation">,</span> messageCount<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// 遍历每封邮件并输出主题</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> messageCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token class-name"><span class="token keyword">var</span></span> message <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">GetMessage</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"邮件主题：{0}"</span><span class="token punctuation">,</span> message<span class="token punctuation">.</span>Headers<span class="token punctuation">.</span>Subject<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                client<span class="token punctuation">.</span><span class="token function">Disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"读取收件箱失败："</span> <span class="token operator">+</span> ex<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h4><a id="__137"></a>② 删除邮件</h4> 
<p>使用POP3协议可以删除收件箱中的邮件。通过指定邮件的索引，可以删除特定的邮件。</p> 
<p>以下是使用C#删除收件箱中邮件的POP3代码示例：</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">OpenPop<span class="token punctuation">.</span>Pop3</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 设置POP3服务器地址、端口、用户名和密码</span>
            <span class="token class-name"><span class="token keyword">string</span></span> popServer <span class="token operator">=</span> <span class="token string">"pop.example.com"</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">int</span></span> port <span class="token operator">=</span> <span class="token number">995</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span></span> username <span class="token operator">=</span> <span class="token string">"your-username"</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span></span> password <span class="token operator">=</span> <span class="token string">"your-password"</span><span class="token punctuation">;</span>

            <span class="token comment">// 创建POP3客户端</span>
            <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">Pop3Client</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Pop3Client</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                client<span class="token punctuation">.</span><span class="token function">Connect</span><span class="token punctuation">(</span>popServer<span class="token punctuation">,</span> port<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                client<span class="token punctuation">.</span><span class="token function">Authenticate</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// 删除邮件</span>
                client<span class="token punctuation">.</span><span class="token function">DeleteMessage</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 删除第一封邮件</span>

                client<span class="token punctuation">.</span><span class="token function">Disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"删除邮件失败："</span> <span class="token operator">+</span> ex<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h3><a id="3IMAP_181"></a>3、IMAP协议</h3> 
<p>IMAP（Internet Message Access Protocol）是一种用于从邮件服务器接收邮件的高级协议，它允许客户端在服务器上管理邮件的状态。在C#中，可以使用IMAP协议读取收件箱中的邮件。</p> 
<h4><a id="__185"></a>① 读取收件箱</h4> 
<p>使用IMAP协议读取收件箱中的邮件是一种灵活且功能丰富的方式。通过连接到IMAP服务器，并提供用户名和密码，可以管理收件箱中的邮件，包括查看、标记、移动等操作。</p> 
<p>以下是使用C#读取收件箱中邮件的IMAP代码示例：</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">MailKit</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">MailKit<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Imap</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">MailKit<span class="token punctuation">.</span>Search</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">MimeKit</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 设置IMAP服务器地址、端口、用户名和密码</span>
            <span class="token class-name"><span class="token keyword">string</span></span> imapServer <span class="token operator">=</span> <span class="token string">"imap.example.com"</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">int</span></span> port <span class="token operator">=</span> <span class="token number">993</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span></span> username <span class="token operator">=</span> <span class="token string">"your-username"</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span></span> password <span class="token operator">=</span> <span class="token string">"your-password"</span><span class="token punctuation">;</span>

            <span class="token comment">// 创建IMAP客户端</span>
            <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ImapClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                client<span class="token punctuation">.</span><span class="token function">Connect</span><span class="token punctuation">(</span>imapServer<span class="token punctuation">,</span> port<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                client<span class="token punctuation">.</span><span class="token function">Authenticate</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// 打开收件箱</span>
                <span class="token class-name"><span class="token keyword">var</span></span> inbox <span class="token operator">=</span> client<span class="token punctuation">.</span>Inbox<span class="token punctuation">;</span>
                inbox<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>FolderAccess<span class="token punctuation">.</span>ReadOnly<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// 获取收件箱中的邮件数量</span>
                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"收件箱中共有 {0} 封邮件"</span><span class="token punctuation">,</span> inbox<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// 遍历收件箱中的邮件并输出主题</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> inbox<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token class-name"><span class="token keyword">var</span></span> message <span class="token operator">=</span> inbox<span class="token punctuation">.</span><span class="token function">GetMessage</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"邮件主题：{0}"</span><span class="token punctuation">,</span> message<span class="token punctuation">.</span>Subject<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                client<span class="token punctuation">.</span><span class="token function">Disconnect</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"读取收件箱失败："</span> <span class="token operator">+</span> ex<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h4><a id="__241"></a>② 标记邮件</h4> 
<p>使用IMAP协议可以标记收件箱中的邮件，例如将邮件标记为已读或未读。</p> 
<p>以下是使用C#标记收件箱中邮件的IMAP代码示例：</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">MailKit</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">MailKit<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Imap</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">MailKit<span class="token punctuation">.</span>Search</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">MimeKit</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 设置IMAP服务器地址、端口、用户名和密码</span>
            <span class="token class-name"><span class="token keyword">string</span></span> imapServer <span class="token operator">=</span> <span class="token string">"imap.example.com"</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">int</span></span> port <span class="token operator">=</span> <span class="token number">993</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span></span> username <span class="token operator">=</span> <span class="token string">"your-username"</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span></span> password <span class="token operator">=</span> <span class="token string">"your-password"</span><span class="token punctuation">;</span>

            <span class="token comment">// 创建IMAP客户端</span>
            <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ImapClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                client<span class="token punctuation">.</span><span class="token function">Connect</span><span class="token punctuation">(</span>imapServer<span class="token punctuation">,</span> port<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                client<span class="token punctuation">.</span><span class="token function">Authenticate</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// 打开收件箱</span>
                <span class="token class-name"><span class="token keyword">var</span></span> inbox <span class="token operator">=</span> client<span class="token punctuation">.</span>Inbox<span class="token punctuation">;</span>
                inbox<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>FolderAccess<span class="token punctuation">.</span>ReadWrite<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// 获取未读邮件</span>
                <span class="token class-name"><span class="token keyword">var</span></span> uids <span class="token operator">=</span> inbox<span class="token punctuation">.</span><span class="token function">Search</span><span class="token punctuation">(</span>SearchQuery<span class="token punctuation">.</span>NotSeen<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> uid <span class="token keyword">in</span> uids<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token class-name"><span class="token keyword">var</span></span> message <span class="token operator">=</span> inbox<span class="token punctuation">.</span><span class="token function">GetMessage</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 标记邮件为已读</span>
                    inbox<span class="token punctuation">.</span><span class="token function">AddFlags</span><span class="token punctuation">(</span>uid<span class="token punctuation">,</span> MessageFlags<span class="token punctuation">.</span>Seen<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                client<span class="token punctuation">.</span><span class="token function">Disconnect</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"标记邮件失败："</span> <span class="token operator">+</span> ex<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h4><a id="__297"></a>③ 移动邮件</h4> 
<p>使用IMAP协议可以移动收件箱中的邮件到其他文件夹。</p> 
<p>以下是使用C#移动收件箱中邮件的IMAP代码示例：</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">MailKit</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">MailKit<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Imap</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">MailKit<span class="token punctuation">.</span>Search</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">MimeKit</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 设置IMAP服务器地址、端口、用户名和密码</span>
            <span class="token class-name"><span class="token keyword">string</span></span> imapServer <span class="token operator">=</span> <span class="token string">"imap.example.com"</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">int</span></span> port <span class="token operator">=</span> <span class="token number">993</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span></span> username <span class="token operator">=</span> <span class="token string">"your-username"</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span></span> password <span class="token operator">=</span> <span class="token string">"your-password"</span><span class="token punctuation">;</span>

            <span class="token comment">// 创建IMAP客户端</span>
            <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ImapClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                client<span class="token punctuation">.</span><span class="token function">Connect</span><span class="token punctuation">(</span>imapServer<span class="token punctuation">,</span> port<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                client<span class="token punctuation">.</span><span class="token function">Authenticate</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// 打开收件箱</span>
                <span class="token class-name"><span class="token keyword">var</span></span> inbox <span class="token operator">=</span> client<span class="token punctuation">.</span>Inbox<span class="token punctuation">;</span>
                inbox<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>FolderAccess<span class="token punctuation">.</span>ReadWrite<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// 获取邮件UID</span>
                <span class="token class-name"><span class="token keyword">var</span></span> uids <span class="token operator">=</span> inbox<span class="token punctuation">.</span><span class="token function">Search</span><span class="token punctuation">(</span>SearchQuery<span class="token punctuation">.</span>All<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> uid <span class="token keyword">in</span> uids<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// 移动邮件到其他文件夹</span>
                    inbox<span class="token punctuation">.</span><span class="token function">MoveTo</span><span class="token punctuation">(</span>uid<span class="token punctuation">,</span> client<span class="token punctuation">.</span><span class="token function">GetFolder</span><span class="token punctuation">(</span><span class="token string">"Archive"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                client<span class="token punctuation">.</span><span class="token function">Disconnect</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"移动邮件失败："</span> <span class="token operator">+</span> ex<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h3><a id="4Exchange_353"></a>4、Exchange服务</h3> 
<p>Exchange是微软开发的企业邮件服务器软件，可以作为邮件收发的中心。在C#中，使用Exchange服务可以通过EWS（Exchange Web Services）或其他API发送邮件。Exchange的功能非常强大，并提供了丰富的操作，我们既可以发送邮件，也可以进行读取收件箱、发件箱等操作。</p> 
<h4><a id="__355"></a>① 发送邮件</h4> 
<p>以下是使用C#使用Exchange服务发送邮件的代码示例：</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>Exchange<span class="token punctuation">.</span>WebServices<span class="token punctuation">.</span>Data</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 设置Exchange服务器地址</span>
            <span class="token class-name"><span class="token keyword">string</span></span> exchangeServerUrl <span class="token operator">=</span> <span class="token string">"https://your-exchange-server-url.com/EWS/Exchange.asmx"</span><span class="token punctuation">;</span>

            <span class="token comment">// 设置发件人邮箱地址和密码</span>
            <span class="token class-name"><span class="token keyword">string</span></span> senderEmail <span class="token operator">=</span> <span class="token string">"your-email@example.com"</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span></span> senderPassword <span class="token operator">=</span> <span class="token string">"your-password"</span><span class="token punctuation">;</span>

            <span class="token comment">// 设置收件人邮箱地址</span>
            <span class="token class-name"><span class="token keyword">string</span></span> receiverEmail <span class="token operator">=</span> <span class="token string">"recipient@example.com"</span><span class="token punctuation">;</span>

            <span class="token comment">// 创建Exchange服务对象</span>
            <span class="token class-name">ExchangeService</span> service <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ExchangeService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            service<span class="token punctuation">.</span>Url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Uri</span><span class="token punctuation">(</span>exchangeServerUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
            service<span class="token punctuation">.</span>Credentials <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">WebCredentials</span><span class="token punctuation">(</span>senderEmail<span class="token punctuation">,</span> senderPassword<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 创建邮件对象</span>
            <span class="token class-name">EmailMessage</span> email <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">EmailMessage</span><span class="token punctuation">(</span>service<span class="token punctuation">)</span><span class="token punctuation">;</span>
            email<span class="token punctuation">.</span>Subject <span class="token operator">=</span> <span class="token string">"邮件主题"</span><span class="token punctuation">;</span>
            email<span class="token punctuation">.</span>Body <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MessageBody</span><span class="token punctuation">(</span><span class="token string">"邮件内容"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            email<span class="token punctuation">.</span>ToRecipients<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>receiverEmail<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 发送邮件</span>
            email<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"邮件发送成功！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"邮件发送失败："</span> <span class="token operator">+</span> ex<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h4><a id="__402"></a>② 读取收件箱</h4> 
<p>Exchange服务器提供了丰富的API来访问和管理邮箱数据，包括读取收件箱中的邮件。通过EWS或其他API，可以检索收件箱中的邮件，并对其进行操作，如查看、删除等。<br> 以下是使用C#使用Exchange服务读取收件箱的代码示例：</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>Exchange<span class="token punctuation">.</span>WebServices<span class="token punctuation">.</span>Data</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 设置Exchange服务器地址</span>
            <span class="token class-name"><span class="token keyword">string</span></span> exchangeServerUrl <span class="token operator">=</span> <span class="token string">"https://your-exchange-server-url.com/EWS/Exchange.asmx"</span><span class="token punctuation">;</span>

            <span class="token comment">// 设置邮箱地址和密码</span>
            <span class="token class-name"><span class="token keyword">string</span></span> userEmail <span class="token operator">=</span> <span class="token string">"your-email@example.com"</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span></span> userPassword <span class="token operator">=</span> <span class="token string">"your-password"</span><span class="token punctuation">;</span>

            <span class="token comment">// 创建Exchange服务对象</span>
            <span class="token class-name">ExchangeService</span> service <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ExchangeService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            service<span class="token punctuation">.</span>Url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Uri</span><span class="token punctuation">(</span>exchangeServerUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
            service<span class="token punctuation">.</span>Credentials <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">WebCredentials</span><span class="token punctuation">(</span>userEmail<span class="token punctuation">,</span> userPassword<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 获取收件箱中的邮件</span>
            <span class="token class-name">FindItemsResults<span class="token punctuation">&lt;</span>Item<span class="token punctuation">&gt;</span></span> findResults <span class="token operator">=</span> service<span class="token punctuation">.</span><span class="token function">FindItems</span><span class="token punctuation">(</span>WellKnownFolderName<span class="token punctuation">.</span>Inbox<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ItemView</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">Item</span> item <span class="token keyword">in</span> findResults<span class="token punctuation">.</span>Items<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 处理邮件</span>
                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"主题："</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>Subject<span class="token punctuation">)</span><span class="token punctuation">;</span>
                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"发件人："</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>From<span class="token punctuation">.</span>Address<span class="token punctuation">)</span><span class="token punctuation">;</span>
                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"时间："</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>DateTimeReceived<span class="token punctuation">)</span><span class="token punctuation">;</span>
                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"--------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"读取收件箱失败："</span> <span class="token operator">+</span> ex<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h3><a id="5_448"></a>5、其他方式</h3> 
<p>除了SMTP、POP、IMAP和Exchange之外，还有其他一些方式可以发送邮件，比如使用第三方邮件服务提供商的API、使用Socket编程直接与邮件服务器通信等。下面是其中一种常见的方式，使用第三方邮件服务提供商的API发送邮件的示例代码：</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Mail</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">SendGrid</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">SendGrid<span class="token punctuation">.</span>Helpers<span class="token punctuation">.</span>Mail</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">static</span> <span class="token keyword">async</span> <span class="token return-type class-name">System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks<span class="token punctuation">.</span>Task</span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 设置发送者的API的key</span>
            <span class="token class-name"><span class="token keyword">string</span></span> apiKey <span class="token operator">=</span> <span class="token string">"xxxxx"</span><span class="token punctuation">;</span>

            <span class="token comment">// 创建SendGrid客户端</span>
            <span class="token class-name"><span class="token keyword">var</span></span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SendGridClient</span><span class="token punctuation">(</span>apiKey<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 设置邮件内容</span>
            <span class="token class-name"><span class="token keyword">var</span></span> from <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">EmailAddress</span><span class="token punctuation">(</span><span class="token string">"sender@example.com"</span><span class="token punctuation">,</span> <span class="token string">"Example User"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">var</span></span> to <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">EmailAddress</span><span class="token punctuation">(</span><span class="token string">"recipient@example.com"</span><span class="token punctuation">,</span> <span class="token string">"Example User"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">var</span></span> subject <span class="token operator">=</span> <span class="token string">"Sending with SendGrid is Fun"</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">var</span></span> plainTextContent <span class="token operator">=</span> <span class="token string">"and easy to do anywhere, even with C#"</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">var</span></span> htmlContent <span class="token operator">=</span> <span class="token string">"&lt;strong&gt;and easy to do anywhere, even with C#&lt;/strong&gt;"</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">var</span></span> msg <span class="token operator">=</span> MailHelper<span class="token punctuation">.</span><span class="token function">CreateSingleEmail</span><span class="token punctuation">(</span>from<span class="token punctuation">,</span> to<span class="token punctuation">,</span> subject<span class="token punctuation">,</span> plainTextContent<span class="token punctuation">,</span> htmlContent<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 发送邮件</span>
            <span class="token class-name"><span class="token keyword">var</span></span> response <span class="token operator">=</span> <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">SendEmailAsync</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>

            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"邮件发送成功！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"邮件发送失败："</span> <span class="token operator">+</span> ex<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h2><a id="C_492"></a>三、C#发送邮件总结</h2> 
<p>本文介绍了C#开发中常用的操作邮箱的方法，包括使用SMTP协议发送邮件、通过POP3和IMAP协议接收邮件，以及利用Exchange服务器进行邮件的发送、接收和管理等。每种方法都配有相应的示例代码，帮助读者快速上手。</p> 
<p>无论是使用SMTP、POP3、IMAP、Exchange还是其他方式，C#都提供了丰富的API和工具来发送邮件。开发人员可以根据具体需求和环境选择适合的方式来发送邮件，实现邮件通知、交互等功能。在实际应用中，需要注意处理异常情况、确保邮件发送的安全性和稳定性。通过选择合适的发送方式并合理处理发送过程中可能遇到的问题，可以保证邮件发送的效率和可靠性。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d5d5495aa2564895ba171adf266a196b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MySQL 数据库中如何新增列</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a7c8a4ad5e0f80bdf83fc4015c86d976/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Flutter 在 Windows 下的开发环境搭建（Flutter SDK 3.19.2）【图文详细教程】</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>