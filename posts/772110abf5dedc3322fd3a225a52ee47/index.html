<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【MySQL】用户管理 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/772110abf5dedc3322fd3a225a52ee47/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【MySQL】用户管理">
  <meta property="og:description" content="用户管理 1.用户信息2.创建用户3.删除用户4.修改用户密码5.数据库的权限5.1给用户授权5.2回收权限 点赞👍👍收藏🌟🌟关注💖💖
你的支持是对我最大的鼓励，我们一起努力吧!😃😃
目前为止我们使用mysql都是用的root账号，但是不建议直接使用root进行mysql的操作。我们推荐使用普通用户对数据的访问。而root作为管理员可以对普通用户对应的权限进行设置和管理。如给张三和李四这样的普通用户权限设定后。就只能操作给你权限的库了。
1.用户信息 MySQL有自己的用户管理，用户管理也是表结构形式进行管理的。 MySQL对用户做管理，其实是一定要记录下来那些用户是允许使用MySQL的，所以MySQLl的信息也是在MySQLl内特定的表中被保存的。这张表就是在系统数据库mysql的user表中。
可以简单看一下，
User是用户名，
Host代表允许这个用户从那台机器上登录mysql ，localhost代表只允许这个root从本地直接登录mysql。
后面一大堆都是权限信息，后面说。
authentication_string是当前用户的密码
password_expried是密码是否过期
password_last_changed是密码更改时间
这里我们主要查看下面三列
select user,host,authentication_string from user; mysql和linux一样可以允许创建多个用户，这些用户都是普通用户，你可以给他们开账号，所谓在mysql内部给用户开账号，就是把用户的用户名，允许从哪里登录，以及用户的密码信息放在mysql中的user表里。然后就有了这个用户了。
如果我们现在想在mysql新建一个用户，有一个特点简单粗暴的方式，也不用后面学的专门的创建用户的sql语句。可以用inset 向这个user里面插入也是可以的。但是这太麻烦了。其实未来学的创建用户，删除用户，修改用户其实说到底就是在user表里做增加删除修改！
2.创建用户 语法：
create user &#39;用户名&#39;@&#39;登陆主机/ip&#39; identified by &#39;密码&#39;; 用户名 ，自己随意设置
登陆主机/ip，不能少，如果是本机登录是 localhost/127.0.0.1，远程登录等会说
然后后面要设置密码，后面密码会被hash加密保存到user表中。
这里新建用户的行为其实就是向mysql的user表里插入一条信息
然后就可以进行本地登录了，不过最好在登录之前进行一下内存的刷新。刚才不是创建用户，这个用户信息是在内存当中的。我们对这个信息进行一下刷新，保证它是有效的就可以了。
flush privileges; 现在普通用户就可以登录了，输入的是刚才设置的密码。
备注：可能实际在设置密码的时候，因为mysql本身的认证等级比较高，一些简单的密码无法设置，会爆出如下报错：
– ERROR 1819 (HY000): Your password does not satisfy the current policy requirements
可以参考这篇文章ERROR 1819 (HY000): Your password does not satisfy the current policy requirements
查看密码设置相关要求">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-29T09:43:42+08:00">
    <meta property="article:modified_time" content="2024-06-29T09:43:42+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【MySQL】用户管理</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>用户管理</h4> 
 <ul><li><a href="#1_11" rel="nofollow">1.用户信息</a></li><li><a href="#2_37" rel="nofollow">2.创建用户</a></li><li><a href="#3_86" rel="nofollow">3.删除用户</a></li><li><a href="#4_103" rel="nofollow">4.修改用户密码</a></li><li><a href="#5_123" rel="nofollow">5.数据库的权限</a></li><li><ul><li><a href="#51_137" rel="nofollow">5.1给用户授权</a></li><li><a href="#52_185" rel="nofollow">5.2回收权限</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<p><img src="https://images2.imgbox.com/a5/bf/YLe1fHp0_o.jpg" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>点赞</strong>👍👍<strong>收藏</strong>🌟🌟<strong>关注</strong>💖💖<br> <font color="red"><strong>你的支持是对我最大的鼓励，我们一起努力吧!😃😃</strong></font></p> 
</blockquote> 
<p>目前为止我们使用mysql都是用的root账号，但是不建议直接使用root进行mysql的操作。我们推荐使用普通用户对数据的访问。而root作为管理员可以对普通用户对应的权限进行设置和管理。如给张三和李四这样的普通用户权限设定后。就只能操作给你权限的库了。</p> 
<p><img src="https://images2.imgbox.com/38/88/BRS0PDxG_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="1_11"></a>1.用户信息</h2> 
<p>MySQL有自己的用户管理，用户管理也是表结构形式进行管理的。 MySQL对用户做管理，其实是一定要记录下来那些用户是允许使用MySQL的，所以MySQLl的信息也是在MySQLl内特定的表中被保存的。这张表就是在系统数据库mysql的user表中。</p> 
<p><img src="https://images2.imgbox.com/d9/6d/3hOTMuWl_o.png" alt="在这里插入图片描述"></p> 
<p>可以简单看一下，<br> <strong>User</strong>是用户名，<br> <strong>Host</strong>代表允许这个用户从那台机器上登录mysql ，localhost代表只允许这个root从本地直接登录mysql。<br> 后面一大堆都是权限信息，后面说。<br> <strong>authentication_string</strong>是当前用户的密码<br> <strong>password_expried</strong>是密码是否过期<br> <strong>password_last_changed</strong>是密码更改时间</p> 
<p><img src="https://images2.imgbox.com/cd/c7/FkWB5rYG_o.png" alt="在这里插入图片描述"></p> 
<p>这里我们主要查看下面三列</p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> user<span class="token punctuation">,</span>host<span class="token punctuation">,</span>authentication_string <span class="token keyword">from</span> user<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d3/f3/l0wZgAGw_o.png" alt="在这里插入图片描述"></p> 
<p>mysql和linux一样可以允许创建多个用户，这些用户都是普通用户，你可以给他们开账号，所谓在mysql内部给用户开账号，就是把用户的用户名，允许从哪里登录，以及用户的密码信息放在mysql中的user表里。然后就有了这个用户了。</p> 
<p>如果我们现在想在mysql新建一个用户，有一个特点简单粗暴的方式，也不用后面学的专门的创建用户的sql语句。可以用inset 向这个user里面插入也是可以的。但是这太麻烦了。其实未来学的创建用户，删除用户，修改用户其实说到底就是在user表里做增加删除修改！</p> 
<h2><a id="2_37"></a>2.创建用户</h2> 
<p>语法：</p> 
<pre><code class="prism language-powershell">create user <span class="token string">'用户名'</span>@<span class="token string">'登陆主机/ip'</span> identified by <span class="token string">'密码'</span><span class="token punctuation">;</span>
</code></pre> 
<p>用户名 ，自己随意设置<br> 登陆主机/ip，不能少，如果是<strong>本机登录是 localhost/127.0.0.1，远程登录等会说</strong><br> 然后后面要设置密码，后面密码会被hash加密保存到user表中。</p> 
<p>这里新建用户的行为其实就是向mysql的user表里插入一条信息</p> 
<p><img src="https://images2.imgbox.com/4d/f1/zEGajdHW_o.png" alt="在这里插入图片描述"></p> 
<p>然后就可以进行本地登录了，不过最好在登录之前进行一下内存的刷新。刚才不是创建用户，这个用户信息是在内存当中的。我们对这个信息进行一下刷新，保证它是有效的就可以了。</p> 
<pre><code class="prism language-powershell">flush privileges<span class="token punctuation">;</span>
</code></pre> 
<p>现在普通用户就可以登录了，输入的是刚才设置的密码。</p> 
<p><img src="https://images2.imgbox.com/25/8c/7nyBEzCi_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>备注：可能实际在设置密码的时候，因为mysql本身的认证等级比较高，一些简单的密码无法设置，会爆出如下报错：</p> 
</blockquote> 
<p>– ERROR 1819 (HY000): Your password does not satisfy the current policy requirements</p> 
<p>可以参考这篇文章<a href="https://blog.csdn.net/hello_world_qwp/article/details/79551789">ERROR 1819 (HY000): Your password does not satisfy the current policy requirements</a></p> 
<p>查看密码设置相关要求</p> 
<pre><code class="prism language-powershell">SHOW VARIABLES LIKE <span class="token string">'validate_password%'</span><span class="token punctuation">;</span>
</code></pre> 
<p>注意上面新建的用户是不能够进行远程登录mysql的。那如何创建一个可以进行远程登录的用户呢？非常简单。</p> 
<p><strong>远程登录可以把允许从那台主机登录写成%</strong>，因为我们目前用的都是windows下的IP地址，目前我们也就一台云服务器，公网ip设上也没有用。那有人说我把允许从那台主机上登录换成windows ip地址行不行呢？不行！windows下的ip地址是私有IP，在经过公网转发的时候会被NAT路由器替换。所以在这里设计具体IP地址没有任何意义。所以直接用 <strong>%，代表是允许wdl这个用户可以从任意主机处登录。</strong> 注意在数据库里，一般禁止直接带%。如果非得让他登录就必须明确限定出来这个用户允许从那台主机登录。</p> 
<pre><code class="prism language-powershell">create user <span class="token string">'wdl'</span>@<span class="token string">'%'</span> identified by <span class="token string">'密码'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/fc/d7/5jitunLn_o.png" alt="在这里插入图片描述"></p> 
<p>注意这里在mysql命令行上下翻的时候，涉及到密码的都不会被mysqk记录下来。</p> 
<p>注意MySQL的端口号一定不能出现在公网上，MySQL的端口号以及整体服务是要在内网上被进行相关访问的。</p> 
<h2><a id="3_86"></a>3.删除用户</h2> 
<p>语法：</p> 
<pre><code class="prism language-powershell">drop user <span class="token string">'用户名'</span>@<span class="token string">'主机名'</span>
</code></pre> 
<p>注意直接给个用户名，不能删除，它默认是%，表示所有地方可以登陆的用户。必须要在删的时候清楚告诉mysql你删的这个人它是在哪台机器上的。相当于USER和HOST两列合起来才是一个用户，它必须得是完整的！</p> 
<p><img src="https://images2.imgbox.com/70/b2/g6fKLJbQ_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-powershell">drop user wdl@localhost<span class="token punctuation">;</span>
</code></pre> 
<p>也可不带‘ ’</p> 
<p><img src="https://images2.imgbox.com/06/b4/WHyuksqZ_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="4_103"></a>4.修改用户密码</h2> 
<p>语法：<br> 自己改自己密码</p> 
<pre><code class="prism language-powershell"><span class="token function">set</span> password=password<span class="token punctuation">(</span><span class="token string">'新的密码'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>root用户修改指定用户的密码</p> 
<pre><code class="prism language-powershell"><span class="token function">set</span> password <span class="token keyword">for</span> <span class="token string">'用户名'</span>@<span class="token string">'主机名'</span>=password<span class="token punctuation">(</span><span class="token string">'新的密码'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/fa/71/iBvLpxpZ_o.png" alt="在这里插入图片描述"></p> 
<p>甚至还可以用update更用户密码，所以不要被创建用户这些负责语句唬住了，它们的核心工作就是对这个user做增删查改。</p> 
<p><img src="https://images2.imgbox.com/64/d0/Z19epqOn_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="5_123"></a>5.数据库的权限</h2> 
<p>当我们在MySQL中把一个用户创建好了，不是就所有工作做好了，而是说把用户创建好了 ，用户还要有他对应的权限也要处理的。</p> 
<p>MySQL数据库提供的权限列表：</p> 
<p><img src="https://images2.imgbox.com/fb/4f/wiGhasaU_o.png" alt="在这里插入图片描述"></p> 
<p>当前新建的用户只能看到这一个数据库。</p> 
<p><img src="https://images2.imgbox.com/86/9c/5f7FcRFN_o.png" alt="在这里插入图片描述"></p> 
<p>下面给新建用户授权，对新用户做相关限制。</p> 
<h3><a id="51_137"></a>5.1给用户授权</h3> 
<p>语法:</p> 
<pre><code class="prism language-powershell">grant 权限列表 on 库<span class="token punctuation">.</span>对象名 to <span class="token string">'用户名'</span>@<span class="token string">'登陆位置'</span> <span class="token punctuation">[</span>identified by <span class="token string">'密码'</span><span class="token punctuation">]</span>
</code></pre> 
<p>库就是那个数据库，对象名就是那个表，说白了你这个权限是对哪一个数据库下的那一张表设置。</p> 
<p>说明：</p> 
<ul><li>权限列表，多个权限用逗号分开</li></ul> 
<blockquote> 
 <p>grant select on …<br> grant select, delete, create on …<br> grant all [privileges] on … – 表示赋予该用户在该对象上的所有权限</p> 
</blockquote> 
<ul><li>*. * : 代表本系统中的所有数据库的所有对象（表，视图，存储过程等）</li><li>库.* : 表示某个数据库中的所有数据对象(表，视图，存储过程等)</li><li>identified by可选。 如果用户存在，赋予权限的同时修改密码,如果该用户不存在，就是创建用户</li></ul> 
<p>首先root建立一个数据库，因为目前还没有给新用户授权所以当前看不到这个数据库</p> 
<p><img src="https://images2.imgbox.com/bf/09/AluBjmnS_o.png" alt="在这里插入图片描述"></p> 
<p>root创建一张表插入两条记录，然后新用户使用这张表的时候，报错的是权限拒绝，虽然从上帝视角看到是有这张表的，但是不让进去。一是不知道有这个数据库，二他也没有权限进去。</p> 
<p><img src="https://images2.imgbox.com/de/15/Nqa0odnz_o.png" alt="在这里插入图片描述"></p> 
<p>下面就给这个新用户这个权限</p> 
<p>给了新用户权限后就可以看了，</p> 
<p><img src="https://images2.imgbox.com/3a/a3/yyxnAPtt_o.png" alt="在这里插入图片描述"></p> 
<p><strong>查看给用户的权限都有哪些</strong></p> 
<pre><code class="prism language-powershell">show grants <span class="token keyword">for</span> <span class="token string">'wdl'</span>@<span class="token string">'%'</span><span class="token punctuation">;</span>
</code></pre> 
<p>可以看到给当前用户的权限是所有的权限</p> 
<p><img src="https://images2.imgbox.com/36/16/pcoBbsHo_o.png" alt="在这里插入图片描述"></p> 
<p>所有新用户也是可以对表进行插入的</p> 
<p><img src="https://images2.imgbox.com/f2/e4/d0QrV4RM_o.png" alt="在这里插入图片描述"></p> 
<p>那我现在想把它插入权限去掉不让他插入，就可以去掉他对应的权限。</p> 
<h3><a id="52_185"></a>5.2回收权限</h3> 
<p>语法：</p> 
<pre><code class="prism language-powershell">revoke 权限列表 on 库<span class="token punctuation">.</span>对象名 <span class="token keyword">from</span> <span class="token string">'用户名'</span>@<span class="token string">'登陆位置'</span><span class="token punctuation">;</span>
</code></pre> 
<p>去掉用户的插入权限。去掉之后发现以前就一个all，怎么回收一个权限这里就变这么长了。但你会发现这里的权限少了insert。</p> 
<p><img src="https://images2.imgbox.com/67/31/OmllKQ4O_o.png" alt="在这里插入图片描述"></p> 
<p>我们发现当前用户是可以删除的，但是就是不能插入了！插入没有权限了。</p> 
<p><img src="https://images2.imgbox.com/0d/b0/9HyvlqUr_o.png" alt="在这里插入图片描述"></p> 
<p>同样也可以把删除权限去掉，用户也不可以删了</p> 
<p><img src="https://images2.imgbox.com/c2/e0/iH3L70P2_o.png" alt="在这里插入图片描述"></p> 
<p>现在我们可以把用户所有权限都取消。发现用户不能查看这个user表了，甚至这个数据库都看不到了</p> 
<p><img src="https://images2.imgbox.com/28/62/Hin9Ejpk_o.png" alt="在这里插入图片描述"></p> 
<p>这就是给用户赋权，给用户赋上对应的权限，用户就可以看到数据库以及数据库的表，如果取消了对应的权限，那对数据库表某些操作就不能做了，如果取消所有权限，那数据库以及表都看不到了。</p> 
<p>给用户什么权限就只能做对应的对应的操作。</p> 
<p><img src="https://images2.imgbox.com/a3/3f/aqpkcyf6_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e05a719cd061fe0438804294818220b6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Python酷库之旅-第三方库openpyxl(07)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/879972b236d4c6ccf0526728e7ff1bb6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">发现传统之美，AI赋能非遗传承</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>