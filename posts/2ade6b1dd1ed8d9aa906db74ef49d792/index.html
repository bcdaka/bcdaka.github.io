<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>WebLogic：管理控制台中常用超时配置项的分析与说明 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/2ade6b1dd1ed8d9aa906db74ef49d792/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="WebLogic：管理控制台中常用超时配置项的分析与说明">
  <meta property="og:description" content="一、超时参数 WebLogic作为服务器端，其控制台中部分常用的与超时相关配置项如下：
1、登录超时
MBean属性：ServerMBean.LoginTimeoutMillis
控制台中的位置：【环境】-&gt;【服务器】-&gt;【&lt;应用服务器名&gt;】-&gt;【配置】-&gt;【优化】
2、空闲连接超时
MBean属性：ServerMBean.IdleConncetionTimeout
控制台中的位置：【环境】-&gt;【服务器】-&gt;【&lt;应用服务器名&gt;】-&gt;【协议】-&gt;【一般信息】
3、完整消息超时
MBean属性：ServerMBean.CompleteMessageTimeout
控制台中的位置：【环境】-&gt;【服务器】-&gt;【&lt;应用服务器名&gt;】-&gt;【协议】-&gt;【一般信息】
4、连接保活超时
MBean属性：WebServerMBean.KeepAliveSecs
控制台中的位置：【环境】-&gt;【服务器】-&gt;【&lt;应用服务器名&gt;】-&gt;【协议】-&gt;【HTTP】
5、POST报文处理超时
MBean属性：WebServerMBean.PostTimeoutSecs
控制台中的位置：【环境】-&gt;【服务器】-&gt;【&lt;应用服务器名&gt;】-&gt;【协议】-&gt;【HTTP】
下面将以WebLogic12.2.1.4.0为例，逐一分析这些配置项是什么意思，以及如何使用。
1、登录超时 官方解释：
The login timeout for this server&#39;s default regular (non-SSL) listen port. This is the maximum amount of time allowed for a new connection to establish.
A value of 0 indicates there is no maximum.
MBean Attribute:
ServerMBean.LoginTimeoutMillis Minimum value: 0 Maximum value: 100000 Secure value: 5000
https://docs.oracle.com/en/middleware/fusion-middleware/weblogic-server/12.2.1.4/wlach/pagehelp/Corecoreserverserverconfigtuningtitle.html#attributes
代码分析：
1）com.oracle.weblogic.server.channels.jar">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-05T15:59:38+08:00">
    <meta property="article:modified_time" content="2024-03-05T15:59:38+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">WebLogic：管理控制台中常用超时配置项的分析与说明</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>一、超时参数</h2> 
<p>WebLogic作为服务器端，其控制台中部分常用的与超时相关配置项如下：</p> 
<p>1、登录超时</p> 
<blockquote> 
 <p>MBean属性：ServerMBean.LoginTimeoutMillis<br> 控制台中的位置：【环境】-&gt;【服务器】-&gt;【&lt;应用服务器名&gt;】-&gt;【配置】-&gt;【优化】</p> 
</blockquote> 
<p>2、空闲连接超时</p> 
<blockquote> 
 <p>MBean属性：ServerMBean.IdleConncetionTimeout<br> 控制台中的位置：【环境】-&gt;【服务器】-&gt;【&lt;应用服务器名&gt;】-&gt;【协议】-&gt;【一般信息】</p> 
</blockquote> 
<p>3、完整消息超时</p> 
<blockquote> 
 <p>MBean属性：ServerMBean.CompleteMessageTimeout<br> 控制台中的位置：【环境】-&gt;【服务器】-&gt;【&lt;应用服务器名&gt;】-&gt;【协议】-&gt;【一般信息】</p> 
</blockquote> 
<p>4、连接保活超时</p> 
<blockquote> 
 <p>MBean属性：WebServerMBean.KeepAliveSecs<br> 控制台中的位置：【环境】-&gt;【服务器】-&gt;【&lt;应用服务器名&gt;】-&gt;【协议】-&gt;【HTTP】</p> 
</blockquote> 
<p>5、POST报文处理超时</p> 
<blockquote> 
 <p>MBean属性：WebServerMBean.PostTimeoutSecs<br> 控制台中的位置：【环境】-&gt;【服务器】-&gt;【&lt;应用服务器名&gt;】-&gt;【协议】-&gt;【HTTP】</p> 
</blockquote> 
<p>下面将以WebLogic12.2.1.4.0为例，逐一分析这些配置项是什么意思，以及如何使用。</p> 
<h3 style="margin-left:.0001pt;text-align:justify;">1、登录超时</h3> 
<p style="margin-left:.0001pt;text-align:justify;">官方解释：</p> 
<blockquote> 
 <p style="margin-left:0;text-align:left;">The login timeout for this server's default regular (non-SSL) listen port. This is the maximum amount of time allowed for a new connection to establish.</p> 
 <p style="margin-left:0;text-align:left;">A value of 0 indicates there is no maximum.</p> 
 <p style="margin-left:0;text-align:left;">MBean Attribute:<br><a href="#LoginTimeoutMillis" rel="nofollow"><u><span style="color:#0000ff;"><u>ServerMBean.LoginTimeoutMillis</u></span></u></a> </p> 
 <p style="margin-left:0;text-align:left;">Minimum value: 0 </p> 
 <p style="margin-left:0;text-align:left;">Maximum value: 100000 </p> 
 <p style="margin-left:.0001pt;text-align:justify;">Secure value: 5000</p> 
</blockquote> 
<p style="margin-left:.0001pt;text-align:justify;">https://docs.oracle.com/en/middleware/fusion-middleware/weblogic-server/12.2.1.4/wlach/pagehelp/Corecoreserverserverconfigtuningtitle.html#attributes</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">代码分析：</p> 
<p>1）com.oracle.weblogic.server.channels.jar<br> ----weblogic.server.channels.ServerSocketManager</p> 
<p><img alt="" height="108" src="https://images2.imgbox.com/f9/8d/4cNz2s8B_o.png" width="681"></p> 
<p style="margin-left:.0001pt;text-align:justify;">创建线程运行ServerSocket，准备接收新的连接请求。</p> 
<p>2）com.oracle.weblogic.server.channels.jar<br> ----weblogic.server.channels.ServerListenThread</p> 
<p><img alt="" height="766" src="https://images2.imgbox.com/b1/0b/1D2Zhl8I_o.png" width="679"></p> 
<p style="margin-left:.0001pt;text-align:justify;">线程循环运行，用于接收新的连接。</p> 
<p style="margin-left:.0001pt;text-align:justify;">3）com.oracle.weblogic.server.channels.jar<br> ----weblogic.server.channels.ServerSocketWrapper</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="239" src="https://images2.imgbox.com/cf/df/SmzV3Co1_o.png" width="681"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="164" src="https://images2.imgbox.com/88/4d/aXCpw4lB_o.png" width="656"></p> 
<p style="margin-left:.0001pt;text-align:justify;">     从代码中可以看到，接收连接并创建新socket后，调用Socket.setSoTimeout(int timeout)设置socket的读超时时间时，使用的正是loginTimeout的值。所以<span style="color:#511b78;"><strong>“登录时间”实际就是socket的读超时时间</strong></span>。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="221" src="https://images2.imgbox.com/6a/15/7J1rhYqj_o.png" width="705"></p> 
<p style="margin-left:.0001pt;text-align:justify;">   另外需要说明一下，loginTimeout的值是从ServerChannelImpl中获取到的。而ServerChannelImpl在创建时会设置NetworkAccessPointMBean，而NetworkAccessPointMBean是从ServerMBean中获取的。因此这里loginTimeout的值就是ServerMBean.LoginTimeoutMillis的值。</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<h3 style="margin-left:.0001pt;text-align:justify;">2、空闲连接超时</h3> 
<p style="margin-left:.0001pt;text-align:justify;">官方解释：</p> 
<blockquote> 
 <p style="margin-left:0;text-align:left;">The maximum number of seconds that a connection is allowed to be idle before it is closed by the server. The T3 and T3S protocols ignore this attribute. If you configure network channels for this server, each channel can override this idle connection message timeout.</p> 
 <p style="margin-left:0;text-align:left;">This timeout helps guard against server deadlock through too many open connections.</p> 
 <p style="margin-left:0;text-align:left;">MBean Attribute:<br><a href="#IdleConnectionTimeout" rel="nofollow"><u><span style="color:#0000ff;"><u>ServerMBean.IdleConnectionTimeout</u></span></u></a> </p> 
 <p style="margin-left:0;text-align:left;">Minimum value: 0 </p> 
 <p style="margin-left:.0001pt;text-align:justify;">Secure value: 65 </p> 
</blockquote> 
<p style="margin-left:.0001pt;text-align:justify;">https://docs.oracle.com/en/middleware/fusion-middleware/weblogic-server/12.2.1.4/wlach/pagehelp/Corecoreserverserverprotocolsgeneraltitle.html</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">代码分析：</p> 
<p style="margin-left:.0001pt;text-align:justify;">代码中会将这个属性改成另外一个名字，在后面的代码分析中会看到。</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<h3 style="margin-left:.0001pt;text-align:justify;">3、完整消息超时</h3> 
<p style="margin-left:.0001pt;text-align:justify;">官方解释：</p> 
<blockquote> 
 <p style="margin-left:0;text-align:left;">The maximum number of seconds that this server waits for a complete message to be received. If you configure network channels for this server, each channel can override this message timeout.</p> 
 <p style="margin-left:0;text-align:left;">This timeout helps guard against a denial of service attack in which a caller indicates that it will be sending a message of a certain size which it never finishes sending.</p> 
 <p style="margin-left:0;text-align:left;">CompleteMessageTimeout affects the HTTP Response, such that if WebLogic Server discovers sockets inactive for longer than the CompleteMessageTimeout, the server will close these sockets.</p> 
 <p style="margin-left:0;text-align:left;">MBean Attribute:<br><a href="#CompleteMessageTimeout" rel="nofollow"><u><span style="color:#0000ff;"><u>ServerMBean.CompleteMessageTimeout</u></span></u></a> </p> 
 <p style="margin-left:0;text-align:left;">Minimum value: 0 </p> 
 <p style="margin-left:.0001pt;text-align:justify;">Maximum value: 480 </p> 
</blockquote> 
<p style="margin-left:.0001pt;text-align:justify;">https://docs.oracle.com/en/middleware/fusion-middleware/weblogic-server/12.2.1.4/wlach/pagehelp/Corecoreserverserverprotocolsgeneraltitle.html</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">代码分析：</p> 
<p style="margin-left:.0001pt;text-align:justify;">1）com.oracle.weblogic.socket.jar<br> ----weblogic.socket.BaseAbstractMuxableSocket</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="107" src="https://images2.imgbox.com/77/32/ehngBueC_o.png" width="515"></p> 
<p style="margin-left:.0001pt;text-align:justify;">IdleConnectionTimeout会转换成IdleTimeoutMillis属性，属性名发生了变化。<br> CompleteMessageTimout会转换成CompleteMessageTimoutMillis属性，属性名未变化。</p> 
<p>2）com.oracle.weblogic.server.muxer.jar<br> ----weblogic.socket.SocketMuxer.TimerListenerImpl</p> 
<p><img alt="" height="183" src="https://images2.imgbox.com/b5/66/Izo3jY1m_o.png" width="609"></p> 
<p style="margin-left:.0001pt;text-align:justify;">以上2个属性会在TimerListener中用到，TimerListener会定期清理符合以下条件的socket：</p> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">(1).空闲超过一定时间的socket</p> 
 <p style="margin-left:.0001pt;text-align:justify;">(2).报文没有接收完但在一段时间内又没有接收到新的报文的socket</p> 
</blockquote> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="150" src="https://images2.imgbox.com/e4/f5/npOhbZYs_o.png" width="1200"></p> 
<p>TimerListener会每5秒执行一次。</p> 
<p></p> 
<h3 style="margin-left:.0001pt;text-align:justify;">4、连接保活超时</h3> 
<p style="margin-left:.0001pt;text-align:justify;">官方解释：</p> 
<blockquote> 
 <p style="margin-left:0;text-align:left;">The amount of time this server waits before closing an inactive HTTP connection.</p> 
 <p style="margin-left:0;text-align:left;">Number of seconds to maintain HTTP keep-alive before timing out the request.</p> 
 <p style="margin-left:0;text-align:left;">MBean Attribute:<br><a href="#KeepAliveSecs" rel="nofollow"><u><span style="color:#0000ff;"><u>WebServerMBean.KeepAliveSecs</u></span></u></a> </p> 
 <p style="margin-left:0;text-align:left;">Minimum value: 5 </p> 
 <p style="margin-left:0;text-align:left;">Maximum value: 3600 </p> 
 <p style="margin-left:.0001pt;text-align:justify;">Secure value: 30 </p> 
</blockquote> 
<p style="margin-left:.0001pt;text-align:justify;">https://docs.oracle.com/en/middleware/fusion-middleware/weblogic-server/12.2.1.4/wlach/pagehelp/Corecoreserverserverprotocolshttptitle.html</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">代码分析：</p> 
<p>1）com.oracle.weblogic.servlet.jar<br> ----weblogic.servlet.internal.MuxableSocketHTTP</p> 
<p><img alt="" height="65" src="https://images2.imgbox.com/be/1e/bOJt0bSh_o.png" width="488"></p> 
<p style="margin-left:.0001pt;text-align:justify;">    KeepAliveSecs会转换成IdleTimeoutMillis属性。即如果处理的是HTTP协议的请求，IdleTimeoutMillis会使用KeepAliveSecs的值，如果不是HTTP协议，则使用通用属性IdleConncetionTimeout的值。</p> 
<p style="margin-left:.0001pt;text-align:justify;">       从这里也可以看出来，WebLogic的一些配置参数是分级的，第一级是通用配置，第二级是专用配置，如果一些专用协议有自身需要的配置参数值，那就单独配置，并覆盖通用配置的参数值。</p> 
<p style="margin-left:.0001pt;text-align:justify;">      另外，官方给这个属性的名字是“持续时间”，感觉不太准确，叫“连接保活超时”应该更准确些。</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<h3 style="margin-left:.0001pt;text-align:justify;">5、POST报文处理超时</h3> 
<p style="margin-left:.0001pt;text-align:justify;">官方解释：</p> 
<blockquote> 
 <p style="margin-left:0;text-align:left;">Timeout (in seconds) for reading HTTP POST data in a servlet request. If the POST data is chunked, the amount of time the server waits between the end of receiving the last chunk of data and the end of receiving the next chunk of data in an HTTP POST before it times out. (This is used to prevent denial-of-service attacks that attempt to overload the server with POST data.)</p> 
 <p style="margin-left:0;text-align:left;">Gets the postTimeoutSecs attribute of the WebServerMBean object</p> 
 <p style="margin-left:0;text-align:left;">MBean Attribute:<br><a href="#PostTimeoutSecs" rel="nofollow"><u><span style="color:#0000ff;"><u>WebServerMBean.PostTimeoutSecs</u></span></u></a> </p> 
 <p style="margin-left:0;text-align:left;">Minimum value: 0 </p> 
 <p style="margin-left:0;text-align:left;">Maximum value: 120 </p> 
 <p style="margin-left:.0001pt;text-align:justify;">Secure value: 30 </p> 
</blockquote> 
<p style="margin-left:.0001pt;text-align:justify;">https://docs.oracle.com/en/middleware/fusion-middleware/weblogic-server/12.2.1.4/wlach/pagehelp/Corecoreserverserverprotocolshttptitle.html</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">代码分析：</p> 
<p style="margin-left:.0001pt;text-align:justify;">   这里要注意，PostTimoutSecs没有转换成CompleteMessageTimoutMillis属性，CompleteMessageTimoutMillis属性仍是采用通用配置项CompleteMessageTimout的值。</p> 
<p style="margin-left:.0001pt;text-align:justify;">1）com.oracle.weblogic.servlet.jar<br> ----weblogic.servlet.internal.HttpConnectionHandler</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="88" src="https://images2.imgbox.com/71/18/mfeMaCAW_o.png" width="681"></p> 
<p>2）com.oracle.weblogic.servlet.jar<br> ----weblogic.servlet.internal.MuxableSocketHTTP</p> 
<p><img alt="" height="56" src="https://images2.imgbox.com/c0/e5/6EmTttPA_o.png" width="546"></p> 
<p>3）com.oracle.weblogic.socket.jar<br> ----weblogic.socket.BaseAbstractMuxableSocket </p> 
<p><img alt="" height="95" src="https://images2.imgbox.com/fb/11/Xh22iiQm_o.png" width="453"></p> 
<p style="margin-left:.0001pt;text-align:justify;">从这里可以看到，socket.soTimeout的值是直接设置的PostTimoutSecs的值。</p> 
<p style="margin-left:.0001pt;text-align:justify;">    这里引出一个新的问题，到底Socket的soTimeout的值是用的LoginTimeout的值还是PostTimoutSecs的值？</p> 
<p style="margin-left:.0001pt;text-align:justify;">    实际上这里是分处理阶段的，当socket刚创建时，用的是LoginTimeout的值，但解析出部分报文后，发现这个报文是HTTP协议的，于是再将socket设置成PostTimoutSecs的值。</p> 
<p></p> 
<h2>二、总结</h2> 
<h3>1、涉及到的jar</h3> 
<p>以上代码分析涉及到的jar如下：<br> com.oracle.weblogic.server.jar<br> com.oracle.weblogic.server.channels.jar<br> com.oracle.weblogic.server.channels-api.jar<br> com.oracle.weblogic.server.muxer.jar<br> com.oracle.weblogic.socket.jar<br> com.oracle.weblogic.socket.api.jar<br> com.oracle.weblogic.servlet.jar<br> com.oracle.weblogic.kernel.jar<br> com.oracle.weblogic.management.base.jar<br> com.oracle.weblogic.management.beanimpl.jar<br> com.oracle.weblogic.management.config.api.jar</p> 
<h3>2、处理流程</h3> 
<p>1）当Weblogic启动后创建TimerListener，并使用专门的线程运行它。它会每隔5秒找出空闲连接超时和完整消息超时的socket，找出后主动关闭socket。</p> 
<p>2）当新的连接请求发送到Weblogic后，如果没有空闲连接则会创建新的socket，新的socket的soTimeout值使用LoginTimeoutMillis的值。</p> 
<p>3）当解析部分报文后发现此报文为HTTP协议，则使用KeepAliveSecs作为空闲连接超时，并使用PostTimeoutSec重新设置socket的soTimeout的值。</p> 
<p></p> 
<p></p> 
<p>参考文档</p> 
<p><a class="link-info" href="https://docs.oracle.com/middleware/1221/wls/WLAPI/index.html?weblogic/management/configuration/KernelMBean.html" rel="nofollow" title="https://docs.oracle.com/middleware/1221/wls/WLAPI/index.html?weblogic/management/configuration/KernelMBean.html">https://docs.oracle.com/middleware/1221/wls/WLAPI/index.html?weblogic/management/configuration/KernelMBean.html</a><br><a class="link-info" href="https://docs.oracle.com/middleware/1221/wls/WLAPI/index.html?weblogic/management/configuration/ServerMBean.html" rel="nofollow" title="https://docs.oracle.com/middleware/1221/wls/WLAPI/index.html?weblogic/management/configuration/ServerMBean.html">https://docs.oracle.com/middleware/1221/wls/WLAPI/index.html?weblogic/management/configuration/ServerMBean.html</a><br><a class="link-info" href="https://docs.oracle.com/middleware/1213/wls/WLMBR/core/index.html" rel="nofollow" title="https://docs.oracle.com/middleware/1213/wls/WLMBR/core/index.html">https://docs.oracle.com/middleware/1213/wls/WLMBR/core/index.html</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7813c994ca0463c00e02794b37598089/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">2024年MySQL 下载、安装及启动停止教程（非常详细），涉及命令行net start mysql80提示发生系统错误5的解决方案</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5cb9942030ded135b472241c1c1eb82d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">JDK收费的各个版本（记录一下）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>