<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android Studio连接MySQL8.0 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/c20c4ee204cefaf3debba572338630f0/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Android Studio连接MySQL8.0">
  <meta property="og:description" content="【序言】
移动平台这个课程要做一个app的课设，我打算后期增加功能改成毕设，就想要使用MySQL来作为数据库，相对于SQLlite来说，我更熟悉MySQL一点。
【遇到的问题】
一直无法连接上数据库，开始的时候查了很多资料，说是MySQL8.0版本比较高，密码验证插件是caching_sha2_password，Android Studio中的JDBC驱动可能不支持这种加密方式。（但我并不确定是否是这个原因，就是一直连不上）
我最开始用的是下面的代码（连接数据库）：
private static final String TAG=&#34;DBUtils&#34;;// 用于日志打印 private static Connection conn=null;// 定义连接变量conn //数据库连接函数 public static Connection getConnection(String dbname) {//定义connection类函数，需要返回一个connection对象，即在上面定义的conn String ip = &#34;192.168.0.146&#34;;//ip地址，win&#43;R，输入cmd打开控制台，输入ipconfig /all查看本机ipv4地址,最上面那个 int port = 3306;//MySQL安装时的默认端口号，无需更改 String user = &#34;root&#34;;//打开Navicat，点击用户，如果显示root@localhost，请修改为root@%或新加一个root@%，%表示任意，任意ip地址都可以连接 String password = &#34;123456&#34;;//密码 String url = &#34;jdbc:mysql://172.19.221.130:3306/course_design?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=true&#34;; // &#34;?useUnicode=true&amp;characterEncoding=UTF-8&#34;添加中文信息时不会乱码 // 注册JDBC驱动的固定语句 try { Class.forName(&#34;com.mysql.jdbc.Driver&#34;);//这是一个目录，你可以找到这个目录点进去就懂了 Log.d(TAG, &#34;加载JDBC驱动成功&#34;); } catch (ClassNotFoundException e) { Log.d(TAG, &#34;加载JDBC驱动失败&#34;); } // 创建与mysql的连接对象conn,当然你也可以直接把上面定义的那些变量url的值直接写进去，就不用上面写一堆定义 try { conn = DriverManager.getConnection(url, user, password); System.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-11T15:41:15+08:00">
    <meta property="article:modified_time" content="2024-05-11T15:41:15+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android Studio连接MySQL8.0</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>【序言】</strong></p> 
<p>        移动平台这个课程要做一个app的课设，我打算后期增加功能改成毕设，就想要使用MySQL来作为数据库，相对于SQLlite来说，我更熟悉MySQL一点。</p> 
<p><strong>【遇到的问题】</strong></p> 
<p>        一直无法连接上数据库，开始的时候查了很多资料，说是MySQL8.0版本比较高，密码验证插件是caching_sha2_password，Android Studio中的JDBC驱动可能不支持这种加密方式。（但我并不确定是否是这个原因，就是一直连不上）</p> 
<p>我最开始用的是下面的代码（连接数据库）：</p> 
<pre><code class="language-java">    private static final String  TAG="DBUtils";//    用于日志打印
    private static Connection conn=null;//    定义连接变量conn
    //数据库连接函数
    public static Connection getConnection(String dbname) {//定义connection类函数，需要返回一个connection对象，即在上面定义的conn

        String ip = "192.168.0.146";//ip地址，win+R，输入cmd打开控制台，输入ipconfig /all查看本机ipv4地址,最上面那个
        int port = 3306;//MySQL安装时的默认端口号，无需更改
        String user = "root";//打开Navicat，点击用户，如果显示root@localhost，请修改为root@%或新加一个root@%，%表示任意，任意ip地址都可以连接
        String password = "123456";//密码
        String url = "jdbc:mysql://172.19.221.130:3306/course_design?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=true";
//        "?useUnicode=true&amp;characterEncoding=UTF-8"添加中文信息时不会乱码
//       注册JDBC驱动的固定语句
        try {
            Class.forName("com.mysql.jdbc.Driver");//这是一个目录，你可以找到这个目录点进去就懂了
            Log.d(TAG, "加载JDBC驱动成功");
        } catch (ClassNotFoundException e) {
            Log.d(TAG, "加载JDBC驱动失败");
        }
//        创建与mysql的连接对象conn,当然你也可以直接把上面定义的那些变量url的值直接写进去，就不用上面写一堆定义
        try {
            conn = DriverManager.getConnection(url, user, password);
            System.out.println("数据库连接成功");
            Log.d(TAG, "数据库连接成功");

        } catch (SQLException e) {
            Log.d(TAG, "数据库连接失败");
        }
        return  conn;//connection类，返回一个connection连接对象
    }</code></pre> 
<p>但是一直都是打印“数据库连接失败”。原博主的方法他自己是成功的，可能是我哪一步出错了我没发现吧。参考链接：<a href="https://blog.csdn.net/m0_59521845/article/details/125300884#comments_32773820" title="Android studio 连接MYQSL8.0_android studio下载适配mysql8-CSDN博客">Android studio 连接MYQSL8.0_android studio下载适配mysql8-CSDN博客</a>。最后我试了别的方法成功了。</p> 
<p><span style="color:#4da8ee;"><strong>【5.11补充】</strong></span></p> 
<p><span style="color:#4da8ee;"><strong>重大发现，上面这个代码可以连接数据库！！！不过也是要开新线程，在调用函数的时候调用就可以连接了！如图：</strong></span></p> 
<p><img alt="" height="189" src="https://images2.imgbox.com/98/e7/G7mfMk2D_o.png" width="579"></p> 
<p><strong>【我的解决方法】</strong></p> 
<h4>1、<strong>开启远程访问3306端口</strong></h4> 
<p><strong>步骤1：依次点击控制面板—系统和安全—windows防火墙—高级设置-入站规则</strong></p> 
<p><strong>步骤2：如图</strong></p> 
<p><img alt="" height="685" src="https://images2.imgbox.com/ff/48/vU0LWOkh_o.png" width="1200"></p> 
<p><strong>步骤3：如图。填好<span style="color:#fe2c24;">端口号</span><span style="color:#fe2c24;">3306</span>后，一直点击下一步即可。</strong></p> 
<p><img alt="" height="671" src="https://images2.imgbox.com/66/ae/EuwfSWcu_o.png" width="890"></p> 
<h4>2.进入MySQL页面</h4> 
<blockquote> 
 <p><strong>步骤1：Win+R，输入cmd，进入命令行窗口，输入<span style="color:#fe2c24;">mysql -u root -p</span><span style="color:#333333;">后回车，再输入你的数据库密码</span></strong></p> 
</blockquote> 
<p><img alt="" height="450" src="https://images2.imgbox.com/02/ad/Pi7Iq5q6_o.png" width="964"></p> 
<blockquote> 
 <p><strong>步骤2：</strong></p> 
 <p><strong>输入命令并回车：</strong></p> 
 <p><span style="color:#fe2c24;"><strong>GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY '123456' WITH GRANT OPTION</strong></span></p> 
 <p><strong>该命令表示允许从所有IP进行连接，其中</strong><span style="color:#fe2c24;"><strong>123456为数据库密码</strong></span></p> 
</blockquote> 
<p><img alt="" height="115" src="https://images2.imgbox.com/96/c5/oqL4tUL3_o.png" width="1099"></p> 
<h4><strong>3.需要新开一个线程运行，才能连接MySQL数据库</strong></h4> 
<p><strong>代码如下：</strong></p> 
<pre><code class="language-java">public void initConnect(String table) {
        // 必须新开线程才能连接MySQL数据库
        new Thread(new Runnable() {
            @Override
            public void run() {
                // 数据库驱动
                String CLS="com.mysql.jdbc.Driver";
                String URL="jdbc:mysql://172.19.221.130:3306/course_design?serverTimezone = GMT&amp;characterEncoding=UTF-8";
                String USER="root";
                String PWD="123456";
                try {
                    Class.forName(CLS).newInstance();// 加载数据库驱动
                    Connection conn=(Connection) DriverManager.getConnection(URL,USER,PWD);// 连接数据库
                    String sql="select * from "+table;
                    Statement stmt=conn.createStatement();
                    ResultSet rs=stmt.executeQuery(sql);// 执行sql
                    List&lt;User&gt; users = new ArrayList&lt;&gt;();
                    while (rs.next()) {
                        User user = new User(rs.getInt("id"),rs.getString("username"),rs.getString("password"));
                        user.setId(rs.getInt("id"));
                        user.setName(rs.getString("username"));
                        user.setPassword(rs.getString("password"));
                        users.add(user);
                        System.out.println(users);
                    }
                    System.out.println("连接成功");
                } catch (ClassNotFoundException | SQLException | IllegalAccessException | InstantiationException e) {
                    System.out.println("连接失败");
                    e.printStackTrace();
                }
            }
        }).start();
    }</code></pre> 
<p><strong>顺带说一下导入jar包和添加权限</strong></p> 
<h4><strong>4、导入jar包</strong></h4> 
<p><strong>步骤1：到官网下载：</strong><a href="https://downloads.mysql.com/archives/c-j/" rel="nofollow" title="MySQL :: Download MySQL Connector/J (Archived Versions)">MySQL :: Download MySQL Connector/J (Archived Versions)</a></p> 
<p><strong>我这里用的版本是5.1.49，建议用5.几的版本，版本高的似乎会出错</strong></p> 
<p><img alt="" height="764" src="https://images2.imgbox.com/d4/54/JJ8SZlJx_o.png" width="1200"></p> 
<p><strong>步骤2：下载后找到对应版本的jar包，复制粘贴到libs的文件夹下（没有libs就建一个）</strong></p> 
<p><img alt="" height="311" src="https://images2.imgbox.com/b3/fa/6I7wvEUp_o.png" width="408"></p> 
<p><strong>步骤3：选中libs目录下的jar包，右击鼠标，点击最下面的<span style="color:#fe2c24;">Add as Library即可。</span><span style="color:#333333;">这样系统就会自动在app目录下的build.gradle中帮你添加依赖。（如图）</span></strong></p> 
<p><span style="color:#4da8ee;"><strong>注意：如果你的jar包用不了重新导入了别的版本，记得到</strong><strong>build.gradle中将上一个版本的jar包删掉，不然会因为系统找不到该文件而报错</strong></span></p> 
<p><img alt="" height="327" src="https://images2.imgbox.com/0a/81/SeYElXRi_o.png" width="771"></p> 
<h4>5、在AndroidManifest.xml中添加网络权限</h4> 
<blockquote> 
 <p><span style="color:#fe2c24;"><strong>&lt;uses-permission android:name="android.permission.INTERNET" /&gt; </strong></span></p> 
 <p><span style="color:#fe2c24;"><strong>&lt;uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /&gt;</strong></span></p> 
</blockquote> 
<p><img alt="" height="217" src="https://images2.imgbox.com/ff/30/Gld4fm3t_o.png" width="811"></p> 
<p><span style="color:#fe2c24;"><strong>然后就可以连接MySQL啦！</strong></span></p> 
<p><img alt="" height="88" src="https://images2.imgbox.com/51/29/amwb7hgG_o.png" width="472"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/352fad96faebefb6fe8b5978ee87e91c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">电子资源|基于SSM&#43;vue的电子资源管理系统(源码&#43;数据库&#43;文档)​</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/28241c0a6e00f552b810bfee806b5363/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【漏洞防范与应对：从发现到修复的全攻略】Prometheus Pushgateway推送网关 存在未授权访问漏洞 ，处理过程详解！！！</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>