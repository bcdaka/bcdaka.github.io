<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>杂谈c语言——4.结构体和联合体 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/39cc534bf82c340c5942a6c91a2d2581/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="杂谈c语言——4.结构体和联合体">
  <meta property="og:description" content="两者最大的区别在于内存利用
1.struct &amp;&amp; union 一、结构体struct
各成员各自拥有自己的内存，各自使用互不干涉，同时存在的，遵循内存对齐原则。一个struct变量的总长度等于所有成员的长度之和。
二、联合体union
各成员共用一块内存空间，并且同时只有一个成员可以得到这块内存的使用权(对该内存的读写)，各变量共用一个内存首地址。因而，联合体比结构体更节约内存。一个union变量的总长度至少能容纳最大的成员变量，而且要满足是所有成员变量类型大小的整数倍。不允许对联合体变量名U2直接赋值或其他操作。
1.对比struct和union占用内存大小
#include&lt;stdio.h&gt; //结构体 struct u //u表示结构体类型名 { char a; //a表示结构体成员名 int b; short c; }U1; //U1表示结构体变量名 //访问该结构体内部成员时可以采用U1.a=1;其中&#34;点&#34;表示结构体成员运算符 //联合体 union u1 //u1表示联合体类型名 { char a; //a表示联合体成员名 int b; short c; }U2; //U2表示联合体变量名 //访问该联合体内部成员时可以采用U2.a=1;其中&#34;点&#34;表示联合体成员运算符 //主函数 int main(){ printf(&#34;%d\n&#34;,sizeof(U1)); printf(&#34;%d\n&#34;,sizeof(U2)); return 0; } /*程序运行结果是： 12 4*/ 1.1 联合体的特点 联合的成员是共⽤同⼀块内存空间的，这样⼀个联合变量的⼤⼩，⾄少是最⼤成员的⼤⼩（因为联合 ⾄少得有能⼒保存最⼤的那个成员）。
//代码1 #include &lt;stdio.h&gt; //联合类型的声明 union Un { char c; int i; }; int main() { //联合变量的定义 union Un un = {0}; // 下⾯输出的结果是⼀样的吗？ printf(&#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-10T12:54:50+08:00">
    <meta property="article:modified_time" content="2024-08-10T12:54:50+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">杂谈c语言——4.结构体和联合体</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>两者最大的区别在于内存利用</p> 
<h2>1.struct &amp;&amp; union</h2> 
<p>一、结构体struct</p> 
<p>    各成员各自拥有自己的内存，各自使用互不干涉，同时存在的，遵循内存对齐原则。一个struct变量的总长度等于所有成员的长度之和。</p> 
<p>二、联合体union</p> 
<p>    各成员共用一块内存空间，并且同时<strong><span style="color:#fe2c24;">只有一个成员可以得到这块内存的使用权</span></strong>(对该内存的读写)，<span style="color:#fe2c24;"><strong>各变量共用一个内存首地址</strong></span>。因而，联合体比结构体更节约内存。一个union变量的总长度至少能容纳最大的成员变量，而且要满足是所有成员变量类型大小的整数倍。不允许对联合体变量名U2直接赋值或其他操作。</p> 
<p></p> 
<blockquote> 
 <p><strong>1.对比struct和union占用内存大小</strong></p> 
</blockquote> 
<pre><code class="hljs">#include&lt;stdio.h&gt;
//结构体
struct u  //u表示结构体类型名
{
    char a;     //a表示结构体成员名
    int b;
    short c;
}U1;      
//U1表示结构体变量名  
//访问该结构体内部成员时可以采用U1.a=1;其中"点"表示结构体成员运算符
 
//联合体
union u1  //u1表示联合体类型名
{
    char a;    //a表示联合体成员名
    int b;
    short c;
}U2;
//U2表示联合体变量名  
//访问该联合体内部成员时可以采用U2.a=1;其中"点"表示联合体成员运算符
 
 
//主函数
int main(){
    printf("%d\n",sizeof(U1));
    printf("%d\n",sizeof(U2));
    return 0;
}
 
/*程序运行结果是：
12
4*/</code></pre> 
<h3>1.1 联合体的特点 </h3> 
<p>联合的成员是共⽤同⼀块内存空间的，这样⼀个联合变量的⼤⼩，⾄少是最⼤成员的⼤⼩（因为联合 ⾄少得有能⼒保存最⼤的那个成员）。</p> 
<blockquote> 
 <pre><code class="hljs">//代码1
#include &lt;stdio.h&gt;
//联合类型的声明
union Un
{
 char c;
 int i;
};
int main()
{
 //联合变量的定义
 union Un un = {0};
 // 下⾯输出的结果是⼀样的吗？
 printf("%p\n", &amp;(un.i));
 printf("%p\n", &amp;(un.c));
 printf("%p\n", &amp;un);
 return 0;
}
</code></pre> 
 <p>输出的结果：</p> 
 <p>001AF85C</p> 
 <p>001AF85C</p> 
 <p>001AF85C </p> 
 <pre><code class="hljs">//代码2
#include &lt;stdio.h&gt;
//联合类型的声明
union Un
{
 char c;
 int i;
};
int main()
{
 //联合变量的定义
 union Un un = {0};
 un.i = 0x11223344;
 un.c = 0x55;
 printf("%x\n", un.i);
 return 0;
}</code></pre> 
 <p>输出的结果：11223355</p> 
</blockquote> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/5c/e3/Us57ExM9_o.png"> </p> 
<h3>1.2 相同成员的结构体和联合体对⽐ </h3> 
<p>我们再对⽐⼀下相同成员的结构体和联合体的内存布局情况。</p> 
<pre><code class="hljs">struct S
{
 char c;
 int i;
};
struct S s = {0};</code></pre> 
<pre><code class="hljs">union Un
{
 char c;
 int i;
};
union Un un = {0};</code></pre> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/0b/78/pz8itSfd_o.png"> </p> 
<h3>1.3 联合体⼤⼩的计算 </h3> 
<blockquote> 
 <p> • 联合的⼤⼩<span style="color:#fe2c24;"><strong>⾄少是最⼤成员的⼤⼩</strong></span>。</p> 
 <p>• 当最⼤成员⼤⼩<span style="color:#fe2c24;"><strong>不是最⼤对⻬数的整数倍的时候，就要对⻬到最⼤对⻬数的整数倍。</strong></span></p> 
</blockquote> 
<p></p> 
<pre><code class="hljs">#include&lt;stdio.h&gt;
 
//联合体
union u2  
{
    char a;   
    int b;
    short c;
    double d;
    int e[5];
}U3;
 
//主函数
int main(){ 
    printf("%d\n",sizeof(U3));//输出24
    return 0;
}
</code></pre> 
<blockquote> 
 <p>代码中U3至少容纳最大e[5]=20字节，同时变量类型最大值是整数倍，即使double(字节数是8)的整数倍，因而sizeof(U3)=24。 </p> 
</blockquote> 
<h3>1.4 联合的⼀个练习 </h3> 
<p>写⼀个程序，判断当前机器是⼤端？还是⼩端？</p> 
<pre><code class="hljs">int check_sys()
{
 union
 {
 int i;
 char c;
 }un;
 un.i = 1;
 return un.c;//返回1是⼩端，返回0是⼤端
}</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1cdda8c70e7faf9287c7f2ace80829a3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">大数据机器学习算法岗位分析推荐：基于Python的招聘大数据爬虫可视化分析推荐系统</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cf5c1056a154a7873cdc8f32a14b61f0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">论文笔记：YOLOv8-QSD 自动驾驶场景小目标检测算法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>