<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Django学习第五天 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/46335c6b056d02613b615deb1a6f82a6/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Django学习第五天">
  <meta property="og:description" content="启动项目命令
python manage.py runserver 图像验证码生成随机字母或者数字
import random from PIL import Image, ImageDraw, ImageFont, ImageFilter def check_code(width=120, height=40, char_length=5, font_file=&#39;ZixunHappyBold.ttf&#39;, font_size=28): code = [] img = Image.new(mode=&#39;RGB&#39;, size=(width, height), color=(255, 255, 255)) draw = ImageDraw.Draw(img, mode=&#39;RGB&#39;) def rndChar(): &#34;&#34;&#34; 生成随机字母 :return: &#34;&#34;&#34; return chr(random.randint(65, 90)) # 生成随机数字 # return str(random.randint(0, 9)) def rndColor(): &#34;&#34;&#34; 生成随机颜色 :return: &#34;&#34;&#34; return (random.randint(0, 255), random.randint(10, 255), random.randint(64, 255)) # 写文字 font = ImageFont.truetype(font_file, font_size) for i in range(char_length): char = rndChar() code.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-05T22:32:34+08:00">
    <meta property="article:modified_time" content="2024-07-05T22:32:34+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Django学习第五天</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p> 启动项目命令</p> 
<pre><code class="language-python">python manage.py runserver</code></pre> 
<p>图像验证码生成随机字母或者数字</p> 
<p><img alt="" height="220" src="https://images2.imgbox.com/c7/44/dJNSIW0G_o.png" width="448"></p> 
<pre><code class="language-python">import random
from PIL import Image, ImageDraw, ImageFont, ImageFilter


def check_code(width=120, height=40, char_length=5, font_file='ZixunHappyBold.ttf', font_size=28):
    code = []
    img = Image.new(mode='RGB', size=(width, height), color=(255, 255, 255))
    draw = ImageDraw.Draw(img, mode='RGB')

    def rndChar():
        """
        生成随机字母
        :return:
        """
        return chr(random.randint(65, 90))
        # 生成随机数字
        # return str(random.randint(0, 9))

    def rndColor():
        """
        生成随机颜色
        :return:
        """
        return (random.randint(0, 255), random.randint(10, 255), random.randint(64, 255))

    # 写文字
    font = ImageFont.truetype(font_file, font_size)
    for i in range(char_length):
        char = rndChar()
        code.append(char)
        h = random.randint(0, 4)
        draw.text([i * width / char_length, h], char, font=font, fill=rndColor())

    # 写干扰点
    for i in range(40):
        draw.point([random.randint(0, width), random.randint(0, height)], fill=rndColor())

    # 写干扰圆圈
    for i in range(40):
        draw.point([random.randint(0, width), random.randint(0, height)], fill=rndColor())
        x = random.randint(0, width)
        y = random.randint(0, height)
        draw.arc((x, y, x + 4, y + 4), 0, 90, fill=rndColor())

    # 画干扰线
    for i in range(5):
        x1 = random.randint(0, width)
        y1 = random.randint(0, height)
        x2 = random.randint(0, width)
        y2 = random.randint(0, height)

        draw.line((x1, y1, x2, y2), fill=rndColor())

    img = img.filter(ImageFilter.EDGE_ENHANCE_MORE)
    return img, ''.join(code)


if __name__ == '__main__':
    # 1. 直接打开
    # img,code = check_code()
    # img.show()

    # 2. 写入文件
    # img,code = check_code()
    # with open('code.png','wb') as f:
    #     img.save(f,format='png')

    # 3. 写入内存(Python3)
    # from io import BytesIO
    # stream = BytesIO()
    # img.save(stream, 'png')
    # stream.getvalue()

    # 4. 写入内存（Python2）
    # import StringIO
    # stream = StringIO.StringIO()
    # img.save(stream, 'png')
    # stream.getvalue()

    pass</code></pre> 
<p>Ajax请求</p> 
<p><img alt="" height="266" src="https://images2.imgbox.com/49/9b/yZqwQT61_o.png" width="469"></p> 
<p>Ajax发送get请求</p> 
<p><img alt="" height="358" src="https://images2.imgbox.com/96/64/wViorexj_o.png" width="445"></p> 
<p>task_list.html</p> 
<pre><code class="language-html">{% extends 'layout.html' %}

{% block content %}
    &lt;div class="container"&gt;
        &lt;h1&gt;任务管理&lt;/h1&gt;

        &lt;h3&gt;示例1&lt;/h3&gt;
        &lt;input type="button" class="btn btn-primary" value="点击" onclick="clickMe()"/&gt;
    &lt;/div&gt;
{% endblock %}

{% block js %}
    &lt;script type="text/javascript"&gt;
        function clickMe() {
            $.ajax({
                url: '/task/ajax/',
                type: "get",
                data: {
                    n1: 123,
                    n2: 456
                },
                success: function (res) {
                    console.log(res);
                }
            })
        }
    &lt;/script&gt;
{% endblock %}</code></pre> 
<p>免除csrf_token认证</p> 
<p><img alt="" height="36" src="https://images2.imgbox.com/ce/27/SHr6y017_o.png" width="448"></p> 
<p><img alt="" height="85" src="https://images2.imgbox.com/7b/f8/FAQESr0A_o.png" width="292"></p> 
<p>Ajax发送post请求</p> 
<p><img alt="" height="490" src="https://images2.imgbox.com/b5/1a/HBspouzI_o.png" width="568"></p> 
<p>task_list.html</p> 
<pre><code class="language-html">{% extends 'layout.html' %}

{% block content %}
    &lt;div class="container"&gt;
        &lt;h1&gt;任务管理&lt;/h1&gt;

        &lt;h3&gt;示例1&lt;/h3&gt;
        &lt;input type="button" class="btn btn-primary" value="点击" onclick="clickMe()"/&gt;
    &lt;/div&gt;
{% endblock %}

{% block js %}
    &lt;script type="text/javascript"&gt;
        function clickMe() {
            $.ajax({
                url: '/task/ajax/',
                type: "post",
                data: {
                    n1: 123,
                    n2: 456
                },
                success: function (res) {
                    console.log(res);
                }
            })
        }
    &lt;/script&gt;
{% endblock %}</code></pre> 
<p>Ajax请求的返回值</p> 
<p>一般是json格式</p> 
<p>转数据格式,转为json格式的数据提供给前端</p> 
<p>import json</p> 
<pre>data_dict = {"status": True, "data": [11, 22, 33, 44]}
json.dumps(data_dict)</pre> 
<p>Django内部转json格式的方法</p> 
<pre>from django.http import JsonResponse</pre> 
<pre>def task_ajax(request):
    data_dict = {"status": True, "data": [11, 22, 33, 44]}
    return JsonResponse(data_dict)</pre> 
<p>使用Ajax发送post请求</p> 
<p>task.py文件</p> 
<pre><code class="language-python">import json
from django.shortcuts import render, HttpResponse
from django.http import JsonResponse
from django.views.decorators.csrf import csrf_exempt

def task_list(request):
    """ 任务列表 """
    return render(request, "task_list.html")


@csrf_exempt
def task_ajax(request):
    data_dict = {"status": True, "data": [11, 22, 33, 44]}
    return HttpResponse(json.dumps(data_dict))
    # return JsonResponse(data_dict)</code></pre> 
<p>task_list.html</p> 
<pre><code class="language-html">{% extends 'layout.html' %}

{% block content %}
    &lt;div class="container"&gt;
        &lt;h1&gt;任务管理&lt;/h1&gt;

        &lt;h3&gt;示例1&lt;/h3&gt;
        &lt;input type="button" class="btn btn-primary" value="点击" id="btn1"/&gt;
    &lt;/div&gt;
{% endblock %}

{% block js %}
    &lt;script type="text/javascript"&gt;
        $(function() {
            //页面框架加载完成之后代码自动执行
            bindBtn1Event();
        })

        function bindBtn1Event() {
            $("#btn1").click(function () {
                $.ajax({
                    url: '/task/ajax/',
                    type: "post",
                    data: {
                        n1: 123,
                        n2: 456
                    },
                    dataType: "JSON",
                    success: function (res) {
                        console.log(res);
                        console.log(res.status);
                        console.log(res.data);
                    }
                })
            })
        }
    &lt;/script&gt;
{% endblock %}</code></pre> 
<p>把表单中所有数据打包使用Ajax发送，是get请求的话使用request.GET就可以拿到前端传过来的数据</p> 
<p><img alt="" height="216" src="https://images2.imgbox.com/ca/f8/9cdvjhqO_o.png" width="613"></p> 
<p><img alt="" height="385" src="https://images2.imgbox.com/45/d7/nAwJnEYA_o.png" width="498"></p> 
<p><img alt="" height="212" src="https://images2.imgbox.com/41/11/1BYRqC6Q_o.png" width="515"></p> 
<p> 运行创建数据库代码的命令语句</p> 
<pre><code class="language-python"> python manage.py makemigrations</code></pre> 
<pre><code class="language-python"> python manage.py migrate </code></pre> 
<p>定义数据库格式的时候页面会自动展示长文本格式</p> 
<p><img alt="" height="71" src="https://images2.imgbox.com/24/ba/z1rbao13_o.png" width="534"></p> 
<p>如果不需要的话可以这么写</p> 
<p><img alt="" height="418" src="https://images2.imgbox.com/86/0c/EU5bOaFz_o.png" width="522"></p> 
<p>也可以这么写</p> 
<p><img alt="" height="442" src="https://images2.imgbox.com/3d/2c/4NMCfnr0_o.png" width="485"></p> 
<p>使用ajax实现form表单数据的提交与保存到数据库</p> 
<p>task.py</p> 
<pre><code class="language-python">import json

from django import forms
from django.shortcuts import render, HttpResponse
from django.http import JsonResponse
from django.views.decorators.csrf import csrf_exempt
from app01.utils.bootstrap import BootStrapModelForm
from app01 import models


class TaskModelForm(BootStrapModelForm):
    class Meta:
        model = models.Task
        fields = "__all__"
        widgets = {
            # "detail": forms.Textarea
            "detail": forms.TextInput
        }


def task_list(request):
    """ 任务列表 """
    form = TaskModelForm()
    return render(request, "task_list.html", {"form": form})


@csrf_exempt
def task_ajax(request):
    print(request.POST)
    data_dict = {"status": True, "data": [11, 22, 33, 44]}
    return HttpResponse(json.dumps(data_dict))
    # return JsonResponse(data_dict)


@csrf_exempt
def task_add(request):
    # 用户发送过来的数据进行校验（ModelForm进行校验）
    form = TaskModelForm(data=request.POST)
    if form.is_valid():
        form.save()
        data_dict = {"status": True}
        return HttpResponse(json.dumps(data_dict))

    data_dict = {"status": True, 'error': form.errors}
    return HttpResponse(json.dumps(data_dict, ensure_ascii=False))</code></pre> 
<p>task_list.html</p> 
<pre><code class="language-html">{% extends 'layout.html' %}

{% block content %}
&lt;div class="container"&gt;
    &lt;div class="panel panel-default"&gt;
        &lt;div class="panel-heading"&gt;表单&lt;/div&gt;
        &lt;div class="panel-body"&gt;
            &lt;form id="formAdd"&gt;
                &lt;div class="clearfix"&gt;
                    {% for field in form %}
                        &lt;div class="col-xs-6"&gt;
                            &lt;div class="form-group" style="position: relative;margin-bottom: 20px;"&gt;
                                &lt;label&gt;{<!-- -->{ field.label }}&lt;/label&gt;
                                {<!-- -->{ field }}
                                &lt;span class="error-msg" style="color: red; position: absolute"&gt;&lt;/span&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;
                    {% endfor %}
                    &lt;div class="col-xs-12"&gt;
                        &lt;button id="btnAdd" type="button" class="btn btn-primary"&gt;提 交&lt;/button&gt;
                    &lt;/div&gt;
                &lt;/div&gt;

            &lt;/form&gt;
        &lt;/div&gt;
    &lt;/div&gt;

    &lt;h1&gt;任务管理&lt;/h1&gt;

    &lt;h3&gt;示例1&lt;/h3&gt;
    &lt;input type="button" class="btn btn-primary" value="点击" id="btn1"/&gt;

    &lt;h3&gt;示例2&lt;/h3&gt;
    &lt;input type="text" id="txtUser" placeholder="姓名"/&gt;
    &lt;input type="text" id="txtAge" placeholder="年龄"/&gt;
    &lt;input type="button" class="btn btn-primary" value="点击2" id="btn2"/&gt;

    &lt;h3&gt;示例3&lt;/h3&gt;
    &lt;form id="form3"&gt;
        &lt;input type="text" name="user" placeholder="姓名"&gt;
        &lt;input type="text" name="age" placeholder="年龄"&gt;
        &lt;input type="text" name="email" placeholder="邮箱"&gt;
        &lt;input type="text" name="more" placeholder="介绍"&gt;
    &lt;/form&gt;
    &lt;input type="button" class="btn btn-primary" value="点击3" id="btn3"/&gt;
&lt;/div&gt;
{% endblock %}

{% block js %}
&lt;script type="text/javascript"&gt;
    $(function() {
        //页面框架加载完成之后代码自动执行
        bindBtn1Event();
        bindBtn2Event();
        bindBtn3Event();
        bindBtnAddEvent();
    })

    function bindBtn1Event() {
        $("#btn1").click(function () {
            $.ajax({
                url: '/task/ajax/',
                type: "post",
                data: {
                    n1: 123,
                    n2: 456
                },
                dataType: "JSON",
                success: function (res) {
                    console.log(res);
                    console.log(res.status);
                    console.log(res.data);
                }
            })
        })
    }

    function bindBtn2Event() {
         $("#btn2").click(function () {
            $.ajax({
                url: '/task/ajax/',
                type: "post",
                data: {
                    name: $("#txtUser").val(),
                    age: $("#txtAge").val(),
                },
                dataType: "JSON",
                success: function (res) {
                    console.log(res);
                    console.log(res.status);
                    console.log(res.data);
                }
            })
        })
    }

    function bindBtn3Event() {
         $("#btn3").click(function () {
            $.ajax({
                url: '/task/ajax/',
                type: "post",
                data: $("#form3").serialize(),
                dataType: "JSON",
                success: function (res) {
                    console.log(res);
                    console.log(res.status);
                    console.log(res.data);
                }
            })
        })
    }

    function bindBtnAddEvent() {
         $("#btnAdd").click(function () {
            $("#error-msg").empty();
            $.ajax({
                url: '/task/add/',
                type: "post",
                data: $("#formAdd").serialize(),
                dataType: "JSON",
                success: function (res) {
                    if(res.status){
                        alert("添加成功");
                    } else {
                        $.each(res.error, function (name, data){
                            console.log(name, data);
                            $("#id_" + name).next().text(data[0]);
                        })
                    }
                }
            })
        })
    }
&lt;/script&gt;
{% endblock %}</code></pre> 
<p>models.py</p> 
<pre><code class="language-python">from django.db import models


class Admin(models.Model):
    """ 管理员 """
    username = models.CharField(verbose_name="用户名", max_length=32)
    password = models.CharField(verbose_name="密码", max_length=64)

    def __str__(self):
        return self.username


# Create your models here.
class Department(models.Model):
    """ 部门表 """
    title = models.CharField(verbose_name='标题', max_length=32)

    def __str__(self):
        return self.title


class UserInfo(models.Model):
    """ 员工表 """
    name = models.CharField(verbose_name="姓名", max_length=16)
    password = models.CharField(verbose_name="密码", max_length=64)
    age = models.IntegerField(verbose_name="年龄")
    account = models.DecimalField(verbose_name="账户余额", max_digits=10, decimal_places=2, default=0)
    # 包含年月日，时分秒
    # create_time = models.DateTimeField(verbose_name="入职时间")
    # 不包含时分秒
    create_time = models.DateTimeField(verbose_name="入职时间")

    # 无约束
    # depart_id = models.BigIntegerField(verbose_name="部门ID")

    # 1.有约束
    # -to, 与哪张表关联
    # -to_field, 表中的哪一列关联
    # 2.django自动
    # -写的depart
    # -生成数据列depart_id
    # 3.部门表被删除
    # 3.1 级联删除
    depart = models.ForeignKey(to="Department", to_field="id", on_delete=models.CASCADE)
    # 3.2 置空
    # depart = models.ForeignKey(to="Department", to_field="id", null=True, blank=True, on_delete=models.SET_NULL)

    # 在django中做的约束
    gender_choices = (
        (1, "男"),
        (2, "女"),
    )
    gender = models.SmallIntegerField(verbose_name="性别", choices=gender_choices)


class PrettyNum(models.Model):
    """ 靓号表 """
    mobile = models.CharField(verbose_name="手机号", max_length=11)
    # 想要允许为空 null=True, blank=True
    price = models.IntegerField(verbose_name="价格", default=0)

    level_choices = (
        (1, "1级"),
        (2, "2级"),
        (3, "3级"),
        (4, "4级"),
    )
    level = models.SmallIntegerField(verbose_name="级别", choices=level_choices, default=1)

    status_choices = (
        (1, "已占用"),
        (2, "未使用"),
    )
    status = models.SmallIntegerField(verbose_name="状态", choices=status_choices, default=2)


class Task(models.Model):
    """ 任务 """
    level_choices = {
        (1, "紧急"),
        (2, "重要"),
        (3, "临时"),
    }
    level = models.SmallIntegerField(verbose_name="级别", choices=level_choices, default=1)
    title = models.CharField(verbose_name="标题", max_length=64)
    detail = models.TextField(verbose_name="详细信息")
    user = models.ForeignKey(verbose_name="负责人", to="Admin", on_delete=models.CASCADE)
</code></pre> 
<p>知识点回顾</p> 
<p><img alt="" height="494" src="https://images2.imgbox.com/f9/40/ZaKUNNsZ_o.png" width="636"></p> 
<p><img alt="" height="364" src="https://images2.imgbox.com/a8/bd/trLs9S9P_o.png" width="676"></p> 
<p><img alt="" height="515" src="https://images2.imgbox.com/fc/39/wBnAsKPk_o.png" width="663"></p> 
<p><img alt="" height="509" src="https://images2.imgbox.com/03/eb/mt7ViHaa_o.png" width="575"></p> 
<p>实现页面的自动刷新更新数据功能<img alt="" height="100" src="https://images2.imgbox.com/00/dd/0Ilt8OXL_o.png" width="313"></p> 
<p>文件命名冲突问题</p> 
<p><img alt="" height="235" src="https://images2.imgbox.com/85/6a/O1yvrPKp_o.png" width="726"></p> 
<p>改为order1.py解决冲突</p> 
<p><img alt="" height="288" src="https://images2.imgbox.com/c5/c1/YjjqGUK8_o.png" width="673"></p> 
<p>两种显示模态框的方式</p> 
<p><img alt="" height="178" src="https://images2.imgbox.com/00/f4/wSZD6eO9_o.png" width="917"></p> 
<p><img alt="" height="358" src="https://images2.imgbox.com/01/f7/p38DD91C_o.png" width="488"></p> 
<p>清空错误信息</p> 
<p><img alt="" height="496" src="https://images2.imgbox.com/c0/a7/hMc6Jmnj_o.png" width="614"></p> 
<p>根据不同登录的用户设置不同的id</p> 
<p><img alt="" height="418" src="https://images2.imgbox.com/8c/92/PSPK7GMv_o.png" width="931"></p> 
<p>出现500的错误</p> 
<p><img alt="" height="126" src="https://images2.imgbox.com/1b/bb/qRwvFxih_o.png" width="686"></p> 
<p>没有登录，使用管理员账户登录一下</p> 
<p>实现删除模态框</p> 
<p>order_list.html页面</p> 
<pre><code class="language-html">{% extends 'layout.html' %}

{% block content %}
&lt;div class="container"&gt;
    &lt;div style="margin-bottom: 10px"&gt;
        &lt;input type="button" value="新建订单1" class="btn btn-primary" data-toggle="modal" data-target="#myModal"&gt;
        &lt;input id="btnAdd" type="button" value="新建订单2" class="btn btn-primary"&gt;
    &lt;/div&gt;

    &lt;div class="panel panel-default"&gt;
        &lt;!-- Default panel contents --&gt;
        &lt;div class="panel-heading"&gt;
            &lt;span class="glyphicon glyphicon-th-list" aria-hidden="true"&gt;&lt;/span&gt;
            订单列表
        &lt;/div&gt;

        &lt;!-- Table --&gt;
        &lt;table class="table table-bordered"&gt;
            &lt;thead&gt;
            &lt;tr&gt;
                &lt;th&gt;ID&lt;/th&gt;
                &lt;th&gt;订单号&lt;/th&gt;
                &lt;th&gt;名称&lt;/th&gt;
                &lt;th&gt;价格&lt;/th&gt;
                &lt;th&gt;状态&lt;/th&gt;
                &lt;th&gt;管理员&lt;/th&gt;
                &lt;th&gt;操作&lt;/th&gt;
            &lt;/tr&gt;
            &lt;/thead&gt;
            &lt;tbody&gt;
            {% for obj in queryset %}
            &lt;tr&gt;
                &lt;th&gt;{<!-- -->{ obj.id }}&lt;/th&gt;
                &lt;td&gt;{<!-- -->{ obj.oid }}&lt;/td&gt;
                &lt;td&gt;{<!-- -->{ obj.title }}&lt;/td&gt;
                &lt;td&gt;{<!-- -->{ obj.price }}&lt;/td&gt;
                &lt;td&gt;{<!-- -->{ obj.get_status_display }}&lt;/td&gt;
                &lt;td&gt;{<!-- -->{ obj.admin.username }}&lt;/td&gt;
                &lt;td&gt;
                    &lt;a class="btn btn-primary btn-xs" href="/admin/{<!-- -->{ obj.id }}/edit/"&gt;编辑&lt;/a&gt;
                    &lt;input class="btn btn-danger btn-xs btn-delete" type="button" value="删除"&gt;
                &lt;/td&gt;
            &lt;/tr&gt;
            {% endfor %}
            &lt;/tbody&gt;
        &lt;/table&gt;
    &lt;/div&gt;
    &lt;div class="clearfix"&gt;
        &lt;ul class="pagination" style="float:left;"&gt;
            {<!-- -->{ page_string }}
        &lt;/ul&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;!-- 新建订单（对话框） --&gt;
&lt;div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"&gt;
    &lt;div class="modal-dialog" role="document"&gt;
        &lt;div class="modal-content"&gt;
            &lt;div class="modal-header"&gt;
                &lt;button type="button" class="close" data-dismiss="modal" aria-label="Close"&gt;&lt;span aria-hidden="true"&gt;&amp;times;&lt;/span&gt;
                &lt;/button&gt;
                &lt;h4 class="modal-title" id="myModalLabel"&gt;新建&lt;/h4&gt;
            &lt;/div&gt;
            &lt;div class="modal-body"&gt;
                &lt;form id="formAdd"&gt;
                    &lt;div class="clearfix"&gt;
                        {% for field in form %}
                        &lt;div class="col-xs-6"&gt;
                            &lt;div class="form-group" style="position: relative;margin-bottom: 20px;"&gt;
                                &lt;label&gt;{<!-- -->{ field.label }}&lt;/label&gt;
                                {<!-- -->{ field }}
                                &lt;span class="error-msg" style="color: red; position: absolute"&gt;&lt;/span&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;
                        {% endfor %}

                    &lt;/div&gt;

                &lt;/form&gt;
            &lt;/div&gt;
            &lt;div class="modal-footer"&gt;
                &lt;button type="button" class="btn btn-default" data-dismiss="modal"&gt;取 消&lt;/button&gt;
                &lt;button id="btnSave" type="button" class="btn btn-primary"&gt;保 存&lt;/button&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;!--删除--&gt;
&lt;div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"&gt;
    &lt;div class="modal-dialog" role="document"&gt;
        &lt;div class="alert alert-danger alert-dismissible fade in" role="alert"&gt;
            &lt;h4&gt;是否确定删除？&lt;/h4&gt;
            &lt;p style="margin: 10px 0;"&gt;删除后可能会出现不一样的问题&lt;/p&gt;
            &lt;p style="text-align: right;"&gt;
                &lt;button type="button" class="btn btn-danger"&gt;确 定&lt;/button&gt;
                &lt;button type="button" class="btn btn-default"&gt;取 消&lt;/button&gt;
            &lt;/p&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
{% endblock %}

{% block js %}
&lt;script type="text/javascript"&gt;
    $(function () {
        bindBtnAddEvent();
        bindBtnSaveEvent();
        bindBtnDeleteEvent();
    })

    function bindBtnAddEvent() {
        $("#btnAdd").click(function () {
            console.log(123);
            //点击新建按钮，显示对话框
            $('#myModal').modal('show')
        });
    }

    function bindBtnSaveEvent() {
        $("#btnSave").click(function() {
            // 清除错误信息
            $("#error-msg").empty();
            // 向后台发送请求
            $.ajax({
                url: "/order/add/",
                type: "post",
                data: $("#formAdd").serialize(),
                dataType: "JSON",
                success: function (res) {
                    if(res.status) {
                        alert("创建成功");
                        // 清空表单
                        $("#formAdd")[0].reset();

                        //关闭对话框
                        $('#myModal').modal('hide');
                        location.reload();
                    } else {
                        $.each(res.error, function (name, errorList) {
                            $("#id_" + name).next().text(errorList[0]);
                        })
                    }
                }
            });
        });
    }

    function bindBtnDeleteEvent() {
        $(".btn-delete").click(function() {
            $("#deleteModal").modal('show');
        });
    }
&lt;/script&gt;
{% endblock %}</code></pre> 
<p>order1.py</p> 
<pre><code class="language-python">import json
import random

from django.shortcuts import render
from django.http import JsonResponse, HttpResponse
from app01 import models
from app01.utils.bootstrap import BootStrapModelForm
from django.views.decorators.csrf import csrf_exempt
from datetime import datetime
from app01.utils.pagination import Pagination

class OrderModelForm(BootStrapModelForm):
    class Meta:
        model = models.Order
        # field = "__all__"
        # fields = [""]
        exclude = ["oid", "admin"]


def order_list(request):
    queryset = models.Order.objects.all().order_by('-id')
    page_object = Pagination(request, queryset)
    form = OrderModelForm()

    context = {
        'form': form,
        'queryset': page_object.page_queryset,
        'page_string': page_object.html()
    }
    return render(request, 'order_list.html', context)


@csrf_exempt
def order_add(request):
    """ 新建订单 （Ajax请求）"""
    form = OrderModelForm(data=request.POST)
    if form.is_valid():
        # 额外增加一些不是用户输入的值（自己计算值）
        form.instance.oid = datetime.now().strftime("%Y%m%d%H%M%S") + str(random.randint(1000, 9999))

        # 固定设置管理员ID
        # form.instance.admin = 当前登录系统管理员的ID
        # keys = list(request.session.keys())
        # print(keys)
        form.instance.admin_id = request.session["info"]["id"]
        # 保存到数据库中
        form.save()
        return JsonResponse({"status": True})
        # return HttpResponse(json.dumps({"status": True}))

    return JsonResponse({"status": False, 'error':  form.errors})
</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/85366e7b198bd664d072c3bd8a30a1b2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">《C语言》认识数据类型和理解变量</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d7366b25693b5d1ff23e9dc2a34a7aeb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java实习手册（小白也看得懂）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>