<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>数据库之Mybatis映射文件、动态SQL - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/6d01fec3c92cd405f1b9aea6ef06c485/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="数据库之Mybatis映射文件、动态SQL">
  <meta property="og:description" content="目录
1.XML映射文件
2.动态SQL
1.XML映射文件 之前我们执行sql语句是通过注解的方式，还有另外一种方式是通过XML配置文件执行sql语句，这份文件在Mybatis中也称为XML映射文件。
XML配置文件的规范：只有这三条规范都正确的情况下，才能正常运行sql语句。
XML文件中的约束在官网中可以找到：MyBatis中文网
右键接口复制全限定名以保证第二点规范。id为list，再右键emp类的全限定名，将其复制给resultType保证返回类型是Emp类型，也就是第三条规范。
执行顺序：1.mybatis查找与接口全类名相同的xml映射文件 2.再找到id属性值（list）与方法名相同的sql语句进行执行。
插件MybatisX：是一款基于IDEA的快速开发Mybatis的插件，为效率而生。有快速定位关联的代码等功能。
那我们到底用哪种方式去执行sql语句呢？官方说明如下：
” 使用注解来映射简单语句会使代码显得更加简洁，但对于稍微复杂一点的语句, Java 注解不仅力不从心,还会让你本就复杂的SQL语句更加混乱不堪。因此, 如果你需要做一些很复杂的操作,最好用XML来映射语句。 “
简单来说：使用Mybatis的注解，主要是来完成一些简单的增删改查功能。如果需要实现复杂的SQL功能，建议使用XML来配置映射语句。
2.动态SQL 动态SQL：随着用户的输入或外部条件的变化而变化的SQL语句。它是mybatis中非常重要的功能
场景：我们之前执行的sql语法都是固定写死的，必须通过某个字段或某些字段进行增删改查，比如根据id查找数据。在实际业务中，有可能什么都不指定，比如查找全部员工，这时什么都没有传入，查找就会失败。此时就要用到动态SQL。
标签if:用于判断条件是否成立。使用test属性进行条件判断,如果条件为true,则拼接SQL。
标签where:元素只会在子元素有内容的情况下才插入where子句。而且会自动去除子句的开头的AND或OR。
这里用到了mybatis中的以上两个标签。假如我要查找性别为男的员工，此时name、begin和end都为null，所以是不会拼接这两条sql语句的，也就是不会执行，只执行了gender这一条sql语句。如果三个都为null，那么红色部分全部不会执行，以保证sql语句不会报错。
以上代码可以通过MybatisX插件一键生成，生成的标签根据方法名进行识别，update就自动给上update标签，其余同理。
这里用到了&lt;set&gt;标签，用于去除属性间（末尾）的逗号，以保证sql语句的正确
标签foreach：用于遍历集合
动态批量删除ids集合中的数据：
delete from emp where id in (1,2,3);--固定的SQL语句 对于以上XML映射文件中的动态sql语句编写，实际上有一些问题。如下：
当功能增多时，红色部分的SQL语句也会变多，如果其中的字段名需要修改，那么就要修改大量的SQL语句，如果遗漏修改，项目就会出现问题。这时我们借助java的封装思想，把这些相同的sql语句封装起来，需要时再引入进来，到时候只要修改封装的这个sql语句即可。
sql标签：用于抽取sql片段，需要给这个sql片段id，即封装了这个sql片段
include标签：引入sql片段，需要指定id，即引入sql片段">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-21T22:53:44+08:00">
    <meta property="article:modified_time" content="2024-08-21T22:53:44+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">数据库之Mybatis映射文件、动态SQL</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="1.XML%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6-toc" style="margin-left:0px;"><a href="#1.XML%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6" rel="nofollow">1.XML映射文件</a></p> 
<p id="2.%E5%8A%A8%E6%80%81SQL-toc" style="margin-left:0px;"><a href="#2.%E5%8A%A8%E6%80%81SQL" rel="nofollow">2.动态SQL</a></p> 
<hr id="hr-toc"> 
<h2>1.XML映射文件</h2> 
<p>之前我们执行sql语句是通过注解的方式，还有另外一种方式是通过XML配置文件执行sql语句，这份文件在Mybatis中也称为XML映射文件。</p> 
<p>XML配置文件的规范：只有这三条规范都正确的情况下，才能正常运行sql语句。</p> 
<p><img alt="" height="303" src="https://images2.imgbox.com/3e/f6/oXJdfUaK_o.png" width="1200"></p> 
<p><img alt="" height="592" src="https://images2.imgbox.com/f4/b8/g4Jni8ZC_o.png" width="1200"></p> 
<p>XML文件中的约束在官网中可以找到：<a href="https://mybatis.net.cn/" rel="nofollow" title="MyBatis中文网">MyBatis中文网</a></p> 
<p><img alt="" height="197" src="https://images2.imgbox.com/02/35/hoO2j8H9_o.png" width="898"></p> 
<p>右键接口复制全限定名以保证第二点规范。id为list，再右键emp类的全限定名，将其复制给resultType保证返回类型是Emp类型，也就是第三条规范。</p> 
<p><img alt="" height="157" src="https://images2.imgbox.com/0f/78/LMDRqdqM_o.png" width="1200"></p> 
<p><img alt="" height="214" src="https://images2.imgbox.com/dc/a5/XrEdk8ao_o.png" width="1200"></p> 
<p><strong>执行顺序：</strong>1.mybatis查找与接口全类名相同的xml映射文件 2.再找到id属性值（list）与方法名相同的sql语句进行执行。</p> 
<p><img alt="" height="251" src="https://images2.imgbox.com/4d/b0/4TEbMqT7_o.png" width="528"></p> 
<p><strong>插件MybatisX</strong>：是一款基于IDEA的快速开发Mybatis的插件，为效率而生。有快速定位关联的代码等功能。</p> 
<p><img alt="" height="168" src="https://images2.imgbox.com/dc/1a/JRgrnPD3_o.png" width="416"></p> 
<p>那我们到底用哪种方式去执行sql语句呢？官方说明如下：</p> 
<p><strong>” </strong>使用注解来映射<strong>简单语句</strong>会使代码显得更加简洁，但对于稍微复杂一点的语句, Java 注解不仅力不从心,还会让你本就复杂的SQL语句更加混乱不堪。因此, 如果你需要做一些很<strong>复杂</strong>的操作,最好用XML来映射语句。<strong> “</strong></p> 
<p>简单来说：使用Mybatis的注解，主要是来完成一些简单的增删改查功能。如果需要实现复杂的SQL功能，建议使用XML来配置映射语句。</p> 
<h2 id="2.%E5%8A%A8%E6%80%81SQL">2.动态SQL</h2> 
<p>动态SQL：随着用户的输入或外部条件的变化而变化的SQL语句。它是mybatis中非常重要的功能</p> 
<p><strong>场景：</strong>我们之前执行的sql语法都是固定写死的，必须通过某个字段或某些字段进行增删改查，比如根据id查找数据。在实际业务中，有可能什么都不指定，比如查找全部员工，这时什么都没有传入，查找就会失败。此时就要用到动态SQL。</p> 
<p><strong>标签if:</strong>用于判断条件是否成立。使用test属性进行条件判断,如果条件为true,则拼接SQL。</p> 
<p><strong>标签where:</strong>元素只会在子元素有内容的情况下才插入where子句。而且会自动去除子句的开头的AND或OR。</p> 
<p>这里用到了mybatis中的以上两个标签。假如我要查找性别为男的员工，此时name、begin和end都为null，所以是不会拼接这两条sql语句的，也就是不会执行，只执行了gender这一条sql语句。如果三个都为null，那么红色部分全部不会执行，以保证sql语句不会报错。</p> 
<p><img alt="" height="360" src="https://images2.imgbox.com/ea/44/t1P0XSiF_o.png" width="504"></p> 
<p>以上代码可以通过MybatisX插件一键生成，生成的标签根据方法名进行识别，update就自动给上update标签，其余同理。</p> 
<p><img alt="" height="131" src="https://images2.imgbox.com/aa/14/mQH9PPOP_o.png" width="526"></p> 
<p>这里用到了<strong>&lt;set&gt;标签</strong>，用于去除属性间（末尾）的逗号，以保证sql语句的正确</p> 
<p><img alt="" height="234" src="https://images2.imgbox.com/0c/c8/ucePaBY6_o.png" width="1185"></p> 
<p><strong>标签foreach：</strong>用于遍历集合</p> 
<p><img alt="" height="168" src="https://images2.imgbox.com/b4/72/pxItvU6O_o.png" width="294"></p> 
<p>动态批量删除ids集合中的数据：</p> 
<pre><code class="language-sql">delete from emp where id in (1,2,3);--固定的SQL语句</code></pre> 
<p><img alt="" height="271" src="https://images2.imgbox.com/ae/ee/KvH9Yszs_o.png" width="1200"></p> 
<p>对于以上XML映射文件中的动态sql语句编写，实际上有一些问题。如下：</p> 
<p>当功能增多时，红色部分的SQL语句也会变多，如果其中的字段名需要修改，那么就要修改大量的SQL语句，如果遗漏修改，项目就会出现问题。这时我们借助java的封装思想，把这些相同的sql语句封装起来，需要时再引入进来，到时候只要修改封装的这个sql语句即可。</p> 
<p><img alt="" height="908" src="https://images2.imgbox.com/57/2a/Alpyjjbb_o.png" width="1200"></p> 
<p><strong>sql标签：</strong>用于抽取sql片段，需要给这个sql片段id，即封装了这个sql片段</p> 
<p><strong>include标签：</strong>引入sql片段，需要指定id，即引入sql片段</p> 
<p><img alt="" height="151" src="https://images2.imgbox.com/c5/8c/U9sTCErj_o.png" width="647"></p> 
<p><img alt="" height="146" src="https://images2.imgbox.com/f6/96/5mJlQXDZ_o.png" width="445"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fb25a72927ebd2d0ad7df32cba8bd9b0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Tomcat使用及负载均衡（最全源码安装及配置使用教程）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/600278aaccd90958e53814b2b5142e49/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">IntelliJ IDEA ideaIU-2024.2.0.2.exe 启动 IDE 失败</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>