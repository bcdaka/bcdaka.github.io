<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>TEXT2SQL工具vanna本地化安装和应用 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/da3998222d2632035aa9f1d2c93ba119/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="TEXT2SQL工具vanna本地化安装和应用">
  <meta property="og:description" content="TEXT2SQL工具vanna本地化安装和应用 Vanna和Text2SQL环境安装和数据准备conda虚拟环境安装数据准备ollama环境准备ollama安装和运行ollama下载模型测试下API方式正常使用 chromaDB的默认的embedding模型准备 vanna脚本跑起来 Vanna和Text2SQL TEXT2SQL即文本转SQL，是利用RAG和LLM来实现输入一段文本，系统自动生成SQL，甚至把数据结果用图表的方式展现出来，以下是一些典型的应用实例：
企业数据分析：企业内部的业务分析师或非技术员工可以通过自然语言提问，如“上个季度销售额最高的五个产品是什么？”Text2SQL系统能够自动将此类问题转换为SQL查询，从数据库中提取所需信息，无需手动编写SQL代码，大大提升了数据分析的效率和易用性。 智能客服系统：在客户服务场景中，Text2SQL可以帮助客服机器人理解用户的问题，比如查询订单状态、退换货政策等，并自动执行数据库查询以提供准确的答案，从而提升客服响应速度和服务质量。 个人助理与智能家居：在智能家居或个人助理应用中，用户可以通过语音或文本提出请求，如“明天早上7点提醒我开会”或“显示最近一周的电费消耗情况”，Text2SQL技术能够解析这些请求并转换成数据库查询指令，与家庭自动化系统或个人日程管理系统交互，实现智能化控制和信息反馈。 电子商务平台：电商平台可以利用Text2SQL快速处理用户的商品搜索请求，如“红色高跟鞋尺码37且价格低于500元”，系统自动构建SQL查询，从商品数据库中筛选出符合条件的商品列表。 金融行业报告生成：在金融分析领域，分析师可以提出复杂的需求，如“统计过去一年内公司A的日均交易量并对比行业平均值”，Text2SQL能够帮助自动生成相应的SQL查询，从海量金融数据中提取所需信息，辅助决策制定。 健康医疗信息查询：在医疗信息系统中，医生或研究人员可以通过自然语言查询患者病历、药物信息或疾病统计数据，Text2SQL能够将这些查询转换为SQL，快速检索电子病历系统或医学数据库中的相关记录。 这些场景展示了Text2SQL如何作为自然语言处理和数据库交互的桥梁，简化数据查询流程，提高数据获取的效率和灵活性。随着自然语言处理技术的进步，Text2SQL的应用将会越来越广泛，为跨领域用户提供更加便捷的数据访问方式。
环境安装和数据准备 此处使用私有化的ollama的环境和本地的向量数据库chromaDB和词向量嵌入模型all-MiniLM-L6-v2来搭建本地化环境，并连接到mysql数据库，进行数据分析。
这里使用的是centos7 ，并有一块11G显存的GeForce GTX 1080 Ti，本文编制的时候，使用的是vanna 0.5.4版本。
conda虚拟环境安装 此处默认已经安装了conda环境，创建虚拟环境：
conda create -n vanna -y python=3.9 激活环境
conda activate vanna 安装包，当然ipykernel可以不安装，看需要
pip install &#39;vanna[chromadb,ollama,mysql]&#39; pip install ipykernel 数据准备 在待连接的mysql数据库的，demodb数据库中新建表和记录，当然可以在不同数据库里面创建表，并插入不同的数据，根据实际情况可以调整SQL，并调整后续步骤的python代码中连接数据库的内容。
CREATE TABLE IF NOT EXISTS vuser ( `id` INT PRIMARY KEY COMMENT &#39;用户ID&#39;, username VARCHAR(50) COMMENT &#39;用户名&#39;, email VARCHAR(100) COMMENT &#39;电子邮件&#39;, age INT COMMENT &#39;年龄&#39;, gender VARCHAR(10) COMMENT &#39;性别（男/女）&#39;, city VARCHAR(50) COMMENT &#39;城市&#39; ) COMMENT=&#39;用户信息表&#39; CHARACTER SET=utf8mb4 COLLATE=utf8mb4_unicode_ci; INSERT INTO vuser (`id`, username, email, age, gender, city) VALUES (1, &#39;张三&#39;, &#39;zhangsan@example.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-11T09:04:41+08:00">
    <meta property="article:modified_time" content="2024-05-11T09:04:41+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">TEXT2SQL工具vanna本地化安装和应用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>TEXT2SQL工具vanna本地化安装和应用</h4> 
 <ul><li><a href="#VannaText2SQL_1" rel="nofollow">Vanna和Text2SQL</a></li><li><a href="#_17" rel="nofollow">环境安装和数据准备</a></li><li><ul><li><a href="#conda_20" rel="nofollow">conda虚拟环境安装</a></li><li><a href="#_40" rel="nofollow">数据准备</a></li><li><a href="#ollama_67" rel="nofollow">ollama环境准备</a></li><li><ul><li><a href="#ollama_68" rel="nofollow">ollama安装和运行</a></li><li><a href="#ollama_84" rel="nofollow">ollama下载模型</a></li><li><a href="#API_92" rel="nofollow">测试下API方式正常使用</a></li></ul> 
   </li><li><a href="#chromaDBembedding_102" rel="nofollow">chromaDB的默认的embedding模型准备</a></li></ul> 
  </li><li><a href="#vanna_109" rel="nofollow">vanna脚本跑起来</a></li></ul> 
</div> 
<p></p> 
<h2><a id="VannaText2SQL_1"></a>Vanna和Text2SQL</h2> 
<p>TEXT2SQL即文本转SQL，是利用RAG和LLM来实现输入一段文本，系统自动生成SQL，甚至把数据结果用图表的方式展现出来，以下是一些典型的应用实例：</p> 
<pre><code>企业数据分析：企业内部的业务分析师或非技术员工可以通过自然语言提问，如“上个季度销售额最高的五个产品是什么？”Text2SQL系统能够自动将此类问题转换为SQL查询，从数据库中提取所需信息，无需手动编写SQL代码，大大提升了数据分析的效率和易用性。

智能客服系统：在客户服务场景中，Text2SQL可以帮助客服机器人理解用户的问题，比如查询订单状态、退换货政策等，并自动执行数据库查询以提供准确的答案，从而提升客服响应速度和服务质量。

个人助理与智能家居：在智能家居或个人助理应用中，用户可以通过语音或文本提出请求，如“明天早上7点提醒我开会”或“显示最近一周的电费消耗情况”，Text2SQL技术能够解析这些请求并转换成数据库查询指令，与家庭自动化系统或个人日程管理系统交互，实现智能化控制和信息反馈。

电子商务平台：电商平台可以利用Text2SQL快速处理用户的商品搜索请求，如“红色高跟鞋尺码37且价格低于500元”，系统自动构建SQL查询，从商品数据库中筛选出符合条件的商品列表。

金融行业报告生成：在金融分析领域，分析师可以提出复杂的需求，如“统计过去一年内公司A的日均交易量并对比行业平均值”，Text2SQL能够帮助自动生成相应的SQL查询，从海量金融数据中提取所需信息，辅助决策制定。

健康医疗信息查询：在医疗信息系统中，医生或研究人员可以通过自然语言查询患者病历、药物信息或疾病统计数据，Text2SQL能够将这些查询转换为SQL，快速检索电子病历系统或医学数据库中的相关记录。
</code></pre> 
<p>这些场景展示了Text2SQL如何作为自然语言处理和数据库交互的桥梁，简化数据查询流程，提高数据获取的效率和灵活性。随着自然语言处理技术的进步，Text2SQL的应用将会越来越广泛，为跨领域用户提供更加便捷的数据访问方式。</p> 
<h2><a id="_17"></a>环境安装和数据准备</h2> 
<p>此处使用私有化的ollama的环境和本地的向量数据库chromaDB和词向量嵌入模型all-MiniLM-L6-v2来搭建本地化环境，并连接到mysql数据库，进行数据分析。<br> 这里使用的是centos7 ，并有一块11G显存的GeForce GTX 1080 Ti，本文编制的时候，使用的是vanna 0.5.4版本。</p> 
<h3><a id="conda_20"></a>conda虚拟环境安装</h3> 
<p>此处默认已经安装了conda环境，创建虚拟环境：</p> 
<pre><code class="prism language-bash">conda create <span class="token parameter variable">-n</span> vanna <span class="token parameter variable">-y</span> <span class="token assign-left variable">python</span><span class="token operator">=</span><span class="token number">3.9</span>
</code></pre> 
<p>激活环境</p> 
<pre><code class="prism language-bash">conda activate vanna
</code></pre> 
<p>安装包，当然ipykernel可以不安装，看需要</p> 
<pre><code class="prism language-bash">pip <span class="token function">install</span> <span class="token string">'vanna[chromadb,ollama,mysql]'</span>
pip <span class="token function">install</span> ipykernel
</code></pre> 
<h3><a id="_40"></a>数据准备</h3> 
<p>在待连接的mysql数据库的，demodb数据库中新建表和记录，当然可以在不同数据库里面创建表，并插入不同的数据，根据实际情况可以调整SQL，并调整后续步骤的python代码中连接数据库的内容。</p> 
<pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> vuser <span class="token punctuation">(</span>
    <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span> 
    username <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户名'</span><span class="token punctuation">,</span>
    email <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'电子邮件'</span><span class="token punctuation">,</span> 
    age <span class="token keyword">INT</span> <span class="token keyword">COMMENT</span> <span class="token string">'年龄'</span><span class="token punctuation">,</span>
    gender <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'性别（男/女）'</span><span class="token punctuation">,</span>
    city <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'城市'</span>
<span class="token punctuation">)</span> <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'用户信息表'</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span><span class="token operator">=</span>utf8mb4 <span class="token keyword">COLLATE</span><span class="token operator">=</span>utf8mb4_unicode_ci<span class="token punctuation">;</span>


<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> vuser <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> username<span class="token punctuation">,</span> email<span class="token punctuation">,</span> age<span class="token punctuation">,</span> gender<span class="token punctuation">,</span> city<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token string">'zhangsan@example.com'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token string">'北京'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">,</span> <span class="token string">'lisi@example.com'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token string">'上海'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'王五'</span><span class="token punctuation">,</span> <span class="token string">'wangwu@example.com'</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token string">'广州'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'赵六'</span><span class="token punctuation">,</span> <span class="token string">'zhaoliu@example.com'</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token string">'深圳'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'小明'</span><span class="token punctuation">,</span> <span class="token string">'xiaoming@example.com'</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token string">'成都'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'小红'</span><span class="token punctuation">,</span> <span class="token string">'xiaohong@example.com'</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token string">'重庆'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'小华'</span><span class="token punctuation">,</span> <span class="token string">'xiaohua@example.com'</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token string">'天津'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">'小丽'</span><span class="token punctuation">,</span> <span class="token string">'xiaoli@example.com'</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token string">'南京'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token string">'小李'</span><span class="token punctuation">,</span> <span class="token string">'xiaoli2@example.com'</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token string">'武汉'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">'小美'</span><span class="token punctuation">,</span> <span class="token string">'xiaomei@example.com'</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token string">'西安'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="ollama_67"></a>ollama环境准备</h3> 
<h4><a id="ollama_68"></a>ollama安装和运行</h4> 
<p>注：使用root或者有sudo权限的用户</p> 
<pre><code class="prism language-bash"><span class="token function">curl</span> <span class="token parameter variable">-fsSL</span> https://ollama.com/install.sh <span class="token operator">|</span> <span class="token function">sh</span>
<span class="token function">service</span> ollama stop
</code></pre> 
<p>默认是绑定在127.0.0.1的IP，若需要绑定到指定IP，那么采用如下:</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">OLLAMA_HOST</span><span class="token operator">=</span>xx.xx.xx.71:11434
<span class="token function">nohup</span> ollama serve <span class="token operator">&amp;</span>    
</code></pre> 
<p>这样就绑定到某个非127.0.0.1的IP上了，方便其他服务器访问。</p> 
<h4><a id="ollama_84"></a>ollama下载模型</h4> 
<pre><code>这里使用qwen的7b模型，根据实际情况，下载还是比较快的。
</code></pre> 
<pre><code class="prism language-bash">ollama run qwen:7b
</code></pre> 
<p>下载后会自动进入命令行聊天交互界面，可以测试下，最后可以输入/bye退出聊天。</p> 
<h4><a id="API_92"></a>测试下API方式正常使用</h4> 
<pre><code class="prism language-bash"><span class="token function">curl</span> http://xx.xx.xx.71:11434/api/chat <span class="token parameter variable">-d</span> <span class="token string">'{
"model": "qwen:7b",
"messages": [
{ "role": "user", "content": "什么是股票?" }
]
}'</span>
</code></pre> 
<h3><a id="chromaDBembedding_102"></a>chromaDB的默认的embedding模型准备</h3> 
<p>当然这个模型在后续的VANNA脚本运行起来的时候会自动下载，但是可能有时候快有时候慢，在魔搭上传了一个模型<br> https://www.modelscope.cn/models/wengad/all-MiniLM-L6-v2/summary (80MB+)，下载onnx.tar.gz后，直接放到$HOME/.cache/chroma/onnx_models/all-MiniLM-L6-v2/onnx目录下，解压开来即可。</p> 
<hr> 
<p>到这里环境就基本准备好了，可以跑脚本，启动下服务了。</p> 
<h2><a id="vanna_109"></a>vanna脚本跑起来</h2> 
<p>这里连接的ollama模型名称，地址根据需要进行修改，还有连接的用于生成SQL数据分析的MYSQL数据库连接和库名等根据需要修改。</p> 
<p>这里的脚本chroma使用的local的模型，运行了以下脚本后，会在运行的目录下生成chroma.sqlite3文件，存放训练的数据，别删了，删了那训练数据就没了，要重新来。</p> 
<p>比如保存成testv.py</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> vanna<span class="token punctuation">.</span>ollama <span class="token keyword">import</span> Ollama
<span class="token keyword">from</span> vanna<span class="token punctuation">.</span>chromadb <span class="token keyword">import</span> ChromaDB_VectorStore

<span class="token keyword">class</span> <span class="token class-name">MyVanna</span><span class="token punctuation">(</span>ChromaDB_VectorStore<span class="token punctuation">,</span> Ollama<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> config<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        ChromaDB_VectorStore<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> config<span class="token operator">=</span>config<span class="token punctuation">)</span>
        Ollama<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> config<span class="token operator">=</span>config<span class="token punctuation">)</span>

vn <span class="token operator">=</span> MyVanna<span class="token punctuation">(</span>config<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'model'</span><span class="token punctuation">:</span> <span class="token string">'qwen:7b'</span><span class="token punctuation">,</span><span class="token string">'ollama_host'</span><span class="token punctuation">:</span><span class="token string">'http://xx.xx.xx.71:11434'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>





vn<span class="token punctuation">.</span>connect_to_mysql<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'xx.xx.xx.101'</span><span class="token punctuation">,</span> dbname<span class="token operator">=</span><span class="token string">'demodb'</span><span class="token punctuation">,</span> user<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'99099a'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">)</span>

<span class="token comment"># The information schema query may need some tweaking depending on your database. This is a good starting point.</span>
df_information_schema <span class="token operator">=</span> vn<span class="token punctuation">.</span>run_sql<span class="token punctuation">(</span><span class="token string">"SELECT * FROM INFORMATION_SCHEMA.COLUMNS"</span><span class="token punctuation">)</span>

<span class="token comment"># This will break up the information schema into bite-sized chunks that can be referenced by the LLM</span>
plan <span class="token operator">=</span> vn<span class="token punctuation">.</span>get_training_plan_generic<span class="token punctuation">(</span>df_information_schema<span class="token punctuation">)</span>


vn<span class="token punctuation">.</span>train<span class="token punctuation">(</span>ddl<span class="token operator">=</span><span class="token triple-quoted-string string">"""CREATE TABLE IF NOT EXISTS vuser (
    `id` INT PRIMARY KEY COMMENT '用户ID',
    username VARCHAR(50) COMMENT '用户名',
    email VARCHAR(100) COMMENT '电子邮件',
    age INT COMMENT '年龄',
    gender VARCHAR(10) COMMENT '性别（男/女）',
    city VARCHAR(50) COMMENT '城市'
) COMMENT='用户信息表' CHARACTER SET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
"""</span><span class="token punctuation">)</span>

<span class="token keyword">from</span> vanna<span class="token punctuation">.</span>flask <span class="token keyword">import</span> VannaFlaskApp
app <span class="token operator">=</span> VannaFlaskApp<span class="token punctuation">(</span>vn<span class="token punctuation">)</span>

</code></pre> 
<p>直接在以上创建的vanna虚拟环境中运行起来。</p> 
<pre><code class="prism language-bash">python testv.py
</code></pre> 
<p><img src="https://images2.imgbox.com/c5/08/Zfh1ZuH6_o.png" alt="在这里插入图片描述"><br> 如果前面嵌入模型没准备好，那么在问答的时候，第一次会下载模型，类似如下：<br> <img src="https://images2.imgbox.com/a3/5e/XkSvvJAA_o.png" alt="在这里插入图片描述"></p> 
<p>这样，就可以访问8084端口，进入页面，开始和系统交互了。<br> <img src="https://images2.imgbox.com/94/55/rdFJGHTc_o.png" alt=""></p> 
<p>注意：如果没有训练数据，那么点击Trainning Data，界面会提示错误。<br> <img src="https://images2.imgbox.com/39/e2/60JaDcnU_o.png" alt="在这里插入图片描述"><br> 这个是在代码里面添加了DDL语句，直接显示在界面了。<img src="https://images2.imgbox.com/c3/3d/FSdpwxBl_o.png" alt="在这里插入图片描述"></p> 
<p>交互实例：<br> <img src="https://images2.imgbox.com/c4/12/PfGeIyYS_o.png" alt="在这里插入图片描述">如果结果是正确的，那么点击 Were the results correct?下的YES按钮，那么系统会将问答的过程加入到训练的数据中，类似如下：<br> <img src="https://images2.imgbox.com/96/a0/xgljWif8_o.png" alt="在这里插入图片描述"><br> 统计+图表分析<br> <img src="https://images2.imgbox.com/38/66/fTGvemUO_o.png" alt="在这里插入图片描述">点击结果正确，就可以将问答又加入到库中<br> <img src="https://images2.imgbox.com/b3/77/zf2MLpV4_o.png" alt="在这里插入图片描述"><br> 也可以通过“Add training data”自行添加。</p> 
<hr> 
<p>完结，有啥问题也可以留言沟通</p> 
<hr> 
<p>展望：如果这玩意能够生成ETL代码，搞定这事，就更好了，解放思路了，有搞头！</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9c564c1d45dbe9ba9a9b90bf1f325cd6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">一眼十行的阅读方法：Kimi Copilot Chrome 插件详细解析</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9ffaad9a42e2a076b9025ff524b0bbbf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">使用ffmpeg.js在Web上实现流媒体处理</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>