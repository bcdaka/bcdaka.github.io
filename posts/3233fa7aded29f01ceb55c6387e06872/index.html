<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于 Hive 数据仓库的教育大数据分析平台（伪分布式） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/3233fa7aded29f01ceb55c6387e06872/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="基于 Hive 数据仓库的教育大数据分析平台（伪分布式）">
  <meta property="og:description" content="一、Hive 部署 （一）Linux 环境搭建 一、虚拟机的安装 VMware (Virtual Machine ware ）是一个“虚拟 PC ”软件公司，提供服务器、桌 面虚拟化的解决方案。 使用的虚拟软件： VMware15 二、Linux 系统安装 1. 环境准备 VMware15.5 pro Centos7 镜像文件 (mini) 2. 虚拟机安装 2.1 新建虚拟机，选择自定义 2.2 选择下一步安装程序光盘映像文件（ iso ） 2.3 选择稍后安装操作系统 2.4 选择Liunx（L）版本Centos7 2.5 选择虚拟机的名称和位置 2.6配置处理器的数量和每个处理器的内核数量 2.7配置虚拟机的内存 2.8配置网络类型 2.9选择 I/OK控制器类型 2.10选择 虚拟磁盘类型 2.11选择磁盘 2.12配置磁盘大小 2.13配置系统 2.14 完成配置开启虚拟机 三、Centos 系统安装 1. 开启虚拟机 2. 安装 CentOS7 3. 选择语言（默认为 English ） 4. 日期和时间亚洲 / 上海（这里默认为最小） 5. 安装位置 6. 系统网络 7.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-22T21:03:35+08:00">
    <meta property="article:modified_time" content="2024-05-22T21:03:35+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于 Hive 数据仓库的教育大数据分析平台（伪分布式）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2><span style="color:#000000;">一、Hive 部署</span></h2> 
<h3><span style="color:#000000;">（一）</span><span style="color:#000000;">Linux </span><span style="color:#000000;">环境搭建 </span></h3> 
<h4><span style="color:#000000;">一、虚拟机的安装 </span></h4> 
<div> 
 <span style="color:#000000;">VMware (Virtual Machine ware</span> 
 <span style="color:#000000;">）是一个“虚拟 </span> 
 <span style="color:#000000;">PC</span> 
 <span style="color:#000000;">”软件公司，提供服务器、桌 </span> 
</div> 
<div> 
 <span style="color:#000000;">面虚拟化的解决方案。 </span> 
</div> 
<div> 
 <span style="color:#000000;">使用的虚拟软件：</span> 
 <span style="color:#000000;">VMware15 </span> 
</div> 
<h4><span style="color:#000000;">二、</span><span style="color:#000000;">Linux </span><span style="color:#000000;">系统安装 </span></h4> 
<div> 
 <span style="color:#000000;">1.</span> 
 <span style="color:#000000;">环境准备 </span> 
</div> 
<div> 
 <span style="color:#000000;">VMware15.5 pro </span> 
</div> 
<div> 
 <span style="color:#000000;">Centos7 </span> 
 <span style="color:#000000;">镜像文件</span> 
 <span style="color:#000000;">(mini) </span> 
</div> 
<div> 
 <span style="color:#000000;">2.</span> 
 <span style="color:#000000;">虚拟机安装 </span> 
</div> 
<div> 
 <span style="color:#000000;">2.1 </span> 
 <span style="color:#000000;">新建虚拟机，选择自定义</span> 
</div> 
<div> 
 <img alt="" height="557" src="https://images2.imgbox.com/5d/b2/g96jghQM_o.png" width="586"> 
</div> 
<div> 
 <span style="color:#000000;">2.2 </span> 
 <span style="color:#000000;">选择下一步安装程序光盘映像文件（</span> 
 <span style="color:#000000;">iso</span> 
 <span style="color:#000000;">） </span> 
</div> 
<div> 
 <img alt="" height="557" src="https://images2.imgbox.com/2c/88/z4GGOmWs_o.png" width="586"> 
</div> 
<div></div> 
<div> 
 <span style="color:#000000;">2.3 </span> 
 <span style="color:#000000;">选择稍后安装操作系统</span> 
</div> 
<div> 
 <img alt="" height="557" src="https://images2.imgbox.com/8a/a9/9Z6UNMSo_o.png" width="586"> 
</div> 
<div> 
 <span style="color:#000000;">2.4 选择Liunx（L）版本Centos7</span> 
</div> 
<div> 
 <img alt="" height="557" src="https://images2.imgbox.com/7a/f0/MIVmosMD_o.png" width="586"> 
</div> 
<div> 
 <span style="color:#000000;">2.5 </span> 
 <span style="color:#000000;">选择虚拟机的名称和位置</span> 
</div> 
<div> 
 <img alt="" height="560" src="https://images2.imgbox.com/7d/56/bnJT9hVd_o.png" width="586"> 
</div> 
<div>
  2.6配置处理器的数量和每个处理器的内核数量 
</div> 
<div> 
 <img alt="" height="557" src="https://images2.imgbox.com/ad/41/txwxfC7M_o.png" width="586"> 
</div> 
<div>
  2.7配置虚拟机的内存 
</div> 
<div> 
 <img alt="" height="557" src="https://images2.imgbox.com/2f/10/jVdXAjCr_o.png" width="586"> 
</div> 
<div>
  2.8配置网络类型 
</div> 
<div> 
 <img alt="" height="557" src="https://images2.imgbox.com/6b/42/UZTgVJBw_o.png" width="586"> 
</div> 
<div>
  2.9选择 I/OK控制器类型 
</div> 
<div> 
 <img alt="" height="557" src="https://images2.imgbox.com/74/07/H08yjsZf_o.png" width="586"> 
</div> 
<div>
  2.10选择 虚拟磁盘类型 
</div> 
<div> 
 <img alt="" height="557" src="https://images2.imgbox.com/20/14/oYwHavNa_o.png" width="586"> 
</div> 
<div>
  2.11选择磁盘 
</div> 
<div> 
 <img alt="" height="557" src="https://images2.imgbox.com/7e/3b/Y28IbisV_o.png" width="586"> 
</div> 
<div>
  2.12配置磁盘大小 
</div> 
<div> 
 <img alt="" height="557" src="https://images2.imgbox.com/fd/dd/WENjTHI1_o.png" width="586"> 
</div> 
<div>
  2.13配置系统 
</div> 
<div>
    
 <img alt="" height="557" src="https://images2.imgbox.com/62/67/WW87ggja_o.png" width="586"> 
</div> 
<div> 
 <img alt="" height="599" src="https://images2.imgbox.com/f6/4f/BWpXaov5_o.png" width="960"> 
</div> 
<div>
  2.14 完成配置开启虚拟机 
</div> 
<div> 
 <img alt="" height="1029" src="https://images2.imgbox.com/6a/09/X7CIpFcp_o.png" width="1200"> 
</div> 
<h4><span style="color:#000000;">三、</span><span style="color:#000000;">Centos </span><span style="color:#000000;">系统安装 </span></h4> 
<div> 
 <span style="color:#000000;">1.</span> 
 <span style="color:#000000;">开启虚拟机 </span> 
</div> 
<div> 
 <span style="color:#000000;">2.</span> 
 <span style="color:#000000;">安装 </span> 
 <span style="color:#000000;">CentOS7 </span> 
</div> 
<div> 
 <img alt="" height="1029" src="https://images2.imgbox.com/47/27/ZQ34y64M_o.png" width="1200"> 
</div> 
<div> 
 <span style="color:#000000;">3.</span> 
 <span style="color:#000000;">选择语言（默认为 </span> 
 <span style="color:#000000;">English</span> 
 <span style="color:#000000;">） </span> 
</div> 
<div> 
 <img alt="" height="879" src="https://images2.imgbox.com/7c/49/DTnaXV4g_o.png" width="1200"> 
</div> 
<div> 
 <span style="color:#000000;">4.</span> 
 <span style="color:#000000;">日期和时间亚洲</span> 
 <span style="color:#000000;">/</span> 
 <span style="color:#000000;">上海（这里默认为最小） </span> 
</div> 
<div> 
 <img alt="" height="601" src="https://images2.imgbox.com/04/03/8RCbR48G_o.png" width="799"> 
</div> 
<div> 
 <span style="color:#000000;">5.</span> 
 <span style="color:#000000;">安装位置 </span> 
</div> 
<div> 
 <img alt="" height="601" src="https://images2.imgbox.com/97/77/ACZfA6BJ_o.png" width="799"> 
</div> 
<div> 
 <span style="color:#000000;">6.</span> 
 <span style="color:#000000;">系统网络</span> 
</div> 
<div> 
 <img alt="" height="601" src="https://images2.imgbox.com/e1/7c/naojKSrn_o.png" width="799"> 
</div> 
<div> 
 <span style="color:#000000;">7.</span> 
 <span style="color:#000000;">开始安装 </span> 
</div> 
<div> 
 <img alt="" height="601" src="https://images2.imgbox.com/81/e3/71t8xmCi_o.png" width="799"> 
</div> 
<div> 
 <span style="color:#000000;">8.</span> 
 <span style="color:#000000;">设置 </span> 
 <span style="color:#000000;">ROOT </span> 
 <span style="color:#000000;">密码 </span> 
</div> 
<div> 
 <img alt="" height="601" src="https://images2.imgbox.com/06/e4/D5JUU9Di_o.png" width="799"> 
</div> 
<div> 
 <img alt="" height="601" src="https://images2.imgbox.com/68/ac/Hhhw6aGd_o.png" width="799"> 
</div> 
<div> 
 <img alt="" height="601" src="https://images2.imgbox.com/3e/78/vhCcc9Zu_o.png" width="799"> 
</div> 
<div> 
 <span style="color:#000000;">9.</span> 
 <span style="color:#000000;">安装完成后重启即可 </span> 
</div> 
<div> 
 <img alt="" height="601" src="https://images2.imgbox.com/99/90/Nq83nJwj_o.png" width="799"> 
</div> 
<div> 
 <span style="color:#000000;">10.</span> 
 <span style="color:#000000;">使用 </span> 
 <span style="color:#000000;">root </span> 
 <span style="color:#000000;">权限登录 </span> 
</div> 
<div> 
 <img alt="" height="804" src="https://images2.imgbox.com/96/02/5nG56xEN_o.png" width="1200"> 
</div> 
<h4><span style="color:#000000;">四、静态网络配置 </span></h4> 
<div> 
 <span style="color:#000000;">1.查看网络是否连通</span> 
 <pre><code>ping www.baidu.com</code></pre> 
</div> 
<div> 
 <span style="color:#000000;">2.</span> 
 <span style="color:#000000;">安装 </span> 
 <span style="color:#000000;">net-tools </span> 
 <pre><code>yum upgrade
yum install net-tools</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<div></div> 
<div>
  查看ip地址和网卡 
</div> 
<div> 
 <pre><code>ifconfip</code></pre> 
</div> 
<div> 
 <img alt="" height="336" src="https://images2.imgbox.com/ff/d3/kyWFB3vo_o.png" width="840"> 
</div> 
<div> 
 <span style="color:#000000;">3.</span> 
 <span style="color:#000000;">查看 </span> 
 <span style="color:#000000;">Mac </span> 
 <span style="color:#000000;">地址</span> 
</div> 
<div> 
 <img alt="" height="1010" src="https://images2.imgbox.com/7a/f8/Y1YCJc41_o.png" width="876"> 
</div> 
<div> 
 <span style="color:#000000;">4.</span> 
 <span style="color:#000000;">查看 </span> 
 <span style="color:#000000;">ip </span> 
 <span style="color:#000000;">地址的起始和结束地址 </span> 
</div> 
<div> 
 <img alt="" height="1029" src="https://images2.imgbox.com/65/cb/RHf05Lus_o.png" width="1200"> 
</div> 
<div> 
 <span style="color:#000000;">5.</span> 
 <span style="color:#000000;">修改网络配置文件 </span> 
</div> 
<div> 
 <pre><code>vi /etc/sysconfig/network-scripts/ifcfg-ens33</code></pre> 
</div> 
<div>
  修改BOOTPROTO为 
</div> 
<div>
  BOOTPROTO="static" 
</div> 
<div>
  修改ONBOOT为 
</div> 
<div>
  ONBOOT="yes" 
</div> 
<div> 
 <span style="color:#000000;">mac </span> 
 <span style="color:#000000;">地址为 </span> 
 <span style="color:#000000;">2 </span> 
 <span style="color:#000000;">步骤的 </span> 
 <span style="color:#000000;">enter </span> 
 <span style="color:#000000;">值</span> 
 <span style="color:#000000;">2 </span> 
</div> 
<div> 
 <span style="color:#000000;">ip </span> 
 <span style="color:#000000;">地址参照 </span> 
 <span style="color:#000000;">4 </span> 
 <span style="color:#000000;">步骤自行选择（必须在起始和结束的范围内） </span> 
</div> 
<div> 
 <span style="color:#000000;">子网掩码默认设置为 </span> 
 <span style="color:#000000;">255.255.255.0 </span> 
</div> 
<div> 
 <span style="color:#000000;">网关的值为将 </span> 
 <span style="color:#000000;">ip </span> 
 <span style="color:#000000;">地址中最后一段的值改为 </span> 
 <span style="color:#000000;">2 </span> 
</div> 
<div> 
 <span style="color:#000000;">DNS </span> 
 <span style="color:#000000;">使用谷歌提供的免费 </span> 
 <span style="color:#000000;">dns1</span> 
 <span style="color:#000000;">：</span> 
 <span style="color:#000000;">8.8.8.8 </span> 
</div> 
<div> 
 <img alt="" height="350" src="https://images2.imgbox.com/81/f9/RryDHnhm_o.png" width="410"> 
</div> 
<div> 
 <span style="color:#000000;">6.</span> 
 <span style="color:#000000;">重启网络服务，查看是否配置成功 </span> 
 <pre><code>systemctl restart network
ping www.baidu.com</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<div> 
 <p><img alt="" height="167" src="https://images2.imgbox.com/48/e1/Tg75GRkS_o.png" width="691"></p> 
 <p><span style="color:#000000;">7.</span><span style="color:#000000;">重启虚拟机后，查看是否连通网络（</span><span style="color:#000000;">ip </span><span style="color:#000000;">地址并未改变，且能连通网络） </span></p> 
 <pre><code>reboot
ifconfig
ping www.baidu.com</code></pre> 
</div> 
<h4><img alt="" height="401" src="https://images2.imgbox.com/97/f1/ljmDz3dK_o.png" width="725"></h4> 
<h4><span style="color:#000000;">五、虚拟配置 </span></h4> 
<p><span style="color:#000000;">（一）X-Shell远程连接Linux</span></p> 
<p><span style="color:#000000;">1.新建会话连接</span></p> 
<p><img alt="" height="1029" src="https://images2.imgbox.com/68/0d/90GEkJXj_o.png" width="1200"></p> 
<p>2.设置名称主机</p> 
<p><img alt="" height="834" src="https://images2.imgbox.com/3a/0e/nPSGlgRR_o.png" width="872"></p> 
<p>3.设置用户身份认证（Linux的账号 密码 ）</p> 
<p><img alt="" height="834" src="https://images2.imgbox.com/d4/19/451aXDCy_o.png" width="872"></p> 
<p>4.连接成功</p> 
<p><img alt="" height="799" src="https://images2.imgbox.com/f3/10/ZsmdCNpJ_o.png" width="1200"></p> 
<h5><span style="color:#000000;">（二）</span><span style="color:#000000;">Hadoop </span><span style="color:#000000;">的部署 </span></h5> 
<div> 
 <span style="color:#000000;">1.</span> 
 <span style="color:#000000;">在所有虚拟机根目录下新建文件夹 </span> 
 <span style="color:#000000;">export</span> 
 <span style="color:#000000;">，</span> 
 <span style="color:#000000;">export </span> 
 <span style="color:#000000;">文件夹中新建 </span> 
 <span style="color:#000000;">data</span> 
 <span style="color:#000000;">、</span> 
 <span style="color:#000000;">servers </span> 
</div> 
<div> 
 <span style="color:#000000;">和 </span> 
 <span style="color:#000000;">software </span> 
 <span style="color:#000000;">文件 </span> 
 <pre><code>mkdir -p /export/data
mkdir -p /export/servers
mkdir -p /export/software</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<div> 
 <img alt="" height="161" src="https://images2.imgbox.com/6d/4b/eyCtYu1s_o.png" width="707"> 
</div> 
<div> 
 <span style="color:#000000;">2.</span> 
 <span style="color:#000000;">准备安装包 </span> 
</div> 
<div> 
 <span style="color:#000000;">hadoop-2.7.4.tar.gz </span> 
</div> 
<div> 
 <span style="color:#000000;">jdk-8u161-linux-x64.tar.gz </span> 
</div> 
<div> 
 <span style="color:#000000;">3.</span> 
 <span style="color:#000000;">在 </span> 
 <span style="color:#000000;">Xshell </span> 
 <span style="color:#000000;">先进入 </span> 
 <span style="color:#000000;">software </span> 
 <span style="color:#000000;">文件内，然后下载 </span> 
 <span style="color:#000000;">rz </span> 
 <span style="color:#000000;">命令，并使用 </span> 
 <span style="color:#000000;">rz </span> 
 <span style="color:#000000;">命令进行文件 </span> 
</div> 
<div> 
 <span style="color:#000000;">上传，此时会弹出上传的窗口，选择要上传的文件，点击确定即可将本地文件上 </span> 
</div> 
<div> 
 <span style="color:#000000;">传到 </span> 
 <span style="color:#000000;">Linux </span> 
 <span style="color:#000000;">上。 </span> 
 <pre><code>cd /export/software
yum -y install lrzsz
rz</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<h5><img alt="" height="571" src="https://images2.imgbox.com/21/78/fzzIz4Gq_o.png" width="759"></h5> 
<h5><img alt="" height="420" src="https://images2.imgbox.com/26/35/lKUoHvvS_o.png" width="539"></h5> 
<h5>4.ls查看安装包是否导入</h5> 
<p><img alt="" height="74" src="https://images2.imgbox.com/3d/e6/34beDWDS_o.png" width="1151"></p> 
<h5><span style="color:#000000;">5.</span><span style="color:#000000;">安装 </span><span style="color:#000000;">JDK</span><span style="color:#000000;">（所有虚拟机都要操作） </span></h5> 
<div> 
 <span style="color:#000000;">5.1 </span> 
 <span style="color:#000000;">解压 </span> 
 <span style="color:#000000;">jdk </span> 
 <pre><code>cd /export/software
tar -zxvf jdk-8u161-linux-x64.tar.gz -C /export/servers/</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<div> 
 <span style="color:#000000;">5.2 </span> 
 <span style="color:#000000;">重命名 </span> 
 <span style="color:#000000;">jdk </span> 
 <span style="color:#000000;">目录 </span> 
 <pre><code>cd /export/servers
mv jdk1.8.0_161 jdk</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<div> 
 <span style="color:#000000;">5.3 </span> 
 <span style="color:#000000;">配置环境变量 </span> 
 <pre><code>vi /etc/profile
#tip:在配置文件末尾追加
export JAVA_HOME=/export/servers/jdk
export PATH=$PATH:$JAVA_HOME/bin
export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<div> 
 <img alt="" height="34" src="https://images2.imgbox.com/9e/27/jpdQQ7cX_o.png" width="549"> 
</div> 
<div> 
 <img alt="" height="770" src="https://images2.imgbox.com/57/e3/bGt2pamz_o.png" width="1200"> 
</div> 
<div> 
 <span style="color:#000000;">5.4 </span> 
 <span style="color:#000000;">使配置文件生效 </span> 
</div> 
<div> 
 <pre><code>source /etc/profile</code></pre> 
</div> 
<div> 
 <span style="color:#000000;">5.5 </span> 
 <span style="color:#000000;">查看是否配置成功 </span> 
</div> 
<div> 
 <pre><code>java -version</code></pre> 
</div> 
<div> 
 <img alt="" height="82" src="https://images2.imgbox.com/f0/82/KRRaqSqM_o.png" width="641"> 
</div> 
<div> 
 <span style="color:#000000;">6.Hadoop </span> 
 <span style="color:#000000;">安装（所有虚拟机都要操作） </span> 
</div> 
<div> 
 <span style="color:#000000;">6.1 </span> 
 <span style="color:#000000;">解压 </span> 
 <span style="color:#000000;">hadoop </span> 
 <pre><code>cd /export/software
tar -zxvf hadoop-2.7.4.tar.gz -C /export/servers/</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<div> 
 <span style="color:#000000;">6.2 </span> 
 <span style="color:#000000;">打开配置文件 </span> 
</div> 
<div> 
 <pre><code>vi /etc/profile</code></pre> 
</div> 
<div> 
 <span style="color:#000000;">6.3 </span> 
 <span style="color:#000000;">配置 </span> 
 <span style="color:#000000;">hadoop </span> 
 <span style="color:#000000;">环境变量 </span> 
 <pre><code>#tip:在文件末尾追加
export HADOOP_HOME=/export/servers/hadoop-2.7.4
export PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOME/sbin</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<div> 
 <img alt="" height="141" src="https://images2.imgbox.com/81/f0/9Zjrep8a_o.png" width="715"> 
</div> 
<div> 
 <span style="color:#000000;">6.4 </span> 
 <span style="color:#000000;">使配置文件生效 </span> 
</div> 
<div> 
 <pre><code>source /etc/profile</code></pre> 
</div> 
<div> 
 <span style="color:#000000;">6.5 </span> 
 <span style="color:#000000;">查看是否配置成功 </span> 
</div> 
<div> 
 <pre><code>hadoop version</code></pre> 
</div> 
<div></div> 
<div> 
 <img alt="" height="140" src="https://images2.imgbox.com/db/3f/ZVnsxL3t_o.png" width="1061"> 
</div> 
<div>
  6.6配置ssh免密登录 
</div> 
<div> 
 <strong>6.6.1生成密钥</strong> 
</div> 
<div> 
 <pre><code>ssh-keygen -t rsa
</code></pre> 
 <p>输入上面的代码后回车四次</p> 
</div> 
<div> 
 <img alt="" height="419" src="https://images2.imgbox.com/b4/6c/EOCGDEl4_o.png" width="757"> 
</div> 
<div>
  6.6.2 
 <strong>把公钥拷贝到本台虚拟机上面去</strong> 
</div> 
<div> 
 <pre><code>ssh-copy-id localhost</code></pre> 
 <p><img alt="" height="351" src="https://images2.imgbox.com/9a/72/BCwfJ4Zl_o.png" width="1175"></p> 
</div> 
<div>
  6.6.4 
 <strong>验证一下是否需要密码</strong> 
</div> 
<div> 
 <img alt="" height="79" src="https://images2.imgbox.com/66/36/ZB6qJlWn_o.png" width="647"> 
</div> 
<div> 
 <span style="color:#000000;">7.Hadoop </span> 
 <span style="color:#000000;">集群配置 </span> 
</div> 
<div> 
 <span style="color:#000000;">7.1 </span> 
 <span style="color:#000000;">进入主节点配置目录 </span> 
</div> 
<div> 
 <pre><code>cd /export/servers/hadoop-2.7.4/etc/hadoop/</code></pre> 
</div> 
<div> 
 <span style="color:#000000;">7.2 </span> 
 <span style="color:#000000;">修改 </span> 
 <span style="color:#000000;">hadoop-env.sh </span> 
 <span style="color:#000000;">文件 </span> 
 <pre><code>vi hadoop-env.sh
#tip:找到相应位置，添加这段话
export JAVA_HOME=/export/servers/jdk</code></pre> 
</div> 
<div> 
 <img alt="" height="171" src="https://images2.imgbox.com/4d/05/k75K5Ng6_o.png" width="776"> 
</div> 
<div> 
 <span style="color:#000000;">7.3 </span> 
 <span style="color:#000000;">修改 </span> 
 <span style="color:#000000;">core-site.xml </span> 
 <span style="color:#000000;">文件 </span> 
</div> 
<div> 
 <pre><code>vi core-site.xml</code></pre> 
</div> 
<div> 
 <span style="color:#000000;">#tip:</span> 
 <span style="color:#000000;">下图中乱码部分为注释代码，可以删掉，不影响 </span> 
</div> 
<div> 
 <span style="color:#000000;">&lt;configuration&gt;</span> 
 <pre><code>&lt;configuration&gt;
	&lt;property&gt;
		&lt;name&gt;hadoop.tmp.dir&lt;/name&gt;
		&lt;value&gt;file:/export/servers/hadoop-2.7.4/tmp&lt;/value&gt;
		&lt;description&gt;Abase for other temporary directories.&lt;/description&gt;
	&lt;/property&gt;
	&lt;property&gt;
		&lt;name&gt;fs.defaultFS&lt;/name&gt;
		&lt;value&gt;hdfs://localhost:9000&lt;/value&gt;
	&lt;/property&gt;
&lt;/configuration&gt;
</code></pre> 
</div> 
<div> 
 <img alt="" height="281" src="https://images2.imgbox.com/65/21/Y6Vigvd1_o.png" width="847"> 
</div> 
<div> 
 <span style="color:#000000;">7.4 </span> 
 <span style="color:#000000;">修改 </span> 
 <span style="color:#000000;">hdfs-site.xml </span> 
 <span style="color:#000000;">文件 </span> 
</div> 
<div> 
 <pre><code>vi hdfs-site.xml</code></pre> 
</div> 
<div> 
 <pre><code>&lt;configuration&gt;
	&lt;property&gt;
		&lt;name&gt;dfs.replication&lt;/name&gt; 
		&lt;value&gt;1&lt;/value&gt;
	&lt;/property&gt;
	&lt;property&gt;
		&lt;name&gt;dfs.namenode.name.dir&lt;/name&gt; 
		&lt;value&gt;file:/export/servers/hadoop-2.7.4/tmp/dfs/name&lt;/value&gt;
	&lt;/property&gt;
	&lt;property&gt;
		&lt;name&gt;dfs.datanode.data.dir&lt;/name&gt; 
		&lt;value&gt;file:/export/servers/hadoop-2.7.4/tmp/dfs/data&lt;/value&gt;
	&lt;/property&gt;
&lt;/configuration&gt;
</code></pre> 
</div> 
<div> 
 <img alt="" height="364" src="https://images2.imgbox.com/78/13/6Pnn58p1_o.png" width="895"> 
</div> 
<div>
  7.5修改mapred-site.xml 
</div> 
<div> 
 <pre><code>mv mapred-site.xml.template mapred-site.xml
vi mapred-site.xml</code></pre> 
 <pre><code>&lt;configuration&gt;
        &lt;property&gt;
                &lt;name&gt;mapreduce.framework.name&lt;/name&gt;
                &lt;value&gt;yarn&lt;/value&gt;
        &lt;/property&gt;
&lt;/configuration&gt;

</code></pre> 
 <p><img alt="" height="179" src="https://images2.imgbox.com/1e/ad/HGsIMcLS_o.png" width="630"></p> 
 <h5>7.6修改yarn-site.xml</h5> 
</div> 
<div> 
 <pre><code>vi yarn-site.xml</code></pre> 
</div> 
<div> 
 <pre><code>&lt;configuration&gt;
        &lt;property&gt;
                &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;
                &lt;value&gt;mapreduce_shuffle&lt;/value&gt;
        &lt;/property&gt;
&lt;/configuration&gt;</code></pre> 
 <p><img alt="" height="147" src="https://images2.imgbox.com/d4/24/DoZszUT7_o.png" width="652"></p> 
</div> 
<div> 
 <span style="color:#000000;">7.7</span> 
 <span style="color:#000000;">格式化文件系统（</span> 
 <span style="color:#000000;">successfully formatted </span> 
 <span style="color:#000000;">格式化成功）</span> 
</div> 
<div> 
 <pre><code>hdfs namenode -format</code></pre> 
</div> 
<p><img alt="" height="229" src="https://images2.imgbox.com/50/fa/EbnoPbCh_o.png" width="1200"></p> 
<h5><span style="color:#000000;">三、</span><span style="color:#000000;">Hadoop 启动</span></h5> 
<div> 
 <span style="color:#000000;">1.</span> 
 <span style="color:#000000;">启动集群 </span> 
</div> 
<div> 
 <span style="color:#000000;">1.1 </span> 
 <span style="color:#000000;">点启动所有 </span> 
 <span style="color:#000000;">HDFS </span> 
 <span style="color:#000000;">服务进程 </span> 
</div> 
<pre><code>start-dfs.sh</code></pre> 
<div> 
 <img alt="" height="250" src="https://images2.imgbox.com/60/80/scovm2wp_o.png" width="1200"> 
</div> 
<div> 
 <span style="color:#000000;">1.2 </span> 
 <span style="color:#000000;">启动所有 </span> 
 <span style="color:#000000;">HDFS </span> 
 <span style="color:#000000;">服务进程 </span> 
</div> 
<div> 
 <pre><code>start-yarn.sh</code></pre> 
</div> 
<div> 
 <img alt="" height="79" src="https://images2.imgbox.com/69/dc/ubLoQfEn_o.png" width="1200"> 
</div> 
<div>
  1.3一键启动集群 
</div> 
<div> 
 <pre><code>start-all.sh</code></pre> 
</div> 
<div> 
 <img alt="" height="192" src="https://images2.imgbox.com/ba/a5/KQRJguz7_o.png" width="776"> 
</div> 
<div> 
 <span style="color:#000000;">1.4</span> 
 <span style="color:#000000;">使用 </span> 
 <span style="color:#000000;">jps </span> 
 <span style="color:#000000;">命令查看进程 </span> 
</div> 
<div> 
 <img alt="" height="131" src="https://images2.imgbox.com/f6/6b/1dsT1vC8_o.png" width="455"> 
</div> 
<div></div> 
<div> 
 <h6><span style="color:#000000;">2.</span><span style="color:#000000;">关闭防火墙（所有虚拟机都要操作） </span></h6> 
 <pre><code>systemctl stop firewalld
#关闭防火墙</code></pre> 
 <pre><code>systemctl disable firewalld.service
#关闭防火墙开机启动</code></pre> 
</div> 
<div> 
 <p><img alt="" height="67" src="https://images2.imgbox.com/11/23/r41gIsTS_o.png" width="739"></p> 
 <p><span style="color:#000000;">3.</span><span style="color:#000000;">打开 </span><span style="color:#000000;">window </span><span style="color:#000000;">下</span></p> 
 <pre><code>firewall-cmd --state
# 查看防火墙状态</code></pre> 
 <p><img alt="" height="40" src="https://images2.imgbox.com/4a/5c/Df9tr3Cr_o.png" width="596"></p> 
 <p><span style="color:#000000;">的 </span><span style="color:#000000;">C:\Windows\System32\drivers\etc </span><span style="color:#000000;">打开 </span><span style="color:#000000;">hosts </span><span style="color:#000000;">文件，在文件末 </span></p> 
</div> 
<div> 
 <span style="color:#000000;">添加代码： </span> 
</div> 
<div> 
 <pre><code>192.168.230.222 hadoop</code></pre> 
</div> 
<div> 
 <span style="color:#000000;">4. </span> 
 <span style="color:#000000;">通 过 </span> 
 <span style="color:#000000;">UI </span> 
 <span style="color:#000000;">界 面 查 看 </span> 
 <span style="color:#000000;">Hadoop </span> 
 <span style="color:#000000;">运 行 状 态 ， 在 </span> 
 <span style="color:#000000;">Windows </span> 
 <span style="color:#000000;">系 统 下 ， 访 问 </span> 
</div> 
<div> 
 <span style="color:#000000;">http://hadoop:50070，或http://192.168.230.200:50070查看 HDFS </span> 
 <span style="color:#000000;">集群状态</span> 
</div> 
<div> 
 <img alt="" height="930" src="https://images2.imgbox.com/e5/bb/MADbRj6A_o.png" width="1200"> 
</div> 
<div> 
 <span style="color:#000000;">5. </span> 
 <span style="color:#000000;">在 </span> 
 <span style="color:#000000;">Windows </span> 
 <span style="color:#000000;">系统下，访问 </span> 
 <span style="color:#000000;">http://hadoop:8088，或http://192.168.230.200:8088 查看 Yarn </span> 
 <span style="color:#000000;">集群状态 </span> 
</div> 
<div> 
 <img alt="" height="930" src="https://images2.imgbox.com/c7/26/wdzBNzA5_o.png" width="1200"> 
</div> 
<h3><span style="color:#000000;">（二）</span><span style="color:#000000;">Hive </span><span style="color:#000000;">的部署 </span></h3> 
<div> 
 <span style="color:#000000;"><strong>Hive </strong></span> 
 <span style="color:#000000;"><strong>安装 </strong></span> 
</div> 
<div> 
 <span style="color:#000000;">第一步：打开 </span> 
 <span style="color:#000000;">X-Shell </span> 
 <span style="color:#000000;">软件，在 </span> 
 <span style="color:#000000;">hive </span> 
 <span style="color:#000000;">上进入</span> 
 <span style="color:#000000;">/export/software/</span> 
 <span style="color:#000000;">目录，指令如下： cd /export/software/ </span> 
</div> 
<div> 
 <pre><code>cd /export/software/</code></pre> 
</div> 
<div> 
 <span style="color:#000000;">第二步：使用指令 </span> 
 <span style="color:#000000;">rz </span> 
 <span style="color:#000000;">进行安装包上传，选择安装包 </span> 
 <span style="color:#000000;">apache-hive-2.3.9-bin.tar.gz</span> 
 <span style="color:#000000;">。 </span> 
</div> 
<div> 
 <div> 
  <span style="color:#000000;">ls </span> 
  <span style="color:#000000;">可查看到该目录 </span> 
 </div> 
 <div> 
  <span style="color:#000000;">下存在 apache-hive-2.3.9-bin.tar.gz 文件。</span> 
 </div> 
</div> 
<div> 
 <span style="color:#000000;">第三步：上传完毕后将该安装包解压到</span> 
 <span style="color:#000000;">/export/servers/</span> 
 <span style="color:#000000;">目录，使用如下指令： </span> 
</div> 
<div> 
 <pre><code>tar -zxvf apache-hive-2.3.9-bin.tar.gz -C /export/servers/</code></pre> 
</div> 
<div> 
 <span style="color:#000000;">解压完成后使用 </span> 
 <span style="color:#000000;">cd /export/servers/</span> 
 <span style="color:#000000;">进入该目录，</span> 
</div> 
<pre><code>cd /export/servers/</code></pre> 
<div>
  修改hive名称 
</div> 
<div> 
 <pre><code>mv apache-hive-2.3.9-bin hive-2.3.9
ls
</code></pre> 
 <p><img alt="" height="59" src="https://images2.imgbox.com/41/4f/XcwSTp3D_o.png" width="647"></p> 
</div> 
<div>
  配置环境 
</div> 
<div> 
 <pre><code>vi /etc/profile
export HIVE_HOME=/export/servers/hive-2.3.9
export PATH=$PATH:$HIVE_HOME/bin
</code></pre> 
 <p><img alt="" height="151" src="https://images2.imgbox.com/a0/f1/yzirxOJF_o.png" width="660"></p> 
 <pre><code>source /etc/profile 
</code></pre> 
</div> 
<div> 
 <p><span style="color:#000000;">2.安装mysql病配置sql服务器</span></p> 
 <p><span style="color:#000000;">2.1上传mysql安装包rz mysql-community-release-el7-5.noarch.rpm<br> 2.2 安装 rpm</span></p> 
 <pre><code>cd /export/sofrware
rpm -ivh mysql-community-release-el7-5.noarch.rpm</code></pre> 
 <p><img alt="" height="77" src="https://images2.imgbox.com/38/c1/1IgGuBr8_o.png" width="849"><br><span style="color:#000000;">2.3 执行安装</span></p> 
 <pre><code>yum install mysql-community-server</code></pre> 
 <p><img alt="" height="324" src="https://images2.imgbox.com/97/bd/psNg6FeE_o.png" width="1200"><br><br><span style="color:#000000;">2.4 设置开机启动并启动mysql服务</span></p> 
 <pre><code>systemctl enable mysqld
systemctl start mysqld</code></pre> 
 <p><br><span style="color:#000000;">ok,因为版本的原因，安装的mysql未自动生成密码，8.x版本以上会自动生成<br> 2.5 输入mysql ，启动mysql</span></p> 
 <p><span style="color:#000000;">mysql</span></p> 
 <p><img alt="" height="275" src="https://images2.imgbox.com/6e/5a/6BOsHhuv_o.png" width="820"></p> 
</div> 
<div>
  在mysql命令窗口执行,为了能让root用户可以操作hive 
 <br> abc123 为root密码 
</div> 
<div> 
 <pre><code>grant all privileges on *.* to 'root'@'%' identified by 'abc123' with grant option;</code></pre> 
 <p><img alt="" height="67" src="https://images2.imgbox.com/59/46/6mt4hmrv_o.png" width="852"></p> 
 <p>2.6 启动、关闭、重启服务</p> 
 <pre><code>systemctl start mysqld
systemctl stop mysqld
systemctl restart mysqld
</code></pre> 
 <p><img alt="" height="102" src="https://images2.imgbox.com/89/dd/xmLyzG5s_o.png" width="629"></p> 
</div> 
<div> 
 <span style="color:#000000;">第四步：</span> 
 <span style="color:#000000;">Hive </span> 
 <span style="color:#000000;">的配置。 </span> 
</div> 
<div> 
 <span style="color:#000000;">首先进入 </span> 
 <span style="color:#000000;">Hive </span> 
 <span style="color:#000000;">安装包下的 </span> 
 <span style="color:#000000;">conf </span> 
 <span style="color:#000000;">文件夹，将 </span> 
 <span style="color:#000000;">hive-env.sh.template </span> 
 <span style="color:#000000;">文件进行复制并 </span> 
</div> 
<div> 
 <span style="color:#000000;">重命名为 </span> 
 <span style="color:#000000;">hive-env.sh</span> 
 <span style="color:#000000;">。具体指令如下： </span> 
</div> 
<div> 
 <pre><code>cd /export/servers/hive-2.3.9/conf</code></pre> 
</div> 
<div> 
 <pre><code>cp hive-env.sh.template hive-env.sh</code></pre> 
</div> 
<div> 
 <span style="color:#000000;">然后修改 </span> 
 <span style="color:#000000;">hive-env.sh </span> 
 <span style="color:#000000;">文件，添加 </span> 
 <span style="color:#000000;">Hadoop </span> 
 <span style="color:#000000;">环境变量。 </span> 
</div> 
<div> 
 <span style="color:#000000;">修改指令： </span> 
</div> 
<div> 
 <pre><code>vi hive-env.sh</code></pre> 
</div> 
<div> 
 <span style="color:#000000;">在文件内容中找到</span> 
 <span style="color:#000000;">#HADOOP_HOME=${bin}/../../hadoop </span> 
 <span style="color:#000000;">这句话，将这句话修改 </span> 
</div> 
<div> 
 <span style="color:#000000;">成如下内容即可。 </span> 
</div> 
<div> 
 <pre><code>HADOOP_HOME=/export/servers/hadoop-2.7.4
export HIVE_CONF_DIR=/export/servers/hive-2.3.9/conf
export HIVE_AUX_JARS_PATH=/export/servers/hive-2.3.9/lib
</code></pre> 
</div> 
<div> 
 <img alt="" height="192" src="https://images2.imgbox.com/8f/4d/zYRFFeEF_o.png" width="1107"> 
</div> 
<div>
  4.2 配置hive-log4j2.properties和hive-site.xml 
</div> 
<div> 
 <pre><code>cd /export/servers/hive-2.3.9/conf/
cp hive-log4j2.properties.template hive-log4j2.properties</code></pre> 
</div> 
<div> 
 <span style="color:#000000;">之后在 </span> 
 <span style="color:#000000;">conf </span> 
 <span style="color:#000000;">目录下新建 </span> 
 <span style="color:#000000;">hive-site.xml </span> 
 <span style="color:#000000;">文件，并添加配置信息。 </span> 
</div> 
<div> 
 <span style="color:#000000;">新建文件并编辑如下： </span> 
</div> 
<div> 
 <pre><code>vi hive-site.xml</code></pre> 
</div> 
<div>
  编辑如下内容： 
 <br> 注：下述代码中，192.168.230.200为本机虚拟机ip地址，编辑时需要修改成自己的 
 <pre><code>&lt;configuration&gt;
   &lt;property&gt;
       &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;
       &lt;value&gt;jdbc:mysql://192.168.230.200:3306/hive?createDatabaseIfNotExist=true&amp;amp;useSSL=false&lt;/value&gt;
    &lt;/property&gt;
    &lt;property&gt;
       &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;
       &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt;
    &lt;/property&gt;
    &lt;property&gt;
           &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt;
           &lt;value&gt;root&lt;/value&gt;
    &lt;/property&gt;
    &lt;property&gt;
           &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt;
       &lt;value&gt;abc123&lt;/value&gt;
    &lt;/property&gt;
&lt;/configuration&gt;</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<div> 
 <img alt="" height="404" src="https://images2.imgbox.com/4f/90/MgPBFc8r_o.png" width="835"> 
</div> 
<div> 
 <span style="color:#000000;">最后将连接驱动的 </span> 
 <span style="color:#000000;">jar </span> 
 <span style="color:#000000;">包 </span> 
 <span style="color:#000000;">mysql-connector-java-5.1.40.jar </span> 
 <span style="color:#000000;">上传至 </span> 
 <span style="color:#000000;">Hive </span> 
 <span style="color:#000000;">安装包的 </span> 
 <span style="color:#000000;">lib </span> 
</div> 
<div> 
 <span style="color:#000000;">文件夹下。 </span> 
</div> 
<div> 
 <img alt="" height="945" src="https://images2.imgbox.com/d5/6a/JN9kjkMH_o.png" width="1200"> 
</div> 
<div>
  4.3 初始化数据库 
</div> 
<div> 
 <pre><code>schematool -dbType mysql -initSchema</code></pre> 
 <p><img alt="" height="251" src="https://images2.imgbox.com/98/94/rU3eAwKl_o.png" width="1200"></p> 
 <p>4.4启动hive</p> 
 <p><img alt="" height="311" src="https://images2.imgbox.com/b2/44/3PXydFan_o.png" width="1200"></p> 
</div> 
<h2><span style="color:#000000;">二、数据仓库分层</span></h2> 
<h3><span style="color:#000000;">（一）源数据层的实现 </span></h3> 
<div> 
 <span style="color:#000000;">源数据层是数据仓库的基础层，负责存储原始的、未经加工的数据。在数据仓库 </span> 
</div> 
<div> 
 <span style="color:#000000;">中，源数据层扮演着收集、存储和保留数据的角色。它是数据仓库中数据质量和 </span> 
</div> 
<div> 
 <span style="color:#000000;">数据完整性的基础，同时也是其他层的数据加工和转换的起点。源数据层的作用 </span> 
</div> 
<div> 
 <span style="color:#000000;">包括但不限于： </span> 
</div> 
<div> 
 <span style="color:#000000;">数据收集： 从各种数据源（如数据库、日志文件、</span> 
 <span style="color:#000000;">API </span> 
 <span style="color:#000000;">等）中收集原始数据。 </span> 
</div> 
<div> 
 <span style="color:#000000;">数据存储： 将原始数据存储在数据仓库中，通常使用原始格式或轻微加工后的 </span> 
</div> 
<div> 
 <span style="color:#000000;">格式存储。 </span> 
</div> 
<div> 
 <span style="color:#000000;">数据保留： 源数据层通常保留了历史数据，以便进行后续的数据分析、报表生 </span> 
</div> 
<div> 
 <span style="color:#000000;">成等操作。 </span> 
</div> 
<div> 
 <span style="color:#000000;">在实现数据仓库分层之前，需要启动 </span> 
 <span style="color:#000000;">Hadoop </span> 
 <span style="color:#000000;"> </span> 
 <span style="color:#000000;">Hive </span> 
 <span style="color:#000000;">实现数据库分层，具体操作步骤如下。 </span> 
</div> 
<div> 
 <span style="color:#000000;">创建数据库 </span> 
 <span style="color:#000000;">itcast_ods </span> 
</div> 
<div> 
 <span style="color:#000000;">在 </span> 
 <span style="color:#000000;">Hive </span> 
 <span style="color:#000000;">中创建数据库 </span> 
 <span style="color:#000000;">itcast_ods</span> 
 <span style="color:#000000;">，用于存储源数据层的源数据表，具体命令如下。 </span> 
</div> 
<div> 
 <pre><code>CREATE DATABASE IF NOT EXISTS itcast_ods;</code></pre> 
</div> 
<div> 
 <span style="color:#000000;">设置存储格式 </span> 
</div> 
<div> 
 <span style="color:#000000;">设置 </span> 
 <span style="color:#000000;">Hive </span> 
 <span style="color:#000000;">的属性 </span> 
 <span style="color:#000000;">hive.exec.orc .compression.strategy </span> 
 <span style="color:#000000;">的属性值为 </span> 
</div> 
<div> 
 <span style="color:#000000;">COMPRESSION</span> 
 <span style="color:#000000;">，配置压缩生效，具体命令如下。 </span> 
</div> 
<div> 
 <pre><code>Set hive.exec.orc.compression.strategy=COMPRESSION;</code></pre> 
</div> 
<div> 
 <span style="color:#000000;">创建源数据表 </span> 
 <span style="color:#000000;">web_chat_ems_ods </span> 
</div> 
<div> 
 <span style="color:#000000;">在 </span> 
 <span style="color:#000000;">Hive </span> 
 <span style="color:#000000;">的数据库 </span> 
 <span style="color:#000000;">itcast_ods </span> 
 <span style="color:#000000;">中创建源数据表 </span> 
 <span style="color:#000000;">web_chat_ems_ods </span> 
 <span style="color:#000000;">用于存储 </span> 
 <span style="color:#000000;">MySQL </span> 
</div> 
<div> 
 <span style="color:#000000;">数据库中用户会话信息表 </span> 
 <span style="color:#000000;">web_chat_ems_2019_07 </span> 
 <span style="color:#000000;">的数据，具体命令如下。 </span> 
 <pre><code>CREATE EXTERNAL TABLE IF NOT EXISTS itcast_ods.web_chat_ems (
  id INT comment '主键',
  create_date_time STRING comment '数据创建时间',
  session_id STRING comment '七陌sessionId',
  sid STRING comment '访客id',
  create_time STRING comment '会话创建时间',
  seo_source STRING comment '搜索来源',
  seo_keywords STRING comment '关键字',
  ip STRING comment 'IP地址',
  area STRING comment '地域',
  country STRING comment '所在国家',
  province STRING comment '省',
  city STRING comment '城市',
  origin_channel STRING comment '投放渠道',
  user_match STRING comment '所属坐席',
  manual_time STRING comment '人工开始时间',
  begin_time STRING comment '坐席领取时间 ',
  end_time STRING comment '会话结束时间',
  last_customer_msg_time_stamp STRING comment '客户最后一条消息的时间',
  last_agent_msg_time_stamp STRING comment '坐席最后一下回复的时间',
  reply_msg_count INT comment '客服回复消息数',
  msg_count INT comment '客户发送消息数',
  browser_name STRING comment '浏览器名称',
  os_info STRING comment '系统名称')
comment '访问会话信息表'
PARTITIONED BY(starts_time STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\t'
stored as orc
location '/user/hive/warehouse/itcast_ods.db/web_chat_ems_ods'
TBLPROPERTIES ('orc.compress'='ZLIB');</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<div> 
 <span style="color:#000000;">创建源数据表 </span> 
 <span style="color:#000000;">web_chat_text_ems_ods</span> 
 <span style="color:#000000;">。 </span> 
</div> 
<div> 
 <span style="color:#000000;">在 </span> 
 <span style="color:#000000;">Hive </span> 
 <span style="color:#000000;">的数据库 </span> 
 <span style="color:#000000;">itcast_ods </span> 
 <span style="color:#000000;">中创建源数据表 </span> 
 <span style="color:#000000;">web_chat_text_ems_ods </span> 
 <span style="color:#000000;">用于存储 </span> 
</div> 
<div> 
 <span style="color:#000000;">MySQL </span> 
 <span style="color:#000000;">数据库中用户会话信息表 </span> 
 <span style="color:#000000;">web_chat_text_ems_2019_07 </span> 
 <span style="color:#000000;">的数据，具体命令 </span> 
</div> 
<div> 
 <span style="color:#000000;">如下。 </span> 
 <pre><code>CREATE EXTERNAL TABLE IF NOT EXISTS itcast_ods.web_chat_text_ems_ods
(
id INT COMMENT "主键 ID",
referrer STRING COMMENT "上级来源页面",
from_url STRING COMMENT "会话来源页面",
landing_page_url STRING COMMENT "访客浏览页面",
url_title STRING COMMENT "页面标题",
platform_description STRING COMMENT "用户信息",
other_params STRING COMMENT "扩展字段",
history STRING COMMENT "历史访问记录"
)
COMMENT "用户会话信息附属表"
ROW FORMAT DELIMITED
FIELDS TERMINATED BY "\t"
STORED AS ORC
LOCATION "/user/hive/warehouse/itcast_ods.db/web_chat_text_ems_ods"
TBLPROPERTIES ("orc.compress"="ZLIB");</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<h3><span style="color:#000000;">（二）数据仓库层的实现 </span></h3> 
<div> 
 <span style="color:#000000;">数据仓库层通常用于存储源数据层清洗或转换后的数据，根据业务需求的不同， </span> 
</div> 
<div> 
 <span style="color:#000000;">清洗或转换后的数据也会有所不同。本项目的数据仓库层涉及明细层和业务层， </span> 
</div> 
<div> 
 <span style="color:#000000;">其中明细层用于存储源数据层清洗转换后的数据；业务层用于存储访问用户量和 </span> 
</div> 
<div> 
 <span style="color:#000000;">咨询用户量这两个指标的数据，实现数据仓库层的步骤如下。 </span> 
</div> 
<div> 
 <span style="color:#000000;">创建数据库 </span> 
 <span style="color:#000000;">itcast_dwd </span> 
</div> 
<div> 
 <span style="color:#000000;">在 </span> 
 <span style="color:#000000;">Hive </span> 
 <span style="color:#000000;">中创建数据库 </span> 
 <span style="color:#000000;">itcast_dwd </span> 
 <span style="color:#000000;">用于存储明细层的数据，具体命令如下。 </span> 
</div> 
<div> 
 <pre><code>CREATE DATABASE IF NOT EXISTS itcast_dwd;</code></pre> 
</div> 
<div> 
 <span style="color:#000000;">创建明细表 </span> 
 <span style="color:#000000;">visit _consult_dwd </span> 
</div> 
<div> 
 <span style="color:#000000;">在</span> 
 <span style="color:#000000;">Hive </span> 
 <span style="color:#000000;">的数据库 </span> 
 <span style="color:#000000;">itcast_dwd </span> 
 <span style="color:#000000;">中创建明细层的明细表 </span> 
 <span style="color:#000000;">visit_consult_dwd </span> 
 <span style="color:#000000;">用于存储源 </span> 
</div> 
<div> 
 <span style="color:#000000;">数据表 </span> 
 <span style="color:#000000;">web_chat_ems_ods </span> 
 <span style="color:#000000;">和 </span> 
 <span style="color:#000000;">web_chat_text_ems_ods </span> 
 <span style="color:#000000;">清洗转换后的数据，命令如 </span> 
</div> 
<div> 
 <span style="color:#000000;">下。 </span> 
 <pre><code>CREATE TABLE IF NOT EXISTS itcast_dwd.visit_consult_dwd (
session_id STRING COMMENT "会话 ID",
sid STRING COMMENT "用户 ID",
create_time BIGINT COMMENT "会话创建时间",
ip STRING COMMENT "IP 地址",
area STRING COMMENT "地区",
msg_count INT COMMENT "客户发送消息数",
origin_channel STRING COMMENT "来源渠道",
from_url STRING COMMENT "会话来源页面"
)
COMMENT "访问咨询用户明细表"
PARTITIONED BY (yearinfo STRING, monthinfo STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY "\t"
STORED AS ORC
TBLPROPERTIES ("orc.compress"="SNAPPY");</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<div> 
 <span style="color:#000000;">创建数据库 </span> 
 <span style="color:#000000;">itcast_dws </span> 
</div> 
<div> 
 <span style="color:#000000;">在 </span> 
 <span style="color:#000000;">Hive </span> 
 <span style="color:#000000;">中创建数据库 </span> 
 <span style="color:#000000;">itcast_dws </span> 
 <span style="color:#000000;">用于存储明细层的数据，具体命令如下。 </span> 
</div> 
<div> 
 <pre><code>CREATE DATABASE IF NOT EXISTS itcast_dws;</code></pre> 
</div> 
<div> 
 <span style="color:#000000;">创建业务层宽表 </span> 
 <span style="color:#000000;">visit_dws </span> 
</div> 
<div> 
 <span style="color:#000000;">在 </span> 
 <span style="color:#000000;">Hive </span> 
 <span style="color:#000000;">的数据库 </span> 
 <span style="color:#000000;">itcast_dws </span> 
 <span style="color:#000000;">中创建业务层的宽表 </span> 
 <span style="color:#000000;">visit_dws</span> 
 <span style="color:#000000;">，用于存储访问用户 </span> 
</div> 
<div> 
 <span style="color:#000000;">量指标的数据，具体命令如下。 </span> 
 <pre><code>CREATE TABLE IF NOT EXISTS itcast_dws.visit_dws (
sid_total INT COMMENT "根据用户 ID 去重统计",
sessionid_total INT COMMENT "根据 SessionID 去重统计",
ip_total INT COMMENT "根据 IP 地址去重统计",
area STRING COMMENT "地区",
origin_channel STRING COMMENT "来源渠道",
from_url STRING COMMENT "会话来源页面",
groupType STRING COMMENT "1.地区维度 2.来源渠道维度 3.会话页面维度 4.
总访问量维度"
)
COMMENT "访问用户量宽表"
PARTITIONED BY (yearinfo STRING,monthinfo STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY "\t"
Stored as orc
TBLPROPERTIES ("orc.compress"="SNAPPY");</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<div> 
 <span style="color:#000000;">创建业务层的宽表 </span> 
 <span style="color:#000000;">consult_dws </span> 
</div> 
<div> 
 <span style="color:#000000;">在 </span> 
 <span style="color:#000000;">Hive </span> 
 <span style="color:#000000;">的数据库 </span> 
 <span style="color:#000000;">itcast_dws </span> 
 <span style="color:#000000;">中创建业务层的宽表 </span> 
 <span style="color:#000000;">consult_dws</span> 
 <span style="color:#000000;">，用于存储咨询用 </span> 
</div> 
<div> 
 <span style="color:#000000;">户量的数据，具体命令如下。 </span> 
 <pre><code>CREATE TABLE IF NOT EXISTS itcast_dws.consult_dws
(
    sid_total INT COMMENT "根据用户 ID 去重统计",
    sessionid_total INT COMMENT "根据 SessionID 去重统计",
    ip_total INT COMMENT "根据 IP 地址去重统计"
)
COMMENT "咨询用户量宽表"
PARTITIONED BY (yearinfo STRING, monthinfo STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY "\t"
STORED AS ORC
TBLPROPERTIES ("orc.compress"="SNAPPY");</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<div></div> 
<h3><img alt="" height="139" src="https://images2.imgbox.com/4b/de/7G8aeIvC_o.png" width="572"></h3> 
<h3><span style="color:#000000;">三、数据采集与转换</span></h3> 
<h4><span style="color:#000000;">（一）数据迁移过程 </span></h4> 
<h5><span style="color:#000000;">1</span><span style="color:#000000;">、</span><span style="color:#000000;">Sqoop </span><span style="color:#000000;">的简介 </span></h5> 
<div> 
 <span style="color:#000000;">Sqoop </span> 
 <span style="color:#000000;">是一款开源的工具，主要用于在 </span> 
 <span style="color:#000000;">Hadoop(Hive)</span> 
 <span style="color:#000000;">与传统的数据库</span> 
 <span style="color:#000000;">(mysql</span> 
 <span style="color:#000000;">、 </span> 
</div> 
<div> 
 <span style="color:#000000;">postgresql </span> 
 <span style="color:#000000;">… </span> 
 <span style="color:#000000;">) </span> 
 <span style="color:#000000;">间 进 行 数 据 的 传 递 ， 可 以 将 一 个 关 系 型 数 据 库 （ 例 如 ： </span> 
</div> 
<div> 
 <span style="color:#000000;">MySQL ,Oracle ,Postgres </span> 
 <span style="color:#000000;">等）中的数据导进到 </span> 
 <span style="color:#000000;">Hadoop </span> 
 <span style="color:#000000;">的 </span> 
 <span style="color:#000000;">HDFS </span> 
 <span style="color:#000000;">中，也可以将 </span> 
 <span style="color:#000000;">HDFS </span> 
</div> 
<div> 
 <span style="color:#000000;">的数据导进到关系型数据库中。 </span> 
</div> 
<div> 
 <span style="color:#000000;">sqoop1 </span> 
 <span style="color:#000000;">最新版本是 </span> 
 <span style="color:#000000;">1.4.7</span> 
 <span style="color:#000000;">，</span> 
 <span style="color:#000000;">sqoop2 </span> 
 <span style="color:#000000;">最新版本是 </span> 
 <span style="color:#000000;">1.99.7 </span> 
</div> 
<div> 
 <span style="color:#000000;">sqoop2 </span> 
 <span style="color:#000000;">特征不完整，不建议用于生产部署。 </span> 
</div> 
<div> 
 <span style="color:#000000;">1.1</span> 
 <span style="color:#000000;">、</span> 
 <span style="color:#000000;">sqoop </span> 
 <span style="color:#000000;">依赖环境 </span> 
</div> 
<div> 
 <span style="color:#000000;">2</span> 
 <span style="color:#000000;">、</span> 
 <span style="color:#000000;">sqoop </span> 
 <span style="color:#000000;">集群安装部署。 </span> 
</div> 
<div> 
 <span style="color:#000000;">安装 </span> 
 <span style="color:#000000;">sqoop </span> 
 <span style="color:#000000;">前集群的最低要求安装 </span> 
 <span style="color:#000000;">mysql</span> 
 <span style="color:#000000;">，</span> 
 <span style="color:#000000;">jdk </span> 
 <span style="color:#000000;">和 </span> 
 <span style="color:#000000;">hadoop</span> 
 <span style="color:#000000;">。 </span> 
</div> 
<div> 
 <span style="color:#000000;">可以添加 </span> 
 <span style="color:#000000;">hbase</span> 
 <span style="color:#000000;">，</span> 
 <span style="color:#000000;">hive </span> 
 <span style="color:#000000;">和 </span> 
 <span style="color:#000000;">zookeeper</span> 
 <span style="color:#000000;">，进行试验。 </span> 
</div> 
<div> 
 <span style="color:#000000;">参考 </span> 
 <span style="color:#000000;">hive,hbase,zookeeper </span> 
 <span style="color:#000000;">和 </span> 
 <span style="color:#000000;">hadoop </span> 
 <span style="color:#000000;">这些进行搭建。 </span> 
</div> 
<div> 
 <span style="color:#000000;">2.1</span> 
 <span style="color:#000000;">、</span> 
 <span style="color:#000000;">sqoop </span> 
 <span style="color:#000000;">解压 </span> 
</div> 
<div> 
 <pre><code>cd /export/software
tar -zxvf sqoop-1.4.7.bin__hadoop-2.6.0.tar.gz -C /export/servers/</code></pre> 
</div> 
<div> 
 <pre><code>cd /export/servers
mv sqoop-1.4.7.bin__hadoop-2.6.0 sqoop-1.4.7
</code></pre> 
</div> 
<div> 
 <img alt="" height="61" src="https://images2.imgbox.com/b2/cb/Ns0TYkEG_o.png" width="666"> 
</div> 
<div> 
 <span style="color:#000000;">2.2</span> 
 <span style="color:#000000;">、</span> 
 <span style="color:#000000;">sqoop </span> 
 <span style="color:#000000;">配置环境变量 </span> 
</div> 
<div> 
 <pre><code>vi /etc/profile</code></pre> 
</div> 
<div> 
 <pre><code># SQOOP_HOME
export SQOOP_HOME=/export/servers/sqoop-1.4.7
export PATH=$PATH:$SQOOP_HOME/bin</code></pre> 
</div> 
<div> 
 <pre><code>source /etc/profile</code></pre> 
</div> 
<div> 
 <span style="color:#000000;">2.3</span> 
 <span style="color:#000000;">、</span> 
 <span style="color:#000000;">sqoop </span> 
 <span style="color:#000000;">配置文件 </span> 
</div> 
<div> 
 <span style="color:#000000;">进入 </span> 
 <span style="color:#000000;">conf</span> 
</div> 
<div> 
 <pre><code>cd /export/servers/sqoop-1.4.7/conf
cp sqoop-env-template.sh sqoop-env.sh</code></pre> 
</div> 
<div> 
 <img alt="" height="64" src="https://images2.imgbox.com/00/aa/beQqdg1s_o.png" width="1170"> 
</div> 
<div> 
 <span style="color:#000000;">将 </span> 
 <span style="color:#000000;">hadoop</span> 
 <span style="color:#000000;">，</span> 
 <span style="color:#000000;">hive</span> 
 <span style="color:#000000;">，</span> 
 <span style="color:#000000;">的绝对路径进行填写。 </span> 
</div> 
<div> 
 <span style="color:#000000;">在Sqoop安装目录的conf目录中修改文件sqoop-env.sh，具体命令如下。</span> 
</div> 
<div> 
 <pre><code>#指定Hadoop安装目录
export HADOOP_COMMON_HOME=/export/servers/hadoop-2.7.4/
export HADOOP_MAPRED_HOME=/export/servers/hadoop-2.7.4/
#指定Hive安装目录
export HIVE_HOME=/export/servers/hive-2.3.9</code></pre> 
 <p><span style="color:#000000;">将 MySQL </span><span style="color:#000000;">的驱动包放到 </span><span style="color:#000000;">sqoop </span><span style="color:#000000;">的 </span><span style="color:#000000;">lib </span><span style="color:#000000;">下面 </span></p> 
</div> 
<div> 
 <pre><code>cp /export/servers/hive-2.3.9/lib/mysql-connector-java-5.1.40.jar /export/servers/sqoop-1.4.7/lib/</code></pre> 
</div> 
<div> 
 <span style="color:#000000;">2.4</span> 
 <span style="color:#000000;">、验证 </span> 
</div> 
<div> 
 <pre><code>sqoop help</code></pre> 
</div> 
<div> 
 <img alt="" height="408" src="https://images2.imgbox.com/d8/21/4XgTFrdr_o.png" width="1014"> 
</div> 
<div>
  执行Sqoop查看本地Mysql数据库中数据库列表的命令，验证Sqoop是否成功部署，具体命令如下。 
</div> 
<div> 
 <pre><code>sqoop list-databases \
  --connect jdbc:mysql://192.168.230.200:3306/ \
  --username root --password abc123
</code></pre> 
</div> 
<div> 
 <img alt="" height="344" src="https://images2.imgbox.com/db/3f/g61SPut3_o.png" width="1142"> 
</div> 
<h4>导入数据文件</h4> 
<p>以root身份登录MySQL数据库，在MySQL数据库的命令行交互界面执行“source /export/data/nev.sql”命令，将数据库文件导入到MySQL数据库。数 据库文件导入完成后执行“showdatabases;”命令查看数据库列表。</p> 
<pre><code>source /export/data/nev.sql
show databases;</code></pre> 
<p><img alt="" height="226" src="https://images2.imgbox.com/af/83/VDfDpiYl_o.png" width="480"></p> 
<p>在MySQL的命令行交互界面执行“use nev;”命令，切换到数据库nev，然后执行“show tables;”命令查看数据库nev中的数据表。</p> 
<pre><code>use nev;
show tables;</code></pre> 
<p><img alt="" height="211" src="https://images2.imgbox.com/74/62/EF2dyO2G_o.png" width="536"></p> 
<p>导入依赖包</p> 
<p>由于Sqoop向Hive表中导入数据时依赖于Hive的相关jar包，所以需要将Hive的相关jar包导入到Sqoop的lib目录中，具体命令如下。</p> 
<pre><code>cp /export/servers/hive-2.3.9/lib/{antlr-runtime-3.5.2.jar,hive-hcatalog-core-2.3.9.jar,hive-exec-2.3.9.jar,datanucleus-api-jdo-4.2.4.jar,datanucleus-core-4.1.17.jar,datanucleus-rdbms-4.1.19.jar,derby-10.10.2.0.jar,javax.jdo-3.2.0-m3.jar} /export/servers/sqoop-1.4.7/lib/</code></pre> 
<pre><code>cp /export/servers/hive-2.3.9/lib/derby-10.10.2.0.jar /export/servers/hadoop-2.7.4/share/hadoop/yarn/lib/
</code></pre> 
<h4>导入配置文件</h4> 
<p>由于Sqoop向Hive表中导入数据时需要获取Hive的配置信息，所以需要将Hive 的配置文件hive-site.xml导入到Sqoop的conf目录下，具体命令如下。</p> 
<pre><code>cp /export/servers/hive-2.3.9/conf/hive-site.xml /export/servers/sqoop-1.4.7/conf/</code></pre> 
<h4><span style="color:#000000;">（二）数据转换过程 </span></h4> 
<div> 
 <span style="color:#000000;">1.</span> 
 <span style="color:#000000;">实现数据迁移 </span> 
</div> 
<div> 
 <span style="color:#000000;">（</span> 
 <span style="color:#000000;">1</span> 
 <span style="color:#000000;">）在虚拟机 </span> 
 <span style="color:#000000;">hive</span> 
 <span style="color:#000000;">执行 </span> 
 <span style="color:#000000;">Sqoop </span> 
 <span style="color:#000000;">命令将 </span> 
 <span style="color:#000000;">MySQL </span> 
 <span style="color:#000000;">数据库的用户会话信息表 </span> 
</div> 
<div> 
 <span style="color:#000000;">web_chat_ems_2019_07 </span> 
</div> 
<div> 
 <span style="color:#000000;">中的数据迁移到 </span> 
 <span style="color:#000000;">Hive </span> 
 <span style="color:#000000;">数据仓库源数据层的 </span> 
 <span style="color:#000000;">web_chat_ems_ods </span> 
 <span style="color:#000000;">源数据表，具体命 </span> 
</div> 
<div> 
 <span style="color:#000000;">令如下所示。 </span> 
 <pre><code>sqoop import \
 --connect jdbc:mysql://192.168.230.200:3306/nev \
 --username root \
 --password abc123 \
 --query "select id,create_date_time,session_id,sid,create_time,seo_source,seo_keywords,ip,area,country,province,city,origin_channel,user as user_match,manual_time,begin_time,end_time,last_customer_msg_time_stamp,last_agent_msg_time_stamp, reply_msg_count,msg_count,browser_name,os_info from web_chat_ems_2019_07 where 1=1 and \$CONDITIONS"\
 --hcatalog-database itcast_ods \
 --hcatalog-table web_chat_ems_ods \
 -m 10 \
 --split-by id</code></pre> 
</div> 
<div> 
 <span style="color:#000000;">（</span> 
 <span style="color:#000000;">2</span> 
 <span style="color:#000000;">）在虚拟机 hive</span> 
 <span style="color:#000000;"> </span> 
 <span style="color:#000000;">执行 </span> 
 <span style="color:#000000;">Sqoop </span> 
 <span style="color:#000000;">命令将 </span> 
 <span style="color:#000000;">MySQL </span> 
 <span style="color:#000000;">数据库的用户会话信息附属表 </span> 
</div> 
<div> 
 <span style="color:#000000;">web_chat_text_ems_2019_07 </span> 
 <span style="color:#000000;">中 的 数 据 迁 移 到 </span> 
 <span style="color:#000000;">Hive </span> 
 <span style="color:#000000;">数 据 仓 库 源 数 据 层 的 </span> 
</div> 
<div> 
 <span style="color:#000000;">web_chat_text_ems_ods </span> 
 <span style="color:#000000;">源数据表，具体命令如下所示。 </span> 
 <pre><code>sqoop import \
--connect jdbc:mysql://192.168.230.200:3306/nev \
--username root \
--password abc123 \
--query "select id,referrer,from_url,landing_page_url,url_title,platform_description,
other_params,history from web_chat_text_ems_2019_07 where 1=1 and \$CONDITIONS" \
--hcatalog-database itcast_ods \
--hcatalog-table web_chat_text_ems_ods \
-m 10 \
--split-by id
</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<div> 
 <span style="color:#000000;">（</span> 
 <span style="color:#000000;">3</span> 
 <span style="color:#000000;">）统计源数据表 </span> 
 <span style="color:#000000;">web_chat_ems_ods </span> 
 <span style="color:#000000;">中包含的数据行数， </span> 
</div> 
<div> 
 <pre><code>select count(*) from itcast_ods.web_chat_ems_ods;</code></pre> 
</div> 
<div> 
 <img alt="" height="154" src="https://images2.imgbox.com/d8/4b/k84c6GE8_o.png" width="636"> 
</div> 
<div> 
 <span style="color:#000000;">（</span> 
 <span style="color:#000000;">3</span> 
 <span style="color:#000000;">）统计源数据表 </span> 
 <span style="color:#000000;">web_chat_text_ems_ods </span> 
 <span style="color:#000000;">中包含的数据行数</span> 
 <span style="color:#000000;">,</span> 
 <span style="color:#000000;">具体命令如下。</span> 
</div> 
<div> 
 <p><span style="color:#000000;">据转换，具体命令如下。 </span></p> 
 <pre><code>​​​​​​​select count(*) from itcast_ods.web_chat_text_ems_ods;</code></pre> 
</div> 
<div> 
 <img alt="" height="131" src="https://images2.imgbox.com/1d/a8/3Cx7dGtO_o.png" width="573"> 
</div> 
<h2><span style="color:#000000;">四、数据分析</span></h2> 
<h3><span style="color:#000000;">（一）实现地区访问用户量统计 </span></h3> 
<div> 
 <span style="color:#000000;">1. </span> 
 <span style="color:#000000;">需求是统计不同地区访问网站的用户量，公司决策者可以根据统计结果对不 </span> 
</div> 
<div> 
 <span style="color:#000000;">同地区的业务进行调整</span> 
 <span style="color:#000000;">,</span> 
 <span style="color:#000000;">例如访问用户量比较多的地区可以增加客服人数</span> 
 <span style="color:#000000;">,</span> 
 <span style="color:#000000;">减少用 </span> 
</div> 
<div> 
 <span style="color:#000000;">户等待时间；访问用户量比较少的地区可以加大推广，使更多用户了解并访问网 </span> 
</div> 
<div> 
 <span style="color:#000000;">站。接下来，实现地区访问用户量统计，统计结果将存储在访问用户量宽表 </span> 
</div> 
<div> 
 <span style="color:#000000;">visit_dws</span> 
 <span style="color:#000000;">，具体命令如下。</span> 
 <span style="color:#000000;">INSERT INTO itcast_dws.visit_dws PARTITION (yearinfo, monthinfo) </span> 
 <pre><code>SELECT
COUNT(DISTINCT sid) sid_total,
COUNT(DISTINCT session_id) sessionid_total,
COUNT(DISTINCT ip) ip_total,
area,
'-1' origin_channel,
'-1' from_url,
'1' grouptype,
yearinfo,monthinfo
FROM itcast_dwd.visit_consult_dwd
GROUP BY area,yearinfo,monthinfo;</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<div> 
 <pre><code>   SELECT sid_total,sessionid_total,ip_total,area,yearinfo,monthinfo FROM itcast_dws.visit_dws WHERE grouptype="1" limit 6;
</code></pre> 
 <p><img alt="" height="263" src="https://images2.imgbox.com/39/26/PI1kM16t_o.png" width="898"></p> 
</div> 
<h3><span style="color:#000000;">（二）实现会话页面排行榜 </span></h3> 
<div> 
 <span style="color:#000000;">1. </span> 
 <span style="color:#000000;">会话页面是指用户创建客服会话的页面</span> 
 <span style="color:#000000;">,</span> 
 <span style="color:#000000;">本需求是统计会话页面排行榜，公司 </span> 
</div> 
<div> 
 <span style="color:#000000;">决策者可以根据统计结果了解网站中哪些页面对用户比较有吸引力</span> 
 <span style="color:#000000;">,</span> 
 <span style="color:#000000;">促使用户向 </span> 
</div> 
<div> 
 <span style="color:#000000;">客服咨询。例如用户在浏览网站中的大数据学科相关课程介绍页面时，有大量用 </span> 
</div> 
<div> 
 <span style="color:#000000;">户向客服进行咨询，那么从侧面可以反映出用户对于大数据学科学习的需求量比 </span> 
</div> 
<div> 
 <span style="color:#000000;">较高。接下来，统计会话页面，统计结果存储在访问用户量宽表 </span> 
 <span style="color:#000000;">visit_dws </span> 
 <pre><code>INSERT INTO itcast_dws.visit_dws PARTITION (yearinfo, monthinfo)
SELECT
COUNT(DISTINCT sid) sid_total,
COUNT(DISTINCT session_id) sessionid_total,
COUNT(DISTINCT ip) ip_total,
'-1' area,
'-1' origin_channel,
from_url,
'3' grouptype,
yearinfo,monthinfo
FROM itcast_dwd.visit_consult_dwd
GROUP BY from_url,yearinfo,monthinfo;</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<div> 
 <pre><code>    SELECT sessionid_total,from_url,yearinfo,monthinfo FROM itcast_dws.visit_dws WHERE grouptype="3" AND from_url!="" ORDER BY sessionid_total DESC LIMIT 1;
</code></pre> 
 <p><img alt="" height="95" src="https://images2.imgbox.com/76/9f/YWA67ofZ_o.png" width="997"></p> 
</div> 
<h3><span style="color:#000000;">（三）实现访问用户量统计 </span></h3> 
<div> 
 <span style="color:#000000;">1. </span> 
 <span style="color:#000000;">本需求是统计访问网站的总用户量，公司决策者可以根据统计结果了解网站 </span> 
</div> 
<div> 
 <span style="color:#000000;">的访问情况，并根据实际情况对网站内容以及业务进行有效调整，同时访问用户 </span> 
</div> 
<div> 
 <span style="color:#000000;">量统计结果也可以作为二次分析的底层数据，例如咨询率统计就需要访问用户量 </span> 
</div> 
<div> 
 <span style="color:#000000;">统计结果 。接下来，统计访问用户量</span> 
 <span style="color:#000000;">,</span> 
 <span style="color:#000000;">统计结果存储在访问用户量宽表 </span> 
 <span style="color:#000000;">visit_dws, </span> 
</div> 
<div> 
 <span style="color:#000000;">具体命令如下。 </span> 
 <pre><code>INSERT INTO itcast_dws.visit_dws PARTITION (yearinfo, monthinfo)
SELECT
COUNT( DISTINCT sid ) sid_total,
COUNT( DISTINCT session_id ) sessionid_total,
COUNT( DISTINCT ip ) ip_total,
'-1' area,
'-1' origin_channel,
'-1' from_url,
'4' grouptype,
yearinfo,monthinfo
FROM itcast_dwd.visit_consult_dwd
GROUP BY yearinfo,monthinfo;</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<div> 
 <pre><code>   SELECT sid_total,sessionid_total,ip_total,yearinfo,monthinfo 
   FROM itcast_dws.visit_dws WHERE grouptype="4";
</code></pre> 
 <p><img alt="" height="96" src="https://images2.imgbox.com/9b/6b/h9972fVj_o.png" width="704"></p> 
</div> 
<h3><span style="color:#000000;">（四）实现来源渠道访问用户量统计 </span></h3> 
<div> 
 <span style="color:#000000;">1. </span> 
 <span style="color:#000000;">本需求是统计通过不同来源渠道访问网站的用户量，公司决策者可以根据统 </span> 
</div> 
<div> 
 <span style="color:#000000;">计结果了解不同渠道投放广告的效果，并根据实际情况进行调整，例如投放效果 </span> 
</div> 
<div> 
 <span style="color:#000000;">好的渠道可以加大投资，投放效果不好的渠道可以舍弃等。接下来，统计来源渠 </span> 
</div> 
<div> 
 <span style="color:#000000;">道访问用户量，统计结果将存储在访问用户量宽表 </span> 
 <span style="color:#000000;">visit_dws</span> 
 <span style="color:#000000;">。 </span> 
 <pre><code>INSERT INTO itcast_dws.visit_dws PARTITION (yearinfo,monthinfo)
SELECT
COUNT(DISTINCT sid) sid_total,
COUNT(DISTINCT session_id) session_total,
COUNT(DISTINCT ip) ip_total,
'-1' area,
origin_channel,
'-1' from_url,
'2' grouptype,
yearinfo,monthinfo
FROM itcast_dwd.visit_consult_dwd
19GROUP BY origin_channel,yearinfo,monthinfo;</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<div> 
 <pre><code>    SELECT sid_total,sessionid_total,ip_total,origin_channel,yearinfo,monthinfo FROM itcast_dws.visit_dws WHERE grouptype="2";
</code></pre> 
 <p><img alt="" height="234" src="https://images2.imgbox.com/53/7b/Yz3PAWfW_o.png" width="634"></p> 
</div> 
<h3><span style="color:#000000;">（五）实现咨询率统计 </span></h3> 
<div> 
 <span style="color:#000000;">1. </span> 
 <span style="color:#000000;">实现咨询用户量统计的命令执行完成后，通过访问用户量和咨询用户量统计 </span> 
</div> 
<div> 
 <span style="color:#000000;">结果实现咨询率统计，具体命令如下。 </span> 
 <pre><code>SELECT
CONCAT(ROUND(msgNumber.sid_total / totalNumber.sid_total,4) * 100, '%')
sid_rage,
CONCAT (ROUND (msgNumber.sessionid_total/ totalNumber.sessionid_total,4)*100,
'%') session_rage,
CONCAT (ROUND (msgNumber.ip_total / totalNumber.ip_total,4)* 100, '&amp;')
ip_rage,
msgNumber.yearinfo,
msgNumber.monthinfo
FROM
(
SELECT
sid_total,
sessionid_total,
ip_total,
yearinfo,
monthinfo
FROM itcast_dws.consult_dws
) msgNumber,
(
SELECT
sid_total,
sessionid_total,
ip_total,
yearinfo,
monthinfo
FROM itcast_dws.visit_dws
where grouptype="4"
) totalNumber;</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<div> 
 <img alt="" height="220" src="https://images2.imgbox.com/23/68/bdyeIV5y_o.png" width="822"> 
</div> 
<h3><span style="color:#000000;">（六）数据可视化 </span></h3> 
<div> 
 <span style="color:#000000;">1.</span> 
 <span style="color:#000000;">导出数据 </span> 
</div> 
<div> 
 <span style="color:#000000;">在虚拟机 </span> 
 <span style="color:#000000;">hive</span> 
 <span style="color:#000000;">中执行“</span> 
 <span style="color:#000000;">mysql -uroot -p</span> 
 <span style="color:#000000;">”命令以 </span> 
 <span style="color:#000000;">root </span> 
 <span style="color:#000000;">身份登录 </span> 
 <span style="color:#000000;">MySQL </span> 
 <span style="color:#000000;">数据库， </span> 
</div> 
<div> 
 <span style="color:#000000;">在弹出的“</span> 
 <span style="color:#000000;">Enter password:</span> 
 <span style="color:#000000;">”信息处输入 </span> 
 <span style="color:#000000;">root </span> 
 <span style="color:#000000;">用户的密码，从而登录 </span> 
 <span style="color:#000000;">MySQL </span> 
 <span style="color:#000000;">数 </span> 
</div> 
<div> 
 <span style="color:#000000;">据库进入命令行交互界面。 </span> 
</div> 
<div> 
 <span style="color:#000000;">在数据库 </span> 
 <span style="color:#000000;">nev </span> 
 <span style="color:#000000;">中创建表 </span> 
 <span style="color:#000000;">visit_dws </span> 
 <span style="color:#000000;">用于存储 </span> 
 <span style="color:#000000;">Hive </span> 
 <span style="color:#000000;">数据仓库中访问用户量宽表 </span> 
</div> 
<div> 
 <span style="color:#000000;">visit_dws </span> 
 <span style="color:#000000;">导出的数据，具体命令如下。 </span> 
 <pre><code>CREATE TABLE nev.visit_dws (
sid_total INT(11) COMMENT '根据用户 ID 去重统计',
sessionid_total INT(11) COMMENT '根据 SessionID 去重统计',
ip_total INT(11) COMMENT '根据 IP 地址去重统计',
area VARCHAR(32) COMMENT '地区', -- 添加单引号并在注释前后加上空格
origin_channel VARCHAR(32) COMMENT '来源渠道', -- 添加单引号并在注释前
后加上空格
from_url VARCHAR(100) COMMENT '会话来源页面', -- 添加单引号并在注释前
后加上空格
groupType VARCHAR(100) COMMENT '1.地区维度 2.来源渠道维度 3.会话页面
维度 4 总访问量维度',
yearinfo VARCHAR(32) COMMENT '年',
monthinfo VARCHAR(32) COMMENT '月'
);</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<div> 
 <span style="color:#000000;">在数据库 </span> 
 <span style="color:#000000;">nev </span> 
 <span style="color:#000000;">中创建表 </span> 
 <span style="color:#000000;">consult_dws </span> 
 <span style="color:#000000;">用于存储 </span> 
 <span style="color:#000000;">Hive </span> 
 <span style="color:#000000;">数据仓库中咨询用户量宽表 </span> 
</div> 
<div> 
 <span style="color:#000000;">consult_dws </span> 
 <span style="color:#000000;">导出的数据，具体命令如下。 </span> 
 <pre><code>CREATE TABLE nev.consult_dws (
sid_total INT(11) COMMENT '根据用户 ID 去重统计',
sessionid_total INT(11) COMMENT '根据 SessionID 去重统计',
21ip_total INT(11) COMMENT '根据 IP 地址去重统计',
yearinfo VARCHAR(32) COMMENT '年',
monthinfo VARCHAR(32) COMMENT '月'
);</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<div> 
 <span style="color:#000000;">查看数据库 </span> 
 <span style="color:#000000;">nev </span> 
 <span style="color:#000000;">中是否成功创建表 </span> 
 <span style="color:#000000;">visit_dws </span> 
 <span style="color:#000000;">和 </span> 
 <span style="color:#000000;">consult_dws</span> 
 <span style="color:#000000;">，具体命令如下。 </span> 
</div> 
<div> 
 <span style="color:#000000;">/*</span> 
 <span style="color:#000000;">切换到数据库 </span> 
 <span style="color:#000000;">nev*/ </span> 
</div> 
<div> 
 <pre><code>use nev;</code></pre> 
</div> 
<div> 
 <span style="color:#000000;">/*</span> 
 <span style="color:#000000;">查看数据库 </span> 
 <span style="color:#000000;">nev </span> 
 <span style="color:#000000;">中包含的表</span> 
 <span style="color:#000000;">*/ </span> 
</div> 
<div> 
 <pre><code>show tables;</code></pre> 
</div> 
<div> 
 <span style="color:#000000;">在 </span> 
 <span style="color:#000000;">MySQL </span> 
 <span style="color:#000000;">命令行交互界面执行“</span> 
 <span style="color:#000000;">exit</span> 
 <span style="color:#000000;">”命令登出 </span> 
 <span style="color:#000000;">MySQL</span> 
 <span style="color:#000000;">，在虚拟机 </span> 
 <span style="color:#000000;">Node02 </span> 
 <span style="color:#000000;">执 </span> 
</div> 
<div> 
 <span style="color:#000000;">行 </span> 
 <span style="color:#000000;">Sqoop </span> 
 <span style="color:#000000;">命令将 </span> 
 <span style="color:#000000;">Hive </span> 
 <span style="color:#000000;">数据仓库中访问用户量宽表 </span> 
 <span style="color:#000000;">visit_dws </span> 
 <span style="color:#000000;">导出到关系型数据库 </span> 
</div> 
<div> 
 <span style="color:#000000;">MySQL </span> 
 <span style="color:#000000;">中 </span> 
 <span style="color:#000000;">nev </span> 
 <span style="color:#000000;">数据库的表 </span> 
 <span style="color:#000000;">visit_dws</span> 
 <span style="color:#000000;">，具体命令如下所示。 </span> 
 <pre><code>sqoop export \
--connect "jdbc:mysql://192.168.230.222:3306/nev?useUnicode=true&amp;character
Encoding=utf-8" \
--username root \
--password abc123 \
--table visit_dws \
22--hcatalog-database itcast_dws \
--hcatalog-table visit_dws</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<div> 
 <span style="color:#000000;">在 </span> 
 <span style="color:#000000;">MySQL </span> 
 <span style="color:#000000;">命令行交互界面执行“</span> 
 <span style="color:#000000;">exit</span> 
 <span style="color:#000000;">”命令登出 </span> 
 <span style="color:#000000;">MySQL</span> 
 <span style="color:#000000;">，在虚拟机 </span> 
 <span style="color:#000000;">Node02 </span> 
 <span style="color:#000000;">执 </span> 
</div> 
<div> 
 <span style="color:#000000;">行 </span> 
 <span style="color:#000000;">Sqoop </span> 
 <span style="color:#000000;">命令将 </span> 
 <span style="color:#000000;">Hive </span> 
 <span style="color:#000000;">数据仓库中咨询用户量宽表 </span> 
 <span style="color:#000000;">consult_dws </span> 
 <span style="color:#000000;">导出到关系型数据 </span> 
</div> 
<div> 
 <span style="color:#000000;">库 </span> 
 <span style="color:#000000;">MySQL </span> 
 <span style="color:#000000;">中 </span> 
 <span style="color:#000000;">nev </span> 
 <span style="color:#000000;">数据库的表 </span> 
 <span style="color:#000000;">consult_dws</span> 
 <span style="color:#000000;">，具体命令如下所示。 </span> 
 <pre><code>sqoop export \
--connect "jdbc:mysql://192.168.230.222:3306/nev?
useUnicode=true&amp;characterEncoding=utf-8" \
--username root \
--password abc123 \
--table consult_dws \
--hcatalog-database itcast_dws \
--hcatalog-table consult_dws</code></pre> 
 <span style="color:#000000;"> </span> 
</div> 
<div> 
 <span style="color:#000000;">2.</span> 
 <span style="color:#000000;">安装、启动与配置 </span> 
 <span style="color:#000000;">FineBI </span> 
</div> 
<div> 
 <span style="color:#000000;">访问 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">的官方网站通过注册的方式下载 </span> 
 <span style="color:#000000;">Windows x64 </span> 
 <span style="color:#000000;">位操作系统的 </span> 
 <span style="color:#000000;">FineBI </span> 
</div> 
<div> 
 <span style="color:#000000;">安装包 </span> 
 <span style="color:#000000;">windows-x64_FineBI5_1-CN.exe</span> 
 <span style="color:#000000;">。 </span> 
</div> 
<div> 
 <span style="color:#000000;">双击 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">安装包 </span> 
 <span style="color:#000000;">windows-x64_FineBI5_1-CN.exe </span> 
 <span style="color:#000000;">进入“欢迎使用 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">安装 </span> 
</div> 
<div> 
 <span style="color:#000000;">程序向导“界面。 </span> 
</div> 
<div> 
 <img alt="" height="388" src="https://images2.imgbox.com/3d/60/mltWuDnp_o.png" width="496"> 
</div> 
<div> 
 <span style="color:#000000;">23</span> 
 <span style="color:#000000;">在“欢迎使用 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">安装程序向导”界面，下一步”按钮进入“许可协议”界 </span> 
</div> 
<div> 
 <span style="color:#000000;">面，在该界面勾选“我接受协议选项” </span> 
</div> 
<div> 
 <span style="color:#000000;">在“许可协议”界面，单击“下一步”按钮进入“选择安装目录”界面，在该界 </span> 
</div> 
<div> 
 <span style="color:#000000;">面中配置 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">的安装目录，这里配置 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">的安装目录为“</span> 
 <span style="color:#000000;">D:\FineBI5.1</span> 
 <span style="color:#000000;">” </span> 
</div> 
<div> 
 <span style="color:#000000;">在“选择安装目录”界面，单击“下一步”按钮进入“设置最大内存”界面，在 </span> 
</div> 
<div> 
 <span style="color:#000000;">“最大 </span> 
 <span style="color:#000000;">jvm </span> 
 <span style="color:#000000;">内存”输入框中输入最大 </span> 
 <span style="color:#000000;">jvm </span> 
 <span style="color:#000000;">内存，默认为 </span> 
 <span style="color:#000000;">2048</span> 
 <span style="color:#000000;">（</span> 
 <span style="color:#000000;">2G</span> 
 <span style="color:#000000;">）。建议设置 </span> 
</div> 
<div> 
 <span style="color:#000000;">最大 </span> 
 <span style="color:#000000;">jvm </span> 
 <span style="color:#000000;">内存大于 </span> 
 <span style="color:#000000;">2048</span> 
 <span style="color:#000000;">，这里设置最大 </span> 
 <span style="color:#000000;">jvm </span> 
 <span style="color:#000000;">内存为 </span> 
 <span style="color:#000000;">4096</span> 
 <span style="color:#000000;">（</span> 
 <span style="color:#000000;">4G</span> 
 <span style="color:#000000;">）。 </span> 
</div> 
<div> 
 <img alt="" height="388" src="https://images2.imgbox.com/53/f3/ZS5hW0ip_o.png" width="496"> 
</div> 
<div> 
 <span style="color:#000000;">在“设置最大内存”界面，单击“下一步”按钮进入“选择开始菜单文件夹”界 </span> 
</div> 
<div> 
 <span style="color:#000000;">面，在该界面使用默认配置即可。 </span> 
</div> 
<div> 
 <img alt="" height="388" src="https://images2.imgbox.com/66/d5/p1YG0MZn_o.png" width="496"> 
</div> 
<div> 
 <span style="color:#000000;">在“选择开始菜单文件夹”界面，单击“下一步”按钮进入“选择附加工作”界 </span> 
</div> 
<div> 
 <span style="color:#000000;">面，在该界面使用默认配置即可。 </span> 
</div> 
<div> 
 <img alt="" height="388" src="https://images2.imgbox.com/73/6e/i6daIvSc_o.png" width="496"> 
</div> 
<div> 
 <span style="color:#000000;">在“选择附加工作”界面，单击“下一步”按钮进入“安装中”界面，在该界面 </span> 
</div> 
<div> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">会自动安装。 </span> 
</div> 
<div> 
 <img alt="" height="388" src="https://images2.imgbox.com/87/05/qvy5WzC5_o.png" width="496"> 
</div> 
<div> 
 <span style="color:#000000;">等待 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">安装完成后会自动进入“完成 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">安装程序”界面，在该界面使 </span> 
</div> 
<div> 
 <span style="color:#000000;">用默认配置即可。 </span> 
</div> 
<div> 
 <img alt="" height="388" src="https://images2.imgbox.com/ff/3f/iTDdRUuq_o.png" width="496"> 
</div> 
<div> 
 <span style="color:#000000;">26</span> 
 <span style="color:#000000;">启动 </span> 
 <span style="color:#000000;">FineBI </span> 
</div> 
<div> 
 <span style="color:#000000;">打开 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">平台 </span> 
</div> 
<div> 
 <img alt="" height="400" src="https://images2.imgbox.com/a2/2f/apR5XXzW_o.png" width="674"> 
</div> 
<div> 
 <span style="color:#000000;">等待 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">启动完成后，系统默认配置的浏览器会打开 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">平台。 </span> 
</div> 
<div> 
 <span style="color:#000000;">初始化设置 </span> 
</div> 
<div> 
 <img alt="" height="1000" src="https://images2.imgbox.com/f6/66/KUZT5bfF_o.png" width="1200"> 
</div> 
<div> 
 <span style="color:#000000;">首次使用 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">时需要通过 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">平台进行初始化设置，将用户名设置为“</span> 
 <span style="color:#000000;">root</span> 
 <span style="color:#000000;">”， </span> 
</div> 
<div> 
 <span style="color:#000000;">密码设置为“</span> 
 <span style="color:#000000;">123456</span> 
 <span style="color:#000000;">” </span> 
</div> 
<div> 
 <span style="color:#000000;">在”设置管理员账号界面”，单击“确认”按钮后，平台会显示“管理员账号设 </span> 
</div> 
<div> 
 <span style="color:#000000;">置成功”信息，并且设置的管理员密码会以明文的方式显示 </span> 
</div> 
<div> 
 <span style="color:#000000;">选择 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">使用的数据库 </span> 
</div> 
<div> 
 <img alt="" height="445" src="https://images2.imgbox.com/ae/b0/UzmtT2xI_o.png" width="834"> 
</div> 
<div> 
 <span style="color:#000000;">在”管理员账号设置成功界面”，单击“下一步”按钮选择 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">使用的数据 </span> 
</div> 
<div> 
 <span style="color:#000000;">库。 </span> 
</div> 
<div> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">登录界面 </span> 
</div> 
<div> 
 <span style="color:#000000;">在”选择 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">使用的数据库”中，单击 “直接登录”选项，页面会自动跳转 </span> 
</div> 
<div> 
 <span style="color:#000000;">到 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">商业智能平台的登录界面。 </span> 
</div> 
<div> 
 <span style="color:#000000;">28</span> 
 <span style="color:#000000;">登录 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">商业智能平台 </span> 
</div> 
<div> 
 <span style="color:#000000;">输入用户名“</span> 
 <span style="color:#000000;">root</span> 
 <span style="color:#000000;">”和密码“</span> 
 <span style="color:#000000;">123456</span> 
 <span style="color:#000000;">”，单击“登录”按钮登录 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">商业智 </span> 
</div> 
<div> 
 <span style="color:#000000;">能平台。 </span> 
</div> 
<div> 
 <img alt="" height="1000" src="https://images2.imgbox.com/df/55/uSIdDAKq_o.png" width="1200"> 
</div> 
<div> 
 <span style="color:#000000;">数据连接管理 </span> 
</div> 
<div> 
 <span style="color:#000000;">在 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">商业智能平台依次选择“管理系统→数据连接→数据连接管理”进入 </span> 
</div> 
<div> 
 <span style="color:#000000;">数据连接管理界面。 </span> 
</div> 
<div> 
 <span style="color:#000000;">选择 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">使用的数据库 </span> 
</div> 
<div> 
 <span style="color:#000000;">在”数据连接界面”，单击“新建数据连接”按钮选择 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">使用的数据库 </span> 
</div> 
<div> 
 <span style="color:#000000;">29</span> 
 <span style="color:#000000;">选择 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">使用的数据库 </span> 
</div> 
<div> 
 <span style="color:#000000;">在”选择 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">使用的数据库界面”右侧的数据库列表中，选择“</span> 
 <span style="color:#000000;">MySQL</span> 
 <span style="color:#000000;">”选 </span> 
</div> 
<div> 
 <span style="color:#000000;">项，配置连接 </span> 
 <span style="color:#000000;">MySQL </span> 
 <span style="color:#000000;">的相关信息，完成 </span> 
 <span style="color:#000000;">MySQL </span> 
 <span style="color:#000000;">相关信息配置。 </span> 
</div> 
<div> 
 <img alt="" height="1000" src="https://images2.imgbox.com/1c/69/i6pwWpQJ_o.png" width="1200"> 
</div> 
<div> 
 <span style="color:#000000;">选择 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">使用的数据库 </span> 
</div> 
<div> 
 <span style="color:#000000;">单击“测试连接”按钮，验证 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">是否可以成功连接虚拟机 </span> 
 <span style="color:#000000;">hive </span> 
 <span style="color:#000000;">中的 </span> 
 <span style="color:#000000;">MySQL </span> 
</div> 
<div> 
 <span style="color:#000000;">数据库。 </span> 
</div> 
<div> 
 <img alt="" height="573" src="https://images2.imgbox.com/6a/41/pY0br8H4_o.png" width="1112"> 
</div> 
<div> 
 <span style="color:#000000;">数据准备 </span> 
</div> 
<div> 
 <span style="color:#000000;">在 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">商业智能平台选择“数据准备”选项。 </span> 
</div> 
<div> 
 <span style="color:#000000;">配置业务名称 </span> 
</div> 
<div> 
 <span style="color:#000000;">在“数据准备”界面，单击“添加业务包”选项添加业务，并配置业务名称为“教 </span> 
</div> 
<div> 
 <span style="color:#000000;">育大数据分析平台”。 </span> 
</div> 
<div> 
 <span style="color:#000000;">配置业务使用的数据内容 </span> 
</div> 
<div> 
 <span style="color:#000000;">在“配置业务名称”界面，单击业务“教育大数据平台”配置该业务使用的数据 </span> 
</div> 
<div> 
 <span style="color:#000000;">内容。 </span> 
</div> 
<div> 
 <span style="color:#000000;">选择数据库中需要使用的数据表 </span> 
</div> 
<div> 
 <span style="color:#000000;">在“配置业务使用的数据内容”界面，依次单击“添加表→数据库表”选项选择 </span> 
</div> 
<div> 
 <span style="color:#000000;">数据库中需要使用的数据表。 </span> 
</div> 
<div> 
 <span style="color:#000000;">成功添加表 </span> 
</div> 
<div> 
 <span style="color:#000000;">在“选择数据库中需要使用的数据表”界面，选中需要使用的访问用户量表 </span> 
</div> 
<div> 
 <span style="color:#000000;">visit_dws </span> 
 <span style="color:#000000;">和咨询用户量表 </span> 
 <span style="color:#000000;">consult_dws</span> 
 <span style="color:#000000;">，单击“确认”按钮，在教育大数据平台 </span> 
</div> 
<div> 
 <span style="color:#000000;">业务中展示成功添加表。 </span> 
</div> 
<div> 
 <span style="color:#000000;">业务包更新 </span> 
</div> 
<div> 
 <span style="color:#000000;">单击“业务包更新”选项更新“教育大数据平台”业务中添加表 </span> 
 <span style="color:#000000;">consult_dws </span> 
 <span style="color:#000000;">和 </span> 
</div> 
<div> 
 <span style="color:#000000;">visit_dws </span> 
 <span style="color:#000000;">的数据，否则后续无法使用这两个表的数据进行可视化展示。 </span> 
</div> 
<div> 
 <span style="color:#000000;">新建 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">仪表板 </span> 
</div> 
<div> 
 <span style="color:#000000;">在 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">商业智能平台单击“仪表板”选项进入仪表板管理页面，在该页面单 </span> 
</div> 
<div> 
 <span style="color:#000000;">击“新建仪表板”选项，在弹出窗口的“名称”文本框中输入“教育大数据平台”， </span> 
</div> 
<div> 
 <span style="color:#000000;">单击“确定”按钮新建仪表板。 </span> 
</div> 
<div> 
 <span style="color:#000000;">完成 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">仪表板配置 </span> 
</div> 
<div> 
 <span style="color:#000000;">30</span> 
 <span style="color:#000000;">单击仪表板“教育大数据平台”，进入教育大数据平台仪表板的配置页面</span> 
 <span style="color:#000000;">,</span> 
 <span style="color:#000000;">显示 </span> 
</div> 
<div> 
 <span style="color:#000000;">仪表板配置完成。 </span> 
</div> 
<div> 
 <span style="color:#000000;">（三</span> 
 <span style="color:#000000;">) </span> 
 <span style="color:#000000;">实现数据可视化 </span> 
</div> 
<div> 
 <span style="color:#000000;">统计地区访问用户量 </span> 
</div> 
<div> 
 <span style="color:#000000;">设 置 表 名 为 ” 根 据 </span> 
 <span style="color:#000000;">sid </span> 
 <span style="color:#000000;">统 计 的 地 区 访 问 用 户 量 ” </span> 
 <span style="color:#000000;">, </span> 
 <span style="color:#000000;">然 后 选 择 使 用 的 表 </span> 
</div> 
<div> 
 <span style="color:#000000;">“</span> 
 <span style="color:#000000;">itcast_visit_dws</span> 
 <span style="color:#000000;">”，最后勾选使用的字段名称“根据用户 </span> 
 <span style="color:#000000;">ID </span> 
 <span style="color:#000000;">去重统计”和“地 </span> 
</div> 
<div> 
 <span style="color:#000000;">区”。 </span> 
</div> 
<div> 
 <span style="color:#000000;">添加过滤条件 </span> 
</div> 
<div> 
 <span style="color:#000000;">在”根据访问用户量”界面</span> 
 <span style="color:#000000;">,</span> 
 <span style="color:#000000;">单击“</span> 
 <span style="color:#000000;">+</span> 
 <span style="color:#000000;">”按钮添加过滤条件。 </span> 
</div> 
<div> 
 <span style="color:#000000;">去除字段在过滤条件中去除字段“地区”中值为“</span> 
 <span style="color:#000000;">-1</span> 
 <span style="color:#000000;">”的数据，并且指定数据开 </span> 
</div> 
<div> 
 <span style="color:#000000;">头为“中国”。 </span> 
</div> 
<div> 
 <span style="color:#000000;">退出自助数据集页面 </span> 
</div> 
<div> 
 <img alt="" height="889" src="https://images2.imgbox.com/bc/09/94YFD4Eu_o.png" width="1200"> 
</div> 
<div> 
 <span style="color:#000000;">在“根据访问用户量”配置过滤条件界面，单击“保存并更新”按钮保存过滤条 </span> 
</div> 
<div> 
 <span style="color:#000000;">件的配置内容，然后单击“×”按钮退出“自助数据集”页面。 </span> 
</div> 
<div> 
 <span style="color:#000000;">添加组件 </span> 
</div> 
<div> 
 <span style="color:#000000;">在弹出的“添加组件”窗口依次选择“教育大数据平台→根据 </span> 
 <span style="color:#000000;">sid </span> 
 <span style="color:#000000;">统计的地区访 </span> 
</div> 
<div> 
 <span style="color:#000000;">问用户量” </span> 
</div> 
<div> 
 <span style="color:#000000;">配置经纬度 </span> 
</div> 
<div> 
 <span style="color:#000000;">在组件添加完成后，需要将地区字段内的数据转换为经纬度数据，便于后续通过 </span> 
</div> 
<div> 
 <span style="color:#000000;">中国地图的方式进行可视化展示。 </span> 
</div> 
<div> 
 <span style="color:#000000;">手动调整未匹配字段数据 </span> 
</div> 
<div> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">会自动将“地区”字段中的数据转换为经纬度，不过此时“地区”字段中 </span> 
</div> 
<div> 
 <span style="color:#000000;">的特殊数据，</span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">并不会自动匹配并转换，因此需要对特殊字段进行手动调整。 </span> 
</div> 
<div> 
 <span style="color:#000000;">完成经纬度配置 </span> 
</div> 
<div> 
 <span style="color:#000000;">在“手动调整未匹配字段数据”界面，单击“确认”按钮，此时在“地区”字段 </span> 
</div> 
<div> 
 <span style="color:#000000;">下方会多出“地区（经度）”和“地区（纬度）”两个字段。 </span> 
</div> 
<div> 
 <span style="color:#000000;">地区访问用户量可视化展示 </span> 
</div> 
<div> 
 <span style="color:#000000;">在“图标类型”一栏中选择区域地区，然后将“地区（经度）”字段拖动到“横 </span> 
</div> 
<div> 
 <span style="color:#000000;">轴”，将“地区（纬度）”拖动到“纵轴”，最后将“根据用户 </span> 
 <span style="color:#000000;">ID </span> 
 <span style="color:#000000;">去重统计” </span> 
</div> 
<div> 
 <span style="color:#000000;">字段拖动到“图形属性”一栏中的“标签”中，此时 </span> 
 <span style="color:#000000;">FineBI </span> 
 <span style="color:#000000;">会自动实现根据用 </span> 
</div> 
<div> 
 <span style="color:#000000;">户 </span> 
 <span style="color:#000000;">ID </span> 
 <span style="color:#000000;">统计的地区访问用户量可视化展示。 </span> 
</div> 
<div> 
 <span style="color:#000000;">地区用户可视化展示 </span> 
</div> 
<div> 
 <img alt="" height="634" src="https://images2.imgbox.com/a5/f7/l5PwvSh7_o.png" width="1200"> 
</div> 
<div> 
 <span style="color:#000000;">在“根据用户 </span> 
 <span style="color:#000000;">ID </span> 
 <span style="color:#000000;">统计的地区访问用户量可视化展示”界面，更改标题名称，然 </span> 
</div> 
<div> 
 <span style="color:#000000;">后单击“进入仪表板”按钮即可。 </span> 
</div> 
<div> 
 <span style="color:#000000;">配置过滤件 </span> 
</div> 
<div> 
 <span style="color:#000000;">在</span> 
 <span style="color:#000000;">“</span> 
 <span style="color:#000000;">根据 </span> 
 <span style="color:#000000;">Session”</span> 
 <span style="color:#000000;">选字段界面，单击</span> 
 <span style="color:#000000;">“+”</span> 
 <span style="color:#000000;">按钮添加过滤条件，去除字段</span> 
 <span style="color:#000000;">“</span> 
 <span style="color:#000000;">会话来源页 </span> 
</div> 
<div> 
 <span style="color:#000000;">面</span> 
 <span style="color:#000000;">”</span> 
 <span style="color:#000000;">中的空数据和值为</span> 
 <span style="color:#000000;">“-1”</span> 
 <span style="color:#000000;">的数据。 </span> 
</div> 
<div> 
 <span style="color:#000000;">统计会话页面排行榜 </span> 
</div> 
<div> 
 <img alt="" height="462" src="https://images2.imgbox.com/97/af/6CLNtVZX_o.png" width="1200"> 
</div> 
<div> 
 <span style="color:#000000;">在</span> 
 <span style="color:#000000;">“</span> 
 <span style="color:#000000;">实现地区访问用户量可视化</span> 
 <span style="color:#000000;">”</span> 
 <span style="color:#000000;">界面，单击</span> 
 <span style="color:#000000;">“</span> 
 <span style="color:#000000;">组件</span> 
 <span style="color:#000000;">”</span> 
 <span style="color:#000000;">按钮，在弹出的</span> 
 <span style="color:#000000;">“</span> 
 <span style="color:#000000;">添加组件</span> 
 <span style="color:#000000;">”</span> 
 <span style="color:#000000;">窗 </span> 
</div> 
<div> 
 <span style="color:#000000;">口依次选择</span> 
 <span style="color:#000000;">“</span> 
 <span style="color:#000000;">教育大数据平台</span> 
 <span style="color:#000000;">→</span> 
 <span style="color:#000000;">根据 </span> 
 <span style="color:#000000;">Session”</span> 
 <span style="color:#000000;">。 </span> 
</div> 
<div> 
 <span style="color:#000000;">配置组件页面 </span> 
</div> 
<div> 
 <span style="color:#000000;">在添加组件</span> 
 <span style="color:#000000;">“Session”</span> 
 <span style="color:#000000;">界面，单击</span> 
 <span style="color:#000000;">“</span> 
 <span style="color:#000000;">确认</span> 
 <span style="color:#000000;">”</span> 
 <span style="color:#000000;">按钮进入配置组件页面。 </span> 
</div> 
<div> 
 <span style="color:#000000;">进入仪表盘 </span> 
</div> 
<div> 
 <img alt="" height="820" src="https://images2.imgbox.com/ce/35/z3EoUiLz_o.png" width="1200"> 
</div> 
<div> 
 <span style="color:#000000;">在配置组件</span> 
 <span style="color:#000000;">“</span> 
 <span style="color:#000000;">根据 </span> 
 <span style="color:#000000;">SessionID </span> 
 <span style="color:#000000;">统计的会话页面排行榜</span> 
 <span style="color:#000000;">”</span> 
 <span style="color:#000000;">界面，单击</span> 
 <span style="color:#000000;">“</span> 
 <span style="color:#000000;">进入仪表板</span> 
 <span style="color:#000000;">”</span> 
 <span style="color:#000000;">按 </span> 
</div> 
<div> 
 <span style="color:#000000;">钮进入</span> 
 <span style="color:#000000;">“</span> 
 <span style="color:#000000;">教育大数据平台</span> 
 <span style="color:#000000;">”</span> 
 <span style="color:#000000;">仪表板。 </span> 
</div> 
<div> 
 <img alt="" height="452" src="https://images2.imgbox.com/ab/a6/ZdGDhIyK_o.png" width="1200"> 
</div> 
<div> 
 <span style="color:#000000;">选字段 </span> 
</div> 
<div> 
 <span style="color:#000000;">在“在教育大数据平台业务中成功添加表”页面，依次选择“添加表→自助数据 </span> 
</div> 
<div> 
 <span style="color:#000000;">集”进入自助数据集页面，在该页面中首先设置表名为“根据 </span> 
 <span style="color:#000000;">ip </span> 
 <span style="color:#000000;">统计的来源渠 </span> 
</div> 
<div> 
 <span style="color:#000000;">道访问用户量”，然后选择使用的表“</span> 
 <span style="color:#000000;">itcast_visit_dws</span> 
 <span style="color:#000000;">”，最后勾选使用的字段 </span> 
</div> 
<div> 
 <span style="color:#000000;">名称“来源渠道”和“根据 </span> 
 <span style="color:#000000;">IP </span> 
 <span style="color:#000000;">地址去重统计”。 </span> 
</div> 
<div> 
 <span style="color:#000000;">去除字段 </span> 
</div> 
<div> 
 <span style="color:#000000;">在“自助数据集“根据 </span> 
 <span style="color:#000000;">sid </span> 
 <span style="color:#000000;">统计的地区访问用户量”选字段页面，单击“</span> 
 <span style="color:#000000;">+</span> 
 <span style="color:#000000;">”按 </span> 
</div> 
<div> 
 <span style="color:#000000;">钮添加过滤条件，去除字段“来源渠道”中值为“</span> 
 <span style="color:#000000;">-1</span> 
 <span style="color:#000000;">”的数据。 </span> 
</div> 
<div> 
 <img alt="" height="541" src="https://images2.imgbox.com/40/4b/g9BqgMJq_o.png" width="1200"> 
</div> 
<div> 
 <span style="color:#000000;">统计访问用户量 </span> 
</div> 
<div> 
 <span style="color:#000000;">在“实现会话页面排行榜可视化”页面，单击“组件”按钮，在弹出的“添加组 </span> 
</div> 
<div> 
 <span style="color:#000000;">件”窗口依次选择“教育大数据平台→根据 </span> 
 <span style="color:#000000;">ip </span> 
 <span style="color:#000000;">统计的来源渠道访问用户量”。 </span> 
</div> 
<div> 
 <span style="color:#000000;">退出自助数据集页面 </span> 
</div> 
<div> 
 <span style="color:#000000;">在 “根据 </span> 
 <span style="color:#000000;">Session</span> 
 <span style="color:#000000;">”页面，单击“确认”按钮进入配置组件页面。 </span> 
</div> 
<div> 
 <span style="color:#000000;">成功添加组件 </span> 
</div> 
<div> 
 <img alt="" height="634" src="https://images2.imgbox.com/73/51/4v1lh6dS_o.png" width="1200"> 
</div> 
<div> 
 <span style="color:#000000;">在“根据 </span> 
 <span style="color:#000000;">ip </span> 
 <span style="color:#000000;">统计的来源渠道访问用户量”页面，单击“进入仪表板”按钮进入 </span> 
</div> 
<div> 
 <span style="color:#000000;">“教育大数据平台”仪表板。 </span> 
</div> 
<div> 
 <img alt="" height="351" src="https://images2.imgbox.com/7f/fe/viUTp5pL_o.png" width="1200"> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/88d28562b9fc41be8f6f77015da12feb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【C&#43;&#43;初阶】—— 类和对象 (上）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b3b9571f9895392c816e8b7edc39fd77/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">基于springboot&#43;vue&#43;Mysql的休闲娱乐代理售票系统</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>