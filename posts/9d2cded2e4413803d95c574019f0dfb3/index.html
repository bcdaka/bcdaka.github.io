<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C/C&#43;&#43;运行时库和UCRT系统通用运行时库总结及问题实例分享 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/9d2cded2e4413803d95c574019f0dfb3/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="C/C&#43;&#43;运行时库和UCRT系统通用运行时库总结及问题实例分享">
  <meta property="og:description" content="目录
1、概述
2、不同版本的Visual Studio对应的运行时库说明
3、在Windbg10.0安装目录中获取UCRT通用运行时库
4、微软官网对UCRT通用运行时库的相关说明
5、使用Visual Studio 2017开发软件初期遇到的UCRT通用运行时库问题
6、如何查看软件依赖了哪些C/C&#43;&#43;运行时库？
7、将软件从32位升级到64位后，要使用64位UCRT通用运行时库
8、发布软件时未打包C/C&#43;&#43;运行时库的项目问题实例
C&#43;&#43;软件异常排查从入门到精通系列教程（专栏文章列表，欢迎订阅，持续更新...）https://blog.csdn.net/chenlycly/article/details/125529931C/C&#43;&#43;基础与进阶（专栏文章，持续更新中...）https://blog.csdn.net/chenlycly/category_11931267.htmlVC&#43;&#43;常用功能开发汇总（专栏文章列表，欢迎订阅，持续更新...）https://blog.csdn.net/chenlycly/article/details/124272585C&#43;&#43;软件分析工具从入门到精通案例集锦（专栏文章，持续更新中...）https://blog.csdn.net/chenlycly/article/details/131405795开源组件及数据库技术（专栏文章，持续更新中...）https://blog.csdn.net/chenlycly/category_12458859.html网络编程与网络问题分享（专栏文章，持续更新中...）https://blog.csdn.net/chenlycly/category_2276111.html 大家在开发C&#43;&#43;软件的过程中，会时不时遇到这样或那样的C/C&#43;&#43;运行时库相关问题。今天结合多年的C&#43;&#43;软件开发经验，给大家详细介绍一下C/C&#43;&#43;运行时库以及以api-ms-win-开头的UCRT系统通用运行时库，并给出了项目问题分析实例，以供大家借鉴或参考。
1、概述 使用Visual Studio开发的C&#43;&#43;应用程序，在发布时需要将C/C&#43;&#43;运行时库一起打包到安装包中，安装时将C/C&#43;&#43;运行时库放置到exe主程序的安装目录中。C&#43;&#43;应用程序调用的C/C&#43;&#43;运行时函数（比如abort、system、strlen、strcpy等）以及C&#43;&#43;标准库，都在C/C&#43;&#43;运行时库中。C&#43;&#43;应用程序依赖这些C/C&#43;&#43;运行时库，启动时需要加载这些运行时库。
为啥要带上C/C&#43;&#43;运行时库呢？如果机器上安装了Visual Studio，在安装Visual Studio时会自动将对应版本的运行时库拷贝到系统目录C:\Windows\System32（在64位系统中，32位版本的运行时库会拷贝到C:\Windows\SysWOW64目录中）。如果机器上没有安装Visual Studio，系统目录中一般不会有这些C/C&#43;&#43;运行时库，如果此时安装目录中也没有，则程序启动时会因为在系统中找不到这些库而启动失败。
2、不同版本的Visual Studio对应的运行时库说明 我们代码中调用的很多C/C&#43;&#43;基本库函数都位于C/C&#43;&#43;运行时库中，比如abort、system、strlen、strcpy等运行时库函数。一般运行时库是以msvcr（C运行时库）或msvcp（C&#43;&#43;运行时库）开头的。
不同版本的Visual Studio携带的C/C&#43;&#43;运行时库的名称也不一样，这些运行时库一般要打包到安装程序中，安装时要拷贝到exe主程序的安装目录中。
对于不同版本的Visual Studio对应的运行时库版本，很多人可能分不清楚，会有疑惑，这里详细给大家介绍一下：（以d结尾的是Debug版本的运行时库）
1）VS2010对应的运行时库文件（对应100版本）：msvcp100.dll（msvcp100d.dll）、msvcr100.dll（msvcr100d.dll）；
2）VS2012对应的运行时库文件（对应110版本）：msvcp110.dll（msvcp110d.dll）、msvcr110.dll（msvcr110d.dll）；
3）VS2013对应的运行时库文件（对应120版本）：msvcp120.dll（msvcp120d.dll）、msvcr120.dll（msvcr120d.dll）；
4）VS2017对应的运行时库文件（对应140版本）：msvcp140.dll（msvcp140d.dll）、vcruntime140.dll（vcruntime140d.dll）、u以及UCRT通用运行时库（ucrtbase.dll（ucrtbased.dll）&#43; 多个以api-ms-win-开头的dll库）。 (VS2017引入了两类新库vcruntime140.dll和UCRT，不再有msvcr140.dll库，只保留了msvcp140.dll库)
在Visual Studio 2015之前的版本中，C/C&#43;&#43;运行时库主要由msvcrXXX.dll和msvcpXXX.dll，其中XXX是对应Visual Studio版本对的数字，如上所示。 在Visual Studio 2015中，C/C&#43;&#43;运行时库被分离重构，分离成msvcp、vcruntime和UCRT，在Visual Studio 2015及以后的版本中，均使用这种新的结构。
UCRT，全称为The Universal CRT，Windows系统通用运行时库，主要由ucrtbase.dll以及api-ms-win-开头的多个dll库，如下所示：
3、在Windbg10.0安装目录中获取UCRT通用运行时库 使用Visual Studio 2015及以上版本开发的C&#43;&#43;应用程序，发布时都要带上这些通用运行时库。这些UCRT通用运行时库可以从Windows SDK中获取。比如可以从安装的Windbg10.0的安装目录中找到这些UCRT通用库，当时Windbg10.0就是使用Windows SDK安装的，所以安装目录中可以找到UCRT运行时库。比如我本机的安装目录：
C:\Program Files (x86)\Windows Kits\10\Redist\10.0.17763.0\ucrt\DLLs
在上述路径中可以找到，如下所示：（可以在Windbg安装目录中以api-ms-win为关键字搜索，找到具体的路径）
可以将这些路径下的通用运行时库拷贝到项目中，发布版本时要将这些运行时库带上。
在这里，给大家重点推荐一下我的几个热门畅销专栏，欢迎订阅：（博客主页还有其他专栏，可以去查看）
专栏1：（该精品技术专栏的订阅量已达到430多个，专栏中包含大量项目实战分析案例，有很强的实战参考价值，广受好评！专栏文章持续更新中，预计更新到200篇以上！欢迎订阅！）
C&#43;&#43;软件异常排查从入门到精通系列教程（专栏文章列表，欢迎订阅，持续更新...）https://blog.csdn.net/chenlycly/article/details/125529931
本专栏根据多年C&#43;&#43;软件异常排查的项目实践，系统地总结了引发C&#43;&#43;软件异常的常见原因以及排查C&#43;&#43;软件异常的常用思路与方法，详细讲述了C&#43;&#43;软件的调试方法与手段，以图文并茂的方式给出具体的项目问题实战分析实例（很有实战参考价值），带领大家逐步掌握C&#43;&#43;软件调试与异常排查的相关技术，适合基础进阶和想做技术提升的相关C&#43;&#43;开发人员！
考察一个开发人员的水平，一是看其编码及设计能力，二是要看其软件调试能力！所以软件调试能力（排查软件异常的能力）很重要，必须重视起来！能解决一般人解决不了的问题，既能提升个人能力及价值，也能体现对团队及公司的贡献！
专栏中的文章都是通过项目实战总结出来的，包含大量项目问题实战分析案例，有很强的实战参考价值！专栏文章还在持续更新中，预计文章篇数能更新到200篇以上！
专栏2： C/C&#43;&#43;基础与进阶（专栏文章，持续更新中...）https://blog.csdn.net/chenlycly/category_11931267.html
以多年的开发实战经验为基础，总结并讲解一些的C/C&#43;&#43;基础与进阶内容，以图文并茂的方式对C&#43;&#43;相关知识点进行详细地展开与剖析！专栏涉及了C/C&#43;&#43;开发领域多个方面的内容，同时给出C/C&#43;&#43;及网络方面的常见笔试面试题，并详细讲述Visual Studio常用调试手段与技巧！
专栏3： VC&#43;&#43;常用功能开发汇总https://blog.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-24T13:12:47+08:00">
    <meta property="article:modified_time" content="2024-05-24T13:12:47+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C/C&#43;&#43;运行时库和UCRT系统通用运行时库总结及问题实例分享</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="1%E3%80%81%E6%A6%82%E8%BF%B0-toc" style="margin-left:40px;"><a href="#1%E3%80%81%E6%A6%82%E8%BF%B0" rel="nofollow">1、概述</a></p> 
<p id="2%E3%80%81%E4%B8%8D%E5%90%8C%E7%89%88%E6%9C%AC%E7%9A%84Visual%20Studio%E5%AF%B9%E5%BA%94%E7%9A%84%E8%BF%90%E8%A1%8C%E6%97%B6%E5%BA%93%E8%AF%B4%E6%98%8E-toc" style="margin-left:40px;"><a href="#2%E3%80%81%E4%B8%8D%E5%90%8C%E7%89%88%E6%9C%AC%E7%9A%84Visual%20Studio%E5%AF%B9%E5%BA%94%E7%9A%84%E8%BF%90%E8%A1%8C%E6%97%B6%E5%BA%93%E8%AF%B4%E6%98%8E" rel="nofollow">2、不同版本的Visual Studio对应的运行时库说明</a></p> 
<p id="3%E3%80%81%E5%9C%A8Windbg10.0%E5%AE%89%E8%A3%85%E7%9B%AE%E5%BD%95%E4%B8%AD%E8%8E%B7%E5%8F%96UCRT%E9%80%9A%E7%94%A8%E8%BF%90%E8%A1%8C%E6%97%B6%E5%BA%93-toc" style="margin-left:40px;"><a href="#3%E3%80%81%E5%9C%A8Windbg10.0%E5%AE%89%E8%A3%85%E7%9B%AE%E5%BD%95%E4%B8%AD%E8%8E%B7%E5%8F%96UCRT%E9%80%9A%E7%94%A8%E8%BF%90%E8%A1%8C%E6%97%B6%E5%BA%93" rel="nofollow">3、在Windbg10.0安装目录中获取UCRT通用运行时库</a></p> 
<p id="4%E3%80%81%E5%BE%AE%E8%BD%AF%E5%AE%98%E7%BD%91%E5%AF%B9UCRT%E9%80%9A%E7%94%A8%E8%BF%90%E8%A1%8C%E6%97%B6%E5%BA%93%E7%9A%84%E7%9B%B8%E5%85%B3%E8%AF%B4%E6%98%8E-toc" style="margin-left:40px;"><a href="#4%E3%80%81%E5%BE%AE%E8%BD%AF%E5%AE%98%E7%BD%91%E5%AF%B9UCRT%E9%80%9A%E7%94%A8%E8%BF%90%E8%A1%8C%E6%97%B6%E5%BA%93%E7%9A%84%E7%9B%B8%E5%85%B3%E8%AF%B4%E6%98%8E" rel="nofollow">4、微软官网对UCRT通用运行时库的相关说明</a></p> 
<p id="5%E3%80%81%E4%BD%BF%E7%94%A8Visual%20Studio%202017%E5%BC%80%E5%8F%91%E8%BD%AF%E4%BB%B6%E5%88%9D%E6%9C%9F%E9%81%87%E5%88%B0%E7%9A%84UCRT%E9%80%9A%E7%94%A8%E8%BF%90%E8%A1%8C%E6%97%B6%E5%BA%93%E9%97%AE%E9%A2%98-toc" style="margin-left:40px;"><a href="#5%E3%80%81%E4%BD%BF%E7%94%A8Visual%20Studio%202017%E5%BC%80%E5%8F%91%E8%BD%AF%E4%BB%B6%E5%88%9D%E6%9C%9F%E9%81%87%E5%88%B0%E7%9A%84UCRT%E9%80%9A%E7%94%A8%E8%BF%90%E8%A1%8C%E6%97%B6%E5%BA%93%E9%97%AE%E9%A2%98" rel="nofollow">5、使用Visual Studio 2017开发软件初期遇到的UCRT通用运行时库问题</a></p> 
<p id="6%E3%80%81%E5%A6%82%E4%BD%95%E6%9F%A5%E7%9C%8B%E8%BD%AF%E4%BB%B6%E4%BE%9D%E8%B5%96%E4%BA%86%E5%93%AA%E4%BA%9BC%2FC%2B%2B%E8%BF%90%E8%A1%8C%E6%97%B6%E5%BA%93%EF%BC%9F-toc" style="margin-left:40px;"><a href="#6%E3%80%81%E5%A6%82%E4%BD%95%E6%9F%A5%E7%9C%8B%E8%BD%AF%E4%BB%B6%E4%BE%9D%E8%B5%96%E4%BA%86%E5%93%AA%E4%BA%9BC%2FC%2B%2B%E8%BF%90%E8%A1%8C%E6%97%B6%E5%BA%93%EF%BC%9F" rel="nofollow">6、如何查看软件依赖了哪些C/C++运行时库？</a></p> 
<p id="7%E3%80%81%E5%B0%86%E8%BD%AF%E4%BB%B6%E4%BB%8E32%E4%BD%8D%E5%8D%87%E7%BA%A7%E5%88%B064%E4%BD%8D%E5%90%8E%EF%BC%8C%E8%A6%81%E4%BD%BF%E7%94%A864%E4%BD%8DUCRT%E9%80%9A%E7%94%A8%E8%BF%90%E8%A1%8C%E6%97%B6%E5%BA%93-toc" style="margin-left:40px;"><a href="#7%E3%80%81%E5%B0%86%E8%BD%AF%E4%BB%B6%E4%BB%8E32%E4%BD%8D%E5%8D%87%E7%BA%A7%E5%88%B064%E4%BD%8D%E5%90%8E%EF%BC%8C%E8%A6%81%E4%BD%BF%E7%94%A864%E4%BD%8DUCRT%E9%80%9A%E7%94%A8%E8%BF%90%E8%A1%8C%E6%97%B6%E5%BA%93" rel="nofollow">7、将软件从32位升级到64位后，要使用64位UCRT通用运行时库</a></p> 
<p id="8%E3%80%81%E5%8F%91%E5%B8%83%E8%BD%AF%E4%BB%B6%E6%97%B6%E6%9C%AA%E6%89%93%E5%8C%85C%2FC%2B%2B%E8%BF%90%E8%A1%8C%E6%97%B6%E5%BA%93%E7%9A%84%E5%AE%9E%E4%BE%8B-toc" style="margin-left:40px;"><a href="#8%E3%80%81%E5%8F%91%E5%B8%83%E8%BD%AF%E4%BB%B6%E6%97%B6%E6%9C%AA%E6%89%93%E5%8C%85C%2FC%2B%2B%E8%BF%90%E8%A1%8C%E6%97%B6%E5%BA%93%E7%9A%84%E5%AE%9E%E4%BE%8B" rel="nofollow">8、发布软件时未打包C/C++运行时库的项目问题实例</a></p> 
<hr id="hr-toc"> 
<p><a class="link-info has-card" href="https://blog.csdn.net/chenlycly/article/details/125529931" title="C++软件异常排查从入门到精通系列教程（专栏文章列表，欢迎订阅，持续更新...）"><span class="link-card-box"><span class="link-title">C++软件异常排查从入门到精通系列教程（专栏文章列表，欢迎订阅，持续更新...）</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/9c/af/V7acFfum_o.png" alt="icon-default.png?t=N7T8">https://blog.csdn.net/chenlycly/article/details/125529931</span></span></a><a class="link-info has-card" href="https://blog.csdn.net/chenlycly/category_11931267.html" title="C/C++基础与进阶（专栏文章，持续更新中...）"><span class="link-card-box"><span class="link-title">C/C++基础与进阶（专栏文章，持续更新中...）</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/eb/7e/thQihvDD_o.png" alt="icon-default.png?t=N7T8">https://blog.csdn.net/chenlycly/category_11931267.html</span></span></a><a class="link-info has-card" href="https://blog.csdn.net/chenlycly/article/details/124272585" title="VC++常用功能开发汇总（专栏文章列表，欢迎订阅，持续更新...）"><span class="link-card-box"><span class="link-title">VC++常用功能开发汇总（专栏文章列表，欢迎订阅，持续更新...）</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/75/52/kykoMjTr_o.png" alt="icon-default.png?t=N7T8">https://blog.csdn.net/chenlycly/article/details/124272585</span></span></a><a class="link-info has-card" href="https://blog.csdn.net/chenlycly/article/details/131405795" title="C++软件分析工具从入门到精通案例集锦（专栏文章，持续更新中...）"><span class="link-card-box"><span class="link-title">C++软件分析工具从入门到精通案例集锦（专栏文章，持续更新中...）</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/40/50/psnanL3O_o.png" alt="icon-default.png?t=N7T8">https://blog.csdn.net/chenlycly/article/details/131405795</span></span></a><a class="link-info has-card" href="https://blog.csdn.net/chenlycly/category_12458859.html" title="开源组件及数据库技术（专栏文章，持续更新中...）"><span class="link-card-box"><span class="link-title">开源组件及数据库技术（专栏文章，持续更新中...）</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/fc/ae/bQo0bHqM_o.png" alt="icon-default.png?t=N7T8">https://blog.csdn.net/chenlycly/category_12458859.html</span></span></a><a class="link-info has-card" href="https://blog.csdn.net/chenlycly/category_2276111.html" title="网络编程与网络问题分享（专栏文章，持续更新中...）"><span class="link-card-box"><span class="link-title">网络编程与网络问题分享（专栏文章，持续更新中...）</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/1e/71/kjRKowse_o.png" alt="icon-default.png?t=N7T8">https://blog.csdn.net/chenlycly/category_2276111.html</span></span></a>       大家在开发C++软件的过程中，会时不时遇到这样或那样的C/C++运行时库相关问题。今天结合多年的C++软件开发经验，给大家详细介绍一下C/C++运行时库以及以api-ms-win-开头的UCRT系统通用运行时库，并给出了项目问题分析实例，以供大家借鉴或参考。</p> 
<h3 id="1%E3%80%81%E6%A6%82%E8%BF%B0">1、概述</h3> 
<p class="img-center"><img alt="" height="509" src="https://images2.imgbox.com/0f/b6/h3OHDLjN_o.png" width="585"></p> 
<p>      <strong> 使用Visual Studio开发的C++应用程序，在发布时需要将C/C++运行时库一起打包到安装包中</strong>，安装时将C/C++运行时库放置到exe主程序的安装目录中。C++应用程序调用的C/C++运行时函数（比如abort、system、strlen、strcpy等）以及C++标准库，都在C/C++运行时库中。C++应用程序依赖这些C/C++运行时库，启动时需要加载这些运行时库。</p> 
<p>       <strong>为啥要带上C/C++运行时库呢？</strong>如果机器上安装了Visual Studio，在安装Visual Studio时会自动将对应版本的运行时库拷贝到系统目录C:\Windows\System32（在64位系统中，32位版本的运行时库会拷贝到C:\Windows\SysWOW64目录中）。如果机器上没有安装Visual Studio，系统目录中一般不会有这些C/C++运行时库，如果此时安装目录中也没有，则程序启动时会因为在系统中找不到这些库而启动失败。</p> 
<h3 id="2%E3%80%81%E4%B8%8D%E5%90%8C%E7%89%88%E6%9C%AC%E7%9A%84Visual%20Studio%E5%AF%B9%E5%BA%94%E7%9A%84%E8%BF%90%E8%A1%8C%E6%97%B6%E5%BA%93%E8%AF%B4%E6%98%8E">2、不同版本的Visual Studio对应的运行时库说明</h3> 
<p>        我们代码中调用的很多C/C++基本库函数都位于C/C++运行时库中，比如abort、system、strlen、strcpy等运行时库函数。一般运行时库是以msvcr（C运行时库）或msvcp（C++运行时库）开头的。</p> 
<p style="text-align:center;"><img alt="" height="236" src="https://images2.imgbox.com/3a/8a/K7Lwhxdy_o.png" width="472"></p> 
<p>       不同版本的Visual Studio携带的C/C++运行时库的名称也不一样，这些运行时库一般要打包到安装程序中，安装时要拷贝到exe主程序的安装目录中。</p> 
<p>       <strong>对于不同版本的Visual Studio对应的运行时库版本</strong>，很多人可能分不清楚，会有疑惑，这里详细给大家介绍一下：（以d结尾的是Debug版本的运行时库）</p> 
<blockquote> 
 <p><span style="color:#0d0016;"><strong>1）VS2010对应的运行时库文件</strong>（对应100版本）：msvcp100.dll（msvcp100d.dll）、msvcr100.dll（msvcr100d.dll）；<br><strong>2）VS2012对应的运行时库文件</strong>（对应110版本）：msvcp110.dll（msvcp110d.dll）、msvcr110.dll（msvcr110d.dll）；<br><strong>3）VS2013对应的运行时库文件</strong>（对应120版本）：msvcp120.dll（msvcp120d.dll）、msvcr120.dll（msvcr120d.dll）；<br><strong>4）VS2017对应的运行时库文件</strong>（对应140版本）：msvcp140.dll（msvcp140d.dll）、vcruntime140.dll（vcruntime140d.dll）、u以及UCRT通用运行时库（ucrtbase.dll（ucrtbased.dll）+ 多个以api-ms-win-开头的dll库）。 (VS2017引入了两类新库vcruntime140.dll和UCRT，不再有msvcr140.dll库，只保留了msvcp140.dll库)</span></p> 
</blockquote> 
<p>       在Visual Studio 2015之前的版本中，C/C++运行时库主要由msvcrXXX.dll和msvcpXXX.dll，其中XXX是对应Visual Studio版本对的数字，如上所示。<span style="color:#1a439c;"><strong> 在Visual Studio 2015中，C/C++运行时库被分离重构，分离成msvcp、vcruntime和UCRT，在Visual Studio 2015及以后的版本中，均使用这种新的结构。</strong></span></p> 
<p> <strong>      UCRT，全称为The Universal CRT，Windows系统通用运行时库</strong>，主要由ucrtbase.dll以及api-ms-win-开头的多个dll库，如下所示：</p> 
<p class="img-center"><img alt="" height="595" src="https://images2.imgbox.com/36/3c/8fVrMAIf_o.png" width="545"></p> 
<h3 id="3%E3%80%81%E5%9C%A8Windbg10.0%E5%AE%89%E8%A3%85%E7%9B%AE%E5%BD%95%E4%B8%AD%E8%8E%B7%E5%8F%96UCRT%E9%80%9A%E7%94%A8%E8%BF%90%E8%A1%8C%E6%97%B6%E5%BA%93">3、在Windbg10.0安装目录中获取UCRT通用运行时库</h3> 
<p>       使用Visual Studio 2015及以上版本开发的C++应用程序，发布时都要带上这些通用运行时库。这些UCRT通用运行时库可以从Windows SDK中获取。比如可以从安装的Windbg10.0的安装目录中找到这些UCRT通用库，当时Windbg10.0就是使用Windows SDK安装的，所以安装目录中可以找到UCRT运行时库。比如我本机的安装目录：</p> 
<blockquote> 
 <p><span style="color:#0d0016;">C:\Program Files (x86)\Windows Kits\10\Redist\10.0.17763.0\ucrt\DLLs</span></p> 
</blockquote> 
<p>在上述路径中可以找到，如下所示：（<span style="color:#be191c;"><em>可以在Windbg安装目录中以api-ms-win为关键字搜索，找到具体的路径</em></span><span style="color:#0d0016;">）</span></p> 
<p class="img-center"><img alt="" height="627" src="https://images2.imgbox.com/3f/88/ZxtcMRYX_o.png" width="700"></p> 
<p>可以将这些路径下的通用运行时库拷贝到项目中，发布版本时要将这些运行时库带上。</p> 
<hr> 
<p>       在这里，给大家<span style="color:#be191c;"><strong>重点推荐一下我的几个热门畅销专栏，欢迎订阅：</strong>（博客主页还有其他专栏，可以去查看）</span></p> 
<p><span style="color:#be191c;"><strong>专栏1：</strong>（该精品技术专栏的订阅量已达到430多个，专栏中包含大量项目实战分析案例，有很强的实战参考价值，广受好评！专栏文章持续更新中，预计更新到200篇以上！欢迎订阅！）</span></p> 
<p><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><a class="link-info has-card" href="https://blog.csdn.net/chenlycly/article/details/125529931" title="C++软件异常排查从入门到精通系列教程（专栏文章列表，欢迎订阅，持续更新...）"><span class="link-card-box"><span class="link-title">C++软件异常排查从入门到精通系列教程（专栏文章列表，欢迎订阅，持续更新...）</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/bd/d9/HdyhMLOI_o.png" alt="icon-default.png?t=N7T8">https://blog.csdn.net/chenlycly/article/details/125529931</span></span></a></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></p> 
<blockquote> 
 <p><span style="color:#0d0016;">本专栏根据多年C++软件异常排查的项目实践，系统地总结了<strong>引发C++软件异常的常见原因以及排查C++软件异常的常用思路与方法</strong>，详细讲述了C++软件的调试方法与手段，<strong>以图文并茂的方式给出具体的项目问题实战分析实例（很有实战参考价值）</strong>，带领大家逐步掌握C++软件调试与异常排查的相关技术，适合基础进阶和想做技术提升的相关C++开发人员！</span></p> 
 <p><span style="color:#0d0016;"><strong>考察一个开发人员的水平，一是看其编码及设计能力，二是要看其软件调试能力</strong>！所以<strong>软件调试能力（排查软件异常的能力）很重要</strong>，必须重视起来！能解决一般人解决不了的问题，既能提升个人能力及价值，也能体现对团队及公司的贡献！</span></p> 
 <p><span style="color:#0d0016;"><strong>专栏中的文章都是通过项目实战总结出来的，包含大量项目问题实战分析案例，有很强的实战参考价值！</strong>专栏文章还在持续更新中，预计文章篇数能更新到200篇以上！</span></p> 
</blockquote> 
<p><strong><span style="color:#be191c;">专栏2</span>： </strong></p> 
<p><a class="link-info has-card" href="https://blog.csdn.net/chenlycly/category_11931267.html" title="C/C++基础与进阶（专栏文章，持续更新中...）"><span class="link-card-box"><span class="link-title">C/C++基础与进阶（专栏文章，持续更新中...）</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/6d/e1/Jdk0TMuW_o.png" alt="icon-default.png?t=N7T8">https://blog.csdn.net/chenlycly/category_11931267.html</span></span></a></p> 
<blockquote> 
 <p><span style="color:#0d0016;">以多年的开发实战经验为基础，总结并讲解一些的C/C++基础与进阶内容，以图文并茂的方式对C++相关知识点进行详细地展开与剖析！专栏涉及了C/C++开发领域多个方面的内容，同时给出C/C++及网络方面的常见笔试面试题，并详细讲述Visual Studio常用调试手段与技巧！</span></p> 
</blockquote> 
<p><strong><span style="color:#be191c;">专栏3</span>： </strong></p> 
<p><a class="link-info has-card" href="https://blog.csdn.net/chenlycly/article/details/124272585" title="VC++常用功能开发汇总"><span class="link-card-box"><span class="link-title">VC++常用功能开发汇总</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/57/46/QTCgNY45_o.png" alt="icon-default.png?t=N7T8">https://blog.csdn.net/chenlycly/article/details/124272585</span></span></a></p> 
<blockquote> 
 <p><span style="color:#0d0016;">专栏将10多年C++开发实践中常用的功能，以高质量的代码展现出来，并对相关功能的实现细节进行了详细的说明。这些常用的代码，其质量与稳定性是有保证的，可以直接拿过去使用，可以有效地解决C++软件开发过程中遇到的问题。</span></p> 
</blockquote> 
<hr> 
<h3 id="4%E3%80%81%E5%BE%AE%E8%BD%AF%E5%AE%98%E7%BD%91%E5%AF%B9UCRT%E9%80%9A%E7%94%A8%E8%BF%90%E8%A1%8C%E6%97%B6%E5%BA%93%E7%9A%84%E7%9B%B8%E5%85%B3%E8%AF%B4%E6%98%8E">4、微软官网对UCRT通用运行时库的相关说明</h3> 
<p>       微软官网也有介绍UCRT通用运行时库的相关介绍，直接在<a href="https://learn.microsoft.com/" rel="nofollow" title="Microsoft Learn: Build skills that open doors in your career">Microsoft Learn: Build skills that open doors in your career</a>上搜索UCRT，会搜索到如下结果：</p> 
<div> 
 <p><img alt="" height="659" src="https://images2.imgbox.com/05/22/gj4xElxP_o.png" width="1006">​</p> 
</div> 
<p>点击“将代码升级到通用 CRT”这一项，进入页面，其链接为：（此处提供英文版本的链接，如果要查看中文，可以在页面底部左下角的语言切换栏切换成中文）<br><a class="link-info has-card" href="https://learn.microsoft.com/en-us/cpp/porting/upgrade-your-code-to-the-universal-crt?view=msvc-170" rel="nofollow" title="Upgrade your code to the Universal CRT"><span class="link-card-box"><span class="link-title">Upgrade your code to the Universal CRT</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/27/3d/YEtcf8h6_o.png" alt="icon-default.png?t=N7T8">https://learn.microsoft.com/en-us/cpp/porting/upgrade-your-code-to-the-universal-crt?view=msvc-170</span></span></a>在该网页中可以看到如何获取UCRT运行时库，如下所示：</p> 
<div> 
 <p class="img-center"><img alt="" height="604" src="https://images2.imgbox.com/ed/f0/vNn5qcwP_o.png" width="698"></p> 
 <h3>​5、使用Visual Studio 2017开发软件初期遇到的UCRT通用运行时库问题</h3> 
</div> 
<p>        我们项目之前使用Visual Studio 2010开发的，后来因为使用了Visual Studio 2017编译的开源WebRTC库，将Visual Studio升级到了2017版本。最开始并不知道UCRT通用运行时库的存在，在发布版本时没有将这些以api-ms-win-开头的通用运行时库带上，导致在部分机器上启动程序时会报错：</p> 
<div> 
 <p class="img-center"><img alt="" height="206" src="https://images2.imgbox.com/0b/56/zNX4fdL8_o.png" width="483"></p> 
 <p>​后来查看腾讯会议、WPS和企业微信等程序的安装目录中均有带上多个以api-ms-win-开头多个dll库：</p> 
</div> 
<div> 
 <p class="img-center"><img alt="" height="664" src="https://images2.imgbox.com/4b/17/aFR4nhfN_o.png" width="594"></p> 
 <p>​估计是这些库是个集合库，使用Visual Studio较高版本开发的C++应用程序在发布时都要打包带上。</p> 
</div> 
<p>       关于如何获取这些以“api-ms-win”开头的dll库，到网上搜索了一下，<strong>有人在微软的技术论坛中问过UCRT通用运行时库的问题</strong>，如下：</p> 
<p><a class="link-info has-card" href="https://social.technet.microsoft.com/Forums/windows/en-US/327da89c-9d1c-4dca-9371-9771eabc3df9/missing-api-dll-api-stub-set-for-windows?forum=win10itprogeneral" rel="nofollow" title="Missing API DLL API STUB Set for Windows"><span class="link-card-box"><span class="link-title">Missing API DLL API STUB Set for Windows</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/46/e0/1tHB1bUR_o.png" alt="icon-default.png?t=N7T8">https://social.technet.microsoft.com/Forums/windows/en-US/327da89c-9d1c-4dca-9371-9771eabc3df9/missing-api-dll-api-stub-set-for-windows?forum=win10itprogeneral</span></span></a>评论区中有人回复，<strong>可以参照下面这篇文章中的说明</strong>：<br><a class="link-info has-card" href="https://devblogs.microsoft.com/cppblog/introducing-the-universal-crt/" rel="nofollow" title="Introducing the Universal CRT"><span class="link-card-box"><span class="link-title">Introducing the Universal CRT</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/15/fb/xjWXuDqt_o.png" alt="icon-default.png?t=N7T8">https://devblogs.microsoft.com/cppblog/introducing-the-universal-crt/</span></span></a>其中下面一段话讲到了如何去获取the Universal CRT系统通用运行时库，如下所示：</p> 
<div> 
 <p class="img-center"><img alt="" height="638" src="https://images2.imgbox.com/ec/d7/Xvps584X_o.png" width="701"></p> 
 <p>​<strong>于是这才知道，这些以api-ms-win-开头多个dll库叫做UCRT通用运行时库。</strong></p> 
</div> 
<h3 id="6%E3%80%81%E5%A6%82%E4%BD%95%E6%9F%A5%E7%9C%8B%E8%BD%AF%E4%BB%B6%E4%BE%9D%E8%B5%96%E4%BA%86%E5%93%AA%E4%BA%9BC%2FC%2B%2B%E8%BF%90%E8%A1%8C%E6%97%B6%E5%BA%93%EF%BC%9F">6、如何查看软件依赖了哪些C/C++运行时库？</h3> 
<p>       当前软件到底依赖了哪些C/C++运行时库，<strong>可以直接在开发着的机器上将软件运行起来，然后使用Process Exploer工具查看软件进程加载的dll库列表</strong>，就能看到了，比如：</p> 
<div> 
 <p class="img-center"><img alt="" height="628" src="https://images2.imgbox.com/0b/9b/BdUJLKd1_o.png" width="867"></p> 
 <p>​当然，也可以使用dumpbin工具将软件所有模块的依赖库打印出来，也能找到依赖哪些运行时库。具体如何使用dumpbin查看库依赖关系，可以查看我之前写的文章：</p> 
</div> 
<p><a class="link-info has-card" href="https://blog.csdn.net/chenlycly/article/details/135483516" title="将dumpbin从Visual Studio中抠出来，并使用dumpbin查看exe和dll库的依赖关系"><span class="link-card-box"><span class="link-title">将dumpbin从Visual Studio中抠出来，并使用dumpbin查看exe和dll库的依赖关系</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/08/d0/fYF0C559_o.png" alt="icon-default.png?t=N7T8">https://blog.csdn.net/chenlycly/article/details/135483516</span></span></a><strong>       如果程序中使用了多个版本的Visual Studio编译的模块</strong>，则需要把这些Visual Studio版本对应的运行时库都带上的。比如有些模块是Visual Studio 2010编译出来的，则会依赖msvcr100.dll和msvcp100.dll；有些模块是Visual Studio 2017编译出来的，则会依赖msvcp140.dll和vcruntime140.dll等库。在发布版本时需要将这些依赖的dll库都带上。</p> 
<p>       <strong>对于以api-ms-win-开头多个dll库UCRT通用运行时库</strong>，可以先到官网上搜索Windbg，然后通过Windows SDK去安装Windbg，然后在Windbg的安装路径中就能找到这些通用运行时库，比如我本机的安装目录C:\Program Files (x86)\Windows Kits\10\Redist\10.0.17763.0\ucrt\DLLs中可以找到，如下所示：（可以在Windbg安装目录中以api-ms-win为关键字搜索，找到具体的路径）</p> 
<div> 
 <p class="img-center"><img alt="" height="627" src="https://images2.imgbox.com/4a/44/jtbRqWni_o.png" width="700"></p> 
 <h3>​7、将软件从32位升级到64位后，要使用64位UCRT通用运行时库</h3> 
</div> 
<p>       <strong>最近将软件从32位升级到64位，要将打包的运行时库都换成64位的</strong>，比如msvcp140.dll、vcruntime140.dll等库路径，可以在开发者的机器上将64位软件运行起来，然后使用Process Explorer工具查看这些库的路径：</p> 
<div> 
 <p class="img-center"><img alt="" height="628" src="https://images2.imgbox.com/fb/12/eoCR7XkH_o.png" width="867"></p> 
 <p>到路径中将dll库拷贝到项目中即可。</p> 
</div> 
<p>       但对于以api-ms-win-开头多个UCRT通用运行时库，因为包含了多个dll库，要将所有的dll库都拷贝上，不好使用Process Explorer工具查看，<span style="color:#1a439c;"><strong>可以到Windbg安装路径中整体拷贝x64版本UCRT</strong></span>即可。比如我本机的安装目录：</p> 
<blockquote> 
 <p><span style="color:#0d0016;">C:\Program Files (x86)\Windows Kits\10\Redist\10.0.17763.0\ucrt\DLLs</span></p> 
</blockquote> 
<p>可以在这个路径中找到，如下所示：（可以在Windbg安装目录中以api-ms-win为关键字搜索，找到具体的路径）</p> 
<div> 
 <p class="img-center"><img alt="" height="160" src="https://images2.imgbox.com/39/7d/GihDO4GA_o.png" width="635"></p> 
 <p>​该路径下有x86和x64两个版本，分别对应32位和64位，我们拷贝x64版本即可。</p> 
</div> 
<h3 id="8%E3%80%81%E5%8F%91%E5%B8%83%E8%BD%AF%E4%BB%B6%E6%97%B6%E6%9C%AA%E6%89%93%E5%8C%85C%2FC%2B%2B%E8%BF%90%E8%A1%8C%E6%97%B6%E5%BA%93%E7%9A%84%E5%AE%9E%E4%BE%8B">8、发布软件时未打包C/C++运行时库的项目问题实例</h3> 
<p>       某天同事在调试使用瑞芯微主控CPU芯片的嵌入式设备（嵌入式设备使用的是Android系统）时，需要在PC上使用瑞芯微提供的一个工具软件去远程配置图像质量参数，但这个工具启动时会报错，无法运行，如下所示：</p> 
<div> 
 <p class="img-center"><img alt="" height="180" src="https://images2.imgbox.com/0d/18/aWEIdmb5_o.png" width="483"></p> 
 <p>​同事找到我，让我帮他们看看是怎么回事，看能否让这个工具尽快跑起来。经排查，瑞芯微提供的工具软件包没有将依赖的运行时库msvcr120.dll和msvcp120.dll一起带上，如下：</p> 
</div> 
<div> 
 <p class="img-center"><img alt="" height="578" src="https://images2.imgbox.com/10/73/fKkK64zZ_o.png" width="829"></p> 
 <p>​正好同事的电脑上没有这两个库，所以启动报错。瑞芯微是做硬件芯片的，可能软件这块不专业，这点也可以理解。</p> 
</div> 
<p>     <strong>  这个问题的详细排查过程</strong>，可以查看我之前写的文章：</p> 
<p><a class="link-info has-card" href="https://blog.csdn.net/chenlycly/article/details/135229025" title="使用Dependency Walker和Process Explorer排查瑞芯微工具软件RKPQTool.exe启动报错问题"><span class="link-card-box"><span class="link-title">使用Dependency Walker和Process Explorer排查瑞芯微工具软件RKPQTool.exe启动报错问题</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/cf/ba/hYLxbuPh_o.png" alt="icon-default.png?t=N7T8">https://blog.csdn.net/chenlycly/article/details/135229025</span></span></a><strong>       另一个与C/C++运行时库相关的实例</strong>，可以查看我的文章：</p> 
<p><a class="link-info has-card" href="https://blog.csdn.net/chenlycly/article/details/135483683" title="使用Process Explorer和Dependency Walker排查程序启动时缺少ucrtbase.dll等运行时库以及报0xC000007B错误"><span class="link-card-box"><span class="link-title">使用Process Explorer和Dependency Walker排查程序启动时缺少ucrtbase.dll等运行时库以及报0xC000007B错误</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/68/e9/EzQfLnAZ_o.png" alt="icon-default.png?t=N7T8">https://blog.csdn.net/chenlycly/article/details/135483683</span></span></a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/43dc0e67291fd41053357beba9a76956/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">YOLOv8制作自己的实例分割数据集保姆级教程（包含json转txt）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/57fba68c47a7486040caf52d800e3b7b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Python】超详细实例讲解python多线程（threading模块）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>