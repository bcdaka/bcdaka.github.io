<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>浏览器自动化脚本 Selenium WebDriver 快速入门 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/591b542ef6c498c5d23dd40700238d3e/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="浏览器自动化脚本 Selenium WebDriver 快速入门">
  <meta property="og:description" content="2024软件测试面试刷题，这个小程序（永久刷题），靠它快速找到工作了！（刷题APP的天花板）_软件测试刷题小程序-CSDN博客文章浏览阅读2.7k次，点赞85次，收藏12次。你知不知道有这么一个软件测试面试的刷题小程序。里面包含了面试常问的软件测试基础题，web自动化测试、app自动化测试、接口测试、性能测试、自动化测试、安全测试及一些常问到的人力资源题目。最主要的是他还收集了像阿里、华为这样的大厂面试真题，还有互动交流板块……_软件测试刷题小程序https://blog.csdn.net/AI_Green/article/details/134931243?spm=1001.2014.3001.5502
一、Selenium Webdriver 常用的API （一）引入依赖 &lt;dependency&gt; &lt;groupId&gt;org.seleniumhq.selenium&lt;/groupId&gt; &lt;artifactId&gt;selenium-java&lt;/artifactId&gt; &lt;version&gt;3.141.59&lt;/version&gt; &lt;/dependency&gt; 开始：
public static void main(String[] args) throws InterruptedException { ChromeOptions options = new ChromeOptions(); //允许任何来源的远程连接，这样可以避免一些跨域问题。 options.addArguments(&#34;--remote-allow-origins=*&#34;); //初始化 chrome 浏览器 driver 对象 WebDriver webDriver = new ChromeDriver(options); // 访问指定网页 webDriver.get(&#34;https://juejin.cn&#34;); //开始操作页面 //…… } 其它浏览器：
WebDriver driver = new FirefoxDriver(); // Firefox浏览器 WebDriver driver = new EdgeDriver(); // Edge浏览器 WebDriver driver = new InternetExplorerDriver(); // Internet Explorer浏览器 …… （二）元素的定位 要想操作一个对象，首先应该识别这个对象。通过下面的 API，可以获取页面上的标签对象，从而来操作它们。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-04T16:45:52+08:00">
    <meta property="article:modified_time" content="2024-03-04T16:45:52+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">浏览器自动化脚本 Selenium WebDriver 快速入门</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/9f/52/K056AZkN_o.png"></p> 
<p><a class="has-card" href="https://blog.csdn.net/AI_Green/article/details/134931243?spm=1001.2014.3001.5502" title="2024软件测试面试刷题，这个小程序（永久刷题），靠它快速找到工作了！（刷题APP的天花板）_软件测试刷题小程序-CSDN博客"><span class="link-card-box"><span class="link-title">2024软件测试面试刷题，这个小程序（永久刷题），靠它快速找到工作了！（刷题APP的天花板）_软件测试刷题小程序-CSDN博客</span><span class="link-desc">文章浏览阅读2.7k次，点赞85次，收藏12次。你知不知道有这么一个软件测试面试的刷题小程序。里面包含了面试常问的软件测试基础题，web自动化测试、app自动化测试、接口测试、性能测试、自动化测试、安全测试及一些常问到的人力资源题目。最主要的是他还收集了像阿里、华为这样的大厂面试真题，还有互动交流板块……_软件测试刷题小程序</span><span class="link-link"><img alt="" class="link-link-icon" src="https://images2.imgbox.com/6b/96/fquD00Pl_o.png">https://blog.csdn.net/AI_Green/article/details/134931243?spm=1001.2014.3001.5502</span></span></a></p> 
<h3> 一、Selenium Webdriver 常用的API</h3> 
<h4>（一）引入依赖</h4> 
<pre><code class="hljs">        &lt;dependency&gt;
            &lt;groupId&gt;org.seleniumhq.selenium&lt;/groupId&gt;
            &lt;artifactId&gt;selenium-java&lt;/artifactId&gt;
            &lt;version&gt;3.141.59&lt;/version&gt;
        &lt;/dependency&gt;
</code></pre> 
<p>开始：</p> 
<pre><code class="hljs">    public static void main(String[] args) throws InterruptedException {
        ChromeOptions options = new ChromeOptions();
        //允许任何来源的远程连接，这样可以避免一些跨域问题。
        options.addArguments("--remote-allow-origins=*");
        //初始化 chrome 浏览器 driver 对象
        WebDriver webDriver = new ChromeDriver(options);
        // 访问指定网页
        webDriver.get("https://juejin.cn");
        //开始操作页面
        //……
    }
</code></pre> 
<p>其它浏览器：</p> 
<pre><code class="hljs">WebDriver driver = new FirefoxDriver();  // Firefox浏览器
 
WebDriver driver = new EdgeDriver();  // Edge浏览器
 
WebDriver driver = new InternetExplorerDriver();  // Internet Explorer浏览器

……
</code></pre> 
<h4>（二）元素的定位</h4> 
<p>要想操作一个对象，首先应该识别这个对象。通过下面的 API，可以获取页面上的标签对象，从而来操作它们。</p> 
<h5>1.css选择器定位</h5> 
<p>css选择器定位，在css中有标签选择器、类选择器、id选择器、后代选择器、子选择器、并集选择器……它们对应的语法在在这里也适用。</p> 
<pre><code class="hljs">    public static void main(String[] args) throws InterruptedException {
        
        ChromeOptions options = new ChromeOptions();
        //允许任何来源的远程连接，这样可以避免一些跨域问题。
        options.addArguments("--remote-allow-origins=*");
        WebDriver webDriver = new ChromeDriver(options);
        // 访问指定网页
        webDriver.get("https://juejin.cn");
        //css 选择器 方式1：id选择
        WebElement element = webDriver.findElement(By.cssSelector("#elementId"));
        //css 选择器 方式2：类选择
        WebElement element2 = webDriver.findElement(By.cssSelector(".elementClass"));
        //css 选择器 方式3：后代选择
        WebElement element2 = webDriver.findElement(By.cssSelector(".elementClass1 .elementClass2……"));
        //其它方式
        ……
    }
</code></pre> 
<p>案例：我想要用webDriver在掘金主页搜索框中输入“java”并点击搜索。</p> 
<ol><li>先看掘金主页源码中搜索框、搜索按钮的标签属性。</li></ol> 
<p><img alt="" height="736" src="https://images2.imgbox.com/dd/ea/LHxq5REg_o.png" width="1200"></p> 
<p><img alt="" height="606" src="https://images2.imgbox.com/f0/87/2GZbGE4w_o.png" width="1033"></p> 
<ol><li>代码</li></ol> 
<pre><code class="hljs">public static void main(String[] args) {
    ChromeOptions options = new ChromeOptions();
    //允许任何来源的远程连接，这样可以避免一些跨域问题。
    options.addArguments("--remote-allow-origins=*");
    WebDriver webDriver = new ChromeDriver(options);
    // 访问指定网页
    webDriver.get("https://juejin.cn");
    //获取搜索框
    WebElement input = webDriver.findElement(By.cssSelector(".search-input"));
    //输入值
    input.sendKeys("java");
    //获取搜索按钮
    WebElement seach = webDriver.findElement(By.cssSelector(".seach-icon-container"));
    //点击该元素
    seach.click();
}
</code></pre> 
<p><img alt="" height="445" src="https://images2.imgbox.com/61/8d/6kSGWfRd_o.png" width="827"></p> 
<p>为了简洁，文章后面就不放查找标签class属性的截图了，知道怎么查找就行了。</p> 
<h5>2.id 定位</h5> 
<p>这个跟 css选择器定位 类似，可以作为它的简便写法</p> 
<pre><code class="hljs">webDriver.findElement(By.id("页面元素的id值"));
</code></pre> 
<p>3.name 定位</p> 
<p>如果这个元素有name属性，并且元素的name命名在整个页面是唯一的，那么我们可以用name来定位这个 元素。</p> 
<pre><code class="hljs">webDriver.findElement(By.name("页面元素的name值"));
</code></pre> 
<h5>4.className、tagName 定位</h5> 
<p>className就是根据类名字选择，tagName是根据标签名选择。</p> 
<pre><code class="hljs">webDriver.findElement(By.className("class的名字"));
webDriver.findElement(By.tagName("标签的名字"));
</code></pre> 
<h5>5.linkText定位</h5> 
<p>对一个文字链接进行定位，我们可以通过链接内容，也就是 link text 来定位。</p> 
<pre><code class="hljs">//获取链接元素
WebElement link = webDriver.findElement(By.linkText("链接文本"));
</code></pre> 
<p>自动进入首页的“后端”页面</p> 
<pre></pre> 
<h5>6.partialLinkText定位</h5> 
<p>只用链接的一部分文字进行匹配。</p> 
<pre><code class="hljs">//获取带“text”的链接
WebElement link = webDriver.findElement(By.partialLinkText("text"));
//获取所有的带“text”的链接
List&lt;WebElement&gt; articles =  webDriver.findElements(By.partialLinkText("text"));
</code></pre> 
<p>注意，这里适用的是<code>findElements</code>，而不是<code>findElement</code>。当获取的元素有多个的时候就使用<code>findElements</code>。</p> 
<h5>7.xpath 定位</h5> 
<p>xpath表达式：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.runoob.com%2Fxpath%2Fxpath-syntax.html" rel="nofollow" title="XPath 语法 | 菜鸟教程 (runoob.com)">XPath 语法 | 菜鸟教程 (runoob.com)</a></p> 
<pre><code class="hljs">webDriver.findElement(By.xpath("XPath定位表达式"));
</code></pre> 
<p>XPath 是一种在 XML 文档中定位元素的语言。因为 HTML 可以看做 XML 的一种实现，所以可以使用这种语言在 web 应用中定位元素。</p> 
<table><thead><tr><th>表达式</th><th>描述</th></tr></thead><tbody><tr><td>nodename</td><td>选取此节点的所有子节点。</td></tr><tr><td>/</td><td>从根节点选取（取子节点）。</td></tr><tr><td>//</td><td>从匹配选择的当前节点选择文档中的节点，而不考虑它们的位置（取子孙节点）。</td></tr><tr><td>.</td><td>选取当前节点。</td></tr><tr><td>..</td><td>选取当前节点的父节点。</td></tr><tr><td>@</td><td>选取属性。</td></tr></tbody></table> 
<table><thead><tr><th>通配符</th><th>描述</th></tr></thead><tbody><tr><td>*</td><td>匹配任何元素节点。</td></tr><tr><td>@*</td><td>匹配任何属性节点。</td></tr><tr><td>node()</td><td>匹配任何类型的节点。</td></tr></tbody></table> 
<p>比如：//form//span[1]/input。表示选择文档中所有的 <code>&lt;form&gt;</code> 元素，然后在每个 <code>&lt;form&gt;</code> 元素内部找到第一个 <code>&lt;span&gt;</code> 元素，然后再在这个 <code>&lt;span&gt;</code> 元素内部选择一个 <code>&lt;input&gt;</code> 元素。</p> 
<p>可以在页面中快速地获取<code>xpath</code>，就以搜索框为例：</p> 
<p><img alt="" height="797" src="https://images2.imgbox.com/19/20/Qqqir4DS_o.png" width="888"></p> 
<pre><code class="hljs">WebElement element1 = webDriver.findElement(By.xpath("//*[@id=\"juejin\"]/div[1]/div[1]/header/div/nav/ul/ul/li[1]/ul/li[1]/form/input"));
</code></pre> 
<h4>（三）操作测试对象</h4> 
<p>  定位只是第一步，定位之后需要对这个元素进行操作。它们都是 <code>WebElement</code> 接口的方法。</p> 
<ul><li><code>sendKeys()</code>：模拟键盘向输入框里输入内容。</li><li><code>click()</code>：用于单击一个元素，前提是它是可以被单击的对象。</li><li><code>getSize()</code>：返回元素的尺寸。</li><li><code>getText()</code>：获取元素的文本。</li><li><code>getAttribute()</code>：获得属性的值。</li><li><code>isDisplayed()</code>：查看该元素是否用户可见，返回值为布尔值。</li><li><code>submit()</code>：用于提交表单，前提必须得有<code>&lt;form&gt;</code>标签。</li><li><code>clear()</code>：用于清除文本输入框中的内容。</li></ul> 
<h4>（四）元素等待方式</h4> 
<p>案例：百度搜索，在搜索框中输入“软件测试”，统计当前页显示出来多少词条。</p> 
<pre><code class="hljs">    public static void main(String[] args) {
        ChromeOptions options = new ChromeOptions();
        //允许任何来源的远程连接，这样可以避免一些跨域问题。
        options.addArguments("--remote-allow-origins=*");
        WebDriver webDriver = new ChromeDriver(options);
        webDriver.get("https://baidu.com");
        //css 选择器，选择输入框
        WebElement input = webDriver.findElement(By.cssSelector("#kw"));
        //输入软件测试
        input.sendKeys("软件测试");
        //点击搜索按钮
        webDriver.findElement(By.cssSelector("#su")).click();
        //获取词条
        List&lt;WebElement&gt; aEms = webDriver.findElements(By.cssSelector("a em"));
        //查看词条数量
        System.out.println(aEms.size());
    }
</code></pre> 
<p>结果：</p> 
<p><img alt="" height="329" src="https://images2.imgbox.com/ce/66/ZAYIFAAY_o.png" width="955"></p> 
<p>这里的结果是0，因为程序还没等浏览器页面加载完 就执行完了，下面就是解决办法。</p> 
<h5>1.使用 sleep()</h5> 
<p>直接使用<code>Thread.sleep()</code>使当前的线程睡眠。</p> 
<pre><code class="hljs">public static void main(String[] args) throws InterruptedException {
    ChromeOptions options = new ChromeOptions();
    //允许任何来源的远程连接，这样可以避免一些跨域问题。
    options.addArguments("--remote-allow-origins=*");
    WebDriver webDriver = new ChromeDriver(options);
    webDriver.get("https://baidu.com");
    //css 选择器，选择输入框
    WebElement input = webDriver.findElement(By.cssSelector("#kw"));
    //输入软件测试
    input.sendKeys("软件测试");
    //点击搜索按钮
    webDriver.findElement(By.cssSelector("#su")).click();
    //睡眠 1 秒
    Thread.sleep(1000);
    //获取所有的 a em 元素，这里也就是词条
    List&lt;WebElement&gt; aEms = webDriver.findElements(By.cssSelector("a em"));
    System.out.println(aEms.size());
}
</code></pre> 
<p>结果：</p> 
<p><img alt="" height="286" src="https://images2.imgbox.com/9e/a3/2DUF23LK_o.png" width="1104"></p> 
<p>这时就把当前页面的词条全获取了。但是用sleep有一个缺点，就是无法把握时间点。如果时间短了则元素获取不完整，如果长了就需要阻塞很长时间，效率低下。好在<code>webDriver</code>提供了API来解决这些问题。</p> 
<h5>2.隐式等待</h5> 
<p>Web驱动程序在每次查找元素时都等待一定的时间，<strong>直到找到元素或者超时为止</strong>。<strong>隐式等待只需要设置一次，就会对整个会话生效</strong>。隐式等待的优点是简单易用，缺点是不能针对特定的元素或条件进行灵活的调整。隐式等待可以通过如下代码实现：</p> 
<pre><code class="hljs">……
WebDriver webDriver = new ChromeDriver();
//全局的隐式等待
webDriver.manage().timeouts().implicitlyWait(5, TimeUnit.SECONDS);
……
</code></pre> 
<pre><code class="hljs">    public static void main(String[] args) {
        ChromeOptions options = new ChromeOptions();
        //允许任何来源的远程连接，这样可以避免一些跨域问题。
        options.addArguments("--remote-allow-origins=*");
        WebDriver webDriver = new ChromeDriver(options);
        //设置全局隐式等待，最长等待时间为 5 秒
        webDriver.manage().timeouts().implicitlyWait(5, TimeUnit.SECONDS);
        webDriver.get("https://baidu.com");
        //css 选择器，选择输入框
        WebElement input = webDriver.findElement(By.cssSelector("#kw"));
        //输入软件测试
        input.sendKeys("软件测试");
        //点击搜索按钮
        webDriver.findElement(By.cssSelector("#su")).click();
        //获取元素
        List&lt;WebElement&gt; aEms = webDriver.findElements(By.cssSelector("a em"));
        System.out.println(aEms.size());
    }
</code></pre> 
<p>结果：</p> 
<p><img alt="" height="267" src="https://images2.imgbox.com/f2/2e/O3p2V1C3_o.png" width="1111"></p> 
<h5>3.显示等待</h5> 
<p>显示等待可以对一个元素进行等待，比隐式等待更灵活。</p> 
<p>语法：</p> 
<pre><code class="hljs">WebDriver webDriver = new ChromeDriver();
WebDriverWait wait = new WebDriverWait(webDriver, 5, 1);
WebElement elem = wait.until(ExpectedConditions.presenceOfElementLocated(/* By选择 */By.id("元素id")));
</code></pre> 
<p>对于第二行代码：</p> 
<ul><li>webDriver：浏览器驱动</li><li>5：最长超时时间（默认以秒为单位）</li><li>1：检测的的间隔时间</li></ul> 
<p>第三行代码：</p> 
<p><code>ExpectedConditions</code> 它包含了一系列的预定义条件，用于等待页面上的元素出现或者满足特定的条件。</p> 
<p><code>presenceOfElementLocated</code>方法会等待页面上的一个元素出现，直到它被找到或者超时。这个元素的ID是"元素id"。如果元素被找到，该方法会返回一个<code>WebElement</code>对象，然后这个对象会被赋值给elem变量。这个<code>WebElement</code>对象可以用来执行其他的操作，比如点击、输入文本等等。如果元素没有被找到,该方法会抛出一个<code>TimeoutException</code>异常。</p> 
<p><code>ExpectedConditions</code>的其它方法（部分）：</p> 
<table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td><code>presenceOfAllElementsLocatedBy(By locator)</code></td><td>等待一组元素根据指定的定位器在页面 DOM 中出现。条件成立，当元素列表至少包含一个元素或元素列表为空时。</td></tr><tr><td><code>elementToBeClickable(By locator)</code></td><td>等待元素可以被单击，通常用于等待按钮或链接可点击。</td></tr><tr><td><code>visibilityOfElementLocated(By locator)</code></td><td>等待元素在页面上可见，通常用于等待元素可见后执行操作。</td></tr><tr><td><code>invisibilityOfElementLocated(By locator)</code></td><td>等待元素在页面上不可见，通常用于等待元素消失后执行操作。</td></tr><tr><td><code>textToBePresentInElement(By locator, String text)</code></td><td>等待特定文本出现在元素中。</td></tr><tr><td><code>titleIs(String title)</code></td><td>等待页面标题与给定的标题完全匹配。</td></tr><tr><td><code>titleContains(String partialTitle)</code></td><td>等待页面标题包含给定的部分标题。</td></tr><tr><td><code>alertIsPresent()</code></td><td>等待警告框出现。</td></tr><tr><td><code>frameToBeAvailableAndSwitchToIt(By frameLocator)</code></td><td>等待并切换到指定的 iframe。</td></tr></tbody></table> 
<p>回到案例：</p> 
<pre><code class="hljs">public static void main(String[] args){
    ChromeOptions options = new ChromeOptions();
    //允许任何来源的远程连接，这样可以避免一些跨域问题。
    options.addArguments("--remote-allow-origins=*");
    WebDriver webDriver = new ChromeDriver(options);
    webDriver.get("https://baidu.com");
    // 初始化显式等待条件
    WebDriverWait wait = new WebDriverWait(webDriver, 5, 1);
    //css 选择器，选择搜索框
    WebElement input = webDriver.findElement(By.cssSelector("#kw"));
    //输入软件测试
    input.sendKeys("软件测试");
    //点击搜索按钮
    webDriver.findElement(By.cssSelector("#su")).click();
    //校验
    //1.找到搜索结果
    List&lt;WebElement&gt; aEms = wait.until(ExpectedConditions.presenceOfAllElementsLocatedBy(By.cssSelector("a em")));
    System.out.println(aEms.size());
}
</code></pre> 
<h4>（五）浏览器的操作</h4> 
<h5>1.浏览器启动的窗口大小</h5> 
<ul><li>webdriver.manage().window().maximize()；窗口最大化</li><li>webdriver.manage().window().setSize(new Dimension(480, 800))；设置窗口宽高</li></ul> 
<h5>2.浏览器前进后退刷新</h5> 
<ul><li>webdriver.navigate().back(); 后退</li><li>webdriver.navigate().forward(); 前进</li><li>webdriver.navigate().refresh(); 刷新</li></ul> 
<h5>3.关闭浏览器</h5> 
<ul><li>webdriver.quit() 关闭整个浏览器</li><li>webdriver.close() 关闭当前页面</li></ul> 
<h4>（六）使用 JS 代码</h4> 
<p>Selenium 提供了 API 来执行 JS 代码。</p> 
<pre><code class="hljs">JavascriptExecutor js = (JavascriptExecutor) webDriver;
js.executeScript("js代码");
</code></pre> 
<pre><code class="hljs">    public static void main(String[] args) throws InterruptedException {
        ChromeOptions options = new ChromeOptions();
        options.addArguments("--remote-allow-origins=*");
        WebDriver webDriver = new ChromeDriver(options);
        //窗口最大化
        webDriver.manage().window().maximize();
        //隐式等待
        webDriver.manage().timeouts().implicitlyWait(1, TimeUnit.SECONDS);
        //打开百度
        webDriver.get("https://baidu.com");
        //执行 js 代码
        JavascriptExecutor js = (JavascriptExecutor) webDriver;
        js.executeScript("alert('你好')");
    }
</code></pre> 
<p><img alt="" height="408" src="https://images2.imgbox.com/d6/d4/2G6ZfOwf_o.png" width="831"></p> 
<ul><li>滚动条：</li></ul> 
<pre><code class="hljs">JavascriptExecutor js = (JavascriptExecutor) webDriver;
js.executeScript("document.documentElement.scrollTop= x ");//x 表示文档顶部距离视口顶部的距离
//方式2：
//x 参数表示水平的左间距；
//y 参数表示垂直的上边距。
js.executeScript("window.scrollTo(x,y);");
</code></pre> 
<h4>（七）模拟键盘操作</h4> 
<p>sendKeys()方法也可以模拟键盘操作，例如 <code>sendKeys(Keys.CONTROL, 'a')</code> 表示按下 Ctrl+A 组合键。</p> 
<table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td><code>Keys.ARROW_DOWN</code></td><td>按下向下箭头键。</td></tr><tr><td><code>Keys.ARROW_UP</code></td><td>按下向上箭头键。</td></tr><tr><td><code>Keys.ARROW_LEFT</code></td><td>按下向左箭头键。</td></tr><tr><td><code>Keys.ARROW_RIGHT</code></td><td>按下向右箭头键。</td></tr><tr><td><code>Keys.ENTER</code></td><td>按下回车键。</td></tr><tr><td><code>Keys.RETURN</code></td><td>按下回车键（与 <code>ENTER</code> 类似）。</td></tr><tr><td><code>Keys.TAB</code></td><td>按下制表键。</td></tr><tr><td><code>Keys.ESCAPE</code></td><td>按下 ESC 键。</td></tr><tr><td><code>Keys.SPACE</code></td><td>按下空格键。</td></tr><tr><td><code>Keys.BACK_SPACE</code></td><td>按下退格键。</td></tr><tr><td><code>Keys.DELETE</code></td><td>按下删除键。</td></tr><tr><td><code>Keys.HOME</code></td><td>按下 Home 键。</td></tr><tr><td><code>Keys.END</code></td><td>按下 End 键。</td></tr><tr><td><code>Keys.PAGE_UP</code></td><td>按下 Page Up 键。</td></tr><tr><td><code>Keys.PAGE_DOWN</code></td><td>按下 Page Down 键。</td></tr><tr><td><code>Keys.CONTROL</code></td><td>按下 Ctrl 键。</td></tr><tr><td><code>Keys.SHIFT</code></td><td>按下 Shift 键。</td></tr><tr><td><code>Keys.ALT</code></td><td>按下 Alt 键。</td></tr><tr><td><code>Keys.F1</code>, <code>Keys.F2</code>, ... <code>Keys.F12</code></td><td>按下 F1 到 F12 键。</td></tr><tr><td><code>sendKeys(CharSequence...keysToSend)</code></td><td>模拟按下多个键的组合，例如 <code>sendKeys(Keys.CONTROL, "a")</code> 表示按下 Ctrl+A 组合键。</td></tr><tr><td><code>Keys.NULL</code></td><td>表示空键，通常用于清除已有的键盘操作。</td></tr></tbody></table> 
<h4>（八）模拟鼠标操作</h4> 
<p>Actions类可以帮助我们实现鼠标操作，Actions类的方法是用来创建一系列的操作，但是不会立即执行，而是存放在一个队列中。当调用perform()方法时，队列中的操作才会按顺序执行。</p> 
<table><thead><tr><th>方法</th><th>说明</th></tr></thead><tbody><tr><td>click</td><td>在当前鼠标位置点击</td></tr><tr><td>clickAndHold</td><td>在当前鼠标位置按住左键不放</td></tr><tr><td>contextClick</td><td>在当前鼠标位置右键点击</td></tr><tr><td>doubleClick</td><td>在当前鼠标位置双击</td></tr><tr><td>dragAndDrop</td><td>将一个元素拖拽到另一个元素上</td></tr><tr><td>keyDown</td><td>按下一个修饰键（如Ctrl, Shift, Alt等）</td></tr><tr><td>keyUp</td><td>释放一个修饰键（如Ctrl, Shift, Alt等）</td></tr><tr><td>moveToElement</td><td>将鼠标移动到一个元素的中心点上</td></tr><tr><td>pause</td><td>在两个操作之间暂停一段时间</td></tr><tr><td>release</td><td>释放当前鼠标位置的左键或右键</td></tr><tr><td>sendKeys</td><td>向当前焦点元素或活动元素发送一系列按键</td></tr></tbody></table> 
<pre><code class="hljs">// 百度首页“设置”悬停下拉菜单
WebDriver driver = new ChromeDriver();
driver.get("https://www.baidu.com/");
WebElement search_setting = driver.findElement(By.id("s-usersetting-top"));
Actions action = new Actions(driver);
action.moveToElement(search_setting).perform();

// 鼠标拖拽动作，将 source 元素拖放到 target 元素的位置
WebElement source = driver.findElement(By.name("element"));
WebElement target = driver.findElement(By.name("element"));
action.dragAndDrop(source,target).perform();
</code></pre> 
<h4>（九）多层框架定位</h4> 
<p>frame 是一个 HTML 元素，它定义了一个特定区域，另一个 HTML 文档可以在里面展示。比如：</p> 
<pre><code class="hljs">&lt;html&gt;
    &lt;frameset cols="25%,50%,25%"&gt;
      &lt;frame src="frame_a.htm" /&gt;
      &lt;frame src="frame_b.htm" /&gt;
      &lt;frame src="frame_c.htm" /&gt;
    &lt;/frameset&gt;
&lt;/html&gt;
</code></pre> 
<p>一个页面里面嵌了三个页面，但是selenium定位的时候默认只能定位到最外面一层的页面，如果想要切换页面（访问下层页面）可以使用如下API：</p> 
<ul><li>Frame标签包含 frameset、frame、iframe 三种。</li><li>Frameset 和普通的标签一样，不会影响正常的定位，可以使用 index、id、name 等任意种方式定位。</li><li>而 frame 与 iframe 对 selenium 定位而言是一样的。selenium 有一组方法对 frame 进行操作。</li></ul> 
<pre><code class="hljs">webdriver.switchTo().frame(x);//切换到 id 为 x 的fram下
//后面可以定位到该 frame 中的元素
webdriver.findElement(By.id("id"));
……
</code></pre> 
<pre><code class="hljs">//如果frame没有标签，可以使用索引来定位
webdriver.switchTo().frame(index);//索引从 1 开始。webdriver.switchTo().frame(1)表示切换到该页面下的第一个frame。
</code></pre> 
<h4>（十）下拉框处理</h4> 
<p>有如下的页面：</p> 
<pre><code class="hljs">&lt;html&gt;
&lt;body&gt;
    &lt;select id="ShippingMethod" onchange="updateShipping(options[selectedIndex]);" name="ShippingMethod"&gt;
        &lt;option value="12.51"&gt;UPS Next Day Air ==&gt; $12.51&lt;/option&gt;
        &lt;option value="11.61"&gt;UPS Next Day Air Saver ==&gt; $11.61&lt;/option&gt;
        &lt;option value="10.69"&gt;UPS 3 Day Select ==&gt; $10.69&lt;/option&gt;
        &lt;option value="9.03"&gt;UPS 2nd Day Air ==&gt; $9.03&lt;/option&gt;
        &lt;option value="8.34"&gt;UPS Ground ==&gt; $8.34&lt;/option&gt;
        &lt;option value="9.25"&gt;USPS Priority Mail Insured ==&gt; $9.25&lt;/option&gt;
        &lt;option value="7.45"&gt;USPS Priority Mail ==&gt; $7.45&lt;/option&gt;
        &lt;option value="3.20" selected=""&gt;USPS First Class ==&gt; $3.20&lt;/option&gt;
    &lt;/select&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
<pre><code class="hljs">// 定位 &lt;select&gt; 标签下拉框
WebElement selectElem = webDriver.findElement(By.cssSelector("#ShippingMethod"));
// Select 类用于定位 select 标签
Select select = new Select(selectElem);
//方式1：通过下标选择：从 1 开始计数
select.selectByIndex(1);
//方式2：通过 value 属性的值选择
select.selectByValue("11.61");
</code></pre> 
<h4>（十一）弹窗处理</h4> 
<p>在 <code>WebDriver</code> 中处理 <code>alert</code>、<code>confirm</code> 以及 <code>prompt</code> 时，先用<code>switchTo()</code> 方法定位到弹窗，然后使用一些方法进行操作。</p> 
<pre><code class="hljs">//假设点击后弹出弹窗
webDriver.findElement(By.cssSelector("button")).click();
//切换到弹窗上
Alert alert = webDriver.switchTo().alert();
//弹窗取消
alert.dismiss();
//弹窗接受
alert.accept();
//输入数据
alert.sendKeys("数据");
//获取弹窗里的文字
alert.getText();
</code></pre> 
<p><strong>（十二）上传文件</strong></p> 
<p>上传文件也是用 <code>sendKeys</code>() 方法。有如下页面：</p> 
<pre><code class="hljs">&lt;html&gt;
&lt;head&gt;
    &lt;meta http-equiv="content-type" content="text/html;charset=utf-8" /&gt;
    &lt;title&gt;upload_file&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class="row-fluid"&gt;
        &lt;div class="span6 well"&gt;
            &lt;h3&gt;upload_file&lt;/h3&gt;
            &lt;input type="file" name="file" /&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
<pre><code class="hljs">//定位上传按钮，然后上传文件
webDriver.findElement(By.cssSelector("input")).sendKeys("D:\\text.txt");
</code></pre> 
<h4>（十三）浏览器窗口切换</h4> 
<p>如果想要操作其它页面，需要先跳到其它页面:</p> 
<pre><code class="hljs">webDriver.getWindowHandle()：获得当前浏览器窗口的句柄。
webDriver.getWindowHandles()：返回所有浏览器窗口的句柄。
webDriver.switchTo().window(handle)：用于切换到相应的浏览器窗口。
</code></pre> 
<pre><code class="hljs">    private static void main(String[] args) throws InterruptedException {
        WebDriver webDriver = new ChromeDriver();
        webDriver.get("https://www.baidu.com");
        //等待时间
        webDriver.manage().timeouts().implicitlyWait(5,TimeUnit.SECONDS);
        //放大窗口，让登录按钮显示出来
        webDriver.manage().window().maximize();
        //获取登录按钮，并点击
        webDriver.findElement(By.cssSelector("#s-top-loginbtn")).click();
        //点击“立即注册”，打开注册页面
        webDriver.findElement(By.cssSelector("#TANGRAM__PSP_11__regLink")).click();
        //获取当前页面的句柄，此时是首页
        String handle = webDriver.getWindowHandle();
        //获取所有的页面的句柄（这时一共两个句柄）
        Set&lt;String&gt; handles = webDriver.getWindowHandles();
        //for 循环遍历句柄
        for(String tmp : handles){
            //比较是不是注册页面
            if(!handle.equals(tmp)){
                //切换到注册页面
                webDriver.switchTo().window(tmp);
                //输入用户名
                webDriver.findElement(By.cssSelector("#TANGRAM__PSP_4__userName")).sendKeys("会飞的喵喵123123123");
                //输入手机号
                webDriver.findElement(By.cssSelector("#TANGRAM__PSP_4__phone")).sendKeys("13220333333");
                //输入密码
                webDriver.findElement(By.cssSelector("#TANGRAM__PSP_4__password")).sendKeys("123456");
                //睡眠3秒
                Thread.sleep(3000);
                //关闭当前页面
                webDriver.close();
            }
        }
    }
</code></pre> 
<p><img alt="" height="444" src="https://images2.imgbox.com/7c/f4/avRhrILA_o.png" width="829"></p> 
<h4>（十四）获取窗口截图</h4> 
<p>添加依赖：添加这个依赖是为了使用<code>FileUtils</code>类，它能方便操作文件</p> 
<pre><code class="hljs">&lt;!-- https://mvnrepository.com/artifact/commons-io/commons-io --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;commons-io&lt;/groupId&gt;
    &lt;artifactId&gt;commons-io&lt;/artifactId&gt;
    &lt;version&gt;2.14.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre> 
<pre><code class="hljs">//截图
File srcFile = ((TakesScreenshot)webDriver).getScreenshotAs(OutputType.FILE);
//将截图保存到 D 盘
FileUtils.copyFile(srcFile,new File("D:\\test.png"));
</code></pre> 
<pre><code class="hljs">    private static void main(String[] args) throws IOException, InterruptedException {
        WebDriver webDriver = new ChromeDriver();
        webDriver.get("https://www.baidu.com");
        //等待时间
        webDriver.manage().timeouts().implicitlyWait(5,TimeUnit.SECONDS);
        //放大窗口，让登录按钮显示出来
        webDriver.manage().window().maximize();
        //获取登录按钮，并点击
        webDriver.findElement(By.cssSelector("#s-top-loginbtn")).click();
        Thread.sleep(1000);
        //截图
        File srcFile = ((TakesScreenshot)webDriver).getScreenshotAs(OutputType.FILE);
        //将截图保存到 D 盘
        FileUtils.copyFile(srcFile,new File("D:\\test.png"));
    }
</code></pre> 
<p>行动吧，在路上总比一直观望的要好，未来的你肯定会感谢现在拼搏的自己！如果想学习提升找不到资料，没人答疑解惑时，<strong>请及时加入群： 759968159</strong>，里面有各种测试开发资料和技术可以一起交流哦。</p> 
<p><strong>最后：</strong> 下方这份完整的软件测试视频教程已经整理上传完成，需要的朋友们可以自行领取<span style="color:#fe2c24;"><strong><code>【保证100%免费】</code></strong></span></p> 
<p class="img-center"><img alt="" height="754" src="https://images2.imgbox.com/17/01/KKohz6Wh_o.png" width="732"></p> 
<p><strong>软件测试面试文档</strong></p> 
<p>我们学习必然是为了找到高薪的工作，下面这些面试题是来自阿里、腾讯、字节等一线互联网大厂最新的面试资料，并且有字节大佬给出了权威的解答，刷完这一套面试资料相信大家都能找到满意的工作。<img alt="在这里插入图片描述" src="https://images2.imgbox.com/59/95/AVakXe4Z_o.png"><br><img alt="在这里插入图片描述" src="https://images2.imgbox.com/67/fa/QCNbNDF6_o.png"></p> 
<p class="img-center"><img alt="在这里插入图片描述" src="https://images2.imgbox.com/44/67/BC56MFub_o.png"></p> 
<p><img alt="" src="https://images2.imgbox.com/44/65/nkSfluMf_o.gif"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ca9ae456d4a9d61b8b87c93b3f473d09/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">RabbitMQ（三）：AMQP协议</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1c3353376a40d46b200c47bcf87ae999/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">史上最全的Python兼职接单挣钱教程，十分详细（附基础教程）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>