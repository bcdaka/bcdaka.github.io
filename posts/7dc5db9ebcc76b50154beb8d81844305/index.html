<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>webpack 打包原理及流程解析，超详细！ - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/7dc5db9ebcc76b50154beb8d81844305/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="webpack 打包原理及流程解析，超详细！">
  <meta property="og:description" content="webpack 打包原理及流程解析 1. 什么是webpack?2. 关键术语解析3. webpack核心概念4. webpack 构建流程5. webpack应用案例6. 打包分析 1. 什么是webpack? 友情提示：
a.前面会稍微有些枯燥，文字居多（建议还是过一遍），后面就劲爆了！！！
b.本文干货满满，非常详细，整理资料到发布文章耗时5个小时&#43;，请大家耐心看
本质上,webpack 是一个现代 JavaScript 应用程序的静态模块打包器。当 webpack 处理应用程序时,它会递归地构建一个依赖关系图，其中包含应用程序需要的每个模块,然后将所有这些模块打包成一个或多个 bundle。webpack 就像一条生产线,要经过一系列处理流程后才能将源文件转换成输出结果。 这条生产线上的每个处理流程的职责都是单一的,多个流程之间有存在依赖关系,只有完成当前处理后才能交给下一个流程去处理。插件就像是一个插入到生产线中的一个功能,在特定的时机对生产线上的资源做处理。webpack 通过 Tapable 来组织这条复杂的生产线。 webpack 在运行过程中会广播事件,插件只需要监听它所关心的事件,就能加入到这条生产线中,去改变生产线的运作。 webpack 的事件流机制保证了插件的有序性,使得整个系统扩展性很好。
官方的说法看不太懂的，🙈🙈可以看这个：在目前的项目中，我们会有很多依赖包，webpack负责将浏览器不能识别的文件类型、语法等转化为可识别的前端三剑客（html，css，js），并在这个过程中充当组织者与优化者的角色。 2. 关键术语解析 2.1 bundle
Bundle（捆绑包）是指将所有相关的模块和资源打包在一起形成的单个文件。它是应用程序的最终输出，可以在浏览器中加载和执行。捆绑包通常由Webpack根据入口点（entry）和它们的依赖关系自动创建。当你运行Webpack构建时，它会根据配置将所有模块和资源打包成一个或多个捆绑包。 2.2 Chunk
Chunk（代码块）是Webpack在打包过程中生成的中间文件，它代表着一个模块的集合。
Webpack 根据代码的拓扑结构和配置将模块组织成不同的代码块。每个代码块可以是一个独立的文件，也可以与其他代码块组合成一个捆绑包。
Webpack使用代码分割（code splitting）技术将应用程序代码拆分成更小的代码块，以便在需要时进行按需加载。这有助于减小初始加载的文件大小，提高应用程序的性能。
在Webpack中，捆绑包和代码块之间存在一对多的关系。一个捆绑包可以包含多个代码块，而一个代码块也可以属于多个不同的捆绑包。这取决于Webpack配置中的拆分点（split points）和代码块的依赖关系。
总结起来，bundle 是Webpack打包过程的最终输出文件，而chunk是Webpack在打包过程中生成的中间文件，用于组织和按需加载模块。
3. webpack核心概念 3.1 Entry
入口起点(entry point)指示 webpack 应该使用哪个模块,来作为构建其内部依赖图的开始。进入入口起点后,webpack 会找出有哪些模块和库是入口起点（直接和间接）依赖的。每个依赖项随即被处理,最后输出到称之为 bundles 的文件中。 3.2 Output
output 属性告诉 webpack 在哪里输出它所创建的 bundles,以及如何命名这些文件,默认值为 ./dist。基本上,整个应用程序结构,都会被编译到你指定的输出路径的文件夹中。 3.3 Module">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-07-21T15:35:06+08:00">
    <meta property="article:modified_time" content="2023-07-21T15:35:06+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">webpack 打包原理及流程解析，超详细！</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>webpack 打包原理及流程解析</h4> 
 <ul><li><ul><li><a href="#1_webpack_2" rel="nofollow">1. 什么是webpack?</a></li><li><a href="#2__16" rel="nofollow">2. 关键术语解析</a></li><li><a href="#3_webpack_31" rel="nofollow">3. webpack核心概念</a></li><li><a href="#4_webpack__52" rel="nofollow">4. webpack 构建流程</a></li><li><a href="#5_webpack_65" rel="nofollow">5. webpack应用案例</a></li><li><a href="#6__132" rel="nofollow">6. 打包分析</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="1_webpack_2"></a>1. 什么是webpack?</h3> 
<blockquote> 
 <p><strong>友情提示：<br> a.前面会稍微有些枯燥，文字居多（建议还是过一遍），后面就劲爆了！！！</strong><br> <strong>b.本文干货满满，非常详细，整理资料到发布文章耗时5个小时+，请大家耐心看</strong></p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/23/7f/CZuFY8Dv_o.png" alt="在这里插入图片描述"></p> 
<ul><li>本质上,webpack 是一个现代 JavaScript 应用程序的<strong>静态模块打包器</strong>。当 webpack 处理应用程序时,它会递归地构建一个依赖关系图，其中包含应用程序需要的每个模块,然后将所有这些模块打包成一个或多个 bundle。</li><li>webpack 就像一条生产线,要经过一系列处理流程后才能<strong>将源文件转换成输出结果</strong>。 这条生产线上的每个处理流程的职责都是单一的,多个流程之间有存在依赖关系,只有完成当前处理后才能交给下一个流程去处理。</li><li>插件就像是一个插入到生产线中的一个功能,在特定的时机对生产线上的资源做处理。</li><li>webpack 通过 Tapable 来组织这条复杂的生产线。 webpack 在运行过程中会广播事件,插件只需要监听它所关心的事件,就能加入到这条生产线中,去改变生产线的运作。 webpack 的事件流机制保证了插件的有序性,使得整个系统扩展性很好。<br> <img src="https://images2.imgbox.com/d9/44/cqjALzOX_o.png" alt="在这里插入图片描述"></li><li>官方的说法看不太懂的，🙈🙈可以看这个：</li><li><strong>在目前的项目中，我们会有很多依赖包，webpack负责将浏览器不能识别的文件类型、语法等转化为可识别的前端三剑客（html，css，js），并在这个过程中充当组织者与优化者的角色。</strong></li></ul> 
<h3><a id="2__16"></a>2. 关键术语解析</h3> 
<blockquote> 
 <p><strong>2.1 bundle</strong></p> 
</blockquote> 
<ul><li>Bundle（捆绑包）是指将所有相关的模块和资源打包在一起形成的单个文件。<strong>它是应用程序的最终输出，可以在浏览器中加载和执行。</strong></li><li>捆绑包通常由Webpack根据入口点（entry）和它们的依赖关系自动创建。当你运行Webpack构建时，它会根据配置<strong>将所有模块和资源打包成一个或多个捆绑包。</strong></li></ul> 
<blockquote> 
 <p><strong>2.2 Chunk</strong></p> 
</blockquote> 
<ul><li> <p>Chunk（代码块）是Webpack在打包过程中生成的中间文件，它代表着一个<strong>模块的集合</strong>。</p> </li><li> <p>Webpack 根据代码的拓扑结构和配置将模块组织成不同的代码块。每个代码块可以是一个独立的文件，也可以与其他代码块组合成一个捆绑包。</p> </li><li> <p>Webpack使用代码分割（code splitting）技术将应用程序代码拆分成更小的代码块，以便在需要时进行按需加载。<strong>这有助于减小初始加载的文件大小，提高应用程序的性能。</strong></p> </li><li> <p>在Webpack中，捆绑包和代码块之间存在一对多的关系。一个捆绑包可以包含多个代码块，而一个代码块也可以属于多个不同的捆绑包。这取决于Webpack配置中的拆分点（split points）和代码块的依赖关系。</p> </li><li> <p>总结起来，<strong>bundle 是Webpack打包过程的最终输出文件，而chunk是Webpack在打包过程中生成的中间文件，用于组织和按需加载模块</strong>。</p> </li></ul> 
<h3><a id="3_webpack_31"></a>3. webpack核心概念</h3> 
<blockquote> 
 <p><strong>3.1 Entry</strong></p> 
</blockquote> 
<ul><li>入口起点(entry point)指示 webpack 应该使用哪个模块,来作为构建其内部依赖图的开始。</li><li>进入入口起点后,webpack 会找出有哪些模块和库是入口起点（直接和间接）依赖的。</li><li>每个依赖项随即被处理,最后输出到称之为 bundles 的文件中。</li></ul> 
<blockquote> 
 <p><strong>3.2 Output</strong></p> 
</blockquote> 
<ul><li>output 属性告诉 webpack 在哪里输出它所创建的 bundles,以及如何命名这些文件,默认值为 ./dist。</li><li>基本上,整个应用程序结构,都会被编译到你指定的输出路径的文件夹中。</li></ul> 
<blockquote> 
 <p><strong>3.3 Module</strong></p> 
</blockquote> 
<ul><li>模块,在 Webpack 里一切皆模块,一个模块对应着一个文件。Webpack 会从配置的 Entry 开始递归找出所有依赖的模块。</li></ul> 
<blockquote> 
 <p><strong>3.4 Chunk</strong></p> 
</blockquote> 
<ul><li>代码块,一个 Chunk 由多个模块组合而成,用于代码合并与分割。</li></ul> 
<blockquote> 
 <p><strong>3.5 Loader</strong></p> 
</blockquote> 
<ul><li>loader 让 webpack 能够去处理那些非 JavaScript 文件（webpack 自身只理解 JavaScript）。</li><li>loader 可以将所有类型的文件转换为 webpack 能够处理的有效模块,然后你就可以利用 webpack 的打包能力,对它们进行处理。</li><li>本质上,webpack loader 将所有类型的文件,转换为应用程序的依赖图（和最终的 bundle）可以直接引用的模块。</li></ul> 
<blockquote> 
 <p><strong>3.6 Plugin</strong></p> 
</blockquote> 
<ul><li>loader 被用于转换某些类型的模块,而插件则可以用于执行范围更广的任务。</li><li>插件的范围包括,从打包优化和压缩,一直到重新定义环境中的变量。插件接口功能极其强大,可以用来处理各种各样的任务。</li></ul> 
<h3><a id="4_webpack__52"></a>4. webpack 构建流程</h3> 
<blockquote> 
 <p><strong>Webpack 的运行流程是一个串行的过程,从启动到结束会依次执行以下流程</strong><br> <img src="https://images2.imgbox.com/fa/3a/MPvGCozn_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<ul><li>初始化参数：从配置文件和 Shell 语句中读取与合并参数,得出最终的参数。</li><li>开始编译：用上一步得到的参数初始化 Compiler 对象,加载所有配置的插件,执行对象的 run 方法开始执行编译。</li><li>确定入口：根据配置中的 entry 找出所有的入口文件。</li><li>编译模块：从入口文件出发,调用所有配置的 Loader 对模块进行翻译,再找出该模块依赖的模块,再递归本步骤直到所有入口依赖的文件都经过了本步骤的处理。</li><li>完成模块编译：在经过第 4 步使用 Loader 翻译完所有模块后,得到了每个模块被翻译后的最终内容以及它们之间的依赖关系。</li><li>输出资源：根据入口和模块之间的依赖关系,组装成一个个包含多个模块的 Chunk,再把每个 Chunk 转换成一个单独的文件加入到输出列表,这步是可以修改输出内容的最后机会。</li><li>输出完成：在确定好输出内容后,根据配置确定输出的路径和文件名,把文件内容写入到文件系统</li><li><strong>在以上过程中,Webpack 会在特定的时间点广播出特定的事件,插件在监听到感兴趣的事件后会执行特定的逻辑,并且插件可以调用 Webpack 提供的 API 改变 Webpack 的运行结果。</strong></li></ul> 
<h3><a id="5_webpack_65"></a>5. webpack应用案例</h3> 
<blockquote> 
 <p><strong>5.1 前置条件</strong></p> 
</blockquote> 
<ul><li>首先检查node版本，建议使用 16.16.x 及以上版本（因为玩的是webpack 4.0+ 的版本）</li><li>全局安装 =&gt; npm install webpack -g</li><li>当然，也可以带版本号，如 webpack@4.4.0</li><li>这里使用的是最新的（不带版本号默认安装最新版本）</li><li>当然，也可以局部安装（全局可能会影响你的其它项目），5.2 步骤将会做的是局部安装</li></ul> 
<blockquote> 
 <p><strong>5.2 初始化项目</strong></p> 
</blockquote> 
<ul><li>整个空文件夹，执行npm init，然后一路回车，把回车摁烂！！！</li><li>当然你也可以搞一些个性化配置，文件名，版本，描述，入口文件等等。<br> <img src="https://images2.imgbox.com/49/3a/j2Qfs9dA_o.png" alt="在这里插入图片描述"></li><li>局部安装webpack：npm i webpack webpack-cli -D</li><li>然后你会看到 package.json 这个鸟样：<br> <img src="https://images2.imgbox.com/08/ed/ZmsIYwWF_o.png" alt="在这里插入图片描述"></li></ul> 
<blockquote> 
 <p><strong>5.3 新建 webpack.config.js 配置文件（根目录）</strong></p> 
</blockquote> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>    
    <span class="token comment">// 入口</span>
    <span class="token literal-property property">entry</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src/index.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    
    <span class="token comment">// 出口</span>
    <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>        
        <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        
        <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>        
        <span class="token literal-property property">publicPath</span><span class="token operator">:</span> <span class="token string">'./'</span>    
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<ul><li>publicPath:指定基础路径，开发环境一般是项目的根路径，上线之后一般是CDN的路径。</li><li>__dirname:表示项目所在目录的根路径。</li></ul> 
<blockquote> 
 <p><strong>5.4 src/index.js 与 test.js</strong></p> 
</blockquote> 
<ul><li>新建入口文件src/index.js，随便整点代码：</li></ul> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> test <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./test'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">12</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token number">12</span>
<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  
    <span class="token keyword">return</span> x <span class="token operator">+</span> y
<span class="token punctuation">}</span>
<span class="token keyword">const</span> c <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
<span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>src/test.js，非主入口文件用来测试打包的</li></ul> 
<pre><code class="prism language-javascript"><span class="token keyword">function</span>  <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> test<span class="token punctuation">;</span>

</code></pre> 
<blockquote> 
 <p><strong>5.5 测试打包</strong></p> 
</blockquote> 
<ul><li>package.json 下的 scripts 中添加打包命令：</li></ul> 
<pre><code class="prism language-javascript"><span class="token string-property property">"build"</span><span class="token operator">:</span> <span class="token string">"webpack --mode development"</span>
</code></pre> 
<ul><li>这里说明一下，不加 <em>–mode development</em>，默认打包是生产环境，打包出来的代码会默认压缩，看不得，辣眼睛</li><li>运行 npm run build，进行打包。</li><li>如果不出意外的话，控制台就成功的打包了两个js文件，同时目录中会生成 dist 文件夹（出意外的话看下上面的步骤）<br> <img src="https://images2.imgbox.com/11/14/Dfmq7mZF_o.png" alt="在这里插入图片描述"></li></ul> 
<h3><a id="6__132"></a>6. 打包分析</h3> 
<ul><li>刚刚的步骤是一个非常简单的打包示例，打包后你会发现两个js文件变成了一个</li><li>试运行一下，也是没问题的，如下<br> <img src="https://images2.imgbox.com/18/82/6SoB0cRp_o.png" alt="在这里插入图片描述"></li></ul> 
<blockquote> 
 <p><strong>6.1 源码分析</strong></p> 
</blockquote> 
<ul><li>源码实际上很好懂，代码量也不多，不妨来解读一下：</li></ul> 
<pre><code class="prism language-javascript"><span class="token comment">/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */</span>
<span class="token comment">/******/</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// webpackBootstrap</span>
<span class="token comment">/******/</span> 	<span class="token keyword">var</span> __webpack_modules__ <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>

<span class="token comment">/***/</span> <span class="token string">"./src/index.js"</span><span class="token operator">:</span>
<span class="token comment">/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/</span>
<span class="token comment">/***/</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">__unused_webpack_module<span class="token punctuation">,</span> __unused_webpack_exports<span class="token punctuation">,</span> __webpack_require__</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>

<span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"const test = __webpack_require__(/*! ./test */ \"./src/test.js\");\r\nconst a = 12\r\nconst b = 12\r\nfunction add(x, y) {  \r\n    return x + y\r\n}\r\nconst c = add(a,b)\r\nconsole.log(c)\r\ntest();\n\n//# sourceURL=webpack://blog/./src/index.js?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/***/</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token comment">/***/</span> <span class="token string">"./src/test.js"</span><span class="token operator">:</span>
<span class="token comment">/*!*********************!*\
  !*** ./src/test.js ***!
  \*********************/</span>
<span class="token comment">/***/</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">module</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>

<span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"function  test(){\r\n    console.log(2);\r\n}\r\n\r\nmodule.exports = test;\r\n\n\n//# sourceURL=webpack://blog/./src/test.js?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/***/</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">/******/</span> 	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/************************************************************************/</span>
<span class="token comment">/******/</span> 	<span class="token comment">// The module cache</span>
<span class="token comment">/******/</span> 	<span class="token keyword">var</span> __webpack_module_cache__ <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">/******/</span> 	
<span class="token comment">/******/</span> 	<span class="token comment">// The require function</span>
<span class="token comment">/******/</span> 	<span class="token keyword">function</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token parameter">moduleId</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token comment">/******/</span> 		<span class="token comment">// Check if module is in cache</span>
<span class="token comment">/******/</span> 		<span class="token keyword">var</span> cachedModule <span class="token operator">=</span> __webpack_module_cache__<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">/******/</span> 		<span class="token keyword">if</span> <span class="token punctuation">(</span>cachedModule <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token comment">/******/</span> 			<span class="token keyword">return</span> cachedModule<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
<span class="token comment">/******/</span> 		<span class="token punctuation">}</span>
<span class="token comment">/******/</span> 		<span class="token comment">// Create a new module (and put it into the cache)</span>
<span class="token comment">/******/</span> 		<span class="token keyword">var</span> module <span class="token operator">=</span> __webpack_module_cache__<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
<span class="token comment">/******/</span> 			<span class="token comment">// no module.id needed</span>
<span class="token comment">/******/</span> 			<span class="token comment">// no module.loaded needed</span>
<span class="token comment">/******/</span> 			<span class="token literal-property property">exports</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token comment">/******/</span> 		<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">/******/</span> 	
<span class="token comment">/******/</span> 		<span class="token comment">// Execute the module function</span>
<span class="token comment">/******/</span> 		__webpack_modules__<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">(</span>module<span class="token punctuation">,</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">,</span> __webpack_require__<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/******/</span> 	
<span class="token comment">/******/</span> 		<span class="token comment">// Return the exports of the module</span>
<span class="token comment">/******/</span> 		<span class="token keyword">return</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
<span class="token comment">/******/</span> 	<span class="token punctuation">}</span>
<span class="token comment">/******/</span> 	
<span class="token comment">/************************************************************************/</span>
<span class="token comment">/******/</span> 	
<span class="token comment">/******/</span> 	<span class="token comment">// startup</span>
<span class="token comment">/******/</span> 	<span class="token comment">// Load entry module and return exports</span>
<span class="token comment">/******/</span> 	<span class="token comment">// This entry module can't be inlined because the eval devtool is used.</span>
<span class="token comment">/******/</span> 	<span class="token keyword">var</span> __webpack_exports__ <span class="token operator">=</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token string">"./src/index.js"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/******/</span> 	
<span class="token comment">/******/</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">;</span>
</code></pre> 
<ul><li>可以看到最简单的场景下 webpack 实现的模块加载系统非常简洁，仅仅只有60多行代码</li><li>打包后的代码其实是一个立即执行函数，在Webpack打包过程中，每个模块都会被转换为一个独立的函数，并通过__webpack_modules__对象进行注册和管理。这个对象以文件路径为 key，以文件内容为 value，它包含了所有打包后的模块。</li><li>当模块被引用或加载时，Webpack会使用__webpack_modules__来查找和执行相应的模块函数。通过使用__webpack_modules__，Webpack可以管理模块之间的依赖关系，并在需要时按需加载和执行模块。</li><li>接着定义了一个模块加载函数 webpack_require()它接收的参数是 moduleId，其实就是文件路径。</li><li>它的执行过程如下： 
  <ul><li>判断模块是否有缓存，如果有则返回缓存模块的 export 对象，即 module.exports。</li><li>新建一个模块 module，并放入缓存。</li><li>执行文件路径对应的模块函数。</li><li>执行完模块后，返回该模块的 exports 对象。</li></ul> </li><li>其中 module、module.exports 的作用和 CommonJS 中的 module、module.exports 的作用是一样的，而 webpack_require 相当于 CommonJS 中的 require。</li><li>在立即函数的最后，使用了 webpack_require() 加载入口模块。并传入了入口模块的路径 ./src/index.js。</li><li>我们再来分析一下入口模块的内容：</li></ul> 
<pre><code class="prism language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">__unused_webpack_module<span class="token punctuation">,</span> __unused_webpack_exports<span class="token punctuation">,</span> __webpack_require__</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
	<span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"const test = __webpack_require__(/*! ./test */ \"./src/test.js\");\r\nconst a = 12\r\nconst b = 12\r\nfunction add(x, y) {  \r\n    return x + y\r\n}\r\nconst c = add(a,b)\r\nconsole.log(c)\r\ntest();\n\n//# sourceURL=webpack://blog/./src/index.js?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>入口模块函数的参数正好是刚才所说的那三个参数（module、module.exports 、require），而 eval 函数的内容美化一下后和下面内容一样：</li></ul> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> test <span class="token operator">=</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token comment">/*! ./test */</span> <span class="token string">"./src/test.js"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<ul><li>将打包后的模块代码和原模块的代码进行对比，可以发现仅有一个地方发生了变化，那就是 require 变成了 webpack_require。</li><li>从刚才的分析可知，webpack_require() 加载模块后，会先执行模块对应的函数，然后返回该模块的 exports 对象。</li><li>而 test.js 的导出对象 module.exports 就是 test() 函数。所以入口模块能通过 webpack_require() 引入 test() 函数并执行</li><li>到目前为止可以发现 webpack 自定义的模块规范完美适配 CommonJS 规范。</li></ul> 
<blockquote> 
 <p><strong>1. 希望本文能对大家有所帮助，如有错误，敬请指出</strong></p> 
 <p><strong>2. 原创不易，还请各位客官动动发财的小手支持一波（关注、评论、点赞、收藏）</strong><br> <strong>3. 拜谢各位！后续将继续奉献优质好文</strong><br> <strong>4. 如果存在疑问，可以私信我(主页有V)</strong></p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/0b/d7/ZUXdNGsO_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2ec2af6d77055f64f1f580c0063a80a9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">mac系统占用100多G怎么清除 mac内存系统占用了好多怎么清理</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3a4e97ea8d535ba1fca23f24faf3257e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Mac苹果系统安装双系统Windows10 Windows11 BOOTCAMP</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>