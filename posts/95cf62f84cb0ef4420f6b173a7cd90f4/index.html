<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SwiftUI 6.0ï¼ˆiOS 18.0ï¼‰æ»šåŠ¨è§†å›¾æ–°å¢çš„æ»šåŠ¨é˜¶æ®µï¼ˆScroll Phaseï¼‰ç›‘å¬åŠŸèƒ½è¶£è°ˆ - ç¼–ç¨‹å¤§å’–</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/95cf62f84cb0ef4420f6b173a7cd90f4/">
  <meta property="og:site_name" content="ç¼–ç¨‹å¤§å’–">
  <meta property="og:title" content="SwiftUI 6.0ï¼ˆiOS 18.0ï¼‰æ»šåŠ¨è§†å›¾æ–°å¢çš„æ»šåŠ¨é˜¶æ®µï¼ˆScroll Phaseï¼‰ç›‘å¬åŠŸèƒ½è¶£è°ˆ">
  <meta property="og:description" content="ä½•æ›¾å‡ æ—¶ï¼Œåœ¨ SwiftUI å¼€å‘ä¸­çš„ç§ƒå¤´å°ç å†œä»¬è¿«åˆ‡éœ€è¦ä¸€ç§èƒ½å¤Ÿè¯»å–å½“å‰æ»šåŠ¨çŠ¶æ€çš„æ–¹æ³•ã€‚
åœ¨è¿‡å»ï¼Œä»–ä»¬å¾€å¾€éœ€è¦å€ŸåŠ©äº UIKit çš„ç¥ç§˜åŠ›é‡ã€‚ä¸è¿‡è¿™ä¸€åˆ‡åœ¨ SwiftUI 6.0 ä¸­å·²æˆâ€œæ²§æµ·æ¡‘ç”°â€ã€‚
åœ¨æœ¬ç¯‡åšæ–‡ä¸­ï¼Œæ‚¨å°†å­¦åˆ°å¦‚ä¸‹å†…å®¹ï¼š 1. ScrollView æ»šåŠ¨é˜¶æ®µç®€ä»‹2. æ™®åº¦ä¼—ç”Ÿçš„ SwiftUI 6.03. æ»šåŠ¨é˜¶æ®µæ›´æ”¹ä¸Šä¸‹æ–‡ï¼ˆScrollPhaseChangeContextï¼‰4. å¦‚ä½•ç›‘å¬åˆ—è¡¨ï¼ˆListï¼‰çš„æ»šåŠ¨é˜¶æ®µæ€»ç»“ ç›¸ä¿¡å­¦å®Œæœ¬è¯¾åï¼Œå°ä¼™ä¼´ä»¬åœ¨éœ€è¦ç›‘å¬æ»šåŠ¨è§†å›¾æ»šåŠ¨é˜¶æ®µçš„åº”ç”¨åœºæ™¯ä¸­å®šèƒ½å¾—å¿ƒåº”æ‰‹ã€æ¸¸åˆƒæœ‰ä½™ï¼
é‚£è¿˜ç­‰ä»€ä¹ˆå‘¢ï¼Ÿè®©æˆ‘ä»¬é©¬ä¸Šå¼€å§‹å§ï¼Letâ€˜s goï¼ï¼ï¼ğŸ˜ƒ
1. ScrollView æ»šåŠ¨é˜¶æ®µç®€ä»‹ æ‰€è°“æ»šåŠ¨é˜¶æ®µï¼ˆScroll Phaseï¼‰æ˜¯æŒ‡æ»šåŠ¨è§†å›¾åœ¨æ»šåŠ¨å‰ã€æ»šåŠ¨ä¸­ä»¥åŠæ»šåŠ¨åæ‰€å¤„çš„ä¸åŒé˜¶æ®µã€‚
æ—©åœ¨ macOS 10.9&#43; çš„ CoreGraphics ä¸­å°±æœ‰æ»šåŠ¨é˜¶æ®µçš„æ¦‚å¿µäº†ï¼š
å¦‚æœæˆ‘ä»¬èƒ½åŠæ—¶çš„è¯»å–å„ä¸ªæ»šåŠ¨é˜¶æ®µçš„å€¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®å®ƒä»¬ä¸ºæ»šåŠ¨è§†å›¾æä¾›æ›´åŠ â€œé“¶æåŒ–â€çš„å®šåˆ¶å’Œæ›´æµç•…æ»šåŠ¨é™„åŠ ä½“éªŒã€‚
åœ¨ SwiftUI 6.0 ä¹‹å‰ï¼Œæˆ‘ä»¬æ— æ³•ä½¿ç”¨è¡Œä¹‹æœ‰æ•ˆçš„æ–¹æ³•æ¥è¯»å–æ»šåŠ¨è§†å›¾å½“å‰æ‰€å¤„çš„æ»šåŠ¨é˜¶æ®µï¼Œåªæœ‰å§”èº«æ•‘åŠ©äº UIKit çš„ç§‰è½´æŒé’§ã€‚
ç„¶è€Œï¼Œè¿™ä¸€åˆ‡åœ¨ SwiftUI 6.0 ä¸­æœ‰äº†ç¿»å¤©è¦†åœ°çš„å˜åŒ–ï¼
2. æ™®åº¦ä¼—ç”Ÿçš„ SwiftUI 6.0 è‡ªä» SwiftUI 6.0ï¼ˆiOS 18.0ï¼‰å¼€å§‹ï¼Œâ€œé¡¿æ‚Ÿâ€çš„è‹¹æœç»ˆäºæä¾›æ»šåŠ¨é˜¶æ®µçš„ç›‘å¬åŠŸèƒ½äº†ã€‚
ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬æœ‰äº†æè¿°æ»šåŠ¨é˜¶æ®µçš„æ–°ç±»å‹ ScrollPhaseï¼š
å®ƒåŒ…å« 5 ä¸ªæšä¸¾å€¼åˆ†åˆ«å¯¹åº”äº 5 ç§æ»šåŠ¨é˜¶æ®µï¼š
@frozen public enum ScrollPhase : Equatable { case idle case tracking case interacting case decelerating case animating public var isScrolling: Bool { get } } è¿™äº›æ»šåŠ¨é˜¶æ®µçš„å«ä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼š">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-06T13:06:35+08:00">
    <meta property="article:modified_time" content="2024-07-06T13:06:35+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§å’–" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§å’–</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SwiftUI 6.0ï¼ˆiOS 18.0ï¼‰æ»šåŠ¨è§†å›¾æ–°å¢çš„æ»šåŠ¨é˜¶æ®µï¼ˆScroll Phaseï¼‰ç›‘å¬åŠŸèƒ½è¶£è°ˆ</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/9f/2a/TM2nZFYB_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>ä½•æ›¾å‡ æ—¶ï¼Œåœ¨ SwiftUI å¼€å‘ä¸­çš„ç§ƒå¤´å°ç å†œä»¬è¿«åˆ‡éœ€è¦ä¸€ç§èƒ½å¤Ÿè¯»å–å½“å‰æ»šåŠ¨çŠ¶æ€çš„æ–¹æ³•ã€‚</p> 
<p><img src="https://images2.imgbox.com/fc/a3/WTYjKOH6_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>åœ¨è¿‡å»ï¼Œä»–ä»¬å¾€å¾€éœ€è¦å€ŸåŠ©äº UIKit çš„ç¥ç§˜åŠ›é‡ã€‚ä¸è¿‡è¿™ä¸€åˆ‡åœ¨ SwiftUI 6.0 ä¸­å·²æˆâ€œæ²§æµ·æ¡‘ç”°â€ã€‚<br> </p> 
<div class="toc"> 
 <h4>åœ¨æœ¬ç¯‡åšæ–‡ä¸­ï¼Œæ‚¨å°†å­¦åˆ°å¦‚ä¸‹å†…å®¹ï¼š</h4> 
 <ul><li><a href="#1_ScrollView__15" rel="nofollow">1. ScrollView æ»šåŠ¨é˜¶æ®µç®€ä»‹</a></li><li><a href="#2__SwiftUI_60_29" rel="nofollow">2. æ™®åº¦ä¼—ç”Ÿçš„ SwiftUI 6.0</a></li><li><a href="#3_ScrollPhaseChangeContext_125" rel="nofollow">3. æ»šåŠ¨é˜¶æ®µæ›´æ”¹ä¸Šä¸‹æ–‡ï¼ˆScrollPhaseChangeContextï¼‰</a></li><li><a href="#4_List_164" rel="nofollow">4. å¦‚ä½•ç›‘å¬åˆ—è¡¨ï¼ˆListï¼‰çš„æ»šåŠ¨é˜¶æ®µ</a></li><li><a href="#_217" rel="nofollow">æ€»ç»“</a></li></ul> 
</div> 
<p></p> 
<p>ç›¸ä¿¡å­¦å®Œæœ¬è¯¾åï¼Œå°ä¼™ä¼´ä»¬åœ¨éœ€è¦ç›‘å¬æ»šåŠ¨è§†å›¾æ»šåŠ¨é˜¶æ®µçš„åº”ç”¨åœºæ™¯ä¸­å®šèƒ½å¾—å¿ƒåº”æ‰‹ã€æ¸¸åˆƒæœ‰ä½™ï¼</p> 
<p>é‚£è¿˜ç­‰ä»€ä¹ˆå‘¢ï¼Ÿè®©æˆ‘ä»¬é©¬ä¸Šå¼€å§‹å§ï¼Letâ€˜s goï¼ï¼ï¼ğŸ˜ƒ</p> 
<hr> 
<h2><a id="1_ScrollView__15"></a>1. ScrollView æ»šåŠ¨é˜¶æ®µç®€ä»‹</h2> 
<p>æ‰€è°“æ»šåŠ¨é˜¶æ®µï¼ˆScroll Phaseï¼‰æ˜¯æŒ‡æ»šåŠ¨è§†å›¾åœ¨æ»šåŠ¨å‰ã€æ»šåŠ¨ä¸­ä»¥åŠæ»šåŠ¨åæ‰€å¤„çš„ä¸åŒé˜¶æ®µã€‚</p> 
<p>æ—©åœ¨ macOS 10.9+ çš„ CoreGraphics ä¸­å°±æœ‰æ»šåŠ¨é˜¶æ®µçš„æ¦‚å¿µäº†ï¼š</p> 
<p><img src="https://images2.imgbox.com/7d/74/ADKqatwp_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> <img src="https://images2.imgbox.com/b8/be/r0n8MQBz_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>å¦‚æœæˆ‘ä»¬èƒ½åŠæ—¶çš„è¯»å–å„ä¸ªæ»šåŠ¨é˜¶æ®µçš„å€¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®å®ƒä»¬ä¸ºæ»šåŠ¨è§†å›¾æä¾›æ›´åŠ â€œé“¶æåŒ–â€çš„å®šåˆ¶å’Œæ›´æµç•…æ»šåŠ¨é™„åŠ ä½“éªŒã€‚</p> 
<p>åœ¨ SwiftUI 6.0 ä¹‹å‰ï¼Œæˆ‘ä»¬æ— æ³•ä½¿ç”¨è¡Œä¹‹æœ‰æ•ˆçš„æ–¹æ³•æ¥è¯»å–æ»šåŠ¨è§†å›¾å½“å‰æ‰€å¤„çš„æ»šåŠ¨é˜¶æ®µï¼Œåªæœ‰å§”èº«æ•‘åŠ©äº UIKit çš„ç§‰è½´æŒé’§ã€‚</p> 
<p>ç„¶è€Œï¼Œè¿™ä¸€åˆ‡åœ¨ SwiftUI 6.0 ä¸­æœ‰äº†ç¿»å¤©è¦†åœ°çš„å˜åŒ–ï¼</p> 
<h2><a id="2__SwiftUI_60_29"></a>2. æ™®åº¦ä¼—ç”Ÿçš„ SwiftUI 6.0</h2> 
<p>è‡ªä» SwiftUI 6.0ï¼ˆiOS 18.0ï¼‰å¼€å§‹ï¼Œâ€œé¡¿æ‚Ÿâ€çš„è‹¹æœç»ˆäºæä¾›æ»šåŠ¨é˜¶æ®µçš„ç›‘å¬åŠŸèƒ½äº†ã€‚</p> 
<p>ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬æœ‰äº†æè¿°æ»šåŠ¨é˜¶æ®µçš„æ–°ç±»å‹ ScrollPhaseï¼š</p> 
<p><img src="https://images2.imgbox.com/26/34/iWdboOtq_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>å®ƒåŒ…å« 5 ä¸ªæšä¸¾å€¼åˆ†åˆ«å¯¹åº”äº 5 ç§æ»šåŠ¨é˜¶æ®µï¼š</p> 
<pre><code class="prism language-swift"><span class="token attribute atrule">@frozen</span> <span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">ScrollPhase</span> <span class="token punctuation">:</span> <span class="token class-name">Equatable</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">case</span> idle
    <span class="token keyword">case</span> tracking
    <span class="token keyword">case</span> interacting
    <span class="token keyword">case</span> decelerating
    <span class="token keyword">case</span> animating
    
    <span class="token keyword">public</span> <span class="token keyword">var</span> isScrolling<span class="token punctuation">:</span> <span class="token class-name">Bool</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">get</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>è¿™äº›æ»šåŠ¨é˜¶æ®µçš„å«ä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼š</p> 
<ul><li>Idle - è¡¨ç¤ºå½“å‰æ»šåŠ¨è§†å›¾å¤„äºç©ºé—²çŠ¶æ€ï¼Œå¯ä»¥è®¤ä¸ºâ€œå˜›äº‹æ²¡æœ‰â€ï¼›</li><li>Tracking - è¡¨ç¤ºå½“å‰ç”¨æˆ·æ­£è½»è§¦æ»šåŠ¨è§†å›¾ä½†å¹¶æ²¡æœ‰å¼€å§‹æ»šåŠ¨ï¼›</li><li>Interacting - è¡¨ç¤ºç”¨æˆ·æ­£åœ¨å¼€å§‹æˆ–ç»§ç»­æ»šåŠ¨ç€è§†å›¾çš„å†…å®¹ï¼›</li><li>Decelerating -è¡¨ç¤ºç”¨æˆ·å·²ç»“æŸæ»šåŠ¨æ“ä½œï¼Œæ»šåŠ¨è§†å›¾çš„æ»šåŠ¨æ­£åœ¨å‡é€Ÿç›´è‡³é™æ­¢çŠ¶æ€ï¼›</li><li>Animating - è¡¨ç¤ºæ»šåŠ¨è§†å›¾è¢« ScrollPosition æˆ– ScrollViewReader ç±»å‹é€šè¿‡ä»£ç åŠ¨æ€æ»šåŠ¨åˆ°äº†æŒ‡å®šçš„ä½ç½®ï¼›</li></ul> 
<p>å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬æœ‰äº†æ–°çš„è§†å›¾æ”¹å™¨æ–¹æ³• onScrollPhaseChange ä¸“æ³¨äºæ»šåŠ¨é˜¶æ®µçš„ç›‘å¬ï¼š</p> 
<p><img src="https://images2.imgbox.com/36/79/GHIFowi9_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>æœ‰äº†ä»¥ä¸Šä¸¤è€…çš„ç è”ç’§åˆï¼Œç°åœ¨æˆ‘ä»¬åœ¨ SwiftUI 6.0 å³å¯è½»è€Œæ˜“ä¸¾çš„ç›‘å¬ä»»ä½•æ»šåŠ¨è§†å›¾çš„æ»šåŠ¨é˜¶æ®µå•¦ï¼š</p> 
<pre><code class="prism language-swift"><span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{<!-- --></span>
        
    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ScrollView</span> <span class="token punctuation">{<!-- --></span>
            
            <span class="token class-name">ForEach</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">...</span><span class="token number">50</span><span class="token punctuation">,</span> id<span class="token punctuation">:</span> <span class="token punctuation">\</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> i <span class="token keyword">in</span>
                <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Item </span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">i</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                
                <span class="token class-name">Divider</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        
        <span class="token punctuation">}</span>
        <span class="token punctuation">.</span>onScrollPhaseChange <span class="token punctuation">{<!-- --></span> old<span class="token punctuation">,</span> new <span class="token keyword">in</span>
            <span class="token keyword">guard</span> old <span class="token operator">!=</span> new <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> <span class="token punctuation">}</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"new phase: </span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">new</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span>
            
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>åœ¨ Xcode 16beta ä¸­è¿è¡Œæ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š</p> 
<p><img src="https://images2.imgbox.com/65/27/1xz4Lara_o.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>ScrollPhase ç±»å‹è¿˜æä¾›ä¸€ä¸ª isScrolling è®¡ç®—å±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥åˆ¤æ–­å½“å‰æ˜¯å¦æ­£åœ¨æ»šåŠ¨ã€‚æ¯”å¦‚ï¼Œå‡è‹¥è§†å›¾æ­£åœ¨è¢«æ»šåŠ¨æˆ‘ä»¬å°±â€œé®æŒ¡â€å®ƒçš„æ˜¾ç¤ºå†…å®¹ï¼š</p> 
<pre><code class="prism language-swift"><span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{<!-- --></span>
    
    <span class="token attribute atrule">@State</span> <span class="token keyword">var</span> isScrolling <span class="token operator">=</span> <span class="token boolean">false</span>
        
    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ScrollView</span> <span class="token punctuation">{<!-- --></span>
            
            <span class="token class-name">ForEach</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">...</span><span class="token number">50</span><span class="token punctuation">,</span> id<span class="token punctuation">:</span> <span class="token punctuation">\</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> i <span class="token keyword">in</span>
                <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Item </span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">i</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                
                <span class="token class-name">Divider</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token punctuation">.</span><span class="token function">redacted</span><span class="token punctuation">(</span>reason<span class="token punctuation">:</span> isScrolling <span class="token operator">?</span> <span class="token punctuation">.</span>placeholder <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        
        <span class="token punctuation">}</span>
        <span class="token punctuation">.</span>onScrollPhaseChange <span class="token punctuation">{<!-- --></span> old<span class="token punctuation">,</span> new <span class="token keyword">in</span>
            <span class="token keyword">guard</span> old <span class="token operator">!=</span> new <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> <span class="token punctuation">}</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"æ­£åœ¨æ»šåŠ¨ï¼Ÿ</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">new<span class="token punctuation">.</span>isScrolling</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span>
            isScrolling <span class="token operator">=</span> new<span class="token punctuation">.</span>isScrolling
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>æ‰§è¡Œæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p> 
<p><img src="https://images2.imgbox.com/3d/57/iTB0nl4N_o.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h2><a id="3_ScrollPhaseChangeContext_125"></a>3. æ»šåŠ¨é˜¶æ®µæ›´æ”¹ä¸Šä¸‹æ–‡ï¼ˆScrollPhaseChangeContextï¼‰</h2> 
<p>é™¤æ­¤ä¹‹å¤–ï¼ŒSwiftUI 6.0 ä¸­æ–°å¢çš„ onScrollPhaseChange ä¿®æ”¹å™¨è¿˜æä¾›å¦ä¸€ç§é‡è½½ï¼ˆOverloadingï¼‰å½¢å¼ï¼Œåœ¨è¯¥é‡è½½æ–¹æ³•çš„é—­åŒ…ä¸­æˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ª ScrollPhaseChangeContext ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œä½¿ç”¨å®ƒæˆ‘ä»¬å¯ä»¥æ›´å¤šçš„æŒæ§æ»šåŠ¨çš„å…¶å®ƒå…¨å±€ä¿¡æ¯ï¼š</p> 
<p><img src="https://images2.imgbox.com/5e/36/fjeb0KAd_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<pre><code class="prism language-swift"><span class="token keyword">nonisolated</span>
<span class="token keyword">func</span> <span class="token function-definition function">onScrollPhaseChange</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> action<span class="token punctuation">:</span> <span class="token attribute atrule">@escaping</span> <span class="token punctuation">(</span><span class="token class-name">ScrollPhase</span><span class="token punctuation">,</span> <span class="token class-name">ScrollPhase</span><span class="token punctuation">,</span> <span class="token class-name">ScrollPhaseChangeContext</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Void</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token keyword">some</span> <span class="token class-name">View</span>
</code></pre> 
<p>æ¼”ç¤ºä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°åœ¨å…¶ä¸­æˆ‘ä»¬ä½¿ç”¨ ScrollPhaseChangeContext ä¸Šä¸‹æ–‡å¯¹è±¡æ‰“å°å‡ºäº†æ›´å¤šçš„ä¸æ»šåŠ¨ç›¸å…³çš„ä¿¡æ¯ï¼š</p> 
<pre><code class="prism language-swift"><span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{<!-- --></span>        
    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ScrollView</span> <span class="token punctuation">{<!-- --></span>
            
            <span class="token class-name">ForEach</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">...</span><span class="token number">50</span><span class="token punctuation">,</span> id<span class="token punctuation">:</span> <span class="token punctuation">\</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> i <span class="token keyword">in</span>
                <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Item </span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">i</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                
                <span class="token class-name">Divider</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>        
        <span class="token punctuation">}</span>
        <span class="token punctuation">.</span>onScrollPhaseChange <span class="token punctuation">{<!-- --></span> old<span class="token punctuation">,</span> new<span class="token punctuation">,</span> context <span class="token keyword">in</span>
            <span class="token keyword">guard</span> old <span class="token operator">!=</span> new <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> <span class="token punctuation">}</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">new</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">\n</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">context</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span>            
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>è¿è¡Œç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p> 
<p><img src="https://images2.imgbox.com/b0/d3/SDyIo7jQ_o.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<blockquote> 
 <p>ScrollPhaseChangeContext(geometry: &lt;ScrollGeometry: contentOffset (0.0, 1694.3333333333333), contentSize (393.0, 4092.0), contentInsets &lt;top: 59.0, leading: 0.0, bottom: 34.0, trailing: 0.0&gt;, containerSize (393.0, 759.0), visibleRect (0.0, 1694.3333333333333, 393.0, 852.0)&gt;, velocity: Optional((0.0, 0.0)))</p> 
</blockquote> 
<h2><a id="4_List_164"></a>4. å¦‚ä½•ç›‘å¬åˆ—è¡¨ï¼ˆListï¼‰çš„æ»šåŠ¨é˜¶æ®µ</h2> 
<p>è™½ç„¶ SwiftUI 6.0 ç ´èŒ§è€Œå‡ºçš„â€œå¤§æ€å™¨â€ onScrollPhaseChange å¯¹äºæˆ‘ä»¬ç›‘å¬æ»šåŠ¨çŠ¶æ€å¤§æœ‰è£¨ç›Šï¼Œä¸è¿‡ç›®å‰å®ƒåªèƒ½åº”ç”¨åœ¨ ScrollView è§†å›¾çš„å¤–å±‚ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœå°†å…¶æ”¾åœ¨ List ä¸Šå°†ä¼šâ€œå¾’åŠ³æ— åŠŸâ€ï¼š</p> 
<pre><code class="prism language-swift"><span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{<!-- --></span>        
    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">List</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">ForEach</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">...</span><span class="token number">50</span><span class="token punctuation">,</span> id<span class="token punctuation">:</span> <span class="token punctuation">\</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> i <span class="token keyword">in</span>
                <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Item </span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">i</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>        
        <span class="token punctuation">}</span>
        <span class="token punctuation">.</span>onScrollPhaseChange <span class="token punctuation">{<!-- --></span> old<span class="token punctuation">,</span> new<span class="token punctuation">,</span> context <span class="token keyword">in</span>
            <span class="token keyword">guard</span> old <span class="token operator">!=</span> new <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> <span class="token punctuation">}</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">new</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">\n</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">context</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>ä¸Šè¿°ä»£ç é™„ç€åœ¨ List ä¹‹ä¸Šçš„ onScrollPhaseChange ä¿®æ”¹å™¨å›è°ƒé—­åŒ…å°†ä¼šæ— æ‰€äº‹äº‹ï¼Œç›´æ¥æ²¦ä¸ºâ€œä¸èˆä¹‹é¹¤â€ã€‚</p> 
<p>è¯šç„¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ScrollView æ¥å¹³æ›¿ Listï¼Œä¸è¿‡å¦‚æœèƒ½åœ¨ List ä¸Šç›´æ¥ç›‘å¬æ»šåŠ¨é˜¶æ®µå²‚ä¸æ›´å¦™ï¼Ÿ</p> 
<p>åœ¨ iOS 18.0beta ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å°† List åŒ…è£¹åœ¨ Form å®¹å™¨ä¸­æš‚æ—¶ç»•å¼€æ­¤é—®é¢˜ï¼š</p> 
<pre><code class="prism language-swift"><span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{<!-- --></span>        
    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Form</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">List</span> <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">ForEach</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">...</span><span class="token number">50</span><span class="token punctuation">,</span> id<span class="token punctuation">:</span> <span class="token punctuation">\</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> i <span class="token keyword">in</span>
                    <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Item </span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">i</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">.</span>onScrollPhaseChange <span class="token punctuation">{<!-- --></span> old<span class="token punctuation">,</span> new<span class="token punctuation">,</span> context <span class="token keyword">in</span>
            <span class="token keyword">guard</span> old <span class="token operator">!=</span> new <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> <span class="token punctuation">}</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">new</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">\n</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">context</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>è¿è¡Œä»£ç å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ç”¨ onScrollPhaseChange ä¿®æ”¹å™¨æˆåŠŸçš„æ•è·åˆ°äº† List ä¸­æ»šåŠ¨é˜¶æ®µçš„æ”¹å˜ä»¥åŠå…¶å®ƒæ»šåŠ¨ä¿¡æ¯ï¼š</p> 
<p><img src="https://images2.imgbox.com/a3/95/rtGetagU_o.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>æˆ‘ä¸ç¡®å®šè¿™ä¸€æƒ…å†µåœ¨ iOS 18.0 æ­£å¼ç‰ˆä¸­æ˜¯å¦èƒ½å¤Ÿä¿®å¤ï¼Œè®©æˆ‘ä»¬æ‹­ç›®ä»¥å¾…å§ï¼</p> 
<h2><a id="_217"></a>æ€»ç»“</h2> 
<p>åœ¨æœ¬ç¯‡åšæ–‡ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† SwiftUI 6.0ï¼ˆiOS 18.0ï¼‰æ»šåŠ¨è§†å›¾æœ€æ–°çš„æ»šåŠ¨é˜¶æ®µï¼ˆScroll Phaseï¼‰ç›‘å¬åŠŸèƒ½ï¼Œå¹¶è®¨è®ºäº†å¦‚ä½•åœ¨åŸæœ¬ä¸æ”¯æŒè¯¥åŠŸèƒ½çš„åˆ—è¡¨ï¼ˆListï¼‰ä¸Šä½¿ç”¨å®ƒã€‚</p> 
<p>æ„Ÿè°¢è§‚èµï¼Œå†ä¼šå•¦ï¼ğŸ˜</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/93f0ab6352cc7fbbc298e6a02dc2cfb4/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">AndroidåŸºç¡€çŸ¥è¯†</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/214ea1a64a0b77c2b4049ffd6acb6a64/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">lodash-es åŸºæœ¬ä½¿ç”¨</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§å’–.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>