<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Gateway实现Redis拉取信息&#43;用户模块开发 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/e5efca4288668f63b05131f122660da8/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Gateway实现Redis拉取信息&#43;用户模块开发">
  <meta property="og:description" content="文章目录 🌞 Sun Frame：SpringBoot 的轻量级开发框架（个人开源项目推荐）🌟 亮点功能📦 spring cloud模块概览常用工具 🔗 更多信息1.Gateway实现Redis拉取信息1.目录结构2.RedisConfig.java3.RedisUtil.java4.StpInterfaceImpl.java 2.用户模块-用户注册1.easycode生成auth_user代码1.创建好目录2.配置生成代码3.将dao层的类剪切到mapper层4.AuthUserDao.java删除Pageable的参数5.service层删除分页查询接口和实现类6.最终目录结构 2.sun-club-auth-application-controller 基本配置1.目录创建2.GlobalConfig.java mvc的全局处理 3.sun-club-auth-common 基本配置1.目录结构2.PageInfo.java3.PageResult.java4.Result.java5.IsDeleteFlagEnum.java6.ResultCodeEnum.java 4.sun-club-auth-application-controller层1.AuthUserDTO.java2.sun-club-auth-domain 模块AuthUserBO.java 与DTO一致 3.AuthUserDTOConverter.java 5.sun-club-auth-domain层1.目录创建2.AuthUserBOConverter.java3.AuthUserDomainService.java4.AuthUserDomainServiceImpl.java 6.sun-club-auth-infra层1.AuthUserService.java 修改insert返回为Integer2.AuthUserServiceImpl.java3.AuthUserDao.java4.AuthUserDao.xml 7.最后：UserController.java8.测试1.接口设计2.结果3.DB4.发现DB中没有插入status1.sun-club-auth-common模块新增枚举 AuthUserStatusEnum.java2.sun-club-auth-application-controller UserController.java新增语句3.重启测试 3.用户模块-更新用户信息1.接口设计2.sun-club-auth-application-controller1.UserController.java 3.sun-club-auth-domain1.AuthUserDomainService.java2.AuthUserDomainServiceImpl.java 4.sun-club-auth-infra1.AuthUserService.java2.AuthUserServiceImpl.java 5.测试1.结果2.DB 4.用户模块-删除用户信息1.接口设计2.sun-club-auth-application-controller1.UserController.java 3.sun-club-auth-domain1.AuthUserDomainService.java2.AuthUserDomainServiceImpl.java 4.测试1.结果2.DB 5.用户模块-启用/禁用信息1.接口设计2.UserController.java3.测试1.结果2.DB 🌞 Sun Frame：SpringBoot 的轻量级开发框架（个人开源项目推荐） 轻松高效的现代化开发体验
Sun Frame 是我个人开源的一款基于 SpringBoot 的轻量级框架，专为中小型企业设计。它提供了一种快速、简单且易于扩展的开发方式。
我们的开发文档记录了整个项目从0到1的任何细节，实属不易，请给我们一个Star！🌟
您的支持是我们持续改进的动力。 🌟 亮点功能 组件化开发：灵活选择，简化流程。高性能：通过异步日志和 Redis 缓存提升性能。易扩展：支持多种数据库和消息队列。 📦 spring cloud模块概览 Nacos 服务：高效的服务注册与发现。Feign 远程调用：简化服务间通信。强大网关：路由与限流。 常用工具 日志管理：异步处理与链路追踪。Redis 集成：支持分布式锁与缓存。Swagger 文档：便捷的 API 入口。测试支持：SpringBoot-Test 集成。EasyCode：自定义EasyCode模板引擎，一键生成CRUD。 🔗 更多信息 开源地址：Gitee Sun Frame详细文档：语雀文档">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-05T13:14:17+08:00">
    <meta property="article:modified_time" content="2024-08-05T13:14:17+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Gateway实现Redis拉取信息&#43;用户模块开发</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_Sun_FrameSpringBoot__3" rel="nofollow">🌞 Sun Frame：SpringBoot 的轻量级开发框架（个人开源项目推荐）</a></li><li><ul><li><a href="#__15" rel="nofollow">🌟 亮点功能</a></li><li><a href="#_spring_cloud_21" rel="nofollow">📦 spring cloud模块概览</a></li><li><ul><li><a href="#_27" rel="nofollow">常用工具</a></li></ul> 
   </li><li><a href="#__36" rel="nofollow">🔗 更多信息</a></li><li><a href="#1GatewayRedis_45" rel="nofollow">1.Gateway实现Redis拉取信息</a></li><li><ul><li><ul><li><a href="#1_47" rel="nofollow">1.目录结构</a></li><li><a href="#2RedisConfigjava_51" rel="nofollow">2.RedisConfig.java</a></li><li><a href="#3RedisUtiljava_103" rel="nofollow">3.RedisUtil.java</a></li><li><a href="#4StpInterfaceImpljava_206" rel="nofollow">4.StpInterfaceImpl.java</a></li></ul> 
   </li></ul> 
   </li><li><a href="#2_276" rel="nofollow">2.用户模块-用户注册</a></li><li><ul><li><ul><li><a href="#1easycodeauth_user_278" rel="nofollow">1.easycode生成auth_user代码</a></li><li><ul><li><a href="#1_280" rel="nofollow">1.创建好目录</a></li><li><a href="#2_284" rel="nofollow">2.配置生成代码</a></li><li><a href="#3daomapper_288" rel="nofollow">3.将dao层的类剪切到mapper层</a></li><li><a href="#4AuthUserDaojavaPageable_290" rel="nofollow">4.AuthUserDao.java删除Pageable的参数</a></li><li><a href="#5service_294" rel="nofollow">5.service层删除分页查询接口和实现类</a></li><li><a href="#6_300" rel="nofollow">6.最终目录结构</a></li></ul> 
     </li><li><a href="#2sunclubauthapplicationcontroller__304" rel="nofollow">2.sun-club-auth-application-controller 基本配置</a></li><li><ul><li><a href="#1_306" rel="nofollow">1.目录创建</a></li><li><a href="#2GlobalConfigjava_mvc_310" rel="nofollow">2.GlobalConfig.java mvc的全局处理</a></li></ul> 
     </li><li><a href="#3sunclubauthcommon__350" rel="nofollow">3.sun-club-auth-common 基本配置</a></li><li><ul><li><a href="#1_352" rel="nofollow">1.目录结构</a></li><li><a href="#2PageInfojava_356" rel="nofollow">2.PageInfo.java</a></li><li><a href="#3PageResultjava_397" rel="nofollow">3.PageResult.java</a></li><li><a href="#4Resultjava_515" rel="nofollow">4.Result.java</a></li><li><a href="#5IsDeleteFlagEnumjava_597" rel="nofollow">5.IsDeleteFlagEnum.java</a></li><li><a href="#6ResultCodeEnumjava_639" rel="nofollow">6.ResultCodeEnum.java</a></li></ul> 
     </li><li><a href="#4sunclubauthapplicationcontroller_681" rel="nofollow">4.sun-club-auth-application-controller层</a></li><li><ul><li><a href="#1AuthUserDTOjava_683" rel="nofollow">1.AuthUserDTO.java</a></li><li><a href="#2sunclubauthdomain__753" rel="nofollow">2.sun-club-auth-domain 模块</a></li><li><ul><li><a href="#AuthUserBOjava_DTO_755" rel="nofollow">AuthUserBO.java 与DTO一致</a></li></ul> 
      </li><li><a href="#3AuthUserDTOConverterjava_825" rel="nofollow">3.AuthUserDTOConverter.java</a></li></ul> 
     </li><li><a href="#5sunclubauthdomain_858" rel="nofollow">5.sun-club-auth-domain层</a></li><li><ul><li><a href="#1_860" rel="nofollow">1.目录创建</a></li><li><a href="#2AuthUserBOConverterjava_864" rel="nofollow">2.AuthUserBOConverter.java</a></li><li><a href="#3AuthUserDomainServicejava_900" rel="nofollow">3.AuthUserDomainService.java</a></li><li><a href="#4AuthUserDomainServiceImpljava_919" rel="nofollow">4.AuthUserDomainServiceImpl.java</a></li></ul> 
     </li><li><a href="#6sunclubauthinfra_957" rel="nofollow">6.sun-club-auth-infra层</a></li><li><ul><li><a href="#1AuthUserServicejava_insertInteger_959" rel="nofollow">1.AuthUserService.java 修改insert返回为Integer</a></li><li><a href="#2AuthUserServiceImpljava_971" rel="nofollow">2.AuthUserServiceImpl.java</a></li><li><a href="#3AuthUserDaojava_986" rel="nofollow">3.AuthUserDao.java</a></li><li><a href="#4AuthUserDaoxml_998" rel="nofollow">4.AuthUserDao.xml</a></li></ul> 
     </li><li><a href="#7UserControllerjava_1010" rel="nofollow">7.最后：UserController.java</a></li><li><a href="#8_1083" rel="nofollow">8.测试</a></li><li><ul><li><a href="#1_1085" rel="nofollow">1.接口设计</a></li><li><a href="#2_1089" rel="nofollow">2.结果</a></li><li><a href="#3DB_1093" rel="nofollow">3.DB</a></li><li><a href="#4DBstatus_1097" rel="nofollow">4.发现DB中没有插入status</a></li><li><ul><li><a href="#1sunclubauthcommon_AuthUserStatusEnumjava_1099" rel="nofollow">1.sun-club-auth-common模块新增枚举 AuthUserStatusEnum.java</a></li><li><a href="#2sunclubauthapplicationcontroller_UserControllerjava_1139" rel="nofollow">2.sun-club-auth-application-controller UserController.java新增语句</a></li><li><a href="#3_1143" rel="nofollow">3.重启测试</a></li></ul> 
     </li></ul> 
    </li></ul> 
   </li></ul> 
   </li><li><a href="#3_1147" rel="nofollow">3.用户模块-更新用户信息</a></li><li><ul><li><ul><li><a href="#1_1149" rel="nofollow">1.接口设计</a></li><li><a href="#2sunclubauthapplicationcontroller_1153" rel="nofollow">2.sun-club-auth-application-controller</a></li><li><ul><li><a href="#1UserControllerjava_1155" rel="nofollow">1.UserController.java</a></li></ul> 
     </li><li><a href="#3sunclubauthdomain_1186" rel="nofollow">3.sun-club-auth-domain</a></li><li><ul><li><a href="#1AuthUserDomainServicejava_1188" rel="nofollow">1.AuthUserDomainService.java</a></li><li><a href="#2AuthUserDomainServiceImpljava_1199" rel="nofollow">2.AuthUserDomainServiceImpl.java</a></li></ul> 
     </li><li><a href="#4sunclubauthinfra_1213" rel="nofollow">4.sun-club-auth-infra</a></li><li><ul><li><a href="#1AuthUserServicejava_1215" rel="nofollow">1.AuthUserService.java</a></li><li><a href="#2AuthUserServiceImpljava_1227" rel="nofollow">2.AuthUserServiceImpl.java</a></li></ul> 
     </li><li><a href="#5_1242" rel="nofollow">5.测试</a></li><li><ul><li><a href="#1_1244" rel="nofollow">1.结果</a></li><li><a href="#2DB_1248" rel="nofollow">2.DB</a></li></ul> 
    </li></ul> 
   </li></ul> 
   </li><li><a href="#4_1252" rel="nofollow">4.用户模块-删除用户信息</a></li><li><ul><li><ul><li><a href="#1_1254" rel="nofollow">1.接口设计</a></li><li><a href="#2sunclubauthapplicationcontroller_1258" rel="nofollow">2.sun-club-auth-application-controller</a></li><li><ul><li><a href="#1UserControllerjava_1260" rel="nofollow">1.UserController.java</a></li></ul> 
     </li><li><a href="#3sunclubauthdomain_1290" rel="nofollow">3.sun-club-auth-domain</a></li><li><ul><li><a href="#1AuthUserDomainServicejava_1292" rel="nofollow">1.AuthUserDomainService.java</a></li><li><a href="#2AuthUserDomainServiceImpljava_1303" rel="nofollow">2.AuthUserDomainServiceImpl.java</a></li></ul> 
     </li><li><a href="#4_1319" rel="nofollow">4.测试</a></li><li><ul><li><a href="#1_1321" rel="nofollow">1.结果</a></li><li><a href="#2DB_1325" rel="nofollow">2.DB</a></li></ul> 
    </li></ul> 
   </li></ul> 
   </li><li><a href="#5_1329" rel="nofollow">5.用户模块-启用/禁用信息</a></li><li><ul><li><ul><li><a href="#1_1331" rel="nofollow">1.接口设计</a></li><li><a href="#2UserControllerjava_1335" rel="nofollow">2.UserController.java</a></li><li><a href="#3_1366" rel="nofollow">3.测试</a></li><li><ul><li><a href="#1_1368" rel="nofollow">1.结果</a></li><li><a href="#2DB_1372" rel="nofollow">2.DB</a></li></ul> 
    </li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_Sun_FrameSpringBoot__3"></a>🌞 Sun Frame：SpringBoot 的轻量级开发框架（个人开源项目推荐）</h2> 
<p><img src="https://images2.imgbox.com/fd/29/XoNkTAYX_o.png" alt="Sun Frame Banner"></p> 
<blockquote> 
 <p><strong>轻松高效的现代化开发体验</strong></p> 
</blockquote> 
<p>Sun Frame 是我个人开源的一款基于 SpringBoot 的轻量级框架，专为中小型企业设计。它提供了一种快速、简单且易于扩展的开发方式。</p> 
<div> 
 <strong>我们的开发文档记录了整个项目从0到1的任何细节，实属不易，请给我们一个Star！🌟<br>您的支持是我们持续改进的动力。</strong> 
</div> 
<h3><a id="__15"></a>🌟 亮点功能</h3> 
<ul><li><strong>组件化开发</strong>：灵活选择，简化流程。</li><li><strong>高性能</strong>：通过异步日志和 Redis 缓存提升性能。</li><li><strong>易扩展</strong>：支持多种数据库和消息队列。</li></ul> 
<h3><a id="_spring_cloud_21"></a>📦 spring cloud模块概览</h3> 
<ul><li><strong>Nacos 服务</strong>：高效的服务注册与发现。</li><li><strong>Feign 远程调用</strong>：简化服务间通信。</li><li><strong>强大网关</strong>：路由与限流。</li></ul> 
<h4><a id="_27"></a>常用工具</h4> 
<ul><li><strong>日志管理</strong>：异步处理与链路追踪。</li><li><strong>Redis 集成</strong>：支持分布式锁与缓存。</li><li><strong>Swagger 文档</strong>：便捷的 API 入口。</li><li><strong>测试支持</strong>：SpringBoot-Test 集成。</li><li><strong>EasyCode</strong>：自定义EasyCode模板引擎，一键生成CRUD。</li></ul> 
<hr> 
<h3><a id="__36"></a>🔗 更多信息</h3> 
<ul><li><strong>开源地址</strong>：<a href="https://gitee.com/qyxinhua_0/sun-frame" rel="nofollow">Gitee Sun Frame</a></li><li><strong>详细文档</strong>：<a href="https://www.yuque.com/yuqueyonghuzns2k6/xg2046" rel="nofollow">语雀文档</a><br> <img src="https://images2.imgbox.com/fd/f3/aVH64zXh_o.png" alt="在这里插入图片描述"></li></ul> 
<hr> 
<h3><a id="1GatewayRedis_45"></a>1.Gateway实现Redis拉取信息</h3> 
<h5><a id="1_47"></a>1.目录结构</h5> 
<p><img src="https://images2.imgbox.com/4b/f8/21uvVw3D_o.png" alt="image-20240605145202260"></p> 
<h5><a id="2RedisConfigjava_51"></a>2.RedisConfig.java</h5> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>club<span class="token punctuation">.</span>gateway<span class="token punctuation">.</span>redis</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">JsonAutoDetect</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">JsonTypeInfo</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PropertyAccessor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>databind<span class="token punctuation">.</span></span><span class="token class-name">DeserializationFeature</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>databind<span class="token punctuation">.</span></span><span class="token class-name">ObjectMapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>connection<span class="token punctuation">.</span></span><span class="token class-name">RedisConnectionFactory</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">RedisTemplate</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>serializer<span class="token punctuation">.</span></span><span class="token class-name">Jackson2JsonRedisSerializer</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>serializer<span class="token punctuation">.</span></span><span class="token class-name">RedisSerializer</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>serializer<span class="token punctuation">.</span></span><span class="token class-name">StringRedisSerializer</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Description: 原生 redis 的 template 的序列化器会产生乱码问题，重写改为 jackson
 * @Author sun
 * @Create 2024/6/5 14:16
 * @Version 1.0
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisConfig</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">redisTemplate</span><span class="token punctuation">(</span><span class="token class-name">RedisConnectionFactory</span> redisConnectionFactory<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> redisTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">RedisSerializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> redisSerializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        redisTemplate<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>redisConnectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        redisTemplate<span class="token punctuation">.</span><span class="token function">setKeySerializer</span><span class="token punctuation">(</span>redisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        redisTemplate<span class="token punctuation">.</span><span class="token function">setHashKeySerializer</span><span class="token punctuation">(</span>redisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        redisTemplate<span class="token punctuation">.</span><span class="token function">setValueSerializer</span><span class="token punctuation">(</span><span class="token function">jackson2JsonRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        redisTemplate<span class="token punctuation">.</span><span class="token function">setHashValueSerializer</span><span class="token punctuation">(</span><span class="token function">jackson2JsonRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> redisTemplate<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">Jackson2JsonRedisSerializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">jackson2JsonRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Jackson2JsonRedisSerializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> jsonRedisSerializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jackson2JsonRedisSerializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ObjectMapper</span> objectMapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        objectMapper<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span><span class="token class-name">PropertyAccessor</span><span class="token punctuation">.</span><span class="token constant">ALL</span><span class="token punctuation">,</span> <span class="token class-name">JsonAutoDetect<span class="token punctuation">.</span>Visibility</span><span class="token punctuation">.</span><span class="token constant">ANY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        objectMapper<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">DeserializationFeature</span><span class="token punctuation">.</span><span class="token constant">FAIL_ON_UNKNOWN_PROPERTIES</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        objectMapper<span class="token punctuation">.</span><span class="token function">enableDefaultTyping</span><span class="token punctuation">(</span><span class="token class-name">ObjectMapper<span class="token punctuation">.</span>DefaultTyping</span><span class="token punctuation">.</span><span class="token constant">NON_FINAL</span><span class="token punctuation">,</span> <span class="token class-name">JsonTypeInfo<span class="token punctuation">.</span>As</span><span class="token punctuation">.</span><span class="token constant">PROPERTY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jsonRedisSerializer<span class="token punctuation">.</span><span class="token function">setObjectMapper</span><span class="token punctuation">(</span>objectMapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> jsonRedisSerializer<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="3RedisUtiljava_103"></a>3.RedisUtil.java</h5> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>club<span class="token punctuation">.</span>gateway<span class="token punctuation">.</span>redis</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">RedisTemplate</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Set</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">TimeUnit</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream<span class="token punctuation">.</span></span><span class="token class-name">Collectors</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream<span class="token punctuation">.</span></span><span class="token class-name">Stream</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Description: RedisUtil工具类
 * @Author sun
 * @Create 2024/6/5 14:17
 * @Version 1.0
 */</span>
<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisUtil</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">RedisTemplate</span> redisTemplate<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">CACHE_KEY_SEPARATOR</span> <span class="token operator">=</span> <span class="token string">"."</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 构建缓存key
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">buildKey</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> strObjs<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>strObjs<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">joining</span><span class="token punctuation">(</span><span class="token constant">CACHE_KEY_SEPARATOR</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 是否存在key
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">exist</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">hasKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 删除key
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">del</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> value<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">setNx</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> value<span class="token punctuation">,</span> <span class="token class-name">Long</span> time<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span> timeUnit<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setIfAbsent</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> time<span class="token punctuation">,</span> timeUnit<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Boolean</span> <span class="token function">zAdd</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> value<span class="token punctuation">,</span> <span class="token class-name">Long</span> score<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForZSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">countZset</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForZSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">rangeZset</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token keyword">long</span> start<span class="token punctuation">,</span> <span class="token keyword">long</span> end<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForZSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">removeZset</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">Object</span> value<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForZSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removeZsetList</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> value<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        value<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForZSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Double</span> <span class="token function">score</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">Object</span> value<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForZSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">score</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">rangeByScore</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token keyword">long</span> start<span class="token punctuation">,</span> <span class="token keyword">long</span> end<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForZSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rangeByScore</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>start<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>end<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">addScore</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">Object</span> obj<span class="token punctuation">,</span> <span class="token keyword">double</span> score<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForZSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">incrementScore</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> obj<span class="token punctuation">,</span> score<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">rank</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">Object</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForZSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rank</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="4StpInterfaceImpljava_206"></a>4.StpInterfaceImpl.java</h5> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>club<span class="token punctuation">.</span>gateway<span class="token punctuation">.</span>auth</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>dev33<span class="token punctuation">.</span>satoken<span class="token punctuation">.</span>stp<span class="token punctuation">.</span></span><span class="token class-name">StpInterface</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span><span class="token class-name">StringUtils</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>gson<span class="token punctuation">.</span></span><span class="token class-name">Gson</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>club<span class="token punctuation">.</span>gateway<span class="token punctuation">.</span>redis<span class="token punctuation">.</span></span><span class="token class-name">RedisConfig</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>club<span class="token punctuation">.</span>gateway<span class="token punctuation">.</span>redis<span class="token punctuation">.</span></span><span class="token class-name">RedisUtil</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Collections</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 自定义权限验证接口扩展
 */</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StpInterfaceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">StpInterface</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">RedisUtil</span> redisUtil<span class="token punctuation">;</span>
    <span class="token comment">// 定义存入到redis的前缀</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> authPermissionPrefix <span class="token operator">=</span> <span class="token string">"auth.permission"</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> authRolePrefix <span class="token operator">=</span> <span class="token string">"auth.role"</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">StpInterfaceImpl</span><span class="token punctuation">(</span><span class="token class-name">RedisUtil</span> redisUtil<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>redisUtil <span class="token operator">=</span> redisUtil<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 返回此loginId拥有的权限列表
     * @param loginId
     * @param loginType
     * @return
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getPermissionList</span><span class="token punctuation">(</span><span class="token class-name">Object</span> loginId<span class="token punctuation">,</span> <span class="token class-name">String</span> loginType<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token function">getAuth</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> loginId<span class="token punctuation">,</span> authPermissionPrefix<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 返回此loginId拥有的角色列表
     * @param loginId
     * @param loginType
     * @return
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getRoleList</span><span class="token punctuation">(</span><span class="token class-name">Object</span> loginId<span class="token punctuation">,</span> <span class="token class-name">String</span> loginType<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token function">getAuth</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> loginId<span class="token punctuation">,</span> authRolePrefix<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getAuth</span><span class="token punctuation">(</span><span class="token class-name">String</span> loginId<span class="token punctuation">,</span> <span class="token class-name">String</span> prefix<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 得到该用户在redis中存储的key</span>
        <span class="token class-name">String</span> authKey <span class="token operator">=</span> redisUtil<span class="token punctuation">.</span><span class="token function">buildKey</span><span class="token punctuation">(</span>prefix<span class="token punctuation">,</span> loginId<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 从redis中获取列表</span>
        <span class="token class-name">String</span> authValue <span class="token operator">=</span> redisUtil<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>authKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 判空</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isBlank</span><span class="token punctuation">(</span>authValue<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 如果有权限，则使用Gson反序列化为List</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> authList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Gson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span>authValue<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> authList<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="2_276"></a>2.用户模块-用户注册</h3> 
<h5><a id="1easycodeauth_user_278"></a>1.easycode生成auth_user代码</h5> 
<h6><a id="1_280"></a>1.创建好目录</h6> 
<p><img src="https://images2.imgbox.com/80/e3/E0tX9O9O_o.png" alt="image-20240605150443859"></p> 
<h6><a id="2_284"></a>2.配置生成代码</h6> 
<p><img src="https://images2.imgbox.com/0c/0e/pLAgRJPH_o.png" alt="image-20240605150614456"></p> 
<h6><a id="3daomapper_288"></a>3.将dao层的类剪切到mapper层</h6> 
<h6><a id="4AuthUserDaojavaPageable_290"></a>4.AuthUserDao.java删除Pageable的参数</h6> 
<p><img src="https://images2.imgbox.com/b9/65/Qrk1rc2x_o.png" alt="image-20240605151131673"></p> 
<h6><a id="5service_294"></a>5.service层删除分页查询接口和实现类</h6> 
<p><img src="https://images2.imgbox.com/f2/6a/RfSo4rk8_o.png" alt="image-20240605151230210"></p> 
<p><img src="https://images2.imgbox.com/00/8b/DuZKH38V_o.png" alt="image-20240605151243406"></p> 
<h6><a id="6_300"></a>6.最终目录结构</h6> 
<p><img src="https://images2.imgbox.com/55/2f/pFeXnlTh_o.png" alt="image-20240605151513469"></p> 
<h5><a id="2sunclubauthapplicationcontroller__304"></a>2.sun-club-auth-application-controller 基本配置</h5> 
<h6><a id="1_306"></a>1.目录创建</h6> 
<p><img src="https://images2.imgbox.com/0d/27/XVKAIbFC_o.png" alt="image-20240605152023941"></p> 
<h6><a id="2GlobalConfigjava_mvc_310"></a>2.GlobalConfig.java mvc的全局处理</h6> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>application<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">JsonInclude</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>databind<span class="token punctuation">.</span></span><span class="token class-name">ObjectMapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>databind<span class="token punctuation">.</span></span><span class="token class-name">SerializationFeature</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>http<span class="token punctuation">.</span>converter<span class="token punctuation">.</span></span><span class="token class-name">HttpMessageConverter</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>http<span class="token punctuation">.</span>converter<span class="token punctuation">.</span>json<span class="token punctuation">.</span></span><span class="token class-name">MappingJackson2HttpMessageConverter</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebMvcConfigurationSupport</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * mvc的全局处理
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GlobalConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebMvcConfigurationSupport</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configureMessageConverters</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HttpMessageConverter</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> converters<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">configureMessageConverters</span><span class="token punctuation">(</span>converters<span class="token punctuation">)</span><span class="token punctuation">;</span>
        converters<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">mappingJackson2HttpMessageConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/**
     * 自定义mappingJackson2HttpMessageConverter
     * 目前实现：空值忽略，空字段可返回
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">MappingJackson2HttpMessageConverter</span> <span class="token function">mappingJackson2HttpMessageConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ObjectMapper</span> objectMapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        objectMapper<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">SerializationFeature</span><span class="token punctuation">.</span><span class="token constant">FAIL_ON_EMPTY_BEANS</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        objectMapper<span class="token punctuation">.</span><span class="token function">setSerializationInclusion</span><span class="token punctuation">(</span><span class="token class-name">JsonInclude<span class="token punctuation">.</span>Include</span><span class="token punctuation">.</span><span class="token constant">NON_NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MappingJackson2HttpMessageConverter</span><span class="token punctuation">(</span>objectMapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="3sunclubauthcommon__350"></a>3.sun-club-auth-common 基本配置</h5> 
<h6><a id="1_352"></a>1.目录结构</h6> 
<p><img src="https://images2.imgbox.com/6f/6d/KWxMJlql_o.png" alt="image-20240605152556975"></p> 
<h6><a id="2PageInfojava_356"></a>2.PageInfo.java</h6> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>common<span class="token punctuation">.</span>eneity</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Description: 分页请求的入参
 * @Author sun
 * @Create 2024/5/28 16:25
 * @Version 1.0
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PageInfo</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token class-name">Integer</span> pageNo <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Integer</span> pageSize <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getPageNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>pageNo <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> pageNo <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> pageNo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getPageSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>pageSize <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> pageSize <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> pageSize <span class="token operator">&gt;</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token number">20</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> pageSize<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPageNo</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> pageNo<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>pageNo <span class="token operator">=</span> pageNo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPageSize</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> pageSize<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>pageSize <span class="token operator">=</span> pageSize<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h6><a id="3PageResultjava_397"></a>3.PageResult.java</h6> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>common<span class="token punctuation">.</span>eneity</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Collections</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Description: 分页返回的实体
 * @Author sun
 * @Create 2024/5/28 16:36
 * @Version 1.1
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PageResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">// 当前页码，默认为1</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> pageNo <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token comment">// 每页显示的记录数，默认为20</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> pageSize <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>

    <span class="token comment">// 总记录条数</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> total <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">// 总页数</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> totalPages <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">// 当前页的记录列表</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 表示当前页是从数据库的第几条记录开始，下标从1开始</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> start <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token comment">// 表示当前页是从数据库的第几条记录结束，下标从1开始</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> end <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">// 设置当前页码，并重新计算起始和结束位置</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPageNo</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> pageNo<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>pageNo <span class="token operator">=</span> pageNo<span class="token punctuation">;</span>
        <span class="token function">calculateStartAndEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 设置每页记录数，并重新计算起始和结束位置</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPageSize</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> pageSize<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>pageSize <span class="token operator">=</span> pageSize<span class="token punctuation">;</span>
        <span class="token function">calculateStartAndEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 设置当前页的记录列表</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setRecords</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> result<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>result <span class="token operator">=</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 设置总记录条数，并重新计算总页数和起始结束位置</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTotal</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> total<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>total <span class="token operator">=</span> total<span class="token punctuation">;</span>
        <span class="token function">calculateTotalPages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">calculateStartAndEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 计算总页数</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">calculateTotalPages</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>pageSize <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>totalPages <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>total <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pageSize<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>total <span class="token operator">%</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pageSize <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>totalPages <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 计算起始和结束位置</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">calculateStartAndEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>pageSize <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>start <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>pageNo <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pageSize <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>end <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>pageNo <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pageSize<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>total<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>start <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>end <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>total<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 获取数据库查询的起始位置（从0开始）</span>
    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getDBStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> start <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> start<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 获取每页记录数</span>
    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getPageSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> pageSize<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 可选的 Getters 和 Setters</span>
    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getPageNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> pageNo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getTotal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> total<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getTotalPages</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> totalPages<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> end<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h6><a id="4Resultjava_515"></a>4.Result.java</h6> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>common<span class="token punctuation">.</span>eneity</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>common<span class="token punctuation">.</span>enums<span class="token punctuation">.</span></span><span class="token class-name">ResultCodeEnum</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Description:
 * @Author sun
 * @Create 2024/5/24 9:48
 * @Version 1.0
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Result</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token class-name">Boolean</span> success<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Integer</span> code<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> message<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">T</span> data<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 成功返回结果
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Result</span> <span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Result</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">setSuccess</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">setCode</span><span class="token punctuation">(</span><span class="token class-name">ResultCodeEnum</span><span class="token punctuation">.</span><span class="token constant">SUCCESS</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">setMessage</span><span class="token punctuation">(</span><span class="token class-name">ResultCodeEnum</span><span class="token punctuation">.</span><span class="token constant">SUCCESS</span><span class="token punctuation">.</span><span class="token function">getDesc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 成功返回结果，携带数据
     * @param data
     * @return
     * @param &lt;T&gt;
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">Result</span> <span class="token function">ok</span><span class="token punctuation">(</span><span class="token class-name">T</span> data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Result</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">setSuccess</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">setCode</span><span class="token punctuation">(</span><span class="token class-name">ResultCodeEnum</span><span class="token punctuation">.</span><span class="token constant">SUCCESS</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">setMessage</span><span class="token punctuation">(</span><span class="token class-name">ResultCodeEnum</span><span class="token punctuation">.</span><span class="token constant">SUCCESS</span><span class="token punctuation">.</span><span class="token function">getDesc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 失败返回结果
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Result</span> <span class="token function">fail</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Result</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">setSuccess</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">setCode</span><span class="token punctuation">(</span><span class="token class-name">ResultCodeEnum</span><span class="token punctuation">.</span><span class="token constant">FAIL</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">setMessage</span><span class="token punctuation">(</span><span class="token class-name">ResultCodeEnum</span><span class="token punctuation">.</span><span class="token constant">FAIL</span><span class="token punctuation">.</span><span class="token function">getDesc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 失败，携带数据
     * @param data
     * @return
     * @param &lt;T&gt;
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">Result</span> <span class="token function">fail</span><span class="token punctuation">(</span><span class="token class-name">T</span> data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Result</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">setSuccess</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">setCode</span><span class="token punctuation">(</span><span class="token class-name">ResultCodeEnum</span><span class="token punctuation">.</span><span class="token constant">FAIL</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">setMessage</span><span class="token punctuation">(</span><span class="token class-name">ResultCodeEnum</span><span class="token punctuation">.</span><span class="token constant">FAIL</span><span class="token punctuation">.</span><span class="token function">getDesc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h6><a id="5IsDeleteFlagEnumjava_597"></a>5.IsDeleteFlagEnum.java</h6> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>common<span class="token punctuation">.</span>enums</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Getter</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Description: 删除标识枚举
 * @Author sun
 * @Create 2024/5/24 9:53
 * @Version 1.0
 */</span>
<span class="token annotation punctuation">@Getter</span>
<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">IsDeleteFlagEnum</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">DELETED</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"已删除"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">UN_DELETED</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"未删除"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> code<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> desc<span class="token punctuation">;</span>

    <span class="token class-name">IsDeleteFlagEnum</span><span class="token punctuation">(</span><span class="token keyword">int</span> code<span class="token punctuation">,</span> <span class="token class-name">String</span> desc<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>code <span class="token operator">=</span> code<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>desc <span class="token operator">=</span> desc<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 根据code获取枚举
     * @param code
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">IsDeleteFlagEnum</span> <span class="token function">getByCode</span><span class="token punctuation">(</span><span class="token keyword">int</span> code<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">IsDeleteFlagEnum</span> value <span class="token operator">:</span> <span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span>code <span class="token operator">==</span> code<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> value<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h6><a id="6ResultCodeEnumjava_639"></a>6.ResultCodeEnum.java</h6> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>common<span class="token punctuation">.</span>enums</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Getter</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Description: 返回结果枚举
 * @Author sun
 * @Create 2024/5/24 9:53
 * @Version 1.0
 */</span>
<span class="token annotation punctuation">@Getter</span>
<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">ResultCodeEnum</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">SUCCESS</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">"成功"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">FAIL</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token string">"失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> code<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> desc<span class="token punctuation">;</span>

    <span class="token class-name">ResultCodeEnum</span><span class="token punctuation">(</span><span class="token keyword">int</span> code<span class="token punctuation">,</span> <span class="token class-name">String</span> desc<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>code <span class="token operator">=</span> code<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>desc <span class="token operator">=</span> desc<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 根据code获取枚举
     * @param code
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ResultCodeEnum</span> <span class="token function">getByCode</span><span class="token punctuation">(</span><span class="token keyword">int</span> code<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ResultCodeEnum</span> value <span class="token operator">:</span> <span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span>code <span class="token operator">==</span> code<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> value<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="4sunclubauthapplicationcontroller_681"></a>4.sun-club-auth-application-controller层</h5> 
<h6><a id="1AuthUserDTOjava_683"></a>1.AuthUserDTO.java</h6> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>application<span class="token punctuation">.</span>dto</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Serializable</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 用户信息的dto
 *
 * @author makejava
 * @since 2024-06-05 15:06:10
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AuthUserDTO</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">/**
     * 主键
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 用户名称/账号
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> userName<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 昵称
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> nickName<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 邮箱
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 手机号
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> phone<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 密码
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 性别
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> sex<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 头像
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> avatar<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 状态 0启用 1禁用
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> status<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 个人介绍
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> introduce<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 特殊字段
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> extJson<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 是否被删除 0未删除 1已删除
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> isDeleted<span class="token punctuation">;</span>

<span class="token punctuation">}</span>

</code></pre> 
<h6><a id="2sunclubauthdomain__753"></a>2.sun-club-auth-domain 模块</h6> 
<h6><a id="AuthUserBOjava_DTO_755"></a>AuthUserBO.java 与DTO一致</h6> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>entity</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Serializable</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 用户信息的bo
 *
 * @author makejava
 * @since 2024-06-05 15:06:10
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AuthUserBO</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">/**
     * 主键
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 用户名称/账号
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> userName<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 昵称
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> nickName<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 邮箱
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 手机号
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> phone<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 密码
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 性别
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> sex<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 头像
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> avatar<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 状态 0启用 1禁用
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> status<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 个人介绍
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> introduce<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 特殊字段
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> extJson<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 是否被删除 0未删除 1已删除
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> isDeleted<span class="token punctuation">;</span>

<span class="token punctuation">}</span>

</code></pre> 
<h6><a id="3AuthUserDTOConverterjava_825"></a>3.AuthUserDTOConverter.java</h6> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>application<span class="token punctuation">.</span>convert</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>application<span class="token punctuation">.</span>dto<span class="token punctuation">.</span></span><span class="token class-name">AuthUserDTO</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">AuthUserBO</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>mapstruct<span class="token punctuation">.</span></span><span class="token class-name">Mapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>mapstruct<span class="token punctuation">.</span>factory<span class="token punctuation">.</span></span><span class="token class-name">Mappers</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Description: DTO转换
 * @Author sun
 * @Create 2024/6/5 15:39
 * @Version 1.0
 */</span>
<span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">AuthUserDTOConverter</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">AuthUserDTOConverter</span> <span class="token constant">INSTANCE</span> <span class="token operator">=</span> <span class="token class-name">Mappers</span><span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">AuthUserDTOConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 将AuthUserDTO转换为AuthUserBO</span>
    <span class="token class-name">AuthUserBO</span> <span class="token function">convertDTO2BO</span><span class="token punctuation">(</span><span class="token class-name">AuthUserDTO</span> authUserDTO<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 将AuthUserBO转换为AuthUserDTO</span>
    <span class="token class-name">AuthUserDTO</span> <span class="token function">convertBO2DTO</span><span class="token punctuation">(</span><span class="token class-name">AuthUserBO</span> authUserBO<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 将AuthUserDTO集合转换为AuthUserBO集合</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AuthUserBO</span><span class="token punctuation">&gt;</span></span> <span class="token function">convertDTO2BO</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AuthUserDTO</span><span class="token punctuation">&gt;</span></span> authUserDTOList<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 将AuthUserBO集合转换为AuthUserDTO集合</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AuthUserDTO</span><span class="token punctuation">&gt;</span></span> <span class="token function">convertBO2DTO</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AuthUserBO</span><span class="token punctuation">&gt;</span></span> authUserBOList<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="5sunclubauthdomain_858"></a>5.sun-club-auth-domain层</h5> 
<h6><a id="1_860"></a>1.目录创建</h6> 
<p><img src="https://images2.imgbox.com/ad/82/UGRO0Gbc_o.png" alt="image-20240605155441562"></p> 
<h6><a id="2AuthUserBOConverterjava_864"></a>2.AuthUserBOConverter.java</h6> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>convert</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>basic<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">AuthUser</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">AuthUserBO</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>mapstruct<span class="token punctuation">.</span></span><span class="token class-name">Mapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>mapstruct<span class="token punctuation">.</span>factory<span class="token punctuation">.</span></span><span class="token class-name">Mappers</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Description: BO转换
 * @Author sun
 * @Create 2024/5/24 9:18
 * @Version 1.0
 */</span>
<span class="token annotation punctuation">@Mapper</span> <span class="token comment">// mapstruct的注解</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">AuthUserBOConverter</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// INSTANCE是一个AuthUserBOConverter的静态实例，可以直接通过AuthUserBOConverter.INSTANCE调用内部的方法</span>
    <span class="token class-name">AuthUserBOConverter</span> <span class="token constant">INSTANCE</span> <span class="token operator">=</span> <span class="token class-name">Mappers</span><span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">AuthUserBOConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 将AuthUserBO转换为AuthUser</span>
    <span class="token class-name">AuthUser</span> <span class="token function">convertBO2Entity</span><span class="token punctuation">(</span><span class="token class-name">AuthUserBO</span> authUserBO<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 将AuthUser转换为AuthUserBO</span>
    <span class="token class-name">AuthUserBO</span> <span class="token function">convertEntity2BO</span><span class="token punctuation">(</span><span class="token class-name">AuthUser</span> authUser<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 将AuthUserBO集合转换为AuthUser集合</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AuthUser</span><span class="token punctuation">&gt;</span></span> <span class="token function">convertBO2Entity</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AuthUserBO</span><span class="token punctuation">&gt;</span></span> authUserBOList<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 将AuthUser集合转换为AuthUserBO集合</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AuthUserBO</span><span class="token punctuation">&gt;</span></span> <span class="token function">convertEntity2BO</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AuthUser</span><span class="token punctuation">&gt;</span></span> authUserList<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

</code></pre> 
<h6><a id="3AuthUserDomainServicejava_900"></a>3.AuthUserDomainService.java</h6> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">AuthUserBO</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Description:
 * @Author sun
 * @Create 2024/5/24 9:03
 * @Version 1.0
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">AuthUserDomainService</span> <span class="token punctuation">{<!-- --></span>

    <span class="token class-name">Boolean</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token class-name">AuthUserBO</span> authUserBO<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h6><a id="4AuthUserDomainServiceImpljava_919"></a>4.AuthUserDomainServiceImpl.java</h6> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>basic<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">AuthUser</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>basic<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">AuthUserService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>convert<span class="token punctuation">.</span></span><span class="token class-name">AuthUserBOConverter</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">AuthUserBO</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">AuthUserDomainService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Description:
 * @Author sun
 * @Create 2024/5/24 9:03
 * @Version 1.0
 */</span>
<span class="token annotation punctuation">@Service</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AuthUserDomainServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">AuthUserDomainService</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">AuthUserService</span> authUserService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Boolean</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token class-name">AuthUserBO</span> authUserBO<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// BO转换为Entity</span>
        <span class="token class-name">AuthUser</span> authUser <span class="token operator">=</span> <span class="token class-name">AuthUserBOConverter</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">.</span><span class="token function">convertBO2Entity</span><span class="token punctuation">(</span>authUserBO<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 调用基础服务</span>
        <span class="token class-name">Integer</span> count <span class="token operator">=</span> authUserService<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>authUser<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="6sunclubauthinfra_957"></a>6.sun-club-auth-infra层</h5> 
<h6><a id="1AuthUserServicejava_insertInteger_959"></a>1.AuthUserService.java 修改insert返回为Integer</h6> 
<pre><code class="prism language-java"><span class="token comment">/**
 * 新增数据
 *
 * @param authUser 实例对象
 * @return 实例对象
 */</span>
<span class="token class-name">Integer</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">AuthUser</span> authUser<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h6><a id="2AuthUserServiceImpljava_971"></a>2.AuthUserServiceImpl.java</h6> 
<pre><code class="prism language-java"><span class="token comment">/**
 * 新增数据
 *
 * @param authUser 实例对象
 * @return 实例对象
 */</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">AuthUser</span> authUser<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>authUserDao<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>authUser<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h6><a id="3AuthUserDaojava_986"></a>3.AuthUserDao.java</h6> 
<pre><code class="prism language-java"><span class="token comment">/**
 * 新增数据
 *
 * @param authUser 实例对象
 * @return 影响行数
 */</span>
<span class="token keyword">int</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">AuthUser</span> authUser<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h6><a id="4AuthUserDaoxml_998"></a>4.AuthUserDao.xml</h6> 
<pre><code class="prism language-xml"><span class="token comment">&lt;!--新增所有列--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>insert<span class="token punctuation">"</span></span> <span class="token attr-name">keyProperty</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">useGeneratedKeys</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    insert into auth_user(user_name, nick_name, email, phone, password, sex, avatar, status, introduce, ext_json,
                          created_by, created_time, update_by, update_time, is_deleted)
    values (#{userName}, #{nickName}, #{email}, #{phone}, #{password}, #{sex}, #{avatar}, #{status}, #{introduce},
            #{extJson}, #{createdBy}, #{createdTime}, #{updateBy}, #{updateTime}, #{isDeleted})
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h5><a id="7UserControllerjava_1010"></a>7.最后：UserController.java</h5> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>application<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>dev33<span class="token punctuation">.</span>satoken<span class="token punctuation">.</span>stp<span class="token punctuation">.</span></span><span class="token class-name">SaTokenInfo</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>dev33<span class="token punctuation">.</span>satoken<span class="token punctuation">.</span>stp<span class="token punctuation">.</span></span><span class="token class-name">StpUtil</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>dev33<span class="token punctuation">.</span>satoken<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">SaResult</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span><span class="token class-name">JSON</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>common<span class="token punctuation">.</span>base<span class="token punctuation">.</span></span><span class="token class-name">Preconditions</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>xml<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>v2<span class="token punctuation">.</span></span><span class="token class-name">TODO</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>application<span class="token punctuation">.</span>convert<span class="token punctuation">.</span></span><span class="token class-name">AuthUserDTOConverter</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>application<span class="token punctuation">.</span>dto<span class="token punctuation">.</span></span><span class="token class-name">AuthUserDTO</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>common<span class="token punctuation">.</span>eneity<span class="token punctuation">.</span></span><span class="token class-name">Result</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>common<span class="token punctuation">.</span>enums<span class="token punctuation">.</span></span><span class="token class-name">IsDeleteFlagEnum</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">AuthUserBO</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">AuthUserDomainService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>lang3<span class="token punctuation">.</span></span><span class="token class-name">StringUtils</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PostMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestBody</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Description:
 * @Author sun
 * @Create 2024/6/2 17:25
 * @Version 1.0
 */</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/user/"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">AuthUserDomainService</span> authUserDomainService<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 用户注册
     * @param authUserDTO
     * @return
     */</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"register"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Result</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Boolean</span><span class="token punctuation">&gt;</span></span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">AuthUserDTO</span> authUserDTO<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 日志</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>log<span class="token punctuation">.</span><span class="token function">isInfoEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"UserController register AuthUserDTO, authUserDTO:{}"</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>authUserDTO<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 参数校验</span>
            <span class="token class-name">Preconditions</span><span class="token punctuation">.</span><span class="token function">checkArgument</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isBlank</span><span class="token punctuation">(</span>authUserDTO<span class="token punctuation">.</span><span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"用户名不能为空"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Preconditions</span><span class="token punctuation">.</span><span class="token function">checkArgument</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isBlank</span><span class="token punctuation">(</span>authUserDTO<span class="token punctuation">.</span><span class="token function">getEmail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"邮箱不能为空"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Preconditions</span><span class="token punctuation">.</span><span class="token function">checkArgument</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isBlank</span><span class="token punctuation">(</span>authUserDTO<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"密码不能为空"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 转换DTO为BO</span>
            <span class="token class-name">AuthUserBO</span> authUserBO <span class="token operator">=</span> <span class="token class-name">AuthUserDTOConverter</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">.</span><span class="token function">convertDTO2BO</span><span class="token punctuation">(</span>authUserDTO<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 调用领域服务</span>
            <span class="token comment">// 设置逻辑删除</span>
            authUserBO<span class="token punctuation">.</span><span class="token function">setIsDeleted</span><span class="token punctuation">(</span><span class="token class-name">IsDeleteFlagEnum</span><span class="token punctuation">.</span><span class="token constant">UN_DELETED</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 注册</span>
            <span class="token class-name">Boolean</span> res <span class="token operator">=</span> authUserDomainService<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>authUserBO<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"UserController register error:{}"</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="8_1083"></a>8.测试</h5> 
<h6><a id="1_1085"></a>1.接口设计</h6> 
<p><img src="https://images2.imgbox.com/35/ab/Ua2uEviF_o.png" alt="image-20240605163348946"></p> 
<h6><a id="2_1089"></a>2.结果</h6> 
<p><img src="https://images2.imgbox.com/a4/20/BBD6AV4W_o.png" alt="image-20240605163402309"></p> 
<h6><a id="3DB_1093"></a>3.DB</h6> 
<p><img src="https://images2.imgbox.com/f4/b6/axDRWWNm_o.png" alt="image-20240605163427362"></p> 
<h6><a id="4DBstatus_1097"></a>4.发现DB中没有插入status</h6> 
<h6><a id="1sunclubauthcommon_AuthUserStatusEnumjava_1099"></a>1.sun-club-auth-common模块新增枚举 AuthUserStatusEnum.java</h6> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>sunxiansheng<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>common<span class="token punctuation">.</span>enums</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Getter</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Description: 返回结果枚举
 * @Author sun
 * @Create 2024/5/24 9:53
 * @Version 1.0
 */</span>
<span class="token annotation punctuation">@Getter</span>
<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">AuthUserStatusEnum</span> <span class="token punctuation">{<!-- --></span>

    <span class="token function">OPEN</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"启用"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">CLOSE</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"禁用"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> code<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> desc<span class="token punctuation">;</span>

    <span class="token class-name">AuthUserStatusEnum</span><span class="token punctuation">(</span><span class="token keyword">int</span> code<span class="token punctuation">,</span> <span class="token class-name">String</span> desc<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>code <span class="token operator">=</span> code<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>desc <span class="token operator">=</span> desc<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">AuthUserStatusEnum</span> <span class="token function">getByCode</span><span class="token punctuation">(</span><span class="token keyword">int</span> codeVal<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">AuthUserStatusEnum</span> resultCodeEnum <span class="token operator">:</span> <span class="token class-name">AuthUserStatusEnum</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>resultCodeEnum<span class="token punctuation">.</span>code <span class="token operator">==</span> codeVal<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> resultCodeEnum<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h6><a id="2sunclubauthapplicationcontroller_UserControllerjava_1139"></a>2.sun-club-auth-application-controller UserController.java新增语句</h6> 
<p><img src="https://images2.imgbox.com/71/d3/Z1iQSrD6_o.png" alt=""></p> 
<h6><a id="3_1143"></a>3.重启测试</h6> 
<p><img src="https://images2.imgbox.com/f9/5f/M9Dyy1Xo_o.png" alt="image-20240605164814865"></p> 
<h3><a id="3_1147"></a>3.用户模块-更新用户信息</h3> 
<h5><a id="1_1149"></a>1.接口设计</h5> 
<p><img src="https://images2.imgbox.com/33/06/7N8Kjrvf_o.png" alt="image-20240605171114841"></p> 
<h5><a id="2sunclubauthapplicationcontroller_1153"></a>2.sun-club-auth-application-controller</h5> 
<h6><a id="1UserControllerjava_1155"></a>1.UserController.java</h6> 
<pre><code class="prism language-java"><span class="token comment">/**
 * 修改用户信息
 * @param authUserDTO
 * @return
 */</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"update"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Result</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Boolean</span><span class="token punctuation">&gt;</span></span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">AuthUserDTO</span> authUserDTO<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 日志</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>log<span class="token punctuation">.</span><span class="token function">isInfoEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"UserController update AuthUserDTO, authUserDTO:{}"</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>authUserDTO<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 参数校验</span>
        <span class="token class-name">Preconditions</span><span class="token punctuation">.</span><span class="token function">checkArgument</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isBlank</span><span class="token punctuation">(</span>authUserDTO<span class="token punctuation">.</span><span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"用户名不能为空"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 转换DTO为BO</span>
        <span class="token class-name">AuthUserBO</span> authUserBO <span class="token operator">=</span> <span class="token class-name">AuthUserDTOConverter</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">.</span><span class="token function">convertDTO2BO</span><span class="token punctuation">(</span>authUserDTO<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 调用领域服务</span>
        <span class="token comment">// 更新用户信息</span>
        <span class="token class-name">Boolean</span> res <span class="token operator">=</span> authUserDomainService<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>authUserBO<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// error日志</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"UserController update error:{}"</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token string">"更新用户信息失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="3sunclubauthdomain_1186"></a>3.sun-club-auth-domain</h5> 
<h6><a id="1AuthUserDomainServicejava_1188"></a>1.AuthUserDomainService.java</h6> 
<pre><code class="prism language-java"><span class="token comment">/**
 * 更新
 * @param authUserBO
 * @return
 */</span>
<span class="token class-name">Boolean</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">AuthUserBO</span> authUserBO<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h6><a id="2AuthUserDomainServiceImpljava_1199"></a>2.AuthUserDomainServiceImpl.java</h6> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">Boolean</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">AuthUserBO</span> authUserBO<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// BO转换为Entity</span>
    <span class="token class-name">AuthUser</span> authUser <span class="token operator">=</span> <span class="token class-name">AuthUserBOConverter</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">.</span><span class="token function">convertBO2Entity</span><span class="token punctuation">(</span>authUserBO<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 调用基础服务</span>
    <span class="token class-name">Integer</span> count <span class="token operator">=</span> authUserService<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>authUser<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 有任何的更新，都要与缓存进行同步的修改，要把当前用户的角色和权限都放到redis里</span>
    <span class="token keyword">return</span> count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="4sunclubauthinfra_1213"></a>4.sun-club-auth-infra</h5> 
<h6><a id="1AuthUserServicejava_1215"></a>1.AuthUserService.java</h6> 
<pre><code class="prism language-java"><span class="token comment">/**
 * 修改数据
 *
 * @param authUser 实例对象
 * @return 实例对象
 */</span>
<span class="token class-name">Integer</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">AuthUser</span> authUser<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h6><a id="2AuthUserServiceImpljava_1227"></a>2.AuthUserServiceImpl.java</h6> 
<pre><code class="prism language-java"><span class="token comment">/**
 * 修改数据
 *
 * @param authUser 实例对象
 * @return 实例对象
 */</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">AuthUser</span> authUser<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>authUserDao<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>authUser<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="5_1242"></a>5.测试</h5> 
<h6><a id="1_1244"></a>1.结果</h6> 
<p><img src="https://images2.imgbox.com/91/6f/GIvvErNa_o.png" alt="image-20240605171347052"></p> 
<h6><a id="2DB_1248"></a>2.DB</h6> 
<p><img src="https://images2.imgbox.com/17/a4/MVxqNqKa_o.png" alt="image-20240605171417545"></p> 
<h3><a id="4_1252"></a>4.用户模块-删除用户信息</h3> 
<h5><a id="1_1254"></a>1.接口设计</h5> 
<p><img src="https://images2.imgbox.com/87/fd/bqio5T6A_o.png" alt="image-20240605172400982"></p> 
<h5><a id="2sunclubauthapplicationcontroller_1258"></a>2.sun-club-auth-application-controller</h5> 
<h6><a id="1UserControllerjava_1260"></a>1.UserController.java</h6> 
<pre><code class="prism language-java"><span class="token comment">/**
 * 删除用户信息
 * @param authUserDTO
 * @return
 */</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"delete"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Result</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Boolean</span><span class="token punctuation">&gt;</span></span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">AuthUserDTO</span> authUserDTO<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 日志</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>log<span class="token punctuation">.</span><span class="token function">isInfoEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"UserController delete AuthUserDTO, authUserDTO:{}"</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>authUserDTO<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 参数校验</span>
        <span class="token comment">// 转换DTO为BO</span>
        <span class="token class-name">AuthUserBO</span> authUserBO <span class="token operator">=</span> <span class="token class-name">AuthUserDTOConverter</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">.</span><span class="token function">convertDTO2BO</span><span class="token punctuation">(</span>authUserDTO<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 调用领域服务</span>
        <span class="token comment">// 删除用户信息</span>
        <span class="token class-name">Boolean</span> res <span class="token operator">=</span> authUserDomainService<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>authUserBO<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// error日志</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"UserController delete error:{}"</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token string">"删除用户信息失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="3sunclubauthdomain_1290"></a>3.sun-club-auth-domain</h5> 
<h6><a id="1AuthUserDomainServicejava_1292"></a>1.AuthUserDomainService.java</h6> 
<pre><code class="prism language-java"><span class="token comment">/**
 * 删除
 * @param authUserBO
 * @return
 */</span>
<span class="token class-name">Boolean</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">AuthUserBO</span> authUserBO<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h6><a id="2AuthUserDomainServiceImpljava_1303"></a>2.AuthUserDomainServiceImpl.java</h6> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">Boolean</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">AuthUserBO</span> authUserBO<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">AuthUser</span> authUser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AuthUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 设置ID</span>
    authUser<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>authUserBO<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 设置逻辑删除</span>
    authUser<span class="token punctuation">.</span><span class="token function">setIsDeleted</span><span class="token punctuation">(</span><span class="token class-name">IsDeleteFlagEnum</span><span class="token punctuation">.</span><span class="token constant">DELETED</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 更新</span>
    <span class="token class-name">Integer</span> count <span class="token operator">=</span> authUserService<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>authUser<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="4_1319"></a>4.测试</h5> 
<h6><a id="1_1321"></a>1.结果</h6> 
<p><img src="https://images2.imgbox.com/d2/59/2us8VQXv_o.png" alt="image-20240605172530415"></p> 
<h6><a id="2DB_1325"></a>2.DB</h6> 
<p><img src="https://images2.imgbox.com/57/5b/RYY9WA8q_o.png" alt="image-20240605172553742"></p> 
<h3><a id="5_1329"></a>5.用户模块-启用/禁用信息</h3> 
<h5><a id="1_1331"></a>1.接口设计</h5> 
<p><img src="https://images2.imgbox.com/1d/77/4LZaZJaG_o.png" alt="image-20240605173355196"></p> 
<h5><a id="2UserControllerjava_1335"></a>2.UserController.java</h5> 
<pre><code class="prism language-java"><span class="token comment">/**
 * 用户启用/禁用
 * @param authUserDTO
 * @return
 */</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"changeStatus"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Result</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Boolean</span><span class="token punctuation">&gt;</span></span> <span class="token function">changeStatus</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">AuthUserDTO</span> authUserDTO<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 日志</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>log<span class="token punctuation">.</span><span class="token function">isInfoEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"UserController changeStatus AuthUserDTO, authUserDTO:{}"</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>authUserDTO<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 参数校验</span>
        <span class="token class-name">Preconditions</span><span class="token punctuation">.</span><span class="token function">checkNotNull</span><span class="token punctuation">(</span>authUserDTO<span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"用户状态不能为空"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 转换DTO为BO</span>
        <span class="token class-name">AuthUserBO</span> authUserBO <span class="token operator">=</span> <span class="token class-name">AuthUserDTOConverter</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">.</span><span class="token function">convertDTO2BO</span><span class="token punctuation">(</span>authUserDTO<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 调用领域服务</span>
        <span class="token comment">// 用户启用/禁用，直接调用更新即可</span>
        <span class="token class-name">Boolean</span> res <span class="token operator">=</span> authUserDomainService<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>authUserBO<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// error日志</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"UserController changeStatus error:{}"</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token string">"用户启用/禁用失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="3_1366"></a>3.测试</h5> 
<h6><a id="1_1368"></a>1.结果</h6> 
<p><img src="https://images2.imgbox.com/df/db/vBIMOOWU_o.png" alt="image-20240605173436856"></p> 
<h6><a id="2DB_1372"></a>2.DB</h6> 
<p><img src="https://images2.imgbox.com/70/5f/AbIP2Lui_o.png" alt="image-20240605173502549"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e4b58a9f74d0c4074064f7d55899c410/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Sun Frame：基于 SpringBoot 的轻量级开发框架（个人开源项目）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2643124f5ffdfc2c3e4ad721d9b402c1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Python 爬虫项目实战（一）：爬取某云热歌榜歌曲</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>