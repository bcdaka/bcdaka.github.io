<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>AI大模型探索之路-实战篇：智能化IT领域搜索引擎之github网站在线搜索 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/b245b1882d740ff14f229e28b5fd9fcf/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="AI大模型探索之路-实战篇：智能化IT领域搜索引擎之github网站在线搜索">
  <meta property="og:description" content="系列篇章💥 No.文章1AI大模型探索之路-实战篇：智能化IT领域搜索引擎的构建与初步实践2AI大模型探索之路-实战篇：智能化IT领域搜索引擎之GLM-4大模型技术的实践探索3AI大模型探索之路-实战篇：智能化IT领域搜索引擎之知乎网站数据获取（初步实践）4AI大模型探索之路-实战篇：智能化IT领域搜索引擎之知乎网站数据获取（函数封装）5AI大模型探索之路-实战篇：智能化IT领域搜索引擎之知乎网站数据获取（流程优化）6AI大模型探索之路-实战篇：智能化IT领域搜索引擎之github网站在线搜索7AI大模型探索之路-实战篇：智能化IT领域搜索引擎之HuggingFace网站在线搜索 目录 系列篇章💥一、前言二、总体概览三、准备工作1、网站地址排除2、获取github token 四、github基础API测试1、定义github关键词提取函数2、github资源搜索测试3、github api调用测试4、定义github readme页面获取函数5、google api搜索github测试6、封装gihub搜索查询函数 五、完整流程封装1、定义github repos地址解析函数2、定义github问题搜索函数3、定义的github答案获取函数4、定义github自动搜索函数5、外部函数信息生成测试6、定义大模型调用函数7、大模型调用测试（咨询大模型不知道的问题）8、大模型调用测试（测试大模型不知道的问题）9、大模型调用测试（测试大模型知道的问题）10、智能对话助手测试 结语 一、前言 在上一篇文章中，我们完成了知乎网站数据的智能搜索流程的代码开发。本篇章将主要实现Github网站的在线智能搜索，为用户提供更全面、准确的搜索结果。
二、总体概览 本章将逐步通过代码落地实现Github网站数据的智能搜索。我们将从获取Github token开始，逐步实现对Github项目readme文档的获取和解析，最终整合到我们的智能化IT领域搜索引擎中，为用户提供更便捷、高效的搜索服务。
三、准备工作 1、网站地址排除 排除github中不需要爬取的网页地址
2、获取github token 如何获取github这些项目的readme文档。这里我们不再需要使用爬虫，而是简单调用Github API即可获取完整的项目readme文档。而要使用Github API，则首先需要获取Github token。Github token全称为GithubPersonal Access Token，用于在调用Github时进行身份验证，其本质上就是一串字符串形式的加密密钥，也就相当于OpenAI API Key
地址：https://github.com/settings/tokens
生成token
配置到本地环境变量
四、github基础API测试 1、定义github关键词提取函数 def convert_keyword_github(q): &#34;&#34;&#34; 将用户输入的问题转化为适合在Github上进行搜索的关键词 &#34;&#34;&#34; response = client.chat.completions.create( model=&#34;glm-4&#34;, messages=[ {&#34;role&#34;: &#34;system&#34;, &#34;content&#34;: &#34;你专门负责将用户的问题转化为Github上的搜索关键词，只返回一个你认为最合适的搜索关键词即可&#34;}, {&#34;role&#34;: &#34;user&#34;, &#34;content&#34;: &#34;请问DeepSpeed是什么？&#34;}, {&#34;role&#34;: &#34;assistant&#34;, &#34;content&#34;: &#34;DeepSpeed&#34;}, {&#34;role&#34;: &#34;user&#34;, &#34;content&#34;: q} ] ) q = response.choices[0].message.content return q 函数测试">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-17T07:30:00+08:00">
    <meta property="article:modified_time" content="2024-06-17T07:30:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">AI大模型探索之路-实战篇：智能化IT领域搜索引擎之github网站在线搜索</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_2"></a>系列篇章💥</h2> 
<table><thead><tr><th align="left">No.</th><th align="left">文章</th></tr></thead><tbody><tr><td align="left">1</td><td align="left"><a href="https://xundaomalu.blog.csdn.net/article/details/139605522" rel="nofollow">AI大模型探索之路-实战篇：智能化IT领域搜索引擎的构建与初步实践</a></td></tr><tr><td align="left">2</td><td align="left"><a href="https://xundaomalu.blog.csdn.net/article/details/139652339" rel="nofollow">AI大模型探索之路-实战篇：智能化IT领域搜索引擎之GLM-4大模型技术的实践探索</a></td></tr><tr><td align="left">3</td><td align="left"><a href="https://xundaomalu.blog.csdn.net/article/details/139668701" rel="nofollow">AI大模型探索之路-实战篇：智能化IT领域搜索引擎之知乎网站数据获取（初步实践）</a></td></tr><tr><td align="left">4</td><td align="left"><a href="https://xundaomalu.blog.csdn.net/article/details/139693535" rel="nofollow">AI大模型探索之路-实战篇：智能化IT领域搜索引擎之知乎网站数据获取（函数封装）</a></td></tr><tr><td align="left">5</td><td align="left"><a href="https://xundaomalu.blog.csdn.net/article/details/139716976" rel="nofollow">AI大模型探索之路-实战篇：智能化IT领域搜索引擎之知乎网站数据获取（流程优化）</a></td></tr><tr><td align="left">6</td><td align="left"><a href="https://xundaomalu.blog.csdn.net/article/details/139727808" rel="nofollow">AI大模型探索之路-实战篇：智能化IT领域搜索引擎之github网站在线搜索</a></td></tr><tr><td align="left">7</td><td align="left">AI大模型探索之路-实战篇：智能化IT领域搜索引擎之HuggingFace网站在线搜索</td></tr></tbody></table> 
<hr> 
<p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#_2" rel="nofollow">系列篇章💥</a></li><li><a href="#_19" rel="nofollow">一、前言</a></li><li><a href="#_21" rel="nofollow">二、总体概览</a></li><li><a href="#_23" rel="nofollow">三、准备工作</a></li><li><ul><li><a href="#1_24" rel="nofollow">1、网站地址排除</a></li><li><a href="#2github_token_28" rel="nofollow">2、获取github token</a></li></ul> 
  </li><li><a href="#githubAPI_39" rel="nofollow">四、github基础API测试</a></li><li><ul><li><a href="#1github_40" rel="nofollow">1、定义github关键词提取函数</a></li><li><a href="#2github_67" rel="nofollow">2、github资源搜索测试</a></li><li><a href="#3github_api_83" rel="nofollow">3、github api调用测试</a></li><li><a href="#4github_readme_113" rel="nofollow">4、定义github readme页面获取函数</a></li><li><a href="#5google_apigithub_147" rel="nofollow">5、google api搜索github测试</a></li><li><a href="#6gihub_159" rel="nofollow">6、封装gihub搜索查询函数</a></li></ul> 
  </li><li><a href="#_175" rel="nofollow">五、完整流程封装</a></li><li><ul><li><a href="#1github_repos_176" rel="nofollow">1、定义github repos地址解析函数</a></li><li><a href="#2github_190" rel="nofollow">2、定义github问题搜索函数</a></li><li><a href="#3github_218" rel="nofollow">3、定义的github答案获取函数</a></li><li><a href="#4github_258" rel="nofollow">4、定义github自动搜索函数</a></li><li><a href="#5_274" rel="nofollow">5、外部函数信息生成测试</a></li><li><a href="#6_284" rel="nofollow">6、定义大模型调用函数</a></li><li><a href="#7_357" rel="nofollow">7、大模型调用测试（咨询大模型不知道的问题）</a></li><li><a href="#8_378" rel="nofollow">8、大模型调用测试（测试大模型不知道的问题）</a></li><li><a href="#9_387" rel="nofollow">9、大模型调用测试（测试大模型知道的问题）</a></li><li><a href="#10_398" rel="nofollow">10、智能对话助手测试</a></li></ul> 
  </li><li><a href="#_428" rel="nofollow">结语</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_19"></a>一、前言</h2> 
<p>在上一篇文章中，我们完成了知乎网站数据的智能搜索流程的代码开发。本篇章将主要实现Github网站的在线智能搜索，为用户提供更全面、准确的搜索结果。</p> 
<h2><a id="_21"></a>二、总体概览</h2> 
<p>本章将逐步通过代码落地实现Github网站数据的智能搜索。我们将从获取Github token开始，逐步实现对Github项目readme文档的获取和解析，最终整合到我们的智能化IT领域搜索引擎中，为用户提供更便捷、高效的搜索服务。</p> 
<h2><a id="_23"></a>三、准备工作</h2> 
<h3><a id="1_24"></a>1、网站地址排除</h3> 
<p>排除github中不需要爬取的网页地址<br> <img src="https://images2.imgbox.com/44/6d/jeDrFo57_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2github_token_28"></a>2、获取github token</h3> 
<p>如何获取github这些项目的readme文档。这里我们不再需要使用爬虫，而是简单调用Github API即可获取完整的项目readme文档。而要使用Github API，则首先需要获取Github token。Github token全称为GithubPersonal Access Token，用于在调用Github时进行身份验证，其本质上就是一串字符串形式的加密密钥，也就相当于OpenAI API Key<br> 地址：https://github.com/settings/tokens<br> <img src="https://images2.imgbox.com/1e/14/QuPtcuUm_o.png" alt="在这里插入图片描述"></p> 
<p>生成token<br> <img src="https://images2.imgbox.com/51/18/Qvis4ZiX_o.png" alt="在这里插入图片描述"></p> 
<p>配置到本地环境变量<br> <img src="https://images2.imgbox.com/dd/63/YWiKOOpC_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="githubAPI_39"></a>四、github基础API测试</h2> 
<h3><a id="1github_40"></a>1、定义github关键词提取函数</h3> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">convert_keyword_github</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    将用户输入的问题转化为适合在Github上进行搜索的关键词
    """</span>
    response <span class="token operator">=</span> client<span class="token punctuation">.</span>chat<span class="token punctuation">.</span>completions<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
            model<span class="token operator">=</span><span class="token string">"glm-4"</span><span class="token punctuation">,</span>
            messages<span class="token operator">=</span><span class="token punctuation">[</span>
                 <span class="token punctuation">{<!-- --></span><span class="token string">"role"</span><span class="token punctuation">:</span> <span class="token string">"system"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> <span class="token string">"你专门负责将用户的问题转化为Github上的搜索关键词，只返回一个你认为最合适的搜索关键词即可"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                 <span class="token punctuation">{<!-- --></span><span class="token string">"role"</span><span class="token punctuation">:</span> <span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> <span class="token string">"请问DeepSpeed是什么？"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                 <span class="token punctuation">{<!-- --></span><span class="token string">"role"</span><span class="token punctuation">:</span> <span class="token string">"assistant"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> <span class="token string">"DeepSpeed"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                 <span class="token punctuation">{<!-- --></span><span class="token string">"role"</span><span class="token punctuation">:</span> <span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> q<span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">)</span>
    q <span class="token operator">=</span> response<span class="token punctuation">.</span>choices<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>message<span class="token punctuation">.</span>content
    <span class="token keyword">return</span> q
</code></pre> 
<p>函数测试</p> 
<pre><code class="prism language-python">convert_keyword_github<span class="token punctuation">(</span><span class="token string">'请帮我介绍下chatglm3大模型'</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/77/5a/2F2wjDKN_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2github_67"></a>2、github资源搜索测试</h3> 
<p>通过google search API 指定搜索github上的资源信息</p> 
<pre><code class="prism language-python">google_search<span class="token punctuation">(</span>query<span class="token operator">=</span><span class="token string">'chatglm3'</span><span class="token punctuation">,</span> num_results<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> site_url<span class="token operator">=</span><span class="token string">'https://github.com/'</span><span class="token punctuation">)</span>
</code></pre> 
<p>输出</p> 
<pre><code class="prism language-python"><span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">'title'</span><span class="token punctuation">:</span> <span class="token string">'ChatGLM3/README_en.md at main · THUDM/ChatGLM3 · GitHub'</span><span class="token punctuation">,</span>
  <span class="token string">'link'</span><span class="token punctuation">:</span> <span class="token string">'https://github.com/THUDM/ChatGLM3/blob/main/README_en.md'</span><span class="token punctuation">,</span>
  <span class="token string">'snippet'</span><span class="token punctuation">:</span> <span class="token string">'More Complete Function Support: ChatGLM3-6B adopts a newly designed Prompt format, supporting multi-turn dialogues as usual. It also natively supports tool\xa0...'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token punctuation">{<!-- --></span><span class="token string">'title'</span><span class="token punctuation">:</span> <span class="token string">'THUDM/ChatGLM3: ChatGLM3 series: Open Bilingual Chat ... - GitHub'</span><span class="token punctuation">,</span>
  <span class="token string">'link'</span><span class="token punctuation">:</span> <span class="token string">'https://github.com/THUDM/ChatGLM3'</span><span class="token punctuation">,</span>
  <span class="token string">'snippet'</span><span class="token punctuation">:</span> <span class="token string">'ChatGLM3 是智谱AI和清华大学KEG 实验室联合发布的对话预训练模型。ChatGLM3-6B 是ChatGLM3 系列中的开源模型，在保留了前两代模型对话流畅、部署门槛低等众多优秀特性的\xa0...'</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
</code></pre> 
<h3><a id="3github_api_83"></a>3、github api调用测试</h3> 
<pre><code class="prism language-python"><span class="token comment">## 获取github key</span>
github_token <span class="token operator">=</span> os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">'GITHUB_TOKEN'</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> base64

owner <span class="token operator">=</span> <span class="token string">"THUDM"</span>
repo <span class="token operator">=</span> <span class="token string">"chatglm3"</span>

headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"Authorization"</span><span class="token punctuation">:</span> github_token<span class="token punctuation">,</span>
    <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> user_agent
<span class="token punctuation">}</span>

response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"https://api.github.com/repos/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>owner<span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>repo<span class="token punctuation">}</span></span><span class="token string">/readme"</span></span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>

readme_data <span class="token operator">=</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
encoded_content <span class="token operator">=</span> readme_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'content'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
decoded_content <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>encoded_content<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>decoded_content<span class="token punctuation">)</span>
</code></pre> 
<p>输出<br> <img src="https://images2.imgbox.com/bc/6b/PyTbOgPU_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4github_readme_113"></a>4、定义github readme页面获取函数</h3> 
<p>基于github提供的API，定义封装一个github readme页面数据获取的函数</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">get_github_readme</span><span class="token punctuation">(</span>dic<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    github_token <span class="token operator">=</span> os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">'GITHUB_TOKEN'</span><span class="token punctuation">)</span>
    user_agent <span class="token operator">=</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36"</span>
    
    owner <span class="token operator">=</span> dic<span class="token punctuation">[</span><span class="token string">'owner'</span><span class="token punctuation">]</span>
    repo <span class="token operator">=</span> dic<span class="token punctuation">[</span><span class="token string">'repo'</span><span class="token punctuation">]</span>

    headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">"Authorization"</span><span class="token punctuation">:</span> github_token<span class="token punctuation">,</span>
        <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> user_agent
    <span class="token punctuation">}</span>

    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"https://api.github.com/repos/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>owner<span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>repo<span class="token punctuation">}</span></span><span class="token string">/readme"</span></span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>

    readme_data <span class="token operator">=</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
    encoded_content <span class="token operator">=</span> readme_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'content'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
    decoded_content <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>encoded_content<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> decoded_content
</code></pre> 
<p>函数测试</p> 
<pre><code class="prism language-python">dic <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'owner'</span><span class="token punctuation">:</span> <span class="token string">'THUDM'</span><span class="token punctuation">,</span> <span class="token string">'repo'</span><span class="token punctuation">:</span> <span class="token string">'chatglm3'</span><span class="token punctuation">}</span>
get_github_readme<span class="token punctuation">(</span>dic<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/dd/63/BhmS9ffT_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="5google_apigithub_147"></a>5、google api搜索github测试</h3> 
<p>检查分析google api搜索github数据内容</p> 
<pre><code class="prism language-python">search_results<span class="token operator">=</span>google_search<span class="token punctuation">(</span>query<span class="token operator">=</span><span class="token string">'chatglm3'</span><span class="token punctuation">,</span> num_results<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> site_url<span class="token operator">=</span><span class="token string">'https://github.com/'</span><span class="token punctuation">)</span>
search_results
</code></pre> 
<p><img src="https://images2.imgbox.com/45/4f/U1ZZrd5I_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>我们发现，GitHub上的项目主页网址的基本结构是<code>https://api.github.com/repos/{owner}/{repo}/readme </code>。其中owner就是项目的拥有者，而repo则是对应某个项目在Github上的名称。具体，如果我们希望在谷歌搜索获得的连接中进行逐个的readme获取，则首先需要筛选搜索结果中的项目主页链接，并且从中解析出每个连接的owner和repo</p> 
</blockquote> 
<h3><a id="6gihub_159"></a>6、封装gihub搜索查询函数</h3> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">extract_github_repos</span><span class="token punctuation">(</span>search_results<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 使用列表推导式筛选出项目主页链接</span>
    repo_links <span class="token operator">=</span> <span class="token punctuation">[</span>result<span class="token punctuation">[</span><span class="token string">'link'</span><span class="token punctuation">]</span> <span class="token keyword">for</span> result <span class="token keyword">in</span> search_results <span class="token keyword">if</span> <span class="token string">'/issues/'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> result<span class="token punctuation">[</span><span class="token string">'link'</span><span class="token punctuation">]</span> <span class="token keyword">and</span> <span class="token string">'/blob/'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> result<span class="token punctuation">[</span><span class="token string">'link'</span><span class="token punctuation">]</span> <span class="token keyword">and</span> <span class="token string">'github.com'</span> <span class="token keyword">in</span> result<span class="token punctuation">[</span><span class="token string">'link'</span><span class="token punctuation">]</span> <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token string">'link'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">]</span>

    <span class="token comment"># 从筛选后的链接中提取owner和repo</span>
    repos_info <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">'owner'</span><span class="token punctuation">:</span> link<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'repo'</span><span class="token punctuation">:</span> link<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">}</span> <span class="token keyword">for</span> link <span class="token keyword">in</span> repo_links<span class="token punctuation">]</span>

    <span class="token keyword">return</span> repos_info

repos_info <span class="token operator">=</span> extract_github_repos<span class="token punctuation">(</span>search_results<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>repos_info<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="_175"></a>五、完整流程封装</h2> 
<h3><a id="1github_repos_176"></a>1、定义github repos地址解析函数</h3> 
<p>从链接地址中提取owner和repo</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">extract_github_repos</span><span class="token punctuation">(</span>search_results<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 使用列表推导式筛选出项目主页链接</span>
    repo_links <span class="token operator">=</span> <span class="token punctuation">[</span>result<span class="token punctuation">[</span><span class="token string">'link'</span><span class="token punctuation">]</span> <span class="token keyword">for</span> result <span class="token keyword">in</span> search_results <span class="token keyword">if</span> <span class="token string">'/issues/'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> result<span class="token punctuation">[</span><span class="token string">'link'</span><span class="token punctuation">]</span> <span class="token keyword">and</span> <span class="token string">'/blob/'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> result<span class="token punctuation">[</span><span class="token string">'link'</span><span class="token punctuation">]</span> <span class="token keyword">and</span> <span class="token string">'github.com'</span> <span class="token keyword">in</span> result<span class="token punctuation">[</span><span class="token string">'link'</span><span class="token punctuation">]</span> <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token string">'link'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">]</span>

    <span class="token comment"># 从筛选后的链接中提取owner和repo</span>
    repos_info <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">'owner'</span><span class="token punctuation">:</span> link<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'repo'</span><span class="token punctuation">:</span> link<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">}</span> <span class="token keyword">for</span> link <span class="token keyword">in</span> repo_links<span class="token punctuation">]</span>

    <span class="token keyword">return</span> repos_info
</code></pre> 
<h3><a id="2github_190"></a>2、定义github问题搜索函数</h3> 
<p>将搜索到的内容保存到本地磁盘</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">get_search_text_github</span><span class="token punctuation">(</span>q<span class="token punctuation">,</span> dic<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    title <span class="token operator">=</span> dic<span class="token punctuation">[</span><span class="token string">'owner'</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'_'</span> <span class="token operator">+</span> dic<span class="token punctuation">[</span><span class="token string">'repo'</span><span class="token punctuation">]</span>
    title <span class="token operator">=</span> windows_create_name<span class="token punctuation">(</span>title<span class="token punctuation">)</span>

    <span class="token comment"># 创建问题答案正文</span>
    text <span class="token operator">=</span> get_github_readme<span class="token punctuation">(</span>dic<span class="token punctuation">)</span>

    <span class="token comment"># 写入本地json文件</span>
    encoding <span class="token operator">=</span> tiktoken<span class="token punctuation">.</span>encoding_for_model<span class="token punctuation">(</span><span class="token string">"gpt-3.5-turbo"</span><span class="token punctuation">)</span>     
    json_data <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string">"title"</span><span class="token punctuation">:</span> title<span class="token punctuation">,</span>
            <span class="token string">"content"</span><span class="token punctuation">:</span> text<span class="token punctuation">,</span>
            <span class="token string">"tokens"</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>encoding<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>

    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./auto_search/%s/%s.json'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>q<span class="token punctuation">,</span> title<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>json_data<span class="token punctuation">,</span> f<span class="token punctuation">)</span>

    <span class="token keyword">return</span> title
</code></pre> 
<h3><a id="3github_218"></a>3、定义的github答案获取函数</h3> 
<p>最外层的github查询函数，整理查询的网页数据内容</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">get_answer_github</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    智能助手函数，当你无法回答某个问题时，调用该函数，能够获得答案
    :param q: 必选参数，询问的问题，字符串类型对象
    :return：某问题的答案，以字符串形式呈现
    """</span>
    <span class="token comment"># 调用转化函数，将用户的问题转化为更适合在GitHub上搜索的关键词</span>
    q <span class="token operator">=</span> convert_keyword_github<span class="token punctuation">(</span>q<span class="token punctuation">)</span>
    
    <span class="token comment"># 默认搜索返回10个答案</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'正在接入谷歌搜索，查找和问题相关的答案...'</span><span class="token punctuation">)</span>
    search_results <span class="token operator">=</span> google_search<span class="token punctuation">(</span>query<span class="token operator">=</span>q<span class="token punctuation">,</span> num_results<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> site_url<span class="token operator">=</span><span class="token string">'https://github.com/'</span><span class="token punctuation">)</span>
    results <span class="token operator">=</span> extract_github_repos<span class="token punctuation">(</span>search_results<span class="token punctuation">)</span>
    
    <span class="token comment"># 创建对应问题的子文件夹</span>
    folder_path <span class="token operator">=</span> <span class="token string">'./auto_search/%s'</span> <span class="token operator">%</span> q
    <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>folder_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
        os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>folder_path<span class="token punctuation">)</span>
    
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'正在读取搜索的到的相关答案...'</span><span class="token punctuation">)</span>
    num_tokens <span class="token operator">=</span> <span class="token number">0</span>
    content <span class="token operator">=</span> <span class="token string">''</span>
    
    <span class="token keyword">for</span> dic <span class="token keyword">in</span> results<span class="token punctuation">:</span>
        title <span class="token operator">=</span> get_search_text_github<span class="token punctuation">(</span>q<span class="token punctuation">,</span> dic<span class="token punctuation">)</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./auto_search/%s/%s.json'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>q<span class="token punctuation">,</span> title<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            jd <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
        num_tokens <span class="token operator">+=</span> jd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'tokens'</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> num_tokens <span class="token operator">&lt;=</span> <span class="token number">12000</span><span class="token punctuation">:</span>
            content <span class="token operator">+=</span> jd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'content'</span><span class="token punctuation">]</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'正在进行最后的整理...'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="4github_258"></a>4、定义github自动搜索函数</h3> 
<p>基于判别模型，自动判断是否需要调用大模型工具函数获取</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">auto_search_answer_github</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 调用判别模型</span>
    res <span class="token operator">=</span> identify_model<span class="token punctuation">(</span>q<span class="token punctuation">)</span>
    <span class="token keyword">if</span> res <span class="token operator">==</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        messages <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">"role"</span><span class="token punctuation">:</span> <span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> q<span class="token punctuation">}</span><span class="token punctuation">]</span>
        res <span class="token operator">=</span>run_conversation<span class="token punctuation">(</span>messages<span class="token operator">=</span>messages<span class="token punctuation">,</span> 
                              functions_list<span class="token operator">=</span><span class="token punctuation">[</span>get_answer_github<span class="token punctuation">]</span><span class="token punctuation">,</span> 
                              model<span class="token operator">=</span><span class="token string">"glm-4"</span><span class="token punctuation">,</span> 
                              function_call<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"function"</span><span class="token punctuation">,</span> <span class="token string">"function"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"get_answer_github"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="5_274"></a>5、外部函数信息生成测试</h3> 
<pre><code class="prism language-python">functions_list<span class="token operator">=</span><span class="token punctuation">[</span>get_answer_github<span class="token punctuation">]</span>
tools<span class="token operator">=</span>auto_functions<span class="token punctuation">(</span>functions_list<span class="token punctuation">)</span>
tools
</code></pre> 
<p>输出<br> <img src="https://images2.imgbox.com/5c/c0/LaAqwRW1_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="6_284"></a>6、定义大模型调用函数</h3> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">run_conversation</span><span class="token punctuation">(</span>messages<span class="token punctuation">,</span> functions_list<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> model<span class="token operator">=</span><span class="token string">"glm-4"</span><span class="token punctuation">,</span> function_call<span class="token operator">=</span><span class="token string">"auto"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    能够自动执行外部函数调用的对话模型
    :param messages: 必要参数，字典类型，输入到Chat模型的messages参数对象
    :param functions_list: 可选参数，默认为None，可以设置为包含全部外部函数的列表对象
    :param model: Chat模型，可选参数，默认模型为glm-4
    :return：Chat模型输出结果
    """</span>
    <span class="token comment"># 如果没有外部函数库，则执行普通的对话任务</span>
    <span class="token keyword">if</span> functions_list <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        response <span class="token operator">=</span> client<span class="token punctuation">.</span>chat<span class="token punctuation">.</span>completions<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
                        model<span class="token operator">=</span>model<span class="token punctuation">,</span>
                        messages<span class="token operator">=</span>messages<span class="token punctuation">,</span>
                        <span class="token punctuation">)</span>
        response_message <span class="token operator">=</span> response<span class="token punctuation">.</span>choices<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>message
        final_response <span class="token operator">=</span> response_message<span class="token punctuation">.</span>content
        
    <span class="token comment"># 若存在外部函数库，则需要灵活选取外部函数并进行回答</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token comment"># 创建functions对象</span>
        tools <span class="token operator">=</span> auto_functions<span class="token punctuation">(</span>functions_list<span class="token punctuation">)</span>

        <span class="token comment"># 创建外部函数库字典</span>
        available_functions <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>func<span class="token punctuation">.</span>__name__<span class="token punctuation">:</span> func <span class="token keyword">for</span> func <span class="token keyword">in</span> functions_list<span class="token punctuation">}</span>

        <span class="token comment"># 第一次调用大模型</span>
        response <span class="token operator">=</span> client<span class="token punctuation">.</span>chat<span class="token punctuation">.</span>completions<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
                        model<span class="token operator">=</span>model<span class="token punctuation">,</span>
                        messages<span class="token operator">=</span>messages<span class="token punctuation">,</span>
                        tools<span class="token operator">=</span>tools<span class="token punctuation">,</span>
                        tool_choice<span class="token operator">=</span>function_call<span class="token punctuation">,</span> <span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span>
        
        response_message <span class="token operator">=</span> response<span class="token punctuation">.</span>choices<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>message


        tool_calls <span class="token operator">=</span> response_message<span class="token punctuation">.</span>tool_calls

        <span class="token keyword">if</span> tool_calls<span class="token punctuation">:</span>

            <span class="token comment">#messages.append(response_message)</span>
            messages<span class="token punctuation">.</span>append<span class="token punctuation">(</span>response<span class="token punctuation">.</span>choices<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>message<span class="token punctuation">.</span>model_dump<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> tool_call <span class="token keyword">in</span> tool_calls<span class="token punctuation">:</span>
                function_name <span class="token operator">=</span> tool_call<span class="token punctuation">.</span>function<span class="token punctuation">.</span>name
                function_to_call <span class="token operator">=</span> available_functions<span class="token punctuation">[</span>function_name<span class="token punctuation">]</span>
                function_args <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>tool_call<span class="token punctuation">.</span>function<span class="token punctuation">.</span>arguments<span class="token punctuation">)</span>
                <span class="token comment">## 真正执行外部函数的就是这儿的代码</span>
                function_response <span class="token operator">=</span> function_to_call<span class="token punctuation">(</span><span class="token operator">**</span>function_args<span class="token punctuation">)</span>
                messages<span class="token punctuation">.</span>append<span class="token punctuation">(</span>
                    <span class="token punctuation">{<!-- --></span>
                        <span class="token string">"role"</span><span class="token punctuation">:</span> <span class="token string">"tool"</span><span class="token punctuation">,</span>
                        <span class="token string">"content"</span><span class="token punctuation">:</span> function_response<span class="token punctuation">,</span>
                        <span class="token string">"tool_call_id"</span><span class="token punctuation">:</span> tool_call<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">)</span> 
            <span class="token comment">## 第二次调用模型</span>
            second_response <span class="token operator">=</span> client<span class="token punctuation">.</span>chat<span class="token punctuation">.</span>completions<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
                model<span class="token operator">=</span>model<span class="token punctuation">,</span>
                messages<span class="token operator">=</span>messages<span class="token punctuation">,</span>
                tools<span class="token operator">=</span>tools
            <span class="token punctuation">)</span> 
            <span class="token comment"># 获取最终结果</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>second_response<span class="token punctuation">.</span>choices<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>message<span class="token punctuation">)</span>
            final_response <span class="token operator">=</span> second_response<span class="token punctuation">.</span>choices<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>message<span class="token punctuation">.</span>content
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            final_response <span class="token operator">=</span> response_message<span class="token punctuation">.</span>content
                
    <span class="token keyword">return</span> final_response
</code></pre> 
<h3><a id="7_357"></a>7、大模型调用测试（咨询大模型不知道的问题）</h3> 
<pre><code class="prism language-python">messages <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">"role"</span><span class="token punctuation">:</span> <span class="token string">"system"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> <span class="token string">"对于知道的问题直接回答，不知道的问题，通过调用智能助手函数解答"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span><span class="token string">"role"</span><span class="token punctuation">:</span> <span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> <span class="token string">"介绍一下github上面的open-interpreter项目"</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
res <span class="token operator">=</span>run_conversation<span class="token punctuation">(</span>messages<span class="token operator">=</span>messages<span class="token punctuation">,</span> 
                              functions_list<span class="token operator">=</span><span class="token punctuation">[</span>get_answer_github<span class="token punctuation">]</span><span class="token punctuation">,</span> 
                              model<span class="token operator">=</span><span class="token string">"glm-4"</span><span class="token punctuation">,</span> 
                              function_call<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"function"</span><span class="token punctuation">,</span> <span class="token string">"function"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"get_answer_github"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
</code></pre> 
<p>输出：</p> 
<pre><code class="prism language-python">model<span class="token operator">=</span><span class="token string">'glm-4'</span> created<span class="token operator">=</span><span class="token number">1713412953</span> choices<span class="token operator">=</span><span class="token punctuation">[</span>CompletionChoice<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> finish_reason<span class="token operator">=</span><span class="token string">'tool_calls'</span><span class="token punctuation">,</span> message<span class="token operator">=</span>CompletionMessage<span class="token punctuation">(</span>content<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> role<span class="token operator">=</span><span class="token string">'assistant'</span><span class="token punctuation">,</span> tool_calls<span class="token operator">=</span><span class="token punctuation">[</span>CompletionMessageToolCall<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token string">'call_8578779325093105020'</span><span class="token punctuation">,</span> function<span class="token operator">=</span>Function<span class="token punctuation">(</span>arguments<span class="token operator">=</span><span class="token string">'{"q":"介绍一下github上面的open-interpreter项目"}'</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'get_answer_github'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'function'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> request_id<span class="token operator">=</span><span class="token string">'8578779325093105020'</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token string">'8578779325093105020'</span> usage<span class="token operator">=</span>CompletionUsage<span class="token punctuation">(</span>prompt_tokens<span class="token operator">=</span><span class="token number">142</span><span class="token punctuation">,</span> completion_tokens<span class="token operator">=</span><span class="token number">22</span><span class="token punctuation">,</span> total_tokens<span class="token operator">=</span><span class="token number">164</span><span class="token punctuation">)</span>
正在接入谷歌搜索，查找和问题相关的答案<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
正在读取搜索的到的相关答案<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
正在进行最后的整理<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
content<span class="token operator">=</span><span class="token string">'Open Interpreter是一个开源项目，它允许大型语言模型（LLM）在本地运行代码，支持Python、JavaScript、Shell等多种语言。通过自然语言界面，用户可以与计算机进行交互，执行各种任务，如创建和编辑图片、控制Chrome浏览器进行搜索、绘制和分析大型数据集等。Open Interpreter在执行代码前会要求用户确认，以避免潜在的安全风险。与ChatGPT的代码解释器相比，Open Interpreter运行在本地环境中，具有更广泛的功能和更高的灵活性。'</span> role<span class="token operator">=</span><span class="token string">'assistant'</span> tool_calls<span class="token operator">=</span><span class="token boolean">None</span>
Open Interpreter是一个开源项目，它允许大型语言模型（LLM）在本地运行代码，支持Python、JavaScript、Shell等多种语言。通过自然语言界面，用户可以与计算机进行交互，执行各种任务，如创建和编辑图片、控制Chrome浏览器进行搜索、绘制和分析大型数据集等。Open Interpreter在执行代码前会要求用户确认，以避免潜在的安全风险。与ChatGPT的代码解释器相比，Open Interpreter运行在本地环境中，具有更广泛的功能和更高的灵活性。
</code></pre> 
<h3><a id="8_378"></a>8、大模型调用测试（测试大模型不知道的问题）</h3> 
<pre><code class="prism language-python"><span class="token comment">## 测试：网上随意找的一个项目：https://github.com/google/grafika</span>
auto_search_answer_github<span class="token punctuation">(</span><span class="token string">'介绍一下github上面的Grafika项目，这个项目是Google发布的'</span><span class="token punctuation">)</span>
</code></pre> 
<p>输出：<br> <img src="https://images2.imgbox.com/27/64/f6IxZCp2_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="9_387"></a>9、大模型调用测试（测试大模型知道的问题）</h3> 
<pre><code class="prism language-python">auto_search_answer_github<span class="token punctuation">(</span><span class="token string">'介绍一下github上面的DB-GPT项目'</span><span class="token punctuation">)</span>
</code></pre> 
<p>输出</p> 
<blockquote> 
 <p>‘DB-GPT是一个基于数据库的开源GPT实验项目，旨在通过结合大型语言模型和数据库技术，实现在本地环境下对数据的自然语言查询和处理。这个项目的主要目的是解决在使用大模型时面临的数据安全和隐私问题。\n\n根据提供的参考信息，DB-GPT项目具有以下特点：\n\n1.<br> <strong>本地部署</strong>：支持在个人设备或本地服务器上部署，可以在没有互联网连接的情况下运行，确保数据不会离开执行环境。\n\n2. <strong>数据安全和隐私保护</strong>：通过代理和插件机制优化数据驱动引擎，使用去标识化技术来保护用户隐私。\n\n3. <strong>架构设计</strong>：DB-GPT的系统架构包括检索器组件、重排器、语言模型处理精炼信息等，确保身份安全，并生成响应。\n\n4. <strong>多源知识库</strong>：系统可以使用来自数据库、网页、PDF文件等多个来源的信息。\n\n5. <strong>插件模式</strong>：原生支持Auto-GPT插件，以及其他代理，如AIOps代理、SQL代理和商业分析代理，以便与不同类型的数据和服务接口。\n\n6.<br> <strong>核心能力</strong>：支持知识库的构建与处理，使用FastChat构建大模型运行环境，以vicuna作为基础的大语言模型，并通过langchain提供私域知识库问答能力。\n\n项目的代码和文档在GitHub上开放，地址为：<a href="https://github.com/eosphoros-ai/DB-GPT">https://github.com/eosphoros-ai/DB-GPT</a>。\n\nDB-GPT项目的目标是简化围绕数据库的大模型应用构建，同时保证数据处理的安全性和可控性。这对于需要在保护数据隐私和安全的条件下使用大模型的企业和组织来说，是一个非常吸引人的解决方案。’</p> 
</blockquote> 
<h3><a id="10_398"></a>10、智能对话助手测试</h3> 
<p>基于github搜索实现一个智能对话助手</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">chat_with_model</span><span class="token punctuation">(</span>functions_list<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> 
                    prompt<span class="token operator">=</span><span class="token string">"你好"</span><span class="token punctuation">,</span> 
                    model<span class="token operator">=</span><span class="token string">"glm-4"</span><span class="token punctuation">,</span> 
                    system_message<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">"role"</span><span class="token punctuation">:</span> <span class="token string">"system"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> <span class="token string">"你是小智助手。"</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    messages <span class="token operator">=</span> system_message
    messages<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"role"</span><span class="token punctuation">:</span> <span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> prompt<span class="token punctuation">}</span><span class="token punctuation">)</span>
    
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>           
        answer <span class="token operator">=</span> run_conversation<span class="token punctuation">(</span>messages<span class="token operator">=</span>messages<span class="token punctuation">,</span> 
                              functions_list<span class="token operator">=</span>functions_list<span class="token punctuation">,</span> 
                              model<span class="token operator">=</span>model<span class="token punctuation">,</span> 
                              function_call<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"function"</span><span class="token punctuation">,</span> <span class="token string">"function"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"get_answer_github"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"智能助手回答: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>answer<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        
        <span class="token comment"># 询问用户是否还有其他问题</span>
        user_input <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"您还有其他问题吗？(输入退出以结束对话): "</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> user_input <span class="token operator">==</span> <span class="token string">"退出"</span><span class="token punctuation">:</span>
            <span class="token keyword">break</span>

        <span class="token comment"># 记录用户回答</span>
        messages<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"role"</span><span class="token punctuation">:</span> <span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> user_input<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="_428"></a>结语</h2> 
<p>随着本章的结束，我们已经成功实现了Github网站数据的智能搜索，并将其整合到了我们的智能化IT领域搜索引擎中。这一成果不仅提升了搜索引擎的数据覆盖范围和准确性，也为后续的开发工作奠定了坚实的基础。然而，我们仍需认识到，搜索引擎的优化和升级是一个持续不断的过程。因此，在接下来的工作中，我们将完成HuggingFace网站搜索的接入。</p> 
<p><img src="https://images2.imgbox.com/e7/55/kBSVt3k6_o.png" alt="在这里插入图片描述"></p> 
<p>🎯🔖更多专栏系列文章：<a href="https://blog.csdn.net/xiaobing259/category_12628007.html?spm=1001.2014.3001.5482"><strong>AIGC-AI大模型探索之路</strong></a></p> 
<blockquote> 
 <p>😎 <strong>作者介绍</strong>：我是寻道AI小兵，资深程序老猿，从业10年+、互联网系统架构师，目前专注于AIGC的探索。<br> 📖 <strong>技术交流</strong>：建立有技术交流群，可以扫码👇 加入社群，500本各类编程书籍、AI教程、AI工具等你领取！<br> <strong>如果文章内容对您有所触动，别忘了<font color="red"><strong>点赞、⭐关注，收藏</strong></font>！加入我，让我们携手同行AI的探索之旅，一起开启智能时代的大门！</strong></p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bcc6eaea3cc0c353440e397e45f46ca0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python GUI开发: tkinter事件处理的几种方式详解与应用实战</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9a8971e79d98d63cdc3ca7f9c4c2d4ef/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【C/C&#43;&#43;】【学生成绩管理系统】深度剖析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>