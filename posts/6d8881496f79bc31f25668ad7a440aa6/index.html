<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>springAI框架学习总结 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/6d8881496f79bc31f25668ad7a440aa6/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="springAI框架学习总结">
  <meta property="og:description" content="springAI 1.springAI基本介绍 springAI是一个AI工程应用框架，其目标是将 Spring 生态系统设计原则（例如可移植性和模块化设计）应用于 AI 领域，并推广使用 POJO 作为 AI 领域应用程序的构建块。
2.特性 灵活的AIP支持chat,text-to-image, and Embedding models。支持同步和stream API。向下可以接入特定的模型。
Chat Models
OpenAI
Azure Open AI
Amazon Bedrock
Cohere&#39;s Command
AI21 Labs&#39; Jurassic-2
Meta&#39;s LLama 2
Amazon&#39;s Titan
Google Vertex AI Palm
Google Gemini
HuggingFace - access thousands of models, including those from Meta such as Llama2
Ollama - run AI models on your local machine
MistralAI
Text-to-image Models
OpenAI with DALL-E">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-06T08:52:49+08:00">
    <meta property="article:modified_time" content="2024-05-06T08:52:49+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">springAI框架学习总结</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>springAI</h2> 
<h3>1.springAI基本介绍</h3> 
<p>springAI是一个AI工程应用框架，其目标是将 Spring 生态系统设计原则（例如可移植性和模块化设计）应用于 AI 领域，并推广使用 POJO 作为 AI 领域应用程序的构建块。</p> 
<h3>2.特性</h3> 
<p>灵活的AIP支持chat,text-to-image, and Embedding models。支持同步和stream API。向下可以接入特定的模型。</p> 
<p><strong>Chat Models</strong></p> 
<ul><li> <p>OpenAI</p> </li><li> <p>Azure Open AI</p> </li><li> <p>Amazon Bedrock</p> 
  <ul><li> <p>Cohere's Command</p> </li><li> <p>AI21 Labs' Jurassic-2</p> </li><li> <p>Meta's LLama 2</p> </li><li> <p>Amazon's Titan</p> </li></ul></li><li> <p>Google Vertex AI Palm</p> </li><li> <p>Google Gemini</p> </li><li> <p>HuggingFace - access thousands of models, including those from Meta such as Llama2</p> </li><li> <p>Ollama - run AI models on your local machine</p> </li><li> <p>MistralAI</p> </li></ul> 
<p><strong>Text-to-image Models</strong></p> 
<ul><li> <p>OpenAI with DALL-E</p> </li><li> <p>StabilityAI</p> </li></ul> 
<p><strong>Transcription (audio to text) Models</strong></p> 
<ul><li> <p>OpenAI</p> </li></ul> 
<p><strong>Embedding Models</strong></p> 
<ul><li> <p>OpenAI</p> </li><li> <p>Azure OpenAI</p> </li><li> <p>Ollama</p> </li><li> <p>ONNX</p> </li><li> <p>PostgresML</p> </li></ul> 
<p></p> 
<ul><li> <p>Bedrock Cohere</p> </li><li> <p>Bedrock Titan</p> </li><li> <p>Google VertexAI</p> </li><li> <p>Mistal AI</p> </li></ul> 
<p></p> 
<p>灵活的提供了多个厂商的向量存储API.</p> 
<p><strong>Vector Databases</strong></p> 
<ul><li> <p>Azure Vector Search</p> </li><li> <p>Chroma</p> </li><li> <p>Milvus</p> </li><li> <p>Neo4j</p> </li><li> <p>PostgreSQL/PGVector</p> </li><li> <p>PineCone</p> </li><li> <p>Redis</p> </li><li> <p>Weaviate</p> </li><li> <p>Qdrant</p> </li></ul> 
<p></p> 
<p>为 AI Models and Vector Stores提供了<strong>Spring Boot Auto Configuration and Starters</strong> .</p> 
<p></p> 
<p>支持以下模型：</p> 
<ul><li> <p>OpenAI</p> </li><li> <p>Azure OpenAI</p> </li><li> <p>VertexAI</p> </li><li> <p>Mistral AI</p> </li></ul> 
<p>支持的模型供应商：</p> 
<ul><li> <p>OpenAI</p> </li><li> <p>Microsoft,</p> </li><li> <p>Amazon,</p> </li><li> <p>Google</p> </li><li> <p>and Huggingface</p> </li></ul> 
<p>提供数据工程ETL框架：</p> 
<ul><li> <p>核心功能是促进使用向量存储将文档传输到模型提供者。 ETL 框架基于 Java 函数式编程概念，可帮助您将多个步骤链接在一起。</p> </li><li> <p>支持读取各种格式的文档，包括 PDF、JSON 等。</p> </li><li> <p>允许进行数据操作以满足需求。涉及分割文档以遵守上下文窗口限制，并使用关键字增强其以提高文档检索效率。</p> </li><li> <p>处理后的文档存储在矢量数据库中，以便将来检索。</p> </li></ul> 
<p></p> 
<p><img alt="" height="754" src="https://images2.imgbox.com/d3/a7/b1uw6Btj_o.png" width="1200"></p> 
<p><img alt="" height="315" src="https://images2.imgbox.com/15/ac/cbx5lmUN_o.png" width="1200"></p> 
<p><a href="https://github.com/open-webui/open-webui" title="https://github.com/open-webui/open-webui">https://github.com/open-webui/open-webui</a></p> 
<p><a href="https://www.bilibili.com/video/BV1d1421d7Fy?p=58&amp;vd_source=51c993d69874e13d552c1b91dbf90aec" rel="nofollow" title="058 Docker运行Open WebUI拉取镜像_哔哩哔哩_bilibili">058 Docker运行Open WebUI拉取镜像_哔哩哔哩_bilibili</a></p> 
<p></p> 
<p></p> 
<h3>3.springAI框架使用搭建</h3> 
<p>参考文档：</p> 
<p><a href="https://docs.spring.io/spring-cli/reference/installation.html" rel="nofollow" title="Installation :: Spring Cli">Installation :: Spring Cli</a></p> 
<p><a href="https://spring.io/projects/spring-ai#overview" rel="nofollow" title="Spring AI">Spring AI</a></p> 
<p><a href="https://docs.spring.io/spring-ai/reference/" rel="nofollow" title="Spring AI :: Spring AI Reference">Spring AI :: Spring AI Reference</a></p> 
<p><a href="https://docs.spring.io/spring-ai/reference/getting-started.html" rel="nofollow" title="Getting Started :: Spring AI Reference">Getting Started :: Spring AI Reference</a></p> 
<p></p> 
<p></p> 
<p>Spring AI 中的类：</p> 
<ul><li> <p>DocumentReader：一个 Java 功能接口，负责从数据源加载 List&lt;Document&gt;。 常见的数据源有 PDF、Markdown 和 JSON。</p> </li><li> <p>Document：数据源的基于文本的表示形式，还包含用于描述内容的元数据。</p> </li><li> <p>DocumentTransformer：负责以各种方式处理数据（例如，将文档分割成更小的部分或向文档添加额外的元数据）。</p> </li><li> <p>DocumentWriter：允许您将文档保存到数据库中（最常见的是在 AI 堆栈中，矢量数据库）。</p> </li><li> <p>Embedding：将数据表示为 List&lt;Double&gt;，矢量数据库使用它来计算用户查询与相关文档的“相似度”。</p> </li></ul> 
<p></p> 
<p>在矢量数据库中，查询与传统的关系数据库不同。 他们执行相似性搜索，而不是精确匹配。 当给定向量作为查询时，向量数据库返回与查询向量“相似”的向量。 矢量数据库用于将您的数据与 AI 模型集成。 使用它们的第一步是将数据加载到矢量数据库中。 然后，当用户查询要发送到人工智能模型时，首先检索一组相似的文档。 然后，这些文档将作为用户问题的上下文，并与用户的查询一起发送到人工智能模型。 该技术称为检索增强生成（RAG）。</p> 
<p></p> 
<p><strong>评估AI模型响应</strong> ： 一种方法涉及呈现用户的请求和人工智能模型对模型的响应，查询响应是否与提供的数据一致。</p> 
<p>利用矢量数据库中存储的信息作为补充数据可以增强评估过程，有助于确定响应相关性。</p> 
<p>Spring AI 项目当前提供了一些非常基本的示例，说明如何以提示的形式评估响应以包含在 JUnit 测试中。</p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p><strong>step1 下载安装spring cli工具</strong> <a href="https://github.com/spring-projects/spring-cli/releases" title="https://github.com/spring-projects/spring-cli/releases">https://github.com/spring-projects/spring-cli/releases</a></p> 
<p><strong>step2.创建myai工程</strong></p> 
<p>spring boot new --from ai --name myai</p> 
<p><strong>step3.创建openAI账户，获取api key并配置其于项目工程</strong></p> 
<p></p> 
<p>获取apikey</p> 
<p><a href="https://platform.openai.com/api-keys" rel="nofollow" title="https://platform.openai.com/api-keys">https://platform.openai.com/api-keys</a></p> 
<p></p> 
<p><a href="https://api.xty.app/token" rel="nofollow" title="New API">New API</a></p> 
<p><img alt="" height="781" src="https://images2.imgbox.com/33/96/zueIJEqg_o.png" width="1200"></p> 
<p>配置api key</p> 
<p><img alt="" height="362" src="https://images2.imgbox.com/3b/87/WYc2jDkL_o.png" width="1200"></p> 
<p><strong>step4.运行myai工程</strong></p> 
<p><strong>step5.访问工程：</strong></p> 
<p>curl localhost:8080/ai/simple</p> 
<p>参考代码：<a href="https://github.com/rd-1-2022/ai-openai-helloworld/tree/main" title="https://github.com/rd-1-2022/ai-openai-helloworld/tree/main">https://github.com/rd-1-2022/ai-openai-helloworld/tree/main</a></p> 
<p>注意：可能因为网络无法访问，需自行解决</p> 
<p></p> 
<p></p> 
<p></p> 
<p><a href="https://www.bilibili.com/video/BV1Wz421k71w/?spm_id_from=333.1007.tianma.1-2-2.click&amp;vd_source=51c993d69874e13d552c1b91dbf90aec" rel="nofollow" title="Spring AI整合OpenAI和Ollama本地大模型_哔哩哔哩_bilibili">Spring AI整合OpenAI和Ollama本地大模型_哔哩哔哩_bilibili</a></p> 
<p></p> 
<p>ollama</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/22/71/Gg5tXV0a_o.png" width="1200"></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/d2/6f/N7b73kCf_o.png" width="1200"></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/e0/76/M7aGStrJ_o.png" width="1200"></p> 
<p><img alt="" height="770" src="https://images2.imgbox.com/02/c2/CV8Rw72V_o.png" width="1200"></p> 
<h3>   4. springAI API</h3> 
<ul><li> <p>chat completion API(openAI/Ollama/huggingface/google vertexAI)</p> </li><li> <p>Embeddings API (openAI/ollama/google vertexAI/Transformer(ONNX)) EmbeddingClient 界面旨在与 AI 和机器学习中的嵌入模型直接集成。 其主要功能是将文本转换为数值向量，通常称为嵌入。 这些嵌入对于语义分析和文本分类等各种任务至关重要。</p> <p>EmbeddingClient 界面的设计围绕两个主要目标：</p> <p>可移植性：该接口确保了跨各种嵌入模型的轻松适应性。 它允许开发人员以最少的代码更改在不同的嵌入技术或模型之间切换。 这种设计符合 Spring 的模块化和可互换性理念。</p> <p>简单性：EmbeddingClient 简化了将文本转换为嵌入的过程。 通过提供 embed(String text) 和 embed(Document document) 等简单方法，它消除了处理原始文本数据和嵌入算法的复杂性。 这种设计选择使开发人员（尤其是刚接触 AI 的开发人员）能够更轻松地在应用程序中利用嵌入，而无需深入研究底层机制。</p> </li><li> <p>image generation api(openAI/stability)</p> </li><li> <p>transcription API (openAI)</p> </li><li> <p>vector databases(Neo4j/PGvector/Redis);</p> </li><li> <p>Function Calling</p> <p>大型语言模型（LLM）在训练后被冻结，导致知识过时，并且无法访问或修改外部数据。</p> <p>Function Calling 机制解决了知识过时问题，允许注册自定义用户函数，将大型语言模型连接到外部系统的 API。 这些系统可以为llm提供实时数据并代表他们执行数据处理操作。</p> </li><li> <p>Multimodality API(多模态 api) 多模态是指模型同时理解和处理多种类型模式的的信息数据能力，包括：文本、图像、音频；</p> <p>多模式大语言模型（LLM）特征使模型能够结合其他模态（图像、音频、视频）来处理和生成文本响应；</p> <p>springAI多模态API提供了所有必要的统一抽象和代码封装来支持多模态LLM</p> </li><li> <p>Prompts</p> <p>角色： system Role /User Role/ Assitant Role/Function Role</p> <p>提示技术：</p> 
  <ul><li> <p><strong><a href="https://www.promptingguide.ai/introduction/examples.en#text-summarization" rel="nofollow" title="Text Summarization">Text Summarization</a></strong>: 文本总结</p> </li><li> <p><strong><a href="https://www.promptingguide.ai/introduction/examples.en#question-answering" rel="nofollow" title="Question Answering">Question Answering</a></strong>: 问题问答</p> </li><li> <p><strong><a href="https://www.promptingguide.ai/introduction/examples.en#text-classification" rel="nofollow" title="Text Classification">Text Classification</a></strong>: 文本分类</p> </li><li> <p><strong><a href="https://www.promptingguide.ai/introduction/examples.en#conversation" rel="nofollow" title="Conversation">Conversation</a></strong>: 交互式自然对话</p> </li><li> <p><strong><a href="https://www.promptingguide.ai/introduction/examples.en#code-generation" rel="nofollow" title="Code Generation">Code Generation</a></strong>: 代码生成</p> </li></ul><p></p> <p>高级技术：</p> 
  <ul><li> <p><strong><a href="https://www.promptingguide.ai/techniques/zeroshot" rel="nofollow" title="Zero-shot">Zero-shot</a>, <a href="https://www.promptingguide.ai/techniques/fewshot" rel="nofollow" title="Few-shot Learning">Few-shot Learning</a></strong>（零样本，少样本学习）: 使模型能够通过最少甚至没有特定问题类型的先前示例做出准确的预测或响应，使用学习到的概括来理解新任务并采取行动。</p> </li><li> <p><strong><a href="https://www.promptingguide.ai/techniques/cot" rel="nofollow" title="Chain-of-Thought（链式思维）">Chain-of-Thought（链式思维）</a></strong>: 将多个人工智能响应链接起来，创建连贯且上下文相关的对话。 它帮助人工智能保持讨论的主线，确保相关性和连续性。</p> </li><li> <p><strong><a href="https://www.promptingguide.ai/techniques/react" rel="nofollow" title="ReAct (Reason + Act)">ReAct (Reason + Act)</a></strong>: 这种方法中，人工智能首先分析输入（推理），然后确定最合适的行动或响应方案。 它将理解与决策结合起来。</p> <p></p> </li></ul></li><li> <p>输出解析（Output Parsers）</p> <p>OutputParser 接口允许您获取结构化输出，例如将输出映射到 Java 类或 AI 模型基于字符串的输出的值数组。</p> </li></ul> 
<p>output Parser接口实现：BeanOutputParser（java bean 与json）、MapOutputParser(json转map)、ListOutputParser（输出为逗号分隔的list）</p> 
<ul><li> <p>ETL Pipeline</p> <p></p> <p>Extract,Transform,Load-&gt;ETL</p> <p>Retrieval Augmented Generation (RAG):检索增强生成</p> <p>ETL 框架充当检索增强生成 (RAG) 用例中数据处理的支柱。</p> <p>ETL 管道编排从原始数据源到结构化向量存储的流向，确保数据采用最佳格式供 AI 模型检索。</p> <p>RAG 用例是文本，通过从数据体中检索相关信息来增强生成模型的功能，从而提高生成输出的质量和相关性。</p> <p>ETL pipeline的三个主要组件：</p> 
  <ul><li> <p><code>DocumentReader</code> 实现了 <code>Supplier&lt;List&lt;Document&gt;&gt;</code>接口</p> </li><li> <p><code>DocumentTransformer</code> 实现了 <code>Function&lt;List&lt;Document&gt;, List&lt;Document&gt;&gt;</code>接口</p> </li><li> <p><code>DocumentWriter</code> 实现了<code>Consumer&lt;List&lt;Document&gt;&gt;</code>接口 Document 类包含文本和元数据，是通过 DocumentReader 从 PDF、文本文件和其他文档类型创建的。<br><img alt="" height="358" src="https://images2.imgbox.com/50/4e/nn3dLDao_o.png" width="1200"><br><img alt="" height="1200" src="https://images2.imgbox.com/e1/ed/F1eMjXW9_o.png" width="1200"></p> <p>ETL 类型：</p> 
    <ul><li> <p><code>PagePdfDocumentReader</code> 实现了 <code>DocumentReader</code></p> </li><li> <p><code>TokenTextSplitter</code> 实现了 <code>DocumentTransformer</code></p> </li><li> <p><code>VectorStore</code> 接口of <code>DocumentWriter</code>接口</p> </li></ul><p>将数据基本加载到向量数据库中以与检索增强生成（RAG）模式一起使用，代码如下： vectorStore.accept(tokenTextSplitter.apply(pdfReader.get()));</p> </li></ul></li><li> <p>测试评估（evaluation testing）</p> </li><li> <p>通用模型api(Generic Model API)</p> <p>为了给所有 AI 模型客户端提供基础，创建了通用模型 API。 这使得通过遵循通用模式可以轻松地为 Spring AI 提供新的 AI 模型支持。 以下部分为此 API介绍：<br><img alt="" height="738" src="https://images2.imgbox.com/ba/ab/YG7G6wJo_o.png" width="1200"></p> </li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/eaabfdd85421f91ed1a5c18251b1605d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【prometheus】Pushgateway安装和使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/430cb10a5205b5d053947c244c339b18/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【高阶数据结构(一)】并查集详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>