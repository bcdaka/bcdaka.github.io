<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>å¾®ä¿¡å°ç¨‹åºè¯¦ç»†ç™»å½•æµç¨‹ï¼ˆå›¾è§£&#43;ä»£ç æµç¨‹ï¼‰ - ç¼–ç¨‹å¤§å’–</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/848327a4d4ce083af30dcb24d371fdd5/">
  <meta property="og:site_name" content="ç¼–ç¨‹å¤§å’–">
  <meta property="og:title" content="å¾®ä¿¡å°ç¨‹åºè¯¦ç»†ç™»å½•æµç¨‹ï¼ˆå›¾è§£&#43;ä»£ç æµç¨‹ï¼‰">
  <meta property="og:description" content="ğŸ’‚ ä¸ªäººç½‘ç«™: ã€ç´«é™Œã€‘ã€ç¬”è®°åˆ†äº«ç½‘ã€‘ ğŸ’… æƒ³å¯»æ‰¾å…±åŒå­¦ä¹ äº¤æµã€å…±åŒæˆé•¿çš„ä¼™ä¼´ï¼Œ è¯·ç‚¹å‡»ã€å‰ç«¯å­¦ä¹ äº¤æµç¾¤ã€‘ å¾®ä¿¡å°ç¨‹åºçš„ç™»å½•å’Œwebç«¯çš„ç™»å½•æœ‰ä¸€ç‚¹æ˜¯ä¸åŒçš„ï¼Œå°ç¨‹åºéœ€è¦å’Œå¾®ä¿¡çš„æœåŠ¡é€šä¿¡éªŒè¯ã€‚
1.å°ç¨‹åºç™»å½•æµç¨‹å®˜ç½‘å›¾ å®˜ç½‘å›¾åœ°å€
2.è®¤è¯†openidï¼Œunionid å’Œcode openid
openidæ˜¯ç”¨æ¥å”¯ä¸€æ ‡è¯†ç”¨æˆ·çš„ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚åœ¨å¾®ä¿¡å°ç¨‹åºä¸­ï¼Œæ¯ä¸ªç”¨æˆ·çš„openidéƒ½æ˜¯å”¯ä¸€çš„ã€‚é€šè¿‡openidï¼Œå°ç¨‹åºå¯ä»¥è·å–ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¦‚å¤´åƒã€æ˜µç§°ç­‰ã€‚
æ³¨æ„ï¼šåŒä¸€ä¸ªç”¨æˆ·åœ¨ä¸åŒçš„å°ç¨‹åºä¸­æ‹¥æœ‰ä¸åŒçš„openidã€‚å› æ­¤ï¼Œåœ¨å¼€å‘å°ç¨‹åºæ—¶ï¼Œä¸èƒ½ä½¿ç”¨openidæ¥è¿›è¡Œç”¨æˆ·çš„å”¯ä¸€æ€§åˆ¤æ–­ã€‚
unionid
unionidæ˜¯åœ¨ç”¨æˆ·ç»‘å®šåŒä¸€å¾®ä¿¡å¼€æ”¾å¹³å°è´¦å·ä¸‹çš„å¤šä¸ªåº”ç”¨æ—¶ï¼Œç”¨æ¥å”¯ä¸€æ ‡è¯†ç”¨æˆ·çš„ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚å¦‚æœç”¨æˆ·åœ¨å¤šä¸ªå°ç¨‹åºä¸­ä½¿ç”¨åŒä¸€ä¸ªå¾®ä¿¡å·è¿›è¡Œç™»å½•æˆæƒï¼Œé‚£ä¹ˆè¿™äº›å°ç¨‹åºä¸­çš„unionidéƒ½æ˜¯ç›¸åŒçš„ã€‚
æ³¨æ„ï¼šç”¨æˆ·çš„unionidåªæœ‰åœ¨ç”¨æˆ·å°†å¤šä¸ªåº”ç”¨ç»‘å®šåˆ°åŒä¸€ä¸ªå¾®ä¿¡å¼€æ”¾å¹³å°è´¦å·ä¸‹æ—¶æ‰ä¼šç”Ÿæˆã€‚å› æ­¤ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰ç»‘å®šå¤šä¸ªåº”ç”¨ï¼Œé‚£ä¹ˆå°ç¨‹åºå°†æ— æ³•è·å–ç”¨æˆ·çš„unionidã€‚
code
codeæ˜¯ç”¨æˆ·ç™»å½•å‡­è¯ï¼Œç”±å¾®ä¿¡æœåŠ¡å™¨é¢å‘ç»™å°ç¨‹åºã€‚åœ¨ç”¨æˆ·æˆæƒç™»å½•åï¼Œå°ç¨‹åºå¯ä»¥é€šè¿‡è°ƒç”¨å¾®ä¿¡ç™»å½•æ¥å£è·å–ç”¨æˆ·çš„codeã€‚ç„¶åï¼Œé€šè¿‡codeå‘å¾®ä¿¡æœåŠ¡å™¨è¯·æ±‚ç”¨æˆ·çš„openidå’Œsession_keyç­‰ä¿¡æ¯ã€‚
æ³¨æ„ï¼šæ¯ä¸ªcodeåªèƒ½ä½¿ç”¨ä¸€æ¬¡ï¼Œä¸”æœ‰æ•ˆæœŸä¸º5åˆ†é’Ÿã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨codeè¿›è¡Œç™»å½•æ—¶ï¼Œéœ€è¦åŠæ—¶å°†å…¶è½¬æ¢æˆç”¨æˆ·çš„openidå’Œsession_keyç­‰ä¿¡æ¯ï¼Œä»¥å…å‡ºç°codeè¿‡æœŸçš„æƒ…å†µ
openidã€unionidå’Œcodeæ˜¯å¾®ä¿¡å°ç¨‹åºç™»å½•æˆæƒä¸­éå¸¸é‡è¦çš„ä¸‰ä¸ªå‚æ•°ï¼Œäº†è§£è¿™äº›å‚æ•°çš„ä½œç”¨å’Œç”¨æ³•ï¼Œæœ‰åŠ©äºå¼€å‘è€…æ›´å¥½åœ°è®¾è®¡å’Œå¼€å‘å°ç¨‹åºç™»å½•æˆæƒåŠŸèƒ½ã€‚ 3.æ–‡å­—ç‰ˆç™»å½•æµç¨‹ï¼ˆé¢è¯•ä¼šé—®è¿™ä¸ªï¼Œå›ç­”è¿™ä¸ªå³å¯ï¼‰ é€šè¿‡wx.login()è·å–codeã€‚
å°†è¿™ä¸ªcodeå‘é€ç»™åç«¯ï¼Œåç«¯ä¼šè¿”å›ä¸€ä¸ªtokenï¼Œè¿™ä¸ªtokenå°†ä½œä¸ºä½ èº«ä»½çš„å”¯ä¸€æ ‡è¯†ã€‚
å°†tokené€šè¿‡wx.setStorageSync()ä¿å­˜åœ¨æœ¬åœ°å­˜å‚¨ã€‚
ç”¨æˆ·ä¸‹æ¬¡è¿›å…¥â»šé¢æ—¶ï¼Œä¼šå…ˆé€šè¿‡wx.getStorageSync() æ–¹æ³•åˆ¤æ–­tokenæ˜¯å¦æœ‰å€¼ï¼Œå¦‚æœæœ‰å€¼ï¼Œåˆ™å¯ä»¥è¯·æ±‚å…¶å®ƒæ•°æ®ï¼Œå¦‚æœæ²¡æœ‰å€¼ï¼Œåˆ™è¿›è¡Œç™»å½•æ“ä½œã€‚
4.å›¾å½¢æµç¨‹ï¼ˆå‰ç«¯æµç¨‹å’Œåç«¯æµç¨‹ï¼‰ å‰ç«¯æ­¥éª¤ï¼š
åç«¯æ­¥éª¤ï¼š
5. ä»£ç å®ç°ç™»å½•æµç¨‹ ç®€å•çš„å®ç°ç™»å½•æµç¨‹ã€‚
2. å†è¿›ä¸€æ­¥å®Œå–„ï¼šæŠŠç™»å½•å°è£…æˆä¸€ä¸ªå‡½æ•°ï¼Œç„¶ååˆ¤è¯»æœ¬åœ°æ˜¯å¦æœ‰tokenæœ‰å°±ä¸ç”¨æ‰§è¡Œç™»å½•å‡½æ•°ï¼Œå¦åˆ™æ‰§è¡Œç™»å½•å‡½æ•°ã€‚ onLoad() { //è·å–token, åˆ¤æ–­tokenæ˜¯å¦æœ‰å€¼ const token = wx.getStorageSync(&#39;token&#39;) || &#39;&#39; //å¦‚æœæœ‰å€¼ if(token) { console.log(&#39;è¯·æ±‚å…¶ä»–æ•°æ®&#39;); }else{ this.handlerLogin() } }, //ç™»å½•çš„å›è°ƒå‡½æ•° handlerLogin(){ wx.login({ success: res =&gt; { //è·å–code const code = res.code console.log(res); //å°†codeå‘ç»™åç«¯è¯·æ±‚token wx.request({ url: &#39;http://xxxxxxx/login&#39;, data:{ code }, method:&#39;post&#39;, success:(res) =&gt;{ const token = res.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-03-20T17:23:00+08:00">
    <meta property="article:modified_time" content="2023-03-20T17:23:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§å’–" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§å’–</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">å¾®ä¿¡å°ç¨‹åºè¯¦ç»†ç™»å½•æµç¨‹ï¼ˆå›¾è§£&#43;ä»£ç æµç¨‹ï¼‰</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="kdocs-document"> 
 <blockquote class="kdocs-blockquote" style=""> 
  ğŸ’‚ ä¸ªäººç½‘ç«™: 
  <a class="kdocs-link" style="color:#0A6CFF;" href="http://zimo.aizhaiyu.com/" rel="nofollow noopener noreferrer" target="_blank">ã€ç´«é™Œã€‘ã€ç¬”è®°åˆ†äº«ç½‘ã€‘</a> 
  <br> 
  ğŸ’… æƒ³å¯»æ‰¾å…±åŒå­¦ä¹ äº¤æµã€å…±åŒæˆé•¿çš„ä¼™ä¼´ï¼Œ 
  <a class="kdocs-link" style="color:#0A6CFF;" href="http://zimo.aizhaiyu.com/wechat/wechat.html" rel="nofollow noopener noreferrer" target="_blank">è¯·ç‚¹å‡»ã€å‰ç«¯å­¦ä¹ äº¤æµç¾¤ã€‘</a> 
 </blockquote> 
 <p style="">å¾®ä¿¡å°ç¨‹åºçš„ç™»å½•å’Œwebç«¯çš„ç™»å½•æœ‰ä¸€ç‚¹æ˜¯ä¸åŒçš„ï¼Œå°ç¨‹åºéœ€è¦å’Œå¾®ä¿¡çš„æœåŠ¡é€šä¿¡éªŒè¯ã€‚</p> 
 <h3 style="">1.å°ç¨‹åºç™»å½•æµç¨‹å®˜ç½‘å›¾</h3> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:592px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:101.35135%;height:0;"> 
    <img src="https://images2.imgbox.com/b9/e0/MbdEOw5o_o.jpg" style="margin-left:;display:block;width:592px;margin-top:-101.35135%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style=""><a class="kdocs-link" style="color:#0A6CFF;" href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/login.html" rel="nofollow noopener noreferrer" target="_blank">å®˜ç½‘å›¾åœ°å€</a></p> 
 <h3 style="">2.è®¤è¯†openidï¼Œunionid å’Œcode</h3> 
 <ol start="1"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>openid</p></li></ol> 
 <p style="padding-left:1.4em;">openidæ˜¯<span class="kdocs-color" style="color:#C21C13;">ç”¨æ¥å”¯ä¸€æ ‡è¯†ç”¨æˆ·çš„ä¸€ä¸ªå­—ç¬¦ä¸²</span>ã€‚åœ¨å¾®ä¿¡å°ç¨‹åºä¸­ï¼Œ<span class="kdocs-color" style="color:#0E52D4;">æ¯ä¸ªç”¨æˆ·çš„openidéƒ½æ˜¯å”¯ä¸€</span>çš„ã€‚é€šè¿‡openidï¼Œå°ç¨‹åºå¯ä»¥è·å–ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¦‚å¤´åƒã€æ˜µç§°ç­‰ã€‚</p> 
 <p style="padding-left:1.4em;"><span class="kdocs-color" style="color:#DA326B;"><span class="kdocs-bold" style="font-weight:bold;">æ³¨æ„ï¼š</span></span><span class="kdocs-bold" style="font-weight:bold;">åŒä¸€ä¸ªç”¨æˆ·åœ¨ä¸åŒçš„å°ç¨‹åºä¸­æ‹¥æœ‰ä¸åŒçš„openidã€‚å› æ­¤ï¼Œåœ¨å¼€å‘å°ç¨‹åºæ—¶ï¼Œä¸èƒ½ä½¿ç”¨openidæ¥è¿›è¡Œç”¨æˆ·çš„å”¯ä¸€æ€§åˆ¤æ–­ã€‚</span></p> 
 <ol start="2"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>unionid</p></li></ol> 
 <p style="padding-left:1.4em;">unionidæ˜¯åœ¨ç”¨æˆ·ç»‘å®š<span class="kdocs-color" style="color:#C21C13;">åŒä¸€å¾®ä¿¡å¼€æ”¾å¹³å°è´¦å·ä¸‹çš„å¤šä¸ªåº”ç”¨</span>æ—¶ï¼Œç”¨æ¥<span class="kdocs-color" style="color:#0E52D4;">å”¯ä¸€æ ‡è¯†ç”¨æˆ·çš„ä¸€ä¸ªå­—ç¬¦ä¸²</span>ã€‚å¦‚æœç”¨æˆ·åœ¨å¤šä¸ªå°ç¨‹åºä¸­ä½¿ç”¨åŒä¸€ä¸ªå¾®ä¿¡å·è¿›è¡Œç™»å½•æˆæƒï¼Œé‚£ä¹ˆè¿™äº›å°ç¨‹åºä¸­çš„unionidéƒ½æ˜¯ç›¸åŒçš„ã€‚</p> 
 <p style="padding-left:1.4em;"><span class="kdocs-color" style="color:#DA326B;"><span class="kdocs-bold" style="font-weight:bold;">æ³¨æ„ï¼š</span></span><span class="kdocs-bold" style="font-weight:bold;">ç”¨æˆ·çš„unionidåªæœ‰åœ¨ç”¨æˆ·å°†å¤šä¸ªåº”ç”¨ç»‘å®šåˆ°åŒä¸€ä¸ªå¾®ä¿¡å¼€æ”¾å¹³å°è´¦å·ä¸‹æ—¶æ‰ä¼šç”Ÿæˆã€‚å› æ­¤ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰ç»‘å®šå¤šä¸ªåº”ç”¨ï¼Œé‚£ä¹ˆå°ç¨‹åºå°†æ— æ³•è·å–ç”¨æˆ·çš„unionidã€‚</span></p> 
 <ol start="3"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>code</p></li></ol> 
 <p style="padding-left:1.4em;">codeæ˜¯ç”¨æˆ·ç™»å½•å‡­è¯ï¼Œç”±å¾®ä¿¡æœåŠ¡å™¨é¢å‘ç»™å°ç¨‹åºã€‚åœ¨ç”¨æˆ·æˆæƒç™»å½•åï¼Œå°ç¨‹åºå¯ä»¥é€šè¿‡è°ƒç”¨å¾®ä¿¡ç™»å½•æ¥å£è·å–ç”¨æˆ·çš„codeã€‚ç„¶åï¼Œé€šè¿‡codeå‘å¾®ä¿¡æœåŠ¡å™¨è¯·æ±‚ç”¨æˆ·çš„openidå’Œsession_keyç­‰ä¿¡æ¯ã€‚</p> 
 <p style="padding-left:1.4em;"><span class="kdocs-color" style="color:#DA326B;"><span class="kdocs-bold" style="font-weight:bold;">æ³¨æ„ï¼š</span></span><span class="kdocs-color" style="color:#080F17;"><span class="kdocs-bold" style="font-weight:bold;">æ¯ä¸ªcodeåªèƒ½ä½¿ç”¨ä¸€æ¬¡ï¼Œä¸”æœ‰æ•ˆæœŸä¸º5åˆ†é’Ÿã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨codeè¿›è¡Œç™»å½•æ—¶ï¼Œéœ€è¦åŠæ—¶å°†å…¶è½¬æ¢æˆç”¨æˆ·çš„openidå’Œsession_keyç­‰ä¿¡æ¯ï¼Œä»¥å…å‡ºç°codeè¿‡æœŸçš„æƒ…å†µ</span></span></p> 
 <blockquote class="kdocs-blockquote" style="">
   openidã€unionidå’Œcodeæ˜¯å¾®ä¿¡å°ç¨‹åºç™»å½•æˆæƒä¸­éå¸¸é‡è¦çš„ä¸‰ä¸ªå‚æ•°ï¼Œäº†è§£è¿™äº›å‚æ•°çš„ä½œç”¨å’Œç”¨æ³•ï¼Œæœ‰åŠ©äºå¼€å‘è€…æ›´å¥½åœ°è®¾è®¡å’Œå¼€å‘å°ç¨‹åºç™»å½•æˆæƒåŠŸèƒ½ã€‚ 
 </blockquote> 
 <p style=""></p> 
 <h3 style="">3.æ–‡å­—ç‰ˆç™»å½•æµç¨‹ï¼ˆé¢è¯•ä¼šé—®è¿™ä¸ªï¼Œå›ç­”è¿™ä¸ªå³å¯ï¼‰</h3> 
 <ol start="1"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>é€šè¿‡wx.login()è·å–codeã€‚</p></li></ol> 
 <ol start="2"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>å°†è¿™ä¸ªcodeå‘é€ç»™åç«¯ï¼Œåç«¯ä¼šè¿”å›ä¸€ä¸ªtokenï¼Œè¿™ä¸ªtokenå°†ä½œä¸ºä½ èº«ä»½çš„å”¯ä¸€æ ‡è¯†ã€‚</p></li></ol> 
 <ol start="3"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>å°†tokené€šè¿‡wx.setStorageSync()ä¿å­˜åœ¨æœ¬åœ°å­˜å‚¨ã€‚</p></li></ol> 
 <ol start="4"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>ç”¨æˆ·ä¸‹æ¬¡è¿›å…¥â»šé¢æ—¶ï¼Œä¼šå…ˆé€šè¿‡wx.getStorageSync() æ–¹æ³•åˆ¤æ–­tokenæ˜¯å¦æœ‰å€¼ï¼Œå¦‚æœæœ‰å€¼ï¼Œåˆ™å¯ä»¥è¯·æ±‚å…¶å®ƒæ•°æ®ï¼Œå¦‚æœæ²¡æœ‰å€¼ï¼Œåˆ™è¿›è¡Œç™»å½•æ“ä½œã€‚</p></li></ol> 
 <p style=""></p> 
 <h3 style="">4.å›¾å½¢æµç¨‹ï¼ˆå‰ç«¯æµç¨‹å’Œåç«¯æµç¨‹ï¼‰</h3> 
 <p style=""><span class="kdocs-bold" style="font-weight:bold;">å‰ç«¯æ­¥éª¤ï¼š</span></p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:839px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:100.119194%;height:0;"> 
    <img src="https://images2.imgbox.com/1d/e2/RkMziqbV_o.png" style="margin-left:;display:block;width:839px;margin-top:-100.119194%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style=""><span class="kdocs-bold" style="font-weight:bold;">åç«¯æ­¥éª¤ï¼š</span></p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:1461px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:58.247776%;height:0;"> 
    <img src="https://images2.imgbox.com/ac/99/2OPVpj28_o.png" style="margin-left:;display:block;width:1461px;margin-top:-58.247776%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style=""></p> 
 <h3 style="">5. ä»£ç å®ç°ç™»å½•æµç¨‹</h3> 
 <ol start="1"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>ç®€å•çš„å®ç°ç™»å½•æµç¨‹ã€‚</p></li></ol> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:1140px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:74.29825%;height:0;"> 
    <img src="https://images2.imgbox.com/a3/95/SbolQCJy_o.png" style="margin-left:;display:block;width:1140px;margin-top:-74.29825%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style=""></p> 
 <p style="">2. å†è¿›ä¸€æ­¥å®Œå–„ï¼šæŠŠç™»å½•å°è£…æˆä¸€ä¸ªå‡½æ•°ï¼Œç„¶ååˆ¤è¯»æœ¬åœ°æ˜¯å¦æœ‰tokenæœ‰å°±ä¸ç”¨æ‰§è¡Œç™»å½•å‡½æ•°ï¼Œå¦åˆ™æ‰§è¡Œç™»å½•å‡½æ•°ã€‚ </p> 
 <pre class="kdocs-javascript"><code class="language-javascript">  onLoad() {
Â  Â  //è·å–token, åˆ¤æ–­tokenæ˜¯å¦æœ‰å€¼
    const token = wx.getStorageSync('token') || ''
    //å¦‚æœæœ‰å€¼
   if(token) {
    console.log('è¯·æ±‚å…¶ä»–æ•°æ®');
   }else{
     this.handlerLogin()
   }
  },
  //ç™»å½•çš„å›è°ƒå‡½æ•°
  handlerLogin(){
    wx.login({
      success: res =&gt; {
        //è·å–code
        const code = res.code
        console.log(res);
        //å°†codeå‘ç»™åç«¯è¯·æ±‚token
        wx.request({
          url: 'http://xxxxxxx/login',
          data:{ code },
          method:'post',
          success:(res) =&gt;{
            const token = res.data.token
Â  Â  Â  Â  Â  Â  //å°†tokenä¿å­˜æœ¬åœ°
            wx.setStorageSync('token', token)
            console.log(res);
          }
        })
      }
    })
  },</code></pre> 
 <ol start="2"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>åœ¨ä¸€æ¬¡ä¼˜åŒ–ä»£ç ï¼š</p></li></ol> 
 <p style="">çœ‹çœ‹åˆšåˆšå†™çš„ä»£ç çš„é—®é¢˜</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:851px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:72.73795%;height:0;"> 
    <img src="https://images2.imgbox.com/35/79/TxD5J061_o.png" style="margin-left:;display:block;width:851px;margin-top:-72.73795%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">æ‰€ä»¥è¦å¯¹ä»£ç ä¼˜åŒ–ï¼ŒæŠŠä¸Šé¢çš„ä»£ç è¿›è¡Œæ‹†åˆ†ã€‚</p> 
 <ol start="1"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>é¦–å…ˆåœ¨é¡¹ç›®çš„serviceæ–‡ä»¶å¤¹ä¸‹å£°æ˜ä¸€ä¸ªlogin.jsç”¨æ¥è·å–codeã€‚ä½¿ç”¨promiseè¿”å›æˆåŠŸçš„code</p></li></ol> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:1010px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:55.643566%;height:0;"> 
    <img src="https://images2.imgbox.com/9a/53/SW6PjfUJ_o.png" style="margin-left:;display:block;width:1010px;margin-top:-55.643566%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <pre class="kdocs-javascript"><code class="language-javascript">export const getCode = () =&gt; {
  new Promise((resolve, reject) =&gt; {
    wx.login({
      success: res =&gt; {
        //è·å–code
        resolve(res.code)
      }
    })
  })
}</code></pre> 
 <ol start="2"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>äºŒæ¬¡å°è£…ä¸€ä¸ªPromiseç‰ˆçš„requestè¯·æ±‚æ–¹æ³•ï¼Œåœ¨serviceä¸‹å»ºç«‹ä¸€ä¸ªindex.jsï¼ˆåé¢å‡ºä¸€ç¯‡å°è£…è¯·æ±‚çš„æ–‡ç« ï¼‰</p></li></ol> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:1175px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:74.97872%;height:0;"> 
    <img src="https://images2.imgbox.com/47/66/RB6WK8se_o.png" style="margin-left:;display:block;width:1175px;margin-top:-74.97872%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <pre class="kdocs-javascript"><code class="language-javascript">// å°è£…æˆç±» 
class Request {
  constructor(baseURL) {
    this.baseURL = baseURL
  }
  request(options) {
    const { url } = options
    return new Promise((resolve, reject) =&gt; {
      wx.request({
        ...options,
        url: this.baseURL + url,
        success: (res) =&gt; {
          resolve(res.data)
        },
        fail: (err) =&gt; {
          console.log("err:", err);
        }
      })
    })
  }
  get(options) {
    return this.request({ ...options, method: "get" })
  }
  post(options) {
    return this.request({ ...options, method: "post" })
  }
}
export const loginRequest = new Request("http://xxxxxxx")</code></pre> 
 <ol start="3"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>ä½¿ç”¨è‡ªå·±å°è£…çš„è¯·æ±‚æ–¹æ³•</p></li></ol> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:731px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:88.50889%;height:0;"> 
    <img src="https://images2.imgbox.com/a9/f7/3ePpq2BC_o.png" style="margin-left:;display:block;width:731px;margin-top:-88.50889%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <pre class="kdocs-javascript"><code class="language-javascript">import { loginRequest } from "./service/index";
import { getCode } from "./service/login";

// app.js
App({
  onLaunch() {
    const token = wx.getStorageSync('token') || ''
    // ç™»å½•
   if(token) {
    console.log('è¯·æ±‚å…¶ä»–æ•°æ®');
   }else{
     this.handlerLogin()
   }
  },
  //ç™»å½•çš„å›è°ƒå‡½æ•°
  async handlerLogin(){
    //è·å–code
    const code = await getCode()

    //å°†codeå‘ç»™åç«¯è¯·æ±‚token
    const res = await loginRequest.post({
      url:"/login",
      data:{code}
    })
    
    //ä¿å­˜token
    wx.setStorageSync('token', res.token)
  },
}</code></pre> 
 <ol start="4"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>å¯¹æ¯”ä¼˜åŒ–å‰å</p></li></ol> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:1457px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:40.219627%;height:0;"> 
    <img src="https://images2.imgbox.com/75/15/J3zE5E2y_o.png" style="margin-left:;display:block;width:1457px;margin-top:-40.219627%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <ol start="5"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>æ·»åŠ ä¸€ä¸ªåˆ¤æ–­tokenæ˜¯å¦è¿‡æœŸï¼Œæœ¬åœ°çš„tokenå¯èƒ½æœ‰å¯èƒ½æ²¡æœ‰ï¼Œæœ‰çš„tokençš„è¯ï¼Œtokenè¿˜æœ‰å¯èƒ½æ˜¯å¦è¿‡æœŸï¼Œtokenæ˜¯æœ‰æ—¶æ•ˆçš„ã€‚åç«¯ç»™æˆ‘ä»¬ä¸€ä¸ªå€Ÿå£éªŒè¯tokenæ˜¯å¦è¿‡æœŸçš„ã€‚</p></li></ol> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:878px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:94.533035%;height:0;"> 
    <img src="https://images2.imgbox.com/88/50/xk4lijrv_o.png" style="margin-left:;display:block;width:878px;margin-top:-94.533035%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">æœ€åï¼šå‘ä¸€ä¸ªæ€»ä½“ä»£ç ï¼š<span class="kdocs-color" style="color:#0E52D4;"><span class="kdocs-bold" style="font-weight:bold;">ç»“åˆå®é™…æ›´æ”¹ä»£ç </span></span></p> 
 <pre class="kdocs-javascript"><code class="language-javascript">import { loginRequest } from "./service/index"
import { getCode } from "./service/login"

// app.js
App({
  async onLaunch() {
    //è·å–æœ¬åœ°token
    const token = wx.getStorageSync('token') || ''

    //æ£€æŸ¥tokenæ˜¯å¦è¿‡æœŸ
    const res = await loginRequest.post({
      url: '/auth',
      header: {
        token
      }
    })
    console.log(res);

    // ç™»å½•
    if (token &amp;&amp; res.message === "å·²ç™»å½•") {
      console.log('è¯·æ±‚å…¶ä»–æ•°æ®');
    } else {
      this.handlerLogin()
    }
  },
  //ç™»å½•çš„å›è°ƒå‡½æ•°
  async handlerLogin() {
    //è·å–code
    const code = await getCode()

    //å°†codeå‘ç»™åç«¯è¯·æ±‚token
    const res = await loginRequest.post({
      url: "/login",
      data: { code }
    })

    //ä¿å­˜token
    wx.setStorageSync('token', res.token)
  },
})



//service/index.jsä»£ç 
// å°è£…æˆç±» 
class Request {
  constructor(baseURL) {
    this.baseURL = baseURL
  }
  request(options) {
    const { url } = options
    return new Promise((resolve, reject) =&gt; {
      wx.request({
        ...options,
        url: this.baseURL + url,
        success: (res) =&gt; {
          resolve(res.data)
        },
        fail: (err) =&gt; {
          console.log("err:", err);
        }
      })
    })
  }
  get(options) {
    return this.request({ ...options, method: "get" })
  }
  post(options) {
    return this.request({ ...options, method: "post" })
  }
}
export const loginRequest = new Request("http://xxxxx")



//service/login.js
export const getCode = () =&gt; {
  new Promise((resolve, reject) =&gt; {
    wx.login({
      success: res =&gt; {
        //è·å–code
        resolve(res.code)
      }
    })
  })
}

</code></pre> 
 <p style=""></p> 
 <blockquote class="kdocs-blockquote" style="">
   æœ€åå“ªé‡Œéœ€è¦æ”¹è¿›çš„éº»çƒ¦å¤§å®¶æŒ‡ç‚¹æ±Ÿå±±ã€‚å¯¹ä½ æœ‰å¸®åŠ©å¯ä»¥ç‚¹ç‚¹èµ~ã€‚éœ€è¦æŠ€æœ¯äº¤æµçš„ä¹Ÿå¯åŠ å…¥æŠ€æœ¯ç¾¤èŠï¼ 
 </blockquote> 
 <p style=""></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e5f904de4a6876aef77d4c3330a9c193/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">å¾®ä¿¡å°ç¨‹åºå®ç°å›¾ç‰‡ä¸Šä¼ ï¼ˆæ¸…æ™°ç‰ˆï¼‰</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5c2170d542c3eec3faee92fbcef2ce10/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">Stm32-ä½¿ç”¨TB6612é©±åŠ¨ç”µæœºåŠç¼–ç å™¨æµ‹é€Ÿ</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§å’–.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>