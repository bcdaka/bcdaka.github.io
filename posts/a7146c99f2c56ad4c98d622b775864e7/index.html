<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>oracle数据库连接错误ORA-12514, TNS:listener does not currently know of service requested in connect descrip - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/a7146c99f2c56ad4c98d622b775864e7/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="oracle数据库连接错误ORA-12514, TNS:listener does not currently know of service requested in connect descrip">
  <meta property="og:description" content="ORA-12514, TNS:listener does not currently know of service requested in connect descriptor 问题排查 数据库连接不上，我们直接服务器进入命令行 无法进入命令行，报错：Oracle 数据库尝试创建审计追踪文件，由于没有空间无法创建。
审计追踪文件的作用：
Oracle 数据库审计追踪文件用于记录数据库中发生的安全相关事件和活动，以提供有关数据库的详细审计信息。这些文件有助于监视和追踪数据库的使用情况，以确保数据库的安全性、合规性和可追溯性。以下是审计追踪文件的一些主要作用：
安全监控： 审计追踪文件记录了数据库中的登录、注销、授权、权限更改等安全相关事件。通过审计文件，数据库管理员可以检查是否有未经授权的访问尝试，以及数据库用户的活动是否符合预期。
合规性： 许多行业和法规要求数据库系统实施严格的安全审计和监控。审计追踪文件可以用于满足这些合规性要求，例如，PCI DSS（支付卡行业数据安全标准）要求对数据库的访问和操作进行详细的审计记录。
问题排查： 当出现数据库性能或安全性问题时，审计追踪文件可用于进行问题排查。通过查看文件，管理员可以了解在特定时间数据库发生了什么，有助于快速定位和解决问题。
用户行为分析： 审计追踪文件记录了用户的活动，包括 SQL 语句的执行、表的访问等。这些信息对于分析用户行为、优化查询以及进行容量规划等方面都是有用的。
数据库性能优化： 通过审计追踪文件，可以了解数据库中哪些查询经常被执行，哪些表被频繁访问，从而帮助优化数据库性能。
在 Oracle 数据库中，可以通过配置审计选项和参数来控制审计追踪文件的生成。审计追踪文件通常包含详细的事件信息，如时间戳、事件类型、用户、主机信息、SQL 语句等。
查询剩余空间 可以看到我们的根目录已经全部占用了，应该就是因为我们的审计追踪文件创建在这个目录之下，所以没有足够的空间继续创建了
解决问题 查看我们的初始化配置文件，看一下审计追踪文件的默认创建位置 一般是在这个路径下的 init.ora 文件
cd $ORACLE_HOME/dbs/ 可以看到我们的 audit_file_dest 路径就是我们的审计追踪文件的位置
audit_trail 是我们审计追踪文件的策略
NONE（默认）：不进行审计。OS：使用操作系统级别的审计功能。这种情况下，审计追踪文件的管理由操作系统处理。DB：审计信息存储在数据库中，可以通过 SQL 查询来检索。数据库管理员需要定期清理过时的审计数据。 定期清理sql
DBMS_AUDIT_MGMT.CLEAN_AUDIT_TRAIL( audit_trail_type =&gt; DBMS_AUDIT_MGMT.AUDIT_TRAIL_AUD_STD, use_last_arch_timestamp =&gt; TRUE ); 找到审计追踪文件并删除 查看环境变量
cat /etc/profile 进入 $ORACLE_BASE/admin/orcl/adump
直接删除这个文件夹下所有文件">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-12-05T20:05:43+08:00">
    <meta property="article:modified_time" content="2023-12-05T20:05:43+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">oracle数据库连接错误ORA-12514, TNS:listener does not currently know of service requested in connect descrip</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="ORA12514_TNSlistener_does_not_currently_know_of_service_requested_in_connect_descriptor_0"></a>ORA-12514, TNS:listener does not currently know of service requested in connect descriptor</h2> 
<p><img src="https://images2.imgbox.com/3b/20/qK8yqbZN_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_3"></a>问题排查</h4> 
<ol><li><strong>数据库连接不上</strong>，<strong>我们直接服务器进入命令行</strong></li></ol> 
<p><img src="https://images2.imgbox.com/57/77/C4w2MjDT_o.png" alt="image-20231205192146251"></p> 
<p>无法进入命令行，报错：Oracle 数据库尝试创建审计追踪文件，由于没有空间无法创建。</p> 
<blockquote> 
 <p>审计追踪文件的作用：</p> 
 <p>Oracle 数据库审计追踪文件用于记录数据库中发生的安全相关事件和活动，以提供有关数据库的详细审计信息。这些文件有助于监视和追踪数据库的使用情况，以确保数据库的安全性、合规性和可追溯性。以下是审计追踪文件的一些主要作用：</p> 
 <ol><li> <p><strong>安全监控：</strong> 审计追踪文件记录了数据库中的登录、注销、授权、权限更改等安全相关事件。通过审计文件，数据库管理员可以检查是否有未经授权的访问尝试，以及数据库用户的活动是否符合预期。</p> </li><li> <p><strong>合规性：</strong> 许多行业和法规要求数据库系统实施严格的安全审计和监控。审计追踪文件可以用于满足这些合规性要求，例如，PCI DSS（支付卡行业数据安全标准）要求对数据库的访问和操作进行详细的审计记录。</p> </li><li> <p><strong>问题排查：</strong> 当出现数据库性能或安全性问题时，审计追踪文件可用于进行问题排查。通过查看文件，管理员可以了解在特定时间数据库发生了什么，有助于快速定位和解决问题。</p> </li><li> <p><strong>用户行为分析：</strong> 审计追踪文件记录了用户的活动，包括 SQL 语句的执行、表的访问等。这些信息对于分析用户行为、优化查询以及进行容量规划等方面都是有用的。</p> </li><li> <p><strong>数据库性能优化：</strong> 通过审计追踪文件，可以了解数据库中哪些查询经常被执行，哪些表被频繁访问，从而帮助优化数据库性能。</p> </li></ol> 
 <p>在 Oracle 数据库中，可以通过配置审计选项和参数来控制审计追踪文件的生成。审计追踪文件通常包含详细的事件信息，如时间戳、事件类型、用户、主机信息、SQL 语句等。</p> 
</blockquote> 
<ol start="2"><li><strong>查询剩余空间</strong></li></ol> 
<p><img src="https://images2.imgbox.com/8a/72/Z08XvMqX_o.png" alt="image-20231205192313922"></p> 
<p>可以看到我们的根目录已经全部占用了，应该就是因为我们的审计追踪文件创建在这个目录之下，所以没有足够的空间继续创建了</p> 
<h4><a id="_33"></a>解决问题</h4> 
<ol><li><strong>查看我们的初始化配置文件，看一下审计追踪文件的默认创建位置</strong></li></ol> 
<p>一般是在这个路径下的 init.ora 文件</p> 
<pre><code>cd $ORACLE_HOME/dbs/
</code></pre> 
<p><img src="https://images2.imgbox.com/06/27/zYXALzfT_o.png" alt="image-20231205165432183"></p> 
<p>可以看到我们的 audit_file_dest 路径就是我们的审计追踪文件的位置</p> 
<p>audit_trail 是我们审计追踪文件的策略</p> 
<ul><li><code>NONE</code>（默认）：不进行审计。</li><li><code>OS</code>：使用操作系统级别的审计功能。这种情况下，审计追踪文件的管理由操作系统处理。</li><li><code>DB</code>：审计信息存储在数据库中，可以通过 SQL 查询来检索。数据库管理员需要定期清理过时的审计数据。</li></ul> 
<blockquote> 
 <p>定期清理sql</p> 
 <pre><code class="prism language-sql">DBMS_AUDIT_MGMT<span class="token punctuation">.</span>CLEAN_AUDIT_TRAIL<span class="token punctuation">(</span>
   audit_trail_type     <span class="token operator">=</span><span class="token operator">&gt;</span> DBMS_AUDIT_MGMT<span class="token punctuation">.</span>AUDIT_TRAIL_AUD_STD<span class="token punctuation">,</span>
   use_last_arch_timestamp <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">TRUE</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
</blockquote> 
<ol start="2"><li><strong>找到审计追踪文件并删除</strong></li></ol> 
<p>查看环境变量</p> 
<pre><code>cat /etc/profile
</code></pre> 
<p><img src="https://images2.imgbox.com/01/f1/t9dTb6lN_o.png" alt="image-20231205194220565"></p> 
<p>进入 $ORACLE_BASE/admin/orcl/adump</p> 
<p>直接删除这个文件夹下所有文件</p> 
<pre><code>rm -rf adump/*
</code></pre> 
<ol start="3"><li><strong>进入oracle命令行重启服务器实例</strong></li></ol> 
<p>由于我的数据库实例使用的是PDB，所以我需要打开我指定的PDB</p> 
<pre><code>[root@oracledb dbs]# su oracle
[oracle@oracledb dbs]$ sqlplus /nolog

SQL*Plus: Release 19.0.0.0.0 - Production on Tue Dec 5 16:55:51 2023
Version 19.3.0.0.0

Copyright (c) 1982, 2019, Oracle.  All rights reserved.

SQL&gt; conn /as sysdba
Connected to an idle instance.

SQL&gt; startup
ORACLE instance started.

Total System Global Area 4.0400E+10 bytes
Fixed Size		   30393616 bytes
Variable Size		 7381975040 bytes
Database Buffers	 3.2883E+10 bytes
Redo Buffers		  103821312 bytes
Database mounted.
Database opened.         " - rest of line ignored.

SQL&gt; ALTER PLUGGABLE DATABASE ORCLPDB1 OPEN;

Pluggable database altered.

</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6cc34dc328dc82421d6d5c6ee70d852c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【数据结构】链表OJ题（顺序表）（C语言实现）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f2f10c52c886f8d9c43b6a5fdfaa64b7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python绘制雷达图</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>