<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>计算机图形学入门05：投影变换 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/6224ff9859beff3fdb6da88f6ced09c4/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="计算机图形学入门05：投影变换">
  <meta property="og:description" content="1.投影变换 上一章已经介绍了投影变换，就是将三维图像投影到二维平面上，而投影变换又分为正交投影(Orthographic Projection)和透视投影(Perspective Projection)。如下图：
正交投影
没有近大远小的现象，无论图形与视点距离是远是近，图形多大画出来的图形就是多大。假设相机距离拉到无限远，远近物体的大小无限接近，所以显示不同距离的物体画面显示一样大小。正交投影会通过远近裁剪面、前后裁剪面、上下裁剪面六个面确定一个可视空间，在可视空间中的物体才能被看到，被映射在近裁剪面(Near clip plane)上。
透视投影
有近大远小的现象，更接近肉眼看到的画面，应用更加常见。假设相机放在某一个点投射出一个视锥空间，在视锥空间中通过近裁剪面和远裁剪面(Far clip plane)可以裁出一个椎体空间，这个空间称为透视投影的可视空间，在可视空间里的物体被映射到近裁剪面上。
2.正交投影 2.1简单的理解 1.相机在原点，方向是-z方向，上方向是Y轴。(上一章提到的相机标准位置)
2.扔掉z轴。如下图所示，物体映射到平面上跟Z轴坐标无关(这样无法判断物体前后)。
3.可以看出只要将物体平移和缩放到[-1,1]²矩阵里。到这个矩阵为了之后方便计算。
2.2正式推导正交投影矩阵 我们想要将一个长方体[l,r]×[b,t]×[f,n]映射到标准立方体(canonical cube)([-1, 1]³)中，表示对空间的某一块进行正交投影。这个变换过程就是先平移再缩放。如下图所示：
上图中的立方，l,r表示左边界和右边界，b,t表示下边界和上边界，f,n表示远裁剪面和近裁剪面。由于相机向-z方向看去，所以离相机越近意味着z值越大，离相机越远z值越小，所以这里z值越大距离相机越近，z值越小距离相机越远。
正交投影矩阵
先平移到原点(两点相加除以2等于中心点)，然后缩放(长、宽、高变为2)。原本长方体长宽高覆盖范围分别为r-l，t-b，n-f，缩放到2，因为标准立方体-1到1直接范围是2。
合并后最终正交投影矩阵为：
3.透视投影 在推导之前先回忆下齐次坐标的性质。坐标(x,y,z,1),(xk,yk,zk,k!=0),(xz,yz,zz,z!=0)在3D中都表示同一个点(x,y,z)。例如(1,0,0,1),(2,0,0,2)都表示(1,0,0)这个点。
3.1推导透视投影矩阵思路 推导思路是将透视投影的视锥体“压扁”长方体，做正交投影。如下图所示：
在挤压过程中，要保证近裁剪面不变，z值不发生变化，远裁剪面的中心点也不发生变化。挤压完成后就变成正交投影矩阵，所以要求透视投影矩阵就变成了先求透视投影到正交投影的变换矩阵，再进行正交投影矩阵。
3.2推导透视投影矩阵 下图是透视投影的侧视图：
如上图所示要将点(x,y,z)移到与点(x’,y’,z’)一样的高度和水平宽度，需要将y移到y’，x移到x’。根据图中的相似三角形性质，可得出两者的关系：
根据齐次坐标性质，给每个分量都乘以z，得到远裁剪面上的点与近裁剪面的点映射关系：
那么得到的这个挤压后远裁剪面的点，肯定是由远裁剪面乘以某个变换矩阵得到，也就是透视投影到正交投影的变换矩阵。
然后根据矩阵相乘的性质，反推算出这个变换矩阵，只有第三行还不知道。
第三行势必跟z有关系，而在挤压过程中近裁剪面上任何的点z值都不发生变化的。而近裁剪面的z值就是n，近裁剪面矩阵乘以这个M(4x4)矩阵一定等于它自己(点坐标一样)。所以可以代入做如下处理。
根据矩阵乘法反推，因此M(4x4)矩阵第三行必须是(0,0,A,B)，A和B为自己命名。推导：x*0&#43;y*0&#43;A*n&#43;B*1 = n²；
所以得到An&#43;B = n²。
又因为在挤压过程中远裁剪面上任何的点z值也都不发生变化的。拿到远裁剪面上的中心点(0,0,f)，这个中心点在挤压前和挤压后x，y的值也不变。
所以与近裁剪面同理，将远裁剪面中心点代入处理可得。
将上面得到的关系表达式，整理计算得到A和B的值。
至此，矩阵第三行得到(0,0,n&#43;f,-nf)，代入可得透视投影到正交投影的变换矩阵。
挤压完成变成正交投影之后，就交给正交投影矩阵完成了。
3.3透视投影矩阵 上述已经求得了透视投影到正交投影的变换矩阵，再进行正交投影矩阵，即是透视投影矩阵。(矩阵相乘从右到左应用)">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-31T17:27:24+08:00">
    <meta property="article:modified_time" content="2024-05-31T17:27:24+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">计算机图形学入门05：投影变换</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>1.投影变换</h2> 
<p>        上一章已经介绍了投影变换，就是将三维图像投影到二维平面上，而投影变换又分为<strong>正交投影(Orthographic Projection</strong><strong>)</strong>和<strong>透视投影(Perspective Projection)</strong>。如下图：</p> 
<p class="img-center"><img alt="" height="300" src="https://images2.imgbox.com/76/ed/SYrgv1LA_o.png" width="643"></p> 
<p><strong>正交投影</strong></p> 
<p>        没有近大远小的现象，无论图形与视点距离是远是近，图形多大画出来的图形就是多大。假设相机距离拉到无限远，远近物体的大小无限接近，所以显示不同距离的物体画面显示一样大小。正交投影会通过远近裁剪面、前后裁剪面、上下裁剪面六个面确定一个<strong>可视空间</strong>，在可视空间中的物体才能被看到，被映射在<strong>近裁剪面(Near clip plane)</strong>上。</p> 
<p><strong>透视投影</strong></p> 
<p>        有近大远小的现象，更接近肉眼看到的画面，应用更加常见。假设相机放在某一个点投射出一个视锥空间，在视锥空间中通过近裁剪面和<strong>远裁剪面(Far clip plane)</strong>可以裁出一个椎体空间，这个空间称为透视投影的<strong>可视空间</strong>，在可视空间里的物体被映射到近裁剪面上。</p> 
<h2>2.正交投影</h2> 
<h3><strong>2.1简单的理解</strong></h3> 
<p>        1.相机在原点，方向是<strong>-z</strong>方向，上方向是<strong>Y</strong>轴。(上一章提到的相机标准位置)</p> 
<p>        2.扔掉<strong>z</strong>轴。如下图所示，物体映射到平面上跟Z轴坐标无关(这样无法判断物体前后)。</p> 
<p>        3.可以看出只要将物体平移和缩放到<strong>[-1,1]²</strong>矩阵里。到这个矩阵为了之后方便计算。</p> 
<p class="img-center"><img alt="" height="200" src="https://images2.imgbox.com/31/ae/T8c9Ezhz_o.png" width="386"></p> 
<h3 style="background-color:transparent;">2.2正式推导正交投影矩阵</h3> 
<p>        我们想要将一个长方体<strong>[l,r]×[b,t]×[f,n]</strong>映射到<strong>标准立方体(canonical cube)([-1, 1]³)</strong>中，表示对空间的某一块进行正交投影。这个变换过程就是先平移再缩放。如下图所示：</p> 
<p class="img-center"><img alt="" height="140" src="https://images2.imgbox.com/a0/ef/n9oc2w0a_o.png" width="580"></p> 
<p>        </p> 
<p>        上图中的立方，<strong>l,r</strong>表示左边界和右边界，<strong>b,t</strong>表示下边界和上边界，<strong>f,n</strong>表示远裁剪面和近裁剪面。由于相机向<strong>-z</strong>方向看去，所以离相机越近意味着<strong>z</strong>值越大，离相机越远z值越小，所以这里<strong>z</strong>值越大距离相机越近，<strong>z</strong>值越小距离相机越远。</p> 
<p><strong>正交投影矩阵</strong></p> 
<p><strong>        </strong>先平移到原点(两点相加除以2等于中心点)，然后缩放(长、宽、高变为2)。原本长方体长宽高覆盖范围分别为<strong>r-l，t-b，n-f</strong>，缩放到2，因为标准立方体-1到1直接范围是2。</p> 
<p class="img-center"><img alt="" height="130" src="https://images2.imgbox.com/ac/23/vVjbUzH0_o.png" width="480"></p> 
<p>        合并后最终<strong>正交投影矩阵</strong>为：</p> 
<p class="img-center"><img alt="" height="130" src="https://images2.imgbox.com/05/a7/CEdgq0GI_o.png" width="398"></p> 
<h2>3.透视投影</h2> 
<p>        在推导之前先回忆下齐次坐标的性质。坐标<strong>(x,y,z,1),(xk,yk,zk,k!=0),(xz,yz,zz,z!=0)</strong>在3D中都表示同一个点<strong>(x,y,z)</strong>。例如(1,0,0,1),(2,0,0,2)都表示(1,0,0)这个点。</p> 
<h3>3.1推导透视投影矩阵思路</h3> 
<p>        推导思路是将透视投影的视锥体“压扁”长方体，做正交投影。如下图所示：</p> 
<p class="img-center"><img alt="" height="150" src="https://images2.imgbox.com/02/a7/BF104xXS_o.png" width="295"></p> 
<p>        在挤压过程中，要保证近裁剪面不变，<strong>z</strong>值不发生变化，远裁剪面的中心点也不发生变化。挤压完成后就变成正交投影矩阵，所以要求透视投影矩阵就变成了先求<strong>透视投影到正交投影的变换矩阵，再进行正交投影矩阵。</strong></p> 
<h3 style="background-color:transparent;"><strong>3.2推导透视投影矩阵</strong></h3> 
<p><strong>        </strong>下图是透视投影的侧视图：</p> 
<p class="img-center"><img alt="" height="300" src="https://images2.imgbox.com/2b/f4/jeR9eAfN_o.png" width="918"></p> 
<p>        如上图所示要将点<strong>(x,y,z)</strong>移到与点<strong>(x’,y’,z’)</strong>一样的高度和水平宽度，需要将<strong>y</strong>移到<strong>y’</strong>，<strong>x</strong>移到<strong>x’</strong>。根据图中的相似三角形性质，可得出两者的关系：</p> 
<p class="img-center"><img alt="" height="50" src="https://images2.imgbox.com/92/81/qgRUr1qI_o.png" width="312"></p> 
<p>        根据齐次坐标性质，给每个分量都乘以<strong>z</strong>，得到远裁剪面上的点与近裁剪面的点映射关系：</p> 
<p class="img-center"><img alt="" height="150" src="https://images2.imgbox.com/40/5f/kWHz2uYV_o.png" width="549"></p> 
<p>        那么得到的这个挤压后远裁剪面的点，肯定是由远裁剪面乘以某个变换矩阵得到，也就是<strong>透视投影到正交投影的变换矩阵。</strong></p> 
<p class="img-center"><img alt="" height="150" src="https://images2.imgbox.com/ac/68/0rHPACOF_o.png" width="462"></p> 
<p>        然后根据矩阵相乘的性质，反推算出这个变换矩阵，只有第三行还不知道。</p> 
<p class="img-center"><img alt="" height="150" src="https://images2.imgbox.com/bc/61/PyFSLv6v_o.png" width="413"></p> 
<p>        第三行势必跟<strong>z</strong>有关系，而在挤压过程中<strong>近裁剪面上任何的点z值都不发生变化的。</strong>而近裁剪面的<strong>z</strong>值就是<strong>n</strong>，近裁剪面矩阵乘以这个<strong>M(4x4)</strong>矩阵一定等于它自己(点坐标一样)。所以可以代入做如下处理。</p> 
<p><img alt="" height="241" src="https://images2.imgbox.com/c3/82/ESgnTfMk_o.png" width="1200"></p> 
<p>       根据矩阵乘法反推，因此<strong>M(4x4)</strong>矩阵第三行必须是<strong>(0,0,A,B)</strong>，<strong>A</strong>和<strong>B</strong>为自己命名。推导：<strong>x*0+y*0+A*n+B*1 = n²</strong>；</p> 
<p class="img-center"><img alt="" height="120" src="https://images2.imgbox.com/f7/e9/AjCOCQIv_o.png" width="289"></p> 
<p>        所以得到<strong>An+B = n²</strong>。</p> 
<p>        又因为在挤压过程中<strong>远裁剪面上任何的点z值也都不发生变化的</strong>。拿到远裁剪面上的<strong>中心点(0,0,f)，</strong>这个中心点在挤压前和挤压后<strong>x，y</strong>的值也不变。</p> 
<p class="img-center"><img alt="" height="200" src="https://images2.imgbox.com/c7/ff/CFh7zzDP_o.png" width="217"></p> 
<p>        所以与近裁剪面同理，将远裁剪面中心点代入处理可得。</p> 
<p class="img-center"><img alt="" height="130" src="https://images2.imgbox.com/8d/c3/sQANXfkv_o.png" width="530"></p> 
<p>        将上面得到的关系表达式，整理计算得到<strong>A</strong>和<strong>B</strong>的值。</p> 
<p class="img-center"><img alt="" height="100" src="https://images2.imgbox.com/d2/ca/eYgILKmh_o.png" width="511"></p> 
<p>        至此，矩阵第三行得到<strong>(0,0,n+f,-nf)，</strong>代入可得<strong>透视投影到正交投影的变换矩阵。</strong></p> 
<p class="img-center"><img alt="" height="150" src="https://images2.imgbox.com/18/38/ioB7unrm_o.png" width="445"></p> 
<p>        挤压完成变成正交投影之后，就交给正交投影矩阵完成了。</p> 
<h3>3.3透视投影矩阵</h3> 
<p>        上述已经求得了<strong>透视投影到正交投影的变换矩阵</strong>，再进行<strong>正交投影矩阵</strong>，即是<strong>透视投影矩阵</strong>。(矩阵相乘从右到左应用)</p> 
<p><img alt="" height="366" src="https://images2.imgbox.com/82/5e/Rynmzetq_o.png" width="1057"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b920bc7473187f27e03c46163ce7414a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">语音深度鉴伪识别项目实战：基于深度学习的语音深度鉴伪识别算法模型(二)音频数据预处理及去噪算法&#43;Python源码应用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4833b9e282b1d7d586fe808ab3f809dc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【C&#43;&#43;】string类模拟实现：探索其内部机制</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>