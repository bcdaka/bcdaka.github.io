<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>springboot 配置文件密码加密的3种方案 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/4291cdde960bed22c240fd637d9481b6/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="springboot 配置文件密码加密的3种方案">
  <meta property="og:description" content="配置文件密码加密的3种方案 一.配置文件添加jasypt 1.pom.xml添加jasypt引用 &lt;dependency&gt; &lt;groupId&gt;com.github.ulisesbocchio&lt;/groupId&gt; &lt;artifactId&gt;jasypt-spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; 2.在springboot配置文件内加入 jasypt配置 jasypt: encryptor: algorithm: PBEWithMD5AndDES ##盐 password: dddda123 #密钥 二.使用配置类初始加载加解密 1.pom.xml添加jasypt依赖 &lt;dependency&gt; &lt;groupId&gt;com.github.ulisesbocchio&lt;/groupId&gt; &lt;artifactId&gt;jasypt-spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; 2.编写配置类加载bean package com.top.common.config; import org.jasypt.encryption.StringEncryptor; import org.jasypt.encryption.pbe.PooledPBEStringEncryptor; import org.jasypt.encryption.pbe.config.SimpleStringPBEConfig; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.Configuration; */ /** * @author * @date 2023/6/719:41 * @Package * @description 自动配置加密信息 *//* @Configuration public class EncryptorConfig { @Bean(&#34;jasyptStringEncryptor&#34;) public StringEncryptor jasyptStringEncryptor() { PooledPBEStringEncryptor encryptor = new PooledPBEStringEncryptor(); SimpleStringPBEConfig config = new SimpleStringPBEConfig(); config.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-17T09:53:27+08:00">
    <meta property="article:modified_time" content="2024-04-17T09:53:27+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">springboot 配置文件密码加密的3种方案</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="3_0"></a>配置文件密码加密的3种方案</h2> 
<h3><a id="jasypt_1"></a>一.配置文件添加jasypt</h3> 
<h4><a id="1pomxmljasypt_2"></a>1.pom.xml添加jasypt引用</h4> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.github.ulisesbocchio<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jasypt-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h4><a id="2springboot_jasypt_11"></a>2.在springboot配置文件内加入 jasypt配置</h4> 
<pre><code class="prism language-html">jasypt:
  encryptor:
    algorithm: PBEWithMD5AndDES ##盐
    password: dddda123 #密钥
</code></pre> 
<h3><a id="_20"></a>二.使用配置类初始加载加解密</h3> 
<h4><a id="1pomxmljasypt_21"></a>1.pom.xml添加jasypt依赖</h4> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.github.ulisesbocchio<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jasypt-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h4><a id="2bean_30"></a>2.编写配置类加载bean</h4> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>top<span class="token punctuation">.</span>common<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>jasypt<span class="token punctuation">.</span>encryption<span class="token punctuation">.</span></span><span class="token class-name">StringEncryptor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>jasypt<span class="token punctuation">.</span>encryption<span class="token punctuation">.</span>pbe<span class="token punctuation">.</span></span><span class="token class-name">PooledPBEStringEncryptor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>jasypt<span class="token punctuation">.</span>encryption<span class="token punctuation">.</span>pbe<span class="token punctuation">.</span>config<span class="token punctuation">.</span></span><span class="token class-name">SimpleStringPBEConfig</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token operator">*</span><span class="token operator">/</span>
<span class="token comment">/**
 * @author 
 * @date 2023/6/719:41
 * @Package 
 * @description 自动配置加密信息
 */</span><span class="token operator">/</span><span class="token operator">*</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EncryptorConfig</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">"jasyptStringEncryptor"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">StringEncryptor</span> <span class="token function">jasyptStringEncryptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">PooledPBEStringEncryptor</span> encryptor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PooledPBEStringEncryptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SimpleStringPBEConfig</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleStringPBEConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"WyYJ5C8l9qWSjkMpP2ilsIRkvhvp9wH4"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 注释部分为配置默认</span>
        config<span class="token punctuation">.</span><span class="token function">setAlgorithm</span><span class="token punctuation">(</span><span class="token string">"PBEWithMD5AndDES"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        config.setKeyObtentionIterations("1000");</span>
        config<span class="token punctuation">.</span><span class="token function">setPoolSize</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        config.setProviderName("SunJCE");</span>
<span class="token comment">//        config.setSaltGeneratorClassName("org.jasypt.salt.RandomSaltGenerator");</span>
<span class="token comment">//        config.setIvGeneratorClassName("org.jasypt.iv.RandomIvGenerator");</span>
<span class="token comment">//        config.setStringOutputType("base64");</span>
        encryptor<span class="token punctuation">.</span><span class="token function">setConfig</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> encryptor<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_68"></a>三、不在配置文件显示配置秘钥</h3> 
<p>使用Jasypt来加密和解密</p> 
<h4><a id="1Jasypt_70"></a>1、添加Jasypt依赖</h4> 
<p>在pom.xml文件中添加Jasypt依赖：</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.jasypt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jasypt-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.0.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h4><a id="2_85"></a>2、获取加密后的字符串</h4> 
<p>在线网站：https://new.lxc1314.xyz/</p> 
<h4><a id="3_87"></a>3、在配置文件中使用加密后的密码</h4> 
<p>在application.properties或application.yml中使用加密后的密码，格式为ENC(加密后的密码)。例如：</p> 
<pre><code class="prism language-html">spring.datasource.password=ENC(1WqJf1V5n1R4n5v2k3P4q5I7r2Q3u5Q1)
</code></pre> 
<h4><a id="4_94"></a>4、在安装的时候向环境变量中配置解密密码和盐值</h4> 
<pre><code class="prism language-html">export JASYPT_ENCRYPTOR_PASSWORD=mySecretPassword
export JASYPT_ENCRYPTOR_IV_GENERATOR_CLASSNAME=org.jasypt.iv.RandomIvGenerator
</code></pre> 
<h4><a id="5java_jasyptencryptorpassword__jasyptencryptorivgeneratorclassname_101"></a>5、java 命令启动时传入jasypt.encryptor.password 和 jasypt.encryptor.iv-generator-classname</h4> 
<pre><code class="prism language-html">java -jar myapp.jar -Djasypt.encryptor.password=$JASYPT_ENCRYPTOR_PASSWORD -Djasypt.encryptor.iv-generator-classname=org.jasypt.iv.RandomIvGenerator
</code></pre> 
<h3><a id="_107"></a>密码加密的使用</h3> 
<h4><a id="1ENC_108"></a>1.在需要加密的配置文件使用ENC(加密后的密码)</h4> 
<h4><a id="2_109"></a>2.获取加密后的密码方法</h4> 
<pre><code class="prism language-html">    private static final String ALGORITHM_INFO = "PBEWithMD5AndDES";

    private static final String PASSWORD_INFO = "WyAh5C8l9qWSGHMpda1lsIRkvhvpyDH1";

    @GetMapping("/encryptPwd")
    public void encryptPwd() {
        StandardPBEStringEncryptor standardPBEStringEncryptor = new StandardPBEStringEncryptor();
        //配置文件中配置如下的算法
        standardPBEStringEncryptor.setAlgorithm(ALGORITHM_INFO);
        //配置文件中配置的password
        standardPBEStringEncryptor.setPassword(PASSWORD_INFO);
        //要加密的文本
        String name = standardPBEStringEncryptor.encrypt("abababa");
        String password = standardPBEStringEncryptor.encrypt("e022f87539fd81f3");
        String redisPassword = standardPBEStringEncryptor.encrypt("gbasedbt123");
        String redisPassword2 = standardPBEStringEncryptor.encrypt("abababa");
        String redisPassword3 = standardPBEStringEncryptor.encrypt("123456");
        String redisPassword4 = standardPBEStringEncryptor.encrypt("6a3d373e077b41b5a1c53f993c4fdc80");
        String oppeer= standardPBEStringEncryptor.encrypt("oppeer");
        String ddlla= standardPBEStringEncryptor.encrypt("ddlla");
        String nacos = standardPBEStringEncryptor.encrypt("nacos");
        //将加密的文本写到配置文件中
        System.out.println("【abababa】=" + name);
        System.out.println("【e022f87539fd81f3】=" + password);
        System.out.println("【gbasedbt123】=" + redisPassword);
        System.out.println("【abababa】=" + redisPassword2);
        System.out.println("【123456】=" + redisPassword3);
        System.out.println("【6a3d373e077b41b5a1c53f993c4fdc80】=" + redisPassword4);
        System.out.println("【oppeer】=" + oppeer);
        System.out.println("【ddlla】=" + ddlla);
        System.out.println("【nacos】=" + nacos);

        //要解密的文本
       *//* String name2 = standardPBEStringEncryptor.decrypt("3U+OHwCEJvWNCnjV6iVYvMxYYcJTxJpoQchB4/ttEsV5YdHI9jFW8S92KiTI6yLk");
        String password2 = standardPBEStringEncryptor.decrypt("0PbODjzlXKy2a0Ijag3oEFqmvRpUl736GVkh55sY4SmTk5Nl1FzxpETEScFtL47W");
//        String redisPassword2 = standardPBEStringEncryptor.decrypt("ZII7UphhbVuJ8c3oxPUeyw==");
        //解密后的文本
        System.out.println("name2=" + name2);
        System.out.println("password2=" + password2);*//*

}
</code></pre> 
<ul><li><strong>两种配置文件密码加密方案，一种是在配置文件中添加jasypt引用并加入jasypt配置，另一种是使用配置类加载bean进行加解密。加密后的密码可以在配置文件中使用ENC(加密后的密码)获取。其中使用的加密算法是PBEWithMD5AndDES，密钥为WyAh5C8l9qWSGHMpda1lsIRkvhvpyDH1。可以通过访问/encryptPwd来获取加密后的密码。</strong></li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5a19056eb10d0b15c553d4133e88eec2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">探索数据结构：BF与KMP的灵活应用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d28eecc8e6ba19b489fd55190bbc06ad/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">dfs和bfs算法详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>