<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python酷库之旅-第三方库openpyxl(15) - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/2abb0d66d05679ec78652f25a501c32c/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Python酷库之旅-第三方库openpyxl(15)">
  <meta property="og:description" content="目录
一、 openpyxl库的由来
1、背景
2、起源
3、发展
4、特点
4-1、支持.xlsx格式
4-2、读写Excel文件
4-3、操作单元格
4-4、创建和修改工作表
4-5、样式设置
4-6、图表和公式
4-7、支持数字和日期格式
二、openpyxl库的优缺点
1、优点
1-1、支持现代Excel格式
1-2、功能丰富
1-3、易于使用
1-4、与Excel兼容性
1-5、性能良好
1-6、社区支持
1-7、跨平台
2、缺点
2-1、不支持旧版格式
2-2、某些特性支持有限
2-3、内存占用
2-4、文档和示例可能不足
2-5、依赖关系
2-6、学习曲线
三、openpyxl库的用途
1、读取Excel文件
2、写入Excel文件
3、修改Excel文件
4、自动化
5、与Excel交互
6、数据迁移和转换
7、创建模板化的报告
四、如何学好openpyxl库？
1、获取openpyxl库的属性和方法
2、获取openpyxl库的帮助信息
3、实战案例
3-141、引用输入了文本的全部单元格
3-142、引用输入了逻辑值的全部单元格
3-143、引用输入了批注的全部单元格
3-144、引用没有输入任何数据和公式的空单元格
3-145、引用所有可见的单元格
3-146、引用输入了日期的单元格
3-147、引用含有相同计算公式的所有单元格
3-148、引用合并单元格区域
3-149、引用定义名称所指定的单元格区域
3-150、引用输入了任何内容的最后一行单元格
3-151、引用多个非连续单元格区域集合(类似Union方法)
3-152、引用多个非连续单元格区域集合(循环处理)
3-153、引用多个单元格区域的交叉区域
3-154、获取计算公式的所有引用单元格
3-155、获取计算公式中引用的其他工作表单元格
3-156、获取某个单元格的从属单元格
3-157、引用某个单元格所在的整个行
3-158、引用某个单元格所在的整个列
3-159、引用单元格区域所在的行范围
3-160、引用单元格区域所在的列范围
五、推荐阅读
1、Python筑基之旅
2、Python函数之旅
3、Python算法之旅
4、Python魔法之旅
5、博客个人主页
一、 openpyxl库的由来 openpyxl库的由来可以总结为以下几点：">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-30T15:06:15+08:00">
    <meta property="article:modified_time" content="2024-06-30T15:06:15+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python酷库之旅-第三方库openpyxl(15)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong><span style="color:#1a439c;">目录</span></strong></p> 
<p id="%E4%B8%80%E3%80%81%20openpyxl%E5%BA%93%E7%9A%84%E7%94%B1%E6%9D%A5-toc" style="margin-left:80px;"><strong><a href="#%E4%B8%80%E3%80%81%20openpyxl%E5%BA%93%E7%9A%84%E7%94%B1%E6%9D%A5" rel="nofollow"><span style="color:#1a439c;">一、 openpyxl库的由来</span></a></strong></p> 
<p id="1%E3%80%81%E8%83%8C%E6%99%AF-toc" style="margin-left:120px;"><strong><a href="#1%E3%80%81%E8%83%8C%E6%99%AF" rel="nofollow"><span style="color:#1a439c;">1、背景</span></a></strong></p> 
<p id="2%E3%80%81%E8%B5%B7%E6%BA%90-toc" style="margin-left:120px;"><strong><a href="#2%E3%80%81%E8%B5%B7%E6%BA%90" rel="nofollow"><span style="color:#1a439c;">2、起源</span></a></strong></p> 
<p id="3%E3%80%81%E5%8F%91%E5%B1%95-toc" style="margin-left:120px;"><strong><a href="#3%E3%80%81%E5%8F%91%E5%B1%95" rel="nofollow"><span style="color:#1a439c;">3、发展</span></a></strong></p> 
<p id="4%E3%80%81%E7%89%B9%E7%82%B9-toc" style="margin-left:120px;"><strong><a href="#4%E3%80%81%E7%89%B9%E7%82%B9" rel="nofollow"><span style="color:#1a439c;">4、特点</span></a></strong></p> 
<p id="4-1%E3%80%81%E6%94%AF%E6%8C%81.xlsx%E6%A0%BC%E5%BC%8F-toc" style="margin-left:160px;"><strong><a href="#4-1%E3%80%81%E6%94%AF%E6%8C%81.xlsx%E6%A0%BC%E5%BC%8F" rel="nofollow"><span style="color:#1a439c;">4-1、支持.xlsx格式</span></a></strong></p> 
<p id="4-2%E3%80%81%E8%AF%BB%E5%86%99Excel%E6%96%87%E4%BB%B6-toc" style="margin-left:160px;"><strong><a href="#4-2%E3%80%81%E8%AF%BB%E5%86%99Excel%E6%96%87%E4%BB%B6" rel="nofollow"><span style="color:#1a439c;">4-2、读写Excel文件</span></a></strong></p> 
<p id="4-3%E3%80%81%E6%93%8D%E4%BD%9C%E5%8D%95%E5%85%83%E6%A0%BC-toc" style="margin-left:160px;"><strong><a href="#4-3%E3%80%81%E6%93%8D%E4%BD%9C%E5%8D%95%E5%85%83%E6%A0%BC" rel="nofollow"><span style="color:#1a439c;">4-3、操作单元格</span></a></strong></p> 
<p id="4-4%E3%80%81%E5%88%9B%E5%BB%BA%E5%92%8C%E4%BF%AE%E6%94%B9%E5%B7%A5%E4%BD%9C%E8%A1%A8-toc" style="margin-left:160px;"><strong><a href="#4-4%E3%80%81%E5%88%9B%E5%BB%BA%E5%92%8C%E4%BF%AE%E6%94%B9%E5%B7%A5%E4%BD%9C%E8%A1%A8" rel="nofollow"><span style="color:#1a439c;">4-4、创建和修改工作表</span></a></strong></p> 
<p id="4-5%E3%80%81%E6%A0%B7%E5%BC%8F%E8%AE%BE%E7%BD%AE-toc" style="margin-left:160px;"><strong><a href="#4-5%E3%80%81%E6%A0%B7%E5%BC%8F%E8%AE%BE%E7%BD%AE" rel="nofollow"><span style="color:#1a439c;">4-5、样式设置</span></a></strong></p> 
<p id="4-6%E3%80%81%E5%9B%BE%E8%A1%A8%E5%92%8C%E5%85%AC%E5%BC%8F-toc" style="margin-left:160px;"><strong><a href="#4-6%E3%80%81%E5%9B%BE%E8%A1%A8%E5%92%8C%E5%85%AC%E5%BC%8F" rel="nofollow"><span style="color:#1a439c;">4-6、图表和公式</span></a></strong></p> 
<p id="4-7%E3%80%81%E6%94%AF%E6%8C%81%E6%95%B0%E5%AD%97%E5%92%8C%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F-toc" style="margin-left:160px;"><strong><a href="#4-7%E3%80%81%E6%94%AF%E6%8C%81%E6%95%B0%E5%AD%97%E5%92%8C%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F" rel="nofollow"><span style="color:#1a439c;">4-7、支持数字和日期格式</span></a></strong></p> 
<p id="%E4%BA%8C%E3%80%81openpyxl%E5%BA%93%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9-toc" style="margin-left:80px;"><strong><a href="#%E4%BA%8C%E3%80%81openpyxl%E5%BA%93%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9" rel="nofollow"><span style="color:#1a439c;">二、openpyxl库的优缺点</span></a></strong></p> 
<p id="1%E3%80%81%E4%BC%98%E7%82%B9-toc" style="margin-left:120px;"><strong><a href="#1%E3%80%81%E4%BC%98%E7%82%B9" rel="nofollow"><span style="color:#1a439c;">1、优点</span></a></strong></p> 
<p id="1-1%E3%80%81%E6%94%AF%E6%8C%81%E7%8E%B0%E4%BB%A3Excel%E6%A0%BC%E5%BC%8F-toc" style="margin-left:160px;"><strong><a href="#1-1%E3%80%81%E6%94%AF%E6%8C%81%E7%8E%B0%E4%BB%A3Excel%E6%A0%BC%E5%BC%8F" rel="nofollow"><span style="color:#1a439c;">1-1、支持现代Excel格式</span></a></strong></p> 
<p id="1-2%E3%80%81%E5%8A%9F%E8%83%BD%E4%B8%B0%E5%AF%8C-toc" style="margin-left:160px;"><strong><a href="#1-2%E3%80%81%E5%8A%9F%E8%83%BD%E4%B8%B0%E5%AF%8C" rel="nofollow"><span style="color:#1a439c;">1-2、功能丰富</span></a></strong></p> 
<p id="1-3%E3%80%81%E6%98%93%E4%BA%8E%E4%BD%BF%E7%94%A8-toc" style="margin-left:160px;"><strong><a href="#1-3%E3%80%81%E6%98%93%E4%BA%8E%E4%BD%BF%E7%94%A8" rel="nofollow"><span style="color:#1a439c;">1-3、易于使用</span></a></strong></p> 
<p id="1-4%E3%80%81%E4%B8%8EExcel%E5%85%BC%E5%AE%B9%E6%80%A7-toc" style="margin-left:160px;"><strong><a href="#1-4%E3%80%81%E4%B8%8EExcel%E5%85%BC%E5%AE%B9%E6%80%A7" rel="nofollow"><span style="color:#1a439c;">1-4、与Excel兼容性</span></a></strong></p> 
<p id="1-5%E3%80%81%E6%80%A7%E8%83%BD%E8%89%AF%E5%A5%BD-toc" style="margin-left:160px;"><strong><a href="#1-5%E3%80%81%E6%80%A7%E8%83%BD%E8%89%AF%E5%A5%BD" rel="nofollow"><span style="color:#1a439c;">1-5、性能良好</span></a></strong></p> 
<p id="1-6%E3%80%81%E7%A4%BE%E5%8C%BA%E6%94%AF%E6%8C%81-toc" style="margin-left:160px;"><strong><a href="#1-6%E3%80%81%E7%A4%BE%E5%8C%BA%E6%94%AF%E6%8C%81" rel="nofollow"><span style="color:#1a439c;">1-6、社区支持</span></a></strong></p> 
<p id="1-7%E3%80%81%E8%B7%A8%E5%B9%B3%E5%8F%B0-toc" style="margin-left:160px;"><strong><a href="#1-7%E3%80%81%E8%B7%A8%E5%B9%B3%E5%8F%B0" rel="nofollow"><span style="color:#1a439c;">1-7、跨平台</span></a></strong></p> 
<p id="2%E3%80%81%E7%BC%BA%E7%82%B9-toc" style="margin-left:120px;"><strong><a href="#2%E3%80%81%E7%BC%BA%E7%82%B9" rel="nofollow"><span style="color:#1a439c;">2、缺点</span></a></strong></p> 
<p id="2-1%E3%80%81%E4%B8%8D%E6%94%AF%E6%8C%81%E6%97%A7%E7%89%88%E6%A0%BC%E5%BC%8F-toc" style="margin-left:160px;"><strong><a href="#2-1%E3%80%81%E4%B8%8D%E6%94%AF%E6%8C%81%E6%97%A7%E7%89%88%E6%A0%BC%E5%BC%8F" rel="nofollow"><span style="color:#1a439c;">2-1、不支持旧版格式</span></a></strong></p> 
<p id="2-2%E3%80%81%E6%9F%90%E4%BA%9B%E7%89%B9%E6%80%A7%E6%94%AF%E6%8C%81%E6%9C%89%E9%99%90-toc" style="margin-left:160px;"><strong><a href="#2-2%E3%80%81%E6%9F%90%E4%BA%9B%E7%89%B9%E6%80%A7%E6%94%AF%E6%8C%81%E6%9C%89%E9%99%90" rel="nofollow"><span style="color:#1a439c;">2-2、某些特性支持有限</span></a></strong></p> 
<p id="2-3%E3%80%81%E5%86%85%E5%AD%98%E5%8D%A0%E7%94%A8-toc" style="margin-left:160px;"><strong><a href="#2-3%E3%80%81%E5%86%85%E5%AD%98%E5%8D%A0%E7%94%A8" rel="nofollow"><span style="color:#1a439c;">2-3、内存占用</span></a></strong></p> 
<p id="2-4%E3%80%81%E6%96%87%E6%A1%A3%E5%92%8C%E7%A4%BA%E4%BE%8B%E5%8F%AF%E8%83%BD%E4%B8%8D%E8%B6%B3-toc" style="margin-left:160px;"><strong><a href="#2-4%E3%80%81%E6%96%87%E6%A1%A3%E5%92%8C%E7%A4%BA%E4%BE%8B%E5%8F%AF%E8%83%BD%E4%B8%8D%E8%B6%B3" rel="nofollow"><span style="color:#1a439c;">2-4、文档和示例可能不足</span></a></strong></p> 
<p id="2-5.%E3%80%81%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB-toc" style="margin-left:160px;"><strong><a href="#2-5.%E3%80%81%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB" rel="nofollow"><span style="color:#1a439c;">2-5、依赖关系</span></a></strong></p> 
<p id="2-6%E3%80%81%E5%AD%A6%E4%B9%A0%E6%9B%B2%E7%BA%BF-toc" style="margin-left:160px;"><strong><a href="#2-6%E3%80%81%E5%AD%A6%E4%B9%A0%E6%9B%B2%E7%BA%BF" rel="nofollow"><span style="color:#1a439c;">2-6、学习曲线</span></a></strong></p> 
<p id="%E4%B8%89%E3%80%81openpyxl%E5%BA%93%E7%9A%84%E7%94%A8%E9%80%94-toc" style="margin-left:80px;"><strong><a href="#%E4%B8%89%E3%80%81openpyxl%E5%BA%93%E7%9A%84%E7%94%A8%E9%80%94" rel="nofollow"><span style="color:#1a439c;">三、openpyxl库的用途</span></a></strong></p> 
<p id="1%E3%80%81%E8%AF%BB%E5%8F%96Excel%E6%96%87%E4%BB%B6-toc" style="margin-left:120px;"><strong><a href="#1%E3%80%81%E8%AF%BB%E5%8F%96Excel%E6%96%87%E4%BB%B6" rel="nofollow"><span style="color:#1a439c;">1、读取Excel文件</span></a></strong></p> 
<p id="2%E3%80%81%E5%86%99%E5%85%A5Excel%E6%96%87%E4%BB%B6-toc" style="margin-left:120px;"><strong><a href="#2%E3%80%81%E5%86%99%E5%85%A5Excel%E6%96%87%E4%BB%B6" rel="nofollow"><span style="color:#1a439c;">2、写入Excel文件</span></a></strong></p> 
<p id="3%E3%80%81%E4%BF%AE%E6%94%B9Excel%E6%96%87%E4%BB%B6-toc" style="margin-left:120px;"><strong><a href="#3%E3%80%81%E4%BF%AE%E6%94%B9Excel%E6%96%87%E4%BB%B6" rel="nofollow"><span style="color:#1a439c;">3、修改Excel文件</span></a></strong></p> 
<p id="4%E3%80%81%E8%87%AA%E5%8A%A8%E5%8C%96-toc" style="margin-left:120px;"><strong><a href="#4%E3%80%81%E8%87%AA%E5%8A%A8%E5%8C%96" rel="nofollow"><span style="color:#1a439c;">4、自动化</span></a></strong></p> 
<p id="5%E3%80%81%E4%B8%8EExcel%E4%BA%A4%E4%BA%92-toc" style="margin-left:120px;"><strong><a href="#5%E3%80%81%E4%B8%8EExcel%E4%BA%A4%E4%BA%92" rel="nofollow"><span style="color:#1a439c;">5、与Excel交互</span></a></strong></p> 
<p id="6%E3%80%81%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E5%92%8C%E8%BD%AC%E6%8D%A2-toc" style="margin-left:120px;"><strong><a href="#6%E3%80%81%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E5%92%8C%E8%BD%AC%E6%8D%A2" rel="nofollow"><span style="color:#1a439c;">6、数据迁移和转换</span></a></strong></p> 
<p id="7%E3%80%81%E5%88%9B%E5%BB%BA%E6%A8%A1%E6%9D%BF%E5%8C%96%E7%9A%84%E6%8A%A5%E5%91%8A-toc" style="margin-left:120px;"><strong><a href="#7%E3%80%81%E5%88%9B%E5%BB%BA%E6%A8%A1%E6%9D%BF%E5%8C%96%E7%9A%84%E6%8A%A5%E5%91%8A" rel="nofollow"><span style="color:#1a439c;">7、创建模板化的报告</span></a></strong></p> 
<p id="%E5%9B%9B%E3%80%81%E5%A6%82%E4%BD%95%E5%AD%A6%E5%A5%BDopenpyxl%E5%BA%93%EF%BC%9F-toc" style="margin-left:80px;"><strong><a href="#%E5%9B%9B%E3%80%81%E5%A6%82%E4%BD%95%E5%AD%A6%E5%A5%BDopenpyxl%E5%BA%93%EF%BC%9F" rel="nofollow"><span style="color:#1a439c;">四、如何学好openpyxl库？</span></a></strong></p> 
<p id="1%E3%80%81%E8%8E%B7%E5%8F%96xlrd%E5%BA%93%E7%9A%84%E5%B1%9E%E6%80%A7%E5%92%8C%E6%96%B9%E6%B3%95-toc" style="margin-left:120px;"><strong><a href="#1%E3%80%81%E8%8E%B7%E5%8F%96xlrd%E5%BA%93%E7%9A%84%E5%B1%9E%E6%80%A7%E5%92%8C%E6%96%B9%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">1、获取openpyxl库的属性和方法</span></a></strong></p> 
<p id="2%E3%80%81%E8%8E%B7%E5%8F%96xlrd%E5%BA%93%E7%9A%84%E5%B8%AE%E5%8A%A9%E4%BF%A1%E6%81%AF-toc" style="margin-left:120px;"><strong><a href="#2%E3%80%81%E8%8E%B7%E5%8F%96xlrd%E5%BA%93%E7%9A%84%E5%B8%AE%E5%8A%A9%E4%BF%A1%E6%81%AF" rel="nofollow"><span style="color:#1a439c;">2、获取openpyxl库的帮助信息</span></a></strong></p> 
<p id="3%E3%80%81%E7%94%A8%E6%B3%95%E7%B2%BE%E8%AE%B2-toc" style="margin-left:120px;"><strong><a href="#3%E3%80%81%E7%94%A8%E6%B3%95%E7%B2%BE%E8%AE%B2" rel="nofollow"><span style="color:#1a439c;">3、实战案例</span></a></strong></p> 
<p id="3-1%E3%80%81cellname%E5%87%BD%E6%95%B0-toc" style="margin-left:160px;"><strong><a href="#3-1%E3%80%81cellname%E5%87%BD%E6%95%B0" rel="nofollow"><span style="color:#1a439c;">3-141、引用输入了文本的全部单元格</span></a></strong></p> 
<p id="3-142%E3%80%81%E5%BC%95%E7%94%A8%E8%BE%93%E5%85%A5%E4%BA%86%E9%80%BB%E8%BE%91%E5%80%BC%E7%9A%84%E5%85%A8%E9%83%A8%E5%8D%95%E5%85%83%E6%A0%BC-toc" style="margin-left:160px;"><strong><a href="#3-142%E3%80%81%E5%BC%95%E7%94%A8%E8%BE%93%E5%85%A5%E4%BA%86%E9%80%BB%E8%BE%91%E5%80%BC%E7%9A%84%E5%85%A8%E9%83%A8%E5%8D%95%E5%85%83%E6%A0%BC" rel="nofollow"><span style="color:#1a439c;">3-142、引用输入了逻辑值的全部单元格</span></a></strong></p> 
<p id="3-143%E3%80%81%E5%BC%95%E7%94%A8%E8%BE%93%E5%85%A5%E4%BA%86%E6%89%B9%E6%B3%A8%E7%9A%84%E5%85%A8%E9%83%A8%E5%8D%95%E5%85%83%E6%A0%BC-toc" style="margin-left:160px;"><strong><a href="#3-143%E3%80%81%E5%BC%95%E7%94%A8%E8%BE%93%E5%85%A5%E4%BA%86%E6%89%B9%E6%B3%A8%E7%9A%84%E5%85%A8%E9%83%A8%E5%8D%95%E5%85%83%E6%A0%BC" rel="nofollow"><span style="color:#1a439c;">3-143、引用输入了批注的全部单元格</span></a></strong></p> 
<p id="3-144%E3%80%81%E5%BC%95%E7%94%A8%E6%B2%A1%E6%9C%89%E8%BE%93%E5%85%A5%E4%BB%BB%E4%BD%95%E6%95%B0%E6%8D%AE%E5%92%8C%E5%85%AC%E5%BC%8F%E7%9A%84%E7%A9%BA%E5%8D%95%E5%85%83%E6%A0%BC-toc" style="margin-left:160px;"><strong><a href="#3-144%E3%80%81%E5%BC%95%E7%94%A8%E6%B2%A1%E6%9C%89%E8%BE%93%E5%85%A5%E4%BB%BB%E4%BD%95%E6%95%B0%E6%8D%AE%E5%92%8C%E5%85%AC%E5%BC%8F%E7%9A%84%E7%A9%BA%E5%8D%95%E5%85%83%E6%A0%BC" rel="nofollow"><span style="color:#1a439c;">3-144、引用没有输入任何数据和公式的空单元格</span></a></strong></p> 
<p id="3-145%E3%80%81%E5%BC%95%E7%94%A8%E6%89%80%E6%9C%89%E5%8F%AF%E8%A7%81%E7%9A%84%E5%8D%95%E5%85%83%E6%A0%BC-toc" style="margin-left:160px;"><strong><a href="#3-145%E3%80%81%E5%BC%95%E7%94%A8%E6%89%80%E6%9C%89%E5%8F%AF%E8%A7%81%E7%9A%84%E5%8D%95%E5%85%83%E6%A0%BC" rel="nofollow"><span style="color:#1a439c;">3-145、引用所有可见的单元格</span></a></strong></p> 
<p id="3-146%E3%80%81%E5%BC%95%E7%94%A8%E8%BE%93%E5%85%A5%E4%BA%86%E6%97%A5%E6%9C%9F%E7%9A%84%E5%8D%95%E5%85%83%E6%A0%BC-toc" style="margin-left:160px;"><strong><a href="#3-146%E3%80%81%E5%BC%95%E7%94%A8%E8%BE%93%E5%85%A5%E4%BA%86%E6%97%A5%E6%9C%9F%E7%9A%84%E5%8D%95%E5%85%83%E6%A0%BC" rel="nofollow"><span style="color:#1a439c;">3-146、引用输入了日期的单元格</span></a></strong></p> 
<p id="3-147%E3%80%81%E5%BC%95%E7%94%A8%E5%90%AB%E6%9C%89%E7%9B%B8%E5%90%8C%E8%AE%A1%E7%AE%97%E5%85%AC%E5%BC%8F%E7%9A%84%E6%89%80%E6%9C%89%E5%8D%95%E5%85%83%E6%A0%BC-toc" style="margin-left:160px;"><strong><a href="#3-147%E3%80%81%E5%BC%95%E7%94%A8%E5%90%AB%E6%9C%89%E7%9B%B8%E5%90%8C%E8%AE%A1%E7%AE%97%E5%85%AC%E5%BC%8F%E7%9A%84%E6%89%80%E6%9C%89%E5%8D%95%E5%85%83%E6%A0%BC" rel="nofollow"><span style="color:#1a439c;">3-147、引用含有相同计算公式的所有单元格</span></a></strong></p> 
<p id="3-148%E3%80%81%E5%BC%95%E7%94%A8%E5%90%88%E5%B9%B6%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F-toc" style="margin-left:160px;"><strong><a href="#3-148%E3%80%81%E5%BC%95%E7%94%A8%E5%90%88%E5%B9%B6%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F" rel="nofollow"><span style="color:#1a439c;">3-148、引用合并单元格区域</span></a></strong></p> 
<p id="3-149%E3%80%81%E5%BC%95%E7%94%A8%E5%AE%9A%E4%B9%89%E5%90%8D%E7%A7%B0%E6%89%80%E6%8C%87%E5%AE%9A%E7%9A%84%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F-toc" style="margin-left:160px;"><strong><a href="#3-149%E3%80%81%E5%BC%95%E7%94%A8%E5%AE%9A%E4%B9%89%E5%90%8D%E7%A7%B0%E6%89%80%E6%8C%87%E5%AE%9A%E7%9A%84%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F" rel="nofollow"><span style="color:#1a439c;">3-149、引用定义名称所指定的单元格区域</span></a></strong></p> 
<p id="3-150%E3%80%81%E5%BC%95%E7%94%A8%E8%BE%93%E5%85%A5%E4%BA%86%E4%BB%BB%E4%BD%95%E5%86%85%E5%AE%B9%E7%9A%84%E6%9C%80%E5%90%8E%E4%B8%80%E8%A1%8C%E5%8D%95%E5%85%83%E6%A0%BC-toc" style="margin-left:160px;"><strong><a href="#3-150%E3%80%81%E5%BC%95%E7%94%A8%E8%BE%93%E5%85%A5%E4%BA%86%E4%BB%BB%E4%BD%95%E5%86%85%E5%AE%B9%E7%9A%84%E6%9C%80%E5%90%8E%E4%B8%80%E8%A1%8C%E5%8D%95%E5%85%83%E6%A0%BC" rel="nofollow"><span style="color:#1a439c;">3-150、引用输入了任何内容的最后一行单元格</span></a></strong></p> 
<p id="3-151%E3%80%81%E5%BC%95%E7%94%A8%E5%A4%9A%E4%B8%AA%E9%9D%9E%E8%BF%9E%E7%BB%AD%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E9%9B%86%E5%90%88(%E7%B1%BB%E4%BC%BCUnion%E6%96%B9%E6%B3%95)-toc" style="margin-left:160px;"><strong><a href="#3-151%E3%80%81%E5%BC%95%E7%94%A8%E5%A4%9A%E4%B8%AA%E9%9D%9E%E8%BF%9E%E7%BB%AD%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E9%9B%86%E5%90%88%28%E7%B1%BB%E4%BC%BCUnion%E6%96%B9%E6%B3%95%29" rel="nofollow"><span style="color:#1a439c;">3-151、引用多个非连续单元格区域集合(类似Union方法)</span></a></strong></p> 
<p id="3-152%E3%80%81%E5%BC%95%E7%94%A8%E5%A4%9A%E4%B8%AA%E9%9D%9E%E8%BF%9E%E7%BB%AD%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E9%9B%86%E5%90%88(%E5%BE%AA%E7%8E%AF%E5%A4%84%E7%90%86)-toc" style="margin-left:160px;"><strong><a href="#3-152%E3%80%81%E5%BC%95%E7%94%A8%E5%A4%9A%E4%B8%AA%E9%9D%9E%E8%BF%9E%E7%BB%AD%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E9%9B%86%E5%90%88%28%E5%BE%AA%E7%8E%AF%E5%A4%84%E7%90%86%29" rel="nofollow"><span style="color:#1a439c;">3-152、引用多个非连续单元格区域集合(循环处理)</span></a></strong></p> 
<p id="3-153%E3%80%81%E5%BC%95%E7%94%A8%E5%A4%9A%E4%B8%AA%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E7%9A%84%E4%BA%A4%E5%8F%89%E5%8C%BA%E5%9F%9F-toc" style="margin-left:160px;"><strong><a href="#3-153%E3%80%81%E5%BC%95%E7%94%A8%E5%A4%9A%E4%B8%AA%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E7%9A%84%E4%BA%A4%E5%8F%89%E5%8C%BA%E5%9F%9F" rel="nofollow"><span style="color:#1a439c;">3-153、引用多个单元格区域的交叉区域</span></a></strong></p> 
<p id="3-154%E3%80%81%E8%8E%B7%E5%8F%96%E8%AE%A1%E7%AE%97%E5%85%AC%E5%BC%8F%E7%9A%84%E6%89%80%E6%9C%89%E5%BC%95%E7%94%A8%E5%8D%95%E5%85%83%E6%A0%BC-toc" style="margin-left:160px;"><strong><a href="#3-154%E3%80%81%E8%8E%B7%E5%8F%96%E8%AE%A1%E7%AE%97%E5%85%AC%E5%BC%8F%E7%9A%84%E6%89%80%E6%9C%89%E5%BC%95%E7%94%A8%E5%8D%95%E5%85%83%E6%A0%BC" rel="nofollow"><span style="color:#1a439c;">3-154、获取计算公式的所有引用单元格</span></a></strong></p> 
<p id="3-155%E3%80%81%E8%8E%B7%E5%8F%96%E8%AE%A1%E7%AE%97%E5%85%AC%E5%BC%8F%E4%B8%AD%E5%BC%95%E7%94%A8%E7%9A%84%E5%85%B6%E4%BB%96%E5%B7%A5%E4%BD%9C%E8%A1%A8%E5%8D%95%E5%85%83%E6%A0%BC-toc" style="margin-left:160px;"><strong><a href="#3-155%E3%80%81%E8%8E%B7%E5%8F%96%E8%AE%A1%E7%AE%97%E5%85%AC%E5%BC%8F%E4%B8%AD%E5%BC%95%E7%94%A8%E7%9A%84%E5%85%B6%E4%BB%96%E5%B7%A5%E4%BD%9C%E8%A1%A8%E5%8D%95%E5%85%83%E6%A0%BC" rel="nofollow"><span style="color:#1a439c;">3-155、获取计算公式中引用的其他工作表单元格</span></a></strong></p> 
<p id="3-156%E3%80%81%E8%8E%B7%E5%8F%96%E6%9F%90%E4%B8%AA%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E4%BB%8E%E5%B1%9E%E5%8D%95%E5%85%83%E6%A0%BC-toc" style="margin-left:160px;"><strong><a href="#3-156%E3%80%81%E8%8E%B7%E5%8F%96%E6%9F%90%E4%B8%AA%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E4%BB%8E%E5%B1%9E%E5%8D%95%E5%85%83%E6%A0%BC" rel="nofollow"><span style="color:#1a439c;">3-156、获取某个单元格的从属单元格</span></a></strong></p> 
<p id="3-157%E3%80%81%E5%BC%95%E7%94%A8%E6%9F%90%E4%B8%AA%E5%8D%95%E5%85%83%E6%A0%BC%E6%89%80%E5%9C%A8%E7%9A%84%E6%95%B4%E4%B8%AA%E8%A1%8C-toc" style="margin-left:160px;"><strong><a href="#3-157%E3%80%81%E5%BC%95%E7%94%A8%E6%9F%90%E4%B8%AA%E5%8D%95%E5%85%83%E6%A0%BC%E6%89%80%E5%9C%A8%E7%9A%84%E6%95%B4%E4%B8%AA%E8%A1%8C" rel="nofollow"><span style="color:#1a439c;">3-157、引用某个单元格所在的整个行</span></a></strong></p> 
<p id="3-158%E3%80%81%E5%BC%95%E7%94%A8%E6%9F%90%E4%B8%AA%E5%8D%95%E5%85%83%E6%A0%BC%E6%89%80%E5%9C%A8%E7%9A%84%E6%95%B4%E4%B8%AA%E5%88%97-toc" style="margin-left:160px;"><strong><a href="#3-158%E3%80%81%E5%BC%95%E7%94%A8%E6%9F%90%E4%B8%AA%E5%8D%95%E5%85%83%E6%A0%BC%E6%89%80%E5%9C%A8%E7%9A%84%E6%95%B4%E4%B8%AA%E5%88%97" rel="nofollow"><span style="color:#1a439c;">3-158、引用某个单元格所在的整个列</span></a></strong></p> 
<p id="3-159%E3%80%81%E5%BC%95%E7%94%A8%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E6%89%80%E5%9C%A8%E7%9A%84%E8%A1%8C%E8%8C%83%E5%9B%B4-toc" style="margin-left:160px;"><strong><a href="#3-159%E3%80%81%E5%BC%95%E7%94%A8%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E6%89%80%E5%9C%A8%E7%9A%84%E8%A1%8C%E8%8C%83%E5%9B%B4" rel="nofollow"><span style="color:#1a439c;">3-159、引用单元格区域所在的行范围</span></a></strong></p> 
<p id="3-160%E3%80%81%E5%BC%95%E7%94%A8%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E6%89%80%E5%9C%A8%E7%9A%84%E5%88%97%E8%8C%83%E5%9B%B4-toc" style="margin-left:160px;"><strong><a href="#3-160%E3%80%81%E5%BC%95%E7%94%A8%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E6%89%80%E5%9C%A8%E7%9A%84%E5%88%97%E8%8C%83%E5%9B%B4" rel="nofollow"><span style="color:#1a439c;">3-160、引用单元格区域所在的列范围</span></a></strong></p> 
<p id="%E4%BA%94%E3%80%81%E6%8E%A8%E8%8D%90%E9%98%85%E8%AF%BB-toc" style="margin-left:80px;"><strong><a href="#%E4%BA%94%E3%80%81%E6%8E%A8%E8%8D%90%E9%98%85%E8%AF%BB" rel="nofollow"><span style="color:#1a439c;">五、推荐阅读</span></a></strong></p> 
<p id="1%E3%80%81-toc" style="margin-left:120px;"><strong><a href="#1%E3%80%81" rel="nofollow"><span style="color:#1a439c;">1、Python筑基之旅</span></a></strong></p> 
<p id="2%E3%80%81-toc" style="margin-left:120px;"><strong><a href="#2%E3%80%81" rel="nofollow"><span style="color:#1a439c;">2、Python函数之旅</span></a></strong></p> 
<p id="3%E3%80%81-toc" style="margin-left:120px;"><strong><a href="#3%E3%80%81" rel="nofollow"><span style="color:#1a439c;">3、Python算法之旅</span></a></strong></p> 
<p id="4%E3%80%81-toc" style="margin-left:120px;"><strong><a href="#4%E3%80%81" rel="nofollow"><span style="color:#1a439c;">4、Python魔法之旅</span></a></strong></p> 
<p id="5%E3%80%81%C2%A0-toc" style="margin-left:120px;"><strong><a href="#5%E3%80%81%C2%A0" rel="nofollow"><span style="color:#1a439c;">5、博客个人主页</span></a></strong></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/39/48/fM8XG1pt_o.gif"></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/46/ed/mtUkGCax_o.png"></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/9c/fa/Qvzkhwje_o.gif"></p> 
<h4 id="%E4%B8%80%E3%80%81%20openpyxl%E5%BA%93%E7%9A%84%E7%94%B1%E6%9D%A5">一、 openpyxl库的由来</h4> 
<p>        openpyxl库的由来可以总结为以下几点：</p> 
<h5 id="1%E3%80%81%E8%83%8C%E6%99%AF">1、背景</h5> 
<p>        在openpyxl库诞生之前，Python中缺乏一个专门用于读取和编写Office Open XML格式(如Excel 2010及更高版本的.xlsx文件)的库。</p> 
<h5 id="2%E3%80%81%E8%B5%B7%E6%BA%90">2、起源</h5> 
<p>        openpyxl库的创建是为了解决上述提到的Python在处理Excel文件时的不足，它的开发受到了PHPExcel团队的启发，因为openpyxl最初是基于PHPExcel的。</p> 
<h5 id="3%E3%80%81%E5%8F%91%E5%B1%95">3、发展</h5> 
<p>        随着时间的推移，openpyxl逐渐发展成为一个功能强大的Python库，专门用于处理Excel文件。它支持Excel 2010及更高版本的文件格式，并提供了丰富的API，用于读取、写入、修改Excel文件。</p> 
<h5 id="4%E3%80%81%E7%89%B9%E7%82%B9">4、特点</h5> 
<h6 id="4-1%E3%80%81%E6%94%AF%E6%8C%81.xlsx%E6%A0%BC%E5%BC%8F">4-1、支持.xlsx格式</h6> 
<p>        openpyxl主要用于处理Excel 2010及更新版本的.xlsx文件。</p> 
<h6 id="4-2%E3%80%81%E8%AF%BB%E5%86%99Excel%E6%96%87%E4%BB%B6">4-2、读写Excel文件</h6> 
<p>        使用openpyxl可以读取现有的Excel文件，获取数据，修改数据，并保存到新的文件中。</p> 
<h6 id="4-3%E3%80%81%E6%93%8D%E4%BD%9C%E5%8D%95%E5%85%83%E6%A0%BC">4-3、操作单元格</h6> 
<p>        openpyxl允许用户按行、列或具体的单元格进行数据的读取和写入。</p> 
<h6 id="4-4%E3%80%81%E5%88%9B%E5%BB%BA%E5%92%8C%E4%BF%AE%E6%94%B9%E5%B7%A5%E4%BD%9C%E8%A1%A8">4-4、创建和修改工作表</h6> 
<p>        用户可以创建新的工作表，复制和删除现有的工作表，设置工作表的属性等。</p> 
<h6 id="4-5%E3%80%81%E6%A0%B7%E5%BC%8F%E8%AE%BE%E7%BD%AE">4-5、样式设置</h6> 
<p>        openpyxl支持设置单元格的字体、颜色、边框等样式。</p> 
<h6 id="4-6%E3%80%81%E5%9B%BE%E8%A1%A8%E5%92%8C%E5%85%AC%E5%BC%8F">4-6、图表和公式</h6> 
<p>        用户可以通过openpyxl创建图表、添加公式等。</p> 
<h6 id="4-7%E3%80%81%E6%94%AF%E6%8C%81%E6%95%B0%E5%AD%97%E5%92%8C%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F">4-7、支持数字和日期格式</h6> 
<p>        openpyxl能够正确处理数字和日期格式，确保在Excel中显示正确的格式。</p> 
<p>        综上所述，openpyxl库的出现填补了Python在处理Excel文件时的空白，经过不断的发展和完善，成为了一个功能丰富、易于使用的Python库。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/2c/bc/0T7HdglH_o.png"></p> 
<h4 id="%E4%BA%8C%E3%80%81openpyxl%E5%BA%93%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9">二、openpyxl库的<span style="color:#1c7331;">优</span><span style="color:#fe2c24;">缺</span>点</h4> 
<p>        <span style="color:#fe2c24;"><strong>openpyxl库</strong></span>是一个<span style="color:#fe2c24;"><strong>用于读写Excel 2010 xlsx/xlsm/xltx/xltm文件的Python库</strong></span>，它基于Python，并且对于处理Excel文件提供了很多便利的功能，其主要<strong><span style="color:#1c7331;">优</span><span style="color:#fe2c24;">缺</span></strong>点有：</p> 
<h5 id="1%E3%80%81%E4%BC%98%E7%82%B9"><span style="color:#1c7331;"><strong>1、优点</strong></span></h5> 
<h6 id="1-1%E3%80%81%E6%94%AF%E6%8C%81%E7%8E%B0%E4%BB%A3Excel%E6%A0%BC%E5%BC%8F"><span style="color:#1c7331;"><strong>1-1、支持现代Excel格式</strong></span></h6> 
<p>        openpyxl支持.xlsx格式的Excel文件，这是Excel 2010及更高版本使用的格式，也是目前广泛使用的格式。</p> 
<h6 id="1-2%E3%80%81%E5%8A%9F%E8%83%BD%E4%B8%B0%E5%AF%8C"><span style="color:#1c7331;"><strong>1-2、功能丰富</strong></span></h6> 
<p>        openpyxl提供了<span style="color:#fe2c24;"><strong>创建、修改和保存Excel工作簿、工作表、单元格、图表、公式、图像</strong></span>等功能。</p> 
<h6 id="1-3%E3%80%81%E6%98%93%E4%BA%8E%E4%BD%BF%E7%94%A8"><span style="color:#1c7331;"><strong>1-3、易于使用</strong></span></h6> 
<p>        openpyxl的API设计得相对直观，使得Python开发者能够很容易地掌握和使用。</p> 
<h6 id="1-4%E3%80%81%E4%B8%8EExcel%E5%85%BC%E5%AE%B9%E6%80%A7"><span style="color:#1c7331;"><strong>1-4、与Excel兼容性</strong></span></h6> 
<p>        openpyxl能够处理Excel文件中的很多复杂特性，如公式、样式、条件格式等，这确保了与Excel的良好兼容性。</p> 
<h6 id="1-5%E3%80%81%E6%80%A7%E8%83%BD%E8%89%AF%E5%A5%BD"><span style="color:#1c7331;"><strong>1-5、性能良好</strong></span></h6> 
<p>        在处理大型Excel文件时，openpyxl通常能够保持较好的性能。</p> 
<h6 id="1-6%E3%80%81%E7%A4%BE%E5%8C%BA%E6%94%AF%E6%8C%81"><span style="color:#1c7331;"><strong>1-6、社区支持</strong></span></h6> 
<p>        openpyxl是一个开源项目，拥有活跃的社区支持和维护，这意味着开发者可以获得帮助和修复错误的快速响应。</p> 
<h6 id="1-7%E3%80%81%E8%B7%A8%E5%B9%B3%E5%8F%B0"><span style="color:#1c7331;"><strong>1-7、跨平台</strong></span></h6> 
<p>        openpyxl可以在不同的操作系统上运行，包括Windows、Linux和macOS等。</p> 
<h5 id="2%E3%80%81%E7%BC%BA%E7%82%B9"><span style="color:#fe2c24;"><strong>2、缺点</strong></span></h5> 
<h6 id="2-1%E3%80%81%E4%B8%8D%E6%94%AF%E6%8C%81%E6%97%A7%E7%89%88%E6%A0%BC%E5%BC%8F"><span style="color:#fe2c24;"><strong>2-1、不支持旧版格式</strong></span></h6> 
<p>        openpyxl不支持较旧的.xls格式(Excel 97-2003)。如果需要处理这种格式的文件，需要使用其他库如xlrd和xlwt(尽管这些库也面临一些兼容性和维护问题)。</p> 
<h6 id="2-2%E3%80%81%E6%9F%90%E4%BA%9B%E7%89%B9%E6%80%A7%E6%94%AF%E6%8C%81%E6%9C%89%E9%99%90"><span style="color:#fe2c24;"><strong>2-2、某些特性支持有限</strong></span></h6> 
<p>        虽然openpyxl支持许多Excel特性，但可能对于某些高级或特定的Excel功能支持有限或不支持。</p> 
<h6 id="2-3%E3%80%81%E5%86%85%E5%AD%98%E5%8D%A0%E7%94%A8"><span style="color:#fe2c24;"><strong>2-3、内存占用</strong></span></h6> 
<p>        在处理大型Excel文件时，openpyxl可能会占用较多的内存。这是因为openpyxl会将整个工作簿加载到内存中。</p> 
<h6 id="2-4%E3%80%81%E6%96%87%E6%A1%A3%E5%92%8C%E7%A4%BA%E4%BE%8B%E5%8F%AF%E8%83%BD%E4%B8%8D%E8%B6%B3"><span style="color:#fe2c24;"><strong>2-4、文档和示例可能不足</strong></span></h6> 
<p>        尽管openpyxl的文档相对完整，但对于某些高级功能或特定用例，可能缺乏足够的示例或详细解释。</p> 
<h6 id="2-5.%E3%80%81%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB"><span style="color:#fe2c24;"><strong>2-5、依赖关系</strong></span></h6> 
<p>        openpyxl依赖于lxml和et_xmlfile这两个Python库来处理XML和Excel文件，在某些环境中，可能需要额外安装这些依赖项。</p> 
<h6 id="2-6%E3%80%81%E5%AD%A6%E4%B9%A0%E6%9B%B2%E7%BA%BF"><span style="color:#fe2c24;"><strong>2-6、学习曲线</strong></span></h6> 
<p>        虽然openpyxl的API设计得相对直观，但对于初学者来说，可能需要一些时间来熟悉和掌握其用法。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/76/de/ELUfo1kh_o.png"></p> 
<h4 id="%E4%B8%89%E3%80%81openpyxl%E5%BA%93%E7%9A%84%E7%94%A8%E9%80%94">三、openpyxl库的用途</h4> 
<p>        openpyxl是一个用于读写Excel 2010 xlsx/xlsm/xltx/xltm文件的Python库。它是用Python编写的，不需要Microsoft Excel，并且支持多种Excel数据类型，包括图表、图像、公式等，其主要用途有：</p> 
<h5 id="1%E3%80%81%E8%AF%BB%E5%8F%96Excel%E6%96%87%E4%BB%B6">1、读取Excel文件</h5> 
<p>        你可以使用openpyxl来读取 Excel 文件中的数据，如单元格值、工作表名称、公式等，它支持多种数据类型，如字符串、数字、日期等。</p> 
<h5 id="2%E3%80%81%E5%86%99%E5%85%A5Excel%E6%96%87%E4%BB%B6">2、写入Excel文件</h5> 
<p>        使用openpyxl，你可以创建新的Excel文件或向现有文件添加数据，你可以设置单元格的字体、颜色、边框等样式，你还可以添加图表、图像和其他复杂的Excel功能。</p> 
<h5 id="3%E3%80%81%E4%BF%AE%E6%94%B9Excel%E6%96%87%E4%BB%B6">3、修改Excel文件</h5> 
<p>        你可以使用openpyxl来修改现有的Excel文件，如更改单元格值、添加或删除工作表等，这对于自动化数据处理和报告生成非常有用。</p> 
<h5 id="4%E3%80%81%E8%87%AA%E5%8A%A8%E5%8C%96">4、自动化</h5> 
<p>        openpyxl可以与其他Python库和框架(如 pandas、numpy、matplotlib 等)结合使用，以自动化数据处理和分析任务。你可以编写脚本来从多个数据源收集数据，将数据整合到 Excel 文件中，并执行各种数据分析任务。</p> 
<h5 id="5%E3%80%81%E4%B8%8EExcel%E4%BA%A4%E4%BA%92">5、与Excel交互</h5> 
<p>        如果你正在开发需要与Excel交互的应用程序或工具，openpyxl可以提供一个强大的API来处理Excel文件，它允许你读取和写入Excel文件，而无需依赖Microsoft Excel或其他第三方库。</p> 
<h5 id="6%E3%80%81%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E5%92%8C%E8%BD%AC%E6%8D%A2">6、数据迁移和转换</h5> 
<p>        使用openpyxl，你可以轻松地将数据从Excel文件迁移到其他数据库或文件格式，或将其他数据源的数据导入到Excel文件中。</p> 
<h5 id="7%E3%80%81%E5%88%9B%E5%BB%BA%E6%A8%A1%E6%9D%BF%E5%8C%96%E7%9A%84%E6%8A%A5%E5%91%8A">7、创建模板化的报告</h5> 
<p>        你可以使用openpyxl来创建模板化的Excel报告，并在需要时填充数据，这对于需要定期生成具有一致格式和布局的报告的场景非常有用。</p> 
<p>        总之，openpyxl是一个功能强大的库，可用于在Python中处理Excel文件，它提供了灵活的API来读取、写入、修改和自动化Excel文件的各个方面。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/e2/d3/hkD7FseA_o.png"></p> 
<h4 id="%E5%9B%9B%E3%80%81%E5%A6%82%E4%BD%95%E5%AD%A6%E5%A5%BDopenpyxl%E5%BA%93%EF%BC%9F">四、如何学好openpyxl库？</h4> 
<h5 id="1%E3%80%81%E8%8E%B7%E5%8F%96xlrd%E5%BA%93%E7%9A%84%E5%B1%9E%E6%80%A7%E5%92%8C%E6%96%B9%E6%B3%95">1、获取openpyxl库的属性和方法</h5> 
<p>        用print()和dir()两个函数获取openpyxl库所有属性和方法的列表</p> 
<pre><code class="language-python"># ['DEBUG', 'DEFUSEDXML', 'LXML', 'NUMPY', 'Workbook', '__author__', '__author_email__', '__builtins__', '__cached__', 
# '__doc__', '__file__', '__license__', '__loader__', '__maintainer_email__', '__name__', '__package__', '__path__',
# '__spec__', '__url__', '__version__', '_constants', 'cell', 'chart', 'chartsheet', 'comments', 'compat', 'constants',
# 'descriptors', 'drawing', 'formatting', 'formula', 'load_workbook', 'open', 'packaging', 'pivot', 'reader', 'styles',
# 'utils', 'workbook', 'worksheet', 'writer', 'xml']</code></pre> 
<h5 id="2%E3%80%81%E8%8E%B7%E5%8F%96xlrd%E5%BA%93%E7%9A%84%E5%B8%AE%E5%8A%A9%E4%BF%A1%E6%81%AF">2、获取openpyxl库的帮助信息</h5> 
<p>        用help()函数获取openpyxl库的帮助信息</p> 
<pre><code class="language-python">Help on package openpyxl:

NAME
    openpyxl - # Copyright (c) 2010-2024 openpyxl

PACKAGE CONTENTS
    _constants
    cell (package)
    chart (package)
    chartsheet (package)
    comments (package)
    compat (package)
    descriptors (package)
    drawing (package)
    formatting (package)
    formula (package)
    packaging (package)
    pivot (package)
    reader (package)
    styles (package)
    utils (package)
    workbook (package)
    worksheet (package)
    writer (package)
    xml (package)

SUBMODULES
    constants

DATA
    DEBUG = False
    DEFUSEDXML = False
    LXML = True
    NUMPY = True
    __author_email__ = 'charlie.clark@clark-consulting.eu'
    __license__ = 'MIT'
    __maintainer_email__ = 'openpyxl-users@googlegroups.com'
    __url__ = 'https://openpyxl.readthedocs.io'

VERSION
    3.1.3

AUTHOR
    See AUTHORS

FILE
    e:\python_workspace\pythonproject\lib\site-packages\openpyxl\__init__.py</code></pre> 
<h5 id="3%E3%80%81%E7%94%A8%E6%B3%95%E7%B2%BE%E8%AE%B2">3、实战案例</h5> 
<h6 id="3-1%E3%80%81cellname%E5%87%BD%E6%95%B0">3-141、引用输入了文本的全部单元格</h6> 
<pre><code class="language-python"># 3-141、引用输入了文本的全部单元格
import openpyxl
# 打开 Excel 文件
workbook = openpyxl.load_workbook('example.xlsx')
# 获取所有工作表的名称
sheet_names = workbook.sheetnames
# 遍历每个工作表
for sheet_name in sheet_names:
    sheet = workbook[sheet_name]
    print(f"Processing sheet: {sheet_name}")
    # 遍历每一行和每一列
    for row in sheet.iter_rows():
        for cell in row:
            # 检查单元格是否包含文本
            if cell.data_type == 's':  # 's' 表示单元格包含字符串
                print(f"Cell {cell.coordinate} contains text: {cell.value}")</code></pre> 
<h6 id="3-142%E3%80%81%E5%BC%95%E7%94%A8%E8%BE%93%E5%85%A5%E4%BA%86%E9%80%BB%E8%BE%91%E5%80%BC%E7%9A%84%E5%85%A8%E9%83%A8%E5%8D%95%E5%85%83%E6%A0%BC">3-142、引用输入了逻辑值的全部单元格</h6> 
<pre><code class="language-python">略，openpyxl库暂不支持此功能，需要借助其他库实现</code></pre> 
<h6 id="3-143%E3%80%81%E5%BC%95%E7%94%A8%E8%BE%93%E5%85%A5%E4%BA%86%E6%89%B9%E6%B3%A8%E7%9A%84%E5%85%A8%E9%83%A8%E5%8D%95%E5%85%83%E6%A0%BC">3-143、引用输入了批注的全部单元格</h6> 
<pre><code class="language-python"># 3-143、引用输入了批注的全部单元格
import openpyxl
# 打开 Excel 文件
workbook = openpyxl.load_workbook('example.xlsx')
# 假设我们只对第一个工作表感兴趣
sheet = workbook.active  # 或者使用 workbook['Sheet1'] 来指定工作表名称
# 遍历工作表中的每一行和每一列
for row in sheet.iter_rows(min_row=sheet.min_row, max_row=sheet.max_row, min_col=sheet.min_column,
                           max_col=sheet.max_column):
    for cell in row:
        # 检查单元格是否包含批注
        if cell.comment is not None:
            # 打印单元格的引用和批注的内容
            print(f"Cell {cell.coordinate} contains a comment: {cell.comment.text}")</code></pre> 
<h6 id="3-144%E3%80%81%E5%BC%95%E7%94%A8%E6%B2%A1%E6%9C%89%E8%BE%93%E5%85%A5%E4%BB%BB%E4%BD%95%E6%95%B0%E6%8D%AE%E5%92%8C%E5%85%AC%E5%BC%8F%E7%9A%84%E7%A9%BA%E5%8D%95%E5%85%83%E6%A0%BC">3-144、引用没有输入任何数据和公式的空单元格</h6> 
<pre><code class="language-python"># 3-144、引用没有输入任何数据和公式的空单元格
import openpyxl
# 加载 Excel 文件
workbook = openpyxl.load_workbook('example.xlsx')
sheet = workbook.active  # 或者使用 workbook[sheetname] 指定具体的工作表
# 存储空单元格的列表
empty_cells = []
# 遍历工作表中的每个单元格
for row in sheet.iter_rows():
    for cell in row:
        if cell.value is None and cell.data_type != 'f':  # 检查单元格是否为空且没有公式
            empty_cells.append(cell.coordinate)  # 存储空单元格的坐标
# 输出所有空单元格的坐标
print("以下单元格为空且没有输入公式：")
for coord in empty_cells:
    print(coord)</code></pre> 
<h6 id="3-145%E3%80%81%E5%BC%95%E7%94%A8%E6%89%80%E6%9C%89%E5%8F%AF%E8%A7%81%E7%9A%84%E5%8D%95%E5%85%83%E6%A0%BC">3-145、引用所有可见的单元格</h6> 
<pre><code class="language-python"># 3-145、引用所有可见的单元格
import openpyxl
# 加载 Excel 文件
workbook = openpyxl.load_workbook('example.xlsx')
sheet = workbook.active  # 或者使用 workbook[sheetname] 指定具体的工作表
# 存储可见单元格的列表
visible_cells = []
# 遍历工作表中的每个单元格
for row in sheet.iter_rows():
    for cell in row:
        if not cell.column_letter in sheet.column_dimensions or not sheet.column_dimensions[cell.column_letter].hidden:
            if not cell.row in sheet.row_dimensions or not sheet.row_dimensions[cell.row].hidden:
                visible_cells.append(cell.coordinate)
# 输出所有可见单元格的坐标
print("以下单元格是可见的：")
for coord in visible_cells:
    print(coord)</code></pre> 
<h6 id="3-146%E3%80%81%E5%BC%95%E7%94%A8%E8%BE%93%E5%85%A5%E4%BA%86%E6%97%A5%E6%9C%9F%E7%9A%84%E5%8D%95%E5%85%83%E6%A0%BC">3-146、引用输入了日期的单元格</h6> 
<pre><code class="language-python"># 3-146、引用输入了日期的单元格
import openpyxl
# 注意：这里没有从openpyxl.utils导入datetime，因为我们直接使用内置的datetime模块
from datetime import datetime
# 加载Excel文件
workbook = openpyxl.load_workbook('example.xlsx')
# 如果需要检查所有工作表，可以使用workbook.sheetnames来迭代
sheet = workbook.active  # 或者使用workbook[sheetname]指定具体的工作表
# 存储包含日期的单元格的列表
date_cells = []
# 遍历工作表中的每个单元格
for row in sheet.iter_rows():
    for cell in row:
        # 检查单元格的值是否是datetime类型
        if isinstance(cell.value, datetime):
            date_cells.append(cell.coordinate)
# 输出所有包含日期的单元格的坐标
print("以下单元格包含日期：")
for coord in date_cells:
    print(coord)</code></pre> 
<h6 id="3-147%E3%80%81%E5%BC%95%E7%94%A8%E5%90%AB%E6%9C%89%E7%9B%B8%E5%90%8C%E8%AE%A1%E7%AE%97%E5%85%AC%E5%BC%8F%E7%9A%84%E6%89%80%E6%9C%89%E5%8D%95%E5%85%83%E6%A0%BC">3-147、引用含有相同计算公式的所有单元格</h6> 
<pre><code class="language-python"># 3-147、引用含有相同计算公式的所有单元格
import openpyxl
# 加载Excel文件
workbook = openpyxl.load_workbook('example.xlsx', data_only=False)
sheet = workbook.active  # 或者使用 workbook[sheetname] 指定具体的工作表
# 特定的公式
target_formula = '=SUM(C1:C2)'  # 例如 '=SUM(C1:C2)'
# 存储包含相同公式的单元格的列表
formula_cells = []
# 遍历工作表中的每个单元格
for row in sheet.iter_rows():
    for cell in row:
        if cell.value and isinstance(cell.value, str) and cell.value.startswith('='):
            if cell.value.strip().upper() == target_formula.strip().upper():
                formula_cells.append(cell.coordinate)
# 输出所有包含相同公式的单元格的坐标
print("以下单元格包含相同公式：")
for coord in formula_cells:
    print(coord)</code></pre> 
<h6 id="3-148%E3%80%81%E5%BC%95%E7%94%A8%E5%90%88%E5%B9%B6%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F">3-148、引用合并单元格区域</h6> 
<pre><code class="language-python"># 3-148、引用合并单元格区域
import openpyxl
# 加载Excel文件
workbook = openpyxl.load_workbook('example.xlsx')
sheet = workbook.active  # 或者使用 workbook[sheetname] 指定具体的工作表
# 获取所有合并单元格的区域
merged_cells_ranges = sheet.merged_cells.ranges
# 遍历并输出所有合并单元格区域
print("以下是所有合并单元格的区域：")
for merged_range in merged_cells_ranges:
    print(merged_range)
    # 例如，可以获取合并单元格的起始单元格和结束单元格
    start_cell = sheet[merged_range.coord.split(":")[0]]
    end_cell = sheet[merged_range.coord.split(":")[1]]
    print(f"起始单元格: {start_cell.coordinate}, 结束单元格: {end_cell.coordinate}")
    # 示例：修改合并单元格的值
    start_cell.value = "新值"
# 保存修改后的工作簿
workbook.save('修改后的文件.xlsx')</code></pre> 
<h6 id="3-149%E3%80%81%E5%BC%95%E7%94%A8%E5%AE%9A%E4%B9%89%E5%90%8D%E7%A7%B0%E6%89%80%E6%8C%87%E5%AE%9A%E7%9A%84%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F">3-149、引用定义名称所指定的单元格区域</h6> 
<pre><code class="language-python">略，openpyxl库暂不支持此功能，需要借助其他库实现</code></pre> 
<h6 id="3-150%E3%80%81%E5%BC%95%E7%94%A8%E8%BE%93%E5%85%A5%E4%BA%86%E4%BB%BB%E4%BD%95%E5%86%85%E5%AE%B9%E7%9A%84%E6%9C%80%E5%90%8E%E4%B8%80%E8%A1%8C%E5%8D%95%E5%85%83%E6%A0%BC">3-150、引用输入了任何内容的最后一行单元格</h6> 
<pre><code class="language-python"># 3-150、引用输入了任何内容的最后一行单元格
import openpyxl
def find_last_filled_row(sheet):
    # 初始化最后一行索引
    last_row = 0
    # 遍历每一行
    for row in sheet.iter_rows():
        for cell in row:
            if cell.value is not None:
                # 更新最后一行索引
                last_row = max(last_row, cell.row)
    return last_row
# 加载 Excel 文件
workbook = openpyxl.load_workbook('example.xlsx')
sheet = workbook.active  # 或者使用 workbook[sheetname] 指定具体的工作表
# 找到最后一行有内容的单元格的行号
last_filled_row = find_last_filled_row(sheet)
# 输出最后一行有内容的单元格的行号
print(f"最后一行有内容的单元格的行号是: {last_filled_row}")
# 示例：引用最后一行的单元格
if last_filled_row &gt; 0:
    last_row_cells = sheet[last_filled_row]
    for cell in last_row_cells:
        print(f"单元格 {cell.coordinate} 的值: {cell.value}")
# 你可以在此处进行进一步的操作，例如修改最后一行的单元格的值
# 保存修改后的工作簿
workbook.save('修改后的文件.xlsx')</code></pre> 
<h6 id="3-151%E3%80%81%E5%BC%95%E7%94%A8%E5%A4%9A%E4%B8%AA%E9%9D%9E%E8%BF%9E%E7%BB%AD%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E9%9B%86%E5%90%88(%E7%B1%BB%E4%BC%BCUnion%E6%96%B9%E6%B3%95)">3-151、引用多个非连续单元格区域集合(类似Union方法)</h6> 
<pre><code class="language-python"># 3-151、引用多个非连续单元格区域集合(类似Union方法)
import openpyxl
# 加载 Excel 文件
workbook = openpyxl.load_workbook('example.xlsx')
sheet = workbook.active  # 或者使用 workbook[sheetname] 指定具体的工作表
# 定义多个非连续单元格区域
regions = ['A1:B2', 'D4:E5', 'G7:H8']
# 初始化一个字典来存储各区域的单元格
cells = {}
for region in regions:
    cells[region] = sheet[region]
# 示例：遍历并打印各区域的单元格的值
for region, cell_range in cells.items():
    print(f"Region: {region}")
    for row in cell_range:
        for cell in row:
            print(f"单元格 {cell.coordinate} 的值: {cell.value}")
# 示例：修改各区域的单元格的值
for cell_range in cells.values():
    for row in cell_range:
        for cell in row:
            cell.value = "修改后的值"
# 保存修改后的工作簿
workbook.save('修改后的文件.xlsx')</code></pre> 
<h6 id="3-152%E3%80%81%E5%BC%95%E7%94%A8%E5%A4%9A%E4%B8%AA%E9%9D%9E%E8%BF%9E%E7%BB%AD%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E9%9B%86%E5%90%88(%E5%BE%AA%E7%8E%AF%E5%A4%84%E7%90%86)">3-152、引用多个非连续单元格区域集合(循环处理)</h6> 
<pre><code class="language-python"># 3-152、引用多个非连续单元格区域集合(循环处理)
import openpyxl
# 加载 Excel 文件
workbook = openpyxl.load_workbook('example.xlsx')
sheet = workbook.active  # 或者使用 workbook[sheetname] 指定具体的工作表
# 定义多个非连续单元格区域
regions = ['A1:B2', 'D4:E5', 'G7:H8']
# 循环处理每个区域
for region in regions:
    cell_range = sheet[region]
    for row in cell_range:
        for cell in row:
            # 处理单元格的逻辑，例如打印单元格值
            print(f"单元格 {cell.coordinate} 的值: {cell.value}")
            # 示例：修改单元格的值
            cell.value = "新的值"
# 保存修改后的工作簿
workbook.save('修改后的文件.xlsx')</code></pre> 
<h6 id="3-153%E3%80%81%E5%BC%95%E7%94%A8%E5%A4%9A%E4%B8%AA%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E7%9A%84%E4%BA%A4%E5%8F%89%E5%8C%BA%E5%9F%9F">3-153、引用多个单元格区域的交叉区域</h6> 
<pre><code class="language-python"># 3-153、引用多个单元格区域的交叉区域
import openpyxl
def get_cells_from_range(sheet, cell_range):
    """Helper function to get all cells from a given range."""
    cells = set()
    for row in sheet[cell_range]:
        for cell in row:
            cells.add(cell.coordinate)
    return cells
# 加载Excel文件
workbook = openpyxl.load_workbook('example.xlsx')
sheet = workbook.active  # 或者使用 workbook[sheetname] 指定具体的工作表
# 定义多个单元格区域
regions = ['A1:C3', 'B2:D4']
# 获取每个区域的单元格集合
sets_of_cells = [get_cells_from_range(sheet, region) for region in regions]
# 找出交叉区域的单元格
intersection = set.intersection(*sets_of_cells)
# 循环处理交叉区域的每个单元格
for cell_coord in intersection:
    cell = sheet[cell_coord]
    print(f"单元格 {cell.coordinate} 的值: {cell.value}")
    # 示例：修改单元格的值
    cell.value = "交叉区域"
# 保存修改后的工作簿
workbook.save('修改后的文件.xlsx')</code></pre> 
<h6 id="3-154%E3%80%81%E8%8E%B7%E5%8F%96%E8%AE%A1%E7%AE%97%E5%85%AC%E5%BC%8F%E7%9A%84%E6%89%80%E6%9C%89%E5%BC%95%E7%94%A8%E5%8D%95%E5%85%83%E6%A0%BC">3-154、获取计算公式的所有引用单元格</h6> 
<pre><code class="language-python"># 3-154、获取计算公式的所有引用单元格
import openpyxl
import re
def get_referenced_cells(formula):
    """Helper function to extract referenced cells from a formula."""
    # Regular expression to match cell references like A1, B2, etc.
    cell_ref_pattern = re.compile(r'(\$?[A-Z]+\$?\d+)')
    return cell_ref_pattern.findall(formula)
# 加载 Excel 文件
workbook = openpyxl.load_workbook('example.xlsx')
sheet = workbook.active  # 或者使用 workbook[sheetname] 指定具体的工作表
# 选择包含公式的单元格
cell_with_formula = sheet['C7']  # 假设C7单元格包含公式
# 获取单元格的公式
formula = cell_with_formula.value
if formula and formula.startswith('='):
    # 提取公式中的所有引用单元格
    referenced_cells = get_referenced_cells(formula)
    print(f"公式 '{formula}' 引用了以下单元格: {referenced_cells}")
    # 示例：遍历并打印每个引用单元格的值
    for cell_ref in referenced_cells:
        cell = sheet[cell_ref]
        print(f"单元格 {cell.coordinate} 的值: {cell.value}")
else:
    print(f"单元格 {cell_with_formula.coordinate} 不包含公式或公式无效")
# 如果需要，可以保存修改后的工作簿
# workbook.save('修改后的文件.xlsx')</code></pre> 
<h6 id="3-155%E3%80%81%E8%8E%B7%E5%8F%96%E8%AE%A1%E7%AE%97%E5%85%AC%E5%BC%8F%E4%B8%AD%E5%BC%95%E7%94%A8%E7%9A%84%E5%85%B6%E4%BB%96%E5%B7%A5%E4%BD%9C%E8%A1%A8%E5%8D%95%E5%85%83%E6%A0%BC">3-155、获取计算公式中引用的其他工作表单元格</h6> 
<pre><code class="language-python">略，openpyxl库暂不支持此功能，需要借助其他库实现</code></pre> 
<h6 id="3-156%E3%80%81%E8%8E%B7%E5%8F%96%E6%9F%90%E4%B8%AA%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E4%BB%8E%E5%B1%9E%E5%8D%95%E5%85%83%E6%A0%BC">3-156、获取某个单元格的从属单元格</h6> 
<pre><code class="language-python"># 3-156、获取某个单元格的从属单元格
from openpyxl import load_workbook
import re
def find_dependent_cells(file_path, target_sheet, target_cell):
    wb = load_workbook(file_path, data_only=False)
    dependent_cells = []
    target_ref = f'{target_sheet}!{target_cell}'
    # 正则表达式匹配单元格引用，例如：A1
    pattern = re.compile(r"([A-Z]+[0-9]+)")
    for sheet in wb.sheetnames:
        ws = wb[sheet]
        for row in ws.iter_rows():
            for cell in row:
                if cell.data_type == 'f':  # 仅处理包含公式的单元格
                    formula = cell.value
                    matches = pattern.findall(formula)
                    cell_references = [f'{sheet}!{match}' for match in matches]
                    if target_ref in cell_references:
                        dependent_cells.append(f'{sheet}!{cell.coordinate}')
    return dependent_cells
if __name__ == '__main__':
    file_path = 'example.xlsx'  # 替换为你的Excel文件路径
    target_sheet = 'Sheet'  # 替换为目标单元格所在的工作表
    target_cell = 'A1'  # 替换为目标单元格
    dependent_cells = find_dependent_cells(file_path, target_sheet, target_cell)
    print(f'单元格 {target_sheet}!{target_cell} 的从属单元格: {dependent_cells}')</code></pre> 
<h6 id="3-157%E3%80%81%E5%BC%95%E7%94%A8%E6%9F%90%E4%B8%AA%E5%8D%95%E5%85%83%E6%A0%BC%E6%89%80%E5%9C%A8%E7%9A%84%E6%95%B4%E4%B8%AA%E8%A1%8C">3-157、引用某个单元格所在的整个行</h6> 
<pre><code class="language-python"># 3-157、引用某个单元格所在的整个行
from openpyxl import load_workbook
import re
def find_dependent_rows(file_path, target_sheet, target_cell):
    wb = load_workbook(file_path, data_only=False)
    ws = wb[target_sheet]
    # 获取目标单元格所在的行号
    target_row = ws[target_cell].row
    # 构建目标行的单元格引用列表
    target_row_cells = [f'{target_sheet}!{ws.cell(row=target_row, column=col).coordinate}'
                        for col in range(1, ws.max_column + 1)]
    # 正则表达式匹配单元格引用，例如：A1
    pattern = re.compile(r"([A-Z]+[0-9]+)")
    dependent_cells = []
    for sheet in wb.sheetnames:
        ws = wb[sheet]
        for row in ws.iter_rows():
            for cell in row:
                if cell.data_type == 'f':  # 仅处理包含公式的单元格
                    formula = cell.value
                    matches = pattern.findall(formula)
                    cell_references = [f'{sheet}!{match}' for match in matches]
                    if any(ref in cell_references for ref in target_row_cells):
                        dependent_cells.append(f'{sheet}!{cell.coordinate}')
    return dependent_cells
if __name__ == '__main__':
    file_path = 'example.xlsx'  # 替换为你的Excel文件路径
    target_sheet = 'Sheet'  # 替换为目标单元格所在的工作表
    target_cell = 'A1'  # 替换为目标单元格
    dependent_cells = find_dependent_rows(file_path, target_sheet, target_cell)
    print(f'单元格 {target_sheet}!{target_cell} 所在行的从属单元格: {dependent_cells}')</code></pre> 
<h6 id="3-158%E3%80%81%E5%BC%95%E7%94%A8%E6%9F%90%E4%B8%AA%E5%8D%95%E5%85%83%E6%A0%BC%E6%89%80%E5%9C%A8%E7%9A%84%E6%95%B4%E4%B8%AA%E5%88%97">3-158、引用某个单元格所在的整个列</h6> 
<pre><code class="language-python"># 3-158、引用某个单元格所在的整个列
from openpyxl import load_workbook
import re
def find_dependent_columns(file_path, target_sheet, target_cell):
    wb = load_workbook(file_path, data_only=False)
    ws = wb[target_sheet]
    # 获取目标单元格所在的列号
    target_col = ws[target_cell].column
    # 构建目标列的单元格引用列表
    target_col_cells = [f'{target_sheet}!{ws.cell(row=row, column=target_col).coordinate}'
                        for row in range(1, ws.max_row + 1)]
    # 正则表达式匹配单元格引用，例如：A1
    pattern = re.compile(r"([A-Z]+[0-9]+)")
    dependent_cells = []
    for sheet in wb.sheetnames:
        ws = wb[sheet]
        for row in ws.iter_rows():
            for cell in row:
                if cell.data_type == 'f':  # 仅处理包含公式的单元格
                    formula = cell.value
                    matches = pattern.findall(formula)
                    cell_references = [f'{sheet}!{match}' for match in matches]
                    if any(ref in cell_references for ref in target_col_cells):
                        dependent_cells.append(f'{sheet}!{cell.coordinate}')
    return dependent_cells
if __name__ == '__main__':
    file_path = 'example.xlsx'  # 替换为你的Excel文件路径
    target_sheet = 'Sheet'  # 替换为目标单元格所在的工作表
    target_cell = 'D10'  # 替换为目标单元格
    dependent_cells = find_dependent_columns(file_path, target_sheet, target_cell)
    print(f'单元格 {target_sheet}!{target_cell} 所在列的从属单元格: {dependent_cells}')</code></pre> 
<h6 id="3-159%E3%80%81%E5%BC%95%E7%94%A8%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E6%89%80%E5%9C%A8%E7%9A%84%E8%A1%8C%E8%8C%83%E5%9B%B4">3-159、引用单元格区域所在的行范围</h6> 
<pre><code class="language-python">略，openpyxl库暂不支持此功能，需要借助其他库实现</code></pre> 
<h6 id="3-160%E3%80%81%E5%BC%95%E7%94%A8%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E6%89%80%E5%9C%A8%E7%9A%84%E5%88%97%E8%8C%83%E5%9B%B4">3-160、引用单元格区域所在的列范围</h6> 
<pre><code class="language-python">略，openpyxl库暂不支持此功能，需要借助其他库实现</code></pre> 
<h4 id="%E4%BA%94%E3%80%81%E6%8E%A8%E8%8D%90%E9%98%85%E8%AF%BB">五、推荐阅读</h4> 
<h5 id="1%E3%80%81">1、<a href="https://myelsa1024.blog.csdn.net/article/details/139241094?spm=1001.2014.3001.5502" rel="nofollow" title="Python筑基之旅">Python筑基之旅</a></h5> 
<h5 id="2%E3%80%81">2、<a href="https://myelsa1024.blog.csdn.net/article/details/138916144?spm=1001.2014.3001.5502" rel="nofollow" title="Python函数之旅">Python函数之旅</a></h5> 
<h5 id="3%E3%80%81">3、<a href="https://blog.csdn.net/ygb_1024/article/details/136889623?spm=1001.2014.3001.5501" title="Python算法之旅">Python算法之旅</a></h5> 
<h5 id="4%E3%80%81">4、<a href="https://myelsa1024.blog.csdn.net/article/details/139555733" rel="nofollow" title="Python魔法之旅">Python魔法之旅</a></h5> 
<h5 id="5%E3%80%81%C2%A0">5、<a href="https://blog.csdn.net/ygb_1024?spm=1010.2135.3001.5421" title="博客个人主页">博客个人主页</a></h5>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9d51f22512d907ef451f2f25372e3711/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">探索WebKit的插件帝国：深入插件系统的奥秘</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6f5ae311f195f8a239286f7c0e4a2f59/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Python酷库之旅-第三方库openpyxl(02)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>