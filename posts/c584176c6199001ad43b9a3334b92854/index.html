<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【Day04】0基础微信小程序入门-学习笔记 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/c584176c6199001ad43b9a3334b92854/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【Day04】0基础微信小程序入门-学习笔记">
  <meta property="og:description" content="文章目录 基础加强学习目标自定义组件1. 创建与引用2. 样式3. 数据、方法和属性4. 数据监听器5. 纯数据字段6. 组件生命周期6.1 created6.2 attached（使用最多）6.3 detached6.4 定义生命周期函数 7. 组件所在页面的生命周期7.1 定义使用7.2 生成随机的`RGB`颜色值 8. 插槽8.1 单个插槽8.2 多个插槽 9. 父子通信9.1 属性绑定9.2 事件绑定9.3 获取组件实例 10. behaviors 代码共享10.1 创建behavior10.2 导入并使用behavior10.3 behavior可用节点10.4 同名字段处理（了解） 小结 基础加强 学习目标 能够知道如何自定义小程序组件能够知道小程序组件中 behaviors 的作用能够知道如何安装和配置 vant-weapp 组件库能够知道如何使用 MobX 实现全局数据共享能够知道如何对小程序的 API进行 Promise 化 自定义组件 1. 创建与引用 创建组件：
创建components -&gt; test文件夹test文件夹中新建Component输入名称后回车，自动生成4个文件，后缀.js .json .wxml .wxss 为保证目录结构清晰，建议把不同的组件，存放到单独目录中。
引用组件：
全局引用：每个小程序页面中都可以使用。
//app.json &#34;usingComponents&#34;: { &#34;my-test&#34;:&#39;/components/test/test&#39; } 局部引用：组件只能在被引用的页面内使用。比如在home页面使用test组件
//home.json &#34;usingComponents&#34;: { &#34;my-test&#34;:&#39;./components/test/test&#39; } &lt;!">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-08T22:33:27+08:00">
    <meta property="article:modified_time" content="2024-08-08T22:33:27+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Day04】0基础微信小程序入门-学习笔记</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_1" rel="nofollow">基础加强</a></li><li><ul><li><a href="#_3" rel="nofollow">学习目标</a></li><li><a href="#_13" rel="nofollow">自定义组件</a></li><li><ul><li><a href="#1__15" rel="nofollow">1. 创建与引用</a></li><li><a href="#2__75" rel="nofollow">2. 样式</a></li><li><a href="#3__124" rel="nofollow">3. 数据、方法和属性</a></li><li><a href="#4__222" rel="nofollow">4. 数据监听器</a></li><li><a href="#5__283" rel="nofollow">5. 纯数据字段</a></li><li><a href="#6__308" rel="nofollow">6. 组件生命周期</a></li><li><ul><li><a href="#61_created_329" rel="nofollow">6.1 created</a></li><li><a href="#62_attached_337" rel="nofollow">6.2 attached（使用最多）</a></li><li><a href="#63_detached_345" rel="nofollow">6.3 detached</a></li><li><a href="#64__353" rel="nofollow">6.4 定义生命周期函数</a></li></ul> 
    </li><li><a href="#7__377" rel="nofollow">7. 组件所在页面的生命周期</a></li><li><ul><li><a href="#71__393" rel="nofollow">7.1 定义使用</a></li><li><a href="#72_RGB_409" rel="nofollow">7.2 生成随机的`RGB`颜色值</a></li></ul> 
    </li><li><a href="#8__453" rel="nofollow">8. 插槽</a></li><li><ul><li><a href="#81__464" rel="nofollow">8.1 单个插槽</a></li><li><a href="#82__484" rel="nofollow">8.2 多个插槽</a></li></ul> 
    </li><li><a href="#9__542" rel="nofollow">9. 父子通信</a></li><li><ul><li><a href="#91__560" rel="nofollow">9.1 属性绑定</a></li><li><a href="#92__597" rel="nofollow">9.2 事件绑定</a></li><li><a href="#93__655" rel="nofollow">9.3 获取组件实例</a></li></ul> 
    </li><li><a href="#10_behaviors__678" rel="nofollow">10. behaviors 代码共享</a></li><li><ul><li><a href="#101_behavior_691" rel="nofollow">10.1 创建behavior</a></li><li><a href="#102_behavior_710" rel="nofollow">10.2 导入并使用behavior</a></li><li><a href="#103_behavior_729" rel="nofollow">10.3 behavior可用节点</a></li><li><a href="#104__745" rel="nofollow">10.4 同名字段处理（了解）</a></li></ul> 
    </li><li><a href="#_759" rel="nofollow">小结</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>基础加强</h2> 
<h3><a id="_3"></a>学习目标</h3> 
<ul><li>能够知道如何自定义小程序组件</li><li>能够知道小程序组件中 <code>behaviors </code>的作用</li><li>能够知道如何安装和配置 <code>vant-weapp</code> 组件库</li><li>能够知道如何使用 <code>MobX</code> 实现全局数据共享</li><li>能够知道如何对小程序的 <code>API</code>进行<code> Promise</code> 化</li></ul> 
<h3><a id="_13"></a>自定义组件</h3> 
<h4><a id="1__15"></a>1. 创建与引用</h4> 
<p><strong>创建组件</strong>：</p> 
<ul><li>创建<code>components -&gt; test</code>文件夹</li><li><code>test</code>文件夹中<strong>新建<code>Component</code></strong></li><li>输入名称后回车，自动生成4个文件，后缀<code>.js .json .wxml .wxss</code></li></ul> 
<blockquote> 
 <p>为保证目录结构清晰，建议把不同的组件，存放到单独目录中。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/f8/6a/4ATsZOaU_o.png" alt="在这里插入图片描述"></p> 
<p><strong>引用组件</strong>：</p> 
<ul><li> <p>全局引用：每个小程序页面中都可以使用。</p> <pre><code class="prism language-json"><span class="token comment">//app.json</span>

<span class="token string-property property">"usingComponents"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
	<span class="token string-property property">"my-test"</span><span class="token operator">:</span><span class="token string">'/components/test/test'</span> 
  <span class="token punctuation">}</span>
</code></pre> </li><li> <p>局部引用：组件只能在被引用的页面内使用。比如在<code>home</code>页面使用<code>test</code>组件</p> <pre><code class="prism language-json"><span class="token comment">//home.json</span>
<span class="token string-property property">"usingComponents"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
	<span class="token string-property property">"my-test"</span><span class="token operator">:</span><span class="token string">'./components/test/test'</span>    
  <span class="token punctuation">}</span>
  
</code></pre> <pre><code class="prism language-html"><span class="token comment">&lt;!--home.wxml--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-test</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-test</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li></ul> 
<blockquote> 
 <p>如果某组件在多个页面中<strong>经常</strong>被用到，建议进行“<strong>全局</strong>引用。</p> 
 <p>如果某组件只在<strong>特定</strong>的页面中被用到，建议进行“<strong>局部</strong>引用。</p> 
</blockquote> 
<p><strong>组件和页面的区别</strong>：都由四个文件组成，但是其<code>.js</code>和<code>.json</code>文件上面有明显不同(3个)：</p> 
<ul><li>组件的 <code>.json </code>文件中需要**声明<code>"component":true</code>**属性</li><li>组件的<code> .js</code> 文件中调用的是 <code>Component()</code>函数；页面调用的是<code>Page()</code>函数。</li><li>组件的事件处理函数需要**定义到<code>methods</code>**节点中</li></ul> 
<h4><a id="2__75"></a>2. 样式</h4> 
<p>组件样式隔离。</p> 
<p>A不影响C；A不影响小程序页面样式；小程序页面样式不影响A和C的样式。</p> 
<p><img src="https://images2.imgbox.com/ba/b7/OHo6OLHq_o.png" alt="在这里插入图片描述"></p> 
<p><strong>组件样式隔离的注意点</strong>：</p> 
<ul><li><code>app.wxss</code>中的全局样式<strong>对组件无效</strong>。</li><li>只有<code>class</code>选择器会有样式隔离效果、<code>id</code>选择器、属性选择器、标签选择器不受样式隔离的影响。</li></ul> 
<p>建议<strong>在组件和引用组件的页面</strong>中使用class选择器，<strong>不要使用id，属性，标签选择器</strong>。</p> 
<p>有时，我们希望在外界能够控制组件内部的样式，此时可以通过<code>stylesolation</code>修改组件的样式隔离选项，<strong>两种方式都可以</strong>。</p> 
<pre><code class="prism language-js"><span class="token comment">//.js文件中</span>
<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">options</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">//启用样式隔离</span>
        <span class="token literal-property property">stylesolation</span><span class="token operator">:</span><span class="token string">'isolated'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-json"><span class="token comment">//.json文件中</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"stylesolation"</span><span class="token operator">:</span><span class="token string">"is0lated"</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><code>stylesolation</code>的可选值如下：</p> 
<table><thead><tr><th>可选值</th><th>默认值</th><th>描述</th></tr></thead><tbody><tr><td>isolated</td><td>是</td><td>表示<strong>启用样式隔离</strong>，在自定义组件内外，使用<code>class</code>指定的样式将<strong>不会相互影响</strong></td></tr><tr><td>apply-shared</td><td>否</td><td>表示<strong>页面<code>wxss</code>样式将影响到自定义组件</strong>，但自定义组件<code>wxss</code>中指定的样式不会影响页面</td></tr><tr><td><strong>shared</strong></td><td>否</td><td>表示页面<code>wxss</code> 样式将影响到自定义组件，自定义组件<code> wxss</code> 中指定的样式也会影响页面和其他设置了<code>apply-shared </code>或<code>shared </code>的自定义组件</td></tr></tbody></table> 
<h4><a id="3__124"></a>3. 数据、方法和属性</h4> 
<p><strong>data数据</strong>：定义到<code>data</code>节点里面</p> 
<pre><code class="prism language-js"><span class="token function">component</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
 <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">count</span><span class="token operator">:</span><span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>methods方法</strong>：<strong>事件处理函数</strong>和<strong>自定义方法</strong>都定义到methods节点中。<strong>自定义方法建议以_下划线开头</strong>。</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>count为：{<!-- -->{count}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>addCount<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>点击count+1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<pre><code class="prism language-js"> <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">count</span><span class="token operator">:</span><span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">//事件处理函数</span>
    <span class="token function-variable function">addCount</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">count</span><span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_showCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">_showCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">"count是"</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>count<span class="token punctuation">,</span>
        <span class="token literal-property property">icon</span><span class="token operator">:</span><span class="token string">'none'</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/31/94/HGZFYyiA_o.png" alt="在这里插入图片描述"></p> 
<p><strong>properties 属性</strong>：</p> 
<p>用来接收外界传递到组件中的数据</p> 
<p><strong>完整版</strong>：需要指定<strong>默认值</strong>时，建议用此方式</p> 
<pre><code class="prism language-js"><span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">properties</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">max</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">type</span><span class="token operator">:</span>Number<span class="token punctuation">,</span>
            <span class="token literal-property property">value</span><span class="token operator">:</span><span class="token number">10</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>简化版</strong>：</p> 
<pre><code class="prism language-js"><span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">properties</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">max</span><span class="token operator">:</span>Number
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//父组件中</span>
<span class="token operator">&lt;</span>my<span class="token operator">-</span>test max<span class="token operator">=</span><span class="token string">"10"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>my<span class="token operator">-</span>test<span class="token operator">&gt;</span>
</code></pre> 
<p><code>data</code>数据和<code>properties</code>属性在<strong>本质上没有任何区别</strong></p> 
<table><thead><tr><th>比较</th><th>data</th><th>properties</th></tr></thead><tbody><tr><td>相同点</td><td>可读可写</td><td>可读可写</td></tr><tr><td>不同点</td><td>存储组件私有数据</td><td>存储外界传递到组件的数据</td></tr></tbody></table> 
<p><code>setData</code>修改<code>properties</code>的值：</p> 
<pre><code class="prism language-js"><span class="token literal-property property">methods</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
	<span class="token function">addCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">max</span><span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>properties<span class="token punctuation">.</span>max <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="4__222"></a>4. 数据监听器</h4> 
<p>用于<strong>监听</strong>和<strong>响应</strong>任何属性和数据字段的变化，从而执行特定的操作。它的作用类似于<code> vue</code> 中的<code>watch</code>侦听器。</p> 
<p>可以监听<strong>多个</strong>字段变化，用逗号<code>,</code>分隔</p> 
<p><strong>基本格式</strong>：</p> 
<pre><code class="prism language-js"><span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">observes</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
        <span class="token string">'字段1,字段2'</span>：<span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">字段<span class="token number">1</span>的新值，字段<span class="token number">2</span>的新值</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    
<span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>基本用法</strong>：</p> 
<pre><code class="prism language-js"><span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">n1</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token literal-property property">n2</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token literal-property property">sum</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">//数据节点</span>
    <span class="token literal-property property">methods</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">addN1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">n1</span><span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>n1 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">addN2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">n2</span><span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>n2 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">observes</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>   <span class="token comment">//数据监听节点</span>
        <span class="token string-property property">'n1,n2'</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">n1<span class="token punctuation">,</span>n2</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">sum</span><span class="token operator">:</span>n1 <span class="token operator">+</span> n2<span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment">//通过监听器，自动计算sum的值</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>上面我们只是监听一些简单类型的数据变化，下面学习如何监听<strong>对象中</strong>单个或多个<strong>属性</strong>的变化。</p> 
<pre><code class="prism language-js"><span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">observes</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
        <span class="token string-property property">'对象.属性A,对象.属性B'</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">属性<span class="token constant">A</span>的新值<span class="token punctuation">,</span>属性<span class="token constant">B</span>的新值</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//触发此监听器的 3 种情况:</span>
			<span class="token comment">//【为属性A赋值】使用 setData 设置 this.data.对象.属性A 时触发</span>
            <span class="token comment">//【为属性B赋值】使用 setData 设置 this.data.对象.属性B 时触发</span>
            <span class="token comment">//【直接为对象赋值】使用 setData 设置 this.data.对象 时触发</span>
			<span class="token comment">// do something..</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="5__283"></a>5. 纯数据字段</h4> 
<p><strong>纯数据字段</strong>指的是那些<strong>不用于界面渲染的 <code>data</code> 字段</strong>。</p> 
<p><strong>应用场景</strong>：data的字段<strong>既不会展示在展示在界面上，也不会传递给其他组件</strong>，这种适合被设置为纯数据字段。</p> 
<p><strong>优点</strong>：有助于提升页面更新的<strong>性能</strong></p> 
<p><strong>使用规则</strong>：在 <code>Component </code>构造器的 <code>options</code> 节点中，指定 <code>pureDataPattern</code> 为一个<strong>正则表达式</strong>，字段名符合这个正则表达式的字段将成为纯数据字段</p> 
<pre><code class="prism language-js"><span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">options</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">//指定所有_开头的数据字段为纯数据字段</span>
        <span class="token literal-property property">pureDataPattern</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^_</span><span class="token regex-delimiter">/</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">a</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">_b</span><span class="token operator">:</span><span class="token boolean">true</span>  <span class="token comment">//纯数据字段</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="6__308"></a>6. 组件生命周期</h4> 
<p>创建组件 -&gt; 组件放入节点树 -&gt; 组件被渲染</p> 
<p>小程序组件可以全部生命周期函数：</p> 
<table><thead><tr><th>生命周期函数</th><th>参数</th><th>描述说明</th></tr></thead><tbody><tr><td><font color="red">created</font></td><td><font color="red">无</font></td><td><font color="red">在组件刚被<strong>创建</strong>好时执行</font></td></tr><tr><td><font color="red">attached</font></td><td><font color="red">无</font></td><td><font color="red">在组件实例<strong>进入页面节点树</strong>时执行</font></td></tr><tr><td>ready</td><td>无</td><td>在组件在视图层布局完成后执行</td></tr><tr><td>moved</td><td>无</td><td>在组件实例被<strong>移动</strong>到节点树另一个位置时执行</td></tr><tr><td><font color="red">detached</font></td><td><font color="red">无</font></td><td><font color="red">在组件实例被从页面节点树<strong>移除</strong>时执行</font></td></tr><tr><td>error</td><td></td><td>当组件方法抛出错误时执行</td></tr></tbody></table> 
<blockquote> 
 <p>微信小程序中的节点树（Node Tree）指的是小程序页面的组件结构树，它描述了页面中各个组件（节点）的层级关系和结构。</p> 
</blockquote> 
<p>下面将三个主要的生命周期函数一一学习</p> 
<h5><a id="61_created_329"></a>6.1 created</h5> 
<p>在组件刚被<strong>创建</strong>好时执行。<strong>只用于给this添加一些自定义属性</strong>。</p> 
<p>!此时不能调用<code>setData</code></p> 
<h5><a id="62_attached_337"></a>6.2 attached（使用最多）</h5> 
<p>组件<strong>初始化完毕</strong>，<strong>进入页面节点树</strong>之后执行。</p> 
<p><code>this.data</code>初始化完毕！绝大多数初始化工作在此时机进行，比如<strong>请求获取初始数据</strong>。</p> 
<h5><a id="63_detached_345"></a>6.3 detached</h5> 
<p>组件离开页面节点树后执行，也就是销毁阶段。</p> 
<p>退出一个页面时，会触发页面中每个自定义组件的<code>detached</code>生命周期函数。<strong>适合书写一些清理性质的相关代码。</strong></p> 
<h5><a id="64__353"></a>6.4 定义生命周期函数</h5> 
<p><strong>新方式（推荐）：使用的是<code>lifetimes</code>节点。</strong></p> 
<p>旧方式：直接定义在Component构造器的第一级参数中。</p> 
<pre><code class="prism language-js"><span class="token comment">//js文件中</span>
<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
	<span class="token comment">//推荐用法</span>
    <span class="token literal-property property">lifetime</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">attached</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">//进入页面节点树时执行</span>
        <span class="token function">detected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">//从页面节点树移除时执行</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token comment">//旧方式，不推荐</span>
    <span class="token function">attached</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">//进入页面节点树时执行</span>
    <span class="token function">detected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">//从页面节点树移除时执行      </span>
         
         <span class="token punctuation">)</span>
</code></pre> 
<h4><a id="7__377"></a>7. 组件所在页面的生命周期</h4> 
<p>就是组件所在页面影响着组件的行为，这时候我们就需要用到所在页面的生命周期。</p> 
<p>比如说进入主页时随机渲染一个背景颜色，这边背景颜色的变化就依赖于主页。</p> 
<p>还不太懂看下面，用用就懂了</p> 
<table><thead><tr><th>生命周期函数</th><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>show</td><td>无</td><td>组件所在页面<strong>被展示</strong>时执行</td></tr><tr><td>hide</td><td>无</td><td>组件所在页面<strong>被隐藏</strong>时执行</td></tr><tr><td>resize</td><td>Object Size</td><td>组件所在页面<strong>尺寸变化</strong>时执行</td></tr></tbody></table> 
<h5><a id="71__393"></a>7.1 定义使用</h5> 
<p>定义到<code>pageLifetimes</code>节点中，实例代码如下：</p> 
<pre><code class="prism language-js"><span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">pageLifetimes</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
        <span class="token function-variable function">show</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token comment">//页面被展示</span>
        <span class="token function-variable function">hide</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">//页面被隐藏</span>
        <span class="token function-variable function">resize</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">size</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span> <span class="token comment">//页面尺寸变化</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="72_RGB_409"></a>7.2 生成随机的<code>RGB</code>颜色值</h5> 
<p>需求：在进入主页时，背景颜色随机。</p> 
<p>分析：即主页只要显示，就随机生成背景颜色，使用<code>show()</code>这个页面生命周期函数进行监听。我们在methods生命一个方法<code>_randomColor()</code>，调用即生成随机<code>RGB</code>颜色值</p> 
<p>这里只书写相关代码:</p> 
<pre><code class="prism language-js"><span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    data：<span class="token punctuation">{<!-- --></span>
    	<span class="token literal-property property">_rgb</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
    		<span class="token literal-property property">r</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
    		<span class="token literal-property property">g</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
    		<span class="token literal-property property">b</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">methods</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">//生成随机RGB颜色值,非事件处理函数建议以_开头</span>
        <span class="token function">_randomColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token comment">//为data里面的_rag纯数据字段重新赋值</span>
                <span class="token literal-property property">_rgb</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">r</span><span class="token operator">:</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">g</span><span class="token operator">:</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">b</span><span class="token operator">:</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">256</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
     
    <span class="token operator">...</span>
    
    <span class="token literal-property property">pageLifetimes</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
    	<span class="token comment">//组件所在页面展示时调用</span>
    	<span class="token function-variable function">show</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">randomColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="8__453"></a>8. 插槽</h4> 
<p><code>slot</code>节点(插槽)，用于承载组件使用者提供的 <code>wxml</code>结构。</p> 
<p>封装者占位，使用者填充具体的内容</p> 
<p><img src="https://images2.imgbox.com/6c/8f/QO3LKq03_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="81__464"></a>8.1 单个插槽</h5> 
<p>小程序默认自定义组件中只允许使用一个<code>slot</code>进行占位，这种<strong>个数限制</strong>叫做单个插槽。</p> 
<pre><code class="prism language-html"><span class="token comment">&lt;!--组件的封装者--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrapper<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>这里是组件的内部节点<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 对于不确定的内容，可以使用&lt;slot&gt;进行占位，具体的内容由组件的使用者决定 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>


<span class="token comment">&lt;!--组件的使用者--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component-tag-name</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--这部分内容将被放置在组件&lt;slot&gt;的位置上进行渲染--&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>这里是插入到组件slot中的内容<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component-tag-name</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h5><a id="82__484"></a>8.2 多个插槽</h5> 
<p><strong>启用</strong>：</p> 
<p>默认不支持</p> 
<p>在<code>.js</code>文件中通过以下方式启用</p> 
<pre><code class="prism language-js"><span class="token function">Copmponent</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">options</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">multipleSlots</span><span class="token operator">:</span><span class="token boolean">true</span>  <span class="token comment">//在组件定义时启用多slot支持</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">properties</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token comment">/* ... */</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">methods</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token comment">/* ... */</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>定义</strong>：</p> 
<p>启用之后，就可以使用多个<code>slot</code>标签，以不同的<code>name</code>区分不同的插槽</p> 
<p>类似于<code>vue</code>的<strong>具名插槽</strong></p> 
<pre><code class="prism language-html"><span class="token comment">&lt;!--组件模板 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrapper<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    
	<span class="token comment">&lt;!--name为 before 的第一个 slot 插槽 --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>before<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>这是一段固定的文本内容<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    
    <span class="token comment">&lt;!--name 为 after 的第二个 slot 插槽 --&gt;</span>	 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>after<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><strong>使用</strong>：</p> 
<p>在使用带有多个插槽的自定义组件时，需要用 <code>slot </code>属性来将节点插入到不同的<code>slot</code>中</p> 
<pre><code class="prism language-html"><span class="token comment">&lt;!--引用组件的页面模板--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component-tag-name</span><span class="token punctuation">&gt;</span></span>
    
<span class="token comment">&lt;!--这部分内容将被放置在组件&lt;slot name="before"&gt;的位置上 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>before<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>这里是插入到组件slot name="before"中的内容<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>viewp</span><span class="token punctuation">&gt;</span></span>
    
    <span class="token comment">&lt;!--这部分内容将被放置在组件&lt;slot name="after"&gt;的位置上--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>after<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>这里是插入到组件slot name="after"中的内容<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component-tag-name</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h4><a id="9__542"></a>9. 父子通信</h4> 
<p>父子通信三种方式</p> 
<ul><li><strong>属性绑定</strong><br> 父传子，只能传递<code>JSON</code>简单数据，方法这类复杂数据不能传递。</li><li><strong>事件绑定</strong><br> 子传父，传递任意数据。</li><li><strong>获取组件实例</strong> 
  <ul><li>父通过<code>this.selectComponent()</code>获取子组件实例对象。</li><li>父这样可以直接访问子组件的任意数据和方法（这个类似于<code>vue</code>的<code>ref</code>）。</li></ul> </li></ul> 
<p>下面学习一下具体的使用方法</p> 
<h5><a id="91__560"></a>9.1 属性绑定</h5> 
<p>属性绑定用于实现<strong>父向子</strong>传值，而且只能传递普通类型的数据，<strong>无法将方法传递给子组件</strong>。</p> 
<pre><code class="prism language-js"><span class="token comment">//父组件的data节点</span>
<span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">count</span><span class="token operator">:</span><span class="token number">0</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-html"><span class="token comment">&lt;!--父组件的wxml结构--&gt;</span>
<span class="token comment">&lt;!--给子组件传递count--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-test</span> <span class="token attr-name">count</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>{<!-- -->{count}}</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-test</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>---<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>父组件中，count的值为{<!-- -->{count}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>子组件<code>properties</code>节点中生命对应的属性并使用。</p> 
<pre><code class="prism language-js"><span class="token comment">//子组件的properties节点</span>
<span class="token literal-property property">properties</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">count</span><span class="token operator">:</span>Number
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-html"><span class="token comment">&lt;!--子组件的wxml结构--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span> 子组件中，count的值为:{<!-- -->{count}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h5><a id="92__597"></a>9.2 事件绑定</h5> 
<p>事件绑定用于实现<strong>子向父</strong>传值，可以传递任何类型的数据。</p> 
<p>步骤：</p> 
<ul><li> <p>a. 父组件<code>js</code>中定义函数</p> <pre><code class="prism language-js"><span class="token comment">//在父组件中定义syncCount方法</span>
<span class="token function">syncCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> </li><li> <p>b. 父组件<code>wxml</code>中将定义的函数引用，通过<strong>自定义事件形式</strong>传递给子组件</p> <pre><code class="prism language-html"><span class="token comment">&lt;!--两种方式，推荐第一种--&gt;</span>
<span class="token comment">&lt;!--1.使用bind:自定义事件名称(推荐)--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-test</span> <span class="token attr-name">count</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>{<!-- -->{count}}</span> <span class="token attr-name"><span class="token namespace">bind:</span>sync</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>syncCount<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-test</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--2.在bind后直接协商自定义事件名称--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-test</span> <span class="token attr-name">count</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>{<!-- -->{count}}</span> <span class="token attr-name">bindsync</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>syncCount<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-test</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li><li> <p>c. 子组件<code>js</code>中调用<code>this.triggerEvent('自定义事件名称',{/* 参数对象 */})</code>，数据发送到父组件</p> <pre><code class="prism language-html"><span class="token comment">&lt;!--子组件的wxml结构--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>子组件中count的值为：{<!-- -->{count}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>addCount<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>+1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre> <pre><code class="prism language-js"><span class="token comment">//子组件的js代码</span>
<span class="token literal-property property">methods</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">addCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">count</span><span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>properties<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">triggerEvent</span><span class="token punctuation">(</span><span class="token string">'sync'</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">value</span><span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>properties<span class="token punctuation">.</span>count<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> </li><li> <p>d. 父组件<code>js</code>中，通过<code>e.detail</code>获取到子组件传递来的数据。<code>e.detail</code>就是传递过来的<strong>参数对象</strong></p> <pre><code class="prism language-js"><span class="token function">syncCount</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">//console.log(e.detail.value)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">count</span><span class="token operator">:</span>e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> </li></ul> 
<h5><a id="93__655"></a>9.3 获取组件实例</h5> 
<p>可在父组件里调用 <code>this.selectComponent("id或class选择器")</code>，获取子组件的实例对象，从而直接访问子组件的任意数据和方法。</p> 
<p>调用时需要传入一个<strong>选择器</strong>，例如 <code>this.selectComponent(".my-component")</code>。</p> 
<pre><code class="prism language-html"><span class="token comment">&lt;!--wxml 结构--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-test3</span> <span class="token attr-name">count</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>({count}}<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">bind:</span>sync</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>syncCount<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>custom<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cA<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-test3</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>getChild<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>获取子组件实例<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>

</code></pre> 
<pre><code class="prism language-js"><span class="token function">getChild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//按钮的 tap 事件处理函数</span>
<span class="token comment">//切记下面参数不能传递标签选择器'my-test3'，不然返回的是 null</span>
    <span class="token keyword">const</span> child <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">selectComponent</span><span class="token punctuation">(</span><span class="token string">'.customA'</span><span class="token punctuation">)</span><span class="token comment">//也可以传递 id 选择器 #CA,不支持标签选择器</span>
    child<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">count</span><span class="token operator">:</span>child<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment">// 调用子组件的 setData 方法</span>
    child<span class="token punctuation">.</span><span class="token function">addCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//调用子组件的 addCount 方法</span>
</code></pre> 
<h4><a id="10_behaviors__678"></a>10. behaviors 代码共享</h4> 
<p>类似于<code>vue</code>的<code>mixins</code>，用于实现组件间代码共享的特性。</p> 
<p><img src="https://images2.imgbox.com/35/bf/QWKouPS0_o.png" alt="在这里插入图片描述"></p> 
<p>每个<code>behavior</code> 可以包含一组<strong>属性、数据、生命周期函数和方法</strong>。组件引用它时，它的属性、数据和方法<strong>会被合并到组件中</strong>。</p> 
<p>每个组件可以引用多个<code>behavior</code>，<code>behavior</code>也可以引用其他的<code>behavior</code>。</p> 
<h5><a id="101_behavior_691"></a>10.1 创建behavior</h5> 
<p>调用<code>Behavior(Object object)</code>方法即可创建一个共享的<code>behavior</code>的实例对象，供所有的组件使用。</p> 
<pre><code class="prism language-js"><span class="token comment">//调用Behavior()方法创建实例对象，使用module.exports将behavior实例对象分享出去,凡是引用了这个Behavior的组件都可以访问到ruru这个名字喽</span>
modules<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">Behavior</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">//属性节点</span>
    <span class="token literal-property property">properties</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//私有数据节点</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">username</span><span class="token operator">:</span><span class="token string">'ruru'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//事件处理函数和自定义方法节点</span>
    <span class="token literal-property property">methods</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//其它节点...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="102_behavior_710"></a>10.2 导入并使用behavior</h5> 
<p>在组件中，使用<code>require()</code>方法导入需要的<code> behavior</code>\</p> 
<p><strong>挂载后即可访问</strong><code>behavior</code>中的数据或方法</p> 
<pre><code class="prism language-js"><span class="token comment">//1.require导入</span>
<span class="token keyword">const</span> myBehavior <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../behaviors/my-behavior"</span><span class="token punctuation">)</span>

<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">//2.挂载</span>
    <span class="token literal-property property">behaviors</span><span class="token operator">:</span><span class="token punctuation">[</span>myBehavior<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">//组件其它节点...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="103_behavior_729"></a>10.3 behavior可用节点</h5> 
<table><thead><tr><th>可用的节点</th><th>类型</th><th>是否必填</th><th>描述</th></tr></thead><tbody><tr><td><strong>properties</strong></td><td>Object Map</td><td>否</td><td>同组件属性</td></tr><tr><td><strong>data</strong></td><td>Object</td><td>否</td><td>同组件数据</td></tr><tr><td><strong>methods</strong></td><td>Object</td><td>否</td><td>同自定义组件的方法</td></tr><tr><td><strong>behaviors</strong></td><td>String Array</td><td>否</td><td>引入其它的behavior</td></tr><tr><td>created</td><td>Function</td><td>否</td><td>生命周期函数</td></tr><tr><td>attached</td><td>Function</td><td>否</td><td>生命周期函数</td></tr><tr><td>ready</td><td>Function</td><td>否</td><td>生命周期函数</td></tr><tr><td>moved</td><td>Function</td><td>否</td><td>生命周期函数</td></tr><tr><td>detached</td><td>Function</td><td>否</td><td>生命周期函数</td></tr></tbody></table> 
<h5><a id="104__745"></a>10.4 同名字段处理（了解）</h5> 
<p>同名字段的覆盖和组合规则</p> 
<p>组件和它引用的 behavior 中可以包含同名的字段，此时可以参考如下3种同名时的处理规则:</p> 
<ul><li>同名的数据字段(data)</li><li>同名的属性(properties)或方法(methods)</li><li>同名的生命周期函数</li></ul> 
<p>详情请参考微信小程序官方给出的说明喔~</p> 
<h4><a id="_759"></a>小结</h4> 
<p>学完今天的内容，对于以下的内容需要掌握</p> 
<ul><li> <p>创建并引用组件</p> <p><strong>全局引用</strong>、局部引用、<strong><code>usingcomponents</code></strong></p> </li><li> <p>如何定义和使用数据监听器</p> <p><code>observers</code></p> </li><li> <p>如何定义和使用纯数据字段</p> <p><code>options -&gt; pureDataPattern</code></p> </li><li> <p>实现组件父子通信有哪3种方式</p> <p>属性绑定、事件绑定、<code>this.selectComponent('id或class选择器'</code></p> </li><li> <p>如何定义和使用<code>behaviors</code></p> <p>调用 **<code>Behavior()</code>**构造器方法</p> </li><li> <p>如何修改组件的样式隔离选项</p> <p><code>options -&gt;stylelsolation ( isolated, apply-shared, shared )</code></p> </li></ul> 
<p>🆗持续更新~<br> 若有笔误请指正，加油加油~</p> 
<p><img src="https://images2.imgbox.com/ff/d2/dCEJTdsf_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/743e0557089f6c33a31da4495379d246/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【最新】推荐7款智能AI写作论文生成网站工具</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/53b8cef0313c8ac5f4583756d9c7f073/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【大模型从入门到精通13】openAI API 构建和评估大型语言模型（LLM）应用1</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>