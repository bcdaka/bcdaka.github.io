<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C#进阶-轻量级ORM框架Dapper的使用教程与原理详解 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/b7795bb1bbfc063bb659c11a3fc3b4cf/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="C#进阶-轻量级ORM框架Dapper的使用教程与原理详解">
  <meta property="og:description" content="本文详细介绍了Dapper在C#中的使用方法，包括Dapper的基本概念、与其他持久层框架的比较、基本语法和高级语法的使用，并通过实例讲解了如何在项目中集成和使用Dapper。Dapper以其高效的性能和简洁的API受到开发者的青睐，适用于各种数据库操作需求。本文还将深入探讨Dapper的核心原理，通过内部代码展示其工作机制。最后，总结了Dapper的优缺点及其在实际开发中的应用场景，为开发者提供全面的指导。
一、Dapper介绍 1. Dapper介绍 Dapper是一个轻量级的ORM（对象关系映射）框架，专为.NET设计。它通过扩展IDbConnection接口，使开发者能够方便地执行SQL查询，并将查询结果映射到对象模型中。
2. Dapper原理解析 Dapper的核心原理是通过扩展方法来简化数据访问过程。它的主要工作流程如下：
建立数据库连接：使用ADO.NET的IDbConnection接口建立数据库连接。执行SQL查询：通过Dapper提供的扩展方法（如Query、Execute等）执行SQL查询。映射结果集：将查询结果集映射到C#对象模型中，简化数据处理。 Dapper的性能优势主要来源于以下几个方面：
轻量级：Dapper没有复杂的上下文管理和变化跟踪机制，减少了性能开销。直接执行SQL：Dapper直接执行原生SQL查询，避免了复杂的查询生成过程。缓存查询计划：Dapper会缓存查询计划，减少SQL解析和执行的开销。 3. Dapper和其他操作数据库的框架比较 为了更清晰地展示Dapper与其他数据库操作框架的比较，以下通过表格进行说明：
特性DapperEntity FrameworkNHibernateADO.NET性能高中等中等高易用性高高中等低映射能力基本映射丰富丰富无学习曲线低中等高低事务支持支持支持支持支持LINQ支持不支持支持支持不支持配置灵活性高中等高高 二、Dapper的基本语法 Dapper提供了多种方法来简化数据库操作。以下是一些常用的基本语法及其示例代码：
1. 查询数据 Dapper使用Query方法执行SQL查询并返回结果集。
using (IDbConnection db = new SqlConnection(connectionString)) { string sql = &#34;SELECT * FROM Students&#34;; var students = db.Query&lt;Student&gt;(sql).ToList(); } 2. 插入数据 Dapper使用Execute方法执行插入操作。
using (IDbConnection db = new SqlConnection(connectionString)) { string sql = &#34;INSERT INTO Students (Name, Age) VALUES (@Name, @Age)&#34;; var result = db.Execute(sql, new { Name = &#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-07T19:50:47+08:00">
    <meta property="article:modified_time" content="2024-08-07T19:50:47+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C#进阶-轻量级ORM框架Dapper的使用教程与原理详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>本文详细介绍了Dapper在C#中的使用方法，包括Dapper的基本概念、与其他持久层框架的比较、基本语法和高级语法的使用，并通过实例讲解了如何在项目中集成和使用Dapper。Dapper以其高效的性能和简洁的API受到开发者的青睐，适用于各种数据库操作需求。本文还将深入探讨Dapper的核心原理，通过内部代码展示其工作机制。最后，总结了Dapper的优缺点及其在实际开发中的应用场景，为开发者提供全面的指导。</p> 
<h3><a id="Dapper_3"></a>一、Dapper介绍</h3> 
<h4><a id="1_Dapper_5"></a>1. Dapper介绍</h4> 
<p>Dapper是一个轻量级的ORM（对象关系映射）框架，专为.NET设计。它通过扩展IDbConnection接口，使开发者能够方便地执行SQL查询，并将查询结果映射到对象模型中。</p> 
<h4><a id="2_Dapper_8"></a>2. Dapper原理解析</h4> 
<p>Dapper的核心原理是通过扩展方法来简化数据访问过程。它的主要工作流程如下：</p> 
<ul><li><strong>建立数据库连接</strong>：使用ADO.NET的IDbConnection接口建立数据库连接。</li><li><strong>执行SQL查询</strong>：通过Dapper提供的扩展方法（如Query、Execute等）执行SQL查询。</li><li><strong>映射结果集</strong>：将查询结果集映射到C#对象模型中，简化数据处理。</li></ul> 
<p>Dapper的性能优势主要来源于以下几个方面：</p> 
<ul><li><strong>轻量级</strong>：Dapper没有复杂的上下文管理和变化跟踪机制，减少了性能开销。</li><li><strong>直接执行SQL</strong>：Dapper直接执行原生SQL查询，避免了复杂的查询生成过程。</li><li><strong>缓存查询计划</strong>：Dapper会缓存查询计划，减少SQL解析和执行的开销。</li></ul> 
<h4><a id="3_Dapper_19"></a>3. Dapper和其他操作数据库的框架比较</h4> 
<p>为了更清晰地展示Dapper与其他数据库操作框架的比较，以下通过表格进行说明：</p> 
<table><thead><tr><th>特性</th><th>Dapper</th><th>Entity Framework</th><th>NHibernate</th><th>ADO.NET</th></tr></thead><tbody><tr><td>性能</td><td>高</td><td>中等</td><td>中等</td><td>高</td></tr><tr><td>易用性</td><td>高</td><td>高</td><td>中等</td><td>低</td></tr><tr><td>映射能力</td><td>基本映射</td><td>丰富</td><td>丰富</td><td>无</td></tr><tr><td>学习曲线</td><td>低</td><td>中等</td><td>高</td><td>低</td></tr><tr><td>事务支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr><td>LINQ支持</td><td>不支持</td><td>支持</td><td>支持</td><td>不支持</td></tr><tr><td>配置灵活性</td><td>高</td><td>中等</td><td>高</td><td>高</td></tr></tbody></table> 
<hr> 
<h3><a id="Dapper_33"></a>二、Dapper的基本语法</h3> 
<p>Dapper提供了多种方法来简化数据库操作。以下是一些常用的基本语法及其示例代码：</p> 
<h4><a id="1__36"></a>1. 查询数据</h4> 
<p>Dapper使用Query方法执行SQL查询并返回结果集。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">IDbConnection</span> db <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlConnection</span><span class="token punctuation">(</span>connectionString<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name"><span class="token keyword">string</span></span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM Students"</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">var</span></span> students <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Query</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Student<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="2__46"></a>2. 插入数据</h4> 
<p>Dapper使用Execute方法执行插入操作。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">IDbConnection</span> db <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlConnection</span><span class="token punctuation">(</span>connectionString<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name"><span class="token keyword">string</span></span> sql <span class="token operator">=</span> <span class="token string">"INSERT INTO Students (Name, Age) VALUES (@Name, @Age)"</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token punctuation">{<!-- --></span> Name <span class="token operator">=</span> <span class="token string">"John"</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">22</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="3__56"></a>3. 更新数据</h4> 
<p>Dapper使用Execute方法执行更新操作。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">IDbConnection</span> db <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlConnection</span><span class="token punctuation">(</span>connectionString<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name"><span class="token keyword">string</span></span> sql <span class="token operator">=</span> <span class="token string">"UPDATE Students SET Name = @Name, Age = @Age WHERE Id = @Id"</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token punctuation">{<!-- --></span> Name <span class="token operator">=</span> <span class="token string">"John"</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">,</span> Id <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="4__66"></a>4. 删除数据</h4> 
<p>Dapper使用Execute方法执行删除操作。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">IDbConnection</span> db <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlConnection</span><span class="token punctuation">(</span>connectionString<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name"><span class="token keyword">string</span></span> sql <span class="token operator">=</span> <span class="token string">"DELETE FROM Students WHERE Id = @Id"</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token punctuation">{<!-- --></span> Id <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="5__76"></a>5. 存储过程</h4> 
<p>Dapper可以轻松调用存储过程。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">IDbConnection</span> db <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlConnection</span><span class="token punctuation">(</span>connectionString<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Query</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Student<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">"GetStudentById"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token punctuation">{<!-- --></span> Id <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token named-parameter punctuation">commandType</span><span class="token punctuation">:</span> CommandType<span class="token punctuation">.</span>StoredProcedure<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">FirstOrDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h3><a id="Dapper_86"></a>三、Dapper的高级功能</h3> 
<p>Dapper除了基本的CRUD操作外，还提供了一些高级功能，以满足复杂的数据库操作需求。</p> 
<h4><a id="1__89"></a>1. 多映射</h4> 
<p>Dapper支持多表查询并将结果映射到多个对象。</p> 
<pre><code class="prism language-csharp"><span class="token class-name"><span class="token keyword">string</span></span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM Students s INNER JOIN Classes c ON s.ClassId = c.Id"</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> studentDictionary <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> Student<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">IDbConnection</span> db <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlConnection</span><span class="token punctuation">(</span>connectionString<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name"><span class="token keyword">var</span></span> students <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Query</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Student<span class="token punctuation">,</span> Class<span class="token punctuation">,</span> Student<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span>student<span class="token punctuation">,</span> @<span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        student<span class="token punctuation">.</span>Class <span class="token operator">=</span> @<span class="token keyword">class</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> student<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token named-parameter punctuation">splitOn</span><span class="token punctuation">:</span> <span class="token string">"Id"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Distinct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="2__104"></a>2. 参数化查询</h4> 
<p>Dapper支持参数化查询，有效防止SQL注入。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">IDbConnection</span> db <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlConnection</span><span class="token punctuation">(</span>connectionString<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name"><span class="token keyword">string</span></span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM Students WHERE Age &gt; @Age"</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">var</span></span> students <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Query</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Student<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token punctuation">{<!-- --></span> Age <span class="token operator">=</span> <span class="token number">20</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="3__114"></a>3. 事务处理</h4> 
<p>Dapper支持数据库事务，确保数据操作的一致性。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">IDbConnection</span> db <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlConnection</span><span class="token punctuation">(</span>connectionString<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    db<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> transaction <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">BeginTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name"><span class="token keyword">string</span></span> insertSql <span class="token operator">=</span> <span class="token string">"INSERT INTO Students (Name, Age) VALUES (@Name, @Age)"</span><span class="token punctuation">;</span>
        db<span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span>insertSql<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token punctuation">{<!-- --></span> Name <span class="token operator">=</span> <span class="token string">"John"</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">22</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> transaction<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name"><span class="token keyword">string</span></span> updateSql <span class="token operator">=</span> <span class="token string">"UPDATE Students SET Age = @Age WHERE Name = @Name"</span><span class="token punctuation">;</span>
        db<span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span>updateSql<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token punctuation">{<!-- --></span> Age <span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">,</span> Name <span class="token operator">=</span> <span class="token string">"John"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> transaction<span class="token punctuation">)</span><span class="token punctuation">;</span>

        transaction<span class="token punctuation">.</span><span class="token function">Commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="4__133"></a>4. 批量操作</h4> 
<p>Dapper可以高效地进行批量操作。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">IDbConnection</span> db <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlConnection</span><span class="token punctuation">(</span>connectionString<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name"><span class="token keyword">string</span></span> sql <span class="token operator">=</span> <span class="token string">"INSERT INTO Students (Name, Age) VALUES (@Name, @Age)"</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">var</span></span> students <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Student<span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span> <span class="token punctuation">{<!-- --></span> Name <span class="token operator">=</span> <span class="token string">"John"</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">22</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span> <span class="token punctuation">{<!-- --></span> Name <span class="token operator">=</span> <span class="token string">"Jane"</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">24</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span> <span class="token punctuation">{<!-- --></span> Name <span class="token operator">=</span> <span class="token string">"Mark"</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">26</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    db<span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> students<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="5__149"></a>5. 动态对象</h4> 
<p>Dapper支持动态对象，适用于不确定返回结构的查询。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">IDbConnection</span> db <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlConnection</span><span class="token punctuation">(</span>connectionString<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name"><span class="token keyword">string</span></span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM Students"</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">var</span></span> students <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Query</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">dynamic</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> student <span class="token keyword">in</span> students<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">student<span class="token punctuation">.</span>Name</span><span class="token punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">student<span class="token punctuation">.</span>Age</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="6__163"></a>6. 缓存功能</h4> 
<p>Dapper内置简单的缓存功能，可以提高查询性能。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">IDbConnection</span> db <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlConnection</span><span class="token punctuation">(</span>connectionString<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name"><span class="token keyword">string</span></span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM Students"</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">var</span></span> students <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Query</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Student<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token named-parameter punctuation">buffered</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h3><a id="Dapper_174"></a>四、Dapper使用总结</h3> 
<p>Dapper作为一个轻量级的ORM框架，在性能和易用性之间找到了平衡点。它适合于需要高效数据访问的应用场景，尤其是在已有数据库项目中快速集成和使用。</p> 
<p>Dapper的优势在于其高性能、简单易用和灵活性。它直接执行SQL查询，性能接近手写ADO.NET，且API简洁明了，易于上手。同时，Dapper不需要复杂的配置，适合快速集成和使用。</p> 
<p>然而，Dapper也有其局限性。它不支持复杂的对象关系映射，不提供LINQ支持，不适合复杂的业务逻辑处理场景。因此，在选择使用Dapper时，需要根据具体项目需求进行权衡。</p> 
<h6><a id="_181"></a>优势总结</h6> 
<table><thead><tr><th>优势</th><th>描述</th></tr></thead><tbody><tr><td>高性能</td><td>直接执行SQL查询，性能接近手写ADO.NET</td></tr><tr><td>简单易用</td><td>API简洁明了，易于上手</td></tr><tr><td>轻量级</td><td>不需要复杂的配置，适合快速集成</td></tr><tr><td>参数化查询</td><td>有效防止SQL注入</td></tr><tr><td>支持事务处理</td><td>确保数据操作的一致性</td></tr><tr><td>灵活性</td><td>允许开发者完全控制SQL语句，实现更复杂的查询逻辑</td></tr></tbody></table> 
<p>通过本教程，希望读者能够快速掌握Dapper的基本使用方法，并在项目中有效地应用Dapper提高开发效率。Dapper的高效和简洁使其成为处理简单到中等复杂度数据库操作的理想选择，但对于复杂的业务场景，仍需结合其他框架或工具进行综合使用。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/08a9958add770cafecd72ee1f0cfc21f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">史上最全C/C&#43;&#43;面试、C&#43;&#43;面经八股文，一文带你彻底搞懂C/C&#43;&#43;面试、C&#43;&#43;面经！</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/11e22f9bafe2b14a61c97f6a7e214416/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【生成式人工智能-四-chatgpt的训练过程-pretrain预训练&amp;自督导式学习&amp;督导式学习】</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>