<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【Python・统计学】Kruskal-Wallis检验/H检验（原理及代码） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/6ed5fe3fda0f4dfd08265f8784266521/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【Python・统计学】Kruskal-Wallis检验/H检验（原理及代码）">
  <meta property="og:description" content="前言 自学笔记，分享给对统计学原理不太清楚但需要在论文中用到的小伙伴，欢迎大佬们补充或绕道。ps：本文不涉及公式讲解（文科生小白友好体质）～（部分定义等来源于知乎百度等）
本文重点：Kruskal-Wallis检验(Kruskal-Wallis test),也称H检验
【1.定义和简单原理】
【2.应用条件】
【3.数据实例以及Python代码】
【4.多重比较（例：Dunn检验）】
1.定义和简单原理 Kruskal-Wallis检验(Kruskal-Wallis test),也称为克鲁斯卡尔-沃利斯检验或H检验,是一种非参数检验方法,用于比较三个或更多独立样本的差异。它可以看作是Mann-Whitney U检验的扩展。
补充1:Mann-Whitney U检验适用于两组数据，Kruskal-Wallis检验适用于三组及以上数据 【Python・统计学】Mann-Whitney U检验/Wilcoxon秩和检验（原理及代码）https://mp.csdn.net/mp_blog/creation/editor/138028894
Kruskal-Wallis检验的基本思想是,如果各组样本来自同一总体,那么各组样本的秩和应该相近。具体步骤如下:
将所有样本的数据合并,并按照从小到大的顺序排列,记录每个数据点的秩(排名)。对每个组内的秩求和,计算每个组的平均秩。如果各组样本来自同一总体,那么各组的平均秩应该相近。如果某些组的平均秩明显偏高或偏低,则可能表明这些组与其他组存在显著差异。计算Kruskal-Wallis检验的统计量H,并根据H的值和自由度,查表或计算p值,以判断是否拒绝原假设。 2.应用条件 数据是独立的随机样本,各组之间相互独立。数据至少是顺序尺度的,即可以比较大小,但不要求数值之间的差异有意义。各组样本不必服从正态分布,也不要求方差齐性。各组样本的分布形状相似(如都是偏态分布或都是对称分布),但不要求完全一致。 3.数据实例以及Python代码 假设我们想比较三种不同教学方法(A、B、C)对学生数学成绩的影响。我们随机选择了一些学生,分别接受这三种教学方法,并记录他们的数学成绩(满分100分)。数据如下:
methodA = [85, 92, 78, 88, 90, 82, 84, 80] methodB = [75, 80, 82, 74, 79, 76, 81] methodC = [90, 87, 92, 93, 88, 91, 85, 89, 94] from scipy.stats import kruskal # 三组学生的数学成绩 methodA = [85, 92, 78, 88, 90, 82, 84, 80] methodB = [75, 80, 82, 74, 79, 76, 81] methodC = [90, 87, 92, 93, 88, 91, 85, 89, 94] # 进行Kruskal-Wallis检验 statistic, p_value = kruskal(methodA, methodB, methodC) print(f&#39;检验统计量为: {statistic}&#39;) print(f&#39;p值为: {p_value}&#39;) if p_value &lt; 0.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-28T21:02:29+08:00">
    <meta property="article:modified_time" content="2024-04-28T21:02:29+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Python・统计学】Kruskal-Wallis检验/H检验（原理及代码）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>前言</h2> 
<p>自学笔记，分享给对统计学原理不太清楚但需要在论文中用到的小伙伴，欢迎大佬们补充或绕道。ps：本文不涉及公式讲解（文科生小白友好体质）～（部分定义等来源于知乎百度等）</p> 
<p>本文重点：Kruskal-Wallis检验(Kruskal-Wallis test),也称H检验</p> 
<p>【<strong><u>1.定义和简单原理</u></strong>】</p> 
<p>【<strong><u>2.应用条件</u></strong>】</p> 
<p>【3<u><strong>.数据实例以及Python代码</strong></u>】</p> 
<p>【4<u><strong>.多重比较（例：Dunn检验）</strong></u>】</p> 
<p></p> 
<h2>1.定义和简单原理</h2> 
<p>Kruskal-Wallis检验(Kruskal-Wallis test),也称为克鲁斯卡尔-沃利斯检验或H检验,是一种非参数检验方法,用于比较三个或更多独立样本的差异。它可以看作是<u><strong>Mann-Whitney U检验的扩展</strong></u>。</p> 
<h5> 补充1:<u><strong>Mann-Whitney U检验适用于两组数据，</strong></u>Kruskal-Wallis检验适用于三组及以上数据</h5> 
<p><a class="link-info has-card" href="https://mp.csdn.net/mp_blog/creation/editor/138028894" title="【Python・统计学】Mann-Whitney U检验/Wilcoxon秩和检验（原理及代码）"><span class="link-card-box"><span class="link-title">【Python・统计学】Mann-Whitney U检验/Wilcoxon秩和检验（原理及代码）</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/7f/44/iHtybxGb_o.png" alt="icon-default.png?t=N7T8">https://mp.csdn.net/mp_blog/creation/editor/138028894</span></span></a></p> 
<p>Kruskal-Wallis检验的基本思想是,如果各组样本来自同一总体,那么各组样本的秩和应该相近。具体步骤如下:</p> 
<ol><li>将所有样本的数据合并,并按照从小到大的顺序排列,记录每个数据点的秩(排名)。</li><li>对每个组内的秩求和,计算每个组的平均秩。</li><li>如果各组样本来自同一总体,那么各组的平均秩应该相近。如果某些组的平均秩明显偏高或偏低,则可能表明这些组与其他组存在显著差异。</li><li>计算Kruskal-Wallis检验的统计量H,并根据H的值和自由度,查表或计算p值,以判断是否拒绝原假设。</li></ol> 
<h2>2.应用条件</h2> 
<ul><li>数据是独立的随机样本,各组之间相互独立。</li><li>数据至少是顺序尺度的,即可以比较大小,但不要求数值之间的差异有意义。</li><li>各组样本不必服从正态分布,也不要求方差齐性。</li><li>各组样本的分布形状相似(如都是偏态分布或都是对称分布),但不要求完全一致。</li></ul> 
<h2>3<u><strong>.数据实例以及Python代码</strong></u></h2> 
<p>假设我们想比较三种不同教学方法(A、B、C)对学生数学成绩的影响。我们随机选择了一些学生,分别接受这三种教学方法,并记录他们的数学成绩(满分100分)。数据如下:</p> 
<pre><code class="language-python">methodA = [85, 92, 78, 88, 90, 82, 84, 80]
methodB = [75, 80, 82, 74, 79, 76, 81]
methodC = [90, 87, 92, 93, 88, 91, 85, 89, 94]</code></pre> 
<pre><code class="language-python">from scipy.stats import kruskal

# 三组学生的数学成绩
methodA = [85, 92, 78, 88, 90, 82, 84, 80]
methodB = [75, 80, 82, 74, 79, 76, 81]
methodC = [90, 87, 92, 93, 88, 91, 85, 89, 94]

# 进行Kruskal-Wallis检验
statistic, p_value = kruskal(methodA, methodB, methodC)

print(f'检验统计量为: {statistic}')
print(f'p值为: {p_value}')

if p_value &lt; 0.05:
    print('在显著性水平0.05下,拒绝原假设,认为三组学生的数学成绩存在显著差异')
else:
    print('在显著性水平0.05下,接受原假设,认为三组学生的数学成绩没有显著差异')</code></pre> 
<pre><code class="language-python">检验统计量为: 11.40568181818182
p值为: 0.0033381294063426758
在显著性水平0.05下,拒绝原假设,认为三组学生的数学成绩存在显著差异</code></pre> 
<p>根据输出结果,p值为0.0033381294063426758,小于显著性水平0.05,因此我们拒绝原假设,认为这三组学生的数学成绩存在显著差异。</p> 
<p>需要注意的是,Kruskal-Wallis检验只能判断是否存在显著差异,但无法确定具体是哪些组之间存在差异。如果想进一步了解组间差异,可以进行事后多重比较,如Dunn检验</p> 
<h2></h2> 
<h2>4.多重比较（例：Dunn检验）</h2> 
<p>本文使用Dunn检验进行多重比较。</p> 
<h5>Dunn多重比较代码</h5> 
<pre><code class="language-python">rank_A = np.mean([sorted(methodA + methodB + methodC).index(x) + 1 for x in methodA])
    rank_B = np.mean([sorted(methodA + methodB + methodC).index(x) + 1 for x in methodB])
    rank_C = np.mean([sorted(methodA + methodB + methodC).index(x) + 1 for x in methodC])

# 计算总样本量和每个组的样本量
n = len(methodA) + len(methodB) + len(methodC)
n_A, n_B, n_C = len(methodA), len(methodB), len(methodC)
    
# 计算Dunn检验的z值和p值
z_AB, p_AB = mannwhitneyu(methodA, methodB, alternative='two-sided')
z_AC, p_AC = mannwhitneyu(methodA, methodC, alternative='two-sided')
z_BC, p_BC = mannwhitneyu(methodB, methodC, alternative='two-sided')
    
# 调整p值 (Bonferroni correction)
p_AB, p_AC, p_BC = p_AB * 3, p_AC * 3, p_BC * 3
    
print(f'\nDunn事后检验结果:')
print(f'组A vs 组B: p值 = {p_AB}, 均值秩差 = {rank_A - rank_B}')
print(f'组A vs 组C: p值 = {p_AC}, 均值秩差 = {rank_A - rank_C}')
print(f'组B vs 组C: p值 = {p_BC}, 均值秩差 = {rank_B - rank_C}')
    </code></pre> 
<pre><code class="language-python">Dunn事后检验结果:
组A vs 组B: p值 = 0.06265422533333335, 均值秩差 = 5.678571428571429
组A vs 组C: p值 = 0.9698684800000001, 均值秩差 = -2.3611111111111116
组B vs 组C: p值 = 0.001467466666666643, 均值秩差 = -8.03968253968254</code></pre> 
<p>从输出结果可以看出,在显著性水平0.05下:</p> 
<ul><li>组A与组B的数学成绩没有显著差异(p = 0.06265422533333335 &gt; 0.05)。</li><li>组A与组C的数学成绩没有显著差异(p = 0.9698684800000001 &gt; 0.05)。</li><li>组B与组C的数学成绩存在显著差异(p = 0.001467466666666643 &lt; 0.05),且组C的均值秩高于组B(均值秩差为负)。</li></ul> 
<p>因此,我们可以得出结论,教学方法C的效果显著优于教学方法B,而教学方法A与其他两种方法没有显著差异。</p> 
<p>需要注意的是,Dunn检验只是事后多重比较的一种方法,还有其他方法如Nemenyi检验、Conover检验等。此外,Bonferroni校正是一种较为保守的p值调整方法,有时可能会增加第二类错误(假阴性)的风险。根据具体情况,也可以考虑使用其他校正方法,如Holm-Bonferroni校正、FDR校正等。</p> 
<h5>多重比较方法选择</h5> 
<p><strong>一般来说,如果<span style="background-color:#efedf6;">样本量相等</span>,可以优先考虑Nemenyi检验;</strong></p> 
<p><strong>如果<span style="background-color:#efedf6;">样本量不等</span>,可以考虑Dunn检验或Conover检验;</strong></p> 
<p><strong>如果<span style="background-color:#efedf6;">比较次数较少</span>,可以使用Bonferroni校正;</strong></p> 
<p><strong>如果<span style="background-color:#efedf6;">比较次数较多</span>,可以考虑Benjamini-Hochberg FDR校正。</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ded623a1dfc7b99c75dc6ec19e825576/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">湖南大学python头歌实训 实验14：递归与二分法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/af482ce5cf42a2552d5563ccdfffd64a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">常用浏览器禁用JavaScript方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>