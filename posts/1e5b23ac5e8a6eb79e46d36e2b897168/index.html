<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于Hadoop的招聘数据可视化系统实现（爬虫、hadoop&#43;hive、flask&#43;echarts、薪资预测、岗位推荐） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/1e5b23ac5e8a6eb79e46d36e2b897168/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="基于Hadoop的招聘数据可视化系统实现（爬虫、hadoop&#43;hive、flask&#43;echarts、薪资预测、岗位推荐）">
  <meta property="og:description" content="文章目录 概要整体架构流程项目实现数据挖掘 概要 随着大数据技术的兴起，AI人工智能领域迎来了大量的人才，而网络招聘成为了求职者的首选渠道。然而，招聘网站信息往往是重复、分散且不一致，就业人员需要花费大量时间才能找到真正合适的岗位。 整体架构流程 本文利用Flask框架设计并实现了一个AI岗位招聘数据可视化系统。首先，系统利用Selenium技术实现对网页数据的自动抓取；接着，构建由三台服务器组成的Hadoop集群，并将爬取数据存储在HDFS分布式文件系统中，使用基于Spark的Hive数据仓库进行数据处理和分析，生成得到的分析数据用可视化方式呈现给用户；并且，系统还使用线性回归算法实现薪资预测以及基于用户的协同过滤算法实现岗位推荐功能，最终给用户提供了一个更加直观、易懂的AI岗位招聘数据可视化系统。
项目流程架构图
项目实现 系统主要分为三个部分：数据采集-搭建数据仓库-建设数据可视化系统
1、数据采集
数据采集使用的技术是Selenium，而Selenium是能够在浏览器中运行测试，仿佛是真实用户在进行操作一样的工具，Selenium能模拟浏览器发送请求，并与网页中的元素进行交互，从而在网页中提取出数据，相较于其他的爬虫方法，Selenium能高效爬取到动态的数据，采用合法手段进行反爬虫策略，确保数据的有效爬取。
从Boss直聘网站上爬取AI岗位招聘数据，而爬取得到的数据由csv文件保存
编写爬虫程序
根据所需要后续可视化分析展示的数据进行元素定位采集
import datetime from selenium.webdriver.support.ui import WebDriverWait from selenium.common.exceptions import StaleElementReferenceException from selenium import webdriver from selenium.webdriver.common.by import By import time import re import csv with open(f&#39;boss_job_city_info.csv&#39;,&#39;a&#39;,encoding=&#39;ANSI&#39;,newline=&#39;&#39;) as filename: csvwriter = csv.DictWriter(filename,fieldnames=[ &#39;岗位&#39;,&#39;地点&#39;,&#39;薪资&#39;,&#39;工作经验&#39;,&#39;学历&#39;,&#39;公司名称&#39;,&#39;技能&#39;,&#39;工作福利&#39;,&#39;工作类型&#39;,&#39;融资情况&#39;,&#39;公司规模&#39;,&#39;链接&#39; ]) path = &#39;chromedriver.exe&#39; dr = webdriver.Chrome(path) dr.get(&#34;https://www.zhipin.com/web/geek/job?query=AI&amp;city=101030100&amp;page=9&#34;) dr.implicitly_wait(8) time.sleep(5) def job_info(): job_list = dr.find_elements(By.CLASS_NAME, &#39;job-card-wrapper&#39;) for job in job_list: # 职位 job_name = job.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-04T15:52:27+08:00">
    <meta property="article:modified_time" content="2024-07-04T15:52:27+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于Hadoop的招聘数据可视化系统实现（爬虫、hadoop&#43;hive、flask&#43;echarts、薪资预测、岗位推荐）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#_1" rel="nofollow">概要</a></li><li><a href="#_5" rel="nofollow">整体架构流程</a></li><li><a href="#_10" rel="nofollow">项目实现</a></li><li><a href="#_261" rel="nofollow">数据挖掘</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_1"></a>概要</h3> 
<pre><code>	随着大数据技术的兴起，AI人工智能领域迎来了大量的人才，而网络招聘成为了求职者的首选渠道。然而，招聘网站信息往往是重复、分散且不一致，就业人员需要花费大量时间才能找到真正合适的岗位。
</code></pre> 
<h3><a id="_5"></a>整体架构流程</h3> 
<p>本文利用Flask框架设计并实现了一个AI岗位招聘数据可视化系统。首先，系统利用Selenium技术实现对网页数据的自动抓取；接着，构建由三台服务器组成的Hadoop集群，并将爬取数据存储在HDFS分布式文件系统中，使用基于Spark的Hive数据仓库进行数据处理和分析，生成得到的分析数据用可视化方式呈现给用户；并且，系统还使用线性回归算法实现薪资预测以及基于用户的协同过滤算法实现岗位推荐功能，最终给用户提供了一个更加直观、易懂的AI岗位招聘数据可视化系统。</p> 
<p>项目流程架构图<img src="https://images2.imgbox.com/a3/b4/XMfLuhXB_o.png" alt=""></p> 
<h3><a id="_10"></a>项目实现</h3> 
<p>系统主要分为三个部分：数据采集-搭建数据仓库-建设数据可视化系统</p> 
<p><strong>1、数据采集</strong><br> 数据采集使用的技术是Selenium，而Selenium是能够在浏览器中运行测试，仿佛是真实用户在进行操作一样的工具，Selenium能模拟浏览器发送请求，并与网页中的元素进行交互，从而在网页中提取出数据，相较于其他的爬虫方法，Selenium能高效爬取到动态的数据，采用合法手段进行反爬虫策略，确保数据的有效爬取。</p> 
<p>从Boss直聘网站上爬取AI岗位招聘数据，而爬取得到的数据由csv文件保存</p> 
<p><img src="https://images2.imgbox.com/34/b3/jeWd9OPU_o.png" alt="在这里插入图片描述"><br> <strong>编写爬虫程序</strong></p> 
<p>根据所需要后续可视化分析展示的数据进行元素定位采集</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> datetime
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support<span class="token punctuation">.</span>ui <span class="token keyword">import</span> WebDriverWait
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>common<span class="token punctuation">.</span>exceptions <span class="token keyword">import</span> StaleElementReferenceException
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By
<span class="token keyword">import</span> time
<span class="token keyword">import</span> re
<span class="token keyword">import</span> csv

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'boss_job_city_info.csv'</span></span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'ANSI'</span><span class="token punctuation">,</span>newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">as</span> filename<span class="token punctuation">:</span>
    csvwriter <span class="token operator">=</span> csv<span class="token punctuation">.</span>DictWriter<span class="token punctuation">(</span>filename<span class="token punctuation">,</span>fieldnames<span class="token operator">=</span><span class="token punctuation">[</span>
        <span class="token string">'岗位'</span><span class="token punctuation">,</span><span class="token string">'地点'</span><span class="token punctuation">,</span><span class="token string">'薪资'</span><span class="token punctuation">,</span><span class="token string">'工作经验'</span><span class="token punctuation">,</span><span class="token string">'学历'</span><span class="token punctuation">,</span><span class="token string">'公司名称'</span><span class="token punctuation">,</span><span class="token string">'技能'</span><span class="token punctuation">,</span><span class="token string">'工作福利'</span><span class="token punctuation">,</span><span class="token string">'工作类型'</span><span class="token punctuation">,</span><span class="token string">'融资情况'</span><span class="token punctuation">,</span><span class="token string">'公司规模'</span><span class="token punctuation">,</span><span class="token string">'链接'</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>


    path <span class="token operator">=</span> <span class="token string">'chromedriver.exe'</span>
    dr <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>path<span class="token punctuation">)</span>
    dr<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://www.zhipin.com/web/geek/job?query=AI&amp;city=101030100&amp;page=9"</span><span class="token punctuation">)</span>
    dr<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>


    <span class="token keyword">def</span> <span class="token function">job_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        job_list <span class="token operator">=</span> dr<span class="token punctuation">.</span>find_elements<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CLASS_NAME<span class="token punctuation">,</span> <span class="token string">'job-card-wrapper'</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> job <span class="token keyword">in</span> job_list<span class="token punctuation">:</span>
            <span class="token comment"># 职位</span>
            job_name <span class="token operator">=</span> job<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CLASS_NAME<span class="token punctuation">,</span><span class="token string">'job-name'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
            <span class="token comment"># 地点</span>
            job_area <span class="token operator">=</span> job<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CLASS_NAME<span class="token punctuation">,</span><span class="token string">'job-area'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
            <span class="token comment"># 薪资</span>
            salary_raw <span class="token operator">=</span> job<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CLASS_NAME<span class="token punctuation">,</span> <span class="token string">'salary'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
            salary_split <span class="token operator">=</span> salary_raw<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'·'</span><span class="token punctuation">)</span>
            salary <span class="token operator">=</span> salary_split<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

            <span class="token keyword">if</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r'天'</span><span class="token punctuation">,</span>salary<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">continue</span>

            <span class="token comment"># experience_education = job.find_elements(By.XPATH, '//ul[@class="tag-list"]/li')</span>
            experience_education <span class="token operator">=</span> job<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CLASS_NAME<span class="token punctuation">,</span><span class="token string">'tag-list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>find_elements<span class="token punctuation">(</span>By<span class="token punctuation">.</span>TAG_NAME<span class="token punctuation">,</span><span class="token string">'li'</span><span class="token punctuation">)</span>
            <span class="token comment"># 工作经验</span>
            experience <span class="token operator">=</span> experience_education<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text
            education <span class="token operator">=</span> experience_education<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text
            <span class="token comment"># 学历</span>

            <span class="token comment"># 公司名称</span>
            company_name <span class="token operator">=</span> job<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CLASS_NAME<span class="token punctuation">,</span> <span class="token string">'company-name'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text

            company_tag_list <span class="token operator">=</span> job<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CLASS_NAME<span class="token punctuation">,</span> <span class="token string">'company-tag-list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>find_elements<span class="token punctuation">(</span>By<span class="token punctuation">.</span>TAG_NAME<span class="token punctuation">,</span><span class="token string">'li'</span><span class="token punctuation">)</span>

            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>company_tag_list<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'跳过'</span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>
            <span class="token comment"># 公司类型</span>
            company_type <span class="token operator">=</span> company_tag_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text
            <span class="token comment"># 公司融资</span>
            company_salary_info <span class="token operator">=</span> company_tag_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text
            <span class="token comment"># 公司规模</span>
            company_size_info <span class="token operator">=</span> company_tag_list<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text
            <span class="token comment"># 工作福利</span>
            company_welfare <span class="token operator">=</span> job<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CLASS_NAME<span class="token punctuation">,</span> <span class="token string">'info-desc'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
            <span class="token comment"># 技能</span>
            skill_list <span class="token operator">=</span> job<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span> <span class="token string">'.job-card-footer.clearfix'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CLASS_NAME<span class="token punctuation">,</span><span class="token string">'tag-list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>find_elements<span class="token punctuation">(</span>By<span class="token punctuation">.</span>TAG_NAME<span class="token punctuation">,</span><span class="token string">'li'</span><span class="token punctuation">)</span>
            skill <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> skill_l <span class="token keyword">in</span> skill_list<span class="token punctuation">:</span>
                skill_i_text <span class="token operator">=</span> skill_l<span class="token punctuation">.</span>text
                <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>skill_i_text<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                    <span class="token keyword">continue</span>
                skill<span class="token punctuation">.</span>append<span class="token punctuation">(</span>skill_i_text<span class="token punctuation">)</span>

            href <span class="token operator">=</span> job<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span><span class="token string">'.job-card-body a'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_attribute<span class="token punctuation">(</span><span class="token string">'href'</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>href<span class="token punctuation">)</span>

            <span class="token builtin">dict</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
                <span class="token string">'岗位'</span><span class="token punctuation">:</span> job_name<span class="token punctuation">,</span>
                <span class="token string">'地点'</span><span class="token punctuation">:</span> job_area<span class="token punctuation">,</span>
                <span class="token string">'薪资'</span><span class="token punctuation">:</span> salary<span class="token punctuation">,</span>
                <span class="token string">'工作经验'</span><span class="token punctuation">:</span>experience<span class="token punctuation">,</span>
                <span class="token string">'学历'</span><span class="token punctuation">:</span>education<span class="token punctuation">,</span>
                <span class="token string">'公司名称'</span><span class="token punctuation">:</span>company_name<span class="token punctuation">,</span>
                <span class="token string">'技能'</span><span class="token punctuation">:</span> skill<span class="token punctuation">,</span>
                <span class="token string">'工作福利'</span><span class="token punctuation">:</span>company_welfare<span class="token punctuation">,</span>
                <span class="token string">'工作类型'</span><span class="token punctuation">:</span> company_type<span class="token punctuation">,</span>
                <span class="token string">'融资情况'</span><span class="token punctuation">:</span>company_salary_info<span class="token punctuation">,</span>
                <span class="token string">'公司规模'</span><span class="token punctuation">:</span> company_size_info<span class="token punctuation">,</span>
                <span class="token string">'链接'</span><span class="token punctuation">:</span>href
            <span class="token punctuation">}</span>
            csvwriter<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span><span class="token builtin">dict</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>job_name<span class="token punctuation">,</span> job_area<span class="token punctuation">,</span> salary<span class="token punctuation">,</span> experience<span class="token punctuation">,</span> education<span class="token punctuation">,</span> company_name<span class="token punctuation">,</span> company_type<span class="token punctuation">,</span> company_salary_info<span class="token punctuation">,</span>
                  company_size_info<span class="token punctuation">,</span> company_welfare<span class="token punctuation">,</span> skill<span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">'|'</span><span class="token punctuation">)</span>
        dr<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CLASS_NAME<span class="token punctuation">,</span><span class="token string">'ui-icon-arrow-right'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>




    <span class="token keyword">for</span> page <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
        job_info<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>2、搭建数据仓库</strong><br> 数据处理采用的是使用Hive数据仓库对数据进行数据分层架构设计，首先该系统数据分析平台基于CentOs7搭建，并安装好Hadoop各生态核心组件，根据项目环境要求，在Vmvare中创建了三台虚拟机，配置好虚拟机环境后，开始构建Hadoop分布式集群，对系统环境、Hadoop的配置文件进行修改，其中配置了主节点Hadoop202负责集群的管理和控制，Hadoop203和Hadoop204则是负责数据的存储以及计算，集群三个节点之间的协作可以快速处理分析大规模的数据。<br> <em><strong>启动hadoop如图所示：</strong></em></p> 
<p><img src="https://images2.imgbox.com/9a/ef/iPoSLCCM_o.png" alt="在这里插入图片描述"><br> 紧接着是搭建Hive数据仓库，安装配置Hive的环境变量，修改Hive中conf目录下的配置文件，将HDFS分布式文件系统和Yarn集群地址写入配置文件，并且需要安装MySQL，把Hive的元数据配置到MySQL中，为了方便后续在Hive的设计数据分层，通过hiveserver2建立远程连接的端口，使用了DataGrip工具远程连接Hive数据仓库，对数据仓库进行SQL操作。</p> 
<p><em><strong>启动hiveserver2：</strong></em><br> <img src="https://images2.imgbox.com/07/a0/jaCeZ9Xd_o.png" alt="在这里插入图片描述"><br> 安装好hive后，对数据上传到hdfs分布式文件系统上，在hive使用创建表映射出表数据，系统分层采用了ODS-DWD-DWA的结构，ODS层则为源数据，DWD为对ODS层的数据进行清洗加工，DWA层数据是根据后续图表需要展示的数据进行细分。</p> 
<p><em><strong>查询ODS层数据：</strong></em><br> <img src="https://images2.imgbox.com/b8/93/rh1OZqdN_o.png" alt="在这里插入图片描述"><br> <em><strong>DWA层在HDFS文件系统分布：</strong></em></p> 
<p><img src="https://images2.imgbox.com/07/ea/Jp0KzhXT_o.png" alt="在这里插入图片描述"><br> 从数据仓库经过分层后得到了清洗、转换和统计后的数据，为了后续实现数据可视化系统，使用MySQL关系型数据库存储经过一系列处理后的数据，根据不同的业务需求创建不同的表存储对应的分析数据，所以使用数据交互工具Sqoop对HDFS上的数据导出到MySQL数据库：</p> 
<pre><code>bin/sqoop export \
--connect jdbc:mysql://hadoop202:3306/boss \
--username root \
--password 123456 \
--table dwa_job_industry_count \
--columns "company_type,numbers" \
--export-dir /user/hive/warehouse/boss.db/dwa_job_industry_count \
--input-fields-terminated-by "\001"

</code></pre> 
<p><strong>3、数据可视化系统</strong></p> 
<p>系统采用了Flask框架+echarts可视化工具进行可视化系统设计，并且加入了线性回归算法对薪资进行预测和基于用户协同过滤算法进行岗位推荐。<br> <img src="https://images2.imgbox.com/64/87/39XcPW6A_o.png" alt="在这里插入图片描述"><br> 部分可视化图表展示：<br> <img src="https://images2.imgbox.com/ff/f2/7oLMlFKw_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/bc/91/opn0uvFk_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/59/79/PvJYG3cH_o.png" alt="在这里插入图片描述"><br> <em><strong>岗位推荐功能：</strong></em><br> <img src="https://images2.imgbox.com/ca/e6/O7PGmPp3_o.png" alt="在这里插入图片描述"><br> 预测薪资功能：<br> <img src="https://images2.imgbox.com/0a/49/mTqD2n6i_o.png" alt="在这里插入图片描述"><br> 其中代码实现：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> sqlalchemy <span class="token keyword">import</span> create_engine
<span class="token keyword">import</span> pymysql
<span class="token comment"># 连接到数据库</span>
con <span class="token operator">=</span> create_engine<span class="token punctuation">(</span><span class="token string">'mysql+pymysql://root:123456@192.168.10.202:3306/boss?charset=utf8'</span><span class="token punctuation">)</span>

<span class="token comment"># 用户</span>
df_user <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span><span class="token string">'select * from user'</span><span class="token punctuation">,</span>con<span class="token operator">=</span>con<span class="token punctuation">)</span>

df_taobao <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span><span class="token string">'select * from extracteddata'</span><span class="token punctuation">,</span> con<span class="token operator">=</span>con<span class="token punctuation">)</span>
<span class="token comment"># 地图</span>
df_area <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span><span class="token string">'select * from dwa_job_area_count'</span><span class="token punctuation">,</span>con<span class="token operator">=</span>con<span class="token punctuation">)</span>
<span class="token comment"># 城市地区，薪资</span>
df_city <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span><span class="token string">'select * from dwa_job_city_area_count'</span><span class="token punctuation">,</span>con<span class="token operator">=</span>con<span class="token punctuation">)</span>
<span class="token comment"># 公司招聘排名</span>
df_company <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span><span class="token string">'select * from dwa_job_company_name_count'</span><span class="token punctuation">,</span>con<span class="token operator">=</span>con<span class="token punctuation">)</span>
<span class="token comment"># 学历要求</span>
df_education <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span><span class="token string">'select * from dwa_job_education_count'</span><span class="token punctuation">,</span>con<span class="token operator">=</span>con<span class="token punctuation">)</span>
<span class="token comment"># 学历对应工资</span>
df_eduSal <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span><span class="token string">'select * from dwa_job_education_salary_count order by salary desc '</span><span class="token punctuation">,</span>con<span class="token operator">=</span>con<span class="token punctuation">)</span>
<span class="token comment"># 工作经验</span>
df_experience <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span><span class="token string">'select * from dwa_job_experience_count'</span><span class="token punctuation">,</span>con<span class="token operator">=</span>con<span class="token punctuation">)</span>
<span class="token comment"># 工作经验对应工资</span>
df_experienceSal <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span><span class="token string">'select * from dwa_job_experience_salary_count order by salary desc '</span><span class="token punctuation">,</span>con<span class="token operator">=</span>con<span class="token punctuation">)</span>
<span class="token comment"># 融资情况</span>
df_financing <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span><span class="token string">'select * from dwa_job_financing_count'</span><span class="token punctuation">,</span>con<span class="token operator">=</span>con<span class="token punctuation">)</span>
<span class="token comment"># 职业方向分布</span>
df_industry <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span><span class="token string">'select * from dwa_job_industry_count order by numbers desc'</span><span class="token punctuation">,</span>con<span class="token operator">=</span>con<span class="token punctuation">)</span>
<span class="token comment"># 职位数量</span>
df_job <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span><span class="token string">'select * from dwa_job_name_count order by numbers desc'</span><span class="token punctuation">,</span>con<span class="token operator">=</span>con<span class="token punctuation">)</span>
<span class="token comment"># ai职位薪资</span>
df_aiSal <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span><span class="token string">'select * from dwa_job_name_salary_count order by salary desc'</span><span class="token punctuation">,</span>con<span class="token operator">=</span>con<span class="token punctuation">)</span>
<span class="token comment"># 技能要求</span>
df_skill <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span><span class="token string">'select * from dwa_job_skill_count'</span><span class="token punctuation">,</span>con<span class="token operator">=</span>con<span class="token punctuation">)</span>

df_job_info <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span><span class="token string">'select * from dwa_boss_job_info_detail'</span><span class="token punctuation">,</span>con<span class="token operator">=</span>con<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/re_men'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">re_men</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    email <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'email'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'GET'</span><span class="token punctuation">:</span>
        city <span class="token operator">=</span> query<span class="token punctuation">.</span>querys<span class="token punctuation">(</span><span class="token string">'select * from dwa_job_city_area_count where job_city like %s order by salary desc'</span><span class="token punctuation">,</span>
                            <span class="token punctuation">[</span><span class="token string">'深圳'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            <span class="token string">'select'</span><span class="token punctuation">)</span>

    <span class="token keyword">elif</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>
        request<span class="token punctuation">.</span>form <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>form<span class="token punctuation">)</span>
        city <span class="token operator">=</span> query<span class="token punctuation">.</span>querys<span class="token punctuation">(</span><span class="token string">'select * from dwa_job_city_area_count where job_city like %s order by salary desc'</span><span class="token punctuation">,</span>
                            <span class="token punctuation">[</span>request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'area'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            <span class="token string">'select'</span><span class="token punctuation">)</span>
    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> data <span class="token keyword">in</span> city<span class="token punctuation">:</span>
        data_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'job_area'</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">'salary'</span><span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>data_dict<span class="token punctuation">)</span>
    data <span class="token operator">=</span> df_area<span class="token punctuation">.</span>to_dict<span class="token punctuation">(</span>orient<span class="token operator">=</span><span class="token string">'records'</span><span class="token punctuation">)</span>
    <span class="token comment"># 提取不同列的数据</span>
    job_areas <span class="token operator">=</span> df_area<span class="token punctuation">[</span><span class="token string">'job_area'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
    numbers <span class="token operator">=</span> df_area<span class="token punctuation">[</span><span class="token string">'numbers'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span>
        <span class="token string">'re_men.html'</span><span class="token punctuation">,</span>
        email<span class="token operator">=</span>email<span class="token punctuation">,</span>
        city<span class="token operator">=</span>result<span class="token punctuation">,</span>
        data<span class="token operator">=</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> job_areas<span class="token operator">=</span>job_areas<span class="token punctuation">,</span> numbers<span class="token operator">=</span>numbers
    <span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>row<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                    {% for item in city %}
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>col-xl-3 mb-4<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card border-left-primary shadow h-100 py-2<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-body<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>row no-gutters align-items-center<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>col mr-2<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text-xs font-weight-bold text-primary text-uppercase mb-1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                                                {<!-- -->{ item['job_area'] }}
                                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>h5 mb-0 font-weight-bold text-gray-800<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{<!-- -->{ item['salary'] }}K<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                    {% endfor %}
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h3><a id="_261"></a>数据挖掘</h3> 
<p><em>薪资预测</em>：</p> 
<p>薪资预测模型分析的数据是采用爬取下来的数据进行预测，在分析之前，需要对数据进行特征清洗，将数据出现空缺或者杂乱情况，清洗后才能拿来使用，保证数据分析的正确性。<br> 首先，通过读取文件获取文件的信息，进而查看爬取下来的文件数据的前两行信息，观察数据并对数据进行分析处理，为后续进行模型预测奠定基础。文件数据格式如图所示：</p> 
<p><img src="https://images2.imgbox.com/e9/1a/MyhQI80X_o.png" alt="在这里插入图片描述"></p> 
<p>通过查看前两行文件可知，地区、薪资、工作经验都的数据格式都不符合进行模型分析，需要对地区进行字符串切割，而薪资、工作经验则是取区间的平均值，由此得到具体的城市、薪资、工作经验数据，有利于后续的分析。处理结果数据如图所示：</p> 
<p><img src="https://images2.imgbox.com/ba/13/v6566HxH_o.png" alt="在这里插入图片描述"></p> 
<p>通过以上对数据进行清洗与预处理，部分数据本身是字符串形式，若要对他们进行模型预测，则需要将三种维度信息进行重编码，城市通过创建LabelEncoder()对象，使用fit_transform方法对城市数据进行拟合和转换的操作，以致于把城市转换伟数值编码以便分析，而工作经验原本只是数值类型无需作重编码，而学历的重编码使用字典形式对不同的学历进行赋值，赋值情况如表8所示。重编码完成完成后，对数据进行缺失值处理即可作为训练模型数据。</p> 
<p>表8 学历重编码表<br> 学历 重编码值<br> 中专/中技 0<br> 高中 1<br> 大专 2<br> 本科 3<br> 硕士 4<br> 博士 5<br> 学历不限 6</p> 
<p>训练代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">wage_pred</span><span class="token punctuation">(</span>area<span class="token punctuation">,</span> exp<span class="token punctuation">,</span> edu<span class="token punctuation">)</span><span class="token punctuation">:</span>
    jobs <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'D:\\毕设\\毕设\\毕设\\web - 副本\\utils\\boss_job_info_test.csv'</span><span class="token punctuation">,</span> engine<span class="token operator">=</span><span class="token string">'python'</span><span class="token punctuation">,</span>
                       encoding<span class="token operator">=</span><span class="token string">'gbk'</span><span class="token punctuation">)</span>
    jobs <span class="token operator">=</span> jobs<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'area'</span><span class="token punctuation">,</span> <span class="token string">'salary'</span><span class="token punctuation">,</span> <span class="token string">'education'</span><span class="token punctuation">,</span> <span class="token string">'experience'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    jobs<span class="token punctuation">[</span><span class="token string">'area'</span><span class="token punctuation">]</span> <span class="token operator">=</span> jobs<span class="token punctuation">[</span><span class="token string">'area'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>get_area<span class="token punctuation">)</span>
    jobs<span class="token punctuation">[</span><span class="token string">'experience'</span><span class="token punctuation">]</span> <span class="token operator">=</span> jobs<span class="token punctuation">[</span><span class="token string">'experience'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>get_exp<span class="token punctuation">)</span>
    jobs<span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">]</span> <span class="token operator">=</span> jobs<span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>get_salary<span class="token punctuation">)</span>

    <span class="token comment"># 对城市进行重编码</span>
    le_area <span class="token operator">=</span> LabelEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span>
    jobs<span class="token punctuation">[</span><span class="token string">'area_code'</span><span class="token punctuation">]</span> <span class="token operator">=</span> le_area<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>jobs<span class="token punctuation">[</span><span class="token string">'area'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># 对教育程度进行重编码</span>
    education_mapping <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'中专/中技'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'高中'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'大专'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'本科'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'硕士'</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'博士'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'学历不限'</span><span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">}</span>
    jobs<span class="token punctuation">[</span><span class="token string">'education_code'</span><span class="token punctuation">]</span> <span class="token operator">=</span> jobs<span class="token punctuation">[</span><span class="token string">'education'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>education_mapping<span class="token punctuation">)</span>

    <span class="token comment"># 处理缺失值</span>
    imputer <span class="token operator">=</span> SimpleImputer<span class="token punctuation">(</span>strategy<span class="token operator">=</span><span class="token string">'mean'</span><span class="token punctuation">)</span>
    X <span class="token operator">=</span> jobs<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'area_code'</span><span class="token punctuation">,</span> <span class="token string">'experience'</span><span class="token punctuation">,</span> <span class="token string">'education_code'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    X_imputed <span class="token operator">=</span> imputer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X<span class="token punctuation">)</span>

    <span class="token comment"># 模型学习</span>
    model <span class="token operator">=</span> LinearRegression<span class="token punctuation">(</span><span class="token punctuation">)</span>
    model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_imputed<span class="token punctuation">,</span> jobs<span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    area_code <span class="token operator">=</span> le_area<span class="token punctuation">.</span>transform<span class="token punctuation">(</span><span class="token punctuation">[</span>area<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    edu_code <span class="token operator">=</span> education_mapping<span class="token punctuation">[</span>edu<span class="token punctuation">]</span>
    X_input <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>area_code<span class="token punctuation">,</span> exp<span class="token punctuation">,</span> edu_code<span class="token punctuation">]</span><span class="token punctuation">]</span>
    wage_pred <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_input<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>wage_pred<span class="token punctuation">)</span>
    <span class="token keyword">return</span> wage_pred
</code></pre> 
<p><em><strong>岗位推荐：</strong></em><br> 推荐算法使用的是基于用户的协同过滤算法，计算用户之间的相似度，将与其他用户相比相似度最高的用户的收藏列表以及搜索列表，再将收藏列表的岗位进行加权比重，将排名靠前的十个岗位推荐给登录用户。</p> 
<p>代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> sqlalchemy <span class="token keyword">import</span> create_engine
<span class="token keyword">import</span> pymysql
<span class="token comment"># 连接到数据库</span>
con <span class="token operator">=</span> create_engine<span class="token punctuation">(</span><span class="token string">'mysql+pymysql://root:123456@192.168.10.202:3306/boss?charset=utf8'</span><span class="token punctuation">)</span>

<span class="token comment"># 用户</span>
df_collection <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span><span class="token string">'select user_id,job_id from collection union all select user_id,job_id from select_job'</span><span class="token punctuation">,</span>con<span class="token operator">=</span>con<span class="token punctuation">)</span>
data <span class="token operator">=</span> df_collection<span class="token punctuation">.</span>to_dict<span class="token punctuation">(</span>orient<span class="token operator">=</span><span class="token string">'records'</span><span class="token punctuation">)</span>


<span class="token comment"># 创建一个空字典</span>
merged_data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>

<span class="token comment"># 遍历数据列表</span>
<span class="token keyword">for</span> entry <span class="token keyword">in</span> data<span class="token punctuation">:</span>
    user_id <span class="token operator">=</span> entry<span class="token punctuation">[</span><span class="token string">'user_id'</span><span class="token punctuation">]</span>
    job_id <span class="token operator">=</span> entry<span class="token punctuation">[</span><span class="token string">'job_id'</span><span class="token punctuation">]</span>

    <span class="token comment"># 如果用户ID已经存在于合并后的字典中，则将作业ID添加到对应的值列表中</span>
    <span class="token keyword">if</span> user_id <span class="token keyword">in</span> merged_data<span class="token punctuation">:</span>
        merged_data<span class="token punctuation">[</span>user_id<span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>job_id<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token comment"># 如果用户ID不存在于合并后的字典中，则创建一个新的键值对</span>
        merged_data<span class="token punctuation">[</span>user_id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>job_id<span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment"># 将合并后的字典转换为所需的格式</span>
result <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token builtin">str</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> merged_data<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token comment"># 基于用户的协同过滤算法</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">UserCF</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> user_item_dict<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 将每个用户的物品取集合</span>
        self<span class="token punctuation">.</span>user_item_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>key<span class="token punctuation">:</span> <span class="token builtin">set</span><span class="token punctuation">(</span>user_item_dict<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> key <span class="token keyword">in</span> user_item_dict<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token comment"># 用户列表</span>
        self<span class="token punctuation">.</span>users_list <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>user_item_dict<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># 两两用户之间计算用户相似度</span>
    <span class="token keyword">def</span> <span class="token function">compute_similer_twouser</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 记录与其他用户相似度的字典</span>
        user_similer_list <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">for</span> i <span class="token keyword">in</span> self<span class="token punctuation">.</span>users_list<span class="token punctuation">:</span>
            user_similer_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> self<span class="token punctuation">.</span>users_list<span class="token punctuation">:</span>
                <span class="token comment"># 去除自身相似度</span>
                <span class="token keyword">if</span> i <span class="token operator">!=</span> j<span class="token punctuation">:</span>
                    <span class="token comment"># 两用户间物品并集，并计算余弦相似度</span>
                    similer_item <span class="token operator">=</span> self<span class="token punctuation">.</span>user_item_dict<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> self<span class="token punctuation">.</span>user_item_dict<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
                    user_similer_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">round</span><span class="token punctuation">(</span>
                        <span class="token builtin">len</span><span class="token punctuation">(</span>similer_item<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>user_item_dict<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>user_item_dict<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> user_similer_list

    <span class="token comment">#     优化后的倒查表方式计算用户相似度</span>
    <span class="token keyword">def</span> <span class="token function">computer_similer_backform_normal</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
        <span class="token comment"># 记录物品的所有用户的字典</span>
        item_user_dict <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 建立物品到用户的倒查表</span>
        <span class="token keyword">for</span> i<span class="token punctuation">,</span> items <span class="token keyword">in</span> self<span class="token punctuation">.</span>user_item_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> items<span class="token punctuation">:</span>
                <span class="token keyword">if</span> j <span class="token keyword">not</span> <span class="token keyword">in</span> item_user_dict<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    item_user_dict<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                item_user_dict<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>

        <span class="token comment"># 建立用户物品二维矩阵</span>
        user_matrix <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>users_list<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>users_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> item<span class="token punctuation">,</span> users <span class="token keyword">in</span> item_user_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> user1 <span class="token keyword">in</span> users<span class="token punctuation">:</span>
                <span class="token keyword">for</span> user2 <span class="token keyword">in</span> users<span class="token punctuation">:</span>
                    <span class="token keyword">if</span> user1 <span class="token operator">!=</span> user2<span class="token punctuation">:</span>
                        <span class="token comment"># 记录不同用户间共同物品的数目</span>
                        user_matrix<span class="token punctuation">[</span>self<span class="token punctuation">.</span>users_list<span class="token punctuation">.</span>index<span class="token punctuation">(</span>user1<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span>self<span class="token punctuation">.</span>users_list<span class="token punctuation">.</span>index<span class="token punctuation">(</span>user2<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>

        <span class="token comment"># 计算用户相似度</span>
        user_similer_list <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> user1 <span class="token keyword">in</span> self<span class="token punctuation">.</span>users_list<span class="token punctuation">:</span>
            user_similer_list<span class="token punctuation">[</span>user1<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> user2 <span class="token keyword">in</span> self<span class="token punctuation">.</span>users_list<span class="token punctuation">:</span>
                <span class="token keyword">if</span> user1 <span class="token operator">!=</span> user2<span class="token punctuation">:</span>
                    <span class="token comment"># 利用二维矩阵存储的用户相似度进行计算</span>
                    user_similer_list<span class="token punctuation">[</span>user1<span class="token punctuation">]</span><span class="token punctuation">[</span>user2<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">round</span><span class="token punctuation">(</span>
                        user_matrix<span class="token punctuation">[</span>self<span class="token punctuation">.</span>users_list<span class="token punctuation">.</span>index<span class="token punctuation">(</span>user1<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span>self<span class="token punctuation">.</span>users_list<span class="token punctuation">.</span>index<span class="token punctuation">(</span>user2<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">/</span>
                        <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>user_item_dict<span class="token punctuation">[</span>user1<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>user_item_dict<span class="token punctuation">[</span>user2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> user_similer_list
</code></pre> 
<p>参考文章</p> 
<blockquote> 
 <p>https://blog.csdn.net/cxm259/article/details/118961604<br> https://blog.csdn.net/BGMcat/article/details/123300633</p> 
</blockquote> 
<p>版权声明：本文为博主原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接和本声明。<br> 本文链接：https://blog.csdn.net/weixin_53118431/article/details/140174857</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/81ce8adaeaf038a49c6bd1b72486147d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">.Net C#执行JavaScript脚本</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fec807b6fa5ed56b4cb223a27eb21805/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【C#】如何在窗体程序中调用多行CMD命令</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>