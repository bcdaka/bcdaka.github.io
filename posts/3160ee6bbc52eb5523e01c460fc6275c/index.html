<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Mybatis动态sql标签 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/3160ee6bbc52eb5523e01c460fc6275c/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Mybatis动态sql标签">
  <meta property="og:description" content="动态SQL标签简介: MyBatis的一个强大的特性之一通常是它的动态SQL能力。如果你有使用JDBC或其他相似框架的经验,你就明白条件地串联SQL字符串在一起是多么的痛苦,确保不能忘了空格或在列表的最后省略逗号。动态SQL可以彻底处理这种痛苦。
Mybatis中实现动态sql的标签有： &lt;if&gt; &lt;where&gt; &lt;trim&gt; &lt;set&gt; &lt;choose&gt; &lt;foreach&gt;
示例对象（Student）： package com.ffyc.mybatis.model; public class Student { private Integer id; private Integer num;//建议不使用基本类型，使用包装类型，包装类型默认值都是null，后期判断会方便 private String name; private String gender; private Major major;//类与类之间的关联关系 has-a关系 什么有什么，将专业信息封装到专业对象中，减少冗余 public Major getMajor() { return major; } public void setMajor(Major major) { this.major = major; } public Integer getId() { return id; } public void setId(Integer id) { this.id = id; } public Integer getNum() { return num; } public void setNum(Integer num) { this.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-15T19:50:57+08:00">
    <meta property="article:modified_time" content="2024-06-15T19:50:57+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Mybatis动态sql标签</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>动态SQL标签简介:</h2> 
<p>        MyBatis的一个强大的特性之一通常是它的动态SQL能力。如果你有使用JDBC或其他相似框架的经验,你就明白条件地串联SQL字符串在一起是多么的痛苦,确保不能忘了空格或在列表的最后省略逗号。动态SQL可以彻底处理这种痛苦。</p> 
<p><strong>Mybatis中实现动态sql的标签有： &lt;if&gt;        &lt;where&gt;        &lt;trim&gt;        &lt;set&gt;        &lt;choose&gt;       &lt;foreach&gt;</strong></p> 
<h2>示例对象（Student）：</h2> 
<pre><code class="language-java">package com.ffyc.mybatis.model;

public class Student {
    private Integer id;
    private Integer num;//建议不使用基本类型，使用包装类型，包装类型默认值都是null，后期判断会方便
    private String name;
    private String gender;
    private Major major;//类与类之间的关联关系    has-a关系   什么有什么，将专业信息封装到专业对象中，减少冗余

    public Major getMajor() {
        return major;
    }

    public void setMajor(Major major) {
        this.major = major;
    }

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public Integer getNum() {
        return num;
    }

    public void setNum(Integer num) {
        this.num = num;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getGender() {
        return gender;
    }

    public void setGender(String gender) {
        this.gender = gender;
    }

    @Override
    public String toString() {
        return "Student{" +
                "id=" + id +
                ", num=" + num +
                ", name='" + name + '\'' +
                ", gender='" + gender + '\'' +
                ", major=" + major +
                '}';
    }
}
</code></pre> 
<h2>&lt;if&gt;标签</h2> 
<p>        判断标签，用于添加判断条件：</p> 
<p>        当我们查询学生列表时，若是不查询特定名字，则打印所有学生信息，若是要查询特定名字，则我们只需要选择对应名字的学生，示例如下：</p> 
<p>Dao:</p> 
<pre><code class="language-java">List&lt;Student&gt; findStudents(Student student);</code></pre> 
<pre><code class="language-java">&lt;select id="findStudents" resultType="Student"&gt;
        select * from student
            &lt;if test="name!=null"&gt;
                where name = #{name}
            &lt;/if&gt;
&lt;/select&gt;--&gt;</code></pre> 
<h2>&lt;where&gt;标签 </h2> 
<p>        判断内部if标签如果有一个返回true，会自动添加一个where关键字，还会自动去除where后多余关键字.</p> 
<p>        在进行多条件查询时，例如：姓名，编号，性别。若性别为null则只需要查询姓名与编号相同的行，意思就是，几个元素不为null，就加几个判断条件。这时候就可以使用where进行多个条件的判断：</p> 
<p>Dao:</p> 
<pre><code class="language-java">List&lt;Student&gt; findStudents(Student student);</code></pre> 
<pre><code class="language-java">&lt;select id="findStudents" resultType="Student"&gt;
        select * from student where
        
            &lt;if test="name!=null"&gt;
                name = #{name}
            &lt;/if&gt;
            &lt;if test="num!=0"&gt;
                and num = #{num}
            &lt;/if&gt;
            &lt;if test="gender!=null"&gt;
                and gender = #{gender}
            &lt;/if&gt;
        
    &lt;/select&gt;</code></pre> 
<p>很明显，当我们写出来后会发现一个很糟糕的问题，要是传入的name值为null，查询语句：</p> 
<p>        select * from student where <span style="color:#fe2c24;">and</span> num=? and gender=?</p> 
<p>where后面出现了一个多余的关键字‘and’.</p> 
<p>这该怎么解决？</p> 
<p>有一种简单而暴力的方法：</p> 
<pre><code class="language-java">&lt;select id="findStudents" resultType="Student"&gt;
        select * from student where 1=1
      
            &lt;if test="name!=null"&gt;
                and name = #{name}
            &lt;/if&gt;
            &lt;if test="num!=0"&gt;
                and num = #{num}
            &lt;/if&gt;
            &lt;if test="gender!=null"&gt;
                and gender = #{gender}
            &lt;/if&gt;
        &lt;/select&gt;</code></pre> 
<p>这样一来，就不会出现where后面出现多余关键字的现象，这也是在&lt;where&gt;标签出现之前程序猿面对这种问题采取的措施。</p> 
<p>有人就觉得了：有没有优雅一点的写法？</p> 
<p>        这时候就到我们&lt;where&gt;标签出场了：</p> 
<pre><code class="language-XML">&lt;select id="findStudents" resultType="Student"&gt;
        select * from student
        &lt;where&gt;
            &lt;if test="name!=null"&gt;
                and name = #{name}
            &lt;/if&gt;
            &lt;if test="num!=0"&gt;
                and num = #{num}
            &lt;/if&gt;
            &lt;if test="gender!=null"&gt;
                and gender = #{gender}
            &lt;/if&gt;
        &lt;/where&gt;
    &lt;/select&gt;</code></pre> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/c5/d3/rdlyudlC_o.png"></p> 
<p>雅！太雅了！<strong>&lt;where&gt;标签会自动添加一个where关键字，还会自动去除where后多余关键字</strong>。</p> 
<h2>&lt;choose&gt;标签</h2> 
<p>        &lt;choose&gt;标签与&lt;when&gt;标签和&lt;otherwise&gt;标签配用用于判定多重条件的语句 </p> 
<p>        应用场景：若传值有名字则查找名字，若没有则查找编号若还是没有则查找名为'kk'的人</p> 
<p>Dao：</p> 
<pre><code class="language-java">List&lt;Student&gt; findStudents(Student student);</code></pre> 
<pre><code class="language-XML">&lt;select id="findStudents" resultType="Student"&gt;
        select * from student where
        &lt;choose&gt;
            &lt;when test="name!=null"&gt;
                name=#{name}
            &lt;/when&gt;
            &lt;when test="num!=null"&gt;
                num=#{num}
            &lt;/when&gt;
            &lt;otherwise&gt;
                name='kk'
            &lt;/otherwise&gt;
        &lt;/choose&gt;
    &lt;/select&gt;</code></pre> 
<p>当传值为：name=“张三” num=1</p> 
<p><img alt="" src="https://images2.imgbox.com/10/59/WTf7eJmd_o.png"> </p> 
<p>当传值为： name=null num=1</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/8c/e8/ayGjPASc_o.png"></p> 
<p> 当传值为： name=null num=null</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/c7/ff/aqwvsgiS_o.png"></p> 
<h2>&lt;trim&gt;标签 </h2> 
<p>        当我们需要修改某些数据时，我们可以用到&lt;trim&gt;来删去多余的符号(或关键字)或是添加我们需要的符号(或关键字)</p> 
<p>        应用场景：修改指定id的某几列</p> 
<p>Dao:</p> 
<pre><code class="language-java">void updatestudent(Student student);</code></pre> 
<pre><code class="language-XML">&lt;update id="updatestudent" parameterType="student"&gt;
        update student
        &lt;trim prefix="set" suffixOverrides=","&gt;
            &lt;if test="name!=null"&gt;
                name=#{name},
            &lt;/if&gt;
            &lt;if test="num!=null"&gt;
                num=#{num},
            &lt;/if&gt;
            &lt;if test="gender!=null"&gt;
                gender=#{gender}
            &lt;/if&gt;
        &lt;/trim&gt;
        where id=#{id}
    &lt;/update&gt;</code></pre> 
<p>在student后添加“set”，删去最后的“,”.</p> 
<p>当传值为：name=op        num=1005        id=1</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/78/7d/ymOkM8Fn_o.png"></p> 
<h2> &lt;set&gt;标签</h2> 
<p>        在标签前添加set，将最后的多余的逗号删除</p> 
<p>        应用场景：与上面的&lt;trim&gt;标签相同，修改指定id的某几列</p> 
<p>Dao:</p> 
<pre><code class="language-java">void updatestudent(Student student);</code></pre> 
<pre><code class="language-XML">&lt;update id="updatestudent" parameterType="student"&gt;
        update student
        &lt;set&gt;
            &lt;if test="name!=null"&gt;
                name=#{name},
            &lt;/if&gt;
            &lt;if test="num!=null"&gt;
                num=#{num},
            &lt;/if&gt;
            &lt;if test="gender!=null"&gt;
                gender=#{gender}
            &lt;/if&gt;

        &lt;/set&gt;
        where id=#{id}
    &lt;/update&gt;</code></pre> 
<p><img alt="" src="https://images2.imgbox.com/35/62/uAbeuKx7_o.png"></p> 
<h2>&lt;foreach&gt;标签 </h2> 
<p>        主要用在构建in条件中，它可以在SQL语句中进行迭代一个集合。foreach元素的属性主要有item，index，collection，open，separator，close。</p> 
<p><strong>        item：</strong> 定义一个变量，接收每次循环中获得的元素</p> 
<p><strong>        collection：</strong> 循环的集合类型 list-集合 array-数量</p> 
<p><strong>        open：</strong> 循环开始的一个符号</p> 
<p><strong>        close：</strong> 循环结束的一个符号</p> 
<p><strong>        separator：</strong> 每次循环后的一个分隔符号</p> 
<p><strong>        index：</strong> 循环时生成的索引</p> 
<p>        应用场景：当需要使用到一串相同类型变量时，可以与List或Integer[]搭配使用</p> 
<p>         (1)当需要删除一组数据时我们可以接收这组数据的id，再用&lt;foreeach&gt;标签循环检索</p> 
<p>Dao:</p> 
<pre><code class="language-java">void deleteStudent(List&lt;Integer&gt; list);</code></pre> 
<p> 或 </p> 
<pre><code class="language-java">void deleteStudent(Integer[] array);</code></pre> 
<pre><code class="language-XML">&lt;delete id="deleteStudent"&gt;
        delete from student where id in
        &lt;foreach item="a" collection="list" open="(" close=")" separator=","&gt;
            #{a}
        &lt;/foreach&gt;
    &lt;/delete&gt;</code></pre> 
<p>当传值为：[7,8]</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/d3/a8/Lufyvif1_o.png"></p> 
<p>        (2)查找所有学生的指定信息</p> 
<p>Dao:</p> 
<pre><code class="language-java">List&lt;Student&gt; findstudentbycolumn(List&lt;String&gt; list);</code></pre> 
<pre><code class="language-XML">&lt;select id="findstudentbycolumn" resultType="student"&gt;
        select
        &lt;foreach item="a" collection="list" separator=","&gt;
            ${a}
        &lt;/foreach&gt;
        from student
    &lt;/select&gt;</code></pre> 
<p>当传值为：name,num</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/ed/0b/GaO69ulE_o.png"></p> 
<p>最后补充一点：</p> 
<p>       <span style="color:#a5a5a5;"> </span><span style="color:#7b7f82;"><strong>为什么整数类型不用基本类型而是用包装类？</strong></span></p> 
<p>        其实基本类型是可以使用的，但是基本类型被定义后默认值为0，而包装类型默认值为null，若是基本类型每次判断需要把!=null换成!=0，这样我们需要判断该变量的初始值是0还是null，而使用包装类就不需要思考，因为和其它变量一样都是null，因此一般使用包装类进行交互。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fd83a8198d0f07f3e90dd68cf111b450/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Python推导式秘籍】：一行代码的艺术，高效数据处理之道</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/deac8ce0db425ecc8f975d8cfccc24c2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux vim 文本编辑 操作文本 三种模式</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>