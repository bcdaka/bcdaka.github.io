<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SpringBoot集成Flowable工作流 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/c9887d116c6aeb797779d52a56b3e748/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="SpringBoot集成Flowable工作流">
  <meta property="og:description" content="文章目录 一、了解Flowable1. 什么是Flowable2. Flowable基本流程3. Flowable主要几张表介绍 二、SpringBoot集成Flowable1. 在idea中安装Flowable插件2. SpringBoot集成Flowable3. SpringBoot集成Flowable前端页面 三、创建流程模版(以请假为例) 提示：以下是本篇文章正文内容，下面案例可供参考
一、了解Flowable 1. 什么是Flowable Flowable下载
Flowable源码GitHub下载
Flowable用户使用手册
Flowable是一个使用Java编写的轻量级业务流程引擎。Flowable流程引擎可用于部署BPMN 2.0流程定义（用于定义流程的行业XML标准）， 创建这些流程定义的流程实例，进行查询，访问运行中或历史的流程实例与相关数据，等等。
具体介绍请看Flowable介绍
2. Flowable基本流程 参考知乎Flowable工作流引擎
对于业务建模，我们需要一种通用的语言来描绘，这样在沟通上和实现上会降低难度，就像中文、英文一样，BPMN2.0便是一种国际通用的建模语言，他能让自然人轻松阅读，更能被计算机所解析。
协议中元素的主要分类为，事件-任务-连线-网关
一个流程必须包含一个事件（如：开始事件）和至少一个结束（事件）。其中网关的作用是流程流转逻辑的控制。任务则分很多类型，他们各司其职，所有节点均由连线联系起来。
BPMN2.0协议
不同的图标代表不同的含义
网关
互斥网关（Exclusive Gateway） 又称排他网关，他有且仅有一个有效出口，可以理解为if…else if… else if…else，就和我们平时写代码的一样。
并行网关（Parallel Gateway） 他的所有出口都会被执行，可以理解为开多线程同时执行多个任务。
包容性网关（Inclusive Gateway）
只要满足条件的出口都会执行，可以理解为 if(…) do, if (…) do, if (…)
do，所有的条件判断都是同级别的。
任务
人工任务（User Task）
它是使用得做多的一种任务类型，他自带有一些人工任务的变量，例如签收人（Assignee），签收人就代表该任务交由谁处理，我们也可以通过某个特定或一系列特定的签收人来查找待办任务。利用上面的行为解释便是，当到达User
Task节点的时候，节点设置Assignee变量或等待设置Assignee变量，当任务被完成的时候，我们使用Trigger来要求流程引擎退出该任务，继续流转。
服务任务（Service Task）
该任务会在到达的时候执行一段自动的逻辑并自动流转。从“到达自动执行一段逻辑”这里我们就可以发现，服务任务的想象空间就可以非常大，我们可以执行一段计算，执行发送邮件，执行RPC调用，而使用最广泛的则为HTTP调用，因为HTTP是使用最广泛的协议之一，它可以解决大部分第三方调用问题，在我们的使用中，HTTP服务任务也被我们单独剥离出来作为一个特殊任务节点。
接受任务（Receive Task） 该任务的名字让人费解，但它又是最简单的一种任务，当该任务到达的时候，它不做任何逻辑，而是被动地等待Trigger，它的适用场景往往是一些不明确的阻塞，比如：一个复杂的计算需要等待很多条件，这些条件是需要人为来判断是否可以执行，而不是直接执行，这个时候，工作人员如果判断可以继续了，那么就Trigger一下使其流转。
结构
调用活动（Call Activity）
调用活动可以理解为函数调用，它会引用另外一个流程使之作为子流程运行，调用活动跟函数调用的功能一样，使流程模块化，增加复用的可能性。
3. Flowable主要几张表介绍 Flowable在项目启动的时候会自动创建表，以下是主要几张表介绍
ACT_RU_TASK： 每次启动的流程都会再这张表中,表示代办项, 流程结束会删除该流程数据ACT_RU_EXECUTION： 流程执行过程表, 会存该流程正在执行的过程数据, 流程结束会删除该流程数据ACT_RU_VARIABLE： 流程变量表, 流程中传的参数都会再该表存储, 流程结束会删除该流程数据ACT_HI_PROCINST： 历史运行流程, 当流程处理完了, 在ACT_RU_* 表中就不会有数据, 可以在该表中查询历史ACT_HI_TASKINST： 历史运行的task信息,ACT_RE_PROCDEF： 流程模板记录,同一个key多次发布version_字段会递增ACT_RE_DEPLOYMENT： 部署的流程模板, 可以启动流程使用的 二、SpringBoot集成Flowable 1.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-02-04T16:50:26+08:00">
    <meta property="article:modified_time" content="2024-02-04T16:50:26+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SpringBoot集成Flowable工作流</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#Flowable_7" rel="nofollow">一、了解Flowable</a></li><li><ul><li><a href="#1_Flowable_8" rel="nofollow">1. 什么是Flowable</a></li><li><a href="#2_Flowable_15" rel="nofollow">2. Flowable基本流程</a></li><li><a href="#3_Flowable_58" rel="nofollow">3. Flowable主要几张表介绍</a></li></ul> 
  </li><li><a href="#SpringBootFlowable_68" rel="nofollow">二、SpringBoot集成Flowable</a></li><li><ul><li><a href="#1_ideaFlowable_69" rel="nofollow">1. 在idea中安装Flowable插件</a></li><li><a href="#2_SpringBootFlowable_74" rel="nofollow">2. SpringBoot集成Flowable</a></li><li><a href="#3_SpringBootFlowable_559" rel="nofollow">3. SpringBoot集成Flowable前端页面</a></li></ul> 
  </li><li><a href="#_607" rel="nofollow">三、创建流程模版(以请假为例)</a></li></ul> 
</div> 
<p></p> 
<hr> 
<p><code>提示：以下是本篇文章正文内容，下面案例可供参考</code></p> 
<h2><a id="Flowable_7"></a>一、了解Flowable</h2> 
<h3><a id="1_Flowable_8"></a>1. 什么是Flowable</h3> 
<p><a href="http://www.flowable.org/downloads.html" rel="nofollow">Flowable下载</a><br> <a href="https://github.com/flowable/flowable-engine">Flowable源码GitHub下载</a><br> <a href="https://tkjohn.github.io/flowable-userguide/#apiUnitTesting" rel="nofollow">Flowable用户使用手册</a><br> Flowable是一个使用Java编写的轻量级业务流程引擎。Flowable流程引擎可用于部署BPMN 2.0流程定义（用于定义流程的行业XML标准）， 创建这些流程定义的流程实例，进行查询，访问运行中或历史的流程实例与相关数据，等等。</p> 
<p><mark>具体介绍请看<a href="https://tkjohn.github.io/flowable-userguide/#_what_is_flowable" rel="nofollow">Flowable介绍</a></mark></p> 
<h3><a id="2_Flowable_15"></a>2. Flowable基本流程</h3> 
<p><a href="https://zhuanlan.zhihu.com/p/417014073" rel="nofollow">参考知乎Flowable工作流引擎</a></p> 
<p>对于业务建模，我们需要一种通用的语言来描绘，这样在沟通上和实现上会降低难度，就像中文、英文一样，BPMN2.0便是一种国际通用的建模语言，他能让自然人轻松阅读，更能被计算机所解析。<br> <mark>协议中元素的主要分类为，事件-任务-连线-网关</mark><br> <strong>一个流程必须包含一个事件（如：开始事件）和至少一个结束（事件）</strong>。其中网关的作用是流程流转逻辑的控制。任务则分很多类型，他们各司其职，所有节点均由连线联系起来。<br> <strong>BPMN2.0协议</strong><br> <img src="https://images2.imgbox.com/3a/7b/ny8YTFrl_o.png" alt="在这里插入图片描述"><br> <strong>不同的图标代表不同的含义</strong></p> 
<ol><li><strong>网关</strong><br> <img src="https://images2.imgbox.com/79/05/pNrc5fIy_o.png" alt="在这里插入图片描述"></li></ol> 
<blockquote> 
 <p><strong>互斥网关（Exclusive Gateway）</strong> 又称排他网关，他有且仅有一个有效出口，可以理解为if…else if… else if…else，就和我们平时写代码的一样。<br> <img src="https://images2.imgbox.com/7a/41/LN0PpKhv_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<blockquote> 
 <p><strong>并行网关（Parallel Gateway）</strong> 他的所有出口都会被执行，可以理解为开多线程同时执行多个任务。<br> <img src="https://images2.imgbox.com/7d/3a/Oub0a2gG_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<blockquote> 
 <p><strong>包容性网关（Inclusive Gateway）</strong><br> 只要满足条件的出口都会执行，可以理解为 if(…) do, if (…) do, if (…)<br> do，所有的条件判断都是同级别的。<br> <img src="https://images2.imgbox.com/56/1d/RanCgFtH_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<ol start="2"><li><strong>任务</strong><br> <img src="https://images2.imgbox.com/77/39/NNo5lfDP_o.png" alt="在这里插入图片描述"></li></ol> 
<blockquote> 
 <p><strong>人工任务（User Task）</strong><br> 它是使用得做多的一种任务类型，他自带有一些人工任务的变量，例如签收人（Assignee），<mark>签收人就代表该任务交由谁处理</mark>，我们也可以通过某个特定或一系列特定的签收人来查找待办任务。利用上面的行为解释便是，当到达User<br> Task节点的时候，节点设置Assignee变量或等待设置Assignee变量，当任务被完成的时候，我们使用Trigger来要求流程引擎退出该任务，继续流转。<br> <img src="https://images2.imgbox.com/7e/f5/NzGYG6i1_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<blockquote> 
 <p><strong>服务任务（Service Task）</strong><br> 该任务会在到达的时候执行一段自动的逻辑并自动流转。从“到达自动执行一段逻辑”这里我们就可以发现，服务任务的想象空间就可以非常大，我们可以执行一段计算，执行发送邮件，执行RPC调用，而使用最广泛的则为HTTP调用，因为HTTP是使用最广泛的协议之一，它可以解决大部分第三方调用问题，在我们的使用中，HTTP服务任务也被我们单独剥离出来作为一个特殊任务节点。<br> <img src="https://images2.imgbox.com/79/2d/LweLd5vG_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<blockquote> 
 <p><strong>接受任务（Receive Task）</strong> 该任务的名字让人费解，但它又是最简单的一种任务，当该任务到达的时候，它不做任何逻辑，而是被动地等待Trigger，它的适用场景往往是一些不明确的阻塞，比如：一个复杂的计算需要等待很多条件，这些条件是需要人为来判断是否可以执行，而不是直接执行，这个时候，工作人员如果判断可以继续了，那么就Trigger一下使其流转。<br> <img src="https://images2.imgbox.com/30/0b/q9W7H29a_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<ol start="3"><li><strong>结构</strong><br> <img src="https://images2.imgbox.com/94/77/IxlISsua_o.png" alt="在这里插入图片描述"></li></ol> 
<blockquote> 
 <p><strong>调用活动（Call Activity）</strong><br> 调用活动可以理解为函数调用，它会引用另外一个流程使之作为子流程运行，调用活动跟函数调用的功能一样，使流程模块化，增加复用的可能性。<br> <img src="https://images2.imgbox.com/5c/f5/QLftAYQD_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<h3><a id="3_Flowable_58"></a>3. Flowable主要几张表介绍</h3> 
<p><mark>Flowable在项目启动的时候会自动创建表，以下是主要几张表介绍</mark></p> 
<ul><li><strong>ACT_RU_TASK：</strong> 每次启动的流程都会再这张表中,表示代办项, 流程结束会删除该流程数据</li><li><strong>ACT_RU_EXECUTION：</strong> 流程执行过程表, 会存该流程正在执行的过程数据, 流程结束会删除该流程数据</li><li><strong>ACT_RU_VARIABLE：</strong> 流程变量表, 流程中传的参数都会再该表存储, 流程结束会删除该流程数据</li><li><strong>ACT_HI_PROCINST：</strong> 历史运行流程, 当流程处理完了, 在ACT_RU_* 表中就不会有数据, 可以在该表中查询历史</li><li><strong>ACT_HI_TASKINST：</strong> 历史运行的task信息,</li><li><strong>ACT_RE_PROCDEF：</strong> 流程模板记录,同一个key多次发布version_字段会递增</li><li><strong>ACT_RE_DEPLOYMENT：</strong> 部署的流程模板, 可以启动流程使用的</li></ul> 
<h2><a id="SpringBootFlowable_68"></a>二、SpringBoot集成Flowable</h2> 
<h3><a id="1_ideaFlowable_69"></a>1. 在idea中安装Flowable插件</h3> 
<p><code>File--&gt;settings</code> 搜索：flowable<br> <img src="https://images2.imgbox.com/be/a3/sSU9fZjX_o.jpg" alt="在这里插入图片描述"><br> 安装完成，重启idea<br> <img src="https://images2.imgbox.com/4c/5d/vIaC3VQ5_o.jpg" alt="在这里插入图片描述"></p> 
<h3><a id="2_SpringBootFlowable_74"></a>2. SpringBoot集成Flowable</h3> 
<ol><li><strong>添加依赖</strong></li></ol> 
<pre><code class="prism language-java">     	<span class="token comment">/**
     	  * 引入数据库依赖，Flowable在项目启动的时候会自动创建表
    	  */</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">-</span>jdbc<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>mysql<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>mysql<span class="token operator">-</span>connector<span class="token operator">-</span>java<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>scope<span class="token punctuation">&gt;</span></span>runtime<span class="token operator">&lt;</span><span class="token operator">/</span>scope<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
         <span class="token comment">/**
     	  * lombok
    	  */</span>
         <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>projectlombok<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>lombok<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1.16</span><span class="token number">.16</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>scope<span class="token punctuation">&gt;</span></span>compile<span class="token operator">&lt;</span><span class="token operator">/</span>scope<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
         <span class="token comment">/**
     	  * 添加flowable工作流依赖
    	  */</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>flowable<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>flowable<span class="token operator">-</span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">6.7</span><span class="token number">.2</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
         <span class="token comment">/**
     	  * 添加flowable工作流前端页面依赖，如果项目没有集成页面，无需添加此依赖
    	  */</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>flowable<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>flowable<span class="token operator">-</span>ui<span class="token operator">-</span>modeler<span class="token operator">-</span>rest<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">6.7</span><span class="token number">.2</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
         <span class="token comment">/**
     	  * 添加flowable-ui-modeler配置依赖项
    	  */</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>flowable<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>flowable<span class="token operator">-</span>ui<span class="token operator">-</span>modeler<span class="token operator">-</span>conf<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">6.7</span><span class="token number">.2</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
</code></pre> 
<ol start="2"><li><strong>设置application.yml</strong></li></ol> 
<pre><code class="prism language-java">server<span class="token operator">:</span>
  port<span class="token operator">:</span> <span class="token number">8080</span>  #tomcat端口
  servlet<span class="token operator">:</span>
    context<span class="token operator">-</span>path<span class="token operator">:</span> <span class="token operator">/</span>
spring<span class="token operator">:</span>
  #数据库链接配置
  datasource<span class="token operator">:</span>
    url<span class="token operator">:</span> jdbc<span class="token operator">:</span>mysql<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">3306</span><span class="token operator">/</span>flowable<span class="token operator">?</span>serverTimezone<span class="token operator">=</span><span class="token class-name">Asia</span><span class="token operator">/</span><span class="token class-name">Shanghai</span><span class="token operator">&amp;</span>useUnicode<span class="token operator">=</span><span class="token boolean">true</span><span class="token operator">&amp;</span>characterEncoding<span class="token operator">=</span><span class="token constant">UTF8</span>
    driver<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">-</span>name<span class="token operator">:</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>cj<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span></span>Driver</span>
    username<span class="token operator">:</span> root
    password<span class="token operator">:</span> root


flowable<span class="token operator">:</span>
  #异步执行
  async<span class="token operator">-</span>executor<span class="token operator">-</span>activate<span class="token operator">:</span> <span class="token boolean">true</span>
  #自动更新数据库
  database<span class="token operator">-</span>schema<span class="token operator">-</span>update<span class="token operator">:</span> <span class="token boolean">true</span>
  #校验流程文件，默认校验resources下的processes文件夹里的流程文件
  process<span class="token operator">-</span>definition<span class="token operator">-</span>location<span class="token operator">-</span>prefix<span class="token operator">:</span> classpath<span class="token operator">*</span><span class="token operator">:</span><span class="token operator">/</span>processes<span class="token operator">/</span>
  process<span class="token operator">-</span>definition<span class="token operator">-</span>location<span class="token operator">-</span>suffixes<span class="token operator">:</span> <span class="token string">"**.bpmn20.xml, **.bpmn"</span>
  
  #该配置只是防止页面报错<span class="token punctuation">,</span>没有实际意义
  common<span class="token operator">:</span>
    app<span class="token operator">:</span>
      idm<span class="token operator">-</span>admin<span class="token operator">:</span>
        password<span class="token operator">:</span> test
        user<span class="token operator">:</span> test
      #没有实际意义
      idm<span class="token operator">-</span>url<span class="token operator">:</span> http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">8080</span><span class="token operator">/</span>flowable<span class="token operator">-</span>demo
</code></pre> 
<ol start="3"><li><strong>创建 【*.bpmn20.xml】</strong><br> 通过【application.yml】可知，需要在resources下的processes文件夹里的创建流程文件<br> <mark>这是ask_for_leave.bpmn20.xml我自己的流程文件</mark><br> <img src="https://images2.imgbox.com/bf/be/EmVbuw6w_o.png" alt="在这里插入图片描述"><br> ask_for_leave.bpmn20.xml</li></ol> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">?</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>definitions xmlns<span class="token operator">=</span><span class="token string">"http://www.omg.org/spec/BPMN/20100524/MODEL"</span> xmlns<span class="token operator">:</span>xsi<span class="token operator">=</span><span class="token string">"http://www.w3.org/2001/XMLSchema-instance"</span> xmlns<span class="token operator">:</span>xsd<span class="token operator">=</span><span class="token string">"http://www.w3.org/2001/XMLSchema"</span> xmlns<span class="token operator">:</span>flowable<span class="token operator">=</span><span class="token string">"http://flowable.org/bpmn"</span> xmlns<span class="token operator">:</span>bpmndi<span class="token operator">=</span><span class="token string">"http://www.omg.org/spec/BPMN/20100524/DI"</span> xmlns<span class="token operator">:</span>omgdc<span class="token operator">=</span><span class="token string">"http://www.omg.org/spec/DD/20100524/DC"</span> xmlns<span class="token operator">:</span>omgdi<span class="token operator">=</span><span class="token string">"http://www.omg.org/spec/DD/20100524/DI"</span> typeLanguage<span class="token operator">=</span><span class="token string">"http://www.w3.org/2001/XMLSchema"</span> expressionLanguage<span class="token operator">=</span><span class="token string">"http://www.w3.org/1999/XPath"</span> targetNamespace<span class="token operator">=</span><span class="token string">"http://www.flowable.org/processdef"</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>process id<span class="token operator">=</span><span class="token string">"askForLeave"</span> name<span class="token operator">=</span><span class="token string">"ask_for_leave_process"</span> isExecutable<span class="token operator">=</span><span class="token string">"true"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>startEvent id<span class="token operator">=</span><span class="token string">"sid-b3fcb298-124a-4dc3-b603-1397b392e1a5"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>userTask id<span class="token operator">=</span><span class="token string">"employee"</span> name<span class="token operator">=</span><span class="token string">"员工"</span> flowable<span class="token operator">:</span>assignee<span class="token operator">=</span><span class="token string">"#{employeeNo}"</span> flowable<span class="token operator">:</span>formFieldValidation<span class="token operator">=</span><span class="token string">"true"</span><span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>documentation<span class="token punctuation">&gt;</span></span>员工提交申请<span class="token operator">&lt;</span><span class="token operator">/</span>documentation<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>userTask<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>sequenceFlow id<span class="token operator">=</span><span class="token string">"sid-9a4f7da0-7df8-422c-8d93-fcfe6eed6454"</span> sourceRef<span class="token operator">=</span><span class="token string">"sid-b3fcb298-124a-4dc3-b603-1397b392e1a5"</span> targetRef<span class="token operator">=</span><span class="token string">"employee"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>userTask id<span class="token operator">=</span><span class="token string">"leader"</span> name<span class="token operator">=</span><span class="token string">"领导"</span> flowable<span class="token operator">:</span>assignee<span class="token operator">=</span><span class="token string">"#{leaderNo}"</span> flowable<span class="token operator">:</span>formFieldValidation<span class="token operator">=</span><span class="token string">"true"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>sequenceFlow id<span class="token operator">=</span><span class="token string">"sid-cda53600-1fdd-4556-b1f4-434cdef4b44c"</span> sourceRef<span class="token operator">=</span><span class="token string">"employee"</span> targetRef<span class="token operator">=</span><span class="token string">"leader"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>exclusiveGateway id<span class="token operator">=</span><span class="token string">"sid-53b678ee-c126-46be-9bb7-70efe235451c"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>sequenceFlow id<span class="token operator">=</span><span class="token string">"sid-c18a730f-6932-4036-b105-a840204bbd1f"</span> sourceRef<span class="token operator">=</span><span class="token string">"leader"</span> targetRef<span class="token operator">=</span><span class="token string">"sid-53b678ee-c126-46be-9bb7-70efe235451c"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>endEvent id<span class="token operator">=</span><span class="token string">"sid-dc057597-34a0-4835-bbbb-1b12f0e8e407"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>sequenceFlow id<span class="token operator">=</span><span class="token string">"leaderExamine"</span> sourceRef<span class="token operator">=</span><span class="token string">"sid-53b678ee-c126-46be-9bb7-70efe235451c"</span> targetRef<span class="token operator">=</span><span class="token string">"sid-dc057597-34a0-4835-bbbb-1b12f0e8e407"</span> name<span class="token operator">=</span><span class="token string">"领导审核不通过"</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>conditionExpression xsi<span class="token operator">:</span>type<span class="token operator">=</span><span class="token string">"tFormalExpression"</span><span class="token operator">&gt;</span>$<span class="token punctuation">{<!-- --></span>outcome<span class="token operator">==</span><span class="token char">'驳回'</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>conditionExpression<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>sequenceFlow<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>userTask id<span class="token operator">=</span><span class="token string">"boss"</span> name<span class="token operator">=</span><span class="token string">"老板"</span> flowable<span class="token operator">:</span>formFieldValidation<span class="token operator">=</span><span class="token string">"true"</span> flowable<span class="token operator">:</span>assignee<span class="token operator">=</span><span class="token string">"#{bossNo}"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>sequenceFlow id<span class="token operator">=</span><span class="token string">"leaderExaminePass"</span> sourceRef<span class="token operator">=</span><span class="token string">"sid-53b678ee-c126-46be-9bb7-70efe235451c"</span> targetRef<span class="token operator">=</span><span class="token string">"boss"</span> name<span class="token operator">=</span><span class="token string">"领导审核通过"</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>conditionExpression xsi<span class="token operator">:</span>type<span class="token operator">=</span><span class="token string">"tFormalExpression"</span><span class="token operator">&gt;</span>$<span class="token punctuation">{<!-- --></span>outcome<span class="token operator">==</span><span class="token char">'通过'</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>conditionExpression<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>sequenceFlow<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>exclusiveGateway id<span class="token operator">=</span><span class="token string">"sid-17d3919b-99f0-4a2e-8914-3dfb7bc74046"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>sequenceFlow id<span class="token operator">=</span><span class="token string">"sid-e4dd8e02-acc7-4e51-95d4-5a1ade5eb2fd"</span> sourceRef<span class="token operator">=</span><span class="token string">"boss"</span> targetRef<span class="token operator">=</span><span class="token string">"sid-17d3919b-99f0-4a2e-8914-3dfb7bc74046"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>endEvent id<span class="token operator">=</span><span class="token string">"sid-311b83fa-5c04-48af-8491-4e2f9417c49c"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>sequenceFlow id<span class="token operator">=</span><span class="token string">"bossExamine"</span> sourceRef<span class="token operator">=</span><span class="token string">"sid-17d3919b-99f0-4a2e-8914-3dfb7bc74046"</span> targetRef<span class="token operator">=</span><span class="token string">"sid-311b83fa-5c04-48af-8491-4e2f9417c49c"</span> name<span class="token operator">=</span><span class="token string">"老板审核不通过"</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>conditionExpression xsi<span class="token operator">:</span>type<span class="token operator">=</span><span class="token string">"tFormalExpression"</span><span class="token operator">&gt;</span>$<span class="token punctuation">{<!-- --></span>outcome<span class="token operator">==</span><span class="token char">'驳回'</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>conditionExpression<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>sequenceFlow<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>endEvent id<span class="token operator">=</span><span class="token string">"sid-3f6150ad-4b8c-47e9-a726-39f5dffd5e0a"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>sequenceFlow id<span class="token operator">=</span><span class="token string">"bossExaminePass"</span> sourceRef<span class="token operator">=</span><span class="token string">"sid-17d3919b-99f0-4a2e-8914-3dfb7bc74046"</span> targetRef<span class="token operator">=</span><span class="token string">"sid-3f6150ad-4b8c-47e9-a726-39f5dffd5e0a"</span> name<span class="token operator">=</span><span class="token string">"老板审核通过"</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>conditionExpression xsi<span class="token operator">:</span>type<span class="token operator">=</span><span class="token string">"tFormalExpression"</span><span class="token operator">&gt;</span>$<span class="token punctuation">{<!-- --></span>outcome<span class="token operator">==</span><span class="token char">'通过'</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>conditionExpression<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>sequenceFlow<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>process<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNDiagram</span> id<span class="token operator">=</span><span class="token string">"BPMNDiagram_ask_for_leave"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNPlane</span> bpmnElement<span class="token operator">=</span><span class="token string">"askForLeave"</span> id<span class="token operator">=</span><span class="token string">"BPMNPlane_ask_for_leave"</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNShape</span> id<span class="token operator">=</span><span class="token string">"shape-c5da47a1-57a1-465c-a7f8-2aad63d19b47"</span> bpmnElement<span class="token operator">=</span><span class="token string">"sid-b3fcb298-124a-4dc3-b603-1397b392e1a5"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdc<span class="token operator">:</span><span class="token class-name">Bounds</span> x<span class="token operator">=</span><span class="token string">"-203.0"</span> y<span class="token operator">=</span><span class="token string">"-10.75"</span> width<span class="token operator">=</span><span class="token string">"30.0"</span> height<span class="token operator">=</span><span class="token string">"30.0"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNShape</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNShape</span> id<span class="token operator">=</span><span class="token string">"shape-71f351aa-e8f4-4656-9fa0-7979ddc1d916"</span> bpmnElement<span class="token operator">=</span><span class="token string">"employee"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdc<span class="token operator">:</span><span class="token class-name">Bounds</span> x<span class="token operator">=</span><span class="token string">"-140.0"</span> y<span class="token operator">=</span><span class="token string">"-10.5"</span> width<span class="token operator">=</span><span class="token string">"61.0"</span> height<span class="token operator">=</span><span class="token string">"29.5"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNShape</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNEdge</span> id<span class="token operator">=</span><span class="token string">"edge-a0cd4bce-af0a-40ce-8128-97629a5f4a23"</span> bpmnElement<span class="token operator">=</span><span class="token string">"sid-9a4f7da0-7df8-422c-8d93-fcfe6eed6454"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdi<span class="token operator">:</span>waypoint x<span class="token operator">=</span><span class="token string">"-173.0"</span> y<span class="token operator">=</span><span class="token string">"4.25"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdi<span class="token operator">:</span>waypoint x<span class="token operator">=</span><span class="token string">"-140.0"</span> y<span class="token operator">=</span><span class="token string">"4.25"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNEdge</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNShape</span> id<span class="token operator">=</span><span class="token string">"shape-6a814a53-e6e2-4453-bb4a-43a1167e5559"</span> bpmnElement<span class="token operator">=</span><span class="token string">"leader"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdc<span class="token operator">:</span><span class="token class-name">Bounds</span> x<span class="token operator">=</span><span class="token string">"-46.5"</span> y<span class="token operator">=</span><span class="token string">"-11.0"</span> width<span class="token operator">=</span><span class="token string">"63.0"</span> height<span class="token operator">=</span><span class="token string">"30.5"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNShape</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNEdge</span> id<span class="token operator">=</span><span class="token string">"edge-3a2944ef-43d6-4409-920d-9d3d1acd422f"</span> bpmnElement<span class="token operator">=</span><span class="token string">"sid-cda53600-1fdd-4556-b1f4-434cdef4b44c"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdi<span class="token operator">:</span>waypoint x<span class="token operator">=</span><span class="token string">"-79.0"</span> y<span class="token operator">=</span><span class="token string">"4.25"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdi<span class="token operator">:</span>waypoint x<span class="token operator">=</span><span class="token string">"-46.5"</span> y<span class="token operator">=</span><span class="token string">"4.25"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNEdge</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNShape</span> id<span class="token operator">=</span><span class="token string">"shape-bef28649-6416-4428-a3bd-43edb5c1b9c6"</span> bpmnElement<span class="token operator">=</span><span class="token string">"sid-53b678ee-c126-46be-9bb7-70efe235451c"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdc<span class="token operator">:</span><span class="token class-name">Bounds</span> x<span class="token operator">=</span><span class="token string">"42.36"</span> y<span class="token operator">=</span><span class="token string">"-15.75"</span> width<span class="token operator">=</span><span class="token string">"40.0"</span> height<span class="token operator">=</span><span class="token string">"40.0"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNShape</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNEdge</span> id<span class="token operator">=</span><span class="token string">"edge-fa69c266-5b3c-4e26-a4e2-3f58c271ebb4"</span> bpmnElement<span class="token operator">=</span><span class="token string">"sid-c18a730f-6932-4036-b105-a840204bbd1f"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdi<span class="token operator">:</span>waypoint x<span class="token operator">=</span><span class="token string">"16.5"</span> y<span class="token operator">=</span><span class="token string">"4.25"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdi<span class="token operator">:</span>waypoint x<span class="token operator">=</span><span class="token string">"42.36"</span> y<span class="token operator">=</span><span class="token string">"4.25"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNEdge</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNShape</span> id<span class="token operator">=</span><span class="token string">"shape-9d577a21-ca61-4e33-bf3e-c892557f1638"</span> bpmnElement<span class="token operator">=</span><span class="token string">"sid-dc057597-34a0-4835-bbbb-1b12f0e8e407"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdc<span class="token operator">:</span><span class="token class-name">Bounds</span> x<span class="token operator">=</span><span class="token string">"47.36"</span> y<span class="token operator">=</span><span class="token string">"54.97"</span> width<span class="token operator">=</span><span class="token string">"30.0"</span> height<span class="token operator">=</span><span class="token string">"30.0"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNShape</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNEdge</span> id<span class="token operator">=</span><span class="token string">"edge-5651dbf2-4118-4668-bbd6-0259282cc084"</span> bpmnElement<span class="token operator">=</span><span class="token string">"leaderExamine"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdi<span class="token operator">:</span>waypoint x<span class="token operator">=</span><span class="token string">"62.36"</span> y<span class="token operator">=</span><span class="token string">"24.25"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdi<span class="token operator">:</span>waypoint x<span class="token operator">=</span><span class="token string">"62.36"</span> y<span class="token operator">=</span><span class="token string">"54.97"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNEdge</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNShape</span> id<span class="token operator">=</span><span class="token string">"shape-1398abfb-fefc-4a16-881c-84a6c4b7b7f7"</span> bpmnElement<span class="token operator">=</span><span class="token string">"boss"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdc<span class="token operator">:</span><span class="token class-name">Bounds</span> x<span class="token operator">=</span><span class="token string">"108.86"</span> y<span class="token operator">=</span><span class="token string">"-12.75"</span> width<span class="token operator">=</span><span class="token string">"68.0"</span> height<span class="token operator">=</span><span class="token string">"34.0"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNShape</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNEdge</span> id<span class="token operator">=</span><span class="token string">"edge-3f5df081-8086-492f-a2c7-90aba1c1e4d7"</span> bpmnElement<span class="token operator">=</span><span class="token string">"leaderExaminePass"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdi<span class="token operator">:</span>waypoint x<span class="token operator">=</span><span class="token string">"82.36"</span> y<span class="token operator">=</span><span class="token string">"4.25"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdi<span class="token operator">:</span>waypoint x<span class="token operator">=</span><span class="token string">"108.86"</span> y<span class="token operator">=</span><span class="token string">"4.25"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNEdge</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNShape</span> id<span class="token operator">=</span><span class="token string">"shape-4932221b-736b-4e85-a319-0859dbeb3e6b"</span> bpmnElement<span class="token operator">=</span><span class="token string">"sid-17d3919b-99f0-4a2e-8914-3dfb7bc74046"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdc<span class="token operator">:</span><span class="token class-name">Bounds</span> x<span class="token operator">=</span><span class="token string">"203.35999"</span> y<span class="token operator">=</span><span class="token string">"-15.75"</span> width<span class="token operator">=</span><span class="token string">"40.0"</span> height<span class="token operator">=</span><span class="token string">"40.0"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNShape</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNEdge</span> id<span class="token operator">=</span><span class="token string">"edge-3daa1ef4-119f-4b98-a40e-0b9cb3b205ce"</span> bpmnElement<span class="token operator">=</span><span class="token string">"sid-e4dd8e02-acc7-4e51-95d4-5a1ade5eb2fd"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdi<span class="token operator">:</span>waypoint x<span class="token operator">=</span><span class="token string">"176.86"</span> y<span class="token operator">=</span><span class="token string">"4.25"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdi<span class="token operator">:</span>waypoint x<span class="token operator">=</span><span class="token string">"203.35999"</span> y<span class="token operator">=</span><span class="token string">"4.25"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNEdge</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNShape</span> id<span class="token operator">=</span><span class="token string">"shape-6becf929-e7e7-4153-a1d1-6175677742ca"</span> bpmnElement<span class="token operator">=</span><span class="token string">"sid-311b83fa-5c04-48af-8491-4e2f9417c49c"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdc<span class="token operator">:</span><span class="token class-name">Bounds</span> x<span class="token operator">=</span><span class="token string">"208.35999"</span> y<span class="token operator">=</span><span class="token string">"54.97"</span> width<span class="token operator">=</span><span class="token string">"30.0"</span> height<span class="token operator">=</span><span class="token string">"30.0"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNShape</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNEdge</span> id<span class="token operator">=</span><span class="token string">"edge-1f1a1414-f4f9-442a-97af-676878899415"</span> bpmnElement<span class="token operator">=</span><span class="token string">"bossExamine"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdi<span class="token operator">:</span>waypoint x<span class="token operator">=</span><span class="token string">"223.35999"</span> y<span class="token operator">=</span><span class="token string">"24.25"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdi<span class="token operator">:</span>waypoint x<span class="token operator">=</span><span class="token string">"223.35999"</span> y<span class="token operator">=</span><span class="token string">"54.97"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNEdge</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNShape</span> id<span class="token operator">=</span><span class="token string">"shape-919e70dd-5004-4066-8103-427901b5c1fd"</span> bpmnElement<span class="token operator">=</span><span class="token string">"sid-3f6150ad-4b8c-47e9-a726-39f5dffd5e0a"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdc<span class="token operator">:</span><span class="token class-name">Bounds</span> x<span class="token operator">=</span><span class="token string">"275.86"</span> y<span class="token operator">=</span><span class="token string">"-10.75"</span> width<span class="token operator">=</span><span class="token string">"30.0"</span> height<span class="token operator">=</span><span class="token string">"30.0"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNShape</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNEdge</span> id<span class="token operator">=</span><span class="token string">"edge-542631d7-42d7-4b2a-b467-da8fdba298a1"</span> bpmnElement<span class="token operator">=</span><span class="token string">"bossExaminePass"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdi<span class="token operator">:</span>waypoint x<span class="token operator">=</span><span class="token string">"243.35999"</span> y<span class="token operator">=</span><span class="token string">"4.25"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>omgdi<span class="token operator">:</span>waypoint x<span class="token operator">=</span><span class="token string">"275.86"</span> y<span class="token operator">=</span><span class="token string">"4.25"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNEdge</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNPlane</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>bpmndi<span class="token operator">:</span><span class="token class-name">BPMNDiagram</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>definitions<span class="token operator">&gt;</span>

</code></pre> 
<ol start="4"><li><strong>设置配置文件</strong></li></ol> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>flowable<span class="token punctuation">.</span>spring<span class="token punctuation">.</span></span><span class="token class-name">SpringProcessEngineConfiguration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>flowable<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">EngineConfigurationConfigurer</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FlowableConfig</span> <span class="token keyword">implements</span> <span class="token class-name">EngineConfigurationConfigurer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SpringProcessEngineConfiguration</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">/**
     * 防止生成的流程图中文乱码
     * @param springProcessEngineConfiguration
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">SpringProcessEngineConfiguration</span> springProcessEngineConfiguration<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        springProcessEngineConfiguration<span class="token punctuation">.</span><span class="token function">setActivityFontName</span><span class="token punctuation">(</span><span class="token string">"宋体"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        springProcessEngineConfiguration<span class="token punctuation">.</span><span class="token function">setLabelFontName</span><span class="token punctuation">(</span><span class="token string">"宋体"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        springProcessEngineConfiguration<span class="token punctuation">.</span><span class="token function">setAnnotationFontName</span><span class="token punctuation">(</span><span class="token string">"宋体"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>如果醒目没有集成页面，【SecurityConfiguration.java】无需配置<br> <a href="https://www.jianshu.com/p/ad3f08ff0579" rel="nofollow">参考简书springboot集成flowable</a></p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>flowable<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>common<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token class-name">SecurityConstants</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Order</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>web<span class="token punctuation">.</span>builders<span class="token punctuation">.</span></span><span class="token class-name">HttpSecurity</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>web<span class="token punctuation">.</span>configuration<span class="token punctuation">.</span></span><span class="token class-name">WebSecurityConfigurerAdapter</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 绕过flowable的登录验证
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfiguration</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token comment">//Order配置说明</span>
    <span class="token comment">// 这个地方相同会报错</span>
    <span class="token comment">//这个地方如果大于则该配置在FlowableUiSecurityAutoConfiguratio中对应项后加载，不能起到绕过授权作用</span>
    <span class="token comment">//所以这个地方-1让该配置项在FlowableUiSecurityAutoConfiguratio中对应配置项前加载，以跳过授权</span>
    <span class="token annotation punctuation">@Order</span><span class="token punctuation">(</span><span class="token class-name">SecurityConstants</span><span class="token punctuation">.</span><span class="token constant">FORM_LOGIN_SECURITY_ORDER</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">FormLoginWebSecurityConfigurerAdapter</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">{<!-- --></span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
            http<span class="token punctuation">.</span><span class="token function">headers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">frameOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


            http
                    <span class="token comment">//必须要将csrf设置为disable，不然后面发送POST请求时会报403错误</span>
                    <span class="token punctuation">.</span><span class="token function">csrf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token comment">//为了简单起见，简单粗暴方式直接放行modeler下面所有请求</span>
                    <span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/modeler/**"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<ol start="5"><li><strong>书写逻辑</strong></li></ol> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>flowable<span class="token punctuation">.</span>bpmn<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">BpmnModel</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>flowable<span class="token punctuation">.</span>engine<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>flowable<span class="token punctuation">.</span>engine<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span></span><span class="token class-name">Execution</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>flowable<span class="token punctuation">.</span>engine<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span></span><span class="token class-name">ProcessInstance</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>flowable<span class="token punctuation">.</span>image<span class="token punctuation">.</span></span><span class="token class-name">ProcessDiagramGenerator</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>flowable<span class="token punctuation">.</span>task<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">Task</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestParam</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">OutputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"askForLeave"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AskForLeaveFlowableController</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">RuntimeService</span> runtimeService<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">TaskService</span> taskService<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">RepositoryService</span> repositoryService<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">ProcessEngine</span> processEngine<span class="token punctuation">;</span>


    <span class="token comment">/**
     * 员工提交请假申请
     *
     * @param employeeNo 员工工号
     * @param name       姓名
     * @param reason     原因
     * @param days       天数
     * @return
     */</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"employeeSubmit"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">employeeSubmitAskForLeave</span><span class="token punctuation">(</span>
            <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"employeeNo"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> employeeNo<span class="token punctuation">,</span>
            <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"name"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span>
            <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"reason"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> reason<span class="token punctuation">,</span>
            <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"days"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> days<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">/**
         * 员工编号字段来自于配置文件
         */</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"employeeNo"</span><span class="token punctuation">,</span> employeeNo<span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"reason"</span><span class="token punctuation">,</span> reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"days"</span><span class="token punctuation">,</span> days<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">/**
         *      key：配置文件中的下个处理流程id
         *      value：默认领导工号为002
         */</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"leaderNo"</span><span class="token punctuation">,</span> <span class="token string">"002"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * askForLeave：为开启流程的id  与配置文件中的一致
         */</span>
        <span class="token class-name">ProcessInstance</span> processInstance <span class="token operator">=</span> runtimeService<span class="token punctuation">.</span><span class="token function">startProcessInstanceByKey</span><span class="token punctuation">(</span><span class="token string">"askForLeave"</span><span class="token punctuation">,</span> map<span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"{},提交请假申请，流程id：{}"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> processInstance<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"提交成功，流程id："</span><span class="token operator">+</span>processInstance<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 领导审核通过
     * @param employeeNo  员工工号
     * @return
     */</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"leaderExaminePass"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">leaderExamine</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"employeeNo"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> employeeNo<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Task</span><span class="token punctuation">&gt;</span></span> taskList <span class="token operator">=</span> taskService<span class="token punctuation">.</span><span class="token function">createTaskQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">taskAssignee</span><span class="token punctuation">(</span>employeeNo<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orderByTaskId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> taskList<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span>  <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"当前员工没有任何申请"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Task</span> task <span class="token operator">:</span> taskList<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>task <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"任务不存在 ID：{}；"</span><span class="token punctuation">,</span> task<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"任务 ID：{}；任务处理人：{}；任务是否挂起：{}"</span><span class="token punctuation">,</span> task<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> task<span class="token punctuation">.</span><span class="token function">getAssignee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> task<span class="token punctuation">.</span><span class="token function">isSuspended</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">/**
             *      key：配置文件中的下个处理流程id
             *      value：默认老板工号为001
             */</span>
            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"bossNo"</span><span class="token punctuation">,</span> <span class="token string">"001"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">/**
             *      key：指定配置文件中的条件判断id
             *      value：指定配置文件中的审核条件
             */</span>
            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"outcome"</span><span class="token punctuation">,</span> <span class="token string">"通过"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            taskService<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span>task<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token string">"领导审核通过"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token comment">/**
     * 老板审核通过
     * @param leaderNo  领导工号
     * @return
     */</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"bossExaminePass"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">bossExamine</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"leaderNo"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> leaderNo<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Task</span><span class="token punctuation">&gt;</span></span> taskList <span class="token operator">=</span> taskService<span class="token punctuation">.</span><span class="token function">createTaskQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">taskAssignee</span><span class="token punctuation">(</span>leaderNo<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orderByTaskId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> taskList<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span>  <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"当前员工没有任何申请"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Task</span> task <span class="token operator">:</span> taskList<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>task <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"任务不存在 ID：{}；"</span><span class="token punctuation">,</span> task<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"任务 ID：{}；任务处理人：{}；任务是否挂起：{}"</span><span class="token punctuation">,</span> task<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> task<span class="token punctuation">.</span><span class="token function">getAssignee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> task<span class="token punctuation">.</span><span class="token function">isSuspended</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">/**
             *     老板是最后的审批人   无需指定下个流程
             */</span>
<span class="token comment">//            map.put("boss", "001");</span>
            <span class="token comment">/**
             *      key：指定配置文件中的条件判断id
             *      value：指定配置文件中的审核条件
             */</span>
            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"outcome"</span><span class="token punctuation">,</span> <span class="token string">"通过"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            taskService<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span>task<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token string">"领导审核通过"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 驳回
     *
     * @param employeeNo  员工工号
     * @return
     */</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"reject"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"employeeNo"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> employeeNo<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Task</span><span class="token punctuation">&gt;</span></span> taskList <span class="token operator">=</span> taskService<span class="token punctuation">.</span><span class="token function">createTaskQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">taskAssignee</span><span class="token punctuation">(</span>employeeNo<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orderByTaskId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> taskList<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span>  <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"当前员工没有任何申请"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Task</span> task <span class="token operator">:</span> taskList<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>task <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"任务不存在 ID：{}；"</span><span class="token punctuation">,</span> task<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"任务 ID：{}；任务处理人：{}；任务是否挂起：{}"</span><span class="token punctuation">,</span> task<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> task<span class="token punctuation">.</span><span class="token function">getAssignee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> task<span class="token punctuation">.</span><span class="token function">isSuspended</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">/**
             *      key：指定配置文件中的领导id
             *      value：指定配置文件中的审核条件
             */</span>
            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"outcome"</span><span class="token punctuation">,</span> <span class="token string">"驳回"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            taskService<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span>task<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token string">"申请被驳回"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token comment">/**
     * 生成流程图
     *
     * @param processId 任务ID
     */</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"processDiagram"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">genProcessDiagram</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> httpServletResponse<span class="token punctuation">,</span> <span class="token class-name">String</span> processId<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ProcessInstance</span> pi <span class="token operator">=</span> runtimeService<span class="token punctuation">.</span><span class="token function">createProcessInstanceQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">processInstanceId</span><span class="token punctuation">(</span>processId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">singleResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//流程走完的不显示图</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>pi <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">Task</span> task <span class="token operator">=</span> taskService<span class="token punctuation">.</span><span class="token function">createTaskQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">processInstanceId</span><span class="token punctuation">(</span>pi<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">singleResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//使用流程实例ID，查询正在执行的执行对象表，返回流程实例对象</span>
        <span class="token class-name">String</span> <span class="token class-name">InstanceId</span> <span class="token operator">=</span> task<span class="token punctuation">.</span><span class="token function">getProcessInstanceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Execution</span><span class="token punctuation">&gt;</span></span> executions <span class="token operator">=</span> runtimeService
                <span class="token punctuation">.</span><span class="token function">createExecutionQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">processInstanceId</span><span class="token punctuation">(</span><span class="token class-name">InstanceId</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//得到正在执行的Activity的Id</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> activityIds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> flows <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Execution</span> exe <span class="token operator">:</span> executions<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> ids <span class="token operator">=</span> runtimeService<span class="token punctuation">.</span><span class="token function">getActiveActivityIds</span><span class="token punctuation">(</span>exe<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            activityIds<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>ids<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//获取流程图</span>
        <span class="token class-name">BpmnModel</span> bpmnModel <span class="token operator">=</span> repositoryService<span class="token punctuation">.</span><span class="token function">getBpmnModel</span><span class="token punctuation">(</span>pi<span class="token punctuation">.</span><span class="token function">getProcessDefinitionId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ProcessEngineConfiguration</span> engconf <span class="token operator">=</span> processEngine<span class="token punctuation">.</span><span class="token function">getProcessEngineConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ProcessDiagramGenerator</span> diagramGenerator <span class="token operator">=</span> engconf<span class="token punctuation">.</span><span class="token function">getProcessDiagramGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">InputStream</span> in <span class="token operator">=</span> diagramGenerator<span class="token punctuation">.</span><span class="token function">generateDiagram</span><span class="token punctuation">(</span>bpmnModel<span class="token punctuation">,</span> <span class="token string">"png"</span><span class="token punctuation">,</span> activityIds<span class="token punctuation">,</span> flows<span class="token punctuation">,</span>
                engconf<span class="token punctuation">.</span><span class="token function">getActivityFontName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> engconf<span class="token punctuation">.</span><span class="token function">getLabelFontName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                engconf<span class="token punctuation">.</span><span class="token function">getAnnotationFontName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> engconf<span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">OutputStream</span> out <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> legth <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            out <span class="token operator">=</span> httpServletResponse<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>legth <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                out<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> legth<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>in <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                in<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>out <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                out<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<ol start="6"><li><strong>测试</strong></li></ol> 
<ul><li> <p>员工提交请假申请，如下图：<br> http://localhost:8080/askForLeave/employeeSubmit?name=Jerry&amp;reason=去旅游&amp;days=30&amp;employeeNo=006<br> <img src="https://images2.imgbox.com/64/3e/D0oLoGGh_o.png" alt="在这里插入图片描述"></p> </li><li> <p>查看员工提交申请的流程图<br> http://localhost:8080/askForLeave/processDiagram?processId=2cd67ca3-c32e-11ee-a344-d41b812ff10e<br> <img src="https://images2.imgbox.com/fe/4a/r4pPoJ1E_o.png" alt="在这里插入图片描述"></p> </li><li> <p>领导进行审批<br> http://localhost:8080/askForLeave/leaderExaminePass?employeeNo=006<br> <img src="https://images2.imgbox.com/a8/bd/5wQlMPz7_o.png" alt="在这里插入图片描述"></p> </li><li> <p>查看领导审批后的流程图<br> http://localhost:8080/askForLeave/processDiagram?processId=2cd67ca3-c32e-11ee-a344-d41b812ff10e<br> <img src="https://images2.imgbox.com/08/db/Uiwk7DRt_o.png" alt="在这里插入图片描述"></p> </li><li> <p>老板审批<br> http://localhost:8080/askForLeave/bossExaminePass?leaderNo=002<br> <img src="https://images2.imgbox.com/3d/b5/NaVwfm18_o.png" alt="在这里插入图片描述"></p> </li><li> <p>查看老板审批后的流程图<br> http://localhost:8080/askForLeave/processDiagram?processId=2cd67ca3-c32e-11ee-a344-d41b812ff10e<br> <img src="https://images2.imgbox.com/73/88/54rUqh1l_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<h3><a id="3_SpringBootFlowable_559"></a>3. SpringBoot集成Flowable前端页面</h3> 
<p><a href="https://www.jianshu.com/p/ad3f08ff0579" rel="nofollow">参考简书毛于晏</a></p> 
<ol><li> <p>下载源码包，此处使用的是6.7.2版本的<br> 源码下载地址: https://github.com/flowable/flowable-engine/tree/flowable-6.7.2<br> <strong>或</strong><br> 链接：https://pan.baidu.com/s/1w-iuynskMuREBlYcpbDFAg<br> 提取码：9gs7</p> </li><li> <p>将以下路径的代码复制到自己工程<br> <mark>/flowable-6.7.2/modules/flowable-ui/flowable-ui-modeler-frontend/src/main/resources/static/modeler</mark><br> <img src="https://images2.imgbox.com/66/98/2471pW5i_o.png" alt="在这里插入图片描述"></p> </li><li> <p>跳过验证</p> </li></ol> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>flowable<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>common<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token class-name">SecurityConstants</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Order</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>web<span class="token punctuation">.</span>builders<span class="token punctuation">.</span></span><span class="token class-name">HttpSecurity</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>web<span class="token punctuation">.</span>configuration<span class="token punctuation">.</span></span><span class="token class-name">WebSecurityConfigurerAdapter</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 绕过flowable的登录验证
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfiguration</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token comment">//Order配置说明</span>
    <span class="token comment">// 这个地方相同会报错</span>
    <span class="token comment">//这个地方如果大于则该配置在FlowableUiSecurityAutoConfiguratio中对应项后加载，不能起到绕过授权作用</span>
    <span class="token comment">//所以这个地方-1让该配置项在FlowableUiSecurityAutoConfiguratio中对应配置项前加载，以跳过授权</span>
    <span class="token annotation punctuation">@Order</span><span class="token punctuation">(</span><span class="token class-name">SecurityConstants</span><span class="token punctuation">.</span><span class="token constant">FORM_LOGIN_SECURITY_ORDER</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">FormLoginWebSecurityConfigurerAdapter</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">{<!-- --></span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
            http<span class="token punctuation">.</span><span class="token function">headers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">frameOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


            http
                    <span class="token comment">//必须要将csrf设置为disable，不然后面发送POST请求时会报403错误</span>
                    <span class="token punctuation">.</span><span class="token function">csrf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token comment">//为了简单起见，简单粗暴方式直接放行modeler下面所有请求</span>
                    <span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/modeler/**"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<ol start="4"><li>启动项目，访问：http://localhost:8080/modeler/#/processes<br> <img src="https://images2.imgbox.com/68/5f/GLVSwBom_o.png" alt="在这里插入图片描述"></li></ol> 
<h2><a id="_607"></a>三、创建流程模版(以请假为例)</h2> 
<ol><li> <p><strong>确保已在idea中安装Flowable插件</strong></p> </li><li> <p><strong>在resources下创建processes文件夹，右键，创建一个【*.bpmn20.xml】文件</strong><br> <img src="https://images2.imgbox.com/2c/c7/DNf7BbH4_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>选中创建好的【*.bpmn20.xml】文件，右键；</strong><img src="https://images2.imgbox.com/8f/9e/8DETdzu6_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>开始画流程图 任意位置右键–&gt;启动一个流程</strong><br> <img src="https://images2.imgbox.com/14/1b/4L0RL7St_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/66/a3/K9mmAJQg_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>设置员工提交申请</strong><br> <img src="https://images2.imgbox.com/9e/d7/aCyvgGgd_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/5d/d9/rqZP2k7s_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>设置领导</strong><br> <img src="https://images2.imgbox.com/41/32/SdRjfbNp_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>设置网关，用来判断领导是否同意</strong><br> <img src="https://images2.imgbox.com/9a/cd/96gR8SLA_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/fb/86/T5lboj3i_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>网关条件判断条件–驳回</strong><br> <img src="https://images2.imgbox.com/31/3e/sC237zbg_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>网关条件判断条件–通过</strong><br> <img src="https://images2.imgbox.com/0e/f6/4kfoYqqf_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>设置老板</strong><br> <img src="https://images2.imgbox.com/e6/f2/oHI53ZG3_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>设置网关，用来判断老板是否同意</strong><br> <img src="https://images2.imgbox.com/b6/9a/p06y0z3P_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>网关条件判断条件–驳回</strong><br> <img src="https://images2.imgbox.com/73/1a/zw3xBbt6_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>网关条件判断条件–通过</strong><br> <img src="https://images2.imgbox.com/c7/8f/kWhsfmiv_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>当我们画好图后，【*.bpmn20.xml】流程文件也已经创建成功了</strong><br> <img src="https://images2.imgbox.com/a0/36/Vi6IlXMQ_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>可以书写针对流程的逻辑了</strong></p> </li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/057161bc7d15176eb2b6d5d565c15f78/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">基于LLaMA-Factory的微调记录</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0da3a7b55e8a7e3822bee0a89550c16f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Spring】Spring的循环依赖以及解决方案</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>