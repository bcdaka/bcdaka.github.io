<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【LeetCode】动态规划 刷题训练(六) - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/142f8250ae76b5ad121b55eb748d7161/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【LeetCode】动态规划 刷题训练(六)">
  <meta property="og:description" content="文章目录 123. 买卖股票的最佳时机 III题目解析零笔交易一笔交易两笔交易 状态转移方程f[i][j]状态转移方程g[i][j]状态转移方程 初始化完整代码 188. 买卖股票的最佳时机 IV题目解析状态转移方程f[i][j]状态转移方程g[i][j]状态转移方程 初始化完整代码 53. 最大子数组和状态转移方程初始化完整代码 123. 买卖股票的最佳时机 III 点击查看：买卖股票的最佳时机 III
给定一个数组，它的第 i 个元素是一支给定的股票在第 i 天的价格。
设计一个算法来计算你所能获取的最大利润。你最多可以完成 两笔 交易。
注意：你不能同时参与多笔交易（你必须在再次购买前出售掉之前的股票）。
示例 1:
输入：prices = [3,3,5,0,0,3,1,4]
输出：6
解释：在第 4 天（股票价格 = 0）的时候买入，在第 6 天（股票价格 = 3）的时候卖出，这笔交易所能获得利润 = 3-0 = 3 。
随后，在第 7 天（股票价格 = 1）的时候买入，在第 8 天 （股票价格 = 4）的时候卖出，这笔交易所能获得利润 = 4-1 = 3 。
示例 2：
输入：prices = [1,2,3,4,5]
输出：4
解释：在第 1 天（股票价格 = 1）的时候买入，在第 5 天 （股票价格 = 5）的时候卖出, 这笔交易所能获得利润 = 5-1 = 4 。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-09-02T18:44:46+08:00">
    <meta property="article:modified_time" content="2023-09-02T18:44:46+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【LeetCode】动态规划 刷题训练(六)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#123__III_3" rel="nofollow">123. 买卖股票的最佳时机 III</a></li><li><ul><li><a href="#_29" rel="nofollow">题目解析</a></li><li><ul><li><a href="#_40" rel="nofollow">零笔交易</a></li><li><a href="#_48" rel="nofollow">一笔交易</a></li><li><a href="#_61" rel="nofollow">两笔交易</a></li></ul> 
   </li><li><a href="#_94" rel="nofollow">状态转移方程</a></li><li><ul><li><a href="#fij_117" rel="nofollow">f[i][j]状态转移方程</a></li><li><a href="#gij_149" rel="nofollow">g[i][j]状态转移方程</a></li></ul> 
   </li><li><a href="#_181" rel="nofollow">初始化</a></li><li><a href="#_234" rel="nofollow">完整代码</a></li></ul> 
  </li><li><a href="#188__IV_287" rel="nofollow">188. 买卖股票的最佳时机 IV</a></li><li><ul><li><a href="#_316" rel="nofollow">题目解析</a></li><li><a href="#_339" rel="nofollow">状态转移方程</a></li><li><ul><li><a href="#fij_369" rel="nofollow">f[i][j]状态转移方程</a></li><li><a href="#gij_397" rel="nofollow">g[i][j]状态转移方程</a></li></ul> 
   </li><li><a href="#_428" rel="nofollow">初始化</a></li><li><a href="#_487" rel="nofollow">完整代码</a></li></ul> 
  </li><li><a href="#53__541" rel="nofollow">53. 最大子数组和</a></li><li><ul><li><a href="#_550" rel="nofollow">状态转移方程</a></li><li><a href="#_584" rel="nofollow">初始化</a></li><li><a href="#_602" rel="nofollow">完整代码</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="123__III_3"></a>123. 买卖股票的最佳时机 III</h2> 
<p><font color="blue">点击查看：<a href="https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-iii/" rel="nofollow">买卖股票的最佳时机 III</a></font></p> 
<hr> 
<blockquote> 
 <p><font color="blue">给定一个数组，它的第 i 个元素是一支给定的股票在第 i 天的价格。<br> 设计一个算法来计算你所能获取的最大利润。你最多可以完成 两笔 交易。<br> 注意：你不能同时参与多笔交易（你必须在再次购买前出售掉之前的股票）。</font></p> 
</blockquote> 
<blockquote> 
 <p><font color="blue">示例 1:<br> 输入：prices = [3,3,5,0,0,3,1,4]<br> 输出：6<br> 解释：在第 4 天（股票价格 = 0）的时候买入，在第 6 天（股票价格 = 3）的时候卖出，这笔交易所能获得利润 = 3-0 = 3 。<br> 随后，在第 7 天（股票价格 = 1）的时候买入，在第 8 天 （股票价格 = 4）的时候卖出，这笔交易所能获得利润 = 4-1 = 3 。<br> 示例 2：<br> 输入：prices = [1,2,3,4,5]<br> 输出：4<br> 解释：在第 1 天（股票价格 = 1）的时候买入，在第 5 天 （股票价格 = 5）的时候卖出, 这笔交易所能获得利润 = 5-1 = 4 。<br> 注意你不能在第 1 天和第 2 天接连购买股票，之后再将它们卖出。<br> 因为这样属于同时参与了多笔交易，你必须在再次购买前出售掉之前的股票。</font></p> 
</blockquote> 
<h3><a id="_29"></a>题目解析</h3> 
<p><font color="blue">相对于之前的股票问题，去除了手续费和冷冻期，其他大部分相同，<br> 但是<font color="red">交易的次数从一次可以变为两次(最多为两次，也可以选择一次或者零次)</font></font></p> 
<p><font color="red">从买入股票到 卖出股票 ，才算完成一笔交易</font></p> 
<hr> 
<h4><a id="_40"></a>零笔交易</h4> 
<img src="https://images2.imgbox.com/7a/c4/CbPJBrWx_o.png" width="50%"> 
<p><font color="blue">由于价格是降序的，所以无论什么时候买股票，再卖出股票都是会亏本的<br> 所以在这个期间内，什么都不做，此时的利润为：0<br> <font color="red">此时完成零笔交易</font></font></p> 
<h4><a id="_48"></a>一笔交易</h4> 
<img src="https://images2.imgbox.com/93/ff/P00ajfkE_o.png" width="50%"> 
<p><font color="blue">当价格为升序的时候，在第一天卖出股票，在价格为5之前什么都不做，<br> 在价格为5时，卖出股票，此时 利润为：5-1=4<br> <font color="red">此时完成 一笔交易</font></font></p> 
<hr> 
<h4><a id="_61"></a>两笔交易</h4> 
<img src="https://images2.imgbox.com/8b/fb/FMSJ6iHu_o.png" width="60%"> 
<p><font color="blue">在第一天买入股票，由于第二天要是买的话根本没有利润，所以第二天什么都不做<br> 在第三天的时候，将股票卖出 ，此时的利润为： 5-3=2</font></p> 
<hr> 
<img src="https://images2.imgbox.com/eb/25/oKkCidTT_o.png" width="60%"> 
<p><font color="blue">在第四天买入股票，一直到 价格为4块之前都处于什么都不干的状态<br> 在价格为4块时，卖出股票<br> 此时的利润为：4-0=4<br> 完成两笔交易的总利润为：4+2=6</font></p> 
<p><font color="red">此时完成两笔交易</font></p> 
<h3><a id="_94"></a>状态转移方程</h3> 
<p><font color="red">dp[i]：表示第i天结束后，所能获得的最大利润</font></p> 
<hr> 
<img src="https://images2.imgbox.com/5c/40/keJGIH6M_o.png" width="50%"> 
<p><font color="blue">在i位置处，共有两种状态，买入状态和卖出状态<br> 用f表示买入状态，用g表示卖出状态<br> 通过i表示第i天结束<br> <font color="red">通过j表示交易次数</font></font></p> 
<p><font color="blue">f[i][j]：表示从第i天结束后，完成了j笔交易，处于买入状态，此时的最大利润<br> g[i][j]：表示从第i天结束后，完成了j笔交易，处于卖出状态，此时的最大利润</font></p> 
<p><font color="red">在完成 买入股票，卖出股票的操作后，会改变交易次数</font></p> 
<hr> 
<h4><a id="fij_117"></a>f[i][j]状态转移方程</h4> 
<img src="https://images2.imgbox.com/c7/70/4UFGzBEc_o.png" width="70%"> 
<p><font color="blue">若第i-1天为买入状态，则第i天啥也不干，第i天也为买入状态<br> 该情况下：<font color="red">f[i][j]=f[i-1][j];</font></font></p> 
<hr> 
<img src="https://images2.imgbox.com/27/fd/Nryw16vN_o.png" width="60%"> 
<p><font color="blue">若第i-1天为卖出状态，则第i天为买入状态<br> 需要减去买股票对应的花费 price[i]<br> 该情况下：<font color="red"> f[i][j]=g[i-1][j]-price[i];</font></font></p> 
<hr> 
<p><font color="blue">状态转移方程为：<br> <font color="red">f[i][j]=max(f[i-1][j],g[i-1][j]-price[i]);</font></font></p> 
<h4><a id="gij_149"></a>g[i][j]状态转移方程</h4> 
<img src="https://images2.imgbox.com/ac/69/3IC9I6pN_o.png" width="60%"> 
<p><font color="blue">若第i-1天为卖出状态，则第i天什么都不干，则第i天也为卖出状态<br> 该情况下：<font color="red">g[i][j]=g[i-1][j];</font></font></p> 
<hr> 
<img src="https://images2.imgbox.com/7f/d0/RfJSocDs_o.png" width="60%"> 
<p><font color="blue">若第i-1天为买入状态，则第i天为卖出状态<br> 需要加上卖股票对应的利润 price[i] ，<br> 因为完成了 从 买入到卖出的状态，第i天的交易次数+1 即变为 j，此时的j属于在原来的次数上+1<br> 而第i-1天的交易次数依旧为原来的次数 ，所以应为 j-1<br> <font color="red">从买入股票到 卖出股票 ，才算完成一笔交易<br> <font color="blue">假设j为0，则第i-1天买入股票，交易次数为0次<br> 而第i天卖出股票，交易次数为1次</font></font></font></p> 
<p><font color="blue">该情况下：<font color="red">g[i][j]=f[i-1][j-1]+price[i];</font></font></p> 
<hr> 
<p><font color="blue">状态转移方程为：<br> <font color="red">g[i][j]= max(g[i-1][j],f[i-1][j-1]+price[i]);</font></font></p> 
<h3><a id="_181"></a>初始化</h3> 
<p><font color="blue">对于g[i][j]的状态转移方程，当j为0时，在第i-1天完成-1笔交易，这种情况是不存在的<br> 所以可以对g[i][j]的状态转移方程进行修改</font></p> 
<hr> 
<img src="https://images2.imgbox.com/e0/cd/txZlGqAY_o.png" width="90%"> 
<p><font color="blue">在第一步中，将g[i][j]赋值为 g[i-1][j]，所以在if循环中直接将g[i-1][j]替换成g[i][j]<br> <font color="red">这样就能避免 出现-1笔交易的发生</font></font></p> 
<hr> 
<img src="https://images2.imgbox.com/62/74/jbonPT7A_o.png" width="70%"> 
<p><font color="blue">纵坐标表示 第i天结束之后<br> 横坐标 表示 完成 i笔交易<br> 当 纵坐标取0时，表示第0天结束之后 ，完成 0 /1/ 2笔交易，这种情况是不存在的<br> 当天买了又卖，是没有任何利润的，而交易次数又是有限的，<br> 所以为了不干扰后续结果，所以将第0天结束之后 ，完成 1/ 2笔交易时都设置为 负无穷大</font></p> 
<hr> 
<img src="https://images2.imgbox.com/17/a9/pLhcn9Qz_o.png" width="50%"> 
<p><font color="blue">f[0][0] ：表示第0天结束之后，处于买入状态，即将股票买了，需要花钱，利润为负<br> <font color="red">f[0][0]=-price[0];</font></font></p> 
<hr> 
<img src="https://images2.imgbox.com/da/9f/M0Iu8LEa_o.png" width="50%"> 
<p><font color="blue">g[0][0]：表示第0天结束之后，处于卖出状态 (第0天结束之后，没有股票在手里，无法卖出，相当于啥也没干，利润为0)<br> <font color="red">g[0][0]=0;</font></font></p> 
<hr> 
<p><font color="blue">若负无穷大 选择 INT_MIN ，则会发生越界问题<br> 负无穷大 选择 <code>-0x3f3f3f3f</code> ( 0x3f3f3f3f 为int的最大值的一半)</font></p> 
<h3><a id="_234"></a>完整代码</h3> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> <span class="token function">maxProfit</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span> prices<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
       <span class="token keyword">int</span> n<span class="token operator">=</span>prices<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">//因为可能完成 0 1 2 三笔交易其中一种 所以定义为3列</span>
       <span class="token comment">//负无穷大 若要设置为INT_MIN会发生越界问题</span>
       <span class="token comment">//所以使用 -0x3f3f3f</span>
       vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;&gt;</span><span class="token function">f</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token generic-function"><span class="token function">vector</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x3f3f3f3f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;&gt;</span><span class="token function">g</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token generic-function"><span class="token function">vector</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x3f3f3f3f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
       <span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
       <span class="token comment">//初始化</span>
       f<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">-</span>prices<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
       g<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
       <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
       <span class="token punctuation">{<!-- --></span>
           <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">3</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
           <span class="token punctuation">{<!-- --></span>
               f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span>g<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">-</span>prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token comment">//修改后的状态转移方程 </span>
               g<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>g<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
               <span class="token keyword">if</span><span class="token punctuation">(</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token operator">&gt;=</span><span class="token number">0</span><span class="token punctuation">)</span>
               <span class="token punctuation">{<!-- --></span>
                   g<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span>f<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token punctuation">}</span>
           <span class="token punctuation">}</span>
       <span class="token punctuation">}</span>
       <span class="token keyword">int</span> ret<span class="token operator">=</span>INT_MIN<span class="token punctuation">;</span>
        <span class="token comment">//寻找最后一行g的最大值</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">3</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">&lt;</span>g<span class="token punctuation">[</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                 ret<span class="token operator">=</span>g<span class="token punctuation">[</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//返回最后一行g的最大值</span>
        <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p><font color="blue"> 返回值<br> 由于 最大利润 有可能为 0笔交易/1一笔交易/2笔交易<br> 若使用f ，则为达到最后位置，还在买入状态，不可能是最大利润<br> 所以使用 g ，并统计 g的最后一行(0,1,2位置)的最大值</font></p> 
<h2><a id="188__IV_287"></a>188. 买卖股票的最佳时机 IV</h2> 
<p><font color="blue">点击查看：<a href="https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-iv/" rel="nofollow">买卖股票的最佳时机 IV</a></font></p> 
<hr> 
<blockquote> 
 <p><font color="blue">给定一个整数数组 prices ，它的第 i 个元素 prices[i] 是一支给定的股票在第 i 天的价格，和一个整型 k 。<br> 设计一个算法来计算你所能获取的最大利润。你最多可以完成 k 笔交易。也就是说，你最多可以买 k 次，卖 k 次。<br> 注意：你不能同时参与多笔交易（你必须在再次购买前出售掉之前的股票）。</font></p> 
</blockquote> 
<blockquote> 
 <p><font color="blue">示例 1：<br> 输入：k = 2, prices = [2,4,1]<br> 输出：2<br> 解释：在第 1 天 (股票价格 = 2) 的时候买入，在第 2 天 (股票价格 = 4) 的时候卖出，这笔交易所能获得利润 = 4-2 = 2 。<br> 示例 2：<br> 输入：k = 2, prices = [3,2,6,5,0,3]<br> 输出：7<br> 解释：在第 2 天 (股票价格 = 2) 的时候买入，在第 3 天 (股票价格 = 6) 的时候卖出, 这笔交易所能获得利润 = 6-2 = 4 。<br> 随后，在第 5 天 (股票价格 = 0) 的时候买入，在第 6 天 (股票价格 = 3) 的时候卖出, 这笔交易所能获得利润 = 3-0 = 3 。</font></p> 
</blockquote> 
<h3><a id="_316"></a>题目解析</h3> 
<p><font color="red">该题与买卖股票的最佳时机 III 基本类似，只不过把之前的 最多2次(0 1 2 三种可能) 变为了 k次( [0,k-1] 种可能</font></p> 
<hr> 
<img src="https://images2.imgbox.com/35/27/2SSImpXv_o.png" width="70%"> 
<p><font color="blue">k为2，表示 最多进行2笔交易(0笔交易/1笔交易 /2笔交易 三种可能) 求最大利润</font></p> 
<hr> 
<img src="https://images2.imgbox.com/b3/ec/YOSNDsmc_o.png" width="60%"> 
<p><font color="blue">在第一天时买入股票，在第二天卖出股票，此时的利润为：4-2=2<br> 第三天因为是最后一天，所以啥也不干<br> 即 最大利润为：2</font></p> 
<h3><a id="_339"></a>状态转移方程</h3> 
<p><font color="blue">(最佳时机IV这道题与 最佳时机III 在分析阶段 ，基本都是一致的)</font></p> 
<hr> 
<p><font color="red">dp[i]：表示第i天结束后，所能获得的最大利润</font></p> 
<img src="https://images2.imgbox.com/e0/bc/puKh514S_o.png" width="50%"> 
<p><font color="blue">在i位置处，共有两种状态，买入状态和卖出状态<br> 用f表示买入状态，用g表示卖出状态<br> 通过i表示第i天结束<br> <font color="red">通过j表示交易次数</font></font></p> 
<p><font color="blue"><font color="blue">f[i][j]：表示从第i天结束后，完成了j笔交易，处于买入状态，此时的最大利润<br> g[i][j]：表示从第i天结束后，完成了j笔交易，处于卖出状态，此时的最大利润</font></font></p> 
<p><font color="red">在完成 买入股票，卖出股票的操作后，会改变交易次数</font></p> 
<h4><a id="fij_369"></a>f[i][j]状态转移方程</h4> 
<img src="https://images2.imgbox.com/9f/22/qbG9iIC7_o.png" width="50%"> 
<p><font color="blue">若第i-1天为买入状态，则第i天啥也不干，第i天也为买入状态<br> 该情况下：<font color="red">f[i][j]=f[i-1][j];</font></font></p> 
<hr> 
<img src="https://images2.imgbox.com/e4/39/9NdXMM82_o.png" width="60%"> 
<p><font color="blue">若第i-1天为卖出状态，则第i天为买入状态<br> 需要减去买股票对应的花费 price[i]<br> 该情况下： <font color="red">f[i][j]=g[i-1][j]-price[i];</font></font></p> 
<hr> 
<p><font color="blue">状态转移方程为：<br> <font color="red">f[i][j]=max(f[i-1][j],g[i-1][j]-price[i]);</font></font></p> 
<h4><a id="gij_397"></a>g[i][j]状态转移方程</h4> 
<img src="https://images2.imgbox.com/21/95/3ENYoMCC_o.png" width="60%"> 
<p><font color="blue">若第i-1天为卖出状态，则第i天什么都不干，则第i天也为卖出状态<br> 该情况下：<font color="red">g[i][j]=g[i-1][j];</font></font></p> 
<hr> 
<img src="https://images2.imgbox.com/71/10/FetnaCb5_o.png" width="60%"> 
<p><font color="blue">若第i-1天为买入状态，则第i天为卖出状态<br> 需要加上卖股票对应的利润 price[i] ，<br> 因为完成了 从 买入到卖出的状态，第i天的交易次数+1 即变为 j，此时的j属于在原来的次数上+1<br> 而第i-1天的交易次数依旧为原来的次数 ，所以应为 j-1<br> <font color="red">从买入股票到 卖出股票 ，才算完成一笔交易<br> <font color="blue">假设j为0，则第i-1天买入股票，交易次数为0次<br> 而第i天卖出股票，交易次数为1次</font></font></font></p> 
<p><font color="blue">该情况下：<font color="red">g[i][j]=f[i-1][j-1]+price[i];</font></font></p> 
<hr> 
<p><font color="blue">状态转移方程为：<br> <font color="red">g[i][j]= max(g[i-1][j],f[i-1][j-1]+price[i]);</font></font></p> 
<h3><a id="_428"></a>初始化</h3> 
<p><font color="blue">对于g[i][j]的状态转移方程，当j为0时，在第i-1天完成-1笔交易，这种情况是不存在的<br> 所以可以对g[i][j]的状态转移方程进行修改</font></p> 
<hr> 
<img src="https://images2.imgbox.com/18/ed/3g75Pflx_o.png" width="80%"> 
<p><font color="blue">在第一步中，将g[i][j]赋值为 g[i-1][j]，所以在if循环中直接将g[i-1][j]替换成g[i][j]<br> 这样就能<font color="red">避免 出现-1笔交易的发生</font></font></p> 
<hr> 
<p><font color="red">假设k为2，则有 0笔交易 1笔交易 2笔交易 三种情况</font></p> 
<img src="https://images2.imgbox.com/6b/04/j0ODMeJ4_o.png" width="70%"> 
<p><font color="blue">纵坐标表示 第i天结束之后<br> 横坐标 表示 完成 i笔交易<br> 当 纵坐标取0时，表示第0天结束之后 ，完成 0 /1/ 2笔交易，这种情况是不存在的<br> 当天买了又卖，是没有任何利润的，而交易次数又是有限的，<br> 所以为了不干扰后续结果，所以将第0天结束之后 ，完成 1/ 2笔交易时都设置为 负无穷大</font></p> 
<hr> 
<img src="https://images2.imgbox.com/e5/ba/2Au59YzI_o.png" width="60%"> 
<p><font color="blue">f[0][0] ：表示第0天结束之后，处于买入状态，即将股票买了，需要花钱，利润为负<br> <font color="red">f[0][0]=-price[0];</font></font></p> 
<hr> 
<img src="https://images2.imgbox.com/a2/8e/NyFjM1Ky_o.png" width="60%"> 
<p><font color="blue">g[0][0]：表示第0天结束之后，处于卖出状态 (第0天结束之后，没有股票在手里，无法卖出，相当于啥也没干，利润为0)<br> <font color="red">g[0][0]=0;</font></font></p> 
<hr> 
<p><font color="blue">若负无穷大 选择 int_min ，则会发生越界问题<br> 负无穷大 选择 <code>-0x3f3f3f3f</code>( 0x3f3f3f3f 为int的最大值的一半)\</font></p> 
<h3><a id="_487"></a>完整代码</h3> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> <span class="token function">maxProfit</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span> prices<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
       <span class="token keyword">int</span> n<span class="token operator">=</span>prices<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">//将k进行优化</span>
       k<span class="token operator">=</span><span class="token function">min</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span>n<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">//f 表示买入状态 g表示卖出状态</span>
       <span class="token comment">//有[0,k-1] 笔交易</span>
       vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;&gt;</span><span class="token function">f</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token generic-function"><span class="token function">vector</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x3f3f3f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
       vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;&gt;</span><span class="token function">g</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token generic-function"><span class="token function">vector</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x3f3f3f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

       <span class="token comment">//初始化</span>
       f<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">-</span>prices<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
       g<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
       <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
       <span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
       <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
       <span class="token punctuation">{<!-- --></span>
           <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>k<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
           <span class="token punctuation">{<!-- --></span>
              f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span>g<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">-</span>prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//修改后的状态转移方程</span>
              g<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>g<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
              <span class="token keyword">if</span><span class="token punctuation">(</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token operator">&gt;=</span><span class="token number">0</span><span class="token punctuation">)</span>
              <span class="token punctuation">{<!-- --></span>
                  g<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span>f<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
           <span class="token punctuation">}</span>
       <span class="token punctuation">}</span>
       <span class="token comment">//寻找g的最后一行的最大值</span>
       <span class="token keyword">int</span> ret<span class="token operator">=</span>INT_MIN<span class="token punctuation">;</span>
       <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>k<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
       <span class="token punctuation">{<!-- --></span>
           <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">&lt;</span>g<span class="token punctuation">[</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
           <span class="token punctuation">{<!-- --></span>
               ret<span class="token operator">=</span>g<span class="token punctuation">[</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
           <span class="token punctuation">}</span>
       <span class="token punctuation">}</span>
       <span class="token comment">//返回g的最后一行的最大值</span>
       <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p><font color="blue">若有20天， k(交易次数)为30，<br> 而最多交易只有10次，所以<font color="red">将k进行优化<br> k=min(k,n/2);<br> <font color="blue">(n/2 代表最多进行交易的次数)</font></font></font></p> 
<h2><a id="53__541"></a>53. 最大子数组和</h2> 
<p><font color="blue">点击查看：<a href="https://leetcode.cn/problems/maximum-subarray/" rel="nofollow">最大子数组和</a></font></p> 
<hr> 
<h3><a id="_550"></a>状态转移方程</h3> 
<img src="https://images2.imgbox.com/db/25/DmOR4Fzm_o.png" width="40%"> 
<p><font color="blue">将以i为结尾的所有子数组拿到，如：i位置处本身、i与i-1位置结合、i与i-2位置结合、i与下标0位置处结合 等生成的子数组<br> <font color="red">取其中和最大的那个</font></font></p> 
<p><font color="red">dp[i]：表示以i位置元素为结尾的所有子数组中的最大和</font></p> 
<hr> 
<p><font color="blue">dp[i]可被划分为两类 ：</font></p> 
<p><font color="blue">1.i位置元素本身(长度为1)<br> 该情况下：<font color="red">dp[i]= nums[i]</font></font></p> 
<hr> 
<p><font color="blue">2.i位置元素与前面元素结合(长度大于1)</font></p> 
<img src="https://images2.imgbox.com/0c/f0/9zIeJAYZ_o.png" width="60%"> 
<p><font color="blue">因为要求的是以i位置为结尾的子数组最大和，所以应该先求 以i-1位置为结尾的子数组的最大和 即<font color="red"> dp[i-1]<br> <font color="blue">在加上nums[i] ，就为以i位置为结尾的子数组最大和<br> 该情况下：<font color="red">dp[i]=dp[i-1]+nums[i];</font></font></font></font></p> 
<h3><a id="_584"></a>初始化</h3> 
<p><font color="blue">若i为0时，就为发生越界问题</font></p> 
<img src="https://images2.imgbox.com/af/05/SZ8nlSoB_o.png" width="70%"> 
<p><font color="blue">为了防止这种越界问题出现，所以加入一个虚拟节点<br> 扩展后的数组，虚拟节点处下标为0，则 原数组的元素下标从1开始</font></p> 
<p><font color="blue">若为dp[1]，dp[1]=max(nums[1],dp[0]+nums[1])<br> 为了保证不干扰结果，则<font color="red">将dp[0]的值置为0</font></font></p> 
<h3><a id="_602"></a>完整代码</h3> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> <span class="token function">maxSubArray</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
       <span class="token keyword">int</span> n<span class="token operator">=</span>nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">//dp作为扩展数组 所以比原数组大1</span>
       vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token function">dp</span><span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

       <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
       <span class="token comment">//因为dp表可能都为负，所以初始值为最小值</span>
       <span class="token keyword">int</span> ret<span class="token operator">=</span>INT_MIN<span class="token punctuation">;</span>
       <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
       <span class="token punctuation">{<!-- --></span>
           <span class="token comment">//当前下标i作为扩展数组dp的下标 </span>
           <span class="token comment">//想要使用dp下标 找到对应 原数组nums对应值</span>
           <span class="token comment">//应该使用i-1</span>
           dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>nums<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token comment">//寻找dp表的最大值</span>
           <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">&lt;</span>dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
           <span class="token punctuation">{<!-- --></span>
               ret<span class="token operator">=</span>dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
           <span class="token punctuation">}</span>
       <span class="token punctuation">}</span>

       <span class="token keyword">return</span> ret<span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5fa68576a04259deb3af669562c964d1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">stable diffusion实践操作-批次出图</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f950adfca2a170068d3abef0c43db27a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">解读《生成式人工智能服务管理暂行办法》</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>