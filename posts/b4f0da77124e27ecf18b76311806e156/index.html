<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Nginx和Tomcat实现负载均衡群集部署应用 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/b4f0da77124e27ecf18b76311806e156/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Nginx和Tomcat实现负载均衡群集部署应用">
  <meta property="og:description" content="🏡作者主页：点击！ 🐧Linux基础知识(初学)：点击！
🐧Linux高级管理专栏：点击！
🔐Linux中firewalld防火墙：点击！
⏰️创作时间：2024年7月10日14点11分
🀄️文章质量：94分
在当今互联网高并发访问的环境下,单一的Web服务器很难满足不断增长的用户需求。为了提高系统的可靠性、可扩展性和高可用性,实现负载均衡和集群部署是一个非常重要的解决方案。
Nginx凭借其高性能、高并发和低资源占用的特点,成为了一款出色的反向代理服务器和负载均衡器。它可以在多台Web服务器之间分发请求,实现负载均衡,同时还提供了缓存、压缩等优化功能,有效提高了Web应用程序的响应速度和可靠性。
而Tomcat则是一款广泛使用的Java Web应用服务器,它支持集群部署,可以将多个Tomcat实例组合成一个逻辑上的服务器集群,实现请求的负载均衡和会话共享,从而提高了系统的可扩展性和高可用性。
无论是Nginx还是Tomcat,它们在负载均衡和集群部署方面都有着独特的优势和特点,根据具体的应用场景和需求,合理选择和配置这两种技术,可以极大地提升Web应用程序的性能和可靠性。
实验环境 Nginx IP地址：192.168.192.100/24
Tomcat1 ip地址：192.168.192.111/24
Tomcat2 ip地址：192.168.192.112/24
本案例我们将以Nginx作为负载均衡器，Tomcat作为应用服务器的负载群集的设置方法
Tomcat1 1.查看JDK是否安装
[root@localhost ~]# java -version -bash: java: 未找到命令 如果没有配置java不要慌，如果有的话是会显示的
配置本地源或者阿里源来安装
yum install -y java-1.8.0-openjdk 上传安装包 解压安装
解压完成之后移动
开启tomcat
[root@localhost ~] tar -zxf apache-tomcat-9.0.91.tar.gz 解压 [root@localhost ~ ]mv apache-tomcat-9.0.91 /usr/local/tomcat8 移动到 /usr/local下 [root@localhost ~] /usr/local/tomcat8/bin/startup.sh	开启tomcat Using CATALINA_BASE: /usr/local/tomcat8 Using CATALINA_HOME: /usr/local/tomcat8 Using CATALINA_TMPDIR: /usr/local/tomcat8/temp Using JRE_HOME: /usr Using CLASSPATH: /usr/local/tomcat8/bin/bootstrap.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-12T14:39:58+08:00">
    <meta property="article:modified_time" content="2024-07-12T14:39:58+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Nginx和Tomcat实现负载均衡群集部署应用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="text-align:center;"> <img alt="" height="80" src="https://images2.imgbox.com/2a/40/ObJhGIr7_o.gif" width="640"></p> 
<p style="text-align:center;"><strong>🏡作者主页：<strong><a href="https://blog.csdn.net/jxjdhdnd?type=blog" title="点击！">点击！</a></strong> </strong></p> 
<p style="text-align:center;"><strong>🐧Linux基础知识(初学)：<a href="http://t.csdnimg.cn/vHbWu" rel="nofollow" title="点击！">点击！</a></strong></p> 
<p style="text-align:center;"><strong>🐧Linux高级管理专栏：<strong><a href="https://blog.csdn.net/jxjdhdnd/category_12688607.html" title="点击！">点击！</a></strong></strong></p> 
<p style="text-align:center;"><strong>🔐Linux中firewalld防火墙：<a href="http://t.csdnimg.cn/wFpET" rel="nofollow" title="点击！">点击！</a></strong></p> 
<p style="text-align:center;"><strong>⏰️创作时间：2024年7月10日14点11分</strong></p> 
<p style="text-align:center;"><strong>🀄️文章质量：94分</strong></p> 
<p style="text-align:center;"><img alt="" height="80" src="https://images2.imgbox.com/37/9b/IUsmHmeN_o.gif" width="640"></p> 
<hr> 
<p></p> 
<p>在当今互联网高并发访问的环境下,单一的Web服务器很难满足不断增长的用户需求。为了提高系统的可靠性、可扩展性和高可用性,实现负载均衡和集群部署是一个非常重要的解决方案。</p> 
<p></p> 
<p><span style="color:#fe2c24;"><strong>Nginx凭借其高性能、高并发和低资源占用的特点,</strong></span>成为了一款出色的反向代理服务器和负载均衡器。它可以在多台Web服务器之间分发请求,实现负载均衡,<span style="color:#fe2c24;"><strong>同时还提供了缓存、压缩等优化功能,有效提高了Web应用程序的响应速度和可靠性。</strong></span></p> 
<p>而Tomcat则是一款广泛使用的<strong>Java Web</strong>应用服务器,它支持集群部署,可以将多个Tomcat实例组合成一个逻辑上的服务器集群,实现请求的负载均衡和会话共享,从而提高了系统的可扩展性和高可用性。</p> 
<p>无论是Nginx还是Tomcat,<strong><span style="color:#ff9900;">它们在负载均衡和集群部署方面都有着独特的优势和特点</span></strong>,<span style="color:#fe2c24;"><strong>根据具体的应用场景和需求,合理选择和配置这两种技术,可以极大地提升Web应用程序的性能和可靠性。</strong></span></p> 
<h2 id="header-d16e-a734">实验环境<img alt="" height="475" src="https://images2.imgbox.com/f8/05/olMFFJ8X_o.png" width="735"></h2> 
<p></p> 
<p></p> 
<p>Nginx IP地址：192.168.192.100/24</p> 
<p>Tomcat1 ip地址：192.168.192.111/24</p> 
<p>Tomcat2 ip地址：192.168.192.112/24</p> 
<p>本案例我们将以Nginx作为负载均衡器，Tomcat作为应用服务器的负载群集的设置方法</p> 
<p></p> 
<h3 id="header-1107-c184">Tomcat1</h3> 
<p>1.查看JDK是否安装</p> 
<pre><code>[root@localhost ~]# java -version
-bash: java: 未找到命令</code></pre> 
<p>如果没有配置java不要慌，如果有的话是会显示的</p> 
<p>配置本地源或者阿里源来安装</p> 
<pre><code>yum install -y java-1.8.0-openjdk</code></pre> 
<p>上传安装包 解压安装</p> 
<p></p> 
<p>解压完成之后移动</p> 
<p>开启tomcat</p> 
<pre><code class="language-bash">[root@localhost ~] tar -zxf apache-tomcat-9.0.91.tar.gz    解压




[root@localhost ~ ]mv apache-tomcat-9.0.91 /usr/local/tomcat8   移动到 /usr/local下


[root@localhost ~] /usr/local/tomcat8/bin/startup.sh		开启tomcat
Using CATALINA_BASE:   /usr/local/tomcat8
Using CATALINA_HOME:   /usr/local/tomcat8
Using CATALINA_TMPDIR: /usr/local/tomcat8/temp
Using JRE_HOME:        /usr
Using CLASSPATH:       /usr/local/tomcat8/bin/bootstrap.jar:/usr/local/tomcat8/bin/tomcat-juli.jar
Using CATALINA_OPTS:   
Tomcat started.</code></pre> 
<p></p> 
<p></p> 
<p>访问测试</p> 
<p>访问Tomcat的ip地址8080 出现以下页面表示成功</p> 
<p><img alt="" height="253" src="https://images2.imgbox.com/f8/83/QURed7Vy_o.png" width="506"></p> 
<p></p> 
<p></p> 
<p>创建存放的目录和页面</p> 
<p>创建/web/webapp1目录，修改Tomcat 配置文件 server.xml,将网站文件目录更改到/web/webapp1/路径下</p> 
<pre><code class="language-bash">mkdir -p /web/webapp1</code></pre> 
<p></p> 
<p>在/web/webapp1/路径下建立 index.jsp，为了区别将测试页面 index,jsp 的内容更改如下</p> 
<pre><code class="language-bash">vim /web/webapp1/index.jsp
加入以下内容
&lt;%@ page language="java" import="java.util.*" pageEncoding="UTF-8"%&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;JSP test1 page&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;% out.println("Welcome to test site, http://www.test1.com");%&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre> 
<p></p> 
<p></p> 
<p>修改Tomcat存放路径</p> 
<pre>vim /usr/local/tomcat8/conf/server.xml</pre> 
<p><img alt="" height="384" src="https://images2.imgbox.com/bc/41/X1AMhM8c_o.png" width="1123"></p> 
<pre><code>[root@localhost ~]# netstat -nultp | grep 8080
tcp6       2      0 :::8080                 :::*                    LISTEN      1133/java           
[root@localhost ~]# kill -9 1133
重启
[root@localhost ~]# /usr/local/tomcat8/bin/startup.sh</code></pre> 
<p></p> 
<p>查看进程关闭进程</p> 
<pre></pre> 
<p>重新访问测试<img alt="" height="393" src="https://images2.imgbox.com/ed/53/keTqB5H4_o.png" width="1033"></p> 
<p></p> 
<p></p> 
<h3 id="header-d480-e6e4">Tomcat2</h3> 
<p>都也一样需要注意的是页面内容记得修改</p> 
<p></p> 
<p></p> 
<h3 id="header-ba29-b6b3">Nginx配置</h3> 
<p></p> 
<p>下载所需组件</p> 
<pre><code class="language-bash">yum groupinstall "Development Tools"
yum install -y pcre-devel zlib-devel openssl-devel</code></pre> 
<pre>如果还缺什么组件 可以自己下载 如果没有包 可以配置阿里源来下载</pre> 
<p></p> 
<p></p> 
<pre><code class="language-bash">root@localhost ~ groupadd www
root@localhost ~ useradd -g www www -s /bin/false
root@localhost ~ tar -xzf nginx-1.26.1.tar.gz 
root@localhost ~ cd nginx-1.26.1/
[root@localhost nginx-1.26.1] ./configure --prefix=/usr/local/nginx --user=www --group=www --with-file-aio --with-http_stub_status_module --with-http_gzip_static_module --with-http_flv_module


make &amp;&amp; make install</code></pre> 
<p></p> 
<p>编辑Nginx的配置文件</p> 
<pre><code class="language-bash">vim /usr/local/nginx/conf/nginx.conf


        upstream tomcat_server {
        server 192.168.192.111:8080 weight=1;
        server 192.168.192.112:8080 weight=1;
    }


          location ~ \.jsp$ {
            proxy_pass   http://tomcat_server;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }</code></pre> 
<pre></pre> 
<pre><code class="language-bash">[roót@localhost~]#/usr/local/nginx/sbin/nginx -t</code></pre> 
<p>命令解释</p> 
<p><span style="color:#fe2c24;"><strong><code>upstream</code> </strong></span>指令用于<span style="color:#fe2c24;"><strong>定义一组服务器,</strong></span>这些服务器将作为负载均衡池,<span style="color:#fe2c24;"><strong>Nginx 会根据负载均衡算法将请求分发到这些服务器上</strong></span>。在这个例子中,定义了一个名为 <code>tomcat_server</code> 的上游服务器组,包含两台服务器 <code>192.168.192.111:8080</code> 和 <code>192.168.192.112:8080</code>,它们的权重都是 1。</p> 
<p></p> 
<p><strong>将所有以 <code>.jsp</code> 结尾的请求代理到 <code>tomcat_server</code> 上游服务器组,实现了对 JSP 页面的负载均衡。</strong></p> 
<p>测试 Nginx 配置文件是否正确</p> 
<pre></pre> 
<p></p> 
<p></p> 
<p>配置完成之后重启</p> 
<p>nginx有多个进程记得一并杀死</p> 
<pre><code class="language-bash">[root@localhost ~]# netstat -nultp | grep nginx
tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      57513/nginx: master 
[root@localhost ~]# kill -9 57513
[root@localhost ~]# kill -9 57514
[root@localhost ~]# /usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf</code></pre> 
<p>查看进程<img alt="" height="114" src="https://images2.imgbox.com/b5/2f/UStr6Kmt_o.png" width="1062"></p> 
<p></p> 
<h3 id="header-0f4c-27b6">测试负载均衡效果</h3> 
<p>不断刷新浏览器测试，可以看到由于权重相同，页面会反复在以下两个页面来回切换第一次访问，出现test1的测试页面，刷新后，第二次访问，出现 1est2 的试页面，。<span style="color:#fe2c24;">这说明负载均衡群集搭建成功，已经可以在两个Tomcat server站点进行切换</span></p> 
<p></p> 
<p>再次访问测试<img alt="" height="294" src="https://images2.imgbox.com/b4/c9/f2sppVLb_o.png" width="1032"></p> 
<p>访问jsp的文件时 给予回复的是Tomcat服务器 并且两个服务器来回切换</p> 
<p><img alt="" height="453" src="https://images2.imgbox.com/b4/d7/krmNbGjm_o.png" width="1027"></p> 
<p><img alt="" height="357" src="https://images2.imgbox.com/09/69/hwuDrHCM_o.png" width="1032"></p> 
<p></p> 
<blockquote> 
 <p>"成功的路上没有捷径，只有不断的努力与坚持。如果你和我一样，坚信努力会带来回报，请关注我，点个赞，一起迎接更加美好的明天！你的支持是我继续前行的动力！"</p> 
 <p></p> 
 <p>"每一次创作都是一次学习的过程，文章中若有不足之处，还请大家多多包容。你的关注和点赞是对我最大的支持，也欢迎大家提出宝贵的意见和建议，让我不断进步。"</p> 
 <p style="text-align:center;">神秘泣男子</p> 
 <p style="text-align:center;"><img alt="" height="289" src="https://images2.imgbox.com/34/f2/MYUHRd5J_o.png" width="296"></p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/10cdcc753dbf8c23fed0b4e91285256a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">DP讨论——建造者模式</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7f5cff16d23a76779e0ee070173ed088/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">零门槛用AI，302.AI让人工智能变得简单易用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>