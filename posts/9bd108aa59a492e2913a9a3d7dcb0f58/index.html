<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Mysql报错：too many connections原因及解决方法 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/9bd108aa59a492e2913a9a3d7dcb0f58/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Mysql报错：too many connections原因及解决方法">
  <meta property="og:description" content="MySQL报错“too many connections”通常是由于数据库的最大连接数超过了MySQL配置的最大限制。这可能是由于数据库的并发连接过多，或者存在一些连接没有被正确关闭。这里给出一些可能的解决方案：
1、linux登录mysql：
mysql -u root -p； 2、查看mysql允许的最大连接数
show variables like &#39;%max_connections%&#39;; 3、查看这次mysql服务启动到现在，同一时刻最多mysql有多少连接
show status like &#39;Max_used_connections&#39;; 4、修改mysql最大连接数
set global max_connections=1000; 5、以上步骤修改后虽然能登录，但仍有隐患，我们应该把那些sleep的连接杀掉
（1）查看所有连接状态,会发现很多状态是sleep的
show processlist ; (2)修改wait_timeout
wait_timeout — 指的是mysql在关闭一个非交互的连接之前所要等待的秒数
如果你没有修改过MySQL的配置，wait_timeout的初始值是28800
wait_timeout 过大有弊端，其体现就是MySQL里大量的SLEEP进程无法及时释放，拖累系统性能，不过也不能把这个指设置的过小，否则你可能会遭遇到“MySQL has gone away”之类的问题
set global wait_timeout=1000; 注意事项：
在高并发场景下，可以考虑设置max_user_connections参数来限制单个用户的最大连接数。
确保MySQL服务器的资源（如内存、CPU）不是瓶颈，因为资源不足也可能导致连接问题。
定期审查和调整数据库的配置参数，以适应业务的发展和变化。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-06T07:08:02+08:00">
    <meta property="article:modified_time" content="2024-01-06T07:08:02+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Mysql报错：too many connections原因及解决方法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="js_content"> 
 <p>MySQL报错“too many connections”通常是由于数据库的最大连接数超过了MySQL配置的最大限制。这可能是由于数据库的并发连接过多，或者存在一些连接没有被正确关闭。这里给出一些可能的解决方案：</p> 
 <p>1、linux登录mysql：</p> 
 <pre class="has"><code class="language-nginx">mysql -u root -p；</code></pre> 
 <p>2、查看mysql允许的最大连接数</p> 
 <pre class="has"><code class="language-sql">show variables like '%max_connections%';</code></pre> 
 <p>3、查看这次mysql服务启动到现在，同一时刻最多mysql有多少连接</p> 
 <pre class="has"><code class="language-sql">show status like 'Max_used_connections';</code></pre> 
 <p>4、修改mysql最大连接数</p> 
 <pre class="has"><code class="language-sql">set global max_connections=1000;</code></pre> 
 <p>5、以上步骤修改后虽然能登录，但仍有隐患，我们应该把那些sleep的连接杀掉</p> 
 <p>（1）查看所有连接状态,会发现很多状态是sleep的</p> 
 <pre class="has"><code class="language-sql">show processlist ;</code></pre> 
 <p>(2)修改wait_timeout</p> 
 <p>wait_timeout — 指的是mysql在关闭一个非交互的连接之前所要等待的秒数</p> 
 <p>如果你没有修改过MySQL的配置，wait_timeout的初始值是28800</p> 
 <p>wait_timeout 过大有弊端，其体现就是MySQL里大量的SLEEP进程无法及时释放，拖累系统性能，不过也不能把这个指设置的过小，否则你可能会遭遇到“MySQL has gone away”之类的问题</p> 
 <pre class="has"><code class="language-sql">set global wait_timeout=1000;</code></pre> 
 <p>注意事项：<br></p> 
 <p>在高并发场景下，可以考虑设置max_user_connections参数来限制单个用户的最大连接数。</p> 
 <p>确保MySQL服务器的资源（如内存、CPU）不是瓶颈，因为资源不足也可能导致连接问题。</p> 
 <p>定期审查和调整数据库的配置参数，以适应业务的发展和变化。</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/eaa14ee7452ed0c2ea928e507260c2f3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python官网下载第三方库,python常用第三方库下载</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1e71f733852e87b9522a55ae47a3d06d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">一篇文章帮你梳理 FT 、FS、 DTFT、 DFS、 DFT</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>