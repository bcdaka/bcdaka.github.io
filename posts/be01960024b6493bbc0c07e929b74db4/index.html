<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>insert overwrite table：数据仓库和数据分析中的常用技术 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/be01960024b6493bbc0c07e929b74db4/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="insert overwrite table：数据仓库和数据分析中的常用技术">
  <meta property="og:description" content="一、介绍： INSERT OVERWRITE TABLE 是用于覆盖（即替换）目标表中的数据的操作。它将新的数据写入表中，并删除原有的数据。这个操作适用于非分区表和分区表。
二、使用场景： 1、数据更新：当您需要更新表中的数据时，可以使用覆写操作。通过覆写，您可以将新的数据写入表中，替换原有的数据。这在需要定期更新或替换表中数据的情况下非常有用。
2、数据重载：如果您需要重新加载表中的数据，覆写操作可以清空表并将新的数据加载进去。这在数据仓库或数据分析任务中很常见，当需要重新加载或替换表中的数据时，覆写操作是一个快速有效的方法。
3、数据清理：当需要删除表中的数据时，可以使用覆写操作。通过将一个空表覆写到目标表中，可以清空表中的数据并释放存储空间。
注：insert overwrite table 是一个具有破坏性操作的语句，因为它会完全覆盖表中的数据。在使用之前，请确保您理解该操作的影响，并备份重要的数据以防止意外数据丢失。
三、普通表应用： 1、准备工作 create table db_1.tb_student( id int, name string, city string ) row format delimited fields terminated by &#39;,&#39;; insert into db_1.tb_student values (1,&#39;张三&#39;,&#39;beijing&#39;) , (2, &#39;李四&#39;, &#39;beijing&#39;), (3, &#39;王五&#39;, &#39;beijing&#39;), (4, &#39;妲己&#39;, &#39;shanghai&#39;), (5, &#39;哪吒&#39;, &#39;shanghai&#39;), (6, &#39;雷震子&#39;, &#39;shanghai&#39;), (7, &#39;悟空&#39;, &#39;guangzhou&#39;), (8, &#39;八戒&#39;, &#39;guangzhou&#39;), (9, &#39;沙和尚&#39;, &#39;guangzhou&#39;); create table db_1.tb_student_2( id int, name string, city string ) row format delimited fields terminated by &#39;,&#39;; drop table if exists tb_student_3_part; create table db_1.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-09-06T20:16:18+08:00">
    <meta property="article:modified_time" content="2023-09-06T20:16:18+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">insert overwrite table：数据仓库和数据分析中的常用技术</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>一、介绍：</h3> 
<p>INSERT OVERWRITE TABLE 是用于覆盖（即替换）目标表中的数据的操作。它将新的数据写入表中，并删除原有的数据。这个操作适用于非分区表和分区表。</p> 
<h3><a id="_2"></a>二、使用场景：</h3> 
<p>1、数据更新：当您需要更新表中的数据时，可以使用覆写操作。通过覆写，您可以将新的数据写入表中，替换原有的数据。这在需要定期更新或替换表中数据的情况下非常有用。<br> 2、数据重载：如果您需要重新加载表中的数据，覆写操作可以清空表并将新的数据加载进去。这在数据仓库或数据分析任务中很常见，当需要重新加载或替换表中的数据时，覆写操作是一个快速有效的方法。<br> 3、数据清理：当需要删除表中的数据时，可以使用覆写操作。通过将一个空表覆写到目标表中，可以清空表中的数据并释放存储空间。<br> 注：insert overwrite table 是一个具有破坏性操作的语句，因为它会完全覆盖表中的数据。在使用之前，请确保您理解该操作的影响，并备份重要的数据以防止意外数据丢失。</p> 
<h3><a id="_7"></a>三、普通表应用：</h3> 
<h5><a id="1_8"></a>1、准备工作</h5> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> db_1<span class="token punctuation">.</span>tb_student<span class="token punctuation">(</span>
    id  <span class="token keyword">int</span><span class="token punctuation">,</span>
    name string<span class="token punctuation">,</span>
    city    string
<span class="token punctuation">)</span>
<span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> db_1<span class="token punctuation">.</span>tb_student <span class="token keyword">values</span>
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token string">'beijing'</span><span class="token punctuation">)</span> <span class="token punctuation">,</span>                                 
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">,</span> <span class="token string">'beijing'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'王五'</span><span class="token punctuation">,</span> <span class="token string">'beijing'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'妲己'</span><span class="token punctuation">,</span> <span class="token string">'shanghai'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'哪吒'</span><span class="token punctuation">,</span> <span class="token string">'shanghai'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'雷震子'</span><span class="token punctuation">,</span> <span class="token string">'shanghai'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'悟空'</span><span class="token punctuation">,</span> <span class="token string">'guangzhou'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">'八戒'</span><span class="token punctuation">,</span> <span class="token string">'guangzhou'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token string">'沙和尚'</span><span class="token punctuation">,</span> <span class="token string">'guangzhou'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> db_1<span class="token punctuation">.</span>tb_student_2<span class="token punctuation">(</span>
    id  <span class="token keyword">int</span><span class="token punctuation">,</span>
    name string<span class="token punctuation">,</span>
    city    string
<span class="token punctuation">)</span>
<span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span><span class="token punctuation">;</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> tb_student_3_part<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> db_1<span class="token punctuation">.</span>tb_student_3_part<span class="token punctuation">(</span>
    id  <span class="token keyword">int</span><span class="token punctuation">,</span>
    name string
<span class="token punctuation">)</span>
partitioned <span class="token keyword">by</span> <span class="token punctuation">(</span>city    string<span class="token punctuation">)</span>
<span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="2_40"></a>2、插入数据</h5> 
<pre><code class="prism language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> db_1<span class="token punctuation">.</span>tb_student_2
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_student<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> db_1<span class="token punctuation">.</span>tb_student_2<span class="token punctuation">;</span> 
</code></pre> 
<p><img src="https://images2.imgbox.com/3c/b3/oOmwjyeH_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="3_47"></a>3、按条件覆写</h5> 
<pre><code class="prism language-sql"><span class="token keyword">insert</span> overwrite <span class="token keyword">table</span> db_1<span class="token punctuation">.</span>tb_student_2
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_student
<span class="token keyword">where</span> id<span class="token operator">&gt;=</span><span class="token number">6</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/49/48/PJbZrDou_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_55"></a>四、分区表应用</h3> 
<h5><a id="1_56"></a>1、全部插入</h5> 
<pre><code class="prism language-sql"><span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">.</span>dynamic<span class="token punctuation">.</span><span class="token keyword">partition</span><span class="token punctuation">.</span><span class="token keyword">mode</span><span class="token operator">=</span>nonstrict<span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> db_1<span class="token punctuation">.</span>tb_student_3_part <span class="token keyword">partition</span><span class="token punctuation">(</span>city<span class="token punctuation">)</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_student
<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_student_3_part<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/92/44/MBlNKuOI_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="2_65"></a>2、部分插入</h5> 
<pre><code class="prism language-sql"><span class="token keyword">insert</span> overwrite <span class="token keyword">table</span> db_1<span class="token punctuation">.</span>tb_student_3_part <span class="token keyword">partition</span><span class="token punctuation">(</span>city<span class="token punctuation">)</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_student <span class="token keyword">where</span> id <span class="token operator">between</span> <span class="token number">6</span> <span class="token operator">and</span> <span class="token number">8</span>
<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_student_3_part<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d8/a0/XYYgN3nT_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_73"></a>五、总结</h3> 
<p>1、对于分区表，insert overwrite table 操作会覆盖指定分区的数据，而不会影响其他分区的数据。只有指定的分区会被更新或替换。这样可以实现更精细和高效的数据管理。<br> 2、而对于普通表（即非分区表），insert overwrite table 操作将完全覆盖表中的所有数据，不考虑任何分区。所有的数据将被删除，并被新插入的数据替换。<br> 3、因此，分区表和普通表在 insert overwrite table 操作上的区别在于操作的粒度。分区表仅覆盖指定分区的数据，而普通表覆盖整个表的数据。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dd0e8c14ccbb99f75a61659f99532b9e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python pytorch-GPU 环境搭建 (CUDA 11.2)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f6b60b291ddbd78691318abf3b4d627e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Stable Diffuse AI 绘画 之 ControlNet 插件及其对应模型的下载安装</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>