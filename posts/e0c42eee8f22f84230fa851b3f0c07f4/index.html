<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>如何申请文心一言&amp;文心千帆大模型API调用资格、获取access_token，并使用SpringBoot接入文心一言API - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/e0c42eee8f22f84230fa851b3f0c07f4/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="如何申请文心一言&文心千帆大模型API调用资格、获取access_token，并使用SpringBoot接入文心一言API">
  <meta property="og:description" content="前段时间，百度文心一言&amp;文心千帆大模型开放了API调用的测试，接下来，教大家申请测试资格并接入文心千帆大模型的API。
一、文心一言&amp;文心千帆的测试资格申请 1. 确保拥有一个百度智能云的账号 右上角点击注册，内容如实填写并完成实名认证。
注册与认证详细内容不再赘述。
2. 文心千帆大模型资格申请 进入文心一言&amp;文心千帆大模型介绍页，点击申请体验
会进入填写问卷页，没有什么技巧，如实填写问卷信息即可，记得每一项要尽量详细，然后点击提交，接下来等待即可。
已经申请通过的会显示我这个页面。
不出意外的话，接下来一天两天内你会收到如下短信
收到信息代表你申请通过，并且会赠送一张20的券，可根据文档自行使用。
3.（可选，非必要）文心千帆控制台 在这里你可以进行模型的体验与参数调节，具体功能请各位自行摸索。
二、获取文心千帆的access_token 众所都周知，百度的文心千帆大模型是通过access_key进行鉴权的，所以我们要调用API必须要申请一个access_key。
1.创建应用，获取API Key与Secret Key 进入文心千帆大模型控制台，点击创建应用。
填写你要创建的应用信息，最下面还有个应用介绍，如实填写就好。
创建成功后，左侧选择应用列表，里面可以看到刚刚创建的应用，里面包含了AppID、API Key、Secret Key（需点击显示），这些请务必不要泄露。
我们需要API Key、Secret Key
2. 获取access_token 方法一：浏览器发送请求 复制这两个Key，并替换下面链接的 [API Key] 与 [Secret Key] https://aip.baidubce.com/oauth/2.0/token?grant_type=client_credentials&amp;client_id=[API Key]&amp;client_secret=[Secret Key]
例如：
https://aip.baidubce.com/oauth/2.0/token?grant_type=client_credentials&amp;client_id=ad456sa4d5fhr5kfh&amp;client_secret=df45d14g5xsdtsc
浏览器访问这个链接，你会得到一个json报文
我们需要关心的是这两个键值对， expires_in 与 access_token expires_in：Access Token的有效期(秒为单位，默认有效期30天)
access_token：要获取的Access Token；
方法二：百度在线调试工具 在线调试工具
左侧输入 API Key 与 Secret Key ，点击调试即可，参数与方法一一致。
方法三：编写发送请求 在线调试工具
这里面有每种语言的例程，可以直接复制修改。
三、接入文心一言API 官方文档
官方文档提供了四个模型，其中ErnieBot就是我们熟悉的文心一言，我们以这个为例，其他的与之类似或相同。
作为Java程序员，我就分别以一个 Java 程序和 SpringBoot 应用为例介绍怎么接入。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-08-06T19:29:03+08:00">
    <meta property="article:modified_time" content="2023-08-06T19:29:03+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">如何申请文心一言&amp;文心千帆大模型API调用资格、获取access_token，并使用SpringBoot接入文心一言API</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>前段时间，百度文心一言&amp;文心千帆大模型开放了API调用的测试，接下来，教大家申请测试资格并接入文心千帆大模型的API。</p> 
<p></p> 
<h2>一、文心一言&amp;文心千帆的测试资格申请</h2> 
<h3>1. 确保拥有一个<a class="link-info" href="https://cloud.baidu.com/" rel="nofollow" title="百度智能云">百度智能云</a>的账号</h3> 
<p><img alt="" height="743" src="https://images2.imgbox.com/ce/15/wDXAX22V_o.png" width="1200">右上角点击注册，内容如实填写并完成实名认证。</p> 
<p><img alt="" height="1050" src="https://images2.imgbox.com/47/0f/PNa85bdz_o.png" width="1200"></p> 
<p> 注册与认证详细内容不再赘述。</p> 
<h3>2. 文心千帆大模型资格申请</h3> 
<p>进入<a class="link-info" href="https://cloud.baidu.com/product/wenxinworkshop" rel="nofollow" title="文心一言&amp;文心千帆大模型">文心一言&amp;文心千帆大模型</a>介绍页，点击申请体验</p> 
<p><img alt="" height="1107" src="https://images2.imgbox.com/98/0f/tp9y1K2r_o.png" width="1200"></p> 
<p>会进入填写问卷页，没有什么技巧，如实填写问卷信息即可，记得每一项要尽量详细，然后点击提交，接下来等待即可。</p> 
<p>已经申请通过的会显示我这个页面。</p> 
<p><img alt="" height="1115" src="https://images2.imgbox.com/0d/90/4sHWcNic_o.png" width="1200"></p> 
<p> 不出意外的话，接下来一天两天内你会收到如下短信</p> 
<p><img alt="" height="224" src="https://images2.imgbox.com/cf/04/6HBShL8Y_o.png" width="231"></p> 
<p>收到信息代表你申请通过，并且会赠送一张20的券，可根据文档自行使用。</p> 
<h3>3.（可选，非必要）文心千帆控制台</h3> 
<p><img alt="" height="991" src="https://images2.imgbox.com/70/6c/Wob5fclE_o.png" width="1200"></p> 
<p> <img alt="" height="1200" src="https://images2.imgbox.com/36/e2/bcBnrV2i_o.png" width="1200"></p> 
<p>在这里你可以进行模型的体验与参数调节，具体功能请各位自行摸索。</p> 
<h2>二、获取文心千帆的access_token</h2> 
<p>众所都周知，百度的文心千帆大模型是通过access_key进行鉴权的，所以我们要调用API必须要申请一个access_key。</p> 
<h3>1.创建应用，获取API Key与Secret Key</h3> 
<p> 进入<a class="link-info" href="https://console.bce.baidu.com/ai/#/ai/wenxinworkshop/overview/index" rel="nofollow" title="文心千帆大模型控制台">文心千帆大模型控制台</a>，点击创建应用。</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/58/54/zCI91tux_o.png" width="1200"></p> 
<p>填写你要创建的应用信息，最下面还有个应用介绍，如实填写就好。</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/bc/3d/XJSSIyqI_o.png" width="1200"></p> 
<p> 创建成功后，左侧选择应用列表，里面可以看到刚刚创建的应用，里面包含了AppID、API Key、Secret Key（需点击显示），这些请务必不要泄露。</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/bb/8b/czlR2Fxj_o.png" width="1200"></p> 
<p> 我们需要API Key、Secret Key</p> 
<h3>2. 获取access_token</h3> 
<h4><strong>方法一：浏览器发送请求</strong></h4> 
<p>复制这两个Key，并替换下面链接的 [API Key] 与 [Secret Key] </p> 
<blockquote> 
 <p>https://aip.baidubce.com/oauth/2.0/token?grant_type=client_credentials&amp;client_id=[API Key]&amp;client_secret=[Secret Key]</p> 
</blockquote> 
<p>例如：</p> 
<blockquote> 
 <p>https://aip.baidubce.com/oauth/2.0/token?grant_type=client_credentials&amp;client_id=ad456sa4d5fhr5kfh&amp;client_secret=df45d14g5xsdtsc</p> 
</blockquote> 
<p>浏览器访问这个链接，你会得到一个json报文</p> 
<p><img alt="" height="330" src="https://images2.imgbox.com/7d/71/XC7VzY9W_o.png" width="1200">我们需要关心的是这两个键值对， expires_in 与 access_token </p> 
<p><strong>expires_in</strong>：Access Token的有效期(秒为单位，默认有效期30天)</p> 
<p><strong>access_token</strong>：要获取的Access Token；</p> 
<p></p> 
<h4>方法二：百度在线调试工具</h4> 
<p><a class="link-info" href="https://console.bce.baidu.com/tools/#/api?product=AI&amp;project=%E6%96%87%E5%BF%83%E5%8D%83%E5%B8%86%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%B9%B3%E5%8F%B0&amp;parent=%E9%89%B4%E6%9D%83%E8%AE%A4%E8%AF%81%E6%9C%BA%E5%88%B6&amp;api=oauth%2F2.0%2Ftoken&amp;method=post" rel="nofollow" title="在线调试工具">在线调试工具</a></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/30/57/472bF9Gi_o.png" width="1200"></p> 
<p>左侧输入 API Key 与 Secret Key ，点击调试即可，参数与方法一一致。</p> 
<p></p> 
<h4>方法三：编写发送请求</h4> 
<p><a class="link-info" href="https://console.bce.baidu.com/tools/#/api?product=AI&amp;project=%E6%96%87%E5%BF%83%E5%8D%83%E5%B8%86%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%B9%B3%E5%8F%B0&amp;parent=%E9%89%B4%E6%9D%83%E8%AE%A4%E8%AF%81%E6%9C%BA%E5%88%B6&amp;api=oauth%2F2.0%2Ftoken&amp;method=post" rel="nofollow" title="在线调试工具">在线调试工具</a></p> 
<p>这里面有每种语言的例程，可以直接复制修改。</p> 
<p></p> 
<h2>三、接入文心一言API</h2> 
<p><a class="link-info" href="https://cloud.baidu.com/doc/WENXINWORKSHOP/s/jlil56u11" rel="nofollow" title="官方文档">官方文档</a></p> 
<p>官方文档提供了四个模型，其中ErnieBot就是我们熟悉的文心一言，我们以这个为例，其他的与之类似或相同。</p> 
<p>作为Java程序员，我就分别以一个 Java 程序和 SpringBoot 应用为例介绍怎么接入。</p> 
<p></p> 
<h3>方法一：原生接入（不推荐）</h3> 
<p>按照官方文档，使用Hutool的HttpUtils工具类或者是其他的Http客户端接入，这样可以获得最大的自由度，但是即为麻烦，并且流式返回处理较为复杂，需使用Flux响应式来做，比较麻烦，我用一个原生Java程序演示一下：</p> 
<pre><code class="language-java">public static void main(String[] args) {
        String url = "https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions";
        String accessToken = "你的access_token";

        HashMap&lt;String, String&gt; msg = new HashMap&lt;&gt;();
        msg.put("role", "user");
        msg.put("content", "请介绍一下你自己");

        ArrayList&lt;HashMap&gt; messages = new ArrayList&lt;&gt;();
        messages.add(msg);

        HashMap&lt;String, Object&gt; requestBody = new HashMap&lt;&gt;();
        requestBody.put("messages", messages);

        String response = HttpUtil.post(url + "?access_token=" + accessToken, JSONUtil.toJsonStr(requestBody));

        System.out.println(response);
    }</code></pre> 
<p>输出内容：</p> 
<pre><code class="language-java">{
    "id": "as-mibg24yygj",
    "object": "chat.completion",
    "created": 1690270732,
    "result": "您好，我是文心一言，英文名是ERNIE Bot。我能够与人对话互动，回答问题，协助创作，高效便捷地帮助人们获取信息、知识和灵感。",
    "is_truncated": false,
    "need_clear_history": false,
    "usage": {
        "prompt_tokens": 8,
        "completion_tokens": 49,
        "total_tokens": 57
    }
}</code></pre> 
<p></p> 
<h3> 方法二：使用现成的spring-boot-starter</h3> 
<p></p> 
<p><strong>项目开源地址：<a class="link-info" href="https://github.com/gemingjia/gear-wenxinworkshop-starter" title="https://github.com/gemingjia/gear-wenxinworkshop-starter">https://github.com/gemingjia/gear-wenxinworkshop-starter</a></strong></p> 
<p></p> 
<p>1. 创建一个 SpringBoot 应用程序（建议选择JDK17）。 </p> 
<p>2. 引入maven坐标：</p> 
<pre><code class="language-XML">&lt;dependency&gt;
  &lt;groupId&gt;io.github.gemingjia&lt;/groupId&gt;
  &lt;artifactId&gt;gear-wenxinworkshop-starter&lt;/artifactId&gt;
  &lt;version&gt;0.0.6&lt;/version&gt;
&lt;/dependency&gt;</code></pre> 
<p>3. 新建一个Controller</p> 
<pre><code class="language-java">@RestController
public class ChatController {

    // 要调用的模型的客户端
    @Resource
    private ErnieBotClient ernieBotClient;

    // 单次对话
    @PostMapping("/chat")
    public BaseResponse&lt;String&gt; chatSingle(String msg) {
        ChatResponse response = ernieBotClient.chatSingle(msg);
        return BaseResponse.success(response.getResult());
    }

    // 连续对话
    @PostMapping("/chats")
    public BaseResponse&lt;String&gt; chatCont(String msg) {
        String chatUID = "test-user-1001";
        ChatResponse response = ernieBotClient.chatCont(msg, chatUID);
        return BaseResponse.success(response.getResult());
    }

    // 流式返回,单次对话
    @PostMapping(value = "/stream/chat", produces = MediaType.TEXT_EVENT_STREAM_VALUE)
    public Flux&lt;ChatResponse&gt; chatSingleStream(String msg) {
        Flux&lt;ChatResponse&gt; chatResponseFlux = ernieBotClient.chatSingleOfStream(msg);
        return chatResponseFlux;
    }

    // 流式返回,连续对话
    @PostMapping(value = "/stream/chats", produces = MediaType.TEXT_EVENT_STREAM_VALUE)
    public Flux&lt;ChatResponse&gt; chatContStream(String msg, String msgUid) {
        Flux&lt;ChatResponse&gt; chatResponseFlux = ernieBotClient.chatContOfStream(msg, msgUid);
        return chatResponseFlux;
    }

}</code></pre> 
<pre><code class="language-java">@Data
public class BaseResponse&lt;T&gt; implements Serializable {

    private int code;

    private T data;

    private String message;

    public static &lt;T&gt; BaseResponse&lt;T&gt; success(T data) {
        BaseResponse&lt;T&gt; resp = new BaseResponse&lt;&gt;();
        resp.setData(data);
        resp.setCode(HttpStatus.OK.value());
        return resp;
    }
    
    public static &lt;T&gt; BaseResponse&lt;T&gt; error(int errorCode, String message) {
        BaseResponse&lt;T&gt; resp = new BaseResponse&lt;&gt;();
        resp.setCode(errorCode);
        resp.setMessage(message);
        return resp;
    }

}</code></pre> 
<p>4. 运行起来，发送请求试一下</p> 
<p><img alt="" height="363" src="https://images2.imgbox.com/32/b1/SnYOgrST_o.png" width="583"></p> 
<p>这是ErnieBot模型的演示，此外starter还提供了ErnieBotClient、ErnieBotTurboClient、Bloomz7BClient 三中模型的客户端，可自行选择使用。</p> 
<p></p> 
<p>如果这个starter帮助您节省了一部分的时间，还请点个star哦~</p> 
<p> <strong>项目开源地址&amp;文档：<a class="link-info" href="https://github.com/gemingjia/gear-wenxinworkshop-starter" title="https://github.com/gemingjia/gear-wenxinworkshop-starter">https://github.com/gemingjia/gear-wenxinworkshop-starter</a></strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ac743ff9b4182e920a803215746f21e9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">（C语言版）力扣（LeetCode）题库1-5题解析</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5f7015d642c8a0b4ddfb854d9734ec71/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python中第三方库——lxml库的最新详细安装教程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>