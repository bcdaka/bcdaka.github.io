<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>.NET 一些常用的类型转换扩展 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/61e629462b62004d1769b353c166acd7/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content=".NET 一些常用的类型转换扩展">
  <meta property="og:description" content="#region 转换为string
/// &lt;summary&gt;
/// 将object转换为string，若转换失败，则返回&#34;&#34;。不抛出异常。 /// &lt;/summary&gt;
/// &lt;param name=&#34;obj&#34;&gt;&lt;/param&gt;
/// &lt;returns&gt;&lt;/returns&gt;
public static string ParseToString(this object obj)
{
return Convert.ToString(obj) ?? string.Empty;
}
#endregion
#region 转换为long
/// &lt;summary&gt;
/// 将object转换为long，若转换失败，则返回0。不抛出异常。 /// &lt;/summary&gt;
/// &lt;param name=&#34;obj&#34;&gt;&lt;/param&gt;
/// &lt;returns&gt;&lt;/returns&gt;
public static long ParseToLong(this object obj)
{
if (obj == null)
{
return 0;
}
else
{
bool boolean = long.TryParse(obj.ToString() ?? string.Empty, out long result);
return result;
}
}">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-21T14:00:30+08:00">
    <meta property="article:modified_time" content="2024-06-21T14:00:30+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">.NET 一些常用的类型转换扩展</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>#region 转换为string<br>         /// &lt;summary&gt;<br>         /// 将object转换为string，若转换失败，则返回""。不抛出异常。  <br>         /// &lt;/summary&gt;<br>         /// &lt;param name="obj"&gt;&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public static string ParseToString(this object obj)<br>         {<!-- --><br>             return Convert.ToString(obj) ?? string.Empty;<br>         }<br>         #endregion</p> 
<p>        #region 转换为long<br>         /// &lt;summary&gt;<br>         /// 将object转换为long，若转换失败，则返回0。不抛出异常。  <br>         /// &lt;/summary&gt;<br>         /// &lt;param name="obj"&gt;&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public static long ParseToLong(this object obj)<br>         {<!-- --><br>             if (obj == null)<br>             {<!-- --><br>                 return 0;<br>             }<br>             else<br>             {<!-- --><br>                 bool boolean = long.TryParse(obj.ToString() ?? string.Empty, out long result);<br>                 return result;<br>             }<br>         }</p> 
<p>        /// &lt;summary&gt;<br>         /// 将object转换为long，若转换失败，则返回指定值。不抛出异常。  <br>         /// &lt;/summary&gt;<br>         /// &lt;param name="obj"&gt;&lt;/param&gt;<br>         /// &lt;param name="defaultValue"&gt;&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public static long ParseToLong(this object obj, long defaultValue)<br>         {<!-- --><br>             if (obj == null)<br>             {<!-- --><br>                 return defaultValue;<br>             }<br>             else<br>             {<!-- --><br>                 bool boolean = long.TryParse(obj.ToString() ?? string.Empty, out long result);<br>                 if (boolean)<br>                     return result;<br>                 else<br>                     return defaultValue;<br>             }<br>         }</p> 
<p>        #endregion</p> 
<p>        #region 转换为int<br>         /// &lt;summary&gt;<br>         /// 将object转换为int，若转换失败，则返回0。不抛出异常。  <br>         /// &lt;/summary&gt;<br>         /// &lt;param name="obj"&gt;&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public static int ParseToInt(this object obj)<br>         {<!-- --><br>             if (obj == null)<br>             {<!-- --><br>                 return 0;<br>             }<br>             else<br>             {<!-- --><br>                 bool boolean = int.TryParse(obj.ToString() ?? string.Empty, out int result);<br>                 return result;<br>             }<br>         }</p> 
<p>        /// &lt;summary&gt;<br>         /// 将object转换为int，若转换失败，则返回指定值。不抛出异常。 <br>         /// null返回默认值<br>         /// &lt;/summary&gt;<br>         /// &lt;param name="obj"&gt;&lt;/param&gt;<br>         /// &lt;param name="defaultValue"&gt;&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public static int ParseToInt(this object obj, int defaultValue)<br>         {<!-- --><br>             if (obj == null)<br>             {<!-- --><br>                 return defaultValue;<br>             }<br>             else<br>             {<!-- --><br>                 bool boolean = int.TryParse(obj.ToString() ?? string.Empty, out int result);<br>                 if (boolean)<br>                     return result;<br>                 else<br>                     return defaultValue;<br>             }<br>         }</p> 
<p>        #endregion</p> 
<p>        #region 转换为double</p> 
<p>        /// &lt;summary&gt;<br>         /// 将object转换为double，若转换失败，则返回0。不抛出异常。  <br>         /// &lt;/summary&gt;<br>         /// &lt;param name="obj"&gt;&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public static double ParseToDouble(this object obj)<br>         {<!-- --></p> 
<p>            if (obj == null)<br>             {<!-- --><br>                 return 0;<br>             }<br>             else<br>             {<!-- --><br>                 bool boolean = double.TryParse(obj.ToString() ?? string.Empty, out double result);<br>                 return result;<br>             }<br>         }</p> 
<p>        /// &lt;summary&gt;<br>         /// 将object转换为double，若转换失败，则返回指定值。不抛出异常。  <br>         /// &lt;/summary&gt;<br>         /// &lt;param name="obj"&gt;&lt;/param&gt;<br>         /// &lt;param name="defaultValue"&gt;&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public static double ParseToDouble(this object obj, double defaultValue)<br>         {<!-- --><br>             if (obj == null)<br>             {<!-- --><br>                 return defaultValue;<br>             }<br>             else<br>             {<!-- --><br>                 bool boolean = double.TryParse(obj.ToString() ?? string.Empty, out double result);<br>                 if (boolean)<br>                     return result;<br>                 else<br>                     return defaultValue;<br>             }<br>         }</p> 
<p>        #endregion</p> 
<p>        #region 转换为demical<br>         /// &lt;summary&gt;<br>         /// 将object转换为demical，若转换失败，则返回0。不抛出异常。  <br>         /// &lt;/summary&gt;<br>         /// &lt;param name="obj"&gt;&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public static decimal ParseToDecimal(this object obj)<br>         {<!-- --><br>             if (obj == null)<br>             {<!-- --><br>                 return 0;<br>             }<br>             else<br>             {<!-- --><br>                 bool boolean = decimal.TryParse(obj.ToString() ?? string.Empty, out decimal result);<br>                 return result;<br>             }<br>         }</p> 
<p>        /// &lt;summary&gt;<br>         /// 将object转换为demical，若转换失败，则返回指定值。不抛出异常。  <br>         /// &lt;/summary&gt;<br>         /// &lt;param name="obj"&gt;&lt;/param&gt;<br>         /// &lt;param name="defaultValue"&gt;&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public static decimal ParseToDecimal(this object obj, decimal defaultValue)<br>         {<!-- --><br>             if (obj == null)<br>             {<!-- --><br>                 return defaultValue;<br>             }<br>             else<br>             {<!-- --><br>                 bool boolean = decimal.TryParse(obj.ToString() ?? string.Empty, out decimal result);<br>                 if (boolean)<br>                     return result;<br>                 else<br>                     return defaultValue;<br>             }<br>         }<br>         #endregion</p> 
<p>        #region 转化为bool<br>         /// &lt;summary&gt;<br>         /// 将object转换为bool，若转换失败，则返回false。不抛出异常。  <br>         /// &lt;/summary&gt;<br>         /// &lt;param name="obj"&gt;&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public static bool ParseToBool(this object obj)<br>         {<!-- --><br>             if (obj == null)<br>             {<!-- --><br>                 return false;<br>             }<br>             else<br>             {<!-- --><br>                 bool boolean = bool.TryParse(obj.ToString() ?? string.Empty, out bool result);<br>                 return result;<br>             }<br>         }</p> 
<p>        /// &lt;summary&gt;<br>         /// 将object转换为bool，若转换失败，则返回指定值。不抛出异常。  <br>         /// &lt;/summary&gt;<br>         /// &lt;param name="obj"&gt;&lt;/param&gt;<br>         /// &lt;param name="defaultValue"&gt;&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public static bool ParseToBool(this object obj, bool defaultValue)<br>         {<!-- --><br>             if (obj == null)<br>             {<!-- --><br>                 return defaultValue;<br>             }<br>             else<br>             {<!-- --><br>                 bool boolean = bool.TryParse(obj.ToString() ?? string.Empty, out bool result);<br>                 if (boolean)<br>                     return result;<br>                 else<br>                     return defaultValue;<br>             }<br>         }</p> 
<p>        #endregion</p> 
<p>        #region 时间与时间戳转换<br>         /// &lt;summary&gt;<br>         /// 时间转换为毫秒时间戳<br>         /// &lt;/summary&gt;<br>         /// &lt;param name="nowTime"&gt;&lt;/param&gt;<br>         /// &lt;returns&gt;时间戳(毫秒)&lt;/returns&gt;<br>         public static long ParseToUnixTime(this DateTime nowTime)<br>         {<!-- --><br>             var startTime = new DateTime(1970, 1, 1, 0, 0, 0, 0);<br>             return (long)Math.Round((nowTime - startTime).TotalMilliseconds, MidpointRounding.AwayFromZero);<br>         }</p> 
<p>        #endregion</p> 
<p>        #region 删除最后一个字符之后的字符<br>         /// &lt;summary&gt;<br>         /// 删除最后结尾的一个逗号<br>         /// &lt;/summary&gt;<br>         public static string DelLastComma(string str)<br>         {<!-- --><br>             return str.Substring(0, str.LastIndexOf(","));<br>         }<br>         /// &lt;summary&gt;<br>         /// 删除最后结尾的指定字符后的字符<br>         /// &lt;/summary&gt;<br>         public static string DelLastChar(string str, string strchar)<br>         {<!-- --><br>             return str.Substring(0, str.LastIndexOf(strchar));<br>         }<br>         /// &lt;summary&gt;<br>         /// 删除最后结尾的长度<br>         /// &lt;/summary&gt;<br>         /// &lt;param name="str"&gt;&lt;/param&gt;<br>         /// &lt;param name="Length"&gt;&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public static string DelLastLength(string str, int Length)<br>         {<!-- --><br>             if (string.IsNullOrEmpty(str))<br>                 return "";<br>             str = str.Substring(0, str.Length - Length);<br>             return str;<br>         }<br>         #endregion</p> 
<p>        #region 强制转换类型<br>         /// &lt;summary&gt;<br>         /// 强制转换类型<br>         /// &lt;/summary&gt;<br>         /// &lt;typeparam name="TResult"&gt;&lt;/typeparam&gt;<br>         /// &lt;param name="source"&gt;&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public static IEnumerable&lt;TResult&gt; CastSuper&lt;TResult&gt;(this IEnumerable source)<br>         {<!-- --><br>             return from object item in source select (TResult)Convert.ChangeType(item, typeof(TResult));<br>         }</p> 
<p>        #endregion</p> 
<p>        #region List转DataTable<br>         /// &lt;summary&gt;<br>         /// List转DataTable<br>         /// &lt;/summary&gt;<br>         /// &lt;typeparam name="T"&gt;&lt;/typeparam&gt;<br>         /// &lt;param name="list"&gt;&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public static DataTable ListToDataTable&lt;T&gt;(IEnumerable&lt;T&gt; list)<br>         {<!-- --><br>             //创建属性的集合 <br>             List&lt;PropertyInfo&gt; pList = new List&lt;PropertyInfo&gt;();<br>             //获得反射的入口 <br>             Type type = typeof(T);<br>             DataTable dt = new DataTable();<br>             //把所有的public属性加入到集合 并添加DataTable的列 <br>             Array.ForEach&lt;PropertyInfo&gt;(type.GetProperties(), p =&gt;<br>             {<!-- --><br>                 pList.Add(p);<br>                 var theType = p.PropertyType;<br>                 //处理可空类型<br>                 if (theType.IsGenericType &amp;&amp; theType.GetGenericTypeDefinition().Equals(typeof(Nullable&lt;&gt;)))<br>                 {<!-- --><br>                     dt.Columns.Add(p.Name, Nullable.GetUnderlyingType(theType));<br>                 }<br>                 else<br>                 {<!-- --><br>                     dt.Columns.Add(p.Name, theType);<br>                 }<br>             });<br>             foreach (var item in list)<br>             {<!-- --><br>                 //创建一个DataRow实例 <br>                 DataRow row = dt.NewRow();<br>                 //给row 赋值 <br>                 pList.ForEach(p =&gt;<br>                 {<!-- --><br>                     var v = p.GetValue(item, null);<br>                     row[p.Name] = v == null ? DBNull.Value : v;<br>                 });<br>                 //加入到DataTable <br>                 dt.Rows.Add(row);<br>             }<br>             return dt;<br>         }</p> 
<p><br>         /// &lt;summary&gt;<br>         /// List转DataTable<br>         /// &lt;/summary&gt;<br>         /// &lt;param name="list"&gt;&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public static DataTable ListToDataTableNew(List&lt;dynamic&gt; list)<br>         {<!-- --><br>             Dictionary&lt;string, string&gt; dic = new Dictionary&lt;string, string&gt;();<br>             DataTable dt = new DataTable();<br>             if (list != null &amp;&amp; list.Count &gt; 0)<br>             {<!-- --><br>                 foreach (var item in list[0])<br>                 {<!-- --><br>                     string text = item.ToString();<br>                     string key = text.Substring(1, text.IndexOf(',') - 1);<br>                     string value = text.Substring(text.IndexOf(',') + 1, text.Length - text.IndexOf(',') - 2);<br>                     dt.Columns.Add(key);<br>                 }<br>             }<br>             foreach (var vlist in list)<br>             {<!-- --><br>                 DataRow row = dt.NewRow();<br>                 foreach (var item in vlist)<br>                 {<!-- --><br>                     string text = item.ToString();<br>                     string key = text.Substring(1, text.IndexOf(',') - 1);<br>                     string value = text.Substring(text.IndexOf(',') + 1, text.Length - text.IndexOf(',') - 2);<br>                     //创建一个DataRow实例 <br>                     row[key] = value;<br>                 }<br>                 //加入到DataTable <br>                 dt.Rows.Add(row);<br>             }<br>             return dt;<br>         }<br>         #endregion</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f27a180e04023464952ee1b7728c917a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">计算机必背单词——算法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/23c5f3f12c9fcdcc2bd19e3ce4dfcd09/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">线性代数|机器学习-P16矩阵A的导数</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>