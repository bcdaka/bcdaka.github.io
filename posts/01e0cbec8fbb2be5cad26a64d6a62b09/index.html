<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>gitee提交代码触发Jenkins自动构建--解决jenkins运行在windows系统localhost上，gitee添加不了webHook的问题（内网穿透） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/01e0cbec8fbb2be5cad26a64d6a62b09/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="gitee提交代码触发Jenkins自动构建--解决jenkins运行在windows系统localhost上，gitee添加不了webHook的问题（内网穿透）">
  <meta property="og:description" content="一、安装Jenkins
在Jenkins官网下载Jenkins 2.401.3版本！
注：只有2.401.3以上版本的Jenkins才支持gitee插件，2.346长期支持版本不行！
二、JAVA环境
Jenkins 2.401.3对应的JAVA环境是jdk17，请在本地下载jdk17并配置好环境变量，在cmd窗口中使用java -version命令可以看到 java version &#34;17.0.10&#34;即可。
三、Jenkins配置
1.打开Jenkins
在下载好的Jenkins的war包位置，打开cmd，用java -jar jenkins.war --httpPort=8899启动Jenkins
注：命令中的&#34;jenkins.war&#34;改成自己war包的名字，可能会带有版本号。
2.jenkins持续集成的操作以及本地的插件包的下载导入可以参考曹红杏老师的博客
一个springboot项目的jenkins持续集成配置_springboot集成jenkins-CSDN博客
注：老师给的插件导入到Jenkins 2.401版本里面可以使用，没有不兼容问题。
三、重点：安装gitee插件
1.点击Dashboard-&gt;Manage Jenkins
2.往下滑！找到System Configuration-&gt;Plugins
3.下载gitee插件
四、创建持续集成任务
同样请参考一个springboot项目的jenkins持续集成配置_springboot集成jenkins-CSDN博客
五、jenkins中Gitee webhook 设置
1.创建持续集成任务完成之后或者在创建的过程中，在构建触发器模块，我们可以看到有一个Gitee webhook 触发构建选项，勾选它!
注：请记住上图红框里面的URL地址，后面要考，这个地址和第七步的内网穿透有关系！！！
2.其他设置不用动，往下滑，找到Gitee WebHook 密码
3.点击生成按钮，生成 Gitee WebHook密码
注：这个密码等下也要用到！！
六、配置Gitee WebHook
1.打开你们的gitee仓库地址，这里我以我的学生宿舍管理系统仓库为例，点击管理
2.往下滑，找到WebHooks，点击右上角的添加webHook
3.填写URL和WebHook密码，点击添加，这里的URL和WebHook密码应该和上面第五步1.3.中框出来的一致
4.点击添加，发现添加不了
这是为什么呢？原因是这个地址是localhost也就是电脑本地的地址，gitee无法直接通过这个地址向你的Jenkins发送post请求，让Jenkins自动构建！
解决方法
用一个外网可以访问到的地址来代替这个地址里面的localhost:8899，如何实现呢，这就要引出内网穿透了！
七、内网穿透
市面上主流的内网穿透软件很多都是要收费的，如果需求不大，跟我一样只是为了完成课程作业，可以下载以下这个内网穿透软件，它可以提供免费服务！
Natapp
项目主页：natapp.cn
项目介绍：基于ngrok的国内的内网穿透工具，类似花生壳，有免费版本，比花生壳好。免费版本：提供http,https,tcp全隧道穿透，随机域名/TCP端口，不定时强制更换域名/端口，自定义本地端口。收费版本也就几元每月。
1.打开上面的官网网址，点击右上角的免费注册，注册一个账号
注：后面需要身份证实名！
2.注册登录后，购买一个免费隧道
3.填入端口，然后购买
4.点击右上角的客户端下载，下载natapp
5.根据你自己的电脑下载，我下的是Windows 64位的
6.下载配置文件
①点击右上角的教程/文档
②点击使用本地配置文件config.ini
③点击下载windows版本">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-22T17:30:53+08:00">
    <meta property="article:modified_time" content="2024-06-22T17:30:53+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">gitee提交代码触发Jenkins自动构建--解决jenkins运行在windows系统localhost上，gitee添加不了webHook的问题（内网穿透）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>一、安装Jenkins</p> 
<p>在Jenkins官网下载Jenkins 2.401.3版本！<br> 注：只有2.401.3以上版本的Jenkins才支持gitee插件，2.346长期支持版本不行！</p> 
<p>二、JAVA环境</p> 
<p>Jenkins 2.401.3对应的JAVA环境是jdk17，请在本地下载jdk17并配置好环境变量，在cmd窗口中使用java -version命令可以看到 java version "17.0.10"即可。</p> 
<p><img alt="" height="920" src="https://images2.imgbox.com/34/d2/Qb8YbkOb_o.png" width="1200"></p> 
<p>三、Jenkins配置<br> 1.打开Jenkins</p> 
<p>在下载好的Jenkins的war包位置，打开cmd，用java -jar jenkins.war --httpPort=8899启动Jenkins</p> 
<p>注：命令中的"jenkins.war"改成自己war包的名字，可能会带有版本号。<br><img alt="" height="1200" src="https://images2.imgbox.com/50/e1/rcTLCoF6_o.png" width="1200"></p> 
<p>2.jenkins持续集成的操作以及本地的插件包的下载导入可以参考曹红杏老师的博客<br><a href="https://blog.csdn.net/caohongxing/article/details/131264494?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522171885119116800188572016%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=171885119116800188572016&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-1-131264494-null-null.nonecase&amp;utm_term=jenkins&amp;spm=1018.2226.3001.4450" title="一个springboot项目的jenkins持续集成配置_springboot集成jenkins-CSDN博客">一个springboot项目的jenkins持续集成配置_springboot集成jenkins-CSDN博客</a><br><br> 注：老师给的插件导入到Jenkins 2.401版本里面可以使用，没有不兼容问题。</p> 
<p>三、重点：安装gitee插件</p> 
<p>1.点击Dashboard-&gt;Manage Jenkins</p> 
<p><img alt="" height="860" src="https://images2.imgbox.com/6c/e2/DWbXt8CT_o.png" width="1200"></p> 
<p>2.往下滑！找到System Configuration-&gt;Plugins<br><img alt="" height="1200" src="https://images2.imgbox.com/c5/3e/kGhCevqW_o.png" width="1200"></p> 
<p></p> 
<p>3.下载gitee插件</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/0e/89/qDMdjqDT_o.png" width="1200"></p> 
<p></p> 
<p>四、创建持续集成任务</p> 
<p>同样请参考<a href="https://blog.csdn.net/caohongxing/article/details/131264494?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522171885119116800188572016%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=171885119116800188572016&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-1-131264494-null-null.nonecase&amp;utm_term=jenkins&amp;spm=1018.2226.3001.4450" title="一个springboot项目的jenkins持续集成配置_springboot集成jenkins-CSDN博客">一个springboot项目的jenkins持续集成配置_springboot集成jenkins-CSDN博客</a></p> 
<p>五、jenkins中Gitee webhook 设置<br><br> 1.创建持续集成任务完成之后或者在创建的过程中，在构建触发器模块，我们可以看到有一个Gitee webhook 触发构建选项，勾选它!<br><img alt="" height="680" src="https://images2.imgbox.com/6e/52/c3RqRqHs_o.png" width="1200"></p> 
<p>注：请记住上图红框里面的URL地址，后面要考，这个地址和第七步的内网穿透有关系！！！</p> 
<p></p> 
<p>2.其他设置不用动，往下滑，找到Gitee WebHook 密码<br><img alt="" height="805" src="https://images2.imgbox.com/e4/5f/ODqla62Q_o.png" width="1200"></p> 
<p>3.点击生成按钮，生成 Gitee WebHook密码</p> 
<p><img alt="" height="841" src="https://images2.imgbox.com/0e/fa/P2zxLsol_o.png" width="1200"></p> 
<p></p> 
<p>注：这个密码等下也要用到！！</p> 
<p></p> 
<p>六、配置Gitee WebHook</p> 
<p>1.打开你们的gitee仓库地址，这里我以我的学生宿舍管理系统仓库为例，点击管理</p> 
<p><br><img alt="" height="1200" src="https://images2.imgbox.com/f0/cc/MO9oCZ3b_o.png" width="1200"></p> 
<p></p> 
<p>2.往下滑，找到WebHooks，点击右上角的添加webHook</p> 
<p><img alt="" height="1012" src="https://images2.imgbox.com/7c/a1/oWdO48Cv_o.png" width="1200"></p> 
<p>3.填写URL和WebHook密码，点击添加，这里的URL和WebHook密码应该和上面第五步1.3.中框出来的一致<img alt="" height="1200" src="https://images2.imgbox.com/dc/90/sj2uChnc_o.png" width="1200"></p> 
<p>4.点击添加，发现添加不了</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/a3/cc/UJNLF5Sd_o.png" width="1200"></p> 
<p>这是为什么呢？原因是这个地址是localhost也就是电脑本地的地址，gitee无法直接通过这个地址向你的Jenkins发送post请求，让Jenkins自动构建！<img alt="" height="89" src="https://images2.imgbox.com/a2/1a/VtOE3kQE_o.png" width="1200"></p> 
<p>解决方法<br> 用一个外网可以访问到的地址来代替这个地址里面的localhost:8899，如何实现呢，这就要引出内网穿透了！</p> 
<p>七、内网穿透</p> 
<p>市面上主流的内网穿透软件很多都是要收费的，如果需求不大，跟我一样只是为了完成课程作业，可以下载以下这个内网穿透软件，它可以提供免费服务！</p> 
<p>Natapp<br> 项目主页：natapp.cn</p> 
<p>项目介绍：基于ngrok的国内的内网穿透工具，类似花生壳，有免费版本，比花生壳好。免费版本：提供http,https,tcp全隧道穿透，随机域名/TCP端口，不定时强制更换域名/端口，自定义本地端口。收费版本也就几元每月。</p> 
<p>1.打开上面的官网网址，点击右上角的免费注册，注册一个账号</p> 
<p>注：后面需要身份证实名！<br><br><br><img alt="" height="1200" src="https://images2.imgbox.com/b4/3b/bxDMjIMm_o.png" width="1200"></p> 
<p></p> 
<p>2.注册登录后，购买一个免费隧道</p> 
<p><img alt="" height="1069" src="https://images2.imgbox.com/0b/57/kiwigUJX_o.png" width="1200"></p> 
<p>3.填入端口，然后购买<img alt="" height="1147" src="https://images2.imgbox.com/eb/20/hAwI8RMu_o.png" width="1200"></p> 
<p></p> 
<p>4.点击右上角的客户端下载，下载natapp<br><img alt="" height="936" src="https://images2.imgbox.com/3c/88/NUUNS2Bt_o.png" width="1200"></p> 
<p>5.根据你自己的电脑下载，我下的是Windows 64位的</p> 
<p><img alt="" height="841" src="https://images2.imgbox.com/cc/ab/E9v1uy99_o.png" width="1200"></p> 
<p>6.下载配置文件<br> ①点击右上角的教程/文档</p> 
<p><img alt="" height="1103" src="https://images2.imgbox.com/78/05/w5JmD0Yc_o.png" width="1200">②点击使用本地配置文件config.ini</p> 
<p><img alt="" height="934" src="https://images2.imgbox.com/b8/76/olSmwJn0_o.png" width="1200"></p> 
<p>③点击下载windows版本</p> 
<p><img alt="" height="986" src="https://images2.imgbox.com/74/50/ybPh6yvG_o.png" width="1200"></p> 
<p>④把刚才下载下来的config.ini和natapp.exe解压存放到同一路径下，像下面这样<br><img alt="" height="1082" src="https://images2.imgbox.com/23/b3/UdzGpoq6_o.png" width="1200"></p> 
<p>⑤找到我的隧道这个链接，查看并复制填写参数</p> 
<p><img alt="" height="1127" src="https://images2.imgbox.com/59/51/JDD3r6Qa_o.png" width="1200"></p> 
<p><img alt="" height="896" src="https://images2.imgbox.com/e5/04/KIymoETR_o.png" width="1200"></p> 
<p>记得Ctrl + s 保存<br><br> ⑥运行natapp</p> 
<p><img alt="" height="1036" src="https://images2.imgbox.com/fb/38/EXv3I26B_o.png" width="1200"></p> 
<p></p> 
<p>八、重新配置Gitee WebHook<br><br> 1.回到第六步中gitee配置webhook的界面</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/b6/31/WA2zm5hT_o.png" width="1200"></p> 
<p>2.填写URL和WebHook密码，用刚刚netapp里面的网址代替localhost:8899<br><img alt="" height="1200" src="https://images2.imgbox.com/40/2f/iSjINlZG_o.png" width="1200"></p> 
<p>3.点击添加即可添加成功</p> 
<p></p> 
<p>九、测试</p> 
<p>此时，尝试修改一下代码，往gitee上面推送<br><img alt="" height="741" src="https://images2.imgbox.com/8f/e0/ozR5xLgG_o.png" width="1200"></p> 
<p>此时Jenkins收到gitee的push就会自动构建</p> 
<p><img alt="" height="1113" src="https://images2.imgbox.com/db/60/Sax0ZcCs_o.png" width="1200"></p> 
<p></p> 
<p>十、说明</p> 
<p><br> 1.本地Jenkins需要一直启动着，才会触发构建<br> 2.netapp也需要一直启动着，如果关闭了，重新启动</p> 
<p><img alt="" height="536" src="https://images2.imgbox.com/42/3c/3rt8pvpo_o.png" width="1085"></p> 
<p>这个代替localhost：8899的网址会变，则又需要到gitee上面修改一下webhook的post URL</p> 
<p><img alt="" height="566" src="https://images2.imgbox.com/fd/83/ZwKbz5hE_o.png" width="1200"></p> 
<p>3.配置完gitee 的webhook后，点击测试按钮发送测试请求不会触发jenkins自动构建，没关系！<br><img alt="" height="851" src="https://images2.imgbox.com/89/d1/H2D46NFh_o.png" width="1200"></p> 
<p>查看请求历史发现报404，这是因为X-Gitee-Event使用的是push_hooks</p> 
<p><img alt="" height="548" src="https://images2.imgbox.com/59/27/nWNoDXE6_o.png" width="1200"></p> 
<p>而正常生产从本地往gitee上推送时X-Gitee-Event使用的是Push Hook</p> 
<p><img alt="" height="473" src="https://images2.imgbox.com/c9/18/PZjEhy4c_o.png" width="1200"></p> 
<p>所以是这个测试功能有问题，才会返回404，直接从本地推送代码可以实现触发jenkins的gitee触发器！</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d79aff98373a123b39a44fd6bf79f5f6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">原生鸿蒙AI浓度要爆表了：鸿蒙原生智能加持，华为小艺进化成系统级智能体...</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/704c1b9a684734e9f96570eaafaf6a97/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">艺术与科技的融合：AI绘画工具的革命性影响*</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>