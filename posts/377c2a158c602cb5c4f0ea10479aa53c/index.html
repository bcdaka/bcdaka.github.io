<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>从零入手人工智能（1）——卷积神经网络 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/377c2a158c602cb5c4f0ea10479aa53c/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="从零入手人工智能（1）——卷积神经网络">
  <meta property="og:description" content="1.前言 本人作为一名单片机工程师，近期对人工智能领域产生了浓厚的兴趣，并开始了我的探索之旅。人工智能是一个博大精深的领域，我相信有许多志同道合的朋友也希望涉足这个领域，因此我写下这篇文章，旨在详细记录我学习人工智能的每一个步骤和心得，希望能为想要入门人工智能的朋友们提供一份入门的指南。为了激发大家的兴趣，我将直接从卷积神经网络这一热门话题入手，带大家领略人工智能的魅力和乐趣。
我们不去深入探讨卷积神经网络底层是如何工作的，而是选择直接通过实践来体验人工智能是如何进行学习和训练的。在这个过程中，我们采取了一种“先上车，再买票”的学习策略，通过这种策略，我们能够通过实践快速上手，然后在后续的学习中逐步深化对知识的理解。
2.开发环境 本代码是在2024年基于当前的编程环境写的，随着技术的快速发展和官方API函数的不断更新，后期可能会出现因API函数修改而导致部分代码编译不通过的情况。
笔者也是借鉴了一位前辈的代码，由于技术的更新，即使是经过验证的代码也可能因为API函数的变化而出现报错。当我们遇到此类问题时，请保持冷静！首先我们可以阅读官方文档，了解API函数的最新变动和更新内容；同时我们可以利用互联网搜索相关的解决方案和修改建议。
我提供了当前代码的开发环境信息，开发环境如下：
python 3.12.2 ancand 2.5.2 jupyter 7.0.8 pandas 2.2.1 numpy 1.26.4 keras 3.3.3 3.准备工作 我们的目标是：对两种不同类型的图片进行识别分类。本代码用卷积神经网络实现了对猫和狗这两类图片的识别分类。为了识别这两类图片，我们需要建立卷积神经网络模型，并用若干张不同的猫和狗的图片训练模型。
在开始构建模型之前，我们需要一定的图片数据集来训练我们的卷积神经网络模型。为了识别猫和狗这两类图片，我们需要在网络上下载并整理这些图片数据。
在这个过程中下载猫和狗图片各35张，保存为JGP格式，我们将这些图片按照特定的组织方式存放到Jupyter工程对应的路径中
upyter 的默认工作目录为：C:\Users\Administrator
在“工程目录”文件夹内我们创建了一个dataset的文件夹，在dataset文件夹中有三个子文件夹：cats、dogs和test。cats文件夹中存放了30张猫的图片，dogs文件夹中存放了30张狗的图片，这些图片将作为训练数据用于模型的学习。而test文件夹则用于存放测试数据，我们存放了5张猫的图片和5张狗的图片，用于评估模型在未见过的数据上的表现。
4.代码实现流程 本代码的核心任务是利用VGG16（经典的卷积神经网络模型）对图片进行特征提取和转换，并将这些转换后的数据作为神经网络的输入进行训练。训练完成后，我们将使用测试图片来验证模型的准确性。
本代码有4个主要步骤：测试VGG16输出数据类型，批量数据预处理，建立模型及训练，测试模型。
4.1.测试VGG16输出数据类型 我们要用VGG16（经典的卷积神经网络模型）对图片进行特征提取和数据转换，随后将得到的转换数据输入到神经网络中。既然要把VGG16转换后的数据输入到神经网络中，那么我们首先需要搞清楚VGG16预处理后的数据格式是什么样的？只有这样我们才能定义数据接口匹配的神经网络模型。
首先加载一张训练图片，并对其进行缩放和归一化，以适应VGG16模型的输入要求。然后使用VGG16模型对图片进行特征提取，最终输出一个包含丰富特征信息的数据，我们查看这个预处理数据类型和大小，方便我们后面构建神经网络模型。
4.2.批量数据预处理 使用VGG16模型对保存不同路径下用于训练的猫和狗的图片进行预处理，并定义一个缓存储存预处理后的数据。
4.3.建立模型及训练 基于VGG16提取的特征向量构建一个神经网络模型，这个模型是一个的全连接网络。我们使用VGG16转换后的数据集来训练这个神经网络模型。在训练过程中，模型会学习从特征向量中识别出图片所属类别。训练完成后，我们会计算模型在训练集上的准确性，以评估其性能。
4.4.测试模型 我们准备了9张独立的测试图片，这些图片在训练过程中是未被使用过的的。使用这些测试图片来验证模型的准确性和泛化能力是非常重要的，因为它可以帮助我们了解模型在新数据上的表现。
将测试图片通过相同的VGG16预处理和特征提取流程，得到对应的特征向量。然后将这些特征向量输入到已经训练好的神经网络模型中，得到模型对每个测试图片的预测结果。
5.代码讲解 将测试我们使用jupyter编程工具，这个工具的最大优势是可以分段运行，下面的代码讲解也是分段描述的，废话不多说，直接上源码。
from matplotlib import pyplot as plt from keras.preprocessing.image import load_img,img_to_array %matplotlib inline #加载图片 转换图片成数组 img_path = &#39;dataset/test/1.jpg&#39; debug_img = load_img(img_path,target_size=(224,224)) debug_img = img_to_array(debug_img) print(debug_img.shape) #显示图片 fig = plt.figure(figsize=(3,3)) show_img = load_img(img_path,target_size=(224,224)) plt.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-05T08:24:03+08:00">
    <meta property="article:modified_time" content="2024-06-05T08:24:03+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">从零入手人工智能（1）——卷积神经网络</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="1_0"></a>1.前言</h3> 
<p>本人作为一名单片机工程师，近期对人工智能领域产生了浓厚的兴趣，并开始了我的探索之旅。人工智能是一个博大精深的领域，我相信有许多志同道合的朋友也希望涉足这个领域，因此我写下这篇文章，旨在详细记录我学习人工智能的每一个步骤和心得，希望能为想要入门人工智能的朋友们提供一份入门的指南。<strong>为了激发大家的兴趣，我将直接从卷积神经网络这一热门话题入手，带大家领略人工智能的魅力和乐趣</strong>。<br> <strong>我们不去深入探讨卷积神经网络底层是如何工作的，而是选择直接通过实践来体验人工智能是如何进行学习和训练的</strong>。在这个过程中，我们采取了一种“<strong>先上车，再买票</strong>”的学习策略，通过这种策略，我们能够通过实践快速上手，然后在后续的学习中逐步深化对知识的理解。<br> <img src="https://images2.imgbox.com/cc/73/9folLT90_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2_6"></a>2.开发环境</h3> 
<p>本代码是在2024年基于当前的编程环境写的，随着技术的快速发展和官方API函数的不断更新，<strong>后期可能会出现因API函数修改而导致部分代码编译不通过的情况</strong>。<br> 笔者也是借鉴了一位前辈的代码，由于技术的更新，即使是经过验证的代码也可能因为API函数的变化而出现报错。当我们遇到此类问题时，请保持冷静！<strong>首先我们可以阅读官方文档，了解API函数的最新变动和更新内容；同时我们可以利用互联网搜索相关的解决方案和修改建议</strong>。<br> 我提供了当前代码的开发环境信息，开发环境如下：</p> 
<pre><code class="prism language-c">python <span class="token number">3.12</span><span class="token number">.2</span>
ancand <span class="token number">2.5</span><span class="token number">.2</span>
jupyter <span class="token number">7.0</span><span class="token number">.8</span>
pandas <span class="token number">2.2</span><span class="token number">.1</span>
numpy <span class="token number">1.26</span><span class="token number">.4</span> 
keras  <span class="token number">3.3</span><span class="token number">.3</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/5d/42/d5WafAWU_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3_22"></a>3.准备工作</h3> 
<p>我们的目标是：<strong>对两种不同类型的图片进行识别分类</strong>。本代码用卷积神经网络实现了对猫和狗这两类图片的识别分类。为了识别这两类图片，我们需要建立卷积神经网络模型，并用若干张不同的猫和狗的图片训练模型。<br> 在开始构建模型之前，<strong>我们需要一定的图片数据集来训练我们的卷积神经网络模型</strong>。为了识别猫和狗这两类图片，我们需要在网络上下载并整理这些图片数据。<br> <img src="https://images2.imgbox.com/f9/d7/ZNCEtg7X_o.png" alt="在这里插入图片描述"><br> 在这个过程中下载猫和狗图片各35张，保存为JGP格式，我们将这些图片按照特定的组织方式存放到Jupyter工程对应的路径中</p> 
<blockquote> 
 <p>upyter 的默认工作目录为：C:\Users\Administrator</p> 
</blockquote> 
<p>在“工程目录”文件夹内我们创建了一个dataset的文件夹，<strong>在dataset文件夹中有三个子文件夹：cats、dogs和test</strong>。cats文件夹中存放了30张猫的图片，dogs文件夹中存放了30张狗的图片，这些图片将作为训练数据用于模型的学习。而test文件夹则用于存放测试数据，我们存放了5张猫的图片和5张狗的图片，用于评估模型在未见过的数据上的表现。<br> <img src="https://images2.imgbox.com/4e/87/7VAySNav_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4_34"></a>4.代码实现流程</h3> 
<p><strong>本代码的核心任务是利用VGG16（经典的卷积神经网络模型）对图片进行特征提取和转换，并将这些转换后的数据作为神经网络的输入进行训练</strong>。训练完成后，我们将使用测试图片来验证模型的准确性。<br> <img src="https://images2.imgbox.com/79/a6/UVcKXAPE_o.png" alt="在这里插入图片描述"><br> 本代码有4个主要步骤：<strong>测试VGG16输出数据类型，批量数据预处理，建立模型及训练，测试模型</strong>。</p> 
<h4><a id="41VGG16_40"></a>4.1.测试VGG16输出数据类型</h4> 
<p>我们要用VGG16（经典的卷积神经网络模型）对图片进行特征提取和数据转换，随后将得到的转换数据输入到神经网络中。既然要把VGG16转换后的数据输入到神经网络中，<strong>那么我们首先需要搞清楚VGG16预处理后的数据格式是什么样的</strong>？只有这样我们才能定义数据接口匹配的神经网络模型。<br> <img src="https://images2.imgbox.com/0b/74/B3d7wKX7_o.png" alt="在这里插入图片描述"><br> 首先加载一张训练图片，并对其进行缩放和归一化，以适应VGG16模型的输入要求。然后使用VGG16模型对图片进行特征提取，<strong>最终输出一个包含丰富特征信息的数据，我们查看这个预处理数据类型和大小</strong>，方便我们后面构建神经网络模型。</p> 
<h4><a id="42_46"></a>4.2.批量数据预处理</h4> 
<p>使用VGG16模型对保存不同路径下用于训练的猫和狗的图片进行预处理，并定义一个缓存储存预处理后的数据。<br> <img src="https://images2.imgbox.com/e3/ce/b8g9Dzgm_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="43_51"></a>4.3.建立模型及训练</h4> 
<p><strong>基于VGG16提取的特征向量构建一个神经网络模型，这个模型是一个的全连接网络</strong>。我们使用VGG16转换后的数据集来训练这个神经网络模型。在训练过程中，模型会学习从特征向量中识别出图片所属类别。训练完成后，我们会计算模型在训练集上的准确性，以评估其性能。<br> <img src="https://images2.imgbox.com/9e/d7/IcmjCJ7e_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="44_56"></a>4.4.测试模型</h4> 
<p>我们准备了9张独立的测试图片，<strong>这些图片在训练过程中是未被使用过的的</strong>。使用这些测试图片来验证模型的准确性和泛化能力是非常重要的，因为它可以帮助我们了解模型在新数据上的表现。<br> 将测试图片通过相同的VGG16预处理和特征提取流程，得到对应的特征向量。然后将这些特征向量输入到已经训练好的神经网络模型中，得到模型对每个测试图片的预测结果。<br> <img src="https://images2.imgbox.com/2f/56/XLQ9HJue_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="5_62"></a>5.代码讲解</h3> 
<p>将测试我们使用jupyter编程工具，这个工具的最大优势是可以分段运行，下面的代码讲解也是分段描述的，废话不多说，直接上源码。</p> 
<pre><code class="prism language-c">from matplotlib import pyplot as plt
from keras<span class="token punctuation">.</span>preprocessing<span class="token punctuation">.</span>image import load_img<span class="token punctuation">,</span>img_to_array
<span class="token operator">%</span>matplotlib <span class="token keyword">inline</span>

#加载图片  转换图片成数组 
img_path <span class="token operator">=</span> <span class="token char">'dataset/test/1.jpg'</span>
debug_img <span class="token operator">=</span> <span class="token function">load_img</span><span class="token punctuation">(</span>img_path<span class="token punctuation">,</span>target_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
debug_img <span class="token operator">=</span> <span class="token function">img_to_array</span><span class="token punctuation">(</span>debug_img<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>debug_img<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>

#显示图片 
fig <span class="token operator">=</span> plt<span class="token punctuation">.</span><span class="token function">figure</span><span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
show_img <span class="token operator">=</span> <span class="token function">load_img</span><span class="token punctuation">(</span>img_path<span class="token punctuation">,</span>target_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span><span class="token function">imshow</span><span class="token punctuation">(</span>show_img<span class="token punctuation">)</span>
</code></pre> 
<blockquote> 
 <p>这段代码的作用是加载一张训练图片，将图片转换成一个数组，然后显示图片大小和内容，以下是程序运行结果，根据结果我们可知图片数据是一个224 * 224 * 3的三维数组。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/2b/e9/84xEavC8_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c">import numpy as np
from keras<span class="token punctuation">.</span>applications<span class="token punctuation">.</span>vgg16 import preprocess_input
#在数组的指定位置插入新的维度 <span class="token punctuation">,</span>使得数据与卷积神经网络的模型兼容
debug_data <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token function">expand_dims</span><span class="token punctuation">(</span>debug_img <span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
debug_data <span class="token operator">=</span> <span class="token function">preprocess_input</span><span class="token punctuation">(</span>debug_data<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>debug_data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
</code></pre> 
<blockquote> 
 <p>这段代码的作用是将图片数据增加一个维度与后面的VGG16模型数据匹配，程序运行结果如下，有结果可知图片转换为一个1 * 224 * 224 * 3 的四维数组</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/c5/40/BHtdspot_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c">from keras<span class="token punctuation">.</span>applications<span class="token punctuation">.</span>vgg16 import VGG16
from keras<span class="token punctuation">.</span>applications<span class="token punctuation">.</span>vgg16 import preprocess_input

model_vgg <span class="token operator">=</span> <span class="token function">VGG16</span><span class="token punctuation">(</span>weights<span class="token operator">=</span><span class="token char">'imagenet'</span> <span class="token punctuation">,</span>include_top<span class="token operator">=</span>False<span class="token punctuation">)</span>  # 加载 VGG16 模型  
vgg16_out <span class="token operator">=</span> model_vgg<span class="token punctuation">.</span><span class="token function">predict</span><span class="token punctuation">(</span>debug_data<span class="token punctuation">)</span>   #  使用VGG16 模型转换  debug_data ，得到 vgg16_out
<span class="token function">print</span><span class="token punctuation">(</span>vgg16_out<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>  # 显示 vgg16_out大小
</code></pre> 
<blockquote> 
 <p>这段代码的作用是使用VGG16模型对图片数据进行数据处理操作，运行结果如下，根据结果可知VGG16转换后得到的数据是一个1* 7 * 7*512的四维数组</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/a6/00/ANgrNuq0_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c">vgg16_out <span class="token operator">=</span> vgg16_out<span class="token punctuation">.</span><span class="token function">reshape</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">512</span><span class="token punctuation">)</span> #将vgg16_out 转换成一维向量 <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">512</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>vgg16_out<span class="token punctuation">.</span>shape<span class="token punctuation">)</span> 
</code></pre> 
<blockquote> 
 <p>这段代码的作用是将VGG16处理得到的数据转换成一个 二维数组格式，因为只有这种数据格式才能匹配全连接神经网络输入，代码运行结果如下，根据运行结果可知输入神经网络的数据类型为1*25088（25088=7 * 7 * 512）。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/e2/f1/SnXguPYU_o.png" alt="在这里插入图片描述"><br> 至此我们终于搞清楚了经过VGG16模型处理后的图片数据是什么类型，神经网络输入的数据是什么类型，<strong>至此我们完成了四大步骤中的步骤一</strong>。</p> 
<pre><code class="prism language-c"># 使用VGG16提取全部的猫和狗训练图片的特性数据
model_vgg <span class="token operator">=</span> <span class="token function">VGG16</span><span class="token punctuation">(</span>weights<span class="token operator">=</span><span class="token char">'imagenet'</span><span class="token punctuation">,</span> include_top<span class="token operator">=</span>False<span class="token punctuation">)</span>

def <span class="token function">model_process</span><span class="token punctuation">(</span>img_path<span class="token punctuation">,</span>model<span class="token punctuation">)</span><span class="token operator">:</span>   # 使用模型数据处理函数
    img <span class="token operator">=</span> <span class="token function">load_img</span><span class="token punctuation">(</span>img_path<span class="token punctuation">,</span> target_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">)</span>     #加载路径
    img <span class="token operator">=</span> <span class="token function">img_to_array</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span>
    x <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token function">expand_dims</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span> #在数组的指定位置插入新的维度
    x <span class="token operator">=</span> <span class="token function">preprocess_input</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    
    x_vgg <span class="token operator">=</span> model_vgg<span class="token punctuation">.</span><span class="token function">predict</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> #使用 VGG16 卷积层特征提取器
    x_vgg <span class="token operator">=</span> x_vgg<span class="token punctuation">.</span><span class="token function">reshape</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">512</span><span class="token punctuation">)</span> #将数据转换成一维向量 <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">512</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> x_vgg
    
import os
folder_path <span class="token operator">=</span> <span class="token string">"dataset/cats"</span>
folder_name <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">listdir</span><span class="token punctuation">(</span>folder_path<span class="token punctuation">)</span>  #listdir 返回一个列表，包含路径path下所有文件的名字

img_path <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i in folder_name<span class="token operator">:</span> 
    <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">splitext</span><span class="token expression">返回一个包含两个元素的元组，第一个元素是文件名（不包括扩展名），第二个元素是扩展名（如果有的话，包含前面的点）</span></span>
    <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">splitext</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">".jpg"</span><span class="token operator">:</span>   
        img_path<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> # 图片的名字加入到img_path中
        
img_path <span class="token operator">=</span> <span class="token punctuation">[</span>folder_path <span class="token operator">+</span> <span class="token string">"//"</span> <span class="token operator">+</span> i <span class="token keyword">for</span> i in img_path<span class="token punctuation">]</span> #img_path转变为一个包含路径的图片名称

#定义<span class="token number">1</span>个保存个样本<span class="token number">1</span>图片<span class="token operator">*</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">512</span>的数组 ，用于存储N个样本<span class="token number">1</span>图片经过VGG16转换后的所有数据
features_cats <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">len</span><span class="token punctuation">(</span>img_path<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">512</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i in <span class="token function">range</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>img_path<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">:</span>
    #使用 VGG16 卷积层特征提取器
    feature_i <span class="token operator">=</span> <span class="token function">model_process</span><span class="token punctuation">(</span>img_path<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>model_vgg<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token char">'preprocessed:'</span><span class="token punctuation">,</span>img_path<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    features_cats<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> feature_i
    
folder_path <span class="token operator">=</span> <span class="token string">"dataset/dogs"</span>
folder_name <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">listdir</span><span class="token punctuation">(</span>folder_path<span class="token punctuation">)</span>
img_path <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i in folder_name<span class="token operator">:</span>                             
    <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">splitext</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">".jpg"</span><span class="token operator">:</span>   
        img_path<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>  # 图片的名字加入到img_path中

img_path <span class="token operator">=</span> <span class="token punctuation">[</span>folder_path <span class="token operator">+</span> <span class="token string">"//"</span> <span class="token operator">+</span> i <span class="token keyword">for</span> i in img_path<span class="token punctuation">]</span> #img_path转变为一个包含路径的图片名称

#定义<span class="token number">1</span>个保存个样本<span class="token number">2</span>图片<span class="token operator">*</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">512</span>的数组 ，用于存储N个样本<span class="token number">2</span>图片经过VGG16转换后的所有数据
features_dogs <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">len</span><span class="token punctuation">(</span>img_path<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">512</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i in <span class="token function">range</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>img_path<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">:</span>
     #使用 VGG16 卷积层特征提取器
    feature_i <span class="token operator">=</span> <span class="token function">model_process</span><span class="token punctuation">(</span>img_path<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>model_vgg<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token char">'preprocessed:'</span><span class="token punctuation">,</span>img_path<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    features_dogs<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> feature_i
#建立标签    这里数组大小需要根据具体的样本数量来确定
label_cat <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>  #y1 猫的额标签值 <span class="token number">0</span>
label_dog <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token function">ones</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>   #y2 狗的额标签值 <span class="token number">1</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">concatenate</span>  <span class="token expression">将多个数组“拼接”成一个更大的数组 </span></span>
data_set <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token function">concatenate</span><span class="token punctuation">(</span><span class="token punctuation">(</span>features_cats <span class="token punctuation">,</span>features_dogs<span class="token punctuation">)</span> <span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span> #将猫和狗的特征数据合并

label <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token function">concatenate</span><span class="token punctuation">(</span><span class="token punctuation">(</span>label_cat <span class="token punctuation">,</span>label_dog<span class="token punctuation">)</span> <span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>  #将猫和狗的标签数据合并
label <span class="token operator">=</span> label<span class="token punctuation">.</span><span class="token function">reshape</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> #将一个一维数组y转换为一个二维数组

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">l</span><span class="token expression">显示数据的大小</span></span>
<span class="token function">print</span><span class="token punctuation">(</span>features_cats<span class="token punctuation">.</span>shape<span class="token punctuation">,</span>features_dogs<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>data_set<span class="token punctuation">.</span>shape<span class="token punctuation">,</span>label<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
</code></pre> 
<blockquote> 
 <p>这段代码的的作用是搜素dataset/cats和dataset/dogs这两个文件夹中的所有图片，并使用VGG16模型对这些图片进行处理，处理后的数据保存到features_cats和features_dogs中，同时我们建立猫和狗的标签label_cat和label_dog。<strong>这里我们注意一个关键点，在代码中已经将猫和狗的图片与0和1两个标签进行了绑定</strong>。程序运行后对数据进行处理，整个过程持续约30秒，运行结果如下。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/6c/18/E4Jam3bf_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c">from sklearn<span class="token punctuation">.</span>model_selection import train_test_split
#划分测试集，将data_set 和  label  划分成一个训练数据集和一个数据测试集
X_train<span class="token punctuation">,</span>X_test<span class="token punctuation">,</span>y_train<span class="token punctuation">,</span>y_test <span class="token operator">=</span> <span class="token function">train_test_split</span><span class="token punctuation">(</span>data_set <span class="token punctuation">,</span>label <span class="token punctuation">,</span>test_size<span class="token operator">=</span><span class="token number">0.3</span> <span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>X_train<span class="token punctuation">.</span>shape <span class="token punctuation">,</span>X_test<span class="token punctuation">.</span>shape <span class="token punctuation">,</span>y_train<span class="token punctuation">.</span>shape <span class="token punctuation">,</span>y_test<span class="token punctuation">.</span>shape<span class="token punctuation">)</span> #查看训练集和测试集
</code></pre> 
<blockquote> 
 <p>这段代码的作用是划分测试集，将data_set 和 label 划分成一个训练数据集和一个数据测试集，运行结果如下。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/42/6b/I86ktMxU_o.png" alt="在这里插入图片描述"><br> 我们使用VGG16模型将所有训练图片进行了批量处理，<strong>至此我们完成了四大步骤中的步骤二</strong>。</p> 
<pre><code class="prism language-c">from keras<span class="token punctuation">.</span>models import Sequential
from keras<span class="token punctuation">.</span>layers import Dense
# 构建神经网络模型 两个全连接层 
model <span class="token operator">=</span> <span class="token function">Sequential</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">Dense</span><span class="token punctuation">(</span>units<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>activation<span class="token operator">=</span><span class="token char">'relu'</span><span class="token punctuation">,</span>input_dim<span class="token operator">=</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  # 输入层 大小 <span class="token number">7</span><span class="token operator">*</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">512</span>
model<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">Dense</span><span class="token punctuation">(</span>units<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>activation<span class="token operator">=</span><span class="token char">'sigmoid'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                  # 输出层  <span class="token number">1</span> ，二分类
model<span class="token punctuation">.</span><span class="token function">summary</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
#定义loss opt acc基本参数
model<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span><span class="token char">'adam'</span><span class="token punctuation">,</span>loss<span class="token operator">=</span><span class="token char">'binary_crossentropy'</span><span class="token punctuation">,</span>metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token char">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<blockquote> 
 <p>这段代码的作用是建立一个全连接的二层神经网络模型，神经网络模型的输入大小为7 * 7 * 512，代码运行结果如下。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/00/43/jGqPaKpa_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c">#使用训练数据对模型进行训练
model<span class="token punctuation">.</span><span class="token function">fit</span><span class="token punctuation">(</span>X_train<span class="token punctuation">,</span>y_train<span class="token punctuation">,</span>epochs<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>
</code></pre> 
<blockquote> 
 <p>这段代码的作用是使用X_train和y_train数据训练模型，代码运行结果如下。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/0b/6c/eDJ7RV6B_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c">from sklearn<span class="token punctuation">.</span>metrics import accuracy_score
import numpy as np

#测试模型准确率
def <span class="token function">predict_data</span><span class="token punctuation">(</span>train<span class="token punctuation">)</span><span class="token operator">:</span>
    predict_ret <span class="token operator">=</span> model<span class="token punctuation">.</span><span class="token function">predict</span><span class="token punctuation">(</span>train<span class="token punctuation">)</span>
    predict_ret<span class="token operator">=</span>np<span class="token punctuation">.</span><span class="token function">argmax</span><span class="token punctuation">(</span>predict_ret<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> predict_ret

#使用测试数据集测试模型准确性
y_test_predict <span class="token operator">=</span>  <span class="token function">predict_data</span><span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
accuracy_test <span class="token operator">=</span> <span class="token function">accuracy_score</span><span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_test_predict<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>accuracy_test<span class="token punctuation">)</span>
</code></pre> 
<blockquote> 
 <p>这段代码的额作用是使用测试数据集测试模型准确性，代码运行结果如下。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/77/2a/LXkZ7Erb_o.png" alt="在这里插入图片描述"></p> 
<p>我们建立了神经网络模型，并使用了VGG16处理的数据作为输入，最终组成了的卷积神经网络模型，完成模型训练后并对模型的准确性进行了测试，<strong>至此我们完成了四大步骤中的步骤三</strong>。</p> 
<pre><code class="prism language-c"># 在模型未接触的TEST数据集中，找一个图片进行测试
# 加载图片
img_path <span class="token operator">=</span> <span class="token char">'dataset/test/3.jpg'</span>
img <span class="token operator">=</span> <span class="token function">load_img</span><span class="token punctuation">(</span>img_path<span class="token punctuation">,</span>target_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
img_show <span class="token operator">=</span> <span class="token function">load_img</span><span class="token punctuation">(</span>img_path<span class="token punctuation">,</span>target_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">VGG16对图片进行转换</span></span>
img <span class="token operator">=</span> <span class="token function">img_to_array</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span>
x <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token function">expand_dims</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
x <span class="token operator">=</span> <span class="token function">preprocess_input</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
features <span class="token operator">=</span> model_vgg<span class="token punctuation">.</span><span class="token function">predict</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
features <span class="token operator">=</span> features<span class="token punctuation">.</span><span class="token function">reshape</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">512</span><span class="token punctuation">)</span>
# 使用模型对图片进行测试
result <span class="token operator">=</span> model<span class="token punctuation">.</span><span class="token function">predict</span><span class="token punctuation">(</span>features<span class="token punctuation">)</span>#本模型是一个二分类模型，因此预测返回值result是一个概率值，，概率接近<span class="token number">0</span>说明是猫 概率接近<span class="token number">1</span>说明是狗
<span class="token function">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> #显示预测值
#用图片名称显示预测值
<span class="token keyword">if</span> result <span class="token operator">&gt;</span><span class="token number">0.5</span> <span class="token operator">:</span>
    plt<span class="token punctuation">.</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">"dog"</span><span class="token punctuation">)</span>
<span class="token keyword">else</span> <span class="token operator">:</span>
    plt<span class="token punctuation">.</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">"cat"</span><span class="token punctuation">)</span>
    
plt<span class="token punctuation">.</span><span class="token function">imshow</span><span class="token punctuation">(</span>img_show<span class="token punctuation">)</span>
</code></pre> 
<blockquote> 
 <p>这段代码的作用是在全新的测试图片中加载一张图片，先用VGG16模型进行数据处理，然后用神经网络模型进行数据预测，代码运行结果如下。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/f0/74/pNJCvWiX_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c">#使用test测试图片对模型进行批量测试
test_path <span class="token operator">=</span> <span class="token char">'dataset/test/'</span>
a <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i in <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
fig <span class="token operator">=</span> plt<span class="token punctuation">.</span><span class="token function">figure</span><span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
#依次加载处理所有图片
<span class="token keyword">for</span> i in a<span class="token operator">:</span> 
    #加载图片
    img_name <span class="token operator">=</span> test_path <span class="token operator">+</span> <span class="token function">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span><span class="token char">'.jpg'</span>
    img_path <span class="token operator">=</span> img_name
    img <span class="token operator">=</span> <span class="token function">load_img</span><span class="token punctuation">(</span>img_path<span class="token punctuation">,</span> target_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    img <span class="token operator">=</span> <span class="token function">img_to_array</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span>
    #增加数据维度  预处理数据  使用 VGG16 卷积层特征提取器
    x <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token function">expand_dims</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    x <span class="token operator">=</span> <span class="token function">preprocess_input</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    x_vgg <span class="token operator">=</span> model_vgg<span class="token punctuation">.</span><span class="token function">predict</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    x_vgg <span class="token operator">=</span> x_vgg<span class="token punctuation">.</span><span class="token function">reshape</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">512</span><span class="token punctuation">)</span>
    #使用模型进行数据结果预测
    result <span class="token operator">=</span> model<span class="token punctuation">.</span><span class="token function">predict</span><span class="token punctuation">(</span>x_vgg<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
    #加载图片用于显示
    img_ori <span class="token operator">=</span> <span class="token function">load_img</span><span class="token punctuation">(</span>img_name<span class="token punctuation">,</span> target_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span><span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span><span class="token function">imshow</span><span class="token punctuation">(</span>img_ori<span class="token punctuation">)</span>
    <span class="token keyword">if</span> result <span class="token operator">&gt;</span><span class="token number">0.5</span> <span class="token operator">:</span>
        plt<span class="token punctuation">.</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'dog'</span> <span class="token punctuation">,</span>fontdict<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> <span class="token char">'size'</span><span class="token operator">:</span> <span class="token char">'10'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span> <span class="token operator">:</span>
        plt<span class="token punctuation">.</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'cat'</span> <span class="token punctuation">,</span>fontdict<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> <span class="token char">'size'</span><span class="token operator">:</span> <span class="token char">'10'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span><span class="token function">tight_layout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> #调整图片大小 防止重叠
plt<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>这段代码的作用是使用test测试图片对模型进行批量测试，注意这里的图片命名为1，2，3…10（与代码匹配），运行结果如下。<br> <img src="https://images2.imgbox.com/2f/e9/RQXvqFQ5_o.png" alt="在这里插入图片描述"><br> 我们用9张全新的图片对模型进行了测试，其中9张图片预测对了8张，准确率相当不错，要知道这只是用30张图片进行了训练，如果我们加大图片数量模型的准确性还将大幅提高，<strong>至此我们完成了四大步骤中的步骤四</strong>。</p> 
<h3><a id="5_318"></a>5.改变训练目标</h3> 
<p>很多时候我们学习了一个别人的代码，当我们想进行一定的修改的时候，发现修改一处就到处报错，修改已至无从下手。接下来我在教大家如何修改训练目标，比如我们想识别卡车和轿车这两种图片，步骤如下：</p> 
<h4><a id="1_322"></a>步骤1</h4> 
<p>下载图片。在“工程目录”文件夹内我们创建了一个dataset的文件夹，<strong>在dataset文件夹中有三个子文件夹：cars、trunks和test</strong>。cars文件夹中存放了30张轿车的图片，trunks文件夹中存放了30张卡车的图片，test文件夹存放5张轿车的图片和5张卡车的图片片，用于评估模型在未见过的数据上的表现。</p> 
<h4><a id="2_325"></a>步骤2</h4> 
<p>修改路径。修改VGG16数据处理代码中的图片加载路径。</p> 
<pre><code class="prism language-c">folder_path <span class="token operator">=</span> <span class="token string">"dataset/cars"</span>  
folder_path <span class="token operator">=</span> <span class="token string">"dataset/trunks"</span>
</code></pre> 
<h4><a id="3_334"></a>步骤3</h4> 
<p>修改图片批量测试中的图片显示代码。</p> 
<pre><code class="prism language-c"><span class="token keyword">if</span> result <span class="token operator">&gt;</span><span class="token number">0.5</span> <span class="token operator">:</span>
    plt<span class="token punctuation">.</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'car'</span> <span class="token punctuation">,</span>fontdict<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> <span class="token char">'size'</span><span class="token operator">:</span> <span class="token char">'10'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">else</span> <span class="token operator">:</span>
    plt<span class="token punctuation">.</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'trunk'</span> <span class="token punctuation">,</span>fontdict<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> <span class="token char">'size'</span><span class="token operator">:</span> <span class="token char">'10'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/df/68/T2y2XygH_o.png" alt="在这里插入图片描述"><br> <strong>希望获取源码的朋友们请在评论区留言！！！</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e1b37d124d96b1c51379f2ee6e19d993/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C&#43;&#43; 20新特性之指定初始化器</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bf1438bf40a37c394cf3f6200f214350/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">英伟达黄仁勋最新主题演讲：“机器人时代“已经到来</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>