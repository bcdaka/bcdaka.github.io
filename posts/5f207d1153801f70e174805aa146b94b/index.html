<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C# 实现HTTP自承载WebApi服务 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/5f207d1153801f70e174805aa146b94b/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="C# 实现HTTP自承载WebApi服务">
  <meta property="og:description" content="HTTP 自承载服务（HTTP Self-Hosted Service）是一种不依赖于外部 Web 服务器（如 IIS、Apache、Nginx 等）的 HTTP 服务，它直接在自己的进程中监听 HTTP 请求并处理它们。这种服务通常由应用程序自己实现 HTTP 服务器功能，从而允许应用程序直接暴露 HTTP API 或提供 Web 内容。
HTTP 自承载服务在以下场景中特别有用：
小型应用或微服务：对于需要通过网络提供 API 的小型应用或微服务，自承载 HTTP 服务器是一个轻量级的解决方案，它不需要额外的 Web 服务器软件。
嵌入式系统：在嵌入式系统或物联网（IoT）设备中，自承载 HTTP 服务器可以方便地提供远程管理、监控或配置接口。
开发环境和测试：在开发过程中，开发人员可以使用自承载 HTTP 服务器快速搭建 API 原型或测试环境，而无需配置复杂的 Web 服务器。
跨平台兼容性：自承载 HTTP 服务器可以轻松地部署到各种操作系统和平台上，因为它们不依赖于特定的 Web 服务器软件。
在 .NET 框架中，HttpSelfHostServer 是实现 HTTP 自承载服务的一种方式，它属于 ASP.NET Web API 的一部分。通过创建 HttpSelfHostConfiguration 对象并配置路由，开发人员可以轻松地构建和启动自承载 HTTP 服务器。
虽然 HTTP 自承载服务提供了很多便利，但它们也可能不如成熟的 Web 服务器软件那样强大和可扩展。因此，在选择是否使用自承载服务时，需要根据具体的应用场景和需求进行评估。
using System; using System.Collections.Generic; using System.Web.Http; namespace SelfHostSample.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-04T17:26:47+08:00">
    <meta property="article:modified_time" content="2024-05-04T17:26:47+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C# 实现HTTP自承载WebApi服务</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>HTTP 自承载服务（HTTP Self-Hosted Service）是一种不依赖于外部 Web 服务器（如 IIS、Apache、Nginx 等）的 HTTP 服务，它直接在自己的进程中监听 HTTP 请求并处理它们。这种服务通常由应用程序自己实现 HTTP 服务器功能，从而允许应用程序直接暴露 HTTP API 或提供 Web 内容。</p> 
<p>HTTP 自承载服务在以下场景中特别有用：</p> 
<ol><li> <p><strong>小型应用或微服务</strong>：对于需要通过网络提供 API 的小型应用或微服务，自承载 HTTP 服务器是一个轻量级的解决方案，它不需要额外的 Web 服务器软件。</p> </li><li> <p><strong>嵌入式系统</strong>：在嵌入式系统或物联网（IoT）设备中，自承载 HTTP 服务器可以方便地提供远程管理、监控或配置接口。</p> </li><li> <p><strong>开发环境和测试</strong>：在开发过程中，开发人员可以使用自承载 HTTP 服务器快速搭建 API 原型或测试环境，而无需配置复杂的 Web 服务器。</p> </li><li> <p><strong>跨平台兼容性</strong>：自承载 HTTP 服务器可以轻松地部署到各种操作系统和平台上，因为它们不依赖于特定的 Web 服务器软件。</p> </li></ol> 
<p>在 .NET 框架中，<code>HttpSelfHostServer</code> 是实现 HTTP 自承载服务的一种方式，它属于 ASP.NET Web API 的一部分。通过创建 <code>HttpSelfHostConfiguration</code> 对象并配置路由，开发人员可以轻松地构建和启动自承载 HTTP 服务器。</p> 
<p>虽然 HTTP 自承载服务提供了很多便利，但它们也可能不如成熟的 Web 服务器软件那样强大和可扩展。因此，在选择是否使用自承载服务时，需要根据具体的应用场景和需求进行评估。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>  
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>  
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Web<span class="token punctuation">.</span>Http</span><span class="token punctuation">;</span>  
  
<span class="token keyword">namespace</span> <span class="token namespace">SelfHostSample<span class="token punctuation">.</span>Controllers</span>  
<span class="token punctuation">{<!-- --></span>  
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ValuesController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ApiController</span></span>  
    <span class="token punctuation">{<!-- --></span>  
        <span class="token comment">// GET api/values  </span>
        <span class="token keyword">public</span> <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
        <span class="token punctuation">{<!-- --></span>  
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{<!-- --></span> <span class="token string">"value1"</span><span class="token punctuation">,</span> <span class="token string">"value2"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>  
  
        <span class="token comment">// GET api/values/5  </span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> id<span class="token punctuation">)</span>  
        <span class="token punctuation">{<!-- --></span>  
            <span class="token keyword">return</span> <span class="token string">"value "</span> <span class="token operator">+</span> id<span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>  
  
        <span class="token comment">// POST api/values  </span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Post</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">FromBody</span></span><span class="token punctuation">]</span><span class="token class-name"><span class="token keyword">string</span></span> <span class="token keyword">value</span><span class="token punctuation">)</span>  
        <span class="token punctuation">{<!-- --></span>  
        <span class="token punctuation">}</span>  
  
        <span class="token comment">// PUT api/values/5  </span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Put</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> id<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">FromBody</span></span><span class="token punctuation">]</span><span class="token class-name"><span class="token keyword">string</span></span> <span class="token keyword">value</span><span class="token punctuation">)</span>  
        <span class="token punctuation">{<!-- --></span>  
        <span class="token punctuation">}</span>  
  
        <span class="token comment">// DELETE api/values/5  </span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Delete</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> id<span class="token punctuation">)</span>  
        <span class="token punctuation">{<!-- --></span>  
        <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>  
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Http</span><span class="token punctuation">;</span>  
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Threading</span><span class="token punctuation">;</span>  
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Web<span class="token punctuation">.</span>Http</span><span class="token punctuation">;</span>  
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Web<span class="token punctuation">.</span>Http<span class="token punctuation">.</span>SelfHost</span><span class="token punctuation">;</span>  
  
<span class="token keyword">namespace</span> <span class="token namespace">SelfHostSample</span>  
<span class="token punctuation">{<!-- --></span>  
    <span class="token keyword">class</span> <span class="token class-name">Program</span>  
    <span class="token punctuation">{<!-- --></span>  
        <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>  
        <span class="token punctuation">{<!-- --></span>  
            <span class="token comment">// 创建HttpSelfHostConfiguration实例  </span>
            <span class="token class-name"><span class="token keyword">var</span></span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HttpSelfHostConfiguration</span><span class="token punctuation">(</span><span class="token string">"http://localhost:8080"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
            <span class="token comment">// 添加路由  </span>
            config<span class="token punctuation">.</span>Routes<span class="token punctuation">.</span><span class="token function">MapHttpRoute</span><span class="token punctuation">(</span>  
                <span class="token named-parameter punctuation">name</span><span class="token punctuation">:</span> <span class="token string">"DefaultApi"</span><span class="token punctuation">,</span>  
                <span class="token named-parameter punctuation">routeTemplate</span><span class="token punctuation">:</span> <span class="token string">"api/{controller}/{id}"</span><span class="token punctuation">,</span>  
                <span class="token named-parameter punctuation">defaults</span><span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token punctuation">{<!-- --></span> id <span class="token operator">=</span> RouteParameter<span class="token punctuation">.</span>Optional <span class="token punctuation">}</span>  
            <span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
            <span class="token comment">// 创建HttpSelfHostServer实例  </span>
            <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">HttpSelfHostServer</span> server <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HttpSelfHostServer</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">)</span>  
            <span class="token punctuation">{<!-- --></span>  
                <span class="token comment">// 启动服务器  </span>
                server<span class="token punctuation">.</span><span class="token function">OpenAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"服务已启动，监听端口：8080"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
                <span class="token comment">// 保持程序运行，直到用户中断  </span>
                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"按任意键停止服务..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                Console<span class="token punctuation">.</span><span class="token function">ReadKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">}</span>  
        <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> 
<p>在这个例子中，我们创建了一个监听http://localhost:8080的自承载服务器，并配置了一个路由规则来映射到我们的ValuesController。当服务器启动时，它会监听指定的端口，并等待客户端请求。你可以通过浏览器、Postman或其他HTTP客户端工具来发送请求到http://localhost:8080/api/values来测试这个API。</p> 
<p>请注意，这个示例是基于旧版本的ASP.NET Web API。如果你正在使用ASP.NET Core，那么你应该使用Microsoft.AspNetCore.Hosting.WebHostBuilder来配置和启动你的自承载服务器。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/481193d9c73117c32365e79652378b5b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C&#43;&#43;必修：类与对象(三)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0e901d8ef0fa0514f9b52580387f3153/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">[嵌入式AI从0开始到入土]17_Ascend C算子开发</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>