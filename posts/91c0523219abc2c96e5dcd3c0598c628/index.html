<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Jenkins - Python 虚拟环境 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/91c0523219abc2c96e5dcd3c0598c628/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Jenkins - Python 虚拟环境">
  <meta property="og:description" content="Jenkins - Python 虚拟环境 引言Python 虚拟环境创建 Python 虚拟环境安装 virtualenv（可选）创建虚拟环境激活虚拟环境安装依赖包退出虚拟环境（可选）注意 Python 虚拟环境实践 引言 Automation 脚本通常会部署到 Jenkins 上运行，Jenkins 环境是随机分配虚拟机的，有些 Node 上虚拟机环境还都不一样，安装的依赖包，操作系统也各不相同。经常有遇到脚本有时跑失败，有时跑成功了，很大原因就是安装脚本所需的安装包失败。我们可以用虚拟环境来解决这一问题，今天就来了解一下 Python 虚拟环境。
Python 虚拟环境 Python 虚拟环境 (Virtual Environment) 是一种隔离的环境，每个虚拟环境都有自己的 Python 解释器和一组独立的库，从而避免了不同项目之间的依赖冲突。
使用虚拟环境有许多好处，尤其在管理项目依赖和开发环境时显得尤为重要。
依赖隔离
虚拟环境允许你为每个项目创建独立的依赖环境。这意味着一个项目中的库和版本不会影响到另一个项目。这样可以避免版本冲突和兼容性问题。更好的项目管理
在虚拟环境中，你可以安装特定于某个项目的依赖包，并确保这些包的版本是项目所需的版本。这有助于确保项目在不同开发环境中的一致性。简化部署
使用虚拟环境可以简化项目的部署过程。通过生成 requirements.txt 文件，你可以轻松地在任何环境中重现项目的依赖配置，从而简化应用的安装和部署。提高安全性
虚拟环境可以隔离项目的依赖包，从而减少与系统全局包的交互。这有助于避免意外修改系统级的库和包，降低了引入安全风险的可能性。多个 Python 版本共存
虚拟环境允许你在同一台机器上使用不同版本的 Python。这对于需要同时维护和开发多个基于不同 Python 版本的项目特别有用。简化开发环境设置
开发人员可以为项目创建一个统一的开发环境配置，确保团队成员之间的一致性。通过共享虚拟环境配置文件（如 requirements.txt），团队成员可以快速搭建和同步开发环境。避免权限问题
在某些操作系统上，安装全局包可能需要管理员权限。使用虚拟环境可以避免这些权限问题，因为虚拟环境中的包安装在用户目录下，无需管理员权限。提供清洁的环境
虚拟环境提供一个干净的工作区，不包含任何未使用的全局安装包。这使得调试和测试更加简洁和明确。 总结
使用虚拟环境不仅能提高开发效率，还能减少项目之间的依赖冲突和兼容性问题，是现代 Python 开发中不可或缺的工具。通过合理利用虚拟环境，开发人员可以更好地管理和维护项目，提高开发和部署的质量和效率。
创建 Python 虚拟环境 安装 virtualenv（可选） virtualenv是一个用于创建隔离的Python环境的第三方工具。虽然 Python 3.3 及以上版本内置了venv模块，可以直接创建虚拟环境，但virtualenv提供了一些额外的功能和更广泛的兼容性，特别是在早于 Python 3.3 的版本中。
如果你使用的是 Python 3.3 或更高版本，并且只需要基本的虚拟环境功能，那么你可能不需要安装virtualenv，因为你可以直接使用内置的venv模块。然而，如果你需要virtualenv提供的额外功能或者你在使用早于 Python 3.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-29T20:08:32+08:00">
    <meta property="article:modified_time" content="2024-06-29T20:08:32+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Jenkins - Python 虚拟环境</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>Jenkins - Python 虚拟环境</h4> 
 <ul><li><a href="#_1" rel="nofollow">引言</a></li><li><a href="#Python__3" rel="nofollow">Python 虚拟环境</a></li><li><a href="#_Python__26" rel="nofollow">创建 Python 虚拟环境</a></li><li><ul><li><a href="#_virtualenv_30" rel="nofollow">安装 virtualenv（可选）</a></li><li><a href="#_40" rel="nofollow">创建虚拟环境</a></li><li><a href="#_53" rel="nofollow">激活虚拟环境</a></li><li><a href="#_70" rel="nofollow">安装依赖包</a></li><li><a href="#_76" rel="nofollow">退出虚拟环境（可选）</a></li><li><a href="#_83" rel="nofollow">注意</a></li></ul> 
  </li><li><a href="#Python__93" rel="nofollow">Python 虚拟环境实践</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>引言</h2> 
<p>Automation 脚本通常会部署到 Jenkins 上运行，Jenkins 环境是随机分配虚拟机的，有些 Node 上虚拟机环境还都不一样，安装的依赖包，操作系统也各不相同。经常有遇到脚本有时跑失败，有时跑成功了，很大原因就是安装脚本所需的安装包失败。我们可以用虚拟环境来解决这一问题，今天就来了解一下 Python 虚拟环境。</p> 
<h2><a id="Python__3"></a>Python 虚拟环境</h2> 
<p>Python 虚拟环境 (Virtual Environment) 是一种隔离的环境，每个虚拟环境都有自己的 Python 解释器和一组独立的库，从而避免了不同项目之间的依赖冲突。</p> 
<p>使用虚拟环境有许多好处，尤其在管理项目依赖和开发环境时显得尤为重要。</p> 
<ol><li>依赖隔离<br> 虚拟环境允许你为每个项目创建独立的依赖环境。这意味着一个项目中的库和版本不会影响到另一个项目。这样可以避免版本冲突和兼容性问题。</li><li>更好的项目管理<br> 在虚拟环境中，你可以安装特定于某个项目的依赖包，并确保这些包的版本是项目所需的版本。这有助于确保项目在不同开发环境中的一致性。</li><li>简化部署<br> 使用虚拟环境可以简化项目的部署过程。通过生成 requirements.txt 文件，你可以轻松地在任何环境中重现项目的依赖配置，从而简化应用的安装和部署。</li><li>提高安全性<br> 虚拟环境可以隔离项目的依赖包，从而减少与系统全局包的交互。这有助于避免意外修改系统级的库和包，降低了引入安全风险的可能性。</li><li>多个 Python 版本共存<br> 虚拟环境允许你在同一台机器上使用不同版本的 Python。这对于需要同时维护和开发多个基于不同 Python 版本的项目特别有用。</li><li>简化开发环境设置<br> 开发人员可以为项目创建一个统一的开发环境配置，确保团队成员之间的一致性。通过共享虚拟环境配置文件（如 requirements.txt），团队成员可以快速搭建和同步开发环境。</li><li>避免权限问题<br> 在某些操作系统上，安装全局包可能需要管理员权限。使用虚拟环境可以避免这些权限问题，因为虚拟环境中的包安装在用户目录下，无需管理员权限。</li><li>提供清洁的环境<br> 虚拟环境提供一个干净的工作区，不包含任何未使用的全局安装包。这使得调试和测试更加简洁和明确。</li></ol> 
<p>总结<br> 使用虚拟环境不仅能提高开发效率，还能减少项目之间的依赖冲突和兼容性问题，是现代 Python 开发中不可或缺的工具。通过合理利用虚拟环境，开发人员可以更好地管理和维护项目，提高开发和部署的质量和效率。</p> 
<h2><a id="_Python__26"></a>创建 Python 虚拟环境</h2> 
<h3><a id="_virtualenv_30"></a>安装 virtualenv（可选）</h3> 
<p><code>virtualenv</code>是一个用于创建隔离的Python环境的第三方工具。虽然 Python 3.3 及以上版本内置了<code>venv</code>模块，可以直接创建虚拟环境，但<code>virtualenv</code>提供了一些额外的功能和更广泛的兼容性，特别是在早于 Python 3.3 的版本中。<br> 如果你使用的是 Python 3.3 或更高版本，并且只需要基本的虚拟环境功能，那么你可能不需要安装<code>virtualenv</code>，因为你可以直接使用内置的<code>venv</code>模块。然而，如果你需要<code>virtualenv</code>提供的额外功能或者你在使用早于 Python 3.3 的版本，那么你需要安装<code>virtualenv</code>。</p> 
<p>安装<code>virtualenv</code>的命令如下：</p> 
<pre><code class="prism language-shell">pip <span class="token function">install</span> virtualenv
</code></pre> 
<p>这个命令使用<code>pip</code>（Python的包管理器）来安装<code>virtualenv</code>。一旦安装，你就可以使用<code>virtualenv</code>命令来创建虚拟环境了。</p> 
<h3><a id="_40"></a>创建虚拟环境</h3> 
<p>使用 venv 模块（Python 3.3 及以上版本自带）创建虚拟环境：</p> 
<pre><code class="prism language-shell">python <span class="token parameter variable">-m</span> venv myenv
</code></pre> 
<p>或者使用 virtualenv：</p> 
<pre><code class="prism language-shell">virtualenv myenv
</code></pre> 
<p>其中 myenv 是虚拟环境的名称，可以随意命名。<mark>执行这个命令后，venv 或 virtualenv 模块会在当前目录下创建一个名为 myenv 的文件夹，其中包含了一个独立的 Python 解释器以及一个空的 pip 库</mark>。这样，你就可以在这个虚拟环境中安装和管理包，而不会影响到系统级别的Python环境。</p> 
<h3><a id="_53"></a>激活虚拟环境</h3> 
<p>在不同操作系统上，激活虚拟环境的方式略有不同，激活虚拟环境后，你的命令行提示符可能会显示虚拟环境的名称，表明虚拟环境已经被激活。</p> 
<ul><li>Windows：</li></ul> 
<pre><code class="prism language-shell">myenv<span class="token punctuation">\</span>Scripts<span class="token punctuation">\</span>activate
</code></pre> 
<ul><li>macOS 和 Linux:</li></ul> 
<pre><code class="prism language-shell"><span class="token builtin class-name">source</span> myenv/bin/activate
</code></pre> 
<p>如果你遇到了 <code>source: not found</code> 错误，这通常意味着你正在使用的 shell 不识别 source 命令，在Unix或类Unix系统（如 Linux 和 MacOS）中，.（点命令）是 source 命令的一个别名，所以可以尝试下面命令</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">.</span> myvenv/bin/activate
</code></pre> 
<h3><a id="_70"></a>安装依赖包</h3> 
<p>在虚拟环境激活后，可以使用 pip 安装所需的包。例如：</p> 
<pre><code class="prism language-shell">pip <span class="token function">install</span> requests
</code></pre> 
<h3><a id="_76"></a>退出虚拟环境（可选）</h3> 
<p>虚拟环境的激活只对当前 shell session有效，不跨 session 传递，所以这个命令是可选的。<br> 可以通过以下命令退出虚拟环境：</p> 
<pre><code class="prism language-shell">deactivate
</code></pre> 
<h3><a id="_83"></a>注意</h3> 
<p>如果你在一个新的 shell session 中工作，之前激活的虚拟环境不会自动激活。每次你开启一个新的 shell session 时，如果你想在该 session 中使用之前创建的虚拟环境，你需要手动激活它。虚拟环境的激活只对当前 shell session有效，不跨 session 传递。</p> 
<p>这意味着，对于每个新的 shell session，如果你想使用特定的虚拟环境，你需要重复激活步骤。记住，每次你开启一个新的 shell session 并希望使用虚拟环境时，这个激活步骤都是必需的。这确保了你的项目依赖是隔离的，并且不会不小心使用到全局 Python 环境中的包。</p> 
<p>如果在另外一个 Shell session 中不激活虚拟环境，只是临时运行某个命令，也可以直接使用虚拟环境目录下执行命令<br> 例如：</p> 
<pre><code class="prism language-shell">myenv/bin/python <span class="token parameter variable">-m</span> pip <span class="token function">install</span> <span class="token parameter variable">-r</span> requirements.txt 
</code></pre> 
<h2><a id="Python__93"></a>Python 虚拟环境实践</h2> 
<p>下面是一个完整的示例，展示了如何创建和使用虚拟环境：</p> 
<p>命令 <strong>python -m venv myvenv --system-site-packages --clear</strong> 用于创建一个新的 Python 虚拟环境，同时包含了一些特定的选项，如下所述：</p> 
<ul><li>–system-site-packages: 这个选项使得虚拟环境能够访问系统级 Python 安装中的 site-packages 目录下的包。这意味着虚拟环境不仅可以使用在其内部安装的包，还可以使用全局安装的包。</li><li>–clear: 如果目标目录（在这个例子中是 myvenv 目录）已经存在，这个选项会在创建新的虚拟环境之前清除目标目录中的所有内容。这对于重置虚拟环境到一个干净的状态很有用。</li></ul> 
<pre><code class="prism language-shell"><span class="token function">cat</span> /proc/version
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token parameter variable">-y</span> <span class="token function">install</span> python3.8-venv
<span class="token function">whereis</span> python
python <span class="token parameter variable">-V</span>
python3 <span class="token parameter variable">-V</span>
python <span class="token parameter variable">-m</span> venv myvenv --system-site-packages <span class="token parameter variable">--clear</span>
<span class="token builtin class-name">.</span> myvenv/bin/activate
<span class="token comment"># 安装依赖包</span>
pip <span class="token function">install</span> requests
<span class="token comment"># 验证安装</span>
python <span class="token parameter variable">-c</span> <span class="token string">"import requests; print(requests.__version__)"</span>
</code></pre> 
<p>如果在尝试使用 python -m venv myenv 创建虚拟环境时遇到 <code>“ensurepip is not available”</code> 的错误，这意味着 Python 安装中缺少 ensurepip模块，该模块负责在虚拟环境中安装 pip。这个问题可能发生在某些 Python 安装中，特别是在某些 Linux 发行版上，它们可能没有包含ensurepip。<br> Jenkinns 虚拟机这个版本就没有包含 ensurepip。所以需要执行 <strong>sudo apt -y install python3.8-venv</strong> 命令<br> 这条命令是在基于Debian的Linux系统（如Ubuntu）中使用 apt 包管理器安装 python3.8-venv 包的命令<br> python3.8-venv 包提供了 Python 3.8 的虚拟环境支持</p> 
<pre><code class="prism language-bash"><span class="token number">18</span>:42:18 + <span class="token function">cat</span> /proc/version
<span class="token number">18</span>:42:18 Linux version <span class="token number">5.15</span>.0-1063-aws <span class="token punctuation">(</span>buildd@lcy02-amd64-003<span class="token punctuation">)</span> <span class="token punctuation">(</span>gcc <span class="token punctuation">(</span>Ubuntu <span class="token number">9.4</span>.0-1ubuntu1~20.04.2<span class="token punctuation">)</span> <span class="token number">9.4</span>.0, GNU ld <span class="token punctuation">(</span>GNU Binutils <span class="token keyword">for</span> Ubuntu<span class="token punctuation">)</span> <span class="token number">2.34</span><span class="token punctuation">)</span> <span class="token comment">#69~20.04.1-Ubuntu SMP Fri May 10 19:20:12 UTC 2024</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f9b635e06b334926a8fa7e4c9b4b5950/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">最新-Android studio导入依赖库的步骤</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e756e4f7a91867ea543a78c5d06d61e3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">解锁高效办公:ONLYOFFICE版本8.1新功能揭秘与个人使用体验</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>