<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>频谱细化之Chirp-Z变换算法 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/195407489851caa7bab0e156b397e454/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="频谱细化之Chirp-Z变换算法">
  <meta property="og:description" content="文章目录 一、 算法简介二、算法仿真三、仿真结果 一、 算法简介 Chirp-Z变换的核心思想是在 Z 平面的单位圆上沿螺旋线进行等采样，若 已知离散采样序列 x(m)，那么该信号的 Z 变换可表示为：
Chirp-Z 变换算法在 Z 平面的一段螺旋线进行等角采样的示意图如下：
其中，Z0,Z1,…,ZM-1表示螺旋线上等分角的 M 个采样点；A0表示螺旋线上起始点 的半径 A0&lt;1 表示起始采样点在圆内；θ0 表示沿着逆时针的起始采样点相角，可 正可负；φ0表示相邻采样点的角频率差，φ0&lt;0 表示 Zk沿着顺时针顺序采样，φ0&lt;0 表示 Zk沿着逆时针顺序采样
等角采样点 Zk可以表示为：
因此求 X(Zk)的过程转变成求 g(m)和 h(m)的卷积，即 g(m)*h(m)，线性调频 Z 变换的算法流程可以总结如下： (1)选择 FFT 点数 L,要求 L≥M1&#43;M2-1，并且 L=2m； (2)将序列 g(m)扩展为 L 点
(3)计算 g(m)的 L 点离散傅里叶变化 G(k)=FFT[g(m)]；
(4)序列 h(m)选取 L 点；
二、算法仿真 clear; close all; clc; fs = 1024; % 采样率 N = 1024; % 信号长度 nfft = N; n = 0:1:N-1; n1 = fs * (0:nfft/2-1) / nfft; % 时间 x = 1.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-31T19:16:36+08:00">
    <meta property="article:modified_time" content="2024-01-31T19:16:36+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">频谱细化之Chirp-Z变换算法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#__5" rel="nofollow">一、 算法简介</a></li><li><a href="#_22" rel="nofollow">二、算法仿真</a></li><li><a href="#_89" rel="nofollow">三、仿真结果</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="__5"></a>一、 算法简介</h2> 
<p>Chirp-Z变换的核心思想是在 Z 平面的单位圆上沿螺旋线进行等采样，若 已知离散采样序列 x(m)，那么该信号的 Z 变换可表示为：<br> <img src="https://images2.imgbox.com/2c/40/4bE14lbJ_o.png" alt="在这里插入图片描述"><br> Chirp-Z 变换算法在 Z 平面的一段螺旋线进行等角采样的示意图如下：<br> <img src="https://images2.imgbox.com/32/91/evX13ruK_o.png" alt="在这里插入图片描述"><br> 其中，Z0,Z1,…,ZM-1表示螺旋线上等分角的 M 个采样点；A0表示螺旋线上起始点 的半径 A0&lt;1 表示起始采样点在圆内；θ0 表示沿着逆时针的起始采样点相角，可 正可负；φ0表示相邻采样点的角频率差，φ0&lt;0 表示 Zk沿着顺时针顺序采样，φ0&lt;0 表示 Zk沿着逆时针顺序采样<br> 等角采样点 Zk可以表示为：<br> <img src="https://images2.imgbox.com/cc/bb/2k389RIO_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/2c/76/CM8iG6r4_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/93/ec/vnuUwPNc_o.png" alt="在这里插入图片描述"><br> 因此求 X(Zk)的过程转变成求 g(m)和 h(m)的卷积，即 g(m)*h(m)，线性调频 Z 变换的算法流程可以总结如下： (1)选择 FFT 点数 L,要求 L≥M1+M2-1，并且 L=2m； (2)将序列 g(m)扩展为 L 点<br> <img src="https://images2.imgbox.com/6a/63/pDYbQCf2_o.png" alt="在这里插入图片描述"><br> (3)计算 g(m)的 L 点离散傅里叶变化 G(k)=FFT[g(m)]；<br> (4)序列 h(m)选取 L 点；<br> <img src="https://images2.imgbox.com/d3/9b/x71SKpeD_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f7/b6/AToTclPX_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_22"></a>二、算法仿真</h2> 
<pre><code class="prism language-c">clear<span class="token punctuation">;</span>
close all<span class="token punctuation">;</span>
clc<span class="token punctuation">;</span>
fs <span class="token operator">=</span> <span class="token number">1024</span><span class="token punctuation">;</span> <span class="token operator">%</span> 采样率
N <span class="token operator">=</span> <span class="token number">1024</span><span class="token punctuation">;</span> <span class="token operator">%</span> 信号长度
nfft <span class="token operator">=</span> N<span class="token punctuation">;</span>
n <span class="token operator">=</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span>N<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
n1 <span class="token operator">=</span> fs <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span>nfft<span class="token operator">/</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> nfft<span class="token punctuation">;</span> <span class="token operator">%</span> 时间
x <span class="token operator">=</span> <span class="token number">1.5</span> <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> pi <span class="token operator">*</span> <span class="token number">98</span> <span class="token operator">*</span> n <span class="token operator">/</span> fs<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> pi <span class="token operator">*</span> <span class="token number">99</span> <span class="token operator">*</span> n <span class="token operator">/</span> fs<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> pi <span class="token operator">*</span> <span class="token number">100.</span> <span class="token operator">*</span> n <span class="token operator">/</span> fs<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3.5</span> <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> pi <span class="token operator">*</span> <span class="token number">101</span> <span class="token operator">*</span> n <span class="token operator">/</span> fs<span class="token punctuation">)</span><span class="token punctuation">;</span>
range_win <span class="token operator">=</span> <span class="token function">hamming</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token operator">%</span>海明窗
<span class="token operator">%</span> range_win <span class="token operator">=</span> <span class="token function">hanning</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token operator">%</span>汉宁窗
x<span class="token operator">=</span>x<span class="token punctuation">.</span><span class="token operator">*</span>range_win'<span class="token punctuation">;</span>
<span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> x<span class="token punctuation">,</span> <span class="token char">'LineWidth'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token char">'Color'</span><span class="token punctuation">,</span> <span class="token char">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ax1 <span class="token operator">=</span> gca<span class="token punctuation">;</span>  <span class="token operator">%</span> 获取当前子图的坐标轴对象
ax1<span class="token punctuation">.</span>FontSize <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span>  <span class="token operator">%</span> 设置坐标轴上文字的字体大小
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token char">'采样点数'</span><span class="token punctuation">,</span><span class="token char">'FontSize'</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token char">'幅值'</span><span class="token punctuation">,</span><span class="token char">'FontSize'</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'原始信号'</span><span class="token punctuation">,</span><span class="token char">'FontSize'</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span> 信号的FFT
XK <span class="token operator">=</span> <span class="token function">fft</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> nfft<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">211</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">XK</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token punctuation">(</span>N<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span>
grid on<span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'信号的FFT'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span> CZT频谱
f1 <span class="token operator">=</span> <span class="token number">93</span><span class="token punctuation">;</span> <span class="token operator">%</span> 细化起始范围
f2 <span class="token operator">=</span> <span class="token number">106</span><span class="token punctuation">;</span> <span class="token operator">%</span> 细化结束范围
M <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span> <span class="token operator">%</span> 细化倍数
w <span class="token operator">=</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span>j <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">*</span> pi <span class="token operator">*</span> <span class="token punctuation">(</span>f2 <span class="token operator">-</span> f1<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>fs <span class="token operator">*</span> M<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
a <span class="token operator">=</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token number">1</span>j <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">*</span> pi <span class="token operator">*</span> f1 <span class="token operator">/</span> fs<span class="token punctuation">)</span><span class="token punctuation">;</span>
xk <span class="token operator">=</span> <span class="token function">czt</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> M<span class="token punctuation">,</span> w<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
h <span class="token operator">=</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span>M<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
f0 <span class="token operator">=</span> <span class="token punctuation">(</span>f2 <span class="token operator">-</span> f1<span class="token punctuation">)</span> <span class="token operator">/</span> M <span class="token operator">*</span> h <span class="token operator">+</span> f1<span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">212</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>f0<span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token function">abs</span><span class="token punctuation">(</span>xk<span class="token punctuation">)</span> <span class="token operator">/</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token char">'f'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token char">'value'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'CZT频谱细化后'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span> 对比FFT和CZT频谱
<span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">211</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">XK</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token punctuation">(</span>N<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> N<span class="token punctuation">,</span> <span class="token char">'b'</span><span class="token punctuation">,</span> <span class="token char">'LineWidth'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
grid on<span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'FFT和CZT仿真对比'</span><span class="token punctuation">,</span><span class="token char">'FontSize'</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ax1 <span class="token operator">=</span> gca<span class="token punctuation">;</span>  <span class="token operator">%</span> 获取当前子图的坐标轴对象
ax1<span class="token punctuation">.</span>FontSize <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span>  <span class="token operator">%</span> 设置坐标轴上文字的字体大小
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token char">'Frequency (Hz)'</span><span class="token punctuation">,</span><span class="token char">'FontSize'</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token char">'Amplitude'</span><span class="token punctuation">,</span><span class="token char">'FontSize'</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">legend</span><span class="token punctuation">(</span><span class="token char">'FFT'</span><span class="token punctuation">,</span><span class="token char">'FontSize'</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">212</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>f0<span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token function">abs</span><span class="token punctuation">(</span>xk<span class="token punctuation">)</span> <span class="token operator">/</span> N<span class="token punctuation">,</span> <span class="token char">'r'</span><span class="token punctuation">,</span> <span class="token char">'LineWidth'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ax1 <span class="token operator">=</span> gca<span class="token punctuation">;</span>  <span class="token operator">%</span> 获取当前子图的坐标轴对象
ax1<span class="token punctuation">.</span>FontSize <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span>  <span class="token operator">%</span> 设置坐标轴上文字的字体大小
grid on<span class="token punctuation">;</span>
<span class="token operator">%</span> <span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'CZT频谱细化后'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token char">'Frequency (Hz)'</span><span class="token punctuation">,</span><span class="token char">'FontSize'</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token char">'Amplitude'</span><span class="token punctuation">,</span><span class="token char">'FontSize'</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">legend</span><span class="token punctuation">(</span><span class="token char">'CZT'</span><span class="token punctuation">,</span><span class="token char">'FontSize'</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="_89"></a>三、仿真结果</h2> 
<p><img src="https://images2.imgbox.com/17/dc/K22OBnqa_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b2/50/CSJ1dBlR_o.png" alt="在这里插入图片描述"></p> 
<hr>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ab3342442c3a0c2a65aa7f80693915fa/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">8款有效删除Android锁屏的手机解锁软件</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/32be32238ff5632edb6215426770a057/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">学生宿舍管理系统设计与实现(源码&#43;数据库&#43;文档)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>