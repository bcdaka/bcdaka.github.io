<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Mysql中使用where 1=1有什么问题吗 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/d63d9c83a9d25afcc4bfdf443c97d46f/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Mysql中使用where 1=1有什么问题吗">
  <meta property="og:description" content="昨天偶然看见一篇文章，提到说如果在mysql查询语句中，使用where 1=1会有性能问题？？
这着实把我吸引了，因为我项目中就有不少同事，包括我自己也有这样写的。为了不给其他人挖坑，赶紧学习一下，这样写sql到底有没有性能问题？
where 1=1的使用场景 我们来看下，where 1=1实际是怎么使用的， 先来看一段SQL
&lt;select id=&#34;selectCmsCourseList&#34; parameterType=&#34;java.util.Map&#34; resultMap=&#34;CourseMap&#34;&gt; SELECT a.id, a.category_id, a.model_id, b.* FROM cms_content a LEFT JOIN cms_course b ON a.id = b.id WHERE 1=1 &lt;if test=&#34;courseName != null and courseName != &#39;&#39;&#34;&gt; AND b.course_name like concat(concat(&#34;%&#34;,#{courseName}),&#34;%&#34;) &lt;/if&gt; &lt;if test=&#34;disabled != null&#34;&gt; AND a.disabled = #{disabled} &lt;/if&gt; &lt;if test=&#34;categoryId != null&#34;&gt; AND a.category_id = #{categoryId} &lt;/if&gt; &lt;/select&gt; 如果用过mybatis的童鞋，看到这段代码应该很熟悉了吧，这里使用where 1=1的作用，就是为了方便后面的条件，能通过if判断，使用AND连接起来，这样即使后面if全部是false，没有参数，这个sql也不会报错。
where 1=1的替换方案 其实上面的这个写法，如果用mybatis，完全可以用where标签来替换,如：
&lt;select id=&#34;selectCmsCourseList&#34; parameterType=&#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-12T17:00:20+08:00">
    <meta property="article:modified_time" content="2024-06-12T17:00:20+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Mysql中使用where 1=1有什么问题吗</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>昨天偶然看见一篇文章，提到说如果在mysql查询语句中，使用<code>where 1=1</code>会有性能问题？？</p> 
<p>这着实把我吸引了，因为我项目中就有不少同事，包括我自己也有这样写的。为了不给其他人挖坑，赶紧学习一下，这样写sql到底有没有性能问题？</p> 
<h3><code>where 1=1</code>的使用场景</h3> 
<p>我们来看下，<code>where 1=1</code>实际是怎么使用的， 先来看一段SQL</p> 
<pre><code>&lt;select id="selectCmsCourseList" parameterType="java.util.Map" resultMap="CourseMap"&gt;
    SELECT
     a.id,
     a.category_id,
     a.model_id,
     b.*
    FROM
     cms_content a
    LEFT JOIN cms_course b ON a.id = b.id
    WHERE 1=1
    &lt;if test="courseName != null and courseName != ''"&gt;
       AND b.course_name like concat(concat("%",#{courseName}),"%")
    &lt;/if&gt;
    &lt;if test="disabled != null"&gt;
       AND a.disabled = #{disabled}
    &lt;/if&gt;
    &lt;if test="categoryId != null"&gt;
       AND a.category_id = #{categoryId}
    &lt;/if&gt;
&lt;/select&gt;
</code></pre> 
<p>如果用过mybatis的童鞋，看到这段代码应该很熟悉了吧，这里使用<code>where 1=1</code>的作用，就是为了方便后面的条件，能通过<code>if</code>判断，使用<code>AND</code>连接起来，这样即使后面<code>if</code>全部是<code>false</code>，没有参数，这个<code>sql</code>也不会报错。</p> 
<h3><code>where 1=1</code>的替换方案</h3> 
<p>其实上面的这个写法，如果用mybatis，完全可以用<code>where</code>标签来替换,如：</p> 
<pre><code>&lt;select id="selectCmsCourseList" parameterType="java.util.Map" resultMap="CourseMap"&gt;
    SELECT
     a.id,
     a.category_id,
     a.model_id,
     b.*
    FROM
     cms_content a
    LEFT JOIN cms_course b ON a.id = b.id
    &lt;where&gt;
        &lt;if test="courseName != null and courseName != ''"&gt;
           AND b.course_name like concat(concat("%",#{courseName}),"%")
        &lt;/if&gt;
        &lt;if test="disabled != null"&gt;
           AND a.disabled = #{disabled}
        &lt;/if&gt;
        &lt;if test="categoryId != null"&gt;
           AND a.category_id = #{categoryId}
        &lt;/if&gt;
    &lt;/where&gt;
&lt;/select&gt;
</code></pre> 
<p>如果你使用了这个写法，就不存在<code>1=1</code>的问题了，所以也不用纠结，但本着打破砂锅问到底的精神，我们还是得探究一下使用<code>1=1</code>到底有没有性能问题</p> 
<h3>使用<code>where 1=1</code>有性能问题吗？</h3> 
<h4>先来问问AI</h4> 
<p></p> 
<p class="img-center"><img alt="" height="334" src="https://images2.imgbox.com/b8/4f/8p8srL5a_o.png" width="839"></p> 
<p>可以看到，AI给到的答复是，基本没有性能问题，更多的是代码风格和可读性！</p> 
<h4>亲自检测</h4> 
<p>为了跟进一步测试，我们来写个SQL看看实际性能是否有差别</p> 
<ol><li> <p><code>explain select * from user;</code></p> <p></p> <p class="img-center"><img alt="" height="202" src="https://images2.imgbox.com/58/9d/lSXFOBp1_o.png" width="805"></p> </li><li> <p><code>explain select * from user where 1=1;</code></p> <p></p> <p class="img-center"><img alt="" height="252" src="https://images2.imgbox.com/da/4a/94TZQBol_o.png" width="801"></p> </li><li> <p><code>explain select * from user where id = 8;</code></p> <p></p> <p class="img-center"><img alt="" height="241" src="https://images2.imgbox.com/d2/e4/ufLDa2jM_o.png" width="799"></p> </li><li> <p><code>explain select * from user where 1=1 and id = 8;</code></p> </li></ol> 
<p><img alt="" class="left" height="255" src="https://images2.imgbox.com/69/0d/YZnbteuU_o.png" width="809"></p> 
<p>可以看到示例1和示例2， 示例3和示例4，这两组写法，都是有个<code>1=1</code>的区别，但性能都是一样的，因此我们基本可以判定，这个写法，对性能是没有影响的。</p> 
<h3>总结</h3> 
<p>如果你在项目中也有使用<code>where 1=1</code>写的SQL，如果从可读性或者代码风格考虑，建议优化掉，但如果担心性能问题，则大可不必过多考虑~</p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e332f0276643cce14bf2ef32b57e173e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">map 详细解析 Java 8 Stream API 中的 map 方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fc5c6316a0be45ef19aa0cf7b39cf008/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java设计模式和面向对象编程思想</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>