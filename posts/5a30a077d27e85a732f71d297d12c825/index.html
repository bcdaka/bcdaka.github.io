<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>useImperativeHandle浅谈 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/5a30a077d27e85a732f71d297d12c825/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="useImperativeHandle浅谈">
  <meta property="og:description" content="useImperativeHandle 是 React Hooks 提供的一个高级功能，它允许你在函数式组件中自定义并暴露特定的实例值或方法给父组件。主要的作用是：
自定义对外暴露的实例值或方法: 通常情况下，函数式组件内部的实例值或方法对外是不可见的，而 useImperativeHandle 可以让你选择性地暴露一些特定的实例值或方法给外部使用。
优化子组件对外暴露的接口: 通过 useImperativeHandle 可以控制子组件对外暴露的接口，避免过多或不必要的暴露，从而更好地封装组件内部逻辑。
使用方法 在使用 useImperativeHandle 时，通常需要配合 React.forwardRef 使用，因为 useImperativeHandle 是用来定制 ref 对象上暴露的内容。
示例代码如下：
import React, { useRef, useImperativeHandle, forwardRef } from &#39;react&#39;; // 子组件 const ChildComponent = forwardRef((props, ref) =&gt; { const internalRef = useRef(); // 使用 useImperativeHandle 定制对外暴露的内容 useImperativeHandle(ref, () =&gt; ({ // 这里定义了暴露给父组件的方法或属性 // 例如，暴露一个方法 focus: () =&gt; { internalRef.current.focus(); }, // 或者暴露一个属性 value: internalRef.current.value, })); return &lt;input ref={internalRef} /&gt;; }); // 父组件 const ParentComponent = () =&gt; { const childRef = useRef(); const handleClick = () =&gt; { // 使用子组件暴露的方法 childRef.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-07T16:15:33+08:00">
    <meta property="article:modified_time" content="2024-07-07T16:15:33+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">useImperativeHandle浅谈</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><code>useImperativeHandle</code> 是 React Hooks 提供的一个高级功能，它允许你在函数式组件中自定义并暴露特定的实例值或方法给父组件。主要的作用是：</p> 
<ol><li> <p><strong>自定义对外暴露的实例值或方法</strong>: 通常情况下，函数式组件内部的实例值或方法对外是不可见的，而 <code>useImperativeHandle</code> 可以让你选择性地暴露一些特定的实例值或方法给外部使用。</p> </li><li> <p><strong>优化子组件对外暴露的接口</strong>: 通过 <code>useImperativeHandle</code> 可以控制子组件对外暴露的接口，避免过多或不必要的暴露，从而更好地封装组件内部逻辑。</p> </li></ol> 
<h4><a id="_6"></a>使用方法</h4> 
<p>在使用 <code>useImperativeHandle</code> 时，通常需要配合 <code>React.forwardRef</code> 使用，因为 <code>useImperativeHandle</code> 是用来定制 <code>ref</code> 对象上暴露的内容。</p> 
<p>示例代码如下：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> useRef<span class="token punctuation">,</span> useImperativeHandle<span class="token punctuation">,</span> forwardRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token comment">// 子组件</span>
<span class="token keyword">const</span> ChildComponent <span class="token operator">=</span> <span class="token function">forwardRef</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> ref</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> internalRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 使用 useImperativeHandle 定制对外暴露的内容</span>
    <span class="token function">useImperativeHandle</span><span class="token punctuation">(</span>ref<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 这里定义了暴露给父组件的方法或属性</span>
        <span class="token comment">// 例如，暴露一个方法</span>
        <span class="token function-variable function">focus</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            internalRef<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// 或者暴露一个属性</span>
        <span class="token literal-property property">value</span><span class="token operator">:</span> internalRef<span class="token punctuation">.</span>current<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token operator">&lt;</span>input ref<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>internalRef<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 父组件</span>
<span class="token keyword">const</span> <span class="token function-variable function">ParentComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> childRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 使用子组件暴露的方法</span>
        childRef<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>ChildComponent ref<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>childRef<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>handleClick<span class="token punctuation">}</span><span class="token operator">&gt;</span>Focus Child Input<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_51"></a>解释</h4> 
<ul><li> <p><strong>ChildComponent</strong>: 在子组件中，使用 <code>useImperativeHandle</code> 定制了 <code>ref</code> 对象上的内容。这里例子中定义了一个 <code>focus</code> 方法，使得父组件可以调用子组件的输入框获得焦点。同时也暴露了一个 <code>value</code> 属性，用于获取输入框的值。</p> </li><li> <p><strong>ParentComponent</strong>: 在父组件中，创建了一个 <code>childRef</code>，并通过 <code>ref</code> 属性将其传递给 <code>ChildComponent</code>。然后可以通过 <code>childRef.current</code> 来访问 <code>ChildComponent</code> 中暴露的方法和属性，实现与子组件的交互。</p> </li></ul> 
<p>总之，<code>useImperativeHandle</code> 提供了一种灵活的方式，让你可以在函数式组件中控制对外暴露的接口，使得组件封装更加清晰和灵活。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bb6799795da7d85315d5861393afad29/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">工欲善其事必先利其器——Anaconda安装教程（2024版本）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7499ece6507b9dd8c6c88d51762f36db/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">为什么要设计DTO类</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>