<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Xcode发布AppStore与TestFlight全流程 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/52e7567ec6afec50c46cc9dc2b0a8202/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Xcode发布AppStore与TestFlight全流程">
  <meta property="og:description" content="目录 调试流程看我另一个链接
[游戏开发][Unity] IOS调试与发布-CSDN博客[游戏开发][Unity] IOS调试与发布https://blog.csdn.net/liuyongjie1992/article/details/136836480
打包前注意事项 使用Xcode导出安装包之前，必须先确认账户的所有合约是否全部同意，如果有不同意的，在出包的时候会弹出报错
点击前往苹果开发者官网https://appstoreconnect.apple.com/agreements/
登录自己的开发者账户后，可以看到提示，有未同意的合约
还有一点要注意的是，Xcode工程在导出安装包之前，执行build必须没有错误。
发布前设置 如果你导入了_dis证书，则上传的是正式包，如果你导入的是_dev证书，则发布的是TestFlight包，当然上传还得选择Archive选项导出Archive包。
Build报错记录
Command PhaseScriptExecution failed with a nonzero exit code
双击可以查看报错信息，这个报错是因为Unity给我们xcode工程生成了一个sh文件，但运行它的时候有语法错误，我直接把整个运行sh的地方删了。因为它考虑的armv7，咱们不考虑，都是arm64了。
/Users/hailong/Documents/ZhangMenXcode/Unity-iPhone.xcodeproj has conflicting provisioning settings. is automatically signed, but provisioning profile ZMDJ_dis has been manually specified. Set the provisioning profile value to &#34;Automatic&#34; in the build settings editor, or switch to manual signing in the Signing &amp; Capabilities editor.
这个问题就是，如果你自己选择了手动输入证书，则设置界面不允许选择autumatic自动选择任何东西。
确认编译运行Scheme，这一步很关键，直接决定项目运行编译能否通过
第一步 先在Xcode中，菜单栏 =&gt; Product=&gt; Archive 开始打包Archive，右上角显示打包Archive进度">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-19T11:19:10+08:00">
    <meta property="article:modified_time" content="2024-03-19T11:19:10+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Xcode发布AppStore与TestFlight全流程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>目录</h2> 
<p>调试流程看我另一个链接</p> 
<p><a class="has-card" href="https://blog.csdn.net/liuyongjie1992/article/details/136836480" title="[游戏开发][Unity] IOS调试与发布-CSDN博客"><span class="link-card-box"><span class="link-title">[游戏开发][Unity] IOS调试与发布-CSDN博客</span><span class="link-desc">[游戏开发][Unity] IOS调试与发布</span><span class="link-link"><img alt="" class="link-link-icon" src="https://images2.imgbox.com/da/b8/uZB74HAs_o.png">https://blog.csdn.net/liuyongjie1992/article/details/136836480</span></span></a></p> 
<h2>打包前注意事项</h2> 
<p>使用Xcode导出安装包之前，必须先确认账户的所有合约是否全部同意，如果有不同意的，在出包的时候会弹出报错</p> 
<p><img alt="" height="600" src="https://images2.imgbox.com/4a/57/cN1VVPGx_o.png" width="978"><br><span style="color:#212529;"><span style="background-color:#ffffff;"><a class="has-card" href="https://appstoreconnect.apple.com/agreements/" rel="nofollow" style="margin-left:2px;" title="点击前往苹果开发者官网"><span class="link-card-box"><span class="link-title">点击前往苹果开发者官网</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/78/e7/Fvs6JndF_o.png" alt="icon-default.png?t=N7T8">https://appstoreconnect.apple.com/agreements/</span></span></a></span></span></p> 
<div style="text-align:left;"> 
 <p>登录自己的开发者账户后，可以看到提示，有未同意的合约</p> 
 <p>还有一点要注意的是，Xcode工程在导出安装包之前，执行build必须没有错误。</p> 
 <p></p> 
 <h2>发布前设置</h2> 
 <p>如果你导入了_dis证书，则上传的是正式包，如果你导入的是_dev证书，则发布的是TestFlight包，当然上传还得选择Archive选项导出Archive包。</p> 
 <p><img alt="" height="415" src="https://images2.imgbox.com/b5/86/oI8HzVVd_o.png" width="478"></p> 
 <p><img alt="" height="566" src="https://images2.imgbox.com/68/fc/pwc2FgeP_o.png" width="798"></p> 
 <p>Build报错记录</p> 
 <p><span style="color:#fe2c24;">Command PhaseScriptExecution failed with a nonzero exit code</span><br><img alt="" height="115" src="https://images2.imgbox.com/0e/08/iQV3Uy9Q_o.png" width="428"></p> 
 <p>双击可以查看报错信息，这个报错是因为Unity给我们xcode工程生成了一个sh文件，但运行它的时候有语法错误，我直接把整个运行sh的地方删了。因为它考虑的armv7，咱们不考虑，都是arm64了。</p> 
 <hr> 
 <p><span style="color:#fe2c24;">/Users/hailong/Documents/ZhangMenXcode/Unity-iPhone.xcodeproj      has conflicting provisioning settings.      is automatically signed, but provisioning profile ZMDJ_dis has been manually specified. Set the provisioning profile value to "Automatic" in the build settings editor, or switch to manual signing in the Signing &amp; Capabilities editor.</span></p> 
 <p><span style="color:#fe2c24;">这个问题就是，如果你自己选择了手动输入证书，则设置界面不允许选择autumatic自动选择任何东西。</span></p> 
 <p><img alt="" height="415" src="https://images2.imgbox.com/82/35/GhSTE6u1_o.png" width="478"></p> 
 <p><img alt="" height="566" src="https://images2.imgbox.com/1b/d2/su7xN5ss_o.png" width="798"></p> 
 <p>确认编译运行Scheme，这一步很关键，直接决定项目运行编译能否通过</p> 
 <h2><img alt="" height="203" src="https://images2.imgbox.com/8c/f8/Aiuohzmo_o.png" width="308"></h2> 
 <h2><img alt="" height="326" src="https://images2.imgbox.com/f0/10/dR6GvhOP_o.png" width="814"></h2> 
 <h2>第一步</h2> 
 <p>先在Xcode中，菜单栏  =&gt;  Product=&gt; Archive 开始打包Archive，右上角显示打包Archive进度</p> 
 <p><img alt="" height="679" src="https://images2.imgbox.com/b2/ff/Ug9LQ5UT_o.png" width="1200"></p> 
 <h2>第二步</h2> 
 <p>第三步：</p> 
 <p>选择一个Archive，Distribute App按钮才会亮起</p> 
 <p><img alt="" height="276" src="https://images2.imgbox.com/05/69/nU3BFXmO_o.png" width="1005"></p> 
 <p>在访达中查看一下， 文件类型是xcarchive</p> 
 <p><img alt="" height="217" src="https://images2.imgbox.com/22/42/XnYiOJNU_o.png" width="1006"></p> 
 <p><img alt="" height="461" src="https://images2.imgbox.com/fb/c1/2KlUqoNj_o.png" width="920"></p> 
 <p>点击Distribute App按钮</p> 
 <h2>第三步</h2> 
 <p>咱们要发布TestFlight，所以选第一项，点击右下角Next下一步</p> 
 <p><img alt="" height="456" src="https://images2.imgbox.com/bd/ed/1Jh2V0LC_o.png" width="847"></p> 
 <h2>第四步</h2> 
 <p>Upload会直接把这个包上传到官网</p> 
 <p>Export则是导出IPA文件，你自己使用工具上传，如果你想自己上传，请移步第第六步之后的Transporter上传。</p> 
 <p><img alt="" height="462" src="https://images2.imgbox.com/c9/65/SxBA33Tl_o.png" width="856"></p> 
 <p>发布正式包会有下面的弹窗，记得选择证书哦<img alt="" height="474" src="https://images2.imgbox.com/50/3a/WafFYvvd_o.png" width="787"></p> 
 <h2>第五步</h2> 
 <p><img alt="" height="470" src="https://images2.imgbox.com/69/af/6PRDfO4k_o.png" width="857"></p> 
</div> 
<h2> 第六步</h2> 
<p>使用Xcode-archive上传</p> 
<p>再次确认上传信息，没问题点击上传<img alt="" height="451" src="https://images2.imgbox.com/09/78/rUfr0PgA_o.png" width="744"></p> 
<p> 正在上传<img alt="" height="450" src="https://images2.imgbox.com/7c/d7/9zJxiVtl_o.png" width="743"></p> 
<p><img alt="" height="36" src="https://images2.imgbox.com/26/c8/lOcDLaAn_o.png" width="472"></p> 
<p><span style="color:#fe2c24;"><strong>报错！！！！</strong></span></p> 
<p>如果包里有不可执行的文件，会报这个错</p> 
<p><img alt="" height="456" src="https://images2.imgbox.com/e2/ad/lbBySVcB_o.png" width="754"></p> 
<p><span style="color:#fe2c24;">Unexpected CFBundleExecutable Key. The bundle at 'Payload/hqhy.app/hqsdk.bundle' does not contain a bundle executable. If this bundle intentionally does not contain an executable, consider removing the CFBundleExecutable key from its Info.plist and using a CFBundlePackageType of BNDL. If this bundle is part of a third-party framework, consider contacting the developer of the framework for an update to address this issue. (ID: cfea2d8a-ff26-4674-81dd-7893c3469456)</span></p> 
<blockquote> 
 <p><span style="color:#0d0016;">解决方法：</span></p> 
</blockquote> 
<p> 回到Xcode项目中，在文件目录里找到对应名字的文件夹，例如我的报错是hqsdk.bundle，找到里面的info.plist文件，把里面的ExecutableFile选项删掉，点那个删除按钮，这里的配图不是我项目的截图</p> 
<p><img alt="" height="932" src="https://images2.imgbox.com/f8/35/U3d3W3Tp_o.png" width="1200"></p> 
<p>第七步：Xcode上传</p> 
<p><img alt="" height="450" src="https://images2.imgbox.com/f6/38/imLirf1X_o.png" width="744"></p> 
<p>看上传的提示 Uploading to App Store Connect...</p> 
<p>App Store Connect是啥？？看截图就知道，这是管理我们开发者账户所有app的地方</p> 
<p><img alt="" height="715" src="https://images2.imgbox.com/b2/00/yH4oQBpC_o.png" width="1200"></p> 
<p>上传成功后，App Store Connect就会出现我们刚才上传的版本图标。点击图标进去</p> 
<p><img alt="" height="499" src="https://images2.imgbox.com/d8/4a/hh5J3HYT_o.png" width="1200"></p> 
<p> 由于我们上传的是TestFlight版本，只看TestFlight选项就好了，版本2.1.1和我在Xcode上传时一致，证明上传成功了。</p> 
<p></p> 
<p><strong>使用Mac Transporter软件上传</strong></p> 
<p>支持ipa文件和pck文件上传，这个ipa文件怎么来的？在前文的Archive上传过程中，可以选择只导出不上传，这个Export就是导出ipa工程</p> 
<p><img alt="" height="156" src="https://images2.imgbox.com/3a/18/ZQf4A3l5_o.png" width="298"></p> 
<p><img alt="" height="441" src="https://images2.imgbox.com/80/92/MVXs98eN_o.png" width="721"></p> 
<p>把这个ipa文件拖拽到到Transporter中，按步骤点击上传即可，非常简单，下图是上传画面</p> 
<p><img alt="" height="630" src="https://images2.imgbox.com/9f/ef/ijihHlT0_o.png" width="843"></p> 
<h2>第七步</h2> 
<p>上传成功后，需要等待官方检查是否通过审核吗，审核时间短则5分钟，长则一天，请留意邮件</p> 
<p>上传成功后，去AppStoreConnect官网查看上传版本，请注意刚上传需要审核<br>  </p> 
<p>这是正式发布成功的样子，上传时用选的是Distribution证书</p> 
<p><img alt="" height="488" src="https://images2.imgbox.com/a2/ab/9PdQLJnI_o.png" width="1200"></p> 
<p>这是发布TestFlight成功的样子，上传时选的是开发证书 </p> 
<p><img alt="" height="519" src="https://images2.imgbox.com/ed/2f/TqYGba0J_o.png" width="1200"></p> 
<p>失败的话就是这个样子，版本里面空空如也</p> 
<p><img alt="" height="487" src="https://images2.imgbox.com/d6/1f/AL0010sY_o.png" width="1200"></p> 
<p>遇到这种情况，去你的邮箱里查看具体原因</p> 
<p><img alt="" height="830" src="https://images2.imgbox.com/d7/cc/TQpbuhFv_o.png" width="1200"></p> 
<p>TestFlight网站出现版本号和图标，并且文字是(正在处理)，基本就稳了，等着吧。</p> 
<p><img alt="" height="543" src="https://images2.imgbox.com/ae/0d/ZfVeXD99_o.png" width="1200"></p> 
<h2>第八步</h2> 
<p>正在等待审核的字样</p> 
<p><img alt="" height="184" src="https://images2.imgbox.com/ea/a8/hx30C4DG_o.png" width="1061"></p> 
<h2>第九步</h2> 
<p><img alt="" height="580" src="https://images2.imgbox.com/6e/5d/QKajcAl5_o.png" width="1200"></p> 
<h2>第十步 </h2> 
<p>你可以选择创建外部测试小组，然后在版本里添加小组。必须添加小组才能在小组里看到外部链接</p> 
<p><img alt="" height="449" src="https://images2.imgbox.com/13/95/glJs4xQy_o.png" width="1200"></p> 
<h2>第十一步</h2> 
<p>启动公开链接，显示testflight测试连接。</p> 
<p><img alt="" height="978" src="https://images2.imgbox.com/5d/89/xwmuqHjR_o.png" width="1200"></p> 
<h2></h2> 
<h2>第十二步</h2> 
<p>打开iphone手机，访问图里的公开链接</p> 
<p><img alt="" height="286" src="https://images2.imgbox.com/79/45/umNvOD8i_o.png" width="1068"></p> 
<p></p> 
<p>没加入版本的测试小组，则没有启动公开链接的按钮，如下图所示</p> 
<h2><img alt="" height="254" src="https://images2.imgbox.com/99/db/KJhQQTzF_o.png" width="1200"></h2> 
<p></p> 
<h2>第十三步</h2> 
<p>下图是iphone手机访问链接的样子，点击开始测试按钮就开始下载了。大功告成！</p> 
<p><img alt="" height="506" src="https://images2.imgbox.com/7d/a4/N27bR8Nh_o.png" width="379"></p> 
<h2>记录一些报错</h2> 
<p>遇到报错不要慌，几乎所有的报错在网上都能查到解决方案。</p> 
<p><img alt="" height="445" src="https://images2.imgbox.com/2a/e3/t112cNyn_o.png" width="758"></p> 
<p><img alt="" height="631" src="https://images2.imgbox.com/4b/b1/jpxDdYBh_o.png" width="962"> 找到报错对应名字的文件夹，找到Info.plist文件，然后删除掉这一行。</p> 
<hr> 
<blockquote> 
 <p> <strong>ITMS-90683: Missing purpose string in Info.plist</strong> - Your app’s code references one or more APIs that access sensitive user data, or the app has one or more entitlements that permit such access. The Info.plist file for the “hqhy.app” bundle should contain a <span style="color:#fe2c24;">NSPhotoLibraryUsageDescription </span>key with a user-facing purpose string explaining clearly and completely why your app needs the data. If you’re using external libraries or SDKs, they may reference APIs that require a purpose string. While your app might not use these APIs, a purpose string is still required. For details</p> 
</blockquote> 
<p>我的原因是权限问题，需要添加权限，根据邮件提示，找到对应的plist文件，添加一行新数据，把相机权限复制进去进去，它自己就变成了Privacy - Photo Library Usage Description，然后value就是弹出的文字提示，自己写啥都行</p> 
<p><span style="color:#fe2c24;">请注意!!!!!!!!!!!!!!!!!!!!!!!!</span></p> 
<p>1： NSPhotoLibraryUsageDescription</p> 
<p>2： NSPhotoLibraryAddUsageDescription</p> 
<p>这俩权限不一样，请按照拒绝邮件里的权限精确复制即可。</p> 
<p><img alt="" height="511" src="https://images2.imgbox.com/5d/26/vPWQyWeh_o.png" width="1091"></p> 
<p>修改所有BUG，再次上传。</p> 
<p><span style="color:#fe2c24;">The provided entity includes a relationship with an invalid value</span></p> 
<p><img alt="" height="469" src="https://images2.imgbox.com/1b/39/Aeu6GAkW_o.png" width="759"></p> 
<p>苹果更新了服务协议，登录苹果开发者账户，只有阅读和同意协议才可以继续上传新的app包</p> 
<p>我遇到的是这种情况，可能还会有别的情况</p> 
<p></p> 
<p><span style="color:#fe2c24;">This bundle is invalid. Invalid XML character '0x0000' at index 2363 in Info.plist. (ID: 33d1b1a9-ec10-485e-a00e-acac933c1ca3)</span></p> 
<p><span style="color:#fe2c24;">问题原因：你修改plist文件，把格式改坏了。或者有写错的权限导致xml格式不正确。</span></p> 
<p><span style="color:#fe2c24;">解决办法：</span></p> 
<p><span style="color:#fe2c24;">我这个报错的原因也是很奇怪，以前开启相机权限的代码:NSPhotoLibraryUsageDescription</span></p> 
<p>这两天Xcode犯病，竟然识别不到这个权限，导致我的plist文件无法打开，过了一天又能识别到。</p> 
<p><img alt="" height="451" src="https://images2.imgbox.com/ed/7e/gZmI93Qe_o.png" width="747"></p> 
<p><span style="color:#fe2c24;"> </span></p> 
<p><span style="color:#fe2c24;">Failed to write chunk 1 to temp file ‘/private/var/folders/kr/n3t4x9q90377cmbc6mqpylq00000gn/T/com.apple.cds.vbtx/com.apple.cds_847581A8-46FB-4A89-9E25-E98666B1CC6E/Part-1.tmp’.</span></p> 
<p><span style="color:#fe2c24;">这种写入问题大概率就是空间不足，检查磁盘空间，</span></p> 
<p><span style="color:#fe2c24;">还有zip fail打包失败，大概率也是。</span></p> 
<p><img alt="" height="450" src="https://images2.imgbox.com/e3/65/MnBepqoH_o.png" width="746"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/72f4ef48c8ab47b5eb04a45cb70d9efe/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Ollama &#43; Openwebui 本地部署大型模型与交互式可视化聊天</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6efd4b7de50316c9c15a8dbce491e36f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Docker 安装 Nginx 容器部署前端项目</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>