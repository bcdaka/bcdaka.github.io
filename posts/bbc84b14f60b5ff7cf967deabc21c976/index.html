<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>前端在WebSocket中加入Token - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/bbc84b14f60b5ff7cf967deabc21c976/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="前端在WebSocket中加入Token">
  <meta property="og:description" content="在WebSocket通信中加入Token主要是为了实现身份验证和授权，确保只有经过验证的用户可以建立WebSocket连接。由于WebSocket API本身不支持直接在连接时设置HTTP头部，因此需要采用一些变通的方法来传递Token。以下是几种常见的方法：
1、通过URL参数传递Token：
在WebSocket的URL中直接携带Token参数。这种方法简单直接，但安全性较低，因为Token会暴露在URL中，容易被截获。
const socket = new WebSocket(&#39;wss://example.com/socket?authorization=&#39; &#43; YOUR_TOKEN);
2、在连接建立后发送Token：
在WebSocket连接建立后，通过onopen事件监听器发送Token。这种方法相对安全，因为Token不会在握手阶段暴露。
const socket = new WebSocket(&#39;wss://example.com/socket&#39;);
socket.addEventListener(&#39;open&#39;, (event) =&gt; {
socket.send(&#39;Authorization: Bearer &#39; &#43; YOUR_TOKEN);
});
3、使用WebSocket子协议（Sec-WebSocket-Protocol）：
利用WebSocket的子协议特性传递Token。这种方法需要服务器端支持并正确处理子协议。
const token = localStorage.getItem(&#39;token&#39;);
const socket = new WebSocket(&#39;wss://example.com/socket&#39;, [token]);
4、使用JWT（JSON Web Token）：
JWT是一种无状态的、可自验证的令牌，可以安全地在客户端和服务器之间传递。客户端在登录后获取JWT，然后在WebSocket连接时将其作为Token传递。
const jwtToken = jwt.sign(payload, secretKey, { expiresIn: &#39;1h&#39; });
// 生成JWT Token
const socket = new WebSocket(&#39;wss://example.com/socket&#39;);
socket.addEventListener(&#39;open&#39;, (event) =&gt; {
socket.send(jwtToken);
});
5、使用服务器端的认证中间件：
在服务器端，可以使用认证中间件（如Express.js的passport.js）来处理WebSocket连接。这样，服务器可以在握手阶段验证Token的有效性。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-02-06T11:45:47+08:00">
    <meta property="article:modified_time" content="2024-02-06T11:45:47+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">前端在WebSocket中加入Token</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>在WebSocket通信中加入Token主要是为了实现身份验证和授权，确保只有经过验证的用户可以建立WebSocket连接。由于WebSocket API本身不支持直接在连接时设置HTTP头部，因此需要采用一些变通的方法来传递Token。以下是几种常见的方法：</p> 
<p></p> 
<p>1、通过URL参数传递Token：</p> 
<p>在WebSocket的URL中直接携带Token参数。这种方法简单直接，但安全性较低，因为Token会暴露在URL中，容易被截获。</p> 
<p></p> 
<p>const socket = new WebSocket('wss://example.com/socket?authorization=' + YOUR_TOKEN);</p> 
<p>2、在连接建立后发送Token：</p> 
<p>在WebSocket连接建立后，通过onopen事件监听器发送Token。这种方法相对安全，因为Token不会在握手阶段暴露。</p> 
<p></p> 
<p>const socket = new WebSocket('wss://example.com/socket');</p> 
<p>socket.addEventListener('open', (event) =&gt; {<!-- --></p> 
<p>  socket.send('Authorization: Bearer ' + YOUR_TOKEN);</p> 
<p>});</p> 
<p>3、使用WebSocket子协议（Sec-WebSocket-Protocol）：</p> 
<p>利用WebSocket的子协议特性传递Token。这种方法需要服务器端支持并正确处理子协议。</p> 
<p></p> 
<p>const token = localStorage.getItem('token');</p> 
<p>const socket = new WebSocket('wss://example.com/socket', [token]);</p> 
<p>4、使用JWT（JSON Web Token）：</p> 
<p>JWT是一种无状态的、可自验证的令牌，可以安全地在客户端和服务器之间传递。客户端在登录后获取JWT，然后在WebSocket连接时将其作为Token传递。</p> 
<p></p> 
<p>const jwtToken = jwt.sign(payload, secretKey, { expiresIn: '1h' });</p> 
<p>// 生成JWT Token</p> 
<p>const socket = new WebSocket('wss://example.com/socket');</p> 
<p>socket.addEventListener('open', (event) =&gt; {<!-- --></p> 
<p>  socket.send(jwtToken);</p> 
<p>});<br> 5、使用服务器端的认证中间件：</p> 
<p>在服务器端，可以使用认证中间件（如Express.js的passport.js）来处理WebSocket连接。这样，服务器可以在握手阶段验证Token的有效性。</p> 
<p></p> 
<p>// 服务器端示例（使用Express.js和socket.io）</p> 
<p>io.use((socket, next) =&gt; {<!-- --></p> 
<p>  const token = socket.handshake.query.authorization;</p> 
<p>  // 验证Token逻辑</p> 
<p>  next();</p> 
<p>});</p> 
<p>在实际应用中，选择哪种方法取决于你的具体需求和安全要求。通常，建议使用JWT结合HTTPS来确保Token的安全传输，同时在服务器端进行严格的Token验证。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9f161bd627cabbf5d3117b84917eb01d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">微信小程序内嵌webView访问H5界面，在H5界面获取定位</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/25eb3e867a99377f9acb29f5a4cd5f15/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">GPT-SoVITS 一键整合包- AIStarter启动器专属</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>