<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vue使用printJs实现前端打印,以及打印分页实现 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/6562332d2973fee16ff7a0c83a87dc29/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="vue使用printJs实现前端打印,以及打印分页实现">
  <meta property="og:description" content="在web端可以直接使用原生调用方法调用打印,但是往往需要单独把需要打印的东西拎出来画一个单独的html,而使用printJs则可选中你需要打印的代码块,进行页面局部打印
我的需求为将表格打印出来,并且超过分页数进行分页展示
以下内容参考了其他博主的实现方法,仅供参考
实现打印 1.可以直接使用以下代码,在项目中生成一个js文件,并在main.js中全局引用,以下代码为Vue使用PrintJS实现页面打印功能_this.$print_呆小杰的博客-CSDN博客
呆小杰博主修改后的代码,也可以使用npm下载引用
/** * 打印类属性、方法定义,需要先在插件中引入 * 使用示例: 1. 先在mian.js中引入 * 2. 函数中调用this.$print(this.$refs.xxxx) */ /* eslint-disable */ const Print = function (dom, options) { if (!(this instanceof Print)) return new Print(dom, options); this.options = this.extend({ &#39;noPrint&#39;: &#39;.no-print&#39; }, options); if ((typeof dom) === &#34;string&#34;) { this.dom = document.querySelector(dom); } else { this.isDOM(dom) this.dom = this.isDOM(dom) ? dom : dom.$el; } this.init(); }; Print.prototype = { init: function () { var content = this.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-08-08T10:09:58+08:00">
    <meta property="article:modified_time" content="2023-08-08T10:09:58+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vue使用printJs实现前端打印,以及打印分页实现</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>在web端可以直接使用原生调用方法调用打印,但是往往需要单独把需要打印的东西拎出来画一个单独的html,而使用printJs则可选中你需要打印的代码块,进行页面局部打印</p> 
<p>我的需求为将表格打印出来,并且超过分页数进行分页展示</p> 
<p>以下内容参考了其他博主的实现方法,仅供参考</p> 
<h3>实现打印</h3> 
<p>1.可以直接使用以下代码,在项目中生成一个js文件,并在main.js中全局引用,以下代码为<a href="https://blog.csdn.net/m0_72416767/article/details/127525980" title="Vue使用PrintJS实现页面打印功能_this.$print_呆小杰的博客-CSDN博客">Vue使用PrintJS实现页面打印功能_this.$print_呆小杰的博客-CSDN博客</a></p> 
<p>呆小杰博主修改后的代码,也可以使用npm下载引用</p> 
<pre><code class="language-javascript">/**
* 打印类属性、方法定义,需要先在插件中引入
* 使用示例: 1. 先在mian.js中引入
*          2. 函数中调用this.$print(this.$refs.xxxx)
*/

/* eslint-disable */
const Print = function (dom, options) {
 if (!(this instanceof Print)) return new Print(dom, options);

 this.options = this.extend({
   'noPrint': '.no-print'
 }, options);

 if ((typeof dom) === "string") {
   this.dom = document.querySelector(dom);
 } else {
   this.isDOM(dom)
   this.dom = this.isDOM(dom) ? dom : dom.$el;
 }

 this.init();
};
Print.prototype = {
 init: function () {
   var content = this.getStyle() + this.getHtml();
   this.writeIframe(content);
 },
 extend: function (obj, obj2) {
   for (var k in obj2) {
     obj[k] = obj2[k];
   }
   return obj;
 },

 getStyle: function () {
   var str = "",
    styles = document.querySelectorAll('style,link');
   for (var i = 0; i &lt; styles.length; i++) {
    str += styles[i].outerHTML;
   }
   str += "&lt;style&gt;" + (this.options.noPrint ? this.options.noPrint : '.no-print') + "{display:none;}&lt;/style&gt;";
   //str += "&lt;style&gt;html,body,div{height: auto!important;font-size:14px}&lt;/style&gt;";
   //这边样式要谨慎使用,会覆盖样式表中设置的样式  --&gt;按照自己的业务需求拼接,会覆盖外面H5原先的样式
   str += "&lt;style&gt;html,body,div{font-size:14px}&lt;/style&gt;";
 
   return str;
  },

 getHtml: function () {
   var inputs = document.querySelectorAll('input');
   var textareas = document.querySelectorAll('textarea');
   var selects = document.querySelectorAll('select');

   for (var k = 0; k &lt; inputs.length; k++) {
     if (inputs[k].type == "checkbox" || inputs[k].type == "radio") {
       if (inputs[k].checked == true) {
         inputs[k].setAttribute('checked', "checked")
       } else {
         inputs[k].removeAttribute('checked')
       }
     } else if (inputs[k].type == "text") {
       inputs[k].setAttribute('value', inputs[k].value)
     } else {
       inputs[k].setAttribute('value', inputs[k].value)
     }
   }

   for (var k2 = 0; k2 &lt; textareas.length; k2++) {
     if (textareas[k2].type == 'textarea') {
       textareas[k2].innerHTML = textareas[k2].value
     }
   }

   for (var k3 = 0; k3 &lt; selects.length; k3++) {
     if (selects[k3].type == 'select-one') {
       var child = selects[k3].children;
       for (var i in child) {
         if (child[i].tagName == 'OPTION') {
           if (child[i].selected == true) {
             child[i].setAttribute('selected', "selected")
           } else {
             child[i].removeAttribute('selected')
           }
         }
       }
     }
   }

   return this.dom.outerHTML;
 },

 writeIframe: function (content) {
   var w, doc, iframe = document.createElement('iframe'),
     f = document.body.appendChild(iframe);
   iframe.id = "myIframe";
   //iframe.style = "position:absolute;width:0;height:0;top:-10px;left:-10px;";
   iframe.setAttribute('style', 'position:absolute;width:0;height:0;top:-10px;left:-10px;');
   w = f.contentWindow || f.contentDocument;
   doc = f.contentDocument || f.contentWindow.document;
   doc.open();
   doc.write(content);
   doc.close();
   var _this = this
   iframe.onload = function(){
     _this.toPrint(w);
     setTimeout(function () {
       document.body.removeChild(iframe)
     }, 100)
   }
 },

 toPrint: function (frameWindow) {
   try {
     setTimeout(function () {
       frameWindow.focus();
       try {
         if (!frameWindow.document.execCommand('print', false, null)) {
           frameWindow.print();
         }
       } catch (e) {
         frameWindow.print();
       }
       frameWindow.close();
     }, 10);
   } catch (err) {
     console.log('err', err);
   }
 },
 isDOM: (typeof HTMLElement === 'object') ?
   function (obj) {
     return obj instanceof HTMLElement;
   } :
   function (obj) {
     return obj &amp;&amp; typeof obj === 'object' &amp;&amp; obj.nodeType === 1 &amp;&amp; typeof obj.nodeName === 'string';
   }
};
const MyPlugin = {}
MyPlugin.install = function (Vue, options) {
 // 4. 添加实例方法
 Vue.prototype.$print = Print
}
export default MyPlugin
</code></pre> 
<p>根据博主提供的方法进行编写</p> 
<p><img alt="" height="173" src="https://images2.imgbox.com/c0/84/x3jgqIe3_o.png" width="1181"></p> 
<p>绑定ref,使用this.$print(this.$refs.xxx)使用,可以将这个代码块中你需要的元素打印出来,</p> 
<ul><li>不需要打印的元素加上 <code>class="no-print"</code>,那么打印时就会将设置了此类名的元素忽略</li></ul> 
<p>这块可以参考博主改装后的js</p> 
<h3>实现分页</h3> 
<p>我这边使用的是el-dialog中绘制我需要的打印预览显示,有不需要预览页面展示的可以把元素从代码上隐藏,至于方式可以自己探索例如position:absolute,top:100000px,或者其他假删除方式,不要用v-if等真删除,节点删除后ref获取不到无法打印.</p> 
<pre><code class="language-javascript">getPrintDataInfo(data) {
      const arrCopy = JSON.parse(JSON.stringify(data))
      arrCopy.forEach((items, indexs) =&gt; {
        items.printTime = this.$moment().format('YYYY-MM-DD HH:ss:mm')//这里是我的需要的打印时间
        if (items.list.length % this.page.size === 0) {
          this.totalPage = items.list.length / this.page.size//this.page.size是我列表的分页显示条数,这边使用为打印时一个页面的条数
        } else {
          this.totalPage = parseInt(items.list.length / this.page.size) + 1
        }
        for (let i = 1; i &lt;= this.totalPage; i++) {
          const obj = JSON.parse(JSON.stringify(items))
          obj.list = this.getTableDataByPaging(i, this.page.size, items.list).data
          obj.currentPage = this.getTableDataByPaging(i, this.page.size, items.list).page
          this.dataList.push(obj)
        }
      })
    },
    // 打印清单分页数据处理
    getTableDataByPaging(page = 1, pageSize = 10, totalData = []) {
      const { length } = totalData
      const tableData = {
        data: [],
        page,
        pageSize,
        length
      }
      if (pageSize &gt;= length) { // pageSize大于等于总数据长度，说明只有1页数据或没有数据
        tableData.data = totalData
        tableData.page = 1// 直接取第一页
      } else { // pageSize小于总数据长度，数据多余1页
        const num = pageSize * (page - 1)// 计算当前页（不含）之前的所有数据总条数
        if (num &lt; length) { // 如果当前页之前所有数据总条数小于（不能等于）总的数据集长度，则说明当前页码没有超出最大页码
          const startIndex = num// 当前页第一条数据在总数据集中的索引
          const endIndex = num + pageSize - 1// 当前页最后一条数据索引
          tableData.data = totalData.filter((_, index) =&gt; index &gt;= startIndex &amp;&amp; index &lt;= endIndex)// 当前页数据条数小于每页最大条数时，也按最大条数范围筛取数据
        } else { // 当前页码超出最大页码，则计算实际最后一页的page，自动返回最后一页数据
          const size = parseInt(length / pageSize) // 取商
          const rest = length % pageSize // 取余数
          if (rest &gt; 0) { // 余数大于0，说明实际最后一页数据不足pageSize，应该取size+1为最后一条的页码
            tableData.page = size + 1// 当前页码重置，取size+1
            tableData.data = totalData.filter((_, index) =&gt; index &gt;= (pageSize * size) &amp;&amp; index &lt;= length)
          } else if (rest === 0) { // 余数等于0，最后一页数据条数正好是pageSize
            tableData.page = size// 当前页码重置，取size
            tableData.data = totalData.filter((_, index) =&gt; index &gt;= (pageSize * (size - 1)) &amp;&amp; index &lt;= length)
          } // 注：余数不可能小于0
        }
      }
      return tableData
    },</code></pre> 
<p>在页面上v-for循环</p> 
<pre><code class="language-javascript">&lt;div ref="printLend" class="pitchman-box "&gt;
          &lt;div v-for="(item,indexs) in dataList" :key="indexs" class="printClass" style="page-break-after: always;"&gt;
            &lt;el-row&gt;
              &lt;h2&gt;{<!-- -->{ item.title }}&lt;/h2&gt;
            &lt;/el-row&gt;
            &lt;el-row class="print_info"&gt;
              &lt;el-col :span="6"&gt;&lt;span&gt;借出人:&lt;/span&gt;{<!-- -->{ item.name }}&lt;/el-col&gt;
              &lt;el-col :span="6"&gt;&lt;span&gt;联系方式:&lt;/span&gt;{<!-- -->{ item.phone }}&lt;/el-col&gt;
              &lt;el-col :span="6"&gt;&lt;span&gt;借出时间:&lt;/span&gt;{<!-- -->{ item.lendTime }}&lt;/el-col&gt;
              &lt;el-col :span="6"&gt;&lt;span&gt;押金:&lt;/span&gt;{<!-- -->{ item.price }}&lt;/el-col&gt;
            &lt;/el-row&gt;
            &lt;table border="1" width="100%" height="100%" cellspacing="0" cellpadding="0"&gt;
              &lt;thead&gt;
                &lt;!--表头,这里就是正常的表格循环--&gt;
                &lt;th&gt;序号&lt;/th&gt;
              &lt;/thead&gt;
              &lt;tbody align="center"&gt;
                &lt;tr v-for="(items,index) in item.list" :key="index"&gt;
                  &lt;td&gt;{<!-- -->{ index +1 }}&lt;/td&gt;
                &lt;/tr&gt;
              &lt;/tbody&gt;
            &lt;/table&gt;
            &lt;el-row class="logistics-bottom"&gt;
              &lt;el-col style="text-align: left;" :span="12"&gt;打印时间：{<!-- -->{ item.printTime }}&lt;/el-col&gt;
              &lt;el-col style="text-align: right;" :span="12"&gt;第{<!-- -->{ item.currentPage }}页，共{<!-- -->{ totalPage }}页&lt;/el-col&gt;
            &lt;/el-row&gt;
            &lt;!-- &lt;div style="page-break-after: always;" /&gt; --&gt;
          &lt;/div&gt;</code></pre> 
<p>style="page-break-after: always;"在你需要分下一页打印页的地方加上这个样式属性<br><img alt="" height="1200" src="https://images2.imgbox.com/eb/2c/SNR8cZ79_o.png" width="1200"></p> 
<p> </p> 
<p>这是我的最终预览效果,打印 A4纸上效果也很完美,一个标题就是一张纸</p> 
<p><strong>值得注意的是,并不建议给整个你需要的打印元素设置高度超出隐藏显示滚动条.样式方面可以自己斟酌怎么实现.一般打印出来的效果不会有太大出入</strong></p> 
<p> 大体代码实现就是这样,如果有错误欢迎指正,有更好的实现方法也可以交流一下,表格预览时有更好办法可以实现流体高度也请赐教,感谢!!!</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f55cebc13985bf95c0d4f08b5f21ae89/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">当编程遇上AI，纵享丝滑</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/00e3916d49a541bd65707315f97e99a4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">链表基础知识详解（非常详细简单易懂）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>