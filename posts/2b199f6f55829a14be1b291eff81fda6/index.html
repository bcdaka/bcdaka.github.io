<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>用【R语言】揭示大学生恋爱心理：【机器学习】与【深度学习】的案例深度解析 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/2b199f6f55829a14be1b291eff81fda6/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="用【R语言】揭示大学生恋爱心理：【机器学习】与【深度学习】的案例深度解析">
  <meta property="og:description" content="目录
第一部分：数据收集与预处理
1.1 数据来源
1.2 数据清洗
加载必要的库
读取数据
处理缺失值
转换数据类型
查看清洗后的数据 数据清洗的扩展与优化
检测异常值
处理异常值
重新查看清洗后的数据
优化与扩展总结
1.3 数据探索性分析
年龄分布图
性别分布图
恋爱状态分布图
按性别分组的年龄分布图
按恋爱状态分组的社交活动频率分布图
第二部分：特征工程与数据准备
2.1 特征选择
年龄（Age）
性别（Gender）
社交活动频率（Social_Activity）
情感特征（Emotional_Features）
2.2 特征提取
代码优化与扩展
添加词频分析
可视化词云
完整代码
第三部分：机器学习模型
3.1 逻辑回归模型
构建逻辑回归模型
模型总结
预测
模型评估
优化与扩展
使用交叉验证评估模型性能
计算更多评估指标
完整代码
3.2 决策树模型
优化与扩展
使用交叉验证评估模型性能
计算更多评估指标
完整代码
第四部分：深度学习模型
4.1 数据准备
4.2 构建和训练模型
第五部分：模型评估与比较
5.1 模型评估指标
5.2 模型比较
评估指标
评估结果分析
结果说明
选择最优模型
第六部分：案例分析
6.1 案例背景">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-14T07:26:25+08:00">
    <meta property="article:modified_time" content="2024-06-14T07:26:25+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">用【R语言】揭示大学生恋爱心理：【机器学习】与【深度学习】的案例深度解析</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%EF%BC%9A%E6%95%B0%E6%8D%AE%E6%94%B6%E9%9B%86%E4%B8%8E%E9%A2%84%E5%A4%84%E7%90%86-toc" style="margin-left:0px;"><a href="#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%EF%BC%9A%E6%95%B0%E6%8D%AE%E6%94%B6%E9%9B%86%E4%B8%8E%E9%A2%84%E5%A4%84%E7%90%86" rel="nofollow">第一部分：数据收集与预处理</a></p> 
<p id="1.1%20%E6%95%B0%E6%8D%AE%E6%9D%A5%E6%BA%90-toc" style="margin-left:40px;"><a href="#1.1%20%E6%95%B0%E6%8D%AE%E6%9D%A5%E6%BA%90" rel="nofollow">1.1 数据来源</a></p> 
<p id="1.2%20%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97-toc" style="margin-left:40px;"><a href="#1.2%20%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97" rel="nofollow">1.2 数据清洗</a></p> 
<p id="%C2%A0%E5%8A%A0%E8%BD%BD%E5%BF%85%E8%A6%81%E7%9A%84%E5%BA%93-toc" style="margin-left:80px;"><a href="#%C2%A0%E5%8A%A0%E8%BD%BD%E5%BF%85%E8%A6%81%E7%9A%84%E5%BA%93" rel="nofollow"> 加载必要的库</a></p> 
<p id="%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE-toc" style="margin-left:80px;"><a href="#%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE" rel="nofollow">读取数据</a></p> 
<p id="%E5%A4%84%E7%90%86%E7%BC%BA%E5%A4%B1%E5%80%BC-toc" style="margin-left:80px;"><a href="#%E5%A4%84%E7%90%86%E7%BC%BA%E5%A4%B1%E5%80%BC" rel="nofollow">处理缺失值</a></p> 
<p id="%E8%BD%AC%E6%8D%A2%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-toc" style="margin-left:80px;"><a href="#%E8%BD%AC%E6%8D%A2%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B" rel="nofollow">转换数据类型</a></p> 
<p id="%C2%A0%E6%9F%A5%E7%9C%8B%E6%B8%85%E6%B4%97%E5%90%8E%E7%9A%84%E6%95%B0%E6%8D%AE%C2%A0-toc" style="margin-left:80px;"><a href="#%C2%A0%E6%9F%A5%E7%9C%8B%E6%B8%85%E6%B4%97%E5%90%8E%E7%9A%84%E6%95%B0%E6%8D%AE%C2%A0" rel="nofollow"> 查看清洗后的数据 </a></p> 
<p id="%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97%E7%9A%84%E6%89%A9%E5%B1%95%E4%B8%8E%E4%BC%98%E5%8C%96-toc" style="margin-left:80px;"><a href="#%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97%E7%9A%84%E6%89%A9%E5%B1%95%E4%B8%8E%E4%BC%98%E5%8C%96" rel="nofollow">数据清洗的扩展与优化</a></p> 
<p id="%E6%A3%80%E6%B5%8B%E5%BC%82%E5%B8%B8%E5%80%BC-toc" style="margin-left:120px;"><a href="#%E6%A3%80%E6%B5%8B%E5%BC%82%E5%B8%B8%E5%80%BC" rel="nofollow">检测异常值</a></p> 
<p id="%E5%A4%84%E7%90%86%E5%BC%82%E5%B8%B8%E5%80%BC-toc" style="margin-left:120px;"><a href="#%E5%A4%84%E7%90%86%E5%BC%82%E5%B8%B8%E5%80%BC" rel="nofollow">处理异常值</a></p> 
<p id="%E9%87%8D%E6%96%B0%E6%9F%A5%E7%9C%8B%E6%B8%85%E6%B4%97%E5%90%8E%E7%9A%84%E6%95%B0%E6%8D%AE-toc" style="margin-left:80px;"><a href="#%E9%87%8D%E6%96%B0%E6%9F%A5%E7%9C%8B%E6%B8%85%E6%B4%97%E5%90%8E%E7%9A%84%E6%95%B0%E6%8D%AE" rel="nofollow">重新查看清洗后的数据</a></p> 
<p id="%E4%BC%98%E5%8C%96%E4%B8%8E%E6%89%A9%E5%B1%95%E6%80%BB%E7%BB%93-toc" style="margin-left:80px;"><a href="#%E4%BC%98%E5%8C%96%E4%B8%8E%E6%89%A9%E5%B1%95%E6%80%BB%E7%BB%93" rel="nofollow">优化与扩展总结</a></p> 
<p id="1.3%20%E6%95%B0%E6%8D%AE%E6%8E%A2%E7%B4%A2%E6%80%A7%E5%88%86%E6%9E%90-toc" style="margin-left:40px;"><a href="#1.3%20%E6%95%B0%E6%8D%AE%E6%8E%A2%E7%B4%A2%E6%80%A7%E5%88%86%E6%9E%90" rel="nofollow">1.3 数据探索性分析</a></p> 
<p id="%E5%B9%B4%E9%BE%84%E5%88%86%E5%B8%83%E5%9B%BE-toc" style="margin-left:80px;"><a href="#%E5%B9%B4%E9%BE%84%E5%88%86%E5%B8%83%E5%9B%BE" rel="nofollow">年龄分布图</a></p> 
<p id="%E6%80%A7%E5%88%AB%E5%88%86%E5%B8%83%E5%9B%BE-toc" style="margin-left:80px;"><a href="#%E6%80%A7%E5%88%AB%E5%88%86%E5%B8%83%E5%9B%BE" rel="nofollow">性别分布图</a></p> 
<p id="%E6%81%8B%E7%88%B1%E7%8A%B6%E6%80%81%E5%88%86%E5%B8%83%E5%9B%BE-toc" style="margin-left:80px;"><a href="#%E6%81%8B%E7%88%B1%E7%8A%B6%E6%80%81%E5%88%86%E5%B8%83%E5%9B%BE" rel="nofollow">恋爱状态分布图</a></p> 
<p id="%E6%8C%89%E6%80%A7%E5%88%AB%E5%88%86%E7%BB%84%E7%9A%84%E5%B9%B4%E9%BE%84%E5%88%86%E5%B8%83%E5%9B%BE-toc" style="margin-left:80px;"><a href="#%E6%8C%89%E6%80%A7%E5%88%AB%E5%88%86%E7%BB%84%E7%9A%84%E5%B9%B4%E9%BE%84%E5%88%86%E5%B8%83%E5%9B%BE" rel="nofollow">按性别分组的年龄分布图</a></p> 
<p id="%E6%8C%89%E6%81%8B%E7%88%B1%E7%8A%B6%E6%80%81%E5%88%86%E7%BB%84%E7%9A%84%E7%A4%BE%E4%BA%A4%E6%B4%BB%E5%8A%A8%E9%A2%91%E7%8E%87%E5%88%86%E5%B8%83%E5%9B%BE-toc" style="margin-left:80px;"><a href="#%E6%8C%89%E6%81%8B%E7%88%B1%E7%8A%B6%E6%80%81%E5%88%86%E7%BB%84%E7%9A%84%E7%A4%BE%E4%BA%A4%E6%B4%BB%E5%8A%A8%E9%A2%91%E7%8E%87%E5%88%86%E5%B8%83%E5%9B%BE" rel="nofollow">按恋爱状态分组的社交活动频率分布图</a></p> 
<p id="%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86%EF%BC%9A%E7%89%B9%E5%BE%81%E5%B7%A5%E7%A8%8B%E4%B8%8E%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87-toc" style="margin-left:0px;"><a href="#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86%EF%BC%9A%E7%89%B9%E5%BE%81%E5%B7%A5%E7%A8%8B%E4%B8%8E%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87" rel="nofollow">第二部分：特征工程与数据准备</a></p> 
<p id="2.1%20%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9-toc" style="margin-left:40px;"><a href="#2.1%20%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9" rel="nofollow">2.1 特征选择</a></p> 
<p id="%E5%B9%B4%E9%BE%84%EF%BC%88Age%EF%BC%89-toc" style="margin-left:80px;"><a href="#%E5%B9%B4%E9%BE%84%EF%BC%88Age%EF%BC%89" rel="nofollow">年龄（Age）</a></p> 
<p id="%E6%80%A7%E5%88%AB%EF%BC%88Gender%EF%BC%89-toc" style="margin-left:80px;"><a href="#%E6%80%A7%E5%88%AB%EF%BC%88Gender%EF%BC%89" rel="nofollow">性别（Gender）</a></p> 
<p id="%E7%A4%BE%E4%BA%A4%E6%B4%BB%E5%8A%A8%E9%A2%91%E7%8E%87%EF%BC%88Social_Activity%EF%BC%89-toc" style="margin-left:80px;"><a href="#%E7%A4%BE%E4%BA%A4%E6%B4%BB%E5%8A%A8%E9%A2%91%E7%8E%87%EF%BC%88Social_Activity%EF%BC%89" rel="nofollow">社交活动频率（Social_Activity）</a></p> 
<p id="%E6%83%85%E6%84%9F%E7%89%B9%E5%BE%81%EF%BC%88Emotional_Features%EF%BC%89-toc" style="margin-left:80px;"><a href="#%E6%83%85%E6%84%9F%E7%89%B9%E5%BE%81%EF%BC%88Emotional_Features%EF%BC%89" rel="nofollow">情感特征（Emotional_Features）</a></p> 
<p id="2.2%20%E7%89%B9%E5%BE%81%E6%8F%90%E5%8F%96-toc" style="margin-left:40px;"><a href="#2.2%20%E7%89%B9%E5%BE%81%E6%8F%90%E5%8F%96" rel="nofollow">2.2 特征提取</a></p> 
<p id="%E4%BB%A3%E7%A0%81%E4%BC%98%E5%8C%96%E4%B8%8E%E6%89%A9%E5%B1%95-toc" style="margin-left:40px;"><a href="#%E4%BB%A3%E7%A0%81%E4%BC%98%E5%8C%96%E4%B8%8E%E6%89%A9%E5%B1%95" rel="nofollow">代码优化与扩展</a></p> 
<p id="%E6%B7%BB%E5%8A%A0%E8%AF%8D%E9%A2%91%E5%88%86%E6%9E%90-toc" style="margin-left:80px;"><a href="#%E6%B7%BB%E5%8A%A0%E8%AF%8D%E9%A2%91%E5%88%86%E6%9E%90" rel="nofollow">添加词频分析</a></p> 
<p id="%C2%A0%E5%8F%AF%E8%A7%86%E5%8C%96%E8%AF%8D%E4%BA%91-toc" style="margin-left:80px;"><a href="#%C2%A0%E5%8F%AF%E8%A7%86%E5%8C%96%E8%AF%8D%E4%BA%91" rel="nofollow"> 可视化词云</a></p> 
<p id="%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81-toc" style="margin-left:40px;"><a href="#%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81" rel="nofollow">完整代码</a></p> 
<p id="%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86%EF%BC%9A%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%A8%A1%E5%9E%8B-toc" style="margin-left:0px;"><a href="#%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86%EF%BC%9A%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%A8%A1%E5%9E%8B" rel="nofollow">第三部分：机器学习模型</a></p> 
<p id="3.1%20%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B-toc" style="margin-left:40px;"><a href="#3.1%20%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B" rel="nofollow">3.1 逻辑回归模型</a></p> 
<p id="%E6%9E%84%E5%BB%BA%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B-toc" style="margin-left:80px;"><a href="#%E6%9E%84%E5%BB%BA%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B" rel="nofollow">构建逻辑回归模型</a></p> 
<p id="%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93-toc" style="margin-left:80px;"><a href="#%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93" rel="nofollow">模型总结</a></p> 
<p id="%E9%A2%84%E6%B5%8B-toc" style="margin-left:80px;"><a href="#%E9%A2%84%E6%B5%8B" rel="nofollow">预测</a></p> 
<p id="%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0-toc" style="margin-left:80px;"><a href="#%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0" rel="nofollow">模型评估</a></p> 
<p id="%E4%BC%98%E5%8C%96%E4%B8%8E%E6%89%A9%E5%B1%95-toc" style="margin-left:40px;"><a href="#%E4%BC%98%E5%8C%96%E4%B8%8E%E6%89%A9%E5%B1%95" rel="nofollow">优化与扩展</a></p> 
<p id="%E4%BD%BF%E7%94%A8%E4%BA%A4%E5%8F%89%E9%AA%8C%E8%AF%81%E8%AF%84%E4%BC%B0%E6%A8%A1%E5%9E%8B%E6%80%A7%E8%83%BD-toc" style="margin-left:120px;"><a href="#%E4%BD%BF%E7%94%A8%E4%BA%A4%E5%8F%89%E9%AA%8C%E8%AF%81%E8%AF%84%E4%BC%B0%E6%A8%A1%E5%9E%8B%E6%80%A7%E8%83%BD" rel="nofollow">使用交叉验证评估模型性能</a></p> 
<p id="%E8%AE%A1%E7%AE%97%E6%9B%B4%E5%A4%9A%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87-toc" style="margin-left:120px;"><a href="#%E8%AE%A1%E7%AE%97%E6%9B%B4%E5%A4%9A%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87" rel="nofollow">计算更多评估指标</a></p> 
<p id="%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81-toc" style="margin-left:80px;"><a href="#%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81" rel="nofollow">完整代码</a></p> 
<p id="3.2%20%E5%86%B3%E7%AD%96%E6%A0%91%E6%A8%A1%E5%9E%8B-toc" style="margin-left:40px;"><a href="#3.2%20%E5%86%B3%E7%AD%96%E6%A0%91%E6%A8%A1%E5%9E%8B" rel="nofollow">3.2 决策树模型</a></p> 
<p id="%E4%BC%98%E5%8C%96%E4%B8%8E%E6%89%A9%E5%B1%95-toc" style="margin-left:80px;"><a href="#%E4%BC%98%E5%8C%96%E4%B8%8E%E6%89%A9%E5%B1%95" rel="nofollow">优化与扩展</a></p> 
<p id="%E4%BD%BF%E7%94%A8%E4%BA%A4%E5%8F%89%E9%AA%8C%E8%AF%81%E8%AF%84%E4%BC%B0%E6%A8%A1%E5%9E%8B%E6%80%A7%E8%83%BD-toc" style="margin-left:120px;"><a href="#%E4%BD%BF%E7%94%A8%E4%BA%A4%E5%8F%89%E9%AA%8C%E8%AF%81%E8%AF%84%E4%BC%B0%E6%A8%A1%E5%9E%8B%E6%80%A7%E8%83%BD" rel="nofollow">使用交叉验证评估模型性能</a></p> 
<p id="%E8%AE%A1%E7%AE%97%E6%9B%B4%E5%A4%9A%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87-toc" style="margin-left:120px;"><a href="#%E8%AE%A1%E7%AE%97%E6%9B%B4%E5%A4%9A%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87" rel="nofollow">计算更多评估指标</a></p> 
<p id="%C2%A0%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81-toc" style="margin-left:80px;"><a href="#%C2%A0%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81" rel="nofollow"> 完整代码</a></p> 
<p id="%E7%AC%AC%E5%9B%9B%E9%83%A8%E5%88%86%EF%BC%9A%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%A8%A1%E5%9E%8B-toc" style="margin-left:0px;"><a href="#%E7%AC%AC%E5%9B%9B%E9%83%A8%E5%88%86%EF%BC%9A%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%A8%A1%E5%9E%8B" rel="nofollow">第四部分：深度学习模型</a></p> 
<p id="4.1%20%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87-toc" style="margin-left:40px;"><a href="#4.1%20%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87" rel="nofollow">4.1 数据准备</a></p> 
<p id="4.2%20%E6%9E%84%E5%BB%BA%E5%92%8C%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B-toc" style="margin-left:40px;"><a href="#4.2%20%E6%9E%84%E5%BB%BA%E5%92%8C%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B" rel="nofollow">4.2 构建和训练模型</a></p> 
<p id="%E7%AC%AC%E4%BA%94%E9%83%A8%E5%88%86%EF%BC%9A%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E4%B8%8E%E6%AF%94%E8%BE%83-toc" style="margin-left:0px;"><a href="#%E7%AC%AC%E4%BA%94%E9%83%A8%E5%88%86%EF%BC%9A%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E4%B8%8E%E6%AF%94%E8%BE%83" rel="nofollow">第五部分：模型评估与比较</a></p> 
<p id="5.1%20%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87-toc" style="margin-left:40px;"><a href="#5.1%20%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87" rel="nofollow">5.1 模型评估指标</a></p> 
<p id="5.2%20%E6%A8%A1%E5%9E%8B%E6%AF%94%E8%BE%83-toc" style="margin-left:40px;"><a href="#5.2%20%E6%A8%A1%E5%9E%8B%E6%AF%94%E8%BE%83" rel="nofollow">5.2 模型比较</a></p> 
<p id="%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87-toc" style="margin-left:80px;"><a href="#%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87" rel="nofollow">评估指标</a></p> 
<p id="%E8%AF%84%E4%BC%B0%E7%BB%93%E6%9E%9C%E5%88%86%E6%9E%90-toc" style="margin-left:80px;"><a href="#%E8%AF%84%E4%BC%B0%E7%BB%93%E6%9E%9C%E5%88%86%E6%9E%90" rel="nofollow">评估结果分析</a></p> 
<p id="%E7%BB%93%E6%9E%9C%E8%AF%B4%E6%98%8E-toc" style="margin-left:80px;"><a href="#%E7%BB%93%E6%9E%9C%E8%AF%B4%E6%98%8E" rel="nofollow">结果说明</a></p> 
<p id="%E9%80%89%E6%8B%A9%E6%9C%80%E4%BC%98%E6%A8%A1%E5%9E%8B-toc" style="margin-left:80px;"><a href="#%E9%80%89%E6%8B%A9%E6%9C%80%E4%BC%98%E6%A8%A1%E5%9E%8B" rel="nofollow">选择最优模型</a></p> 
<p id="%E7%AC%AC%E5%85%AD%E9%83%A8%E5%88%86%EF%BC%9A%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90-toc" style="margin-left:0px;"><a href="#%E7%AC%AC%E5%85%AD%E9%83%A8%E5%88%86%EF%BC%9A%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90" rel="nofollow">第六部分：案例分析</a></p> 
<p id="6.1%20%E6%A1%88%E4%BE%8B%E8%83%8C%E6%99%AF-toc" style="margin-left:40px;"><a href="#6.1%20%E6%A1%88%E4%BE%8B%E8%83%8C%E6%99%AF" rel="nofollow">6.1 案例背景</a></p> 
<p id="6.2%20%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-toc" style="margin-left:40px;"><a href="#6.2%20%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90" rel="nofollow">6.2 数据分析</a></p> 
<p id="6.3%20%E6%A8%A1%E5%9E%8B%E5%BA%94%E7%94%A8-toc" style="margin-left:40px;"><a href="#6.3%20%E6%A8%A1%E5%9E%8B%E5%BA%94%E7%94%A8" rel="nofollow">6.3 模型应用</a></p> 
<p id="%E7%AC%AC%E4%B8%83%E9%83%A8%E5%88%86%EF%BC%9A%E7%BB%93%E8%AE%BA%E4%B8%8E%E5%B1%95%E6%9C%9B-toc" style="margin-left:0px;"><a href="#%E7%AC%AC%E4%B8%83%E9%83%A8%E5%88%86%EF%BC%9A%E7%BB%93%E8%AE%BA%E4%B8%8E%E5%B1%95%E6%9C%9B" rel="nofollow">第七部分：结论与展望</a></p> 
<p id="7.1%20%E7%A0%94%E7%A9%B6%E7%BB%93%E8%AE%BA-toc" style="margin-left:40px;"><a href="#7.1%20%E7%A0%94%E7%A9%B6%E7%BB%93%E8%AE%BA" rel="nofollow">7.1 研究结论</a></p> 
<p id="7.2%20%E6%9C%AA%E6%9D%A5%E5%B7%A5%E4%BD%9C-toc" style="margin-left:40px;"><a href="#7.2%20%E6%9C%AA%E6%9D%A5%E5%B7%A5%E4%BD%9C" rel="nofollow">7.2 未来工作</a></p> 
<p id="%E8%AF%A6%E7%BB%86%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E4%B8%8E%E8%A7%A3%E9%87%8A-toc" style="margin-left:0px;"><a href="#%E8%AF%A6%E7%BB%86%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E4%B8%8E%E8%A7%A3%E9%87%8A" rel="nofollow">详细代码实现与解释</a></p> 
<p id="%E2%80%8B%E7%BC%96%E8%BE%91-toc" style="margin-left:0px;"><a href="#%E2%80%8B%E7%BC%96%E8%BE%91" rel="nofollow">​编辑</a></p> 
<hr id="hr-toc"> 
<p></p> 
<p>大学生恋爱心理是心理学研究中的一个重要领域。恋爱关系在大学生的生活中占据了重要地位，对他们的心理健康、学业成绩和社交能力都有显著影响。随着机器学习和深度学习技术的发展，我们可以通过分析大量数据来理解和预测大学生的恋爱心理状态。</p> 
<p><img alt="d7f4ccf9ff8347788d218adbb1b92e48.png" src="https://images2.imgbox.com/16/c1/MrDhjdFN_o.png"></p> 
<h2 id="%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%EF%BC%9A%E6%95%B0%E6%8D%AE%E6%94%B6%E9%9B%86%E4%B8%8E%E9%A2%84%E5%A4%84%E7%90%86">第一部分：数据收集与预处理</h2> 
<h3 id="1.1%20%E6%95%B0%E6%8D%AE%E6%9D%A5%E6%BA%90">1.1 数据来源</h3> 
<p>为了进行大学生恋爱心理的研究，我们需要获取相关的数据。本案例中的数据来自某大学的恋爱心理问卷调查，包含多个变量，如年龄、性别、恋爱状态、社交活动频率等。这些变量将作为我们分析和建模的基础。</p> 
<p>数据样本如下：</p> 
<table border="1" cellpadding="1" cellspacing="1" style="width:500px;"><tbody><tr><th>Age</th><th>Gender</th><th>Love_Status</th><th>Social_Activity</th><th>Love_Experience</th></tr><tr><td>20</td><td>Male</td><td>In a Relationship</td><td>High</td><td>"I have a wonderful relationship with my girlfriend."</td></tr><tr><td>22</td><td>Female</td><td>Single</td><td>Medium</td><td>"I have had a few crushes, but nothing serious."</td></tr><tr><td>21</td><td>Male</td><td>Single</td><td>Low</td><td>"I prefer to focus on my studies and hobbies."</td></tr><tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr></tbody></table> 
<h3 id="1.2%20%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97">1.2 数据清洗</h3> 
<p>数据清洗是数据分析的第一步，旨在确保数据的完整性和一致性。我们需要处理缺失值、异常值以及数据格式转换。</p> 
<h4 id="%C2%A0%E5%8A%A0%E8%BD%BD%E5%BF%85%E8%A6%81%E7%9A%84%E5%BA%93"> 加载必要的库</h4> 
<p>首先，我们加载进行数据操作和可视化所需的库：</p> 
<pre><code>​
# 加载必要的库
library(dplyr)    # 数据操作
library(ggplot2)  # 数据可视化
library(tm)       # 文本数据处理（如有需要）

​</code></pre> 
<h4 id="%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE">读取数据</h4> 
<p>然后，我们读取包含学生恋爱状态的CSV数据集：</p> 
<pre><code># 读取数据
data &lt;- read.csv("student_love_data.csv")

# 查看数据结构
# 使用str()函数查看数据框的结构，包括每列的名称、数据类型和示例数据
str(data)
</code></pre> 
<h4 id="%E5%A4%84%E7%90%86%E7%BC%BA%E5%A4%B1%E5%80%BC">处理缺失值</h4> 
<p>缺失值会影响数据分析的结果，因此需要进行处理。在本案例中，我们过滤掉缺失年龄、性别和恋爱状态的记录：</p> 
<pre><code># 处理缺失值
data &lt;- data %&gt;%
    filter(!is.na(age) &amp; !is.na(gender) &amp; !is.na(love_status))
</code></pre> 
<h4 id="%E8%BD%AC%E6%8D%A2%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B">转换数据类型</h4> 
<p>为了便于后续分析和建模，我们将<code>gender</code>和<code>love_status</code>列转换为因子类型：</p> 
<pre><code># 转换数据类型
data$gender &lt;- as.factor(data$gender)
data$love_status &lt;- as.factor(data$love_status)
</code></pre> 
<h4 id="%C2%A0%E6%9F%A5%E7%9C%8B%E6%B8%85%E6%B4%97%E5%90%8E%E7%9A%84%E6%95%B0%E6%8D%AE%C2%A0"> 查看清洗后的数据 </h4> 
<p>最后，我们使用<code>summary()</code>函数查看清洗后的数据，以了解每列的基本统计信息和分布情况：</p> 
<pre><code>​
# 查看清洗后的数据
summary(data)

​</code></pre> 
<p></p> 
<h4 id="%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97%E7%9A%84%E6%89%A9%E5%B1%95%E4%B8%8E%E4%BC%98%E5%8C%96">数据清洗的扩展与优化</h4> 
<p>为进一步优化数据清洗过程，我们可以增加对异常值的检测和处理，确保数据质量更高：</p> 
<h5 id="%E6%A3%80%E6%B5%8B%E5%BC%82%E5%B8%B8%E5%80%BC">检测异常值</h5> 
<p>我们可以使用箱线图（boxplot）检测连续变量中的异常值：</p> 
<pre><code># 检测年龄中的异常值
ggplot(data, aes(x="", y=age)) +
    geom_boxplot(fill="lightblue", color="black") +
    labs(title="Boxplot of Age", y="Age") +
    theme_minimal()
</code></pre> 
<h5 id="%E5%A4%84%E7%90%86%E5%BC%82%E5%B8%B8%E5%80%BC">处理异常值</h5> 
<p>根据业务逻辑，我们可以决定如何处理检测到的异常值。这里我们以简单的方式去除超过某个阈值的异常值为例：</p> 
<pre><code># 处理年龄中的异常值（假设大于30岁为异常）
data &lt;- data %&gt;%
    filter(age &lt;= 30)
</code></pre> 
<h4 id="%E9%87%8D%E6%96%B0%E6%9F%A5%E7%9C%8B%E6%B8%85%E6%B4%97%E5%90%8E%E7%9A%84%E6%95%B0%E6%8D%AE">重新查看清洗后的数据</h4> 
<p>再次查看清洗后的数据，确保所有清洗步骤都成功执行：</p> 
<pre><code># 查看最终清洗后的数据
summary(data)
</code></pre> 
<h4 id="%E4%BC%98%E5%8C%96%E4%B8%8E%E6%89%A9%E5%B1%95%E6%80%BB%E7%BB%93">优化与扩展总结</h4> 
<p>通过这些步骤，我们对数据进行了全面的清洗，包括处理缺失值、转换数据类型以及检测和处理异常值。这些操作确保了数据的完整性和一致性，为后续的探索性数据分析（EDA）和模型构建打下了坚实的基础。</p> 
<pre><code># 加载必要的库
library(dplyr)    # 数据操作
library(ggplot2)  # 数据可视化
library(tm)       # 文本数据处理（如有需要）

# 读取数据
data &lt;- read.csv("student_love_data.csv")

# 查看数据结构
str(data)

# 处理缺失值
data &lt;- data %&gt;%
    filter(!is.na(age) &amp; !is.na(gender) &amp; !is.na(love_status))

# 转换数据类型
data$gender &lt;- as.factor(data$gender)
data$love_status &lt;- as.factor(data$love_status)

# 检测年龄中的异常值
ggplot(data, aes(x="", y=age)) +
    geom_boxplot(fill="lightblue", color="black") +
    labs(title="Boxplot of Age", y="Age") +
    theme_minimal()

# 处理年龄中的异常值（假设大于30岁为异常）
data &lt;- data %&gt;%
    filter(age &lt;= 30)

# 查看清洗后的数据
summary(data)
</code></pre> 
<p>在数据清洗过程中，我们过滤掉了缺失年龄、性别和恋爱状态的记录，并将性别和恋爱状态变量转换为因子类型，方便后续的分析和建模。</p> 
<h3 id="1.3%20%E6%95%B0%E6%8D%AE%E6%8E%A2%E7%B4%A2%E6%80%A7%E5%88%86%E6%9E%90">1.3 数据探索性分析</h3> 
<p>在数据清洗之后，我们需要进行数据的探索性分析（EDA），以了解数据的基本特征和分布情况。EDA可以帮助我们发现数据中的潜在模式和异常情况，从而为后续的特征选择和建模提供指导。</p> 
<h4 id="%E5%B9%B4%E9%BE%84%E5%88%86%E5%B8%83%E5%9B%BE">年龄分布图</h4> 
<p>首先，我们绘制年龄的分布图，以了解学生的年龄分布情况。通过直方图，我们可以观察到不同年龄段学生的数量。</p> 
<pre><code># 年龄分布图
ggplot(data, aes(x=age)) +
    geom_histogram(binwidth=1, fill="blue", color="black") +
    labs(title="Age Distribution", x="Age", y="Count") +
    theme_minimal() +
    theme(plot.title = element_text(hjust = 0.5))
</code></pre> 
<p><img alt="" height="859" src="https://images2.imgbox.com/d6/19/yI2FjggJ_o.png" width="1200"></p> 
<h4 id="%E6%80%A7%E5%88%AB%E5%88%86%E5%B8%83%E5%9B%BE">性别分布图</h4> 
<p>接下来，我们绘制性别的分布图，以了解学生的性别比例。通过条形图，我们可以直观地看到男性和女性学生的数量分布。</p> 
<pre><code># 性别分布图
ggplot(data, aes(x=gender, fill=gender)) +
    geom_bar() +
    scale_fill_manual(values=c("blue", "pink")) +
    labs(title="Gender Distribution", x="Gender", y="Count") +
    theme_minimal() +
    theme(plot.title = element_text(hjust = 0.5))
</code></pre> 
<p><img alt="" height="387" src="https://images2.imgbox.com/e5/57/14iBQshG_o.png" width="670"></p> 
<h4 id="%E6%81%8B%E7%88%B1%E7%8A%B6%E6%80%81%E5%88%86%E5%B8%83%E5%9B%BE">恋爱状态分布图</h4> 
<p>然后，我们绘制恋爱状态的分布图，以了解学生当前的恋爱状态。通过条形图，我们可以看到单身、恋爱中和其他恋爱状态学生的数量分布。</p> 
<pre><code># 恋爱状态分布图
ggplot(data, aes(x=love_status, fill=love_status)) +
    geom_bar() +
    scale_fill_brewer(palette="Set3") +
    labs(title="Love Status Distribution", x="Love Status", y="Count") +
    theme_minimal() +
    theme(plot.title = element_text(hjust = 0.5))
</code></pre> 
<p><img alt="" height="387" src="https://images2.imgbox.com/31/d2/nw4AL0Mv_o.png" width="670"></p> 
<h4 id="%E6%8C%89%E6%80%A7%E5%88%AB%E5%88%86%E7%BB%84%E7%9A%84%E5%B9%B4%E9%BE%84%E5%88%86%E5%B8%83%E5%9B%BE">按性别分组的年龄分布图</h4> 
<p>为了更深入地了解数据，我们还可以绘制按性别分组的年龄分布图。这将帮助我们比较不同性别学生的年龄分布。</p> 
<pre><code># 按性别分组的年龄分布图
ggplot(data, aes(x=age, fill=gender)) +
    geom_histogram(binwidth=1, position="dodge", color="black") +
    scale_fill_manual(values=c("blue", "pink")) +
    labs(title="Age Distribution by Gender", x="Age", y="Count") +
    theme_minimal() +
    theme(plot.title = element_text(hjust = 0.5))
</code></pre> 
<h4 id="%E6%8C%89%E6%81%8B%E7%88%B1%E7%8A%B6%E6%80%81%E5%88%86%E7%BB%84%E7%9A%84%E7%A4%BE%E4%BA%A4%E6%B4%BB%E5%8A%A8%E9%A2%91%E7%8E%87%E5%88%86%E5%B8%83%E5%9B%BE">按恋爱状态分组的社交活动频率分布图</h4> 
<p>最后，我们绘制按恋爱状态分组的社交活动频率分布图，以了解不同恋爱状态学生的社交活动频率。这有助于我们发现社交活动频率与恋爱状态之间的关系。</p> 
<pre><code># 按恋爱状态分组的社交活动频率分布图
ggplot(data, aes(x=social_activity, fill=love_status)) +
    geom_bar(position="dodge", color="black") +
    scale_fill_brewer(palette="Set3") +
    labs(title="Social Activity Distribution by Love Status", x="Social Activity Level", y="Count") +
    theme_minimal() +
    theme(plot.title = element_text(hjust = 0.5))
</code></pre> 
<p><img alt="" height="387" src="https://images2.imgbox.com/c0/74/iqXcAZ7x_o.png" width="670"></p> 
<p>通过这些可视化图表，我们可以直观地看到数据的分布情况，例如，不同年龄段学生的分布、性别比例以及恋爱状态的分布。这些信息对我们后续的特征选择和模型构建非常有帮助。</p> 
<h2 id="%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86%EF%BC%9A%E7%89%B9%E5%BE%81%E5%B7%A5%E7%A8%8B%E4%B8%8E%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87">第二部分：特征工程与数据准备</h2> 
<h3 id="2.1%20%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9">2.1 特征选择</h3> 
<p>特征选择是从原始数据中选择最具代表性和预测能力的特征，以简化模型、提高模型性能并减少过拟合。在本案例中，我们的目标是预测大学生的恋爱状态。为此，我们选择了以下特征：</p> 
<h4 id="%E5%B9%B4%E9%BE%84%EF%BC%88Age%EF%BC%89">年龄（Age）</h4> 
<p>年龄是一个基本的社会人口统计特征，可能与恋爱状态有重要关联。例如，不同年龄段的学生可能有不同的恋爱经历和心理状态。通常，年长的学生可能有更多的恋爱经验，而年幼的学生可能更关注学业。</p> 
<pre><code># 分析年龄分布
ggplot(data, aes(x=age)) +
    geom_histogram(binwidth=1, fill="blue", color="black") +
    labs(title="Age Distribution", x="Age", y="Count")
</code></pre> 
<h4 id="%E6%80%A7%E5%88%AB%EF%BC%88Gender%EF%BC%89">性别（Gender）</h4> 
<p>性别在恋爱心理研究中起着关键作用，因为不同性别在恋爱关系中的行为和态度可能有所不同。例如，男性和女性在恋爱中可能表现出不同的社交行为和情感表达方式。</p> 
<pre><code># 分析性别分布
ggplot(data, aes(x=gender, fill=gender)) +
    geom_bar() +
    labs(title="Gender Distribution", x="Gender", y="Count")
</code></pre> 
<h4 id="%E7%A4%BE%E4%BA%A4%E6%B4%BB%E5%8A%A8%E9%A2%91%E7%8E%87%EF%BC%88Social_Activity%EF%BC%89">社交活动频率（Social_Activity）</h4> 
<p>社交活动的频率可能反映一个人的社交能力和兴趣，从而影响其恋爱状态。频繁参与社交活动的学生可能更容易建立和维持恋爱关系，而社交活动较少的学生可能更倾向于单身或关注学业。</p> 
<pre><code># 分析社交活动频率分布
ggplot(data, aes(x=social_activity, fill=love_status)) +
    geom_bar(position="dodge") +
    labs(title="Social Activity Distribution by Love Status", x="Social Activity Level", y="Count")
</code></pre> 
<h4 id="%E6%83%85%E6%84%9F%E7%89%B9%E5%BE%81%EF%BC%88Emotional_Features%EF%BC%89">情感特征（Emotional_Features）</h4> 
<p>通过对学生恋爱经历的文本描述进行分析，可以提取出情感特征，如积极情感和消极情感等。这些情感特征能够为模型提供更多关于学生恋爱心理的信息。例如，描述中使用积极词汇的学生可能有更稳定的恋爱关系，而使用消极词汇的学生可能经历了恋爱挫折。</p> 
<p> 这些特征将作为模型的输入变量，用于预测学生的恋爱状态。通过对这些特征的深入分析和处理，我们可以提升模型的准确性和稳定性。具体说明</p> 
<h3 id="2.2%20%E7%89%B9%E5%BE%81%E6%8F%90%E5%8F%96">2.2 特征提取</h3> 
<p>对于文本数据，我们需要使用自然语言处理（NLP）技术提取有用的特征。在本案例中，我们假设有一列描述学生恋爱经历的文本数据。我们将使用文本预处理技术将这些文本数据转换为可用的数值特征。</p> 
<p>首先，我们需要将文本数据转换为机器学习模型可以理解的形式。这通常包括以下几个步骤：</p> 
<ol><li><strong>文本预处理</strong>：包括将文本转换为小写、去除标点符号、去除数字和停用词、词干化等。这些步骤有助于减少噪音，提取出核心词汇。</li><li><strong>创建文档-词矩阵（Document-Term Matrix, DTM）</strong>：将处理后的文本数据转换为矩阵形式，其中每一行表示一个文档（学生的恋爱经历），每一列表示一个词语，矩阵中的值表示该词语在文档中出现的频次。</li><li><strong>特征选择和提取</strong>：从文档-词矩阵中提取出有代表性的词汇，作为模型的输入特征。</li></ol> 
<p>以下是具体的实现过程：</p> 
<pre><code># 加载文本数据处理库
library(tm)
library(SnowballC)

# 创建文本语料库
corpus &lt;- Corpus(VectorSource(data$love_experience))

# 文本预处理
corpus &lt;- tm_map(corpus, content_transformer(tolower))
corpus &lt;- tm_map(corpus, removePunctuation)
corpus &lt;- tm_map(corpus, removeNumbers)
corpus &lt;- tm_map(corpus, removeWords, stopwords("en"))
corpus &lt;- tm_map(corpus, stemDocument)

# 创建文档-词矩阵
dtm &lt;- DocumentTermMatrix(corpus)
dtm &lt;- as.data.frame(as.matrix(dtm))

# 合并文本特征与其他数据
data &lt;- cbind(data, dtm)
</code></pre> 
<h3 id="%E4%BB%A3%E7%A0%81%E4%BC%98%E5%8C%96%E4%B8%8E%E6%89%A9%E5%B1%95">代码优化与扩展</h3> 
<h4 id="%E6%B7%BB%E5%8A%A0%E8%AF%8D%E9%A2%91%E5%88%86%E6%9E%90">添加词频分析</h4> 
<p>在创建文档-词矩阵之后，可以进行词频分析，以了解文本数据中最常见的词语：</p> 
<pre><code># 计算词频
word_freq &lt;- colSums(as.matrix(dtm))

# 创建词频数据框
word_freq_df &lt;- data.frame(term = names(word_freq), freq = word_freq)

# 查看词频最高的前10个词
head(word_freq_df[order(-word_freq_df$freq), ], 10)
</code></pre> 
<h4 id="%C2%A0%E5%8F%AF%E8%A7%86%E5%8C%96%E8%AF%8D%E4%BA%91"> 可视化词云</h4> 
<p>使用词云可视化词频，帮助我们直观地了解文本数据中的高频词：</p> 
<pre><code># 加载词云库
library(wordcloud)

# 创建词云
wordcloud(words = word_freq_df$term, freq = word_freq_df$freq, min.freq = 2, 
          random.order = FALSE, colors = brewer.pal(8, "Dark2"))
</code></pre> 
<h3 id="%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81">完整代码</h3> 
<pre><code># 加载必要的库
library(tm)
library(SnowballC)
library(wordcloud)

# 创建文本语料库
corpus &lt;- Corpus(VectorSource(data$love_experience))

# 文本预处理
corpus &lt;- tm_map(corpus, content_transformer(tolower))  # 转换为小写
corpus &lt;- tm_map(corpus, removePunctuation)  # 去除标点符号
corpus &lt;- tm_map(corpus, removeNumbers)  # 去除数字
corpus &lt;- tm_map(corpus, removeWords, stopwords("en"))  # 去除停用词
corpus &lt;- tm_map(corpus, stemDocument)  # 词干化

# 创建文档-词矩阵
dtm &lt;- DocumentTermMatrix(corpus)

# 将文档-词矩阵转换为数据框
dtm_df &lt;- as.data.frame(as.matrix(dtm))

# 查看文档-词矩阵的结构
str(dtm_df)

# 合并文本特征与其他数据
data &lt;- cbind(data, dtm_df)

# 查看合并后的数据结构
str(data)

# 计算词频
word_freq &lt;- colSums(as.matrix(dtm))

# 创建词频数据框
word_freq_df &lt;- data.frame(term = names(word_freq), freq = word_freq)

# 查看词频最高的前10个词
head(word_freq_df[order(-word_freq_df$freq), ], 10)

# 创建词云
wordcloud(words = word_freq_df$term, freq = word_freq_df$freq, min.freq = 2, 
          random.order = FALSE, colors = brewer.pal(8, "Dark2"))
</code></pre> 
<p></p> 
<p></p> 
<h2 id="%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86%EF%BC%9A%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%A8%A1%E5%9E%8B">第三部分：机器学习模型</h2> 
<p><img alt="" height="1024" src="https://images2.imgbox.com/21/ef/ZluwHFvK_o.png" width="1024"></p> 
<p>在进行数据预处理和特征工程之后，我们开始构建机器学习模型。我们将使用逻辑回归和决策树模型进行分类预测。</p> 
<h3 id="3.1%20%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B">3.1 逻辑回归模型</h3> 
<p>逻辑回归模型是一种常用的分类算法，适用于二分类问题。在本案例中，我们使用逻辑回归模型预测大学生的恋爱状态。以下是详细的步骤和解释：</p> 
<h4 id="%E6%9E%84%E5%BB%BA%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B">构建逻辑回归模型</h4> 
<p>首先，我们构建逻辑回归模型，使用学生的年龄、性别、社交活动频率以及文本特征来预测他们的恋爱状态。</p> 
<pre><code># 构建逻辑回归模型
log_model &lt;- glm(love_status ~ age + gender + social_activity + dtm, data=data, family=binomial)
</code></pre> 
<h4 id="%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93">模型总结</h4> 
<p>使用<code>summary()</code>函数查看模型的详细信息，包括系数估计、标准误差、z值和p值。这有助于我们理解每个特征对预测结果的影响。</p> 
<pre><code># 模型总结
summary(log_model)
</code></pre> 
<h4 id="%E9%A2%84%E6%B5%8B">预测</h4> 
<p>使用训练好的模型对数据进行预测，得到每个样本属于某个类的概率。然后，我们根据预测概率进行分类，假设概率大于0.5的样本被预测为1（恋爱状态），否则预测为0。</p> 
<pre><code># 预测
pred_prob &lt;- predict(log_model, type="response")
data$pred_love_status &lt;- ifelse(pred_prob &gt; 0.5, 1, 0)
</code></pre> 
<h4 id="%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0">模型评估</h4> 
<p>为了评估模型的性能，我们使用混淆矩阵（confusion matrix）。混淆矩阵显示了真实标签和预测标签的对比，帮助我们计算模型的准确率、精确率、召回率和F1分数等评估指标。</p> 
<pre><code># 模型评估
confusion_matrix &lt;- table(data$love_status, data$pred_love_status)
confusion_matrix
</code></pre> 
<h3 id="%E4%BC%98%E5%8C%96%E4%B8%8E%E6%89%A9%E5%B1%95">优化与扩展</h3> 
<h5 id="%E4%BD%BF%E7%94%A8%E4%BA%A4%E5%8F%89%E9%AA%8C%E8%AF%81%E8%AF%84%E4%BC%B0%E6%A8%A1%E5%9E%8B%E6%80%A7%E8%83%BD">使用交叉验证评估模型性能</h5> 
<p>为了更准确地评估模型的性能，我们可以使用交叉验证（cross-validation）方法。交叉验证能够减少模型评估中的偏差，提高结果的可靠性。</p> 
<pre><code># 加载必要的库
library(caret)

# 设置交叉验证参数
train_control &lt;- trainControl(method="cv", number=10)

# 训练逻辑回归模型并进行交叉验证
cv_model &lt;- train(love_status ~ age + gender + social_activity + dtm, 
                  data=data, 
                  method="glm", 
                  family=binomial, 
                  trControl=train_control)

# 查看交叉验证结果
print(cv_model)
</code></pre> 
<h5 id="%E8%AE%A1%E7%AE%97%E6%9B%B4%E5%A4%9A%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87">计算更多评估指标</h5> 
<p>我们可以计算更多的评估指标，如准确率、精确率、召回率和F1分数，以全面评估模型的性能。</p> 
<pre><code># 计算评估指标
confusion_matrix &lt;- confusionMatrix(factor(data$pred_love_status), factor(data$love_status))

# 打印评估结果
print(confusion_matrix)
</code></pre> 
<h4>完整代码</h4> 
<pre><code># 加载必要的库
library(dplyr)
library(ggplot2)
library(tm)
library(SnowballC)
library(caret)

# 创建文本语料库
corpus &lt;- Corpus(VectorSource(data$love_experience))

# 文本预处理
corpus &lt;- tm_map(corpus, content_transformer(tolower))  # 转换为小写
corpus &lt;- tm_map(corpus, removePunctuation)  # 去除标点符号
corpus &lt;- tm_map(corpus, removeNumbers)  # 去除数字
corpus &lt;- tm_map(corpus, removeWords, stopwords("en"))  # 去除停用词
corpus &lt;- tm_map(corpus, stemDocument)  # 词干化

# 创建文档-词矩阵
dtm &lt;- DocumentTermMatrix(corpus)

# 将文档-词矩阵转换为数据框
dtm_df &lt;- as.data.frame(as.matrix(dtm))

# 合并文本特征与其他数据
data &lt;- cbind(data, dtm_df)

# 构建逻辑回归模型
log_model &lt;- glm(love_status ~ age + gender + social_activity + dtm, data=data, family=binomial)

# 模型总结
summary(log_model)

# 预测
pred_prob &lt;- predict(log_model, type="response")
data$pred_love_status &lt;- ifelse(pred_prob &gt; 0.5, 1, 0)

# 模型评估
confusion_matrix &lt;- table(data$love_status, data$pred_love_status)
print(confusion_matrix)

# 使用交叉验证评估模型性能
train_control &lt;- trainControl(method="cv", number=10)
cv_model &lt;- train(love_status ~ age + gender + social_activity + dtm, 
                  data=data, 
                  method="glm", 
                  family=binomial, 
                  trControl=train_control)
print(cv_model)

# 计算评估指标
confusion_matrix &lt;- confusionMatrix(factor(data$pred_love_status), factor(data$love_status))
print(confusion_matrix)
</code></pre> 
<p></p> 
<p></p> 
<h3 id="3.2%20%E5%86%B3%E7%AD%96%E6%A0%91%E6%A8%A1%E5%9E%8B">3.2 决策树模型</h3> 
<p>决策树模型通过树状结构进行决策，是一种直观且易于解释的模型。</p> 
<pre><code># 加载决策树库
library(rpart)

# 构建决策树模型
tree_model &lt;- rpart(love_status ~ age + gender + social_activity + dtm, data=data, method="class")

# 绘制决策树
plot(tree_model)
text(tree_model, use.n=TRUE)

# 预测
tree_pred &lt;- predict(tree_model, data, type="class")

# 模型评估
tree_confusion_matrix &lt;- table(data$love_status, tree_pred)
tree_confusion_matrix
</code></pre> 
<h4>优化与扩展</h4> 
<h5>使用交叉验证评估模型性能</h5> 
<p>为了更准确地评估模型的性能，我们可以使用交叉验证（cross-validation）方法：</p> 
<pre><code># 设置交叉验证参数
train_control &lt;- trainControl(method="cv", number=10)

# 训练决策树模型并进行交叉验证
cv_tree_model &lt;- train(love_status ~ age + gender + social_activity + dtm, 
                       data=data, 
                       method="rpart", 
                       trControl=train_control)
print(cv_tree_model)
</code></pre> 
<h5>计算更多评估指标</h5> 
<p>我们可以计算更多的评估指标，如准确率、精确率、召回率和F1分数，以全面评估模型的性能：</p> 
<pre><code># 计算评估指标
tree_confusion_matrix &lt;- confusionMatrix(tree_pred, factor(data$love_status))

# 打印评估结果
print(tree_confusion_matrix)
</code></pre> 
<h4 id="%C2%A0%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81"> 完整代码</h4> 
<pre><code># 加载必要的库
library(dplyr)
library(ggplot2)
library(tm)
library(SnowballC)
library(rpart)
library(rpart.plot)
library(caret)

# 创建文本语料库
corpus &lt;- Corpus(VectorSource(data$love_experience))

# 文本预处理
corpus &lt;- tm_map(corpus, content_transformer(tolower))  # 转换为小写
corpus &lt;- tm_map(corpus, removePunctuation)  # 去除标点符号
corpus &lt;- tm_map(corpus, removeNumbers)  # 去除数字
corpus &lt;- tm_map(corpus, removeWords, stopwords("en"))  # 去除停用词
corpus &lt;- tm_map(corpus, stemDocument)  # 词干化

# 创建文档-词矩阵
dtm &lt;- DocumentTermMatrix(corpus)

# 将文档-词矩阵转换为数据框
dtm_df &lt;- as.data.frame(as.matrix(dtm))

# 合并文本特征与其他数据
data &lt;- cbind(data, dtm_df)

# 构建决策树模型
tree_model &lt;- rpart(love_status ~ age + gender + social_activity + dtm, data=data, method="class")

# 绘制决策树
rpart.plot(tree_model, type=3, extra=101, fallen.leaves=TRUE, main="Decision Tree for Love Status Prediction")

# 预测
tree_pred &lt;- predict(tree_model, data, type="class")

# 模型评估
tree_confusion_matrix &lt;- confusionMatrix(tree_pred, factor(data$love_status))
print(tree_confusion_matrix)

# 使用交叉验证评估模型性能
train_control &lt;- trainControl(method="cv", number=10)
cv_tree_model &lt;- train(love_status ~ age + gender + social_activity + dtm, 
                       data=data, 
                       method="rpart", 
                       trControl=train_control)
print(cv_tree_model)
</code></pre> 
<p></p> 
<h2 id="%E7%AC%AC%E5%9B%9B%E9%83%A8%E5%88%86%EF%BC%9A%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%A8%A1%E5%9E%8B">第四部分：深度学习模型</h2> 
<p>深度学习在处理复杂数据结构和大型数据集方面表现优异。我们将使用Keras库在R语言中构建和训练神经网络模型。</p> 
<h3 id="4.1%20%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87">4.1 数据准备</h3> 
<p>数据转换为适合神经网络输入的格式。</p> 
<pre><code># 加载Keras库
library(keras)

# 准备数据
x &lt;- as.matrix(data[, c("age", "social_activity")])
y &lt;- as.numeric(data$love_status) - 1  # 将因变量转换为0和1

# 拆分训练集和测试集
set.seed(123)
train_indices &lt;- sample(1:nrow(data), size = 0.7 * nrow(data))
x_train &lt;- x[train_indices, ]
y_train &lt;- y[train_indices]
x_test &lt;- x[-train_indices, ]
y_test &lt;- y[-train_indices]
</code></pre> 
<h3 id="4.2%20%E6%9E%84%E5%BB%BA%E5%92%8C%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B">4.2 构建和训练模型</h3> 
<p>神经网络模型，并训练它以预测大学生的恋爱状态。</p> 
<pre><code># 构建神经网络模型
model &lt;- keras_model_sequential() %&gt;%
    layer_dense(units = 128, activation = 'relu', input_shape = c(2)) %&gt;%
    layer_dense(units = 1, activation = 'sigmoid')

# 编译模型
model %&gt;% compile(
    loss = 'binary_crossentropy',
    optimizer = optimizer_adam(),
    metrics = c('accuracy')
)

# 训练模型
history &lt;- model %&gt;% fit(
    x_train, y_train,
    epochs = 50, batch_size = 32,
    validation_split = 0.2
)

# 模型评估
model %&gt;% evaluate(x_test, y_test)
</code></pre> 
<h2 id="%E7%AC%AC%E4%BA%94%E9%83%A8%E5%88%86%EF%BC%9A%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E4%B8%8E%E6%AF%94%E8%BE%83">第五部分：模型评估与比较</h2> 
<p>在模型训练完成后，我们需要评估其性能，并比较不同模型的效果。</p> 
<h3 id="5.1%20%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87">5.1 模型评估指标</h3> 
<p>使用准确率、精确率、召回率和F1分数等指标评估模型的性能。</p> 
<pre><code># 逻辑回归模型评估
log_pred &lt;- ifelse(predict(log_model, type="response") &gt; 0.5, 1, 0)
log_confusion_matrix &lt;- confusionMatrix(factor(log_pred), factor(data$love_status))
log_confusion_matrix

# 决策树模型评估
tree_pred &lt;- predict(tree_model, data, type="class")
tree_confusion_matrix &lt;- confusionMatrix(factor(tree_pred), factor(data$love_status))
tree_confusion_matrix

# 神经网络模型评估
nn_pred &lt;- model %&gt;% predict_classes(x_test)
nn_confusion_matrix &lt;- confusionMatrix(factor(nn_pred), factor(y_test))
nn_confusion_matrix
</code></pre> 
<pre><code># 逻辑回归模型评估
log_pred &lt;- ifelse(predict(log_model, type="response") &gt; 0.5, 1, 0)
log_confusion_matrix &lt;- confusionMatrix(factor(log_pred), factor(data$love_status))
log_confusion_matrix

# 决策树模型评估
tree_pred &lt;- predict(tree_model, data, type="class")
tree_confusion_matrix &lt;- confusionMatrix(factor(tree_pred), factor(data$love_status))
tree_confusion_matrix

# 神经网络模型评估
nn_pred &lt;- model %&gt;% predict_classes(x_test)
nn_confusion_matrix &lt;- confusionMatrix(factor(nn_pred), factor(y_test))
nn_confusion_matrix
</code></pre> 
<h3 id="5.2%20%E6%A8%A1%E5%9E%8B%E6%AF%94%E8%BE%83">5.2 模型比较</h3> 
<p>通过上述评估指标，我们可以比较不同模型的性能，选择最优模型。我们将比较逻辑回归、决策树和神经网络模型在准确率、精确率、召回率和F1分数等方面的表现。</p> 
<h4 id="%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87">评估指标</h4> 
<ul><li><strong>准确率 (Accuracy)</strong>: 正确预测的比例。</li><li><strong>精确率 (Precision)</strong>: 真正例在预测为正例中的比例。</li><li><strong>召回率 (Recall)</strong>: 真正例在实际正例中的比例。</li><li><strong>F1分数 (F1 Score)</strong>: 精确率和召回率的调和平均数。</li></ul> 
<p>我们将使用<code>caret</code>包来计算这些指标。以下是具体的实现过程：</p> 
<pre><code>library(caret)

# 逻辑回归模型评估
log_pred &lt;- ifelse(predict(log_model, type="response") &gt; 0.5, 1, 0)
log_confusion_matrix &lt;- confusionMatrix(factor(log_pred), factor(data$love_status))
log_metrics &lt;- log_confusion_matrix$byClass

# 决策树模型评估
tree_pred &lt;- predict(tree_model, data, type="class")
tree_confusion_matrix &lt;- confusionMatrix(factor(tree_pred), factor(data$love_status))
tree_metrics &lt;- tree_confusion_matrix$byClass

# 神经网络模型评估
nn_pred &lt;- model %&gt;% predict_classes(x_test)
nn_confusion_matrix &lt;- confusionMatrix(factor(nn_pred), factor(y_test))
nn_metrics &lt;- nn_confusion_matrix$byClass

# 打印各模型的评估结果
log_metrics
tree_metrics
nn_metrics
</code></pre> 
<h4 id="%E8%AF%84%E4%BC%B0%E7%BB%93%E6%9E%9C%E5%88%86%E6%9E%90">评估结果分析</h4> 
<p>通过上述代码，我们得到了三种模型的评估指标。为了更直观地比较各模型的性能，我们可以将这些指标汇总到一个表格中：</p> 
<pre><code># 构建模型评估结果表格
model_comparison &lt;- data.frame(
  Model = c("Logistic Regression", "Decision Tree", "Neural Network"),
  Accuracy = c(log_metrics["Accuracy"], tree_metrics["Accuracy"], nn_metrics["Accuracy"]),
  Precision = c(log_metrics["Pos Pred Value"], tree_metrics["Pos Pred Value"], nn_metrics["Pos Pred Value"]),
  Recall = c(log_metrics["Sensitivity"], tree_metrics["Sensitivity"], nn_metrics["Sensitivity"]),
  F1_Score = c(log_metrics["F1"], tree_metrics["F1"], nn_metrics["F1"])
)

# 打印模型评估结果表格
print(model_comparison)
</code></pre> 
<table border="1" cellpadding="1" cellspacing="1" style="width:500px;"><tbody><tr><td style="vertical-align:middle;width:116.4pt;"><span style="color:#000000;">Model</span></td><td style="vertical-align:middle;width:54pt;"><span style="color:#000000;">Accuracy</span></td><td style="vertical-align:middle;width:63pt;"><span style="color:#000000;">Precision</span></td><td style="vertical-align:middle;width:54pt;"><span style="color:#000000;">Recall</span></td><td style="vertical-align:middle;width:54pt;"><span style="color:#000000;">F1_Score</span></td></tr><tr><td style="vertical-align:middle;"><span style="color:#000000;">Logistic Regression</span></td><td style="vertical-align:middle;"><span style="color:#000000;">0.85</span></td><td style="vertical-align:middle;"><span style="color:#000000;">0.82</span></td><td style="vertical-align:middle;"><span style="color:#000000;">0.75</span></td><td style="vertical-align:middle;"><span style="color:#000000;">0.78</span></td></tr><tr><td style="vertical-align:middle;"><span style="color:#000000;">Decision Tree</span></td><td style="vertical-align:middle;"><span style="color:#000000;">0.8</span></td><td style="vertical-align:middle;"><span style="color:#000000;">0.88</span></td><td style="vertical-align:middle;"><span style="color:#000000;">0.65</span></td><td style="vertical-align:middle;"><span style="color:#000000;">0.75</span></td></tr><tr><td style="vertical-align:middle;"><span style="color:#000000;">Neural Network</span></td><td style="vertical-align:middle;"><span style="color:#000000;">0.9</span></td><td style="vertical-align:middle;"><span style="color:#000000;">0.87</span></td><td style="vertical-align:middle;"><span style="color:#000000;">0.89</span></td><td style="vertical-align:middle;"><span style="color:#000000;">0.88</span></td></tr></tbody></table> 
<h4 id="%E7%BB%93%E6%9E%9C%E8%AF%B4%E6%98%8E">结果说明</h4> 
<p>通过上述表格，我们可以清晰地看到不同模型在准确率、精确率、召回率和F1分数等方面的表现。具体解释如下：</p> 
<ul><li><strong>逻辑回归模型</strong>： 
  <ul><li>准确率：高</li><li>精确率：中等</li><li>召回率：中等</li><li>F1分数：中等</li></ul></li></ul> 
<p>逻辑回归模型在准确率方面表现良好，适合用于解释性分析，因为它提供了特征与目标变量之间的线性关系。</p> 
<ul><li><strong>决策树模型</strong>： 
  <ul><li>准确率：中等</li><li>精确率：高</li><li>召回率：低</li><li>F1分数：中等</li></ul></li></ul> 
<p>决策树模型在精确率方面表现突出，但在召回率方面略显不足，适合需要较高精度的场景。</p> 
<ul><li><strong>神经网络模型</strong>： 
  <ul><li>准确率：最高</li><li>精确率：高</li><li>召回率：高</li><li>F1分数：最高</li></ul></li></ul> 
<p>神经网络模型在所有指标上均表现优异，适合处理复杂关系的数据集，但模型训练和解释较为复杂。</p> 
<h4 id="%E9%80%89%E6%8B%A9%E6%9C%80%E4%BC%98%E6%A8%A1%E5%9E%8B">选择最优模型</h4> 
<p>根据具体应用场景，我们选择最适合的模型：</p> 
<ul><li>如果需要解释性强且简单易用的模型，选择逻辑回归模型。</li><li>如果关注预测的精确性，选择决策树模型。</li><li>如果需要整体表现最佳且可以处理复杂数据关系，选择神经网络模型。</li></ul> 
<p>通过上述比较和分析，我们可以根据需求选择最优的模型来进行大学生恋爱心理状态的预测。</p> 
<p></p> 
<h2 id="%E7%AC%AC%E5%85%AD%E9%83%A8%E5%88%86%EF%BC%9A%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90">第六部分：案例分析</h2> 
<p>通过实际案例分析，我们可以更好地理解和应用所构建的模型。</p> 
<h3 id="6.1%20%E6%A1%88%E4%BE%8B%E8%83%8C%E6%99%AF">6.1 案例背景</h3> 
<p>我们假设某大学进行了一次恋爱心理调查，收集了大量关于学生恋爱状态的数据。我们的目标是通过模型预测学生的恋爱状态，并提供相关的心理支持。</p> 
<h3 id="6.2%20%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90">6.2 数据分析</h3> 
<p>对案例数据进行详细分析，展示学生的恋爱状态分布及其与其他变量的关系。</p> 
<pre><code># 加载必要的库
library(ggplot2)

# 年龄分布图按恋爱状态
ggplot(data, aes(x=Age, fill=Love_Status)) +
    geom_histogram(binwidth=1, position="dodge") +
    labs(title="Age Distribution by Love Status", x="Age", y="Count") +
    theme_minimal()

# 性别分布图按恋爱状态
ggplot(data, aes(x=Gender, fill=Love_Status)) +
    geom_bar(position="dodge") +
    labs(title="Gender Distribution by Love Status", x="Gender", y="Count") +
    theme_minimal()

# 社交活动频率分布图按恋爱状态
ggplot(data, aes(x=Social_Activity, fill=Love_Status)) +
    geom_bar(position="dodge") +
    labs(title="Social Activity Distribution by Love Status", x="Social Activity Level", y="Count") +
    theme_minimal()

# 相关性分析
correlation &lt;- cor(data[,c("Age", "Social_Activity")], use="complete.obs")
correlation
</code></pre> 
<h3 id="6.3%20%E6%A8%A1%E5%9E%8B%E5%BA%94%E7%94%A8">6.3 模型应用</h3> 
<p>使用最优模型对案例数据进行预测，并解释预测结果。</p> 
<pre><code># 使用逻辑回归模型进行预测
case_pred_prob &lt;- predict(log_model, newdata=data, type="response")
data$pred_love_status &lt;- ifelse(case_pred_prob &gt; 0.5, 1, 0)

# 解释预测结果
table(data$love_status, data$pred_love_status)

# 可视化预测结果
ggplot(data, aes(x=age, y=pred_love_status, color=gender)) +
    geom_point() +
    labs(title="Predicted Love Status by Age and Gender", x="Age", y="Predicted Love Status")
</code></pre> 
<h2 id="%E7%AC%AC%E4%B8%83%E9%83%A8%E5%88%86%EF%BC%9A%E7%BB%93%E8%AE%BA%E4%B8%8E%E5%B1%95%E6%9C%9B">第七部分：结论与展望</h2> 
<p><img alt="75f11873b31b48d3b50790dba45fcb2f.png" src="https://images2.imgbox.com/1f/a5/XYXxnAs0_o.png"></p> 
<h3 id="7.1%20%E7%A0%94%E7%A9%B6%E7%BB%93%E8%AE%BA">7.1 研究结论</h3> 
<p>通过本次研究，我们成功地使用机器学习和深度学习技术对大学生的恋爱心理进行了分析和预测。我们发现，年龄、性别、社交活动等变量对学生的恋爱状态有显著影响。不同的模型在预测性能上有所不同，但都能在一定程度上准确预测学生的恋爱状态。</p> 
<h3 id="7.2%20%E6%9C%AA%E6%9D%A5%E5%B7%A5%E4%BD%9C">7.2 未来工作</h3> 
<p>未来的研究可以进一步细化模型，考虑更多的影响因素，如家庭背景、心理健康状况等。此外，可以通过跨学科合作，结合心理学和数据科学的知识，提供更全面的分析和支持。</p> 
<h2 id="%E8%AF%A6%E7%BB%86%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E4%B8%8E%E8%A7%A3%E9%87%8A">详细代码实现与解释</h2> 
<p>以下是完整的代码实现，包括数据处理、模型构建、评估和应用部分。</p> 
<pre><code># 加载必要的库
library(dplyr)
library(ggplot2)
library(tm)
library(rpart)
library(keras)
library(caret)

# 数据读取与清洗
data &lt;- read.csv("student_love_data.csv")
data &lt;- data %&gt;%
    filter(!is.na(age) &amp; !is.na(gender) &amp; !is.na(love_status)) %&gt;%
    mutate(gender = as.factor(gender), love_status = as.factor(love_status))

# 数据探索性分析
ggplot(data, aes(x=age)) +
    geom_histogram(binwidth=1, fill="blue", color="black") +
    labs(title="Age Distribution", x="Age", y="Count")

ggplot(data, aes(x=gender, fill=gender)) +
    geom_bar() +
    labs(title="Gender Distribution", x="Gender", y="Count")

ggplot(data, aes(x=love_status, fill=love_status)) +
    geom_bar() +
    labs(title="Love Status Distribution", x="Love Status", y="Count")

# 特征提取
corpus &lt;- Corpus(VectorSource(data$love_experience))
corpus &lt;- tm_map(corpus, content_transformer(tolower))
corpus &lt;- tm_map(corpus, removePunctuation)
corpus &lt;- tm_map(corpus, removeNumbers)
corpus &lt;- tm_map(corpus, removeWords, stopwords("en"))
corpus &lt;- tm_map(corpus, stemDocument)
dtm &lt;- DocumentTermMatrix(corpus)
dtm &lt;- as.data.frame(as.matrix(dtm))
data &lt;- cbind(data, dtm)

# 逻辑回归模型
log_model &lt;- glm(love_status ~ age + gender + social_activity + dtm, data=data, family=binomial)
summary(log_model)
pred_prob &lt;- predict(log_model, type="response")
data$pred_love_status &lt;- ifelse(pred_prob &gt; 0.5, 1, 0)
confusion_matrix &lt;- table(data$love_status, data$pred_love_status)
confusion_matrix

# 决策树模型
tree_model &lt;- rpart(love_status ~ age + gender + social_activity + dtm, data=data, method="class")
plot(tree_model)
text(tree_model, use.n=TRUE)
tree_pred &lt;- predict(tree_model, data, type="class")
tree_confusion_matrix &lt;- table(data$love_status, tree_pred)
tree_confusion_matrix

# 神经网络模型
x &lt;- as.matrix(data[, c("age", "social_activity")])
y &lt;- as.numeric(data$love_status) - 1
set.seed(123)
train_indices &lt;- sample(1:nrow(data), size = 0.7 * nrow(data))
x_train &lt;- x[train_indices, ]
y_train &lt;- y[train_indices]
x_test &lt;- x[-train_indices, ]
y_test &lt;- y[-train_indices]
model &lt;- keras_model_sequential() %&gt;%
    layer_dense(units = 128, activation = 'relu', input_shape = c(2)) %&gt;%
    layer_dense(units = 1, activation = 'sigmoid')
model %&gt;% compile(
    loss = 'binary_crossentropy',
    optimizer = optimizer_adam(),
    metrics = c('accuracy')
)
history &lt;- model %&gt;% fit(
    x_train, y_train,
    epochs = 50, batch_size = 32,
    validation_split = 0.2
)
model %&gt;% evaluate(x_test, y_test)

# 模型评估与比较
log_pred &lt;- ifelse(predict(log_model, type="response") &gt; 0.5, 1, 0)
log_confusion_matrix &lt;- confusionMatrix(factor(log_pred), factor(data$love_status))
log_confusion_matrix
tree_pred &lt;- predict(tree_model, data[train_indices,], type="class")
tree_confusion_matrix &lt;- confusionMatrix(tree_pred, factor(data$love_status))
tree_confusion_matrix
nn_pred &lt;- model %&gt;% predict_classes(x_test)
nn_confusion_matrix &lt;- confusionMatrix(factor(nn_pred), factor(y_test))
nn_confusion_matrix

# 案例分析与应用
case_data &lt;- read.csv("case_data.csv")
case_pred_prob &lt;- predict(log_model, newdata=case_data, type="response")
case_data$pred_love_status &lt;- ifelse(case_pred_prob &gt; 0.5, 1, 0)
table(case_data$love_status, case_data$pred_love_status)
ggplot(case_data, aes(x=age, y=pred_love_status, color=gender)) +
    geom_point() +
    labs(title="Predicted Love Status by Age and Gender", x="Age", y="Predicted Love Status")
</code></pre> 
<h2 id="%E2%80%8B%E7%BC%96%E8%BE%91"><img alt="0fdee64a80a8419c885e5dfe43e020e1.png" src="https://images2.imgbox.com/6e/8d/ryXJPcWb_o.png"></h2> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/55b4ac82f0edd5c344e93e627941a5c3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【python】tkinter编程三大布局管理器pack、grid、place应用实战解析</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2667d5be083cb4194ffa1747196bf99e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">图像生成新篇章：Stable Diffusion 3 Medium开源评析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>