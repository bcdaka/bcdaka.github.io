<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>大数据技术原理与应用实验指南——HBase编程实践 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/24f14b968126a348ec6300550dbee937/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="大数据技术原理与应用实验指南——HBase编程实践">
  <meta property="og:description" content="大数据技术原理与应用实验指南——HBase安装与编程实践 一、 实验目的
（1） 熟练使用HBase操作常用的Shell命令。
（2） 熟悉HBase操作常用的Java API。
二、 实验内容
（1） 安装HBase软件。
（2） 编程实现指定功能，并利用Hadoop提供的Shell命令完成相同的任务（实现增、删、改、查基本操作，统计表的行数，打印表的记录等操作）。
三、 实验平台（软件版本）
VirtualBox-6.1.4
jdk-8u162-linux-x64.tar
ubuntukylin-16.04-desktop-amd64
hadoop-3.1.3
FileZilla_3.17.0.0_win64_setup 这是一个用于将windows文件与linux互相传的软件-
hbase-2.2.2-bin.tar.gz
四、 实验步骤 (全分布环境下搭建HBase ——一主三从并实现 HBase 的Java Api )
实验思维导图：
全分布环境下搭建HBase （1）下载安装Hbase，将Hbase传送至linux系统上的根目录下。
（2）解压安装包hbase-2.2.2-bin.tar.gz至路径 /usr/local，命令如下：
$ cd ~ $ sudo tar -zxvf ~/hbase-2.2.2-bin.tar.gz -C /usr/local （3）将解压的文件名hbase-2.2.2改为hbase，以方便使用，命令如下：
$ cd /usr/local $ sudo mv ./hbase-2.2.2 ./hbase （4）下面把hbase目录权限赋hadoop用户：
$ cd /usr/local $ sudo chown -R hadoop ./hbase （5）配置环境变量，集群上的每个节点都要配置：
$ vim ~/.bashrc 在尾部加：(之后保存退出)">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-02-16T15:55:16+08:00">
    <meta property="article:modified_time" content="2024-02-16T15:55:16+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">大数据技术原理与应用实验指南——HBase编程实践</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="HBase_0"></a>大数据技术原理与应用实验指南——HBase安装与编程实践</h2> 
<p><strong>一、</strong> <strong>实验目的</strong></p> 
<p>（1） 熟练使用HBase操作常用的Shell命令。</p> 
<p>（2） 熟悉HBase操作常用的Java API。</p> 
<p><strong>二、</strong> <strong>实验内容</strong></p> 
<p>（1） 安装HBase软件。</p> 
<p>（2） 编程实现指定功能，并利用Hadoop提供的Shell命令完成相同的任务（实现增、删、改、查基本操作，统计表的行数，打印表的记录等操作）。</p> 
<p><strong>三、</strong> <strong>实验平台（软件版本）</strong></p> 
<p><em>VirtualBox-6.1.4</em></p> 
<p><em>jdk-8u162-linux-x64.tar</em></p> 
<p><em>ubuntukylin-16.04-desktop-amd64</em></p> 
<p><em>hadoop-3.1.3</em></p> 
<p><em>FileZilla_3.17.0.0_win64_setup 这是一个用于将windows文件与linux互相传的软件-</em></p> 
<p>hbase-2.2.2-bin.tar.gz</p> 
<p><strong>四、</strong> <strong>实验步骤 (全分布环境下搭建HBase ——一主三从并实现 HBase 的Java Api )</strong></p> 
<hr> 
<h3><a id="%0Ahttpsimgblogcsdnimgcndirectd3b8a000a52b411e84865bb581189518png_32"></a><em>实验思维导图</em>：<br> <img src="https://images2.imgbox.com/67/a1/ZLmaURef_o.png" alt="在这里插入图片描述"></h3> 
<ol><li><em><strong>全分布环境下搭建HBase</strong></em></li></ol> 
<p>（1）下载安装Hbase，将Hbase传送至linux系统上的根目录下。</p> 
<p>（2）解压安装包hbase-2.2.2-bin.tar.gz至路径 /usr/local，命令如下：</p> 
<pre><code class="prism language-shell">$ <span class="token builtin class-name">cd</span> ~
$ <span class="token function">sudo</span> <span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> ~/hbase-2.2.2-bin.tar.gz <span class="token parameter variable">-C</span> /usr/local
</code></pre> 
<p>（3）将解压的文件名hbase-2.2.2改为hbase，以方便使用，命令如下：</p> 
<pre><code class="prism language-shell">$ <span class="token builtin class-name">cd</span> /usr/local
$ <span class="token function">sudo</span> <span class="token function">mv</span> ./hbase-2.2.2 ./hbase
</code></pre> 
<p>（4）下面把hbase目录权限赋hadoop用户：</p> 
<pre><code class="prism language-shell">$ <span class="token builtin class-name">cd</span> /usr/local
$ <span class="token function">sudo</span> <span class="token function">chown</span> <span class="token parameter variable">-R</span> hadoop ./hbase
</code></pre> 
<p>（5）配置环境变量，集群上的每个节点都要配置：</p> 
<pre><code class="prism language-shell">$ <span class="token function">vim</span> ~/.bashrc
</code></pre> 
<p><u>在尾部加：(之后保存退出)</u></p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">export</span> <span class="token assign-left variable">HBASE_HOME</span><span class="token operator">=</span>/usr/local/hbase
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token environment constant">$PATH</span><span class="token builtin class-name">:</span><span class="token variable">$HBASE_HOME</span>/bin
</code></pre> 
<p><em>改变的每个节点的~/.bashrc后的结果如图所示</em><br> <img src="https://images2.imgbox.com/be/e4/0vf9nHd8_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-shell">$ <span class="token builtin class-name">source</span> ~/.bashrc <span class="token comment">#使配置生效！！千万不能忘记</span>
</code></pre> 
<p>（6）修改hbase的配置文件：</p> 
<p>① hbase-env.sh文件的修改：</p> 
<p><em>注意：hbase-env.sh中本来就存在如下这些变量的配置，大家只需要删除前面的#并修改配置内容即可(#代表注释)</em></p> 
<pre><code class="prism language-shell">$ <span class="token builtin class-name">cd</span> /usr/local/hbase/conf <span class="token comment">#切换到配置文件的目录</span>
$ <span class="token function">vim</span> hbase-env.sh
</code></pre> 
<pre><code class="prism language-shell"><span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span>/usr/lib/jvm/jdk1.8.0_162
<span class="token comment">#因为是分布式的hbase安装，所以要在hbase-env.sh里设置java环境变量</span>
<span class="token comment">#修改HBASE_CLASSPATH帮助找到hbase</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HBASE_CLASSPATH</span><span class="token operator">=</span>/usr/local/hbase/conf
</code></pre> 
<p><em>图中给出上下文，便于寻找</em></p> 
<p><img src="https://images2.imgbox.com/40/e2/w5UvtEy5_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">export</span> <span class="token assign-left variable">HBASE_MANAGES_ZK</span><span class="token operator">=</span>true<span class="token comment">#因为使用hbase自带的zookeeper，所以将HBASE_MANAGES_ZK设为true</span>
</code></pre> 
<p><em>图中给出上下文，便于寻找</em><br> <img src="https://images2.imgbox.com/59/ac/nyoRA6zP_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-shell">$ <span class="token builtin class-name">source</span> hbase-env.sh <span class="token comment">#使得配置生效！！！不能忘记</span>
</code></pre> 
<p>② hbase-site.xml文件的修改：</p> 
<pre><code class="prism language-sh">$ <span class="token function">vim</span> hbase-site.xml
</code></pre> 
<p>配置的内容如下：将原来 …中添加如下内容</p> 
<pre><code class="prism language-visual">&lt;property&gt;
    &lt;name&gt;hbase.rootdir&lt;/name&gt;
    &lt;value&gt;hdfs://Master:9000/hbase&lt;/value&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;hbase.zookeeper.property.dataDir&lt;/name&gt;
    &lt;value&gt;/home/hadoop/zookeeper&lt;/value&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;hbase.cluster.distributed&lt;/name&gt;
    &lt;value&gt;true&lt;/value&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;hbase.zookeeper.quorum&lt;/name&gt;
    &lt;value&gt;Master,Slave1,Slave2,Slave3&lt;/value&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;hbase.unsafe.stream.capability.enforce&lt;/name&gt;
    &lt;value&gt;false&lt;/value&gt;
&lt;/property&gt;
</code></pre> 
<p>参数解释如下：</p> 
<p>a) hbase.rootdir，用于指定HBase数据的存储位置，因为如果不设置的话，hbase.rootdir默认为/tmp/hbase-${user.name},这意味着每次重启系统都会丢失数据。</p> 
<p>b) hbase.cluster.distributed 值为 ture设置集群处于分布式模式.</p> 
<p>c）hbase.zookeeper.property.dataDir：用于指定HBase自带的ZooKeeper存储数据的本地路径</p> 
<p>e）hbase.zookeeper.quorum：对于HBase的完全分布式模式（使用HBase内置的ZooKeeper），应将该参数的值设置为作为内置zookeeper的主机列表，此时在配置文件hbase-env.sh中的HBASE_MANAGES_ZK参数必须为true</p> 
<p><em>修改hbase-env.sh结果如图所示</em><br> <img src="https://images2.imgbox.com/f3/b4/5crKBrbi_o.png" alt="在这里插入图片描述"></p> 
<p>③配置regionservers文件</p> 
<pre><code class="prism language-shell">$ <span class="token function">sudo</span> <span class="token function">vim</span> regionservers <span class="token comment">#此文件在/usr/local/hbase/conf下</span>
</code></pre> 
<p><u>配置所有节点的主机名，类似于hadoop里的slave文件，也是一行一个。(如下表所示)</u></p> 
<pre><code class="prism language-visual">Master
Slave1
Slave2
Slave3
</code></pre> 
<p>④拷贝Hadoop的两个配置文件core-site.xml和hdfs-site.xml到HBase的配置文件目录（HBase对HDFS有依赖关系）</p> 
<p><u>依次执行命令</u></p> 
<pre><code class="prism language-shell">$ <span class="token function">cp</span> /usr/local/hadoop/etc/hadoop/core-site.xml /usr/local/hbase/conf
$ <span class="token function">cp</span> /usr/local/hadoop/etc/hadoop/hdfs-site.xml /usr/local/hbase/conf
</code></pre> 
<p>（7） 将配置过的整个hbase文件使用scp命令传输到各个slave上：</p> 
<p><u>依次执行命令</u></p> 
<pre><code class="prism language-shell">$ <span class="token builtin class-name">cd</span>  /usr/local/hbase/conf  <span class="token comment"># 切换到配置文件所在目录</span>
$ <span class="token function">scp</span> hbase-env.sh hbase-site.xml core-site.xml hdfs-site.xml regionservers  hadoop@Slave1:/usr/local/hbase/conf/
$ <span class="token function">scp</span> hbase-env.sh hbase-site.xml core-site.xml hdfs-site.xml regionservers  hadoop@Slave2:/usr/local/hbase/conf/
$ <span class="token function">scp</span> hbase-env.sh hbase-site.xml core-site.xml hdfs-site.xml regionservers  hadoop@Slave3:/usr/local/hbase/conf/

</code></pre> 
<p><u>别忘了要在所有节点执行如下命令，使得HBase的配置参数生效：</u></p> 
<pre><code class="prism language-shell">$ <span class="token builtin class-name">source</span> hbase-env.sh
</code></pre> 
<p>（8）启动Hbase：<u>(请在启动前确保集群（一主三从）已经启动)</u></p> 
<pre><code class="prism language-shell">$ start-hbase.sh  
</code></pre> 
<p><em>启动过程如图所示</em><br> <img src="https://images2.imgbox.com/17/ee/nvR47AtQ_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-shell">$ jps <span class="token comment">#使用jps进行检验是否所有进程启动</span>
</code></pre> 
<p><em>主节点启动结果如图所示</em><br> <img src="https://images2.imgbox.com/16/63/lPhP7JMW_o.png" alt="在这里插入图片描述"></p> 
<p><em>从节点启动结果如图所示</em></p> 
<p><img src="https://images2.imgbox.com/46/cb/LLNB53tk_o.png" alt="在这里插入图片描述"></p> 
<p><u>自此HBase的配置便全部结束了</u></p> 
<hr> 
<ol start="2"><li><em><strong>实现 HBase 的shell编程与Java Api</strong></em></li></ol> 
<p>（1）进入shell界面</p> 
<pre><code class="prism language-sh">$ hbase shell
</code></pre> 
<p><em>进入shell界面如图所示</em><br> <img src="https://images2.imgbox.com/53/81/qQv5niPg_o.png" alt="在这里插入图片描述"></p> 
<p><em>初步测试，shell中list命令的结果如图所示</em></p> 
<p><img src="https://images2.imgbox.com/e4/4b/mNral2Dz_o.png" alt="在这里插入图片描述"></p> 
<p>（2） shell命令交互</p> 
<p>a) 表格操作</p> 
<pre><code class="prism language-shell"><span class="token comment"># 列出已有表格</span>
 <span class="token operator">&gt;</span> list

 <span class="token comment"># 建立表格</span>
 <span class="token operator">&gt;</span> create <span class="token string">'student'</span>,<span class="token string">'Sname'</span>,<span class="token string">'Ssex'</span>,<span class="token string">'Sage'</span>,<span class="token string">'Sdept'</span>,<span class="token string">'course'</span>

 <span class="token comment"># 查看表格信息</span>
 <span class="token operator">&gt;</span> describe <span class="token string">'student'</span>
</code></pre> 
<p><em>创建表格后查看表格信息结果如图所示</em><br> <img src="https://images2.imgbox.com/c8/80/jJTKe1dy_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/af/49/4tUxW9UP_o.png" alt="在这里插入图片描述"></p> 
<p>b) 数据操作：增删改查（在student表格上测试）</p> 
<p><u>改：在添加数据时，HBase会自动为添加的数据添加一个时间戳，故在需要修改数据时，只需直接添加数据，HBase即会生成一个新的版本，从而完成“改”操作</u></p> 
<pre><code class="prism language-shell"><span class="token comment"># 增加数据：一次只能为一个单元格添加一个数据，实际一般利用编程操作数据。</span>
<span class="token operator">&gt;</span> put <span class="token string">'student'</span>,<span class="token string">'95001'</span>, <span class="token string">'Sname'</span>,<span class="token string">'LiYing'</span>
<span class="token operator">&gt;</span> put <span class="token string">'student'</span>,<span class="token string">'95001'</span>, <span class="token string">'course:math'</span>,<span class="token string">'80'</span>
<span class="token operator">&gt;</span> list
 <span class="token comment"># 查看数据</span>
<span class="token operator">&gt;</span> get <span class="token string">'student'</span>,<span class="token string">'95001'</span>    <span class="token comment"># 查看表的某一行数据</span>
<span class="token operator">&gt;</span> scan <span class="token string">'student'</span>         <span class="token comment"># 查看某个表的全部数据</span>
<span class="token operator">&gt;</span> deleteall <span class="token string">'student'</span>,<span class="token string">'95001'</span>      <span class="token comment"># 删除一行数据</span>
<span class="token operator">&gt;</span> scan <span class="token string">'student'</span> <span class="token comment">#查看删除一行数据后的结果</span>
<span class="token operator">&gt;</span> get <span class="token string">'student'</span>,<span class="token string">'95001'</span> <span class="token comment">#查看表结果</span>
 <span class="token comment"># 删除数据</span>
<span class="token operator">&gt;</span> delete <span class="token string">'student'</span>,<span class="token string">'95001'</span>,<span class="token string">'Sname'</span> <span class="token comment"># 删除一个数据</span>
 <span class="token comment"># 删除表格：第一步先让该表不可用，第二步才能删除表。</span>
<span class="token operator">&gt;</span> disable <span class="token string">'student'</span>
<span class="token operator">&gt;</span> drop <span class="token string">'student'</span>

</code></pre> 
<p><em>以上代码实现的结果如图所示</em><br> <img src="https://images2.imgbox.com/5c/09/eDPh6O78_o.jpg" alt="在这里插入图片描述"></p> 
<p>c) 查询表历史数据：（查询表的历史版本，需要两步。）</p> 
<pre><code class="prism language-shell"><span class="token comment">#创建表的时候，指定保存的版本数（假设指定为5）</span>
$ create <span class="token string">'teacher'</span>,<span class="token punctuation">{<!-- --></span>NAME<span class="token operator">=</span><span class="token operator">&gt;</span><span class="token string">'username'</span>,VERSIONS<span class="token operator">=</span><span class="token operator">&gt;</span><span class="token number">5</span><span class="token punctuation">}</span>
<span class="token comment">#插入数据然后更新数据，使其产生历史版本数据，注意：这里插入数据和更新数据都是用put命令</span>
$ put <span class="token string">'teacher'</span>,<span class="token string">'91001'</span>,<span class="token string">'username'</span>,<span class="token string">'Mary'</span>
$ put <span class="token string">'teacher'</span>,<span class="token string">'91001'</span>,<span class="token string">'username'</span>,<span class="token string">'Mary1'</span>
$ put <span class="token string">'teacher'</span>,<span class="token string">'91001'</span>,<span class="token string">'username'</span>,<span class="token string">'Mary2'</span>
$ put <span class="token string">'teacher'</span>,<span class="token string">'91001'</span>,<span class="token string">'username'</span>,<span class="token string">'Mary3'</span>
$ put <span class="token string">'teacher'</span>,<span class="token string">'91001'</span>,<span class="token string">'username'</span>,<span class="token string">'Mary4'</span>  
$ put <span class="token string">'teacher'</span>,<span class="token string">'91001'</span>,<span class="token string">'username'</span>,<span class="token string">'Mary5'</span>
<span class="token comment">#查询时，指定查询的历史版本数。默认会查询出最新的数据。（有效取值为1到5）</span>
$ get <span class="token string">'teacher'</span>,<span class="token string">'91001'</span>,<span class="token punctuation">{<!-- --></span>COLUMN<span class="token operator">=</span><span class="token operator">&gt;</span><span class="token string">'username'</span>,VERSIONS<span class="token operator">=</span><span class="token operator">&gt;</span><span class="token number">5</span><span class="token punctuation">}</span>
</code></pre> 
<p><em>以上查询历史的结果截图如下：</em><br> <img src="https://images2.imgbox.com/0c/13/HN8Iz1Kz_o.png" alt="在这里插入图片描述"></p> 
<p>d) 退出shell界面的操作如下</p> 
<pre><code class="prism language-shell">hbase<span class="token punctuation">(</span>main<span class="token punctuation">)</span>:002:<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> <span class="token builtin class-name">exit</span> <span class="token comment">#退出Shell命令，注意：这里退出HBase数据库是退出对数据库表的操作，而不是停止启动HBase数据库后台运行。</span>
</code></pre> 
<hr> 
<p>（3）HBase Java API编程实践</p> 
<p>a) 启动Eclipse，启动以后，<em>出现如下图所示界面</em>，点击界面右下角的“Launch”按钮<br> <img src="https://images2.imgbox.com/11/c6/6wOl6eYS_o.png" alt="在这里插入图片描述"></p> 
<p>b) <em>启动进入Eclipse以后的程序开发界面如下图所示。</em><br> <img src="https://images2.imgbox.com/22/dd/141wC8tx_o.png" alt="在这里插入图片描述"></p> 
<p>c) 点击界面顶部的“File”菜单，在弹出的子菜单<em>如下图所示</em>中选择“New”，再选择子菜单中的“Java Project”。<br> <img src="https://images2.imgbox.com/b9/37/B90Mn72k_o.png" alt="在这里插入图片描述"></p> 
<p>d) 这时会弹出一个<u>java project</u> 创建对话框，<u>在“Project name”文本框中输入“HBaseExample”</u>，在“JRE”选项卡中<u>选中第2项</u>“Use a project specific JRE”，然后点击界面底部的“<u>Next</u>”按钮。在弹出的界面中,用鼠标点击<u>“Libraries”</u>选项卡，然后，点击<u>界面右侧的“Add External JARs…”</u>按钮,</p> 
<p><em>导入下图文件中的包：步骤如下面两张图所示：</em><br> <img src="https://images2.imgbox.com/37/f6/8eiyrsKh_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/d2/53/QTXxbXtN_o.png" alt="在这里插入图片描述"><br> <em>全部导入完毕后，点击OK即可</em></p> 
<p>e) 在界面左侧的“HBaseExample”工程名称上单击鼠标右键，在弹出的菜单中选择“New”，再在弹出的子菜单中选择“Class”。创建一个新的类ExampleForHBase</p> 
<p><em>ExampleForHBase.java代码内容如图所示：</em></p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>conf<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>hbase<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>hbase<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>hbase<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Bytes</span></span><span class="token punctuation">;</span>
 
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExampleForHBase</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Configuration</span> configuration<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Connection</span> connection<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Admin</span> admin<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">"student"</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span><span class="token string">"score"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">insertData</span><span class="token punctuation">(</span><span class="token string">"student"</span><span class="token punctuation">,</span><span class="token string">"zhangsan"</span><span class="token punctuation">,</span><span class="token string">"score"</span><span class="token punctuation">,</span><span class="token string">"English"</span><span class="token punctuation">,</span><span class="token string">"69"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">insertData</span><span class="token punctuation">(</span><span class="token string">"student"</span><span class="token punctuation">,</span><span class="token string">"zhangsan"</span><span class="token punctuation">,</span><span class="token string">"score"</span><span class="token punctuation">,</span><span class="token string">"Math"</span><span class="token punctuation">,</span><span class="token string">"86"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">insertData</span><span class="token punctuation">(</span><span class="token string">"student"</span><span class="token punctuation">,</span><span class="token string">"zhangsan"</span><span class="token punctuation">,</span><span class="token string">"score"</span><span class="token punctuation">,</span><span class="token string">"Computer"</span><span class="token punctuation">,</span><span class="token string">"77"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">getData</span><span class="token punctuation">(</span><span class="token string">"student"</span><span class="token punctuation">,</span> <span class="token string">"zhangsan"</span><span class="token punctuation">,</span> <span class="token string">"score"</span><span class="token punctuation">,</span><span class="token string">"English"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        configuration  <span class="token operator">=</span> <span class="token class-name">HBaseConfiguration</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        configuration<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"hbase.rootdir"</span><span class="token punctuation">,</span><span class="token string">"hdfs://192.168.43.49:9000/hbase"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span><span class="token punctuation">{<!-- --></span>
            connection <span class="token operator">=</span> <span class="token class-name">ConnectionFactory</span><span class="token punctuation">.</span><span class="token function">createConnection</span><span class="token punctuation">(</span>configuration<span class="token punctuation">)</span><span class="token punctuation">;</span>
            admin <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">getAdmin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>admin <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                admin<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> connection<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">createTable</span><span class="token punctuation">(</span><span class="token class-name">String</span> myTableName<span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> colFamily<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">TableName</span> tableName <span class="token operator">=</span> <span class="token class-name">TableName</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>myTableName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>admin<span class="token punctuation">.</span><span class="token function">tableExists</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"talbe is exists!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">TableDescriptorBuilder</span> tableDescriptor <span class="token operator">=</span> <span class="token class-name">TableDescriptorBuilder</span><span class="token punctuation">.</span><span class="token function">newBuilder</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token operator">:</span>colFamily<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token class-name">ColumnFamilyDescriptor</span> family <span class="token operator">=</span> 
<span class="token class-name">ColumnFamilyDescriptorBuilder</span><span class="token punctuation">.</span><span class="token function">newBuilder</span><span class="token punctuation">(</span><span class="token class-name">Bytes</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                tableDescriptor<span class="token punctuation">.</span><span class="token function">setColumnFamily</span><span class="token punctuation">(</span>family<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            admin<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span>tableDescriptor<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> 
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">insertData</span><span class="token punctuation">(</span><span class="token class-name">String</span> tableName<span class="token punctuation">,</span><span class="token class-name">String</span> rowKey<span class="token punctuation">,</span><span class="token class-name">String</span> colFamily<span class="token punctuation">,</span><span class="token class-name">String</span> col<span class="token punctuation">,</span><span class="token class-name">String</span> val<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span> 
        <span class="token class-name">Table</span> table <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">getTable</span><span class="token punctuation">(</span><span class="token class-name">TableName</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Put</span> put <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Put</span><span class="token punctuation">(</span>rowKey<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        put<span class="token punctuation">.</span><span class="token function">addColumn</span><span class="token punctuation">(</span>colFamily<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>col<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> val<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        table<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>put<span class="token punctuation">)</span><span class="token punctuation">;</span>
        table<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token class-name">String</span> tableName<span class="token punctuation">,</span><span class="token class-name">String</span> rowKey<span class="token punctuation">,</span><span class="token class-name">String</span> colFamily<span class="token punctuation">,</span> <span class="token class-name">String</span> col<span class="token punctuation">)</span><span class="token keyword">throws</span>  <span class="token class-name">IOException</span><span class="token punctuation">{<!-- --></span> 
        <span class="token class-name">Table</span> table <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">getTable</span><span class="token punctuation">(</span><span class="token class-name">TableName</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Get</span> get <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Get</span><span class="token punctuation">(</span>rowKey<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        get<span class="token punctuation">.</span><span class="token function">addColumn</span><span class="token punctuation">(</span>colFamily<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>col<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Result</span> result <span class="token operator">=</span> table<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>get<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span>colFamily<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>col<span class="token operator">==</span><span class="token keyword">null</span><span class="token operator">?</span><span class="token keyword">null</span><span class="token operator">:</span>col<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        table<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p><u>在开始运行ExampleForHBase.java程序之前，需要启动HDFS和HBase。</u></p> 
<p><em>代码运行结果如图所示：</em><br> <img src="https://images2.imgbox.com/50/28/Dv06lScd_o.png" alt="在这里插入图片描述"></p> 
<p><em>在shell中检验上述代码是否真的运行成功如图所示：</em><br> <img src="https://images2.imgbox.com/ed/d5/uwyytjp9_o.png" alt="在这里插入图片描述"></p> 
<p>**五、**完成情况与问题讨论</p> 
<p>（1） 实际完成情况</p> 
<p>​ a) 完成HBase全分布搭建</p> 
<p>​ b) 完成hbase的shell部分命令</p> 
<p>​ c) HBase的Java API操作</p> 
<p>（2） 问题与讨论</p> 
<p>​ 问题一：出现HBase启动一段时间后，HMaster消失的现象？</p> 
<p>​ 解决：在hbase的conf文件中修改hbase-site.xml文件，加入如下一句话：</p> 
<pre><code class="prism language-visual">&lt;property&gt;
    &lt;name&gt;hbase.unsafe.stream.capability.enforce&lt;/name&gt;
    &lt;value&gt;false&lt;/value&gt;
&lt;/property&gt;
</code></pre> 
<p>​ 问题二：对于全分布与伪分布的了解不是特别详细，使得对于在配置文件，默认加载src下的配置文件总是配置不对？</p> 
<p>​ 解决：</p> 
<pre><code class="prism language-java"><span class="token comment">//全分布</span>
configuration  <span class="token operator">=</span> <span class="token class-name">HBaseConfiguration</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
configuration<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"hbase.rootdir"</span><span class="token punctuation">,</span><span class="token string">"hdfs://192.168.43.49:9000/hbase"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//192.168.43.49是全分布namenode的ip地址</span>
<span class="token comment">/***********************/</span>
<span class="token comment">//伪分布</span>
configuration  <span class="token operator">=</span> <span class="token class-name">HBaseConfiguration</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
configuration<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"hbase.rootdir"</span><span class="token punctuation">,</span><span class="token string">"hdfs://localhost:9000/hbase"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>.unsafe.stream.capability.enforce<br> false<br> </p> 
<pre><code>
​		问题二：对于全分布与伪分布的了解不是特别详细，使得对于在配置文件，默认加载src下的配置文件总是配置不对？

​		解决：

```java
//全分布
configuration  = HBaseConfiguration.create();
configuration.set("hbase.rootdir","hdfs://192.168.43.49:9000/hbase");
//192.168.43.49是全分布namenode的ip地址
/***********************/
//伪分布
configuration  = HBaseConfiguration.create();
configuration.set("hbase.rootdir","hdfs://localhost:9000/hbase");
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e4b896aed68dae86e41f24e32257afa4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Termux配置安卓编译环境</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/33ca77aa1ab8a7203674da82e10d6539/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">JavaScript中的变量监听：实时捕捉变化的利器</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>