<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于Python&#43;大数据的线上教育平台数据分析系统设计与实现 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/9d5f83660790e156ae063a249765b9f5/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="基于Python&#43;大数据的线上教育平台数据分析系统设计与实现">
  <meta property="og:description" content="💗博主介绍：✌全网粉丝10W&#43;,CSDN全栈领域优质创作者，博客之星、掘金/华为云/阿里云等平台优质作者。
👇🏻 精彩专栏 推荐订阅👇🏻
计算机毕业设计精品项目案例-200套
🌟文末获取源码&#43;数据库&#43;文档🌟
感兴趣的可以先收藏起来，还有大家在毕设选题，项目以及论文编写等相关问题都可以和学长沟通，希望帮助更多的人
一.前言 随着互联网技术的不断和快速发展，网络与大数据很早就成为了人们生活中的一部分，线上教育平台大数据分析由于其特有的便捷性，用户能够更加容易地接受。互联网有了这种便捷调剂信息(阅读量TOP10)、访问信息等分析形式，也是一种新型的全新应用形式[3]。从侧面来看，线上教育平台大数据分析还能够推进网上用户查看爬取下的大数据调剂信息的普及。
同传统的人工统计数据模式相比，线上教育平台大数据分析具有较多的优势。建立规范化的流程通常可以解决用户查询阅读量统计、发布时间统计、地区访问量统计、访问类型统计、调剂信息(阅读量TOP10）分析问题，而目前如果需要管理网站爬取下的大数据，管理员依然以人工的方式进行管理的话太过于落后。线上教育平台大数据分析处理数据越来越趋于信息化，这种模式需要依赖于智能化手段管理。随着科技发展的进步与大数据的普及，信息技术能够改善我们的生活，现在许多生活场景都需要信息化技术帮助改善我们的生活。
本课题就是以线上教育系统爬取为例，介绍网络爬虫的基本原理，Python环境的搭建，PyCharm scrapy模块的爬虫数据的运用，把获取到的数据进行清洗、整合，储存数据到MySQL，然后进行数据可视化的呈现，简单对呈现的图进行数据分析。
二.技术环境 开发语言：Python
python框架：django
软件版本：python3.7/python3.8
数据库：mysql 5.7或更高版本
数据库工具：Navicat11
爬虫框架：Scrapy
开发软件：PyCharm/vs code
前端框架:vue.js
三.功能设计 系统功能结构图是系统设计阶段，系统功能结构图只是这个阶段一个基础，整个系统的架构决定了系统的整体模式，是系统的根据。线上教育平台数据分析系统的整个设计结构如图所示。
四.数据设计 概念模型的设计是为了抽象真实世界的信息，并对信息世界进行建模。它是数据库设计的强大工具。数据库概念模型设计可以通过E-R图描述现实世界的概念模型。系统的E-R图显示了系统中实体之间的链接。而且Mysql数据库是自我保护能力比较强的数据库，下图主要是对数据库实体的E-R图：
五.部分效果展示 系统管理员功能实现效果 管理员要登录线上教育平台大数据分析，需要输入账号和密码，进行登录，管理员登录界面如图所示。
管理员登录进入线上教育平台大数据分析可以查看系统首页、个人中心、调剂信息管理、访问信息管理、访问类型管理、系统管理等功能，进行详细操作，如图所示。
管理员点击调剂信息管理；在调剂信息管理页面输入来源、学校名、标题、阅读量、发布时间、分类等信息，进行查询，爬起数据或删除调剂信息等操作；如图所示。
管理员点击访问信息管理；在访问信息管理页面输入访问编号、访问地区、访问量、访问类型、更新时间等信息，进行查询，新增、导入或删除访问信息等操作；如图所示。
管理员点击访问类型管理；在访问类型管理页面输入访问类型等信息，进行查询、新增或删除访问类型等操作；如图所示。
管理员点击系统管理；在系统管理页面对系统简介等信息，进行查询或修改系统信息等操作；如图所示。
数据可视化分析大屏展示实现效果 线上教育平台分析系统展示图，如图所示。
下面展示是阅读量统计，对于阅读量统计大数据，数据获取之后，开始对这些数据进行可视化分析，首先是阅读量统计的基本情况，其中根据爬取的数据以饼状图的形式来展示，如图所示。
下面展示是发布时间统计，对于发布时间统计大数据获取之后，开始对这些数据进行可视化分析，首先通过页面查看发布时间统计详情进行展示，如图所示。
在地区访问量统计页面以条形图进行展示所示。
下图是访问类型统计，通过python爬取清洗后的数据以饼状图形式展示如图所示：
下图是调剂信息(阅读量TOP10)，通过python爬取清洗后的数据以信息表形式展示如图所示：
六.部分功能代码 # 数据爬取文件 import scrapy import pymysql import pymssql from ..items import TiaojixinxiItem import time import re import random import platform import json import os from urllib.parse import urlparse import requests import emoji # 调剂信息 class TiaojixinxiSpider(scrapy.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-28T17:13:25+08:00">
    <meta property="article:modified_time" content="2024-01-28T17:13:25+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于Python&#43;大数据的线上教育平台数据分析系统设计与实现</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>💗博主介绍：✌全网粉丝10W+,CSDN全栈领域优质创作者，博客之星、掘金/华为云/阿里云等平台优质作者。<br> 👇🏻 精彩专栏 推荐订阅👇🏻<br> <a href="https://blog.csdn.net/qq_15801219/category_11466472.html">计算机毕业设计精品项目案例-200套</a><br> 🌟<strong>文末获取源码+数据库+文档</strong>🌟<br> 感兴趣的可以先收藏起来，还有大家在毕设选题，项目以及论文编写等相关问题都可以和学长沟通，希望帮助更多的人</p> 
</blockquote> 
<h3><a id="_5"></a>一.前言</h3> 
<p><img src="https://images2.imgbox.com/57/e2/TqpOyTn5_o.png" alt="在这里插入图片描述"></p> 
<p>随着互联网技术的不断和快速发展，网络与大数据很早就成为了人们生活中的一部分，线上教育平台大数据分析由于其特有的便捷性，用户能够更加容易地接受。互联网有了这种便捷调剂信息(阅读量TOP10)、访问信息等分析形式，也是一种新型的全新应用形式[3]。从侧面来看，线上教育平台大数据分析还能够推进网上用户查看爬取下的大数据调剂信息的普及。<br> 同传统的人工统计数据模式相比，线上教育平台大数据分析具有较多的优势。建立规范化的流程通常可以解决用户查询阅读量统计、发布时间统计、地区访问量统计、访问类型统计、调剂信息(阅读量TOP10）分析问题，而目前如果需要管理网站爬取下的大数据，管理员依然以人工的方式进行管理的话太过于落后。线上教育平台大数据分析处理数据越来越趋于信息化，这种模式需要依赖于智能化手段管理。随着科技发展的进步与大数据的普及，信息技术能够改善我们的生活，现在许多生活场景都需要信息化技术帮助改善我们的生活。<br> 本课题就是以线上教育系统爬取为例，介绍网络爬虫的基本原理，Python环境的搭建，PyCharm scrapy模块的爬虫数据的运用，把获取到的数据进行清洗、整合，储存数据到MySQL，然后进行数据可视化的呈现，简单对呈现的图进行数据分析。</p> 
<hr> 
<h3><a id="_13"></a>二.技术环境</h3> 
<p>开发语言：Python<br> python框架：django<br> 软件版本：python3.7/python3.8<br> 数据库：mysql 5.7或更高版本<br> 数据库工具：Navicat11<br> 爬虫框架：Scrapy<br> 开发软件：PyCharm/vs code<br> 前端框架:vue.js</p> 
<hr> 
<h3><a id="_25"></a>三.功能设计</h3> 
<p>系统功能结构图是系统设计阶段，系统功能结构图只是这个阶段一个基础，整个系统的架构决定了系统的整体模式，是系统的根据。线上教育平台数据分析系统的整个设计结构如图所示。<br> <img src="https://images2.imgbox.com/07/cc/E5kgegM2_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_31"></a>四.数据设计</h3> 
<p>概念模型的设计是为了抽象真实世界的信息，并对信息世界进行建模。它是数据库设计的强大工具。数据库概念模型设计可以通过E-R图描述现实世界的概念模型。系统的E-R图显示了系统中实体之间的链接。而且Mysql数据库是自我保护能力比较强的数据库，下图主要是对数据库实体的E-R图：<br> <img src="https://images2.imgbox.com/9e/37/XOF4YokM_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/0c/f0/RaMrVQoB_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_37"></a>五.部分效果展示</h3> 
<h4><a id="_39"></a>系统管理员功能实现效果</h4> 
<p>管理员要登录线上教育平台大数据分析，需要输入账号和密码，进行登录，管理员登录界面如图所示。</p> 
<p><img src="https://images2.imgbox.com/5c/f1/obfz9Ebm_o.png" alt="在这里插入图片描述"></p> 
<p>管理员登录进入线上教育平台大数据分析可以查看系统首页、个人中心、调剂信息管理、访问信息管理、访问类型管理、系统管理等功能，进行详细操作，如图所示。<br> <img src="https://images2.imgbox.com/72/d6/ttZCxjah_o.png" alt="在这里插入图片描述"></p> 
<p>管理员点击调剂信息管理；在调剂信息管理页面输入来源、学校名、标题、阅读量、发布时间、分类等信息，进行查询，爬起数据或删除调剂信息等操作；如图所示。</p> 
<p><img src="https://images2.imgbox.com/47/c5/9saXtrx2_o.png" alt="在这里插入图片描述"></p> 
<p>管理员点击访问信息管理；在访问信息管理页面输入访问编号、访问地区、访问量、访问类型、更新时间等信息，进行查询，新增、导入或删除访问信息等操作；如图所示。</p> 
<p><img src="https://images2.imgbox.com/8a/21/LMmbLrFF_o.png" alt="在这里插入图片描述"></p> 
<p>管理员点击访问类型管理；在访问类型管理页面输入访问类型等信息，进行查询、新增或删除访问类型等操作；如图所示。<br> <img src="https://images2.imgbox.com/f8/23/HmBMELtM_o.png" alt="在这里插入图片描述"></p> 
<p>管理员点击系统管理；在系统管理页面对系统简介等信息，进行查询或修改系统信息等操作；如图所示。<br> <img src="https://images2.imgbox.com/c2/0f/A2QcVAOa_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_66"></a>数据可视化分析大屏展示实现效果</h4> 
<p>线上教育平台分析系统展示图，如图所示。</p> 
<p><img src="https://images2.imgbox.com/b1/3c/saZPYCjD_o.png" alt="在这里插入图片描述"></p> 
<p>下面展示是阅读量统计，对于阅读量统计大数据，数据获取之后，开始对这些数据进行可视化分析，首先是阅读量统计的基本情况，其中根据爬取的数据以饼状图的形式来展示，如图所示。<br> <img src="https://images2.imgbox.com/78/0c/eFluQFqJ_o.png" alt="在这里插入图片描述"></p> 
<p>下面展示是发布时间统计，对于发布时间统计大数据获取之后，开始对这些数据进行可视化分析，首先通过页面查看发布时间统计详情进行展示，如图所示。<br> <img src="https://images2.imgbox.com/0f/bb/AoocuHJ6_o.png" alt="在这里插入图片描述"></p> 
<p>在地区访问量统计页面以条形图进行展示所示。</p> 
<p><img src="https://images2.imgbox.com/df/d3/lYylTuuT_o.png" alt="在这里插入图片描述"></p> 
<p>下图是访问类型统计，通过python爬取清洗后的数据以饼状图形式展示如图所示：<br> <img src="https://images2.imgbox.com/b8/4c/L4whGLQH_o.png" alt="在这里插入图片描述"></p> 
<p>下图是调剂信息(阅读量TOP10)，通过python爬取清洗后的数据以信息表形式展示如图所示：</p> 
<p><img src="https://images2.imgbox.com/48/b6/w6DWb1hs_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_94"></a>六.部分功能代码</h3> 
<pre><code class="prism language-python"><span class="token comment"># 数据爬取文件</span>

<span class="token keyword">import</span> scrapy
<span class="token keyword">import</span> pymysql
<span class="token keyword">import</span> pymssql
<span class="token keyword">from</span> <span class="token punctuation">.</span><span class="token punctuation">.</span>items <span class="token keyword">import</span> TiaojixinxiItem
<span class="token keyword">import</span> time
<span class="token keyword">import</span> re
<span class="token keyword">import</span> random
<span class="token keyword">import</span> platform
<span class="token keyword">import</span> json
<span class="token keyword">import</span> os
<span class="token keyword">from</span> urllib<span class="token punctuation">.</span>parse <span class="token keyword">import</span> urlparse
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> emoji

<span class="token comment"># 调剂信息</span>
<span class="token keyword">class</span> <span class="token class-name">TiaojixinxiSpider</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> <span class="token string">'tiaojixinxiSpider'</span>
    spiderUrl <span class="token operator">=</span> <span class="token string">'http://jixun.iqihang.com/schoolkytj/index.html'</span>
    start_urls <span class="token operator">=</span> spiderUrl<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">";"</span><span class="token punctuation">)</span>
    protocol <span class="token operator">=</span> <span class="token string">''</span>
    hostname <span class="token operator">=</span> <span class="token string">''</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">start_requests</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        plat <span class="token operator">=</span> platform<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> plat <span class="token operator">==</span> <span class="token string">'linux'</span> <span class="token keyword">or</span> plat <span class="token operator">==</span> <span class="token string">'windows'</span><span class="token punctuation">:</span>
            connect <span class="token operator">=</span> self<span class="token punctuation">.</span>db_connect<span class="token punctuation">(</span><span class="token punctuation">)</span>
            cursor <span class="token operator">=</span> connect<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> self<span class="token punctuation">.</span>table_exists<span class="token punctuation">(</span>cursor<span class="token punctuation">,</span> <span class="token string">'qh73g_tiaojixinxi'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                cursor<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
                connect<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
                self<span class="token punctuation">.</span>temp_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span>

        pageNum <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">for</span> url <span class="token keyword">in</span> self<span class="token punctuation">.</span>start_urls<span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token string">'{}'</span> <span class="token keyword">in</span> url<span class="token punctuation">:</span>
                <span class="token keyword">for</span> page <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> pageNum<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    next_link <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span>
                    <span class="token keyword">yield</span> scrapy<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>
                        url<span class="token operator">=</span>next_link<span class="token punctuation">,</span>
                        callback<span class="token operator">=</span>self<span class="token punctuation">.</span>parse
                    <span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">yield</span> scrapy<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>
                    url<span class="token operator">=</span>url<span class="token punctuation">,</span>
                    callback<span class="token operator">=</span>self<span class="token punctuation">.</span>parse
                <span class="token punctuation">)</span>

    <span class="token comment"># 列表解析</span>
    <span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>
        
        _url <span class="token operator">=</span> urlparse<span class="token punctuation">(</span>self<span class="token punctuation">.</span>spiderUrl<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>protocol <span class="token operator">=</span> _url<span class="token punctuation">.</span>scheme
        self<span class="token punctuation">.</span>hostname <span class="token operator">=</span> _url<span class="token punctuation">.</span>netloc
        plat <span class="token operator">=</span> platform<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> plat <span class="token operator">==</span> <span class="token string">'windows_bak'</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
        <span class="token keyword">elif</span> plat <span class="token operator">==</span> <span class="token string">'linux'</span> <span class="token keyword">or</span> plat <span class="token operator">==</span> <span class="token string">'windows'</span><span class="token punctuation">:</span>
            connect <span class="token operator">=</span> self<span class="token punctuation">.</span>db_connect<span class="token punctuation">(</span><span class="token punctuation">)</span>
            cursor <span class="token operator">=</span> connect<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> self<span class="token punctuation">.</span>table_exists<span class="token punctuation">(</span>cursor<span class="token punctuation">,</span> <span class="token string">'qh73g_tiaojixinxi'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                cursor<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
                connect<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
                self<span class="token punctuation">.</span>temp_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span>

        <span class="token builtin">list</span> <span class="token operator">=</span> response<span class="token punctuation">.</span>css<span class="token punctuation">(</span><span class="token string">'div.listLeft ul li'</span><span class="token punctuation">)</span>
        
        <span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token builtin">list</span><span class="token punctuation">:</span>

            fields <span class="token operator">=</span> TiaojixinxiItem<span class="token punctuation">(</span><span class="token punctuation">)</span>



            fields<span class="token punctuation">[</span><span class="token string">"laiyuan"</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>remove_html<span class="token punctuation">(</span>item<span class="token punctuation">.</span>css<span class="token punctuation">(</span><span class="token string">'a::attr(href)'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> fields<span class="token punctuation">[</span><span class="token string">"laiyuan"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'//'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                fields<span class="token punctuation">[</span><span class="token string">"laiyuan"</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>protocol <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> fields<span class="token punctuation">[</span><span class="token string">"laiyuan"</span><span class="token punctuation">]</span>
            <span class="token keyword">elif</span> fields<span class="token punctuation">[</span><span class="token string">"laiyuan"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                fields<span class="token punctuation">[</span><span class="token string">"laiyuan"</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>protocol <span class="token operator">+</span> <span class="token string">'://'</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>hostname <span class="token operator">+</span> fields<span class="token punctuation">[</span><span class="token string">"laiyuan"</span><span class="token punctuation">]</span>
            fields<span class="token punctuation">[</span><span class="token string">"xuexiaoming"</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>remove_html<span class="token punctuation">(</span>item<span class="token punctuation">.</span>css<span class="token punctuation">(</span><span class="token string">'a span::text'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            fields<span class="token punctuation">[</span><span class="token string">"biaoti"</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>remove_html<span class="token punctuation">(</span>item<span class="token punctuation">.</span>css<span class="token punctuation">(</span><span class="token string">'a span:nth-child(2)::text'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            fields<span class="token punctuation">[</span><span class="token string">"fabushijian"</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>remove_html<span class="token punctuation">(</span>item<span class="token punctuation">.</span>css<span class="token punctuation">(</span><span class="token string">'a span:nth-child(3)::text'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

            detailUrlRule <span class="token operator">=</span> item<span class="token punctuation">.</span>css<span class="token punctuation">(</span><span class="token string">'a::attr(href)'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> self<span class="token punctuation">.</span>protocol <span class="token keyword">in</span> detailUrlRule<span class="token punctuation">:</span>
                <span class="token keyword">pass</span>
            <span class="token keyword">elif</span> detailUrlRule<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'//'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                detailUrlRule <span class="token operator">=</span> self<span class="token punctuation">.</span>protocol <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> detailUrlRule
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                detailUrlRule <span class="token operator">=</span> self<span class="token punctuation">.</span>protocol <span class="token operator">+</span> <span class="token string">'://'</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>hostname <span class="token operator">+</span> detailUrlRule
                fields<span class="token punctuation">[</span><span class="token string">"laiyuan"</span><span class="token punctuation">]</span> <span class="token operator">=</span> detailUrlRule

            <span class="token keyword">yield</span> scrapy<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url<span class="token operator">=</span>detailUrlRule<span class="token punctuation">,</span> meta<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'fields'</span><span class="token punctuation">:</span> fields<span class="token punctuation">}</span><span class="token punctuation">,</span>  callback<span class="token operator">=</span>self<span class="token punctuation">.</span>detail_parse<span class="token punctuation">,</span> dont_filter<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>


    <span class="token comment"># 详情解析</span>
    <span class="token keyword">def</span> <span class="token function">detail_parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>
        fields <span class="token operator">=</span> response<span class="token punctuation">.</span>meta<span class="token punctuation">[</span><span class="token string">'fields'</span><span class="token punctuation">]</span>

        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token string">'(.*?)'</span> <span class="token keyword">in</span> <span class="token triple-quoted-string string">'''div[class="rt time"] p:nth-child(4)::text'''</span><span class="token punctuation">:</span>
                fields<span class="token punctuation">[</span><span class="token string">"yueduliang"</span><span class="token punctuation">]</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token triple-quoted-string string">r'''div[class="rt time"] p:nth-child(4)::text'''</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>text<span class="token punctuation">,</span> re<span class="token punctuation">.</span>S<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> <span class="token string">'yueduliang'</span> <span class="token operator">!=</span> <span class="token string">'xiangqing'</span> <span class="token keyword">and</span> <span class="token string">'yueduliang'</span> <span class="token operator">!=</span> <span class="token string">'detail'</span> <span class="token keyword">and</span> <span class="token string">'yueduliang'</span> <span class="token operator">!=</span> <span class="token string">'pinglun'</span> <span class="token keyword">and</span> <span class="token string">'yueduliang'</span> <span class="token operator">!=</span> <span class="token string">'zuofa'</span><span class="token punctuation">:</span>
                    fields<span class="token punctuation">[</span><span class="token string">"yueduliang"</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>remove_html<span class="token punctuation">(</span>response<span class="token punctuation">.</span>css<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''div[class="rt time"] p:nth-child(4)::text'''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    fields<span class="token punctuation">[</span><span class="token string">"yueduliang"</span><span class="token punctuation">]</span> <span class="token operator">=</span> emoji<span class="token punctuation">.</span>demojize<span class="token punctuation">(</span>response<span class="token punctuation">.</span>css<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''div[class="rt time"] p:nth-child(4)::text'''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>


        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token string">'(.*?)'</span> <span class="token keyword">in</span> <span class="token triple-quoted-string string">'''div[class="lt time"] p:nth-child(2)::text'''</span><span class="token punctuation">:</span>
                fields<span class="token punctuation">[</span><span class="token string">"fenlei"</span><span class="token punctuation">]</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token triple-quoted-string string">r'''div[class="lt time"] p:nth-child(2)::text'''</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>text<span class="token punctuation">,</span> re<span class="token punctuation">.</span>S<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> <span class="token string">'fenlei'</span> <span class="token operator">!=</span> <span class="token string">'xiangqing'</span> <span class="token keyword">and</span> <span class="token string">'fenlei'</span> <span class="token operator">!=</span> <span class="token string">'detail'</span> <span class="token keyword">and</span> <span class="token string">'fenlei'</span> <span class="token operator">!=</span> <span class="token string">'pinglun'</span> <span class="token keyword">and</span> <span class="token string">'fenlei'</span> <span class="token operator">!=</span> <span class="token string">'zuofa'</span><span class="token punctuation">:</span>
                    fields<span class="token punctuation">[</span><span class="token string">"fenlei"</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>remove_html<span class="token punctuation">(</span>response<span class="token punctuation">.</span>css<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''div[class="lt time"] p:nth-child(2)::text'''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    fields<span class="token punctuation">[</span><span class="token string">"fenlei"</span><span class="token punctuation">]</span> <span class="token operator">=</span> emoji<span class="token punctuation">.</span>demojize<span class="token punctuation">(</span>response<span class="token punctuation">.</span>css<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''div[class="lt time"] p:nth-child(2)::text'''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>


        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token string">'(.*?)'</span> <span class="token keyword">in</span> <span class="token triple-quoted-string string">'''div.art_content'''</span><span class="token punctuation">:</span>
                fields<span class="token punctuation">[</span><span class="token string">"detail"</span><span class="token punctuation">]</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token triple-quoted-string string">r'''div.art_content'''</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>text<span class="token punctuation">,</span> re<span class="token punctuation">.</span>S<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> <span class="token string">'detail'</span> <span class="token operator">!=</span> <span class="token string">'xiangqing'</span> <span class="token keyword">and</span> <span class="token string">'detail'</span> <span class="token operator">!=</span> <span class="token string">'detail'</span> <span class="token keyword">and</span> <span class="token string">'detail'</span> <span class="token operator">!=</span> <span class="token string">'pinglun'</span> <span class="token keyword">and</span> <span class="token string">'detail'</span> <span class="token operator">!=</span> <span class="token string">'zuofa'</span><span class="token punctuation">:</span>
                    fields<span class="token punctuation">[</span><span class="token string">"detail"</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>remove_html<span class="token punctuation">(</span>response<span class="token punctuation">.</span>css<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''div.art_content'''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    fields<span class="token punctuation">[</span><span class="token string">"detail"</span><span class="token punctuation">]</span> <span class="token operator">=</span> emoji<span class="token punctuation">.</span>demojize<span class="token punctuation">(</span>response<span class="token punctuation">.</span>css<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''div.art_content'''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>




        <span class="token keyword">return</span> fields

    <span class="token comment"># 去除多余html标签</span>
    <span class="token keyword">def</span> <span class="token function">remove_html</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> html<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> html <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token string">''</span>
        pattern <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">r'&lt;[^&gt;]+&gt;'</span><span class="token punctuation">,</span> re<span class="token punctuation">.</span>S<span class="token punctuation">)</span>
        <span class="token keyword">return</span> pattern<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> html<span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 数据库连接</span>
    <span class="token keyword">def</span> <span class="token function">db_connect</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">type</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'TYPE'</span><span class="token punctuation">,</span> <span class="token string">'mysql'</span><span class="token punctuation">)</span>
        host <span class="token operator">=</span> self<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'HOST'</span><span class="token punctuation">,</span> <span class="token string">'localhost'</span><span class="token punctuation">)</span>
        port <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'PORT'</span><span class="token punctuation">,</span> <span class="token number">3306</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        user <span class="token operator">=</span> self<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'USER'</span><span class="token punctuation">,</span> <span class="token string">'root'</span><span class="token punctuation">)</span>
        password <span class="token operator">=</span> self<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'PASSWORD'</span><span class="token punctuation">,</span> <span class="token string">'123456'</span><span class="token punctuation">)</span>

        <span class="token keyword">try</span><span class="token punctuation">:</span>
            database <span class="token operator">=</span> self<span class="token punctuation">.</span>databaseName
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            database <span class="token operator">=</span> self<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'DATABASE'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> <span class="token builtin">type</span> <span class="token operator">==</span> <span class="token string">'mysql'</span><span class="token punctuation">:</span>
            connect <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>host<span class="token operator">=</span>host<span class="token punctuation">,</span> port<span class="token operator">=</span>port<span class="token punctuation">,</span> db<span class="token operator">=</span>database<span class="token punctuation">,</span> user<span class="token operator">=</span>user<span class="token punctuation">,</span> passwd<span class="token operator">=</span>password<span class="token punctuation">,</span> charset<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            connect <span class="token operator">=</span> pymssql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>host<span class="token operator">=</span>host<span class="token punctuation">,</span> user<span class="token operator">=</span>user<span class="token punctuation">,</span> password<span class="token operator">=</span>password<span class="token punctuation">,</span> database<span class="token operator">=</span>database<span class="token punctuation">)</span>

        <span class="token keyword">return</span> connect

    <span class="token comment"># 断表是否存在</span>
    <span class="token keyword">def</span> <span class="token function">table_exists</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> cursor<span class="token punctuation">,</span> table_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">"show tables;"</span><span class="token punctuation">)</span>
        tables <span class="token operator">=</span> <span class="token punctuation">[</span>cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        table_list <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'(\'.*?\')'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>tables<span class="token punctuation">)</span><span class="token punctuation">)</span>
        table_list <span class="token operator">=</span> <span class="token punctuation">[</span>re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">"'"</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span>each<span class="token punctuation">)</span> <span class="token keyword">for</span> each <span class="token keyword">in</span> table_list<span class="token punctuation">]</span>

        <span class="token keyword">if</span> table_name <span class="token keyword">in</span> table_list<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token number">0</span>

    <span class="token comment"># 数据缓存源</span>
    <span class="token keyword">def</span> <span class="token function">temp_data</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        connect <span class="token operator">=</span> self<span class="token punctuation">.</span>db_connect<span class="token punctuation">(</span><span class="token punctuation">)</span>
        cursor <span class="token operator">=</span> connect<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        sql <span class="token operator">=</span> <span class="token triple-quoted-string string">'''
            insert into tiaojixinxi(
                laiyuan
                ,xuexiaoming
                ,biaoti
                ,fabushijian
                ,yueduliang
                ,fenlei
                ,detail
            )
            select
                laiyuan
                ,xuexiaoming
                ,biaoti
                ,fabushijian
                ,yueduliang
                ,fenlei
                ,detail
            from qh73g_tiaojixinxi
            where(not exists (select
                laiyuan
                ,xuexiaoming
                ,biaoti
                ,fabushijian
                ,yueduliang
                ,fenlei
                ,detail
            from tiaojixinxi where
             tiaojixinxi.laiyuan=qh73g_tiaojixinxi.laiyuan
            and tiaojixinxi.xuexiaoming=qh73g_tiaojixinxi.xuexiaoming
            and tiaojixinxi.biaoti=qh73g_tiaojixinxi.biaoti
            and tiaojixinxi.fabushijian=qh73g_tiaojixinxi.fabushijian
            and tiaojixinxi.yueduliang=qh73g_tiaojixinxi.yueduliang
            and tiaojixinxi.fenlei=qh73g_tiaojixinxi.fenlei
            and tiaojixinxi.detail=qh73g_tiaojixinxi.detail
            ))
            limit {0}
        '''</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
        connect<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

        connect<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>


</code></pre> 
<h3><a id="_333"></a>最后</h3> 
<p><a href="https://yidianbishe.blog.csdn.net/article/details/131622291" rel="nofollow">最新计算机毕业设计选题篇-选题推荐（值得收藏）</a><br> <a href="https://blog.csdn.net/qq_15801219/category_11466472.html">计算机毕业设计精品项目案例-200套（值得订阅）</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1123dd18557b111404da60c560e1a024/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Python中bs4的soup.find()和soup.find_all()用法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2a590be10b858c2c6a82bc82fd2fcff4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">数学建模入门笔记(2) 聚类分析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>