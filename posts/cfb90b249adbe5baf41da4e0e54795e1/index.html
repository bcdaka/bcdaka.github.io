<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>深入探索【Hadoop】生态系统：Hive、Pig、HBase及更多关键组件（上） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/cfb90b249adbe5baf41da4e0e54795e1/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="深入探索【Hadoop】生态系统：Hive、Pig、HBase及更多关键组件（上）">
  <meta property="og:description" content="🐇明明跟你说过：个人主页
🏅个人专栏：《大数据前沿：技术与应用并进》🏅
🔖行路有良友，便是天堂🔖
目录
一、引言
1、Hadoop简介
2、Hadoop生态系统的构成概览 3、Hadoop在大数据处理中的应用价值
二、Hive：SQL on Hadoop
1、Hive简介
2、Hive架构
1. Metastore
2. Driver
3. Compiler
4. Executor
3、HiveQL语言基础
4、Hive应用场景
三、Pig：数据流的脚本语言
1、Pig概述：设计哲学与优势
2、Pig 的核心组件
3、Pig 的执行流程
4、Pig与Hive的对比
一、引言 1、Hadoop简介 Hadoop 是一个由 Apache 软件基金会开发的开源软件框架，用于分布式存储和处理大规模数据集。它的设计目的是在计算机集群上运行，并能够有效地处理数以千计的节点上的海量数据。Hadoop 主要用于处理大数据，并且能够处理结构化、半结构化和非结构化的数据。
Hadoop 的核心组件包括：
Hadoop Distributed File System (HDFS): 这是 Hadoop 的分布式文件系统，负责将数据分块并分布在集群中的多个节点上，以实现高容错性和高吞吐量的数据存储和访问。MapReduce: 这是一种编程模型和处理引擎，允许开发人员编写程序来并行处理大型数据集。MapReduce 将任务分解为两个阶段：“Map” 阶段负责将数据进行分块处理，“Reduce” 阶段负责将处理结果进行汇总。YARN (Yet Another Resource Negotiator): YARN 是 Hadoop 的资源管理器，负责管理集群资源，并将这些资源分配给运行在集群上的各种应用程序。Hadoop Common: 这是 Hadoop 框架的基础部分，提供了支持其他 Hadoop 模块的必要库和工具。 2、Hadoop生态系统的构成概览 HBase: 分布式的、面向列的 NoSQL 数据库，运行在 HDFS 之上，适用于处理大规模结构化和半结构化数据。Hive: 数据仓库基础设施，用于将结构化数据文件映射为数据库表，并使用类似 SQL 的查询语言（HiveQL）进行查询和分析。Pig: 数据流语言和执行环境，适合处理和分析大型数据集，Pig Latin 是其特有的编程语言。Spark: 分布式数据处理引擎，支持内存中计算，适用于批处理、流处理和机器学习等多种场景。Flink: 流处理框架，提供高吞吐量和低延迟的数据流处理能力。Storm: 实时数据处理框架，适合处理不断产生的大数据流。Zookeeper: 分布式协调服务，提供高可靠性的分布式应用协调服务，如同步、配置管理和命名服务。Kafka: 分布式消息系统，适合处理实时数据流，常用于构建实时流处理管道。 3、Hadoop在大数据处理中的应用价值 1.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-23T07:30:00+08:00">
    <meta property="article:modified_time" content="2024-08-23T07:30:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">深入探索【Hadoop】生态系统：Hive、Pig、HBase及更多关键组件（上）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p class="img-center" style="margin-left:0;text-align:center;"><img alt="" height="1080" src="https://images2.imgbox.com/d4/a9/uWfCZjlK_o.jpg" width="1200"></p> 
<p style="text-align:center;">🐇明明跟你说过：<a href="https://blog.csdn.net/weixin_53269650?spm=1011.2415.3001.5343" title="个人主页">个人主页</a></p> 
<p style="text-align:center;">🏅个人专栏：<a href="https://blog.csdn.net/weixin_53269650/category_12756249.html" title="《大数据前沿：技术与应用并进》">《大数据前沿：技术与应用并进》</a>🏅</p> 
<p style="text-align:center;">🔖行路有良友，便是天堂🔖</p> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%B8%80%E3%80%81%E5%BC%95%E8%A8%80-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E5%BC%95%E8%A8%80" rel="nofollow">一、引言</a></p> 
<p id="1%E3%80%81Hadoop%E7%AE%80%E4%BB%8B-toc" style="margin-left:40px;"><a href="#1%E3%80%81Hadoop%E7%AE%80%E4%BB%8B" rel="nofollow">1、Hadoop简介</a></p> 
<p id="2%E3%80%81Hadoop%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%9E%84%E6%88%90%E6%A6%82%E8%A7%88%C2%A0-toc" style="margin-left:40px;"><a href="#2%E3%80%81Hadoop%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%9E%84%E6%88%90%E6%A6%82%E8%A7%88%C2%A0" rel="nofollow">2、Hadoop生态系统的构成概览 </a></p> 
<p id="3%E3%80%81Hadoop%E5%9C%A8%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8%E4%BB%B7%E5%80%BC-toc" style="margin-left:40px;"><a href="#3%E3%80%81Hadoop%E5%9C%A8%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8%E4%BB%B7%E5%80%BC" rel="nofollow">3、Hadoop在大数据处理中的应用价值</a></p> 
<p id="%E4%BA%8C%E3%80%81Hive%EF%BC%9ASQL%20on%20Hadoop-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81Hive%EF%BC%9ASQL%20on%20Hadoop" rel="nofollow">二、Hive：SQL on Hadoop</a></p> 
<p id="1%E3%80%81Hive%E7%AE%80%E4%BB%8B-toc" style="margin-left:40px;"><a href="#1%E3%80%81Hive%E7%AE%80%E4%BB%8B" rel="nofollow">1、Hive简介</a></p> 
<p id="2%E3%80%81Hive%E6%9E%B6%E6%9E%84-toc" style="margin-left:40px;"><a href="#2%E3%80%81Hive%E6%9E%B6%E6%9E%84" rel="nofollow">2、Hive架构</a></p> 
<p id="1.%20Metastore-toc" style="margin-left:80px;"><a href="#1.%20Metastore" rel="nofollow">1. Metastore</a></p> 
<p id="2.%20Driver-toc" style="margin-left:80px;"><a href="#2.%20Driver" rel="nofollow">2. Driver</a></p> 
<p id="3.%20Compiler-toc" style="margin-left:80px;"><a href="#3.%20Compiler" rel="nofollow">3. Compiler</a></p> 
<p id="4.%20Executor-toc" style="margin-left:80px;"><a href="#4.%20Executor" rel="nofollow">4. Executor</a></p> 
<p id="3%E3%80%81HiveQL%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80-toc" style="margin-left:40px;"><a href="#3%E3%80%81HiveQL%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80" rel="nofollow">3、HiveQL语言基础</a></p> 
<p id="4%E3%80%81Hive%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-toc" style="margin-left:40px;"><a href="#4%E3%80%81Hive%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF" rel="nofollow">4、Hive应用场景</a></p> 
<p id="%E4%B8%89%E3%80%81Pig%EF%BC%9A%E6%95%B0%E6%8D%AE%E6%B5%81%E7%9A%84%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80-toc" style="margin-left:0px;"><a href="#%E4%B8%89%E3%80%81Pig%EF%BC%9A%E6%95%B0%E6%8D%AE%E6%B5%81%E7%9A%84%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80" rel="nofollow">三、Pig：数据流的脚本语言</a></p> 
<p id="1%E3%80%81Pig%E6%A6%82%E8%BF%B0%EF%BC%9A%E8%AE%BE%E8%AE%A1%E5%93%B2%E5%AD%A6%E4%B8%8E%E4%BC%98%E5%8A%BF-toc" style="margin-left:40px;"><a href="#1%E3%80%81Pig%E6%A6%82%E8%BF%B0%EF%BC%9A%E8%AE%BE%E8%AE%A1%E5%93%B2%E5%AD%A6%E4%B8%8E%E4%BC%98%E5%8A%BF" rel="nofollow">1、Pig概述：设计哲学与优势</a></p> 
<p id="2%E3%80%81Pig%20%E7%9A%84%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6-toc" style="margin-left:40px;"><a href="#2%E3%80%81Pig%20%E7%9A%84%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6" rel="nofollow">2、Pig 的核心组件</a></p> 
<p id="3%E3%80%81Pig%20%E7%9A%84%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B-toc" style="margin-left:40px;"><a href="#3%E3%80%81Pig%20%E7%9A%84%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B" rel="nofollow">3、Pig 的执行流程</a></p> 
<p id="4%E3%80%81Pig%E4%B8%8EHive%E7%9A%84%E5%AF%B9%E6%AF%94-toc" style="margin-left:40px;"><a href="#4%E3%80%81Pig%E4%B8%8EHive%E7%9A%84%E5%AF%B9%E6%AF%94" rel="nofollow">4、Pig与Hive的对比</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="%E4%B8%80%E3%80%81%E5%BC%95%E8%A8%80">一、引言</h2> 
<h3 id="1%E3%80%81Hadoop%E7%AE%80%E4%BB%8B">1、Hadoop简介</h3> 
<blockquote> 
 <p><span style="color:#fe2c24;">Hadoop </span>是一个由 Apache 软件基金会开发的开源软件框架，用于分布式存储和处理大规模数据集。它的设计目的是在计算机集群上运行，并能够有效地处理数以千计的节点上的海量数据。Hadoop 主要用于处理大数据，并且能够处理结构化、半结构化和非结构化的数据。</p> 
</blockquote> 
<p><span style="background-color:#c7e6ea;">Hadoop 的核心组件包括：</span></p> 
<ol><li><strong>Hadoop Distributed File System (HDFS): </strong>这是 Hadoop 的分布式文件系统，负责将数据分块并分布在集群中的多个节点上，以实现高容错性和高吞吐量的数据存储和访问。</li><li><strong>MapReduce: </strong>这是一种编程模型和处理引擎，允许开发人员编写程序来并行处理大型数据集。MapReduce 将任务分解为两个阶段：“Map” 阶段负责将数据进行分块处理，“Reduce” 阶段负责将处理结果进行汇总。</li><li><strong>YARN (Yet Another Resource Negotiator):</strong> YARN 是 Hadoop 的资源管理器，负责管理集群资源，并将这些资源分配给运行在集群上的各种应用程序。</li><li><strong>Hadoop Common: </strong>这是 Hadoop 框架的基础部分，提供了支持其他 Hadoop 模块的必要库和工具。</li></ol> 
<p class="img-center"><img alt="" height="536" src="https://images2.imgbox.com/f1/77/XXmduotV_o.png" width="979"></p> 
<h3 id="2%E3%80%81Hadoop%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%9E%84%E6%88%90%E6%A6%82%E8%A7%88%C2%A0">2、Hadoop生态系统的构成概览 </h3> 
<ol><li><strong>HBase: </strong>分布式的、面向列的 NoSQL 数据库，运行在 HDFS 之上，适用于处理大规模结构化和半结构化数据。</li><li><strong>Hive: </strong>数据仓库基础设施，用于将结构化数据文件映射为数据库表，并使用类似 SQL 的查询语言（HiveQL）进行查询和分析。</li><li><strong>Pig: </strong>数据流语言和执行环境，适合处理和分析大型数据集，Pig Latin 是其特有的编程语言。</li><li><strong>Spark: </strong>分布式数据处理引擎，支持内存中计算，适用于批处理、流处理和机器学习等多种场景。</li><li><strong>Flink: </strong>流处理框架，提供高吞吐量和低延迟的数据流处理能力。</li><li><strong>Storm: </strong>实时数据处理框架，适合处理不断产生的大数据流。</li><li><strong>Zookeeper: </strong>分布式协调服务，提供高可靠性的分布式应用协调服务，如同步、配置管理和命名服务。</li><li><strong>Kafka: </strong>分布式消息系统，适合处理实时数据流，常用于构建实时流处理管道。</li></ol> 
<p></p> 
<p class="img-center"><img alt="" height="638" src="https://images2.imgbox.com/2c/2d/1uRvV2ja_o.png" width="1200"></p> 
<h3 id="3%E3%80%81Hadoop%E5%9C%A8%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8%E4%BB%B7%E5%80%BC">3、Hadoop在大数据处理中的应用价值</h3> 
<p><span style="background-color:#ffd7b9;">1. 处理大规模数据的能力</span></p> 
<ul><li>Hadoop 的分布式架构使其能够处理和存储大规模数据集，支持数百 TB 甚至 PB 级的数据。其核心组件 HDFS 和 MapReduce 可以在大规模集群上高效分布式存储和处理数据，突破了传统单机系统在数据存储和处理能力上的瓶颈。</li></ul> 
<p><span style="background-color:#ffd7b9;">2. 高容错性和可扩展性</span></p> 
<ul><li>Hadoop 的 HDFS 通过数据块的冗余复制机制保证了数据的高可用性和容错性。当集群中的某个节点发生故障时，Hadoop 可以自动将任务转移到其他节点继续执行，确保数据不丢失。此外，Hadoop 的架构使得集群能够根据需求灵活扩展，通过添加更多的节点来提升计算和存储能力。</li></ul> 
<p><span style="background-color:#ffd7b9;">3. 成本效益</span></p> 
<ul><li>Hadoop 可以运行在廉价的商用硬件上，通过横向扩展来处理大数据集。与传统的大型机或高端服务器系统相比，Hadoop 显著降低了大数据处理的基础设施成本。此外，它是一个开源框架，企业可以自由使用和定制，大大减少了软件许可费用。</li></ul> 
<p class="img-center"><img alt="" height="482" src="https://images2.imgbox.com/ad/ed/cmBYVQdK_o.png" width="1029"></p> 
<p><span style="background-color:#fbd4d0;">4. 多种数据格式与源的支持</span></p> 
<ul><li>Hadoop 能够处理多种格式的数据，包括结构化、半结构化和非结构化数据，如文本、图像、视频、JSON、XML 等。这使得 Hadoop 能够从各种数据源中提取和处理数据，如日志文件、社交媒体数据、传感器数据和数据库记录，满足多样化的数据处理需求。</li></ul> 
<p><span style="background-color:#fbd4d0;">5. 生态系统的强大支持</span></p> 
<ul><li>Hadoop 生态系统中包含了丰富的工具和组件，支持数据存储、处理、分析、集成、安全等各个方面的需求。例如，使用 Hive 可以方便地对大数据进行 SQL 查询，使用 Spark 可以实现快速的数据处理和流处理，使用 HBase 可以处理海量的结构化数据，使用 Kafka 可以实现实时数据流的处理。这些工具和 Hadoop 的核心组件紧密集成，形成了一个强大的大数据处理平台。</li></ul> 
<p><span style="background-color:#fbd4d0;">6. 批处理和实时处理能力</span></p> 
<ul><li>通过 Hadoop 的 MapReduce 框架，用户可以实现复杂的数据批处理任务，适合处理大规模的历史数据。同时，通过 Spark、Storm、Flink 等工具，Hadoop 生态系统也支持实时数据流处理，能够应对实时分析、监控、推荐系统等场景。</li></ul> 
<p></p> 
<p class="img-center"><img alt="" height="693" src="https://images2.imgbox.com/0d/31/0yvfc36e_o.png" width="1200"></p> 
<h2 id="%E4%BA%8C%E3%80%81Hive%EF%BC%9ASQL%20on%20Hadoop">二、Hive：SQL on Hadoop</h2> 
<h3 id="1%E3%80%81Hive%E7%AE%80%E4%BB%8B">1、Hive简介</h3> 
<blockquote> 
 <p><span style="color:#fe2c24;">Hive </span>是一个基于 Hadoop 的数据仓库工具，主要用于处理和查询存储在 Hadoop 分布式文件系统 (HDFS) 中的大规模数据集。它提供了一个类似于 SQL 的查询语言，称为 HiveQL，使得用户可以通过简单的 SQL 查询语句来分析和处理大数据，而不需要编写复杂的 MapReduce 代码。</p> 
</blockquote> 
<p><strong>Hive 的主要特点：</strong></p> 
<p><span style="background-color:#f9eda6;">1. SQL 风格的查询语言 (HiveQL)</span></p> 
<ul><li>Hive 提供了 HiveQL，类似于 SQL 的查询语言，使得熟悉 SQL 的用户能够轻松上手，对存储在 HDFS 中的数据进行查询、分析和处理。</li></ul> 
<p><span style="background-color:#f9eda6;">2. 面向批处理的查询</span></p> 
<ul><li>Hive 主要用于大规模数据的批处理任务，它将 HiveQL 查询转换为 MapReduce 作业在 Hadoop 集群上执行，因此适合处理海量数据集的离线分析任务。</li></ul> 
<p><span style="background-color:#f9eda6;">3. 与 Hadoop 的深度集成</span></p> 
<ul><li>Hive 构建在 Hadoop 之上，利用 HDFS 进行数据存储，利用 MapReduce 执行查询。它能够无缝地与 Hadoop 生态系统中的其他组件集成，如 HBase、Pig、Spark 等。</li></ul> 
<p><span style="background-color:#f9eda6;">4. 可扩展性和容错性</span></p> 
<ul><li>由于 Hive 依赖于 Hadoop，其查询执行具有良好的可扩展性和容错性。可以处理从 GB 到 PB 级别的数据，支持在大型集群上运行。</li></ul> 
<p class="img-center"><img alt="" height="553" src="https://images2.imgbox.com/af/ab/hhpC9LKX_o.png" width="1117"></p> 
<h3 id="2%E3%80%81Hive%E6%9E%B6%E6%9E%84">2、Hive架构</h3> 
<blockquote> 
 <p><span style="color:#fe2c24;">Hive</span> 的架构设计由多个核心组件组成，每个组件在数据处理流程中扮演不同的角色。主要的组件包括 Metastore、Driver、Compiler、Executor、CLI/UI、以及各类连接器。</p> 
</blockquote> 
<h4 id="1.%20Metastore"><strong>1. Metastore</strong></h4> 
<p>Metastore 是 Hive 的元数据存储系统，它存储了关于 Hive 表、数据库、分区、列、索引等结构化数据的元数据信息。Metastore 使用 RDBMS（如 MySQL、PostgreSQL）来存储元数据，并通过 Thrift 服务向 Hive 提供元数据访问。</p> 
<p><span style="background-color:#d4e9d5;">元数据管理：</span></p> 
<ul><li>Metastore 管理着 Hive 表的所有元数据，包括表的模式、表所在的 HDFS 位置、分区信息、列的数据类型、表的存储格式等。</li></ul> 
<p><span style="background-color:#d4e9d5;">模式（Schema）信息：</span></p> 
<ul><li>Hive 的 Schema-on-Read 模式允许在查询数据时应用模式，Metastore 存储并维护这些模式信息。</li></ul> 
<p></p> 
<h4 id="2.%20Driver"><strong>2. Driver</strong></h4> 
<p>Driver 是 Hive 的核心控制器，负责管理整个查询的生命周期。它处理用户请求，管理查询的编译、优化、执行等过程。</p> 
<p><span style="background-color:#f9eda6;">查询编译：</span></p> 
<ul><li>Driver 解析用户的 HiveQL 查询，将其转换为抽象语法树（AST），并进一步生成逻辑执行计划。</li></ul> 
<p><span style="background-color:#f9eda6;">查询优化：</span></p> 
<ul><li>在生成执行计划后，Driver 会进行一系列的优化步骤，如谓词下推、列剪裁、join 优化等，以提升查询执行效率。</li></ul> 
<p><span style="background-color:#f9eda6;">查询执行：</span></p> 
<ul><li>优化后的执行计划会通过 Executor 提交给 Hadoop 集群执行，Driver 负责管理整个执行过程，直到任务完成并返回结果。</li></ul> 
<p class="img-center"><img alt="" height="788" src="https://images2.imgbox.com/0b/53/GEbNu1ek_o.png" width="1200"></p> 
<h4 id="3.%20Compiler"><br> 3. Compiler</h4> 
<p>Compiler 是将 HiveQL 查询转换为可执行代码的组件。它从 Driver 接收到的语法树开始，生成逻辑执行计划并进一步优化。</p> 
<p><span style="background-color:#ffd7b9;">逻辑计划生成：</span></p> 
<ul><li>Compiler 负责将查询语句转换为逻辑执行计划，这个计划描述了查询的操作顺序和数据流。</li></ul> 
<p><br><span style="background-color:#ffd7b9;">物理计划生成：</span></p> 
<ul><li>Compiler 进一步将逻辑计划转换为物理执行计划，包含实际的 MapReduce、Tez 或 Spark 作业。</li></ul> 
<h4 id="4.%20Executor"><br> 4. Executor</h4> 
<p>Executor 是负责执行物理计划的组件。它将编译器生成的物理计划提交到 Hadoop 集群，并监控任务的执行。</p> 
<p><span style="background-color:#dad5e9;">任务提交：</span></p> 
<ul><li>Executor 将物理计划分解为一个或多个 MapReduce、Tez 或 Spark 任务，并将这些任务提交到 YARN 进行调度和执行。</li></ul> 
<p><span style="background-color:#dad5e9;">任务监控：</span></p> 
<ul><li>Executor 监控任务的运行状态，处理任务失败的重试和错误恢复，确保任务正确执行并最终返回结果。</li></ul> 
<p></p> 
<p class="img-center"><img alt="" height="676" src="https://images2.imgbox.com/a4/cb/NiOHyBC9_o.png" width="1105"></p> 
<p></p> 
<h3 id="3%E3%80%81HiveQL%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80">3、HiveQL语言基础</h3> 
<blockquote> 
 <p>HiveQL 的语法与 SQL 类似，支持常见的 SQL 操作，如 SELECT、INSERT、UPDATE、DELETE 等。它可以用于查询、插入数据、创建和管理表等。</p> 
</blockquote> 
<p><strong>SELECT 查询</strong></p> 
<pre><code>SELECT column1, column2
FROM table_name
WHERE condition
ORDER BY column1
LIMIT 10;</code></pre> 
<ul><li><strong>SELECT: </strong>用于从一个或多个表中提取数据。</li><li><strong>FROM:</strong> 指定要查询的表。</li><li><strong>WHERE:</strong> 过滤满足条件的数据。</li><li><strong>ORDER BY: </strong>对结果集进行排序。</li><li><strong>LIMIT: </strong>限制返回的记录数。</li></ul> 
<p><br><strong>创建表</strong></p> 
<pre><code>CREATE TABLE table_name (
  column1 STRING,
  column2 INT,
  column3 FLOAT
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS TEXTFILE;</code></pre> 
<ul><li><strong>CREATE TABLE: </strong>用于创建新的表。</li><li><strong>ROW FORMAT DELIMITED: </strong>指定数据的行格式和字段分隔符。</li><li><strong>STORED AS: </strong>定义数据的存储格式（如 TEXTFILE、ORC、PARQUET 等）。</li></ul> 
<p><br><strong>插入数据</strong></p> 
<pre><code>INSERT INTO TABLE table_name
VALUES ('value1', 123, 45.67);</code></pre> 
<ul><li><strong>INSERT INTO: </strong>向表中插入数据。</li><li><strong>VALUES: </strong>定义插入的数据值。</li></ul> 
<p><strong>分区表</strong></p> 
<pre><code>CREATE TABLE partitioned_table (
  column1 STRING,
  column2 INT
)
PARTITIONED BY (date STRING)
STORED AS TEXTFILE;

INSERT INTO TABLE partitioned_table PARTITION (date='2024-08-19')
VALUES ('value1', 123);</code></pre> 
<ul><li><strong>PARTITIONED BY: </strong>创建分区表，按照指定的列进行分区。</li><li><strong>INSERT INTO PARTITION: </strong>向指定分区插入数据。</li></ul> 
<p class="img-center"><img alt="" height="497" src="https://images2.imgbox.com/69/b7/8Z7u4JCM_o.png" width="753"></p> 
<h3 id="4%E3%80%81Hive%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF">4、Hive应用场景</h3> 
<blockquote> 
 <p>Hive 是一种基于 Hadoop 的数据仓库工具，主要用于在 HDFS 上处理和分析大规模数据集。其应用场景主要集中在数据仓库、数据分析和报表生成方面，以下是一些典型的应用场景：</p> 
</blockquote> 
<p><strong>1. 数据仓库</strong></p> 
<p>Hive 是为处理大规模数据的传统数据仓库需求而设计的。它为企业提供了将大数据存储在 Hadoop 集群中，并利用 SQL 语言（HiveQL）进行复杂查询和分析的能力。Hive 可以用于：</p> 
<ul><li><strong>ETL 过程：</strong>在将数据加载到 Hadoop 之前进行提取、转换和加载（Extract, Transform, Load）。</li><li><strong>数据聚合：</strong>在大数据集上运行聚合查询（如 SUM、COUNT、AVG）以生成报告或统计信息。</li><li><strong>数据存储和归档：</strong>将数据存储在 HDFS 中，并提供高效的数据检索能力。</li></ul> 
<p><br><strong>2. 数据分析</strong></p> 
<p>Hive 允许分析人员使用熟悉的 SQL 语言来查询和分析存储在 Hadoop 上的数据，支持快速编写和执行复杂的分析查询。适用于：</p> 
<ul><li><strong>行为分析：</strong>通过分析网站点击流数据、用户行为日志等，生成用户行为模式、热门内容等。</li><li><strong>业务报告生成：</strong>定期生成各种业务报告，如销售报告、财务报告等。</li></ul> 
<p></p> 
<p><strong>3. 日志分析</strong></p> 
<p>Hive 非常适合分析大规模的日志数据，如服务器日志、应用日志、网络流量日志等。可以在 Hive 中存储和查询这些日志，以识别系统性能问题、安全事件或用户行为模式。例如：</p> 
<ul><li><strong>Web 日志分析：</strong>分析 web 服务器日志以跟踪用户访问路径、频率、停留时间等。</li><li><strong>安全日志分析：</strong>分析防火墙、IDS/IPS 设备生成的安全日志，以检测潜在的威胁和异常行为。</li></ul> 
<p><br><strong>4. 数据挖掘</strong></p> 
<p>利用 Hive 进行数据挖掘任务，例如：</p> 
<ul><li><strong>客户细分：</strong>通过分析客户数据，识别不同类型的客户群体。</li><li><strong>推荐系统：</strong>分析用户行为数据，生成个性化推荐。</li></ul> 
<p class="img-center"><img alt="" height="660" src="https://images2.imgbox.com/84/56/ekiSlYQ5_o.png" width="1200"></p> 
<p></p> 
<p></p> 
<h2 id="%E4%B8%89%E3%80%81Pig%EF%BC%9A%E6%95%B0%E6%8D%AE%E6%B5%81%E7%9A%84%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80">三、<strong>Pig：数据流的脚本语言</strong></h2> 
<h3 id="1%E3%80%81Pig%E6%A6%82%E8%BF%B0%EF%BC%9A%E8%AE%BE%E8%AE%A1%E5%93%B2%E5%AD%A6%E4%B8%8E%E4%BC%98%E5%8A%BF">1、Pig概述：设计哲学与优势</h3> 
<blockquote> 
 <p><span style="color:#fe2c24;">Apache Pig </span>是一种高层次的数据流脚本语言和执行框架，主要用于处理大规模数据集。它最初由 Yahoo! 开发，后来成为 Apache 软件基金会的顶级项目。Pig 的核心组件包括 Pig Latin 脚本语言和 Pig 运行时环境。</p> 
</blockquote> 
<p><span style="background-color:#f9eda6;">Pig 的设计哲学</span></p> 
<ol><li>简化大数据处理: Pig 的主要设计目标是让开发者能够更简单、更快速地编写大数据处理任务，而不必深入了解底层复杂的分布式计算框架（如 Hadoop MapReduce）。Pig Latin 语言类似于 SQL，使得用户可以以声明性的方式指定数据处理逻辑，而无需编写复杂的代码。</li><li>灵活性: 虽然 Pig 提供了高层次的抽象，但它并不限制用户在必要时使用更低级别的编程模型。用户可以在 Pig 脚本中插入 UDF（用户自定义函数）来扩展其功能，从而实现复杂的操作。</li><li>可扩展性和可组合性: Pig 的架构设计使得它能够轻松地处理各种规模的数据集，从 GB 级到 PB 级的数据。Pig Latin 语言中的各类操作符（如过滤、分组、连接等）可以灵活组合，处理复杂的数据流任务。</li><li>与 Hadoop 紧密集成: Pig 运行时环境在底层将 Pig Latin 脚本编译为 Hadoop 的 MapReduce 作业。因此，Pig 可以在现有的 Hadoop 集群上运行，利用 Hadoop 的分布式存储和处理能力。</li></ol> 
<p class="img-center"><img alt="" height="617" src="https://images2.imgbox.com/15/d3/TORsh9fx_o.png" width="1098"></p> 
<p> </p> 
<p><span style="background-color:#f9eda6;">Pig 的优势</span></p> 
<ol><li><strong>简化编程: </strong>与传统的 MapReduce 编程相比，Pig Latin 大大简化了数据处理任务的编写，减少了代码量，提高了开发效率。开发者只需关注数据处理的逻辑，而无需关心底层的执行细节。</li><li><strong>易于学习:</strong> Pig Latin 语言设计类似于 SQL，使得熟悉 SQL 的用户可以快速上手。此外，Pig 提供了丰富的内置函数库，用于常见的数据处理任务。</li><li><strong>强大的数据处理能力: </strong>Pig 能够处理半结构化和非结构化的数据，这使得它非常适合处理像日志文件、社交媒体数据等非标准化的数据源。</li><li><strong>可扩展性: </strong>Pig 可以扩展为处理非常大的数据集，从而满足大规模数据分析的需求。它可以轻松地处理从数百 MB 到数 PB 的数据。</li><li><strong>灵活的执行模式: </strong>Pig 支持多种执行模式，包括本地模式和分布式模式。在开发和测试阶段，用户可以在本地模式下运行 Pig 脚本，而在生产环境中，脚本可以在 Hadoop 集群上以分布式方式执行。</li><li><strong>容错能力: </strong>Pig 依赖 Hadoop 的 MapReduce 引擎，因此继承了 Hadoop 的容错能力。在节点失败时，Pig 能够自动重新调度任务，从而保证作业的顺利完成。</li></ol> 
<p class="img-center"><img alt="" height="417" src="https://images2.imgbox.com/12/b7/Lc2PvIuH_o.png" width="861"></p> 
<h3 id="2%E3%80%81Pig%20%E7%9A%84%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6">2、Pig 的核心组件</h3> 
<p><span style="background-color:#ffd7b9;">Pig Latin 语言</span></p> 
<ul><li><strong>简介: </strong>Pig Latin 是 Pig 的脚本语言，专门用于描述数据流处理逻辑。它类似于 SQL，但具有更大的灵活性，可以处理结构化、半结构化和非结构化数据。Pig Latin 支持多种操作符，如过滤、分组、连接、排序等，用户可以通过编写 Pig Latin 脚本来定义数据的输入、处理和输出过程。</li><li><strong>数据模型: </strong>Pig 的数据模型由原子、元组、包、映射四种数据类型组成。Pig Latin 可以操作这些数据类型来实现复杂的数据处理任务。</li></ul> 
<p><br><span style="background-color:#ffd7b9;">Pig 编译器</span></p> 
<ul><li><strong>解析: </strong>当用户提交 Pig Latin 脚本时，Pig 编译器首先会解析脚本，检查语法错误，并生成抽象语法树（AST）。在这一步，编译器会确保脚本的语法正确，并且所有引用的变量和操作符都存在。</li><li><strong>逻辑计划生成: </strong>解析后的 AST 会被转化为一个逻辑计划，这个计划描述了数据处理的逻辑流程。逻辑计划是与具体执行环境无关的，它只描述了数据处理的操作序列，而不涉及具体的执行方式。</li><li><strong>物理计划生成: </strong>在生成逻辑计划后，编译器会进一步生成物理计划。物理计划指定了每个数据处理步骤的具体实现方式，如使用 MapReduce 作业来执行分组操作。物理计划是执行计划的具体化，它映射到具体的执行框架（如 Hadoop MapReduce）。</li></ul> 
<p><br><span style="background-color:#ffd7b9;">Pig 执行引擎</span></p> 
<ul><li><strong>执行计划优化: </strong>在生成物理计划后，Pig 的执行引擎会对物理计划进行优化。这些优化可以包括合并操作符、移除冗余操作、优化数据传输等，以提高作业的执行效率。</li><li><strong>MapReduce 任务生成: </strong>Pig 的执行引擎会将优化后的物理计划转化为一系列的 MapReduce 作业。在 Hadoop 集群上，这些 MapReduce 作业会被调度和执行。Pig 的执行引擎负责将 Pig Latin 中的高层操作符映射到低层次的 MapReduce 作业。</li></ul> 
<p><br><span style="background-color:#ffd7b9;">用户自定义函数（UDF）</span></p> 
<ul><li><strong>扩展功能: </strong>虽然 Pig Latin 提供了丰富的内置函数库，但在某些情况下，用户可能需要定义自己的函数来处理特殊的数据转换或计算。Pig 允许用户使用 Java、Python、JavaScript 等语言编写 UDF，并在 Pig Latin 脚本中调用这些函数。</li><li><strong>集成: </strong>UDF 可以无缝地集成到 Pig 的执行流程中，作为自定义的操作符来处理数据。Pig 编译器和执行引擎会处理 UDF 与其他操作符的结合，使其成为整个数据处理流程的一部分。</li></ul> 
<p class="img-center"><img alt="" height="494" src="https://images2.imgbox.com/c4/e6/VAvCIsql_o.png" width="1200"></p> 
<h3 id="3%E3%80%81Pig%20%E7%9A%84%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B">3、Pig 的执行流程</h3> 
<ol><li><strong>脚本提交: </strong>用户编写 Pig Latin 脚本并提交给 Pig。</li><li><strong>解析和逻辑计划生成: </strong>Pig 编译器解析脚本并生成逻辑计划。</li><li><strong>物理计划生成:</strong> Pig 编译器将逻辑计划转化为物理计划。</li><li><strong>执行计划优化: </strong>Pig 执行引擎对物理计划进行优化。</li><li><strong>MapReduce 任务生成和执行: </strong>Pig 执行引擎将优化后的计划转化为 MapReduce 作业并在 Hadoop 上执行。</li><li><strong>结果输出: </strong>执行完成后，结果会被存储到指定的输出位置（如 HDFS）。 </li></ol> 
<p> </p> 
<p> </p> 
<p class="img-center"><img alt="" height="450" src="https://images2.imgbox.com/47/9d/MyaD3Gaf_o.png" width="808"></p> 
<h3 id="4%E3%80%81Pig%E4%B8%8EHive%E7%9A%84%E5%AF%B9%E6%AF%94">4、Pig与Hive的对比</h3> 
<p><span style="background-color:#ffd7b9;">语言特性    </span></p> 
<ul><li><strong>Pig：</strong>Pig Latin是一种数据流语言，注重数据处理的过程性，适用于实时分析场景。    </li><li><strong>Hive：</strong>HiveQL类似于SQL，提供了完整的SQL查询功能，适用于离线数据分析。</li></ul> 
<p><span style="background-color:#ffd7b9;">学习成本    </span></p> 
<ul><li><strong>Pig：</strong>Pig Latin虽然简洁，但需要一定的学习成本，因为它提供了一套高级的数据流操作语言。    </li><li><strong>Hive：</strong>HiveQL与SQL相似，降低了学习成本，尤其对于具有SQL背景的用户。</li></ul> 
<p><span style="background-color:#ffd7b9;">数据类型处理    </span></p> 
<ul><li><strong>Pig：</strong>Pig能够处理各种数据类型，包括结构化、半结构化和非结构化数据。    </li><li><strong>Hive：</strong>Hive更适合处理大规模的结构化数据。</li></ul> 
<p><span style="background-color:#ffd7b9;">执行效率    </span></p> 
<ul><li><strong>Pig：</strong>Pig旨在提供快速的执行效率，适合需要快速处理大量数据的场合。    </li><li><strong>Hive：</strong>Hive适用于处理和分析历史数据，尤其是在数据仓库环境中。</li></ul> 
<p><span style="background-color:#ffd7b9;">集成与扩展   </span> </p> 
<ul><li><strong>Pig：</strong>Pig可以与其他Hadoop生态系统组件（如Spark）集成，提高数据处理的灵活性。    </li><li><strong>Hive：</strong>Hive同样支持与其他Hadoop组件的集成，并提供了用户自定义函数（UDF）等功能来扩展其能力。</li></ul> 
<p><span style="background-color:#ffd7b9;">优化机制    </span></p> 
<ul><li><strong>Pig：</strong>Pig在执行时会进行内部优化，减少数据的实际扫描次数，提高处理效率。    </li><li><strong>Hive：</strong>Hive也提供了多种优化机制，如分区、桶、压缩等，以提升查询性能。</li></ul> 
<p class="img-center"><img alt="" height="564" src="https://images2.imgbox.com/e4/06/QW4BUwkL_o.png" width="1082"></p> 
<blockquote> 
 <p>💕💕💕每一次的分享都是一次成长的旅程，感谢您的陪伴和关注。希望这些关于大数据的文章能陪伴您走过技术的一段旅程，共同见证成长和进步！😺😺😺</p> 
 <p></p> 
 <p>🧨🧨🧨让我们一起在技术的海洋中探索前行，共同书写美好的未来！！！  </p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4676adeeea9da62e806d53398cb0f9f9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">《黑神话.悟空》与人工智能AI重塑经典与探索未来的交织</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/90ad5296efd08b2e1b774a8273f71e1f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Sql Server】使用row_number over方式进行表分页，数据量达到五千多条记录后，查询变慢需要20多秒的解决方案</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>