<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>在Ubuntu 16.04上安装和配置Redis的方法 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/b63e1ff0b738512f1bd226a625abe06f/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="在Ubuntu 16.04上安装和配置Redis的方法">
  <meta property="og:description" content="前些天发现了一个巨牛的人工智能学习网站，通俗易懂，风趣幽默，忍不住分享一下给大家。点击跳转到网站。
简介 Redis 是一个内存中的键值存储，以其灵活性、性能和广泛的语言支持而闻名。在本指南中，我们将演示如何在 Ubuntu 16.04 服务器上安装和配置 Redis。
先决条件 要完成本指南，您需要访问 Ubuntu 16.04 服务器。您需要一个具有 sudo 权限的非根用户，以执行此过程所需的管理功能。您可以按照我们的 Ubuntu 16.04 初始服务器设置指南来了解如何设置具有这些权限的帐户。
当您准备好开始时，请使用您的 sudo 用户登录到 Ubuntu 16.04 服务器并继续以下操作。
安装构建和测试依赖项 为了获得 Redis 的最新版本，我们将从源代码编译和安装软件。在下载代码之前，我们需要满足构建依赖项，以便编译软件。
为此，我们可以从 Ubuntu 存储库安装 build-essential 元包。我们还将下载 tcl 包，这样我们就可以测试我们的二进制文件。
我们可以通过输入以下命令来更新本地的 apt 包缓存并安装依赖项：
sudo apt-get update sudo apt-get install build-essential tcl 下载、编译和安装 Redis 接下来，我们可以开始构建 Redis。
下载并解压源代码 由于我们不需要长期保留我们将要编译的源代码（我们可以随时重新下载它），我们将在 /tmp 目录中构建。让我们现在切换到那里：
cd /tmp 现在，下载最新稳定版本的 Redis。这始终可在稳定的下载 URL 上找到：
curl -O http://download.redis.io/redis-stable.tar.gz 通过输入以下命令解压 tarball：
tar xzvf redis-stable.tar.gz 进入刚刚提取的 Redis 源目录结构：">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-08T01:00:00+08:00">
    <meta property="article:modified_time" content="2024-07-08T01:00:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">在Ubuntu 16.04上安装和配置Redis的方法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>前些天发现了一个巨牛的<a href="https://www.captainbed.cn/rubys" rel="nofollow">人工智能学习网站</a>，通俗易懂，风趣幽默，忍不住分享一下给大家。<a href="https://www.captainbed.cn/rubys" rel="nofollow">点击跳转到网站</a>。</p> 
<h4><a id="_2"></a>简介</h4> 
<p>Redis 是一个内存中的键值存储，以其灵活性、性能和广泛的语言支持而闻名。在本指南中，我们将演示如何在 Ubuntu 16.04 服务器上安装和配置 Redis。</p> 
<h3><a id="_6"></a>先决条件</h3> 
<p>要完成本指南，您需要访问 Ubuntu 16.04 服务器。您需要一个具有 <code>sudo</code> 权限的非根用户，以执行此过程所需的管理功能。您可以按照我们的 Ubuntu 16.04 初始服务器设置指南来了解如何设置具有这些权限的帐户。</p> 
<p>当您准备好开始时，请使用您的 <code>sudo</code> 用户登录到 Ubuntu 16.04 服务器并继续以下操作。</p> 
<h3><a id="_12"></a>安装构建和测试依赖项</h3> 
<p>为了获得 Redis 的最新版本，我们将从源代码编译和安装软件。在下载代码之前，我们需要满足构建依赖项，以便编译软件。</p> 
<p>为此，我们可以从 Ubuntu 存储库安装 <code>build-essential</code> 元包。我们还将下载 <code>tcl</code> 包，这样我们就可以测试我们的二进制文件。</p> 
<p>我们可以通过输入以下命令来更新本地的 <code>apt</code> 包缓存并安装依赖项：</p> 
<pre><code class="prism language-command">sudo apt-get update
sudo apt-get install build-essential tcl
</code></pre> 
<h3><a id="_Redis_25"></a>下载、编译和安装 Redis</h3> 
<p>接下来，我们可以开始构建 Redis。</p> 
<h4><a id="_29"></a>下载并解压源代码</h4> 
<p>由于我们不需要长期保留我们将要编译的源代码（我们可以随时重新下载它），我们将在 <code>/tmp</code> 目录中构建。让我们现在切换到那里：</p> 
<pre><code class="prism language-command">cd /tmp
</code></pre> 
<p>现在，下载最新稳定版本的 Redis。这始终可在稳定的下载 URL 上找到：</p> 
<pre><code class="prism language-command">curl -O http://download.redis.io/redis-stable.tar.gz
</code></pre> 
<p>通过输入以下命令解压 tarball：</p> 
<pre><code class="prism language-command">tar xzvf redis-stable.tar.gz
</code></pre> 
<p>进入刚刚提取的 Redis 源目录结构：</p> 
<pre><code class="prism language-command">cd redis-stable
</code></pre> 
<h4><a id="_Redis_55"></a>构建和安装 Redis</h4> 
<p>现在，我们可以通过输入以下命令来编译 Redis 二进制文件：</p> 
<pre><code class="prism language-command">make
</code></pre> 
<p>在编译二进制文件后，运行测试套件以确保一切都构建正确。您可以通过输入以下命令来执行此操作：</p> 
<pre><code class="prism language-command">make test
</code></pre> 
<p>这通常需要几分钟才能运行。完成后，您可以通过输入以下命令将二进制文件安装到系统中：</p> 
<pre><code class="prism language-command">sudo make install
</code></pre> 
<h3><a id="_Redis_75"></a>配置 Redis</h3> 
<p>现在 Redis 已安装，我们可以开始配置它。</p> 
<p>首先，我们需要创建一个配置目录。我们将使用传统的 <code>/etc/redis</code> 目录，可以通过输入以下命令来创建：</p> 
<pre><code class="prism language-command">sudo mkdir /etc/redis
</code></pre> 
<p>现在，复制 Redis 源存档中包含的示例 Redis 配置文件：</p> 
<pre><code class="prism language-command">sudo cp /tmp/redis-stable/redis.conf /etc/redis
</code></pre> 
<p>接下来，我们可以打开文件以调整配置中的一些项目：</p> 
<pre><code class="prism language-command">sudo nano /etc/redis/redis.conf
</code></pre> 
<p>在文件中，找到 <code>supervised</code> 指令。当前，此项设置为 <code>no</code>。由于我们正在运行使用 systemd init 系统的操作系统，我们可以将其更改为 <code>systemd</code>：</p> 
<pre><code>
. . .

# If you run Redis from upstart or systemd, Redis can interact with your
# supervision tree. Options:
#   supervised no      - no supervision interaction
#   supervised upstart - signal upstart by putting Redis into SIGSTOP mode
#   supervised systemd - signal systemd by writing READY=1 to $NOTIFY_SOCKET
#   supervised auto    - detect upstart or systemd method based on
#                        UPSTART_JOB or NOTIFY_SOCKET environment variables
# Note: these supervision methods only signal "process is ready."
#       They do not enable continuous liveness pings back to your supervisor.
supervised systemd

. . .
</code></pre> 
<p>接下来，找到 <code>dir</code> 目录。此选项指定 Redis 将用于转储持久数据的目录。我们需要选择一个 Redis 将具有写权限且普通用户无法查看的位置。</p> 
<p>我们将使用 <code>/var/lib/redis</code> 目录，稍后我们将在其中创建：</p> 
<pre><code>
. . .

# The working directory.
#
# The DB will be written inside this directory, with the filename specified
# above using the 'dbfilename' configuration directive.
#
# The Append Only File will also be created inside this directory.
#
# Note that you must specify a directory here, not a file name.
dir /var/lib/redis

. . .
</code></pre> 
<p>完成后保存并关闭文件。</p> 
<h3><a id="_Redis_systemd__140"></a>创建 Redis systemd 单元文件</h3> 
<p>接下来，我们可以创建一个 systemd 单元文件，以便 init 系统可以管理 Redis 进程。</p> 
<p>首先创建并打开 <code>/etc/systemd/system/redis.service</code> 文件：</p> 
<pre><code class="prism language-command">sudo nano /etc/systemd/system/redis.service
</code></pre> 
<p>在文件中，我们可以在 <code>[Unit]</code> 部分开始添加描述，并定义一个要求，在启动此服务之前网络必须可用：</p> 
<pre><code>
[Unit]
Description=Redis 内存数据存储
After=network.target
</code></pre> 
<p>在 <code>[Service]</code> 部分，我们需要指定服务的行为。出于安全考虑，我们不应该以 <code>root</code> 用户身份运行服务。我们应该使用一个专门的用户和组，我们将简单地称之为 <code>redis</code>。我们将立即创建这些。</p> 
<p>要启动服务，我们只需要调用 <code>redis-server</code> 二进制文件，指向我们的配置。要停止它，我们可以使用 Redis 的 <code>shutdown</code> 命令，可以用 <code>redis-cli</code> 二进制文件执行。此外，由于我们希望 Redis 在可能的情况下从故障中恢复，我们将 <code>Restart</code> 指令设置为 “always”：</p> 
<pre><code>
[Unit]
Description=Redis 内存数据存储
After=network.target

[Service]
User=redis
Group=redis
ExecStart=/usr/local/bin/redis-server /etc/redis/redis.conf
ExecStop=/usr/local/bin/redis-cli shutdown
Restart=always
</code></pre> 
<p>最后，在 <code>[Install]</code> 部分，我们可以定义服务在启用时应附加到的 systemd 目标（配置为在启动时启动）：</p> 
<pre><code>
[Unit]
Description=Redis 内存数据存储
After=network.target

[Service]
User=redis
Group=redis
ExecStart=/usr/local/bin/redis-server /etc/redis/redis.conf
ExecStop=/usr/local/bin/redis-cli shutdown
Restart=always

[Install]
WantedBy=multi-user.target
</code></pre> 
<p>完成后保存并关闭文件。</p> 
<h3><a id="_Redis__198"></a>创建 Redis 用户、组和目录</h3> 
<p>现在，我们只需创建在前两个文件中引用的用户、组和目录。</p> 
<p>首先创建 <code>redis</code> 用户和组。可以通过输入以下命令一次性完成：</p> 
<pre><code class="prism language-command">sudo adduser --system --group --no-create-home redis
</code></pre> 
<p>现在，我们可以通过输入以下命令创建 <code>/var/lib/redis</code> 目录：</p> 
<pre><code class="prism language-command">sudo mkdir /var/lib/redis
</code></pre> 
<p>我们应该让 <code>redis</code> 用户和组拥有此目录的所有权：</p> 
<pre><code class="prism language-command">sudo chown redis:redis /var/lib/redis
</code></pre> 
<p>调整权限，以便普通用户无法访问此位置：</p> 
<pre><code class="prism language-command">sudo chmod 770 /var/lib/redis
</code></pre> 
<h3><a id="_Redis_226"></a>启动和测试 Redis</h3> 
<p>现在，我们准备启动 Redis 服务器。</p> 
<h4><a id="_Redis__230"></a>启动 Redis 服务</h4> 
<p>通过输入以下命令启动 systemd 服务：</p> 
<pre><code class="prism language-command">sudo systemctl start redis
</code></pre> 
<p>通过运行以下命令检查服务是否没有错误：</p> 
<pre><code class="prism language-command">sudo systemctl status redis
</code></pre> 
<p>您应该看到类似于以下内容：</p> 
<pre><code>
● redis.service - Redis 服务器
   Loaded: loaded (/etc/systemd/system/redis.service; enabled; vendor preset: enabled)
   Active: active (running) since Wed 2016-05-11 14:38:08 EDT; 1min 43s ago
  Process: 3115 ExecStop=/usr/local/bin/redis-cli shutdown (code=exited, status=0/SUCCESS)
 Main PID: 3124 (redis-server)
    Tasks: 3 (limit: 512)
   Memory: 864.0K
      CPU: 179ms
   CGroup: /system.slice/redis.service
           └─3124 /usr/local/bin/redis-server 127.0.0.1:6379       

. . .
</code></pre> 
<h4><a id="_Redis__262"></a>测试 Redis 实例功能</h4> 
<p>要测试服务是否正常运行，使用命令行客户端连接到 Redis 服务器：</p> 
<pre><code class="prism language-command">redis-cli
</code></pre> 
<p>在随后的提示符中，通过输入以下内容测试连接：</p> 
<pre><code class="prism language-custom_prefix(127.0.0.1:6379&gt;)">ping
</code></pre> 
<p>您应该看到：</p> 
<pre><code>
PONG
</code></pre> 
<p>通过输入以下内容检查是否可以设置键：</p> 
<pre><code class="prism language-custom_prefix(127.0.0.1:6379&gt;)">set test "It's working!"
</code></pre> 
<pre><code>
OK
</code></pre> 
<p>现在，通过输入以下内容检索值：</p> 
<pre><code class="prism language-custom_prefix(127.0.0.1:6379&gt;)">get test
</code></pre> 
<p>您应该能够检索到我们存储的值：</p> 
<pre><code>
"It's working!"
</code></pre> 
<p>退出 Redis 提示符返回到 shell：</p> 
<pre><code class="prism language-custom_prefix(127.0.0.1:6379&gt;)">exit
</code></pre> 
<p>作为最后的测试，让我们重新启动 Redis 实例：</p> 
<pre><code class="prism language-command">sudo systemctl restart redis
</code></pre> 
<p>现在，再次连接客户端并确认您的测试值仍然可用：</p> 
<pre><code class="prism language-command">redis-cli
</code></pre> 
<pre><code class="prism language-custom_prefix(127.0.0.1:6379&gt;)">get test
</code></pre> 
<p>您的键的值仍然可以访问：</p> 
<pre><code>
"It's working!"
</code></pre> 
<p>完成后再次返回到 shell：</p> 
<pre><code class="prism language-custom_prefix(127.0.0.1:6379&gt;)">exit
</code></pre> 
<h4><a id="_Redis__341"></a>启用 Redis 开机自启动</h4> 
<p>如果你的所有测试都通过了，并且你希望在服务器启动时自动启动 Redis，你可以启用 systemd 服务。</p> 
<p>要这样做，请输入以下命令：</p> 
<pre><code class="prism language-command">sudo systemctl enable redis
</code></pre> 
<pre><code class="prism language-bash">Created symlink from /etc/systemd/system/multi-user.target.wants/redis.service to /etc/systemd/system/redis.service.
</code></pre> 
<h3><a id="_354"></a>结论</h3> 
<p>现在你的 Ubuntu 16.04 服务器上应该已经安装并配置了 Redis 实例。要了解更多关于如何保护你的 Redis 安装的信息，请参考我们的《如何在 Ubuntu 14.04 上保护你的 Redis 安装》（从第3步开始）。尽管它是针对 Ubuntu 14.04 编写的，但在 16.04 上也应该大部分适用。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6d442ab84664ff6c2da059fc8c445d1b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">[算法] 优先算法(四):滑动窗口(下)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bd4675a364f34928cbd2386a636da3e1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Apache Tomcat 数千台服务器面临拒绝服务风险威胁</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>