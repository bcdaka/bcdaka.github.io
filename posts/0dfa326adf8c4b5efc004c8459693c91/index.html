<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>OpenCV与AI深度学习 | 如何使用YOLOv9检测图片和视频中的目标 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/0dfa326adf8c4b5efc004c8459693c91/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="OpenCV与AI深度学习 | 如何使用YOLOv9检测图片和视频中的目标">
  <meta property="og:description" content="本文来源公众号“OpenCV与AI深度学习”，仅用于学术分享，侵权删，干货满满。
原文链接：如何使用YOLOv9检测图片和视频中的目标
1 介绍 在之前的文章中，我们探索了使用 YOLOv8 进行对象检测。现在，我们很高兴能够深入研究最新的迭代——YOLOv9！这个新版本承诺在准确性、效率和适用性方面取得显著进步，使其成为各种计算机视觉任务的强大工具。
2 如何使用 YOLOv9 处理图像和视频 第 1 步：安装必要的库
pip install opencv-python ultralytics 第 2 步：导入库
import cv2 from ultralytics import YOLO 第 3 步：选择模型
model = YOLO(&#34;yolov9c.pt&#34;) 在下面网址中，您可以比较不同的型号并权衡各自的优缺点。在本例中，我们选择了 yolov9c.pt。
https://docs.ultralytics.com/de/models/yolov9/#impact-on-lightweight-models 第 4 步：编写一个函数来预测和检测图像和视频中的对象 def predict(chosen_model, img, classes=[], conf=0.5): if classes: results = chosen_model.predict(img, classes=classes, conf=conf) else: results = chosen_model.predict(img, conf=conf) return results def predict_and_detect(chosen_model, img, classes=[], conf=0.5, rectangle_thickness=2, text_thickness=1): results = predict(chosen_model, img, classes, conf=conf) for result in results: for box in result.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-08T17:20:28+08:00">
    <meta property="article:modified_time" content="2024-05-08T17:20:28+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">OpenCV与AI深度学习 | 如何使用YOLOv9检测图片和视频中的目标</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>本文来源公众号<strong>“OpenCV与AI深度学习</strong><strong>”</strong>，仅用于学术分享，侵权删，干货满满。</p> 
<p>原文链接：<a href="https://mp.weixin.qq.com/s/tX3yw3Q8nGY3tnW3KC6A9g" rel="nofollow" title="如何使用YOLOv9检测图片和视频中的目标">如何使用YOLOv9检测图片和视频中的目标</a></p> 
<p><img alt="" height="434" src="https://images2.imgbox.com/d7/33/oV3gLV9p_o.png" width="770"></p> 
<h3><strong>1 介绍</strong></h3> 
<p>    在之前的文章中，我们探索了使用 YOLOv8 进行对象检测。现在，我们很高兴能够深入研究最新的迭代——YOLOv9！这个新版本承诺在准确性、效率和适用性方面取得显著进步，使其成为各种计算机视觉任务的强大工具。</p> 
<h3><strong>2 如何使用 YOLOv9 处理图像和视频</strong></h3> 
<p><strong>第 1 步：安装必要的库</strong></p> 
<pre><code class="language-bash">pip install opencv-python ultralytics</code></pre> 
<p><strong>第 2 步：导入库</strong></p> 
<pre><code class="language-python">import cv2
from ultralytics import YOLO</code></pre> 
<p><strong>第 3 步：选择模型</strong></p> 
<pre><code class="language-python">model = YOLO("yolov9c.pt")</code></pre> 
<p>    在下面网址中，您可以比较不同的型号并权衡各自的优缺点。在本例中，我们选择了 yolov9c.pt。</p> 
<pre><code>https://docs.ultralytics.com/de/models/yolov9/#impact-on-lightweight-models</code></pre> 
<p><img alt="" height="423" src="https://images2.imgbox.com/cc/7f/0stahWnC_o.png" width="772"></p> 
<p><strong>第 4 步：编写一个函数来预测和检测图像和视频中的对象 </strong></p> 
<pre><code class="language-python">def predict(chosen_model, img, classes=[], conf=0.5):
    if classes:
        results = chosen_model.predict(img, classes=classes, conf=conf)
    else:
        results = chosen_model.predict(img, conf=conf)

    return results

def predict_and_detect(chosen_model, img, classes=[], conf=0.5, rectangle_thickness=2, text_thickness=1):
    results = predict(chosen_model, img, classes, conf=conf)
    for result in results:
        for box in result.boxes:
            cv2.rectangle(img, (int(box.xyxy[0][0]), int(box.xyxy[0][1])),
                          (int(box.xyxy[0][2]), int(box.xyxy[0][3])), (255, 0, 0), rectangle_thickness)
            cv2.putText(img, f"{result.names[int(box.cls[0])]}",
                        (int(box.xyxy[0][0]), int(box.xyxy[0][1]) - 10),
                        cv2.FONT_HERSHEY_PLAIN, 1, (255, 0, 0), text_thickness)
    return img, results</code></pre> 
<p>   <strong>predict()函数</strong>有三个参数：</p> 
<ul><li>chosen_model：用于预测的训练模型</li><li>img：进行预测的图像</li><li>classes：（可选）用于过滤预测的类名列表</li><li>conf：（可选）要考虑的预测的最小置信度阈值</li></ul> 
<p>    该函数首先检查是否classes提供了参数。如果是，则chosen_model.predict()使用参数调用该方法classes，该方法将预测仅过滤到这些类。否则，chosen_model.predict()将在不带参数的情况下调用该方法classes，这会返回所有预测。</p> 
<p>    该conf参数用于过滤掉置信度分数低于指定阈值的预测。这对于消除误报很有用。</p> 
<p>    该函数返回预测结果列表，其中每个结果包含以下信息：</p> 
<ul><li>name: 预测类别的名称</li><li>conf：预测的置信度分数</li><li>box：预测对象的边界框</li></ul> 
<p>    <strong>predict_and_detect()函数</strong>：该函数采用与 函数相同的参数predict()，但除了预测结果之外，它还返回带注释的图像。</p> 
<p>    该函数首先调用该predict()函数来获取预测结果。然后，它迭代预测结果并在每个预测对象周围绘制一个边界框。预测类的名称也写在边界框上方。</p> 
<p>    该函数返回一个包含注释图像和预测结果的元组。</p> 
<p>    以下是两个函数之间差异的总结：</p> 
<ul><li>predict()函数仅返回预测结果，同时该predict_and_detect()函数还返回带注释的图像</li><li>predict_and_detect()函数是函数的包装器predict()，这意味着它predict()在内部调用该函数。</li></ul> 
<p><strong>第 5 步：使用 YOLOv9 检测图像中的目标</strong></p> 
<pre><code class="language-python"># read the image
image = cv2.imread("YourImagePath")

result_img, _ = predict_and_detect(model, image, classes=[], conf=0.5)</code></pre> 
<p>如果想检测特定的类，可以在下面链接找到对应的类名，只需在类列表中写入对象的 ID 号即可。</p> 
<pre><code>https://github.com/ultralytics/ultralytics/blob/main/ultralytics/cfg/datasets/coco.yaml</code></pre> 
<p><strong>第 6 步：保存并绘制结果图像</strong></p> 
<pre><code class="language-python">cv2.imshow("Image", result_img)
cv2.imwrite("YourSavePath", result_img)
cv2.waitKey(0)</code></pre> 
<p><strong>第 7 步：使用 YOLOv9 检测视频中的目标</strong></p> 
<pre><code class="language-python">video_path = r"YourVideoPath"
cap = cv2.VideoCapture(video_path)
while True:
    success, img = cap.read()
    if not success:
        break
    result_img, _ = predict_and_detect(model, img, classes=[], conf=0.5)
    cv2.imshow("Image", result_img)
    
    cv2.waitKey(1)</code></pre> 
<p><strong>第 8 步：保存结果视频</strong></p> 
<pre><code class="language-python"># defining function for creating a writer (for mp4 videos)
def create_video_writer(video_cap, output_filename):
    # grab the width, height, and fps of the frames in the video stream.
    frame_width = int(video_cap.get(cv2.CAP_PROP_FRAME_WIDTH))
    frame_height = int(video_cap.get(cv2.CAP_PROP_FRAME_HEIGHT))
    fps = int(video_cap.get(cv2.CAP_PROP_FPS))
    # initialize the FourCC and a video writer object
    fourcc = cv2.VideoWriter_fourcc(*'MP4V')
    writer = cv2.VideoWriter(output_filename, fourcc, fps,
                             (frame_width, frame_height))
    return writer</code></pre> 
<p>只需使用上面的函数和代码即可：</p> 
<pre><code class="language-python">output_filename = "YourFilename"
writer = create_video_writer(cap, output_filename)

video_path = r"YourVideoPath"
cap = cv2.VideoCapture(video_path)
while True:
    success, img = cap.read()
    if not success:
        break
    result_img, _ = predict_and_detect(model, img, classes=[], conf=0.5)
    writer.write(result_img)
    cv2.imshow("Image", result_img)
    
    cv2.waitKey(1)
writer.release()</code></pre> 
<p>THE END !</p> 
<p>文章结束，感谢阅读。您的点赞，收藏，评论是我继续更新的动力。<strong>大家有推荐的公众号可以评论区留言，共同学习，一起进步。</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7a595dfef19fd8c1e1647a48fcf583ee/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Windows系统完全卸载删除 Node.js （包含控制面板找不到node.js选项情况）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a17e342f5e3e90ee8cedbf08f336b9ed/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">RabbitMQ如何测试</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>