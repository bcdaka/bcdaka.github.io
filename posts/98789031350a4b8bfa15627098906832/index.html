<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Hadoop 高可用集群完全分布式安装教程一篇就够用（zookeeper、spark、hbase、mysql、hive) - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/98789031350a4b8bfa15627098906832/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Hadoop 高可用集群完全分布式安装教程一篇就够用（zookeeper、spark、hbase、mysql、hive)">
  <meta property="og:description" content="Hadoop 高可用集群完全分布式安装教程一篇就够用（zookeeper、spark、hbase、mysql、hive） 写在之前，Hadoop完全分布式集群资源配置规划情况
一、全局基本配置 💡 建议一开始安装的时候在网络配置项的地方,选择自动ipv4,然后进行ip设置 1、更改静态网络 命令如下：
# 检查虚拟机是否能够ping通www.baidu.com service network restart # 尝试重启网络服务 # 修改网络服务为静态网络 指定路由以及DNS服务器 vim /etc/sysconfig/network-scripts/ifcfg-ens33 文件内容如下：
TYPE=Ethernet PROXY_METHOD=none BROWSER_ONLY=no BOOTPROTO=&#34;static&#34; DEFROUTE=yes IPV4_FAILURE_FATAL=no IPV6INIT=yes IPV6_AUTOCONF=yes IPV6_DEFROUTE=yes IPV6_FAILURE_FATAL=no IPV6_ADDR_GEN_MODE=stable-privacy NAME=ens33 UUID=c494a46e-a55b-431a-9b5e-b2bbdc767606 DEVICE=ens33 ONBOOT=yes IPADDR=192.168.201.201# 虚拟机对应的ip地址 NETMASK=255.255.255.0 # 子网掩码 GATEWAY=192.168.201.2# 网关地址 DNS1=114.114.114.114 # DNS服务器地址 然后重启网络：
service network restart 再次测试 网络是否能够正常联通
ping www.baidu.com 2、关闭防火墙 #关闭防火墙 systemctl stop firewalld #禁用防火墙 systemctl disable firewalld #查看防火墙状态 systemctl status firewalld 3、配置主机名（方便后期Hadoop集群服务） #给3台虚拟机设置主机名分别为hadoop01、hadoop02和hadoop03。 #在第一台机器操作 hostnamectl set-hostname hadoop01 #在第二台机器操作 hostnamectl set-hostname hadoop02 #在第三台机器操作 hostnamectl set-hostname hadoop03 设置完毕后在ssh工具处刷新即可">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-12-08T22:40:44+08:00">
    <meta property="article:modified_time" content="2023-12-08T22:40:44+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Hadoop 高可用集群完全分布式安装教程一篇就够用（zookeeper、spark、hbase、mysql、hive)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Hadoop_zookeepersparkhbasemysqlhive_0"></a>Hadoop 高可用集群完全分布式安装教程一篇就够用（zookeeper、spark、hbase、mysql、hive）</h2> 
<p><strong>写在之前，Hadoop完全分布式集群资源配置规划情况</strong><br> <img src="https://images2.imgbox.com/93/9b/8xX9Ne0d_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_4"></a>一、全局基本配置</h2> 
<aside>
  💡 建议一开始安装的时候在网络配置项的地方,选择自动ipv4,然后进行ip设置 
</aside> 
<h3><a id="1_11"></a>1、更改静态网络</h3> 
<p><strong>命令如下：</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># 检查虚拟机是否能够ping通www.baidu.com</span>
service network restart  <span class="token comment"># 尝试重启网络服务</span>
<span class="token comment"># 修改网络服务为静态网络 指定路由以及DNS服务器</span>
vim <span class="token operator">/</span>etc<span class="token operator">/</span>sysconfig<span class="token operator">/</span>network<span class="token operator">-</span>scripts<span class="token operator">/</span>ifcfg<span class="token operator">-</span>ens33
</code></pre> 
<p><strong>文件内容如下：</strong></p> 
<pre><code class="prism language-python">TYPE<span class="token operator">=</span>Ethernet
PROXY_METHOD<span class="token operator">=</span>none
BROWSER_ONLY<span class="token operator">=</span>no
BOOTPROTO<span class="token operator">=</span><span class="token string">"static"</span>
DEFROUTE<span class="token operator">=</span>yes
IPV4_FAILURE_FATAL<span class="token operator">=</span>no
IPV6INIT<span class="token operator">=</span>yes
IPV6_AUTOCONF<span class="token operator">=</span>yes
IPV6_DEFROUTE<span class="token operator">=</span>yes
IPV6_FAILURE_FATAL<span class="token operator">=</span>no
IPV6_ADDR_GEN_MODE<span class="token operator">=</span>stable<span class="token operator">-</span>privacy
NAME<span class="token operator">=</span>ens33
UUID<span class="token operator">=</span>c494a46e<span class="token operator">-</span>a55b<span class="token operator">-</span>431a<span class="token operator">-</span>9b5e<span class="token operator">-</span>b2bbdc767606
DEVICE<span class="token operator">=</span>ens33
ONBOOT<span class="token operator">=</span>yes
IPADDR<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.201</span><span class="token number">.201</span><span class="token comment"># 虚拟机对应的ip地址</span>
NETMASK<span class="token operator">=</span><span class="token number">255.255</span><span class="token number">.255</span><span class="token number">.0</span>  <span class="token comment"># 子网掩码</span>
GATEWAY<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.201</span><span class="token number">.2</span><span class="token comment"># 网关地址</span>
DNS1<span class="token operator">=</span><span class="token number">114.114</span><span class="token number">.114</span><span class="token number">.114</span>       <span class="token comment"># DNS服务器地址</span>

</code></pre> 
<p><strong>然后重启网络：</strong></p> 
<pre><code class="prism language-python">service network restart
</code></pre> 
<p><strong>再次测试 网络是否能够正常联通</strong></p> 
<pre><code class="prism language-python">ping www<span class="token punctuation">.</span>baidu<span class="token punctuation">.</span>com
</code></pre> 
<h3><a id="2_59"></a>2、关闭防火墙</h3> 
<pre><code class="prism language-python"><span class="token comment">#关闭防火墙</span>
systemctl stop firewalld
<span class="token comment">#禁用防火墙</span>
systemctl disable firewalld
<span class="token comment">#查看防火墙状态</span>
systemctl status firewalld
</code></pre> 
<h3><a id="3Hadoop_70"></a><strong>3、配置主机名（方便后期Hadoop集群服务）</strong></h3> 
<pre><code class="prism language-python"><span class="token comment">#给3台虚拟机设置主机名分别为hadoop01、hadoop02和hadoop03。</span>
<span class="token comment">#在第一台机器操作 </span>
hostnamectl <span class="token builtin">set</span><span class="token operator">-</span>hostname hadoop01
<span class="token comment">#在第二台机器操作</span>
hostnamectl <span class="token builtin">set</span><span class="token operator">-</span>hostname hadoop02
<span class="token comment">#在第三台机器操作</span>
hostnamectl <span class="token builtin">set</span><span class="token operator">-</span>hostname hadoop03
</code></pre> 
<p><strong>设置完毕后在ssh工具处刷新即可</strong></p> 
<h3><a id="4hostsLinux_84"></a>4、编辑hosts头文件（Linux）</h3> 
<pre><code class="prism language-python">vi <span class="token operator">/</span>etc<span class="token operator">/</span>hosts  <span class="token comment"># 编辑hosts文件</span>
<span class="token comment"># 在最后一行添加</span>
<span class="token number">192.168</span><span class="token number">.201</span><span class="token number">.201</span> hadoop01
<span class="token number">192.168</span><span class="token number">.201</span><span class="token number">.202</span> hadoop02
<span class="token number">192.168</span><span class="token number">.201</span><span class="token number">.203</span> hadoop03
</code></pre> 
<h3><a id="5hostswindows_94"></a>5、编辑hosts头文件（windows）</h3> 
<pre><code class="prism language-python"><span class="token comment"># 在Windows中打开C:\Windows\System32\drivers\etc路径，在hosts文件中添加如下内容：</span>

<span class="token number">192.168</span><span class="token number">.201</span><span class="token number">.201</span> hadoop01
<span class="token number">192.168</span><span class="token number">.201</span><span class="token number">.202</span> hadoop02
<span class="token number">192.168</span><span class="token number">.201</span><span class="token number">.203</span> hadoop03
</code></pre> 
<h3><a id="6ssh_104"></a>6、ssh免密登录</h3> 
<pre><code class="prism language-python"><span class="token comment"># 每一个机器都需要这样操作</span>
ssh<span class="token operator">-</span>keygen <span class="token operator">-</span>b <span class="token number">1024</span> <span class="token operator">-</span>t rsa

cd <span class="token punctuation">.</span>ssh

ssh<span class="token operator">-</span>copy<span class="token operator">-</span><span class="token builtin">id</span> hadoop01
ssh<span class="token operator">-</span>copy<span class="token operator">-</span><span class="token builtin">id</span> hadoop02
ssh<span class="token operator">-</span>copy<span class="token operator">-</span><span class="token builtin">id</span> hadoop03
</code></pre> 
<h3><a id="7_117"></a>7、编写集群分发脚本</h3> 
<pre><code class="prism language-python"><span class="token comment"># 需要在用户目录下新建一个bin文件夹,然后存放集群分发脚本xsync</span>
<span class="token comment"># 为什么要新建bin文件夹的原因 执行   echo $PATH   查看系统环境路径 能够全局执行</span>
<span class="token comment"># /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin</span>
mkdir <span class="token operator">/</span>root<span class="token operator">/</span><span class="token builtin">bin</span>
vim xsync
chmod <span class="token number">777</span> xsync

<span class="token comment"># 如果报错</span>
<span class="token comment"># bash: rsync: command not found</span>
<span class="token comment"># rsync: connection unexpectedly closed (0 bytes received so far) [sender]</span>
<span class="token comment"># rsync error: remote command not found (code 127) at io.c(226) [sender=3.1.2]</span>
<span class="token comment"># 下载 rsync 即可 因为作者使用的从机使用的是最小化安装版本 因此需要额外安装rsync</span>
yum <span class="token operator">-</span>y install rsync
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">#!/bin/bash</span>

<span class="token comment">#1. 判断参数个数</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> $<span class="token comment"># -lt 1 ]</span>
then
    echo Not Enough Arguement!
    exit<span class="token punctuation">;</span>
fi
<span class="token comment">#2. 遍历集群所有机器</span>
<span class="token keyword">for</span> host <span class="token keyword">in</span> hadoop01 hadoop02 hadoop03
do
    echo <span class="token operator">-</span>e <span class="token string">"\n====================  $host  ===================="</span>
    <span class="token comment">#3. 遍历所有目录，逐个发送</span>
    <span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> $@
    do
        <span class="token comment">#4. 判断文件是否存在</span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">-</span>e $<span class="token builtin">file</span> <span class="token punctuation">]</span>
            then
                <span class="token comment">#5. 获取父目录</span>
                pdir<span class="token operator">=</span>$<span class="token punctuation">(</span>cd <span class="token operator">-</span>P $<span class="token punctuation">(</span>dirname $<span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">;</span> pwd<span class="token punctuation">)</span>
                <span class="token comment">#6. 获取当前文件的名称</span>
                fname<span class="token operator">=</span>$<span class="token punctuation">(</span>basename $<span class="token builtin">file</span><span class="token punctuation">)</span>
                ssh $host <span class="token string">"mkdir -p $pdir"</span>
                rsync <span class="token operator">-</span>av $pdir<span class="token operator">/</span>$fname $host<span class="token punctuation">:</span>$pdir
            <span class="token keyword">else</span>
                echo $<span class="token builtin">file</span> does <span class="token keyword">not</span> exist!
        fi
    done
done
echo <span class="token operator">-</span>e <span class="token string">"\n"</span>
</code></pre> 
<h3><a id="8jps_168"></a>8、编写集群查看jps进行脚本</h3> 
<pre><code class="prism language-python">cd <span class="token operator">~</span><span class="token operator">/</span><span class="token builtin">bin</span>
vim jpsall

<span class="token comment">#!/bin/bash</span>
<span class="token keyword">for</span> host <span class="token keyword">in</span> hadoop01 hadoop02 hadoop03
do
    echo <span class="token operator">-</span>e <span class="token string">"\n=============== $host ==============="</span>
    ssh $host <span class="token string">"export JAVA_HOME=/opt/module/jdk1.8.0_391 &amp;&amp; export PATH=\$JAVA_HOME/bin:\$PATH &amp;&amp; jps"</span>
done
echo <span class="token operator">-</span>e <span class="token string">"\n"</span>

<span class="token comment"># 保存 给文件赋予执行权限</span>
chmod <span class="token number">777</span> jpsall
</code></pre> 
<h2><a id="jdk_186"></a>二、jdk安装配置</h2> 
<pre><code class="prism language-python"><span class="token comment"># 解压</span>
tar <span class="token operator">-</span>zxvf jdk<span class="token operator">-</span>8u391<span class="token operator">-</span>linux<span class="token operator">-</span>x64<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">-</span>C <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>

<span class="token comment"># 设置环境变量</span>
vim <span class="token operator">/</span>etc<span class="token operator">/</span>profile 

<span class="token comment">#在末尾追加环境变量</span>
export JAVA_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_391</span>
export PATH<span class="token operator">=</span>$JAVA_HOME<span class="token operator">/</span><span class="token builtin">bin</span><span class="token punctuation">:</span>$PATH

<span class="token comment"># 使用集群分发命令 将 环境变量 分发至其他从机</span>
xsync <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment"># 激活环境变量</span>
source <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token punctuation">[</span>root@hadoop03 module<span class="token punctuation">]</span><span class="token comment"># java -version</span>
java version <span class="token string">"1.8.0_391"</span>
Java<span class="token punctuation">(</span>TM<span class="token punctuation">)</span> SE Runtime Environment <span class="token punctuation">(</span>build <span class="token number">1.8</span><span class="token number">.0_391</span><span class="token operator">-</span>b13<span class="token punctuation">)</span>
Java HotSpot<span class="token punctuation">(</span>TM<span class="token punctuation">)</span> <span class="token number">64</span><span class="token operator">-</span>Bit Server VM <span class="token punctuation">(</span>build <span class="token number">25.391</span><span class="token operator">-</span>b13<span class="token punctuation">,</span> mixed mode<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="zookeeper_211"></a>三、zookeeper安装配置</h2> 
<h3><a id="zookeeper__213"></a>zookeeper集群 搭建</h3> 
<pre><code class="prism language-python"><span class="token comment"># 解压</span>
tar <span class="token operator">-</span>zxvf apache<span class="token operator">-</span>zookeeper<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.1</span><span class="token operator">-</span><span class="token builtin">bin</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">-</span>C <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>

cd <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>

mv apache<span class="token operator">-</span>zookeeper<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.1</span><span class="token operator">-</span><span class="token builtin">bin</span><span class="token operator">/</span> zookeeper<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.1</span>

cd zookeeper<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.1</span><span class="token operator">/</span>conf<span class="token operator">/</span>

<span class="token comment">#zk配置文件是 zoo.cfg ，创建并配置</span>
mv zoo_sample<span class="token punctuation">.</span>cfg zoo<span class="token punctuation">.</span>cfg

vim zoo<span class="token punctuation">.</span>cfg

<span class="token comment"># 修改</span>
dataDir<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>zookeeper<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.1</span><span class="token operator">/</span>data
<span class="token comment"># 添加  对应主机名的id识别全局端口</span>
server<span class="token punctuation">.</span><span class="token number">1</span><span class="token operator">=</span>hadoop01<span class="token punctuation">:</span><span class="token number">2888</span><span class="token punctuation">:</span><span class="token number">3888</span>
server<span class="token punctuation">.</span><span class="token number">2</span><span class="token operator">=</span>hadoop02<span class="token punctuation">:</span><span class="token number">2888</span><span class="token punctuation">:</span><span class="token number">3888</span>
server<span class="token punctuation">.</span><span class="token number">3</span><span class="token operator">=</span>hadoop03<span class="token punctuation">:</span><span class="token number">2888</span><span class="token punctuation">:</span><span class="token number">3888</span>
</code></pre> 
<hr> 
<aside>
  💡 说明：在zookeeper 集群中有三种角色：Leader、Follower 和 Observer，但在同一时刻只会有一个 Leader，其他都是 Follower 或 Observer。 
</aside> 
<hr> 
<pre><code class="prism language-python">cd <span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token comment"># 创建存放数据的文件夹</span>
mkdir data
<span class="token comment"># 创建myid编号</span>
echo <span class="token number">1</span> <span class="token operator">&gt;</span> data<span class="token operator">/</span>myid
</code></pre> 
<hr> 
<aside>
  💡 说明：对于zooKeeper集群来说，每个节点都需要配置一个唯一的myid。确保每个节点都能被正确地识别和识别为集群的一部分。 
</aside> 
<hr> 
<pre><code class="prism language-python"><span class="token comment"># 配置zookeeper环境变量</span>
vim <span class="token operator">/</span>etc<span class="token operator">/</span>profile

export ZOOKEEPER_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>zookeeper<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.1</span>
export PATH<span class="token operator">=</span>$PATH<span class="token punctuation">:</span>$ZOOKEEPER_HOME<span class="token operator">/</span><span class="token builtin">bin</span>

<span class="token comment"># 使用集群分发命令 将 环境变量 分发至其他从机</span>
xsync <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment"># 激活环境变量</span>
source <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment"># 使用集群分发命令 将 zookeeper 分发至其他从机</span>
xsync <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>zookeeper<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.1</span>

<span class="token comment"># 分别修改 hadoop02 和 hadoop03 的 myid 编号</span>
<span class="token punctuation">[</span>root@hadoop02 module<span class="token punctuation">]</span><span class="token comment"># echo 2 &gt; /opt/module/zookeeper-3.7.1/data/myid</span>
<span class="token punctuation">[</span>root@hadoop03 module<span class="token punctuation">]</span><span class="token comment"># echo 3 &gt; /opt/module/zookeeper-3.7.1/data/myid</span>

<span class="token comment">#所有节点启动，需要在每个节点执行</span>
zkServer<span class="token punctuation">.</span>sh start
</code></pre> 
<h3><a id="zookeeper__288"></a>zookeeper集群 启动命令</h3> 
<pre><code class="prism language-python"><span class="token comment"># 编写脚本对zookeeper集群实现批量启动，停止，重启</span>
<span class="token comment"># 在 用户目录下的 bin 文件下 创建集群启动文件</span>

cd <span class="token operator">/</span>root<span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span>

vim zkserver

<span class="token comment">#!/bin/bash</span>
echo <span class="token string">"$1 zkServer ..."</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">{<!-- --></span>hadoop02<span class="token punctuation">,</span>hadoop01<span class="token punctuation">,</span>hadoop03<span class="token punctuation">}</span>
do
        ssh $i <span class="token string">"source /etc/profile &amp;&amp; zkServer.sh $1"</span>
done

<span class="token comment"># 给文件赋予权限</span>
chmod <span class="token number">777</span> zkserver
</code></pre> 
<p><img src="https://images2.imgbox.com/42/22/3UElxQA7_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202311281105486.png"></p> 
<h3><a id="zookeeper__311"></a>zookeeper集群 状态检查命令</h3> 
<pre><code class="prism language-python"><span class="token comment"># 通过编写脚本实现批量检查</span>
vim zkstatus

<span class="token comment">#!/bin/bash</span>
<span class="token keyword">for</span> host <span class="token keyword">in</span> <span class="token punctuation">{<!-- --></span>hadoop02<span class="token punctuation">,</span>hadoop01<span class="token punctuation">,</span>hadoop03<span class="token punctuation">}</span>
do
        status<span class="token operator">=</span>$<span class="token punctuation">(</span>ssh $host <span class="token string">'source /etc/profile &amp;&amp; zkServer.sh status 2&gt;&amp;1 | grep  Mode'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> $status <span class="token operator">==</span> <span class="token string">"Mode: follower"</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>then
                echo <span class="token string">"$host是从节点"</span>
        <span class="token keyword">elif</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> $status <span class="token operator">==</span> <span class="token string">"Mode: leader"</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>then
                echo <span class="token string">"$host是主节点"</span>
        <span class="token keyword">else</span>
                echo <span class="token string">"未查询到$host节点zookeeper状态,请检查服务"</span>
        fi
done

<span class="token comment"># 给文件赋予权限</span>
chmod <span class="token number">777</span> zkstatus
</code></pre> 
<p><img src="https://images2.imgbox.com/b0/05/MjvQRw9m_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202311281102350.png"></p> 
<h2><a id="hadoop_336"></a>四、hadoop搭建集群</h2> 
<h3><a id="_338"></a>主机环境配置</h3> 
<pre><code class="prism language-python">
cd <span class="token operator">/</span>opt<span class="token operator">/</span>software<span class="token operator">/</span>

tar <span class="token operator">-</span>zxvf hadoop<span class="token operator">-</span><span class="token number">3.3</span><span class="token number">.5</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">-</span>C <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>

<span class="token comment"># 配置 hadoop 环境变量</span>
vim <span class="token operator">/</span>etc<span class="token operator">/</span>profile

export HADOOP_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hadoop<span class="token operator">-</span><span class="token number">3.3</span><span class="token number">.5</span>
export PATH<span class="token operator">=</span>$PATH<span class="token punctuation">:</span>$HADOOP_HOME<span class="token operator">/</span><span class="token builtin">bin</span><span class="token punctuation">:</span>$HADOOP_HOME<span class="token operator">/</span>sbin

<span class="token comment"># 激活环境变量</span>
source <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token punctuation">[</span>root@hadoop01 software<span class="token punctuation">]</span><span class="token comment"># hadoop version</span>
Hadoop <span class="token number">3.3</span><span class="token number">.5</span>
Source code repository https<span class="token punctuation">:</span><span class="token operator">//</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>apache<span class="token operator">/</span>hadoop<span class="token punctuation">.</span>git <span class="token operator">-</span>r 706d88266abcee09ed78fbaa0ad5f74d818ab0e9
Compiled by stevel on <span class="token number">2023</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span>15T15<span class="token punctuation">:</span>56Z
Compiled <span class="token keyword">with</span> protoc <span class="token number">3.7</span><span class="token number">.1</span>
From source <span class="token keyword">with</span> checksum 6bbd9afcf4838a0eb12a5f189e9bd7
</code></pre> 
<h3><a id="hadoop_hdfs_363"></a>编辑hadoop hdfs核心配置文件</h3> 
<h4><a id="workers_365"></a>编辑主机workers文件</h4> 
<pre><code class="prism language-python">vim workers

<span class="token comment">#填入从机名</span>
hadoop01
hadoop02
hadoop03
</code></pre> 
<h4><a id="coresitexml_376"></a>修改core-site.xml文件</h4> 
<pre><code class="prism language-python">vim core<span class="token operator">-</span>site<span class="token punctuation">.</span>xml

<span class="token operator">&lt;</span>configuration<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>配置默认的文件系统<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>fs<span class="token punctuation">.</span>defaultFS<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>用的是HDFS作为文件系统，还要指定HDFS放在哪台主机上运行，<span class="token number">9000</span>默认端口号<span class="token punctuation">,</span>如果配置了HA<span class="token punctuation">,</span>fs<span class="token punctuation">.</span>defaultFs的值应该是nameservice的名称，如hdfs<span class="token operator">-</span>site<span class="token punctuation">.</span>xml文件中dfs<span class="token punctuation">.</span>nameservices的
值为mycluster，此处填写hdfs<span class="token punctuation">:</span><span class="token operator">//</span>mycluster<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hdfs<span class="token punctuation">:</span><span class="token operator">//</span>mycluster<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hadoop<span class="token punctuation">.</span>tmp<span class="token punctuation">.</span><span class="token builtin">dir</span><span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token operator">/</span>data<span class="token operator">/</span>hadoop<span class="token operator">/</span>tmp<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>ha<span class="token punctuation">.</span>zookeeper<span class="token punctuation">.</span>quorum<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>HDFS连接zookeeper集群的地址和端口<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop01<span class="token punctuation">:</span><span class="token number">2181</span><span class="token punctuation">,</span>hadoop02<span class="token punctuation">:</span><span class="token number">2181</span><span class="token punctuation">,</span>hadoop03<span class="token punctuation">:</span><span class="token number">2181</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>ipc<span class="token punctuation">.</span>client<span class="token punctuation">.</span>connect<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">.</span>retries<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>设置重连次数，默认<span class="token number">10</span>次<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">100</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>ipc<span class="token punctuation">.</span>client<span class="token punctuation">.</span>connect<span class="token punctuation">.</span>retry<span class="token punctuation">.</span>interval<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>设置客户端在重试建立服务器连接之前等待的毫秒数，默认<span class="token number">1000</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">10000</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>io<span class="token punctuation">.</span><span class="token builtin">file</span><span class="token punctuation">.</span><span class="token builtin">buffer</span><span class="token punctuation">.</span>size<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>设置在读写数据时的缓存大小<span class="token punctuation">,</span>这个缓存区的大小应该是硬件页面大小的倍数（在 Intel x86 上是 <span class="token number">4096</span>），它决定了在读写操作中缓冲了多少数据。较大的缓存可以提供更高的数据传输<span class="token operator">&gt;</span>
，但这也意味着更大的内存消耗和延迟<span class="token punctuation">.</span>默认情况下，io<span class="token punctuation">.</span><span class="token builtin">file</span><span class="token punctuation">.</span><span class="token builtin">buffer</span><span class="token punctuation">.</span>size 的值为 <span class="token number">4096</span>，但是建议将其设置为<span class="token number">65536</span>（64k）<span class="token punctuation">,</span>也可以设置更高，比如<span class="token number">131702</span>等<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">65536</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>configuration<span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="hdfssitexml_422"></a>配置hdfs-site.xml文件</h4> 
<pre><code class="prism language-python">vim hdfs<span class="token operator">-</span>site<span class="token punctuation">.</span>xml

<span class="token operator">&lt;</span>configuration<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>nameservices<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>定义hdfs集群<span class="token builtin">id</span>号，需要和core<span class="token operator">-</span>site<span class="token punctuation">.</span>xml中的fs<span class="token punctuation">.</span>defaultFS保持一致<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>mycluster<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>ha<span class="token punctuation">.</span>namenodes<span class="token punctuation">.</span>mycluster<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>定义hdfs集群中的namenode的<span class="token builtin">id</span>号<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>nn1<span class="token punctuation">,</span>nn2<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>namenode<span class="token punctuation">.</span>rpc<span class="token operator">-</span>address<span class="token punctuation">.</span>mycluster<span class="token punctuation">.</span>nn1<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>nn1的RPC通信地址<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop01<span class="token punctuation">:</span><span class="token number">9000</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>namenode<span class="token punctuation">.</span>http<span class="token operator">-</span>address<span class="token punctuation">.</span>mycluster<span class="token punctuation">.</span>nn1<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>nn1的http通信地址<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop01<span class="token punctuation">:</span><span class="token number">50070</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>namenode<span class="token punctuation">.</span>rpc<span class="token operator">-</span>address<span class="token punctuation">.</span>mycluster<span class="token punctuation">.</span>nn2<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop02<span class="token punctuation">:</span><span class="token number">9000</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>namenode<span class="token punctuation">.</span>http<span class="token operator">-</span>address<span class="token punctuation">.</span>mycluster<span class="token punctuation">.</span>nn2<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop02<span class="token punctuation">:</span><span class="token number">50070</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>namenode<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token builtin">dir</span><span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token operator">/</span>data<span class="token operator">/</span>hadoop<span class="token operator">/</span>hdfs<span class="token operator">/</span>namenode<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>description<span class="token operator">&gt;</span>namenode上存储hdfs命名空间元数据<span class="token operator">&lt;</span><span class="token operator">/</span>description<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>datanode<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token builtin">dir</span><span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token operator">/</span>data<span class="token operator">/</span>hadoop<span class="token operator">/</span>hdfs<span class="token operator">/</span>datanode<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>description<span class="token operator">&gt;</span>datanode上数据块的物理存储位置<span class="token operator">&lt;</span><span class="token operator">/</span>description<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>replication<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">3</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>description<span class="token operator">&gt;</span>副本个数，默认是<span class="token number">3</span><span class="token punctuation">,</span>应小于datanode数量<span class="token operator">&lt;</span><span class="token operator">/</span>description<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>如果想让solr索引存放到hdfs中，则还须添加下面<span class="token number">2</span>个属性<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>webhdfs<span class="token punctuation">.</span>enabled<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>permissions<span class="token punctuation">.</span>enabled<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>用于启用或禁用 HDFS ACL（简单权限）。当 dfs<span class="token punctuation">.</span>permissions<span class="token punctuation">.</span>enabled 设置为 false 时，任何用户都可以在 HDFS 中的任何位置创建或删除文件或目录。将此属性设置为 false 后，您
可以访问所有其他 Hadoop 服务，例如 Hive、HBase 等<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>false<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>datanode<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">.</span>transfer<span class="token punctuation">.</span>threads<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">4096</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>用于设置 DataNode 在进行文件传输时的最大线程数<span class="token punctuation">.</span> 如果集群中有某台 DataNode 主机的这个值比其他主机的大，那么出现的问题是，这台主机上存储的数据相对别的主机比较多，导致
数据分布不均匀的问题，即使 balance 仍然会不均匀<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>ha<span class="token punctuation">.</span>fencing<span class="token punctuation">.</span>methods<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> HDFS集群中两个namenode切换状态时的隔离方法 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>sshfence<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>ha<span class="token punctuation">.</span>fencing<span class="token punctuation">.</span>ssh<span class="token punctuation">.</span>private<span class="token operator">-</span>key<span class="token operator">-</span>files<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> HDFS集群中两个namenode切换状态时的隔离方法的密钥 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token operator">/</span>root<span class="token operator">/</span><span class="token punctuation">.</span>ssh<span class="token operator">/</span>id_rsa<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>ha<span class="token punctuation">.</span>automatic<span class="token operator">-</span>failover<span class="token punctuation">.</span>enabled<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> 故障自动转移，HA的HDFS集群自动切换namenode的开关<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>namenode<span class="token punctuation">.</span>shared<span class="token punctuation">.</span>edits<span class="token punctuation">.</span><span class="token builtin">dir</span><span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> 指定NameNode的元数据在JournalNode上的存放位置 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>qjournal<span class="token punctuation">:</span><span class="token operator">//</span>hadoop01<span class="token punctuation">:</span><span class="token number">8485</span><span class="token punctuation">;</span>hadoop02<span class="token punctuation">:</span><span class="token number">8485</span><span class="token operator">/</span>mycluster<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>journalnode<span class="token punctuation">.</span>edits<span class="token punctuation">.</span><span class="token builtin">dir</span><span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> journalnode集群中用于保存edits文件的目录 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token operator">/</span>data<span class="token operator">/</span>hadoop<span class="token operator">/</span>hdfs<span class="token operator">/</span>ha<span class="token operator">/</span>jn<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>configuration<span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="hadoopenvsh_535"></a>修改hadoop-env.sh文件</h4> 
<pre><code class="prism language-python">vim hadoop<span class="token operator">-</span>env<span class="token punctuation">.</span>sh

<span class="token comment">#修改JAVA_HOME的路径</span>
export JAVA_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_391</span>  
</code></pre> 
<h4><a id="hdfsroot_544"></a><em>设置hdfs集群启动时，允许root用户启动</em></h4> 
<pre><code class="prism language-python">vim <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment">#设置hdfs集群启动时，允许root用户启动</span>
HDFS_NAMENODE_USER<span class="token operator">=</span>root
export HDFS_NAMENODE_USER
HDFS_DATANODE_USER<span class="token operator">=</span>root
export HDFS_DATANODE_USER
HDFS_JOURNALNODE_USER<span class="token operator">=</span>root
export HDFS_JOURNALNODE_USER
HDFS_ZKFC_USER<span class="token operator">=</span>root
export HDFS_ZKFC_USER

<span class="token comment"># 激活环境变量</span>
source <span class="token operator">/</span>etc<span class="token operator">/</span>profile
</code></pre> 
<h4><a id="hadoop_hdfs_563"></a>启动hadoop hdfs系统</h4> 
<pre><code class="prism language-python"><span class="token comment"># 使用集群分发命令 将 hadoop 以及 环境变量 分发至其他从机</span>
xsync <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hadoop<span class="token operator">-</span><span class="token number">3.3</span><span class="token number">.5</span>
xsync <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment"># 激活环境变量</span>
source <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment">#启动JN,格式化之前要优先启动JN,现在是两个nn，要通过JN传递数据。</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># hdfs --daemon start journalnode</span>
<span class="token punctuation">[</span>root@hadoop02 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># hdfs --daemon start journalnode</span>
<span class="token comment"># 由于没有事先创建logs文件夹,因此会自动创建</span>
<span class="token comment"># WARNING: /opt/module/hadoop-3.3.5/logs does not exist. Creating.</span>

<span class="token comment"># 格式化NN，将hadoop01作为主节点</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># hdfs namenode -format</span>

<span class="token comment"># 格式化NameNode会在指定的NameNode数据目录中创建一个名为current的子目录，用于存储NameNode的元数据和命名空间信息</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># ll /data/hadoop/hdfs/namenode/</span>
total <span class="token number">0</span>
drwx<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span> <span class="token number">2</span> root root <span class="token number">112</span> Nov <span class="token number">28</span> <span class="token number">04</span><span class="token punctuation">:</span><span class="token number">26</span> current

<span class="token comment"># hadoop02上的nn作为主备，在hadoop02执行拷贝元数据之前，需要先启动hadoop01上的namanode</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># hdfs --daemon start namenode</span>

<span class="token comment"># 拷贝元数据，在Hadoop HDFS中初始化一个备用的NameNode节点。当主要的NameNode节点出现故障时，备用的NameNode节点就可以快速启动并接管服务，而无需重新加载整个文件系统的元数据，提供高可用性。</span>
<span class="token comment"># 注意在hadoop02上执行</span>
<span class="token punctuation">[</span>root@hadoop02 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># hdfs namenode -bootstrapStandby</span>
</code></pre> 
<p><strong>在hadoop02上，执行元数据复制</strong></p> 
<p><img src="https://images2.imgbox.com/2e/d1/rMUvn4jw_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202311281047887.png"></p> 
<pre><code class="prism language-python"><span class="token comment"># 启动hadoop02上的namenode</span>
<span class="token punctuation">[</span>root@hadoop02 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># hdfs --daemon start namenode</span>

<span class="token comment"># 格式化zk，用于监控和管理Hadoop HDFS中的主备NameNode节点切换的组件。此命令会创建一个ZooKeeper目录结构，并将初始的主备NameNode节点信息存储在ZooKeeper中。这样，ZKFC就可以使用ZooKeeper来进行主备节点的管理和切换。</span>
<span class="token comment"># 在设置Hadoop HDFS的高可用性环境时，需要先使用hdfs namenode -bootstrapStandby命令初始化备用的NameNode节点，然后使用hdfs zkfc -formatZK 命令初始化ZKFC。这两个命令的组合可以确保Hadoop HDFS的主备节点切换的可靠性和高可用性。</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># hdfs zkfc -formatZK</span>

<span class="token comment"># 注意 执行上述步骤前,需要先开启zookeeper集群服务！！！</span>

<span class="token comment"># 启动zk客户端  </span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># zkCli.sh</span>

<span class="token comment"># 可以通过ls查看目录结构</span>
<span class="token punctuation">[</span>zk<span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">2181</span><span class="token punctuation">(</span>CONNECTED<span class="token punctuation">)</span> <span class="token number">5</span><span class="token punctuation">]</span> ls <span class="token operator">/</span>
<span class="token punctuation">[</span>hadoop<span class="token operator">-</span>ha<span class="token punctuation">,</span> zookeeper<span class="token punctuation">]</span>

<span class="token comment"># quit 退出客户端</span>

<span class="token comment"># 启动 datanode 或者使用下面用集群命令 start-dfs.sh 一键启动所有服务</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># hdfs --daemon start datanode</span>

<span class="token comment"># 注意：以后启动 hdfs 就只需要先启动 zookeeper，然后执行 start-dfs.sh 就可以了</span>
<span class="token comment"># 启动 zookeeper 只需要 执行 zkserver start 即可</span>

<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># start-dfs.sh</span>
Starting namenodes on <span class="token punctuation">[</span>hadoop01 hadoop02<span class="token punctuation">]</span>
Last login<span class="token punctuation">:</span> Tue Nov <span class="token number">28</span> <span class="token number">11</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token number">37</span> CST <span class="token number">2023</span> <span class="token keyword">from</span> <span class="token number">192.168</span><span class="token number">.201</span><span class="token number">.1</span> on pts<span class="token operator">/</span><span class="token number">0</span>
Starting datanodes
Last login<span class="token punctuation">:</span> Tue Nov <span class="token number">28</span> <span class="token number">11</span><span class="token punctuation">:</span><span class="token number">17</span><span class="token punctuation">:</span><span class="token number">31</span> CST <span class="token number">2023</span> on pts<span class="token operator">/</span><span class="token number">0</span>
Starting journal nodes <span class="token punctuation">[</span>hadoop02 hadoop01<span class="token punctuation">]</span>
Last login<span class="token punctuation">:</span> Tue Nov <span class="token number">28</span> <span class="token number">11</span><span class="token punctuation">:</span><span class="token number">17</span><span class="token punctuation">:</span><span class="token number">34</span> CST <span class="token number">2023</span> on pts<span class="token operator">/</span><span class="token number">0</span>
Starting ZK Failover Controllers on NN hosts <span class="token punctuation">[</span>hadoop01 hadoop02<span class="token punctuation">]</span>
Last login<span class="token punctuation">:</span> Tue Nov <span class="token number">28</span> <span class="token number">11</span><span class="token punctuation">:</span><span class="token number">18</span><span class="token punctuation">:</span><span class="token number">02</span> CST <span class="token number">2023</span> on pts<span class="token operator">/</span><span class="token number">0</span>

<span class="token comment"># 验证高可用</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># hdfs haadmin -getServiceState nn1</span>
active
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># hdfs haadmin -getServiceState nn2</span>
standby

<span class="token comment"># 如果两台都是standby，可以通过 hdfs haadmin -transitionToActive --forcemanual nn1 命令强制将nn1转换为为active</span>

<span class="token comment"># 访问页面验证 </span>
<span class="token comment"># 到浏览器访问，hadoop01:50070 (192.168.201.201:50070) 和 (hadoop01:50070) 192.168.201.202:50070 验证</span>

<span class="token comment"># 如果出现主从节点状态不正常的情况，执行以下命令</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># hdfs haadmin -failover nn2 nn1</span>
Failover to NameNode at hadoop01<span class="token operator">/</span><span class="token number">192.168</span><span class="token number">.201</span><span class="token number">.201</span><span class="token punctuation">:</span><span class="token number">9000</span> successful
</code></pre> 
<p><img src="https://images2.imgbox.com/9c/fb/SKuc9fZb_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202311281121200.png"></p> 
<h3><a id="hadoop_yarn_652"></a>编辑hadoop yarn核心配置文件</h3> 
<h4><a id="mapredsitexml_654"></a>编辑mapred-site.xml文件</h4> 
<pre><code class="prism language-python"><span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># cd /opt/module/hadoop-3.3.5/etc/hadoop/</span>

vim mapred<span class="token operator">-</span>site<span class="token punctuation">.</span>xml

<span class="token comment"># 添加以下配置</span>
<span class="token operator">&lt;</span>configuration<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>mapreduce<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>name<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>yarn<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>description<span class="token operator">&gt;</span>指定mapreduce使用yarn框架<span class="token operator">&lt;</span><span class="token operator">/</span>description<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>configuration<span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="yarnsitexml_671"></a>编辑yarn-site.xml文件</h4> 
<pre><code class="prism language-python">vim yarn<span class="token operator">-</span>site<span class="token punctuation">.</span>xml

<span class="token operator">&lt;</span>configuration<span class="token operator">&gt;</span>
<span class="token comment"># 这里是在文件包着的里面写入内容 ！！！</span>
<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> Site specific YARN configuration properties <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>nodemanager<span class="token punctuation">.</span>aux<span class="token operator">-</span>services<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>mapreduce_shuffle<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>ha<span class="token punctuation">.</span>enabled<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>description<span class="token operator">&gt;</span>是否开启高可用<span class="token operator">&lt;</span><span class="token operator">/</span>description<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>cluster<span class="token operator">-</span><span class="token builtin">id</span><span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>yrc<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>ha<span class="token punctuation">.</span>rm<span class="token operator">-</span>ids<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>rm1<span class="token punctuation">,</span>rm2<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>hostname<span class="token punctuation">.</span>rm1<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop01<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>hostname<span class="token punctuation">.</span>rm2<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop02<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> 指定 rm 的内部通信地址 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span> 
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span> 
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>address<span class="token punctuation">.</span>rm1<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>  
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop01<span class="token punctuation">:</span><span class="token number">8032</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span> 
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>  
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span> 
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>address<span class="token punctuation">.</span>rm2<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>  
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop02<span class="token punctuation">:</span><span class="token number">8032</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span> 
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span> 
	
	<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> 指定 AM 向 rm 申请资源的地址 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>  
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span> 
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>address<span class="token punctuation">.</span>rm1<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>  
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop01<span class="token punctuation">:</span><span class="token number">8030</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span> 
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>  
	
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span> 
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>address<span class="token punctuation">.</span>rm2<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>  
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop02<span class="token punctuation">:</span><span class="token number">8030</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span> 
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> 指定供 NM 连接的地址 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>  
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span> 
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>resource<span class="token operator">-</span>tracker<span class="token punctuation">.</span>address<span class="token punctuation">.</span>rm1<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>  
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop01<span class="token punctuation">:</span><span class="token number">8031</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span> 
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>  
	
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span> 
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>resource<span class="token operator">-</span>tracker<span class="token punctuation">.</span>address<span class="token punctuation">.</span>rm2<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>  
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop02<span class="token punctuation">:</span><span class="token number">8031</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span> 
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>    
	
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>zk<span class="token operator">-</span>address<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop01<span class="token punctuation">:</span><span class="token number">2181</span><span class="token punctuation">,</span>hadoop02<span class="token punctuation">:</span><span class="token number">2181</span><span class="token punctuation">,</span>hadoop03<span class="token punctuation">:</span><span class="token number">2181</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> 启用自动恢复 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>  
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span> 
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>recovery<span class="token punctuation">.</span>enabled<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>  
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span> 
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>  
	
	<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> 指定 resourcemanager 的状态信息存储在 zookeeper 集群 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>  
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span> 
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>  
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>yarn<span class="token punctuation">.</span>server<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>recovery<span class="token punctuation">.</span>ZKRMStateStore<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span> 
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span> 
	
	<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> 环境变量的继承 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>  
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span> 
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>nodemanager<span class="token punctuation">.</span>env<span class="token operator">-</span>whitelist<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>  
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>JAVA_HOME<span class="token punctuation">,</span>HADOOP_COMMON_HOME<span class="token punctuation">,</span>HADOOP_HDFS_HOME<span class="token punctuation">,</span>HADOOP_CONF_DIR<span class="token punctuation">,</span>CLAS SPATH_PREPEND_DISTCACHE<span class="token punctuation">,</span>HADOOP_YARN_HOME<span class="token punctuation">,</span>HADOOP_MAPRED_HOME<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span> 
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>configuration<span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="yarnroot_768"></a>设置yarn集群启动时，允许root用户启动</h4> 
<pre><code class="prism language-python">vim <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment">#允许root用户启动yarn集群服务</span>
YARN_RESOURCEMANAGER_USER<span class="token operator">=</span>root
export YARN_RESOURCEMANAGER_USER
YARN_NODEMANAGER_USER<span class="token operator">=</span>root
export YARN_NODEMANAGER_USER

<span class="token comment"># 激活环境变量</span>
source <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment"># 集群分发 修改后的hadoop文件</span>
xsync hadoop<span class="token operator">-</span><span class="token number">3.3</span><span class="token number">.5</span><span class="token operator">/</span>
<span class="token comment"># 集群分发 环境变量</span>
xsync <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># start-yarn.sh</span>
Starting resourcemanagers on <span class="token punctuation">[</span> hadoop01 hadoop02<span class="token punctuation">]</span>
Last login<span class="token punctuation">:</span> Tue Nov <span class="token number">28</span> <span class="token number">13</span><span class="token punctuation">:</span><span class="token number">42</span><span class="token punctuation">:</span><span class="token number">30</span> CST <span class="token number">2023</span> on pts<span class="token operator">/</span><span class="token number">0</span>
Starting nodemanagers
Last login<span class="token punctuation">:</span> Tue Nov <span class="token number">28</span> <span class="token number">13</span><span class="token punctuation">:</span><span class="token number">45</span><span class="token punctuation">:</span><span class="token number">56</span> CST <span class="token number">2023</span> on pts<span class="token operator">/</span><span class="token number">0</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># jps</span>
<span class="token number">20018</span> DataNode
<span class="token number">19443</span> NodeManager
<span class="token number">20501</span> DFSZKFailoverController
<span class="token number">20294</span> JournalNode
<span class="token number">19865</span> NameNode
<span class="token number">19274</span> ResourceManager
<span class="token number">18798</span> QuorumPeerMain
<span class="token number">20814</span> Jps

<span class="token comment"># 产生这样的原因 可能是一开始 启动zookeeper服务时导致,hadoop01不是主节点（已修改）</span>
<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment">#  yarn rmadmin -getServiceState rm1</span>
standby
<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment">#  yarn rmadmin -getServiceState rm2</span>
active

<span class="token comment">#如果某些原因yarn没有启动成功，可以单独启动</span>
yarn<span class="token operator">-</span>daemon<span class="token punctuation">.</span>sh start resourcemanager
</code></pre> 
<h3><a id="____812"></a>集群启动 推荐方式 （分步启动 可能导致主节点出现问题）</h3> 
<pre><code class="prism language-python"><span class="token comment"># 先启动 zookeeper 同步服务</span>
zkserver start

<span class="token comment"># 然后直接启动hadoop集群</span>
start<span class="token operator">-</span><span class="token builtin">all</span><span class="token punctuation">.</span>sh

<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># zkserver start</span>
start zkServer <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
ZooKeeper JMX enabled by default
Using config<span class="token punctuation">:</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>zookeeper<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.1</span><span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span>conf<span class="token operator">/</span>zoo<span class="token punctuation">.</span>cfg
Starting zookeeper <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> STARTED
ZooKeeper JMX enabled by default
Using config<span class="token punctuation">:</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>zookeeper<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.1</span><span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span>conf<span class="token operator">/</span>zoo<span class="token punctuation">.</span>cfg
Starting zookeeper <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> STARTED
ZooKeeper JMX enabled by default
Using config<span class="token punctuation">:</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>zookeeper<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.1</span><span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span>conf<span class="token operator">/</span>zoo<span class="token punctuation">.</span>cfg
Starting zookeeper <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> STARTED
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># start-all.sh</span>
Starting namenodes on <span class="token punctuation">[</span>hadoop01 hadoop02<span class="token punctuation">]</span>
Last login<span class="token punctuation">:</span> Tue Nov <span class="token number">28</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">45</span><span class="token punctuation">:</span><span class="token number">58</span> CST <span class="token number">2023</span> <span class="token keyword">from</span> <span class="token number">192.168</span><span class="token number">.201</span><span class="token number">.1</span> on pts<span class="token operator">/</span><span class="token number">0</span>
Starting datanodes
Last login<span class="token punctuation">:</span> Tue Nov <span class="token number">28</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">47</span><span class="token punctuation">:</span><span class="token number">02</span> CST <span class="token number">2023</span> on pts<span class="token operator">/</span><span class="token number">0</span>
Starting journal nodes <span class="token punctuation">[</span>hadoop02 hadoop01<span class="token punctuation">]</span>
Last login<span class="token punctuation">:</span> Tue Nov <span class="token number">28</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">47</span><span class="token punctuation">:</span><span class="token number">05</span> CST <span class="token number">2023</span> on pts<span class="token operator">/</span><span class="token number">0</span>
Starting ZK Failover Controllers on NN hosts <span class="token punctuation">[</span>hadoop01 hadoop02<span class="token punctuation">]</span>
Last login<span class="token punctuation">:</span> Tue Nov <span class="token number">28</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">47</span><span class="token punctuation">:</span><span class="token number">11</span> CST <span class="token number">2023</span> on pts<span class="token operator">/</span><span class="token number">0</span>
Starting resourcemanagers on <span class="token punctuation">[</span> hadoop01 hadoop02<span class="token punctuation">]</span>
Last login<span class="token punctuation">:</span> Tue Nov <span class="token number">28</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">47</span><span class="token punctuation">:</span><span class="token number">16</span> CST <span class="token number">2023</span> on pts<span class="token operator">/</span><span class="token number">0</span>
Starting nodemanagers
Last login<span class="token punctuation">:</span> Tue Nov <span class="token number">28</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">47</span><span class="token punctuation">:</span><span class="token number">23</span> CST <span class="token number">2023</span> on pts<span class="token operator">/</span><span class="token number">0</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># jps</span>
<span class="token number">3779</span> ResourceManager
<span class="token number">4195</span> Jps
<span class="token number">3941</span> NodeManager
<span class="token number">2390</span> QuorumPeerMain
<span class="token number">2663</span> NameNode
<span class="token number">3113</span> JournalNode
<span class="token number">2827</span> DataNode
<span class="token number">3340</span> DFSZKFailoverController
</code></pre> 
<p>启动查看命令 ： hadoop01:8088 hadoop01:50070</p> 
<p>至此hadoop ha 高可用集群已搭建完毕，可以尝试进行中断任一节点的服务，然后刷新web浏览器，即可查看状态进行切换为active状态，检测完后可以重新开启</p> 
<pre><code class="prism language-python">kill <span class="token operator">-</span><span class="token number">9</span> <span class="token number">2663</span> <span class="token punctuation">(</span>namenode 节点对应的 进程<span class="token builtin">id</span><span class="token punctuation">)</span>
<span class="token comment"># 在浏览器上多刷新几次 并且打开 hadoop02:50070 查看状态</span>
<span class="token comment"># 重新开启 namenode 节点 </span>
hdfs <span class="token operator">-</span><span class="token operator">-</span>daemon start namenode  
</code></pre> 
<p>hadoop01:50070</p> 
<p><img src="https://images2.imgbox.com/a6/4f/30I2eP9p_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202312040955705.png"></p> 
<p>hadoop02:50070</p> 
<p><img src="https://images2.imgbox.com/09/cd/9AiL06S2_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202312040956878.png"></p> 
<p>hadoop01:8088 (输入hadoop02:8088 时，会切换至hadoop01:8088)</p> 
<p>因为 ha 机制 同时刻 只允许一个 yarn 服务状态为active ，否则会出现 脑裂 （split-brain）</p> 
<p><img src="https://images2.imgbox.com/de/64/hJLpSFQd_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202312040959786.png"></p> 
<h2><a id="spark_881"></a>五、spark集群搭建</h2> 
<h3><a id="_883"></a>主机环境配置</h3> 
<pre><code class="prism language-python">cd <span class="token operator">/</span>opt<span class="token operator">/</span>software<span class="token operator">/</span>

tar <span class="token operator">-</span>zxvf spark<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.4</span><span class="token operator">-</span><span class="token builtin">bin</span><span class="token operator">-</span>hadoop3<span class="token punctuation">.</span><span class="token number">2</span><span class="token operator">-</span>scala2<span class="token punctuation">.</span><span class="token number">13</span><span class="token punctuation">.</span>tgz <span class="token operator">-</span>C <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>

cd <span class="token operator">/</span>opt<span class="token operator">/</span>module

mv spark<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.4</span><span class="token operator">-</span><span class="token builtin">bin</span><span class="token operator">-</span>hadoop3<span class="token punctuation">.</span><span class="token number">2</span><span class="token operator">-</span>scala2<span class="token punctuation">.</span><span class="token number">13</span><span class="token operator">/</span> spark<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.4</span><span class="token operator">/</span>

<span class="token comment"># 配置 spark 环境变量</span>
vim <span class="token operator">/</span>etc<span class="token operator">/</span>profile

export SPARK_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>spark<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.4</span>
export PATH<span class="token operator">=</span>$PATH<span class="token punctuation">:</span>$SPARK_HOME<span class="token operator">/</span><span class="token builtin">bin</span>

<span class="token comment"># 激活环境变量</span>
source <span class="token operator">/</span>etc<span class="token operator">/</span>profile
</code></pre> 
<h3><a id="spark__904"></a>配置spark 核心文件</h3> 
<h4><a id="_sparkenvsh__906"></a>编辑 spark-env.sh 文件</h4> 
<pre><code class="prism language-python">cd <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>spark<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.4</span><span class="token operator">/</span>conf<span class="token operator">/</span>

mv spark<span class="token operator">-</span>env<span class="token punctuation">.</span>sh<span class="token punctuation">.</span>template spark<span class="token operator">-</span>env<span class="token punctuation">.</span>sh

vim spark<span class="token operator">-</span>env<span class="token punctuation">.</span>sh

export JAVA_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_391</span>
export HADOOP_CONF_DIR<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hadoop<span class="token operator">-</span><span class="token number">3.3</span><span class="token number">.5</span><span class="token operator">/</span>etc<span class="token operator">/</span>hadoop<span class="token operator">/</span>
export YARN_CONF_DIR<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hadoop<span class="token operator">-</span><span class="token number">3.3</span><span class="token number">.5</span><span class="token operator">/</span>etc<span class="token operator">/</span>hadoop<span class="token operator">/</span>
export SPARK_MASTER_IP<span class="token operator">=</span>hadoop01
export SPARK_MASTER_PORT<span class="token operator">=</span><span class="token number">7077</span>
export SPARK_MASTER_WEBUI_PORT<span class="token operator">=</span><span class="token number">8090</span>
export SPARK_WORKER_WEBUI_PORT<span class="token operator">=</span><span class="token number">8091</span>
export SPARK_DAEMON_JAVA_OPTS<span class="token operator">=</span><span class="token string">"-Dspark.deploy.recoveryMode=ZOOKEEPER -Dspark.deploy.zookeeper.url=hadoop01:2181,hadoop02:2181,hadoop03:2181 -Dspark.deploy.zookeeper.dir=/opt/module/zookeeper-3.7.1"</span>

</code></pre> 
<aside>
  💡 说明: JAVA_HOEM：设置Java安装目录的路径 HADOOP_CONF_DIR：设置Hadoop的配置目录路径 YARN_CONF_DIR：设置YARN的配置目录路径，YARN是Hadoop的资源管理器 SPARK_MASTER_IP：设置Spark主节点的IP地址或主机名。Spark主节点负责协调集群中的各个工作节点。 SPARK_MASTER_PORT：设置Spark主节点的端口号。通过该端口，工作节点可以与Spark主节点进行通信。 SPARK_MASTER_WEBUI_PORT：设置Spark主节点的Web界面端口号。可以通过该端口访问Spark主节点的Web界面。 SPARK_WORKER_WEBUI_PORT：设置Spark工作节点的Web界面端口号。可以通过该端口访问Spark工作节点的Web界面。 
</aside> 
<h4><a id="_workers__938"></a>编辑 workers 文件</h4> 
<pre><code class="prism language-python">mv workers<span class="token punctuation">.</span>template workers

vim workers

<span class="token comment"># 修改为以下内容</span>
hadoop01
hadoop02
hadoop03
</code></pre> 
<h3><a id="spark___951"></a>spark 集群 测试</h3> 
<h4><a id="_spark__953"></a>启动 spark 测试</h4> 
<pre><code class="prism language-python"><span class="token comment"># 将 hadoop 相关配置文件 复制到 spark </span>
cd <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hadoop<span class="token operator">-</span><span class="token number">3.3</span><span class="token number">.5</span><span class="token operator">/</span>etc<span class="token operator">/</span>hadoop

cp core<span class="token operator">-</span>site<span class="token punctuation">.</span>xml hdfs<span class="token operator">-</span>site<span class="token punctuation">.</span>xml <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>spark<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.4</span><span class="token operator">/</span>conf<span class="token operator">/</span>

<span class="token comment"># 同步 spark 文件目录</span>
xsync <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>spark<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.4</span>
<span class="token comment"># 同步 环境变量</span>
xsync <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment">#在 hadoop02 上配置备用 master 节点</span>
<span class="token punctuation">[</span>root@hadoop02 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># vim /opt/module/spark-3.2.4/conf/spark-env.sh</span>
<span class="token comment">#将 export SPARK_MASTER_IP=hadoop01  改为</span>
export SPARK_MASTER_IP<span class="token operator">=</span>hadoop02

<span class="token comment"># 没有 vim 编辑器 需要使用 yum 下载</span>
yum install <span class="token operator">-</span>y vim

<span class="token comment">#由于启动命令和hadoop下的命令文件名一样，我们需要cd到spark目录下执行</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># cd /opt/module/spark-3.2.4/sbin</span>
<span class="token punctuation">[</span>root@hadoop01 sbin<span class="token punctuation">]</span><span class="token comment"># ./start-all.sh</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token punctuation">[</span>root@hadoop01 sbin<span class="token punctuation">]</span><span class="token comment"># jps</span>
<span class="token number">3779</span> ResourceManager
<span class="token number">3941</span> NodeManager
<span class="token number">2390</span> QuorumPeerMain
<span class="token number">7078</span> Worker
<span class="token number">2663</span> NameNode
<span class="token number">6952</span> Master
<span class="token number">3113</span> JournalNode
<span class="token number">2827</span> DataNode
<span class="token number">3340</span> DFSZKFailoverController
<span class="token number">7245</span> Jps

<span class="token comment"># 在 hadoop02 上 开启 备用 Master 节点</span>
<span class="token punctuation">[</span>root@hadoop02 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># cd /opt/module/spark-3.2.4/sbin</span>
<span class="token punctuation">[</span>root@hadoop02 sbin<span class="token punctuation">]</span><span class="token comment"># ./start-master.sh</span>

<span class="token comment">#jps查看hadoop01 和 hadoop02 上都有Master，hadoop03节点有Worker</span>
</code></pre> 
<p>浏览器访问 hadoop01:8090 可以看到上面状态 <strong>Status:</strong> ALIVE</p> 
<p><img src="https://images2.imgbox.com/c8/01/yFLDumsu_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202311281558360.png"></p> 
<p>浏览器访问 hadoop02:8090 可以看到上面状态 <strong>Status:</strong> STANDBY</p> 
<p><img src="https://images2.imgbox.com/37/4b/FzlHMoBj_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202311281559515.png"></p> 
<h4><a id="_master__1007"></a>中断 master 切换测试</h4> 
<pre><code class="prism language-python"><span class="token comment"># 强制中断 Master 服务</span>
<span class="token punctuation">[</span>root@hadoop01 sbin<span class="token punctuation">]</span><span class="token comment"># jps</span>
<span class="token number">3779</span> ResourceManager
<span class="token number">3941</span> NodeManager
<span class="token number">7445</span> Jps
<span class="token number">2390</span> QuorumPeerMain
<span class="token number">7078</span> Worker
<span class="token number">2663</span> NameNode
<span class="token number">6952</span> Master
<span class="token number">3113</span> JournalNode
<span class="token number">2827</span> DataNode
<span class="token number">3340</span> DFSZKFailoverController
<span class="token punctuation">[</span>root@hadoop01 sbin<span class="token punctuation">]</span><span class="token comment"># kill -9 6952</span>
</code></pre> 
<p>刷新页面，hadoop01:8090 已经访问不到了，我们在访问 hadoop02:8090时，多刷新几次，可以看到 master 已经切换到hadoop02</p> 
<p><img src="https://images2.imgbox.com/52/b7/N1e0PpwB_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202311281606174.png"></p> 
<pre><code class="prism language-python"><span class="token comment"># 在 hadoop01 上 重新启动 Master 服务</span>
<span class="token punctuation">.</span><span class="token operator">/</span>start<span class="token operator">-</span>master<span class="token punctuation">.</span>sh
<span class="token comment"># 然后 重新执行 开启 hadoop02 上的 备用 Master 进程 </span>

<span class="token comment"># 此时 发现 hadoop01 上的 状态回到了 active 状态, 而 hadoop02 为 standby 状态</span>
</code></pre> 
<h4><a id="_spark__1037"></a>启动 spark 计算服务测试</h4> 
<pre><code class="prism language-python"><span class="token comment"># 使用 spark 计算 pi </span>
<span class="token punctuation">[</span>root@hadoop01 sbin<span class="token punctuation">]</span><span class="token comment"># spark-submit --class org.apache.spark.examples.SparkPi --master yarn --deploy-mode cluster /opt/module/spark-3.2.4/examples/jars/spark-examples_2.13-3.2.4.jar</span>
</code></pre> 
<ul><li>代码解释： 
  <ul><li>spark-submit: 是用于提交 Spark 应用程序的命令行工具。</li><li>–class org.apache.spark.examples.SparkPi: 指定要运行的 Spark 应用程序的主类，这里是 SparkPi 示例应用程序。这是一个计算 π 值的简单 Spark 应用程序。</li><li>–master yarn: 指定 Spark 应用程序运行的主节点（master）。在这里，yarn 表示使用 YARN 作为集群管理器。</li><li>–deploy-mode cluster: 指定 Spark 应用程序的部署模式，cluster 表示在集群上运行。在这种模式下，驱动程序（Driver）会在集群中的某个节点上启动，而不是在提交命令的本地机器上启动。</li><li>/opt/module/spark-3.2.4/examples/jars/spark-examples_2.13-3.2.4.jar : 这是 Spark 应用程序的 JAR 文件的路径，其中包含了 Spark 应用程序的代码和依赖。在这里，SparkPi 示例的 JAR 文件路径。</li><li>完整解释是 使用 spark-submit 提交一个 Spark 应用程序，这个应用程序的主类是 org.apache.spark.examples.SparkPi，在 YARN 集群上以 cluster 模式运行，其代码和依赖位于 /opt/module/spark-3.2.4/examples/jars/spark-examples_2.13-3.2.4.jar 这个 JAR 文件中。</li></ul> </li></ul> 
<p><img src="https://images2.imgbox.com/91/50/CDrXtJpP_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202311281625090.png"></p> 
<pre><code class="prism language-python"><span class="token comment"># 可以在 hadoop01:8088 上查看 运行状态 以及 日志信息 等</span>
</code></pre> 
<h3><a id="__yarn___1058"></a>配置 yarn 历史服务器</h3> 
<h4><a id="hadoop_mapredsitexml_1060"></a>配置hadoop mapred-site.xml</h4> 
<pre><code class="prism language-python">cd <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hadoop<span class="token operator">-</span><span class="token number">3.3</span><span class="token number">.5</span><span class="token operator">/</span>etc<span class="token operator">/</span>hadoop<span class="token operator">/</span>

vim mapred<span class="token operator">-</span>site<span class="token punctuation">.</span>xml

<span class="token comment"># 添加以下配置项</span>
		<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>Spark on Yarn<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>mapreduce<span class="token punctuation">.</span>jobhistory<span class="token punctuation">.</span>address<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop01<span class="token punctuation">:</span><span class="token number">10020</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>mapreduce<span class="token punctuation">.</span>jobhistory<span class="token punctuation">.</span>webapp<span class="token punctuation">.</span>address<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop01<span class="token punctuation">:</span><span class="token number">19888</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="hadoop_yarnsitexml_1080"></a>配置hadoop yarn-site.xml</h4> 
<pre><code class="prism language-python">vim yarn<span class="token operator">-</span>site<span class="token punctuation">.</span>xml

<span class="token comment"># 添加以下配置项</span>
				<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>Spark on Yarn<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> 是否开启聚合日志 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>log<span class="token operator">-</span>aggregation<span class="token operator">-</span>enable<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> 配置日志服务器的地址 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>log<span class="token punctuation">.</span>server<span class="token punctuation">.</span>url<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>http<span class="token punctuation">:</span><span class="token operator">//</span>hadoop01<span class="token punctuation">:</span><span class="token number">19888</span><span class="token operator">/</span>jobhistory<span class="token operator">/</span>logs<span class="token operator">/</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> 配置日志过期时间<span class="token punctuation">,</span>单位秒 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>log<span class="token operator">-</span>aggregation<span class="token punctuation">.</span>retain<span class="token operator">-</span>seconds<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">86400</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="__spark__1106"></a>同步文件到其他主机 以及 spark 配置中</h4> 
<pre><code class="prism language-python"><span class="token comment"># 同步至其他主机的 hadoop 文件目录中</span>
<span class="token punctuation">[</span>root@hadoop01 hadoop<span class="token punctuation">]</span><span class="token comment"># xsync mapred-site.xml yarn-site.xml</span>

<span class="token comment"># 复制文件 并 同步至 其他主机的 spark 文件目录中</span>
<span class="token punctuation">[</span>root@hadoop01 hadoop<span class="token punctuation">]</span><span class="token comment"># cp mapred-site.xml yarn-site.xml /opt/module/spark-3.2.4/conf/</span>
<span class="token punctuation">[</span>root@hadoop01 hadoop<span class="token punctuation">]</span><span class="token comment"># xsync /opt/module/spark-3.2.4/conf/</span>
</code></pre> 
<h3><a id="_spark___1117"></a>配置 spark 历史服务器</h3> 
<h4><a id="_spark_sparkdefaultsconf_1119"></a>配置 spark spark-defaults.conf文件</h4> 
<pre><code class="prism language-python">cd <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>spark<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.4</span><span class="token operator">/</span>conf<span class="token operator">/</span>

<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># mv spark-defaults.conf.template spark-defaults.conf</span>

vim spark<span class="token operator">-</span>defaults<span class="token punctuation">.</span>conf

<span class="token comment"># 添加或者放开注释并修改</span>
spark<span class="token punctuation">.</span>eventLog<span class="token punctuation">.</span>enabled              true
spark<span class="token punctuation">.</span>eventLog<span class="token punctuation">.</span>compress             true
spark<span class="token punctuation">.</span>eventLog<span class="token punctuation">.</span><span class="token builtin">dir</span>                  hdfs<span class="token punctuation">:</span><span class="token operator">//</span>mycluster<span class="token operator">/</span>spark<span class="token operator">-</span>logs
spark<span class="token punctuation">.</span>yarn<span class="token punctuation">.</span>historyServer<span class="token punctuation">.</span>address    hadoop01<span class="token punctuation">:</span><span class="token number">18080</span><span class="token punctuation">,</span>hadoop02<span class="token punctuation">:</span><span class="token number">18080</span>
spark<span class="token punctuation">.</span>history<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>port               <span class="token number">18080</span>
spark<span class="token punctuation">.</span>history<span class="token punctuation">.</span>fs<span class="token punctuation">.</span>logDirectory       hdfs<span class="token punctuation">:</span><span class="token operator">//</span>mycluster<span class="token operator">/</span>spark<span class="token operator">-</span>logs
spark<span class="token punctuation">.</span>history<span class="token punctuation">.</span>retainedApplications  <span class="token number">30</span>
</code></pre> 
<ul><li>文件说明： 
  <ul><li>spark.eventLog.enabled 设置为 true 表示启用Spark事件日志记录功能。</li><li>spark.eventLog.compress 指定Spark事件日志是否需要进行压缩</li><li>spark.eventLog.dir 指定了事件日志的存储路径</li><li>spark.yarn.historyServer.address 指定了YARN历史服务器的地址</li><li>spark.history.ui.port 指定了Spark历史服务器UI的端口号</li><li>spark.history.fs.logDirectory 指定了历史记录文件在文件系统中的存储路径</li><li>spark.history.retainedApplications 指定了历史服务器要保留的应用程序数量，设置为 30，表示历史服务器将保留最近提交的30个应用程序的历史记录。</li></ul> </li></ul> 
<h4><a id="_1148"></a>同步文件到其他主机</h4> 
<pre><code class="prism language-python"><span class="token comment"># 同步至 其他主机的 spark 文件目录中</span>
<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># xsync spark-defaults.conf</span>
<span class="token comment"># 删除 其他主机的 spark-defaults.conf文件</span>
<span class="token punctuation">[</span>root@hadoop02 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># rm -rf /opt/module/spark-3.2.4/conf/spark-defaults.conf.template</span>
</code></pre> 
<h4><a id="_1157"></a>重新开启集群测试</h4> 
<pre><code class="prism language-python"><span class="token comment">#创建时间日志的存储路径，需要在启动历史服务器之前创建，不然报错找不到路径或文件</span>
<span class="token punctuation">[</span>root@hadoop01 sbin<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -mkdir /spark-logs</span>

<span class="token comment"># hadoop01 上执行</span>
zkserver start
start<span class="token operator">-</span><span class="token builtin">all</span><span class="token punctuation">.</span>sh

mapred <span class="token operator">-</span><span class="token operator">-</span>daemon start historyserver

$SPARK_HOME<span class="token operator">/</span>sbin<span class="token operator">/</span>start<span class="token operator">-</span><span class="token builtin">all</span><span class="token punctuation">.</span>sh
$SPARK_HOME<span class="token operator">/</span>sbin<span class="token operator">/</span>start<span class="token operator">-</span>history<span class="token operator">-</span>server<span class="token punctuation">.</span>sh

<span class="token comment"># hadoop02 上执行</span>
$SPARK_HOME<span class="token operator">/</span>sbin<span class="token operator">/</span>start<span class="token operator">-</span>master<span class="token punctuation">.</span>sh
$SPARK_HOME<span class="token operator">/</span>sbin<span class="token operator">/</span>start<span class="token operator">-</span>history<span class="token operator">-</span>server<span class="token punctuation">.</span>sh
</code></pre> 
<p>hadoop01:18080</p> 
<p><img src="https://images2.imgbox.com/c2/0b/ovkyQgRB_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202311282050798.png"></p> 
<p>hadoop01:19888 (logs 日志 在 hadoop01:8088 页面点击 logs 跳转)</p> 
<p><img src="https://images2.imgbox.com/80/4d/HCs5UyMA_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202311282051236.png"></p> 
<p>hadoop01:19888</p> 
<p><img src="https://images2.imgbox.com/a2/c2/OadqJLBr_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202311282056316.png"></p> 
<aside>
  💡 如果 出现 类似 这样的问题 http://hadoop01:8088/proxy/application_1701174521692_0001/ 点击之后 ，报错的 是因为 那个日志 是通过代理 到 对应的 集群上 保存的 proxy 就是代理的原因，在spark 的history 日志里面 有相关的日志 http://hadoop01:18080/history/application_1701174521692_0001/1/jobs/ 
</aside> 
<h2><a id="hbase_1196"></a>六、hbase集群搭建</h2> 
<h3><a id="_1198"></a>主机环境配置</h3> 
<pre><code class="prism language-python">cd <span class="token operator">/</span>opt<span class="token operator">/</span>software<span class="token operator">/</span>

tar <span class="token operator">-</span>zxvf hbase<span class="token operator">-</span><span class="token number">2.4</span><span class="token number">.17</span><span class="token operator">-</span><span class="token builtin">bin</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">-</span>C <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>

cd <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>

<span class="token comment"># 配置 hbase 环境变量</span>
vim <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment"># HBase环境变量</span>
export HBASE_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hbase<span class="token operator">-</span><span class="token number">2.4</span><span class="token number">.17</span>
export PATH<span class="token operator">=</span>$PATH<span class="token punctuation">:</span>$HBASE_HOME<span class="token operator">/</span><span class="token builtin">bin</span>

<span class="token comment"># 激活环境变量</span>
source <span class="token operator">/</span>etc<span class="token operator">/</span>profile
</code></pre> 
<h3><a id="hbase__1218"></a>配置hbase 核心文件</h3> 
<h4><a id="hbaseenvsh__1220"></a>配置hbase-env.sh 文件</h4> 
<pre><code class="prism language-python">cd <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hbase<span class="token operator">-</span><span class="token number">2.4</span><span class="token number">.17</span><span class="token operator">/</span>conf<span class="token operator">/</span>

vim hbase<span class="token operator">-</span>env<span class="token punctuation">.</span>sh
<span class="token comment"># 修改以下内容</span>

export JAVA_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_391</span>
<span class="token comment">#保存pid文件</span>
export HBASE_PID_DIR<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hbase<span class="token operator">-</span><span class="token number">2.4</span><span class="token number">.17</span><span class="token operator">/</span>pids
<span class="token comment">#禁用HBase自带的Zookeeper，因为我们是使用独立的Zookeeper</span>
export HBASE_MANAGES_ZK<span class="token operator">=</span>false
</code></pre> 
<h4><a id="hbasesitexml__1235"></a>配置hbase-site.xml 文件</h4> 
<pre><code class="prism language-python">vim hbase<span class="token operator">-</span>site<span class="token punctuation">.</span>xml

<span class="token comment"># 将原有的配置信息 进行删除 添加以下配置项</span>

<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> 设置HRegionServers共享目录 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hbase<span class="token punctuation">.</span>rootdir<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hdfs<span class="token punctuation">:</span><span class="token operator">//</span>mycluster<span class="token operator">/</span>hbase<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
  
  <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hbase<span class="token punctuation">.</span>master<span class="token punctuation">.</span>info<span class="token punctuation">.</span>port<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">60010</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
  
  <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> 启用分布式模式 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hbase<span class="token punctuation">.</span>cluster<span class="token punctuation">.</span>distributed<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
  
  <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> 指定Zookeeper集群位置 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hbase<span class="token punctuation">.</span>zookeeper<span class="token punctuation">.</span>quorum<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop01<span class="token punctuation">:</span><span class="token number">2181</span><span class="token punctuation">,</span>hadoop02<span class="token punctuation">:</span><span class="token number">2181</span><span class="token punctuation">,</span>hadoop03<span class="token punctuation">:</span><span class="token number">2181</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
  
  <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> 指定独立Zookeeper安装路径 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hbase<span class="token punctuation">.</span>zookeeper<span class="token punctuation">.</span><span class="token builtin">property</span><span class="token punctuation">.</span>dataDir<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>zookeeper<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.1</span><span class="token operator">/</span>data<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
  
  <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> 指定ZooKeeper集群端口 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hbase<span class="token punctuation">.</span>zookeeper<span class="token punctuation">.</span><span class="token builtin">property</span><span class="token punctuation">.</span>clientPort<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">2181</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
  
  <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hbase<span class="token punctuation">.</span>tmp<span class="token punctuation">.</span><span class="token builtin">dir</span><span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hbase<span class="token operator">-</span><span class="token number">2.4</span><span class="token number">.17</span><span class="token operator">/</span>tmp<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
  
  <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>HBase将按照正常的写入路径进行处理与检查<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hbase<span class="token punctuation">.</span>unsafe<span class="token punctuation">.</span>stream<span class="token punctuation">.</span>capability<span class="token punctuation">.</span>enforce<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>false<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
  
  <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hbase<span class="token punctuation">.</span>wal<span class="token punctuation">.</span>provider<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>filesystem<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="regionservers__1294"></a>配置regionservers 文件</h4> 
<pre><code class="prism language-python">vim regionservers

<span class="token comment"># 修改为 以下信息</span>
hadoop01
hadoop02
hadoop03
</code></pre> 
<h4><a id="_1305"></a>复制配置文件</h4> 
<pre><code class="prism language-python"><span class="token comment"># 复制 hadoop 配置到 hbase 目录下</span>
cd <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hadoop<span class="token operator">-</span><span class="token number">3.3</span><span class="token number">.5</span><span class="token operator">/</span>etc<span class="token operator">/</span>hadoop<span class="token operator">/</span> 

cp core<span class="token operator">-</span>site<span class="token punctuation">.</span>xml hdfs<span class="token operator">-</span>site<span class="token punctuation">.</span>xml <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hbase<span class="token operator">-</span><span class="token number">2.4</span><span class="token number">.17</span><span class="token operator">/</span>conf<span class="token operator">/</span>

<span class="token comment"># 将 hbase 文件 同步到其他主机</span>
cd <span class="token operator">/</span>opt<span class="token operator">/</span>module
xsync hbase<span class="token operator">-</span><span class="token number">2.4</span><span class="token number">.17</span><span class="token operator">/</span>
xsync <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment"># 分别在 hadoop02 和 hadoop03 上 执行以下代码 激活环境变量</span>
source <span class="token operator">/</span>etc<span class="token operator">/</span>profile
</code></pre> 
<h3><a id="hbase_1322"></a>启动hbase集群</h3> 
<pre><code class="prism language-python"><span class="token comment"># 查看那个是主节点 (hadoop01 还是 hadoop02) 然后执行 集群启动命令 </span>
<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># hdfs haadmin -getServiceState nn1</span>
active
<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># start-hbase.sh</span>

<span class="token comment"># 然后在另外一个备份节点上执行 </span>
hbase<span class="token operator">-</span>daemon<span class="token punctuation">.</span>sh start master
</code></pre> 
<p>查看集群web界面 ： master : <strong>hadoop01:60010</strong> backup master **** : <strong>hadoop02:60010</strong></p> 
<p><img src="https://images2.imgbox.com/4b/08/YJMz4eKJ_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202312012227250.png"></p> 
<h3><a id="shell__1338"></a>简单测试shell 命令</h3> 
<pre><code class="prism language-python"><span class="token comment"># 任意节点进行</span>
<span class="token punctuation">[</span>root@hadoop03 <span class="token builtin">bin</span><span class="token punctuation">]</span><span class="token comment"># hbase shell</span>
SLF4J<span class="token punctuation">:</span> Class <span class="token class-name">path</span> contains multiple SLF4J bindings<span class="token punctuation">.</span>
SLF4J<span class="token punctuation">:</span> Found binding <span class="token keyword">in</span> <span class="token punctuation">[</span>jar<span class="token punctuation">:</span><span class="token builtin">file</span><span class="token punctuation">:</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hadoop<span class="token operator">-</span><span class="token number">3.3</span><span class="token number">.5</span><span class="token operator">/</span>share<span class="token operator">/</span>hadoop<span class="token operator">/</span>common<span class="token operator">/</span>lib<span class="token operator">/</span>slf4j<span class="token operator">-</span>reload4j<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.36</span><span class="token punctuation">.</span>jar!<span class="token operator">/</span>org<span class="token operator">/</span>slf4j<span class="token operator">/</span>impl<span class="token operator">/</span>StaticLoggerBinder<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">]</span>
SLF4J<span class="token punctuation">:</span> Found binding <span class="token keyword">in</span> <span class="token punctuation">[</span>jar<span class="token punctuation">:</span><span class="token builtin">file</span><span class="token punctuation">:</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hbase<span class="token operator">-</span><span class="token number">2.4</span><span class="token number">.17</span><span class="token operator">/</span>lib<span class="token operator">/</span>client<span class="token operator">-</span>facing<span class="token operator">-</span>thirdparty<span class="token operator">/</span>slf4j<span class="token operator">-</span>reload4j<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.33</span><span class="token punctuation">.</span>jar!<span class="token operator">/</span>org<span class="token operator">/</span>slf4j<span class="token operator">/</span>impl<span class="token operator">/</span>StaticLoggerBinder<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">]</span>
SLF4J<span class="token punctuation">:</span> See http<span class="token punctuation">:</span><span class="token operator">//</span>www<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>org<span class="token operator">/</span>codes<span class="token punctuation">.</span>html<span class="token comment">#multiple_bindings for an explanation.</span>
SLF4J<span class="token punctuation">:</span> Actual binding <span class="token keyword">is</span> of <span class="token builtin">type</span> <span class="token punctuation">[</span>org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>Reload4jLoggerFactory<span class="token punctuation">]</span>
HBase Shell
Use <span class="token string">"help"</span> to get <span class="token builtin">list</span> of supported commands<span class="token punctuation">.</span>
Use <span class="token string">"exit"</span> to quit this interactive shell<span class="token punctuation">.</span>
For Reference<span class="token punctuation">,</span> please visit<span class="token punctuation">:</span> http<span class="token punctuation">:</span><span class="token operator">//</span>hbase<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>org<span class="token operator">/</span><span class="token number">2.0</span><span class="token operator">/</span>book<span class="token punctuation">.</span>html<span class="token comment">#shell</span>
Version <span class="token number">2.4</span><span class="token number">.17</span><span class="token punctuation">,</span> r7fd096f39b4284da9a71da3ce67c48d259ffa79a<span class="token punctuation">,</span> Fri Mar <span class="token number">31</span> <span class="token number">18</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token number">45</span> UTC <span class="token number">2023</span>
Took <span class="token number">0.0027</span> seconds                                                                                                                                                             
hbase<span class="token punctuation">:</span><span class="token number">001</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token operator">&gt;</span> version    <span class="token comment"># 输入 version </span>
<span class="token number">2.4</span><span class="token number">.17</span><span class="token punctuation">,</span> r7fd096f39b4284da9a71da3ce67c48d259ffa79a<span class="token punctuation">,</span> Fri Mar <span class="token number">31</span> <span class="token number">18</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token number">45</span> UTC <span class="token number">2023</span>
Took <span class="token number">0.0004</span> seconds

<span class="token comment"># exit 退出 </span>

<span class="token comment"># 由于本笔记目的是为了进行项目配置,暂不涉及更多的集群</span>
</code></pre> 
<h2><a id="mysql_1363"></a>七、mysql数据库集群搭建</h2> 
<h3><a id="mariadb_1365"></a><strong><strong>卸载系统自带的mariadb</strong></strong></h3> 
<pre><code class="prism language-python"><span class="token comment"># 查看并卸载系统的mariadb软件</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># rpm -qa | grep mariadb</span>
mariadb<span class="token operator">-</span>libs<span class="token operator">-</span><span class="token number">5.5</span><span class="token number">.68</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span>el7<span class="token punctuation">.</span>x86_64

<span class="token comment"># 卸载mariadb</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># rpm -e --nodeps mariadb-libs-5.5.68-1.el7.x86_64</span>
<span class="token comment"># 因为centos7内部集成了mariadb，而安装mysql的话会和mariadb的文件冲突，所以需要先卸载掉mariadb</span>

<span class="token comment"># 查询还有没有 mariadb 和 mysql </span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># rpm -qa | grep mariadb</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># rpm -qa | grep mysql</span>

<span class="token comment"># 创建mysql用户并禁止登录 (系统用户 不会生成 home 目录等 其他文件信息)</span>
<span class="token comment"># 该用户将拥有系统权限，但不会有与家目录相关的文件和配置。 MySQL 的运行文件、日志文件等通常会有专门的目录，并不依赖于 MySQL 用户的家目录。</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># useradd mysql -s /sbin/nologin</span>
<span class="token comment"># 通常用于系统上运行服务的用户，这些用户的目的是为了执行服务而不是人为的交互。例如，MySQL 服务通常以一个专门的用户（例如 mysql）的身份运行，这个用户的 shell 被设置为 /sbin/nologin，以防止不必要的登录。这样可以增加系统的安全性，因为攻击者无法直接通过登录该用户来执行交互式命令。</span>
</code></pre> 
<aside>
  💡 在搭建 Hadoop 生态系统中，通常不会使用 MySQL 的 **`root`** 用户作为 Hive Metastore 的连接用户。应该为 Hive Metastore 创建一个专门的用户，并使用该用户来连接到 MySQL 数据库，从而提高安全性并根据最小权限原则进行用户管理。 
</aside> 
<h3><a id="mysql_1391"></a>安装mysql</h3> 
<pre><code class="prism language-python"><span class="token comment"># 解压</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># tar -zxvf /opt/software/mysql-5.7.35-el7-x86_64.tar.gz -C /opt/module/</span>

<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># cd /opt/module/</span>

<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># mv mysql-5.7.35-el7-x86_64/ mysql-5.7.35</span>

<span class="token comment"># 创建mysql数据目录以及配置目录</span>
<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># mkdir mysql-5.7.35/{data,conf,logs,binlog}</span>

<span class="token comment"># 添加系统环境变量</span>
vim <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment"># mysql 环境变量</span>
export MYSQL_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span>
export PATH<span class="token operator">=</span>$PATH<span class="token punctuation">:</span>$MYSQL_HOME<span class="token operator">/</span><span class="token builtin">bin</span>
</code></pre> 
<h3><a id="mysql_1412"></a>配置mysql</h3> 
<pre><code class="prism language-python"><span class="token comment"># 创建mysql配置文件</span>
<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># cd mysql-5.7.35/conf/</span>

<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># vim my.cnf  (不能改成别的名字)</span>

<span class="token comment"># 客户端配置，包括客户端连接mysql服务器的相关配置</span>
<span class="token punctuation">[</span>client<span class="token punctuation">]</span>	
port <span class="token operator">=</span> <span class="token number">3306</span>
socket <span class="token operator">=</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token operator">/</span>mysqld<span class="token punctuation">.</span>sock
default<span class="token operator">-</span>character<span class="token operator">-</span><span class="token builtin">set</span> <span class="token operator">=</span> utf8mb4

<span class="token comment"># MySQL命令行客户端的配置</span>
<span class="token punctuation">[</span>mysql<span class="token punctuation">]</span>
<span class="token comment"># 指定MySQL命令行提示符的格式。</span>
prompt<span class="token operator">=</span><span class="token string">"\u@mysqldb \R:\m:\s [\d]&gt; "</span>	
<span class="token comment"># 禁用自动补全功能</span>
no<span class="token operator">-</span>auto<span class="token operator">-</span>rehash
<span class="token comment"># 指定MySQL命令行客户端的默认字符集</span>
default<span class="token operator">-</span>character<span class="token operator">-</span><span class="token builtin">set</span> <span class="token operator">=</span> utf8mb4

<span class="token comment"># MySQL服务器的配置</span>
<span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>
<span class="token comment"># 指定MySQL服务器运行的用户 （一般设置为mysql，需要提前创建mysql用户）</span>
user <span class="token operator">=</span> mysql
<span class="token comment"># 指定MySQL服务器监听的端口号</span>
port <span class="token operator">=</span> <span class="token number">3306</span>
socket <span class="token operator">=</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token operator">/</span>mysqld<span class="token punctuation">.</span>sock
<span class="token comment"># 禁用DNS反向解析</span>
skip<span class="token operator">-</span>name<span class="token operator">-</span>resolve

<span class="token comment"># 设置字符编码</span>
character<span class="token operator">-</span><span class="token builtin">set</span><span class="token operator">-</span>server <span class="token operator">=</span> utf8
collation<span class="token operator">-</span>server <span class="token operator">=</span> utf8_general_ci

<span class="token comment"># 设置默认时区</span>
default<span class="token operator">-</span>time_zone<span class="token operator">=</span><span class="token string">'+8:00'</span>

<span class="token comment"># 指定MySQL服务器的唯一标识</span>
server<span class="token operator">-</span><span class="token builtin">id</span> <span class="token operator">=</span> <span class="token number">1</span>

<span class="token comment"># Directory</span>
<span class="token comment"># 安装目录</span>
basedir <span class="token operator">=</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token operator">/</span>
<span class="token comment"># 数据存储目录</span>
datadir <span class="token operator">=</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token operator">/</span>data
<span class="token comment"># 安全文件目录</span>
secure_file_priv <span class="token operator">=</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token operator">/</span>data
<span class="token comment"># PID文件的路径</span>
pid<span class="token operator">-</span><span class="token builtin">file</span> <span class="token operator">=</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token operator">/</span>mysql<span class="token punctuation">.</span>pid

<span class="token comment"># MySQL服务器的最大连接数</span>
max_connections       <span class="token operator">=</span> <span class="token number">1024</span>
<span class="token comment"># 最大连接错误数</span>
max_connect_errors    <span class="token operator">=</span> <span class="token number">100</span>
<span class="token comment"># 连接超时时间</span>
wait_timeout          <span class="token operator">=</span> <span class="token number">100</span>
<span class="token comment"># 最大允许数据包大小</span>
max_allowed_packet    <span class="token operator">=</span> 128M
<span class="token comment"># 表缓存数量</span>
table_open_cache      <span class="token operator">=</span> <span class="token number">2048</span>
<span class="token comment"># 连接请求队列长度</span>
back_log              <span class="token operator">=</span> <span class="token number">600</span>

<span class="token comment"># 指定MySQL服务器的默认存储引擎</span>
default<span class="token operator">-</span>storage<span class="token operator">-</span>engine <span class="token operator">=</span> innodb
<span class="token comment"># 允许二进制日志中包含函数创建语句</span>
log_bin_trust_function_creators <span class="token operator">=</span> <span class="token number">1</span>

<span class="token comment"># Log</span>
<span class="token comment"># 关闭通用查询日志</span>
general_log<span class="token operator">=</span>off
general_log_file <span class="token operator">=</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token operator">/</span>logs<span class="token operator">/</span>mysql<span class="token punctuation">.</span>log
<span class="token comment">#错误日志的路径</span>
log<span class="token operator">-</span>error <span class="token operator">=</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token operator">/</span>logs<span class="token operator">/</span>error<span class="token punctuation">.</span>log

<span class="token comment"># binlog</span>
<span class="token comment">#指定二进制日志的路径和格式</span>
log<span class="token operator">-</span><span class="token builtin">bin</span> <span class="token operator">=</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token operator">/</span>binlog<span class="token operator">/</span>mysql<span class="token operator">-</span>binlog
binlog_format<span class="token operator">=</span>mixed

<span class="token comment"># slowlog慢查询日志</span>
slow_query_log <span class="token operator">=</span> <span class="token number">1</span>
slow_query_log_file <span class="token operator">=</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token operator">/</span>logs<span class="token operator">/</span>slow<span class="token punctuation">.</span>log
long_query_time <span class="token operator">=</span> <span class="token number">2</span>
log_output <span class="token operator">=</span> FILE
log_queries_not_using_indexes <span class="token operator">=</span> <span class="token number">0</span>

<span class="token comment"># global_buffers</span>
innodb_buffer_pool_size <span class="token operator">=</span> 2G
innodb_log_buffer_size <span class="token operator">=</span> 16M
innodb_flush_log_at_trx_commit <span class="token operator">=</span> <span class="token number">2</span>
key_buffer_size <span class="token operator">=</span> 64M

innodb_log_file_size <span class="token operator">=</span> 512M
innodb_log_file_size <span class="token operator">=</span> 2G
innodb_log_files_in_group <span class="token operator">=</span> <span class="token number">2</span>
innodb_data_file_path <span class="token operator">=</span> ibdata1<span class="token punctuation">:</span>20M<span class="token punctuation">:</span>autoextend

sql_mode <span class="token operator">=</span> STRICT_TRANS_TABLES<span class="token punctuation">,</span>NO_ZERO_IN_DATE<span class="token punctuation">,</span>NO_ZERO_DATE<span class="token punctuation">,</span>ERROR_FOR_DIVISION_BY_ZERO<span class="token punctuation">,</span>NO_ENGINE_SUBSTITUTION

<span class="token punctuation">[</span>mysqldump<span class="token punctuation">]</span>
<span class="token comment"># 指定mysqldump工具使用快速导出模式</span>
quick
<span class="token comment"># 指定mysqldump工具允许的最大数据包大小为32M</span>
max_allowed_packet <span class="token operator">=</span> 32M

</code></pre> 
<h3><a id="mysql__1523"></a>初始化mysql 并启动</h3> 
<pre><code class="prism language-python"><span class="token comment"># 创建链接</span>
<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># ln my.cnf /etc/my.cnf</span>
<span class="token comment"># 这通常用于将配置文件从一个位置链接到另一个位置，以方便访问或者使不同的程序或用户能够共享同一份配置文件。</span>

<span class="token comment"># 将mysql-5.7.35文件下的文件归属设置为mysql用户</span>
<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># chown -R mysql:mysql /opt/module/mysql-5.7.35/</span>

<span class="token comment"># 初始化 MySQL 数据库</span>
<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># cd ..</span>
<span class="token punctuation">[</span>root@hadoop01 mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token punctuation">]</span><span class="token comment"># ./bin/mysqld --initialize --user=mysql --datadir=/opt/module/mysql-5.7.35/data/ --basedir=/opt/module/mysql-5.7.35/</span>

<span class="token comment"># --initialize : 这个选项告诉 MySQL 初始化数据库。在首次启动 MySQL 服务器之前，你需要执行这个操作来创建数据库的初始结构，包括系统表和权限表。</span>

<span class="token comment"># 配置 mysql 快捷启动</span>
<span class="token punctuation">[</span>root@hadoop01 mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token punctuation">]</span><span class="token comment"># cp support-files/mysql.server /etc/init.d/mysqld</span>
<span class="token punctuation">[</span>root@hadoop01 mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token punctuation">]</span><span class="token comment"># chmod 777 /etc/init.d/mysqld</span>

<span class="token comment"># 启动 mysql </span>
<span class="token punctuation">[</span>root@hadoop01 mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token punctuation">]</span><span class="token comment"># /etc/init.d/mysqld start</span>
Starting MySQL<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> SUCCESS!

<span class="token comment"># 查看 mysql 进程</span>
<span class="token punctuation">[</span>root@hadoop01 mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token punctuation">]</span><span class="token comment"># ss -ntulp | grep mysql</span>
tcp    LISTEN     <span class="token number">0</span>      <span class="token number">128</span>    <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token number">3306</span>               <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token operator">*</span>                   users<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"mysqld"</span><span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">5419</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre> 
<h3><a id="mysql__1553"></a>设置mysql 开机自启</h3> 
<pre><code class="prism language-python"><span class="token comment"># 设置mysql开机自启</span>
chkconfig <span class="token operator">-</span><span class="token operator">-</span>level <span class="token number">35</span> mysqld on
<span class="token comment"># 表示在运行级别 3 和 5 下启用 mysqld 服务，意味着 MySQL 服务将在系统启动时自动启动</span>
<span class="token punctuation">[</span>root@hadoop01 mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token punctuation">]</span><span class="token comment"># chkconfig --list mysqld</span>

Note<span class="token punctuation">:</span> This output shows SysV services only <span class="token keyword">and</span> does <span class="token keyword">not</span> include native
      systemd services<span class="token punctuation">.</span> SysV configuration data might be overridden by native
      systemd configuration<span class="token punctuation">.</span>

      If you want to <span class="token builtin">list</span> systemd services use <span class="token string">'systemctl list-unit-files'</span><span class="token punctuation">.</span>
      To see services enabled on particular target use
      <span class="token string">'systemctl list-dependencies [target]'</span><span class="token punctuation">.</span>

mysqld          <span class="token number">0</span><span class="token punctuation">:</span>off   <span class="token number">1</span><span class="token punctuation">:</span>off   <span class="token number">2</span><span class="token punctuation">:</span>on    <span class="token number">3</span><span class="token punctuation">:</span>on    <span class="token number">4</span><span class="token punctuation">:</span>on    <span class="token number">5</span><span class="token punctuation">:</span>on    <span class="token number">6</span><span class="token punctuation">:</span>off

<span class="token comment"># MySQL 服务在运行级别 2、3、4、5 下是启用的，而在运行级别 0 和 6 下是禁用的。这意味着 MySQL 服务会在系统启动时自动启动，并在进入多用户模式（运行级别 2、3、4、5）时保持启用。</span>

chmod <span class="token number">777</span> <span class="token operator">/</span>etc<span class="token operator">/</span>rc<span class="token punctuation">.</span>d<span class="token operator">/</span>init<span class="token punctuation">.</span>d<span class="token operator">/</span>mysqld
chkconfig <span class="token operator">-</span><span class="token operator">-</span>add mysqld
chkconfig <span class="token operator">-</span><span class="token operator">-</span><span class="token builtin">list</span> mysqld
<span class="token punctuation">[</span>root@hadoop01 mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token punctuation">]</span><span class="token comment"># service mysqld status</span>
 SUCCESS! MySQL running <span class="token punctuation">(</span><span class="token number">5419</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>root@hadoop01 mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token punctuation">]</span><span class="token comment"># reboot</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># ss -ntulp | grep mysql</span>
tcp    LISTEN     <span class="token number">0</span>      <span class="token number">128</span>    <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token number">3306</span>               <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token operator">*</span>                   users<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"mysqld"</span><span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">2133</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="hive_1583"></a><strong><strong>创建hive使用的相关用户并授权</strong></strong></h3> 
<pre><code class="prism language-python"><span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># grep password /opt/module/mysql-5.7.35/logs/error.log </span>
<span class="token number">2023</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span>02T10<span class="token punctuation">:</span><span class="token number">46</span><span class="token punctuation">:</span><span class="token number">22</span><span class="token punctuation">.</span>116862Z <span class="token number">1</span> <span class="token punctuation">[</span>Note<span class="token punctuation">]</span> A temporary password <span class="token keyword">is</span> generated <span class="token keyword">for</span> root@localhost<span class="token punctuation">:</span> 1WuYfoDmvc<span class="token operator">-</span>L

<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># mysqladmin -uroot -p'1WuYfoDmvc-L' password 123456</span>
<span class="token comment"># 出现警告不用管 (因为密码使用了明文)</span>

<span class="token comment"># 登录 mysql 客户端</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># mysql -uroot -p123456</span>

<span class="token comment"># 添加远程访问权限</span>
root@mysqldb <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">:</span>  <span class="token punctuation">[</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> grant <span class="token builtin">all</span> privileges on <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> to <span class="token string">'root'</span>@<span class="token string">'%'</span> identified by <span class="token string">'123456'</span> <span class="token keyword">with</span> grant option<span class="token punctuation">;</span>

<span class="token comment"># 创建hive数据库并授权</span>
root@mysqldb <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">14</span><span class="token punctuation">:</span>  <span class="token punctuation">[</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> create database hive<span class="token punctuation">;</span>
root@mysqldb <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">:</span>  <span class="token punctuation">[</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> create user <span class="token string">"hive"</span>@<span class="token string">"%"</span> identified by <span class="token string">"123456"</span><span class="token punctuation">;</span>
root@mysqldb <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">:</span>  <span class="token punctuation">[</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> grant <span class="token builtin">all</span> privileges on hive<span class="token punctuation">.</span><span class="token operator">*</span> to <span class="token string">"hive"</span>@<span class="token string">"%"</span><span class="token punctuation">;</span>
root@mysqldb <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">:</span>  <span class="token punctuation">[</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> flush privileges<span class="token punctuation">;</span>

<span class="token comment"># 创建一个名为 "hive" 的数据库，创建一个用户名为 "hive"，允许从任何主机（%表示通配符，表示来自任何主机）连接的用户，并授予该用户对 "hive" 数据库的所有权限</span>

<span class="token comment"># 输入exit 退出即可</span>
</code></pre> 
<h2><a id="hive_1609"></a>八、hive集群搭建</h2> 
<h3><a id="hadoop__coresitexml_1611"></a>首先需要hadoop 用户代理服务 core-site.xml</h3> 
<pre><code class="prism language-python"><span class="token comment"># 需要将集群都关闭！！！ 再进行！！！</span>
<span class="token comment"># 修改 hadoop 配置文件复制到 hive 中</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># cd /opt/module/hadoop-3.3.5/etc/hadoop/</span>
<span class="token punctuation">[</span>root@hadoop01 hadoop<span class="token punctuation">]</span><span class="token comment"># vim core-site.xml</span>

<span class="token comment"># 添加以下配置项：</span>
		<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hadoop<span class="token punctuation">.</span>proxyuser<span class="token punctuation">.</span>root<span class="token punctuation">.</span>hosts<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token operator">*</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hadoop<span class="token punctuation">.</span>proxyuser<span class="token punctuation">.</span>root<span class="token punctuation">.</span>groups<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token operator">*</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

<span class="token comment">#hadoop.proxyuser.xxx.hosts和hadoop.proxyuser.xxx.groups,其中xxx为启动HiveServer2的用户</span>
cp core<span class="token operator">-</span>site<span class="token punctuation">.</span>xml hdfs<span class="token operator">-</span>site<span class="token punctuation">.</span>xml <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hive<span class="token operator">-</span><span class="token number">3.1</span><span class="token number">.3</span><span class="token operator">/</span>conf<span class="token operator">/</span>

cd 
</code></pre> 
<h3><a id="_1636"></a>主机环境配置</h3> 
<pre><code class="prism language-python"><span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># tar -zxvf /opt/software/apache-hive-3.1.3-bin.tar.gz -C /opt/module/</span>

<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># cd /opt/module/</span>

<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># mv apache-hive-3.1.3-bin/ hive-3.1.3/</span>

<span class="token comment"># 配置 hbase 环境变量</span>
vim <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment"># hive环境变量</span>
export HIVE_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hive<span class="token operator">-</span><span class="token number">3.1</span><span class="token number">.3</span>
export PATH<span class="token operator">=</span>$PATH<span class="token punctuation">:</span>$HIVE_HOME<span class="token operator">/</span><span class="token builtin">bin</span>

<span class="token comment"># 激活环境变量</span>
source <span class="token operator">/</span>etc<span class="token operator">/</span>profile
</code></pre> 
<h3><a id="hive__1656"></a>配置hive 核心文件</h3> 
<pre><code class="prism language-python">cd hive<span class="token operator">-</span><span class="token number">3.1</span><span class="token number">.3</span><span class="token operator">/</span>conf<span class="token operator">/</span>

<span class="token comment"># 配置hive日志文件</span>
cp hive<span class="token operator">-</span>log4j2<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>template hive<span class="token operator">-</span>log4j2<span class="token punctuation">.</span>properties
<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># vim hive-log4j2.properties</span>

<span class="token comment"># 修改 日志 存放位置</span>
<span class="token comment"># 修改配置项： property.hive.log.dir = ${sys:java.io.tmpdir}/${sys:user.name} </span>
<span class="token comment"># 修改为 property.hive.log.dir = /opt/module/hive-3.1.3/logs</span>

<span class="token comment"># 解决 hive 控制台输出大量日志信息 解决方法</span>

<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># vim log4j.properties</span>
<span class="token comment"># 插入以下内容即可</span>
log4j<span class="token punctuation">.</span>rootLogger<span class="token operator">=</span>WARN<span class="token punctuation">,</span>CA
log4j<span class="token punctuation">.</span>appender<span class="token punctuation">.</span>CA<span class="token operator">=</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>log4j<span class="token punctuation">.</span>ConsoleAppender
log4j<span class="token punctuation">.</span>appender<span class="token punctuation">.</span>CA<span class="token punctuation">.</span>layout<span class="token operator">=</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>log4j<span class="token punctuation">.</span>PatternLayout
log4j<span class="token punctuation">.</span>appender<span class="token punctuation">.</span>CA<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>ConversionPattern<span class="token operator">=</span><span class="token operator">%</span><span class="token operator">-</span>4r <span class="token punctuation">[</span><span class="token operator">%</span>t<span class="token punctuation">]</span> <span class="token operator">%</span><span class="token operator">-</span>5p <span class="token operator">%</span>c <span class="token operator">%</span>x <span class="token operator">-</span> <span class="token operator">%</span>m<span class="token operator">%</span>n

<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># cp hive-env.sh.template hive-env.sh</span>
<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># vim hive-env.sh</span>

<span class="token comment"># 修改配置项如下</span>
HADOOP_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hadoop<span class="token operator">-</span><span class="token number">3.3</span><span class="token number">.5</span>
export HIVE_CONF_DIR<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hive<span class="token operator">-</span><span class="token number">3.1</span><span class="token number">.3</span><span class="token operator">/</span>conf
export HIVE_AUX_JARS_PATH<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hive<span class="token operator">-</span><span class="token number">3.1</span><span class="token number">.3</span><span class="token operator">/</span>lib
export JAVA_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_391</span>   
</code></pre> 
<h3><a id="hivesitexml__metastore__hiveserver2_1688"></a><strong><strong>配置hive-site.xml 文件 （metastore 和 hiveserver2）</strong></strong></h3> 
<aside>
  💡 说明：Metastore负责管理和存储Hive表的元数据信息，而HiveServer2充当Hive服务端，允许客户端通过不同的接口与Hive交互执行查询。 
</aside> 
<pre><code class="prism language-python"><span class="token comment"># 需要开启 hadoop 集群 和 zookeeper集群</span>
<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># hadoop fs -ls /user</span>
Found <span class="token number">1</span> items
drwxr<span class="token operator">-</span>xr<span class="token operator">-</span>x   <span class="token operator">-</span> root supergroup          <span class="token number">0</span> <span class="token number">2023</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">12</span><span class="token punctuation">:</span><span class="token number">59</span> <span class="token operator">/</span>user<span class="token operator">/</span>root

<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -mkdir -p /user/hive/{warehouse,tmp,logs}</span>
<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -chmod -R 777 /user/hive/</span>

<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># vim hive-site.xml </span>

<span class="token operator">&lt;</span>?xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span> standalone<span class="token operator">=</span><span class="token string">"no"</span>?<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>?xml<span class="token operator">-</span>stylesheet <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">"text/xsl"</span> href<span class="token operator">=</span><span class="token string">"configuration.xsl"</span>?<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>configuration<span class="token operator">&gt;</span>

	<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>指定Hive元数据存储在本地 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>metastore<span class="token punctuation">.</span>local<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>Hive作业的HDFS根目录位置 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">.</span>scratchdir<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token operator">/</span>user<span class="token operator">/</span>hive<span class="token operator">/</span>tmp<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>Hive作业的HDFS根目录创建和写权限 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>scratch<span class="token punctuation">.</span><span class="token builtin">dir</span><span class="token punctuation">.</span>permission<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">777</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>指定Hive元数据存放在HDFS上的位置 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>metastore<span class="token punctuation">.</span>warehouse<span class="token punctuation">.</span><span class="token builtin">dir</span><span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token operator">/</span>user<span class="token operator">/</span>hive<span class="token operator">/</span>warehouse<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>连接数据库地址，名称 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>javax<span class="token punctuation">.</span>jdo<span class="token punctuation">.</span>option<span class="token punctuation">.</span>ConnectionURL<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span><span class="token operator">//</span>hadoop01<span class="token punctuation">:</span><span class="token number">3306</span><span class="token operator">/</span>hive?createDatabaseIfNotExist<span class="token operator">=</span>true<span class="token operator">&amp;</span>amp<span class="token punctuation">;</span>useSSL<span class="token operator">=</span>false<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>连接数据库驱动 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>javax<span class="token punctuation">.</span>jdo<span class="token punctuation">.</span>option<span class="token punctuation">.</span>ConnectionDriverName<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>Driver<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>连接数据库用户名称 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>javax<span class="token punctuation">.</span>jdo<span class="token punctuation">.</span>option<span class="token punctuation">.</span>ConnectionUserName<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hive<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>连接数据库用户密码 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>javax<span class="token punctuation">.</span>jdo<span class="token punctuation">.</span>option<span class="token punctuation">.</span>ConnectionPassword<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">123456</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> 指定metastore连接地址 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>metastore<span class="token punctuation">.</span>uris<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>thrift<span class="token punctuation">:</span><span class="token operator">//</span>hadoop01<span class="token punctuation">:</span><span class="token number">9083</span><span class="token punctuation">,</span>thrift<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">9083</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>启用Hive Server2的动态服务发现支持<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>server2<span class="token punctuation">.</span>support<span class="token punctuation">.</span>dynamic<span class="token punctuation">.</span>service<span class="token punctuation">.</span>discovery<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>description<span class="token operator">&gt;</span>当启用时，Hive Server <span class="token number">2</span>会注册到ZooKeeper，并通过ZooKeeper进行服务发现。这可以支持Hive Server <span class="token number">2</span>的高可用和负载均衡配置<span class="token operator">&lt;</span><span class="token operator">/</span>description<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>启用Hive Server2的主备模式<span class="token punctuation">,</span>并通过ZooKeeper选举一个活动实例来提供服务<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>server2<span class="token punctuation">.</span>active<span class="token punctuation">.</span>passive<span class="token punctuation">.</span>ha<span class="token punctuation">.</span>enable<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>指定在ZooKeeper中用于Hive Server2的命名空间<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>server2<span class="token punctuation">.</span>zookeeper<span class="token punctuation">.</span>namespace<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hiveserver2_zk<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>zookeeper<span class="token punctuation">.</span>quorum<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop01<span class="token punctuation">:</span><span class="token number">2181</span><span class="token punctuation">,</span>hadoop02<span class="token punctuation">:</span><span class="token number">2181</span><span class="token punctuation">,</span>hadoop03<span class="token punctuation">:</span><span class="token number">2181</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>    
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>zookeeper<span class="token punctuation">.</span>client<span class="token punctuation">.</span>port<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">2181</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>指定Hive Server2的Thrift服务监听的端口号<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>server2<span class="token punctuation">.</span>thrift<span class="token punctuation">.</span>port<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">10001</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>指定Hive Server2的Thrift服务绑定的主机名或IP地址<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>server2<span class="token punctuation">.</span>thrift<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>host<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop02<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>querylog<span class="token punctuation">.</span>location<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token operator">/</span>user<span class="token operator">/</span>hive<span class="token operator">/</span>logs<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> 显示表的列名 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>cli<span class="token punctuation">.</span><span class="token keyword">print</span><span class="token punctuation">.</span>header<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> 显示数据库名称 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>cli<span class="token punctuation">.</span><span class="token keyword">print</span><span class="token punctuation">.</span>current<span class="token punctuation">.</span>db<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
<span class="token operator">&lt;</span><span class="token operator">/</span>configuration<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="mysql_1825"></a>初始化mysql</h3> 
<pre><code class="prism language-python"><span class="token comment"># 将下载 mysql 驱动包到 hive 的 lib 目录下</span>
<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># cp /opt/software/mysql-connector-java-5.1.49.jar /opt/module/hive-3.1.3/lib/</span>

<span class="token comment"># 删除 hive 下的 log4j-slf4j-impl-2.17.1.jar,会与hadoop下的 slf4j-reload4j-1.7.36.jar 冲突</span>
<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># rm -rf ../lib/log4j-slf4j-impl-2.17.1.jar</span>

<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># rm -rf /opt/module/hive-3.1.3/lib/guava-19.0.jar</span>
<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># cp /opt/module/hadoop-3.3.5/share/hadoop/common/lib/guava-27.0-jre.jar /opt/module/hive-3.1.3/lib/</span>

<span class="token comment"># 将 hive 文件 同步到其他主机</span>
cd <span class="token operator">/</span>opt<span class="token operator">/</span>module
<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># xsync hive-3.1.3/</span>
<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># xsync /etc/profile</span>

<span class="token comment"># 分别在 hadoop02 和 hadoop03 上 执行以下代码 激活环境变量</span>
<span class="token comment"># 在 hadoop02 和 hadoop03 上 建议先删除 关于 mysql 的环境变量</span>
source <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment"># 在初始化 mysql 之前 要在hadoop03 上 修改 hive-site.xml文件</span>
<span class="token comment"># 在 hadoop02 上不用修改,因为使用的是同一份配置,即hadoop01 和 hadoop02 是一样的</span>
<span class="token comment"># 在 hadoop03 上修改</span>
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>指定Hive Server2的Thrift服务绑定的主机名或IP地址<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>server2<span class="token punctuation">.</span>thrift<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>host<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop03<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># schematool -dbType mysql -initSchema</span>
Metastore connection URL<span class="token punctuation">:</span>        jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span><span class="token operator">//</span>hadoop01<span class="token punctuation">:</span><span class="token number">3306</span><span class="token operator">/</span>hive?createDatabaseIfNotExist<span class="token operator">=</span>true<span class="token operator">&amp;</span>useSSL<span class="token operator">=</span>false
Metastore Connection Driver <span class="token punctuation">:</span>    com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>Driver
Metastore connection User<span class="token punctuation">:</span>       hive
Starting metastore schema initialization to <span class="token number">3.1</span><span class="token number">.0</span>
Initialization script hive<span class="token operator">-</span>schema<span class="token operator">-</span><span class="token number">3.1</span><span class="token number">.0</span><span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>sql

Initialization script completed
schemaTool completed

<span class="token comment"># 初始化成功</span>
</code></pre> 
<p>在数据库管理工具中，可以进行查看虚拟机中的mysql数据库中的hive库 这里我使用的是 datagrip</p> 
<p><img src="https://images2.imgbox.com/34/e5/KNGqRWPl_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202312040920856.png"></p> 
<h4><a id="_1872"></a>初始化报错解决方法</h4> 
<pre><code class="prism language-python"><span class="token comment"># 如果按照我实现的顺序进行,一般不会出现问题</span>
<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># schematool -dbType mysql -initSchema</span>
Metastore connection URL<span class="token punctuation">:</span>        jdbc<span class="token punctuation">:</span>derby<span class="token punctuation">:</span><span class="token punctuation">;</span>databaseName<span class="token operator">=</span>metastore_db<span class="token punctuation">;</span>create<span class="token operator">=</span>true
Metastore Connection Driver <span class="token punctuation">:</span>    org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>derby<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>EmbeddedDriver
Metastore connection User<span class="token punctuation">:</span>       APP
Starting metastore schema initialization to <span class="token number">3.1</span><span class="token number">.0</span>
Initialization script hive<span class="token operator">-</span>schema<span class="token operator">-</span><span class="token number">3.1</span><span class="token number">.0</span><span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>sql

Error<span class="token punctuation">:</span> Syntax error<span class="token punctuation">:</span> Encountered <span class="token string">"&lt;EOF&gt;"</span> at line <span class="token number">1</span><span class="token punctuation">,</span> column <span class="token number">64.</span> <span class="token punctuation">(</span>state<span class="token operator">=</span>42X01<span class="token punctuation">,</span>code<span class="token operator">=</span><span class="token number">30000</span><span class="token punctuation">)</span>
org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>hive<span class="token punctuation">.</span>metastore<span class="token punctuation">.</span>HiveMetaException<span class="token punctuation">:</span> Schema initialization FAILED! Metastore state would be inconsistent !!
Underlying cause<span class="token punctuation">:</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException <span class="token punctuation">:</span> Schema script failed<span class="token punctuation">,</span> errorcode <span class="token number">2</span>
Use <span class="token operator">-</span><span class="token operator">-</span>verbose <span class="token keyword">for</span> detailed stacktrace<span class="token punctuation">.</span>
<span class="token operator">**</span><span class="token operator">*</span> schemaTool failed <span class="token operator">**</span><span class="token operator">*</span>

<span class="token comment"># 初始化失败了,通过查询 原因是 hive 中的 lib 文件里面 关于 guava-19.0.jar 版本为 19 而在 hadoop 中的版本为 27 guava-27.0-jre.jar</span>
<span class="token comment"># 解决方法:</span>
<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># rm -rf /opt/module/hive-3.1.3/lib/guava-19.0.jar</span>
<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># cp /opt/module/hadoop-3.3.5/share/hadoop/common/lib/guava-27.0-jre.jar /opt/module/hive-3.1.3/lib/</span>

<span class="token comment"># 重新执行格式化</span>

<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># schematool -dbType mysql -initSchema</span>
Metastore connection URL<span class="token punctuation">:</span>        jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span><span class="token operator">//</span>hadoop01<span class="token punctuation">:</span><span class="token number">3306</span><span class="token operator">/</span>hive?createDatabaseIfNotExist<span class="token operator">=</span>true<span class="token operator">&amp;</span>useSSL<span class="token operator">=</span>false
Metastore Connection Driver <span class="token punctuation">:</span>    com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>Driver
Metastore connection User<span class="token punctuation">:</span>       hive
Starting metastore schema initialization to <span class="token number">3.1</span><span class="token number">.0</span>
Initialization script hive<span class="token operator">-</span>schema<span class="token operator">-</span><span class="token number">3.1</span><span class="token number">.0</span><span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>sql
Error<span class="token punctuation">:</span> Table <span class="token string">'CTLGS'</span> already exists <span class="token punctuation">(</span>state<span class="token operator">=</span>42S01<span class="token punctuation">,</span>code<span class="token operator">=</span><span class="token number">1050</span><span class="token punctuation">)</span>
org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>hive<span class="token punctuation">.</span>metastore<span class="token punctuation">.</span>HiveMetaException<span class="token punctuation">:</span> Schema initialization FAILED! Metastore state would be inconsistent !!
Underlying cause<span class="token punctuation">:</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException <span class="token punctuation">:</span> Schema script failed<span class="token punctuation">,</span> errorcode <span class="token number">2</span>
Use <span class="token operator">-</span><span class="token operator">-</span>verbose <span class="token keyword">for</span> detailed stacktrace<span class="token punctuation">.</span>
<span class="token operator">**</span><span class="token operator">*</span> schemaTool failed <span class="token operator">**</span><span class="token operator">*</span>

<span class="token comment"># 需要连接数据库，将hive 中的所有表进行删除</span>
</code></pre> 
<h4><a id="metastore_1911"></a><strong><strong>启动metastore</strong></strong></h4> 
<pre><code class="prism language-python"><span class="token punctuation">[</span>root@hadoop02 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># nohup hive --service metastore &gt;&gt; /opt/module/hive-3.1.3/logs/metastore.log 2&gt;&amp;1 &amp;</span>

<span class="token punctuation">[</span>root@hadoop02 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># mkdir /opt/module/hive-3.1.3/logs</span>
<span class="token punctuation">[</span>root@hadoop02 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># nohup hive --service metastore &gt;&gt; /opt/module/hive-3.1.3/logs/metastore.log 2&gt;&amp;1 &amp;</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">3695</span>
<span class="token comment">#查看启动的服务，验证</span>

<span class="token punctuation">[</span>root@hadoop02 hive<span class="token operator">-</span><span class="token number">3.1</span><span class="token number">.3</span><span class="token punctuation">]</span><span class="token comment"># ss -ntulp | grep 3695</span>
tcp    LISTEN     <span class="token number">0</span>      <span class="token number">50</span>     <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token number">9083</span>               <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token operator">*</span>                   users<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"java"</span><span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">3695</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">630</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="hiveserver2_1925"></a><strong><strong>启动hiveserver2</strong></strong></h4> 
<pre><code class="prism language-python"><span class="token punctuation">[</span>root@hadoop02 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># nohup hive --service hiveserver2 &gt;&gt; /opt/module/hive-3.1.3/logs/hiveserver2.log 2&gt;&amp;1 &amp;</span>

<span class="token punctuation">[</span>root@hadoop03 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># mkdir /opt/module/hive-3.1.3/logs</span>
<span class="token punctuation">[</span>root@hadoop03 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># nohup hive --service hiveserver2 &gt;&gt; /opt/module/hive-3.1.3/logs/hiveserver2.log 2&gt;&amp;1 &amp;</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">2141</span>
<span class="token comment">#查看启动的服务，验证</span>

<span class="token punctuation">[</span>root@hadoop03 hadoop<span class="token punctuation">]</span><span class="token comment"># ss -ntulp | grep 2141</span>
tcp    LISTEN     <span class="token number">0</span>      <span class="token number">50</span>     <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token number">10001</span>              <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token operator">*</span>                   users<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"java"</span><span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">2141</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">627</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
tcp    LISTEN     <span class="token number">0</span>      <span class="token number">50</span>     <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token number">10002</span>              <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token operator">*</span>                   users<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"java"</span><span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">2141</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">632</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="hive_1940"></a>hive启动测试</h4> 
<p>在浏览器上输入 hadoop02:10002或者hadoop03:10002</p> 
<p><img src="https://images2.imgbox.com/2a/80/zhvfuv2a_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202312031945149.png"></p> 
<pre><code class="prism language-python"><span class="token comment"># 在本次 hive 集群搭建的过程中,我将 hadoop03 当作客户机来使用</span>
<span class="token comment"># 连接测试 </span>
<span class="token punctuation">[</span>root@hadoop03 hadoop<span class="token punctuation">]</span><span class="token comment"># beeline -u jdbc:hive2://hadoop02:10001</span>
Connecting to jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span>
<span class="token number">2023</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">03</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token number">06</span><span class="token punctuation">:</span><span class="token number">53</span><span class="token punctuation">,</span><span class="token number">137</span> INFO jdbc<span class="token punctuation">.</span>Utils<span class="token punctuation">:</span> Supplied authorities<span class="token punctuation">:</span> hadoop02<span class="token punctuation">:</span><span class="token number">10001</span>
<span class="token number">2023</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">03</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token number">06</span><span class="token punctuation">:</span><span class="token number">53</span><span class="token punctuation">,</span><span class="token number">139</span> INFO jdbc<span class="token punctuation">.</span>Utils<span class="token punctuation">:</span> Resolved authority<span class="token punctuation">:</span> hadoop02<span class="token punctuation">:</span><span class="token number">10001</span>
Connected to<span class="token punctuation">:</span> Apache Hive <span class="token punctuation">(</span>version <span class="token number">3.1</span><span class="token number">.3</span><span class="token punctuation">)</span>
Driver<span class="token punctuation">:</span> Hive JDBC <span class="token punctuation">(</span>version <span class="token number">2.3</span><span class="token number">.9</span><span class="token punctuation">)</span>
Transaction isolation<span class="token punctuation">:</span> TRANSACTION_REPEATABLE_READ
Beeline version <span class="token number">2.3</span><span class="token number">.9</span> by Apache Hive
<span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span><span class="token operator">&gt;</span> Closing<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span>

<span class="token punctuation">[</span>root@hadoop03 hadoop<span class="token punctuation">]</span><span class="token comment"># beeline -u jdbc:hive2://hadoop03:10001</span>
Connecting to jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop03<span class="token punctuation">:</span><span class="token number">10001</span>
<span class="token number">2023</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">03</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token number">08</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">208</span> INFO jdbc<span class="token punctuation">.</span>Utils<span class="token punctuation">:</span> Supplied authorities<span class="token punctuation">:</span> hadoop03<span class="token punctuation">:</span><span class="token number">10001</span>
<span class="token number">2023</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">03</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token number">08</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">209</span> INFO jdbc<span class="token punctuation">.</span>Utils<span class="token punctuation">:</span> Resolved authority<span class="token punctuation">:</span> hadoop03<span class="token punctuation">:</span><span class="token number">10001</span>
Connected to<span class="token punctuation">:</span> Apache Hive <span class="token punctuation">(</span>version <span class="token number">3.1</span><span class="token number">.3</span><span class="token punctuation">)</span>
Driver<span class="token punctuation">:</span> Hive JDBC <span class="token punctuation">(</span>version <span class="token number">2.3</span><span class="token number">.9</span><span class="token punctuation">)</span>
Transaction isolation<span class="token punctuation">:</span> TRANSACTION_REPEATABLE_READ
Beeline version <span class="token number">2.3</span><span class="token number">.9</span> by Apache Hive
<span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop03<span class="token punctuation">:</span><span class="token number">10001</span><span class="token operator">&gt;</span> Closing<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop03<span class="token punctuation">:</span><span class="token number">10001</span>
</code></pre> 
<p>hive数据库创建测试并查看hiveserver2状态</p> 
<pre><code class="prism language-python"><span class="token punctuation">[</span>root@hadoop03 hadoop<span class="token punctuation">]</span><span class="token comment"># beeline</span>
Beeline version <span class="token number">2.3</span><span class="token number">.9</span> by Apache Hive
beeline<span class="token operator">&gt;</span> !connect jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span>
Connecting to jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span>
Enter username <span class="token keyword">for</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span><span class="token punctuation">:</span> hive
Enter password <span class="token keyword">for</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span><span class="token punctuation">:</span> 
<span class="token number">2023</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">03</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token number">46</span><span class="token punctuation">:</span><span class="token number">57</span><span class="token punctuation">,</span><span class="token number">731</span> INFO jdbc<span class="token punctuation">.</span>Utils<span class="token punctuation">:</span> Supplied authorities<span class="token punctuation">:</span> hadoop02<span class="token punctuation">:</span><span class="token number">10001</span>
<span class="token number">2023</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">03</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token number">46</span><span class="token punctuation">:</span><span class="token number">57</span><span class="token punctuation">,</span><span class="token number">732</span> INFO jdbc<span class="token punctuation">.</span>Utils<span class="token punctuation">:</span> Resolved authority<span class="token punctuation">:</span> hadoop02<span class="token punctuation">:</span><span class="token number">10001</span>
Connected to<span class="token punctuation">:</span> Apache Hive <span class="token punctuation">(</span>version <span class="token number">3.1</span><span class="token number">.3</span><span class="token punctuation">)</span>
Driver<span class="token punctuation">:</span> Hive JDBC <span class="token punctuation">(</span>version <span class="token number">2.3</span><span class="token number">.9</span><span class="token punctuation">)</span>
Transaction isolation<span class="token punctuation">:</span> TRANSACTION_REPEATABLE_READ
<span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span><span class="token operator">&gt;</span> create database <span class="token keyword">if</span> <span class="token keyword">not</span> exists mytestdb<span class="token punctuation">;</span>
No rows affected <span class="token punctuation">(</span><span class="token number">0.1</span> seconds<span class="token punctuation">)</span>
<span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span><span class="token operator">&gt;</span> use mytestdb<span class="token punctuation">;</span>
No rows affected <span class="token punctuation">(</span><span class="token number">0.059</span> seconds<span class="token punctuation">)</span>
<span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span><span class="token operator">&gt;</span> show tables<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span>   tab_name   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> mytesttable  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token number">1</span> row selected <span class="token punctuation">(</span><span class="token number">0.127</span> seconds<span class="token punctuation">)</span>
<span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span><span class="token operator">&gt;</span> describe database mytestdb<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span>  db_name  <span class="token operator">|</span> comment  <span class="token operator">|</span>                     location                      <span class="token operator">|</span> owner_name  <span class="token operator">|</span> owner_type  <span class="token operator">|</span> parameters  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> mytestdb  <span class="token operator">|</span>          <span class="token operator">|</span> hdfs<span class="token punctuation">:</span><span class="token operator">//</span>mycluster<span class="token operator">/</span>user<span class="token operator">/</span>hive<span class="token operator">/</span>warehouse<span class="token operator">/</span>mytestdb<span class="token punctuation">.</span>db  <span class="token operator">|</span> anonymous   <span class="token operator">|</span> USER        <span class="token operator">|</span>             <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token number">1</span> row selected <span class="token punctuation">(</span><span class="token number">0.068</span> seconds<span class="token punctuation">)</span>
<span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span><span class="token operator">&gt;</span> CREATE EXTERNAL TABLE IF NOT EXISTS mytesttable <span class="token punctuation">(</span>
<span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token operator">&gt;</span> name string<span class="token punctuation">,</span>
<span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token operator">&gt;</span> age string<span class="token punctuation">,</span>
<span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token operator">&gt;</span> workplace ARRAY<span class="token operator">&lt;</span>STRING<span class="token operator">&gt;</span>
<span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token operator">&gt;</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token operator">&gt;</span> COMMENT <span class="token string">'This is an text table'</span><span class="token punctuation">;</span>
No rows affected <span class="token punctuation">(</span><span class="token number">0.074</span> seconds<span class="token punctuation">)</span>
<span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span><span class="token operator">&gt;</span> show tables<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span>   tab_name   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> mytesttable  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token number">1</span> row selected <span class="token punctuation">(</span><span class="token number">0.091</span> seconds<span class="token punctuation">)</span>
<span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span><span class="token operator">&gt;</span> desc mytesttable<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span>  col_name  <span class="token operator">|</span>   data_type    <span class="token operator">|</span> comment  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> name       <span class="token operator">|</span> string         <span class="token operator">|</span>          <span class="token operator">|</span>
<span class="token operator">|</span> age        <span class="token operator">|</span> string         <span class="token operator">|</span>          <span class="token operator">|</span>
<span class="token operator">|</span> workplace  <span class="token operator">|</span> array<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span>  <span class="token operator">|</span>          <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token number">3</span> rows selected <span class="token punctuation">(</span><span class="token number">0.136</span> seconds<span class="token punctuation">)</span>
<span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span><span class="token operator">&gt;</span> Closing<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span>
</code></pre> 
<p>可以查看，我们创建数据库的过程中，所使用的语句信息会同时保存到hdfs中，并且使用mapreduce的形式运行</p> 
<p><img src="https://images2.imgbox.com/66/9c/DwaOsWYC_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202312032350369.png"></p> 
<h2><a id="_2033"></a>另附上述软件下载地址</h2> 
<pre><code class="prism language-python"><span class="token comment"># jdk https://www.oracle.com/java/technologies/downloads/#sjre8-windows  然后选择最新的linux jdk下载就好 不过需要注册oracle账号进行下载</span>
<span class="token comment"># hadoop https://archive.apache.org/dist/hadoop/common/hadoop-3.3.5/hadoop-3.3.5.tar.gz</span>
<span class="token comment"># hbase https://dlcdn.apache.org/hbase/2.4.17/hbase-2.4.17-bin.tar.gz</span>
<span class="token comment"># hive https://dlcdn.apache.org/hive/hive-3.1.3/apache-hive-3.1.3-bin.tar.gz</span>
<span class="token comment"># kafka https://archive.apache.org/dist/kafka/3.4.0/kafka_2.12-3.4.0.tgz</span>
<span class="token comment"># spark https://archive.apache.org/dist/spark/spark-3.2.4/spark-3.2.4-bin-hadoop3.2-scala2.13.tgz</span>
<span class="token comment"># flink https://archive.apache.org/dist/flink/flink-1.16.1/flink-1.16.1-bin-scala_2.12.tgz</span>
<span class="token comment"># flink-share https://repo.maven.apache.org/maven2/org/apache/flink/flink-shaded-hadoop-2-uber/2.8.3-10.0/flink-shaded-hadoop-2-uber-2.8.3-10.0.jar</span>
<span class="token comment"># mysql https://cdn.mysql.com/archives/mysql-5.7/mysql-5.7.35-el7-x86_64.tar.gz</span>
<span class="token comment"># mysql-jdbc https://repo1.maven.org/maven2/mysql/mysql-connector-java/5.1.49/mysql-connector-java-5.1.49.jar</span>

<span class="token comment"># 软件打包链接</span>
链接：https<span class="token punctuation">:</span><span class="token operator">//</span>pan<span class="token punctuation">.</span>baidu<span class="token punctuation">.</span>com<span class="token operator">/</span>s<span class="token operator">/</span>19cmBl9fpf7<span class="token operator">-</span>7luxtBhMUJw?pwd<span class="token operator">=</span>bkth 
提取码：bkth 
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/651ef463318d6cd4eb28f5ac89a73bea/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">排序算法-插入/希尔排序</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e81eaf0af87495cdab7993a81d177f10/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">macOS Big Sur/Mac电脑安装vscode显示您没有权限来打开应用程序‘Visual Studio Code‘ 请联系您的电脑或网络管理员问题修复</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>