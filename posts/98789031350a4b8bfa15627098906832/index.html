<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Hadoop é«˜å¯ç”¨é›†ç¾¤å®Œå…¨åˆ†å¸ƒå¼å®‰è£…æ•™ç¨‹ä¸€ç¯‡å°±å¤Ÿç”¨ï¼ˆzookeeperã€sparkã€hbaseã€mysqlã€hive) - ç¼–ç¨‹å¤§å’–</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/98789031350a4b8bfa15627098906832/">
  <meta property="og:site_name" content="ç¼–ç¨‹å¤§å’–">
  <meta property="og:title" content="Hadoop é«˜å¯ç”¨é›†ç¾¤å®Œå…¨åˆ†å¸ƒå¼å®‰è£…æ•™ç¨‹ä¸€ç¯‡å°±å¤Ÿç”¨ï¼ˆzookeeperã€sparkã€hbaseã€mysqlã€hive)">
  <meta property="og:description" content="Hadoop é«˜å¯ç”¨é›†ç¾¤å®Œå…¨åˆ†å¸ƒå¼å®‰è£…æ•™ç¨‹ä¸€ç¯‡å°±å¤Ÿç”¨ï¼ˆzookeeperã€sparkã€hbaseã€mysqlã€hiveï¼‰ å†™åœ¨ä¹‹å‰ï¼ŒHadoopå®Œå…¨åˆ†å¸ƒå¼é›†ç¾¤èµ„æºé…ç½®è§„åˆ’æƒ…å†µ
ä¸€ã€å…¨å±€åŸºæœ¬é…ç½® ğŸ’¡ å»ºè®®ä¸€å¼€å§‹å®‰è£…çš„æ—¶å€™åœ¨ç½‘ç»œé…ç½®é¡¹çš„åœ°æ–¹,é€‰æ‹©è‡ªåŠ¨ipv4,ç„¶åè¿›è¡Œipè®¾ç½® 1ã€æ›´æ”¹é™æ€ç½‘ç»œ å‘½ä»¤å¦‚ä¸‹ï¼š
# æ£€æŸ¥è™šæ‹Ÿæœºæ˜¯å¦èƒ½å¤Ÿpingé€šwww.baidu.com service network restart # å°è¯•é‡å¯ç½‘ç»œæœåŠ¡ # ä¿®æ”¹ç½‘ç»œæœåŠ¡ä¸ºé™æ€ç½‘ç»œ æŒ‡å®šè·¯ç”±ä»¥åŠDNSæœåŠ¡å™¨ vim /etc/sysconfig/network-scripts/ifcfg-ens33 æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š
TYPE=Ethernet PROXY_METHOD=none BROWSER_ONLY=no BOOTPROTO=&#34;static&#34; DEFROUTE=yes IPV4_FAILURE_FATAL=no IPV6INIT=yes IPV6_AUTOCONF=yes IPV6_DEFROUTE=yes IPV6_FAILURE_FATAL=no IPV6_ADDR_GEN_MODE=stable-privacy NAME=ens33 UUID=c494a46e-a55b-431a-9b5e-b2bbdc767606 DEVICE=ens33 ONBOOT=yes IPADDR=192.168.201.201# è™šæ‹Ÿæœºå¯¹åº”çš„ipåœ°å€ NETMASK=255.255.255.0 # å­ç½‘æ©ç  GATEWAY=192.168.201.2# ç½‘å…³åœ°å€ DNS1=114.114.114.114 # DNSæœåŠ¡å™¨åœ°å€ ç„¶åé‡å¯ç½‘ç»œï¼š
service network restart å†æ¬¡æµ‹è¯• ç½‘ç»œæ˜¯å¦èƒ½å¤Ÿæ­£å¸¸è”é€š
ping www.baidu.com 2ã€å…³é—­é˜²ç«å¢™ #å…³é—­é˜²ç«å¢™ systemctl stop firewalld #ç¦ç”¨é˜²ç«å¢™ systemctl disable firewalld #æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€ systemctl status firewalld 3ã€é…ç½®ä¸»æœºåï¼ˆæ–¹ä¾¿åæœŸHadoopé›†ç¾¤æœåŠ¡ï¼‰ #ç»™3å°è™šæ‹Ÿæœºè®¾ç½®ä¸»æœºååˆ†åˆ«ä¸ºhadoop01ã€hadoop02å’Œhadoop03ã€‚ #åœ¨ç¬¬ä¸€å°æœºå™¨æ“ä½œ hostnamectl set-hostname hadoop01 #åœ¨ç¬¬äºŒå°æœºå™¨æ“ä½œ hostnamectl set-hostname hadoop02 #åœ¨ç¬¬ä¸‰å°æœºå™¨æ“ä½œ hostnamectl set-hostname hadoop03 è®¾ç½®å®Œæ¯•ååœ¨sshå·¥å…·å¤„åˆ·æ–°å³å¯">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-12-08T22:40:44+08:00">
    <meta property="article:modified_time" content="2023-12-08T22:40:44+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§å’–" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§å’–</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Hadoop é«˜å¯ç”¨é›†ç¾¤å®Œå…¨åˆ†å¸ƒå¼å®‰è£…æ•™ç¨‹ä¸€ç¯‡å°±å¤Ÿç”¨ï¼ˆzookeeperã€sparkã€hbaseã€mysqlã€hive)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Hadoop_zookeepersparkhbasemysqlhive_0"></a>Hadoop é«˜å¯ç”¨é›†ç¾¤å®Œå…¨åˆ†å¸ƒå¼å®‰è£…æ•™ç¨‹ä¸€ç¯‡å°±å¤Ÿç”¨ï¼ˆzookeeperã€sparkã€hbaseã€mysqlã€hiveï¼‰</h2> 
<p><strong>å†™åœ¨ä¹‹å‰ï¼ŒHadoopå®Œå…¨åˆ†å¸ƒå¼é›†ç¾¤èµ„æºé…ç½®è§„åˆ’æƒ…å†µ</strong><br> <img src="https://images2.imgbox.com/93/9b/8xX9Ne0d_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h2><a id="_4"></a>ä¸€ã€å…¨å±€åŸºæœ¬é…ç½®</h2> 
<aside>
  ğŸ’¡ å»ºè®®ä¸€å¼€å§‹å®‰è£…çš„æ—¶å€™åœ¨ç½‘ç»œé…ç½®é¡¹çš„åœ°æ–¹,é€‰æ‹©è‡ªåŠ¨ipv4,ç„¶åè¿›è¡Œipè®¾ç½® 
</aside> 
<h3><a id="1_11"></a>1ã€æ›´æ”¹é™æ€ç½‘ç»œ</h3> 
<p><strong>å‘½ä»¤å¦‚ä¸‹ï¼š</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># æ£€æŸ¥è™šæ‹Ÿæœºæ˜¯å¦èƒ½å¤Ÿpingé€šwww.baidu.com</span>
service network restart  <span class="token comment"># å°è¯•é‡å¯ç½‘ç»œæœåŠ¡</span>
<span class="token comment"># ä¿®æ”¹ç½‘ç»œæœåŠ¡ä¸ºé™æ€ç½‘ç»œ æŒ‡å®šè·¯ç”±ä»¥åŠDNSæœåŠ¡å™¨</span>
vim <span class="token operator">/</span>etc<span class="token operator">/</span>sysconfig<span class="token operator">/</span>network<span class="token operator">-</span>scripts<span class="token operator">/</span>ifcfg<span class="token operator">-</span>ens33
</code></pre> 
<p><strong>æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</strong></p> 
<pre><code class="prism language-python">TYPE<span class="token operator">=</span>Ethernet
PROXY_METHOD<span class="token operator">=</span>none
BROWSER_ONLY<span class="token operator">=</span>no
BOOTPROTO<span class="token operator">=</span><span class="token string">"static"</span>
DEFROUTE<span class="token operator">=</span>yes
IPV4_FAILURE_FATAL<span class="token operator">=</span>no
IPV6INIT<span class="token operator">=</span>yes
IPV6_AUTOCONF<span class="token operator">=</span>yes
IPV6_DEFROUTE<span class="token operator">=</span>yes
IPV6_FAILURE_FATAL<span class="token operator">=</span>no
IPV6_ADDR_GEN_MODE<span class="token operator">=</span>stable<span class="token operator">-</span>privacy
NAME<span class="token operator">=</span>ens33
UUID<span class="token operator">=</span>c494a46e<span class="token operator">-</span>a55b<span class="token operator">-</span>431a<span class="token operator">-</span>9b5e<span class="token operator">-</span>b2bbdc767606
DEVICE<span class="token operator">=</span>ens33
ONBOOT<span class="token operator">=</span>yes
IPADDR<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.201</span><span class="token number">.201</span><span class="token comment"># è™šæ‹Ÿæœºå¯¹åº”çš„ipåœ°å€</span>
NETMASK<span class="token operator">=</span><span class="token number">255.255</span><span class="token number">.255</span><span class="token number">.0</span>  <span class="token comment"># å­ç½‘æ©ç </span>
GATEWAY<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.201</span><span class="token number">.2</span><span class="token comment"># ç½‘å…³åœ°å€</span>
DNS1<span class="token operator">=</span><span class="token number">114.114</span><span class="token number">.114</span><span class="token number">.114</span>       <span class="token comment"># DNSæœåŠ¡å™¨åœ°å€</span>

</code></pre> 
<p><strong>ç„¶åé‡å¯ç½‘ç»œï¼š</strong></p> 
<pre><code class="prism language-python">service network restart
</code></pre> 
<p><strong>å†æ¬¡æµ‹è¯• ç½‘ç»œæ˜¯å¦èƒ½å¤Ÿæ­£å¸¸è”é€š</strong></p> 
<pre><code class="prism language-python">ping www<span class="token punctuation">.</span>baidu<span class="token punctuation">.</span>com
</code></pre> 
<h3><a id="2_59"></a>2ã€å…³é—­é˜²ç«å¢™</h3> 
<pre><code class="prism language-python"><span class="token comment">#å…³é—­é˜²ç«å¢™</span>
systemctl stop firewalld
<span class="token comment">#ç¦ç”¨é˜²ç«å¢™</span>
systemctl disable firewalld
<span class="token comment">#æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€</span>
systemctl status firewalld
</code></pre> 
<h3><a id="3Hadoop_70"></a><strong>3ã€é…ç½®ä¸»æœºåï¼ˆæ–¹ä¾¿åæœŸHadoopé›†ç¾¤æœåŠ¡ï¼‰</strong></h3> 
<pre><code class="prism language-python"><span class="token comment">#ç»™3å°è™šæ‹Ÿæœºè®¾ç½®ä¸»æœºååˆ†åˆ«ä¸ºhadoop01ã€hadoop02å’Œhadoop03ã€‚</span>
<span class="token comment">#åœ¨ç¬¬ä¸€å°æœºå™¨æ“ä½œ </span>
hostnamectl <span class="token builtin">set</span><span class="token operator">-</span>hostname hadoop01
<span class="token comment">#åœ¨ç¬¬äºŒå°æœºå™¨æ“ä½œ</span>
hostnamectl <span class="token builtin">set</span><span class="token operator">-</span>hostname hadoop02
<span class="token comment">#åœ¨ç¬¬ä¸‰å°æœºå™¨æ“ä½œ</span>
hostnamectl <span class="token builtin">set</span><span class="token operator">-</span>hostname hadoop03
</code></pre> 
<p><strong>è®¾ç½®å®Œæ¯•ååœ¨sshå·¥å…·å¤„åˆ·æ–°å³å¯</strong></p> 
<h3><a id="4hostsLinux_84"></a>4ã€ç¼–è¾‘hostså¤´æ–‡ä»¶ï¼ˆLinuxï¼‰</h3> 
<pre><code class="prism language-python">vi <span class="token operator">/</span>etc<span class="token operator">/</span>hosts  <span class="token comment"># ç¼–è¾‘hostsæ–‡ä»¶</span>
<span class="token comment"># åœ¨æœ€åä¸€è¡Œæ·»åŠ </span>
<span class="token number">192.168</span><span class="token number">.201</span><span class="token number">.201</span> hadoop01
<span class="token number">192.168</span><span class="token number">.201</span><span class="token number">.202</span> hadoop02
<span class="token number">192.168</span><span class="token number">.201</span><span class="token number">.203</span> hadoop03
</code></pre> 
<h3><a id="5hostswindows_94"></a>5ã€ç¼–è¾‘hostså¤´æ–‡ä»¶ï¼ˆwindowsï¼‰</h3> 
<pre><code class="prism language-python"><span class="token comment"># åœ¨Windowsä¸­æ‰“å¼€C:\Windows\System32\drivers\etcè·¯å¾„ï¼Œåœ¨hostsæ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</span>

<span class="token number">192.168</span><span class="token number">.201</span><span class="token number">.201</span> hadoop01
<span class="token number">192.168</span><span class="token number">.201</span><span class="token number">.202</span> hadoop02
<span class="token number">192.168</span><span class="token number">.201</span><span class="token number">.203</span> hadoop03
</code></pre> 
<h3><a id="6ssh_104"></a>6ã€sshå…å¯†ç™»å½•</h3> 
<pre><code class="prism language-python"><span class="token comment"># æ¯ä¸€ä¸ªæœºå™¨éƒ½éœ€è¦è¿™æ ·æ“ä½œ</span>
ssh<span class="token operator">-</span>keygen <span class="token operator">-</span>b <span class="token number">1024</span> <span class="token operator">-</span>t rsa

cd <span class="token punctuation">.</span>ssh

ssh<span class="token operator">-</span>copy<span class="token operator">-</span><span class="token builtin">id</span> hadoop01
ssh<span class="token operator">-</span>copy<span class="token operator">-</span><span class="token builtin">id</span> hadoop02
ssh<span class="token operator">-</span>copy<span class="token operator">-</span><span class="token builtin">id</span> hadoop03
</code></pre> 
<h3><a id="7_117"></a>7ã€ç¼–å†™é›†ç¾¤åˆ†å‘è„šæœ¬</h3> 
<pre><code class="prism language-python"><span class="token comment"># éœ€è¦åœ¨ç”¨æˆ·ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªbinæ–‡ä»¶å¤¹,ç„¶åå­˜æ”¾é›†ç¾¤åˆ†å‘è„šæœ¬xsync</span>
<span class="token comment"># ä¸ºä»€ä¹ˆè¦æ–°å»ºbinæ–‡ä»¶å¤¹çš„åŸå›  æ‰§è¡Œ   echo $PATH   æŸ¥çœ‹ç³»ç»Ÿç¯å¢ƒè·¯å¾„ èƒ½å¤Ÿå…¨å±€æ‰§è¡Œ</span>
<span class="token comment"># /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin</span>
mkdir <span class="token operator">/</span>root<span class="token operator">/</span><span class="token builtin">bin</span>
vim xsync
chmod <span class="token number">777</span> xsync

<span class="token comment"># å¦‚æœæŠ¥é”™</span>
<span class="token comment"># bash: rsync: command not found</span>
<span class="token comment"># rsync: connection unexpectedly closed (0 bytes received so far) [sender]</span>
<span class="token comment"># rsync error: remote command not found (code 127) at io.c(226) [sender=3.1.2]</span>
<span class="token comment"># ä¸‹è½½ rsync å³å¯ å› ä¸ºä½œè€…ä½¿ç”¨çš„ä»æœºä½¿ç”¨çš„æ˜¯æœ€å°åŒ–å®‰è£…ç‰ˆæœ¬ å› æ­¤éœ€è¦é¢å¤–å®‰è£…rsync</span>
yum <span class="token operator">-</span>y install rsync
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">#!/bin/bash</span>

<span class="token comment">#1. åˆ¤æ–­å‚æ•°ä¸ªæ•°</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> $<span class="token comment"># -lt 1 ]</span>
then
    echo Not Enough Arguement!
    exit<span class="token punctuation">;</span>
fi
<span class="token comment">#2. éå†é›†ç¾¤æ‰€æœ‰æœºå™¨</span>
<span class="token keyword">for</span> host <span class="token keyword">in</span> hadoop01 hadoop02 hadoop03
do
    echo <span class="token operator">-</span>e <span class="token string">"\n====================  $host  ===================="</span>
    <span class="token comment">#3. éå†æ‰€æœ‰ç›®å½•ï¼Œé€ä¸ªå‘é€</span>
    <span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> $@
    do
        <span class="token comment">#4. åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">-</span>e $<span class="token builtin">file</span> <span class="token punctuation">]</span>
            then
                <span class="token comment">#5. è·å–çˆ¶ç›®å½•</span>
                pdir<span class="token operator">=</span>$<span class="token punctuation">(</span>cd <span class="token operator">-</span>P $<span class="token punctuation">(</span>dirname $<span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">;</span> pwd<span class="token punctuation">)</span>
                <span class="token comment">#6. è·å–å½“å‰æ–‡ä»¶çš„åç§°</span>
                fname<span class="token operator">=</span>$<span class="token punctuation">(</span>basename $<span class="token builtin">file</span><span class="token punctuation">)</span>
                ssh $host <span class="token string">"mkdir -p $pdir"</span>
                rsync <span class="token operator">-</span>av $pdir<span class="token operator">/</span>$fname $host<span class="token punctuation">:</span>$pdir
            <span class="token keyword">else</span>
                echo $<span class="token builtin">file</span> does <span class="token keyword">not</span> exist!
        fi
    done
done
echo <span class="token operator">-</span>e <span class="token string">"\n"</span>
</code></pre> 
<h3><a id="8jps_168"></a>8ã€ç¼–å†™é›†ç¾¤æŸ¥çœ‹jpsè¿›è¡Œè„šæœ¬</h3> 
<pre><code class="prism language-python">cd <span class="token operator">~</span><span class="token operator">/</span><span class="token builtin">bin</span>
vim jpsall

<span class="token comment">#!/bin/bash</span>
<span class="token keyword">for</span> host <span class="token keyword">in</span> hadoop01 hadoop02 hadoop03
do
    echo <span class="token operator">-</span>e <span class="token string">"\n=============== $host ==============="</span>
    ssh $host <span class="token string">"export JAVA_HOME=/opt/module/jdk1.8.0_391 &amp;&amp; export PATH=\$JAVA_HOME/bin:\$PATH &amp;&amp; jps"</span>
done
echo <span class="token operator">-</span>e <span class="token string">"\n"</span>

<span class="token comment"># ä¿å­˜ ç»™æ–‡ä»¶èµ‹äºˆæ‰§è¡Œæƒé™</span>
chmod <span class="token number">777</span> jpsall
</code></pre> 
<h2><a id="jdk_186"></a>äºŒã€jdkå®‰è£…é…ç½®</h2> 
<pre><code class="prism language-python"><span class="token comment"># è§£å‹</span>
tar <span class="token operator">-</span>zxvf jdk<span class="token operator">-</span>8u391<span class="token operator">-</span>linux<span class="token operator">-</span>x64<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">-</span>C <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>

<span class="token comment"># è®¾ç½®ç¯å¢ƒå˜é‡</span>
vim <span class="token operator">/</span>etc<span class="token operator">/</span>profile 

<span class="token comment">#åœ¨æœ«å°¾è¿½åŠ ç¯å¢ƒå˜é‡</span>
export JAVA_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_391</span>
export PATH<span class="token operator">=</span>$JAVA_HOME<span class="token operator">/</span><span class="token builtin">bin</span><span class="token punctuation">:</span>$PATH

<span class="token comment"># ä½¿ç”¨é›†ç¾¤åˆ†å‘å‘½ä»¤ å°† ç¯å¢ƒå˜é‡ åˆ†å‘è‡³å…¶ä»–ä»æœº</span>
xsync <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment"># æ¿€æ´»ç¯å¢ƒå˜é‡</span>
source <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token punctuation">[</span>root@hadoop03 module<span class="token punctuation">]</span><span class="token comment"># java -version</span>
java version <span class="token string">"1.8.0_391"</span>
Java<span class="token punctuation">(</span>TM<span class="token punctuation">)</span> SE Runtime Environment <span class="token punctuation">(</span>build <span class="token number">1.8</span><span class="token number">.0_391</span><span class="token operator">-</span>b13<span class="token punctuation">)</span>
Java HotSpot<span class="token punctuation">(</span>TM<span class="token punctuation">)</span> <span class="token number">64</span><span class="token operator">-</span>Bit Server VM <span class="token punctuation">(</span>build <span class="token number">25.391</span><span class="token operator">-</span>b13<span class="token punctuation">,</span> mixed mode<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="zookeeper_211"></a>ä¸‰ã€zookeeperå®‰è£…é…ç½®</h2> 
<h3><a id="zookeeper__213"></a>zookeeperé›†ç¾¤ æ­å»º</h3> 
<pre><code class="prism language-python"><span class="token comment"># è§£å‹</span>
tar <span class="token operator">-</span>zxvf apache<span class="token operator">-</span>zookeeper<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.1</span><span class="token operator">-</span><span class="token builtin">bin</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">-</span>C <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>

cd <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>

mv apache<span class="token operator">-</span>zookeeper<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.1</span><span class="token operator">-</span><span class="token builtin">bin</span><span class="token operator">/</span> zookeeper<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.1</span>

cd zookeeper<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.1</span><span class="token operator">/</span>conf<span class="token operator">/</span>

<span class="token comment">#zké…ç½®æ–‡ä»¶æ˜¯ zoo.cfg ï¼Œåˆ›å»ºå¹¶é…ç½®</span>
mv zoo_sample<span class="token punctuation">.</span>cfg zoo<span class="token punctuation">.</span>cfg

vim zoo<span class="token punctuation">.</span>cfg

<span class="token comment"># ä¿®æ”¹</span>
dataDir<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>zookeeper<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.1</span><span class="token operator">/</span>data
<span class="token comment"># æ·»åŠ   å¯¹åº”ä¸»æœºåçš„idè¯†åˆ«å…¨å±€ç«¯å£</span>
server<span class="token punctuation">.</span><span class="token number">1</span><span class="token operator">=</span>hadoop01<span class="token punctuation">:</span><span class="token number">2888</span><span class="token punctuation">:</span><span class="token number">3888</span>
server<span class="token punctuation">.</span><span class="token number">2</span><span class="token operator">=</span>hadoop02<span class="token punctuation">:</span><span class="token number">2888</span><span class="token punctuation">:</span><span class="token number">3888</span>
server<span class="token punctuation">.</span><span class="token number">3</span><span class="token operator">=</span>hadoop03<span class="token punctuation">:</span><span class="token number">2888</span><span class="token punctuation">:</span><span class="token number">3888</span>
</code></pre> 
<hr> 
<aside>
  ğŸ’¡ è¯´æ˜ï¼šåœ¨zookeeper é›†ç¾¤ä¸­æœ‰ä¸‰ç§è§’è‰²ï¼šLeaderã€Follower å’Œ Observerï¼Œä½†åœ¨åŒä¸€æ—¶åˆ»åªä¼šæœ‰ä¸€ä¸ª Leaderï¼Œå…¶ä»–éƒ½æ˜¯ Follower æˆ– Observerã€‚ 
</aside> 
<hr> 
<pre><code class="prism language-python">cd <span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token comment"># åˆ›å»ºå­˜æ”¾æ•°æ®çš„æ–‡ä»¶å¤¹</span>
mkdir data
<span class="token comment"># åˆ›å»ºmyidç¼–å·</span>
echo <span class="token number">1</span> <span class="token operator">&gt;</span> data<span class="token operator">/</span>myid
</code></pre> 
<hr> 
<aside>
  ğŸ’¡ è¯´æ˜ï¼šå¯¹äºzooKeeperé›†ç¾¤æ¥è¯´ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½éœ€è¦é…ç½®ä¸€ä¸ªå”¯ä¸€çš„myidã€‚ç¡®ä¿æ¯ä¸ªèŠ‚ç‚¹éƒ½èƒ½è¢«æ­£ç¡®åœ°è¯†åˆ«å’Œè¯†åˆ«ä¸ºé›†ç¾¤çš„ä¸€éƒ¨åˆ†ã€‚ 
</aside> 
<hr> 
<pre><code class="prism language-python"><span class="token comment"># é…ç½®zookeeperç¯å¢ƒå˜é‡</span>
vim <span class="token operator">/</span>etc<span class="token operator">/</span>profile

export ZOOKEEPER_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>zookeeper<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.1</span>
export PATH<span class="token operator">=</span>$PATH<span class="token punctuation">:</span>$ZOOKEEPER_HOME<span class="token operator">/</span><span class="token builtin">bin</span>

<span class="token comment"># ä½¿ç”¨é›†ç¾¤åˆ†å‘å‘½ä»¤ å°† ç¯å¢ƒå˜é‡ åˆ†å‘è‡³å…¶ä»–ä»æœº</span>
xsync <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment"># æ¿€æ´»ç¯å¢ƒå˜é‡</span>
source <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment"># ä½¿ç”¨é›†ç¾¤åˆ†å‘å‘½ä»¤ å°† zookeeper åˆ†å‘è‡³å…¶ä»–ä»æœº</span>
xsync <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>zookeeper<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.1</span>

<span class="token comment"># åˆ†åˆ«ä¿®æ”¹ hadoop02 å’Œ hadoop03 çš„ myid ç¼–å·</span>
<span class="token punctuation">[</span>root@hadoop02 module<span class="token punctuation">]</span><span class="token comment"># echo 2 &gt; /opt/module/zookeeper-3.7.1/data/myid</span>
<span class="token punctuation">[</span>root@hadoop03 module<span class="token punctuation">]</span><span class="token comment"># echo 3 &gt; /opt/module/zookeeper-3.7.1/data/myid</span>

<span class="token comment">#æ‰€æœ‰èŠ‚ç‚¹å¯åŠ¨ï¼Œéœ€è¦åœ¨æ¯ä¸ªèŠ‚ç‚¹æ‰§è¡Œ</span>
zkServer<span class="token punctuation">.</span>sh start
</code></pre> 
<h3><a id="zookeeper__288"></a>zookeeperé›†ç¾¤ å¯åŠ¨å‘½ä»¤</h3> 
<pre><code class="prism language-python"><span class="token comment"># ç¼–å†™è„šæœ¬å¯¹zookeeperé›†ç¾¤å®ç°æ‰¹é‡å¯åŠ¨ï¼Œåœæ­¢ï¼Œé‡å¯</span>
<span class="token comment"># åœ¨ ç”¨æˆ·ç›®å½•ä¸‹çš„ bin æ–‡ä»¶ä¸‹ åˆ›å»ºé›†ç¾¤å¯åŠ¨æ–‡ä»¶</span>

cd <span class="token operator">/</span>root<span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span>

vim zkserver

<span class="token comment">#!/bin/bash</span>
echo <span class="token string">"$1 zkServer ..."</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">{<!-- --></span>hadoop02<span class="token punctuation">,</span>hadoop01<span class="token punctuation">,</span>hadoop03<span class="token punctuation">}</span>
do
        ssh $i <span class="token string">"source /etc/profile &amp;&amp; zkServer.sh $1"</span>
done

<span class="token comment"># ç»™æ–‡ä»¶èµ‹äºˆæƒé™</span>
chmod <span class="token number">777</span> zkserver
</code></pre> 
<p><img src="https://images2.imgbox.com/42/22/3UElxQA7_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202311281105486.png"></p> 
<h3><a id="zookeeper__311"></a>zookeeperé›†ç¾¤ çŠ¶æ€æ£€æŸ¥å‘½ä»¤</h3> 
<pre><code class="prism language-python"><span class="token comment"># é€šè¿‡ç¼–å†™è„šæœ¬å®ç°æ‰¹é‡æ£€æŸ¥</span>
vim zkstatus

<span class="token comment">#!/bin/bash</span>
<span class="token keyword">for</span> host <span class="token keyword">in</span> <span class="token punctuation">{<!-- --></span>hadoop02<span class="token punctuation">,</span>hadoop01<span class="token punctuation">,</span>hadoop03<span class="token punctuation">}</span>
do
        status<span class="token operator">=</span>$<span class="token punctuation">(</span>ssh $host <span class="token string">'source /etc/profile &amp;&amp; zkServer.sh status 2&gt;&amp;1 | grep  Mode'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> $status <span class="token operator">==</span> <span class="token string">"Mode: follower"</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>then
                echo <span class="token string">"$hostæ˜¯ä»èŠ‚ç‚¹"</span>
        <span class="token keyword">elif</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> $status <span class="token operator">==</span> <span class="token string">"Mode: leader"</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>then
                echo <span class="token string">"$hostæ˜¯ä¸»èŠ‚ç‚¹"</span>
        <span class="token keyword">else</span>
                echo <span class="token string">"æœªæŸ¥è¯¢åˆ°$hostèŠ‚ç‚¹zookeeperçŠ¶æ€,è¯·æ£€æŸ¥æœåŠ¡"</span>
        fi
done

<span class="token comment"># ç»™æ–‡ä»¶èµ‹äºˆæƒé™</span>
chmod <span class="token number">777</span> zkstatus
</code></pre> 
<p><img src="https://images2.imgbox.com/b0/05/MjvQRw9m_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202311281102350.png"></p> 
<h2><a id="hadoop_336"></a>å››ã€hadoopæ­å»ºé›†ç¾¤</h2> 
<h3><a id="_338"></a>ä¸»æœºç¯å¢ƒé…ç½®</h3> 
<pre><code class="prism language-python">
cd <span class="token operator">/</span>opt<span class="token operator">/</span>software<span class="token operator">/</span>

tar <span class="token operator">-</span>zxvf hadoop<span class="token operator">-</span><span class="token number">3.3</span><span class="token number">.5</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">-</span>C <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>

<span class="token comment"># é…ç½® hadoop ç¯å¢ƒå˜é‡</span>
vim <span class="token operator">/</span>etc<span class="token operator">/</span>profile

export HADOOP_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hadoop<span class="token operator">-</span><span class="token number">3.3</span><span class="token number">.5</span>
export PATH<span class="token operator">=</span>$PATH<span class="token punctuation">:</span>$HADOOP_HOME<span class="token operator">/</span><span class="token builtin">bin</span><span class="token punctuation">:</span>$HADOOP_HOME<span class="token operator">/</span>sbin

<span class="token comment"># æ¿€æ´»ç¯å¢ƒå˜é‡</span>
source <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token punctuation">[</span>root@hadoop01 software<span class="token punctuation">]</span><span class="token comment"># hadoop version</span>
Hadoop <span class="token number">3.3</span><span class="token number">.5</span>
Source code repository https<span class="token punctuation">:</span><span class="token operator">//</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>apache<span class="token operator">/</span>hadoop<span class="token punctuation">.</span>git <span class="token operator">-</span>r 706d88266abcee09ed78fbaa0ad5f74d818ab0e9
Compiled by stevel on <span class="token number">2023</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span>15T15<span class="token punctuation">:</span>56Z
Compiled <span class="token keyword">with</span> protoc <span class="token number">3.7</span><span class="token number">.1</span>
From source <span class="token keyword">with</span> checksum 6bbd9afcf4838a0eb12a5f189e9bd7
</code></pre> 
<h3><a id="hadoop_hdfs_363"></a>ç¼–è¾‘hadoop hdfsæ ¸å¿ƒé…ç½®æ–‡ä»¶</h3> 
<h4><a id="workers_365"></a>ç¼–è¾‘ä¸»æœºworkersæ–‡ä»¶</h4> 
<pre><code class="prism language-python">vim workers

<span class="token comment">#å¡«å…¥ä»æœºå</span>
hadoop01
hadoop02
hadoop03
</code></pre> 
<h4><a id="coresitexml_376"></a>ä¿®æ”¹core-site.xmlæ–‡ä»¶</h4> 
<pre><code class="prism language-python">vim core<span class="token operator">-</span>site<span class="token punctuation">.</span>xml

<span class="token operator">&lt;</span>configuration<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>é…ç½®é»˜è®¤çš„æ–‡ä»¶ç³»ç»Ÿ<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>fs<span class="token punctuation">.</span>defaultFS<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>ç”¨çš„æ˜¯HDFSä½œä¸ºæ–‡ä»¶ç³»ç»Ÿï¼Œè¿˜è¦æŒ‡å®šHDFSæ”¾åœ¨å“ªå°ä¸»æœºä¸Šè¿è¡Œï¼Œ<span class="token number">9000</span>é»˜è®¤ç«¯å£å·<span class="token punctuation">,</span>å¦‚æœé…ç½®äº†HA<span class="token punctuation">,</span>fs<span class="token punctuation">.</span>defaultFsçš„å€¼åº”è¯¥æ˜¯nameserviceçš„åç§°ï¼Œå¦‚hdfs<span class="token operator">-</span>site<span class="token punctuation">.</span>xmlæ–‡ä»¶ä¸­dfs<span class="token punctuation">.</span>nameservicesçš„
å€¼ä¸ºmyclusterï¼Œæ­¤å¤„å¡«å†™hdfs<span class="token punctuation">:</span><span class="token operator">//</span>mycluster<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hdfs<span class="token punctuation">:</span><span class="token operator">//</span>mycluster<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hadoop<span class="token punctuation">.</span>tmp<span class="token punctuation">.</span><span class="token builtin">dir</span><span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token operator">/</span>data<span class="token operator">/</span>hadoop<span class="token operator">/</span>tmp<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>ha<span class="token punctuation">.</span>zookeeper<span class="token punctuation">.</span>quorum<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>HDFSè¿æ¥zookeeperé›†ç¾¤çš„åœ°å€å’Œç«¯å£<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop01<span class="token punctuation">:</span><span class="token number">2181</span><span class="token punctuation">,</span>hadoop02<span class="token punctuation">:</span><span class="token number">2181</span><span class="token punctuation">,</span>hadoop03<span class="token punctuation">:</span><span class="token number">2181</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>ipc<span class="token punctuation">.</span>client<span class="token punctuation">.</span>connect<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">.</span>retries<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>è®¾ç½®é‡è¿æ¬¡æ•°ï¼Œé»˜è®¤<span class="token number">10</span>æ¬¡<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">100</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>ipc<span class="token punctuation">.</span>client<span class="token punctuation">.</span>connect<span class="token punctuation">.</span>retry<span class="token punctuation">.</span>interval<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>è®¾ç½®å®¢æˆ·ç«¯åœ¨é‡è¯•å»ºç«‹æœåŠ¡å™¨è¿æ¥ä¹‹å‰ç­‰å¾…çš„æ¯«ç§’æ•°ï¼Œé»˜è®¤<span class="token number">1000</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">10000</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>io<span class="token punctuation">.</span><span class="token builtin">file</span><span class="token punctuation">.</span><span class="token builtin">buffer</span><span class="token punctuation">.</span>size<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>è®¾ç½®åœ¨è¯»å†™æ•°æ®æ—¶çš„ç¼“å­˜å¤§å°<span class="token punctuation">,</span>è¿™ä¸ªç¼“å­˜åŒºçš„å¤§å°åº”è¯¥æ˜¯ç¡¬ä»¶é¡µé¢å¤§å°çš„å€æ•°ï¼ˆåœ¨ Intel x86 ä¸Šæ˜¯ <span class="token number">4096</span>ï¼‰ï¼Œå®ƒå†³å®šäº†åœ¨è¯»å†™æ“ä½œä¸­ç¼“å†²äº†å¤šå°‘æ•°æ®ã€‚è¾ƒå¤§çš„ç¼“å­˜å¯ä»¥æä¾›æ›´é«˜çš„æ•°æ®ä¼ è¾“<span class="token operator">&gt;</span>
ï¼Œä½†è¿™ä¹Ÿæ„å‘³ç€æ›´å¤§çš„å†…å­˜æ¶ˆè€—å’Œå»¶è¿Ÿ<span class="token punctuation">.</span>é»˜è®¤æƒ…å†µä¸‹ï¼Œio<span class="token punctuation">.</span><span class="token builtin">file</span><span class="token punctuation">.</span><span class="token builtin">buffer</span><span class="token punctuation">.</span>size çš„å€¼ä¸º <span class="token number">4096</span>ï¼Œä½†æ˜¯å»ºè®®å°†å…¶è®¾ç½®ä¸º<span class="token number">65536</span>ï¼ˆ64kï¼‰<span class="token punctuation">,</span>ä¹Ÿå¯ä»¥è®¾ç½®æ›´é«˜ï¼Œæ¯”å¦‚<span class="token number">131702</span>ç­‰<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">65536</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>configuration<span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="hdfssitexml_422"></a>é…ç½®hdfs-site.xmlæ–‡ä»¶</h4> 
<pre><code class="prism language-python">vim hdfs<span class="token operator">-</span>site<span class="token punctuation">.</span>xml

<span class="token operator">&lt;</span>configuration<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>nameservices<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>å®šä¹‰hdfsé›†ç¾¤<span class="token builtin">id</span>å·ï¼Œéœ€è¦å’Œcore<span class="token operator">-</span>site<span class="token punctuation">.</span>xmlä¸­çš„fs<span class="token punctuation">.</span>defaultFSä¿æŒä¸€è‡´<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>mycluster<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>ha<span class="token punctuation">.</span>namenodes<span class="token punctuation">.</span>mycluster<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>å®šä¹‰hdfsé›†ç¾¤ä¸­çš„namenodeçš„<span class="token builtin">id</span>å·<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>nn1<span class="token punctuation">,</span>nn2<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>namenode<span class="token punctuation">.</span>rpc<span class="token operator">-</span>address<span class="token punctuation">.</span>mycluster<span class="token punctuation">.</span>nn1<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>nn1çš„RPCé€šä¿¡åœ°å€<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop01<span class="token punctuation">:</span><span class="token number">9000</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>namenode<span class="token punctuation">.</span>http<span class="token operator">-</span>address<span class="token punctuation">.</span>mycluster<span class="token punctuation">.</span>nn1<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>nn1çš„httpé€šä¿¡åœ°å€<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop01<span class="token punctuation">:</span><span class="token number">50070</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>namenode<span class="token punctuation">.</span>rpc<span class="token operator">-</span>address<span class="token punctuation">.</span>mycluster<span class="token punctuation">.</span>nn2<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop02<span class="token punctuation">:</span><span class="token number">9000</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>namenode<span class="token punctuation">.</span>http<span class="token operator">-</span>address<span class="token punctuation">.</span>mycluster<span class="token punctuation">.</span>nn2<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop02<span class="token punctuation">:</span><span class="token number">50070</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>namenode<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token builtin">dir</span><span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token operator">/</span>data<span class="token operator">/</span>hadoop<span class="token operator">/</span>hdfs<span class="token operator">/</span>namenode<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>description<span class="token operator">&gt;</span>namenodeä¸Šå­˜å‚¨hdfså‘½åç©ºé—´å…ƒæ•°æ®<span class="token operator">&lt;</span><span class="token operator">/</span>description<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>datanode<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token builtin">dir</span><span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token operator">/</span>data<span class="token operator">/</span>hadoop<span class="token operator">/</span>hdfs<span class="token operator">/</span>datanode<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>description<span class="token operator">&gt;</span>datanodeä¸Šæ•°æ®å—çš„ç‰©ç†å­˜å‚¨ä½ç½®<span class="token operator">&lt;</span><span class="token operator">/</span>description<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>replication<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">3</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>description<span class="token operator">&gt;</span>å‰¯æœ¬ä¸ªæ•°ï¼Œé»˜è®¤æ˜¯<span class="token number">3</span><span class="token punctuation">,</span>åº”å°äºdatanodeæ•°é‡<span class="token operator">&lt;</span><span class="token operator">/</span>description<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>å¦‚æœæƒ³è®©solrç´¢å¼•å­˜æ”¾åˆ°hdfsä¸­ï¼Œåˆ™è¿˜é¡»æ·»åŠ ä¸‹é¢<span class="token number">2</span>ä¸ªå±æ€§<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>webhdfs<span class="token punctuation">.</span>enabled<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>permissions<span class="token punctuation">.</span>enabled<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>ç”¨äºå¯ç”¨æˆ–ç¦ç”¨ HDFS ACLï¼ˆç®€å•æƒé™ï¼‰ã€‚å½“ dfs<span class="token punctuation">.</span>permissions<span class="token punctuation">.</span>enabled è®¾ç½®ä¸º false æ—¶ï¼Œä»»ä½•ç”¨æˆ·éƒ½å¯ä»¥åœ¨ HDFS ä¸­çš„ä»»ä½•ä½ç½®åˆ›å»ºæˆ–åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ã€‚å°†æ­¤å±æ€§è®¾ç½®ä¸º false åï¼Œæ‚¨
å¯ä»¥è®¿é—®æ‰€æœ‰å…¶ä»– Hadoop æœåŠ¡ï¼Œä¾‹å¦‚ Hiveã€HBase ç­‰<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>false<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>datanode<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">.</span>transfer<span class="token punctuation">.</span>threads<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">4096</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>ç”¨äºè®¾ç½® DataNode åœ¨è¿›è¡Œæ–‡ä»¶ä¼ è¾“æ—¶çš„æœ€å¤§çº¿ç¨‹æ•°<span class="token punctuation">.</span> å¦‚æœé›†ç¾¤ä¸­æœ‰æŸå° DataNode ä¸»æœºçš„è¿™ä¸ªå€¼æ¯”å…¶ä»–ä¸»æœºçš„å¤§ï¼Œé‚£ä¹ˆå‡ºç°çš„é—®é¢˜æ˜¯ï¼Œè¿™å°ä¸»æœºä¸Šå­˜å‚¨çš„æ•°æ®ç›¸å¯¹åˆ«çš„ä¸»æœºæ¯”è¾ƒå¤šï¼Œå¯¼è‡´
æ•°æ®åˆ†å¸ƒä¸å‡åŒ€çš„é—®é¢˜ï¼Œå³ä½¿ balance ä»ç„¶ä¼šä¸å‡åŒ€<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>ha<span class="token punctuation">.</span>fencing<span class="token punctuation">.</span>methods<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> HDFSé›†ç¾¤ä¸­ä¸¤ä¸ªnamenodeåˆ‡æ¢çŠ¶æ€æ—¶çš„éš”ç¦»æ–¹æ³• <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>sshfence<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>ha<span class="token punctuation">.</span>fencing<span class="token punctuation">.</span>ssh<span class="token punctuation">.</span>private<span class="token operator">-</span>key<span class="token operator">-</span>files<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> HDFSé›†ç¾¤ä¸­ä¸¤ä¸ªnamenodeåˆ‡æ¢çŠ¶æ€æ—¶çš„éš”ç¦»æ–¹æ³•çš„å¯†é’¥ <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token operator">/</span>root<span class="token operator">/</span><span class="token punctuation">.</span>ssh<span class="token operator">/</span>id_rsa<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>ha<span class="token punctuation">.</span>automatic<span class="token operator">-</span>failover<span class="token punctuation">.</span>enabled<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> æ•…éšœè‡ªåŠ¨è½¬ç§»ï¼ŒHAçš„HDFSé›†ç¾¤è‡ªåŠ¨åˆ‡æ¢namenodeçš„å¼€å…³<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>namenode<span class="token punctuation">.</span>shared<span class="token punctuation">.</span>edits<span class="token punctuation">.</span><span class="token builtin">dir</span><span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> æŒ‡å®šNameNodeçš„å…ƒæ•°æ®åœ¨JournalNodeä¸Šçš„å­˜æ”¾ä½ç½® <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>qjournal<span class="token punctuation">:</span><span class="token operator">//</span>hadoop01<span class="token punctuation">:</span><span class="token number">8485</span><span class="token punctuation">;</span>hadoop02<span class="token punctuation">:</span><span class="token number">8485</span><span class="token operator">/</span>mycluster<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>dfs<span class="token punctuation">.</span>journalnode<span class="token punctuation">.</span>edits<span class="token punctuation">.</span><span class="token builtin">dir</span><span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> journalnodeé›†ç¾¤ä¸­ç”¨äºä¿å­˜editsæ–‡ä»¶çš„ç›®å½• <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token operator">/</span>data<span class="token operator">/</span>hadoop<span class="token operator">/</span>hdfs<span class="token operator">/</span>ha<span class="token operator">/</span>jn<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>configuration<span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="hadoopenvsh_535"></a>ä¿®æ”¹hadoop-env.shæ–‡ä»¶</h4> 
<pre><code class="prism language-python">vim hadoop<span class="token operator">-</span>env<span class="token punctuation">.</span>sh

<span class="token comment">#ä¿®æ”¹JAVA_HOMEçš„è·¯å¾„</span>
export JAVA_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_391</span>  
</code></pre> 
<h4><a id="hdfsroot_544"></a><em>è®¾ç½®hdfsé›†ç¾¤å¯åŠ¨æ—¶ï¼Œå…è®¸rootç”¨æˆ·å¯åŠ¨</em></h4> 
<pre><code class="prism language-python">vim <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment">#è®¾ç½®hdfsé›†ç¾¤å¯åŠ¨æ—¶ï¼Œå…è®¸rootç”¨æˆ·å¯åŠ¨</span>
HDFS_NAMENODE_USER<span class="token operator">=</span>root
export HDFS_NAMENODE_USER
HDFS_DATANODE_USER<span class="token operator">=</span>root
export HDFS_DATANODE_USER
HDFS_JOURNALNODE_USER<span class="token operator">=</span>root
export HDFS_JOURNALNODE_USER
HDFS_ZKFC_USER<span class="token operator">=</span>root
export HDFS_ZKFC_USER

<span class="token comment"># æ¿€æ´»ç¯å¢ƒå˜é‡</span>
source <span class="token operator">/</span>etc<span class="token operator">/</span>profile
</code></pre> 
<h4><a id="hadoop_hdfs_563"></a>å¯åŠ¨hadoop hdfsç³»ç»Ÿ</h4> 
<pre><code class="prism language-python"><span class="token comment"># ä½¿ç”¨é›†ç¾¤åˆ†å‘å‘½ä»¤ å°† hadoop ä»¥åŠ ç¯å¢ƒå˜é‡ åˆ†å‘è‡³å…¶ä»–ä»æœº</span>
xsync <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hadoop<span class="token operator">-</span><span class="token number">3.3</span><span class="token number">.5</span>
xsync <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment"># æ¿€æ´»ç¯å¢ƒå˜é‡</span>
source <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment">#å¯åŠ¨JN,æ ¼å¼åŒ–ä¹‹å‰è¦ä¼˜å…ˆå¯åŠ¨JN,ç°åœ¨æ˜¯ä¸¤ä¸ªnnï¼Œè¦é€šè¿‡JNä¼ é€’æ•°æ®ã€‚</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># hdfs --daemon start journalnode</span>
<span class="token punctuation">[</span>root@hadoop02 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># hdfs --daemon start journalnode</span>
<span class="token comment"># ç”±äºæ²¡æœ‰äº‹å…ˆåˆ›å»ºlogsæ–‡ä»¶å¤¹,å› æ­¤ä¼šè‡ªåŠ¨åˆ›å»º</span>
<span class="token comment"># WARNING: /opt/module/hadoop-3.3.5/logs does not exist. Creating.</span>

<span class="token comment"># æ ¼å¼åŒ–NNï¼Œå°†hadoop01ä½œä¸ºä¸»èŠ‚ç‚¹</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># hdfs namenode -format</span>

<span class="token comment"># æ ¼å¼åŒ–NameNodeä¼šåœ¨æŒ‡å®šçš„NameNodeæ•°æ®ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªåä¸ºcurrentçš„å­ç›®å½•ï¼Œç”¨äºå­˜å‚¨NameNodeçš„å…ƒæ•°æ®å’Œå‘½åç©ºé—´ä¿¡æ¯</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># ll /data/hadoop/hdfs/namenode/</span>
total <span class="token number">0</span>
drwx<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">.</span> <span class="token number">2</span> root root <span class="token number">112</span> Nov <span class="token number">28</span> <span class="token number">04</span><span class="token punctuation">:</span><span class="token number">26</span> current

<span class="token comment"># hadoop02ä¸Šçš„nnä½œä¸ºä¸»å¤‡ï¼Œåœ¨hadoop02æ‰§è¡Œæ‹·è´å…ƒæ•°æ®ä¹‹å‰ï¼Œéœ€è¦å…ˆå¯åŠ¨hadoop01ä¸Šçš„namanode</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># hdfs --daemon start namenode</span>

<span class="token comment"># æ‹·è´å…ƒæ•°æ®ï¼Œåœ¨Hadoop HDFSä¸­åˆå§‹åŒ–ä¸€ä¸ªå¤‡ç”¨çš„NameNodeèŠ‚ç‚¹ã€‚å½“ä¸»è¦çš„NameNodeèŠ‚ç‚¹å‡ºç°æ•…éšœæ—¶ï¼Œå¤‡ç”¨çš„NameNodeèŠ‚ç‚¹å°±å¯ä»¥å¿«é€Ÿå¯åŠ¨å¹¶æ¥ç®¡æœåŠ¡ï¼Œè€Œæ— éœ€é‡æ–°åŠ è½½æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿçš„å…ƒæ•°æ®ï¼Œæä¾›é«˜å¯ç”¨æ€§ã€‚</span>
<span class="token comment"># æ³¨æ„åœ¨hadoop02ä¸Šæ‰§è¡Œ</span>
<span class="token punctuation">[</span>root@hadoop02 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># hdfs namenode -bootstrapStandby</span>
</code></pre> 
<p><strong>åœ¨hadoop02ä¸Šï¼Œæ‰§è¡Œå…ƒæ•°æ®å¤åˆ¶</strong></p> 
<p><img src="https://images2.imgbox.com/2e/d1/rMUvn4jw_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202311281047887.png"></p> 
<pre><code class="prism language-python"><span class="token comment"># å¯åŠ¨hadoop02ä¸Šçš„namenode</span>
<span class="token punctuation">[</span>root@hadoop02 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># hdfs --daemon start namenode</span>

<span class="token comment"># æ ¼å¼åŒ–zkï¼Œç”¨äºç›‘æ§å’Œç®¡ç†Hadoop HDFSä¸­çš„ä¸»å¤‡NameNodeèŠ‚ç‚¹åˆ‡æ¢çš„ç»„ä»¶ã€‚æ­¤å‘½ä»¤ä¼šåˆ›å»ºä¸€ä¸ªZooKeeperç›®å½•ç»“æ„ï¼Œå¹¶å°†åˆå§‹çš„ä¸»å¤‡NameNodeèŠ‚ç‚¹ä¿¡æ¯å­˜å‚¨åœ¨ZooKeeperä¸­ã€‚è¿™æ ·ï¼ŒZKFCå°±å¯ä»¥ä½¿ç”¨ZooKeeperæ¥è¿›è¡Œä¸»å¤‡èŠ‚ç‚¹çš„ç®¡ç†å’Œåˆ‡æ¢ã€‚</span>
<span class="token comment"># åœ¨è®¾ç½®Hadoop HDFSçš„é«˜å¯ç”¨æ€§ç¯å¢ƒæ—¶ï¼Œéœ€è¦å…ˆä½¿ç”¨hdfs namenode -bootstrapStandbyå‘½ä»¤åˆå§‹åŒ–å¤‡ç”¨çš„NameNodeèŠ‚ç‚¹ï¼Œç„¶åä½¿ç”¨hdfs zkfc -formatZK å‘½ä»¤åˆå§‹åŒ–ZKFCã€‚è¿™ä¸¤ä¸ªå‘½ä»¤çš„ç»„åˆå¯ä»¥ç¡®ä¿Hadoop HDFSçš„ä¸»å¤‡èŠ‚ç‚¹åˆ‡æ¢çš„å¯é æ€§å’Œé«˜å¯ç”¨æ€§ã€‚</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># hdfs zkfc -formatZK</span>

<span class="token comment"># æ³¨æ„ æ‰§è¡Œä¸Šè¿°æ­¥éª¤å‰,éœ€è¦å…ˆå¼€å¯zookeeperé›†ç¾¤æœåŠ¡ï¼ï¼ï¼</span>

<span class="token comment"># å¯åŠ¨zkå®¢æˆ·ç«¯  </span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># zkCli.sh</span>

<span class="token comment"># å¯ä»¥é€šè¿‡lsæŸ¥çœ‹ç›®å½•ç»“æ„</span>
<span class="token punctuation">[</span>zk<span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">2181</span><span class="token punctuation">(</span>CONNECTED<span class="token punctuation">)</span> <span class="token number">5</span><span class="token punctuation">]</span> ls <span class="token operator">/</span>
<span class="token punctuation">[</span>hadoop<span class="token operator">-</span>ha<span class="token punctuation">,</span> zookeeper<span class="token punctuation">]</span>

<span class="token comment"># quit é€€å‡ºå®¢æˆ·ç«¯</span>

<span class="token comment"># å¯åŠ¨ datanode æˆ–è€…ä½¿ç”¨ä¸‹é¢ç”¨é›†ç¾¤å‘½ä»¤ start-dfs.sh ä¸€é”®å¯åŠ¨æ‰€æœ‰æœåŠ¡</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># hdfs --daemon start datanode</span>

<span class="token comment"># æ³¨æ„ï¼šä»¥åå¯åŠ¨ hdfs å°±åªéœ€è¦å…ˆå¯åŠ¨ zookeeperï¼Œç„¶åæ‰§è¡Œ start-dfs.sh å°±å¯ä»¥äº†</span>
<span class="token comment"># å¯åŠ¨ zookeeper åªéœ€è¦ æ‰§è¡Œ zkserver start å³å¯</span>

<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># start-dfs.sh</span>
Starting namenodes on <span class="token punctuation">[</span>hadoop01 hadoop02<span class="token punctuation">]</span>
Last login<span class="token punctuation">:</span> Tue Nov <span class="token number">28</span> <span class="token number">11</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token number">37</span> CST <span class="token number">2023</span> <span class="token keyword">from</span> <span class="token number">192.168</span><span class="token number">.201</span><span class="token number">.1</span> on pts<span class="token operator">/</span><span class="token number">0</span>
Starting datanodes
Last login<span class="token punctuation">:</span> Tue Nov <span class="token number">28</span> <span class="token number">11</span><span class="token punctuation">:</span><span class="token number">17</span><span class="token punctuation">:</span><span class="token number">31</span> CST <span class="token number">2023</span> on pts<span class="token operator">/</span><span class="token number">0</span>
Starting journal nodes <span class="token punctuation">[</span>hadoop02 hadoop01<span class="token punctuation">]</span>
Last login<span class="token punctuation">:</span> Tue Nov <span class="token number">28</span> <span class="token number">11</span><span class="token punctuation">:</span><span class="token number">17</span><span class="token punctuation">:</span><span class="token number">34</span> CST <span class="token number">2023</span> on pts<span class="token operator">/</span><span class="token number">0</span>
Starting ZK Failover Controllers on NN hosts <span class="token punctuation">[</span>hadoop01 hadoop02<span class="token punctuation">]</span>
Last login<span class="token punctuation">:</span> Tue Nov <span class="token number">28</span> <span class="token number">11</span><span class="token punctuation">:</span><span class="token number">18</span><span class="token punctuation">:</span><span class="token number">02</span> CST <span class="token number">2023</span> on pts<span class="token operator">/</span><span class="token number">0</span>

<span class="token comment"># éªŒè¯é«˜å¯ç”¨</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># hdfs haadmin -getServiceState nn1</span>
active
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># hdfs haadmin -getServiceState nn2</span>
standby

<span class="token comment"># å¦‚æœä¸¤å°éƒ½æ˜¯standbyï¼Œå¯ä»¥é€šè¿‡ hdfs haadmin -transitionToActive --forcemanual nn1 å‘½ä»¤å¼ºåˆ¶å°†nn1è½¬æ¢ä¸ºä¸ºactive</span>

<span class="token comment"># è®¿é—®é¡µé¢éªŒè¯ </span>
<span class="token comment"># åˆ°æµè§ˆå™¨è®¿é—®ï¼Œhadoop01:50070 (192.168.201.201:50070) å’Œ (hadoop01:50070) 192.168.201.202:50070 éªŒè¯</span>

<span class="token comment"># å¦‚æœå‡ºç°ä¸»ä»èŠ‚ç‚¹çŠ¶æ€ä¸æ­£å¸¸çš„æƒ…å†µï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># hdfs haadmin -failover nn2 nn1</span>
Failover to NameNode at hadoop01<span class="token operator">/</span><span class="token number">192.168</span><span class="token number">.201</span><span class="token number">.201</span><span class="token punctuation">:</span><span class="token number">9000</span> successful
</code></pre> 
<p><img src="https://images2.imgbox.com/9c/fb/SKuc9fZb_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202311281121200.png"></p> 
<h3><a id="hadoop_yarn_652"></a>ç¼–è¾‘hadoop yarnæ ¸å¿ƒé…ç½®æ–‡ä»¶</h3> 
<h4><a id="mapredsitexml_654"></a>ç¼–è¾‘mapred-site.xmlæ–‡ä»¶</h4> 
<pre><code class="prism language-python"><span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># cd /opt/module/hadoop-3.3.5/etc/hadoop/</span>

vim mapred<span class="token operator">-</span>site<span class="token punctuation">.</span>xml

<span class="token comment"># æ·»åŠ ä»¥ä¸‹é…ç½®</span>
<span class="token operator">&lt;</span>configuration<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>mapreduce<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>name<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>yarn<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>description<span class="token operator">&gt;</span>æŒ‡å®šmapreduceä½¿ç”¨yarnæ¡†æ¶<span class="token operator">&lt;</span><span class="token operator">/</span>description<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>configuration<span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="yarnsitexml_671"></a>ç¼–è¾‘yarn-site.xmlæ–‡ä»¶</h4> 
<pre><code class="prism language-python">vim yarn<span class="token operator">-</span>site<span class="token punctuation">.</span>xml

<span class="token operator">&lt;</span>configuration<span class="token operator">&gt;</span>
<span class="token comment"># è¿™é‡Œæ˜¯åœ¨æ–‡ä»¶åŒ…ç€çš„é‡Œé¢å†™å…¥å†…å®¹ ï¼ï¼ï¼</span>
<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> Site specific YARN configuration properties <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>nodemanager<span class="token punctuation">.</span>aux<span class="token operator">-</span>services<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>mapreduce_shuffle<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>ha<span class="token punctuation">.</span>enabled<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>description<span class="token operator">&gt;</span>æ˜¯å¦å¼€å¯é«˜å¯ç”¨<span class="token operator">&lt;</span><span class="token operator">/</span>description<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>cluster<span class="token operator">-</span><span class="token builtin">id</span><span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>yrc<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>ha<span class="token punctuation">.</span>rm<span class="token operator">-</span>ids<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>rm1<span class="token punctuation">,</span>rm2<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>hostname<span class="token punctuation">.</span>rm1<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop01<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>hostname<span class="token punctuation">.</span>rm2<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop02<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> æŒ‡å®š rm çš„å†…éƒ¨é€šä¿¡åœ°å€ <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span> 
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span> 
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>address<span class="token punctuation">.</span>rm1<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>  
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop01<span class="token punctuation">:</span><span class="token number">8032</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span> 
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>  
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span> 
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>address<span class="token punctuation">.</span>rm2<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>  
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop02<span class="token punctuation">:</span><span class="token number">8032</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span> 
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span> 
	
	<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> æŒ‡å®š AM å‘ rm ç”³è¯·èµ„æºçš„åœ°å€ <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>  
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span> 
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>address<span class="token punctuation">.</span>rm1<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>  
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop01<span class="token punctuation">:</span><span class="token number">8030</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span> 
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>  
	
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span> 
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>address<span class="token punctuation">.</span>rm2<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>  
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop02<span class="token punctuation">:</span><span class="token number">8030</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span> 
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> æŒ‡å®šä¾› NM è¿æ¥çš„åœ°å€ <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>  
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span> 
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>resource<span class="token operator">-</span>tracker<span class="token punctuation">.</span>address<span class="token punctuation">.</span>rm1<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>  
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop01<span class="token punctuation">:</span><span class="token number">8031</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span> 
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>  
	
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span> 
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>resource<span class="token operator">-</span>tracker<span class="token punctuation">.</span>address<span class="token punctuation">.</span>rm2<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>  
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop02<span class="token punctuation">:</span><span class="token number">8031</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span> 
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>    
	
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>zk<span class="token operator">-</span>address<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop01<span class="token punctuation">:</span><span class="token number">2181</span><span class="token punctuation">,</span>hadoop02<span class="token punctuation">:</span><span class="token number">2181</span><span class="token punctuation">,</span>hadoop03<span class="token punctuation">:</span><span class="token number">2181</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> å¯ç”¨è‡ªåŠ¨æ¢å¤ <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>  
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span> 
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>recovery<span class="token punctuation">.</span>enabled<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>  
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span> 
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>  
	
	<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> æŒ‡å®š resourcemanager çš„çŠ¶æ€ä¿¡æ¯å­˜å‚¨åœ¨ zookeeper é›†ç¾¤ <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>  
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span> 
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>  
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>yarn<span class="token punctuation">.</span>server<span class="token punctuation">.</span>resourcemanager<span class="token punctuation">.</span>recovery<span class="token punctuation">.</span>ZKRMStateStore<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span> 
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span> 
	
	<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> ç¯å¢ƒå˜é‡çš„ç»§æ‰¿ <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>  
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span> 
		<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>nodemanager<span class="token punctuation">.</span>env<span class="token operator">-</span>whitelist<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>  
		<span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>JAVA_HOME<span class="token punctuation">,</span>HADOOP_COMMON_HOME<span class="token punctuation">,</span>HADOOP_HDFS_HOME<span class="token punctuation">,</span>HADOOP_CONF_DIR<span class="token punctuation">,</span>CLAS SPATH_PREPEND_DISTCACHE<span class="token punctuation">,</span>HADOOP_YARN_HOME<span class="token punctuation">,</span>HADOOP_MAPRED_HOME<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span> 
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>configuration<span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="yarnroot_768"></a>è®¾ç½®yarné›†ç¾¤å¯åŠ¨æ—¶ï¼Œå…è®¸rootç”¨æˆ·å¯åŠ¨</h4> 
<pre><code class="prism language-python">vim <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment">#å…è®¸rootç”¨æˆ·å¯åŠ¨yarné›†ç¾¤æœåŠ¡</span>
YARN_RESOURCEMANAGER_USER<span class="token operator">=</span>root
export YARN_RESOURCEMANAGER_USER
YARN_NODEMANAGER_USER<span class="token operator">=</span>root
export YARN_NODEMANAGER_USER

<span class="token comment"># æ¿€æ´»ç¯å¢ƒå˜é‡</span>
source <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment"># é›†ç¾¤åˆ†å‘ ä¿®æ”¹åçš„hadoopæ–‡ä»¶</span>
xsync hadoop<span class="token operator">-</span><span class="token number">3.3</span><span class="token number">.5</span><span class="token operator">/</span>
<span class="token comment"># é›†ç¾¤åˆ†å‘ ç¯å¢ƒå˜é‡</span>
xsync <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># start-yarn.sh</span>
Starting resourcemanagers on <span class="token punctuation">[</span> hadoop01 hadoop02<span class="token punctuation">]</span>
Last login<span class="token punctuation">:</span> Tue Nov <span class="token number">28</span> <span class="token number">13</span><span class="token punctuation">:</span><span class="token number">42</span><span class="token punctuation">:</span><span class="token number">30</span> CST <span class="token number">2023</span> on pts<span class="token operator">/</span><span class="token number">0</span>
Starting nodemanagers
Last login<span class="token punctuation">:</span> Tue Nov <span class="token number">28</span> <span class="token number">13</span><span class="token punctuation">:</span><span class="token number">45</span><span class="token punctuation">:</span><span class="token number">56</span> CST <span class="token number">2023</span> on pts<span class="token operator">/</span><span class="token number">0</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># jps</span>
<span class="token number">20018</span> DataNode
<span class="token number">19443</span> NodeManager
<span class="token number">20501</span> DFSZKFailoverController
<span class="token number">20294</span> JournalNode
<span class="token number">19865</span> NameNode
<span class="token number">19274</span> ResourceManager
<span class="token number">18798</span> QuorumPeerMain
<span class="token number">20814</span> Jps

<span class="token comment"># äº§ç”Ÿè¿™æ ·çš„åŸå›  å¯èƒ½æ˜¯ä¸€å¼€å§‹ å¯åŠ¨zookeeperæœåŠ¡æ—¶å¯¼è‡´,hadoop01ä¸æ˜¯ä¸»èŠ‚ç‚¹ï¼ˆå·²ä¿®æ”¹ï¼‰</span>
<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment">#  yarn rmadmin -getServiceState rm1</span>
standby
<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment">#  yarn rmadmin -getServiceState rm2</span>
active

<span class="token comment">#å¦‚æœæŸäº›åŸå› yarnæ²¡æœ‰å¯åŠ¨æˆåŠŸï¼Œå¯ä»¥å•ç‹¬å¯åŠ¨</span>
yarn<span class="token operator">-</span>daemon<span class="token punctuation">.</span>sh start resourcemanager
</code></pre> 
<h3><a id="____812"></a>é›†ç¾¤å¯åŠ¨ æ¨èæ–¹å¼ ï¼ˆåˆ†æ­¥å¯åŠ¨ å¯èƒ½å¯¼è‡´ä¸»èŠ‚ç‚¹å‡ºç°é—®é¢˜ï¼‰</h3> 
<pre><code class="prism language-python"><span class="token comment"># å…ˆå¯åŠ¨ zookeeper åŒæ­¥æœåŠ¡</span>
zkserver start

<span class="token comment"># ç„¶åç›´æ¥å¯åŠ¨hadoopé›†ç¾¤</span>
start<span class="token operator">-</span><span class="token builtin">all</span><span class="token punctuation">.</span>sh

<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># zkserver start</span>
start zkServer <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
ZooKeeper JMX enabled by default
Using config<span class="token punctuation">:</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>zookeeper<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.1</span><span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span>conf<span class="token operator">/</span>zoo<span class="token punctuation">.</span>cfg
Starting zookeeper <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> STARTED
ZooKeeper JMX enabled by default
Using config<span class="token punctuation">:</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>zookeeper<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.1</span><span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span>conf<span class="token operator">/</span>zoo<span class="token punctuation">.</span>cfg
Starting zookeeper <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> STARTED
ZooKeeper JMX enabled by default
Using config<span class="token punctuation">:</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>zookeeper<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.1</span><span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span>conf<span class="token operator">/</span>zoo<span class="token punctuation">.</span>cfg
Starting zookeeper <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> STARTED
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># start-all.sh</span>
Starting namenodes on <span class="token punctuation">[</span>hadoop01 hadoop02<span class="token punctuation">]</span>
Last login<span class="token punctuation">:</span> Tue Nov <span class="token number">28</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">45</span><span class="token punctuation">:</span><span class="token number">58</span> CST <span class="token number">2023</span> <span class="token keyword">from</span> <span class="token number">192.168</span><span class="token number">.201</span><span class="token number">.1</span> on pts<span class="token operator">/</span><span class="token number">0</span>
Starting datanodes
Last login<span class="token punctuation">:</span> Tue Nov <span class="token number">28</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">47</span><span class="token punctuation">:</span><span class="token number">02</span> CST <span class="token number">2023</span> on pts<span class="token operator">/</span><span class="token number">0</span>
Starting journal nodes <span class="token punctuation">[</span>hadoop02 hadoop01<span class="token punctuation">]</span>
Last login<span class="token punctuation">:</span> Tue Nov <span class="token number">28</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">47</span><span class="token punctuation">:</span><span class="token number">05</span> CST <span class="token number">2023</span> on pts<span class="token operator">/</span><span class="token number">0</span>
Starting ZK Failover Controllers on NN hosts <span class="token punctuation">[</span>hadoop01 hadoop02<span class="token punctuation">]</span>
Last login<span class="token punctuation">:</span> Tue Nov <span class="token number">28</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">47</span><span class="token punctuation">:</span><span class="token number">11</span> CST <span class="token number">2023</span> on pts<span class="token operator">/</span><span class="token number">0</span>
Starting resourcemanagers on <span class="token punctuation">[</span> hadoop01 hadoop02<span class="token punctuation">]</span>
Last login<span class="token punctuation">:</span> Tue Nov <span class="token number">28</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">47</span><span class="token punctuation">:</span><span class="token number">16</span> CST <span class="token number">2023</span> on pts<span class="token operator">/</span><span class="token number">0</span>
Starting nodemanagers
Last login<span class="token punctuation">:</span> Tue Nov <span class="token number">28</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">47</span><span class="token punctuation">:</span><span class="token number">23</span> CST <span class="token number">2023</span> on pts<span class="token operator">/</span><span class="token number">0</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># jps</span>
<span class="token number">3779</span> ResourceManager
<span class="token number">4195</span> Jps
<span class="token number">3941</span> NodeManager
<span class="token number">2390</span> QuorumPeerMain
<span class="token number">2663</span> NameNode
<span class="token number">3113</span> JournalNode
<span class="token number">2827</span> DataNode
<span class="token number">3340</span> DFSZKFailoverController
</code></pre> 
<p>å¯åŠ¨æŸ¥çœ‹å‘½ä»¤ ï¼š hadoop01:8088 hadoop01:50070</p> 
<p>è‡³æ­¤hadoop ha é«˜å¯ç”¨é›†ç¾¤å·²æ­å»ºå®Œæ¯•ï¼Œå¯ä»¥å°è¯•è¿›è¡Œä¸­æ–­ä»»ä¸€èŠ‚ç‚¹çš„æœåŠ¡ï¼Œç„¶ååˆ·æ–°webæµè§ˆå™¨ï¼Œå³å¯æŸ¥çœ‹çŠ¶æ€è¿›è¡Œåˆ‡æ¢ä¸ºactiveçŠ¶æ€ï¼Œæ£€æµ‹å®Œåå¯ä»¥é‡æ–°å¼€å¯</p> 
<pre><code class="prism language-python">kill <span class="token operator">-</span><span class="token number">9</span> <span class="token number">2663</span> <span class="token punctuation">(</span>namenode èŠ‚ç‚¹å¯¹åº”çš„ è¿›ç¨‹<span class="token builtin">id</span><span class="token punctuation">)</span>
<span class="token comment"># åœ¨æµè§ˆå™¨ä¸Šå¤šåˆ·æ–°å‡ æ¬¡ å¹¶ä¸”æ‰“å¼€ hadoop02:50070 æŸ¥çœ‹çŠ¶æ€</span>
<span class="token comment"># é‡æ–°å¼€å¯ namenode èŠ‚ç‚¹ </span>
hdfs <span class="token operator">-</span><span class="token operator">-</span>daemon start namenode  
</code></pre> 
<p>hadoop01:50070</p> 
<p><img src="https://images2.imgbox.com/a6/4f/30I2eP9p_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202312040955705.png"></p> 
<p>hadoop02:50070</p> 
<p><img src="https://images2.imgbox.com/09/cd/9AiL06S2_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202312040956878.png"></p> 
<p>hadoop01:8088 (è¾“å…¥hadoop02:8088 æ—¶ï¼Œä¼šåˆ‡æ¢è‡³hadoop01:8088)</p> 
<p>å› ä¸º ha æœºåˆ¶ åŒæ—¶åˆ» åªå…è®¸ä¸€ä¸ª yarn æœåŠ¡çŠ¶æ€ä¸ºactive ï¼Œå¦åˆ™ä¼šå‡ºç° è„‘è£‚ ï¼ˆsplit-brainï¼‰</p> 
<p><img src="https://images2.imgbox.com/de/64/hJLpSFQd_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202312040959786.png"></p> 
<h2><a id="spark_881"></a>äº”ã€sparké›†ç¾¤æ­å»º</h2> 
<h3><a id="_883"></a>ä¸»æœºç¯å¢ƒé…ç½®</h3> 
<pre><code class="prism language-python">cd <span class="token operator">/</span>opt<span class="token operator">/</span>software<span class="token operator">/</span>

tar <span class="token operator">-</span>zxvf spark<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.4</span><span class="token operator">-</span><span class="token builtin">bin</span><span class="token operator">-</span>hadoop3<span class="token punctuation">.</span><span class="token number">2</span><span class="token operator">-</span>scala2<span class="token punctuation">.</span><span class="token number">13</span><span class="token punctuation">.</span>tgz <span class="token operator">-</span>C <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>

cd <span class="token operator">/</span>opt<span class="token operator">/</span>module

mv spark<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.4</span><span class="token operator">-</span><span class="token builtin">bin</span><span class="token operator">-</span>hadoop3<span class="token punctuation">.</span><span class="token number">2</span><span class="token operator">-</span>scala2<span class="token punctuation">.</span><span class="token number">13</span><span class="token operator">/</span> spark<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.4</span><span class="token operator">/</span>

<span class="token comment"># é…ç½® spark ç¯å¢ƒå˜é‡</span>
vim <span class="token operator">/</span>etc<span class="token operator">/</span>profile

export SPARK_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>spark<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.4</span>
export PATH<span class="token operator">=</span>$PATH<span class="token punctuation">:</span>$SPARK_HOME<span class="token operator">/</span><span class="token builtin">bin</span>

<span class="token comment"># æ¿€æ´»ç¯å¢ƒå˜é‡</span>
source <span class="token operator">/</span>etc<span class="token operator">/</span>profile
</code></pre> 
<h3><a id="spark__904"></a>é…ç½®spark æ ¸å¿ƒæ–‡ä»¶</h3> 
<h4><a id="_sparkenvsh__906"></a>ç¼–è¾‘ spark-env.sh æ–‡ä»¶</h4> 
<pre><code class="prism language-python">cd <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>spark<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.4</span><span class="token operator">/</span>conf<span class="token operator">/</span>

mv spark<span class="token operator">-</span>env<span class="token punctuation">.</span>sh<span class="token punctuation">.</span>template spark<span class="token operator">-</span>env<span class="token punctuation">.</span>sh

vim spark<span class="token operator">-</span>env<span class="token punctuation">.</span>sh

export JAVA_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_391</span>
export HADOOP_CONF_DIR<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hadoop<span class="token operator">-</span><span class="token number">3.3</span><span class="token number">.5</span><span class="token operator">/</span>etc<span class="token operator">/</span>hadoop<span class="token operator">/</span>
export YARN_CONF_DIR<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hadoop<span class="token operator">-</span><span class="token number">3.3</span><span class="token number">.5</span><span class="token operator">/</span>etc<span class="token operator">/</span>hadoop<span class="token operator">/</span>
export SPARK_MASTER_IP<span class="token operator">=</span>hadoop01
export SPARK_MASTER_PORT<span class="token operator">=</span><span class="token number">7077</span>
export SPARK_MASTER_WEBUI_PORT<span class="token operator">=</span><span class="token number">8090</span>
export SPARK_WORKER_WEBUI_PORT<span class="token operator">=</span><span class="token number">8091</span>
export SPARK_DAEMON_JAVA_OPTS<span class="token operator">=</span><span class="token string">"-Dspark.deploy.recoveryMode=ZOOKEEPER -Dspark.deploy.zookeeper.url=hadoop01:2181,hadoop02:2181,hadoop03:2181 -Dspark.deploy.zookeeper.dir=/opt/module/zookeeper-3.7.1"</span>

</code></pre> 
<aside>
  ğŸ’¡ è¯´æ˜: JAVA_HOEMï¼šè®¾ç½®Javaå®‰è£…ç›®å½•çš„è·¯å¾„ HADOOP_CONF_DIRï¼šè®¾ç½®Hadoopçš„é…ç½®ç›®å½•è·¯å¾„ YARN_CONF_DIRï¼šè®¾ç½®YARNçš„é…ç½®ç›®å½•è·¯å¾„ï¼ŒYARNæ˜¯Hadoopçš„èµ„æºç®¡ç†å™¨ SPARK_MASTER_IPï¼šè®¾ç½®Sparkä¸»èŠ‚ç‚¹çš„IPåœ°å€æˆ–ä¸»æœºåã€‚Sparkä¸»èŠ‚ç‚¹è´Ÿè´£åè°ƒé›†ç¾¤ä¸­çš„å„ä¸ªå·¥ä½œèŠ‚ç‚¹ã€‚ SPARK_MASTER_PORTï¼šè®¾ç½®Sparkä¸»èŠ‚ç‚¹çš„ç«¯å£å·ã€‚é€šè¿‡è¯¥ç«¯å£ï¼Œå·¥ä½œèŠ‚ç‚¹å¯ä»¥ä¸Sparkä¸»èŠ‚ç‚¹è¿›è¡Œé€šä¿¡ã€‚ SPARK_MASTER_WEBUI_PORTï¼šè®¾ç½®Sparkä¸»èŠ‚ç‚¹çš„Webç•Œé¢ç«¯å£å·ã€‚å¯ä»¥é€šè¿‡è¯¥ç«¯å£è®¿é—®Sparkä¸»èŠ‚ç‚¹çš„Webç•Œé¢ã€‚ SPARK_WORKER_WEBUI_PORTï¼šè®¾ç½®Sparkå·¥ä½œèŠ‚ç‚¹çš„Webç•Œé¢ç«¯å£å·ã€‚å¯ä»¥é€šè¿‡è¯¥ç«¯å£è®¿é—®Sparkå·¥ä½œèŠ‚ç‚¹çš„Webç•Œé¢ã€‚ 
</aside> 
<h4><a id="_workers__938"></a>ç¼–è¾‘ workers æ–‡ä»¶</h4> 
<pre><code class="prism language-python">mv workers<span class="token punctuation">.</span>template workers

vim workers

<span class="token comment"># ä¿®æ”¹ä¸ºä»¥ä¸‹å†…å®¹</span>
hadoop01
hadoop02
hadoop03
</code></pre> 
<h3><a id="spark___951"></a>spark é›†ç¾¤ æµ‹è¯•</h3> 
<h4><a id="_spark__953"></a>å¯åŠ¨ spark æµ‹è¯•</h4> 
<pre><code class="prism language-python"><span class="token comment"># å°† hadoop ç›¸å…³é…ç½®æ–‡ä»¶ å¤åˆ¶åˆ° spark </span>
cd <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hadoop<span class="token operator">-</span><span class="token number">3.3</span><span class="token number">.5</span><span class="token operator">/</span>etc<span class="token operator">/</span>hadoop

cp core<span class="token operator">-</span>site<span class="token punctuation">.</span>xml hdfs<span class="token operator">-</span>site<span class="token punctuation">.</span>xml <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>spark<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.4</span><span class="token operator">/</span>conf<span class="token operator">/</span>

<span class="token comment"># åŒæ­¥ spark æ–‡ä»¶ç›®å½•</span>
xsync <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>spark<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.4</span>
<span class="token comment"># åŒæ­¥ ç¯å¢ƒå˜é‡</span>
xsync <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment">#åœ¨ hadoop02 ä¸Šé…ç½®å¤‡ç”¨ master èŠ‚ç‚¹</span>
<span class="token punctuation">[</span>root@hadoop02 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># vim /opt/module/spark-3.2.4/conf/spark-env.sh</span>
<span class="token comment">#å°† export SPARK_MASTER_IP=hadoop01  æ”¹ä¸º</span>
export SPARK_MASTER_IP<span class="token operator">=</span>hadoop02

<span class="token comment"># æ²¡æœ‰ vim ç¼–è¾‘å™¨ éœ€è¦ä½¿ç”¨ yum ä¸‹è½½</span>
yum install <span class="token operator">-</span>y vim

<span class="token comment">#ç”±äºå¯åŠ¨å‘½ä»¤å’Œhadoopä¸‹çš„å‘½ä»¤æ–‡ä»¶åä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦cdåˆ°sparkç›®å½•ä¸‹æ‰§è¡Œ</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># cd /opt/module/spark-3.2.4/sbin</span>
<span class="token punctuation">[</span>root@hadoop01 sbin<span class="token punctuation">]</span><span class="token comment"># ./start-all.sh</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token punctuation">[</span>root@hadoop01 sbin<span class="token punctuation">]</span><span class="token comment"># jps</span>
<span class="token number">3779</span> ResourceManager
<span class="token number">3941</span> NodeManager
<span class="token number">2390</span> QuorumPeerMain
<span class="token number">7078</span> Worker
<span class="token number">2663</span> NameNode
<span class="token number">6952</span> Master
<span class="token number">3113</span> JournalNode
<span class="token number">2827</span> DataNode
<span class="token number">3340</span> DFSZKFailoverController
<span class="token number">7245</span> Jps

<span class="token comment"># åœ¨ hadoop02 ä¸Š å¼€å¯ å¤‡ç”¨ Master èŠ‚ç‚¹</span>
<span class="token punctuation">[</span>root@hadoop02 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># cd /opt/module/spark-3.2.4/sbin</span>
<span class="token punctuation">[</span>root@hadoop02 sbin<span class="token punctuation">]</span><span class="token comment"># ./start-master.sh</span>

<span class="token comment">#jpsæŸ¥çœ‹hadoop01 å’Œ hadoop02 ä¸Šéƒ½æœ‰Masterï¼Œhadoop03èŠ‚ç‚¹æœ‰Worker</span>
</code></pre> 
<p>æµè§ˆå™¨è®¿é—® hadoop01:8090 å¯ä»¥çœ‹åˆ°ä¸Šé¢çŠ¶æ€ <strong>Status:</strong> ALIVE</p> 
<p><img src="https://images2.imgbox.com/c8/01/yFLDumsu_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202311281558360.png"></p> 
<p>æµè§ˆå™¨è®¿é—® hadoop02:8090 å¯ä»¥çœ‹åˆ°ä¸Šé¢çŠ¶æ€ <strong>Status:</strong> STANDBY</p> 
<p><img src="https://images2.imgbox.com/37/4b/FzlHMoBj_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202311281559515.png"></p> 
<h4><a id="_master__1007"></a>ä¸­æ–­ master åˆ‡æ¢æµ‹è¯•</h4> 
<pre><code class="prism language-python"><span class="token comment"># å¼ºåˆ¶ä¸­æ–­ Master æœåŠ¡</span>
<span class="token punctuation">[</span>root@hadoop01 sbin<span class="token punctuation">]</span><span class="token comment"># jps</span>
<span class="token number">3779</span> ResourceManager
<span class="token number">3941</span> NodeManager
<span class="token number">7445</span> Jps
<span class="token number">2390</span> QuorumPeerMain
<span class="token number">7078</span> Worker
<span class="token number">2663</span> NameNode
<span class="token number">6952</span> Master
<span class="token number">3113</span> JournalNode
<span class="token number">2827</span> DataNode
<span class="token number">3340</span> DFSZKFailoverController
<span class="token punctuation">[</span>root@hadoop01 sbin<span class="token punctuation">]</span><span class="token comment"># kill -9 6952</span>
</code></pre> 
<p>åˆ·æ–°é¡µé¢ï¼Œhadoop01:8090 å·²ç»è®¿é—®ä¸åˆ°äº†ï¼Œæˆ‘ä»¬åœ¨è®¿é—® hadoop02:8090æ—¶ï¼Œå¤šåˆ·æ–°å‡ æ¬¡ï¼Œå¯ä»¥çœ‹åˆ° master å·²ç»åˆ‡æ¢åˆ°hadoop02</p> 
<p><img src="https://images2.imgbox.com/52/b7/N1e0PpwB_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202311281606174.png"></p> 
<pre><code class="prism language-python"><span class="token comment"># åœ¨ hadoop01 ä¸Š é‡æ–°å¯åŠ¨ Master æœåŠ¡</span>
<span class="token punctuation">.</span><span class="token operator">/</span>start<span class="token operator">-</span>master<span class="token punctuation">.</span>sh
<span class="token comment"># ç„¶å é‡æ–°æ‰§è¡Œ å¼€å¯ hadoop02 ä¸Šçš„ å¤‡ç”¨ Master è¿›ç¨‹ </span>

<span class="token comment"># æ­¤æ—¶ å‘ç° hadoop01 ä¸Šçš„ çŠ¶æ€å›åˆ°äº† active çŠ¶æ€, è€Œ hadoop02 ä¸º standby çŠ¶æ€</span>
</code></pre> 
<h4><a id="_spark__1037"></a>å¯åŠ¨ spark è®¡ç®—æœåŠ¡æµ‹è¯•</h4> 
<pre><code class="prism language-python"><span class="token comment"># ä½¿ç”¨ spark è®¡ç®— pi </span>
<span class="token punctuation">[</span>root@hadoop01 sbin<span class="token punctuation">]</span><span class="token comment"># spark-submit --class org.apache.spark.examples.SparkPi --master yarn --deploy-mode cluster /opt/module/spark-3.2.4/examples/jars/spark-examples_2.13-3.2.4.jar</span>
</code></pre> 
<ul><li>ä»£ç è§£é‡Šï¼š 
  <ul><li>spark-submit: æ˜¯ç”¨äºæäº¤ Spark åº”ç”¨ç¨‹åºçš„å‘½ä»¤è¡Œå·¥å…·ã€‚</li><li>â€“class org.apache.spark.examples.SparkPi: æŒ‡å®šè¦è¿è¡Œçš„ Spark åº”ç”¨ç¨‹åºçš„ä¸»ç±»ï¼Œè¿™é‡Œæ˜¯ SparkPi ç¤ºä¾‹åº”ç”¨ç¨‹åºã€‚è¿™æ˜¯ä¸€ä¸ªè®¡ç®— Ï€ å€¼çš„ç®€å• Spark åº”ç”¨ç¨‹åºã€‚</li><li>â€“master yarn: æŒ‡å®š Spark åº”ç”¨ç¨‹åºè¿è¡Œçš„ä¸»èŠ‚ç‚¹ï¼ˆmasterï¼‰ã€‚åœ¨è¿™é‡Œï¼Œyarn è¡¨ç¤ºä½¿ç”¨ YARN ä½œä¸ºé›†ç¾¤ç®¡ç†å™¨ã€‚</li><li>â€“deploy-mode cluster: æŒ‡å®š Spark åº”ç”¨ç¨‹åºçš„éƒ¨ç½²æ¨¡å¼ï¼Œcluster è¡¨ç¤ºåœ¨é›†ç¾¤ä¸Šè¿è¡Œã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œé©±åŠ¨ç¨‹åºï¼ˆDriverï¼‰ä¼šåœ¨é›†ç¾¤ä¸­çš„æŸä¸ªèŠ‚ç‚¹ä¸Šå¯åŠ¨ï¼Œè€Œä¸æ˜¯åœ¨æäº¤å‘½ä»¤çš„æœ¬åœ°æœºå™¨ä¸Šå¯åŠ¨ã€‚</li><li>/opt/module/spark-3.2.4/examples/jars/spark-examples_2.13-3.2.4.jar : è¿™æ˜¯ Spark åº”ç”¨ç¨‹åºçš„ JAR æ–‡ä»¶çš„è·¯å¾„ï¼Œå…¶ä¸­åŒ…å«äº† Spark åº”ç”¨ç¨‹åºçš„ä»£ç å’Œä¾èµ–ã€‚åœ¨è¿™é‡Œï¼ŒSparkPi ç¤ºä¾‹çš„ JAR æ–‡ä»¶è·¯å¾„ã€‚</li><li>å®Œæ•´è§£é‡Šæ˜¯ ä½¿ç”¨ spark-submit æäº¤ä¸€ä¸ª Spark åº”ç”¨ç¨‹åºï¼Œè¿™ä¸ªåº”ç”¨ç¨‹åºçš„ä¸»ç±»æ˜¯ org.apache.spark.examples.SparkPiï¼Œåœ¨ YARN é›†ç¾¤ä¸Šä»¥ cluster æ¨¡å¼è¿è¡Œï¼Œå…¶ä»£ç å’Œä¾èµ–ä½äº /opt/module/spark-3.2.4/examples/jars/spark-examples_2.13-3.2.4.jar è¿™ä¸ª JAR æ–‡ä»¶ä¸­ã€‚</li></ul> </li></ul> 
<p><img src="https://images2.imgbox.com/91/50/CDrXtJpP_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202311281625090.png"></p> 
<pre><code class="prism language-python"><span class="token comment"># å¯ä»¥åœ¨ hadoop01:8088 ä¸ŠæŸ¥çœ‹ è¿è¡ŒçŠ¶æ€ ä»¥åŠ æ—¥å¿—ä¿¡æ¯ ç­‰</span>
</code></pre> 
<h3><a id="__yarn___1058"></a>é…ç½® yarn å†å²æœåŠ¡å™¨</h3> 
<h4><a id="hadoop_mapredsitexml_1060"></a>é…ç½®hadoop mapred-site.xml</h4> 
<pre><code class="prism language-python">cd <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hadoop<span class="token operator">-</span><span class="token number">3.3</span><span class="token number">.5</span><span class="token operator">/</span>etc<span class="token operator">/</span>hadoop<span class="token operator">/</span>

vim mapred<span class="token operator">-</span>site<span class="token punctuation">.</span>xml

<span class="token comment"># æ·»åŠ ä»¥ä¸‹é…ç½®é¡¹</span>
		<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>Spark on Yarn<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>mapreduce<span class="token punctuation">.</span>jobhistory<span class="token punctuation">.</span>address<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop01<span class="token punctuation">:</span><span class="token number">10020</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>mapreduce<span class="token punctuation">.</span>jobhistory<span class="token punctuation">.</span>webapp<span class="token punctuation">.</span>address<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop01<span class="token punctuation">:</span><span class="token number">19888</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="hadoop_yarnsitexml_1080"></a>é…ç½®hadoop yarn-site.xml</h4> 
<pre><code class="prism language-python">vim yarn<span class="token operator">-</span>site<span class="token punctuation">.</span>xml

<span class="token comment"># æ·»åŠ ä»¥ä¸‹é…ç½®é¡¹</span>
				<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>Spark on Yarn<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> æ˜¯å¦å¼€å¯èšåˆæ—¥å¿— <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>log<span class="token operator">-</span>aggregation<span class="token operator">-</span>enable<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> é…ç½®æ—¥å¿—æœåŠ¡å™¨çš„åœ°å€ <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>log<span class="token punctuation">.</span>server<span class="token punctuation">.</span>url<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>http<span class="token punctuation">:</span><span class="token operator">//</span>hadoop01<span class="token punctuation">:</span><span class="token number">19888</span><span class="token operator">/</span>jobhistory<span class="token operator">/</span>logs<span class="token operator">/</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> é…ç½®æ—¥å¿—è¿‡æœŸæ—¶é—´<span class="token punctuation">,</span>å•ä½ç§’ <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>yarn<span class="token punctuation">.</span>log<span class="token operator">-</span>aggregation<span class="token punctuation">.</span>retain<span class="token operator">-</span>seconds<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">86400</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="__spark__1106"></a>åŒæ­¥æ–‡ä»¶åˆ°å…¶ä»–ä¸»æœº ä»¥åŠ spark é…ç½®ä¸­</h4> 
<pre><code class="prism language-python"><span class="token comment"># åŒæ­¥è‡³å…¶ä»–ä¸»æœºçš„ hadoop æ–‡ä»¶ç›®å½•ä¸­</span>
<span class="token punctuation">[</span>root@hadoop01 hadoop<span class="token punctuation">]</span><span class="token comment"># xsync mapred-site.xml yarn-site.xml</span>

<span class="token comment"># å¤åˆ¶æ–‡ä»¶ å¹¶ åŒæ­¥è‡³ å…¶ä»–ä¸»æœºçš„ spark æ–‡ä»¶ç›®å½•ä¸­</span>
<span class="token punctuation">[</span>root@hadoop01 hadoop<span class="token punctuation">]</span><span class="token comment"># cp mapred-site.xml yarn-site.xml /opt/module/spark-3.2.4/conf/</span>
<span class="token punctuation">[</span>root@hadoop01 hadoop<span class="token punctuation">]</span><span class="token comment"># xsync /opt/module/spark-3.2.4/conf/</span>
</code></pre> 
<h3><a id="_spark___1117"></a>é…ç½® spark å†å²æœåŠ¡å™¨</h3> 
<h4><a id="_spark_sparkdefaultsconf_1119"></a>é…ç½® spark spark-defaults.confæ–‡ä»¶</h4> 
<pre><code class="prism language-python">cd <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>spark<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.4</span><span class="token operator">/</span>conf<span class="token operator">/</span>

<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># mv spark-defaults.conf.template spark-defaults.conf</span>

vim spark<span class="token operator">-</span>defaults<span class="token punctuation">.</span>conf

<span class="token comment"># æ·»åŠ æˆ–è€…æ”¾å¼€æ³¨é‡Šå¹¶ä¿®æ”¹</span>
spark<span class="token punctuation">.</span>eventLog<span class="token punctuation">.</span>enabled              true
spark<span class="token punctuation">.</span>eventLog<span class="token punctuation">.</span>compress             true
spark<span class="token punctuation">.</span>eventLog<span class="token punctuation">.</span><span class="token builtin">dir</span>                  hdfs<span class="token punctuation">:</span><span class="token operator">//</span>mycluster<span class="token operator">/</span>spark<span class="token operator">-</span>logs
spark<span class="token punctuation">.</span>yarn<span class="token punctuation">.</span>historyServer<span class="token punctuation">.</span>address    hadoop01<span class="token punctuation">:</span><span class="token number">18080</span><span class="token punctuation">,</span>hadoop02<span class="token punctuation">:</span><span class="token number">18080</span>
spark<span class="token punctuation">.</span>history<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>port               <span class="token number">18080</span>
spark<span class="token punctuation">.</span>history<span class="token punctuation">.</span>fs<span class="token punctuation">.</span>logDirectory       hdfs<span class="token punctuation">:</span><span class="token operator">//</span>mycluster<span class="token operator">/</span>spark<span class="token operator">-</span>logs
spark<span class="token punctuation">.</span>history<span class="token punctuation">.</span>retainedApplications  <span class="token number">30</span>
</code></pre> 
<ul><li>æ–‡ä»¶è¯´æ˜ï¼š 
  <ul><li>spark.eventLog.enabled è®¾ç½®ä¸º true è¡¨ç¤ºå¯ç”¨Sparkäº‹ä»¶æ—¥å¿—è®°å½•åŠŸèƒ½ã€‚</li><li>spark.eventLog.compress æŒ‡å®šSparkäº‹ä»¶æ—¥å¿—æ˜¯å¦éœ€è¦è¿›è¡Œå‹ç¼©</li><li>spark.eventLog.dir æŒ‡å®šäº†äº‹ä»¶æ—¥å¿—çš„å­˜å‚¨è·¯å¾„</li><li>spark.yarn.historyServer.address æŒ‡å®šäº†YARNå†å²æœåŠ¡å™¨çš„åœ°å€</li><li>spark.history.ui.port æŒ‡å®šäº†Sparkå†å²æœåŠ¡å™¨UIçš„ç«¯å£å·</li><li>spark.history.fs.logDirectory æŒ‡å®šäº†å†å²è®°å½•æ–‡ä»¶åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„å­˜å‚¨è·¯å¾„</li><li>spark.history.retainedApplications æŒ‡å®šäº†å†å²æœåŠ¡å™¨è¦ä¿ç•™çš„åº”ç”¨ç¨‹åºæ•°é‡ï¼Œè®¾ç½®ä¸º 30ï¼Œè¡¨ç¤ºå†å²æœåŠ¡å™¨å°†ä¿ç•™æœ€è¿‘æäº¤çš„30ä¸ªåº”ç”¨ç¨‹åºçš„å†å²è®°å½•ã€‚</li></ul> </li></ul> 
<h4><a id="_1148"></a>åŒæ­¥æ–‡ä»¶åˆ°å…¶ä»–ä¸»æœº</h4> 
<pre><code class="prism language-python"><span class="token comment"># åŒæ­¥è‡³ å…¶ä»–ä¸»æœºçš„ spark æ–‡ä»¶ç›®å½•ä¸­</span>
<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># xsync spark-defaults.conf</span>
<span class="token comment"># åˆ é™¤ å…¶ä»–ä¸»æœºçš„ spark-defaults.confæ–‡ä»¶</span>
<span class="token punctuation">[</span>root@hadoop02 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># rm -rf /opt/module/spark-3.2.4/conf/spark-defaults.conf.template</span>
</code></pre> 
<h4><a id="_1157"></a>é‡æ–°å¼€å¯é›†ç¾¤æµ‹è¯•</h4> 
<pre><code class="prism language-python"><span class="token comment">#åˆ›å»ºæ—¶é—´æ—¥å¿—çš„å­˜å‚¨è·¯å¾„ï¼Œéœ€è¦åœ¨å¯åŠ¨å†å²æœåŠ¡å™¨ä¹‹å‰åˆ›å»ºï¼Œä¸ç„¶æŠ¥é”™æ‰¾ä¸åˆ°è·¯å¾„æˆ–æ–‡ä»¶</span>
<span class="token punctuation">[</span>root@hadoop01 sbin<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -mkdir /spark-logs</span>

<span class="token comment"># hadoop01 ä¸Šæ‰§è¡Œ</span>
zkserver start
start<span class="token operator">-</span><span class="token builtin">all</span><span class="token punctuation">.</span>sh

mapred <span class="token operator">-</span><span class="token operator">-</span>daemon start historyserver

$SPARK_HOME<span class="token operator">/</span>sbin<span class="token operator">/</span>start<span class="token operator">-</span><span class="token builtin">all</span><span class="token punctuation">.</span>sh
$SPARK_HOME<span class="token operator">/</span>sbin<span class="token operator">/</span>start<span class="token operator">-</span>history<span class="token operator">-</span>server<span class="token punctuation">.</span>sh

<span class="token comment"># hadoop02 ä¸Šæ‰§è¡Œ</span>
$SPARK_HOME<span class="token operator">/</span>sbin<span class="token operator">/</span>start<span class="token operator">-</span>master<span class="token punctuation">.</span>sh
$SPARK_HOME<span class="token operator">/</span>sbin<span class="token operator">/</span>start<span class="token operator">-</span>history<span class="token operator">-</span>server<span class="token punctuation">.</span>sh
</code></pre> 
<p>hadoop01:18080</p> 
<p><img src="https://images2.imgbox.com/c2/0b/ovkyQgRB_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202311282050798.png"></p> 
<p>hadoop01:19888 (logs æ—¥å¿— åœ¨ hadoop01:8088 é¡µé¢ç‚¹å‡» logs è·³è½¬)</p> 
<p><img src="https://images2.imgbox.com/80/4d/HCs5UyMA_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202311282051236.png"></p> 
<p>hadoop01:19888</p> 
<p><img src="https://images2.imgbox.com/a2/c2/OadqJLBr_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202311282056316.png"></p> 
<aside>
  ğŸ’¡ å¦‚æœ å‡ºç° ç±»ä¼¼ è¿™æ ·çš„é—®é¢˜ http://hadoop01:8088/proxy/application_1701174521692_0001/ ç‚¹å‡»ä¹‹å ï¼ŒæŠ¥é”™çš„ æ˜¯å› ä¸º é‚£ä¸ªæ—¥å¿— æ˜¯é€šè¿‡ä»£ç† åˆ° å¯¹åº”çš„ é›†ç¾¤ä¸Š ä¿å­˜çš„ proxy å°±æ˜¯ä»£ç†çš„åŸå› ï¼Œåœ¨spark çš„history æ—¥å¿—é‡Œé¢ æœ‰ç›¸å…³çš„æ—¥å¿— http://hadoop01:18080/history/application_1701174521692_0001/1/jobs/ 
</aside> 
<h2><a id="hbase_1196"></a>å…­ã€hbaseé›†ç¾¤æ­å»º</h2> 
<h3><a id="_1198"></a>ä¸»æœºç¯å¢ƒé…ç½®</h3> 
<pre><code class="prism language-python">cd <span class="token operator">/</span>opt<span class="token operator">/</span>software<span class="token operator">/</span>

tar <span class="token operator">-</span>zxvf hbase<span class="token operator">-</span><span class="token number">2.4</span><span class="token number">.17</span><span class="token operator">-</span><span class="token builtin">bin</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">-</span>C <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>

cd <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>

<span class="token comment"># é…ç½® hbase ç¯å¢ƒå˜é‡</span>
vim <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment"># HBaseç¯å¢ƒå˜é‡</span>
export HBASE_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hbase<span class="token operator">-</span><span class="token number">2.4</span><span class="token number">.17</span>
export PATH<span class="token operator">=</span>$PATH<span class="token punctuation">:</span>$HBASE_HOME<span class="token operator">/</span><span class="token builtin">bin</span>

<span class="token comment"># æ¿€æ´»ç¯å¢ƒå˜é‡</span>
source <span class="token operator">/</span>etc<span class="token operator">/</span>profile
</code></pre> 
<h3><a id="hbase__1218"></a>é…ç½®hbase æ ¸å¿ƒæ–‡ä»¶</h3> 
<h4><a id="hbaseenvsh__1220"></a>é…ç½®hbase-env.sh æ–‡ä»¶</h4> 
<pre><code class="prism language-python">cd <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hbase<span class="token operator">-</span><span class="token number">2.4</span><span class="token number">.17</span><span class="token operator">/</span>conf<span class="token operator">/</span>

vim hbase<span class="token operator">-</span>env<span class="token punctuation">.</span>sh
<span class="token comment"># ä¿®æ”¹ä»¥ä¸‹å†…å®¹</span>

export JAVA_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_391</span>
<span class="token comment">#ä¿å­˜pidæ–‡ä»¶</span>
export HBASE_PID_DIR<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hbase<span class="token operator">-</span><span class="token number">2.4</span><span class="token number">.17</span><span class="token operator">/</span>pids
<span class="token comment">#ç¦ç”¨HBaseè‡ªå¸¦çš„Zookeeperï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯ä½¿ç”¨ç‹¬ç«‹çš„Zookeeper</span>
export HBASE_MANAGES_ZK<span class="token operator">=</span>false
</code></pre> 
<h4><a id="hbasesitexml__1235"></a>é…ç½®hbase-site.xml æ–‡ä»¶</h4> 
<pre><code class="prism language-python">vim hbase<span class="token operator">-</span>site<span class="token punctuation">.</span>xml

<span class="token comment"># å°†åŸæœ‰çš„é…ç½®ä¿¡æ¯ è¿›è¡Œåˆ é™¤ æ·»åŠ ä»¥ä¸‹é…ç½®é¡¹</span>

<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> è®¾ç½®HRegionServerså…±äº«ç›®å½• <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hbase<span class="token punctuation">.</span>rootdir<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hdfs<span class="token punctuation">:</span><span class="token operator">//</span>mycluster<span class="token operator">/</span>hbase<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
  
  <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hbase<span class="token punctuation">.</span>master<span class="token punctuation">.</span>info<span class="token punctuation">.</span>port<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">60010</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
  
  <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> å¯ç”¨åˆ†å¸ƒå¼æ¨¡å¼ <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hbase<span class="token punctuation">.</span>cluster<span class="token punctuation">.</span>distributed<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
  
  <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> æŒ‡å®šZookeeperé›†ç¾¤ä½ç½® <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hbase<span class="token punctuation">.</span>zookeeper<span class="token punctuation">.</span>quorum<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop01<span class="token punctuation">:</span><span class="token number">2181</span><span class="token punctuation">,</span>hadoop02<span class="token punctuation">:</span><span class="token number">2181</span><span class="token punctuation">,</span>hadoop03<span class="token punctuation">:</span><span class="token number">2181</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
  
  <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> æŒ‡å®šç‹¬ç«‹Zookeeperå®‰è£…è·¯å¾„ <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hbase<span class="token punctuation">.</span>zookeeper<span class="token punctuation">.</span><span class="token builtin">property</span><span class="token punctuation">.</span>dataDir<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>zookeeper<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.1</span><span class="token operator">/</span>data<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
  
  <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> æŒ‡å®šZooKeeperé›†ç¾¤ç«¯å£ <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hbase<span class="token punctuation">.</span>zookeeper<span class="token punctuation">.</span><span class="token builtin">property</span><span class="token punctuation">.</span>clientPort<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">2181</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
  
  <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hbase<span class="token punctuation">.</span>tmp<span class="token punctuation">.</span><span class="token builtin">dir</span><span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hbase<span class="token operator">-</span><span class="token number">2.4</span><span class="token number">.17</span><span class="token operator">/</span>tmp<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
  
  <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>HBaseå°†æŒ‰ç…§æ­£å¸¸çš„å†™å…¥è·¯å¾„è¿›è¡Œå¤„ç†ä¸æ£€æŸ¥<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hbase<span class="token punctuation">.</span>unsafe<span class="token punctuation">.</span>stream<span class="token punctuation">.</span>capability<span class="token punctuation">.</span>enforce<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>false<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
  
  <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hbase<span class="token punctuation">.</span>wal<span class="token punctuation">.</span>provider<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>filesystem<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="regionservers__1294"></a>é…ç½®regionservers æ–‡ä»¶</h4> 
<pre><code class="prism language-python">vim regionservers

<span class="token comment"># ä¿®æ”¹ä¸º ä»¥ä¸‹ä¿¡æ¯</span>
hadoop01
hadoop02
hadoop03
</code></pre> 
<h4><a id="_1305"></a>å¤åˆ¶é…ç½®æ–‡ä»¶</h4> 
<pre><code class="prism language-python"><span class="token comment"># å¤åˆ¶ hadoop é…ç½®åˆ° hbase ç›®å½•ä¸‹</span>
cd <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hadoop<span class="token operator">-</span><span class="token number">3.3</span><span class="token number">.5</span><span class="token operator">/</span>etc<span class="token operator">/</span>hadoop<span class="token operator">/</span> 

cp core<span class="token operator">-</span>site<span class="token punctuation">.</span>xml hdfs<span class="token operator">-</span>site<span class="token punctuation">.</span>xml <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hbase<span class="token operator">-</span><span class="token number">2.4</span><span class="token number">.17</span><span class="token operator">/</span>conf<span class="token operator">/</span>

<span class="token comment"># å°† hbase æ–‡ä»¶ åŒæ­¥åˆ°å…¶ä»–ä¸»æœº</span>
cd <span class="token operator">/</span>opt<span class="token operator">/</span>module
xsync hbase<span class="token operator">-</span><span class="token number">2.4</span><span class="token number">.17</span><span class="token operator">/</span>
xsync <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment"># åˆ†åˆ«åœ¨ hadoop02 å’Œ hadoop03 ä¸Š æ‰§è¡Œä»¥ä¸‹ä»£ç  æ¿€æ´»ç¯å¢ƒå˜é‡</span>
source <span class="token operator">/</span>etc<span class="token operator">/</span>profile
</code></pre> 
<h3><a id="hbase_1322"></a>å¯åŠ¨hbaseé›†ç¾¤</h3> 
<pre><code class="prism language-python"><span class="token comment"># æŸ¥çœ‹é‚£ä¸ªæ˜¯ä¸»èŠ‚ç‚¹ (hadoop01 è¿˜æ˜¯ hadoop02) ç„¶åæ‰§è¡Œ é›†ç¾¤å¯åŠ¨å‘½ä»¤ </span>
<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># hdfs haadmin -getServiceState nn1</span>
active
<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># start-hbase.sh</span>

<span class="token comment"># ç„¶ååœ¨å¦å¤–ä¸€ä¸ªå¤‡ä»½èŠ‚ç‚¹ä¸Šæ‰§è¡Œ </span>
hbase<span class="token operator">-</span>daemon<span class="token punctuation">.</span>sh start master
</code></pre> 
<p>æŸ¥çœ‹é›†ç¾¤webç•Œé¢ ï¼š master : <strong>hadoop01:60010</strong> backup master **** : <strong>hadoop02:60010</strong></p> 
<p><img src="https://images2.imgbox.com/4b/08/YJMz4eKJ_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202312012227250.png"></p> 
<h3><a id="shell__1338"></a>ç®€å•æµ‹è¯•shell å‘½ä»¤</h3> 
<pre><code class="prism language-python"><span class="token comment"># ä»»æ„èŠ‚ç‚¹è¿›è¡Œ</span>
<span class="token punctuation">[</span>root@hadoop03 <span class="token builtin">bin</span><span class="token punctuation">]</span><span class="token comment"># hbase shell</span>
SLF4J<span class="token punctuation">:</span> Class <span class="token class-name">path</span> contains multiple SLF4J bindings<span class="token punctuation">.</span>
SLF4J<span class="token punctuation">:</span> Found binding <span class="token keyword">in</span> <span class="token punctuation">[</span>jar<span class="token punctuation">:</span><span class="token builtin">file</span><span class="token punctuation">:</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hadoop<span class="token operator">-</span><span class="token number">3.3</span><span class="token number">.5</span><span class="token operator">/</span>share<span class="token operator">/</span>hadoop<span class="token operator">/</span>common<span class="token operator">/</span>lib<span class="token operator">/</span>slf4j<span class="token operator">-</span>reload4j<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.36</span><span class="token punctuation">.</span>jar!<span class="token operator">/</span>org<span class="token operator">/</span>slf4j<span class="token operator">/</span>impl<span class="token operator">/</span>StaticLoggerBinder<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">]</span>
SLF4J<span class="token punctuation">:</span> Found binding <span class="token keyword">in</span> <span class="token punctuation">[</span>jar<span class="token punctuation">:</span><span class="token builtin">file</span><span class="token punctuation">:</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hbase<span class="token operator">-</span><span class="token number">2.4</span><span class="token number">.17</span><span class="token operator">/</span>lib<span class="token operator">/</span>client<span class="token operator">-</span>facing<span class="token operator">-</span>thirdparty<span class="token operator">/</span>slf4j<span class="token operator">-</span>reload4j<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.33</span><span class="token punctuation">.</span>jar!<span class="token operator">/</span>org<span class="token operator">/</span>slf4j<span class="token operator">/</span>impl<span class="token operator">/</span>StaticLoggerBinder<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">]</span>
SLF4J<span class="token punctuation">:</span> See http<span class="token punctuation">:</span><span class="token operator">//</span>www<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>org<span class="token operator">/</span>codes<span class="token punctuation">.</span>html<span class="token comment">#multiple_bindings for an explanation.</span>
SLF4J<span class="token punctuation">:</span> Actual binding <span class="token keyword">is</span> of <span class="token builtin">type</span> <span class="token punctuation">[</span>org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>Reload4jLoggerFactory<span class="token punctuation">]</span>
HBase Shell
Use <span class="token string">"help"</span> to get <span class="token builtin">list</span> of supported commands<span class="token punctuation">.</span>
Use <span class="token string">"exit"</span> to quit this interactive shell<span class="token punctuation">.</span>
For Reference<span class="token punctuation">,</span> please visit<span class="token punctuation">:</span> http<span class="token punctuation">:</span><span class="token operator">//</span>hbase<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>org<span class="token operator">/</span><span class="token number">2.0</span><span class="token operator">/</span>book<span class="token punctuation">.</span>html<span class="token comment">#shell</span>
Version <span class="token number">2.4</span><span class="token number">.17</span><span class="token punctuation">,</span> r7fd096f39b4284da9a71da3ce67c48d259ffa79a<span class="token punctuation">,</span> Fri Mar <span class="token number">31</span> <span class="token number">18</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token number">45</span> UTC <span class="token number">2023</span>
Took <span class="token number">0.0027</span> seconds                                                                                                                                                             
hbase<span class="token punctuation">:</span><span class="token number">001</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token operator">&gt;</span> version    <span class="token comment"># è¾“å…¥ version </span>
<span class="token number">2.4</span><span class="token number">.17</span><span class="token punctuation">,</span> r7fd096f39b4284da9a71da3ce67c48d259ffa79a<span class="token punctuation">,</span> Fri Mar <span class="token number">31</span> <span class="token number">18</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token number">45</span> UTC <span class="token number">2023</span>
Took <span class="token number">0.0004</span> seconds

<span class="token comment"># exit é€€å‡º </span>

<span class="token comment"># ç”±äºæœ¬ç¬”è®°ç›®çš„æ˜¯ä¸ºäº†è¿›è¡Œé¡¹ç›®é…ç½®,æš‚ä¸æ¶‰åŠæ›´å¤šçš„é›†ç¾¤</span>
</code></pre> 
<h2><a id="mysql_1363"></a>ä¸ƒã€mysqlæ•°æ®åº“é›†ç¾¤æ­å»º</h2> 
<h3><a id="mariadb_1365"></a><strong><strong>å¸è½½ç³»ç»Ÿè‡ªå¸¦çš„mariadb</strong></strong></h3> 
<pre><code class="prism language-python"><span class="token comment"># æŸ¥çœ‹å¹¶å¸è½½ç³»ç»Ÿçš„mariadbè½¯ä»¶</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># rpm -qa | grep mariadb</span>
mariadb<span class="token operator">-</span>libs<span class="token operator">-</span><span class="token number">5.5</span><span class="token number">.68</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span>el7<span class="token punctuation">.</span>x86_64

<span class="token comment"># å¸è½½mariadb</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># rpm -e --nodeps mariadb-libs-5.5.68-1.el7.x86_64</span>
<span class="token comment"># å› ä¸ºcentos7å†…éƒ¨é›†æˆäº†mariadbï¼Œè€Œå®‰è£…mysqlçš„è¯ä¼šå’Œmariadbçš„æ–‡ä»¶å†²çªï¼Œæ‰€ä»¥éœ€è¦å…ˆå¸è½½æ‰mariadb</span>

<span class="token comment"># æŸ¥è¯¢è¿˜æœ‰æ²¡æœ‰ mariadb å’Œ mysql </span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># rpm -qa | grep mariadb</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># rpm -qa | grep mysql</span>

<span class="token comment"># åˆ›å»ºmysqlç”¨æˆ·å¹¶ç¦æ­¢ç™»å½• (ç³»ç»Ÿç”¨æˆ· ä¸ä¼šç”Ÿæˆ home ç›®å½•ç­‰ å…¶ä»–æ–‡ä»¶ä¿¡æ¯)</span>
<span class="token comment"># è¯¥ç”¨æˆ·å°†æ‹¥æœ‰ç³»ç»Ÿæƒé™ï¼Œä½†ä¸ä¼šæœ‰ä¸å®¶ç›®å½•ç›¸å…³çš„æ–‡ä»¶å’Œé…ç½®ã€‚ MySQL çš„è¿è¡Œæ–‡ä»¶ã€æ—¥å¿—æ–‡ä»¶ç­‰é€šå¸¸ä¼šæœ‰ä¸“é—¨çš„ç›®å½•ï¼Œå¹¶ä¸ä¾èµ–äº MySQL ç”¨æˆ·çš„å®¶ç›®å½•ã€‚</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># useradd mysql -s /sbin/nologin</span>
<span class="token comment"># é€šå¸¸ç”¨äºç³»ç»Ÿä¸Šè¿è¡ŒæœåŠ¡çš„ç”¨æˆ·ï¼Œè¿™äº›ç”¨æˆ·çš„ç›®çš„æ˜¯ä¸ºäº†æ‰§è¡ŒæœåŠ¡è€Œä¸æ˜¯äººä¸ºçš„äº¤äº’ã€‚ä¾‹å¦‚ï¼ŒMySQL æœåŠ¡é€šå¸¸ä»¥ä¸€ä¸ªä¸“é—¨çš„ç”¨æˆ·ï¼ˆä¾‹å¦‚ mysqlï¼‰çš„èº«ä»½è¿è¡Œï¼Œè¿™ä¸ªç”¨æˆ·çš„ shell è¢«è®¾ç½®ä¸º /sbin/nologinï¼Œä»¥é˜²æ­¢ä¸å¿…è¦çš„ç™»å½•ã€‚è¿™æ ·å¯ä»¥å¢åŠ ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼Œå› ä¸ºæ”»å‡»è€…æ— æ³•ç›´æ¥é€šè¿‡ç™»å½•è¯¥ç”¨æˆ·æ¥æ‰§è¡Œäº¤äº’å¼å‘½ä»¤ã€‚</span>
</code></pre> 
<aside>
  ğŸ’¡ åœ¨æ­å»º Hadoop ç”Ÿæ€ç³»ç»Ÿä¸­ï¼Œé€šå¸¸ä¸ä¼šä½¿ç”¨ MySQL çš„ **`root`** ç”¨æˆ·ä½œä¸º Hive Metastore çš„è¿æ¥ç”¨æˆ·ã€‚åº”è¯¥ä¸º Hive Metastore åˆ›å»ºä¸€ä¸ªä¸“é—¨çš„ç”¨æˆ·ï¼Œå¹¶ä½¿ç”¨è¯¥ç”¨æˆ·æ¥è¿æ¥åˆ° MySQL æ•°æ®åº“ï¼Œä»è€Œæé«˜å®‰å…¨æ€§å¹¶æ ¹æ®æœ€å°æƒé™åŸåˆ™è¿›è¡Œç”¨æˆ·ç®¡ç†ã€‚ 
</aside> 
<h3><a id="mysql_1391"></a>å®‰è£…mysql</h3> 
<pre><code class="prism language-python"><span class="token comment"># è§£å‹</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># tar -zxvf /opt/software/mysql-5.7.35-el7-x86_64.tar.gz -C /opt/module/</span>

<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># cd /opt/module/</span>

<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># mv mysql-5.7.35-el7-x86_64/ mysql-5.7.35</span>

<span class="token comment"># åˆ›å»ºmysqlæ•°æ®ç›®å½•ä»¥åŠé…ç½®ç›®å½•</span>
<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># mkdir mysql-5.7.35/{data,conf,logs,binlog}</span>

<span class="token comment"># æ·»åŠ ç³»ç»Ÿç¯å¢ƒå˜é‡</span>
vim <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment"># mysql ç¯å¢ƒå˜é‡</span>
export MYSQL_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span>
export PATH<span class="token operator">=</span>$PATH<span class="token punctuation">:</span>$MYSQL_HOME<span class="token operator">/</span><span class="token builtin">bin</span>
</code></pre> 
<h3><a id="mysql_1412"></a>é…ç½®mysql</h3> 
<pre><code class="prism language-python"><span class="token comment"># åˆ›å»ºmysqlé…ç½®æ–‡ä»¶</span>
<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># cd mysql-5.7.35/conf/</span>

<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># vim my.cnf  (ä¸èƒ½æ”¹æˆåˆ«çš„åå­—)</span>

<span class="token comment"># å®¢æˆ·ç«¯é…ç½®ï¼ŒåŒ…æ‹¬å®¢æˆ·ç«¯è¿æ¥mysqlæœåŠ¡å™¨çš„ç›¸å…³é…ç½®</span>
<span class="token punctuation">[</span>client<span class="token punctuation">]</span>	
port <span class="token operator">=</span> <span class="token number">3306</span>
socket <span class="token operator">=</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token operator">/</span>mysqld<span class="token punctuation">.</span>sock
default<span class="token operator">-</span>character<span class="token operator">-</span><span class="token builtin">set</span> <span class="token operator">=</span> utf8mb4

<span class="token comment"># MySQLå‘½ä»¤è¡Œå®¢æˆ·ç«¯çš„é…ç½®</span>
<span class="token punctuation">[</span>mysql<span class="token punctuation">]</span>
<span class="token comment"># æŒ‡å®šMySQLå‘½ä»¤è¡Œæç¤ºç¬¦çš„æ ¼å¼ã€‚</span>
prompt<span class="token operator">=</span><span class="token string">"\u@mysqldb \R:\m:\s [\d]&gt; "</span>	
<span class="token comment"># ç¦ç”¨è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½</span>
no<span class="token operator">-</span>auto<span class="token operator">-</span>rehash
<span class="token comment"># æŒ‡å®šMySQLå‘½ä»¤è¡Œå®¢æˆ·ç«¯çš„é»˜è®¤å­—ç¬¦é›†</span>
default<span class="token operator">-</span>character<span class="token operator">-</span><span class="token builtin">set</span> <span class="token operator">=</span> utf8mb4

<span class="token comment"># MySQLæœåŠ¡å™¨çš„é…ç½®</span>
<span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>
<span class="token comment"># æŒ‡å®šMySQLæœåŠ¡å™¨è¿è¡Œçš„ç”¨æˆ· ï¼ˆä¸€èˆ¬è®¾ç½®ä¸ºmysqlï¼Œéœ€è¦æå‰åˆ›å»ºmysqlç”¨æˆ·ï¼‰</span>
user <span class="token operator">=</span> mysql
<span class="token comment"># æŒ‡å®šMySQLæœåŠ¡å™¨ç›‘å¬çš„ç«¯å£å·</span>
port <span class="token operator">=</span> <span class="token number">3306</span>
socket <span class="token operator">=</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token operator">/</span>mysqld<span class="token punctuation">.</span>sock
<span class="token comment"># ç¦ç”¨DNSåå‘è§£æ</span>
skip<span class="token operator">-</span>name<span class="token operator">-</span>resolve

<span class="token comment"># è®¾ç½®å­—ç¬¦ç¼–ç </span>
character<span class="token operator">-</span><span class="token builtin">set</span><span class="token operator">-</span>server <span class="token operator">=</span> utf8
collation<span class="token operator">-</span>server <span class="token operator">=</span> utf8_general_ci

<span class="token comment"># è®¾ç½®é»˜è®¤æ—¶åŒº</span>
default<span class="token operator">-</span>time_zone<span class="token operator">=</span><span class="token string">'+8:00'</span>

<span class="token comment"># æŒ‡å®šMySQLæœåŠ¡å™¨çš„å”¯ä¸€æ ‡è¯†</span>
server<span class="token operator">-</span><span class="token builtin">id</span> <span class="token operator">=</span> <span class="token number">1</span>

<span class="token comment"># Directory</span>
<span class="token comment"># å®‰è£…ç›®å½•</span>
basedir <span class="token operator">=</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token operator">/</span>
<span class="token comment"># æ•°æ®å­˜å‚¨ç›®å½•</span>
datadir <span class="token operator">=</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token operator">/</span>data
<span class="token comment"># å®‰å…¨æ–‡ä»¶ç›®å½•</span>
secure_file_priv <span class="token operator">=</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token operator">/</span>data
<span class="token comment"># PIDæ–‡ä»¶çš„è·¯å¾„</span>
pid<span class="token operator">-</span><span class="token builtin">file</span> <span class="token operator">=</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token operator">/</span>mysql<span class="token punctuation">.</span>pid

<span class="token comment"># MySQLæœåŠ¡å™¨çš„æœ€å¤§è¿æ¥æ•°</span>
max_connections       <span class="token operator">=</span> <span class="token number">1024</span>
<span class="token comment"># æœ€å¤§è¿æ¥é”™è¯¯æ•°</span>
max_connect_errors    <span class="token operator">=</span> <span class="token number">100</span>
<span class="token comment"># è¿æ¥è¶…æ—¶æ—¶é—´</span>
wait_timeout          <span class="token operator">=</span> <span class="token number">100</span>
<span class="token comment"># æœ€å¤§å…è®¸æ•°æ®åŒ…å¤§å°</span>
max_allowed_packet    <span class="token operator">=</span> 128M
<span class="token comment"># è¡¨ç¼“å­˜æ•°é‡</span>
table_open_cache      <span class="token operator">=</span> <span class="token number">2048</span>
<span class="token comment"># è¿æ¥è¯·æ±‚é˜Ÿåˆ—é•¿åº¦</span>
back_log              <span class="token operator">=</span> <span class="token number">600</span>

<span class="token comment"># æŒ‡å®šMySQLæœåŠ¡å™¨çš„é»˜è®¤å­˜å‚¨å¼•æ“</span>
default<span class="token operator">-</span>storage<span class="token operator">-</span>engine <span class="token operator">=</span> innodb
<span class="token comment"># å…è®¸äºŒè¿›åˆ¶æ—¥å¿—ä¸­åŒ…å«å‡½æ•°åˆ›å»ºè¯­å¥</span>
log_bin_trust_function_creators <span class="token operator">=</span> <span class="token number">1</span>

<span class="token comment"># Log</span>
<span class="token comment"># å…³é—­é€šç”¨æŸ¥è¯¢æ—¥å¿—</span>
general_log<span class="token operator">=</span>off
general_log_file <span class="token operator">=</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token operator">/</span>logs<span class="token operator">/</span>mysql<span class="token punctuation">.</span>log
<span class="token comment">#é”™è¯¯æ—¥å¿—çš„è·¯å¾„</span>
log<span class="token operator">-</span>error <span class="token operator">=</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token operator">/</span>logs<span class="token operator">/</span>error<span class="token punctuation">.</span>log

<span class="token comment"># binlog</span>
<span class="token comment">#æŒ‡å®šäºŒè¿›åˆ¶æ—¥å¿—çš„è·¯å¾„å’Œæ ¼å¼</span>
log<span class="token operator">-</span><span class="token builtin">bin</span> <span class="token operator">=</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token operator">/</span>binlog<span class="token operator">/</span>mysql<span class="token operator">-</span>binlog
binlog_format<span class="token operator">=</span>mixed

<span class="token comment"># slowlogæ…¢æŸ¥è¯¢æ—¥å¿—</span>
slow_query_log <span class="token operator">=</span> <span class="token number">1</span>
slow_query_log_file <span class="token operator">=</span> <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token operator">/</span>logs<span class="token operator">/</span>slow<span class="token punctuation">.</span>log
long_query_time <span class="token operator">=</span> <span class="token number">2</span>
log_output <span class="token operator">=</span> FILE
log_queries_not_using_indexes <span class="token operator">=</span> <span class="token number">0</span>

<span class="token comment"># global_buffers</span>
innodb_buffer_pool_size <span class="token operator">=</span> 2G
innodb_log_buffer_size <span class="token operator">=</span> 16M
innodb_flush_log_at_trx_commit <span class="token operator">=</span> <span class="token number">2</span>
key_buffer_size <span class="token operator">=</span> 64M

innodb_log_file_size <span class="token operator">=</span> 512M
innodb_log_file_size <span class="token operator">=</span> 2G
innodb_log_files_in_group <span class="token operator">=</span> <span class="token number">2</span>
innodb_data_file_path <span class="token operator">=</span> ibdata1<span class="token punctuation">:</span>20M<span class="token punctuation">:</span>autoextend

sql_mode <span class="token operator">=</span> STRICT_TRANS_TABLES<span class="token punctuation">,</span>NO_ZERO_IN_DATE<span class="token punctuation">,</span>NO_ZERO_DATE<span class="token punctuation">,</span>ERROR_FOR_DIVISION_BY_ZERO<span class="token punctuation">,</span>NO_ENGINE_SUBSTITUTION

<span class="token punctuation">[</span>mysqldump<span class="token punctuation">]</span>
<span class="token comment"># æŒ‡å®šmysqldumpå·¥å…·ä½¿ç”¨å¿«é€Ÿå¯¼å‡ºæ¨¡å¼</span>
quick
<span class="token comment"># æŒ‡å®šmysqldumpå·¥å…·å…è®¸çš„æœ€å¤§æ•°æ®åŒ…å¤§å°ä¸º32M</span>
max_allowed_packet <span class="token operator">=</span> 32M

</code></pre> 
<h3><a id="mysql__1523"></a>åˆå§‹åŒ–mysql å¹¶å¯åŠ¨</h3> 
<pre><code class="prism language-python"><span class="token comment"># åˆ›å»ºé“¾æ¥</span>
<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># ln my.cnf /etc/my.cnf</span>
<span class="token comment"># è¿™é€šå¸¸ç”¨äºå°†é…ç½®æ–‡ä»¶ä»ä¸€ä¸ªä½ç½®é“¾æ¥åˆ°å¦ä¸€ä¸ªä½ç½®ï¼Œä»¥æ–¹ä¾¿è®¿é—®æˆ–è€…ä½¿ä¸åŒçš„ç¨‹åºæˆ–ç”¨æˆ·èƒ½å¤Ÿå…±äº«åŒä¸€ä»½é…ç½®æ–‡ä»¶ã€‚</span>

<span class="token comment"># å°†mysql-5.7.35æ–‡ä»¶ä¸‹çš„æ–‡ä»¶å½’å±è®¾ç½®ä¸ºmysqlç”¨æˆ·</span>
<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># chown -R mysql:mysql /opt/module/mysql-5.7.35/</span>

<span class="token comment"># åˆå§‹åŒ– MySQL æ•°æ®åº“</span>
<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># cd ..</span>
<span class="token punctuation">[</span>root@hadoop01 mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token punctuation">]</span><span class="token comment"># ./bin/mysqld --initialize --user=mysql --datadir=/opt/module/mysql-5.7.35/data/ --basedir=/opt/module/mysql-5.7.35/</span>

<span class="token comment"># --initialize : è¿™ä¸ªé€‰é¡¹å‘Šè¯‰ MySQL åˆå§‹åŒ–æ•°æ®åº“ã€‚åœ¨é¦–æ¬¡å¯åŠ¨ MySQL æœåŠ¡å™¨ä¹‹å‰ï¼Œä½ éœ€è¦æ‰§è¡Œè¿™ä¸ªæ“ä½œæ¥åˆ›å»ºæ•°æ®åº“çš„åˆå§‹ç»“æ„ï¼ŒåŒ…æ‹¬ç³»ç»Ÿè¡¨å’Œæƒé™è¡¨ã€‚</span>

<span class="token comment"># é…ç½® mysql å¿«æ·å¯åŠ¨</span>
<span class="token punctuation">[</span>root@hadoop01 mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token punctuation">]</span><span class="token comment"># cp support-files/mysql.server /etc/init.d/mysqld</span>
<span class="token punctuation">[</span>root@hadoop01 mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token punctuation">]</span><span class="token comment"># chmod 777 /etc/init.d/mysqld</span>

<span class="token comment"># å¯åŠ¨ mysql </span>
<span class="token punctuation">[</span>root@hadoop01 mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token punctuation">]</span><span class="token comment"># /etc/init.d/mysqld start</span>
Starting MySQL<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> SUCCESS!

<span class="token comment"># æŸ¥çœ‹ mysql è¿›ç¨‹</span>
<span class="token punctuation">[</span>root@hadoop01 mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token punctuation">]</span><span class="token comment"># ss -ntulp | grep mysql</span>
tcp    LISTEN     <span class="token number">0</span>      <span class="token number">128</span>    <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token number">3306</span>               <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token operator">*</span>                   users<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"mysqld"</span><span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">5419</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre> 
<h3><a id="mysql__1553"></a>è®¾ç½®mysql å¼€æœºè‡ªå¯</h3> 
<pre><code class="prism language-python"><span class="token comment"># è®¾ç½®mysqlå¼€æœºè‡ªå¯</span>
chkconfig <span class="token operator">-</span><span class="token operator">-</span>level <span class="token number">35</span> mysqld on
<span class="token comment"># è¡¨ç¤ºåœ¨è¿è¡Œçº§åˆ« 3 å’Œ 5 ä¸‹å¯ç”¨ mysqld æœåŠ¡ï¼Œæ„å‘³ç€ MySQL æœåŠ¡å°†åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨</span>
<span class="token punctuation">[</span>root@hadoop01 mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token punctuation">]</span><span class="token comment"># chkconfig --list mysqld</span>

Note<span class="token punctuation">:</span> This output shows SysV services only <span class="token keyword">and</span> does <span class="token keyword">not</span> include native
      systemd services<span class="token punctuation">.</span> SysV configuration data might be overridden by native
      systemd configuration<span class="token punctuation">.</span>

      If you want to <span class="token builtin">list</span> systemd services use <span class="token string">'systemctl list-unit-files'</span><span class="token punctuation">.</span>
      To see services enabled on particular target use
      <span class="token string">'systemctl list-dependencies [target]'</span><span class="token punctuation">.</span>

mysqld          <span class="token number">0</span><span class="token punctuation">:</span>off   <span class="token number">1</span><span class="token punctuation">:</span>off   <span class="token number">2</span><span class="token punctuation">:</span>on    <span class="token number">3</span><span class="token punctuation">:</span>on    <span class="token number">4</span><span class="token punctuation">:</span>on    <span class="token number">5</span><span class="token punctuation">:</span>on    <span class="token number">6</span><span class="token punctuation">:</span>off

<span class="token comment"># MySQL æœåŠ¡åœ¨è¿è¡Œçº§åˆ« 2ã€3ã€4ã€5 ä¸‹æ˜¯å¯ç”¨çš„ï¼Œè€Œåœ¨è¿è¡Œçº§åˆ« 0 å’Œ 6 ä¸‹æ˜¯ç¦ç”¨çš„ã€‚è¿™æ„å‘³ç€ MySQL æœåŠ¡ä¼šåœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨ï¼Œå¹¶åœ¨è¿›å…¥å¤šç”¨æˆ·æ¨¡å¼ï¼ˆè¿è¡Œçº§åˆ« 2ã€3ã€4ã€5ï¼‰æ—¶ä¿æŒå¯ç”¨ã€‚</span>

chmod <span class="token number">777</span> <span class="token operator">/</span>etc<span class="token operator">/</span>rc<span class="token punctuation">.</span>d<span class="token operator">/</span>init<span class="token punctuation">.</span>d<span class="token operator">/</span>mysqld
chkconfig <span class="token operator">-</span><span class="token operator">-</span>add mysqld
chkconfig <span class="token operator">-</span><span class="token operator">-</span><span class="token builtin">list</span> mysqld
<span class="token punctuation">[</span>root@hadoop01 mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token punctuation">]</span><span class="token comment"># service mysqld status</span>
 SUCCESS! MySQL running <span class="token punctuation">(</span><span class="token number">5419</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>root@hadoop01 mysql<span class="token operator">-</span><span class="token number">5.7</span><span class="token number">.35</span><span class="token punctuation">]</span><span class="token comment"># reboot</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># ss -ntulp | grep mysql</span>
tcp    LISTEN     <span class="token number">0</span>      <span class="token number">128</span>    <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token number">3306</span>               <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token operator">*</span>                   users<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"mysqld"</span><span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">2133</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="hive_1583"></a><strong><strong>åˆ›å»ºhiveä½¿ç”¨çš„ç›¸å…³ç”¨æˆ·å¹¶æˆæƒ</strong></strong></h3> 
<pre><code class="prism language-python"><span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># grep password /opt/module/mysql-5.7.35/logs/error.log </span>
<span class="token number">2023</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span>02T10<span class="token punctuation">:</span><span class="token number">46</span><span class="token punctuation">:</span><span class="token number">22</span><span class="token punctuation">.</span>116862Z <span class="token number">1</span> <span class="token punctuation">[</span>Note<span class="token punctuation">]</span> A temporary password <span class="token keyword">is</span> generated <span class="token keyword">for</span> root@localhost<span class="token punctuation">:</span> 1WuYfoDmvc<span class="token operator">-</span>L

<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># mysqladmin -uroot -p'1WuYfoDmvc-L' password 123456</span>
<span class="token comment"># å‡ºç°è­¦å‘Šä¸ç”¨ç®¡ (å› ä¸ºå¯†ç ä½¿ç”¨äº†æ˜æ–‡)</span>

<span class="token comment"># ç™»å½• mysql å®¢æˆ·ç«¯</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># mysql -uroot -p123456</span>

<span class="token comment"># æ·»åŠ è¿œç¨‹è®¿é—®æƒé™</span>
root@mysqldb <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">:</span>  <span class="token punctuation">[</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> grant <span class="token builtin">all</span> privileges on <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> to <span class="token string">'root'</span>@<span class="token string">'%'</span> identified by <span class="token string">'123456'</span> <span class="token keyword">with</span> grant option<span class="token punctuation">;</span>

<span class="token comment"># åˆ›å»ºhiveæ•°æ®åº“å¹¶æˆæƒ</span>
root@mysqldb <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">14</span><span class="token punctuation">:</span>  <span class="token punctuation">[</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> create database hive<span class="token punctuation">;</span>
root@mysqldb <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">:</span>  <span class="token punctuation">[</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> create user <span class="token string">"hive"</span>@<span class="token string">"%"</span> identified by <span class="token string">"123456"</span><span class="token punctuation">;</span>
root@mysqldb <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">:</span>  <span class="token punctuation">[</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> grant <span class="token builtin">all</span> privileges on hive<span class="token punctuation">.</span><span class="token operator">*</span> to <span class="token string">"hive"</span>@<span class="token string">"%"</span><span class="token punctuation">;</span>
root@mysqldb <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">:</span>  <span class="token punctuation">[</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> flush privileges<span class="token punctuation">;</span>

<span class="token comment"># åˆ›å»ºä¸€ä¸ªåä¸º "hive" çš„æ•°æ®åº“ï¼Œåˆ›å»ºä¸€ä¸ªç”¨æˆ·åä¸º "hive"ï¼Œå…è®¸ä»ä»»ä½•ä¸»æœºï¼ˆ%è¡¨ç¤ºé€šé…ç¬¦ï¼Œè¡¨ç¤ºæ¥è‡ªä»»ä½•ä¸»æœºï¼‰è¿æ¥çš„ç”¨æˆ·ï¼Œå¹¶æˆäºˆè¯¥ç”¨æˆ·å¯¹ "hive" æ•°æ®åº“çš„æ‰€æœ‰æƒé™</span>

<span class="token comment"># è¾“å…¥exit é€€å‡ºå³å¯</span>
</code></pre> 
<h2><a id="hive_1609"></a>å…«ã€hiveé›†ç¾¤æ­å»º</h2> 
<h3><a id="hadoop__coresitexml_1611"></a>é¦–å…ˆéœ€è¦hadoop ç”¨æˆ·ä»£ç†æœåŠ¡ core-site.xml</h3> 
<pre><code class="prism language-python"><span class="token comment"># éœ€è¦å°†é›†ç¾¤éƒ½å…³é—­ï¼ï¼ï¼ å†è¿›è¡Œï¼ï¼ï¼</span>
<span class="token comment"># ä¿®æ”¹ hadoop é…ç½®æ–‡ä»¶å¤åˆ¶åˆ° hive ä¸­</span>
<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># cd /opt/module/hadoop-3.3.5/etc/hadoop/</span>
<span class="token punctuation">[</span>root@hadoop01 hadoop<span class="token punctuation">]</span><span class="token comment"># vim core-site.xml</span>

<span class="token comment"># æ·»åŠ ä»¥ä¸‹é…ç½®é¡¹ï¼š</span>
		<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hadoop<span class="token punctuation">.</span>proxyuser<span class="token punctuation">.</span>root<span class="token punctuation">.</span>hosts<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token operator">*</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hadoop<span class="token punctuation">.</span>proxyuser<span class="token punctuation">.</span>root<span class="token punctuation">.</span>groups<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token operator">*</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

<span class="token comment">#hadoop.proxyuser.xxx.hostså’Œhadoop.proxyuser.xxx.groups,å…¶ä¸­xxxä¸ºå¯åŠ¨HiveServer2çš„ç”¨æˆ·</span>
cp core<span class="token operator">-</span>site<span class="token punctuation">.</span>xml hdfs<span class="token operator">-</span>site<span class="token punctuation">.</span>xml <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hive<span class="token operator">-</span><span class="token number">3.1</span><span class="token number">.3</span><span class="token operator">/</span>conf<span class="token operator">/</span>

cd 
</code></pre> 
<h3><a id="_1636"></a>ä¸»æœºç¯å¢ƒé…ç½®</h3> 
<pre><code class="prism language-python"><span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># tar -zxvf /opt/software/apache-hive-3.1.3-bin.tar.gz -C /opt/module/</span>

<span class="token punctuation">[</span>root@hadoop01 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># cd /opt/module/</span>

<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># mv apache-hive-3.1.3-bin/ hive-3.1.3/</span>

<span class="token comment"># é…ç½® hbase ç¯å¢ƒå˜é‡</span>
vim <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment"># hiveç¯å¢ƒå˜é‡</span>
export HIVE_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hive<span class="token operator">-</span><span class="token number">3.1</span><span class="token number">.3</span>
export PATH<span class="token operator">=</span>$PATH<span class="token punctuation">:</span>$HIVE_HOME<span class="token operator">/</span><span class="token builtin">bin</span>

<span class="token comment"># æ¿€æ´»ç¯å¢ƒå˜é‡</span>
source <span class="token operator">/</span>etc<span class="token operator">/</span>profile
</code></pre> 
<h3><a id="hive__1656"></a>é…ç½®hive æ ¸å¿ƒæ–‡ä»¶</h3> 
<pre><code class="prism language-python">cd hive<span class="token operator">-</span><span class="token number">3.1</span><span class="token number">.3</span><span class="token operator">/</span>conf<span class="token operator">/</span>

<span class="token comment"># é…ç½®hiveæ—¥å¿—æ–‡ä»¶</span>
cp hive<span class="token operator">-</span>log4j2<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>template hive<span class="token operator">-</span>log4j2<span class="token punctuation">.</span>properties
<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># vim hive-log4j2.properties</span>

<span class="token comment"># ä¿®æ”¹ æ—¥å¿— å­˜æ”¾ä½ç½®</span>
<span class="token comment"># ä¿®æ”¹é…ç½®é¡¹ï¼š property.hive.log.dir = ${sys:java.io.tmpdir}/${sys:user.name} </span>
<span class="token comment"># ä¿®æ”¹ä¸º property.hive.log.dir = /opt/module/hive-3.1.3/logs</span>

<span class="token comment"># è§£å†³ hive æ§åˆ¶å°è¾“å‡ºå¤§é‡æ—¥å¿—ä¿¡æ¯ è§£å†³æ–¹æ³•</span>

<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># vim log4j.properties</span>
<span class="token comment"># æ’å…¥ä»¥ä¸‹å†…å®¹å³å¯</span>
log4j<span class="token punctuation">.</span>rootLogger<span class="token operator">=</span>WARN<span class="token punctuation">,</span>CA
log4j<span class="token punctuation">.</span>appender<span class="token punctuation">.</span>CA<span class="token operator">=</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>log4j<span class="token punctuation">.</span>ConsoleAppender
log4j<span class="token punctuation">.</span>appender<span class="token punctuation">.</span>CA<span class="token punctuation">.</span>layout<span class="token operator">=</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>log4j<span class="token punctuation">.</span>PatternLayout
log4j<span class="token punctuation">.</span>appender<span class="token punctuation">.</span>CA<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>ConversionPattern<span class="token operator">=</span><span class="token operator">%</span><span class="token operator">-</span>4r <span class="token punctuation">[</span><span class="token operator">%</span>t<span class="token punctuation">]</span> <span class="token operator">%</span><span class="token operator">-</span>5p <span class="token operator">%</span>c <span class="token operator">%</span>x <span class="token operator">-</span> <span class="token operator">%</span>m<span class="token operator">%</span>n

<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># cp hive-env.sh.template hive-env.sh</span>
<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># vim hive-env.sh</span>

<span class="token comment"># ä¿®æ”¹é…ç½®é¡¹å¦‚ä¸‹</span>
HADOOP_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hadoop<span class="token operator">-</span><span class="token number">3.3</span><span class="token number">.5</span>
export HIVE_CONF_DIR<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hive<span class="token operator">-</span><span class="token number">3.1</span><span class="token number">.3</span><span class="token operator">/</span>conf
export HIVE_AUX_JARS_PATH<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hive<span class="token operator">-</span><span class="token number">3.1</span><span class="token number">.3</span><span class="token operator">/</span>lib
export JAVA_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_391</span>   
</code></pre> 
<h3><a id="hivesitexml__metastore__hiveserver2_1688"></a><strong><strong>é…ç½®hive-site.xml æ–‡ä»¶ ï¼ˆmetastore å’Œ hiveserver2ï¼‰</strong></strong></h3> 
<aside>
  ğŸ’¡ è¯´æ˜ï¼šMetastoreè´Ÿè´£ç®¡ç†å’Œå­˜å‚¨Hiveè¡¨çš„å…ƒæ•°æ®ä¿¡æ¯ï¼Œè€ŒHiveServer2å……å½“HiveæœåŠ¡ç«¯ï¼Œå…è®¸å®¢æˆ·ç«¯é€šè¿‡ä¸åŒçš„æ¥å£ä¸Hiveäº¤äº’æ‰§è¡ŒæŸ¥è¯¢ã€‚ 
</aside> 
<pre><code class="prism language-python"><span class="token comment"># éœ€è¦å¼€å¯ hadoop é›†ç¾¤ å’Œ zookeeperé›†ç¾¤</span>
<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># hadoop fs -ls /user</span>
Found <span class="token number">1</span> items
drwxr<span class="token operator">-</span>xr<span class="token operator">-</span>x   <span class="token operator">-</span> root supergroup          <span class="token number">0</span> <span class="token number">2023</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">12</span><span class="token punctuation">:</span><span class="token number">59</span> <span class="token operator">/</span>user<span class="token operator">/</span>root

<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -mkdir -p /user/hive/{warehouse,tmp,logs}</span>
<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -chmod -R 777 /user/hive/</span>

<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># vim hive-site.xml </span>

<span class="token operator">&lt;</span>?xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span> standalone<span class="token operator">=</span><span class="token string">"no"</span>?<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>?xml<span class="token operator">-</span>stylesheet <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">"text/xsl"</span> href<span class="token operator">=</span><span class="token string">"configuration.xsl"</span>?<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>configuration<span class="token operator">&gt;</span>

	<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>æŒ‡å®šHiveå…ƒæ•°æ®å­˜å‚¨åœ¨æœ¬åœ° <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>metastore<span class="token punctuation">.</span>local<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>Hiveä½œä¸šçš„HDFSæ ¹ç›®å½•ä½ç½® <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">.</span>scratchdir<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token operator">/</span>user<span class="token operator">/</span>hive<span class="token operator">/</span>tmp<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>Hiveä½œä¸šçš„HDFSæ ¹ç›®å½•åˆ›å»ºå’Œå†™æƒé™ <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>scratch<span class="token punctuation">.</span><span class="token builtin">dir</span><span class="token punctuation">.</span>permission<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">777</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>æŒ‡å®šHiveå…ƒæ•°æ®å­˜æ”¾åœ¨HDFSä¸Šçš„ä½ç½® <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>metastore<span class="token punctuation">.</span>warehouse<span class="token punctuation">.</span><span class="token builtin">dir</span><span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token operator">/</span>user<span class="token operator">/</span>hive<span class="token operator">/</span>warehouse<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>è¿æ¥æ•°æ®åº“åœ°å€ï¼Œåç§° <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>javax<span class="token punctuation">.</span>jdo<span class="token punctuation">.</span>option<span class="token punctuation">.</span>ConnectionURL<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span><span class="token operator">//</span>hadoop01<span class="token punctuation">:</span><span class="token number">3306</span><span class="token operator">/</span>hive?createDatabaseIfNotExist<span class="token operator">=</span>true<span class="token operator">&amp;</span>amp<span class="token punctuation">;</span>useSSL<span class="token operator">=</span>false<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>è¿æ¥æ•°æ®åº“é©±åŠ¨ <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>javax<span class="token punctuation">.</span>jdo<span class="token punctuation">.</span>option<span class="token punctuation">.</span>ConnectionDriverName<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>Driver<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>è¿æ¥æ•°æ®åº“ç”¨æˆ·åç§° <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>javax<span class="token punctuation">.</span>jdo<span class="token punctuation">.</span>option<span class="token punctuation">.</span>ConnectionUserName<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hive<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>è¿æ¥æ•°æ®åº“ç”¨æˆ·å¯†ç  <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>javax<span class="token punctuation">.</span>jdo<span class="token punctuation">.</span>option<span class="token punctuation">.</span>ConnectionPassword<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">123456</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> æŒ‡å®šmetastoreè¿æ¥åœ°å€ <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>metastore<span class="token punctuation">.</span>uris<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>thrift<span class="token punctuation">:</span><span class="token operator">//</span>hadoop01<span class="token punctuation">:</span><span class="token number">9083</span><span class="token punctuation">,</span>thrift<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">9083</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>å¯ç”¨Hive Server2çš„åŠ¨æ€æœåŠ¡å‘ç°æ”¯æŒ<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>server2<span class="token punctuation">.</span>support<span class="token punctuation">.</span>dynamic<span class="token punctuation">.</span>service<span class="token punctuation">.</span>discovery<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>description<span class="token operator">&gt;</span>å½“å¯ç”¨æ—¶ï¼ŒHive Server <span class="token number">2</span>ä¼šæ³¨å†Œåˆ°ZooKeeperï¼Œå¹¶é€šè¿‡ZooKeeperè¿›è¡ŒæœåŠ¡å‘ç°ã€‚è¿™å¯ä»¥æ”¯æŒHive Server <span class="token number">2</span>çš„é«˜å¯ç”¨å’Œè´Ÿè½½å‡è¡¡é…ç½®<span class="token operator">&lt;</span><span class="token operator">/</span>description<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>å¯ç”¨Hive Server2çš„ä¸»å¤‡æ¨¡å¼<span class="token punctuation">,</span>å¹¶é€šè¿‡ZooKeeperé€‰ä¸¾ä¸€ä¸ªæ´»åŠ¨å®ä¾‹æ¥æä¾›æœåŠ¡<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>server2<span class="token punctuation">.</span>active<span class="token punctuation">.</span>passive<span class="token punctuation">.</span>ha<span class="token punctuation">.</span>enable<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>æŒ‡å®šåœ¨ZooKeeperä¸­ç”¨äºHive Server2çš„å‘½åç©ºé—´<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>server2<span class="token punctuation">.</span>zookeeper<span class="token punctuation">.</span>namespace<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hiveserver2_zk<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
	<span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>zookeeper<span class="token punctuation">.</span>quorum<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop01<span class="token punctuation">:</span><span class="token number">2181</span><span class="token punctuation">,</span>hadoop02<span class="token punctuation">:</span><span class="token number">2181</span><span class="token punctuation">,</span>hadoop03<span class="token punctuation">:</span><span class="token number">2181</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>    
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>zookeeper<span class="token punctuation">.</span>client<span class="token punctuation">.</span>port<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">2181</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>æŒ‡å®šHive Server2çš„ThriftæœåŠ¡ç›‘å¬çš„ç«¯å£å·<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>server2<span class="token punctuation">.</span>thrift<span class="token punctuation">.</span>port<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">10001</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>æŒ‡å®šHive Server2çš„ThriftæœåŠ¡ç»‘å®šçš„ä¸»æœºåæˆ–IPåœ°å€<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>server2<span class="token punctuation">.</span>thrift<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>host<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop02<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>querylog<span class="token punctuation">.</span>location<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token operator">/</span>user<span class="token operator">/</span>hive<span class="token operator">/</span>logs<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> æ˜¾ç¤ºè¡¨çš„åˆ—å <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>cli<span class="token punctuation">.</span><span class="token keyword">print</span><span class="token punctuation">.</span>header<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> æ˜¾ç¤ºæ•°æ®åº“åç§° <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>cli<span class="token punctuation">.</span><span class="token keyword">print</span><span class="token punctuation">.</span>current<span class="token punctuation">.</span>db<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
	
<span class="token operator">&lt;</span><span class="token operator">/</span>configuration<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="mysql_1825"></a>åˆå§‹åŒ–mysql</h3> 
<pre><code class="prism language-python"><span class="token comment"># å°†ä¸‹è½½ mysql é©±åŠ¨åŒ…åˆ° hive çš„ lib ç›®å½•ä¸‹</span>
<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># cp /opt/software/mysql-connector-java-5.1.49.jar /opt/module/hive-3.1.3/lib/</span>

<span class="token comment"># åˆ é™¤ hive ä¸‹çš„ log4j-slf4j-impl-2.17.1.jar,ä¼šä¸hadoopä¸‹çš„ slf4j-reload4j-1.7.36.jar å†²çª</span>
<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># rm -rf ../lib/log4j-slf4j-impl-2.17.1.jar</span>

<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># rm -rf /opt/module/hive-3.1.3/lib/guava-19.0.jar</span>
<span class="token punctuation">[</span>root@hadoop01 conf<span class="token punctuation">]</span><span class="token comment"># cp /opt/module/hadoop-3.3.5/share/hadoop/common/lib/guava-27.0-jre.jar /opt/module/hive-3.1.3/lib/</span>

<span class="token comment"># å°† hive æ–‡ä»¶ åŒæ­¥åˆ°å…¶ä»–ä¸»æœº</span>
cd <span class="token operator">/</span>opt<span class="token operator">/</span>module
<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># xsync hive-3.1.3/</span>
<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># xsync /etc/profile</span>

<span class="token comment"># åˆ†åˆ«åœ¨ hadoop02 å’Œ hadoop03 ä¸Š æ‰§è¡Œä»¥ä¸‹ä»£ç  æ¿€æ´»ç¯å¢ƒå˜é‡</span>
<span class="token comment"># åœ¨ hadoop02 å’Œ hadoop03 ä¸Š å»ºè®®å…ˆåˆ é™¤ å…³äº mysql çš„ç¯å¢ƒå˜é‡</span>
source <span class="token operator">/</span>etc<span class="token operator">/</span>profile

<span class="token comment"># åœ¨åˆå§‹åŒ– mysql ä¹‹å‰ è¦åœ¨hadoop03 ä¸Š ä¿®æ”¹ hive-site.xmlæ–‡ä»¶</span>
<span class="token comment"># åœ¨ hadoop02 ä¸Šä¸ç”¨ä¿®æ”¹,å› ä¸ºä½¿ç”¨çš„æ˜¯åŒä¸€ä»½é…ç½®,å³hadoop01 å’Œ hadoop02 æ˜¯ä¸€æ ·çš„</span>
<span class="token comment"># åœ¨ hadoop03 ä¸Šä¿®æ”¹</span>
    <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>æŒ‡å®šHive Server2çš„ThriftæœåŠ¡ç»‘å®šçš„ä¸»æœºåæˆ–IPåœ°å€<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token builtin">property</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive<span class="token punctuation">.</span>server2<span class="token punctuation">.</span>thrift<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>host<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>hadoop03<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token builtin">property</span><span class="token operator">&gt;</span>

<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># schematool -dbType mysql -initSchema</span>
Metastore connection URL<span class="token punctuation">:</span>        jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span><span class="token operator">//</span>hadoop01<span class="token punctuation">:</span><span class="token number">3306</span><span class="token operator">/</span>hive?createDatabaseIfNotExist<span class="token operator">=</span>true<span class="token operator">&amp;</span>useSSL<span class="token operator">=</span>false
Metastore Connection Driver <span class="token punctuation">:</span>    com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>Driver
Metastore connection User<span class="token punctuation">:</span>       hive
Starting metastore schema initialization to <span class="token number">3.1</span><span class="token number">.0</span>
Initialization script hive<span class="token operator">-</span>schema<span class="token operator">-</span><span class="token number">3.1</span><span class="token number">.0</span><span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>sql

Initialization script completed
schemaTool completed

<span class="token comment"># åˆå§‹åŒ–æˆåŠŸ</span>
</code></pre> 
<p>åœ¨æ•°æ®åº“ç®¡ç†å·¥å…·ä¸­ï¼Œå¯ä»¥è¿›è¡ŒæŸ¥çœ‹è™šæ‹Ÿæœºä¸­çš„mysqlæ•°æ®åº“ä¸­çš„hiveåº“ è¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯ datagrip</p> 
<p><img src="https://images2.imgbox.com/34/e5/KNGqRWPl_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202312040920856.png"></p> 
<h4><a id="_1872"></a>åˆå§‹åŒ–æŠ¥é”™è§£å†³æ–¹æ³•</h4> 
<pre><code class="prism language-python"><span class="token comment"># å¦‚æœæŒ‰ç…§æˆ‘å®ç°çš„é¡ºåºè¿›è¡Œ,ä¸€èˆ¬ä¸ä¼šå‡ºç°é—®é¢˜</span>
<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># schematool -dbType mysql -initSchema</span>
Metastore connection URL<span class="token punctuation">:</span>        jdbc<span class="token punctuation">:</span>derby<span class="token punctuation">:</span><span class="token punctuation">;</span>databaseName<span class="token operator">=</span>metastore_db<span class="token punctuation">;</span>create<span class="token operator">=</span>true
Metastore Connection Driver <span class="token punctuation">:</span>    org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>derby<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>EmbeddedDriver
Metastore connection User<span class="token punctuation">:</span>       APP
Starting metastore schema initialization to <span class="token number">3.1</span><span class="token number">.0</span>
Initialization script hive<span class="token operator">-</span>schema<span class="token operator">-</span><span class="token number">3.1</span><span class="token number">.0</span><span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>sql

Error<span class="token punctuation">:</span> Syntax error<span class="token punctuation">:</span> Encountered <span class="token string">"&lt;EOF&gt;"</span> at line <span class="token number">1</span><span class="token punctuation">,</span> column <span class="token number">64.</span> <span class="token punctuation">(</span>state<span class="token operator">=</span>42X01<span class="token punctuation">,</span>code<span class="token operator">=</span><span class="token number">30000</span><span class="token punctuation">)</span>
org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>hive<span class="token punctuation">.</span>metastore<span class="token punctuation">.</span>HiveMetaException<span class="token punctuation">:</span> Schema initialization FAILED! Metastore state would be inconsistent !!
Underlying cause<span class="token punctuation">:</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException <span class="token punctuation">:</span> Schema script failed<span class="token punctuation">,</span> errorcode <span class="token number">2</span>
Use <span class="token operator">-</span><span class="token operator">-</span>verbose <span class="token keyword">for</span> detailed stacktrace<span class="token punctuation">.</span>
<span class="token operator">**</span><span class="token operator">*</span> schemaTool failed <span class="token operator">**</span><span class="token operator">*</span>

<span class="token comment"># åˆå§‹åŒ–å¤±è´¥äº†,é€šè¿‡æŸ¥è¯¢ åŸå› æ˜¯ hive ä¸­çš„ lib æ–‡ä»¶é‡Œé¢ å…³äº guava-19.0.jar ç‰ˆæœ¬ä¸º 19 è€Œåœ¨ hadoop ä¸­çš„ç‰ˆæœ¬ä¸º 27 guava-27.0-jre.jar</span>
<span class="token comment"># è§£å†³æ–¹æ³•:</span>
<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># rm -rf /opt/module/hive-3.1.3/lib/guava-19.0.jar</span>
<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># cp /opt/module/hadoop-3.3.5/share/hadoop/common/lib/guava-27.0-jre.jar /opt/module/hive-3.1.3/lib/</span>

<span class="token comment"># é‡æ–°æ‰§è¡Œæ ¼å¼åŒ–</span>

<span class="token punctuation">[</span>root@hadoop01 module<span class="token punctuation">]</span><span class="token comment"># schematool -dbType mysql -initSchema</span>
Metastore connection URL<span class="token punctuation">:</span>        jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span><span class="token operator">//</span>hadoop01<span class="token punctuation">:</span><span class="token number">3306</span><span class="token operator">/</span>hive?createDatabaseIfNotExist<span class="token operator">=</span>true<span class="token operator">&amp;</span>useSSL<span class="token operator">=</span>false
Metastore Connection Driver <span class="token punctuation">:</span>    com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>Driver
Metastore connection User<span class="token punctuation">:</span>       hive
Starting metastore schema initialization to <span class="token number">3.1</span><span class="token number">.0</span>
Initialization script hive<span class="token operator">-</span>schema<span class="token operator">-</span><span class="token number">3.1</span><span class="token number">.0</span><span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>sql
Error<span class="token punctuation">:</span> Table <span class="token string">'CTLGS'</span> already exists <span class="token punctuation">(</span>state<span class="token operator">=</span>42S01<span class="token punctuation">,</span>code<span class="token operator">=</span><span class="token number">1050</span><span class="token punctuation">)</span>
org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>hive<span class="token punctuation">.</span>metastore<span class="token punctuation">.</span>HiveMetaException<span class="token punctuation">:</span> Schema initialization FAILED! Metastore state would be inconsistent !!
Underlying cause<span class="token punctuation">:</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException <span class="token punctuation">:</span> Schema script failed<span class="token punctuation">,</span> errorcode <span class="token number">2</span>
Use <span class="token operator">-</span><span class="token operator">-</span>verbose <span class="token keyword">for</span> detailed stacktrace<span class="token punctuation">.</span>
<span class="token operator">**</span><span class="token operator">*</span> schemaTool failed <span class="token operator">**</span><span class="token operator">*</span>

<span class="token comment"># éœ€è¦è¿æ¥æ•°æ®åº“ï¼Œå°†hive ä¸­çš„æ‰€æœ‰è¡¨è¿›è¡Œåˆ é™¤</span>
</code></pre> 
<h4><a id="metastore_1911"></a><strong><strong>å¯åŠ¨metastore</strong></strong></h4> 
<pre><code class="prism language-python"><span class="token punctuation">[</span>root@hadoop02 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># nohup hive --service metastore &gt;&gt; /opt/module/hive-3.1.3/logs/metastore.log 2&gt;&amp;1 &amp;</span>

<span class="token punctuation">[</span>root@hadoop02 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># mkdir /opt/module/hive-3.1.3/logs</span>
<span class="token punctuation">[</span>root@hadoop02 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># nohup hive --service metastore &gt;&gt; /opt/module/hive-3.1.3/logs/metastore.log 2&gt;&amp;1 &amp;</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">3695</span>
<span class="token comment">#æŸ¥çœ‹å¯åŠ¨çš„æœåŠ¡ï¼ŒéªŒè¯</span>

<span class="token punctuation">[</span>root@hadoop02 hive<span class="token operator">-</span><span class="token number">3.1</span><span class="token number">.3</span><span class="token punctuation">]</span><span class="token comment"># ss -ntulp | grep 3695</span>
tcp    LISTEN     <span class="token number">0</span>      <span class="token number">50</span>     <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token number">9083</span>               <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token operator">*</span>                   users<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"java"</span><span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">3695</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">630</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="hiveserver2_1925"></a><strong><strong>å¯åŠ¨hiveserver2</strong></strong></h4> 
<pre><code class="prism language-python"><span class="token punctuation">[</span>root@hadoop02 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># nohup hive --service hiveserver2 &gt;&gt; /opt/module/hive-3.1.3/logs/hiveserver2.log 2&gt;&amp;1 &amp;</span>

<span class="token punctuation">[</span>root@hadoop03 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># mkdir /opt/module/hive-3.1.3/logs</span>
<span class="token punctuation">[</span>root@hadoop03 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># nohup hive --service hiveserver2 &gt;&gt; /opt/module/hive-3.1.3/logs/hiveserver2.log 2&gt;&amp;1 &amp;</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">2141</span>
<span class="token comment">#æŸ¥çœ‹å¯åŠ¨çš„æœåŠ¡ï¼ŒéªŒè¯</span>

<span class="token punctuation">[</span>root@hadoop03 hadoop<span class="token punctuation">]</span><span class="token comment"># ss -ntulp | grep 2141</span>
tcp    LISTEN     <span class="token number">0</span>      <span class="token number">50</span>     <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token number">10001</span>              <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token operator">*</span>                   users<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"java"</span><span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">2141</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">627</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
tcp    LISTEN     <span class="token number">0</span>      <span class="token number">50</span>     <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token number">10002</span>              <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token operator">*</span>                   users<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"java"</span><span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">2141</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">632</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="hive_1940"></a>hiveå¯åŠ¨æµ‹è¯•</h4> 
<p>åœ¨æµè§ˆå™¨ä¸Šè¾“å…¥ hadoop02:10002æˆ–è€…hadoop03:10002</p> 
<p><img src="https://images2.imgbox.com/2a/80/zhvfuv2a_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202312031945149.png"></p> 
<pre><code class="prism language-python"><span class="token comment"># åœ¨æœ¬æ¬¡ hive é›†ç¾¤æ­å»ºçš„è¿‡ç¨‹ä¸­,æˆ‘å°† hadoop03 å½“ä½œå®¢æˆ·æœºæ¥ä½¿ç”¨</span>
<span class="token comment"># è¿æ¥æµ‹è¯• </span>
<span class="token punctuation">[</span>root@hadoop03 hadoop<span class="token punctuation">]</span><span class="token comment"># beeline -u jdbc:hive2://hadoop02:10001</span>
Connecting to jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span>
<span class="token number">2023</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">03</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token number">06</span><span class="token punctuation">:</span><span class="token number">53</span><span class="token punctuation">,</span><span class="token number">137</span> INFO jdbc<span class="token punctuation">.</span>Utils<span class="token punctuation">:</span> Supplied authorities<span class="token punctuation">:</span> hadoop02<span class="token punctuation">:</span><span class="token number">10001</span>
<span class="token number">2023</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">03</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token number">06</span><span class="token punctuation">:</span><span class="token number">53</span><span class="token punctuation">,</span><span class="token number">139</span> INFO jdbc<span class="token punctuation">.</span>Utils<span class="token punctuation">:</span> Resolved authority<span class="token punctuation">:</span> hadoop02<span class="token punctuation">:</span><span class="token number">10001</span>
Connected to<span class="token punctuation">:</span> Apache Hive <span class="token punctuation">(</span>version <span class="token number">3.1</span><span class="token number">.3</span><span class="token punctuation">)</span>
Driver<span class="token punctuation">:</span> Hive JDBC <span class="token punctuation">(</span>version <span class="token number">2.3</span><span class="token number">.9</span><span class="token punctuation">)</span>
Transaction isolation<span class="token punctuation">:</span> TRANSACTION_REPEATABLE_READ
Beeline version <span class="token number">2.3</span><span class="token number">.9</span> by Apache Hive
<span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span><span class="token operator">&gt;</span> Closing<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span>

<span class="token punctuation">[</span>root@hadoop03 hadoop<span class="token punctuation">]</span><span class="token comment"># beeline -u jdbc:hive2://hadoop03:10001</span>
Connecting to jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop03<span class="token punctuation">:</span><span class="token number">10001</span>
<span class="token number">2023</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">03</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token number">08</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">208</span> INFO jdbc<span class="token punctuation">.</span>Utils<span class="token punctuation">:</span> Supplied authorities<span class="token punctuation">:</span> hadoop03<span class="token punctuation">:</span><span class="token number">10001</span>
<span class="token number">2023</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">03</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token number">08</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">209</span> INFO jdbc<span class="token punctuation">.</span>Utils<span class="token punctuation">:</span> Resolved authority<span class="token punctuation">:</span> hadoop03<span class="token punctuation">:</span><span class="token number">10001</span>
Connected to<span class="token punctuation">:</span> Apache Hive <span class="token punctuation">(</span>version <span class="token number">3.1</span><span class="token number">.3</span><span class="token punctuation">)</span>
Driver<span class="token punctuation">:</span> Hive JDBC <span class="token punctuation">(</span>version <span class="token number">2.3</span><span class="token number">.9</span><span class="token punctuation">)</span>
Transaction isolation<span class="token punctuation">:</span> TRANSACTION_REPEATABLE_READ
Beeline version <span class="token number">2.3</span><span class="token number">.9</span> by Apache Hive
<span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop03<span class="token punctuation">:</span><span class="token number">10001</span><span class="token operator">&gt;</span> Closing<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop03<span class="token punctuation">:</span><span class="token number">10001</span>
</code></pre> 
<p>hiveæ•°æ®åº“åˆ›å»ºæµ‹è¯•å¹¶æŸ¥çœ‹hiveserver2çŠ¶æ€</p> 
<pre><code class="prism language-python"><span class="token punctuation">[</span>root@hadoop03 hadoop<span class="token punctuation">]</span><span class="token comment"># beeline</span>
Beeline version <span class="token number">2.3</span><span class="token number">.9</span> by Apache Hive
beeline<span class="token operator">&gt;</span> !connect jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span>
Connecting to jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span>
Enter username <span class="token keyword">for</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span><span class="token punctuation">:</span> hive
Enter password <span class="token keyword">for</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span><span class="token punctuation">:</span> 
<span class="token number">2023</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">03</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token number">46</span><span class="token punctuation">:</span><span class="token number">57</span><span class="token punctuation">,</span><span class="token number">731</span> INFO jdbc<span class="token punctuation">.</span>Utils<span class="token punctuation">:</span> Supplied authorities<span class="token punctuation">:</span> hadoop02<span class="token punctuation">:</span><span class="token number">10001</span>
<span class="token number">2023</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">03</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token number">46</span><span class="token punctuation">:</span><span class="token number">57</span><span class="token punctuation">,</span><span class="token number">732</span> INFO jdbc<span class="token punctuation">.</span>Utils<span class="token punctuation">:</span> Resolved authority<span class="token punctuation">:</span> hadoop02<span class="token punctuation">:</span><span class="token number">10001</span>
Connected to<span class="token punctuation">:</span> Apache Hive <span class="token punctuation">(</span>version <span class="token number">3.1</span><span class="token number">.3</span><span class="token punctuation">)</span>
Driver<span class="token punctuation">:</span> Hive JDBC <span class="token punctuation">(</span>version <span class="token number">2.3</span><span class="token number">.9</span><span class="token punctuation">)</span>
Transaction isolation<span class="token punctuation">:</span> TRANSACTION_REPEATABLE_READ
<span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span><span class="token operator">&gt;</span> create database <span class="token keyword">if</span> <span class="token keyword">not</span> exists mytestdb<span class="token punctuation">;</span>
No rows affected <span class="token punctuation">(</span><span class="token number">0.1</span> seconds<span class="token punctuation">)</span>
<span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span><span class="token operator">&gt;</span> use mytestdb<span class="token punctuation">;</span>
No rows affected <span class="token punctuation">(</span><span class="token number">0.059</span> seconds<span class="token punctuation">)</span>
<span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span><span class="token operator">&gt;</span> show tables<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span>   tab_name   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> mytesttable  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token number">1</span> row selected <span class="token punctuation">(</span><span class="token number">0.127</span> seconds<span class="token punctuation">)</span>
<span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span><span class="token operator">&gt;</span> describe database mytestdb<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span>  db_name  <span class="token operator">|</span> comment  <span class="token operator">|</span>                     location                      <span class="token operator">|</span> owner_name  <span class="token operator">|</span> owner_type  <span class="token operator">|</span> parameters  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> mytestdb  <span class="token operator">|</span>          <span class="token operator">|</span> hdfs<span class="token punctuation">:</span><span class="token operator">//</span>mycluster<span class="token operator">/</span>user<span class="token operator">/</span>hive<span class="token operator">/</span>warehouse<span class="token operator">/</span>mytestdb<span class="token punctuation">.</span>db  <span class="token operator">|</span> anonymous   <span class="token operator">|</span> USER        <span class="token operator">|</span>             <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token number">1</span> row selected <span class="token punctuation">(</span><span class="token number">0.068</span> seconds<span class="token punctuation">)</span>
<span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span><span class="token operator">&gt;</span> CREATE EXTERNAL TABLE IF NOT EXISTS mytesttable <span class="token punctuation">(</span>
<span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token operator">&gt;</span> name string<span class="token punctuation">,</span>
<span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token operator">&gt;</span> age string<span class="token punctuation">,</span>
<span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token operator">&gt;</span> workplace ARRAY<span class="token operator">&lt;</span>STRING<span class="token operator">&gt;</span>
<span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token operator">&gt;</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token operator">&gt;</span> COMMENT <span class="token string">'This is an text table'</span><span class="token punctuation">;</span>
No rows affected <span class="token punctuation">(</span><span class="token number">0.074</span> seconds<span class="token punctuation">)</span>
<span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span><span class="token operator">&gt;</span> show tables<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span>   tab_name   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> mytesttable  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token number">1</span> row selected <span class="token punctuation">(</span><span class="token number">0.091</span> seconds<span class="token punctuation">)</span>
<span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span><span class="token operator">&gt;</span> desc mytesttable<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span>  col_name  <span class="token operator">|</span>   data_type    <span class="token operator">|</span> comment  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> name       <span class="token operator">|</span> string         <span class="token operator">|</span>          <span class="token operator">|</span>
<span class="token operator">|</span> age        <span class="token operator">|</span> string         <span class="token operator">|</span>          <span class="token operator">|</span>
<span class="token operator">|</span> workplace  <span class="token operator">|</span> array<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span>  <span class="token operator">|</span>          <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token number">3</span> rows selected <span class="token punctuation">(</span><span class="token number">0.136</span> seconds<span class="token punctuation">)</span>
<span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span><span class="token operator">&gt;</span> Closing<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>hive2<span class="token punctuation">:</span><span class="token operator">//</span>hadoop02<span class="token punctuation">:</span><span class="token number">10001</span>
</code></pre> 
<p>å¯ä»¥æŸ¥çœ‹ï¼Œæˆ‘ä»¬åˆ›å»ºæ•°æ®åº“çš„è¿‡ç¨‹ä¸­ï¼Œæ‰€ä½¿ç”¨çš„è¯­å¥ä¿¡æ¯ä¼šåŒæ—¶ä¿å­˜åˆ°hdfsä¸­ï¼Œå¹¶ä¸”ä½¿ç”¨mapreduceçš„å½¢å¼è¿è¡Œ</p> 
<p><img src="https://images2.imgbox.com/66/9c/DwaOsWYC_o.png" alt="https://gitee.com/zth0828/pictures-saving/raw/master/202312032350369.png"></p> 
<h2><a id="_2033"></a>å¦é™„ä¸Šè¿°è½¯ä»¶ä¸‹è½½åœ°å€</h2> 
<pre><code class="prism language-python"><span class="token comment"># jdk https://www.oracle.com/java/technologies/downloads/#sjre8-windows  ç„¶åé€‰æ‹©æœ€æ–°çš„linux jdkä¸‹è½½å°±å¥½ ä¸è¿‡éœ€è¦æ³¨å†Œoracleè´¦å·è¿›è¡Œä¸‹è½½</span>
<span class="token comment"># hadoop https://archive.apache.org/dist/hadoop/common/hadoop-3.3.5/hadoop-3.3.5.tar.gz</span>
<span class="token comment"># hbase https://dlcdn.apache.org/hbase/2.4.17/hbase-2.4.17-bin.tar.gz</span>
<span class="token comment"># hive https://dlcdn.apache.org/hive/hive-3.1.3/apache-hive-3.1.3-bin.tar.gz</span>
<span class="token comment"># kafka https://archive.apache.org/dist/kafka/3.4.0/kafka_2.12-3.4.0.tgz</span>
<span class="token comment"># spark https://archive.apache.org/dist/spark/spark-3.2.4/spark-3.2.4-bin-hadoop3.2-scala2.13.tgz</span>
<span class="token comment"># flink https://archive.apache.org/dist/flink/flink-1.16.1/flink-1.16.1-bin-scala_2.12.tgz</span>
<span class="token comment"># flink-share https://repo.maven.apache.org/maven2/org/apache/flink/flink-shaded-hadoop-2-uber/2.8.3-10.0/flink-shaded-hadoop-2-uber-2.8.3-10.0.jar</span>
<span class="token comment"># mysql https://cdn.mysql.com/archives/mysql-5.7/mysql-5.7.35-el7-x86_64.tar.gz</span>
<span class="token comment"># mysql-jdbc https://repo1.maven.org/maven2/mysql/mysql-connector-java/5.1.49/mysql-connector-java-5.1.49.jar</span>

<span class="token comment"># è½¯ä»¶æ‰“åŒ…é“¾æ¥</span>
é“¾æ¥ï¼šhttps<span class="token punctuation">:</span><span class="token operator">//</span>pan<span class="token punctuation">.</span>baidu<span class="token punctuation">.</span>com<span class="token operator">/</span>s<span class="token operator">/</span>19cmBl9fpf7<span class="token operator">-</span>7luxtBhMUJw?pwd<span class="token operator">=</span>bkth 
æå–ç ï¼šbkth 
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/651ef463318d6cd4eb28f5ac89a73bea/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">æ’åºç®—æ³•-æ’å…¥/å¸Œå°”æ’åº</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e81eaf0af87495cdab7993a81d177f10/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">macOS Big Sur/Macç”µè„‘å®‰è£…vscodeæ˜¾ç¤ºæ‚¨æ²¡æœ‰æƒé™æ¥æ‰“å¼€åº”ç”¨ç¨‹åºâ€˜Visual Studio Codeâ€˜ è¯·è”ç³»æ‚¨çš„ç”µè„‘æˆ–ç½‘ç»œç®¡ç†å‘˜é—®é¢˜ä¿®å¤</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§å’–.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>