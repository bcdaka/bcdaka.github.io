<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>高阶数据结构 ＜红黑树＞ - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/572f1a1d2b07a4a5855e6d7b636eaf5e/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="高阶数据结构 ＜红黑树＞">
  <meta property="og:description" content="本文已收录至《数据结构(C/C&#43;&#43;语言)》专栏！
作者：ARMCSKGT 目录 前言正文红黑树简介红黑树整体结构红黑树节点的定义红黑树主体类设计红黑树的插入函数情况一：变色情况二：变色&#43;旋转单旋情况双旋情况 完整插入代码 关于红黑树红黑树检验红黑树 vs AVL树 最后 前言 红黑树是二叉搜索树的一种，但是红黑树是性能最均衡应用场景最广的一种二叉搜索树，相对于AVL树来说，红黑树在旋转条件上并不是很严格，但是依然可以有非常出色的查找性能，这得益于红黑树的性质，本节将为大家介绍红黑树的基本性质。
正文 本文相关知识点：二叉搜索树(搜索树性质)，AVL树(旋转相关)
如果大家对二叉搜索树性质不熟悉或者对树的旋转调整不熟悉，可以先移步这两篇文章就行了解！
红黑树简介 红黑树是在1972年由Rudolf Bayer发明的，当时被称为平衡二叉B树（symmetric binary B-trees）。后来，在1978年被 Leo J. Guibas 和 Robert Sedgewick 修改为如今的“红黑树”。
红黑树，是一种二叉搜索树，但在每个结点上增加一个存储位表示结点的颜色，可以是Red或Black。 通过对任何一条从根到叶子的路径上各个结点着色方式的限制，红黑树确保没有一条路径会比其他路径长出俩倍，因而是接近平衡的。
前面我们介绍了AVL树，AVL树有着极其严格的平衡标准，这使得AVL树在某些极端情况下可能会频繁旋转导致插入和删除性能下降，而红黑树只有在极度不平衡下才会调整，对于红黑树来说，极度不平衡就是最长路径大于最短路径的两倍！
红黑树的性质：
每个节点不是黑色就是红色根节点是黑色如果一个节点是红色的，则它的两个孩子结点是黑色的（不存在连续的红色节点，例如父子节点都是红色）每条路径上叶子节点都是黑色的（红黑树中空节点NIL可以理解为叶子节点，这个叶节点没有特殊意思，方便判断）每条路径上的黑色节点数量相同 按照红黑树的性质，可以知道： 上图中，如果是AVL树就需要进行左单旋降低高度，而红黑树则不需要调整。
可以说，最短路径是全黑节点，最长路径是红黑相间。
因为最长路径的节点数量不能超过最短路径节点数量的两倍，所以 黑节点数量大于等于红节点数量。
我们一般在使用容器时，增删查改是都会出现的，如果使用AVL树，查找性能非常好，但是插入性能就一般了，所以一般语言标准中的容器都会使用红黑树，性能比较均衡，而AVL树则时候那些只读的静态数据，专门用于查询！
关于实际的性能差距，假设二叉树有n个节点，AVL树查询的时间复杂度为O( l o g 2 n log_2n log2​n)；红黑树查询的最优效率为O( l o g 2 n log_2n log2​n)，最差效率为O( 2 l o g 2 n 2log_2n 2log2​n)。 l o g 2 n log_2n log2​n和 2 l o g 2 n 2log_2n 2log2​n这两个数值的差距，对于计算机来说可以忽略不计，假设有10亿，也仅仅是30和60次查找的差别！">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-27T16:22:40+08:00">
    <meta property="article:modified_time" content="2024-03-27T16:22:40+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">高阶数据结构 ＜红黑树＞</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p><img src="https://images2.imgbox.com/05/6a/Nlt9kjci_o.jpg" alt="红黑树"><br> <br> <em></em></p> 
 <center> 
  <strong>本文已收录至《<a href="https://blog.csdn.net/m0_73446322/category_12100295.html">数据结构(C/C++语言)</a>》专栏！<br> 作者：<a href="https://blog.csdn.net/m0_73446322?spm=1011.2421.3001.5343">ARMCSKGT</a></strong> 
 </center> 
 <br> 
 <img src="https://images2.imgbox.com/4b/af/0Mqn7Udp_o.gif" alt="CSDN"> 
 <p></p> 
</blockquote> 
<hr> 
<p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#_8" rel="nofollow">前言</a></li><li><a href="#_12" rel="nofollow">正文</a></li><li><ul><li><a href="#_16" rel="nofollow">红黑树简介</a></li><li><a href="#_54" rel="nofollow">红黑树整体结构</a></li><li><a href="#_95" rel="nofollow">红黑树节点的定义</a></li><li><a href="#_150" rel="nofollow">红黑树主体类设计</a></li><li><a href="#_196" rel="nofollow">红黑树的插入函数</a></li><li><ul><li><a href="#_289" rel="nofollow">情况一：变色</a></li><li><a href="#_338" rel="nofollow">情况二：变色+旋转</a></li><li><ul><li><a href="#_356" rel="nofollow">单旋情况</a></li><li><a href="#_429" rel="nofollow">双旋情况</a></li></ul> 
    </li><li><a href="#_507" rel="nofollow">完整插入代码</a></li></ul> 
   </li><li><a href="#_627" rel="nofollow">关于红黑树</a></li><li><ul><li><a href="#_629" rel="nofollow">红黑树检验</a></li><li><a href="#_vs_AVL_695" rel="nofollow">红黑树 vs AVL树</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_754" rel="nofollow">最后</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_8"></a>前言</h2> 
<p>红黑树是二叉搜索树的一种，但是红黑树是性能最均衡应用场景最广的一种二叉搜索树，相对于AVL树来说，红黑树在旋转条件上并不是很严格，但是依然可以有非常出色的查找性能，这得益于红黑树的性质，本节将为大家介绍红黑树的基本性质。<br> <img src="https://images2.imgbox.com/27/46/MrTqn2Uf_o.png" alt=""></p> 
<hr> 
<h2><a id="_12"></a>正文</h2> 
<p>本文相关知识点：<a href="https://blog.csdn.net/m0_73446322/article/details/134784892?spm=1001.2014.3001.5502">二叉搜索树(搜索树性质)</a>，<a href="https://blog.csdn.net/m0_73446322/article/details/136662144?spm=1001.2014.3001.5502">AVL树(旋转相关)</a><br> 如果大家对<strong>二叉搜索树性质不熟悉</strong>或者对树的<strong>旋转调整不熟悉</strong>，可以先移步这两篇文章就行了解！</p> 
<blockquote> 
 <h3><a id="_16"></a>红黑树简介</h3> 
 <hr> 
 <p>红黑树是在1972年由<strong>Rudolf Bayer</strong>发明的，当时被称为平衡二叉B树（symmetric binary B-trees）。后来，在1978年被 <strong>Leo J. Guibas</strong> 和 <strong>Robert Sedgewick</strong> 修改为如今的“红黑树”。</p> 
 <br> 
 <p>红黑树，是一种二叉搜索树，但在每个结点上增加一个存储位表示结点的颜色，可以是Red或Black。 <strong>通过对任何一条从根到叶子的路径上各个结点着色方式的限制，红黑树确保没有一条路径会比其他路径长出俩倍，因而是接近平衡的</strong>。</p> 
 <br> 
 <p>前面我们介绍了AVL树，AVL树有着极其严格的平衡标准，这使得AVL树在某些极端情况下可能会频繁旋转导致插入和删除性能下降，而红黑树只有在极度不平衡下才会调整，对于红黑树来说，<strong>极度不平衡就是最长路径大于最短路径的两倍</strong>！</p> 
 <br> 
 <blockquote> 
  <p>红黑树的性质：</p> 
  <ul><li>每个节点不是黑色就是红色</li><li>根节点是黑色</li><li>如果一个节点是红色的，则它的两个孩子结点是黑色的（不存在连续的红色节点，例如父子节点都是红色）</li><li>每条路径上叶子节点都是黑色的（红黑树中空节点NIL可以理解为叶子节点，这个叶节点没有特殊意思，方便判断）</li><li>每条路径上的黑色节点数量相同</li></ul> 
 </blockquote> 
 <br> 按照红黑树的性质，可以知道： 
 <p><img src="https://images2.imgbox.com/ee/5c/cZEwP1bv_o.png" alt="红黑树性质"><br> 上图中，如果是AVL树就需要进行左单旋降低高度，而红黑树则不需要调整。<br> 可以说，最短路径是全黑节点，最长路径是红黑相间。<br> 因为最长路径的节点数量不能超过最短路径节点数量的两倍，所以 黑节点数量大于等于红节点数量。</p> 
 <br> 
 <p>我们一般在使用容器时，增删查改是都会出现的，如果使用AVL树，查找性能非常好，但是插入性能就一般了，<strong>所以一般语言标准中的容器都会使用红黑树，性能比较均衡</strong>，而AVL树则时候那些只读的静态数据，专门用于查询！</p> 
 <br> 
 <p><strong>关于实际的性能差距，假设二叉树有n个节点，AVL树查询的时间复杂度为O(<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           l 
          
         
           o 
          
          
          
            g 
           
          
            2 
           
          
         
           n 
          
         
        
          log_2n 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathnormal">n</span></span></span></span></span>)；红黑树查询的最优效率为O(<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           l 
          
         
           o 
          
          
          
            g 
           
          
            2 
           
          
         
           n 
          
         
        
          log_2n 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathnormal">n</span></span></span></span></span>)，最差效率为O(<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           2 
          
         
           l 
          
         
           o 
          
          
          
            g 
           
          
            2 
           
          
         
           n 
          
         
        
          2log_2n 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathnormal">n</span></span></span></span></span>)。<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           l 
          
         
           o 
          
          
          
            g 
           
          
            2 
           
          
         
           n 
          
         
        
          log_2n 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathnormal">n</span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           2 
          
         
           l 
          
         
           o 
          
          
          
            g 
           
          
            2 
           
          
         
           n 
          
         
        
          2log_2n 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathnormal">n</span></span></span></span></span>这两个数值的差距，对于计算机来说可以忽略不计，假设有10亿，也仅仅是30和60次查找的差别！</strong></p> 
</blockquote> 
<hr> 
<blockquote> 
 <h3><a id="_54"></a>红黑树整体结构</h3> 
 <hr> 
 <p>红黑树需要定义节点，比较函数和红黑树类主体，所以分为三部分，封装在红黑树命名空间中！<br> <br> 对于比较函数，我们使用仿函数控制，使用模板参数传参，默认K类型参数为比较对象，使用者也可以自己按要求实现比较函数，按自己的比较规则控制红黑树。<br> <br> 同时，我们在头文件中实现，为了防止重复包含，使用 #ifndef~#endif 来就行条件编译。</p> 
 <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">RB_TREE</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">RB_TREE</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword">namespace</span> RB_Tree
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">typedef</span> <span class="token keyword">bool</span> Color<span class="token punctuation">;</span>         <span class="token comment">//重定义定义bool为颜色类型</span>
	<span class="token keyword">const</span> <span class="token keyword">bool</span> RED <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>      <span class="token comment">//定义 true 为 RED 常量值 对应红色节点</span>
	<span class="token keyword">const</span> <span class="token keyword">bool</span> BLACK <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>   <span class="token comment">//定义 false 为 BLACK 常量值 对应黑色节点</span>
	<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">V</span><span class="token operator">&gt;</span>
	<span class="token keyword">struct</span> <span class="token class-name">RBTreeNode</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//红黑树节点成员</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token comment">//默认比较仿函数</span>
	<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
	<span class="token keyword">struct</span> <span class="token class-name">less</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> left<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span> right<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> left <span class="token operator">&lt;</span> right<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
	<span class="token keyword">struct</span> <span class="token class-name">greater</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> left<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span> right<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> left <span class="token operator">&gt;</span> right<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token comment">//红黑树类主体</span>
	<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">V</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">Compare</span> <span class="token operator">=</span> less<span class="token operator">&lt;</span>K<span class="token operator">&gt;&gt;</span>
	<span class="token keyword">class</span> <span class="token class-name">RBTree</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//红黑树类主体成员</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// !RB_TREE</span></span>
</code></pre> 
</blockquote> 
<hr> 
<blockquote> 
 <h3><a id="_95"></a>红黑树节点的定义</h3> 
 <hr> 
 <p>红黑树依然是三叉链结构，需要一个父节点指针，同时有一个颜色节点来区分红黑节点。<br> 这里红黑节点采用bool值区分，true为红，false为黑。<br> <img src="https://images2.imgbox.com/68/22/IQ1t5wXc_o.png" alt="红黑树节点定义"><br> 我们采用key-value键值对模型来构造红黑树，形成映射关系(搜索树类容器属于关系型容器)。<br> 这里的键值对，我们采用C++标准库提供的<code>pair对象</code>来实现。</p> 
 <br> 
 <p><strong>代码：</strong></p> 
 <pre><code class="prism language-cpp"><span class="token keyword">struct</span> <span class="token class-name">RBTreeNode</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">typedef</span> std<span class="token double-colon punctuation">::</span>pair <span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">&gt;</span> val_type<span class="token punctuation">;</span>
	<span class="token function">RBTreeNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token operator">:</span> <span class="token function">_parent</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
		<span class="token punctuation">,</span> <span class="token function">_left</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
		<span class="token punctuation">,</span> <span class="token function">_right</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
		<span class="token punctuation">,</span> <span class="token function">_col</span><span class="token punctuation">(</span>RED<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>

	<span class="token function">RBTreeNode</span><span class="token punctuation">(</span><span class="token keyword">const</span> val_type<span class="token operator">&amp;</span> data<span class="token punctuation">)</span>
		<span class="token operator">:</span> <span class="token function">_parent</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
		<span class="token punctuation">,</span> <span class="token function">_left</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
		<span class="token punctuation">,</span> <span class="token function">_right</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
		<span class="token punctuation">,</span> <span class="token function">_data</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
		<span class="token punctuation">,</span> <span class="token function">_col</span><span class="token punctuation">(</span>RED<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>

	RBTreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">&gt;</span><span class="token operator">*</span> _parent<span class="token punctuation">;</span>
	RBTreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">&gt;</span><span class="token operator">*</span> _left<span class="token punctuation">;</span>
	RBTreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">&gt;</span><span class="token operator">*</span> _right<span class="token punctuation">;</span>
	val_type          _data<span class="token punctuation">;</span>
	Color			  _col<span class="token punctuation">;</span> <span class="token comment">//bool类型 true=red false=black</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
 <blockquote> 
  <p><strong>关于节点的默认颜色：</strong><br> 新节点的插入，有可能会违反规则，分为下面两种情况：</p> 
  <ul><li>如果是插入黑节点，那么所有路径的黑色节点不相等，此时需要花费大量时间对黑色节点进行调整！</li><li>如果是插入红色节点，则会造成连续红色节点的的出现，需要变色和旋转。</li></ul> 
 </blockquote> 
 <p>对于上面的情况，我们必须选择违背其中一个，然后想办法恢复，怎么选择取决于那个的恢复成本比较小。<br> 如果是选择插入黑节点，那么一个节点的插入可能会影响所有路径的黑色节点（全局影响），如果是插入红色节点，最坏的情况仅需要旋转到根即可（局部影响），<code>显而易见，插入红节点的恢复成本更小</code>，如果需要调整所有路径的黑色节点，是非常复杂的！<br> <br> 控制红色节点是必然，如果出现连续的红色节点，那么就不能保证红黑相间，最长路径必然大于最短路径的两倍，而每条路径上黑色节点数量相同，即使是出现连续的黑色节点，在同一层都是连续的，那么每条路径的黑色节点也相同，性质可以得以维持！</p> 
 <br> 
 <p>所以我们默认插入红色节点，然后对其进行局部调整！</p> 
</blockquote> 
<hr> 
<blockquote> 
 <h3><a id="_150"></a>红黑树主体类设计</h3> 
 <hr> 
 <p>红黑树类主体对pair&lt;K,V&gt;对象重定义为val_type，对RBTreeNode&lt;K, V&gt;重定义为Node，方便使用。<br> 其成员变量只需要一个根节点指针_root，一个_size记录节点数量，一个_com比较函数即可。<br> 为了防止内存泄漏，我们事先实现了节点释放函数，使用 <strong>后序遍历+递归</strong> 逐一删除节点。</p> 
 <pre><code class="prism language-cpp"><span class="token comment">//红黑树类主体设计</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">V</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">Compare</span> <span class="token operator">=</span> less<span class="token operator">&lt;</span>K<span class="token operator">&gt;&gt;</span>
<span class="token keyword">class</span> <span class="token class-name">RBTree</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">typedef</span> std<span class="token double-colon punctuation">::</span>pair <span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">&gt;</span> val_type<span class="token punctuation">;</span>
	<span class="token keyword">typedef</span> RBTreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">&gt;</span> Node<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">RBTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token operator">:</span><span class="token function">_root</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
		<span class="token punctuation">,</span> <span class="token function">_size</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>

	<span class="token operator">~</span><span class="token function">RBTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">DelTree</span><span class="token punctuation">(</span>_root<span class="token punctuation">)</span><span class="token punctuation">;</span>
		_root <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token comment">//删除树</span>
	<span class="token keyword">void</span> <span class="token function">DelTree</span><span class="token punctuation">(</span>Node<span class="token operator">*</span> root<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token function">DelTree</span><span class="token punctuation">(</span>root<span class="token operator">-&gt;</span>_left<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">DelTree</span><span class="token punctuation">(</span>root<span class="token operator">-&gt;</span>_right<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">delete</span> root<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
	Node<span class="token operator">*</span> _root<span class="token punctuation">;</span>  <span class="token comment">//根节点</span>
	size_t _size<span class="token punctuation">;</span> <span class="token comment">//节点数量</span>
	Compare _com<span class="token punctuation">;</span>  <span class="token comment">//比较函数</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
 <p>我们自己实现的红黑树，与STL库中的有一定区别，我们主要介绍插入思想，插入思想上与库中基本相似，但是在结构设计上有一定区别，这里要提一下的是，STL中的红黑树有一个<strong>头节点</strong>，其左子树指针指向树中的最小值节点（最左节点），右子树指针指向最大值节点（最右节点），这样好处在于，设计迭代器时，遍历不需要找最左和最右节点，以及对遍历到结尾的条件判断要简单一点，<strong>但是我们这里主要介绍红黑树的插入原理，所以使用简单的结构就行</strong>。<br> <img src="https://images2.imgbox.com/32/c0/QpW2lVHy_o.png" alt=""><br> <strong>当然，我们本节介绍的并非上图的红黑树，而是不带header的！</strong></p> 
</blockquote> 
<hr> 
<blockquote> 
 <h3><a id="_196"></a>红黑树的插入函数</h3> 
 <hr> 
 <p>红黑树的插入流程与二叉搜索树相似，只不过多了调整环节。</p> 
 <br> 
 <blockquote> 
  <p><strong>插入流程：</strong></p> 
  <ul><li>判断根节点是否为空，如果为空则直接插入根节点</li><li>找最合适的插入位置（插入到哪个父节点下），与每个节点相比较，通过比较函数决定向左子树走还是向右子树走</li><li>找到合适的父节点后，通过比较函数选择插入到父节点的左边还是右边</li><li>判断父节点颜色，决定是否需要染色或调整</li></ul> 
 </blockquote> 
 <br> 
 <p>为了方便理解，我们先介绍一下节点关系，一张图说明：<br> <img src="https://images2.imgbox.com/5e/74/IFDniUlp_o.png" alt="节点关系"></p> 
 <br> 
 <p><strong>代码：</strong></p> 
 <pre><code class="prism language-cpp">pair<span class="token operator">&lt;</span>val_type<span class="token punctuation">,</span> <span class="token keyword">bool</span><span class="token operator">&gt;</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">const</span> val_type<span class="token operator">&amp;</span> data<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//为空插入根节点</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">nullptr</span> <span class="token operator">==</span> _root<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		Node<span class="token operator">*</span> newnode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Node</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
		_root <span class="token operator">=</span> newnode<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token comment">//否则开始找插入位置</span>
	<span class="token punctuation">{<!-- --></span>
		Node<span class="token operator">*</span> newnode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Node</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
		Node<span class="token operator">*</span> parent <span class="token operator">=</span> _root<span class="token punctuation">;</span>
		Node<span class="token operator">*</span> cur <span class="token operator">=</span> _root<span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">_com</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>first<span class="token punctuation">,</span> cur<span class="token operator">-&gt;</span>_data<span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">)</span>      <span class="token comment">// &lt;</span>
			<span class="token punctuation">{<!-- --></span>
				parent <span class="token operator">=</span> cur<span class="token punctuation">;</span>
				cur <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>_left<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">_com</span><span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>_data<span class="token punctuation">.</span>first<span class="token punctuation">,</span> data<span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// &gt;</span>
			<span class="token punctuation">{<!-- --></span>
				parent <span class="token operator">=</span> cur<span class="token punctuation">;</span>
				cur <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>_right<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> data<span class="token punctuation">,</span><span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>      <span class="token comment">// ==</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//新节点插入合适的父节点下</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">_com</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>first<span class="token punctuation">,</span> parent<span class="token operator">-&gt;</span>_data<span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">)</span> parent<span class="token operator">-&gt;</span>_left <span class="token operator">=</span> newnode<span class="token punctuation">;</span>
		<span class="token keyword">else</span> parent<span class="token operator">-&gt;</span>_right <span class="token operator">=</span> newnode<span class="token punctuation">;</span>
		newnode<span class="token operator">-&gt;</span>_parent <span class="token operator">=</span> parent<span class="token punctuation">;</span>
		cur <span class="token operator">=</span> newnode<span class="token punctuation">;</span>

		<span class="token comment">//开始调整</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>parent <span class="token operator">&amp;&amp;</span> parent<span class="token operator">-&gt;</span>_col <span class="token operator">==</span> RED<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">//祖父节点</span>
			Node<span class="token operator">*</span> grandfather <span class="token operator">=</span> parent<span class="token operator">-&gt;</span>_parent<span class="token punctuation">;</span>
			<span class="token comment">//叔叔节点</span>
			Node<span class="token operator">*</span> uncle <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
			<span class="token comment">//调整 ... </span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token operator">++</span>_size<span class="token punctuation">;</span>
	_root<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> BLACK<span class="token punctuation">;</span> <span class="token comment">//无论怎么调整 根节点总是黑色</span>
	<span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> data<span class="token punctuation">,</span><span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
 <blockquote> 
  <p>说明：</p> 
  <ul><li>插入函数的返回值为pair对象key-value类型，表示数据data是否插入成功，插入成功时second为true，失败则为false。</li><li>每次成功插入节点时，都将_size+1，用作计数（如果设计返回节点数量的接口，该变量可以大大优化效率，否则需要对整棵树进行遍历）。</li><li>每次插入成功返回前都将根节点_root的颜色置为BLACK，以确保根节点一直为黑（染色调整可能会修改根节点颜色）。</li></ul> 
 </blockquote> 
 <br> 
 <blockquote> 
  <p><strong>关于调整：</strong><br> <mark>调整的关键是看 父节点 和 叔叔节点 ！</mark></p> 
  <ul><li>如果父节点为黑节点，则直接插入，不需要进行任何调整</li><li>如果父节点为红色，则需要去看叔叔节点，如果叔叔节点也为红色，则<strong>直接变色然后继续向上调整</strong>即可</li><li>如果父节点为红色，叔叔节点为黑色或不存在，则需要进行 <strong><a href="https://blog.csdn.net/m0_73446322/article/details/136662144?spm=1001.2014.3001.5502#AVL_118">旋转</a>+变色</strong> 调整。</li></ul> 
 </blockquote> 
 <p>因为左区间和右区间的判断条件对称，所以我们左右一起介绍。<br> <br> <mark>下面介绍时因为祖父单词过长，简写为gf！</mark></p> 
 <hr> 
 <h4><a id="_289"></a>情况一：变色</h4> 
 <p><strong><code>父节点和叔叔节点都为红色</code>此时需要变色</strong><br> 如果新节点插入后，父节点（parent）和叔叔节点（uncle）的颜色都为黑色，则可以将父节点和叔叔节点变为黑色，祖父节点（grandfather）变为红色来解决！<br> <br> 不过在变色后，如果祖父节点是其他树的子树，则需要继续向上调整，<strong>将祖父节点作为新插入节点继续检查</strong>，因为祖父节点变成红色后可能其曾祖父也是红色，此时还需要继续判断和调整，如果曾祖父是黑色或不存在，则停止调整即可！<br> <img src="https://images2.imgbox.com/13/aa/q3DBEI9h_o.png" alt="变色"><br> <strong>代码：</strong></p> 
 <pre><code class="prism language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span>grandfather<span class="token operator">-&gt;</span>_left <span class="token operator">==</span> parent<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//父节点是祖父的左 叔叔就是祖父的右</span>
	uncle <span class="token operator">=</span> grandfather<span class="token operator">-&gt;</span>_right<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">&amp;&amp;</span> uncle<span class="token operator">-&gt;</span>_col <span class="token operator">==</span> RED<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		grandfather<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> RED<span class="token punctuation">;</span>
		parent<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> uncle<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
		uncle<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
		<span class="token comment">//继续检查和调整</span>
		cur <span class="token operator">=</span> grandfather<span class="token punctuation">;</span>
		parent <span class="token operator">=</span> grandfather<span class="token operator">-&gt;</span>_parent<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">==</span> <span class="token keyword">nullptr</span> <span class="token operator">||</span> uncle<span class="token operator">-&gt;</span>_col <span class="token operator">==</span> BLACK<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//旋转+染色</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>grandfather<span class="token operator">-&gt;</span>_right <span class="token operator">==</span> parent<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//父节点是祖父的右 叔叔就是祖父的左</span>
	uncle <span class="token operator">=</span> grandfather<span class="token operator">-&gt;</span>_left<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">&amp;&amp;</span> uncle<span class="token operator">-&gt;</span>_col <span class="token operator">==</span> RED<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		grandfather<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> RED<span class="token punctuation">;</span>
		parent<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
		uncle<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
		<span class="token comment">//继续检查和调整</span>
		cur <span class="token operator">=</span> grandfather<span class="token punctuation">;</span>
		parent <span class="token operator">=</span> grandfather<span class="token operator">-&gt;</span>_parent<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">==</span> <span class="token keyword">nullptr</span> <span class="token operator">||</span> uncle<span class="token operator">-&gt;</span>_col <span class="token operator">==</span> BLACK<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//旋转+染色</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
 <p>这里主要是通过祖父指针分辨父节点和叔叔节点的位置，以做不同操作！</p> 
 <hr> 
 <h4><a id="_338"></a>情况二：变色+旋转</h4> 
 <p><strong><code>叔叔不存在或叔叔为黑色</code>此时需要旋转和变色</strong><br> 有些情况下染色并不能保持性质，此时需要旋转降低高度！<br> 情况二可以由情况一产生，变色后祖父和曾祖父为连续的红色节点！</p> 
 <br> 
 <p>在AVL树中，旋转分为单旋和双旋，如果插入在左子树的左和右子树的右，不平衡的情况直接分别进行右单旋和左单旋即可；如果插入在左子树的右和右子树的左，不平衡的情况直接分别进行左右双旋和右左双旋即可！</p> 
 <p><img src="https://images2.imgbox.com/3d/44/reAZKzmz_o.png" alt=""></p> 
 <p>涉及旋转都需要注意新增节点的插入位置，才能进行对应的旋转！</p> 
 <br> 
 <p>旋转后就需要调整节点的颜色，以符合红黑树的性质！<br> <strong>当旋转和染色结束后，直接跳出调整即可，不需要继续向上检测！</strong></p> 
 <h5><a id="_356"></a>单旋情况</h5> 
 <p>如果插入位置在<strong>左子树的左和右子树的右</strong>且<strong>叔叔节点不存在或存在且为黑节点</strong>，此时需要进行单旋和变色调整！</p> 
 <br> 
 <p><strong>图示：</strong></p> 
 <center>
   左单旋+染色 
 </center> 
 <p><img src="https://images2.imgbox.com/91/16/HhBefa5a_o.png" alt="左单旋+染色"></p> 
</blockquote> 
<blockquote> 
 <br> 
 <center>
   右单旋+染色 
 </center> 
 <p><img src="https://images2.imgbox.com/cd/55/MKVDOIFF_o.png" alt="右单旋+染色"></p> 
 <p><strong>代码：</strong></p> 
 <pre><code class="prism language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span>grandfather<span class="token operator">-&gt;</span>_left <span class="token operator">==</span> parent<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	uncle <span class="token operator">=</span> grandfather<span class="token operator">-&gt;</span>_right<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">&amp;&amp;</span> uncle<span class="token operator">-&gt;</span>_col <span class="token operator">==</span> RED<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//单纯染色</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">==</span> <span class="token keyword">nullptr</span> <span class="token operator">||</span> uncle<span class="token operator">-&gt;</span>_col <span class="token operator">==</span> BLACK<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token operator">-&gt;</span>_left <span class="token operator">==</span> cur<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">//右单旋</span>
			<span class="token function">RotateR</span><span class="token punctuation">(</span>grandfather<span class="token punctuation">)</span><span class="token punctuation">;</span>
			parent<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
			grandfather<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> RED<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token operator">-&gt;</span>_right <span class="token operator">==</span> cur<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">//左右双旋</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//旋转完后整树平衡 直接跳出</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>grandfather<span class="token operator">-&gt;</span>_right <span class="token operator">==</span> parent<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	uncle <span class="token operator">=</span> grandfather<span class="token operator">-&gt;</span>_left<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">&amp;&amp;</span> uncle<span class="token operator">-&gt;</span>_col <span class="token operator">==</span> RED<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//单纯染色</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">==</span> <span class="token keyword">nullptr</span> <span class="token operator">||</span> uncle<span class="token operator">-&gt;</span>_col <span class="token operator">==</span> BLACK<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token operator">-&gt;</span>_right <span class="token operator">==</span> cur<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">//左单旋</span>
			<span class="token function">RotateL</span><span class="token punctuation">(</span>grandfather<span class="token punctuation">)</span><span class="token punctuation">;</span>
			grandfather<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> RED<span class="token punctuation">;</span>
			parent<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token operator">-&gt;</span>_left <span class="token operator">==</span> cur<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">//右左双旋</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//旋转完成后整树趋于平衡</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
 <br> 
 <h5><a id="_429"></a>双旋情况</h5> 
 <p>如果插入位置在<strong>左子树的右和右子树的左</strong>且<strong>叔叔节点不存在或存在且为黑节点</strong>，此时需要进行双旋和变色调整！</p> 
 <br> 
 <p><strong>图示：</strong></p> 
 <center>
   右左双旋+变色 
 </center> 
 <p><img src="https://images2.imgbox.com/bf/91/ywicqpAe_o.png" alt="右左双旋+变色"></p> 
 <br> 
 <center>
   右左双旋+变色 
 </center> 
 <p><img src="https://images2.imgbox.com/fe/b8/WwCJTuMc_o.png" alt="右左双旋+变色"></p> 
 <br> 
 <p><strong>代码：</strong></p> 
 <pre><code class="prism language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span>grandfather<span class="token operator">-&gt;</span>_left <span class="token operator">==</span> parent<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	uncle <span class="token operator">=</span> grandfather<span class="token operator">-&gt;</span>_right<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">&amp;&amp;</span> uncle<span class="token operator">-&gt;</span>_col <span class="token operator">==</span> RED<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//染色+调整</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">==</span> <span class="token keyword">nullptr</span> <span class="token operator">||</span> uncle<span class="token operator">-&gt;</span>_col <span class="token operator">==</span> BLACK<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token operator">-&gt;</span>_left <span class="token operator">==</span> cur<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">//右单旋+染色</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token operator">-&gt;</span>_right <span class="token operator">==</span> cur<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">//左右双旋+染色</span>
			<span class="token function">RotateL</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">RotateR</span><span class="token punctuation">(</span>grandfather<span class="token punctuation">)</span><span class="token punctuation">;</span>
			cur<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
			grandfather<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> RED<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//旋转完后整树平衡 直接跳出</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>grandfather<span class="token operator">-&gt;</span>_right <span class="token operator">==</span> parent<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	uncle <span class="token operator">=</span> grandfather<span class="token operator">-&gt;</span>_left<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">&amp;&amp;</span> uncle<span class="token operator">-&gt;</span>_col <span class="token operator">==</span> RED<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//染色+调整</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">==</span> <span class="token keyword">nullptr</span> <span class="token operator">||</span> uncle<span class="token operator">-&gt;</span>_col <span class="token operator">==</span> BLACK<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token operator">-&gt;</span>_right <span class="token operator">==</span> cur<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">//左单旋+变色</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token operator">-&gt;</span>_left <span class="token operator">==</span> cur<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">//右左双旋+染色</span>
			<span class="token function">RotateR</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">RotateL</span><span class="token punctuation">(</span>grandfather<span class="token punctuation">)</span><span class="token punctuation">;</span>
			grandfather<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> RED<span class="token punctuation">;</span>
			cur<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//旋转完成后整树趋于平衡</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
 <hr> 
 <h4><a id="_507"></a>完整插入代码</h4> 
 <pre><code class="prism language-cpp">pair<span class="token operator">&lt;</span>val_type<span class="token punctuation">,</span> <span class="token keyword">bool</span><span class="token operator">&gt;</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">const</span> val_type<span class="token operator">&amp;</span> data<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">nullptr</span> <span class="token operator">==</span> _root<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		Node<span class="token operator">*</span> newnode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Node</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
		_root <span class="token operator">=</span> newnode<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{<!-- --></span>
		Node<span class="token operator">*</span> newnode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Node</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
		Node<span class="token operator">*</span> parent <span class="token operator">=</span> _root<span class="token punctuation">;</span>
		Node<span class="token operator">*</span> cur <span class="token operator">=</span> _root<span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">_com</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>first<span class="token punctuation">,</span> cur<span class="token operator">-&gt;</span>_data<span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">)</span>      <span class="token comment">// &lt;</span>
			<span class="token punctuation">{<!-- --></span>
				parent <span class="token operator">=</span> cur<span class="token punctuation">;</span>
				cur <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>_left<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">_com</span><span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>_data<span class="token punctuation">.</span>first<span class="token punctuation">,</span> data<span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// &gt;</span>
			<span class="token punctuation">{<!-- --></span>
				parent <span class="token operator">=</span> cur<span class="token punctuation">;</span>
				cur <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>_right<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> data<span class="token punctuation">,</span><span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>      <span class="token comment">// ==</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">_com</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>first<span class="token punctuation">,</span> parent<span class="token operator">-&gt;</span>_data<span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">)</span> parent<span class="token operator">-&gt;</span>_left <span class="token operator">=</span> newnode<span class="token punctuation">;</span>
		<span class="token keyword">else</span> parent<span class="token operator">-&gt;</span>_right <span class="token operator">=</span> newnode<span class="token punctuation">;</span>
		newnode<span class="token operator">-&gt;</span>_parent <span class="token operator">=</span> parent<span class="token punctuation">;</span>
		cur <span class="token operator">=</span> newnode<span class="token punctuation">;</span>

		<span class="token keyword">while</span> <span class="token punctuation">(</span>parent <span class="token operator">&amp;&amp;</span> parent<span class="token operator">-&gt;</span>_col <span class="token operator">==</span> RED<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">//祖父节点</span>
			Node<span class="token operator">*</span> grandfather <span class="token operator">=</span> parent<span class="token operator">-&gt;</span>_parent<span class="token punctuation">;</span>
			<span class="token comment">//叔叔节点</span>
			Node<span class="token operator">*</span> uncle <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
			<span class="token comment">//调整</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>grandfather<span class="token operator">-&gt;</span>_left <span class="token operator">==</span> parent<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				uncle <span class="token operator">=</span> grandfather<span class="token operator">-&gt;</span>_right<span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">&amp;&amp;</span> uncle<span class="token operator">-&gt;</span>_col <span class="token operator">==</span> RED<span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					grandfather<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> RED<span class="token punctuation">;</span>
					parent<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> uncle<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
					uncle<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
					<span class="token comment">//继续染色</span>
					cur <span class="token operator">=</span> grandfather<span class="token punctuation">;</span>
					parent <span class="token operator">=</span> grandfather<span class="token operator">-&gt;</span>_parent<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">==</span> <span class="token keyword">nullptr</span> <span class="token operator">||</span> uncle<span class="token operator">-&gt;</span>_col <span class="token operator">==</span> BLACK<span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token operator">-&gt;</span>_left <span class="token operator">==</span> cur<span class="token punctuation">)</span>
					<span class="token punctuation">{<!-- --></span>
						<span class="token comment">//右单旋</span>
						<span class="token function">RotateR</span><span class="token punctuation">(</span>grandfather<span class="token punctuation">)</span><span class="token punctuation">;</span>
						parent<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
						grandfather<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> RED<span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token operator">-&gt;</span>_right <span class="token operator">==</span> cur<span class="token punctuation">)</span>
					<span class="token punctuation">{<!-- --></span>
						<span class="token comment">//左右双旋</span>
						<span class="token function">RotateL</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token function">RotateR</span><span class="token punctuation">(</span>grandfather<span class="token punctuation">)</span><span class="token punctuation">;</span>
						cur<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
						grandfather<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> RED<span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token comment">//旋转完后整树平衡 直接跳出</span>
					<span class="token keyword">break</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>grandfather<span class="token operator">-&gt;</span>_right <span class="token operator">==</span> parent<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				uncle <span class="token operator">=</span> grandfather<span class="token operator">-&gt;</span>_left<span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">&amp;&amp;</span> uncle<span class="token operator">-&gt;</span>_col <span class="token operator">==</span> RED<span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					grandfather<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> RED<span class="token punctuation">;</span>
					parent<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
					uncle<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
					<span class="token comment">//继续染色</span>
					cur <span class="token operator">=</span> grandfather<span class="token punctuation">;</span>
					parent <span class="token operator">=</span> grandfather<span class="token operator">-&gt;</span>_parent<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">==</span> <span class="token keyword">nullptr</span> <span class="token operator">||</span> uncle<span class="token operator">-&gt;</span>_col <span class="token operator">==</span> BLACK<span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token operator">-&gt;</span>_right <span class="token operator">==</span> cur<span class="token punctuation">)</span>
					<span class="token punctuation">{<!-- --></span>
						<span class="token comment">//左单旋</span>
						<span class="token function">RotateL</span><span class="token punctuation">(</span>grandfather<span class="token punctuation">)</span><span class="token punctuation">;</span>
						grandfather<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> RED<span class="token punctuation">;</span>
						parent<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token operator">-&gt;</span>_left <span class="token operator">==</span> cur<span class="token punctuation">)</span>
					<span class="token punctuation">{<!-- --></span>
						<span class="token comment">//右左双旋</span>
						<span class="token function">RotateR</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token function">RotateL</span><span class="token punctuation">(</span>grandfather<span class="token punctuation">)</span><span class="token punctuation">;</span>
						grandfather<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> RED<span class="token punctuation">;</span>
						cur<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token comment">//旋转完成后整树趋于平衡</span>
					<span class="token keyword">break</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>

		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token operator">++</span>_size<span class="token punctuation">;</span>
	_root<span class="token operator">-&gt;</span>_col <span class="token operator">=</span> BLACK<span class="token punctuation">;</span> <span class="token comment">//无论怎么调整 根节点总是黑色</span>
	<span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> data<span class="token punctuation">,</span><span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
</blockquote> 
<hr> 
<blockquote> 
 <h3><a id="_627"></a>关于红黑树</h3> 
 <hr> 
 <h4><a id="_629"></a>红黑树检验</h4> 
 <p>我们实现红黑树后，还需要对其规则进行检验，防止bug导致红黑树结构异常！</p> 
 <br> 
 <blockquote> 
  <p>检验规则：</p> 
  <ul><li><strong>根节点是否为黑色姐</strong></li><li><strong>是否出现连续的红色节点</strong><br> – 说明：如果我们先判断当前节点再判断子节点，就需要对子节点进行分类判断，很麻烦。此时我们需要转换思想，<code>先判断子树是否为红再判断父节点</code>，因为根节点为黑所以不会访问根节点的父级指针，也就是不会访问空指针，而后的子树必有父节点，所以我们只需要判断当前节点是否为红，如果为红再去判断父节点，红节点一定有父节点。</li><li><strong>每条路径的黑色节点数量是否相等</strong><br> –说明：既然是每条路径都相等，我们随意找一条路径取基准值（例如取最左路径或最右路径的黑节点数量），然后去与每条路径进行对比，全相等就符合要求。</li></ul> 
 </blockquote> 
 <br> 
 <pre><code class="prism language-cpp"><span class="token comment">//检验函数 调用接口</span>
<span class="token keyword">bool</span> <span class="token function">isRBTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//三个条件</span>
	<span class="token comment">//没有连续红色节点</span>
	<span class="token comment">//每条路上的黑色节点数相等</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>_root <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>_root <span class="token operator">&amp;&amp;</span> _root<span class="token operator">-&gt;</span>_col <span class="token operator">==</span> RED<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> blackmark <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	Node<span class="token operator">*</span> cur <span class="token operator">=</span> _root<span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>_col <span class="token operator">==</span> BLACK<span class="token punctuation">)</span> <span class="token operator">++</span>blackmark<span class="token punctuation">;</span>
		cur <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>_right<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> <span class="token function">_isRBTree</span><span class="token punctuation">(</span>_root<span class="token punctuation">,</span> blackmark<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//检验函数 执行接口</span>
<span class="token keyword">bool</span> <span class="token function">_isRBTree</span><span class="token punctuation">(</span>Node<span class="token operator">*</span> root<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> blackmark<span class="token punctuation">,</span> <span class="token keyword">int</span> blacknum<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>blackmark <span class="token operator">!=</span> blacknum<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			cout <span class="token operator">&lt;&lt;</span> <span class="token string">"黑节点数不相等！"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token operator">-&gt;</span>_col <span class="token operator">==</span> BLACK<span class="token punctuation">)</span> <span class="token operator">++</span>blacknum<span class="token punctuation">;</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token operator">-&gt;</span>_parent <span class="token operator">&amp;&amp;</span> root<span class="token operator">-&gt;</span>_parent<span class="token operator">-&gt;</span>_col <span class="token operator">==</span> RED<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"出现连续的红色节点！"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> <span class="token function">_isRBTree</span><span class="token punctuation">(</span>root<span class="token operator">-&gt;</span>_left<span class="token punctuation">,</span> blackmark<span class="token punctuation">,</span> blacknum<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">_isRBTree</span><span class="token punctuation">(</span>root<span class="token operator">-&gt;</span>_right<span class="token punctuation">,</span> blackmark<span class="token punctuation">,</span> blacknum<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
 <br> 
 <p>有序插入1-10000的数，查看情况：<br> <img src="https://images2.imgbox.com/68/95/12Q59dZ2_o.png" alt=""><br> 可以发现，插入有序序列下，最大和最小层数正好相差二倍，但是仍然合格！</p> 
 <hr> 
 <h4><a id="_vs_AVL_695"></a>红黑树 vs AVL树</h4> 
 <p>我们将两棵树进行性能对比，插入1-100w节点，查看耗时！<br> <strong>检查代码：</strong></p> 
 <pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">randominsert</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">srand</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"随机数据插入！"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	RB_Tree<span class="token double-colon punctuation">::</span>RBTree<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&gt;</span> rbt<span class="token punctuation">;</span>
	AVLTree<span class="token double-colon punctuation">::</span>AVLTree<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&gt;</span> avl<span class="token punctuation">;</span>
	clock_t start <span class="token operator">=</span> <span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> avl<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> i <span class="token operator">+</span> i<span class="token punctuation">,</span>i <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	clock_t end <span class="token operator">=</span> <span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"AVLTree："</span> <span class="token operator">&lt;&lt;</span> end <span class="token operator">-</span> start <span class="token operator">&lt;&lt;</span> <span class="token string">"ms"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	avl<span class="token punctuation">.</span><span class="token operator">~</span><span class="token function">AVLTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	start <span class="token operator">=</span> <span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> rbt<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> i <span class="token operator">+</span> i<span class="token punctuation">,</span>i <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	end <span class="token operator">=</span> <span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"RBTree："</span> <span class="token operator">&lt;&lt;</span> end <span class="token operator">-</span> start <span class="token operator">&lt;&lt;</span> <span class="token string">"ms"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">orderlyinsert</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"有序数据插入！"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	RB_Tree<span class="token double-colon punctuation">::</span>RBTree<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&gt;</span> rbt<span class="token punctuation">;</span>
	AVLTree<span class="token double-colon punctuation">::</span>AVLTree<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&gt;</span> avl<span class="token punctuation">;</span>

	clock_t start <span class="token operator">=</span> <span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> avl<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> i<span class="token punctuation">,</span>i <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	clock_t end <span class="token operator">=</span> <span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"AVLTree："</span> <span class="token operator">&lt;&lt;</span> end <span class="token operator">-</span> start <span class="token operator">&lt;&lt;</span> <span class="token string">"ms"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	avl<span class="token punctuation">.</span><span class="token operator">~</span><span class="token function">AVLTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	start <span class="token operator">=</span> <span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> rbt<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> i<span class="token punctuation">,</span>i <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	end <span class="token operator">=</span> <span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"RBTree："</span> <span class="token operator">&lt;&lt;</span> end <span class="token operator">-</span> start <span class="token operator">&lt;&lt;</span> <span class="token string">"ms"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>


<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">const</span> <span class="token keyword">int</span> N <span class="token operator">=</span> <span class="token number">1000000</span><span class="token punctuation">;</span>
	<span class="token function">randominsert</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">orderlyinsert</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
 <p><img src="https://images2.imgbox.com/ff/93/NWjsuG0b_o.png" alt=""><br> 在测试中，我们插入随机节点，发现红黑树与AVL相差不大，而插入有序节点，AVL树反而比红黑树性能要好，所以不同情况两树性能有区别。<br> 这里我们只实现了插入，还有增删改查等一系列的操作，都进行的话，红黑树平均性能会超过AVL树！<br> <br><br> <strong>注意：实际对比下，因为数据量问题可能出现AVL树性能比红黑树好的情况，这种属于正常现象，单比插入不能真实体现全部性能！</strong></p> 
</blockquote> 
<hr> 
<h2><a id="_754"></a>最后</h2> 
<p><strong>本节红黑树的介绍到这里就告一段落了，当我们完全了解红黑树后，发现其实红黑树比较抽象，但是比AVL树好控制，而我们的STL容器中map和set使用的底层数据结构就是红黑树，后面我们将为大家介绍库中红黑树的使用以及map和set的基本封装！</strong></p> 
<p><strong>本次 &lt;红黑树&gt; 就先介绍到这里啦，希望能够尽可能帮助到大家。</strong></p> 
<p><strong>如果文章中有瑕疵，还请各位大佬细心点评和留言，我将立即修补错误，谢谢！</strong></p> 
<p><strong>本节涉及代码：<a href="https://gitee.com/armcskgt/c-and---c-code-warehouse/tree/master/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AD%A6%E4%B9%A0%E5%92%8C%E5%AE%9E%E7%8E%B0/C++%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84STL/BinarySearchTree%E5%8F%8AAVL%E5%8F%8ARB/%E9%AB%98%E9%98%B6%E6%A0%91%E5%8D%9A%E5%AE%A2/RB_Tree" rel="nofollow">红黑树博客代码</a></strong></p> 
<p><img src="https://images2.imgbox.com/dc/20/z4d9hCIl_o.png" alt="红黑树封底"></p> 
<blockquote> 
 <p><em></em></p> 
 <center> 
  <strong>🌟其他文章阅读推荐🌟<br> <a href="https://blog.csdn.net/m0_73446322/article/details/136662144">高级数据结构＜AVL树＞</a><br> <a href="https://blog.csdn.net/m0_73446322/article/details/134784892">高级数据结构＜二叉搜索树＞</a><br> <a href="https://blog.csdn.net/m0_73446322/article/details/128394450">数据结构初级＜二叉树＞</a><br> <a href="https://blog.csdn.net/m0_73446322/article/details/131281127">C++ &lt;继承&gt;</a><br> <a href="https://blog.csdn.net/m0_73446322/article/details/131281150">C++ &lt;多态&gt;</a><br> 🌹欢迎读者多多浏览多多支持!🌹</strong> 
 </center> 
 <p></p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a38a6af81a98b2f60b34c6cd348ef8f0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">灵神笔记(1)----动态规划篇</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/483cd6984b6e9bfd7dfd5f59100843a6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【C&#43;&#43;初阶】第七站：string类的初识(万字详解、细节拉满)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>