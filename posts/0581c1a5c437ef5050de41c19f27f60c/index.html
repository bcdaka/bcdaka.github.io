<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>已有H5站点，如何用webview嵌入H5来快速制作微信小程序以及对微信小程序支付的修改 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/0581c1a5c437ef5050de41c19f27f60c/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="已有H5站点，如何用webview嵌入H5来快速制作微信小程序以及对微信小程序支付的修改">
  <meta property="og:description" content="前提条件：H5站点及微信支付正常(采用微信公众号支付)。
我是小程序小白，之前对小程序毫无概念，最近想把自己的H5站点发布成小程序，各种资料搜索，实践总结如下：
webview嵌入H5制作微信小程序 第一步：开通小程序公众平台账号，获得小程序appid 第二步：配置业务域名 在小程序公众平台中 开发 开发管理 开发设置中配置业务域名为H5站点域名
并且下载校验文件放到H5站点根目录。
第三步：下载安装HBuilderX和 微信开发者工具。 第四步：创建项目 使用HBuilder创建一个最简单的uniapp项目，vue版本，2，3都可以
第五步：写入webview及配置
写入启动页
启动页的webview地址，src则是注意事项中h5发布的域名以及他访问的入口文件位置
第六步：配置微信小程序appid 第七步：配置调试 在HBuilderX中 工具-&gt;设置-&gt;运行设置中配置 微信开发者工具 的安装地址。
微信开发者工具中 设置-&gt;安全设置 打开服务端口：
第八步：生成项目文件到微信开发者工具 打开微信开发者工具，并且在HBuilderX中 点击 运行-&gt;运行到小程序模拟器-&gt;微信开发者工具
然后在微信开发者工具下会生成项目对应的js文件并可以调试了，界面会在开发者工具中展示出来。
第九步：发布 微信开发者工具中调式没有问题，就可以发布版本到小程序公众平台了。
将原有H5中的微信支付，改造成小程序支付 Webview嵌入H5的小程序不支持原有H5的微信支付，需要改造，具体改造地方在：
第一：：在小程序公众平台中，开通微信支付功能，关联原有H5已有公众号支付，使用同一主体。 第二：在小程序公众平台中 开发 开发管理 开发设置中 设置 appSecret小程序秘钥，后面获取用户code的接口需要用到
配置服务器域名 为H5站点域名及相关域名解析地址 (正式发布后需要用到，开发与体验版调试时，因为不校验域名，不会有问题，不配置的话会在正式发布后唤起失败无反应)
第三：统一下单前需要获取微信用户的临时code，原有微信公众号获取code的接口需要改成使用微信小程序的接口。可参考微信接口说明。 https://api.weixin.qq.com/sns/jscode2session?appid=xxxxx&amp;secret=xxxxxx&amp;js_code=&#39;获得的用户code&#39;&amp;grant_type=authorization_code
这里需要小程序的appid和密钥。
这样做的目的，是不绑定微信用户登录，也可以支付。
第四：统一下单需要使用小程序的appid下单。 第五：原有签名需要改用小程序appid参数进行签名。 第六：在微信开发者工具中 新建支付跳转页面，比如pages/pay/pay 。 注意，不要在HBuilderX中新建再运行到微信开发者工具，不然会覆盖原有代码。
第七：小程序中pay.js的onload方法请求小程序支付 我这里是直接在pay.js中onload方法中先获取从H5页面跳转传过来的参数，再调用wx.login获取用户临时code，然后通过wx.request用该code调用H5统一下单接口以及签名等操作(原H5会有的)。成功后返回5个后续用到的相关参数值，然后调用wx.requestPayment去请求小程序支付。支付成功后，可以跳转到对应的H5页面（需要在小程序中定义对应的webview页面）
onLoad(options) {
console.log(options);
var params = JSON.parse(decodeURIComponent(options.param));
console.log(&#39;params:&#39;&#43;params);
var order_id = params.order_id;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-23T17:07:15+08:00">
    <meta property="article:modified_time" content="2024-05-23T17:07:15+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">已有H5站点，如何用webview嵌入H5来快速制作微信小程序以及对微信小程序支付的修改</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:0;text-align:justify;"><strong>前提条件：H5站点及微信支付正常(采用微信公众号支付)。</strong></p> 
<p style="margin-left:0;text-align:justify;">我是小程序小白，之前对小程序毫无概念，最近想把自己的H5站点发布成小程序，各种资料搜索，实践总结如下：</p> 
<h3 style="margin-left:0px;text-align:justify;">webview嵌入H5制作微信小程序</h3> 
<p style="margin-left:0;text-align:justify;"></p> 
<h5 style="margin-left:0px;text-align:justify;"><strong>第一步：开通小程序公众平台账号，获得小程序appid</strong></h5> 
<h5 style="margin-left:0px;text-align:justify;">第二步：配置业务域名</h5> 
<p style="margin-left:0;text-align:justify;">在小程序公众平台中 开发  开发管理  开发设置中配置业务域名为H5站点域名</p> 
<p style="margin-left:0;text-align:justify;">         <img alt="" height="574" src="https://images2.imgbox.com/fd/03/Hqq69pF1_o.png" width="1112"></p> 
<p style="margin-left:0;text-align:justify;">   并且下载校验文件放到H5站点根目录。</p> 
<h5 style="margin-left:0px;text-align:justify;">第三步：下载安装<a href="https://www.dcloud.io/hbuilderx.html" rel="nofollow" title="HBuilderX">HBuilderX</a>和 <a href="https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html" rel="nofollow" title="微信开发者工具">微信开发者工具</a>。</h5> 
<h5 style="margin-left:0px;text-align:justify;">第四步：创建项目</h5> 
<p style="margin-left:0;text-align:justify;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">使用HBuilder创建一个最简单的uniapp项目，vue版本，2，3都可以</span></span></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">第五步：写入</span></span></strong><strong><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">webview</span></span></strong><strong><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">及配置</span></span></strong></p> 
<p style="margin-left:0;text-align:justify;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">写入启动页</span></span></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="499" src="https://images2.imgbox.com/88/c7/vFOge9zJ_o.png" width="1200"></p> 
<p style="margin-left:0;text-align:justify;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">启动页的</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">webview</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">地址，</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">src</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">则是注意事项中</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">h5</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">发布的域名以及他访问的入口文件位置</span></span></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="595" src="https://images2.imgbox.com/a8/85/l0r5HGus_o.png" width="1165"></p> 
<h5 style="margin-left:0px;text-align:justify;">第六步：配置微信小程序appid</h5> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="730" src="https://images2.imgbox.com/9a/87/tfEUvJ4O_o.png" width="1200"></p> 
<h5 style="margin-left:0px;text-align:justify;">第七步：配置调试</h5> 
<p style="margin-left:0;text-align:justify;">在HBuilderX中 工具-&gt;设置-&gt;运行设置中配置 微信开发者工具 的安装地址。</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="476" src="https://images2.imgbox.com/de/6f/fZNEOK7S_o.png" width="1000"></p> 
<p style="margin-left:0;text-align:justify;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">微信开发者工具中</span></span>   <span style="background-color:#ffffff;"><span style="color:#4d4d4d;">设置</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">-&gt;</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">安全设置</span></span>  <span style="background-color:#ffffff;"><span style="color:#4d4d4d;">打开服务端口：</span></span></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="460" src="https://images2.imgbox.com/6d/cb/16AVEwfb_o.png" width="595"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<h5 style="margin-left:0px;text-align:justify;">第八步：生成项目文件到微信开发者工具</h5> 
<p style="margin-left:0;text-align:justify;">打开微信开发者工具，并且在HBuilderX中  点击  运行-&gt;运行到小程序模拟器-&gt;微信开发者工具</p> 
<p style="margin-left:0;text-align:justify;">然后在微信开发者工具下会生成项目对应的js文件并可以调试了，<span style="background-color:#ffffff;"><span style="color:#4d4d4d;">界面会在开发者工具中展示出来。</span></span></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<h5 style="margin-left:0px;text-align:justify;">第九步：发布</h5> 
<p style="margin-left:0;text-align:justify;">     微信开发者工具中调式没有问题，就可以发布版本到小程序公众平台了。</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<h3 style="margin-left:0px;text-align:justify;">将原有H5中的微信支付，改造成小程序支付</h3> 
<p style="margin-left:0;text-align:justify;">Webview嵌入H5的小程序不支持原有H5的微信支付，需要改造，具体改造地方在：</p> 
<h5 style="margin-left:0px;text-align:justify;">第一：：在小程序公众平台中，开通微信支付功能，关联原有H5已有公众号支付，使用同一主体。</h5> 
<h5 style="margin-left:0px;text-align:justify;">第二：在小程序公众平台中 开发  开发管理  开发设置中</h5> 
<p style="margin-left:0;text-align:justify;">       设置 appSecret小程序秘钥，后面获取用户code的接口需要用到</p> 
<p style="margin-left:0;text-align:justify;">       配置服务器域名 为H5站点域名及相关域名解析地址 (<span style="color:#ff0000;">正式发布后需要用到，开发与体验版调试时，因为不校验域名，不会有问题，不配置的话会在正式发布后唤起失败无反应</span>)</p> 
<h5 style="margin-left:0px;text-align:justify;">第三：统一下单前需要获取微信用户的<span style="color:#ff0000;">临时code</span>，原有微信公众号获取code的接口需要改成使用微信小程序的接口。可参考微信接口说明。</h5> 
<p style="margin-left:0;text-align:justify;"> <a href="https://api.weixin.qq.com/sns/jscode2session?appid=xxxxx&amp;secret=xxxxxx&amp;js_code='%20rel=" title="https://api.weixin.qq.com/sns/jscode2session?appid=xxxxx&amp;secret=xxxxxx&amp;js_code='获得的用户code'&amp;grant_type=authorization_code">https://api.weixin.qq.com/sns/jscode2session?appid=xxxxx&amp;secret=xxxxxx&amp;js_code='获得的用户code'&amp;grant_type=authorization_code</a></p> 
<p style="margin-left:0;text-align:justify;">这里需要小程序的appid和密钥。</p> 
<p style="margin-left:0;text-align:justify;">这样做的目的，是不绑定微信用户登录，也可以支付。</p> 
<h5 style="margin-left:0px;text-align:justify;">第四：统一下单需要使用小程序的appid下单。</h5> 
<h5 style="margin-left:0px;text-align:justify;">第五：原有签名需要改用小程序appid参数进行签名。</h5> 
<h5 style="margin-left:0px;text-align:justify;">第六：在微信开发者工具中 新建支付跳转页面，比如pages/pay/pay 。</h5> 
<p style="margin-left:0;text-align:justify;">      注意，<span style="color:#ff0000;">不要</span>在HBuilderX中新建再运行到微信开发者工具，不然会覆盖原有代码。</p> 
<h5 style="margin-left:0px;text-align:justify;">第七：小程序中pay.js的onload方法请求小程序支付</h5> 
<p style="margin-left:0px;text-align:justify;">我这里是直接在pay.js中onload方法中先获取从H5页面跳转传过来的参数，再调用wx.login获取用户临时code，然后通过wx.request用该code调用H5统一下单接口以及签名等操作(原H5会有的)。成功后返回5个后续用到的相关参数值，然后调用wx.requestPayment去请求小程序支付。支付成功后，可以跳转到对应的H5页面（需要在小程序中定义对应的webview页面）</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;"><span style="color:#ffa54f;">onLoad</span><span style="color:#89ddff;">(</span>options<span style="color:#89ddff;">)</span> <span style="color:#89ddff;">{<!-- --></span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">    <span style="color:#c0c0c0;">console</span><span style="color:#89ddff;">.</span><span style="color:#ffa54f;">log</span>(<span style="color:#c0c0c0;">options</span>)<span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">    <span style="color:#f7e45a;">var</span> <span style="color:#c0c0c0;">params</span> <span style="color:#f7e45a;">=</span> JSON<span style="color:#89ddff;">.</span><span style="color:#ffa54f;">parse</span>(<span style="color:#ffa54f;">decodeURIComponent</span>(<span style="color:#c0c0c0;">options</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">param</span>))<span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">    <span style="color:#c0c0c0;">console</span><span style="color:#89ddff;">.</span><span style="color:#ffa54f;">log</span>(<span style="color:#89ddff;">'</span>params:<span style="color:#89ddff;">'</span><span style="color:#f7e45a;">+</span><span style="color:#c0c0c0;">params</span>)<span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">    <span style="color:#f7e45a;">var</span> <span style="color:#c0c0c0;">order_id</span> <span style="color:#f7e45a;">=</span> <span style="color:#c0c0c0;">params</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">order_id</span><span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">    <span style="color:#f7e45a;">var</span> <span style="color:#c0c0c0;">payment_id</span> <span style="color:#f7e45a;">=</span> <span style="color:#c0c0c0;">params</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">payment_id</span><span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">    <span style="color:#f7e45a;">var</span> <span style="color:#c0c0c0;">device</span> <span style="color:#f7e45a;">=</span> <span style="color:#c0c0c0;">params</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">device</span><span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">    <span style="color:#f7e45a;">var</span> <span style="color:#c0c0c0;">utoken</span> <span style="color:#f7e45a;">=</span> <span style="color:#c0c0c0;">params</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">token</span><span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">    <span style="color:#f7e45a;">var</span> <span style="color:#c0c0c0;">bustype</span> <span style="color:#f7e45a;">=</span> <span style="color:#c0c0c0;">params</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">bus_type</span><span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">    <span style="color:#f7e45a;">var</span> <span style="color:#c0c0c0;">apiurl</span> <span style="color:#f7e45a;">=</span> <span style="color:#89ddff;">'</span>https://www.xxxx.com/api/pay/<span style="color:#89ddff;">'</span><span style="color:#f7e45a;">+</span><span style="color:#c0c0c0;">bustype</span><span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">    <span style="color:#c0c0c0;">console</span><span style="color:#89ddff;">.</span><span style="color:#ffa54f;">log</span>(<span style="color:#89ddff;">'</span>order_id:<span style="color:#89ddff;">'</span><span style="color:#f7e45a;">+</span><span style="color:#c0c0c0;">order_id</span>)<span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">    <span style="color:#c0c0c0;">console</span><span style="color:#89ddff;">.</span><span style="color:#ffa54f;">log</span>(<span style="color:#89ddff;">'</span>utoken:<span style="color:#89ddff;">'</span><span style="color:#f7e45a;">+</span><span style="color:#c0c0c0;">utoken</span>)<span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">    <span style="color:#c0c0c0;">wx</span><span style="color:#89ddff;">.</span><span style="color:#ffa54f;">login</span>(<span style="color:#89ddff;">{<!-- --></span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">      <span style="color:#ffa54f;">success</span> <span style="color:#89ddff;">(</span>res<span style="color:#89ddff;">)</span> <span style="color:#89ddff;">{<!-- --></span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">        <span style="color:#89ddff;">if</span> (<span style="color:#c0c0c0;">res</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">code</span>) <span style="color:#89ddff;">{<!-- --></span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">          <span style="color:#7ccd7d;">//</span><span style="color:#7ccd7d;">获取支付请求参数</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">          <span style="color:#c0c0c0;">console</span><span style="color:#89ddff;">.</span><span style="color:#ffa54f;">log</span>(<span style="color:#c0c0c0;">res</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">code</span>)<span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">          <span style="color:#c0c0c0;">wx</span><span style="color:#89ddff;">.</span><span style="color:#ffa54f;">request</span>(<span style="color:#89ddff;">{<!-- --></span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">            url<span style="color:#89ddff;">:</span> <span style="color:#c0c0c0;">apiurl</span><span style="color:#89ddff;">,</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">            data<span style="color:#89ddff;">:</span> <span style="color:#89ddff;">{<!-- --></span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">              order_id<span style="color:#89ddff;">:</span> <span style="color:#c0c0c0;">order_id</span><span style="color:#89ddff;">,</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">              payment_id<span style="color:#89ddff;">:</span> <span style="color:#c0c0c0;">payment_id</span><span style="color:#89ddff;">,</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">              device<span style="color:#89ddff;">:</span> <span style="color:#c0c0c0;">device</span><span style="color:#89ddff;">,</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">              code<span style="color:#89ddff;">:</span> <span style="color:#c0c0c0;">res</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">code</span><span style="color:#89ddff;">,</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">              token<span style="color:#89ddff;">:</span> <span style="color:#c0c0c0;">utoken</span><span style="color:#89ddff;">,</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">            <span style="color:#89ddff;">},</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">            <span style="color:#ffa54f;">success</span><span style="color:#89ddff;">:</span> <span style="color:#f7e45a;">function</span> <span style="color:#89ddff;">(</span>res<span style="color:#89ddff;">){<!-- --></span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">              <span style="color:#c0c0c0;">console</span><span style="color:#89ddff;">.</span><span style="color:#ffa54f;">log</span>(<span style="color:#c0c0c0;">res</span>)<span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">              <span style="color:#c0c0c0;">console</span><span style="color:#89ddff;">.</span><span style="color:#ffa54f;">log</span>(<span style="color:#c0c0c0;">res</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">data</span>)<span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">              <span style="color:#89ddff;">if</span> (<span style="color:#c0c0c0;">res</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">data</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">status</span> <span style="color:#f7e45a;">==</span> <span style="color:#89ddff;">'</span>success<span style="color:#89ddff;">'</span>)<span style="color:#89ddff;">{<!-- --></span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                <span style="color:#f7e45a;">var</span> <span style="color:#c0c0c0;">pdata</span> <span style="color:#f7e45a;">=</span> JSON<span style="color:#89ddff;">.</span><span style="color:#ffa54f;">parse</span>(<span style="color:#ffa54f;">decodeURIComponent</span>(<span style="color:#c0c0c0;">res</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">data</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">url</span>))<span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                <span style="color:#f7e45a;">var</span> <span style="color:#c0c0c0;">ptimeStamp</span> <span style="color:#f7e45a;">=</span> <span style="color:#c0c0c0;">pdata</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">timeStamp</span><span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                <span style="color:#f7e45a;">var</span> <span style="color:#c0c0c0;">pnonceStr</span> <span style="color:#f7e45a;">=</span> <span style="color:#c0c0c0;">pdata</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">nonceStr</span><span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                <span style="color:#f7e45a;">var</span> <span style="color:#c0c0c0;">ppackage</span> <span style="color:#f7e45a;">=</span> <span style="color:#c0c0c0;">pdata</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">package</span><span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                <span style="color:#f7e45a;">var</span> <span style="color:#c0c0c0;">psignType</span> <span style="color:#f7e45a;">=</span> <span style="color:#c0c0c0;">pdata</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">signType</span><span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                <span style="color:#f7e45a;">var</span> <span style="color:#c0c0c0;">ppaySign</span> <span style="color:#f7e45a;">=</span> <span style="color:#c0c0c0;">pdata</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">paySign</span><span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                <span style="color:#c0c0c0;">wx</span><span style="color:#89ddff;">.</span><span style="color:#ffa54f;">requestPayment</span>(<span style="color:#89ddff;">{<!-- --></span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　<span style="color:#89ddff;">'</span>timeStamp<span style="color:#89ddff;">':</span> <span style="color:#c0c0c0;">ptimeStamp</span><span style="color:#89ddff;">,</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　<span style="color:#89ddff;">'</span>nonceStr<span style="color:#89ddff;">':</span> <span style="color:#c0c0c0;">pnonceStr</span><span style="color:#89ddff;">,</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　<span style="color:#89ddff;">'</span>package<span style="color:#89ddff;">':</span> <span style="color:#c0c0c0;">ppackage</span><span style="color:#89ddff;">,</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　<span style="color:#89ddff;">'</span>signType<span style="color:#89ddff;">':</span> <span style="color:#c0c0c0;">psignType</span><span style="color:#89ddff;">,</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　<span style="color:#89ddff;">'</span>paySign<span style="color:#89ddff;">':</span> <span style="color:#c0c0c0;">ppaySign</span><span style="color:#89ddff;">,</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　<span style="color:#89ddff;">'</span>success<span style="color:#89ddff;">':</span> <span style="color:#f7e45a;">function</span> <span style="color:#89ddff;">(</span>res<span style="color:#89ddff;">)</span> <span style="color:#89ddff;">{<!-- --></span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　　　<span style="color:#7ccd7d;">//</span><span style="color:#7ccd7d;">定义小程序页面集合</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　　　<span style="color:#f7e45a;">var</span> <span style="color:#c0c0c0;">pages</span> <span style="color:#f7e45a;">=</span> <span style="color:#ffa54f;">getCurrentPages</span>()<span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　　　<span style="color:#7ccd7d;">//</span><span style="color:#7ccd7d;">当前页面</span><span style="color:#7ccd7d;"> (wxpay page)</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　　　<span style="color:#f7e45a;">var</span> <span style="color:#c0c0c0;">currPage</span> <span style="color:#f7e45a;">=</span> <span style="color:#c0c0c0;">pages</span>[<span style="color:#c0c0c0;">pages</span><span style="color:#89ddff;">.</span>length <span style="color:#f7e45a;">-</span> 1]<span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　　　<span style="color:#7ccd7d;">//</span><span style="color:#7ccd7d;">上一个页面</span> <span style="color:#7ccd7d;">（</span><span style="color:#7ccd7d;">index page</span><span style="color:#7ccd7d;">）</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　　　<span style="color:#f7e45a;">var</span> <span style="color:#c0c0c0;">prevPage</span> <span style="color:#f7e45a;">=</span> <span style="color:#c0c0c0;">pages</span>[<span style="color:#c0c0c0;">pages</span><span style="color:#89ddff;">.</span>length <span style="color:#f7e45a;">-</span> 2]<span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　　　<span style="color:#7ccd7d;">//</span><span style="color:#7ccd7d;">通过</span><span style="color:#7ccd7d;">page.setData</span><span style="color:#7ccd7d;">方法使</span><span style="color:#7ccd7d;">index</span><span style="color:#7ccd7d;">的</span><span style="color:#7ccd7d;">webview </span><span style="color:#7ccd7d;">重新加载</span><span style="color:#7ccd7d;">url </span><span style="color:#7ccd7d;">有点类似于后台刷新页面</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　　　<span style="color:#7ccd7d;">//</span><span style="color:#7ccd7d;">此处有点类似小程序通过加载</span><span style="color:#7ccd7d;">URL</span><span style="color:#7ccd7d;">的方式回调通知后端</span> <span style="color:#7ccd7d;">该订单支付成功。后端逻辑不做赘述。</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                                <span style="color:#89ddff;">if</span> (<span style="color:#c0c0c0;">bustype</span><span style="color:#f7e45a;">==</span><span style="color:#89ddff;">'</span>xxxx<span style="color:#89ddff;">'</span>)<span style="color:#89ddff;">{<!-- --></span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                                  <span style="color:#7ccd7d;">//console.log('</span><span style="color:#7ccd7d;">跳转到</span><span style="color:#7ccd7d;">vreturn');</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                                  <span style="color:#c0c0c0;">wx</span><span style="color:#89ddff;">.</span><span style="color:#ffa54f;">redirectTo</span>(<span style="color:#89ddff;">{<!-- --></span> url<span style="color:#89ddff;">:</span> <span style="color:#89ddff;">'</span>/pages/pay/vreturn?order_id=<span style="color:#89ddff;">'</span><span style="color:#f7e45a;">+</span><span style="color:#c0c0c0;">order_id</span> <span style="color:#89ddff;">}</span>)<span style="color:#89ddff;">; //定义的支付返回页面</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                                <span style="color:#89ddff;">}else{<!-- --></span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                                  <span style="color:#c0c0c0;">wx</span><span style="color:#89ddff;">.</span><span style="color:#ffa54f;">redirectTo</span>(<span style="color:#89ddff;">{<!-- --></span> url<span style="color:#89ddff;">:</span> <span style="color:#89ddff;">'</span>/pages/pay/return?order_id=<span style="color:#89ddff;">'</span><span style="color:#f7e45a;">+</span><span style="color:#c0c0c0;">order_id</span> <span style="color:#89ddff;">}</span>)<span style="color:#89ddff;">;//定义的支付返回页面</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                                <span style="color:#89ddff;">}</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　　　<span style="color:#7ccd7d;">//wx.redirectTo({ url: '/pages/order/list' });</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　　　<span style="color:#7ccd7d;">//</span><span style="color:#7ccd7d;">小程序主动返回到上一个页面。即从</span><span style="color:#7ccd7d;">wxpay page</span><span style="color:#7ccd7d;">到</span><span style="color:#7ccd7d;">index page</span><span style="color:#7ccd7d;">。此时</span><span style="color:#7ccd7d;">index page</span><span style="color:#7ccd7d;">的</span><span style="color:#7ccd7d;">webview</span><span style="color:#7ccd7d;">已经重新加载了</span><span style="color:#7ccd7d;">url </span><span style="color:#7ccd7d;">了</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　　　<span style="color:#7ccd7d;">//</span><span style="color:#7ccd7d;">微信小程序的</span><span style="color:#7ccd7d;">page </span><span style="color:#7ccd7d;">也有栈的概念</span><span style="color:#7ccd7d;">navigateBack </span><span style="color:#7ccd7d;">相当于页面出栈的操作</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　　　<span style="color:#7ccd7d;">//wx.navigateBack();</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　<span style="color:#89ddff;">},</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　<span style="color:#89ddff;">'</span>fail<span style="color:#89ddff;">':</span> <span style="color:#f7e45a;">function</span> <span style="color:#89ddff;">(</span>res<span style="color:#89ddff;">)</span> <span style="color:#89ddff;">{<!-- --></span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　　　<span style="color:#c0c0c0;">console</span><span style="color:#89ddff;">.</span><span style="color:#ffa54f;">log</span>(<span style="color:#89ddff;">"</span>支付失败或取消支付:errMsg=<span style="color:#89ddff;">"</span><span style="color:#f7e45a;">+</span><span style="color:#c0c0c0;">res</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">errMsg</span>)<span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　　　<span style="color:#7ccd7d;">//console.log(res);</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　　　<span style="color:#f7e45a;">var</span> <span style="color:#c0c0c0;">pages</span> <span style="color:#f7e45a;">=</span> <span style="color:#ffa54f;">getCurrentPages</span>()<span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　　　<span style="color:#f7e45a;">var</span> <span style="color:#c0c0c0;">currPage</span> <span style="color:#f7e45a;">=</span> <span style="color:#c0c0c0;">pages</span>[<span style="color:#c0c0c0;">pages</span><span style="color:#89ddff;">.</span>length <span style="color:#f7e45a;">-</span> 1]<span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　　　<span style="color:#f7e45a;">var</span> <span style="color:#c0c0c0;">prevPage</span> <span style="color:#f7e45a;">=</span> <span style="color:#c0c0c0;">pages</span>[<span style="color:#c0c0c0;">pages</span><span style="color:#89ddff;">.</span>length <span style="color:#f7e45a;">-</span> 2]<span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　　　<span style="color:#7ccd7d;">//console.log("</span><span style="color:#7ccd7d;">准备修改数据</span><span style="color:#7ccd7d;">");</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　　　<span style="color:#7ccd7d;">//wx.redirectTo({ url: '/pages/index/index' });</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                                <span style="color:#89ddff;">if</span> (<span style="color:#c0c0c0;">bustype</span><span style="color:#f7e45a;">==</span><span style="color:#89ddff;">'</span>xxxx<span style="color:#89ddff;">'</span>)<span style="color:#89ddff;">{<!-- --></span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                                  <span style="color:#7ccd7d;">//wx.navigateBack();</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                                  <span style="color:#c0c0c0;">wx</span><span style="color:#89ddff;">.</span><span style="color:#ffa54f;">redirectTo</span>(<span style="color:#89ddff;">{<!-- --></span> url<span style="color:#89ddff;">:</span> <span style="color:#89ddff;">'</span>/pages/pay/vreturn?order_id=<span style="color:#89ddff;">'</span><span style="color:#f7e45a;">+</span><span style="color:#c0c0c0;">order_id</span> <span style="color:#89ddff;">}</span>)<span style="color:#89ddff;">;//定义的支付返回页面</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                                <span style="color:#89ddff;">}</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                                <span style="color:#89ddff;">else{<!-- --></span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　　　  <span style="color:#c0c0c0;">wx</span><span style="color:#89ddff;">.</span><span style="color:#ffa54f;">redirectTo</span>(<span style="color:#89ddff;">{<!-- --></span> url<span style="color:#89ddff;">:</span> <span style="color:#89ddff;">'</span>/pages/pay/return?order_id=<span style="color:#89ddff;">'</span><span style="color:#f7e45a;">+</span><span style="color:#c0c0c0;">order_id</span> <span style="color:#89ddff;">}</span>)<span style="color:#89ddff;">;//定义的支付返回页面</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                                <span style="color:#89ddff;">}</span></span><span style="background-color:#2e2e2e;">                  　　　　　　　</span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　　　<span style="color:#7ccd7d;">//console.log("</span><span style="color:#7ccd7d;">准备结束页面</span><span style="color:#7ccd7d;">")</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　　　<span style="color:#7ccd7d;">// wx.navigateBack();</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　　　<span style="color:#89ddff;">}</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                  　　　　<span style="color:#89ddff;">}</span>)</span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">              <span style="color:#89ddff;">}</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">              <span style="color:#89ddff;">else{<!-- --></span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">                <span style="color:#c0c0c0;">console</span><span style="color:#89ddff;">.</span><span style="color:#ffa54f;">log</span>(<span style="color:#89ddff;">'</span>获取支付参数失败:status=<span style="color:#89ddff;">'</span><span style="color:#f7e45a;">+</span><span style="color:#c0c0c0;">res</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">data</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">status</span><span style="color:#f7e45a;">+</span><span style="color:#89ddff;">'</span>msg=<span style="color:#89ddff;">'</span><span style="color:#f7e45a;">+</span><span style="color:#c0c0c0;">res</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">data</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">msg</span>)<span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">              <span style="color:#89ddff;">}</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">            <span style="color:#89ddff;">},</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">            <span style="color:#89ddff;">'</span>fail<span style="color:#89ddff;">':</span> <span style="color:#f7e45a;">function</span> <span style="color:#89ddff;">(</span>res<span style="color:#89ddff;">)</span> <span style="color:#89ddff;">{<!-- --></span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">              <span style="color:#c0c0c0;">console</span><span style="color:#89ddff;">.</span><span style="color:#ffa54f;">log</span>(<span style="color:#89ddff;">'</span>获取支付参数请求失败:msg=<span style="color:#89ddff;">'</span> <span style="color:#f7e45a;">+</span> <span style="color:#c0c0c0;">res</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">data</span>)<span style="color:#89ddff;">;</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">            <span style="color:#89ddff;">}</span> </span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">          <span style="color:#89ddff;">}</span>) </span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">        <span style="color:#89ddff;">}</span> <span style="color:#89ddff;">else</span> <span style="color:#89ddff;">{<!-- --></span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">          <span style="color:#c0c0c0;">console</span><span style="color:#89ddff;">.</span><span style="color:#ffa54f;">log</span>(<span style="color:#89ddff;">'</span>登录失败！<span style="color:#89ddff;">'</span> <span style="color:#f7e45a;">+</span> <span style="color:#c0c0c0;">res</span><span style="color:#89ddff;">.</span><span style="color:#c0c0c0;">errMsg</span>)</span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">        <span style="color:#89ddff;">}</span> </span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">      <span style="color:#89ddff;">}</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">    <span style="color:#89ddff;">}</span>)</span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#2e2e2e;">  <span style="color:#89ddff;">},</span></span></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<h5 style="margin-left:0px;text-align:justify;">第八：H5跳转到小程序</h5> 
<p style="margin-left:0;text-align:justify;">前端页面需要加载微信插件</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="37" src="https://images2.imgbox.com/63/ed/JddqWVuZ_o.png" width="921"></p> 
<p style="margin-left:0;text-align:justify;">调用方法</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="186" src="https://images2.imgbox.com/88/4f/FYdewWAc_o.png" width="870"></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="57" src="https://images2.imgbox.com/fc/aa/5W563MkW_o.png" width="1200"></p> 
<p style="margin-left:0;text-align:justify;">前端判断是否在小程序环境中</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="187" src="https://images2.imgbox.com/66/5f/kpDDfu5O_o.png" width="629"></p> 
<h5 style="margin-left:0px;text-align:justify;">第九：小程序跳转到H5</h5> 
<p style="margin-left:0;text-align:justify;">Webview的Src url变量</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="629" src="https://images2.imgbox.com/7a/4f/bAkUAyHF_o.png" width="1149"></p> 
<p style="margin-left:0;text-align:justify;">页面加载方法中setdata 跳转url和传参</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="639" src="https://images2.imgbox.com/6e/62/1nlt217W_o.png" width="1200"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">小程序中新建页面后，需要配置页面</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="823" src="https://images2.imgbox.com/19/9f/y0bFQPgu_o.png" width="1112"></p> 
<h5 style="margin-left:0px;text-align:justify;">第十，支付成功的回调api中的签名验证修改</h5> 
<p style="margin-left:0;text-align:justify;">前面发给微信的数据签名是小程序appid，签名验证时别忘了也同样用小程序的appid。</p> 
<h5 style="margin-left:0px;text-align:justify;">第十一，调试</h5> 
<p style="margin-left:0;text-align:justify;">可模拟器上调试，可真机调试，真机调试时，会生成开发版，扫码后在手机上测试运行结果</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="982" src="https://images2.imgbox.com/58/d9/YKmDZ2cF_o.png" width="512"></p> 
<p style="margin-left:0;text-align:justify;">模拟运行和真机调试时，应勾选 不校验合法域名 选项。</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<h5 style="margin-left:0px;text-align:justify;">第十一，上传发布</h5> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<h5 style="margin-left:0px;text-align:justify;">备注：</h5> 
<p style="margin-left:0;text-align:justify;">小程序订单中心如何配置？</p> 
<p style="margin-left:0;text-align:justify;">需要配置一个小程序的页面path，该页面对应h5的订单中心地址</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="425" src="https://images2.imgbox.com/e8/b5/h3fLFAP9_o.png" width="1200"></p> 
<p style="margin-left:0;text-align:justify;">配置时则输入自己定义的小程序的页面路径 /pages/order/list</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9472bc88b46b53ce0a3b39cbf1ee60fb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">文心一言智能体-心弦共鸣</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dde535b1b850cf955e01d6f685537498/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">[自动驾驶技术]-5 Tesla自动驾驶方案之算法（AI Day 2021）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>