<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CesiumJS第3篇，前端使用Vue和Element实现可拖动弹框效果，并使用mixins混入特性实现，不影响底层元素操作（Cesium上可拖拽的实时视频播放弹框，底层元素可以正常操作） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/c9da36bce79a7eacaeac328b3b5edb29/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="CesiumJS第3篇，前端使用Vue和Element实现可拖动弹框效果，并使用mixins混入特性实现，不影响底层元素操作（Cesium上可拖拽的实时视频播放弹框，底层元素可以正常操作）">
  <meta property="og:description" content="简述：在前端开发中，弹框和实时视频播放是常见的需求。这里来简单记录一下，如何使用Vue.js和Element UI实现一个可拖动的弹框，并使用mixins混入特性，在组件中播放实时视频。同时，确保在拖拽弹框时，底层元素仍然可以操作。这里来记录一下 Cesium ～ 第 3 篇 —— Cesium上可拖拽的实时视频弹框 一、项目初始化，以Vue项目为例 首先，确保你的项目已经安装了Element UI。如果没有安装，可以使用以下命令进行安装并注册：
npm install element-ui
// 或者
cnpm install element-ui
二、创建Vue组件 这里我们创建一个包含实时视频播放功能的弹框组件。这个组件将使用Element UI的el-dialog组件，并添加拖动功能，同时添加CSS代码。确保在拖拽时底层元素可以操作。
1. 弹框组件 &lt;template&gt; &lt;!-- 弹出框 --&gt; &lt;el-dialog title=&#34;实时视频播放&#34; :visible.sync=&#34;dialogVisible&#34; width=&#34;30%&#34; :before-close=&#34;handleClose&#34; :modal=&#34;false&#34; :close-on-click-modal=&#34;false&#34; class=&#34;cesium_dialog&#34; &gt; &lt;flvVue :Url=&#34;rtsp1&#34; v-if=&#34;dialogVisible&#34;&gt;&lt;/flvVue&gt; &lt;span slot=&#34;footer&#34; class=&#34;dialog-footer&#34;&gt; &lt;/span&gt; &lt;/el-dialog&gt; &lt;/template&gt; &lt;script&gt; export default { data() { return { dialogVisible: false, // 弹框显示状态 rtsp1: &#39;rtsp://your-stream-url&#39; // 实时视频流地址 }; }, methods: { // 打开弹框事件 DialogOpen(RtspUrl) { this.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-12T11:45:02+08:00">
    <meta property="article:modified_time" content="2024-07-12T11:45:02+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CesiumJS第3篇，前端使用Vue和Element实现可拖动弹框效果，并使用mixins混入特性实现，不影响底层元素操作（Cesium上可拖拽的实时视频播放弹框，底层元素可以正常操作）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>简述：在前端开发中，弹框和实时视频播放是常见的需求。这里来简单记录一下，如何使用Vue.js和Element UI实现一个可拖动的弹框，并使用mixins混入特性，在组件中播放实时视频。同时，确保在拖拽弹框时，底层元素仍然可以操作。这里来记录一下</h4> 
<p></p> 
<hr> 
<p></p> 
<p class="img-center"><img alt="" height="457" src="https://images2.imgbox.com/cc/3e/WdIJzwFU_o.gif" width="733"></p> 
<h4 style="text-align:center;"><span style="color:#956fe7;">Cesium ～ 第 3 篇    ——    Cesium上可拖拽的实时视频弹框</span></h4> 
<p></p> 
<h4>一、项目初始化，以Vue项目为例</h4> 
<p>首先，确保你的项目已经安装了Element UI。如果没有安装，可以使用以下命令进行安装并注册：</p> 
<blockquote> 
 <p>npm install element-ui</p> 
 <p>// 或者</p> 
 <p>cnpm install element-ui</p> 
</blockquote> 
<p></p> 
<hr> 
<p></p> 
<h4>二、创建Vue组件</h4> 
<p></p> 
<p>这里我们创建一个包含实时视频播放功能的弹框组件。这个组件将使用Element UI的<code>el-dialog</code>组件，并添加拖动功能，同时添加CSS代码。确保在拖拽时底层元素可以操作。</p> 
<h4>1. 弹框组件</h4> 
<pre><code class="language-html">&lt;template&gt;
  &lt;!-- 弹出框 --&gt;
  &lt;el-dialog
    title="实时视频播放"
    :visible.sync="dialogVisible"
    width="30%"
    :before-close="handleClose"
    :modal="false"
    :close-on-click-modal="false"
    class="cesium_dialog"
  &gt;
    &lt;flvVue :Url="rtsp1" v-if="dialogVisible"&gt;&lt;/flvVue&gt;
    &lt;span slot="footer" class="dialog-footer"&gt; &lt;/span&gt;
  &lt;/el-dialog&gt;
&lt;/template&gt;

&lt;script&gt;

export default {

  data() {
    return {
      dialogVisible: false, // 弹框显示状态
      rtsp1: 'rtsp://your-stream-url' // 实时视频流地址
    };
  },

  methods: {
    // 打开弹框事件
    DialogOpen(RtspUrl) {
      this.dialogVisible = true; // 显示弹框
    },
    // 关闭弹框事件
    handleClose() {
      this.dialogVisible = false; // 关闭弹框
    }
  },

};};
&lt;/script&gt;

&lt;style&gt;
/* 在你的 CSS 文件或 &lt;style&gt; 标签中添加 */
::v-deep .el-dialog__wrapper {
  pointer-events: none !important; /* 禁用遮罩层的点击事件 */
}
::v-deep .el-dialog__wrapper .el-dialog {
  pointer-events: auto !important; /* 允许对话框内的元素交互 */
  margin-top: 20vh !important; /* 设置弹框距顶部的距离 */
}
&lt;/style&gt;
</code></pre> 
<h4>2. 拖拽功能的实现</h4> 
<p>创建一个<code>draggable.js</code>文件，用于实现弹框的拖拽功能：</p> 
<pre><code class="language-javascript">// src/mixins/draggable.js
export default {
  mounted() {
    // 获取对话框的头部元素
    const dialogHeaderEl = this.$el.querySelector('.el-dialog__header');
    // 获取整个对话框元素
    const dragDom = this.$el.querySelector('.el-dialog');
    // 设置头部的光标为移动样式，表示可以拖动
    dialogHeaderEl.style.cursor = 'move';

    // 函数用于获取元素的计算样式
    const getStyle = (function () {
      if (window.document.currentStyle) {
        // 对于旧版 IE，使用 currentStyle
        return (dom, attr) =&gt; dom.currentStyle[attr];
      } else {
        // 对于现代浏览器，使用 getComputedStyle
        return (dom, attr) =&gt; getComputedStyle(dom, false)[attr];
      }
    })();

    // 鼠标按下事件处理程序
    dialogHeaderEl.onmousedown = (e) =&gt; {
      // 计算鼠标点击点相对于对话框头部的偏移量
      const disX = e.clientX - dialogHeaderEl.offsetLeft;
      const disY = e.clientY - dialogHeaderEl.offsetTop;

      // 获取对话框的宽度和高度
      const dragDomWidth = dragDom.offsetWidth;
      const dragDomHeight = dragDom.offsetHeight;

      // 获取浏览器窗口的宽度和高度
      const screenWidth = document.body.clientWidth;
      const screenHeight = document.body.clientHeight;

      // 计算对话框拖动的边界
      const minDragDomLeft = dragDom.offsetLeft; // 左边界
      // 右边界
      const maxDragDomLeft = screenWidth - dragDom.offsetLeft - dragDomWidth; 
      const minDragDomTop = dragDom.offsetTop; // 上边界
      // 下边界
      const maxDragDomTop = screenHeight - dragDom.offsetTop - dragDomHeight; 

      // 获取对话框当前位置的样式（左和上），处理 px 或百分比单位
      let styL = getStyle(dragDom, 'left');
      let styT = getStyle(dragDom, 'top');

      // 处理百分比单位，将其转换为绝对像素值
      if (styL.includes('%')) {
        styL = +document.body.clientWidth * (+styL.replace(/%/g, '') / 100);
        styT = +document.body.clientHeight * (+styT.replace(/%/g, '') / 100);
      } else {
        // 处理 px 单位
        styL = +styL.replace(/px/g, '');
        styT = +styT.replace(/px/g, '');
      }

      // 鼠标移动事件处理程序
      document.onmousemove = function (e) {
        // 计算新的位置
        let left = e.clientX - disX;
        let top = e.clientY - disY;

        // 边界处理：防止对话框拖动超出边界
        if (-left &gt; minDragDomLeft) {
          left = -minDragDomLeft;
        } else if (left &gt; maxDragDomLeft) {
          left = maxDragDomLeft;
        }

        if (-top &gt; minDragDomTop) {
          top = -minDragDomTop;
        } else if (top &gt; maxDragDomTop) {
          top = maxDragDomTop;
        }

        // 更新对话框的位置
        dragDom.style.cssText += `;left:${left + styL}px;top:${top + styT}px;`;
      };

      // 鼠标释放事件处理程序
      document.onmouseup = function () {
        // 解除鼠标移动和释放事件的绑定
        document.onmousemove = null;
        document.onmouseup = null;
      };

    };
  }
};};</code></pre> 
<h4>3. 整合拖拽功能</h4> 
<p>将<code>draggable.js</code>文件混入到你的Vue组件中，使得弹框可以实现拖动功能，同时确保拖拽时底层元素仍然可以操作。</p> 
<pre><code class="language-javascript">import draggable from "@/utils/hs/draggable.js"; // 引入拖拽功能

export default {

  // 混入拖拽功能
  mixins: [draggable],

  data() {
    return {
      ......
    };
  },
  methods: {
      ......
  },

};};
</code></pre> 
<h4></h4> 
<hr> 
<h4></h4> 
<h4>三、完整代码</h4> 
<h4><em>1. Vue</em></h4> 
<pre><code class="language-javascript">&lt;template&gt;
  &lt;!-- 弹出框 --&gt;
  &lt;el-dialog
    title="实时视频播放"
    :visible.sync="dialogVisible"
    width="30%"
    :before-close="handleClose"
    :modal="false"
    :close-on-click-modal="false"
    class="cesium_dialog"
  &gt;
    &lt;flvVue :Url="rtsp1" v-if="dialogVisible"&gt;&lt;/flvVue&gt;
    &lt;span slot="footer" class="dialog-footer"&gt; &lt;/span&gt;
  &lt;/el-dialog&gt;
&lt;/template&gt;

&lt;script&gt;
import draggable from "@/utils/hs/draggable.js"; // 引入拖拽功能

export default {

  // 混入拖拽功能
  mixins: [draggable],

  data() {
    return {
      dialogVisible: false,
      rtsp1: 'rtsp://your-stream-url'
    };
  },

  methods: {
    DialogOpen(RtspUrl) {
      this.dialogVisible = true;
    },
    handleClose() {
      this.dialogVisible = false;
    }
  },

};};
&lt;/script&gt;

&lt;style&gt;
/* 在你的 CSS 文件或 &lt;style&gt; 标签中添加 */
::v-deep .el-dialog__wrapper {
  pointer-events: none !important; /* 禁用遮罩层的点击事件 */
}
::v-deep .el-dialog__wrapper .el-dialog {
  pointer-events: auto !important; /* 允许对话框内的元素交互 */
  margin-top: 20vh !important; /* 设置弹框距顶部的距离 */
}
&lt;/style&gt;</code></pre> 
<h4><em>2. JS</em></h4> 
<pre><code class="language-javascript">// src/mixins/draggable.js

export default {
  mounted() {
    // 获取对话框的头部元素
    const dialogHeaderEl = this.$el.querySelector('.el-dialog__header');
    // 获取整个对话框元素
    const dragDom = this.$el.querySelector('.el-dialog');
    // 设置头部的光标为移动样式，表示可以拖动
    dialogHeaderEl.style.cursor = 'move';

    // 函数用于获取元素的计算样式
    const getStyle = (function () {
      if (window.document.currentStyle) {
        // 对于旧版 IE，使用 currentStyle
        return (dom, attr) =&gt; dom.currentStyle[attr];
      } else {
        // 对于现代浏览器，使用 getComputedStyle
        return (dom, attr) =&gt; getComputedStyle(dom, false)[attr];
      }
    })();

    // 鼠标按下事件处理程序
    dialogHeaderEl.onmousedown = (e) =&gt; {
      // 计算鼠标点击点相对于对话框头部的偏移量
      const disX = e.clientX - dialogHeaderEl.offsetLeft;
      const disY = e.clientY - dialogHeaderEl.offsetTop;

      // 获取对话框的宽度和高度
      const dragDomWidth = dragDom.offsetWidth;
      const dragDomHeight = dragDom.offsetHeight;

      // 获取浏览器窗口的宽度和高度
      const screenWidth = document.body.clientWidth;
      const screenHeight = document.body.clientHeight;

      // 计算对话框拖动的边界
      const minDragDomLeft = dragDom.offsetLeft; // 左边界
      // 右边界
      const maxDragDomLeft = screenWidth - dragDom.offsetLeft - dragDomWidth;
      const minDragDomTop = dragDom.offsetTop; // 上边界
      // 下边界
      const maxDragDomTop = screenHeight - dragDom.offsetTop - dragDomHeight; 
      // 获取对话框当前位置的样式（左和上），处理 px 或百分比单位
      let styL = getStyle(dragDom, 'left');
      let styT = getStyle(dragDom, 'top');

      // 处理百分比单位，将其转换为绝对像素值
      if (styL.includes('%')) {
        styL = +document.body.clientWidth * (+styL.replace(/%/g, '') / 100);
        styT = +document.body.clientHeight * (+styT.replace(/%/g, '') / 100);
      } else {
        // 处理 px 单位
        styL = +styL.replace(/px/g, '');
        styT = +styT.replace(/px/g, '');
      }

      // 鼠标移动事件处理程序
      document.onmousemove = function (e) {
        // 计算新的位置
        let left = e.clientX - disX;
        let top = e.clientY - disY;

        // 边界处理：防止对话框拖动超出边界
        if (-left &gt; minDragDomLeft) {
          left = -minDragDomLeft;
        } else if (left &gt; maxDragDomLeft) {
          left = maxDragDomLeft;
        }

        if (-top &gt; minDragDomTop) {
          top = -minDragDomTop;
        } else if (top &gt; maxDragDomTop) {
          top = maxDragDomTop;
        }

        // 更新对话框的位置
        dragDom.style.cssText += `;left:${left + styL}px;top:${top + styT}px;`;
      };

      // 鼠标释放事件处理程序
      document.onmouseup = function () {
        // 解除鼠标移动和释放事件的绑定
        document.onmousemove = null;
        document.onmouseup = null;
      };
    };
  }
};};</code></pre> 
<p></p> 
<hr> 
<p></p> 
<h4>四. 请求RTSP视频流播放，请看</h4> 
<p><a class="link-info has-card" href="https://blog.csdn.net/weixin_65793170/article/details/140049511?csdn_share_tail=%7B%22type%22%3A%22blog%22%2C%22rType%22%3A%22article%22%2C%22rId%22%3A%22140049511%22%2C%22source%22%3A%22weixin_65793170%22%7D" title="前端请求RTSP视频流播放"><span class="link-card-box"><span class="link-title">前端请求RTSP视频流播放</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/4b/11/DcQo8ql5_o.png" alt="icon-default.png?t=N7T8">https://blog.csdn.net/weixin_65793170/article/details/140049511?csdn_share_tail=%7B%22type%22%3A%22blog%22%2C%22rType%22%3A%22article%22%2C%22rId%22%3A%22140049511%22%2C%22source%22%3A%22weixin_65793170%22%7D</span></span></a></p> 
<p></p> 
<hr> 
<p></p> 
<h4>五. Cesium在项目中使用的详细介绍，请看以下</h4> 
<p><a class="link-info has-card" href="https://blog.csdn.net/weixin_65793170/article/details/131204332" title="Cesium在项目中的使用"><span class="link-card-box"><span class="link-title">Cesium在项目中的使用</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/9f/90/tDspkrQ0_o.png" alt="icon-default.png?t=N7T8">https://blog.csdn.net/weixin_65793170/article/details/131204332</span></span></a></p> 
<p></p> 
<hr> 
<p></p> 
<h4>六. 小结</h4> 
<p>通过以上步骤，我们实现了一个可拖动的弹框，并在其中播放实时视频。我们使用了Vue.js和Element UI，并通过自定义混入实现了拖拽功能。同时，通过设置<code>pointer-events</code>属性，确保在拖拽弹框时底层元素仍然可以操作。</p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<h4><span style="color:#956fe7;">创作不易，感觉有用，就一键三连😄点赞、收藏加关注，感谢(●'◡'●)</span></h4>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fdc258e73e13a7e8e6bfb76f96152f4b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">如何使用可道云结合内网穿透工具实现远程访问打造私人云盘</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ccef01aeb5cdee1a23f0d35e78759982/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SpringBoot(JAVA)整合微信公众号消息推送</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>