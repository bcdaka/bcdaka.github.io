<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>初学Mybatis之生命周期和作用域 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/4711b4778fdc203e10cceaab2e1c8773/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="初学Mybatis之生命周期和作用域">
  <meta property="og:description" content="生命周期和作用域，如果错误使用，会导致严重的并发问题
1. SqlSessionFactoryBuilder： 一旦创建了 SqlSessionFactory，就不再需要它了
SqlSessionFactoryBuilder 的最佳作用域是局部变量
2. SqlSessionFactory： 可以理解成数据库连接池
一旦被创建就应该在应用的运行期间一直存在，没有任何理由丢弃它或重新创建另一个实例
SqlSessionFactory 的最佳作用域是应用作用域
最简单的就是使用单例模式（保证全局只有一份变量）或者静态单例模式
3. SqlSession： 可以理解成连接到连接池的一个请求
每个线程都应该有它自己的 SqlSession 实例
SqlSession 的实例不是线程安全的，不能被共享
它的最佳作用域是请求或方法作用域
用完关闭，否则资源被占用
每个 SqlSession 能连接多个 Mapper
并发情况下，SqlSession 用完关闭，是因为 SqlSessionFactory 池子需要释放，不然会形成宕机">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-23T22:37:35+08:00">
    <meta property="article:modified_time" content="2024-07-23T22:37:35+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">初学Mybatis之生命周期和作用域</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>生命周期和作用域，如果错误使用，会导致严重的并发问题</p> 
<h5>1. SqlSessionFactoryBuilder：</h5> 
<p>一旦创建了 SqlSessionFactory，就不再需要它了</p> 
<p>SqlSessionFactoryBuilder 的最佳<strong>作用域</strong>是<strong>局部变量</strong></p> 
<h5>2. SqlSessionFactory：</h5> 
<p>可以理解成数据库连接池</p> 
<p>一旦被创建就应该在应用的运行期间一直存在，<strong>没有任何理由丢弃它或重新创建另一个实例</strong></p> 
<p>SqlSessionFactory 的最佳<strong>作用域</strong>是<strong>应用作用域</strong></p> 
<p>最简单的就是使用<strong>单例模式</strong>（保证全局只有一份变量）或者静态单例模式</p> 
<h5>3. SqlSession：</h5> 
<p>可以理解成连接到连接池的一个请求</p> 
<p>每个线程都应该有它自己的 SqlSession 实例</p> 
<p>SqlSession 的实例不是线程安全的，不能被共享</p> 
<p>它的最佳<strong>作用域</strong>是<strong>请求或方法作用域</strong></p> 
<p>用完<strong>关闭，</strong>否则资源被占用</p> 
<p>每个 SqlSession 能连接多个 Mapper</p> 
<p>并发情况下，SqlSession 用完关闭，是因为 SqlSessionFactory 池子需要释放，不然会形成宕机</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e12d2918e6eeb44bc205f78757205157/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">两台低功耗服务器存档</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3001a016e931fbe6f94e0b207fbd7820/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C&#43;&#43;五子棋（未做完，但能玩，而且还不错）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>