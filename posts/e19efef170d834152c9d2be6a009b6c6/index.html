<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>前端Excel导出实用方案（完整源码，可直接应用） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/e19efef170d834152c9d2be6a009b6c6/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="前端Excel导出实用方案（完整源码，可直接应用）">
  <meta property="og:description" content="目录
前言：
技术选型：
主要功能点：
核心代码：
完整代码：
安装sheetjs
全局导出组件代码：
调用示例：
mock数据:
开发文档
调用方式：
API
FAQ
前言： 在前后端分离开发为主流的时代，很多时候，excel导出已不再由后端主导，而是把导出的操作移交到了前端。本文在全局导出组件封装上，保持了高度的扩展性，无论大家用的是element组件库还是antd vue的组件库或者其他的组件库，都容易进行更换。
技术选型： vue &#43; antd vue &#43; sheetjs
前端导出excel导出，需借助第三方插件，目前两款导出最为主流。
一款是sheetjs，优点支持多种excel格式，但是官方文档全是英文
SheetJS Community Edition | SheetJS Community Edition
一款是exceljs，优点是中文文档很全，缺点是导出格式受限，仅支持部分格式
https://github.com/exceljs/exceljs/blob/master/README_zh.md
因公司业务需要，用户需支持多种excel的格式，所以本文笔者主要针对sheetjs进行封装调用。
主要功能点： 自定义dom拆分成多张表导出（默认超过1万条数据自动拆分）自定义过滤函数各种标题自定义数据排序支持大数据量导出 核心代码： // 文件名称 const filename = fileName; //Excel第一个sheet的名称 const ws_name = sheetName; // 创建sheet const ws = XLSX.utils.aoa_to_sheet([this.tableTitle]); //添加数据 XLSX.utils.sheet_add_json(ws, apiData, { skipHeader: true, origin:origin }); // 创建wokbook const wb = XLSX.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-20T09:38:42+08:00">
    <meta property="article:modified_time" content="2024-06-20T09:38:42+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">前端Excel导出实用方案（完整源码，可直接应用）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E5%89%8D%E8%A8%80%EF%BC%9A-toc" style="margin-left:40px;"><a href="#%E5%89%8D%E8%A8%80%EF%BC%9A" rel="nofollow">前言：</a></p> 
<p id="%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B%EF%BC%9A-toc" style="margin-left:40px;"><a href="#%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B%EF%BC%9A" rel="nofollow">技术选型：</a></p> 
<p id="%E4%B8%BB%E8%A6%81%E5%8A%9F%E8%83%BD%E7%82%B9%EF%BC%9A-toc" style="margin-left:40px;"><a href="#%E4%B8%BB%E8%A6%81%E5%8A%9F%E8%83%BD%E7%82%B9%EF%BC%9A" rel="nofollow">主要功能点：</a></p> 
<p id="%E6%A0%B8%E5%BF%83%E4%BB%A3%E7%A0%81%EF%BC%9A-toc" style="margin-left:40px;"><a href="#%E6%A0%B8%E5%BF%83%E4%BB%A3%E7%A0%81%EF%BC%9A" rel="nofollow">核心代码：</a></p> 
<p id="%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81%EF%BC%9A-toc" style="margin-left:40px;"><a href="#%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81%EF%BC%9A" rel="nofollow">完整代码：</a></p> 
<p id="%E5%AE%89%E8%A3%85sheetjs-toc" style="margin-left:80px;"><a href="#%E5%AE%89%E8%A3%85sheetjs" rel="nofollow">安装sheetjs</a></p> 
<p id="%E5%85%A8%E5%B1%80%E5%AF%BC%E5%87%BA%E7%BB%84%E4%BB%B6%E4%BB%A3%E7%A0%81%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E5%85%A8%E5%B1%80%E5%AF%BC%E5%87%BA%E7%BB%84%E4%BB%B6%E4%BB%A3%E7%A0%81%EF%BC%9A" rel="nofollow">全局导出组件代码：</a></p> 
<p id="%E8%B0%83%E7%94%A8%E7%A4%BA%E4%BE%8B%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E8%B0%83%E7%94%A8%E7%A4%BA%E4%BE%8B%EF%BC%9A" rel="nofollow">调用示例：</a></p> 
<p id="mock%E6%95%B0%E6%8D%AE%3A-toc" style="margin-left:80px;"><a href="#mock%E6%95%B0%E6%8D%AE%3A" rel="nofollow">mock数据:</a></p> 
<p id="%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3-toc" style="margin-left:40px;"><a href="#%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3" rel="nofollow">开发文档</a></p> 
<p id="%E8%B0%83%E7%94%A8%E6%96%B9%E5%BC%8F%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E8%B0%83%E7%94%A8%E6%96%B9%E5%BC%8F%EF%BC%9A" rel="nofollow">调用方式：</a></p> 
<p id="API-toc" style="margin-left:80px;"><a href="#API" rel="nofollow">API</a></p> 
<p id="FAQ-toc" style="margin-left:80px;"><a href="#FAQ" rel="nofollow">FAQ</a></p> 
<hr> 
<h3 id="%E5%89%8D%E8%A8%80%EF%BC%9A">前言：</h3> 
<p>在前后端分离开发为主流的时代，很多时候，excel导出已不再由后端主导，而是把导出的操作移交到了前端。本文在全局导出组件封装上，保持了高度的扩展性，无论大家用的是element组件库还是antd vue的组件库或者其他的组件库，都容易进行更换。</p> 
<h3 id="%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B%EF%BC%9A">技术选型：</h3> 
<p><strong>vue + antd vue + sheetjs</strong></p> 
<p>前端导出excel导出，需借助第三方插件，目前两款导出最为主流。</p> 
<p>一款是sheetjs，优点支持多种excel格式，但是官方文档全是英文<br><a href="https://docs.sheetjs.com/" rel="nofollow" title="SheetJS Community Edition | SheetJS Community Edition">SheetJS Community Edition | SheetJS Community Edition</a></p> 
<p>一款是exceljs，优点是中文文档很全，缺点是导出格式受限，仅支持部分格式</p> 
<p><a href="https://github.com/exceljs/exceljs/blob/master/README_zh.md" title="https://github.com/exceljs/exceljs/blob/master/README_zh.md">https://github.com/exceljs/exceljs/blob/master/README_zh.md</a></p> 
<p>因公司业务需要，用户需支持多种excel的格式，所以本文笔者主要针对sheetjs进行封装调用。</p> 
<h3 id="%E4%B8%BB%E8%A6%81%E5%8A%9F%E8%83%BD%E7%82%B9%EF%BC%9A">主要功能点：</h3> 
<ul><li>自定义dom</li><li>拆分成多张表导出（默认超过1万条数据自动拆分）</li><li>自定义过滤函数</li><li>各种标题自定义</li><li>数据排序</li><li>支持大数据量导出</li></ul> 
<h3 id="%E6%A0%B8%E5%BF%83%E4%BB%A3%E7%A0%81%EF%BC%9A">核心代码：</h3> 
<pre><code class="language-javascript">// 文件名称
const filename = fileName;
//Excel第一个sheet的名称
const ws_name = sheetName;
// 创建sheet
const ws = XLSX.utils.aoa_to_sheet([this.tableTitle]);
//添加数据
XLSX.utils.sheet_add_json(ws, apiData, {
   skipHeader: true,
   origin:origin
});
// 创建wokbook
const wb = XLSX.utils.book_new();
// 将数据添加到工作薄
XLSX.utils.book_append_sheet(wb, ws, ws_name);
// 导出文件
XLSX.writeFile(wb, filename);</code></pre> 
<h3 id="%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81%EF%BC%9A">完整代码：</h3> 
<h4 id="%E5%AE%89%E8%A3%85sheetjs">安装sheetjs</h4> 
<pre><code>npm i xlsx</code></pre> 
<h4 id="%E5%85%A8%E5%B1%80%E5%AF%BC%E5%87%BA%E7%BB%84%E4%BB%B6%E4%BB%A3%E7%A0%81%EF%BC%9A">全局导出组件代码：</h4> 
<p>ExportExcelComponent.vue</p> 
<pre><code class="language-javascript">&lt;template&gt;
  &lt;div id="excel-export"&gt;
    &lt;slot name="custom" v-if="isCustom"&gt;&lt;/slot&gt;

    &lt;a-button ghost type="primary" @click="startExport" v-else&gt;
      导出excel
    &lt;/a-button&gt;

    &lt;a-modal
      v-if="visible"
      v-model="visible"
      :title="modelTitle"
      :maskClosable="false"
      :closable="false"
    &gt;
      &lt;template #footer&gt;
        &lt;a-button
          type="primary"
          ghost
          v-if="isAbnormal"
          :loading="btnLoading"
          @click="startExport"
        &gt;
          重新导出
        &lt;/a-button&gt;
        &lt;a-button
          type="primary"
          ghost
          v-if="isAbnormal"
          :loading="btnLoading"
          @click="getTableData"
        &gt;
          继续导出
        &lt;/a-button&gt;
        &lt;a-button :loading="btnLoading" @click="handleClose"&gt; 关闭 &lt;/a-button&gt;
      &lt;/template&gt;
      &lt;a-progress
        :percent="percent"
        :status="progressStatus"
        class="progress"
      /&gt;
    &lt;/a-modal&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
import * as XLSX from "xlsx";

export default {
  props: {
    //自定义过滤函数
    filterFunction: {
      type: Function,
      default: null,
    },
    //sheet名
    ws_name: {
      type: String,
      default: "Sheet",
    },
    //导出的excel的表名
    filename: {
      type: String,
      default: "Excel" + new Date().getTime(),
    },
    //拆分成每个表多少条数据，需要搭配isSplit属性一起使用
    multiFileSize: {
      type: Number,
      default: 10e3,
    },
    //模态框标题
    modelTitle: {
      type: String,
      default: "导出excel",
    },
    //是否自定义dom,如果采用插槽，需要开启该属性，否则dom为默认button
    isCustom: {
      type: Boolean,
      default: false,
    },
    // 导出的数据表的表头
    tableTitleData: {
      type: Array,
      required: true,
      default: () =&gt; [],
    },
    //请求数据的api函数
    asyncDataApi: {
      type: Function,
      default: () =&gt; {},
    },
    //请求参数
    listQuery: {
      type: Object,
      default: () =&gt; ({}),
    },
  },
  data() {
    return {
      ws: null,
      isAbnormal: false,
      btnLoading: false,
      progressStatus: "active",
      visible: false,
      percent: 0,
      tableData: [],
      currentPage: 1,
      multiFileNum: 0,
    };
  },
  computed: {
    // 导出的数据表的表头
    tableTitle() {
      return this.tableTitleData.map((item) =&gt; {
        return item.title;
      });
    },
    //导出数据表的表头的code
    tableCode() {
      return this.tableTitleData.map((item) =&gt; {
        return item.code;
      });
    },
  },
  watch: {
    percent: {
      handler(newVal) {
        if (newVal &gt; 100) {
          this.progressStatus = "success";
          setTimeout(() =&gt; {
            this.handleClose();
          }, 500);
        }
      },
    },
  },
  methods: {
    //按照指定的title顺序映射排序数组对象
    sortData(data, tit_code) {
      const newData = [];
      data.forEach((item) =&gt; {
        const newObj = {};
        tit_code.forEach((v) =&gt; {
          newObj[v] = item[v] || "";
        });
        newData.push(newObj);
      });
      return newData;
    },

    handleClose() {
      console.log("close");
      this.resetExport();
      this.visible = false;
    },
    resetExport() {
      this.percent = 0;
      this.progressStatus = "active";
      this.isAbnormal = false;
      this.tableData = [];
      this.currentPage = 1;
      this.multiFileNum = 0;

      this.ws = XLSX.utils.aoa_to_sheet([this.tableTitle]);
    },
    //获取进度条百分比
    getPersent(res) {
      const persent_num =
        ((res.paginator.currentPage * res.paginator.size) /
          res.paginator.total) *
        100;
      this.percent = parseInt(persent_num) - 1;
    },

    //异常处理
    handleAbnormal() {
      this.btnLoading = false;
      this.progressStatus = "exception";
      this.isAbnormal = true;
    },

    async startExport() {
      if (!this.asyncDataApi) {
        return new Promise(new Error("asyncDataApi is required"));
      }

      this.resetExport();

      await this.getTableData();
    },
    //请求导出的数据和标题
    async getTableData() {
      this.visible = true;
      this.btnLoading = true;
      this.isAbnormal = false;

      try {
        const res = await this.asyncDataApi({
          ...this.listQuery,
          page: this.currentPage,
        });

        if (res.code !== 200) {
          this.handleAbnormal();
          this.$message.error(res.message || this.t("requestException"));
          return;
        }

        let apiData = res.data;
        apiData = this.sortData(apiData, this.tableCode);

        if (this.filterFunction) {
          apiData = this.filterFunction(apiData);
        }

        apiData = apiData.map((item) =&gt; Object.values(item));

        this.addSheetData(apiData, res);

        this.currentPage = res.paginator.currentPage + 1;

        console.log("res", res);
        this.getPersent(res);

        const isSplit =
          res.paginator.currentPage * res.paginator.size &gt;=
          this.multiFileSize * (this.multiFileNum + 1);
        if (isSplit) {
          this.splitExport();
        }

        if (res.paginator.currentPage &lt; res.paginator.page) {
          this.getTableData();
          return;
        }

        //当数据不满足拆分数量时触发
        this.hadnleOneExport(res);

        this.percent += 2;
        this.btnLoading = false;
        this.$message.success("导出成功");
      } catch (error) {
        console.log(error);
        this.$message.error("网络错误，请稍后再试");
        this.handleAbnormal();
      }
    },
    //当数据不满足拆分数量时触发
    hadnleOneExport(res) {
      if (
        this.multiFileNum &amp;&amp;
        res.paginator.total &gt; this.multiFileNum * this.multiFileSize
      ) {
        this.multiFileNum += 1;
        this.exportExcel(
          this.filename + this.multiFileNum + ".xlsx",
          this.ws_name + this.multiFileNum
        );
      } else if (!this.multiFileNum) {
        this.exportExcel(this.filename + ".xlsx", this.ws_name);
      }
    },
    //拆分成多个excel导出
    splitExport() {
      this.multiFileNum += 1;

      this.exportExcel(
        this.filename + this.multiFileNum + ".xlsx",
        this.ws_name + this.multiFileNum
      );

      //重置表格
      this.ws = XLSX.utils.aoa_to_sheet([this.tableTitle]);
    },
    addSheetData(apiData, res) {
      //添加数据到表格 origin为每次添加数据从第几行开始
      XLSX.utils.sheet_add_json(this.ws, apiData, {
        skipHeader: true,
        origin:
          (this.currentPage - 1) * res.paginator.size -
          this.multiFileSize * this.multiFileNum +
          1,
      });
    },
    //导出所有数据到一个excel
    exportExcel(fileName, sheetName) {
      // 文件名称
      const filename = fileName;
      //Excel第一个sheet的名称
      const ws_name = sheetName;
      // 创建wokbook
      const wb = XLSX.utils.book_new();
      // 将数据添加到工作薄
      XLSX.utils.book_append_sheet(wb, this.ws, ws_name);
      // 导出文件
      XLSX.writeFile(wb, filename);
    },
  },
};
&lt;/script&gt;
</code></pre> 
<h4 id="%E8%B0%83%E7%94%A8%E7%A4%BA%E4%BE%8B%EF%BC%9A">调用示例：</h4> 
<p>App.vue</p> 
<pre><code class="language-javascript">&lt;template&gt;
  &lt;div&gt;
    &lt;h1&gt;测试表格导出&lt;/h1&gt;
    &lt;div&gt;
      &lt;ExportExcelComponent
        :tableTitleData="title"
        :asyncDataApi="asyncDataApi"
        :isCustom="isCustom"
        :listQuery="listQuery"
        ref="export"
        :filterFunction="handleDateFilter"
      &gt;
        &lt;template #custom&gt;
          &lt;!-- &lt;a-button type="primary" @click="handleClick"&gt;导出excel&lt;/a-button&gt; --&gt;
          &lt;a-dropdown-button&gt;
            Dropdown
            &lt;a-menu slot="overlay" @click="handleMenuClick"&gt;
              &lt;a-menu-item key="1"&gt;
                &lt;a-icon type="user" /&gt;1st menu item
              &lt;/a-menu-item&gt;
              &lt;a-menu-item key="2"&gt;
                &lt;a-icon type="user" /&gt;2nd menu item
              &lt;/a-menu-item&gt;
              &lt;a-menu-item key="3"&gt;
                &lt;a-icon type="user" /&gt;3rd item
              &lt;/a-menu-item&gt;
            &lt;/a-menu&gt;
          &lt;/a-dropdown-button&gt;
        &lt;/template&gt;
      &lt;/ExportExcelComponent&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
import ExportExcelComponent from "./ExportExcelComponent/ExportExcelComponent.vue";
import { asyncDataApi } from "./request";
import dayjs from "dayjs";
export default {
  data() {
    return {
      listQuery: {
        name: "yyy",
        age: 18,
      },
      isCustom: true,
      asyncDataApi: null,
      title: [
        { code: "id", title: "序号" },
        { code: "hobby", title: "爱好" },
        { code: "name", title: "姓名" },
        { code: "age", title: "年龄" },
        // { code: "hobby", title: "爱好" },
        { code: "sex", title: "性别" },
        { code: "address", title: "地址" },
        { code: "birthday", title: "生日" },
        { code: "createTime", title: "创建时间" },
        { code: "updateTime", title: "更新时间" },
        { code: "remark", title: "备注" },
        { code: "status", title: "状态" },
      ],
    };
  },
  methods: {
    handleDateFilter(data) {
      const res = data.reduce((pre, cur) =&gt; {
        for (let i in cur) {
          if (i === "createTime") {
            cur[i] = dayjs(cur[i] * 1000).format("YYYY-MM-DD HH:mm:ss");
          }
        }
        pre.push(cur);
        return pre;
      }, []);
      return res;
    },
    async handleMenuClick(val) {
      // const titleNewData = [];
      // for (let i = 1; i &lt; 500; i++) {
      //   this.title.forEach((item) =&gt; {
      //     titleNewData.push({ code: item.code + i, title: item.title + i });
      //   });
      // }
      // this.title = titleNewData;

      console.log("点击了导出excel", val);
      await (this.asyncDataApi = asyncDataApi);
      this.$refs.export.startExport();
    },
    // async handleClick() {
    //   console.log("点击了导出excel");
    //   await (this.asyncDataApi = asyncDataApi);
    //   this.$refs.export.startExport();
    // },
  },
  components: {
    ExportExcelComponent,
  },
};
&lt;/script&gt;</code></pre> 
<h4 id="mock%E6%95%B0%E6%8D%AE%3A">mock数据:</h4> 
<p>request.js</p> 
<pre><code class="language-javascript">const asyncDataApi = (listquery) =&gt; {
  console.log("params", listquery);
  // 模拟异步请求接口
  return new Promise((resolve, reject) =&gt; {
    setTimeout(() =&gt; {
      const data = [];

      for (let i = listquery.page * 100; i &lt; (listquery.page + 1) * 100; i++) {
        const obj = {
          id: i - 99,
          name: "姓名" + i,
          age: 20 + i,
          hobby:
            "赵客缦胡缨，吴钩霜雪明。银鞍照白马，飒沓如流星。十步杀一人，千里不留行。事了拂衣去，深藏身与名。闲过信陵饮，脱剑膝前横。将炙啖朱亥，持觞劝侯嬴。" +
            i,
          sex: "男" + i,
          birthday: "2020-01-01",
          createTime: "1701155392",
          updateTime: "2020-01-01",
          remark: "备注" + i,
          status: "1" + i,
        };

        // let newObj = {};
        // for (var a = 1; a &lt; 500; a++) {
        //   for (let k in obj) {
        //     newObj[k + a] = obj[k];
        //   }
        // }
        // data.push(newObj);
        data.push(obj);
      }

      resolve({
        data,
        code: 200,
        msg: "请求成功",
        paginator: {
          page: 1000,
          size: 100,
          total: 100000,
          currentPage: listquery.page,
        },
      });
    }, 100);
  });
};
export { asyncDataApi };
</code></pre> 
<h3 id="%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3">开发文档</h3> 
<h4 id="%E8%B0%83%E7%94%A8%E6%96%B9%E5%BC%8F%EF%BC%9A">调用方式：</h4> 
<p>如果不采用自定义dom的话，直接点击默认的按钮可直接导出表格数据； 如果采用自定义dom的话，通过ref实例调用子组件内的startExport方法，执行导出操作</p> 
<pre><code class="language-javascript">&lt;template&gt;
  &lt;ExportExcelComponent
    ...
    :isCustom = "true"
    :asyncDataApi="asyncDataApi"
    :tableTitleData="titles"
    ref="export"
  &gt;
    &lt;template #custom&gt;
        &lt;a-button type="primary" @click="handleClick"&gt;导出excel&lt;/a-button&gt;
    &lt;/template&gt;
  &lt;/ExportExcelComponent&gt;
&lt;/template&gt;
​
&lt;script&gt;
  import { asyncDataApi } from '@/api/member'
  export default{
    data(){
      return:{
        titles:[]
        asyncDataApi,
      }
    }
    methods:{
      handleClick(){
        this.$refs.export.startExport();
      }
    }
  }
&lt;/script&gt;</code></pre> 
<h4 id="API">API</h4> 
<p>属性如下</p> 
<table><thead><tr><th>参数</th><th>说明</th><th>类型</th><th>默认值</th></tr></thead><tbody><tr><td>listQuery</td><td>请求参数</td><td>Object</td><td>{}</td></tr><tr><td>asyncDataApi</td><td>请求数据的api函数</td><td>Function</td><td><strong>必传</strong></td></tr><tr><td>tableTitleData</td><td>导出的数据表的表头</td><td>Array</td><td><strong>必传</strong></td></tr><tr><td>isCustom</td><td>是否自定义dom,如果采用插槽，需要开启该属性，否则dom为默认button；可以传递 <code>v-slot:custom</code> 来自定义 dom。</td><td>Boolean</td><td>false</td></tr><tr><td>modelTitle</td><td>模态框标题</td><td>String</td><td>"导出excel"</td></tr><tr><td> <p>multiFileSize</p> </td><td>拆分成每个表多少条数据，需要搭配isSplit属性一起使用</td><td>Number</td><td>10e3</td></tr><tr><td>filename</td><td>导出的excel的表名</td><td>String</td><td>"Excel" + new Date().getTime()</td></tr><tr><td>ws_name</td><td>sheet名</td><td>String</td><td>"Sheet"</td></tr><tr><td>filterFunction</td><td>自定义过滤函数；可在业务层处理数据格式，如时间格式化等</td><td>Function(data)</td><td>null</td></tr></tbody></table> 
<h4 id="FAQ">FAQ</h4> 
<p id="filterFunction%E6%80%8E%E4%B9%88%E4%BD%BF%E7%94%A8"><strong>filterFunction怎么使用</strong></p> 
<pre><code class="language-javascript">&lt;template&gt;
  &lt;ExportExcelComponent
    ...
    :isCustom = "true"
    :asyncDataApi="asyncDataApi"
    :tableTitleData="titles"
    ref="export"
    :filterFunction="handleDateFilter"
  &gt;
    &lt;template #custom&gt;
        &lt;a-button type="primary" @click="handleClick"&gt;导出excel&lt;/a-button&gt;
    &lt;/template&gt;
  &lt;/ExportExcelComponent&gt;
&lt;/template&gt;
​
&lt;script&gt;
  import { asyncDataApi } from '@/api/member'
  export default{
    data(){
      return:{
        titles:[]
        asyncDataApi,
      }
    }
    methods:{
      handleDateFilter(data) {
       const res = data.reduce((pre, cur) =&gt; {
        for (let i in cur) {
          if (i === "createTime") {
            cur[i] = dayjs(cur[i] * 1000).format("YYYY-MM-DD HH:mm:ss");
            }
          }
          pre.push(cur);
          return pre;
        }, []);
        return res;
      },
      handleClick(){
        this.$refs.export.startExport();
      }
    }
  }
&lt;/script&gt;</code></pre> 
<p id="%E5%AF%BC%E5%87%BA%E8%A1%A8%E6%A0%BC%E6%95%B0%E6%8D%AE%E4%B8%BA%E7%A9%BA%E6%98%AF%E4%BB%80%E4%B9%88%E6%83%85%E5%86%B5%EF%BC%9F"><strong>导出表格数据为空是什么情况？</strong></p> 
<p>因为导出的表格数据的顺序和标题的顺序并不一定是一致的，所以在组件内部做了映射排序，一定要确保传入的标题数据在调用导出接口之前执行。如果传递的标题有误，在进行映射的时候，这时标题和表格数据并不匹配，那么就会出现数据映射为空的情况</p> 
<p id="Promise%20Error%EF%BC%9A%22asyncDataApi%20is%20required%22"><strong>Promise Error："asyncDataApi is required"</strong></p> 
<p>当传递给组件的后端api需要在点击dom后赋值再传递的时候，一定要确保在导入后端api之后再调用组件内的导出方法，否则因为后端api还没传递过去就调用，然后抛错或者导出异常</p> 
<p>正确示例：</p> 
<pre><code class="language-javascript">async handleClick() {
  await (this.asyncDataApi = asyncDataApi);
  this.$refs.export.getTableData();
},</code></pre> 
<p id="%E5%90%8E%E7%AB%AF%E5%AF%BC%E5%87%BA%E8%A1%A8%E6%A0%BCapi%E6%95%B0%E6%8D%AE%E8%BF%94%E5%9B%9E%E6%A0%BC%E5%BC%8F"><strong>后端导出表格api数据返回格式</strong></p> 
<p>因该组件为全局组件，方便以后复用，需与后端协商规定好数据导出的格式。以下为笔者的公司，与后端同事协商的数据格式。大家可根据自己公司需要，更改以上源码中后端返回值字段。</p> 
<pre><code class="language-javascript">//后端返回数据结构
{
    "status": true,
    "data": [
        {...},
        {...},
    ],
    "paginator": {
        "currentPage": 1,
        "total": 200,
        "size": 20,
        "page": 10
    }
}</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/503789bdc28bb77fb4c159df30baae71/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">同时使用磁吸充电器和Lightning时，iPhone充电速度会变快吗？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6be85beda3a75cc122ad16a0f70f5b64/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">故障：笔记本电脑更新系统后开机黑屏只剩鼠标</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>