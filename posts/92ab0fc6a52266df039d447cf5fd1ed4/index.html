<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Open3D 点云数据处理基础（Python版） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/92ab0fc6a52266df039d447cf5fd1ed4/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Open3D 点云数据处理基础（Python版）">
  <meta property="og:description" content="Open3D 点云数据处理基础（Python版）
文章目录 1 概述
2 安装
2.1 PyCharm 与 Python 安装
2.3 Anaconda 安装
2.4 Open3D 0.13.0 安装
2.5 新建一个 Python 项目
3 点云读写
4 点云可视化
2.1 可视化单个点云
2.2 同一窗口可视化多个点云
2.3 可视化的属性设置
5 k-d tree 与 Octree
5.1 k-d tree
5.2 Octree
5.2.1 从点云中构建Octree
5.2.2 从体素栅格中构建Octree
6 点云滤波
6.1 体素下采样
6.2 统计滤波
6.3 半径滤波
7 点云特征提取
7.1 法线估计
8 点云分割
8.1 DBSCAN 聚类分割
8.2 RANSAC 平面分割
8.3 隐藏点剔除">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-15T16:45:15+08:00">
    <meta property="article:modified_time" content="2024-04-15T16:45:15+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Open3D 点云数据处理基础（Python版）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/b0/99/aIoawg59_o.png" alt=""></p> 
<p>Open3D 点云数据处理基础（Python版）</p> 
<h4><a id="_4"></a>文章目录</h4> 
<ul><li> <p>1 概述</p> </li><li> <p>2 安装</p> </li><li> <p>2.1 PyCharm 与 Python 安装</p> </li><li> <p>2.3 Anaconda 安装</p> </li><li> <p>2.4 Open3D 0.13.0 安装</p> </li><li> <p>2.5 新建一个 Python 项目</p> </li><li> <p>3 点云读写</p> </li><li> <p>4 点云可视化</p> </li><li> <p>2.1 可视化单个点云</p> </li><li> <p>2.2 同一窗口可视化多个点云</p> </li><li> <p>2.3 可视化的属性设置</p> </li><li> <p>5 k-d tree 与 Octree</p> </li><li> <p>5.1 k-d tree</p> </li><li> <p>5.2 Octree</p> </li><li> <p>5.2.1 从点云中构建Octree</p> </li><li> <p>5.2.2 从体素栅格中构建Octree</p> </li><li> <p>6 点云滤波</p> </li><li> <p>6.1 体素下采样</p> </li><li> <p>6.2 统计滤波</p> </li><li> <p>6.3 半径滤波</p> </li><li> <p>7 点云特征提取</p> </li><li> <p>7.1 法线估计</p> </li><li> <p>8 点云分割</p> </li><li> <p>8.1 DBSCAN 聚类分割</p> </li><li> <p>8.2 RANSAC 平面分割</p> </li><li> <p>8.3 隐藏点剔除</p> </li><li> <p>9 点云曲面重建</p> </li><li> <p>9.1 Alpha shapes</p> </li><li> <p>9.2 Ball pivoting</p> </li><li> <p>9.3 Poisson surface reconstruction</p> </li><li> <p>9.3.1 直接读取点云的方法</p> </li><li> <p>9.3.2 mesh方法</p> </li><li> <p>10 点云空间变换</p> </li><li> <p>10.1 Translate 平移</p> </li><li> <p>10.1.1 指定平移行向量，实现点云平移</p> </li><li> <p>10.1.2 将点云质心平移到指定位置</p> </li><li> <p>10.2 Rotation 旋转</p> </li><li> <p>10.2.1 使用欧拉角旋转</p> </li><li> <p>10.2.1.1 未指定旋转中心</p> </li><li> <p>10.2.1.2 指定旋转中心</p> </li><li> <p>10.2.2 使用轴向角旋转</p> </li><li> <p>10.2.3 使用四元数旋转</p> </li><li> <p>10.3 Scale 缩放</p> </li><li> <p>10.4 General transformation 一般变换（平移+旋转）</p> </li><li> <p>11 点云配准</p> </li><li> <p>12 其他常用算法</p> </li><li> <p>12.1 计算点云间的距离</p> </li><li> <p>12.2 计算点云最小包围盒</p> </li><li> <p>12.3 计算点云凸包</p> </li><li> <p>12.4 点云体素化</p> </li><li> <p>12.4.1 一种简单的方法</p> </li><li> <p>12.1.2 复杂方法</p> </li><li> <p>12.5 计算点云质心</p> </li><li> <p>12.6 根据索引提取点云</p> </li><li> <p>12.7 点云赋色</p> </li></ul> 
<p>历时一个月，<strong>Open3D 点云数据处理基础（Python版）</strong> 终于初具雏形！目前主要是一些基础内容，后续会继续完善，希望互相学习！</p> 
<hr> 
<h3><a id="1__81"></a>1 概述</h3> 
<p>Open3D是一个开源库，支持快速开发处理3D数据的软件。Open3D后端是用C++实现的，经过高度优化并通过Python的前端接口公开。Open3D提供了三种数据结构：点云（point cloud）、网格（mesh）和RGB-D图像。对于每个表示，open3D都实现了一整套基本处理算法，如I/O、采样、可视化和数据转换。此外，还包括一些常用的算法，如法线估计、ICP配准等。</p> 
<p>open3D包含了九个模块，如下表所示：</p> 
<table><thead><tr><th>模块</th><th>功能</th></tr></thead><tbody><tr><td>Geometry 几何模块</td><td>数据结构和基本处理算法</td></tr><tr><td>Camera 相机模块</td><td>相机模型和相机轨迹</td></tr><tr><td>Odometry 里程计模块</td><td>RGB-D图像的跟踪与对齐</td></tr><tr><td>Registration 配准模块</td><td>全局和局部配准</td></tr><tr><td>Integration 积分模块</td><td>体积积分</td></tr><tr><td>I/O 输入输出模块</td><td>读写3维数据</td></tr><tr><td>Visualization 可视化模块</td><td>使用OpenGL呈现3D数据的可自定义GUI</td></tr><tr><td>Utility 辅助功能模块</td><td>辅助功能，如控制台输出、文件系统和特征包装器</td></tr><tr><td>Python 模块</td><td>Open3D Python绑定和教程</td></tr></tbody></table> 
<p>本文旨在快速入门Python点云数据处理，原理性知识会在后续专题中给出，这里不做过多描述。</p> 
<h3><a id="2__101"></a>2 安装</h3> 
<h4><a id="21_PyCharm__Python__103"></a>2.1 PyCharm 与 Python 安装</h4> 
<p><a href="https://blog.csdn.net/weixin_46098577/article/details/120589133?spm=1001.2014.3001.5501">PyCharm Community 2021.2 安装教程（附汉化教程！）</a></p> 
<h4><a id="23_Anaconda__107"></a>2.3 Anaconda 安装</h4> 
<p><a href="https://blog.csdn.net/weixin_46098577/article/details/120593057">Anaconda3 2021 安装教程</a></p> 
<h4><a id="24_Open3D_0130__111"></a>2.4 Open3D 0.13.0 安装</h4> 
<p>在成功安装 Anaconda3 之后，在所有应用中找到 Anaconda3，选择 Anaconda Powershell Prompt</p> 
<p><img src="https://images2.imgbox.com/8f/26/8dOklo9i_o.png" alt=""><br> 打开之后如下所示</p> 
<p><img src="https://images2.imgbox.com/2c/a4/eeSAQiAV_o.png" alt=""><br> 手动输入</p> 
<pre><code>pip install open3d
</code></pre> 
<p>开始安装 open3d-0.13.0，需要漫长的等待…</p> 
<p><img src="https://images2.imgbox.com/f9/01/uD50Mear_o.png" alt=""><br> 安装成功！</p> 
<p><img src="https://images2.imgbox.com/91/2b/OJY10z9a_o.png" alt=""></p> 
<h4><a id="25__Python__132"></a>2.5 新建一个 Python 项目</h4> 
<p>文件 &gt; 新建项目，输入（若路径不存在，则自动创建）或选择位置路径，选择已经由Conda配置好的解释器</p> 
<p><img src="https://images2.imgbox.com/f3/cf/RkcvCdWG_o.png" alt=""><br> 新建Python文件</p> 
<p><img src="https://images2.imgbox.com/b9/d5/9JhSWrdm_o.png" alt=""><br> 输入新建的Python文件名，按回车完成新建</p> 
<p><img src="https://images2.imgbox.com/71/fe/B19IFfiK_o.png" alt=""><br> 测试代码</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d 
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np 

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在加载点云... "</span><span class="token punctuation">)</span> 
pcd <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span><span class="token string">"test.pcd"</span><span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span>pcd<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在保存点云"</span><span class="token punctuation">)</span> 
o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>write_point_cloud<span class="token punctuation">(</span><span class="token string">"write.pcd"</span><span class="token punctuation">,</span> pcd<span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># 默认false，保存为Binarty；True 保存为ASICC形式 print(pcd)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c6/fd/Xkw2NFWR_o.png" alt=""></p> 
<h3><a id="3__157"></a>3 点云读写</h3> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d 
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np 

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在加载点云... "</span><span class="token punctuation">)</span> 
pcd <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span><span class="token string">"test.pcd"</span><span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span>pcd<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在保存点云"</span><span class="token punctuation">)</span> 
o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>write_point_cloud<span class="token punctuation">(</span><span class="token string">"write.pcd"</span><span class="token punctuation">,</span> pcd<span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># 默认false，保存为Binarty；True 保存为ASICC形式 print(pcd)</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云... 
PointCloud with 356478 points.
-&amp;gt;正在保存点云
PointCloud with 356478 points.
</code></pre> 
<p>默认情况下，Open3D尝试通过文件扩展名推断文件类型。支持以下点云文件类型：</p> 
<table><thead><tr><th>格式</th><th>描述</th></tr></thead><tbody><tr><td><code>xyz</code></td><td>每一行包含 <code>[x, y, z]</code>, 其中的<code>x</code>, <code>y</code>, <code>z</code> 是三维坐标</td></tr><tr><td><code>xyzn</code></td><td>每一行包含 <code>[x, y, z, nx, ny, nz]</code>, 其中的 <code>nx</code>, <code>ny</code>, <code>nz</code> 是法线向量</td></tr><tr><td><code>xyzrgb</code></td><td>每一行包含 <code>[x, y, z, r, g, b]</code>, 其中的 <code>r</code>, <code>g</code>, <code>b</code> 是范围在 <code>[0, 1]</code>的float类型</td></tr><tr><td><code>pts</code></td><td>第一行是表示点数的整数。每个后续行包含<code>[x, y, z, i, r, g, b]</code>, 其中的 <code>r</code>, <code>g</code>, <code>b</code> 是<code>uint8</code>类型</td></tr><tr><td><code>ply</code></td><td>查看 <a href="http://paulbourke.net/dataformats/ply" rel="nofollow">Polygon File Format</a>, ply文件能够同时包含点云和网格数据</td></tr><tr><td><code>pcd</code></td><td>查看 <a href="http://pointclouds.org/documentation/tutorials/pcd_file_format.html" rel="nofollow">Point Cloud Data</a></td></tr></tbody></table> 
<p>也可以显式地指定文件类型。在这种情况下，文件扩展名将被忽略。</p> 
<pre><code class="prism language-python">pcd <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span><span class="token string">"../../test_data/my_points.txt"</span><span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">'xyz'</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="4__197"></a>4 点云可视化</h3> 
<h4><a id="21__199"></a>2.1 可视化单个点云</h4> 
<p>代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d 
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np 

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在加载点云... "</span><span class="token punctuation">)</span> 
pcd <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span><span class="token string">"test.pcd"</span><span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span>pcd<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在可视化点云"</span><span class="token punctuation">)</span> 
o3d<span class="token punctuation">.</span>visualization<span class="token punctuation">.</span>draw_geometries<span class="token punctuation">(</span><span class="token punctuation">[</span>pcd<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云... 
PointCloud with 356478 points.
-&amp;gt;正在可视化点云
</code></pre> 
<p><strong>可视化结果展示：</strong></p> 
<p><img src="https://images2.imgbox.com/ae/1c/0CYdtQlC_o.png" alt=""></p> 
<p>可以通过键盘上的 <code>+</code>、<code>-</code>，实时调整点的大小。</p> 
<h4><a id="22__227"></a>2.2 同一窗口可视化多个点云</h4> 
<p><strong>函数描述：</strong></p> 
<p><code>o3d.visualization.draw_geometries([pcd1, pcd2, ... ,pcdn])</code></p> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d 
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np 

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在加载点云1... "</span><span class="token punctuation">)</span> 
pcd1 <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span><span class="token string">"bunny.pcd"</span><span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span>pcd1<span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在加载点云2..."</span><span class="token punctuation">)</span> 
pcd2 <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span><span class="token string">"bunny0.pcd"</span><span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span>pcd2<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在同时可视化两个点云..."</span><span class="token punctuation">)</span> 
o3d<span class="token punctuation">.</span>visualization<span class="token punctuation">.</span>draw_geometries<span class="token punctuation">(</span><span class="token punctuation">[</span>pcd1<span class="token punctuation">,</span> pcd2<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>输出结果：</p> 
<pre><code>-&amp;gt;正在加载点云1... 
PointCloud with 35947 points.
-&amp;gt;正在加载点云2...
PointCloud with 35947 points.
-&amp;gt;正在同时可视化两个点云...
</code></pre> 
<p>可视化结果：</p> 
<p><img src="https://images2.imgbox.com/cb/6f/u0I0AgzD_o.png" alt=""></p> 
<h4><a id="23__262"></a>2.3 可视化的属性设置</h4> 
<p><strong>函数原型1：</strong></p> 
<pre><code class="prism language-python">draw_geometries<span class="token punctuation">(</span>geometry_list<span class="token punctuation">,</span> window_name<span class="token operator">=</span><span class="token string">'Open3D'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">1920</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">1080</span><span class="token punctuation">,</span> left<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> top<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> point_show_normal<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> mesh_show_wireframe<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> mesh_show_back_face<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>参数说明</strong></p> 
<table><thead><tr><th>参数名</th><th>描述</th></tr></thead><tbody><tr><td><code>geometry_list</code></td><td>要可视化的几何体列表</td></tr><tr><td><code>window_name</code></td><td><code>(str, optional, default='Open3D')</code>，可视化窗口的显示标题</td></tr><tr><td><code>width</code></td><td><code>(int, optional, default=1920)</code>，可视化窗口的宽度</td></tr><tr><td><code>height</code></td><td><code>(int, optional, default=1080)</code>，可视化窗口的高度</td></tr><tr><td><code>left</code></td><td><code>(int, optional, default=50)</code>，可视化窗口的左边距</td></tr><tr><td><code>top</code></td><td><code>(int, optional, default=50)</code>，可视化窗口的顶部边距</td></tr><tr><td><code>point_show_normal</code></td><td><code>(bool, optional, default=False)</code>，如果设置为true，则可视化点法线，需要事先计算点云法线</td></tr><tr><td><code>mesh_show_wireframe</code></td><td><code>(bool, optional, default=False)</code>，如果设置为true，则可视化网格线框</td></tr><tr><td><code>mesh_show_back_face</code></td><td><code>(bool, optional, default=False)</code>，可视化网格三角形的背面</td></tr></tbody></table> 
<p><strong>函数原型2：</strong></p> 
<pre><code class="prism language-python">draw_geometries<span class="token punctuation">(</span>geometry_list<span class="token punctuation">,</span> window_name<span class="token operator">=</span><span class="token string">'Open3D'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">1920</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">1080</span><span class="token punctuation">,</span> left<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> top<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> point_show_normal<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> mesh_show_wireframe<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> mesh_show_back_face<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> lookat<span class="token punctuation">,</span> up<span class="token punctuation">,</span> front<span class="token punctuation">,</span> zoom<span class="token punctuation">)</span>
</code></pre> 
<p><strong>参数说明</strong></p> 
<table><thead><tr><th>参数名</th><th>描述</th></tr></thead><tbody><tr><td><code>geometry_list</code></td><td>要可视化的几何体列表</td></tr><tr><td><code>window_name</code></td><td><code>(str, optional, default='Open3D')</code>，可视化窗口的显示标题</td></tr><tr><td><code>width</code></td><td><code>(int, optional, default=1920)</code>，可视化窗口的宽度</td></tr><tr><td><code>height</code></td><td><code>(int, optional, default=1080)</code>，可视化窗口的高度</td></tr><tr><td><code>left</code></td><td><code>(int, optional, default=50)</code>，可视化窗口的左边距</td></tr><tr><td><code>top</code></td><td><code>(int, optional, default=50)</code>，可视化窗口的顶部边距</td></tr><tr><td><code>point_show_normal</code></td><td><code>(bool, optional, default=False)</code>，如果设置为true，则可视化点法线</td></tr><tr><td><code>mesh_show_wireframe</code></td><td><code>(bool, optional, default=False)</code>，如果设置为true，则可视化网格线框</td></tr><tr><td><code>mesh_show_back_face</code></td><td><code>(bool, optional, default=False)</code>，可视化网格三角形的背面</td></tr><tr><td><code>lookat</code></td><td><code>(numpy.ndarray[float64[3, 1]])</code>，相机的注视向量</td></tr><tr><td><code>up</code></td><td><code>(numpy.ndarray[float64[3, 1]])</code>，相机的上方向向量</td></tr><tr><td><code>front</code></td><td><code>(numpy.ndarray[float64[3, 1]])</code>，相机的前矢量</td></tr><tr><td><code>zoom</code></td><td><code>(float)</code>，相机的缩放倍数</td></tr></tbody></table> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在加载点云... "</span><span class="token punctuation">)</span> 
pcd <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span><span class="token string">"bunny.pcd"</span><span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span>pcd<span class="token punctuation">)</span>  <span class="token comment"># 法线估计 radius = 0.01 # 搜索半径 max_nn = 30 # 邻域内用于估算法线的最大点数 </span>
pcd<span class="token punctuation">.</span>estimate_normals<span class="token punctuation">(</span>search_param<span class="token operator">=</span>o3d<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>KDTreeSearchParamHybrid<span class="token punctuation">(</span>radius<span class="token punctuation">,</span> max_nn<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 执行法线估计 # 可视化 </span>
o3d<span class="token punctuation">.</span>visualization<span class="token punctuation">.</span>draw_geometries<span class="token punctuation">(</span><span class="token punctuation">[</span>pcd<span class="token punctuation">]</span><span class="token punctuation">,</span> window_name <span class="token operator">=</span> <span class="token string">"可视化参数设置"</span><span class="token punctuation">,</span> width <span class="token operator">=</span> <span class="token number">600</span><span class="token punctuation">,</span> height <span class="token operator">=</span> <span class="token number">450</span><span class="token punctuation">,</span> left <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">,</span> top <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">,</span> point_show_normal <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>可视化结果：</strong></p> 
<p><img src="https://images2.imgbox.com/47/42/moTHhHf0_o.png" alt=""></p> 
<h3><a id="5_kd_tree__Octree_323"></a>5 k-d tree 与 Octree</h3> 
<h4><a id="51_kd_tree_325"></a>5.1 k-d tree</h4> 
<ul><li><code>o3d.geometry.KDTreeFlann(pcd)</code>：建立 <code>KDTree</code></li><li><code>search_knn_vector_3d(search_Pt, k)</code>：K 近邻搜索</li><li><code>search_radius_vector_3d(search_Pt, radius)</code>：半径 R 近邻搜索</li><li><code>search_hybrid_vector_3d(search_pt, radius, max_nn)</code>：混合邻域搜索，返回半径 <code>radius</code> 内不超过 <code>max_nn</code> 个近邻点</li></ul> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d 
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在加载点云... "</span><span class="token punctuation">)</span> 
pcd <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span><span class="token string">"bunny.pcd"</span><span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span>pcd<span class="token punctuation">)</span> <span class="token comment"># 将点云设置为灰色 </span>
pcd<span class="token punctuation">.</span>paint_uniform_color<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 建立KDTree pcd_tree = o3d.geometry.KDTreeFlann(pcd) # 将第1500个点设置为紫色 </span>
pcd<span class="token punctuation">.</span>colors<span class="token punctuation">[</span><span class="token number">1500</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">]</span> <span class="token comment"># 使用K近邻，将第1500个点最近的5000个点设置为蓝色 </span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"使用K近邻，将第1500个点最近的5000个点设置为蓝色"</span><span class="token punctuation">)</span> 
k <span class="token operator">=</span> <span class="token number">5000</span> <span class="token comment"># 设置K的大小 </span>
<span class="token punctuation">[</span>num_k<span class="token punctuation">,</span> idx_k<span class="token punctuation">,</span> _<span class="token punctuation">]</span> <span class="token operator">=</span> pcd_tree<span class="token punctuation">.</span>search_knn_vector_3d<span class="token punctuation">(</span>pcd<span class="token punctuation">.</span>points<span class="token punctuation">[</span><span class="token number">1500</span><span class="token punctuation">]</span><span class="token punctuation">,</span> k<span class="token punctuation">)</span> <span class="token comment"># 返回邻域点的个数和索引 </span>
np<span class="token punctuation">.</span>asarray<span class="token punctuation">(</span>pcd<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">[</span>idx_k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment"># 跳过最近邻点（查询点本身）进行赋色 </span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"k邻域内的点数为："</span><span class="token punctuation">,</span> num_k<span class="token punctuation">)</span> <span class="token comment"># 使用半径R近邻，将第1500个点半径（0.02）范围内的点设置为红色 </span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"使用半径R近邻，将第1500个点半径（0.02）范围内的点设置为红色"</span><span class="token punctuation">)</span> 
radius <span class="token operator">=</span> <span class="token number">0.02</span> <span class="token comment"># 设置半径大小 </span>
<span class="token punctuation">[</span>num_radius<span class="token punctuation">,</span> idx_radius<span class="token punctuation">,</span> _<span class="token punctuation">]</span> <span class="token operator">=</span> pcd_tree<span class="token punctuation">.</span>search_radius_vector_3d<span class="token punctuation">(</span>pcd<span class="token punctuation">.</span>points<span class="token punctuation">[</span><span class="token number">1500</span><span class="token punctuation">]</span><span class="token punctuation">,</span> radius<span class="token punctuation">)</span> <span class="token comment"># 返回邻域点的个数和索引 </span>
np<span class="token punctuation">.</span>asarray<span class="token punctuation">(</span>pcd<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">[</span>idx_radius<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment"># 跳过最近邻点（查询点本身）进行赋色 </span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"半径r邻域内的点数为："</span><span class="token punctuation">,</span> num_radius<span class="token punctuation">)</span> <span class="token comment"># 使用混合邻域，将半径R邻域内不超过max_num个点设置为绿色 </span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"使用混合邻域，将第1500个点半径R邻域内不超过max_num个点设置为绿色"</span><span class="token punctuation">)</span> 
max_nn <span class="token operator">=</span> <span class="token number">200</span> <span class="token comment"># 半径R邻域内最大点数 </span>
<span class="token punctuation">[</span>num_hybrid<span class="token punctuation">,</span> idx_hybrid<span class="token punctuation">,</span> _<span class="token punctuation">]</span> <span class="token operator">=</span> pcd_tree<span class="token punctuation">.</span>search_hybrid_vector_3d<span class="token punctuation">(</span>pcd<span class="token punctuation">.</span>points<span class="token punctuation">[</span><span class="token number">1500</span><span class="token punctuation">]</span><span class="token punctuation">,</span> radius<span class="token punctuation">,</span> max_nn<span class="token punctuation">)</span> np<span class="token punctuation">.</span>asarray<span class="token punctuation">(</span>pcd<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">[</span>idx_hybrid<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment"># 跳过最近邻点（查询点本身）进行赋色 </span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"混合邻域内的点数为："</span><span class="token punctuation">,</span> num_hybrid<span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在可视化点云..."</span><span class="token punctuation">)</span> 
o3d<span class="token punctuation">.</span>visualization<span class="token punctuation">.</span>draw_geometries<span class="token punctuation">(</span><span class="token punctuation">[</span>pcd<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云... 
PointCloud with 35947 points.
使用K近邻，将第1500个点最近的5000个点设置为蓝色
k邻域内的点数为： 5000
使用半径R近邻，将第1500个点半径（0.02）范围内的点设置为红色
半径r邻域内的点数为： 751
使用混合邻域，将第1500个点半径R邻域内不超过max_num个点设置为绿色
混合邻域内的点数为： 200
-&amp;gt;正在可视化点云...
</code></pre> 
<p><strong>结果展示：</strong><br> <img src="https://images2.imgbox.com/f0/34/y7XXNEF2_o.png" alt=""></p> 
<h4><a id="52_Octree_377"></a>5.2 Octree</h4> 
<p>八叉树（Octree）是一种树数据结构，其中每个内部节点有八个子节点。八叉树通常用于三维点云的空间划分。八叉树的非空叶节点包含属于同一空间细分的一个或多个点。八叉树是三维空间的有用描述，可用于快速查找附近的点。Open3D具有几何体类型的八叉树，可用于创建、搜索和遍历具有用户指定的最大树深度的八叉树<code>max_depth</code>。</p> 
<h5><a id="521_Octree_381"></a>5.2.1 从点云中构建Octree</h5> 
<p>可以使用<code>convert_from_point_cloud</code>方法从点云构造八叉树。通过遵循从根节点到“最大深度”（depth max_depth）处的相应叶节点的路径，将每个点插入到树中。随着树深度的增加，内部（最终是叶子）节点表示三维空间的较小分区。</p> 
<p>如果点云具有颜色，则对应的叶节点将采用上次插入点的颜色。<code>size_expand</code>参数会增加根八叉树节点的大小，使其略大于原始点云边界以容纳所有点。</p> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d 
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token comment"># --------------------------- 加载点云 --------------------------- </span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在加载点云... "</span><span class="token punctuation">)</span> 
pcd <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span><span class="token string">"tree.pcd"</span><span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"原始点云："</span><span class="token punctuation">,</span> pcd<span class="token punctuation">)</span> <span class="token comment"># ============================================================== # ------------------------- 构建Octree -------------------------- </span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'octree 分割'</span><span class="token punctuation">)</span> 
octree <span class="token operator">=</span> o3d<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>Octree<span class="token punctuation">(</span>max_depth<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span> octree<span class="token punctuation">.</span>convert_from_point_cloud<span class="token punctuation">(</span>pcd<span class="token punctuation">,</span> size_expand<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在可视化Octree..."</span><span class="token punctuation">)</span> 
o3d<span class="token punctuation">.</span>visualization<span class="token punctuation">.</span>draw_geometries<span class="token punctuation">(</span><span class="token punctuation">[</span>octree<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># ==============================================================</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云... 
原始点云： PointCloud with 5746 points.
octree 分割
-&amp;gt;正在可视化Octree...
</code></pre> 
<p><strong>结果展示：</strong><br> <img src="https://images2.imgbox.com/fb/78/Le5No0nD_o.png" alt=""></p> 
<h5><a id="522_Octree_414"></a>5.2.2 从体素栅格中构建Octree</h5> 
<p>还可以使用<code>create_from_voxel_grid</code>的方法，从Open3D体素网格<code>VoxelGrid</code>几何体构建八叉树。每个体素被视为三维空间中的一个点，坐标对应于体素的原点。每个叶节点采用其相应体素的颜色。</p> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d 
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token comment"># --------------------------- 加载点云 --------------------------- </span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在加载点云... "</span><span class="token punctuation">)</span> 
pcd <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span><span class="token string">"tree.pcd"</span><span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"原始点云："</span><span class="token punctuation">,</span> pcd<span class="token punctuation">)</span> <span class="token comment"># ============================================================== # ------------------------- 构建Octree -------------------------- </span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'体素化'</span><span class="token punctuation">)</span> 
voxel_grid <span class="token operator">=</span> o3d<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>VoxelGrid<span class="token punctuation">.</span>create_from_point_cloud<span class="token punctuation">(</span>pcd<span class="token punctuation">,</span> voxel_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"体素："</span><span class="token punctuation">,</span> voxel_grid<span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"正在可视化体素..."</span><span class="token punctuation">)</span> 
o3d<span class="token punctuation">.</span>visualization<span class="token punctuation">.</span>draw_geometries<span class="token punctuation">(</span><span class="token punctuation">[</span>voxel_grid<span class="token punctuation">]</span><span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Octree 分割'</span><span class="token punctuation">)</span> 
octree <span class="token operator">=</span> o3d<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>Octree<span class="token punctuation">(</span>max_depth<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span> 
octree<span class="token punctuation">.</span>create_from_voxel_grid<span class="token punctuation">(</span>voxel_grid<span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Octree："</span><span class="token punctuation">,</span> octree<span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"正在可视化Octree..."</span><span class="token punctuation">)</span> 
o3d<span class="token punctuation">.</span>visualization<span class="token punctuation">.</span>draw_geometries<span class="token punctuation">(</span><span class="token punctuation">[</span>octree<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># ==============================================================</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云... 
原始点云： PointCloud with 5746 points.
体素化
体素： VoxelGrid with 861 voxels.
正在可视化体素...
Octree 分割
Octree： Octree with origin: [64.647, -54.2659, -20.2166], size: 7, max_depth: 4
正在可视化Octree...
</code></pre> 
<p><strong>可视化结果：</strong></p> 
<h3><a id="6__454"></a>6 点云滤波</h3> 
<h4><a id="61__456"></a>6.1 体素下采样</h4> 
<p>体素下采样使用规则体素栅格从输入点云创建均匀下采样点云。该算法分两步操作：</p> 
<ul><li>将点云进行进行体素划分</li><li>对所有非空体素，取体素内点云的质心作为该体素的点的位置。</li></ul> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d 
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np 

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在加载点云... "</span><span class="token punctuation">)</span> 
pcd <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span><span class="token string">"test.pcd"</span><span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span>pcd<span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在可视化原始点云"</span><span class="token punctuation">)</span> 
o3d<span class="token punctuation">.</span>visualization<span class="token punctuation">.</span>draw_geometries<span class="token punctuation">(</span><span class="token punctuation">[</span>pcd<span class="token punctuation">]</span><span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在体素下采样..."</span><span class="token punctuation">)</span> 
voxel_size <span class="token operator">=</span> <span class="token number">0.5</span> 
downpcd <span class="token operator">=</span> pcd<span class="token punctuation">.</span>voxel_down_sample<span class="token punctuation">(</span>voxel_size<span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span>downpcd<span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在可视化下采样点云"</span><span class="token punctuation">)</span> 
o3d<span class="token punctuation">.</span>visualization<span class="token punctuation">.</span>draw_geometries<span class="token punctuation">(</span><span class="token punctuation">[</span>downpcd<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云... 
PointCloud with 356478 points.
-&amp;gt;正在可视化原始点云
-&amp;gt;正在体素下采样...
PointCloud with 11141 points.
-&amp;gt;正在可视化下采样点云
</code></pre> 
<p><strong>可视化展示：</strong></p> 
<h4><a id="62__495"></a>6.2 统计滤波</h4> 
<p><code>statistical_outlier_removal</code> 会移除距离相邻点更远的点。它需要两个输入参数：</p> 
<ul><li><code>num_neighbors</code>，指定为了计算给定点的平均距离，需要考虑多少个邻居。即K邻域的点数</li><li><code>std_ratio</code>，允许根据点云平均距离的标准偏差设置阈值水平。该数值越低，滤除的点数就越多</li></ul> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在加载点云... "</span><span class="token punctuation">)</span> pcd <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span><span class="token string">"desk.pcd"</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"原始点云："</span><span class="token punctuation">,</span> pcd<span class="token punctuation">)</span> <span class="token comment"># ------------------------- 统计滤波 -------------------------- print("-&gt;正在进行统计滤波...") num_neighbors = 20 # K邻域点的个数 std_ratio = 2.0 # 标准差乘数 # 执行统计滤波，返回滤波后的点云sor_pcd和对应的索引ind sor_pcd, ind = pcd.remove_statistical_outlier(num_neighbors, std_ratio) sor_pcd.paint_uniform_color([0, 0, 1]) print("统计滤波后的点云：", sor_pcd) sor_pcd.paint_uniform_color([0, 0, 1]) # 提取噪声点云 sor_noise_pcd = pcd.select_by_index(ind,invert = True) print("噪声点云：", sor_noise_pcd) sor_noise_pcd.paint_uniform_color([1, 0, 0]) # =========================================================== # 可视化统计滤波后的点云和噪声点云 o3d.visualization.draw_geometries([sor_pcd, sor_noise_pcd])</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云... 
原始点云： PointCloud with 41049 points.
-&amp;gt;正在进行统计滤波...
统计滤波后的点云： PointCloud with 40061 points.
噪声点云： PointCloud with 988 points.
</code></pre> 
<p><strong>可视化结果：</strong></p> 
<p><img src="https://images2.imgbox.com/03/8e/KbxGQkMi_o.png" alt=""></p> 
<h4><a id="63__522"></a>6.3 半径滤波</h4> 
<p><code>radius_outlier_removal</code> 移除给定球体中几乎没有邻居的点。需要两个参数：</p> 
<p><code>num_points</code>，邻域球内的最少点数，低于该值的点为噪声点</p> 
<p><code>radius</code> ，邻域半径的大小</p> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在加载点云... "</span><span class="token punctuation">)</span> pcd <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span><span class="token string">"desk.pcd"</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"原始点云："</span><span class="token punctuation">,</span> pcd<span class="token punctuation">)</span> <span class="token comment"># ------------------------- 半径滤波 -------------------------- print("-&gt;正在进行半径滤波...") num_points = 20 # 邻域球内的最少点数，低于该值的点为噪声点 radius = 0.05 # 邻域半径大小 # 执行半径滤波，返回滤波后的点云sor_pcd和对应的索引ind sor_pcd, ind = pcd.remove_radius_outlier(num_points, radius) sor_pcd.paint_uniform_color([0, 0, 1]) print("半径滤波后的点云：", sor_pcd) sor_pcd.paint_uniform_color([0, 0, 1]) # 提取噪声点云 sor_noise_pcd = pcd.select_by_index(ind,invert = True) print("噪声点云：", sor_noise_pcd) sor_noise_pcd.paint_uniform_color([1, 0, 0]) # =========================================================== # 可视化半径滤波后的点云和噪声点云 o3d.visualization.draw_geometries([sor_pcd, sor_noise_pcd])</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云... 
原始点云： PointCloud with 41049 points.
-&amp;gt;正在进行半径滤波...
半径滤波后的点云： PointCloud with 40146 points.
噪声点云： PointCloud with 903 points.
</code></pre> 
<p><strong>可视化结果：</strong><br> <img src="https://images2.imgbox.com/4f/b1/kJICPvZE_o.png" alt=""></p> 
<h3><a id="7__549"></a>7 点云特征提取</h3> 
<h4><a id="71__551"></a>7.1 法线估计</h4> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在加载点云... "</span><span class="token punctuation">)</span> pcd <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span><span class="token string">"bunny.pcd"</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>pcd<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在估计法线并可视化..."</span><span class="token punctuation">)</span> radius <span class="token operator">=</span> <span class="token number">0.01</span> <span class="token comment"># 搜索半径 max_nn = 30 # 邻域内用于估算法线的最大点数 pcd.estimate_normals(search_param=o3d.geometry.KDTreeSearchParamHybrid(radius, max_nn)) # 执行法线估计 o3d.visualization.draw_geometries([pcd], point_show_normal=True) print("-&gt;正在打印前10个点的法向量...") print(np.asarray(pcd.normals)[:10, :])</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云... 
PointCloud with 35947 points.
-&amp;gt;正在估计法线并可视化...
-&amp;gt;正在打印前10个点的法向量...
[[-0.22344398 -0.96962557  0.09949394]
 [-0.30282456 -0.91827757  0.25507564]
 [-0.0930339  -0.77633579 -0.62341594]
 [ 0.06452443 -0.96881599 -0.23923249]
 [ 0.24771039 -0.96349484  0.10157387]
 [ 0.1890532  -0.97541781  0.11322096]
 [-0.26920394 -0.95010988  0.15754506]
 [ 0.72941317  0.51298568  0.45255067]
 [ 0.83949302  0.5402317   0.05831961]
 [-0.32325253  0.62920765  0.7068278 ]]
</code></pre> 
<p><strong>可视化结果：</strong><br> <img src="https://images2.imgbox.com/50/df/VfU8b2Lr_o.png" alt=""></p> 
<h3><a id="8__581"></a>8 点云分割</h3> 
<h4><a id="81_DBSCAN__583"></a>8.1 DBSCAN 聚类分割</h4> 
<p>Open3D实现了DBSCAN[1996]，这是一种基于密度的聚类算法。该算法在<code>cluster_dbscan</code>中实现，需要两个参数：<code>eps</code> 为同一簇内的最大点间距，<code>min_points</code> 定义有效聚类的最小点数。函数返回标签 <code>label</code>，其中<code>label = -1</code>表示噪声。</p> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在加载点云... "</span><span class="token punctuation">)</span> pcd <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span><span class="token string">"test.pcd"</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>pcd<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在DBSCAN聚类..."</span><span class="token punctuation">)</span> eps <span class="token operator">=</span> <span class="token number">0.5</span> <span class="token comment"># 同一聚类中最大点间距 min_points = 50 # 有效聚类的最小点数 with o3d.utility.VerbosityContextManager(o3d.utility.VerbosityLevel.Debug) as cm: labels = np.array(pcd.cluster_dbscan(eps, min_points, print_progress=True)) max_label = labels.max() # 获取聚类标签的最大值 [-1,0,1,2,...,max_label]，label = -1 为噪声，因此总聚类个数为 max_label + 1 print(f"point cloud has {max_label + 1} clusters") colors = plt.get_cmap("tab20")(labels / (max_label if max_label &gt; 0 else 1)) colors[labels &lt; 0] = 0 # labels = -1 的簇为噪声，以黑色显示 pcd.colors = o3d.utility.Vector3dVector(colors[:, :3]) o3d.visualization.draw_geometries([pcd])</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云... 
PointCloud with 356478 points.
-&amp;gt;正在DBSCAN聚类...
[Open3D DEBUG] Precompute neighbors.
[Open3D DEBUG] Done Precompute neighbors.
[Open3D DEBUG] Compute Clusters
Precompute neighbors.[========================================] 100%
[Open3D DEBUG] Done Compute Clusters: 49
point cloud has 49 clusters
</code></pre> 
<p><strong>可视化结果：</strong><br> <img src="https://images2.imgbox.com/47/94/qIHIcckA_o.png" alt=""></p> 
<h4><a id="82_RANSAC__610"></a>8.2 RANSAC 平面分割</h4> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在加载点云... "</span><span class="token punctuation">)</span> pcd <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span><span class="token string">"test.pcd"</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>pcd<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在RANSAC平面分割..."</span><span class="token punctuation">)</span> distance_threshold <span class="token operator">=</span> <span class="token number">0.2</span> <span class="token comment"># 内点到平面模型的最大距离 ransac_n = 3 # 用于拟合平面的采样点数 num_iterations = 1000 # 最大迭代次数 # 返回模型系数plane_model和内点索引inliers，并赋值 plane_model, inliers = pcd.segment_plane(distance_threshold, ransac_n, num_iterations) # 输出平面方程 [a, b, c, d] = plane_model print(f"Plane equation: {a:.2f}x + {b:.2f}y + {c:.2f}z + {d:.2f} = 0") # 平面内点点云 inlier_cloud = pcd.select_by_index(inliers) inlier_cloud.paint_uniform_color([0, 0, 1.0]) print(inlier_cloud) # 平面外点点云 outlier_cloud = pcd.select_by_index(inliers, invert=True) outlier_cloud.paint_uniform_color([1.0, 0, 0]) print(outlier_cloud) # 可视化平面分割结果 o3d.visualization.draw_geometries([inlier_cloud, outlier_cloud])</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云... 
PointCloud with 356478 points.
-&amp;gt;正在RANSAC平面分割...
Plane equation: -0.00x + -0.00y + 1.00z + -0.27 = 0
PointCloud with 241099 points.
PointCloud with 115379 points.
</code></pre> 
<p><strong>可视化结果：</strong><br> <img src="https://images2.imgbox.com/e8/8f/vVkjAWhY_o.png" alt=""></p> 
<h4><a id="83__632"></a>8.3 隐藏点剔除</h4> 
<p>假设您希望从给定的视点渲染点云，但背景中的点会泄漏到前景中，因为它们不会被其他点遮挡。为此，我们可以应用隐藏点移除算法。在Open3D中，实现了[Katz2007] 的方法，该方法从给定视图近似点云的可见性，无需曲面重建或法线估计。</p> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在加载点云... "</span><span class="token punctuation">)</span> pcd <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span><span class="token string">"bunny.pcd"</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>pcd<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在剔除隐藏点..."</span><span class="token punctuation">)</span> diameter <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>np<span class="token punctuation">.</span>asarray<span class="token punctuation">(</span>pcd<span class="token punctuation">.</span>get_max_bound<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> np<span class="token punctuation">.</span>asarray<span class="token punctuation">(</span>pcd<span class="token punctuation">.</span>get_min_bound<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"定义隐藏点去除的参数"</span><span class="token punctuation">)</span> camera <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> diameter<span class="token punctuation">]</span> <span class="token comment"># 视点位置 radius = diameter * 100 # 噪声点云半径,The radius of the sperical projection _, pt_map = pcd.hidden_point_removal(camera, radius) # 获取视点位置能看到的所有点的索引 pt_map # 可视点点云 pcd_visible = pcd.select_by_index(pt_map) pcd_visible.paint_uniform_color([0, 0, 1]) # 可视点为蓝色 print("-&gt;可视点个数为：", pcd_visible) # 隐藏点点云 pcd_hidden = pcd.select_by_index(pt_map, invert = True) pcd_hidden.paint_uniform_color([1, 0, 0]) # 隐藏点为红色 print("-&gt;隐藏点个数为：", pcd_hidden) print("-&gt;正在可视化可视点和隐藏点点云...") o3d.visualization.draw_geometries([pcd_visible, pcd_hidden])</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云... 
PointCloud with 35947 points.
-&amp;gt;正在剔除隐藏点...
定义隐藏点去除的参数
-&amp;gt;可视点个数为： PointCloud with 11490 points.
-&amp;gt;正在可视化可视点和隐藏点点云...
</code></pre> 
<p><strong>可视化结果：</strong><br> <img src="https://images2.imgbox.com/f1/cb/DCmgsuqw_o.png" alt=""><br> <strong>函数原型：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">hidden_point_removal</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> camera_location<span class="token punctuation">,</span> radius<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># real signature unknown; restored from __doc__ """ hidden_point_removal(self, camera_location, radius) Removes hidden points from a point cloud and returns a mesh of the remaining points. Based on Katz et al. 'Direct Visibility of Point Sets', 2007. Additional information about the choice of radius for noisy point clouds can be found in Mehra et. al. 'Visibility of Noisy Point Cloud Data', 2010. Args: camera_location (numpy.ndarray[float64[3, 1]]): All points not visible from that location will be reomved radius (float): The radius of the sperical projection Returns: Tuple[open3d.geometry.TriangleMesh, List[int]] """ pass</span>
</code></pre> 
<h3><a id="9__661"></a>9 点云曲面重建</h3> 
<p>在许多情况下，我们希望生成密集的三维几何体，即三角形网格。然而，从多视图立体方法或深度传感器中，我们只能获得非结构化点云。要从非结构化输入中获得三角形网格，我们需要执行曲面重建。文献中有几种方法，Open3D目前实现了以下功能：</p> 
<ul><li>Alpha shapes [<a href="http://www.open3d.org/docs/latest/tutorial/reference.html#Edelsbrunner1983" rel="nofollow">Edelsbrunner1983]</a></li><li>Ball pivoting [<a href="http://www.open3d.org/docs/latest/tutorial/reference.html#Bernardini1999" rel="nofollow">Bernardini1999]</a></li><li>Poisson surface reconstruction [<a href="http://www.open3d.org/docs/latest/tutorial/reference.html#Kazhdan2006" rel="nofollow">Kazhdan2006]</a></li></ul> 
<h4><a id="91_Alpha_shapes_669"></a>9.1 Alpha shapes</h4> 
<p><code>Alpha shapes</code> 是凸壳的推广。正如这里所描述的，我们可以直观地认为<code>Alpha shapes</code>如下：想象一个巨大的冰淇淋，其中包含点<code>S</code>作为硬巧克力块。使用其中一个球形冰淇淋勺，我们可以在不撞到巧克力块的情况下雕刻出冰淇淋块的所有部分，从而甚至在内部雕刻出孔（例如，仅从外部移动勺子无法触及的部分）。我们最终将得到一个（不一定是凸的）对象，该对象以帽、弧和点为边界。如果我们现在把所有的面拉直成三角形和线段，我们就可以直观地描述<code>S</code>的<code>Alpha shapes</code>。</p> 
<p>Open3D实现了 <code>create_from_point_cloud_alpha_shape</code> 方法</p> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token comment"># --------------------------- 加载点云 --------------------------- print("-&gt;正在加载点云... ") pcd = o3d.io.read_point_cloud("bunny.pcd") print("原始点云：", pcd) # ============================================================== # ------------------------- Alpha shapes ----------------------- alpha = 0.03 print(f"alpha={alpha:.3f}") mesh = o3d.geometry.TriangleMesh.create_from_point_cloud_alpha_shape(pcd, alpha) mesh.compute_vertex_normals() o3d.visualization.draw_geometries([mesh], mesh_show_back_face=True) # ==============================================================</span>
</code></pre> 
<p><strong>可视化结果：</strong></p> 
<h4><a id="92_Ball_pivoting_683"></a>9.2 Ball pivoting</h4> 
<p><code>Ball pivoting</code>（BPA）[Bernardini1999]是一种与<code>Alpha shapes</code>相关的曲面重建方法。直观地说，想象一个具有给定半径的3D球，我们将其落在点云上。如果它击中任何3个点（并且没有穿过这3个点），它将创建一个三角形。然后，该算法从现有三角形的边开始旋转，每当它击中球未落下的3个点时，我们创建另一个三角形。</p> 
<p>open3D 对应的函数为 <code>create_from_point_cloud_ball_pivoting</code></p> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token comment"># ---------------------- 定义点云体素化函数 ---------------------- def get_mesh(_relative_path): mesh = o3d.io.read_triangle_mesh(_relative_path) mesh.compute_vertex_normals() return mesh # ============================================================= # ------------------------- Ball pivoting -------------------------- print("-&gt;Ball pivoting...") _relative_path = "bunny.ply" # 设置相对路径 N = 2000 # 将点划分为N个体素 pcd = get_mesh(_relative_path).sample_points_poisson_disk(N) o3d.visualization.draw_geometries([pcd]) radii = [0.005, 0.01, 0.02, 0.04] rec_mesh = o3d.geometry.TriangleMesh.create_from_point_cloud_ball_pivoting(pcd, o3d.utility.DoubleVector(radii)) o3d.visualization.draw_geometries([pcd, rec_mesh]) # ==============================================================</span>
</code></pre> 
<p><strong>可视化结果：</strong></p> 
<h4><a id="93_Poisson_surface_reconstruction_697"></a>9.3 Poisson surface reconstruction</h4> 
<p>泊松曲面重建方法[Kazhdan2006]解决了一个正则化优化问题，以获得光滑曲面。因此，泊松曲面重建比上述方法更可取，因为它们会产生非平滑结果，因为点云的点也是生成的三角形网格的顶点，无需任何修改。</p> 
<p>Open3D对应的方法为 <code>create_from_point_cloud_poisson</code>，这基本上是Kazhdan代码的包装。该函数的一个重要参数是<code>depth</code>，它定义了用于曲面重建的八叉树的深度，因此表示生成的三角形网格的分辨率。<code>depth</code>值越高，网格的细节就越多。</p> 
<h5><a id="931__703"></a>9.3.1 直接读取点云的方法</h5> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token comment"># --------------------------- 加载点云 --------------------------- print("-&gt;正在加载点云... ") pcd = o3d.io.read_point_cloud("bunny.pcd") print("原始点云：", pcd) # ============================================================== # ------------------------- Ball pivoting -------------------------- print('run Poisson surface reconstruction') radius = 0.001 # 搜索半径 max_nn = 30 # 邻域内用于估算法线的最大点数 pcd.estimate_normals(search_param=o3d.geometry.KDTreeSearchParamHybrid(radius, max_nn)) # 执行法线估计 with o3d.utility.VerbosityContextManager(o3d.utility.VerbosityLevel.Debug) as cm: mesh, densities = o3d.geometry.TriangleMesh.create_from_point_cloud_poisson(pcd, depth=12) print(mesh) o3d.visualization.draw_geometries([mesh]) # ==============================================================</span>
</code></pre> 
<p><strong>可视化结果：</strong><br> <img src="https://images2.imgbox.com/3d/cc/3vTdRmTU_o.png" alt=""></p> 
<h5><a id="932_mesh_714"></a>9.3.2 mesh方法</h5> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token comment"># -------------------------- 定义点云体素化函数 --------------------------- def get_mesh(_relative_path): mesh = o3d.io.read_triangle_mesh(_relative_path) mesh.compute_vertex_normals() return mesh # ===================================================================== # -------------------- Poisson surface reconstruction ------------------ # 加载点云 print("-&gt;Poisson surface reconstruction...") _relative_path = "bunny.ply" # 设置相对路径 N = 5000 # 将点划分为N个体素 pcd = get_mesh(_relative_path).sample_points_poisson_disk(N) pcd.normals = o3d.utility.Vector3dVector(np.zeros((1, 3))) # 使现有法线无效 # 法线估计 pcd.estimate_normals() o3d.visualization.draw_geometries([pcd], point_show_normal=True) pcd.orient_normals_consistent_tangent_plane(100) o3d.visualization.draw_geometries([pcd], point_show_normal=True) # 泊松重建 print('run Poisson surface reconstruction') with o3d.utility.VerbosityContextManager( o3d.utility.VerbosityLevel.Debug) as cm: mesh, densities = o3d.geometry.TriangleMesh.create_from_point_cloud_poisson( pcd, depth=9) print(mesh) o3d.visualization.draw_geometries([mesh]) # =====================================================================</span>
</code></pre> 
<p><strong>可视化结果：</strong></p> 
<h3><a id="10__724"></a>10 点云空间变换</h3> 
<p>Open3D的几何体类型有多种转换方法。下面将介绍如何使用<code>taranslate</code>平移、<code>rotate</code>旋转、<code>scale</code>缩放和<code>transform</code>变换（旋转+平移）。</p> 
<h4><a id="101_Translate__728"></a>10.1 Translate 平移</h4> 
<p>我们要研究的第一种转换方法是<code>translate</code>。该函数接受两个输入参数：</p> 
<ul><li>第一个输入参数为一个三维行向量<code>(tx,ty,tz)</code></li><li>第二个参数为布尔值，默认<code>relative = True</code>，实现点云平移。若设置为<code>relative = False</code>，则将点云质心平移到第一个参数指定的位置</li></ul> 
<pre><code class="prism language-python">pcd<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token punctuation">(</span>tx<span class="token punctuation">,</span>ty<span class="token punctuation">,</span>tz<span class="token punctuation">)</span><span class="token punctuation">,</span>relative<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="1011__739"></a>10.1.1 指定平移行向量，实现点云平移</h5> 
<p>只输入第一个参数，或者将第二个参数设置为<code>relative = True</code>或<code>True</code>，<code>relative</code>可以省略</p> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> copy <span class="token comment"># 点云深拷贝 import open3d as o3d # -------------------------- 加载点云 ------------------------ print("-&gt;正在加载点云... ") pcd = o3d.io.read_point_cloud("bunny.pcd") print(pcd) print(f'pcd质心：{pcd.get_center()}') # =========================================================== # -------------------------- 点云平移 ------------------------ print("\n-&gt;沿X轴平移0.2m") pcd_tx = copy.deepcopy(pcd).translate((0.2, 0, 0)) pcd_tx.paint_uniform_color([1, 0, 0]) print(pcd_tx) print(f'pcd_tx质心：{pcd_tx.get_center()}') print("\n-&gt;沿Y轴平移0.2m") pcd_ty = copy.deepcopy(pcd_tx).translate((0, 0.2, 0)) pcd_ty.paint_uniform_color([0, 1, 0]) print(pcd_ty) print(f'pcd_ty质心：{pcd_ty.get_center()}') print("\n-&gt;沿X轴平移-0.2m，再沿Y轴平移0.2m") pcd_txy = copy.deepcopy(pcd).translate((-0.2, 0.2, 0)) pcd_txy.paint_uniform_color([0, 0, 1]) print(pcd_txy) print('pcd_txy质心：', pcd_txy.get_center()) # =========================================================== # -------------------------- 可视化 -------------------------- o3d.visualization.draw_geometries([pcd, pcd_tx, pcd_ty, pcd_txy]) # ===========================================================</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云... 
PointCloud with 35947 points.
pcd质心：[-0.02675991  0.09521606  0.00894711]

-&amp;gt;沿X轴平移0.2m
PointCloud with 35947 points.
pcd_tx质心：[0.17324009 0.09521606 0.00894711]

-&amp;gt;沿Y轴平移0.2m
PointCloud with 35947 points.
pcd_ty质心：[0.17324009 0.29521606 0.00894711]

-&amp;gt;沿X轴平移-0.2m，再沿Y轴平移0.2m
PointCloud with 35947 points.
pcd_txy质心： [-0.22675991  0.29521606  0.00894711]
</code></pre> 
<p><strong>结果展示：</strong></p> 
<p><img src="https://images2.imgbox.com/53/07/dJvzV6r2_o.png" alt=""></p> 
<h5><a id="1012__773"></a>10.1.2 将点云质心平移到指定位置</h5> 
<p>将第二个参数<code>relative</code>设置为<code>False</code>即可。</p> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> copy <span class="token comment"># 点云深拷贝 import open3d as o3d # -------------------------- 加载点云 ------------------------ print("-&gt;正在加载点云... ") pcd = o3d.io.read_point_cloud("bunny.pcd") print(pcd) print(f'pcd质心：{pcd.get_center()}') # =========================================================== # -------------------------- 点云平移 ------------------------ print("\n-&gt;沿X轴平移0.2m") pcd_tx = copy.deepcopy(pcd).translate((0.2, 0.2, 0.2)) pcd_tx.paint_uniform_color([1, 0, 0]) print(pcd_tx) print(f'pcd_tx质心：{pcd_tx.get_center()}') print("\n-&gt;将点云质心平移到指定位置") pcd_new = copy.deepcopy(pcd_tx).translate((0.2, 0.2, 0.2),relative=False) #pcd_new = copy.deepcopy(pcd_tx).translate((0.2, 0.2, 0.2),False) # relative 可以省略 pcd_new.paint_uniform_color([0, 1, 0]) print(pcd_new) print(f'pcd_new：{pcd_new.get_center()}') # =========================================================== # -------------------------- 可视化 -------------------------- o3d.visualization.draw_geometries([pcd, pcd_tx, pcd_new]) # ===========================================================</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云... 
PointCloud with 35947 points.
pcd质心：[-0.02675991  0.09521606  0.00894711]

-&amp;gt;沿X轴平移0.2m
PointCloud with 35947 points.
pcd_tx质心：[0.17324009 0.29521606 0.20894711]

-&amp;gt;将点云质心平移到指定位置
PointCloud with 35947 points.
pcd_new：[0.2 0.2 0.2]
</code></pre> 
<p><strong>结果展示：</strong></p> 
<p><img src="https://images2.imgbox.com/6d/dc/m5CK7IUC_o.png" alt=""></p> 
<h4><a id="102_Rotation__803"></a>10.2 Rotation 旋转</h4> 
<p>Open3D使用<code>rotate</code>进行旋转，接受两个输入参数：</p> 
<ol><li> <p>第一个参数是旋转矩阵<code>R</code>。由于3D中的旋转可以通过多种方式进行参数化，Open3D提供了方便的功能，可以将不同的参数化转换为旋转矩阵：</p> </li><li> <p>使用<code>get_rotation_matrix_from_xyz</code>从欧拉角 <a href="https://en.wikipedia.org/wiki/Euler_angles" rel="nofollow">Euler angles</a> 中转换（其中，<code>xyz</code>也可以是<code>yzx</code>, <code>zxy</code>, <code>xzy</code>, <code>zyx</code>, 和<code>yxz</code>的形式）</p> </li><li> <p>使用<code>get_rotation_matrix_from_axis_angle</code>从轴角表示法 <a href="https://en.wikipedia.org/wiki/Axis%E2%80%93angle_representation" rel="nofollow">Axis-angle representation</a> 中转换</p> </li><li> <p>使用<code>get_rotation_matrix_from_quaternion</code>从四参数 <a href="https://en.wikipedia.org/wiki/Quaternion" rel="nofollow">Quaternions</a> 中转换</p> </li><li> <p>第二个参数<code>center</code>，若不设置，则围绕点云质心旋转，<strong>旋转前后点云质心位置不变</strong>。</p> </li></ol> 
<pre><code class="prism language-python">pcd<span class="token punctuation">.</span>rotate<span class="token punctuation">(</span>R<span class="token punctuation">)</span> <span class="token comment"># 不指定旋转中心</span>
</code></pre> 
<p>若指定<code>center</code>，则整个点云围绕指定的坐标中心<code>(x,y,z)</code>旋转。<strong>旋转前后点云质心位置发生改变</strong>。</p> 
<pre><code class="prism language-python">pcd<span class="token punctuation">.</span>rotate<span class="token punctuation">(</span>R<span class="token punctuation">,</span>center<span class="token operator">=</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 指定旋转中心</span>
</code></pre> 
<h5><a id="1021__825"></a>10.2.1 使用欧拉角旋转</h5> 
<h6><a id="10211__827"></a>10.2.1.1 未指定旋转中心</h6> 
<p>未指定旋转中心，默认以点云质心为旋转中心，旋转前后点云执行不变。</p> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> copy <span class="token comment"># 点云深拷贝 import open3d as o3d import numpy as np # -------------------------- 加载点云 ------------------------ print("-&gt;正在加载点云... ") pcd = o3d.io.read_point_cloud("bunny.pcd") print(pcd) pcd.paint_uniform_color([1,0,0]) print("-&gt;pcd质心：",pcd.get_center()) # =========================================================== # -------------------------- 点云旋转 ------------------------ print("\n-&gt;采用欧拉角进行点云旋转") pcd_EulerAngle = copy.deepcopy(pcd) R1 = pcd.get_rotation_matrix_from_xyz((0,np.pi/2,0)) print("旋转矩阵：\n",R1) pcd_EulerAngle.rotate(R1) # 不指定旋转中心 pcd_EulerAngle.paint_uniform_color([0,0,1]) print("\n-&gt;pcd_EulerAngle质心：",pcd_EulerAngle.get_center()) # =========================================================== # -------------------------- 可视化 -------------------------- o3d.visualization.draw_geometries([pcd, pcd_EulerAngle]) # ===========================================================</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云... 
PointCloud with 35947 points.
-&amp;gt;pcd质心： [-0.02675991  0.09521606  0.00894711]

-&amp;gt;采用欧拉角进行点云旋转
旋转矩阵：
 [[ 6.123234e-17  0.000000e+00  1.000000e+00]
 [ 0.000000e+00  1.000000e+00  0.000000e+00]
 [-1.000000e+00  0.000000e+00  6.123234e-17]]

-&amp;gt;pcd_EulerAngle质心： [-0.02675991  0.09521606  0.00894711]
</code></pre> 
<p><strong>结果展示：</strong></p> 
<p><img src="https://images2.imgbox.com/6f/b2/yxYTvIqm_o.png" alt=""></p> 
<h6><a id="10212__857"></a>10.2.1.2 指定旋转中心</h6> 
<p>指定旋转中心，旋转前后点云质心改变。</p> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> copy <span class="token comment"># 点云深拷贝 import open3d as o3d import numpy as np # -------------------------- 加载点云 ------------------------ print("-&gt;正在加载点云... ") pcd = o3d.io.read_point_cloud("bunny.pcd") print(pcd) pcd.paint_uniform_color([1,0,0]) print("-&gt;pcd质心：",pcd.get_center()) # =========================================================== # -------------------------- 点云旋转 ------------------------ print("\n-&gt;采用欧拉角进行点云旋转") pcd_EulerAngle = copy.deepcopy(pcd) R1 = pcd.get_rotation_matrix_from_xyz((0,np.pi/2,0)) print("旋转矩阵：\n",R1) pcd_EulerAngle.rotate(R1,center = (0.1,0.1,0.1)) # 指定旋转中心 pcd_EulerAngle.paint_uniform_color([0,0,1]) print("\n-&gt;pcd_EulerAngle质心：",pcd_EulerAngle.get_center()) # =========================================================== # -------------------------- 可视化 -------------------------- o3d.visualization.draw_geometries([pcd, pcd_EulerAngle]) # ===========================================================</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云... 
PointCloud with 35947 points.
-&amp;gt;pcd质心： [-0.02675991  0.09521606  0.00894711]

-&amp;gt;采用欧拉角进行点云旋转
旋转矩阵：
 [[ 6.123234e-17  0.000000e+00  1.000000e+00]
 [ 0.000000e+00  1.000000e+00  0.000000e+00]
 [-1.000000e+00  0.000000e+00  6.123234e-17]]

-&amp;gt;pcd_EulerAngle质心： [0.00894711 0.09521606 0.22675991]
</code></pre> 
<p><strong>结果展示：</strong></p> 
<p><img src="https://images2.imgbox.com/6f/8a/S0Bu3pyX_o.png" alt=""></p> 
<h5><a id="1022__887"></a>10.2.2 使用轴向角旋转</h5> 
<h5><a id="1023__889"></a>10.2.3 使用四元数旋转</h5> 
<h4><a id="103_Scale__891"></a>10.3 Scale 缩放</h4> 
<p>使用<code>rotate</code>函数实现点云缩放，接受两个输入参数：</p> 
<ul><li>缩放倍数</li><li>缩放后点云质心<code>center</code>，不可省略。</li></ul> 
<pre><code class="prism language-python">pcd_scale<span class="token punctuation">.</span>rotate<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>center<span class="token operator">=</span>pcd<span class="token punctuation">.</span>get_center<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 缩放前后质心一致</span>
</code></pre> 
<pre><code class="prism language-python">pcd_scale<span class="token punctuation">.</span>rotate<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>center<span class="token operator">=</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 缩放后质心为(x,y,z)</span>
</code></pre> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> copy <span class="token comment"># 点云深拷贝 import open3d as o3d import numpy as np # -------------------------- 加载点云 ------------------------ print("-&gt;正在加载点云... ") pcd = o3d.io.read_point_cloud("circle.pcd") print(pcd) pcd.paint_uniform_color([1,0,0]) print("-&gt;pcd质心：",pcd.get_center()) # =========================================================== # -------------------------- 点云缩放 ------------------------ print("\n-&gt;点云缩放") pcd_scale1 = copy.deepcopy(pcd) pcd_scale1.scale(1.5,center=pcd.get_center()) pcd_scale1.paint_uniform_color([0,0,1]) print("-&gt;pcd_scale1质心：",pcd_scale1.get_center()) # 缩放前后质心不变 pcd_scale2 = copy.deepcopy(pcd) pcd_scale2.scale(0.5,center=(1,1,1)) # 自定义缩放后的质心 pcd_scale2.paint_uniform_color([0,1,0]) print("-&gt;pcd_scale2质心：",pcd_scale2.get_center()) # =========================================================== # -------------------------- 可视化 -------------------------- o3d.visualization.draw_geometries([pcd, pcd_scale1,pcd_scale2]) # ===========================================================</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云... 
PointCloud with 63 points.
-&amp;gt;pcd质心： [1.01066824 1.99955513 0.        ]

-&amp;gt;点云缩放
-&amp;gt;pcd_scale1质心： [1.01066824 1.99955513 0.        ]
-&amp;gt;pcd_scale2质心： [1.00533412 1.49977756 0.5       ]
</code></pre> 
<p><strong>结果展示：</strong><br> <img src="https://images2.imgbox.com/dc/f1/NbpOJwdv_o.png" alt=""></p> 
<h4><a id="104_General_transformation__927"></a>10.4 General transformation 一般变换（平移+旋转）</h4> 
<p>使用<code>transform</code>实现点云的一般变换，接受1个输入参数，为4×4变换矩阵，前3行3列为旋转矩阵，第4列前3行为平移向量。</p> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> copy <span class="token comment"># 点云深拷贝 import open3d as o3d import numpy as np # -------------------------- 加载点云 ------------------------ print("-&gt;正在加载点云... ") pcd = o3d.io.read_point_cloud("circle.pcd") print(pcd) pcd.paint_uniform_color([1,0,0]) print("-&gt;pcd质心：",pcd.get_center()) # =========================================================== # -------------------------- transform ------------------------ print("\n-&gt;点云的一般变换") pcd_T = copy.deepcopy(pcd) T = np.eye(4) T[ :3, :3] = pcd.get_rotation_matrix_from_xyz((np.pi/6,np.pi/4,0)) # 旋转矩阵 T[0,3] = 5.0 # 平移向量的dx T[1,3] = 3.0 # 平移向量的dy print("\n-&gt;变换矩阵：\n",T) pcd_T.transform(T) pcd_T.paint_uniform_color([0,0,1]) print("\n-&gt;pcd_scale1质心：",pcd_T.get_center()) # =========================================================== # -------------------------- 可视化 -------------------------- o3d.visualization.draw_geometries([pcd, pcd_T]) # ===========================================================</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云... 
PointCloud with 63 points.
-&amp;gt;pcd质心： [1.01066824 1.99955513 0.        ]

-&amp;gt;点云的一般变换

-&amp;gt;变换矩阵：
 [[ 0.70710678  0.          0.70710678  5.        ]
 [ 0.35355339  0.8660254  -0.35355339  3.        ]
 [-0.61237244  0.5         0.61237244  0.        ]
 [ 0.          0.          0.          1.        ]]

-&amp;gt;pcd_scale1质心： [5.71465037 5.08899072 0.38087219]
</code></pre> 
<p><strong>结果展示：</strong></p> 
<p><img src="https://images2.imgbox.com/ad/77/EqvYMCXn_o.png" alt=""></p> 
<h3><a id="11__959"></a>11 点云配准</h3> 
<h3><a id="12__961"></a>12 其他常用算法</h3> 
<h4><a id="121__963"></a>12.1 计算点云间的距离</h4> 
<p><strong>函数介绍：</strong></p> 
<p>Open3D提供了<code>compute_point_cloud_distance</code>方法来计算从源点云到目标点云的距离。它为源点云中的每个点计算到目标点云中最近点的距离。</p> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在加载点云1... "</span><span class="token punctuation">)</span> pcd1 <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span><span class="token string">"bunny.pcd"</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>pcd1<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在加载点云2..."</span><span class="token punctuation">)</span> pcd2 <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span><span class="token string">"test.pcd"</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>pcd2<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在点云1每一点到点云2的最近距离..."</span><span class="token punctuation">)</span> dists <span class="token operator">=</span> pcd1<span class="token punctuation">.</span>compute_point_cloud_distance<span class="token punctuation">(</span>pcd2<span class="token punctuation">)</span> dists <span class="token operator">=</span> np<span class="token punctuation">.</span>asarray<span class="token punctuation">(</span>dists<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在打印前10个点..."</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>dists<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在提取距离大于3.56的点"</span><span class="token punctuation">)</span> ind <span class="token operator">=</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>dists <span class="token operator">&gt;</span> <span class="token number">3.56</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> pcd3 <span class="token operator">=</span> pcd1<span class="token punctuation">.</span>select_by_index<span class="token punctuation">(</span>ind<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>pcd3<span class="token punctuation">)</span> o3d<span class="token punctuation">.</span>visualization<span class="token punctuation">.</span>draw_geometries<span class="token punctuation">(</span><span class="token punctuation">[</span>pcd3<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云1... 
PointCloud with 35947 points.
-&amp;gt;正在加载点云2...
PointCloud with 356478 points.
-&amp;gt;正在点云1每一点到点云2的最近距离...
-&amp;gt;正在打印前10个点...
[3.56774778 3.57472048 3.58922401 3.53018802 3.55273519 3.55542831
 3.56749706 3.49795738 3.49527627 3.55416983]
-&amp;gt;正在提取距离大于3.56的点
PointCloud with 19935 points.
</code></pre> 
<p><strong>可视化结果：</strong><br> <img src="https://images2.imgbox.com/fb/1a/kYpT2t2R_o.png" alt=""></p> 
<h4><a id="122__993"></a>12.2 计算点云最小包围盒</h4> 
<p><strong>函数介绍：</strong></p> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在加载点云... "</span><span class="token punctuation">)</span> pcd <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span><span class="token string">"bunny.pcd"</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>pcd<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在计算点云轴向最小包围盒..."</span><span class="token punctuation">)</span> aabb <span class="token operator">=</span> pcd<span class="token punctuation">.</span>get_axis_aligned_bounding_box<span class="token punctuation">(</span><span class="token punctuation">)</span> aabb<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在计算点云最小包围盒..."</span><span class="token punctuation">)</span> obb <span class="token operator">=</span> pcd<span class="token punctuation">.</span>get_oriented_bounding_box<span class="token punctuation">(</span><span class="token punctuation">)</span> obb<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> o3d<span class="token punctuation">.</span>visualization<span class="token punctuation">.</span>draw_geometries<span class="token punctuation">(</span><span class="token punctuation">[</span>pcd<span class="token punctuation">,</span> aabb<span class="token punctuation">,</span> obb<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云... 
PointCloud with 35947 points.
-&amp;gt;正在计算点云轴向最小包围盒...
-&amp;gt;正在计算点云最小包围盒...
</code></pre> 
<p><strong>可视化结果：</strong></p> 
<p><img src="https://images2.imgbox.com/dc/d7/QGylEM4v_o.png" alt=""></p> 
<h4><a id="123__1016"></a>12.3 计算点云凸包</h4> 
<p>点云的凸包是包含所有点的最小凸集。Open3D 包含计算点云凸包的 <code>compute_convex_hull</code> 方法。该实现基于Qhull。</p> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在加载点云... "</span><span class="token punctuation">)</span> pcd <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span><span class="token string">"bunny.pcd"</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>pcd<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在计算点云凸包..."</span><span class="token punctuation">)</span> hull<span class="token punctuation">,</span> _ <span class="token operator">=</span> pcd<span class="token punctuation">.</span>compute_convex_hull<span class="token punctuation">(</span><span class="token punctuation">)</span> hull_ls <span class="token operator">=</span> o3d<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>LineSet<span class="token punctuation">.</span>create_from_triangle_mesh<span class="token punctuation">(</span>hull<span class="token punctuation">)</span> hull_ls<span class="token punctuation">.</span>paint_uniform_color<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> o3d<span class="token punctuation">.</span>visualization<span class="token punctuation">.</span>draw_geometries<span class="token punctuation">(</span><span class="token punctuation">[</span>pcd<span class="token punctuation">,</span> hull_ls<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云... 
PointCloud with 35947 points.
-&amp;gt;正在计算点云凸包...
</code></pre> 
<p><strong>可视化结果：</strong><br> <img src="https://images2.imgbox.com/86/73/Q4Ig7ccJ_o.png" alt=""></p> 
<h4><a id="124__1037"></a>12.4 点云体素化</h4> 
<h5><a id="1241__1039"></a>12.4.1 一种简单的方法</h5> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token comment"># --------------------------- 加载点云 --------------------------- print("-&gt;正在加载点云... ") pcd = o3d.io.read_point_cloud("bunny.ply") print("原始点云：", pcd) # ============================================================== # --------------------------- 体素化点云 ------------------------- print('执行体素化点云') voxel_grid = o3d.geometry.VoxelGrid.create_from_point_cloud(pcd, voxel_size=0.005) print("正在可视化体素...") o3d.visualization.draw_geometries([voxel_grid]) # ==============================================================</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云... 
原始点云： PointCloud with 35947 points.
执行体素化点云
正在可视化体素...
</code></pre> 
<p><strong>可视化结果：</strong></p> 
<p><img src="https://images2.imgbox.com/cd/56/AEzC5mQt_o.png" alt=""></p> 
<h5><a id="1212__1060"></a>12.1.2 复杂方法</h5> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token comment"># ---------------------- 定义点云体素化函数 ---------------------- def get_mesh(_relative_path): mesh = o3d.io.read_triangle_mesh(_relative_path) mesh.compute_vertex_normals() return mesh # ============================================================= # ------------------------- 点云体素化 -------------------------- print("-&gt;正在进行点云体素化...") _relative_path = "bunny.ply" # 设置相对路径 N = 2000 # 将点划分为N个体素 pcd = get_mesh(_relative_path).sample_points_poisson_disk(N) # fit to unit cube pcd.scale(1 / np.max(pcd.get_max_bound() - pcd.get_min_bound()), center=pcd.get_center()) pcd.colors = o3d.utility.Vector3dVector(np.random.uniform(0, 1, size=(N, 3))) print("体素下采样点云：", pcd) print("正在可视化体素下采样点云...") o3d.visualization.draw_geometries([pcd]) print('执行体素化点云') voxel_grid = o3d.geometry.VoxelGrid.create_from_point_cloud(pcd, voxel_size=0.05) print("正在可视化体素...") o3d.visualization.draw_geometries([voxel_grid]) # ===========================================================</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在进行点云体素化...
体素下采样点云： PointCloud with 2000 points.
正在可视化体素下采样点云...
执行体素化点云
正在可视化体素...
</code></pre> 
<p><strong>可视化结果：</strong></p> 
<p><strong><code>get_mesh</code> 函数参考代码*：</strong></p> 
<p><code>open3d_tutorial.py</code></p> 
<pre><code class="prism language-python"><span class="token comment"># Helpers and monkey patches for ipynb tutorials import open3d as o3d import numpy as np import PIL.Image import IPython.display import os import urllib import tarfile import gzip import zipfile import shutil interactive = True def jupyter_draw_geometries( geoms, window_name="Open3D", width=1920, height=1080, left=50, top=50, point_show_normal=False, mesh_show_wireframe=False, mesh_show_back_face=False, lookat=None, up=None, front=None, zoom=None, ): vis = o3d.visualization.Visualizer() vis.create_window( window_name=window_name, width=width, height=height, left=left, top=top, visible=True, # If false, capture_screen_float_buffer() won't work. ) vis.get_render_option().point_show_normal = point_show_normal vis.get_render_option().mesh_show_wireframe = mesh_show_wireframe vis.get_render_option().mesh_show_back_face = mesh_show_back_face for geom in geoms: vis.add_geometry(geom) if lookat is not None: vis.get_view_control().set_lookat(lookat) if up is not None: vis.get_view_control().set_up(up) if front is not None: vis.get_view_control().set_front(front) if zoom is not None: vis.get_view_control().set_zoom(zoom) if interactive: vis.run() else: for geom in geoms: vis.update_geometry(geom) vis.poll_events() vis.update_renderer() im = vis.capture_screen_float_buffer() vis.destroy_window() im = (255 * np.asarray(im)).astype(np.uint8) IPython.display.display(PIL.Image.fromarray(im, "RGB")) o3d.visualization.draw_geometries = jupyter_draw_geometries def edges_to_lineset(mesh, edges, color): ls = o3d.geometry.LineSet() ls.points = mesh.vertices ls.lines = edges colors = np.empty((np.asarray(edges).shape[0], 3)) colors[:] = color ls.colors = o3d.utility.Vector3dVector(colors) return ls def _relative_path(path): script_path = os.path.realpath(__file__) script_dir = os.path.dirname(script_path) return os.path.join(script_dir, path) def download_fountain_dataset(): fountain_path = _relative_path("../TestData/fountain_small") fountain_zip_path = _relative_path("../TestData/fountain.zip") if not os.path.exists(fountain_path): print("downloading fountain dataset") url = "https://storage.googleapis.com/isl-datasets/open3d-dev/fountain.zip" urllib.request.urlretrieve(url, fountain_zip_path) print("extract fountain dataset") with zipfile.ZipFile(fountain_zip_path, "r") as zip_ref: zip_ref.extractall(os.path.dirname(fountain_path)) os.remove(fountain_zip_path) return fountain_path def get_non_manifold_edge_mesh(): verts = np.array( [[-1, 0, 0], [0, 1, 0], [1, 0, 0], [0, -1, 0], [0, 0, 1]], dtype=np.float64, ) triangles = np.array([[0, 1, 3], [1, 2, 3], [1, 3, 4]]) mesh = o3d.geometry.TriangleMesh() mesh.vertices = o3d.utility.Vector3dVector(verts) mesh.triangles = o3d.utility.Vector3iVector(triangles) mesh.compute_vertex_normals() mesh.rotate( mesh.get_rotation_matrix_from_xyz((np.pi / 4, 0, np.pi / 4)), center=mesh.get_center(), ) return mesh def get_non_manifold_vertex_mesh(): verts = np.array( [ [-1, 0, -1], [1, 0, -1], [0, 1, -1], [0, 0, 0], [-1, 0, 1], [1, 0, 1], [0, 1, 1], ], dtype=np.float64, ) triangles = np.array([ [0, 1, 2], [0, 1, 3], [1, 2, 3], [2, 0, 3], [4, 5, 6], [4, 5, 3], [5, 6, 3], [4, 6, 3], ]) mesh = o3d.geometry.TriangleMesh() mesh.vertices = o3d.utility.Vector3dVector(verts) mesh.triangles = o3d.utility.Vector3iVector(triangles) mesh.compute_vertex_normals() mesh.rotate( mesh.get_rotation_matrix_from_xyz((np.pi / 4, 0, np.pi / 4)), center=mesh.get_center(), ) return mesh def get_open_box_mesh(): mesh = o3d.geometry.TriangleMesh.create_box() mesh.triangles = o3d.utility.Vector3iVector(np.asarray(mesh.triangles)[:-2]) mesh.compute_vertex_normals() mesh.rotate( mesh.get_rotation_matrix_from_xyz((0.8 * np.pi, 0, 0.66 * np.pi)), center=mesh.get_center(), ) return mesh def get_intersecting_boxes_mesh(): mesh0 = o3d.geometry.TriangleMesh.create_box() T = np.eye(4) T[:, 3] += (0.5, 0.5, 0.5, 0) mesh1 = o3d.geometry.TriangleMesh.create_box() mesh1.transform(T) mesh = mesh0 + mesh1 mesh.compute_vertex_normals() mesh.rotate( mesh.get_rotation_matrix_from_xyz((0.7 * np.pi, 0, 0.6 * np.pi)), center=mesh.get_center(), ) return mesh def get_armadillo_mesh(): armadillo_path = _relative_path("../TestData/Armadillo.ply") if not os.path.exists(armadillo_path): print("downloading armadillo mesh") url = "http://graphics.stanford.edu/pub/3Dscanrep/armadillo/Armadillo.ply.gz" urllib.request.urlretrieve(url, armadillo_path + ".gz") print("extract armadillo mesh") with gzip.open(armadillo_path + ".gz", "rb") as fin: with open(armadillo_path, "wb") as fout: shutil.copyfileobj(fin, fout) os.remove(armadillo_path + ".gz") mesh = o3d.io.read_triangle_mesh(armadillo_path) mesh.compute_vertex_normals() return mesh def get_bunny_mesh(): bunny_path = _relative_path("../TestData/Bunny.ply") if not os.path.exists(bunny_path): print("downloading bunny mesh") url = "http://graphics.stanford.edu/pub/3Dscanrep/bunny.tar.gz" urllib.request.urlretrieve(url, bunny_path + ".tar.gz") print("extract bunny mesh") with tarfile.open(bunny_path + ".tar.gz") as tar: tar.extractall(path=os.path.dirname(bunny_path)) shutil.move( os.path.join( os.path.dirname(bunny_path), "bunny", "reconstruction", "bun_zipper.ply", ), bunny_path, ) os.remove(bunny_path + ".tar.gz") shutil.rmtree(os.path.join(os.path.dirname(bunny_path), "bunny")) mesh = o3d.io.read_triangle_mesh(bunny_path) mesh.compute_vertex_normals() return mesh def get_knot_mesh(): mesh = o3d.io.read_triangle_mesh(_relative_path("../TestData/knot.ply")) mesh.compute_vertex_normals() return mesh def get_eagle_pcd(): path = _relative_path("../TestData/eagle.ply") if not os.path.exists(path): print("downloading eagle pcl") url = "http://www.cs.jhu.edu/~misha/Code/PoissonRecon/eagle.points.ply" urllib.request.urlretrieve(url, path) pcd = o3d.io.read_point_cloud(path) return pcd</span>
</code></pre> 
<h4><a id="125__1088"></a>12.5 计算点云质心</h4> 
<p>使用<code>get_center()</code> 实现点云质心计算</p> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在加载点云... "</span><span class="token punctuation">)</span> pcd <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span><span class="token string">"tree.pcd"</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>pcd<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'pcd质心：</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>pcd<span class="token punctuation">.</span>get_center<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云... 
PointCloud with 5746 points.
pcd质心：[ 66.36420378 -52.42476729 -15.28512276]
</code></pre> 
<p><strong><a href="https://blog.csdn.net/weixin_46098577/article/details/119981408">pcl点云质心计算结果</a>：</strong></p> 
<pre><code>-&amp;gt;点云质心为：(66.3642, -52.4248, -15.2851)
</code></pre> 
<h4><a id="126__1112"></a>12.6 根据索引提取点云</h4> 
<p><strong>函数原型：</strong></p> 
<pre><code class="prism language-python">select_by_index<span class="token punctuation">(</span>self<span class="token punctuation">,</span> indices<span class="token punctuation">,</span> invert<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在加载点云... "</span><span class="token punctuation">)</span> pcd <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span><span class="token string">"desk.pcd"</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>pcd<span class="token punctuation">)</span> <span class="token triple-quoted-string string">"""------------------- 根据索引提取点云 --------------------"""</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在根据索引提取点云..."</span><span class="token punctuation">)</span> idx <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">20000</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 生成 从0到19999的列表 # 索引对应的点云（内点） inlier_pcd = pcd.select_by_index(idx) inlier_pcd.paint_uniform_color([1, 0, 0]) print("内点点云：", inlier_pcd) # 索引外的点云（外点） outlier_pcd = pcd.select_by_index(idx, invert=True) # 对索引取反 outlier_pcd.paint_uniform_color([0, 1, 0]) print("外点点云：", outlier_pcd) o3d.visualization.draw_geometries([inlier_pcd, outlier_pcd]) """========================================================"""</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云... 
PointCloud with 41049 points.
-&amp;gt;正在根据索引提取点云...
内点点云： PointCloud with 20000 points.
外点点云： PointCloud with 21049 points.
</code></pre> 
<p><strong>可视化结果：</strong><br> <img src="https://images2.imgbox.com/9c/9a/b0XF8Jo9_o.png" alt=""></p> 
<p><strong>源码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">select_by_index</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> indices<span class="token punctuation">,</span> invert<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># real signature unknown; restored from __doc__ """ select_by_index(self, indices, invert=False) Function to select points from input pointcloud into output pointcloud. Args: indices (List[int]): Indices of points to be selected. invert (bool, optional, default=False): Set to ``True`` to invert the selection of indices. Returns: open3d.geometry.PointCloud """ pass</span>
</code></pre> 
<h4><a id="127__1145"></a>12.7 点云赋色</h4> 
<p><strong>赋色函数：</strong></p> 
<p><code>paint_uniform_color</code> ：将点云进行单一颜色赋值，为RGB颜色空间，R、G、B分量的范围为[0,1]，注意不是[0,255]</p> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> open3d <span class="token keyword">as</span> o3d <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在加载点云... "</span><span class="token punctuation">)</span> pcd <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span><span class="token string">"bunny.pcd"</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>pcd<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在点云赋色..."</span><span class="token punctuation">)</span> pcd<span class="token punctuation">.</span>paint_uniform_color<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0.706</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在可视化赋色后的点云..."</span><span class="token punctuation">)</span> o3d<span class="token punctuation">.</span>visualization<span class="token punctuation">.</span>draw_geometries<span class="token punctuation">(</span><span class="token punctuation">[</span>pcd<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-&gt;正在保存赋色后的点云"</span><span class="token punctuation">)</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>write_point_cloud<span class="token punctuation">(</span><span class="token string">"color.pcd"</span><span class="token punctuation">,</span> pcd<span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># 默认false，保存为Binarty；True 保存为ASICC形式</span>
</code></pre> 
<p><strong>输出结果：</strong></p> 
<pre><code>-&amp;gt;正在加载点云... 
PointCloud with 35947 points.
-&amp;gt;正在点云赋色...
-&amp;gt;正在可视化赋色后的点云...
-&amp;gt;正在保存赋色后的点云
</code></pre> 
<p><strong>可视化结果：</strong></p> 
<p><img src="https://images2.imgbox.com/51/1f/vI0GIi7r_o.png" alt=""></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e0dcba4c574c8e1aa3f9dccc20ccde75/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">密钥交换算法 之 DH/ECDH/ECDHE原理与Python实现</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dd7d81c9e95b5d4b509b9e275a80f0ce/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Python 大麦抢票脚本</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>