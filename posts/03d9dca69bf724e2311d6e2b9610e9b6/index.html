<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>前端大文件分片上传解决方案（看这一篇就够了） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/03d9dca69bf724e2311d6e2b9610e9b6/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="前端大文件分片上传解决方案（看这一篇就够了）">
  <meta property="og:description" content="文章目录 概要整体架构流程具体实现一，分片下载之本地储存（localForage）前言：二，本地数据获取（获取下载列表）二，操作JS1，下载进度监听2，文件下载状态控制3，分片下载 二，VUE页面 小结 概要 本文从前端方面出发实现浏览器下载大文件的功能。不考虑网络异常、关闭网页等原因造成传输中断的情况。分片下载采用串行方式（并行下载需要对切片计算hash，比对hash，丢失重传，合并chunks的时候需要按顺序合并等，很麻烦。对传输速度有追求的，并且在带宽允许的情况下可以做并行分片下载）
整体架构流程 1， 使用分片下载： 将大文件分割成多个小块进行下载，可以降低内存占用和网络传输中断的风险。这样可以避免一次性下载整个大文件造成的性能问题。
2， 断点续传： 实现断点续传功能，即在下载中途中断后，可以从已下载的部分继续下载，而不需要重新下载整个文件。
3， 进度条显示： 在页面上展示下载进度，让用户清晰地看到文件下载的进度。如果一次全部下载可以从process中直接拿到参数计算得出（很精细），如果是分片下载，也是计算已下载的和总大小，只不过已下载的会成片成片的增加（不是很精细）。
4， 取消下载和暂停下载功能： 提供取消下载和暂停下载的按钮，让用户可以根据需要中止或暂停下载过程。
5， 合并文件： 下载完成后，将所有分片文件合并成一个完整的文件。
具体实现 一，分片下载之本地储存（localForage） 前言： 浏览器的安全策略禁止网页（JS）直接访问和操作用户计算机上的文件系统。
在分片下载过程中，每个下载的文件块（chunk）都需要在客户端进行缓存或存储，方便实现断点续传功能，同时也方便后续将这些文件块合并成完整的文件。这些文件块可以暂时保存在内存中或者存储在客户端的本地存储（如 IndexedDB、LocalStorage 等）中。
使用封装，直接上代码：
import axios from &#39;axios&#39;; import ElementUI from &#39;element-ui&#39; import Vue from &#39;vue&#39; import localForage from &#39;localforage&#39; import streamSaver from &#39;streamsaver&#39;; import store from &#34;@/store/index&#34; /** * localforage–是一个高效而强大的离线存储方案。 * 它封装了IndexedDB, WebSQL, or localStorage，并且提供了一个简化的类似localStorage的API。 * 在默认情况下会优先采用使用IndexDB、WebSQL、localStorage进行后台存储， * 即浏览器不支持IndexDB时尝试采用WebSQL，既不支持IndexDB又不支持WebSQL时采用 * localStorage来进行存储。 * */ /** * @description 创建数据库实例，创建并返回一个 localForage 的新实例。每个实例对象都有独立的数据库，而不会影响到其他实例 * @param {Object} dataBase 数据库名 * @return {Object} storeName 实例（仓库实例） */ function createInstance(dataBase){ return localForage.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-06T10:59:09+08:00">
    <meta property="article:modified_time" content="2024-05-06T10:59:09+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">前端大文件分片上传解决方案（看这一篇就够了）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#_1" rel="nofollow">概要</a></li><li><a href="#_5" rel="nofollow">整体架构流程</a></li><li><a href="#_18" rel="nofollow">具体实现</a></li><li><ul><li><a href="#localForage_19" rel="nofollow">一，分片下载之本地储存（localForage）</a></li><li><a href="#_20" rel="nofollow">前言：</a></li><li><a href="#_132" rel="nofollow">二，本地数据获取（获取下载列表）</a></li><li><a href="#JS_181" rel="nofollow">二，操作JS</a></li><li><ul><li><a href="#1_183" rel="nofollow">1，下载进度监听</a></li><li><a href="#2_202" rel="nofollow">2，文件下载状态控制</a></li><li><a href="#3_243" rel="nofollow">3，分片下载</a></li></ul> 
    </li><li><a href="#VUE_446" rel="nofollow">二，VUE页面</a></li></ul> 
   </li><li><a href="#_557" rel="nofollow">小结</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_1"></a>概要</h3> 
<p>本文从前端方面出发实现浏览器下载大文件的功能。不考虑网络异常、关闭网页等原因造成传输中断的情况。分片下载采用串行方式（并行下载需要对切片计算hash，比对hash，丢失重传，合并chunks的时候需要按顺序合并等，很麻烦。对传输速度有追求的，并且在带宽允许的情况下可以做并行分片下载）</p> 
<h3><a id="_5"></a>整体架构流程</h3> 
<p>1， 使用分片下载： 将大文件分割成多个小块进行下载，可以降低内存占用和网络传输中断的风险。这样可以避免一次性下载整个大文件造成的性能问题。</p> 
<p>2， 断点续传： 实现断点续传功能，即在下载中途中断后，可以从已下载的部分继续下载，而不需要重新下载整个文件。</p> 
<p>3， 进度条显示： 在页面上展示下载进度，让用户清晰地看到文件下载的进度。如果一次全部下载可以从process中直接拿到参数计算得出（很精细），如果是分片下载，也是计算已下载的和总大小，只不过已下载的会成片成片的增加（不是很精细）。</p> 
<p>4， 取消下载和暂停下载功能： 提供取消下载和暂停下载的按钮，让用户可以根据需要中止或暂停下载过程。</p> 
<p>5， 合并文件： 下载完成后，将所有分片文件合并成一个完整的文件。</p> 
<h3><a id="_18"></a>具体实现</h3> 
<h4><a id="localForage_19"></a>一，分片下载之本地储存（localForage）</h4> 
<h4><a id="_20"></a>前言：</h4> 
<p>浏览器的安全策略禁止网页（JS）直接访问和操作用户计算机上的文件系统。<br> 在分片下载过程中，每个下载的文件块（chunk）都需要在客户端进行缓存或存储，方便实现断点续传功能，同时也方便后续将这些文件块合并成完整的文件。这些文件块可以暂时保存在内存中或者存储在客户端的本地存储（如 IndexedDB、LocalStorage 等）中。<br> <strong>使用封装，直接上代码</strong>：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ElementUI <span class="token keyword">from</span> <span class="token string">'element-ui'</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> localForage <span class="token keyword">from</span> <span class="token string">'localforage'</span>
<span class="token keyword">import</span> streamSaver <span class="token keyword">from</span> <span class="token string">'streamsaver'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">"@/store/index"</span>
<span class="token comment">/**
 * localforage–是一个高效而强大的离线存储方案。
 * 它封装了IndexedDB, WebSQL, or localStorage，并且提供了一个简化的类似localStorage的API。
 * 在默认情况下会优先采用使用IndexDB、WebSQL、localStorage进行后台存储，
 * 即浏览器不支持IndexDB时尝试采用WebSQL，既不支持IndexDB又不支持WebSQL时采用
 * localStorage来进行存储。
 * 
 */</span>
<span class="token comment">/**
 * @description 创建数据库实例，创建并返回一个 localForage 的新实例。每个实例对象都有独立的数据库，而不会影响到其他实例
 * @param {Object} dataBase 数据库名
 * @return {Object} storeName 实例（仓库实例）
 */</span>
<span class="token keyword">function</span> <span class="token function">createInstance</span><span class="token punctuation">(</span><span class="token parameter">dataBase</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> localForage<span class="token punctuation">.</span><span class="token function">createInstance</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> dataBase
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * @description 保存数据
 * @param {Object} name 键名
 * @param {Object} value 数据
 * @param {Object} storeName 仓库
 */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">saveData</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> value<span class="token punctuation">,</span> storeName</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token keyword">await</span> storeName<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 当值被存储后，可执行其他操作</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"save success"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 当出错时，此处代码运行</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * @description 获取保存的数据
 * @param {Object} name 键名
 * @param {Object} storeName 仓库
 */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> storeName<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token keyword">await</span> storeName<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 获取到值后，可执行其他操作</span>
    <span class="token function">callback</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 当出错时，此处代码运行</span>
    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * @description 移除保存的数据
 * @param {Object} name 键名
 * @param {Object} storeName 仓库
 */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">removeData</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> storeName</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token keyword">await</span> storeName<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Key is cleared!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 当出错时，此处代码运行</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * @description 删除数据仓库，将删除指定的 “数据库”（及其所有数据仓库）。
 * @param {Object} dataBase 数据库名
 */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">dropDataBase</span><span class="token punctuation">(</span><span class="token parameter">dataBase</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token keyword">await</span> localForage<span class="token punctuation">.</span><span class="token function">dropInstance</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> dataBase
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Dropped '</span> <span class="token operator">+</span> dataBase <span class="token operator">+</span> <span class="token string">' database'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 当出错时，此处代码运行</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * @description 删除数据仓库
 * @param {Object} dataBase 数据库名
 * @param {Object} storeName 仓库名（实例）
 */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">dropDataBaseNew</span><span class="token punctuation">(</span><span class="token parameter">dataBase<span class="token punctuation">,</span> storeName</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token keyword">await</span> localForage<span class="token punctuation">.</span><span class="token function">dropInstance</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> dataBase<span class="token punctuation">,</span>
    <span class="token literal-property property">storeName</span><span class="token operator">:</span> storeName
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Dropped'</span><span class="token punctuation">,</span>storeName<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 当出错时，此处代码运行</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>



</code></pre> 
<h4><a id="_132"></a>二，本地数据获取（获取下载列表）</h4> 
<pre><code class="prism language-javascript"><span class="token comment">/**
 * @description 获取下载列表
 * @param {String} page 页面
 * @param {String} user 用户
 */</span>
<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getDownloadList</span><span class="token punctuation">(</span><span class="token parameter">page<span class="token punctuation">,</span> user<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// const key = user + "_" + page + "_";</span>
  <span class="token comment">// const key = user + "_";</span>
  <span class="token keyword">const</span> key <span class="token operator">=</span> <span class="token string">"_"</span><span class="token punctuation">;</span> <span class="token comment">// 因为用户会过期 所以不保存用户名  直接以页面为键即可</span>
  <span class="token comment">// 基础数据库</span>
  <span class="token keyword">const</span> baseDataBase <span class="token operator">=</span> <span class="token function">createInstance</span><span class="token punctuation">(</span>baseDataBaseName<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> baseDataBase<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">keys</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 包含所有 key 名的数组</span>
      <span class="token keyword">let</span> fileList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> keys<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
          <span class="token comment">// 获取数据</span>
          <span class="token keyword">await</span> <span class="token function">getData</span><span class="token punctuation">(</span>keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> baseDataBase<span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
            fileList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
              <span class="token punctuation">{<!-- --></span>
                <span class="token string-property property">'fileName'</span><span class="token operator">:</span> res<span class="token punctuation">,</span> <span class="token comment">// 文件名</span>
                <span class="token string-property property">'dataInstance'</span><span class="token operator">:</span> keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token comment">// 文件对应数据库实例名</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 获取进度</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> fileList<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> dataBase <span class="token operator">=</span> <span class="token function">createInstance</span><span class="token punctuation">(</span>fileList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>dataInstance<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">await</span> <span class="token function">getData</span><span class="token punctuation">(</span>progressKey<span class="token punctuation">,</span> dataBase<span class="token punctuation">,</span>  <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">progress</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>progress<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            fileList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fileSize <span class="token operator">=</span> progress<span class="token punctuation">.</span>fileSize<span class="token punctuation">;</span>
            fileList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>progress <span class="token operator">=</span> progress<span class="token punctuation">.</span>progress <span class="token operator">?</span> progress<span class="token punctuation">.</span>progress <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
            fileList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>status <span class="token operator">=</span> progress<span class="token punctuation">.</span>status <span class="token operator">?</span> progress<span class="token punctuation">.</span>status <span class="token operator">:</span> <span class="token string">"stopped"</span><span class="token punctuation">;</span>
            fileList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>url <span class="token operator">=</span> progress<span class="token punctuation">.</span>url<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">callback</span><span class="token punctuation">(</span>fileList<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 当出错时，此处代码运行</span>
      <span class="token function">callback</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="JS_181"></a>二，操作JS</h4> 
<h5><a id="1_183"></a>1，下载进度监听</h5> 
<pre><code class="prism language-javascript"><span class="token comment">/**
 * 文件下载进度监听
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">onDownloadProgres</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">progress</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// progress对象中的loaded表示已经下载的数量，total表示总数量，这里计算出百分比</span>
  <span class="token keyword">let</span> downProgress <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token number">100</span> <span class="token operator">*</span> progress<span class="token punctuation">.</span>loaded <span class="token operator">/</span> progress<span class="token punctuation">.</span>total<span class="token punctuation">)</span><span class="token punctuation">;</span> 
  store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'setProgress'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">dataInstance</span><span class="token operator">:</span> uniSign<span class="token punctuation">,</span>
      <span class="token literal-property property">fileName</span><span class="token operator">:</span> data<span class="token punctuation">.</span>downLoad<span class="token punctuation">,</span>
      <span class="token literal-property property">progress</span><span class="token operator">:</span> downProgress<span class="token punctuation">,</span>
      <span class="token literal-property property">status</span><span class="token operator">:</span> downProgress <span class="token operator">==</span> <span class="token number">100</span> <span class="token operator">?</span> <span class="token string">'success'</span> <span class="token operator">:</span> <span class="token string">'downloading'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">cancel</span><span class="token operator">:</span> cancel
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> 
<h5><a id="2_202"></a>2，文件下载状态控制</h5> 
<pre><code class="prism language-javascript"><span class="token comment">// 数据库进度数据主键</span>
<span class="token keyword">const</span> progressKey <span class="token operator">=</span> <span class="token string">"progress"</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * @description 状态控制
 * @param {String} fileName 文件名
 * @param {String} type 下载方式 continue:续传  again:重新下载  cancel:取消
 * @param {String} dataBaseName 数据库名 每个文件唯一
 * 
 */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">controlFile</span><span class="token punctuation">(</span><span class="token parameter">fileName<span class="token punctuation">,</span> type<span class="token punctuation">,</span> dataBaseName</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token string">'continue'</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token string">'again'</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 删除文件数据</span>
    <span class="token keyword">await</span> <span class="token function">dropDataBase</span><span class="token punctuation">(</span>dataBaseName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 基础数据库</span>
    <span class="token keyword">const</span> baseDataBase <span class="token operator">=</span> <span class="token function">createInstance</span><span class="token punctuation">(</span>baseDataBaseName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 基础数据库删除数据库实例</span>
    <span class="token function">removeData</span><span class="token punctuation">(</span>dataBaseName<span class="token punctuation">,</span> baseDataBase<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token string">'cancel'</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 删除文件数据</span>
    <span class="token keyword">await</span> <span class="token function">dropDataBase</span><span class="token punctuation">(</span>dataBaseName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 基础数据库</span>
    <span class="token keyword">const</span> baseDataBase <span class="token operator">=</span> <span class="token function">createInstance</span><span class="token punctuation">(</span>baseDataBaseName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 基础数据库删除数据库实例</span>
    <span class="token keyword">await</span> <span class="token function">removeData</span><span class="token punctuation">(</span>dataBaseName<span class="token punctuation">,</span> baseDataBase<span class="token punctuation">)</span><span class="token punctuation">;</span>
    store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'delProgress'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">dataInstance</span><span class="token operator">:</span> dataBaseName
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token string">'stop'</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'setProgress'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">dataInstance</span><span class="token operator">:</span> dataBaseName<span class="token punctuation">,</span>
        <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token string">'stopped'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h5><a id="3_243"></a>3，分片下载</h5> 
<pre><code class="prism language-javascript"><span class="token comment">/**
 * @description 分片下载
 * @param {String} fileName 文件名
 * @param {String} url 下载地址
 * @param {String} dataBaseName 数据库名 每个文件唯一
 * @param {Object} progress 下载进度 type: continue:续传  again:重新下载  cancel:取消
 * 
 */</span>
<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">downloadByBlock</span><span class="token punctuation">(</span><span class="token parameter">fileName<span class="token punctuation">,</span> url<span class="token punctuation">,</span> dataBaseName<span class="token punctuation">,</span> progress</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">//调整下载状态</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>progress<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">await</span> <span class="token function">controlFile</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> progress<span class="token punctuation">.</span>type<span class="token punctuation">,</span> dataBaseName<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">// 判断是否超过最大下载数量</span>
  <span class="token keyword">let</span> downloadNum <span class="token operator">=</span> store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>progressList<span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>downloadNum<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>progress<span class="token punctuation">.</span>type <span class="token operator">&amp;&amp;</span> downloadNum<span class="token punctuation">.</span>length <span class="token operator">==</span> downloadMaxNum<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      ElementUI<span class="token punctuation">.</span>Message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"已超过最大下载量，请等待其他文件下载完再尝试!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">// 基础数据库</span>
  <span class="token keyword">const</span> baseDataBase <span class="token operator">=</span> <span class="token function">createInstance</span><span class="token punctuation">(</span>baseDataBaseName<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 判断数据库中是否已存在该文件的下载任务</span>
  <span class="token keyword">let</span> isError <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> <span class="token function">getData</span><span class="token punctuation">(</span>dataBaseName<span class="token punctuation">,</span> baseDataBase<span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>res <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>progress<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      ElementUI<span class="token punctuation">.</span>Message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"该文件已在下载任务列表，无需重新下载!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      isError <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>isError<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">// 储存数据的数据库</span>
  <span class="token keyword">const</span> dataBase <span class="token operator">=</span> <span class="token function">createInstance</span><span class="token punctuation">(</span>dataBaseName<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token comment">// 获取文件大小</span>
  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">head</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 文件大小</span>
  <span class="token keyword">const</span> fileSize <span class="token operator">=</span> <span class="token operator">+</span>response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'content-length'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// 分片大小</span>
  <span class="token keyword">const</span> chunkSize <span class="token operator">=</span> <span class="token operator">+</span>response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'buffer-size'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// 开始节点</span>
  <span class="token keyword">let</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token comment">// 结束节点</span>
  <span class="token keyword">let</span> end <span class="token operator">=</span> chunkSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>fileSize <span class="token operator">&lt;</span> chunkSize<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    end <span class="token operator">=</span> fileSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 所有分片</span>
  <span class="token keyword">let</span> ranges <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// 计算需要分多少次下载</span>
  <span class="token keyword">const</span> numChunks <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>fileSize <span class="token operator">/</span> chunkSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 回写文件大小</span>
  progress<span class="token punctuation">.</span>fileSize <span class="token operator">=</span> fileSize<span class="token punctuation">;</span>
  progress<span class="token punctuation">.</span>url <span class="token operator">=</span> url<span class="token punctuation">;</span>
  
  <span class="token comment">// 保存数据库实例</span>
  <span class="token keyword">await</span> <span class="token function">saveData</span><span class="token punctuation">(</span>dataBaseName<span class="token punctuation">,</span> fileName<span class="token punctuation">,</span> baseDataBase<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>progress<span class="token punctuation">.</span>progress<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 保存进度数据</span>
    <span class="token keyword">await</span> <span class="token function">saveData</span><span class="token punctuation">(</span>progressKey<span class="token punctuation">,</span> progress<span class="token punctuation">,</span> dataBase<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 保存下载状态至localstorage  如果页面刷新 可重新读取状态 判断是否需要继续下载</span>
  sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span>dataBaseName<span class="token punctuation">,</span><span class="token string">"downloading"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token comment">// 组转参数</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> numChunks<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 创建请求控制器 </span>
    <span class="token keyword">const</span> controller <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AbortController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">const</span> range <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">bytes=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>start<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>end<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token comment">// 如果是续传 先判断是否已下载</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>progress<span class="token punctuation">.</span>type <span class="token operator">==</span> <span class="token string">'continue'</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 先修改状态</span>
      store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'setProgress'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
          <span class="token literal-property property">dataInstance</span><span class="token operator">:</span> dataBaseName<span class="token punctuation">,</span>
          <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token string">'downloading'</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">let</span> isContinue <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token keyword">await</span> <span class="token function">getData</span><span class="token punctuation">(</span>range<span class="token punctuation">,</span> dataBase<span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> isContinue <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>isContinue<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        ranges<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>range<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 重置开始节点</span>
        start <span class="token operator">=</span> end <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token comment">// 重置结束节点</span>
        end <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>end <span class="token operator">+</span> chunkSize<span class="token punctuation">,</span> fileSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">continue</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">let</span> cancel<span class="token punctuation">;</span>
    <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">Range</span><span class="token operator">:</span> range
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">responseType</span><span class="token operator">:</span> <span class="token string">'arraybuffer'</span><span class="token punctuation">,</span>
      <span class="token comment">// 绑定取消请求的信号量</span>
      <span class="token literal-property property">signal</span><span class="token operator">:</span> controller<span class="token punctuation">.</span>signal<span class="token punctuation">,</span> 
      <span class="token comment">// 文件下载进度监听</span>
      <span class="token function-variable function">onDownloadProgress</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">pro</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>progress<span class="token punctuation">.</span>type <span class="token operator">==</span> <span class="token string">'stop'</span> <span class="token operator">||</span> progress<span class="token punctuation">.</span>type <span class="token operator">==</span> <span class="token string">'cancel'</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
           <span class="token comment">// 终止请求</span>
          controller<span class="token punctuation">.</span><span class="token function">abort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        <span class="token comment">// 已加载大小</span>
        <span class="token comment">// progress对象中的loaded表示已经下载的数量，total表示总数量，这里计算出百分比</span>
        <span class="token keyword">let</span> downProgress <span class="token operator">=</span> <span class="token punctuation">(</span>pro<span class="token punctuation">.</span>loaded <span class="token operator">/</span> pro<span class="token punctuation">.</span>total<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        downProgress <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span> <span class="token punctuation">(</span>i <span class="token operator">/</span> numChunks<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">+</span> downProgress  <span class="token operator">/</span> numChunks <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        progress<span class="token punctuation">.</span>progress <span class="token operator">=</span> downProgress<span class="token punctuation">;</span>
        <span class="token comment">// 设置为异常  如果是正常下载完 这个记录会被删除 如果合并失败  则会显示异常</span>
        progress<span class="token punctuation">.</span>status <span class="token operator">=</span> downProgress <span class="token operator">==</span> <span class="token number">100</span> <span class="token operator">?</span> <span class="token string">'error'</span> <span class="token operator">:</span> <span class="token string">'stopped'</span><span class="token punctuation">;</span>
        store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'setProgress'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">dataInstance</span><span class="token operator">:</span> dataBaseName<span class="token punctuation">,</span>
            <span class="token literal-property property">fileName</span><span class="token operator">:</span> fileName<span class="token punctuation">,</span>
            <span class="token literal-property property">progress</span><span class="token operator">:</span> downProgress<span class="token punctuation">,</span>
            <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token string">'downloading'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">cancel</span><span class="token operator">:</span> cancel<span class="token punctuation">,</span>
            <span class="token literal-property property">url</span><span class="token operator">:</span> url<span class="token punctuation">,</span>
            <span class="token literal-property property">dataBaseName</span><span class="token operator">:</span> dataBaseName
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 开始分片下载</span>
      <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 保存分片数据</span>
      <span class="token keyword">await</span> <span class="token function">saveData</span><span class="token punctuation">(</span>range<span class="token punctuation">,</span> response<span class="token punctuation">.</span>data<span class="token punctuation">,</span> dataBase<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
      ranges<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>range<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 重置开始节点</span>
      start <span class="token operator">=</span> end <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token comment">// 重置结束节点</span>
      end <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>end <span class="token operator">+</span> chunkSize<span class="token punctuation">,</span> fileSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"终止请求时catch的error---"</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 判断是否为取消上传</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>message <span class="token operator">==</span> <span class="token string">"canceled"</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
          <span class="token comment">// 进行后续处理</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>progress<span class="token punctuation">.</span>type <span class="token operator">==</span> <span class="token string">'stop'</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 暂停</span>
            <span class="token keyword">await</span> <span class="token function">controlFile</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> progress<span class="token punctuation">.</span>type<span class="token punctuation">,</span> dataBaseName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span>dataBaseName<span class="token punctuation">,</span><span class="token string">"stop"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token comment">// 终止请求</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"stopped"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>progress<span class="token punctuation">.</span>type <span class="token operator">==</span> <span class="token string">'cancel'</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 取消</span>
            <span class="token keyword">await</span> <span class="token function">controlFile</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> progress<span class="token punctuation">.</span>type<span class="token punctuation">,</span> dataBaseName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            sessionStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span>dataBaseName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 终止请求</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"canceled"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"开始合入"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 流操作</span>
  <span class="token keyword">const</span> fileStream <span class="token operator">=</span> streamSaver<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">size</span><span class="token operator">:</span> fileSize<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> writer <span class="token operator">=</span> fileStream<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 合并数据</span>
  <span class="token comment">// 循环取出数据合并</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ranges<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">var</span> range <span class="token operator">=</span> ranges<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// 从数据库获取分段数据</span>
    <span class="token keyword">await</span> <span class="token function">getData</span><span class="token punctuation">(</span>range<span class="token punctuation">,</span> dataBase<span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 读取流</span>
        <span class="token keyword">const</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>res<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> done<span class="token punctuation">,</span> value <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> reader<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>done<span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
          <span class="token comment">// 写入流</span>
          writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 结束写入</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">==</span>ranges<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
          writer<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token comment">// 清空数据库</span>
          <span class="token function">dropDataBase</span><span class="token punctuation">(</span>dataBaseName<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token comment">// 基础数据库删除数据库实例</span>
          <span class="token function">removeData</span><span class="token punctuation">(</span>dataBaseName<span class="token punctuation">,</span> baseDataBase<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token comment">// 清除store</span>
          store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'delProgress'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">dataInstance</span><span class="token operator">:</span> dataBaseName
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> 
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="VUE_446"></a>二，VUE页面</h4> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> downloadByBlock <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"上面的js"</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"suspension"</span><span class="token punctuation">,</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 下载列表</span>
      <span class="token literal-property property">downloadDialog</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token literal-property property">fileStatus</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">watch</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"$store.state.progressList"</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">let</span> progressList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>progressList<span class="token punctuation">;</span>
        progressList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
          <span class="token comment">// 获取之前下载状态 还原操作</span>
          <span class="token keyword">const</span> status <span class="token operator">=</span> sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>dataInstance<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">==</span> <span class="token string">"downloading"</span> <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>status <span class="token operator">!=</span> status<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">startDownload</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">/**
     * @description 重试
     * @param {Object} row
     */</span>
    <span class="token function">retryDownload</span><span class="token punctuation">(</span><span class="token parameter">row</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">startDownload</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">/**
     * @description 开始下载
     * @param {Object} row
     */</span>
    <span class="token function">startDownload</span><span class="token punctuation">(</span><span class="token parameter">row</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>fileStatus<span class="token punctuation">[</span>row<span class="token punctuation">.</span>dataInstance<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"continue"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">progress</span><span class="token operator">:</span> row<span class="token punctuation">.</span>progress
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token function">downloadByBlock</span><span class="token punctuation">(</span>
        row<span class="token punctuation">.</span>fileName<span class="token punctuation">,</span>
        row<span class="token punctuation">.</span>url<span class="token punctuation">,</span>
        row<span class="token punctuation">.</span>dataInstance<span class="token punctuation">,</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>fileStatus<span class="token punctuation">[</span>row<span class="token punctuation">.</span>dataInstance<span class="token punctuation">]</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">/**
     * @description 暂停下载
     * @param {Object} row
     */</span>
    <span class="token function">stopDownload</span><span class="token punctuation">(</span><span class="token parameter">row</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$set</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>fileStatus<span class="token punctuation">[</span>row<span class="token punctuation">.</span>dataInstance<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"type"</span><span class="token punctuation">,</span> <span class="token string">"stop"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">/**
     * @description 删除下载
     * @param {Object} row
     */</span>
    <span class="token function">delDownload</span><span class="token punctuation">(</span><span class="token parameter">row</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>fileStatus<span class="token punctuation">[</span>row<span class="token punctuation">.</span>dataInstance<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> row<span class="token punctuation">.</span>status <span class="token operator">!=</span> <span class="token string">"stopped"</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$set</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>fileStatus<span class="token punctuation">[</span>row<span class="token punctuation">.</span>dataInstance<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"type"</span><span class="token punctuation">,</span> <span class="token string">"cancel"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>fileStatus<span class="token punctuation">[</span>row<span class="token punctuation">.</span>dataInstance<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"cancel"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token function">downloadByBlock</span><span class="token punctuation">(</span>
          row<span class="token punctuation">.</span>fileName<span class="token punctuation">,</span>
          row<span class="token punctuation">.</span>url<span class="token punctuation">,</span>
          row<span class="token punctuation">.</span>dataInstance<span class="token punctuation">,</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>fileStatus<span class="token punctuation">[</span>row<span class="token punctuation">.</span>dataInstance<span class="token punctuation">]</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">/**
     * @description 分片下载文件
     */</span>
    <span class="token function">downloadByBlock</span><span class="token punctuation">(</span><span class="token parameter">fileName<span class="token punctuation">,</span> url<span class="token punctuation">,</span> dataBaseName<span class="token punctuation">,</span> type</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>fileStatus<span class="token punctuation">[</span>dataBaseName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">type</span><span class="token operator">:</span> type <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token function">downloadByBlock</span><span class="token punctuation">(</span>
        fileName<span class="token punctuation">,</span>
        url<span class="token punctuation">,</span>
        dataBaseName<span class="token punctuation">,</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>fileStatus<span class="token punctuation">[</span>dataBaseName<span class="token punctuation">]</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">btnDownload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">/**
     * @description 下载列表
     */</span>
    <span class="token function">btnDownload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 通过路由信息判断当前处于哪一个页面</span>
      <span class="token keyword">const</span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>downloadDialog <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>



    <span class="token comment">/**
     * @description 取消弹窗
     */</span>
    <span class="token function">downloadBtnCancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>downloadDialog <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="_557"></a>小结</h3> 
<p>这只是一个基本示例。在实际应用中，你可能需要考虑以下问题：</p> 
<p>并发下载： 如果多个用户同时下载相同的大文件，可能会对服务器造成很大的压力。可以使用并发下载来提高性能。</p> 
<p>安全性： 确保只有授权用户可以下载文件，并且不会泄漏敏感信息。</p> 
<p>性能优化： 使用缓存、压缩等技术来提高下载速度和用户体验。</p> 
<p>服务器资源管理： 下载大文件可能会占用服务器的网络带宽和内存资源，需要适当的管理。</p> 
<p>总之，大文件分片下载和合并是一个复杂的任务，需要综合考虑性能、安全性和用户体验。在实际项目中，你可能会使用更高级的工具和技术来处理这些问题。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6eb45e0bb387925e3cf209272b55cbc1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">NLP国内外大模型汇总列表[文心一言、智谱、百川、星火、通义千问、盘古等等]</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3944ea56c170ae519198af28d3d925d9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">国内外 30 个热门大模型的架构的图文解析汇总</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>