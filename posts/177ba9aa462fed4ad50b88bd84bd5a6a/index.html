<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C&#43;&#43; --ï¼ stringç±»æ¨¡æ‹Ÿå®ç°ï¼ˆé™„æºç ï¼‰ - ç¼–ç¨‹å¤§å’–</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/177ba9aa462fed4ad50b88bd84bd5a6a/">
  <meta property="og:site_name" content="ç¼–ç¨‹å¤§å’–">
  <meta property="og:title" content="C&#43;&#43; --ï¼ stringç±»æ¨¡æ‹Ÿå®ç°ï¼ˆé™„æºç ï¼‰">
  <meta property="og:description" content="æ¬¢è¿æ¥åˆ°æˆ‘çš„Blogï¼Œç‚¹å‡»å…³æ³¨å“¦ğŸ’•
å‰è¨€ï¼š C&#43;&#43;ä¸­STLæ‰®æ¼”ç€æå…¶é‡è¦çš„è§’è‰²ï¼Œå­¦ä¹ C&#43;&#43;é‡ä¸­ä¹‹é‡çš„å°±æ˜¯å­¦ä¹ STLï¼Œè™½ç„¶stringä¸ä½œä¸ºcontainersçš„å…¶ä¸­ä¸€å‘˜ï¼Œä½†æ˜¯ä¹Ÿæ˜¯å€¼å¾—å­¦ä¹ çš„leç±»ã€‚ä¸‹é¢å°±è¿›è¡Œstringçš„æ¨¡æ‹Ÿå®ç°
stringçš„æ¨¡æ‹Ÿå®ç°å’Œé¡ºåºè¡¨æ˜¯å·®ä¸å¤šï¼Œå°±æ˜¯å¢åŠ äº†C&#43;&#43;çš„ç‰¹æ€§ã€‚
string æ¨¡æ‹Ÿå®ç° å­˜å‚¨ç»“æ„ ç»“æ„ä¸Šä½¿ç”¨å‘½åç©ºé—´mystrè¿›è¡Œå°è£…ï¼Œé˜²æ­¢ä¸åº“å†²çªï¼Œä½¿ç”¨classå°è£…æˆä¸ºå¯¹è±¡string:
å®šä¹‰ _size æ–¹ä¾¿è®°å½•stringçš„å¤§å°ã€‚å®šä¹‰ _capacityæ–¹ä¾¿è®°å½•stringçš„å®¹é‡å¤§å°å®šä¹‰ char* _stræ˜¯å­˜å‚¨æ•°æ®ï¼Œè¿›è¡ŒåŠ¨æ€newå‡ºç©ºé—´nopsï¼šnposç”¨äºè¡¨ç¤ºåœ¨å­—ç¬¦ä¸²ä¸­æœªæ‰¾åˆ°æ‰€æŸ¥æ‰¾çš„å­ä¸²ï¼Œæˆ–è€…è¡¨ç¤ºä¸€ä¸ªè¶…å‡ºå­—ç¬¦ä¸²é•¿åº¦çš„æœ‰æ•ˆç´¢å¼•ä½ç½®ã€‚nposçš„å€¼é€šå¸¸è¢«å®šä¹‰ä¸ºstd::size_tç±»å‹çš„æœ€å¤§å€¼ï¼Œè¿™æ˜¯ä¸€ä¸ªæ— ç¬¦å·æ•´æ•°ç±»å‹ï¼Œå› æ­¤nposå®é™…ä¸Šæ˜¯ä¸€ä¸ªéå¸¸å¤§çš„æ­£æ•´æ•°ï¼Œç”¨äºè¡¨ç¤ºæ²¡æœ‰æ‰¾åˆ°åŒ¹é…é¡¹æˆ–å­—ç¬¦ä¸²çš„ç»“æŸä½ç½®. namespace mystr { class string { public: static const size_t npos = -1; private:	size_t _size; size_t _capacity; char* _str; }; } é»˜è®¤æ„é€ å‡½æ•° æ„é€ å‡½æ•° å…¨ç¼ºçœçš„æ„é€ å‡½æ•°ä¹Ÿæ˜¯é»˜è®¤æ„é€ å‡½æ•°ï¼Œç»“å°¾ç»™&#34;&#34;å¸¸é‡å­—ç¬¦ä¸²æœ«å°¾å­˜åœ¨\0; é»˜è®¤æ„é€ å‡½æ•°ï¼šå…¨ç¼ºçœã€æ— å‚ã€ç¼–è¯‘å™¨é»˜è®¤ç”Ÿæˆçš„æ„é€ å‡½æ•°ç§°ä¹‹ä¸ºé»˜è®¤æ„é€ å‡½æ•° é‡‡å–åˆå§‹åŒ–åˆ—è¡¨ï¼Œå¯¹äºå¸¸é‡å¼•ç”¨å¯ä»¥è¿›è¡Œåˆå§‹åŒ–ã€‚strlenè®¡ç®—å‡ºå¤§å°ï¼Œåˆå§‹åŒ–_size
2. æ³¨æ„ï¼šåˆå§‹åŒ–é¡ºåºå°±æ˜¯å£°æ˜çš„é¡ºåºï¼Œè¿™ä¸ªä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå°†char* _stræ”¾åœ¨æœ€åï¼›_capacotyåˆå§‹åŒ–å®¹é‡&#43;1çš„ç›®çš„æ˜¯ç»™\0å¼€è¾Ÿç©ºé—´ï¼›æœ€åå°†strè¿›è¡Œæ‹·è´ï¼Œè¿™é‡Œé‡‡ç”¨memcpyä¸é‡‡ç”¨strcpy
3. memcpyå¯ä»¥å°†å…¨éƒ¨å†…å®¹æ‹·è´ï¼Œstrcpyä¼šè¯†åˆ«\0åœæ­¢ï¼Œå‡ä½¿å­—ç¬¦ä¸²hello\0 worldæ„é€ å°±ä¸ä¼šå¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœ string(const char* str = &#34;&#34;) :_size(strlen(str)) , _capacity(_size) , _str(new char[_capacity &#43; 1]) {	memcpy(_str, str, _capacity &#43; 1); } æ‹·è´æ„é€ å‡½æ•° ä¼—æ‰€å‘¨çŸ¥çš„æ˜¯å½“ä¸å­˜åœ¨æ‹·è´æ„é€ å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ç”Ÿæˆæ‹·è´æ„é€ å‡½æ•°ï¼› ç¼–è¯‘å™¨ç”Ÿæˆçš„ä»…ä»…ä¼šå®ç°æ•°å€¼ä¸Šçš„æ‹·è´ï¼ˆæµ…æ‹·è´ï¼‰_strnewå‡ºç©ºé—´ï¼Œè¦å®ç°å†…å®¹ä¸Šçš„æ‹·è´ï¼ˆæ·±æ‹·è´ï¼‰ _capacotyåˆå§‹åŒ–å®¹é‡&#43;1çš„ç›®çš„æ˜¯ç»™\0å¼€è¾Ÿç©ºé—´ï¼› string(const string&amp; s) { _capacity = s.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-29T10:34:50+08:00">
    <meta property="article:modified_time" content="2024-07-29T10:34:50+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§å’–" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§å’–</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C&#43;&#43; --ï¼ stringç±»æ¨¡æ‹Ÿå®ç°ï¼ˆé™„æºç ï¼‰</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><a href="https://blog.csdn.net/Cayyyy?spm=1011.2415.3001.5343">æ¬¢è¿æ¥åˆ°æˆ‘çš„Blogï¼Œç‚¹å‡»å…³æ³¨å“¦ğŸ’•</a></p> 
<h2><a id="_2"></a>å‰è¨€ï¼š</h2> 
<blockquote> 
 <p>C++ä¸­<code>STL</code>æ‰®æ¼”ç€æå…¶é‡è¦çš„è§’è‰²ï¼Œå­¦ä¹ C++é‡ä¸­ä¹‹é‡çš„å°±æ˜¯å­¦ä¹ <code>STL</code>ï¼Œè™½ç„¶stringä¸ä½œä¸ºcontainersçš„å…¶ä¸­ä¸€å‘˜ï¼Œä½†æ˜¯ä¹Ÿæ˜¯å€¼å¾—å­¦ä¹ çš„leç±»ã€‚ä¸‹é¢å°±è¿›è¡Œ<code>string</code>çš„æ¨¡æ‹Ÿå®ç°</p> 
</blockquote> 
<p>stringçš„æ¨¡æ‹Ÿå®ç°å’Œé¡ºåºè¡¨æ˜¯å·®ä¸å¤šï¼Œå°±æ˜¯å¢åŠ äº†C++çš„ç‰¹æ€§ã€‚</p> 
<h2><a id="string__8"></a>string æ¨¡æ‹Ÿå®ç°</h2> 
<h3><a id="_10"></a>å­˜å‚¨ç»“æ„</h3> 
<p><mark>ç»“æ„ä¸Šä½¿ç”¨å‘½åç©ºé—´<code>mystr</code>è¿›è¡Œå°è£…ï¼Œé˜²æ­¢ä¸åº“å†²çªï¼Œä½¿ç”¨classå°è£…æˆä¸ºå¯¹è±¡string:</mark></p> 
<ul><li>å®šä¹‰ <code>_size </code>æ–¹ä¾¿è®°å½•<code>string</code>çš„å¤§å°ã€‚</li><li>å®šä¹‰ <code>_capacity</code>æ–¹ä¾¿è®°å½•<code>string</code>çš„å®¹é‡å¤§å°</li><li>å®šä¹‰ <code>char* _str</code>æ˜¯å­˜å‚¨æ•°æ®ï¼Œè¿›è¡ŒåŠ¨æ€newå‡ºç©ºé—´</li><li><code>nops</code>ï¼š<code>npos</code>ç”¨äºè¡¨ç¤ºåœ¨å­—ç¬¦ä¸²ä¸­æœªæ‰¾åˆ°æ‰€æŸ¥æ‰¾çš„å­ä¸²ï¼Œæˆ–è€…è¡¨ç¤ºä¸€ä¸ªè¶…å‡ºå­—ç¬¦ä¸²é•¿åº¦çš„æœ‰æ•ˆç´¢å¼•ä½ç½®ã€‚<code>npos</code>çš„å€¼é€šå¸¸è¢«å®šä¹‰ä¸º<code>std::size_t</code>ç±»å‹çš„æœ€å¤§å€¼ï¼Œè¿™æ˜¯ä¸€ä¸ªæ— ç¬¦å·æ•´æ•°ç±»å‹ï¼Œå› æ­¤<code>npos</code>å®é™…ä¸Šæ˜¯ä¸€ä¸ªéå¸¸å¤§çš„æ­£æ•´æ•°ï¼Œç”¨äºè¡¨ç¤ºæ²¡æœ‰æ‰¾åˆ°åŒ¹é…é¡¹æˆ–å­—ç¬¦ä¸²çš„ç»“æŸä½ç½®.</li></ul> 
<pre><code class="prism language-cpp"><span class="token keyword">namespace</span> mystr
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">class</span> <span class="token class-name">string</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">public</span><span class="token operator">:</span>
        <span class="token keyword">static</span> <span class="token keyword">const</span> size_t npos <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span><span class="token operator">:</span>		
        size_t _size<span class="token punctuation">;</span>
        size_t _capacity<span class="token punctuation">;</span>
        <span class="token keyword">char</span><span class="token operator">*</span> _str<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_34"></a>é»˜è®¤æ„é€ å‡½æ•°</h3> 
<h4><a id="_36"></a>æ„é€ å‡½æ•°</h4> 
<ul><li>å…¨ç¼ºçœçš„æ„é€ å‡½æ•°ä¹Ÿæ˜¯é»˜è®¤æ„é€ å‡½æ•°ï¼Œç»“å°¾ç»™<code>""</code>å¸¸é‡å­—ç¬¦ä¸²æœ«å°¾å­˜åœ¨<code>\0</code>;</li></ul> 
<ol><li>é»˜è®¤æ„é€ å‡½æ•°ï¼šå…¨ç¼ºçœã€æ— å‚ã€ç¼–è¯‘å™¨é»˜è®¤ç”Ÿæˆçš„æ„é€ å‡½æ•°ç§°ä¹‹ä¸º<code>é»˜è®¤æ„é€ å‡½æ•°</code></li></ol> 
<ul><li>é‡‡å–åˆå§‹åŒ–åˆ—è¡¨ï¼Œå¯¹äºå¸¸é‡å¼•ç”¨å¯ä»¥è¿›è¡Œåˆå§‹åŒ–ã€‚<code>strlen</code>è®¡ç®—å‡ºå¤§å°ï¼Œåˆå§‹åŒ–<code>_size</code><br> 2. æ³¨æ„ï¼šåˆå§‹åŒ–é¡ºåºå°±æ˜¯å£°æ˜çš„é¡ºåºï¼Œè¿™ä¸ªä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå°†<code>char* _str</code>æ”¾åœ¨æœ€åï¼›</li><li><code>_capacoty</code>åˆå§‹åŒ–å®¹é‡+1çš„ç›®çš„æ˜¯ç»™<code>\0</code>å¼€è¾Ÿç©ºé—´ï¼›</li><li>æœ€åå°†<code>str</code>è¿›è¡Œæ‹·è´ï¼Œè¿™é‡Œé‡‡ç”¨<code>memcpy</code>ä¸é‡‡ç”¨<code>strcpy</code><br> 3. <code>memcpy</code>å¯ä»¥å°†å…¨éƒ¨å†…å®¹æ‹·è´ï¼Œ<code>strcpy</code>ä¼šè¯†åˆ«<code>\0</code>åœæ­¢ï¼Œå‡ä½¿å­—ç¬¦ä¸²<code>hello\0 world</code>æ„é€ å°±ä¸ä¼šå¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœ</li></ul> 
<pre><code class="prism language-cpp"><span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span>
    <span class="token operator">:</span><span class="token function">_size</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">,</span> <span class="token function">_capacity</span><span class="token punctuation">(</span>_size<span class="token punctuation">)</span>
        <span class="token punctuation">,</span> <span class="token function">_str</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>_capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>	
        <span class="token function">memcpy</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> str<span class="token punctuation">,</span> _capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h4><a id="_56"></a>æ‹·è´æ„é€ å‡½æ•°</h4> 
<ul><li>ä¼—æ‰€å‘¨çŸ¥çš„æ˜¯å½“ä¸å­˜åœ¨æ‹·è´æ„é€ å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ç”Ÿæˆæ‹·è´æ„é€ å‡½æ•°ï¼› 
  <ol><li>ç¼–è¯‘å™¨ç”Ÿæˆçš„ä»…ä»…ä¼šå®ç°æ•°å€¼ä¸Šçš„æ‹·è´ï¼ˆæµ…æ‹·è´ï¼‰</li><li><code>_str</code>newå‡ºç©ºé—´ï¼Œè¦å®ç°å†…å®¹ä¸Šçš„æ‹·è´ï¼ˆæ·±æ‹·è´ï¼‰</li></ol> </li><li><code>_capacoty</code>åˆå§‹åŒ–å®¹é‡+1çš„ç›®çš„æ˜¯ç»™<code>\0</code>å¼€è¾Ÿç©ºé—´ï¼›</li></ul> 
<pre><code class="prism language-cpp"><span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    _capacity <span class="token operator">=</span> s<span class="token punctuation">.</span>_capacity<span class="token punctuation">;</span>
    _size <span class="token operator">=</span> s<span class="token punctuation">.</span>_size<span class="token punctuation">;</span>
    _str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>s<span class="token punctuation">.</span>_capacity<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">memcpy</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">,</span> _capacity<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="_73"></a>èµ‹å€¼è¿ç®—ç¬¦é‡è½½</h4> 
<p><mark>èµ‹å€¼é¢„ç®—ç¬¦é‡è½½çš„åº•å±‚é€»è¾‘æ˜¯å’Œæ‹·è´æ„é€ å‡½æ•°æ˜¯ä¸€æ ·çš„ï¼Œåœ¨è¿™é‡Œå°±ä¸è¿‡å¤šä»‹ç»äº†</mark></p> 
<pre><code class="prism language-cpp">string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>

    _capacity <span class="token operator">=</span> s<span class="token punctuation">.</span>_capacity<span class="token punctuation">;</span>
    _size <span class="token operator">=</span> s<span class="token punctuation">.</span>_size<span class="token punctuation">;</span>
    _str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>_capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">memcpy</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">,</span> _capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="_89"></a>ææ„å‡½æ•°</h4> 
<p><mark>ç¨‹åºçš„æ•´ä¸ªå†ç¨‹å¼€è¾Ÿç©ºé—´ï¼Œä¸è¿›è¡Œç©ºé—´çš„é‡Šæ”¾ä¸æ˜¯ä¸€ä¸ªå¥½çš„ä¹ æƒ¯ï¼Œè¿™é‡Œææ„å‡½æ•°å°±è¦ä¸Šåœºäº†</mark></p> 
<pre><code class="prism language-cpp"><span class="token operator">~</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    _size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    _capacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> _str<span class="token punctuation">;</span>
    _str <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="iterator_103"></a>è¿­ä»£å™¨ï¼ˆiteratorï¼‰</h3> 
<ul><li> <p><code>string</code>çš„è¿­ä»£å™¨çš„æœ¬è´¨å°±æ˜¯æŒ‡é’ˆï¼Œæ ¹æ®Cè¯­è¨€çš„æŒ‡é’ˆå¾ˆå®¹æ˜“å°±å¯ä»¥ç†è§£ï¼Œå°±æ˜¯å°† <em>char</em> * è¿›è¡Œ</p> <p><code>typefed char* iterator</code></p> </li><li> <p>è¿­ä»£å™¨å®ç°ä¸¤ä¸ªç‰ˆæœ¬ <code>const</code>å’Œ<code>éconst</code>ï¼Œ <mark>åªè¯»</mark>å’Œ<mark>å¯è¯»å¯å†™</mark></p> </li></ul> 
<h4><a id="begin_111"></a>beginï¼ˆï¼‰</h4> 
<pre><code class="prism language-cpp">iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> _str<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span> 
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> _str<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="end_125"></a>endï¼ˆï¼‰</h4> 
<pre><code class="prism language-cpp">iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> _str <span class="token operator">+</span> _size<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> _str <span class="token operator">+</span> _size<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="capacity_139"></a>å®¹é‡ï¼ˆcapacityï¼‰</h3> 
<h4><a id="size_141"></a>size</h4> 
<ul><li><code>mstr::string</code>ç±»å®šä¹‰äº†<code>_size</code>ç›´æ¥å°†å…¶è¿”å›</li></ul> 
<pre><code class="prism language-\">size_t size()const
{
return _size;
}
</code></pre> 
<h4><a id="capacity_152"></a>capacity</h4> 
<ul><li><code>mstr::string</code>ç±»å®šä¹‰äº†<code>_capacity</code>ç›´æ¥å°†å…¶è¿”å›</li></ul> 
<pre><code class="prism language-cpp">size_t <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> _capacity<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<h4><a id="resize_164"></a>resize</h4> 
<ul><li><code>resize</code>æ˜¯å°†åé¢æŒ‡å®šå¤§å°åˆå§‹åŒ–æŒ‡å®šçš„å­—ç¬¦ï¼ˆç¼ºçœï¼š<code>\0</code>ï¼‰</li><li>è¿›è¡Œå®¹é‡çš„æ£€æŸ¥ï¼Œä¸å¤Ÿæ‰©å®¹</li><li>ä¸€å±‚å¾ªç¯åˆå§‹åŒ–ä¸º<code>ch</code></li><li>ä¿®æ”¹<code>_size</code>é•¿åº¦ä¸º<code>n</code></li></ul> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">resize</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">,</span><span class="token keyword">char</span> ch <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        _str<span class="token punctuation">[</span>n <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
        _size <span class="token operator">=</span> n<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">reverse</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> _size<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            _str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        _str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
        _size <span class="token operator">=</span> n<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="reverse_195"></a>reverse</h4> 
<ul><li>ç”±äºå¾ˆå¤šåœ°æ–¹è¿›è¡Œå¤ç”¨ï¼Œéœ€è¦åœ¨å‡½æ•°å†…éƒ¨è¿›è¡Œåˆ¤æ–­æé«˜æ•ˆç‡</li><li>å¼€è¾Ÿä¸€ä¸ªå¤§äºåŸå§‹ç©ºé—´çš„æ–°çš„ç©ºé—´ï¼Œå°†<code> _str</code>æ‹·è´è¿‡å»ï¼Œæ”¹å˜<code>_str</code>çš„æŒ‡å‘ï¼Œå°†æ–°å¼€è¾Ÿçš„ç©ºé—´é‡Šæ”¾è°¨é˜²å†…å­˜æ³„æ¼</li></ul> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">reverse</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">char</span><span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">memcpy</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> _str<span class="token punctuation">,</span> _capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> _str<span class="token punctuation">;</span>
        _capacity <span class="token operator">=</span> n<span class="token punctuation">;</span>
        _str <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="empty_216"></a>empty</h4> 
<p><mark>ç›´æ¥åˆ¤æ–­<code>_size</code>æ˜¯å¦ä¸º0å³å¯</mark></p> 
<pre><code>bool empty()const
{
return _size == 0 ? true : false;
}
</code></pre> 
<h4><a id="clear_225"></a>clear</h4> 
<ul><li>ç›´æ¥å°†é¦–ä½ç½®èµ‹å€¼ä¸º<code>\0</code>ï¼Œä¿®æ”¹<code>_size</code>å¤§å°å³å¯</li></ul> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    _str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
    _size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="modify_237"></a>ä¿®æ”¹ï¼ˆmodifyï¼‰</h3> 
<h4><a id="push_back_239"></a>push_back</h4> 
<p>C++<code>string</code>ä¸­ push_back å‡½æ•°å£°æ˜ï¼š<code>void push_back (char c);</code>åœ¨å­—ç¬¦ä¸²åè¿½åŠ ä¸€ä¸ªå­—ç¬¦ï¼›</p> 
<ul><li>å¼€å§‹è¦æ£€æŸ¥å®¹é‡ è¿›è¡Œæ‰©å®¹è¿™é‡Œç”¨ <code>reverse</code> å®ç°</li><li>ç”±äºä¸€ä¸ªå­—ç¬¦ï¼Œä»…ä»…éœ€è¦åœ¨<code>_size</code>ä½ç½®ä¸Šç›´æ¥èµ‹å€¼ï¼Œåœ¨<code>_size+1</code>çš„ä½ç½®ä¸Šèµ‹å€¼<code>\0</code></li></ul> 
<pre><code class="prism language-cpp"> <span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">==</span> _capacity<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">reverse</span><span class="token punctuation">(</span>_capacity <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">4</span> <span class="token operator">:</span> _capacity <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    _str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>
    _str<span class="token punctuation">[</span>_size <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
    _size<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="append_260"></a>append</h4> 
<ul><li><code>append</code>åé¢è¿½åŠ ä¸€ä¸ªå­—ç¬¦å¯ä»¥è¿›è¡Œå¤ç”¨ <code>push_back</code></li><li><code>append</code>åé¢è¿½åŠ ä¸€ä¸ªå­—ç¬¦ä¸²å’Œæ·»åŠ ä¸€ä¸ª<code>string</code>ç±»æ˜¯ä¸€æ ·çš„æ€è·¯æ˜¯ä¸€æ ·ï¼›</li></ul> 
<pre><code class="prism language-cpp"><span class="token comment">//è¿½åŠ ä¸€ä¸ªå­—ç¬¦</span>
<span class="token keyword">void</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> ch<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
<span class="token function">push_back</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//è¿½åŠ ä¸€ä¸ªå­—ç¬¦ä¸²</span>
<span class="token keyword">void</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
size_t len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">+</span> len <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
<span class="token function">reverse</span><span class="token punctuation">(</span>_capacity <span class="token operator">+</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">memcpy</span><span class="token punctuation">(</span>_str <span class="token operator">+</span> _size<span class="token punctuation">,</span> str<span class="token punctuation">,</span> len <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//è¿½åŠ ä¸€ä¸ªstringç±»</span>
<span class="token keyword">void</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">+</span> str<span class="token punctuation">.</span>_size <span class="token operator">==</span> _capacity<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
<span class="token function">reverse</span><span class="token punctuation">(</span>_size <span class="token operator">+</span> str<span class="token punctuation">.</span>_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">memcpy</span><span class="token punctuation">(</span>_str <span class="token operator">+</span> _size<span class="token punctuation">,</span> str<span class="token punctuation">.</span>_str<span class="token punctuation">,</span> str<span class="token punctuation">.</span>_size<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="operator_293"></a>operator+=</h4> 
<p><mark>ç”±äºæ˜¯å®ç°äº†<code>append</code>å®ç°è¿ç®—ç¬¦é‡è½½å°±æ–¹ä¾¿è·Ÿå¤šï¼ŒåŠŸèƒ½ä¸€æ ·ï¼Œç»“æœä¸€æ ·ç›´æ¥è¿›è¡Œå¤ç”¨</mark></p> 
<pre><code class="prism language-cpp"><span class="token comment">//è¿½åŠ ä¸€ä¸ªå­—ç¬¦</span>
string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">append</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//è¿½åŠ ä¸€ä¸ªå­—ç¬¦ä¸²</span>
string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">append</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//è¿½åŠ ä¸€ä¸ªstringç±»</span>
string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">push_back</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="inset_320"></a>inset</h4> 
<ul><li> <p>å®ç°ä¸¤ä¸ªç‰ˆæœ¬ï¼Œæ’å…¥å­—ç¬¦å’Œæ’å…¥å­—ç¬¦ä¸²</p> </li><li> <p><code>string</code>ç±»æ˜¯æ²¡æœ‰å®ç°<code>push_front</code>å¤´æ’å…¥ï¼Œ<code>insert</code>å°±æœ‰å¾ˆå¤§çš„ä½œç”¨äº†åœ¨<code>pos</code>ä½ç½®è¿›è¡Œæ’å…¥</p> </li><li> <p>é¦–å…ˆè¿›è¡Œ<code>pos</code>ä½ç½®çš„æ–­è¨€ï¼Œä¿è¯<code>pos</code>åœ¨å­—ç¬¦ä¸²çš„æœ‰æ•ˆä½ç½®</p> </li><li> <p>è¿›è¡Œå®¹é‡æ£€æŸ¥ï¼Œè¿›è¡Œæ‰©å®¹.</p> </li><li> <p>å°†<code>pos</code>ä½ç½®åé¢çš„å­—ç¬¦ï¼ˆä»¥åŠ<code>pos</code>ä½ç½®ï¼‰ä¾æ¬¡å‘åé¢ç§»<code>len</code>ä¸ªé•¿åº¦ï¼Œåœ¨<code>pos</code>ä½ç½®æ’å…¥å­—ç¬¦ï¼ˆå­—ç¬¦ä¸²ï¼‰</p> </li><li> <p><code>i!= npos</code>åœ¨<code>for</code>å¾ªç¯ä¸­å¦‚æœ<code>i</code>å˜æˆäº†0ï¼Œä¹‹åå†å»å‡1 ï¼Œ<code>size_t</code>ä¸‹çš„<code>-1</code>ä¼šå˜ä¸ºæ— çº¿å¤§ï¼Œä¼šé™·å…¥æ­»å¾ªç¯ã€‚</p> </li><li> <p>æœ€åä¸è¦å¿˜è®°å°†<code>_size</code>è¿›è¡Œä¿®æ”¹</p> </li></ul> 
<pre><code class="prism language-cpp"><span class="token comment">//æ’å…¥å­—ç¬¦</span>
string<span class="token operator">&amp;</span> <span class="token function">insert</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> <span class="token keyword">char</span> c<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>_capacity <span class="token operator">==</span> _size<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">reverse</span><span class="token punctuation">(</span>_size<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> _size<span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> pos<span class="token operator">&amp;&amp;</span> i<span class="token operator">!=</span> npos<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        _str<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> _str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    _str<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">;</span>
    _size<span class="token operator">++</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//æ’å…¥å­—ç¬¦ä¸²</span>
string<span class="token operator">&amp;</span> <span class="token function">insert</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    size_t len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_capacity <span class="token operator">==</span> _size<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>			
        <span class="token function">reverse</span><span class="token punctuation">(</span>_size <span class="token operator">+</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> _size<span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> pos<span class="token operator">&amp;&amp;</span> i<span class="token operator">!=</span> npos<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        _str<span class="token punctuation">[</span>i <span class="token operator">+</span> len<span class="token punctuation">]</span> <span class="token operator">=</span> _str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
    <span class="token function">memcpy</span><span class="token punctuation">(</span>_str <span class="token operator">+</span> pos<span class="token punctuation">,</span> str<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    _size<span class="token operator">+=</span>len<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="erase_381"></a>erase</h4> 
<ul><li> <p>é¦–å…ˆè¿›è¡Œ<code>pos</code>ä½ç½®çš„æ–­è¨€ï¼Œä¿è¯<code>pos</code>åœ¨å­—ç¬¦ä¸²çš„æœ‰æ•ˆä½ç½®</p> </li><li> <p><code>erase</code>æ˜¯åœ¨<code>pos</code>ä½ç½®åˆ é™¤<code>len</code>ä¸ªå­—ç¬¦ï¼ˆç¼ºçœå€¼ï¼š<code>npos</code>ï¼‰</p> </li><li> <p>å‡½æ•°ä¸»ä½“è¿›å…¥è¿›<code>len</code>çš„åˆ¤æ–­ï¼Œå¦‚æœ<code>len == npos </code>æˆ–<code> pos + len &gt;= _size</code>è¶…å‡ºå­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œå°±æ˜¯ä»<code>pos</code>åå…¨éƒ¨åˆ é™¤</p> </li><li> <p>å¦åˆ™æ²¡æœ‰è¶…è¿‡å°†<code>pos + len</code>ä½ç½®åé¢çš„æ•°æ®å°† <code>pos</code>ä½ç½®ç§»åŠ¨ç›´è‡³ç§»åŠ¨åˆ°<code>\0</code></p> </li></ul> 
<pre><code class="prism language-cpp">string<span class="token operator">&amp;</span> <span class="token function">erase</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> size_t len <span class="token operator">=</span> npos<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">==</span> npos <span class="token operator">||</span> pos <span class="token operator">+</span> len <span class="token operator">&gt;=</span> _size<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        _str<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
        _size <span class="token operator">=</span> pos<span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{<!-- --></span>
        size_t end <span class="token operator">=</span> pos <span class="token operator">+</span> len<span class="token punctuation">;</span>

        <span class="token keyword">while</span> <span class="token punctuation">(</span>end <span class="token operator">&lt;=</span> _size<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            _str<span class="token punctuation">[</span>pos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> _str<span class="token punctuation">[</span>end<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        _size <span class="token operator">-=</span> len<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="swap_414"></a>swap</h4> 
<ul><li>åˆ©ç”¨C++åº“ä¸­çš„swapè¿›è¡Œ<code>string</code>ç±»çš„äº¤æ¢</li></ul> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
string <span class="token function">tmp</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> tmp<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_size<span class="token punctuation">,</span> tmp<span class="token punctuation">.</span>_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_capacity<span class="token punctuation">,</span> tmp<span class="token punctuation">.</span>_capacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="Element_access_428"></a>å…ƒç´ è®¿é—®ï¼ˆElement accessï¼‰</h3> 
<h4><a id="operator___430"></a>operator [ ]</h4> 
<ul><li>å®ç°<code>const</code>å’Œ<code>éconst</code>ä¸¤ç§ï¼Œåªè¯»å’Œå¯è¯»å¯æ”¹</li><li>å……åˆ†åˆ©ç”¨å­—ç¬¦ä¸²ç‰¹æ€§å¯ä»¥è¿›è¡Œä¸‹æ ‡çš„è®¿é—®</li></ul> 
<pre><code class="prism language-cpp"><span class="token comment">//const</span>
<span class="token keyword">char</span><span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>size_t index<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">assert</span><span class="token punctuation">(</span>index <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> _str<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//nonconst</span>
<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>size_t index<span class="token punctuation">)</span><span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">assert</span><span class="token punctuation">(</span>index <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> _str<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="String_operations_452"></a>å­—ç¬¦ä¸²æ“ä½œï¼ˆString operationsï¼‰</h3> 
<h4><a id="c_str_454"></a>c_str</h4> 
<ul><li>ç›´æ¥è¿”å›<code>_str</code></li></ul> 
<pre><code class="prism language-cpp"><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> _str<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="find_465"></a>find</h4> 
<ul><li>é¦–å…ˆè¿›è¡Œ<code>pos</code>ä½ç½®çš„æ–­è¨€ï¼Œä¿è¯<code>pos</code>åœ¨å­—ç¬¦ä¸²çš„æœ‰æ•ˆä½ç½®</li><li>å­—ç¬¦ä¸²æŸ¥æ‰¾åˆ©ç”¨Cè¯­è¨€ä¸­çš„<code>strstr</code>å‡½æ•°è¿›è¡ŒæŸ¥æ‰¾</li><li>è¿”å›ä¸‹é¢çš„ä¸‹æ ‡ï¼Œåˆ©ç”¨æŒ‡é’ˆå‡æŒ‡é’ˆçš„æ–¹æ³•ï¼Œæ²¡æœ‰æ‰¾åˆ°è¿”å›<code>npos</code></li></ul> 
<pre><code class="prism language-cpp">size_t <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> s<span class="token punctuation">,</span> size_t pos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span><span class="token operator">*</span> p <span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> p <span class="token operator">-</span> _str<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> npos<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="relational_operators_489"></a>å…³ç³»è¿ç®—ç¬¦(relational operators)</h3> 
<p><mark>è¿›è¡Œæ¯”è¾ƒçš„é‡è½½</mark></p> 
<ul><li>å®ç°<code>&lt;</code> <code>==</code>å…¶ä»–çš„è¿›è¡Œå¤ç”¨å³å¯</li><li>ä½¿ç”¨<code>memcpy</code>è¿›è¡Œæ¯”è¾ƒï¼Œæ¯”è¾ƒå­—ç¬¦ä¸²è¾ƒå°çš„é‚£ä¸ª<code>_size &lt; s._size ?_size : s._size</code></li><li>è¿”å› ä¸º 0 è¿”å›æ¯”è¾ƒé•¿ï¼ˆ<code>_size &lt; s._size</code>ï¼‰çš„é‚£ä¸ªå¦åˆ™è¿”å›å‡ï¼ˆ <code>ret &lt; 0</code>ï¼‰</li></ul> 
<pre><code class="prism language-cpp"><span class="token comment">//é‡è½½&lt;</span>
<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token function">memcmp</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">,</span> <span class="token punctuation">(</span>_size <span class="token operator">&lt;</span> s<span class="token punctuation">.</span>_size <span class="token operator">?</span>_size <span class="token operator">:</span> s<span class="token punctuation">.</span>_size<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> ret <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> _size <span class="token operator">&lt;</span> s<span class="token punctuation">.</span>_size <span class="token operator">:</span> ret <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//é‡è½½==</span>
<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> _size <span class="token operator">==</span> s<span class="token punctuation">.</span>_size <span class="token operator">&amp;&amp;</span> <span class="token function">memcmp</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">,</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//é‡è½½&lt;=</span>
<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">&gt;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//é‡è½½&gt;</span>
<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">&lt;=</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//é‡è½½&gt;=</span>
<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&gt;=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">&lt;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//é‡è½½!=</span>
<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">==</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_532"></a>æµæå–å’Œæ’</h3> 
<h4><a id="operator_534"></a>operator&lt;&lt;</h4> 
<ul><li>è¿™ä¸ªå‡½æ•°æ˜¯å†™åœ¨ç±»å¤–é¢çš„ä¸€ä¸ªå‹å…ƒå‡½æ•°</li><li>ä½¿ç”¨èŒƒå›´<code>for</code>è¿›è¡Œå®ç°</li></ul> 
<pre><code class="prism language-cpp">ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">,</span> <span class="token keyword">const</span> mystr<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> ch <span class="token operator">:</span> s<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		out <span class="token operator">&lt;&lt;</span> ch<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> out<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="operator_550"></a>operator&gt;&gt;</h4> 
<ul><li><code>s.clear();</code>è¿™å¥è¯æ˜¯æ¸…ç†ç¼“å†²åŒºä¸Šæ¬¡<code>cin</code>çš„æ®‹ç•™</li><li>ç¬¬ä¸€ä¸ª<code>while</code>å¾ªç¯æ˜¯å¤„ç†ç¼“å†²åŒºçš„ç©ºæ ¼</li><li>åˆ›å»ºä¸€ä¸ªæ•°ç»„ï¼Œé¿å…å¤šæ¬¡å¼€è¾Ÿç©ºé—´ï¼Œç›´è‡³å¤§å°åˆ°128æ‹·è´ä¼šåŠ åˆ°<code>string</code> s ä¸­</li><li>æœ€åçš„<code>if</code>è¯­å¥æ˜¯å­—ç¬¦é‡è§ç©ºæ ¼æˆ–è€…æ¢è¡Œç»“æŸï¼Œæœ«å°¾æ·»åŠ <code>\0</code></li></ul> 
<pre><code class="prism language-cpp">istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> in<span class="token punctuation">,</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    s<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">char</span> ch <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å¤„ç†å‰ç¼“å†²åŒºå‰é¢çš„ç©ºæ ¼æˆ–è€…æ¢è¡Œ</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token char">' '</span> <span class="token operator">||</span> ch <span class="token operator">==</span> <span class="token char">'\n'</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        ch <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">char</span> buff<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">!=</span> <span class="token char">' '</span> <span class="token operator">&amp;&amp;</span> ch <span class="token operator">!=</span> <span class="token char">'\n'</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        buff<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">127</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            buff<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
            s <span class="token operator">+=</span> buff<span class="token punctuation">;</span>
            i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        ch <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        buff<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
        s <span class="token operator">+=</span> buff<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> in<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="mystr_string__594"></a><code>mystr:: string </code>æºç </h2> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;assert.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>


<span class="token keyword">namespace</span> mystr
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">class</span> <span class="token class-name">string</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">friend</span> ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> _cout<span class="token punctuation">,</span> <span class="token keyword">const</span> mystr<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">friend</span> istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> _cin<span class="token punctuation">,</span>mystr<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span><span class="token operator">:</span>
		<span class="token keyword">typedef</span> <span class="token keyword">char</span><span class="token operator">*</span> iterator<span class="token punctuation">;</span>
		<span class="token keyword">typedef</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> const_iterator<span class="token punctuation">;</span>


		<span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span>
			<span class="token operator">:</span><span class="token function">_size</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token punctuation">,</span> <span class="token function">_capacity</span><span class="token punctuation">(</span>_size<span class="token punctuation">)</span>
			<span class="token punctuation">,</span> <span class="token function">_str</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>_capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>	
			<span class="token function">memcpy</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> str<span class="token punctuation">,</span> _capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//ææ„å‡½æ•°</span>
		<span class="token operator">~</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			_capacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> _str<span class="token punctuation">;</span>
			_str <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// æ‹·è´æ„é€ å‡½æ•°</span>
		<span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_capacity <span class="token operator">=</span> s<span class="token punctuation">.</span>_capacity<span class="token punctuation">;</span>
			_size <span class="token operator">=</span> s<span class="token punctuation">.</span>_size<span class="token punctuation">;</span>
			_str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>s<span class="token punctuation">.</span>_capacity<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token function">memcpy</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">,</span> _capacity<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//èµ‹å€¼é¢„ç®—ç¬¦é‡è½½</span>
		string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>

			_capacity <span class="token operator">=</span> s<span class="token punctuation">.</span>_capacity<span class="token punctuation">;</span>
			_size <span class="token operator">=</span> s<span class="token punctuation">.</span>_size<span class="token punctuation">;</span>
			_str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>_capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token function">memcpy</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">,</span> _capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token punctuation">}</span>
		<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _str<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">//è¿­ä»£å™¨</span>
		iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _str<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _str <span class="token operator">+</span> _size<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span> 
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _str<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _str <span class="token operator">+</span> _size<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
		<span class="token comment">//capacity</span>

		size_t <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _size<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		size_t <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _capacity<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">void</span> <span class="token function">reverse</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token keyword">char</span><span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token function">memcpy</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> _str<span class="token punctuation">,</span> _capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> _str<span class="token punctuation">;</span>
				_capacity <span class="token operator">=</span> n<span class="token punctuation">;</span>
				_str <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

		<span class="token punctuation">}</span>
		<span class="token keyword">void</span> <span class="token function">resize</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">,</span><span class="token keyword">char</span> ch <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				_str<span class="token punctuation">[</span>n <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
				_size <span class="token operator">=</span> n<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">reverse</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> _size<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					_str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				_str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
				_size <span class="token operator">=</span> n<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

		<span class="token punctuation">}</span>

		<span class="token keyword">bool</span> <span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _size <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
		<span class="token comment">//access</span>

		<span class="token comment">//modify</span>
		
		<span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">==</span> _capacity<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">reverse</span><span class="token punctuation">(</span>_capacity <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">4</span> <span class="token operator">:</span> _capacity <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			_str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>
			_str<span class="token punctuation">[</span>_size <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
			_size<span class="token operator">++</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">void</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> ch<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">push_back</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">void</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			size_t len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">+</span> len <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">reverse</span><span class="token punctuation">(</span>_capacity <span class="token operator">+</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token function">memcpy</span><span class="token punctuation">(</span>_str <span class="token operator">+</span> _size<span class="token punctuation">,</span> str<span class="token punctuation">,</span> len <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">void</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">+</span> str<span class="token punctuation">.</span>_size <span class="token operator">==</span> _capacity<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">reverse</span><span class="token punctuation">(</span>_size <span class="token operator">+</span> str<span class="token punctuation">.</span>_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token function">memcpy</span><span class="token punctuation">(</span>_str <span class="token operator">+</span> _size<span class="token punctuation">,</span> str<span class="token punctuation">.</span>_str<span class="token punctuation">,</span> str<span class="token punctuation">.</span>_size<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>


		string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">append</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">append</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">push_back</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
			_size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			string <span class="token function">tmp</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
			std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> tmp<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
			std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_size<span class="token punctuation">,</span> tmp<span class="token punctuation">.</span>_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
			std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_capacity<span class="token punctuation">,</span> tmp<span class="token punctuation">.</span>_capacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//relational operators</span>
		<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token function">memcmp</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">,</span> <span class="token punctuation">(</span>_size <span class="token operator">&lt;</span> s<span class="token punctuation">.</span>_size <span class="token operator">?</span>_size <span class="token operator">:</span> s<span class="token punctuation">.</span>_size<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">return</span> ret <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> _size <span class="token operator">&lt;</span> s<span class="token punctuation">.</span>_size <span class="token operator">:</span> <span class="token generic-function"><span class="token function">ret</span> <span class="token generic class-name"><span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _size <span class="token operator">==</span> s<span class="token punctuation">.</span>_size <span class="token operator">&amp;&amp;</span> <span class="token function">memcmp</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">,</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">&gt;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>


		<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">&lt;=</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&gt;=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">&lt;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">==</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// è¿”å›cåœ¨stringä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</span>

		size_t <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">char</span> c<span class="token punctuation">,</span> size_t pos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> pos<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> _size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>_str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> c<span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					<span class="token keyword">return</span> i<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">return</span> npos<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>


		<span class="token comment">// è¿”å›å­ä¸²såœ¨stringä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</span>

		size_t <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> s<span class="token punctuation">,</span> size_t pos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">char</span><span class="token operator">*</span> p <span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token keyword">return</span> p <span class="token operator">-</span> _str<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token keyword">return</span> npos<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		
		<span class="token punctuation">}</span>

		<span class="token comment">// åœ¨posä½ç½®ä¸Šæ’å…¥å­—ç¬¦c/å­—ç¬¦ä¸²strï¼Œå¹¶è¿”å›è¯¥å­—ç¬¦çš„ä½ç½®</span>

		string<span class="token operator">&amp;</span> <span class="token function">insert</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> <span class="token keyword">char</span> c<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span>_capacity <span class="token operator">==</span> _size<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">reverse</span><span class="token punctuation">(</span>_size<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> _size<span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> pos<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				_str<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> _str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			_str<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">;</span>
			_size<span class="token operator">++</span><span class="token punctuation">;</span>
		
			<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		string<span class="token operator">&amp;</span> <span class="token function">insert</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
			size_t len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>_capacity <span class="token operator">==</span> _size<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>			
				<span class="token function">reverse</span><span class="token punctuation">(</span>_size <span class="token operator">+</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> _size<span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> pos<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				_str<span class="token punctuation">[</span>i <span class="token operator">+</span> len<span class="token punctuation">]</span> <span class="token operator">=</span> _str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

			<span class="token punctuation">}</span>
			<span class="token function">memcpy</span><span class="token punctuation">(</span>_str <span class="token operator">+</span> pos<span class="token punctuation">,</span> str<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
			_size<span class="token operator">+=</span>len<span class="token punctuation">;</span>

			<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
		
		<span class="token punctuation">}</span>

		string<span class="token operator">&amp;</span> <span class="token function">erase</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> size_t len <span class="token operator">=</span> npos<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span>_capacity <span class="token operator">==</span> _size<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">reverse</span><span class="token punctuation">(</span>_size <span class="token operator">+</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token punctuation">}</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">==</span> npos <span class="token operator">||</span> pos <span class="token operator">+</span> len <span class="token operator">&gt;=</span> _size<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				_str<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
				_size <span class="token operator">=</span> pos<span class="token punctuation">;</span>

			<span class="token punctuation">}</span>
			<span class="token keyword">else</span>
			<span class="token punctuation">{<!-- --></span>
				size_t end <span class="token operator">=</span> pos <span class="token operator">+</span> len<span class="token punctuation">;</span>

				<span class="token keyword">while</span> <span class="token punctuation">(</span>end <span class="token operator">&lt;=</span> _size<span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					_str<span class="token punctuation">[</span>pos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> _str<span class="token punctuation">[</span>end<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				_size <span class="token operator">-=</span> len<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		
		<span class="token punctuation">}</span>

	<span class="token keyword">private</span><span class="token operator">:</span>		
		size_t _size<span class="token punctuation">;</span>

		size_t _capacity<span class="token punctuation">;</span>
		<span class="token keyword">char</span><span class="token operator">*</span> _str<span class="token punctuation">;</span>

		<span class="token keyword">public</span><span class="token operator">:</span>

		
		<span class="token keyword">const</span> <span class="token keyword">static</span> size_t npos<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token keyword">const</span> size_t string<span class="token double-colon punctuation">::</span>npos <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	
	ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">,</span> <span class="token keyword">const</span> mystr<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> ch <span class="token operator">:</span> s<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token generic-function"><span class="token function">out</span> <span class="token generic class-name"><span class="token operator">&lt;&lt;</span> ch<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> out<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&gt;&gt;</span></span></span><span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> in<span class="token punctuation">,</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//æ¸…é™¤ç¼“å†²åŒº</span>
		s<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">char</span> ch <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token char">' '</span> <span class="token operator">||</span> ch <span class="token operator">==</span> <span class="token char">'\n'</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			ch <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">char</span> buff<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

		<span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">!=</span> <span class="token char">' '</span> <span class="token operator">&amp;&amp;</span> ch <span class="token operator">!=</span> <span class="token char">'\n'</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			buff<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">127</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				buff<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
				s <span class="token operator">+=</span> buff<span class="token punctuation">;</span>
				i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			ch <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			buff<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
			s <span class="token operator">+=</span> buff<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">return</span> in<span class="token punctuation">;</span>

	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>                                                                                              
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/332e897a82e224a6cbab8ff6fc264d62/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">æ‰“é€ ä¸€ç¯‡å®Œç¾çš„ã€æ•°å­¦å»ºæ¨¡ç«èµ›è®ºæ–‡ã€‘ï¼šä»å‡†å¤‡åˆ°æ’°å†™çš„å…¨é¢æŒ‡å—</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e2f020de462793ef4490c4923b68090b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">äº”ä¸ªä¼˜ç§€çš„å…è´¹ Ollama WebUI å®¢æˆ·ç«¯æ¨è</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§å’–.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>