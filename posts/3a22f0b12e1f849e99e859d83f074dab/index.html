<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android11.0 生成系统签名.jks文件并对Apk进行签名 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/3a22f0b12e1f849e99e859d83f074dab/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Android11.0 生成系统签名.jks文件并对Apk进行签名">
  <meta property="og:description" content="文章目录 V2签名生成.jks签名文件使用命令查看.jks文件Studio引用platform.jks使用platform.jks手动签名APK使用命令查看APK文件签名信息 V2签名 对应用手动进行系统签名，需要platform.pk8，platform.x509.pem，signapk.jar这三个文件，应用的AndroidManifest.xml中需要添加android:sharedUserId=“android.uid.system” ，然后输入以下命令就可得到签名后的apk文件：
java -jar signapk.jar platform.x509.pem platform.pk8 target.apk sign.apk 如果你的应用targetSdkVersion&gt;=30，在7.0以上的设备上安装不成功，会报以下错误：
Failure [INSTALL_PARSE_FAILED_NO_CERTIFICATES: Scanning Failed.: No signature found in package of version 2 or newer for package com.xxx.fotatest] 对于以Android11(Api30）为目标平台，apk必须使用V2及以上签名否则无法安装成功。
下面介绍一种使用系统文件生成.jks签名文件的方式对Apk进行系统签名。
生成.jks签名文件 在源码中进入到/build/target/product/security目录，输入以下命令:
cd build/target/product/security/ // 1.生成 platform.pem openssl pkcs8 -inform DER -nocrypt -in platform.pk8 -out platform.pem // 2.生成 platform.p12 // 别名：systemkey // 密码：123456 openssl pkcs12 -export -in platform.x509.pem -out platform.p12 -inkey platform.pem -password pass:123456 -name systemkey // 3.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-09-14T15:22:47+08:00">
    <meta property="article:modified_time" content="2023-09-14T15:22:47+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android11.0 生成系统签名.jks文件并对Apk进行签名</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><ul><li><a href="#V2_1" rel="nofollow">V2签名</a></li><li><a href="#jks_16" rel="nofollow">生成.jks签名文件</a></li><li><a href="#jks_57" rel="nofollow">使用命令查看.jks文件</a></li><li><a href="#Studioplatformjks_110" rel="nofollow">Studio引用platform.jks</a></li><li><a href="#platformjksAPK_141" rel="nofollow">使用platform.jks手动签名APK</a></li><li><a href="#APK_155" rel="nofollow">使用命令查看APK文件签名信息</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h4><a id="V2_1"></a>V2签名</h4> 
<p>对应用手动进行系统签名，需要platform.pk8，platform.x509.pem，signapk.jar这三个文件，应用的AndroidManifest.xml中需要添加<font color="DC143C">android:sharedUserId=“android.uid.system”</font> ，然后输入以下命令就可得到签名后的apk文件：</p> 
<pre><code class="prism language-java"> java <span class="token operator">-</span>jar signapk<span class="token punctuation">.</span>jar platform<span class="token punctuation">.</span>x509<span class="token punctuation">.</span>pem platform<span class="token punctuation">.</span>pk8 target<span class="token punctuation">.</span>apk sign<span class="token punctuation">.</span>apk
</code></pre> 
<p>如果你的应用<font color="DC143C">targetSdkVersion&gt;=30</font>，在7.0以上的设备上安装不成功，会报以下错误：</p> 
<pre><code class="prism language-java"> <span class="token class-name">Failure</span> <span class="token punctuation">[</span><span class="token constant">INSTALL_PARSE_FAILED_NO_CERTIFICATES</span><span class="token operator">:</span> <span class="token class-name">Scanning</span> <span class="token class-name">Failed</span><span class="token punctuation">.</span><span class="token punctuation">:</span> <span class="token class-name">No</span> signature found in <span class="token keyword">package</span> <span class="token namespace">of</span> version <span class="token number">2</span> or newer <span class="token keyword">for</span> <span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>xxx<span class="token punctuation">.</span>fotatest</span><span class="token punctuation">]</span>
</code></pre> 
<p>对于以Android11(Api30）为目标平台，apk必须使用V2及以上签名否则无法安装成功。<br> 下面介绍一种使用系统文件生成.jks签名文件的方式对Apk进行系统签名。</p> 
<h4><a id="jks_16"></a>生成.jks签名文件</h4> 
<p>在源码中进入到/build/target/product/security目录，输入以下命令:</p> 
<pre><code class="prism language-java"> cd build<span class="token operator">/</span>target<span class="token operator">/</span>product<span class="token operator">/</span>security<span class="token operator">/</span>

 <span class="token comment">// 1.生成 platform.pem</span>
 openssl pkcs8 <span class="token operator">-</span>inform <span class="token constant">DER</span> <span class="token operator">-</span>nocrypt <span class="token operator">-</span>in platform<span class="token punctuation">.</span>pk8 <span class="token operator">-</span>out platform<span class="token punctuation">.</span>pem

 <span class="token comment">// 2.生成 platform.p12 </span>
 <span class="token comment">// 别名：systemkey</span>
 <span class="token comment">// 密码：123456</span>
 openssl pkcs12 <span class="token operator">-</span>export <span class="token operator">-</span>in  platform<span class="token punctuation">.</span>x509<span class="token punctuation">.</span>pem <span class="token operator">-</span>out platform<span class="token punctuation">.</span>p12 <span class="token operator">-</span>inkey  platform<span class="token punctuation">.</span>pem <span class="token operator">-</span>password pass<span class="token operator">:</span><span class="token number">123456</span> <span class="token operator">-</span>name systemkey

 <span class="token comment">// 3.生成 platform.jks文件</span>
 keytool <span class="token operator">-</span>importkeystore <span class="token operator">-</span>deststorepass <span class="token number">123456</span> <span class="token operator">-</span>destkeystore <span class="token punctuation">.</span>/platform<span class="token punctuation">.</span>jks <span class="token operator">-</span>srckeystore <span class="token punctuation">.</span>/platform<span class="token punctuation">.</span>p12 <span class="token operator">-</span>srcstoretype <span class="token constant">PKCS12</span> <span class="token operator">-</span>srcstorepass <span class="token number">123456</span>
</code></pre> 
<p>输入第三条命令会提示让你输入源密钥库口令: 直接输入123456</p> 
<pre><code class="prism language-java"> 正在将密钥库 <span class="token punctuation">.</span>/platform<span class="token punctuation">.</span>p12 导入到 <span class="token punctuation">.</span>/platform<span class="token punctuation">.</span>jks<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 输入源密钥库口令<span class="token operator">:</span>  
 已成功导入别名 systemkey 的条目。
 已完成导入命令<span class="token operator">:</span> <span class="token number">1</span> 个条目成功导入<span class="token punctuation">,</span> <span class="token number">0</span> 个条目失败或取消

 <span class="token class-name">Warning</span><span class="token operator">:</span>
 <span class="token generics"><span class="token punctuation">&lt;</span>systemkey<span class="token punctuation">&gt;</span></span> <span class="token keyword">uses</span> <span class="token namespace">the</span> <span class="token class-name">MD5withRSA</span> signature algorithm which is considered a security risk and is disabled<span class="token punctuation">.</span>
 <span class="token constant">JKS</span> 密钥库使用专用格式。建议使用 <span class="token string">"keytool -importkeystore -srckeystore ./platform.jks -destkeystore ./platform.jks -deststoretype pkcs12"</span> 迁移到行业标准格式 <span class="token constant">PKCS12</span>。
</code></pre> 
<p>上面已完成导入命令行表明.jks文件制作成功了，根据建议的命令迁移到行业标准格式</p> 
<pre><code class="prism language-java"> keytool <span class="token operator">-</span>importkeystore <span class="token operator">-</span>srckeystore <span class="token punctuation">.</span>/platform<span class="token punctuation">.</span>jks <span class="token operator">-</span>destkeystore <span class="token punctuation">.</span>/platform<span class="token punctuation">.</span>jks <span class="token operator">-</span>deststoretype pkcs12
 输入源密钥库口令<span class="token operator">:</span>  
 已成功导入别名 systemkey 的条目。
 已完成导入命令<span class="token operator">:</span> <span class="token number">1</span> 个条目成功导入<span class="token punctuation">,</span> <span class="token number">0</span> 个条目失败或取消

 <span class="token class-name">Warning</span><span class="token operator">:</span>
 <span class="token generics"><span class="token punctuation">&lt;</span>systemkey<span class="token punctuation">&gt;</span></span> <span class="token keyword">uses</span> <span class="token namespace">the</span> <span class="token class-name">MD5withRSA</span> signature algorithm which is considered a security risk and is disabled<span class="token punctuation">.</span>
 已将 <span class="token string">"./platform.jks"</span> 迁移到 <span class="token class-name">Non</span> <span class="token constant">JKS</span><span class="token operator">/</span><span class="token constant">JCEKS</span>。将 <span class="token constant">JKS</span> 密钥库作为 <span class="token string">"./platform.jks.old"</span> 进行了备份。
</code></pre> 
<p>同目录下会生成platform.pem，platform.p12，platform.jks，platform.jks.old</p> 
<h4><a id="jks_57"></a>使用命令查看.jks文件</h4> 
<pre><code class="prism language-java"> keytool <span class="token operator">-</span>list <span class="token operator">-</span>v <span class="token operator">-</span>keystore platform<span class="token punctuation">.</span>jks
 输入密钥库口令<span class="token operator">:</span>  
 密钥库类型<span class="token operator">:</span> <span class="token constant">PKCS12</span>
 密钥库提供方<span class="token operator">:</span> <span class="token constant">SUN</span>

 您的密钥库包含 <span class="token number">1</span> 个条目

 别名<span class="token operator">:</span> systemkey
 创建日期<span class="token operator">:</span> <span class="token number">2023</span><span class="token operator">-</span><span class="token number">6</span><span class="token operator">-</span><span class="token number">20</span>
 条目类型<span class="token operator">:</span> <span class="token class-name">PrivateKeyEntry</span>
 证书链长度<span class="token operator">:</span> <span class="token number">1</span>
 证书<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">:</span>
 所有者<span class="token operator">:</span> <span class="token constant">EMAILADDRESS</span><span class="token operator">=</span>android<span class="token annotation punctuation">@android.com</span><span class="token punctuation">,</span> <span class="token constant">CN</span><span class="token operator">=</span><span class="token class-name">Android</span><span class="token punctuation">,</span> <span class="token constant">OU</span><span class="token operator">=</span><span class="token class-name">Android</span><span class="token punctuation">,</span> <span class="token class-name">O</span><span class="token operator">=</span><span class="token class-name">Android</span><span class="token punctuation">,</span> <span class="token class-name">L</span><span class="token operator">=</span><span class="token class-name">Mountain</span> <span class="token class-name">View</span><span class="token punctuation">,</span> <span class="token constant">ST</span><span class="token operator">=</span><span class="token class-name">California</span><span class="token punctuation">,</span> <span class="token class-name">C</span><span class="token operator">=</span><span class="token constant">US</span>
 发布者<span class="token operator">:</span> <span class="token constant">EMAILADDRESS</span><span class="token operator">=</span>android<span class="token annotation punctuation">@android.com</span><span class="token punctuation">,</span> <span class="token constant">CN</span><span class="token operator">=</span><span class="token class-name">Android</span><span class="token punctuation">,</span> <span class="token constant">OU</span><span class="token operator">=</span><span class="token class-name">Android</span><span class="token punctuation">,</span> <span class="token class-name">O</span><span class="token operator">=</span><span class="token class-name">Android</span><span class="token punctuation">,</span> <span class="token class-name">L</span><span class="token operator">=</span><span class="token class-name">Mountain</span> <span class="token class-name">View</span><span class="token punctuation">,</span> <span class="token constant">ST</span><span class="token operator">=</span><span class="token class-name">California</span><span class="token punctuation">,</span> <span class="token class-name">C</span><span class="token operator">=</span><span class="token constant">US</span>
 序列号<span class="token operator">:</span> b3998086d056cffa
 有效期为 <span class="token class-name">Wed</span> <span class="token class-name">Apr</span> <span class="token number">16</span> <span class="token number">06</span><span class="token operator">:</span><span class="token number">40</span><span class="token operator">:</span><span class="token number">50</span> <span class="token constant">CST</span> <span class="token number">2008</span> 至 <span class="token class-name">Sun</span> <span class="token class-name">Sep</span> <span class="token number">02</span> <span class="token number">06</span><span class="token operator">:</span><span class="token number">40</span><span class="token operator">:</span><span class="token number">50</span> <span class="token constant">CST</span> <span class="token number">2035</span>
 证书指纹<span class="token operator">:</span>
	 <span class="token constant">MD5</span><span class="token operator">:</span>  <span class="token number">27</span><span class="token operator">:</span><span class="token number">19</span><span class="token operator">:</span><span class="token number">6</span>E<span class="token operator">:</span><span class="token number">38</span><span class="token operator">:</span><span class="token number">6</span>B<span class="token operator">:</span><span class="token number">87</span><span class="token operator">:</span><span class="token number">5</span>E<span class="token operator">:</span><span class="token number">76</span><span class="token operator">:</span><span class="token constant">AD</span><span class="token operator">:</span><span class="token constant">F7</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token constant">E7</span><span class="token operator">:</span><span class="token constant">EA</span><span class="token operator">:</span><span class="token number">84</span><span class="token operator">:</span><span class="token constant">E4</span><span class="token operator">:</span><span class="token constant">C6</span><span class="token operator">:</span><span class="token constant">EE</span><span class="token operator">:</span><span class="token constant">E3</span><span class="token operator">:</span><span class="token number">3D</span><span class="token operator">:</span><span class="token constant">FA</span>
	 <span class="token constant">SHA1</span><span class="token operator">:</span> <span class="token constant">C8</span><span class="token operator">:</span><span class="token constant">A2</span><span class="token operator">:</span><span class="token constant">E9</span><span class="token operator">:</span><span class="token constant">BC</span><span class="token operator">:</span><span class="token constant">CF</span><span class="token operator">:</span><span class="token number">59</span><span class="token operator">:</span><span class="token number">7</span>C<span class="token operator">:</span><span class="token number">2F</span><span class="token operator">:</span><span class="token constant">B6</span><span class="token operator">:</span><span class="token constant">DC</span><span class="token operator">:</span><span class="token number">66</span><span class="token operator">:</span><span class="token constant">BE</span><span class="token operator">:</span><span class="token constant">E2</span><span class="token operator">:</span><span class="token number">93</span><span class="token operator">:</span><span class="token constant">FC</span><span class="token operator">:</span><span class="token number">13</span><span class="token operator">:</span><span class="token constant">F2</span><span class="token operator">:</span><span class="token constant">FC</span><span class="token operator">:</span><span class="token number">47</span><span class="token operator">:</span><span class="token constant">EC</span><span class="token operator">:</span><span class="token number">77</span><span class="token operator">:</span><span class="token constant">BC</span><span class="token operator">:</span><span class="token number">6</span>B<span class="token operator">:</span><span class="token number">2</span>B<span class="token operator">:</span><span class="token number">0D</span><span class="token operator">:</span><span class="token number">52</span><span class="token operator">:</span><span class="token constant">C1</span><span class="token operator">:</span><span class="token number">1F</span><span class="token operator">:</span><span class="token number">51</span><span class="token operator">:</span><span class="token number">19</span><span class="token operator">:</span><span class="token number">2</span>A<span class="token operator">:</span><span class="token constant">B8</span>
	 <span class="token constant">SHA256</span><span class="token operator">:</span> <span class="token class-name">MD5withRSA</span> <span class="token punctuation">(</span>disabled<span class="token punctuation">)</span>
 签名算法名称<span class="token operator">:</span> <span class="token number">2048</span> 位 <span class="token constant">RSA</span> 密钥
 主体公共密钥算法<span class="token operator">:</span> <span class="token number">3</span>
 版本<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token number">10</span><span class="token punctuation">}</span>

 扩展<span class="token operator">:</span> 

 #<span class="token number">1</span><span class="token operator">:</span> <span class="token class-name">ObjectId</span><span class="token operator">:</span> <span class="token number">2.5</span><span class="token number">.29</span><span class="token number">.35</span> <span class="token class-name">Criticality</span><span class="token operator">=</span><span class="token boolean">false</span>
 <span class="token class-name">AuthorityKeyIdentifier</span> <span class="token punctuation">[</span>
 <span class="token class-name">KeyIdentifier</span> <span class="token punctuation">[</span>
 <span class="token number">0000</span><span class="token operator">:</span> <span class="token number">4F</span> <span class="token constant">E4</span> <span class="token constant">A0</span> <span class="token constant">B3</span> <span class="token constant">DD</span> <span class="token number">9</span>C <span class="token constant">BA</span> <span class="token number">29</span>   <span class="token constant">F7</span> <span class="token number">1D</span> <span class="token number">72</span> <span class="token number">87</span> <span class="token constant">C4</span> <span class="token constant">E7</span> <span class="token constant">C3</span> <span class="token number">8F</span>  <span class="token class-name">O</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span>r<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 <span class="token number">0010</span><span class="token operator">:</span> <span class="token number">20</span> <span class="token number">86</span> <span class="token constant">C2</span> <span class="token number">99</span>                                         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 <span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token constant">EMAILADDRESS</span><span class="token operator">=</span>android<span class="token annotation punctuation">@android.com</span><span class="token punctuation">,</span> <span class="token constant">CN</span><span class="token operator">=</span><span class="token class-name">Android</span><span class="token punctuation">,</span> <span class="token constant">OU</span><span class="token operator">=</span><span class="token class-name">Android</span><span class="token punctuation">,</span> <span class="token class-name">O</span><span class="token operator">=</span><span class="token class-name">Android</span><span class="token punctuation">,</span> <span class="token class-name">L</span><span class="token operator">=</span><span class="token class-name">Mountain</span> <span class="token class-name">View</span><span class="token punctuation">,</span> <span class="token constant">ST</span><span class="token operator">=</span><span class="token class-name">California</span><span class="token punctuation">,</span> <span class="token class-name">C</span><span class="token operator">=</span><span class="token constant">US</span><span class="token punctuation">]</span>
 <span class="token class-name">SerialNumber</span><span class="token operator">:</span> <span class="token punctuation">[</span>    b3998086 d056cffa<span class="token punctuation">]</span>
 <span class="token punctuation">]</span>

 #<span class="token number">2</span><span class="token operator">:</span> <span class="token class-name">ObjectId</span><span class="token operator">:</span> <span class="token number">2.5</span><span class="token number">.29</span><span class="token number">.19</span> <span class="token class-name">Criticality</span><span class="token operator">=</span><span class="token boolean">false</span>
 <span class="token class-name">BasicConstraints</span><span class="token operator">:</span><span class="token punctuation">[</span>
   <span class="token constant">CA</span><span class="token operator">:</span><span class="token boolean">true</span>
   <span class="token class-name">PathLen</span><span class="token operator">:</span><span class="token number">2147483647</span>
 <span class="token punctuation">]</span>

 #<span class="token number">3</span><span class="token operator">:</span> <span class="token class-name">ObjectId</span><span class="token operator">:</span> <span class="token number">2.5</span><span class="token number">.29</span><span class="token number">.14</span> <span class="token class-name">Criticality</span><span class="token operator">=</span><span class="token boolean">false</span>
 <span class="token class-name">SubjectKeyIdentifier</span> <span class="token punctuation">[</span>
 <span class="token class-name">KeyIdentifier</span> <span class="token punctuation">[</span>
 <span class="token number">0000</span><span class="token operator">:</span> <span class="token number">4F</span> <span class="token constant">E4</span> <span class="token constant">A0</span> <span class="token constant">B3</span> <span class="token constant">DD</span> <span class="token number">9</span>C <span class="token constant">BA</span> <span class="token number">29</span>   <span class="token constant">F7</span> <span class="token number">1D</span> <span class="token number">72</span> <span class="token number">87</span> <span class="token constant">C4</span> <span class="token constant">E7</span> <span class="token constant">C3</span> <span class="token number">8F</span>  <span class="token class-name">O</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span>r<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 <span class="token number">0010</span><span class="token operator">:</span> <span class="token number">20</span> <span class="token number">86</span> <span class="token constant">C2</span> <span class="token number">99</span>                                         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 <span class="token punctuation">]</span>
 <span class="token punctuation">]</span>
</code></pre> 
<h4><a id="Studioplatformjks_110"></a>Studio引用platform.jks</h4> 
<p>app目录下新建key目录，将<font color="DC143C">platform.jks</font>放到key目录下<br> 在build.gradle下添加如下内容：</p> 
<pre><code class="prism language-java"> android <span class="token punctuation">{<!-- --></span>
     <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
     signingConfigs <span class="token punctuation">{<!-- --></span>
        release <span class="token punctuation">{<!-- --></span>
            storeFile <span class="token function">file</span><span class="token punctuation">(</span><span class="token string">"/key/platform.jks"</span><span class="token punctuation">)</span>
            keyAlias <span class="token string">"systemkey"</span>
            keyPassword <span class="token string">"123456"</span>
            storePassword <span class="token string">"123456"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    buildTypes <span class="token punctuation">{<!-- --></span>
        release <span class="token punctuation">{<!-- --></span>
            minifyEnabled <span class="token boolean">false</span>
            proguardFiles <span class="token function">getDefaultProguardFile</span><span class="token punctuation">(</span>'proguard<span class="token operator">-</span>android<span class="token operator">-</span>optimize<span class="token punctuation">.</span>txt<span class="token char">'), '</span>proguard<span class="token operator">-</span>rules<span class="token punctuation">.</span>pro'
            signingConfig signingConfigs<span class="token punctuation">.</span>release
        <span class="token punctuation">}</span>
        debug <span class="token punctuation">{<!-- --></span>
            minifyEnabled <span class="token boolean">false</span>
            proguardFiles <span class="token function">getDefaultProguardFile</span><span class="token punctuation">(</span>'proguard<span class="token operator">-</span>android<span class="token operator">-</span>optimize<span class="token punctuation">.</span>txt<span class="token char">'), '</span>proguard<span class="token operator">-</span>rules<span class="token punctuation">.</span>pro'
            signingConfig signingConfigs<span class="token punctuation">.</span>release
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>   
</code></pre> 
<p>直接运行程序即可。</p> 
<h4><a id="platformjksAPK_141"></a>使用platform.jks手动签名APK</h4> 
<p>将你的Apk文件和<font color="DC143C">platform.jks</font>复制到你的/sdk/build-tools/30.0.2目录下</p> 
<pre><code class="prism language-java"><span class="token comment">// 1.Zipalign 优化 APK</span>
<span class="token class-name">D</span><span class="token operator">:</span>\<span class="token class-name">Studio</span>\sdk\build<span class="token operator">-</span>tools\<span class="token number">30.0</span><span class="token number">.2</span><span class="token operator">&gt;</span>zipalign <span class="token operator">-</span>f <span class="token operator">-</span>v <span class="token number">4</span> target<span class="token punctuation">.</span>apk sign<span class="token punctuation">.</span>apk

<span class="token comment">// 2.签名APK</span>
<span class="token class-name">D</span><span class="token operator">:</span>\<span class="token class-name">Studio</span>\sdk\build<span class="token operator">-</span>tools\<span class="token number">30.0</span><span class="token number">.2</span><span class="token operator">&gt;</span>apksigner sign <span class="token operator">--</span>ks platform<span class="token punctuation">.</span>jks <span class="token operator">--</span>ks<span class="token operator">-</span>key<span class="token operator">-</span>alias systemkey sign<span class="token punctuation">.</span>apk
</code></pre> 
<p>这样就得到签名后应用sign.apk</p> 
<p>注意： 对应用进行系统签名需要应用的AndroidManifest.xml中有添加<font color="DC143C">android:sharedUserId=“android.uid.system”</font></p> 
<h4><a id="APK_155"></a>使用命令查看APK文件签名信息</h4> 
<pre><code class="prism language-java"><span class="token operator">&gt;</span> keytool <span class="token operator">-</span>printcert <span class="token operator">-</span>jarfile sign<span class="token punctuation">.</span>apk
签名者 #<span class="token number">1</span><span class="token operator">:</span>

签名<span class="token operator">:</span>

所有者<span class="token operator">:</span> <span class="token constant">EMAILADDRESS</span><span class="token operator">=</span>android<span class="token annotation punctuation">@android.com</span><span class="token punctuation">,</span> <span class="token constant">CN</span><span class="token operator">=</span>android<span class="token punctuation">,</span> <span class="token constant">OU</span><span class="token operator">=</span>android<span class="token punctuation">,</span> <span class="token class-name">O</span><span class="token operator">=</span>android<span class="token punctuation">,</span> <span class="token class-name">L</span><span class="token operator">=</span><span class="token class-name">Mountain</span> <span class="token class-name">View</span><span class="token punctuation">,</span> <span class="token constant">ST</span><span class="token operator">=</span><span class="token class-name">California</span><span class="token punctuation">,</span> <span class="token class-name">C</span><span class="token operator">=</span><span class="token constant">US</span>
发布者<span class="token operator">:</span> <span class="token constant">EMAILADDRESS</span><span class="token operator">=</span>android<span class="token annotation punctuation">@android.com</span><span class="token punctuation">,</span> <span class="token constant">CN</span><span class="token operator">=</span>android<span class="token punctuation">,</span> <span class="token constant">OU</span><span class="token operator">=</span>android<span class="token punctuation">,</span> <span class="token class-name">O</span><span class="token operator">=</span>android<span class="token punctuation">,</span> <span class="token class-name">L</span><span class="token operator">=</span><span class="token class-name">Mountain</span> <span class="token class-name">View</span><span class="token punctuation">,</span> <span class="token constant">ST</span><span class="token operator">=</span><span class="token class-name">California</span><span class="token punctuation">,</span> <span class="token class-name">C</span><span class="token operator">=</span><span class="token constant">US</span>
序列号<span class="token operator">:</span> <span class="token number">32</span>aec6361322ef35697e6d76a2b65319be7b2d5c
有效期开始日期<span class="token operator">:</span> <span class="token class-name">Thu</span> <span class="token class-name">Aug</span> <span class="token number">24</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">51</span><span class="token operator">:</span><span class="token number">23</span> <span class="token class-name">CST</span> <span class="token number">2023</span><span class="token punctuation">,</span> 截止日期<span class="token operator">:</span> <span class="token class-name">Mon</span> <span class="token class-name">Jan</span> <span class="token number">09</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">51</span><span class="token operator">:</span><span class="token number">23</span> <span class="token constant">CST</span> <span class="token number">2051</span>
证书指纹<span class="token operator">:</span>
         <span class="token constant">MD5</span><span class="token operator">:</span> <span class="token number">96</span><span class="token operator">:</span><span class="token number">5F</span><span class="token operator">:</span><span class="token number">61</span><span class="token operator">:</span><span class="token constant">D7</span><span class="token operator">:</span><span class="token constant">DB</span><span class="token operator">:</span><span class="token number">61</span><span class="token operator">:</span><span class="token number">84</span><span class="token operator">:</span><span class="token number">25</span><span class="token operator">:</span><span class="token constant">CD</span><span class="token operator">:</span><span class="token number">6</span>A<span class="token operator">:</span><span class="token number">5</span>B<span class="token operator">:</span><span class="token constant">C0</span><span class="token operator">:</span><span class="token constant">E1</span><span class="token operator">:</span><span class="token number">3F</span><span class="token operator">:</span><span class="token constant">BA</span><span class="token operator">:</span><span class="token number">6F</span>
         <span class="token constant">SHA1</span><span class="token operator">:</span> <span class="token constant">FA</span><span class="token operator">:</span><span class="token constant">FE</span><span class="token operator">:</span><span class="token constant">E5</span><span class="token operator">:</span><span class="token constant">F9</span><span class="token operator">:</span><span class="token number">09</span><span class="token operator">:</span><span class="token number">7</span>C<span class="token operator">:</span><span class="token constant">ED</span><span class="token operator">:</span><span class="token constant">A3</span><span class="token operator">:</span><span class="token number">67</span><span class="token operator">:</span><span class="token number">39</span><span class="token operator">:</span><span class="token constant">B0</span><span class="token operator">:</span><span class="token constant">BC</span><span class="token operator">:</span><span class="token constant">DC</span><span class="token operator">:</span><span class="token number">36</span><span class="token operator">:</span><span class="token constant">C8</span><span class="token operator">:</span><span class="token constant">F8</span><span class="token operator">:</span><span class="token constant">DE</span><span class="token operator">:</span><span class="token constant">D6</span><span class="token operator">:</span><span class="token number">23</span><span class="token operator">:</span><span class="token number">9F</span>
         <span class="token constant">SHA256</span><span class="token operator">:</span> <span class="token number">6</span>A<span class="token operator">:</span><span class="token constant">A5</span><span class="token operator">:</span><span class="token constant">D2</span><span class="token operator">:</span><span class="token number">29</span><span class="token operator">:</span><span class="token number">1D</span><span class="token operator">:</span><span class="token number">18</span><span class="token operator">:</span><span class="token constant">E6</span><span class="token operator">:</span><span class="token number">28</span><span class="token operator">:</span><span class="token constant">D1</span><span class="token operator">:</span><span class="token number">29</span><span class="token operator">:</span><span class="token number">70</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token constant">A9</span><span class="token operator">:</span><span class="token number">3</span>A<span class="token operator">:</span><span class="token number">29</span><span class="token operator">:</span><span class="token constant">D0</span><span class="token operator">:</span><span class="token constant">A7</span><span class="token operator">:</span><span class="token constant">B6</span><span class="token operator">:</span><span class="token constant">DC</span><span class="token operator">:</span><span class="token constant">B8</span><span class="token operator">:</span><span class="token number">57</span><span class="token operator">:</span><span class="token number">85</span><span class="token operator">:</span><span class="token number">2F</span><span class="token operator">:</span><span class="token constant">BA</span><span class="token operator">:</span><span class="token number">41</span><span class="token operator">:</span><span class="token number">85</span><span class="token operator">:</span><span class="token number">2</span>B<span class="token operator">:</span><span class="token constant">D1</span><span class="token operator">:</span><span class="token number">0F</span><span class="token operator">:</span><span class="token number">5D</span><span class="token operator">:</span><span class="token number">47</span><span class="token operator">:</span><span class="token number">86</span>
         签名算法名称<span class="token operator">:</span> <span class="token class-name">SHA256withRSA</span>
         版本<span class="token operator">:</span> <span class="token number">3</span>

扩展<span class="token operator">:</span>

#<span class="token number">1</span><span class="token operator">:</span> <span class="token class-name">ObjectId</span><span class="token operator">:</span> <span class="token number">2.5</span><span class="token number">.29</span><span class="token number">.35</span> <span class="token class-name">Criticality</span><span class="token operator">=</span><span class="token boolean">false</span>
<span class="token class-name">AuthorityKeyIdentifier</span> <span class="token punctuation">[</span>
<span class="token class-name">KeyIdentifier</span> <span class="token punctuation">[</span>
<span class="token number">0000</span><span class="token operator">:</span> <span class="token number">00</span> <span class="token number">4</span>E <span class="token number">32</span> <span class="token number">24</span> <span class="token number">3D</span> <span class="token constant">B6</span> <span class="token number">55</span> <span class="token number">3</span>E   <span class="token number">35</span> <span class="token constant">D8</span> <span class="token number">48</span> <span class="token number">47</span> <span class="token number">1</span>E <span class="token number">5</span>A <span class="token constant">CA</span> <span class="token number">44</span>  <span class="token punctuation">.</span><span class="token constant">N2</span>$<span class="token operator">=</span><span class="token punctuation">.</span>U<span class="token operator">&gt;</span><span class="token number">5.</span><span class="token constant">HG</span><span class="token punctuation">.</span>Z<span class="token punctuation">.</span>D
<span class="token number">0010</span><span class="token operator">:</span> <span class="token constant">F8</span> <span class="token constant">C1</span> <span class="token number">12</span> <span class="token number">2</span>E                                        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>

#<span class="token number">2</span><span class="token operator">:</span> <span class="token class-name">ObjectId</span><span class="token operator">:</span> <span class="token number">2.5</span><span class="token number">.29</span><span class="token number">.19</span> <span class="token class-name">Criticality</span><span class="token operator">=</span><span class="token boolean">true</span>
<span class="token class-name">BasicConstraints</span><span class="token operator">:</span><span class="token punctuation">[</span>
  <span class="token constant">CA</span><span class="token operator">:</span><span class="token boolean">true</span>
  <span class="token class-name">PathLen</span><span class="token operator">:</span><span class="token number">2147483647</span>
<span class="token punctuation">]</span>

#<span class="token number">3</span><span class="token operator">:</span> <span class="token class-name">ObjectId</span><span class="token operator">:</span> <span class="token number">2.5</span><span class="token number">.29</span><span class="token number">.14</span> <span class="token class-name">Criticality</span><span class="token operator">=</span><span class="token boolean">false</span>
<span class="token class-name">SubjectKeyIdentifier</span> <span class="token punctuation">[</span>
<span class="token class-name">KeyIdentifier</span> <span class="token punctuation">[</span>
<span class="token number">0000</span><span class="token operator">:</span> <span class="token number">00</span> <span class="token number">4</span>E <span class="token number">32</span> <span class="token number">24</span> <span class="token number">3D</span> <span class="token constant">B6</span> <span class="token number">55</span> <span class="token number">3</span>E   <span class="token number">35</span> <span class="token constant">D8</span> <span class="token number">48</span> <span class="token number">47</span> <span class="token number">1</span>E <span class="token number">5</span>A <span class="token constant">CA</span> <span class="token number">44</span>  <span class="token punctuation">.</span><span class="token constant">N2</span>$<span class="token operator">=</span><span class="token punctuation">.</span>U<span class="token operator">&gt;</span><span class="token number">5.</span><span class="token constant">HG</span><span class="token punctuation">.</span>Z<span class="token punctuation">.</span>D
<span class="token number">0010</span><span class="token operator">:</span> <span class="token constant">F8</span> <span class="token constant">C1</span> <span class="token number">12</span> <span class="token number">2</span>E                                        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>

</code></pre> 
<p>参考微软官方文献:<br> <a href="https://learn.microsoft.com/zh-cn/xamarin/android/deploy-test/signing/manually-signing-the-apk#zipalign-the-apk" rel="nofollow">https://learn.microsoft.com/zh-cn/xamarin/android/deploy-test/signing/manually-signing-the-apk#zipalign-the-apk</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/caffea39eb8b22968c839c47a97a9d97/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Spring MVC请求处理流程和九大组件</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/04b35bf98f53c486ddde78130050e3be/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">第一章 SQL Server 数据库部署</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>