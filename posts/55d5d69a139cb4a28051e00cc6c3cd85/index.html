<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>探索数据结构：堆的具体实现与应用 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/55d5d69a139cb4a28051e00cc6c3cd85/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="探索数据结构：堆的具体实现与应用">
  <meta property="og:description" content="✨✨ 欢迎大家来到贝蒂大讲堂✨✨
🎈🎈养成好习惯，先赞后看哦~🎈🎈
所属专栏：数据结构与算法
贝蒂的主页：Betty’s blog
1. 堆的概念 堆(Heap)是计算机科学中一类特殊的数据结构。堆通常是一个可以被看作一棵完全二树的数组对象，若满足：
任意节点的值&gt;=其子节点的值。则称为大根堆。任意节点的值&lt;=其子节点的值。则称为小根堆。 2. 堆的实现方式 虽然堆是一种特殊的二叉树，它既可以用数组存储也可以用链式存储。但是考虑到其完全二叉树的特性，我们最好采用数组存储的方式，因为这样既方便访问，也并不会浪费格外的空间。
假设某个合法下标为i：
若双亲节点存在，下标为(i-1)/2。若孩子节点存在，左孩子下标为2i&#43;1，右孩子为2i&#43;2。 3. 堆的功能 堆的初始化。堆的插入。堆的删除。获取堆顶的元素。堆的元素个数。堆的判空。输出堆。建堆。销毁堆。 4. 堆的声明 因为我用数组实现堆，所以堆的声明与顺序表类似。
typedef int HpDataType; typedef struct Heap { HpDataType* a;//存储数据 int size;//大小 int capacity;//容量 }Heap; 5. 堆的实现 5.1. 堆的初始化 5.1.1. 代码实现 void HeapInit(Heap* hp)//堆的初始化 { assert(hp); hp-&gt;a = NULL; hp-&gt;size = hp-&gt;capacity = 0; } 5.1.2. 复杂度分析 时间复杂度：没有额外的时间消耗，时间复杂度为O(1)。空间复杂度：没有额外的空间消耗，空间复杂度为O(1)。 5.2. 堆的插入 当我们堆进行插入时可能会破坏堆的原有结构，这时就需要我们对其进行向上调整。
5.2.1. 代码实现 void AdjustUp(Heap* hp, int child)//向上调整 { int parent = (child - 1) / 2; while (child &gt; 0) { if (hp-&gt;a[child] &gt; hp-&gt;a[parent]) { swap(&amp;hp-&gt;a[child], &amp;hp-&gt;a[parent]); child = parent; parent = (child - 1) / 2; } else { break; } } } void HeapPush(Heap* hp, HpDataType x)//堆的插入 { assert(hp); if (hp-&gt;size == hp-&gt;capacity) { int newCapacity = hp-&gt;capacity == 0 ?">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-14T22:23:30+08:00">
    <meta property="article:modified_time" content="2024-05-14T22:23:30+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">探索数据结构：堆的具体实现与应用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p><img src="https://images2.imgbox.com/99/06/Pf3SZRFF_o.png" alt=""></p> 
 <p>✨✨ 欢迎大家来到贝蒂大讲堂✨✨</p> 
 <p>🎈🎈养成好习惯，先赞后看哦~🎈🎈</p> 
 <p>所属专栏：<a href="http://t.csdnimg.cn/REhD0" rel="nofollow">数据结构与算法</a><br> 贝蒂的主页：<a href="https://blog.csdn.net/Bettysweetyaaa?type=lately">Betty’s blog</a></p> 
</blockquote> 
<h3><a id="1__8"></a>1. 堆的概念</h3> 
<p><strong>堆(Heap</strong>)是计算机科学中一类特殊的数据结构。堆通常是一个可以被看作一棵完全二树的数组对象，若满足：</p> 
<ul><li>任意节点的值&gt;=其子节点的值。则称为<strong>大根堆</strong>。</li><li>任意节点的值&lt;=其子节点的值。则称为<strong>小根堆</strong>。</li></ul> 
<p><img src="https://images2.imgbox.com/a0/5c/uqaEHlc3_o.jpg" alt="img"></p> 
<p><img src="https://images2.imgbox.com/a1/6b/gHCvVlCx_o.jpg" alt="img"></p> 
<h3><a id="2__21"></a>2. 堆的实现方式</h3> 
<p>虽然堆是一种特殊的二叉树，它既可以用数组存储也可以用链式存储。但是考虑到其完全二叉树的特性，我们最好采用数组存储的方式，因为这样<strong>既方便访问，也并不会浪费格外的空间。</strong></p> 
<p><img src="https://images2.imgbox.com/75/bc/PXhBzrfC_o.jpg" alt="img"></p> 
<p>假设某个合法下标为i：</p> 
<ul><li><strong>若双亲节点存在，下标为(i-1)/2。</strong></li><li><strong>若孩子节点存在，左孩子下标为2i+1，右孩子为2i+2。</strong></li></ul> 
<h3><a id="3__32"></a>3. 堆的功能</h3> 
<blockquote> 
 <ol><li>堆的初始化。</li><li>堆的插入。</li><li>堆的删除。</li><li>获取堆顶的元素。</li><li>堆的元素个数。</li><li>堆的判空。</li><li>输出堆。</li><li>建堆。</li><li>销毁堆。</li></ol> 
</blockquote> 
<h3><a id="4__44"></a>4. 堆的声明</h3> 
<p>因为我用数组实现堆，所以堆的声明与顺序表类似。</p> 
<pre><code class="prism language-c"><span class="token keyword">typedef</span> <span class="token keyword">int</span> HpDataType<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Heap</span> 
<span class="token punctuation">{<!-- --></span>
	HpDataType<span class="token operator">*</span> a<span class="token punctuation">;</span><span class="token comment">//存储数据</span>
	<span class="token keyword">int</span> size<span class="token punctuation">;</span><span class="token comment">//大小</span>
	<span class="token keyword">int</span> capacity<span class="token punctuation">;</span><span class="token comment">//容量</span>
<span class="token punctuation">}</span>Heap<span class="token punctuation">;</span>
</code></pre> 
<h3><a id="5__58"></a>5. 堆的实现</h3> 
<h4><a id="51__60"></a>5.1. 堆的初始化</h4> 
<h5><a id="511__62"></a>5.1.1. 代码实现</h5> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">HeapInit</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">)</span><span class="token comment">//堆的初始化</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span>hp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	hp<span class="token operator">-&gt;</span>a <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	hp<span class="token operator">-&gt;</span>size <span class="token operator">=</span> hp<span class="token operator">-&gt;</span>capacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="512__73"></a>5.1.2. 复杂度分析</h5> 
<ul><li>时间复杂度：没有额外的时间消耗，时间复杂度为O(1)。</li><li>空间复杂度：没有额外的空间消耗，空间复杂度为O(1)。</li></ul> 
<h4><a id="52__78"></a>5.2. 堆的插入</h4> 
<p>当我们堆进行插入时可能会破坏堆的原有结构，这时就需要我们对其进行<strong>向上调整。</strong></p> 
<p><img src="https://images2.imgbox.com/e5/79/R50JFizI_o.jpg" alt="img"></p> 
<h5><a id="521__84"></a>5.2.1. 代码实现</h5> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">AdjustUp</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">,</span> <span class="token keyword">int</span> child<span class="token punctuation">)</span><span class="token comment">//向上调整</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> parent <span class="token operator">=</span> <span class="token punctuation">(</span>child <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>child <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>hp<span class="token operator">-&gt;</span>a<span class="token punctuation">[</span>child<span class="token punctuation">]</span> <span class="token operator">&gt;</span> hp<span class="token operator">-&gt;</span>a<span class="token punctuation">[</span>parent<span class="token punctuation">]</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>hp<span class="token operator">-&gt;</span>a<span class="token punctuation">[</span>child<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>hp<span class="token operator">-&gt;</span>a<span class="token punctuation">[</span>parent<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			child <span class="token operator">=</span> parent<span class="token punctuation">;</span>
			parent <span class="token operator">=</span> <span class="token punctuation">(</span>child <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">HeapPush</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">,</span> HpDataType x<span class="token punctuation">)</span><span class="token comment">//堆的插入</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span>hp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>hp<span class="token operator">-&gt;</span>size <span class="token operator">==</span> hp<span class="token operator">-&gt;</span>capacity<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">int</span> newCapacity <span class="token operator">=</span> hp<span class="token operator">-&gt;</span>capacity <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">4</span> <span class="token operator">:</span> hp<span class="token operator">-&gt;</span>capacity <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
		HpDataType<span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token punctuation">(</span>HpDataType<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">realloc</span><span class="token punctuation">(</span>hp<span class="token operator">-&gt;</span>a<span class="token punctuation">,</span> newCapacity <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>HpDataType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>tmp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"realloc fail"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		hp<span class="token operator">-&gt;</span>a <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
		hp<span class="token operator">-&gt;</span>capacity <span class="token operator">=</span> newCapacity<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	hp<span class="token operator">-&gt;</span>a<span class="token punctuation">[</span>hp<span class="token operator">-&gt;</span>size<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">;</span>
	hp<span class="token operator">-&gt;</span>size<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token function">AdjustUp</span><span class="token punctuation">(</span>hp<span class="token punctuation">,</span> hp<span class="token operator">-&gt;</span>size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//向上调整</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="522__125"></a>5.2.2. 复杂度分析</h5> 
<ul><li>时间复杂度：假设有N个节点，高度为h，2h -1=N。至少调整log2(N+1)-1次，所以时间复杂度为logN。</li><li>空间复杂度：没有开辟额外的空间，空间复杂度为O(1)。</li></ul> 
<h4><a id="53__130"></a>5.3. 堆的删除</h4> 
<p>堆的删除是指删除堆顶的数据，如果我们删除堆顶元素并往前覆盖就可能打乱原有的亲缘关系。所以我们可以先将<strong>堆顶的元素与末尾元素交换</strong>，然后再进行<strong>向下调整</strong>·。</p> 
<p><img src="https://images2.imgbox.com/5f/e1/yc92P2Yr_o.jpg" alt="img"></p> 
<h5><a id="531__136"></a>5.3.1. 代码实现</h5> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>HpDataType<span class="token operator">*</span> x1<span class="token punctuation">,</span> HpDataType<span class="token operator">*</span> x2<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	HpDataType tmp <span class="token operator">=</span> <span class="token operator">*</span>x1<span class="token punctuation">;</span>
	<span class="token operator">*</span>x1 <span class="token operator">=</span> <span class="token operator">*</span>x2<span class="token punctuation">;</span>
	<span class="token operator">*</span>x2 <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> 
<span class="token keyword">void</span> <span class="token function">AdjustDown</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">int</span> parent<span class="token punctuation">)</span><span class="token comment">//向下调整</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> child <span class="token operator">=</span> parent <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//默认左孩子更大</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>child <span class="token operator">&lt;</span> n<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>	
		<span class="token keyword">if</span> <span class="token punctuation">(</span>child <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;</span> n <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">[</span>child <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> a<span class="token punctuation">[</span>child<span class="token punctuation">]</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token operator">++</span>child<span class="token punctuation">;</span><span class="token comment">//右孩子</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>child<span class="token punctuation">]</span> <span class="token operator">&gt;</span> a<span class="token punctuation">[</span>parent<span class="token punctuation">]</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">[</span>child<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">[</span>parent<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			parent <span class="token operator">=</span> child<span class="token punctuation">;</span>
			child <span class="token operator">=</span> parent <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> 
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">HeapPop</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">)</span><span class="token comment">//删除堆顶元素</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span>hp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">assert</span><span class="token punctuation">(</span>hp<span class="token operator">-&gt;</span>size <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>hp<span class="token operator">-&gt;</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>hp<span class="token operator">-&gt;</span>a<span class="token punctuation">[</span>hp<span class="token operator">-&gt;</span>size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	hp<span class="token operator">-&gt;</span>size<span class="token operator">--</span><span class="token punctuation">;</span><span class="token comment">//删除最后一个数据</span>
	<span class="token function">AdjustDown</span><span class="token punctuation">(</span>hp<span class="token operator">-&gt;</span>a<span class="token punctuation">,</span> hp<span class="token operator">-&gt;</span>size<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//向下调整</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="532__178"></a>5.3.2. 复杂度分析</h5> 
<ul><li>时间复杂度：假设有N个节点，高度为h，2h -1=N。至少调整log2(N+1)-1次，所以时间复杂度为logN。</li><li>空间复杂度：没有开辟额外的空间，空间复杂度为O(1)。</li></ul> 
<h4><a id="54__183"></a>5.4. 获取堆顶元素</h4> 
<h5><a id="541__185"></a>5.4.1. 代码实现</h5> 
<pre><code class="prism language-c">HpDataType <span class="token function">HeapTop</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">)</span><span class="token comment">//获取堆顶元素</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span>hp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">assert</span><span class="token punctuation">(</span>hp<span class="token operator">-&gt;</span>size <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> hp<span class="token operator">-&gt;</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="542__196"></a>5.4.2. 复杂度分析</h5> 
<ul><li>时间复杂度：没有额外的时间消耗，时间复杂度为O(1)。</li><li>空间复杂度：没有额外的空间消耗，空间复杂度为O(1)。</li></ul> 
<h4><a id="55__201"></a>5.5. 获取堆的元素个数</h4> 
<h5><a id="551__203"></a>5.5.1. 代码实现</h5> 
<pre><code class="prism language-c"><span class="token class-name">size_t</span> <span class="token function">HeapSize</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">)</span><span class="token comment">//堆的大小</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span>hp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> hp<span class="token operator">-&gt;</span>size<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="552__213"></a>5.5.2. 复杂度分析</h5> 
<ul><li>时间复杂度：没有额外的时间消耗，时间复杂度为O(1)。</li><li>空间复杂度：没有额外的空间消耗，空间复杂度为O(1)。</li></ul> 
<h4><a id="56__218"></a>5.6. 判断堆是否为空</h4> 
<h5><a id="561__220"></a>5.6.1. 代码实现</h5> 
<pre><code class="prism language-c">bool <span class="token function">HeapEmpty</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">)</span><span class="token comment">//判断堆是否为空</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span>hp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> hp<span class="token operator">-&gt;</span>size <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="562__230"></a>5.6.2. 复杂度分析</h5> 
<ul><li>时间复杂度：没有额外的时间消耗，时间复杂度为O(1)。</li><li>空间复杂度：没有额外的空间消耗，空间复杂度为O(1)。</li></ul> 
<h4><a id="57__235"></a>5.7. 输出堆</h4> 
<h5><a id="571__237"></a>5.7.1. 代码实现</h5> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">HeapDisplay</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">)</span><span class="token comment">//堆的打印</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> hp<span class="token operator">-&gt;</span>size<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> hp<span class="token operator">-&gt;</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="572__250"></a>5.7.2. 复杂度分析</h5> 
<ul><li>时间复杂度：遍历整个数组，时间复杂度为O(N)。</li><li>空间复杂度：没有额外的空间消耗，空间复杂度为O(1)。</li></ul> 
<h4><a id="58__255"></a>5.8. 建堆</h4> 
<h5><a id="581__257"></a>5.8.1. 代码实现</h5> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">HeapCreatUp</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">,</span>HpDataType<span class="token operator">*</span> arr<span class="token punctuation">,</span><span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token comment">//向上调整建堆</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span>hp <span class="token operator">&amp;&amp;</span> arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">HeapPush</span><span class="token punctuation">(</span>hp<span class="token punctuation">,</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">HeapCreatDown</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">,</span> HpDataType<span class="token operator">*</span> arr<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token comment">//向下调整建堆</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span>hp <span class="token operator">&amp;&amp;</span> arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
	HpDataType<span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token punctuation">(</span>HpDataType<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>HpDataType<span class="token punctuation">)</span> <span class="token operator">*</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>tmp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"malloc fail"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	hp<span class="token operator">-&gt;</span>a <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
	<span class="token function">memcpy</span><span class="token punctuation">(</span>hp<span class="token operator">-&gt;</span>a<span class="token punctuation">,</span> arr<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>HpDataType<span class="token punctuation">)</span> <span class="token operator">*</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
	hp<span class="token operator">-&gt;</span>size <span class="token operator">=</span> n<span class="token punctuation">;</span>
	hp<span class="token operator">-&gt;</span>capacity <span class="token operator">=</span> n<span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span><span class="token comment">//从最后一个元素开始</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">AdjustDown</span><span class="token punctuation">(</span>hp<span class="token operator">-&gt;</span>a<span class="token punctuation">,</span> n<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="582__288"></a>5.8.2. 复杂度分析</h5> 
<p>假设高度为h，节点个数为N。如果是向上调整建堆：</p> 
<p><img src="https://images2.imgbox.com/46/66/nIHmDUn5_o.jpg" alt="img"></p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          F 
         
        
          ( 
         
        
          N 
         
        
          ) 
         
        
          = 
         
         
         
           2 
          
         
           1 
          
         
        
          × 
         
        
          1 
         
        
          + 
         
         
         
           2 
          
         
           2 
          
         
        
          × 
         
        
          2 
         
        
          + 
         
        
          . 
         
        
          . 
         
        
          . 
         
        
          + 
         
         
         
           2 
          
          
          
            h 
           
          
            − 
           
          
            1 
           
          
         
        
          × 
         
        
          ( 
         
        
          h 
         
        
          − 
         
        
          1 
         
        
          ) 
         
         
        
          2 
         
        
          F 
         
        
          ( 
         
        
          N 
         
        
          ) 
         
        
          = 
         
         
         
           2 
          
         
           2 
          
         
        
          × 
         
        
          1 
         
        
          + 
         
         
         
           2 
          
         
           3 
          
         
        
          × 
         
        
          2 
         
        
          + 
         
        
          . 
         
        
          . 
         
        
          . 
         
        
          + 
         
         
         
           2 
          
          
          
            h 
           
          
            − 
           
          
            1 
           
          
         
        
          × 
         
        
          ( 
         
        
          h 
         
        
          − 
         
        
          1 
         
        
          ) 
         
        
          + 
         
         
         
           2 
          
         
           h 
          
         
        
          × 
         
        
          ( 
         
        
          h 
         
        
          − 
         
        
          1 
         
        
          ) 
         
         
        
          2 
         
        
          F 
         
        
          ( 
         
        
          N 
         
        
          ) 
         
        
          − 
         
        
          F 
         
        
          ( 
         
        
          N 
         
        
          ) 
         
        
          = 
         
        
          − 
         
         
         
           2 
          
         
           1 
          
         
        
          − 
         
         
         
           2 
          
         
           2 
          
         
        
          − 
         
         
         
           2 
          
         
           3 
          
         
        
          − 
         
        
          . 
         
        
          . 
         
        
          . 
         
         
         
           2 
          
          
          
            h 
           
          
            − 
           
          
            1 
           
          
         
        
          + 
         
         
         
           2 
          
         
           h 
          
         
        
          × 
         
        
          ( 
         
        
          h 
         
        
          − 
         
        
          1 
         
        
          ) 
         
        
          = 
         
        
          − 
         
         
         
           2 
          
         
           h 
          
         
        
          + 
         
        
          2 
         
        
          − 
         
         
         
           2 
          
         
           h 
          
         
        
          + 
         
         
         
           2 
          
         
           h 
          
         
        
          × 
         
        
          h 
         
         
        
          F 
         
        
          ( 
         
        
          N 
         
        
          ) 
         
        
          = 
         
         
         
           2 
          
         
           h 
          
         
        
          × 
         
        
          ( 
         
        
          h 
         
        
          − 
         
        
          2 
         
        
          ) 
         
        
          + 
         
        
          2 
         
        
          , 
         
        
          N 
         
        
          = 
         
         
         
           2 
          
         
           h 
          
         
        
          − 
         
        
          1 
         
         
        
          F 
         
        
          ( 
         
        
          N 
         
        
          ) 
         
        
          = 
         
        
          ( 
         
        
          N 
         
        
          + 
         
        
          1 
         
        
          ) 
         
        
          × 
         
        
          ( 
         
        
          l 
         
        
          o 
         
        
          g 
         
        
          2 
         
        
          ( 
         
        
          N 
         
        
          + 
         
        
          1 
         
        
          ) 
         
        
          − 
         
        
          2 
         
        
          ) 
         
        
          + 
         
        
          2 
         
        
       
         F(N)=2^1×1+2^2×2+...+2^{h-1}×(h-1)\\ 2F(N)=2^2×1+2^3×2+...+2^{h-1}×(h-1)+2^h×(h-1)\\ 2F(N)-F(N)=-2^1-2^2-2^3-...2^{h-1}+2^h×(h-1)=-2^h+2-2^h+2^h×h\\ F(N)=2^h×(h-2)+2,N=2^h-1\\ F(N)=(N+1)×(log2(N+1)-2)+2 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.9474em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9474em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord">...</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9824em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right: 0.1389em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.9474em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9474em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord">...</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9824em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9824em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right: 0.1389em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.9474em; vertical-align: -0.0833em;"></span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9474em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9474em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9824em; vertical-align: -0.0833em;"></span><span class="mord">...</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9824em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.9824em; vertical-align: -0.0833em;"></span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9824em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9824em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">h</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.9824em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.9824em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span><span class="mord">2</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span></span></span></p> 
<p>如果是向下调整建堆：</p> 
<p><img src="https://images2.imgbox.com/c7/3b/fqAiHGQq_o.jpg" alt="img"><br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          F 
         
        
          ( 
         
        
          N 
         
        
          ) 
         
        
          = 
         
         
         
           2 
          
          
          
            h 
           
          
            − 
           
          
            2 
           
          
         
        
          × 
         
        
          1 
         
        
          + 
         
         
         
           2 
          
          
          
            h 
           
          
            − 
           
          
            3 
           
          
         
        
          × 
         
        
          2 
         
        
          + 
         
        
          . 
         
        
          . 
         
        
          . 
         
        
          + 
         
         
         
           2 
          
         
           0 
          
         
        
          × 
         
        
          ( 
         
        
          h 
         
        
          − 
         
        
          1 
         
        
          ) 
         
         
        
          2 
         
        
          F 
         
        
          ( 
         
        
          N 
         
        
          ) 
         
        
          = 
         
         
         
           2 
          
          
          
            h 
           
          
            − 
           
          
            1 
           
          
         
        
          × 
         
        
          1 
         
        
          + 
         
         
         
           2 
          
          
          
            h 
           
          
            − 
           
          
            2 
           
          
         
        
          × 
         
        
          2 
         
        
          + 
         
        
          . 
         
        
          . 
         
        
          . 
         
        
          + 
         
         
         
           2 
          
         
           1 
          
         
        
          × 
         
        
          ( 
         
        
          h 
         
        
          − 
         
        
          1 
         
        
          ) 
         
         
        
          2 
         
        
          F 
         
        
          ( 
         
        
          N 
         
        
          ) 
         
        
          − 
         
        
          F 
         
        
          ( 
         
        
          N 
         
        
          ) 
         
        
          = 
         
         
         
           2 
          
          
          
            h 
           
          
            − 
           
          
            1 
           
          
         
        
          + 
         
         
         
           2 
          
          
          
            h 
           
          
            − 
           
          
            2 
           
          
         
        
          + 
         
        
          . 
         
        
          . 
         
        
          . 
         
         
         
           2 
          
         
           1 
          
         
        
          − 
         
         
         
           2 
          
         
           0 
          
         
        
          × 
         
        
          ( 
         
        
          h 
         
        
          − 
         
        
          1 
         
        
          ) 
         
        
          = 
         
         
         
           2 
          
         
           h 
          
         
        
          − 
         
        
          1 
         
        
          − 
         
        
          h 
         
         
        
          F 
         
        
          ( 
         
        
          N 
         
        
          ) 
         
        
          = 
         
         
         
           2 
          
         
           h 
          
         
        
          − 
         
        
          1 
         
        
          − 
         
        
          h 
         
        
          , 
         
        
          N 
         
        
          = 
         
         
         
           2 
          
         
           h 
          
         
        
          − 
         
        
          1 
         
         
        
          F 
         
        
          ( 
         
        
          N 
         
        
          ) 
         
        
          = 
         
        
          N 
         
        
          − 
         
        
          l 
         
        
          o 
         
        
          g 
         
        
          2 
         
        
          ( 
         
        
          N 
         
        
          + 
         
        
          1 
         
        
          ） 
         
        
       
         F(N)=2^{h-2}×1+2^{h-3}×2+...+2^0×(h-1)\\ 2F(N)=2^{h-1}×1+2^{h-2}×2+...+2^1×(h-1)\\ 2F(N)-F(N)=2^{h-1}+2^{h-2}+...2^1-2^0×(h-1)=2^h-1-h\\ F(N)=2^h-1-h,N=2^h-1\\ F(N)=N-log2(N+1） 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.9824em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9824em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mbin mtight">−</span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord">...</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9474em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right: 0.1389em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.9824em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9824em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord">...</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9474em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right: 0.1389em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.9824em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9824em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9474em; vertical-align: -0.0833em;"></span><span class="mord">...</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9474em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.9824em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">h</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.9824em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">h</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.9824em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8991em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;"></span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span><span class="mord">2</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord">1</span><span class="mord cjk_fallback">）</span></span></span></span></span></span></p> 
<ul><li>时间复杂度：向上调整建堆最后一排调整h-1次，倒数第二排调整h-2次…时间复杂度为NlogN。向下调整建堆倒数第二排调整1次，倒数第二排调整2…第一排调整h-1次。时间复杂为O(N)。</li><li>空间复杂度：无论是向上调整建堆还是向下调整建堆都需开辟N个空间，所以空间复杂度为O(N)。</li></ul> 
<h4><a id="59__319"></a>5.9. 销毁堆</h4> 
<h5><a id="591__321"></a>5.9.1. 代码实现</h5> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">HeapDestroy</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">)</span><span class="token comment">//销毁堆</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span>hp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">free</span><span class="token punctuation">(</span>hp<span class="token operator">-&gt;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
	hp<span class="token operator">-&gt;</span>size <span class="token operator">=</span> hp<span class="token operator">-&gt;</span>capacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="592__332"></a>5.9.2. 复杂度分析</h5> 
<ul><li>时间复杂度：没有额外的时间消耗，时间复杂度为O(1)。</li><li>空间复杂度：没有额外的空间消耗，空间复杂度为O(1)。</li></ul> 
<h4><a id="510__337"></a>5.10. 完整代码</h4> 
<h5><a id="5101_Heaph_339"></a>5.10.1. Heap.h</h5> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;assert.h&gt;</span></span>
<span class="token keyword">typedef</span> <span class="token keyword">int</span> HpDataType<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Heap</span> 
<span class="token punctuation">{<!-- --></span>
	HpDataType<span class="token operator">*</span> a<span class="token punctuation">;</span><span class="token comment">//存储数据</span>
	<span class="token keyword">int</span> size<span class="token punctuation">;</span><span class="token comment">//大小</span>
	<span class="token keyword">int</span> capacity<span class="token punctuation">;</span><span class="token comment">//容量</span>
<span class="token punctuation">}</span>Heap<span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">HeapInit</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//堆的初始化</span>
<span class="token keyword">void</span> <span class="token function">AdjustUp</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">,</span> <span class="token keyword">int</span> child<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//向上调整</span>
<span class="token keyword">void</span> <span class="token function">HeapPush</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">,</span> HpDataType x<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//堆的插入</span>
bool <span class="token function">HeapEmpty</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//判断堆是否为空</span>
<span class="token class-name">size_t</span> <span class="token function">HeapSize</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//堆的大小</span>
<span class="token keyword">void</span> <span class="token function">AdjustDown</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">int</span> parent<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//向下调整</span>
<span class="token keyword">void</span> <span class="token function">HeapPop</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//删除堆顶元素</span>
HpDataType <span class="token function">HeapTop</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取堆顶元素</span>
<span class="token keyword">void</span> <span class="token function">HeapDisplay</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//堆的打印</span>
<span class="token keyword">void</span> <span class="token function">HeapDestroy</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//销毁堆</span>
<span class="token keyword">void</span> <span class="token function">HeapCreatUp</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">,</span>HpDataType<span class="token operator">*</span> arr<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//向上调整建堆</span>
<span class="token keyword">void</span> <span class="token function">HeapCreatDown</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">,</span>HpDataType<span class="token operator">*</span> arr<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//向下调整建堆</span>
</code></pre> 
<h5><a id="5102_Heapc_367"></a>5.10.2. Heap.c</h5> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_CRT_SECURE_NO_WARNINGS</span> <span class="token expression"><span class="token number">1</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"Heap.h"</span></span>
<span class="token keyword">void</span> <span class="token function">HeapInit</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">)</span><span class="token comment">//堆的初始化</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span>hp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	hp<span class="token operator">-&gt;</span>a <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	hp<span class="token operator">-&gt;</span>size <span class="token operator">=</span> hp<span class="token operator">-&gt;</span>capacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>HpDataType<span class="token operator">*</span> x1<span class="token punctuation">,</span> HpDataType<span class="token operator">*</span> x2<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	HpDataType tmp <span class="token operator">=</span> <span class="token operator">*</span>x1<span class="token punctuation">;</span>
	<span class="token operator">*</span>x1 <span class="token operator">=</span> <span class="token operator">*</span>x2<span class="token punctuation">;</span>
	<span class="token operator">*</span>x2 <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">AdjustUp</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">,</span> <span class="token keyword">int</span> child<span class="token punctuation">)</span><span class="token comment">//向上调整</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> parent <span class="token operator">=</span> <span class="token punctuation">(</span>child <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>child <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>hp<span class="token operator">-&gt;</span>a<span class="token punctuation">[</span>child<span class="token punctuation">]</span> <span class="token operator">&gt;</span> hp<span class="token operator">-&gt;</span>a<span class="token punctuation">[</span>parent<span class="token punctuation">]</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>hp<span class="token operator">-&gt;</span>a<span class="token punctuation">[</span>child<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>hp<span class="token operator">-&gt;</span>a<span class="token punctuation">[</span>parent<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			child <span class="token operator">=</span> parent<span class="token punctuation">;</span>
			parent <span class="token operator">=</span> <span class="token punctuation">(</span>child <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">HeapPush</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">,</span> HpDataType x<span class="token punctuation">)</span><span class="token comment">//堆的插入</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span>hp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>hp<span class="token operator">-&gt;</span>size <span class="token operator">==</span> hp<span class="token operator">-&gt;</span>capacity<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">int</span> newCapacity <span class="token operator">=</span> hp<span class="token operator">-&gt;</span>capacity <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">4</span> <span class="token operator">:</span> hp<span class="token operator">-&gt;</span>capacity <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
		HpDataType<span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token punctuation">(</span>HpDataType<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">realloc</span><span class="token punctuation">(</span>hp<span class="token operator">-&gt;</span>a<span class="token punctuation">,</span> newCapacity <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>HpDataType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>tmp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"realloc fail"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		hp<span class="token operator">-&gt;</span>a <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
		hp<span class="token operator">-&gt;</span>capacity <span class="token operator">=</span> newCapacity<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	hp<span class="token operator">-&gt;</span>a<span class="token punctuation">[</span>hp<span class="token operator">-&gt;</span>size<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">;</span>
	hp<span class="token operator">-&gt;</span>size<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token function">AdjustUp</span><span class="token punctuation">(</span>hp<span class="token punctuation">,</span> hp<span class="token operator">-&gt;</span>size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//向上调整</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">AdjustDown</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">int</span> parent<span class="token punctuation">)</span><span class="token comment">//向下调整</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> child <span class="token operator">=</span> parent <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//默认左孩子更大</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>child <span class="token operator">&lt;</span> n<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>	
		<span class="token keyword">if</span> <span class="token punctuation">(</span>child <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;</span> n <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">[</span>child <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> a<span class="token punctuation">[</span>child<span class="token punctuation">]</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token operator">++</span>child<span class="token punctuation">;</span><span class="token comment">//右孩子</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>child<span class="token punctuation">]</span> <span class="token operator">&gt;</span> a<span class="token punctuation">[</span>parent<span class="token punctuation">]</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">[</span>child<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">[</span>parent<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			parent <span class="token operator">=</span> child<span class="token punctuation">;</span>
			child <span class="token operator">=</span> parent <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> 
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">HeapPop</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">)</span><span class="token comment">//删除堆顶元素</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span>hp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">assert</span><span class="token punctuation">(</span>hp<span class="token operator">-&gt;</span>size <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>hp<span class="token operator">-&gt;</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>hp<span class="token operator">-&gt;</span>a<span class="token punctuation">[</span>hp<span class="token operator">-&gt;</span>size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	hp<span class="token operator">-&gt;</span>size<span class="token operator">--</span><span class="token punctuation">;</span><span class="token comment">//删除最后一个数据</span>
	<span class="token function">AdjustDown</span><span class="token punctuation">(</span>hp<span class="token operator">-&gt;</span>a<span class="token punctuation">,</span> hp<span class="token operator">-&gt;</span>size<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//向下调整</span>
<span class="token punctuation">}</span>

HpDataType <span class="token function">HeapTop</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">)</span><span class="token comment">//获取堆顶元素</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span>hp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">assert</span><span class="token punctuation">(</span>hp<span class="token operator">-&gt;</span>size <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> hp<span class="token operator">-&gt;</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

bool <span class="token function">HeapEmpty</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">)</span><span class="token comment">//判断堆是否为空</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span>hp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> hp<span class="token operator">-&gt;</span>size <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">size_t</span> <span class="token function">HeapSize</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">)</span><span class="token comment">//堆的大小</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span>hp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> hp<span class="token operator">-&gt;</span>size<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">HeapDisplay</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">)</span><span class="token comment">//堆的打印</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> hp<span class="token operator">-&gt;</span>size<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> hp<span class="token operator">-&gt;</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">HeapCreatUp</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">,</span>HpDataType<span class="token operator">*</span> arr<span class="token punctuation">,</span><span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token comment">//向上调整建堆</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span>hp <span class="token operator">&amp;&amp;</span> arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">HeapPush</span><span class="token punctuation">(</span>hp<span class="token punctuation">,</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">HeapCreatDown</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">,</span> HpDataType<span class="token operator">*</span> arr<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token comment">//向下调整建堆</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span>hp <span class="token operator">&amp;&amp;</span> arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
	HpDataType<span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token punctuation">(</span>HpDataType<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>HpDataType<span class="token punctuation">)</span> <span class="token operator">*</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>tmp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"malloc fail"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	hp<span class="token operator">-&gt;</span>a <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
	<span class="token function">memcpy</span><span class="token punctuation">(</span>hp<span class="token operator">-&gt;</span>a<span class="token punctuation">,</span> arr<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>HpDataType<span class="token punctuation">)</span> <span class="token operator">*</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
	hp<span class="token operator">-&gt;</span>size <span class="token operator">=</span> n<span class="token punctuation">;</span>
	hp<span class="token operator">-&gt;</span>capacity <span class="token operator">=</span> n<span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span><span class="token comment">//从最后一个元素开始</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">AdjustDown</span><span class="token punctuation">(</span>hp<span class="token operator">-&gt;</span>a<span class="token punctuation">,</span> n<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">HeapDestroy</span><span class="token punctuation">(</span>Heap<span class="token operator">*</span> hp<span class="token punctuation">)</span><span class="token comment">//销毁堆</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span>hp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">free</span><span class="token punctuation">(</span>hp<span class="token operator">-&gt;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
	hp<span class="token operator">-&gt;</span>size <span class="token operator">=</span> hp<span class="token operator">-&gt;</span>capacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="6_TopK_512"></a>6. Top-K问题</h3> 
<h4><a id="61__514"></a>6.1. 问题分析</h4> 
<p>Top-K问题简单来说就是<strong>求数据结合中前K个最大的元素或者最小的元素</strong>，一般情况下数据量都比较大。这个问题在我们日常生活中非常常见，比如说：游戏中活跃度前十的玩家，世界五百强企业等等。</p> 
<p>解决这个问题常见的思路就是遍历或者排序，但是当数据量较大时这种方法就并不适用了。这时我们就需要建堆来处理，具体操作方法如下：</p> 
<ol><li>用数据集合中前K个元素来建堆。</li></ol> 
<ul><li><strong>前k个最大的元素，则建小堆。</strong></li><li><strong>前k个最小的元素，则建大堆。</strong></li><li>用剩余的N - K个元素依次与堆顶元素来比较，不满足条件则替换堆顶元素。</li></ul> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">TopK</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//建堆</span>
	<span class="token keyword">int</span><span class="token operator">*</span> kminHeap <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token operator">*</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>kminHeap <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"malloc fail"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//将前k个数据放入堆中</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> k<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		kminHeap<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//向下调整法建小堆</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token punctuation">(</span>k <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">AdjustDown</span><span class="token punctuation">(</span>kminHeap<span class="token punctuation">,</span> k<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//依次比较</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> k<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> kminHeap<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			kminHeap<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token function">AdjustDown</span><span class="token punctuation">(</span>kminHeap<span class="token punctuation">,</span> k<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> k<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> kminHeap<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">free</span><span class="token punctuation">(</span>kminHeap<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">TestTopk</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span><span class="token operator">*</span> a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token operator">*</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">srand</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">1000000</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	a<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1000000</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
	a<span class="token punctuation">[</span><span class="token number">1231</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1000000</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
	a<span class="token punctuation">[</span><span class="token number">531</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1000000</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
	a<span class="token punctuation">[</span><span class="token number">5121</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1000000</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">;</span>
	a<span class="token punctuation">[</span><span class="token number">115</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1000000</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">;</span>
	a<span class="token punctuation">[</span><span class="token number">2335</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1000000</span> <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">;</span>
	a<span class="token punctuation">[</span><span class="token number">9999</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1000000</span> <span class="token operator">+</span> <span class="token number">7</span><span class="token punctuation">;</span>
	a<span class="token punctuation">[</span><span class="token number">76</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1000000</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">;</span>
	a<span class="token punctuation">[</span><span class="token number">423</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1000000</span> <span class="token operator">+</span> <span class="token number">9</span><span class="token punctuation">;</span>
	a<span class="token punctuation">[</span><span class="token number">3144</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1000000</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span>
	<span class="token function">TopK</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> n<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/fe/95/636xcoIG_o.png" alt="img"></p> 
<h4><a id="62__587"></a>6.2. 复杂度分析</h4> 
<ul><li>时间复杂度：建堆时间为K，向下调整的最坏时间为(N-K)*logK。所以时间复杂度为NlogK。</li><li>空间复杂度：建堆会开辟K的个空间，所以空间复杂度为logK。</li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1d77c693557e54e836122b25bc56f76f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">JavaSE--类和对象·下</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b0cca9366b24bca478ffbff2c775a21f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">其它高阶数据结构①_并查集（概念&#43;代码&#43;两道OJ）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>