<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>大数据可视化——基于Python豆瓣电影数据可视化分析系统 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/ff93ab32ce3209787169957b46fd97a1/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="大数据可视化——基于Python豆瓣电影数据可视化分析系统">
  <meta property="og:description" content="大数据可视化——基于Python豆瓣电影数据可视化分析系统 本项目旨在通过对豆瓣电影数据进行综合分析与可视化展示，构建一个基于Python的大数据可视化系统。通过数据爬取收集、清洗、分析豆瓣电影数据，我们提供了一个全面的电影信息平台，为用户提供深入了解电影产业趋势、影片评价与演员表现的工具。项目的关键步骤包括数据采集、数据清洗、数据分析与可视化展示。首先，我们使用爬虫技术从豆瓣电影网站获取丰富的电影数据，包括电影基本信息、评分、评论等存储到Mysql数据库。然后，通过数据清洗与预处理，确保数据的质量与一致性，以提高后续分析的准确性。数据分析阶段主要包括对电影评分分布、不同类型电影的数量分布、评分、演员的影响力等方面的深入研究。基于Echarts进行可视化展示，借助Python中的数据分析库（如Pandas、NumPy）和可视化库（如Matplotlib、Seaborn），我们能够以图表的形式清晰地展示电影数据的特征和趋势。最终，我们将分析结果以交互式的可视化界面呈现，用户可以通过系统自定义的查询与过滤功能，深入挖掘他们感兴趣的电影信息。这个项目不仅为电影爱好者提供了一个全面的数据参考平台，也为电影产业从业者提供了洞察行业动向的工具。
最后我们爬取到的字段信息：电影名，评分，封面图，详情url，上映时间，导演，类型，制作国家，语言，片长，电影简介，星星比例，多少人评价，预告片，前五条评论，五张详情图片
for i,moveInfomation in enumerate(moveisInfomation): try: resultData = {} # 详情 resultData[&#39;detailLink&#39;] = detailUrls[i] # 导演（数组） resultData[&#39;directors&#39;] = &#39;,&#39;.join(moveInfomation[&#39;directors&#39;]) # 评分 resultData[&#39;rate&#39;] = moveInfomation[&#39;rate&#39;] # 影片名 resultData[&#39;title&#39;] = moveInfomation[&#39;title&#39;] # 主演（数组） resultData[&#39;casts&#39;] = &#39;,&#39;.join(moveInfomation[&#39;casts&#39;]) # 封面 resultData[&#39;cover&#39;] = moveInfomation[&#39;cover&#39;] # =================进入详情页==================== detailMovieRes = requests.get(detailUrls[i], headers=headers) soup = BeautifulSoup(detailMovieRes.text, &#39;lxml&#39;) # 上映年份 resultData[&#39;year&#39;] = re.findall(r&#39;[(](.*?)[)]&#39;,soup.find(&#39;span&#39;, class_=&#39;year&#39;).get_text())[0] types = soup.find_all(&#39;span&#39;,property=&#39;v:genre&#39;) for i,span in enumerate(types): types[i] = span.get_text() # 影片类型（数组） resultData[&#39;types&#39;] = &#39;,&#39;.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-10T13:38:19+08:00">
    <meta property="article:modified_time" content="2024-07-10T13:38:19+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">大数据可视化——基于Python豆瓣电影数据可视化分析系统</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Python_0"></a>大数据可视化——基于Python豆瓣电影数据可视化分析系统</h2> 
<p>本项目旨在通过对豆瓣电影数据进行综合分析与可视化展示，构建一个基于Python的大数据可视化系统。通过数据爬取收集、清洗、分析豆瓣电影数据，我们提供了一个全面的电影信息平台，为用户提供深入了解电影产业趋势、影片评价与演员表现的工具。项目的关键步骤包括数据采集、数据清洗、数据分析与可视化展示。首先，我们使用爬虫技术从豆瓣电影网站获取丰富的电影数据，包括电影基本信息、评分、评论等存储到Mysql数据库。然后，通过数据清洗与预处理，确保数据的质量与一致性，以提高后续分析的准确性。数据分析阶段主要包括对电影评分分布、不同类型电影的数量分布、评分、演员的影响力等方面的深入研究。基于Echarts进行可视化展示，借助Python中的数据分析库（如Pandas、NumPy）和可视化库（如Matplotlib、Seaborn），我们能够以图表的形式清晰地展示电影数据的特征和趋势。最终，我们将分析结果以交互式的可视化界面呈现，用户可以通过系统自定义的查询与过滤功能，深入挖掘他们感兴趣的电影信息。这个项目不仅为电影爱好者提供了一个全面的数据参考平台，也为电影产业从业者提供了洞察行业动向的工具。</p> 
<p>最后我们爬取到的字段信息：电影名，评分，封面图，详情url，上映时间，导演，类型，制作国家，语言，片长，电影简介，星星比例，多少人评价，预告片，前五条评论，五张详情图片</p> 
<pre><code class="prism language-bash"> <span class="token keyword">for</span> i,moveInfomation <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>moveisInfomation<span class="token punctuation">)</span>:
        try:
            resultData <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
            <span class="token comment"># 详情</span>
            resultData<span class="token punctuation">[</span><span class="token string">'detailLink'</span><span class="token punctuation">]</span> <span class="token operator">=</span> detailUrls<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
            <span class="token comment"># 导演（数组）</span>
            resultData<span class="token punctuation">[</span><span class="token string">'directors'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">','</span>.join<span class="token punctuation">(</span>moveInfomation<span class="token punctuation">[</span><span class="token string">'directors'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token comment"># 评分</span>
            resultData<span class="token punctuation">[</span><span class="token string">'rate'</span><span class="token punctuation">]</span> <span class="token operator">=</span> moveInfomation<span class="token punctuation">[</span><span class="token string">'rate'</span><span class="token punctuation">]</span>
            <span class="token comment"># 影片名</span>
            resultData<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span> <span class="token operator">=</span> moveInfomation<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span>
            <span class="token comment"># 主演（数组）</span>
            resultData<span class="token punctuation">[</span><span class="token string">'casts'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">','</span>.join<span class="token punctuation">(</span>moveInfomation<span class="token punctuation">[</span><span class="token string">'casts'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token comment"># 封面</span>
            resultData<span class="token punctuation">[</span><span class="token string">'cover'</span><span class="token punctuation">]</span> <span class="token operator">=</span> moveInfomation<span class="token punctuation">[</span><span class="token string">'cover'</span><span class="token punctuation">]</span>

            <span class="token comment"># =================进入详情页====================</span>
            detailMovieRes <span class="token operator">=</span> requests.get<span class="token punctuation">(</span>detailUrls<span class="token punctuation">[</span>i<span class="token punctuation">]</span>, <span class="token assign-left variable">headers</span><span class="token operator">=</span>headers<span class="token punctuation">)</span>
            soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>detailMovieRes.text, <span class="token string">'lxml'</span><span class="token punctuation">)</span>
            <span class="token comment"># 上映年份</span>
            resultData<span class="token punctuation">[</span><span class="token string">'year'</span><span class="token punctuation">]</span> <span class="token operator">=</span> re.findall<span class="token punctuation">(</span>r<span class="token string">'[(](.*?)[)]'</span>,soup.find<span class="token punctuation">(</span><span class="token string">'span'</span>, <span class="token assign-left variable">class_</span><span class="token operator">=</span><span class="token string">'year'</span><span class="token punctuation">)</span>.get_text<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            types <span class="token operator">=</span> soup.find_all<span class="token punctuation">(</span><span class="token string">'span'</span>,property<span class="token operator">=</span><span class="token string">'v:genre'</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> i,span <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>types<span class="token punctuation">)</span>:
                types<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> span.get_text<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment"># 影片类型（数组）</span>
            resultData<span class="token punctuation">[</span><span class="token string">'types'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">','</span>.join<span class="token punctuation">(</span>types<span class="token punctuation">)</span>
            country <span class="token operator">=</span> soup.find_all<span class="token punctuation">(</span><span class="token string">'span'</span>,class_<span class="token operator">=</span><span class="token string">'pl'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>.next_sibling.strip<span class="token punctuation">(</span><span class="token punctuation">)</span>.split<span class="token punctuation">(</span>sep<span class="token operator">=</span><span class="token string">'/'</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> i,c <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>country<span class="token punctuation">)</span>:
                country<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> c.strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment"># 制作国家（数组）</span>
            resultData<span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">','</span>.join<span class="token punctuation">(</span>country<span class="token punctuation">)</span>
            lang <span class="token operator">=</span> soup.find_all<span class="token punctuation">(</span><span class="token string">'span'</span>, <span class="token assign-left variable">class_</span><span class="token operator">=</span><span class="token string">'pl'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span>.next_sibling.strip<span class="token punctuation">(</span><span class="token punctuation">)</span>.split<span class="token punctuation">(</span>sep<span class="token operator">=</span><span class="token string">'/'</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> i, l <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>lang<span class="token punctuation">)</span>:
                lang<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> l.strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment"># 影片语言（数组）</span>
            resultData<span class="token punctuation">[</span><span class="token string">'lang'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">','</span>.join<span class="token punctuation">(</span>lang<span class="token punctuation">)</span>

            upTimes <span class="token operator">=</span> soup.find_all<span class="token punctuation">(</span><span class="token string">'span'</span>,property<span class="token operator">=</span><span class="token string">'v:initialReleaseDate'</span><span class="token punctuation">)</span>
            upTimesStr <span class="token operator">=</span> <span class="token string">''</span>
            <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> upTimes:
                upTimesStr <span class="token operator">=</span> upTimesStr + i.get_text<span class="token punctuation">(</span><span class="token punctuation">)</span>
            upTime <span class="token operator">=</span> re.findall<span class="token punctuation">(</span>r<span class="token string">'\d*-\d*-\d*'</span>,upTimesStr<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            <span class="token comment"># 上映时间</span>
            resultData<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span> <span class="token operator">=</span> upTime
            <span class="token keyword">if</span> soup.find<span class="token punctuation">(</span><span class="token string">'span'</span>,property<span class="token operator">=</span><span class="token string">'v:runtime'</span><span class="token punctuation">)</span>:
                <span class="token comment"># 时间长度</span>
                resultData<span class="token punctuation">[</span><span class="token string">'moveiTime'</span><span class="token punctuation">]</span> <span class="token operator">=</span> re.findall<span class="token punctuation">(</span>r<span class="token string">'\d+'</span>,soup.find<span class="token punctuation">(</span><span class="token string">'span'</span>,property<span class="token operator">=</span><span class="token string">'v:runtime'</span><span class="token punctuation">)</span>.get_text<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            else:
                <span class="token comment"># 时间长度</span>
                resultData<span class="token punctuation">[</span><span class="token string">'moveiTime'</span><span class="token punctuation">]</span> <span class="token operator">=</span> random.randint<span class="token punctuation">(</span><span class="token number">39,61</span><span class="token punctuation">)</span>
            <span class="token comment"># 评论个数</span>
            resultData<span class="token punctuation">[</span><span class="token string">'comment_len'</span><span class="token punctuation">]</span> <span class="token operator">=</span> soup.find<span class="token punctuation">(</span><span class="token string">'span'</span>,property<span class="token operator">=</span><span class="token string">'v:votes'</span><span class="token punctuation">)</span>.get_text<span class="token punctuation">(</span><span class="token punctuation">)</span>
            starts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            startAll <span class="token operator">=</span> soup.find_all<span class="token punctuation">(</span><span class="token string">'span'</span>,class_<span class="token operator">=</span><span class="token string">'rating_per'</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> startAll:
                starts.append<span class="token punctuation">(</span>i.get_text<span class="token punctuation">(</span><span class="token punctuation">))</span>
            <span class="token comment"># 星星比例（数组）</span>
            resultData<span class="token punctuation">[</span><span class="token string">'starts'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">','</span>.join<span class="token punctuation">(</span>starts<span class="token punctuation">)</span>
            <span class="token comment"># 影片简介</span>
            resultData<span class="token punctuation">[</span><span class="token string">'summary'</span><span class="token punctuation">]</span> <span class="token operator">=</span> soup.find<span class="token punctuation">(</span><span class="token string">'span'</span>,property<span class="token operator">=</span><span class="token string">'v:summary'</span><span class="token punctuation">)</span>.get_text<span class="token punctuation">(</span><span class="token punctuation">)</span>.strip<span class="token punctuation">(</span><span class="token punctuation">)</span>

            <span class="token comment"># 五条热评</span>
            comments_info <span class="token operator">=</span> soup.find_all<span class="token punctuation">(</span><span class="token string">'span'</span>, <span class="token assign-left variable">class_</span><span class="token operator">=</span><span class="token string">'comment-info'</span><span class="token punctuation">)</span>
            comments <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span> <span class="token keyword">for</span> <span class="token for-or-select variable">x</span> <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> i, comment <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>comments_info<span class="token punctuation">)</span>:
                comments<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span> <span class="token operator">=</span> comment.contents<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>.get_text<span class="token punctuation">(</span><span class="token punctuation">)</span>
                comments<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'start'</span><span class="token punctuation">]</span> <span class="token operator">=</span> re.findall<span class="token punctuation">(</span><span class="token string">'(\d*)'</span>, comment.contents<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span>.attrs<span class="token punctuation">[</span><span class="token string">'class'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span>
                comments<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span> <span class="token operator">=</span> comment.contents<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span>.attrs<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span>
            contents <span class="token operator">=</span> soup.find_all<span class="token punctuation">(</span><span class="token string">'span'</span>, <span class="token assign-left variable">class_</span><span class="token operator">=</span><span class="token string">'short'</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>:
                comments<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'content'</span><span class="token punctuation">]</span> <span class="token operator">=</span> contents<span class="token punctuation">[</span>i<span class="token punctuation">]</span>.get_text<span class="token punctuation">(</span><span class="token punctuation">)</span>
            resultData<span class="token punctuation">[</span><span class="token string">'comments'</span><span class="token punctuation">]</span> <span class="token operator">=</span> json.dumps<span class="token punctuation">(</span>comments<span class="token punctuation">)</span>

            <span class="token comment"># 五张详情图</span>
            imgList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            lis <span class="token operator">=</span> soup.select<span class="token punctuation">(</span><span class="token string">'.related-pic-bd img'</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> lis:
                imgList.append<span class="token punctuation">(</span>i<span class="token punctuation">[</span><span class="token string">'src'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            resultData<span class="token punctuation">[</span><span class="token string">'imgList'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">','</span>.join<span class="token punctuation">(</span>imgList<span class="token punctuation">)</span>
</code></pre> 
<p>将结果保存到CSV文件和SQL数据库中，并在完成后更新页数记录。</p> 
<p>从豆瓣电影数据中提取演员和导演的电影数量信息，以便后续的分析和可视化展示。</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">getAllActorMovieNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    allData <span class="token operator">=</span> homeData<span class="token punctuation">.</span>getAllData<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ActorMovieNum <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> allData<span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> ActorMovieNum<span class="token punctuation">.</span>get<span class="token punctuation">(</span>j<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
                ActorMovieNum<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                ActorMovieNum<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> ActorMovieNum<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span>
    ActorMovieNum <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>ActorMovieNum<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> ActorMovieNum<span class="token punctuation">:</span>
        x<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> x<span class="token punctuation">,</span>y
</code></pre> 
<p>定义统计导演执导电影数量的函数getAllDirectorMovieNum()：</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">getAllDirectorMovieNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    allData <span class="token operator">=</span> homeData<span class="token punctuation">.</span>getAllData<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ActorMovieNum <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> allData<span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> i<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> ActorMovieNum<span class="token punctuation">.</span>get<span class="token punctuation">(</span>j<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
                ActorMovieNum<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                ActorMovieNum<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> ActorMovieNum<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span>
    ActorMovieNum <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>ActorMovieNum<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> ActorMovieNum<span class="token punctuation">:</span>
        x<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> x<span class="token punctuation">,</span>y
</code></pre> 
<ol><li><code>allData = homeData.getAllData()</code>：调用<code>homeData</code>模块中的<code>getAllData</code>函数，获取所有的电影数据，并将其保存在<code>allData</code>变量中。</li><li><code>ActorMovieNum = {}</code>：创建一个空字典<code>ActorMovieNum</code>，用于存储导演与其执导电影数量的映射。</li><li><code>for i in allData:</code>：遍历所有电影数据，其中<code>i</code>代表每一部电影的信息。</li><li><code>for j in i[4]:</code>：在每部电影的信息中，使用<code>i[4]</code>访问导演的信息，然后遍历每个导演。</li><li><code>if ActorMovieNum.get(j, -1) == -1:</code>：检查字典<code>ActorMovieNum</code>中是否已经存在该导演的记录。如果不存在，则将该导演作为键加入字典，并将对应的值初始化为1。</li><li><code>else:</code>：如果字典中已存在该导演的记录，则将对应的值加1，表示该导演又执导了一部电影。</li><li><code>ActorMovieNum = sorted(ActorMovieNum.items(), key=lambda x: x[1])[-20:]</code>：将字典中的导演及其执导电影数量按照电影数量进行降序排序，然后取排序后的前20项。排序的依据是<code>key=lambda x: x[1]</code>，即按照字典中的值进行排序。</li><li><code>x = []</code> 和 <code>y = []</code>：创建两个空列表，用于存储导演名称和对应的执导电影数量。</li><li><code>for i in ActorMovieNum:</code>：遍历排序后的前20项导演及其执导电影数量。</li><li><code>x.append(i[0])</code> 和 <code>y.append(i[1])</code>：将导演的名称和执导电影数量分别加入列表<code>x</code>和<code>y</code>。</li><li><code>return x, y</code>：返回存储导演名称和执导电影数量的两个列表。</li></ol> 
<p>从名为<code>homeData</code>的模块中导入<code>getAllData</code>函数，然后使用<code>pandas</code>库创建一个数据框（DataFrame）<code>df</code>。<code>getAllData</code>函数的返回值被传递给<code>DataFrame</code>的构造函数，同时指定了数据框的列名。</p> 
<ol><li><code>from . import homeData</code>: 这行代码从当前目录（<code>.</code>表示当前目录）导入<code>homeData</code>模块。</li><li><code>import pandas as ps</code>: 这行代码导入<code>pandas</code>库，并使用<code>ps</code>作为别名。一般来说，<code>pandas</code>的别名是<code>pd</code>，但在这里使用了<code>ps</code>。</li><li><code>df = ps.DataFrame(homeData.getAllData(), columns=[...])</code>: 这行代码创建一个数据框<code>df</code>，并使用<code>homeData.getAllData()</code>的返回值填充数据框。列名由<code>columns</code>参数指定，列的顺序与列表中的顺序相对应。列名包括： 
  <ul><li>‘id’: 电影ID</li><li>‘directors’: 导演</li><li>‘rate’: 评分</li><li>‘title’: 标题</li><li>‘casts’: 演员</li><li>‘cover’: 封面</li><li>‘year’: 上映年份</li><li>‘types’: 类型</li><li>‘country’: 制片国家</li><li>‘lang’: 语言</li><li>‘time’: 时长</li><li>‘moveiTime’: 电影时长</li><li>‘comment_len’: 评论长度</li><li>‘starts’: 星级</li><li>‘summary’: 摘要</li><li>‘comments’: 评论</li><li>‘imgList’: 图片列表</li><li>‘movieUrl’: 电影链接</li><li>‘detailLink’: 详细链接</li></ul> </li></ol> 
<p>这样就创建了一个包含特定列名的数据框，其中的数据来自<code>homeData.getAllData()</code>函数的返回结果。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> homeData
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> ps
df <span class="token operator">=</span> ps<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>homeData<span class="token punctuation">.</span>getAllData<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>columns<span class="token operator">=</span><span class="token punctuation">[</span>
        <span class="token string">'id'</span><span class="token punctuation">,</span>
        <span class="token string">'directors'</span><span class="token punctuation">,</span>
        <span class="token string">'rate'</span><span class="token punctuation">,</span>
        <span class="token string">'title'</span><span class="token punctuation">,</span>
        <span class="token string">'casts'</span><span class="token punctuation">,</span>
        <span class="token string">'cover'</span><span class="token punctuation">,</span>
        <span class="token string">'year'</span><span class="token punctuation">,</span>
        <span class="token string">'types'</span><span class="token punctuation">,</span>
        <span class="token string">'country'</span><span class="token punctuation">,</span>
        <span class="token string">'lang'</span><span class="token punctuation">,</span>
        <span class="token string">'time'</span><span class="token punctuation">,</span>
        <span class="token string">'moveiTime'</span><span class="token punctuation">,</span>
        <span class="token string">'comment_len'</span><span class="token punctuation">,</span>
        <span class="token string">'starts'</span><span class="token punctuation">,</span>
        <span class="token string">'summary'</span><span class="token punctuation">,</span>
        <span class="token string">'comments'</span><span class="token punctuation">,</span>
        <span class="token string">'imgList'</span><span class="token punctuation">,</span>
        <span class="token string">'movieUrl'</span><span class="token punctuation">,</span>
        <span class="token string">'detailLink'</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>从数据框（DataFrame）中的’country’列中提取地址数据。数据框中的地址数据提取出来，并统计每个地址出现的次数。它首先检查’country’列中的每个元素，如果元素是一个列表，则将列表中的每个元素添加到一个新的列表（address）中。然后，它创建一个字典（addressDic），将地址作为键，出现次数作为值，最后返回地址列表和对应的出现次数列表。</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">getAddressData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 获取名为 'country' 的列的值</span>
    addresses <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values
    
    <span class="token comment"># 创建一个空列表来存储地址</span>
    address <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    
    <span class="token comment"># 遍历 'country' 列的每个元素</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> addresses<span class="token punctuation">:</span>
        <span class="token comment"># 如果元素是列表类型</span>
        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 遍历列表中的每个元素并添加到 address 列表中</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> i<span class="token punctuation">:</span>
                address<span class="token punctuation">.</span>append<span class="token punctuation">(</span>j<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># 如果元素不是列表类型，直接将其添加到 address 列表中</span>
            address<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    
    <span class="token comment"># 创建一个空字典来存储地址及其出现次数</span>
    addressDic <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    
    <span class="token comment"># 遍历地址列表中的每个元素</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> address<span class="token punctuation">:</span>
        <span class="token comment"># 如果地址字典中不存在该地址，则将其添加并设置出现次数为1</span>
        <span class="token keyword">if</span> addressDic<span class="token punctuation">.</span>get<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
            addressDic<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># 如果地址字典中已存在该地址，则将其出现次数加1</span>
            addressDic<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> addressDic<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span>
    
    <span class="token comment"># 返回地址列表和对应的出现次数列表</span>
    <span class="token keyword">return</span> <span class="token builtin">list</span><span class="token punctuation">(</span>addressDic<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span>addressDic<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>从数据框的’lang’列中提取语言数据，并统计每种语言出现的次数。最终返回语言列表和对应的出现次数列表。</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">getLangData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 获取名为 'lang' 的列的值</span>
    langs <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'lang'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values
    
    <span class="token comment"># 创建一个空列表来存储语言数据</span>
    languages <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    
    <span class="token comment"># 遍历 'lang' 列的每个元素</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> langs<span class="token punctuation">:</span>
        <span class="token comment"># 如果元素是列表类型</span>
        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 遍历列表中的每个元素并添加到 languages 列表中</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> i<span class="token punctuation">:</span>
                languages<span class="token punctuation">.</span>append<span class="token punctuation">(</span>j<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># 如果元素不是列表类型，直接将其添加到 languages 列表中</span>
            languages<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    
    <span class="token comment"># 创建一个空字典来存储语言及其出现次数</span>
    langsDic <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    
    <span class="token comment"># 遍历语言列表中的每个元素</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> languages<span class="token punctuation">:</span>
        <span class="token comment"># 如果语言字典中不存在该语言，则将其添加并设置出现次数为1</span>
        <span class="token keyword">if</span> langsDic<span class="token punctuation">.</span>get<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
            langsDic<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># 如果语言字典中已存在该语言，则将其出现次数加1</span>
            langsDic<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> langsDic<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span>
    
    <span class="token comment"># 返回语言列表和对应的出现次数列表</span>
    <span class="token keyword">return</span> <span class="token builtin">list</span><span class="token punctuation">(</span>langsDic<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span>langsDic<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre> 
<p>数据库创建四个表：<br> <img src="https://images2.imgbox.com/50/25/YQ1ppxFE_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/a1/a3/auWt8BL1_o.png" alt="在这里插入图片描述"><br> 修改为自己的数据库主机名和账号密码：<br> <img src="https://images2.imgbox.com/57/2d/IRlRcffB_o.png" alt="在这里插入图片描述"><br> 启动项目：<br> <img src="https://images2.imgbox.com/1c/14/o3NrKHX8_o.png" alt="在这里插入图片描述"></p> 
<p>服务端口：5000 http://127.0.0.1:5000</p> 
<p>用户注册 http://127.0.0.1:5000/registry</p> 
<p><img src="https://images2.imgbox.com/2c/ab/EvJ3iloP_o.png" alt="在这里插入图片描述"></p> 
<p>用户登录</p> 
<p><img src="https://images2.imgbox.com/b2/91/zy4OBTOB_o.png" alt="在这里插入图片描述"></p> 
<p>首页页面展示：</p> 
<p><img src="https://images2.imgbox.com/5c/00/ilAeREOd_o.png" alt="在这里插入图片描述"></p> 
<p>还有电影数据，包括电影名、评分、片场、预告片等数据。</p> 
<p><img src="https://images2.imgbox.com/8a/15/rZ1rcxsp_o.png" alt="在这里插入图片描述"></p> 
<p>查看电影预告片</p> 
<p><img src="https://images2.imgbox.com/ee/a3/E99sZBo5_o.png" alt="在这里插入图片描述"></p> 
<p>电影搜索</p> 
<p><img src="https://images2.imgbox.com/08/18/A9gzu3XH_o.png" alt="在这里插入图片描述"></p> 
<p>电影产量分析</p> 
<p><img src="https://images2.imgbox.com/8b/57/6TqYwv6a_o.png" alt="在这里插入图片描述"></p> 
<p>电影数据时长分布占比</p> 
<p><img src="https://images2.imgbox.com/86/e3/mZd9VbGW_o.png" alt="在这里插入图片描述"></p> 
<p>电影评分统计分析</p> 
<p><img src="https://images2.imgbox.com/16/a0/WsW2UJzX_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/0b/5a/yCamMek6_o.png" alt="在这里插入图片描述"></p> 
<p>​ 豆瓣评分星级饼状图、豆瓣年度评价评分柱状图</p> 
<p><img src="https://images2.imgbox.com/1e/a4/PDf2NLJa_o.png" alt="在这里插入图片描述"></p> 
<p>​ 豆瓣电影中外评分分布图</p> 
<p><img src="https://images2.imgbox.com/f7/63/y1SRlCTK_o.png" alt="在这里插入图片描述"></p> 
<p>数据视图切换</p> 
<p><img src="https://images2.imgbox.com/0e/b7/lNiUrqJ2_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/14/a4/gVnrIAmc_o.png" alt="在这里插入图片描述"></p> 
<p>​ 电影拍摄地点统计图</p> 
<p><img src="https://images2.imgbox.com/ad/03/GYreMyaN_o.png" alt="在这里插入图片描述"></p> 
<p>​ 电影语言统计图</p> 
<p><img src="https://images2.imgbox.com/01/dc/3ShISFEQ_o.png" alt="在这里插入图片描述"></p> 
<p>电影类型饼图</p> 
<p><img src="https://images2.imgbox.com/7d/c5/VY55WLWA_o.png" alt="在这里插入图片描述"></p> 
<p>​ 导演作品数量前20</p> 
<p><img src="https://images2.imgbox.com/5f/af/lmMAewVj_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/a9/98/C3d93ykq_o.png" alt="在这里插入图片描述"></p> 
<p>​ 数据表操作</p> 
<p><img src="https://images2.imgbox.com/16/05/MLOQ6BWe_o.png" alt="在这里插入图片描述"></p> 
<p>​ 标题词云图</p> 
<p><img src="https://images2.imgbox.com/73/95/Y2JS0kC6_o.png" alt="在这里插入图片描述"></p> 
<p>​ 简介词云图</p> 
<p><img src="https://images2.imgbox.com/2a/c8/nEYOGEEm_o.png" alt="在这里插入图片描述"><br> s4XV8qh-1701860368769)</p> 
<p>​ 演员名词云图</p> 
<p><img src="https://images2.imgbox.com/08/45/Omr12Tk0_o.png" alt="在这里插入图片描述"></p> 
<p>评论词云图</p> 
<p><img src="https://images2.imgbox.com/65/85/NabXqllc_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/5c/2a/ostSi8SZ_o.png" alt="在这里插入图片描述"></p> 
<p>需更多资料/商业合作/交流探讨等可以添加下面个人名片，感谢各位的喜欢与支持！</p> 
<p>后面有时间和精力也会分享更多关于<strong>大数据领域</strong>方面的优质内容，喜欢的小伙伴可以点赞关注收藏，感谢各位的喜欢与支持！</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6efcbe94caf00e02c0dafaeb822cb6a8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">二十年大数据到 AI，图灵奖得主眼中的数据库因果循环</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/451576ec5a3dfcd65dabaa8b91d1fa33/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">阿里云操作系统智能助手OS Copilot实验测评报告</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>