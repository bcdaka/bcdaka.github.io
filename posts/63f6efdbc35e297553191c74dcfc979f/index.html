<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ã€SpringBootã€‘SpringBootä¸­ä½¿ç”¨AOPå®ç°æ—¥å¿—è®°å½•åŠŸèƒ½ - ç¼–ç¨‹å¤§å’–</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/63f6efdbc35e297553191c74dcfc979f/">
  <meta property="og:site_name" content="ç¼–ç¨‹å¤§å’–">
  <meta property="og:title" content="ã€SpringBootã€‘SpringBootä¸­ä½¿ç”¨AOPå®ç°æ—¥å¿—è®°å½•åŠŸèƒ½">
  <meta property="og:description" content="ğŸ“ä¸ªäººä¸»é¡µï¼šå“ˆ__
æœŸå¾…æ‚¨çš„å…³æ³¨Â ç›®å½•
ğŸ“•AOPç®€ä»‹
ğŸ“‚åˆ›å»ºæ—¥å¿—æ•°æ®åº“Â ğŸ”¥åˆ›å»ºæ—¥å¿—è®°å½•è¡¨
ğŸŒ¼åˆ›å»ºç”¨æˆ·è¡¨Â ğŸ‰SpringBootä½¿ç”¨AOP
ä¸€ã€å¯¼å…¥ä¾èµ–
äºŒã€åˆ›å»ºæˆ‘ä»¬çš„é¡¹ç›®ç»“æ„
ä¸‰ã€ä½¿ç”¨AOP
1.åˆ›å»ºæšä¸¾ç±»
2..åˆ›å»ºLogæ³¨è§£
3.åˆ›å»ºåˆ‡é¢ç±»
4.IpUtil
5.è¿›è¡Œæµ‹è¯•
åœ¨æˆ‘ä¹‹å‰çš„ä¸€ç¯‡æ–‡ç« ä¸­æˆ‘å·²ç»è®²è§£è¿‡äº†AOPçš„åŸºæœ¬æ¦‚å¿µï¼Œåœ¨è¿™é‡Œæ— éä¹Ÿå°±æ˜¯åœ¨é‡å¤ä¸€éã€‚
ğŸ“•AOPç®€ä»‹ AOPçš„å…¨ç§°æ˜¯Aspect-Oriented Programmingï¼Œå³é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆä¹Ÿç§°é¢å‘æ–¹é¢ç¼–ç¨‹ï¼‰ã€‚å®ƒæ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰çš„ä¸€ç§è¡¥å……ï¼Œç›®å‰å·²æˆä¸ºä¸€ç§æ¯”è¾ƒæˆç†Ÿçš„ç¼–ç¨‹æ–¹å¼ã€‚
åœ¨ä¼ ç»Ÿçš„ä¸šåŠ¡å¤„ç†ä»£ç ä¸­ï¼Œé€šå¸¸éƒ½ä¼šè¿›è¡Œäº‹åŠ¡å¤„ç†ã€æ—¥å¿—è®°å½•ç­‰æ“ä½œã€‚è™½ç„¶ä½¿ç”¨OOPå¯ä»¥é€šè¿‡ç»„åˆæˆ–è€…ç»§æ‰¿çš„æ–¹å¼æ¥è¾¾åˆ°ä»£ç çš„é‡ç”¨ï¼Œä½†å¦‚æœè¦å®ç°æŸä¸ªåŠŸèƒ½ï¼ˆå¦‚æ—¥å¿—è®°å½•ï¼‰ï¼ŒåŒæ ·çš„ä»£ç ä»ç„¶ä¼šåˆ†æ•£åˆ°å„ä¸ªæ–¹æ³•ä¸­ã€‚è¿™æ ·ï¼Œå¦‚æœæƒ³è¦å…³é—­æŸä¸ªåŠŸèƒ½ï¼Œæˆ–è€…å¯¹å…¶è¿›è¡Œä¿®æ”¹ï¼Œå°±å¿…é¡»è¦ä¿®æ”¹æ‰€æœ‰çš„ç›¸å…³æ–¹æ³•ã€‚è¿™ä¸ä½†å¢åŠ äº†å¼€å‘äººå‘˜çš„å·¥ä½œé‡ï¼Œè€Œä¸”æé«˜äº†ä»£ç çš„å‡ºé”™ç‡ã€‚
ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼ŒAOPæ€æƒ³éšä¹‹äº§ç”Ÿã€‚AOPé‡‡å–æ¨ªå‘æŠ½å–æœºåˆ¶ï¼Œå°†åˆ†æ•£åœ¨å„ä¸ªæ–¹æ³•ä¸­çš„é‡å¤ä»£ç æå–å‡ºæ¥ï¼Œç„¶ååœ¨ç¨‹åºç¼–è¯‘æˆ–è¿è¡Œæ—¶ï¼Œå†å°†è¿™äº›æå–å‡ºæ¥çš„ä»£ç åº”ç”¨åˆ°éœ€è¦æ‰§è¡Œçš„åœ°æ–¹ã€‚è¿™ç§é‡‡ç”¨æ¨ªå‘æŠ½å–æœºåˆ¶çš„æ–¹å¼ï¼Œé‡‡ç”¨ä¼ ç»Ÿçš„OOPæ€æƒ³æ˜¾ç„¶æ˜¯æ— æ³•åŠåˆ°çš„ï¼Œå› ä¸ºOOPåªèƒ½å®ç°çˆ¶å­å…³ç³»çš„çºµå‘çš„é‡ç”¨ã€‚è™½ç„¶AOPæ˜¯ä¸€ç§æ–°çš„ç¼–ç¨‹æ€æƒ³ï¼Œä½†å´ä¸æ˜¯OOPçš„æ›¿ä»£å“ï¼Œå®ƒåªæ˜¯OOPçš„å»¶ä¼¸å’Œè¡¥å……ã€‚
æƒ³è¦å†è¯¦ç»†äº†è§£AOPçš„å¤§å®¶å¯ä»¥çœ‹çœ‹æˆ‘è¿™ç¯‡æ–‡ç« ã€‚è¿™ç¯‡æ–‡ç« æˆ‘ä¸»è¦å°†åœ¨SpringBootä¸­ä½¿ç”¨AOPå®ç°æ—¥å¿—è®°å½•ã€‚
ã€Springã€‘Springä¸­AOPçš„ç®€ä»‹å’ŒåŸºæœ¬ä½¿ç”¨ï¼ŒSpringBootä½¿ç”¨AOP-CSDNåšå®¢
ğŸ“‚åˆ›å»ºæ—¥å¿—æ•°æ®åº“Â ğŸ”¥åˆ›å»ºæ—¥å¿—è®°å½•è¡¨ SET NAMES utf8mb4; SET FOREIGN_KEY_CHECKS = 0; -- ---------------------------- -- Table structure for sys_oper_log -- ---------------------------- DROP TABLE IF EXISTS `sys_oper_log`; CREATE TABLE `sys_oper_log` ( `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT &#39;æ—¥å¿—ä¸»é”®&#39;, `operation` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT &#39;&#39; COMMENT &#39;æ“ä½œ&#39;, `business_type` varchar(20) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT &#39;0&#39; COMMENT &#39;ä¸šåŠ¡ç±»å‹&#39;, `method` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT &#39;&#39; COMMENT &#39;æ–¹æ³•åç§°&#39;, `create_time` datetime(0) NULL DEFAULT NULL COMMENT &#39;æ“ä½œæ—¶é—´&#39;, `oper_name` varchar(80) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT &#39;&#39; COMMENT &#39;æ“ä½œç”¨æˆ·&#39;, `params` text CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL COMMENT &#39;å‚æ•°&#39;, `ip` varchar(80) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT &#39;&#39; COMMENT &#39;è¯·æ±‚çš„ipåœ°å€&#39;, PRIMARY KEY (`id`) USING BTREE ) ENGINE = InnoDB AUTO_INCREMENT = 2058 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_general_ci COMMENT = &#39;æ“ä½œæ—¥å¿—è®°å½•&#39; ROW_FORMAT = Dynamic; SET FOREIGN_KEY_CHECKS = 1; ğŸŒ¼åˆ›å»ºç”¨æˆ·è¡¨Â SET NAMES utf8mb4; SET FOREIGN_KEY_CHECKS = 0; -- ---------------------------- -- Table structure for user -- ---------------------------- DROP TABLE IF EXISTS `user`; CREATE TABLE `user` ( `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT &#39;ä¸»é”®ID&#39;, `name` varchar(30) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL COMMENT &#39;å§“å &#39;, `age` int(11) NULL DEFAULT NULL COMMENT &#39;å¹´é¾„ &#39;, `email` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL COMMENT &#39;é‚®ç®± &#39;, PRIMARY KEY (`id`) USING BTREE ) ENGINE = InnoDB AUTO_INCREMENT = 9 CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Compact; -- ---------------------------- -- Records of user -- ---------------------------- INSERT INTO `user` VALUES (2, &#39;Jack&#39;, 20, &#39;test2@baomidou.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-18T11:48:33+08:00">
    <meta property="article:modified_time" content="2024-05-18T11:48:33+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§å’–" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§å’–</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ã€SpringBootã€‘SpringBootä¸­ä½¿ç”¨AOPå®ç°æ—¥å¿—è®°å½•åŠŸèƒ½</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="text-align:center;"><img alt="" height="150" src="https://images2.imgbox.com/25/6e/1ow2OCyj_o.png" width="150"></p> 
<p style="text-align:center;">Â <strong>Â ğŸ“ä¸ªäººä¸»é¡µï¼š<a class="link-info" href="https://blog.csdn.net/qq_61024956?type=blog" title="å“ˆ__">å“ˆ__</a></strong></p> 
<p style="text-align:center;"><span style="color:#fe2c24;">æœŸå¾…æ‚¨çš„å…³æ³¨Â </span></p> 
<p style="text-align:center;"><img alt="" height="100" src="https://images2.imgbox.com/3e/88/wj5Ei7hJ_o.gif" width="1000"></p> 
<p id="main-toc"><strong>ç›®å½•</strong></p> 
<p id="%F0%9F%93%95AOP%E7%AE%80%E4%BB%8B-toc" style="margin-left:0px;"><a href="#%F0%9F%93%95AOP%E7%AE%80%E4%BB%8B" rel="nofollow">ğŸ“•AOPç®€ä»‹</a></p> 
<p id="%F0%9F%93%82%E5%88%9B%E5%BB%BA%E6%97%A5%E5%BF%97%E6%95%B0%E6%8D%AE%E5%BA%93%C2%A0-toc" style="margin-left:0px;"><a href="#%F0%9F%93%82%E5%88%9B%E5%BB%BA%E6%97%A5%E5%BF%97%E6%95%B0%E6%8D%AE%E5%BA%93%C2%A0" rel="nofollow">ğŸ“‚åˆ›å»ºæ—¥å¿—æ•°æ®åº“Â </a></p> 
<p id="%F0%9F%94%A5%E5%88%9B%E5%BB%BA%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95%E8%A1%A8-toc" style="margin-left:40px;"><a href="#%F0%9F%94%A5%E5%88%9B%E5%BB%BA%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95%E8%A1%A8" rel="nofollow">ğŸ”¥åˆ›å»ºæ—¥å¿—è®°å½•è¡¨</a></p> 
<p id="%F0%9F%8C%BC%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7%E8%A1%A8%C2%A0-toc" style="margin-left:40px;"><a href="#%F0%9F%8C%BC%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7%E8%A1%A8%C2%A0" rel="nofollow">ğŸŒ¼åˆ›å»ºç”¨æˆ·è¡¨Â </a></p> 
<p id="%F0%9F%8D%89SpringBoot%E4%BD%BF%E7%94%A8AOP-toc" style="margin-left:0px;"><a href="#%F0%9F%8D%89SpringBoot%E4%BD%BF%E7%94%A8AOP" rel="nofollow">ğŸ‰SpringBootä½¿ç”¨AOP</a></p> 
<p id="%E4%B8%80%E3%80%81%E5%AF%BC%E5%85%A5%E4%BE%9D%E8%B5%96-toc" style="margin-left:40px;"><a href="#%E4%B8%80%E3%80%81%E5%AF%BC%E5%85%A5%E4%BE%9D%E8%B5%96" rel="nofollow">ä¸€ã€å¯¼å…¥ä¾èµ–</a></p> 
<p id="%E4%BA%8C%E3%80%81%E5%88%9B%E5%BB%BA%E6%88%91%E4%BB%AC%E7%9A%84%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84-toc" style="margin-left:40px;"><a href="#%E4%BA%8C%E3%80%81%E5%88%9B%E5%BB%BA%E6%88%91%E4%BB%AC%E7%9A%84%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84" rel="nofollow">äºŒã€åˆ›å»ºæˆ‘ä»¬çš„é¡¹ç›®ç»“æ„</a></p> 
<p id="%E4%B8%89%E3%80%81%E4%BD%BF%E7%94%A8AOP-toc" style="margin-left:40px;"><a href="#%E4%B8%89%E3%80%81%E4%BD%BF%E7%94%A8AOP" rel="nofollow">ä¸‰ã€ä½¿ç”¨AOP</a></p> 
<p id="1.%E5%88%9B%E5%BB%BA%E6%9E%9A%E4%B8%BE%E7%B1%BB-toc" style="margin-left:80px;"><a href="#1.%E5%88%9B%E5%BB%BA%E6%9E%9A%E4%B8%BE%E7%B1%BB" rel="nofollow">1.åˆ›å»ºæšä¸¾ç±»</a></p> 
<p id="2..%E5%88%9B%E5%BB%BALog%E6%B3%A8%E8%A7%A3-toc" style="margin-left:80px;"><a href="#2..%E5%88%9B%E5%BB%BALog%E6%B3%A8%E8%A7%A3" rel="nofollow">2..åˆ›å»ºLogæ³¨è§£</a></p> 
<p id="3.%E5%88%9B%E5%BB%BA%E5%88%87%E9%9D%A2%E7%B1%BB-toc" style="margin-left:80px;"><a href="#3.%E5%88%9B%E5%BB%BA%E5%88%87%E9%9D%A2%E7%B1%BB" rel="nofollow">3.åˆ›å»ºåˆ‡é¢ç±»</a></p> 
<p id="4.IpUtil-toc" style="margin-left:80px;"><a href="#4.IpUtil" rel="nofollow">4.IpUtil</a></p> 
<p id="5.%E8%BF%9B%E8%A1%8C%E6%B5%8B%E8%AF%95-toc" style="margin-left:80px;"><a href="#5.%E8%BF%9B%E8%A1%8C%E6%B5%8B%E8%AF%95" rel="nofollow">5.è¿›è¡Œæµ‹è¯•</a></p> 
<hr id="hr-toc"> 
<p></p> 
<p>åœ¨æˆ‘ä¹‹å‰çš„ä¸€ç¯‡æ–‡ç« ä¸­æˆ‘å·²ç»è®²è§£è¿‡äº†AOPçš„åŸºæœ¬æ¦‚å¿µï¼Œåœ¨è¿™é‡Œæ— éä¹Ÿå°±æ˜¯åœ¨é‡å¤ä¸€éã€‚</p> 
<h2 id="%F0%9F%93%95AOP%E7%AE%80%E4%BB%8B">ğŸ“•AOPç®€ä»‹</h2> 
<blockquote> 
 <p><span style="color:#7b7f82;">AOPçš„å…¨ç§°æ˜¯Aspect-Oriented Programmingï¼Œå³é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆä¹Ÿç§°é¢å‘æ–¹é¢ç¼–ç¨‹ï¼‰ã€‚å®ƒæ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰çš„ä¸€ç§è¡¥å……ï¼Œç›®å‰å·²æˆä¸ºä¸€ç§æ¯”è¾ƒæˆç†Ÿçš„ç¼–ç¨‹æ–¹å¼ã€‚</span></p> 
 <hr> 
 <p><span style="color:#7b7f82;">åœ¨ä¼ ç»Ÿçš„ä¸šåŠ¡å¤„ç†ä»£ç ä¸­ï¼Œé€šå¸¸éƒ½ä¼šè¿›è¡Œäº‹åŠ¡å¤„ç†ã€æ—¥å¿—è®°å½•ç­‰æ“ä½œã€‚è™½ç„¶ä½¿ç”¨OOPå¯ä»¥é€šè¿‡ç»„åˆæˆ–è€…ç»§æ‰¿çš„æ–¹å¼æ¥è¾¾åˆ°ä»£ç çš„é‡ç”¨ï¼Œä½†å¦‚æœè¦å®ç°æŸä¸ªåŠŸèƒ½ï¼ˆå¦‚æ—¥å¿—è®°å½•ï¼‰ï¼ŒåŒæ ·çš„ä»£ç ä»ç„¶ä¼šåˆ†æ•£åˆ°å„ä¸ªæ–¹æ³•ä¸­ã€‚è¿™æ ·ï¼Œå¦‚æœæƒ³è¦å…³é—­æŸä¸ªåŠŸèƒ½ï¼Œæˆ–è€…å¯¹å…¶è¿›è¡Œä¿®æ”¹ï¼Œå°±å¿…é¡»è¦ä¿®æ”¹æ‰€æœ‰çš„ç›¸å…³æ–¹æ³•ã€‚è¿™ä¸ä½†å¢åŠ äº†å¼€å‘äººå‘˜çš„å·¥ä½œé‡ï¼Œè€Œä¸”æé«˜äº†ä»£ç çš„å‡ºé”™ç‡ã€‚</span></p> 
 <hr> 
 <p><span style="color:#7b7f82;">ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼ŒAOPæ€æƒ³éšä¹‹äº§ç”Ÿã€‚AOPé‡‡å–æ¨ªå‘æŠ½å–æœºåˆ¶ï¼Œå°†åˆ†æ•£åœ¨å„ä¸ªæ–¹æ³•ä¸­çš„é‡å¤ä»£ç æå–å‡ºæ¥ï¼Œç„¶ååœ¨ç¨‹åºç¼–è¯‘æˆ–è¿è¡Œæ—¶ï¼Œå†å°†è¿™äº›æå–å‡ºæ¥çš„ä»£ç åº”ç”¨åˆ°éœ€è¦æ‰§è¡Œçš„åœ°æ–¹ã€‚è¿™ç§é‡‡ç”¨æ¨ªå‘æŠ½å–æœºåˆ¶çš„æ–¹å¼ï¼Œé‡‡ç”¨ä¼ ç»Ÿçš„OOPæ€æƒ³æ˜¾ç„¶æ˜¯æ— æ³•åŠåˆ°çš„ï¼Œå› ä¸ºOOPåªèƒ½å®ç°çˆ¶å­å…³ç³»çš„çºµå‘çš„é‡ç”¨ã€‚è™½ç„¶AOPæ˜¯ä¸€ç§æ–°çš„ç¼–ç¨‹æ€æƒ³ï¼Œä½†å´ä¸æ˜¯OOPçš„æ›¿ä»£å“ï¼Œå®ƒåªæ˜¯OOPçš„å»¶ä¼¸å’Œè¡¥å……ã€‚</span></p> 
</blockquote> 
<p><img alt="" height="273" src="https://images2.imgbox.com/86/ef/mJaNVQ5n_o.png" width="709"></p> 
<blockquote> 
 <p><span style="color:#7b7f82;">æƒ³è¦å†è¯¦ç»†äº†è§£AOPçš„å¤§å®¶å¯ä»¥çœ‹çœ‹æˆ‘è¿™ç¯‡æ–‡ç« ã€‚è¿™ç¯‡æ–‡ç« æˆ‘ä¸»è¦å°†åœ¨SpringBootä¸­ä½¿ç”¨AOPå®ç°æ—¥å¿—è®°å½•ã€‚</span></p> 
 <p><a href="https://blog.csdn.net/qq_61024956/article/details/138333607?spm=1001.2014.3001.5502" title="ã€Springã€‘Springä¸­AOPçš„ç®€ä»‹å’ŒåŸºæœ¬ä½¿ç”¨ï¼ŒSpringBootä½¿ç”¨AOP-CSDNåšå®¢">ã€Springã€‘Springä¸­AOPçš„ç®€ä»‹å’ŒåŸºæœ¬ä½¿ç”¨ï¼ŒSpringBootä½¿ç”¨AOP-CSDNåšå®¢</a></p> 
</blockquote> 
<h2 id="%F0%9F%93%82%E5%88%9B%E5%BB%BA%E6%97%A5%E5%BF%97%E6%95%B0%E6%8D%AE%E5%BA%93%C2%A0">ğŸ“‚åˆ›å»ºæ—¥å¿—æ•°æ®åº“Â </h2> 
<h3 id="%F0%9F%94%A5%E5%88%9B%E5%BB%BA%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95%E8%A1%A8">ğŸ”¥åˆ›å»ºæ—¥å¿—è®°å½•è¡¨</h3> 
<pre><code class="language-sql">SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
-- Table structure for sys_oper_log
-- ----------------------------
DROP TABLE IF EXISTS `sys_oper_log`;
CREATE TABLE `sys_oper_log`  (
  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'æ—¥å¿—ä¸»é”®',
  `operation` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT '' COMMENT 'æ“ä½œ',
  `business_type` varchar(20) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT '0' COMMENT 'ä¸šåŠ¡ç±»å‹',
  `method` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT '' COMMENT 'æ–¹æ³•åç§°',
  `create_time` datetime(0) NULL DEFAULT NULL COMMENT 'æ“ä½œæ—¶é—´',
  `oper_name` varchar(80) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT '' COMMENT 'æ“ä½œç”¨æˆ·',
  `params` text CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL COMMENT 'å‚æ•°',
  `ip` varchar(80) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT '' COMMENT 'è¯·æ±‚çš„ipåœ°å€',
  PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 2058 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_general_ci COMMENT = 'æ“ä½œæ—¥å¿—è®°å½•' ROW_FORMAT = Dynamic;

SET FOREIGN_KEY_CHECKS = 1;</code></pre> 
<h3 id="%F0%9F%8C%BC%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7%E8%A1%A8%C2%A0">ğŸŒ¼åˆ›å»ºç”¨æˆ·è¡¨Â </h3> 
<pre><code class="language-sql">SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
-- Table structure for user
-- ----------------------------
DROP TABLE IF EXISTS `user`;
CREATE TABLE `user`  (
  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `name` varchar(30) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL COMMENT 'å§“å ',
  `age` int(11) NULL DEFAULT NULL COMMENT 'å¹´é¾„ ',
  `email` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL COMMENT 'é‚®ç®± ',
  PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 9 CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Compact;

-- ----------------------------
-- Records of user
-- ----------------------------
INSERT INTO `user` VALUES (2, 'Jack', 20, 'test2@baomidou.com');
INSERT INTO `user` VALUES (3, 'Tom', 28, 'test3@baomidou.com');
INSERT INTO `user` VALUES (4, 'Sandy', 21, 'test4@baomidou.com');
INSERT INTO `user` VALUES (5, 'Billie', 24, 'test5@baomidou.com');
INSERT INTO `user` VALUES (6, 'sss', 18, '123@qq.com');
INSERT INTO `user` VALUES (8, 'sss', 18, '123@qq.com');

SET FOREIGN_KEY_CHECKS = 1;</code></pre> 
<p>ç®€å•çœ‹ä¸€ä¸‹è¡¨æ ¼çš„ç»“æ„ï¼Œæˆ‘è¿™é‡Œçš„æ•°æ®å°±ä¸ç»™å¤§å®¶å±•ç¤ºäº†ã€‚</p> 
<p><img alt="" height="249" src="https://images2.imgbox.com/7a/c3/strpsweW_o.png" width="1147">Â </p> 
<p><img alt="" height="354" src="https://images2.imgbox.com/ea/73/HcTFiv3x_o.png" width="1200">Â </p> 
<h2 id="%F0%9F%8D%89SpringBoot%E4%BD%BF%E7%94%A8AOP">ğŸ‰SpringBootä½¿ç”¨AOP</h2> 
<h3 id="%E4%B8%80%E3%80%81%E5%AF%BC%E5%85%A5%E4%BE%9D%E8%B5%96">ä¸€ã€å¯¼å…¥ä¾èµ–</h3> 
<p>ä¸‹è¾¹çš„ä¸‰ä¸ªä¾èµ–æ˜¯æˆ‘ä»¬çš„æ ¸å¿ƒä¾èµ–ã€‚</p> 
<pre><code class="language-sql">        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-aop&lt;/artifactId&gt;
        &lt;/dependency&gt;
         &lt;dependency&gt;
            &lt;groupId&gt;mysql&lt;/groupId&gt;
            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
            &lt;version&gt;8.0.29&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.baomidou&lt;/groupId&gt;
            &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt;
            &lt;version&gt;3.4.3&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;</code></pre> 
<h3 id="%E4%BA%8C%E3%80%81%E5%88%9B%E5%BB%BA%E6%88%91%E4%BB%AC%E7%9A%84%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84">äºŒã€åˆ›å»ºæˆ‘ä»¬çš„é¡¹ç›®ç»“æ„</h3> 
<blockquote> 
 <ul><li>åˆ›å»º<strong>UserMapper</strong></li></ul> 
 <pre><code class="language-java">@Mapper
public interface UserMapper extends BaseMapper&lt;User&gt; {
}</code></pre> 
 <ul><li>åˆ›å»º<strong>UserService</strong></li></ul> 
 <pre><code class="language-java">public interface UserService extends IService&lt;User&gt; {
}</code></pre> 
 <ul><li>åˆ›å»º<strong>UserServiceImpl</strong></li></ul> 
 <pre><code class="language-java">@Service
public class UserServiceImpl extends ServiceImpl&lt;UserMapper, User&gt; implements UserService {
}</code></pre> 
 <ul><li>åˆ›å»º<strong>UserController</strong></li></ul> 
 <pre><code class="language-java">@RestController
@RequestMapping("/user")
public class UserController {
    @Autowired
    private UserService userService;
    @Log(operation = "æŸ¥æ‰¾ç”¨æˆ·",businessType = BusinessType.LIST)
    @RequestMapping("/find-user")
    public String findUser(){
        return userService.list().toString();
    }
}</code></pre> 
</blockquote> 
<blockquote> 
 <p><strong>åˆ›å»ºä¸¤ä¸ªå®ä½“</strong></p> 
 <ul><li>åˆ›å»ºUser</li></ul> 
 <pre><code class="language-java">@Data
public class User {
    @TableId(type = IdType.ASSIGN_ID)
    private Long id;
    private String name;
    private Integer age;
    private String email;
    
}</code></pre> 
 <ul><li>åˆ›å»ºSysOperLog</li></ul> 
 <pre><code class="language-java">@Data
@TableName("sys_oper_log")
public class SysOperLog {

        @TableId(type = IdType.AUTO)
        private Long id;

        private String operation;

        private String businessType;

        private String method;

        @TableField(fill = FieldFill.INSERT)
        private LocalDateTime createTime;

        private String operName;

        private String params;

        private String ip;
}</code></pre> 
 <p>Â </p> 
</blockquote> 
<h3 id="%E4%B8%89%E3%80%81%E4%BD%BF%E7%94%A8AOP">ä¸‰ã€ä½¿ç”¨AOP</h3> 
<h4 id="1.%E5%88%9B%E5%BB%BA%E6%9E%9A%E4%B8%BE%E7%B1%BB">1.åˆ›å»ºæšä¸¾ç±»</h4> 
<p>è¿™ä¸ªæšä¸¾ç±»çš„ä½œç”¨å°±æ˜¯è®°å½•æˆ‘ä»¬è°ƒç”¨çš„æ¥å£æ˜¯ä»€ä¹ˆæ ·çš„ä¸€ä¸ªç±»å‹çš„ï¼Œæ˜¯æŸ¥æ‰¾ã€åˆ é™¤è¿˜æ˜¯å…¶ä»–ã€‚</p> 
<pre><code class="language-java">public enum BusinessType {
    /**
     * å…¶å®ƒ
     */
    OTHER,

    /**
     * æ–°å¢
     */
    INSERT,

    /**
     * ä¿®æ”¹
     */
    UPDATE,

    /**
     * åˆ é™¤
     */
    DELETE,
    
    /**
     * æµè§ˆ
     */
    LIST
}</code></pre> 
<h4 id="2..%E5%88%9B%E5%BB%BALog%E6%B3%A8%E8%A7%A3">2..åˆ›å»ºLogæ³¨è§£</h4> 
<p>é»˜è®¤çš„æ“ä½œä¸ºç©ºï¼Œé»˜è®¤çš„æ“ä½œç±»å‹æ˜¯OTHERã€‚</p> 
<pre><code class="language-java">@Target({ElementType.METHOD})
@Retention(RetentionPolicy.RUNTIME)
@Documented
public @interface Log {
    /**
     * æ“ä½œåç§°
     * @return
     */
    String operation() default "";

    /**
     * æ“ä½œçš„ç±»å‹
     * @return
     */
    BusinessType businessType() default BusinessType.OTHER;
}</code></pre> 
<h4 id="3.%E5%88%9B%E5%BB%BA%E5%88%87%E9%9D%A2%E7%B1%BB">3.åˆ›å»ºåˆ‡é¢ç±»</h4> 
<pre><code class="language-java">@Aspect
@Component
public class LogAspect {
    @Pointcut("@annotation(com.qcby.annotation.Log)")
    public void pointCut(){}

    @Autowired
    HttpServletRequest request;
    @Autowired
    SysOperLogMapper sysOperLogMapper;

    @After(value = "pointCut()")
    public void afterLogWrite(JoinPoint joinPoint){
        // åˆ›å»ºæ—¥å¿—å¯¹è±¡
        SysOperLog sysOperLog = new SysOperLog();
        // è·å–æˆ‘ä»¬è°ƒç”¨çš„æ–¹æ³•
        MethodSignature signature = (MethodSignature) joinPoint.getSignature();
        Method method = signature.getMethod();

        // è·å–æ–¹æ³•ä¸Šçš„Logæ³¨è§£ï¼Œå› ä¸ºæˆ‘ä»¬è¦è·å–æ³¨è§£ä¸­çš„ä¸€äº›ä¿¡æ¯
        Log log = method.getAnnotation(Log.class);

        // è·å–æˆ‘ä»¬è°ƒç”¨çš„ç±»çš„åç§°
        String className = joinPoint.getTarget().getClass().getName();
        // è·å–è°ƒç”¨çš„æ–¹æ³•çš„åç§°
        String methodName = method.getName();
        // é‡æ–°ä¿®æ”¹ä¸€ä¸‹æˆ‘ä»¬è°ƒç”¨çš„æ–¹æ³• æ˜¯å…¨è·¯å¾„çš„
        methodName = className + methodName;

        // è·å–æ–¹æ³•çš„å‚æ•°
        Object[] args = joinPoint.getArgs();
        ObjectMapper objectMapper = new ObjectMapper();
        String params = "";
        try {
            params =  objectMapper.writeValueAsString(args);
        } catch (JsonProcessingException e) {
            e.printStackTrace();
        }

        // è·å–æ³¨è§£ä¸­çš„æ“ä½œåç§°
        String operation = log.operation();
        // è·å–æ³¨è§£ä¸­çš„æ“ä½œç±»å‹
        String businessType = log.businessType().toString();

        // è¿™é‡Œçš„æ“ä½œäººå‘˜ä»…é åç«¯æ˜¯å†™ä¸äº†çš„  éœ€è¦å‰ç«¯çš„tokenè®¤è¯  æˆ‘ç›´æ¥æŠŠæ“ä½œäººå‘˜æ”¹ä¸ºadmin
        String username = "admin";

        // è·å–ipåœ°å€
        String ipAddress = IpUtil.getIpAddr(request);

        sysOperLog.setBusinessType(businessType);
        sysOperLog.setOperation(operation);
        sysOperLog.setMethod(methodName);
        sysOperLog.setParams(params);
        sysOperLog.setIp(ipAddress);
        sysOperLog.setOperName(username);
        sysOperLog.setCreateTime(LocalDateTime.now());
        
        sysOperLogMapper.insert(sysOperLog);
        
    }
}
</code></pre> 
<h4 id="4.IpUtil">4.IpUtil</h4> 
<pre><code class="language-java">public class IpUtil {
    private static final String UNKNOWN = "unknown";
    private static final String LOCALHOST = "127.0.0.1";
    private static final String SEPARATOR = ",";

    public static String getIpAddr(HttpServletRequest request) {
        System.out.println(request);
        String ipAddress;
        try {
            ipAddress = request.getHeader("x-forwarded-for");
            if (ipAddress == null || ipAddress.length() == 0 || UNKNOWN.equalsIgnoreCase(ipAddress)) {
                ipAddress = request.getHeader("Proxy-Client-IP");
            }
            if (ipAddress == null || ipAddress.length() == 0 || UNKNOWN.equalsIgnoreCase(ipAddress)) {
                ipAddress = request.getHeader("WL-Proxy-Client-IP");
            }
            if (ipAddress == null || ipAddress.length() == 0 || UNKNOWN.equalsIgnoreCase(ipAddress)) {
                ipAddress = request.getRemoteAddr();
                if (LOCALHOST.equals(ipAddress)) {
                    InetAddress inet = null;
                    try {
                        inet = InetAddress.getLocalHost();
                    } catch (UnknownHostException e) {
                        e.printStackTrace();
                    }
                    ipAddress = inet.getHostAddress();
                }
            }
            // å¯¹äºé€šè¿‡å¤šä¸ªä»£ç†çš„æƒ…å†µï¼Œç¬¬ä¸€ä¸ªIPä¸ºå®¢æˆ·ç«¯çœŸå®IP,å¤šä¸ªIPæŒ‰ç…§','åˆ†å‰²
            // "***.***.***.***".length()
            if (ipAddress != null &amp;&amp; ipAddress.length() &gt; 15) {
                if (ipAddress.indexOf(SEPARATOR) &gt; 0) {
                    ipAddress = ipAddress.substring(0, ipAddress.indexOf(","));
                }
            }
        } catch (Exception e) {
            ipAddress = "";
        }
        return ipAddress;
    }
}</code></pre> 
<h4 id="5.%E8%BF%9B%E8%A1%8C%E6%B5%8B%E8%AF%95">5.è¿›è¡Œæµ‹è¯•</h4> 
<p>æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸Šè¾“å…¥ç½‘å€:</p> 
<pre><code class="language-java">127.0.0.1:8080/user/find-user</code></pre> 
<p>æ•°æ®æ˜¯æ²¡é—®é¢˜çš„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åªéœ€è¦æŸ¥çœ‹æ•°æ®çš„æ—¥å¿—æ–‡ä»¶æ˜¯å¦æ’å…¥äº†æ—¥å¿—å°±å¥½äº†ã€‚Â </p> 
<p><img alt="" height="270" src="https://images2.imgbox.com/7d/46/Oi3FL3tY_o.png" width="1200"></p> 
<p>è¿™é‡Œæˆ‘æŸ¥æ‰¾äº†ä¸¤æ¬¡ï¼Œä¸€æ¬¡ä½¿ç”¨çš„localhostï¼Œå¦ä¸€æ¬¡ä½¿ç”¨çš„127.0.0.1ã€‚æ—¥å¿—å¯ä»¥æˆåŠŸè®°å½•ã€‚Â </p> 
<p><img alt="" height="245" src="https://images2.imgbox.com/d4/c4/W4S2Nf0M_o.png" width="1017">Â </p> 
<p>Â </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2cf29e511544e3ea2d433dfc4b2c2f8a/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">ç½‘ç»œå®‰å…¨ï¼ˆé»‘å®¢ï¼‰â€”-2024è‡ªå­¦æ‰‹å†Œ</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2629928dc7920a8aa0ea29874ae4b7e3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">å¦‚ä½•ä½¿ç”¨androidstudioæˆåŠŸå¯¼å…¥åˆ«äººé¡¹ç›®æ•™ç¨‹</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§å’–.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>