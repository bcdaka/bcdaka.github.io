<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>第T2周：彩色图片分类 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/8473114a53685a6f037a73b1b641ca76/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="第T2周：彩色图片分类">
  <meta property="og:description" content="本文为🔗365天深度学习训练营 中的学习记录博客原作者：K同学啊 要求：
●学习如何编写一个完整的深度学习程序
●了解分类彩色图片会灰度图片有什么区别
●测试集accuracy到达72%
我的环境：
●语言环境：Python 3.6.5
●编译器：jupyter notebook
●深度学习环境：TensorFlow 2.6.2
一、前期工作
设置GPU 如果使用的是CPU可以忽略这步
import tensorflow as tf gpus = tf.config.list_physical_devices(&#34;GPU&#34;) if gpus: gpu0 = gpus[0] #如果有多个GPU，仅使用第0个GPU tf.config.experimental.set_memory_growth(gpu0, True) #设置GPU显存用量按需使用 tf.config.set_visible_devices([gpu0],&#34;GPU&#34;) 导入数据 import tensorflow as tf from tensorflow.keras import datasets, layers, models import matplotlib.pyplot as plt # 导入cifar10数据，依次分别为训练集图片、训练集标签、测试集图片、测试集标签 (train_images, train_labels), (test_images, test_labels) = datasets.cifar10.load_data() 归一化 # 将像素的值标准化至0到1的区间内。 train_images, test_images = train_images / 255.0, test_images / 255.0 # 查看数据维数信息 train_images.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-09-02T17:36:29+08:00">
    <meta property="article:modified_time" content="2024-09-02T17:36:29+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">第T2周：彩色图片分类</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <ul><li><strong>本文为<a href="https://mp.weixin.qq.com/s/Z9yL_wt7L8aPOr9Lqb1K3w" rel="nofollow">🔗365天深度学习训练营</a> 中的学习记录博客</strong></li><li><strong>原作者：<a href="https://mtyjkh.blog.csdn.net/" rel="nofollow">K同学啊</a></strong></li></ul> 
</blockquote> 
<p>要求：<br> ●学习如何编写一个完整的深度学习程序<br> ●了解分类彩色图片会灰度图片有什么区别<br> ●测试集accuracy到达72%</p> 
<p>我的环境：<br> ●语言环境：Python 3.6.5<br> ●编译器：jupyter notebook<br> ●深度学习环境：TensorFlow 2.6.2</p> 
<p>一、前期工作</p> 
<ol><li>设置GPU</li></ol> 
<p>如果使用的是CPU可以忽略这步</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf
gpus <span class="token operator">=</span> tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>list_physical_devices<span class="token punctuation">(</span><span class="token string">"GPU"</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> gpus<span class="token punctuation">:</span>
    gpu0 <span class="token operator">=</span> gpus<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment">#如果有多个GPU，仅使用第0个GPU</span>
    tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>experimental<span class="token punctuation">.</span>set_memory_growth<span class="token punctuation">(</span>gpu0<span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment">#设置GPU显存用量按需使用</span>
    tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>set_visible_devices<span class="token punctuation">(</span><span class="token punctuation">[</span>gpu0<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"GPU"</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="2"><li>导入数据</li></ol> 
<pre><code class="prism language-python"><span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras <span class="token keyword">import</span> datasets<span class="token punctuation">,</span> layers<span class="token punctuation">,</span> models
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt


<span class="token comment"># 导入cifar10数据，依次分别为训练集图片、训练集标签、测试集图片、测试集标签</span>
<span class="token punctuation">(</span>train_images<span class="token punctuation">,</span> train_labels<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>test_images<span class="token punctuation">,</span> test_labels<span class="token punctuation">)</span> <span class="token operator">=</span> datasets<span class="token punctuation">.</span>cifar10<span class="token punctuation">.</span>load_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="3"><li>归一化</li></ol> 
<pre><code class="prism language-python"><span class="token comment"># 将像素的值标准化至0到1的区间内。</span>
train_images<span class="token punctuation">,</span> test_images <span class="token operator">=</span> train_images <span class="token operator">/</span> <span class="token number">255.0</span><span class="token punctuation">,</span> test_images <span class="token operator">/</span> <span class="token number">255.0</span>

<span class="token comment"># 查看数据维数信息</span>
train_images<span class="token punctuation">.</span>shape<span class="token punctuation">,</span>test_images<span class="token punctuation">.</span>shape<span class="token punctuation">,</span>train_labels<span class="token punctuation">.</span>shape<span class="token punctuation">,</span>test_labels<span class="token punctuation">.</span>shape
</code></pre> 
<p>代码输出</p> 
<pre><code>((50000, 32, 32, 3), (10000, 32, 32, 3), (50000, 1), (10000, 1))
</code></pre> 
<ol start="4"><li>可视化</li></ol> 
<pre><code class="prism language-python">class_names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'airplane'</span><span class="token punctuation">,</span> <span class="token string">'automobile'</span><span class="token punctuation">,</span> <span class="token string">'bird'</span><span class="token punctuation">,</span> <span class="token string">'cat'</span><span class="token punctuation">,</span> <span class="token string">'deer'</span><span class="token punctuation">,</span><span class="token string">'dog'</span><span class="token punctuation">,</span> <span class="token string">'frog'</span><span class="token punctuation">,</span> <span class="token string">'horse'</span><span class="token punctuation">,</span> <span class="token string">'ship'</span><span class="token punctuation">,</span> <span class="token string">'truck'</span><span class="token punctuation">]</span>


<span class="token comment"># 将数据集前20个图片数据可视化显示</span>
<span class="token comment"># 进行图像大小为20宽、10长的绘图(单位为英寸inch)</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token comment"># 设置不显示x轴刻度</span>
    plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># 设置不显示y轴刻度</span>
    plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># 设置不显示子图网格线</span>
    plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>
     <span class="token comment"># 图像展示，cmap为颜色图谱，"plt.cm.binary"为matplotlib.cm中的色表</span>
    plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>train_images<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span>plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>binary<span class="token punctuation">)</span>
     <span class="token comment"># 设置x轴标签显示为图片对应的标签</span>
    plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span>class_names<span class="token punctuation">[</span>train_labels<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 显示图片</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>代码输出</p> 
<p><img src="https://images2.imgbox.com/34/e5/sr6obVw9_o.png" alt="在这里插入图片描述"></p> 
<p>二、构建简单的CNN网络</p> 
<p>池化层对提取到的特征信息进行降维，一方面使特征图变小，简化网络计算复杂度；另一方面进行特征压缩，提取主要特征，增加平移不变性，减少过拟合风险。但其实池化更多程度上是一种计算性能的一个妥协，强硬地压缩特征的同时也损失了一部分信息，所以现在的网络比较少用池化层或者使用优化后的如SoftPool。</p> 
<p>池化层包括最大池化层（MaxPooling）和平均池化层（AveragePooling），均值池化对背景保留更好，最大池化对纹理提取更好）。同卷积计算，池化层计算窗口内的平均值或者最大值。例如通过一个 2*2 的最大池化层，其计算方式如下：<br> <img src="https://images2.imgbox.com/87/2f/YQYSst2o_o.jpg" alt="在这里插入图片描述"></p> 
<p>即将构建模型的结构图，分别二维和三维的形式展示出来方便大家理解。</p> 
<p>平面结构图<br> <img src="https://images2.imgbox.com/81/71/P8JMl1PE_o.png" alt="在这里插入图片描述"></p> 
<p>立体结构图<br> <img src="https://images2.imgbox.com/f9/c5/546EGcod_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># 创建并设置卷积神经网络</span>
<span class="token comment"># 卷积层：通过卷积操作对输入图像进行降维和特征抽取</span>
<span class="token comment"># 池化层：是一种非线性形式的下采样。主要用于特征降维，压缩数据和参数的数量，减小过拟合，同时提高模型的鲁棒性。</span>
<span class="token comment"># 全连接层：在经过几个卷积和池化层之后，神经网络中的高级推理通过全连接层来完成。</span>

model <span class="token operator">=</span> models<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token punctuation">[</span>

    <span class="token comment"># 设置二维卷积层1，设置32个3*3卷积核，activation参数将激活函数设置为ReLu函数，input_shape参数将图层的输入形状设置为(32,32,3)</span>
    <span class="token comment"># ReLu函数作为激活励函数可以增强判定函数和整个神经网络的非线性特性，而本身并不会改变卷积层</span>
    <span class="token comment"># 相比其它函数来说，ReLU函数更受青睐，这是因为它可以将神经网络的训练速度提升数倍，而并不会对模型的泛化准确度造成显著影响。</span>
    
    layers<span class="token punctuation">.</span>Conv2D<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">,</span> input_shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">#卷积层1，卷积核3*3</span>
    layers<span class="token punctuation">.</span>MaxPooling2D<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                   <span class="token comment">#池化层1，2*2采样</span>
    layers<span class="token punctuation">.</span>Conv2D<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">#卷积层2，卷积核3*3</span>
    layers<span class="token punctuation">.</span>MaxPooling2D<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                   <span class="token comment">#池化层2，2*2采样</span>
    layers<span class="token punctuation">.</span>Conv2D<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">#卷积层3，卷积核3*3</span>
    
    layers<span class="token punctuation">.</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                      <span class="token comment">#Flatten层，连接卷积层与全连接层</span>
    layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>   <span class="token comment">#全连接层，特征进一步提取</span>
    layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>                       <span class="token comment">#输出层，输出预期结果，10为输出空间的维数</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 打印网络结构</span>
</code></pre> 
<p>代码输出</p> 
<pre><code>Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_17 (Conv2D)           (None, 30, 30, 32)        896       
_________________________________________________________________
max_pooling2d_14 (MaxPooling (None, 15, 15, 32)        0         
_________________________________________________________________
conv2d_18 (Conv2D)           (None, 13, 13, 64)        18496     
_________________________________________________________________
max_pooling2d_15 (MaxPooling (None, 6, 6, 64)          0         
_________________________________________________________________
conv2d_19 (Conv2D)           (None, 4, 4, 64)          36928     
_________________________________________________________________
flatten_7 (Flatten)          (None, 1024)              0         
_________________________________________________________________
dense_14 (Dense)             (None, 64)                65600     
_________________________________________________________________
dense_15 (Dense)             (None, 10)                650       
=================================================================
Total params: 122,570
Trainable params: 122,570
Non-trainable params: 0
_________________________________________________________________
</code></pre> 
<p>三、编译模型</p> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""
这里设置优化器、损失函数以及metrics
"""</span>
<span class="token comment"># model.compile()方法用于在配置训练方法时，告知训练时用的优化器、损失函数和准确率评测标准</span>

model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>
              <span class="token comment"># 设置优化器为Adam优化器</span>
              optimizer<span class="token operator">=</span><span class="token string">'adam'</span><span class="token punctuation">,</span>                                               
              <span class="token comment"># 设置损失函数为交叉熵损失函数（tf.keras.losses.SparseCategoricalCrossentropy()）</span>
              <span class="token comment"># from_logits为True时，会将y_pred转化为概率（用softmax），否则不进行转换，通常情况下用True结果更稳定</span>
              loss<span class="token operator">=</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>losses<span class="token punctuation">.</span>SparseCategoricalCrossentropy<span class="token punctuation">(</span>from_logits<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              <span class="token comment"># 设置性能指标列表，将在模型训练时监控列表中的指标</span>
              metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>四、训练模型</p> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""
这里设置输入训练数据集（图片及标签）、验证数据集（图片及标签）以及迭代次数epochs
关于model.fit()函数的具体介绍可参考下面的博客：
https://blog.csdn.net/qq_38251616/article/details/122321757
"""</span>

history <span class="token operator">=</span> model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>
                    <span class="token comment"># 输入训练集图片</span>
                    train_images<span class="token punctuation">,</span> 
                    <span class="token comment"># 输入训练集标签</span>
                    train_labels<span class="token punctuation">,</span> 
                    <span class="token comment"># 设置10个epoch，每一个epoch都将会把所有的数据输入模型完成一次训练。</span>
                    epochs<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> 
                    <span class="token comment"># 设置验证集</span>
                    validation_data<span class="token operator">=</span><span class="token punctuation">(</span>test_images<span class="token punctuation">,</span> test_labels<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>代码输出</p> 
<pre><code>Epoch 1/10
1563/1563 [==============================] - 60s 38ms/step - loss: 1.5249 - accuracy: 0.4436 - val_loss: 1.2871 - val_accuracy: 0.5290
Epoch 2/10
1563/1563 [==============================] - 58s 37ms/step - loss: 1.1353 - accuracy: 0.5964 - val_loss: 1.1610 - val_accuracy: 0.5881
Epoch 3/10
1563/1563 [==============================] - 58s 37ms/step - loss: 0.9876 - accuracy: 0.6531 - val_loss: 0.9847 - val_accuracy: 0.6471
Epoch 4/10
1563/1563 [==============================] - 57s 37ms/step - loss: 0.8943 - accuracy: 0.6858 - val_loss: 0.9196 - val_accuracy: 0.6797
Epoch 5/10
1563/1563 [==============================] - 60s 38ms/step - loss: 0.8251 - accuracy: 0.7120 - val_loss: 0.8963 - val_accuracy: 0.6842
Epoch 6/10
1563/1563 [==============================] - 58s 37ms/step - loss: 0.7695 - accuracy: 0.7327 - val_loss: 0.8835 - val_accuracy: 0.6954
Epoch 7/10
1563/1563 [==============================] - 59s 38ms/step - loss: 0.7245 - accuracy: 0.7453 - val_loss: 0.8565 - val_accuracy: 0.7037
Epoch 8/10
1563/1563 [==============================] - 57s 37ms/step - loss: 0.6795 - accuracy: 0.7623 - val_loss: 0.8657 - val_accuracy: 0.7017
Epoch 9/10
1563/1563 [==============================] - 58s 37ms/step - loss: 0.6393 - accuracy: 0.7761 - val_loss: 0.8812 - val_accuracy: 0.7061
Epoch 10/10
1563/1563 [==============================] - 58s 37ms/step - loss: 0.6069 - accuracy: 0.7865 - val_loss: 0.8741 - val_accuracy: 0.7117
</code></pre> 
<p>五、预测</p> 
<p>通过模型进行预测得到的是每一个类别的概率，数字越大该图片为该类别的可能性越大。</p> 
<pre><code class="prism language-python">plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>test_images<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>代码输出</p> 
<pre><code>&lt;matplotlib.image.AxesImage at 0x1c10de85550&gt;
</code></pre> 
<p><img src="https://images2.imgbox.com/77/f4/hmvNrmIt_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

pre <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>test_images<span class="token punctuation">)</span>          <span class="token comment"># 对所有测试图片进行预测</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>class_names<span class="token punctuation">[</span>np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>pre<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>      <span class="token comment"># 输出索引为 1 的图片的预测结果</span>
</code></pre> 
<p>代码输出</p> 
<pre><code>ship
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">#随机预测某张图片的结果</span>

<span class="token keyword">import</span> random

<span class="token comment"># 从0到len(pre)的范围内随机取一个整数（包括0，但不包括 (len(pre)+1)）</span>
random_number <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pre<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>random_number<span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>test_images<span class="token punctuation">[</span>random_number<span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>class_names<span class="token punctuation">[</span>np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>pre<span class="token punctuation">[</span>random_number<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>      <span class="token comment"># 输出索引为 random_number 的图片的预测结果</span>
</code></pre> 
<p>代码输出</p> 
<pre><code>3403
</code></pre> 
<p><img src="https://images2.imgbox.com/cb/57/wp85MX5S_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">ship
</code></pre> 
<p>注：上面的“ship”也是代码输出的结果之一。</p> 
<p>六、模型评估</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>history<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'accuracy'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>history<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'val_accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token string">'val_accuracy'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Epoch'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Accuracy'</span><span class="token punctuation">)</span>
<span class="token comment">#plt.ylim([0.5, 1])</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'lower right'</span><span class="token punctuation">)</span>


plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>history<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'loss'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'loss'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>history<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'val_loss'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token string">'val_loss'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Epoch'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Accuracy'</span><span class="token punctuation">)</span>
<span class="token comment">#plt.ylim([0.5, 1])</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'upper right'</span><span class="token punctuation">)</span>


plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

test_loss<span class="token punctuation">,</span> test_acc <span class="token operator">=</span> model<span class="token punctuation">.</span>evaluate<span class="token punctuation">(</span>test_images<span class="token punctuation">,</span>  test_labels<span class="token punctuation">,</span> verbose<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre> 
<p>代码输出</p> 
<p><img src="https://images2.imgbox.com/41/8f/CpJpWLyG_o.png" alt="在这里插入图片描述"></p> 
<pre><code>313/313 - 3s - loss: 0.8741 - accuracy: 0.7117
</code></pre> 
<p>分析上图可知，模型在训练集上的损失低、准确率高。模型在验证集或测试集上的损失高、准确率低，甚至随着训练的进行，验证集性能逐渐下降。<br> 这是过拟合的迹象。</p> 
<p>七、将测试集accuracy到达72%</p> 
<p>也就是解决过拟合。</p> 
<p>过拟合（Overfitting） 是机器学习模型训练中常见的问题，指的是模型在训练数据上表现得非常好，但在验证或测试数据（未见过的数据）上的表现较差。这意味着模型过于复杂，以至于学习到了训练数据中的噪声或特定模式，而不是数据的通用特征，导致在新数据上泛化能力不足。</p> 
<p>过拟合的表现：</p> 
<blockquote> 
 <p>训练集性能非常好：模型在训练集上的损失低、准确率高。<br> 验证集/测试集性能较差：模型在验证集或测试集上的损失高、准确率低，甚至随着训练的进行，验证集性能逐渐下降。</p> 
</blockquote> 
<p>过拟合的原因：</p> 
<blockquote> 
 <p>模型复杂度高：模型参数过多，层数过深，或神经元数量过多，导致模型能够记住训练集中的每一个细节和噪声。<br> 数据量不足：训练数据量过少，模型没有足够的多样性来学习数据的通用特征。<br> 训练时间过长：训练时间过长可能导致模型在训练集上不断优化，逐渐学习到训练集中的噪声。<br> 数据噪声：训练数据中存在的异常值或噪声会被模型过度学习，导致其在新数据上表现不佳。</p> 
</blockquote> 
<p>如何防止过拟合</p> 
<blockquote> 
 <p>增加数据量：通过收集更多的数据或使用数据增强技术来增加数据的多样性，使模型更好地学习数据的通用特征。<br> 使用正则化：如 L2正则化、Dropout 等技术，可以限制模型的复杂度，防止其过度拟合训练数据。<br> 简化模型：减少模型的层数或神经元数量，使模型更简单，减少其记住训练集细节的能力。<br> 早停法（Early Stopping）：在训练过程中监控验证集的性能，一旦验证集性能不再提升（甚至开始下降），就停止训练。<br> 交叉验证：使用交叉验证来评估模型的性能，以减少模型对特定数据分割的依赖，增强模型的泛化能力。<br> 调整学习率：使用学习率调度器或较低的学习率，使模型在训练后期收敛得更平滑，避免过度拟合。</p> 
</blockquote> 
<p>通过采取这些措施，可以有效降低过拟合的风险，从而提高模型在新数据上的表现。</p> 
<p>经过上网查资料和多次训练，将epochs修改为20，结果不如意，甚至比epochs=10的结果更差，过拟合现象更突出，说明模型一定过拟合了。<br> 也利用LearningRateScheduler创建学习率衰减函数，更改Adam优化器为Adagrad等，均未实现目标。</p> 
<p>因为是模型出现了过拟合现象，因此用layers.Dropout(0.4)防止过拟合，提高模型的泛化能力，训练结果达到要求了。</p> 
<p>在以下两个方面进行了修改：<br> 1.将epochs=10修改为epochs=15，如下所示：</p> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""
这里设置输入训练数据集（图片及标签）、验证数据集（图片及标签）以及迭代次数epochs
关于model.fit()函数的具体介绍可参考下面的博客：
https://blog.csdn.net/qq_38251616/article/details/122321757
"""</span>

history <span class="token operator">=</span> model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>
                    <span class="token comment"># 输入训练集图片</span>
                    train_images<span class="token punctuation">,</span> 
                    <span class="token comment"># 输入训练集标签</span>
                    train_labels<span class="token punctuation">,</span> 
                    <span class="token comment"># 设置15个epoch，每一个epoch都将会把所有的数据输入模型完成一次训练。</span>
                    epochs<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span> 
                    <span class="token comment"># 设置验证集</span>
                    validation_data<span class="token operator">=</span><span class="token punctuation">(</span>test_images<span class="token punctuation">,</span> test_labels<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>2.在CNN网络模型中增加“layers.Dropout(0.4)”，如下所示：</p> 
<pre><code class="prism language-python"><span class="token comment"># 创建并设置卷积神经网络</span>
<span class="token comment"># 卷积层：通过卷积操作对输入图像进行降维和特征抽取</span>
<span class="token comment"># 池化层：是一种非线性形式的下采样。主要用于特征降维，压缩数据和参数的数量，减小过拟合，同时提高模型的鲁棒性。</span>
<span class="token comment"># 全连接层：在经过几个卷积和池化层之后，神经网络中的高级推理通过全连接层来完成。</span>

model <span class="token operator">=</span> models<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token punctuation">[</span>

    <span class="token comment"># 设置二维卷积层1，设置32个3*3卷积核，activation参数将激活函数设置为ReLu函数，input_shape参数将图层的输入形状设置为(32,32,3)</span>
    <span class="token comment"># ReLu函数作为激活励函数可以增强判定函数和整个神经网络的非线性特性，而本身并不会改变卷积层</span>
    <span class="token comment"># 相比其它函数来说，ReLU函数更受青睐，这是因为它可以将神经网络的训练速度提升数倍，而并不会对模型的泛化准确度造成显著影响。</span>
    
    layers<span class="token punctuation">.</span>Conv2D<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">,</span> input_shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">#卷积层1，卷积核3*3</span>
    layers<span class="token punctuation">.</span>MaxPooling2D<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                   <span class="token comment">#池化层1，2*2采样</span>
    layers<span class="token punctuation">.</span>Conv2D<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">#卷积层2，卷积核3*3</span>
    layers<span class="token punctuation">.</span>MaxPooling2D<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                   <span class="token comment">#池化层2，2*2采样</span>
    layers<span class="token punctuation">.</span>Conv2D<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">#卷积层3，卷积核3*3</span>

    layers<span class="token punctuation">.</span>Dropout<span class="token punctuation">(</span><span class="token number">0.4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># 让神经元以一定的概率停止工作，防止过拟合，提高模型的泛化能力。</span>
    
    layers<span class="token punctuation">.</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                      <span class="token comment">#Flatten层，连接卷积层与全连接层</span>
    layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>   <span class="token comment">#全连接层，特征进一步提取</span>
    layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>                       <span class="token comment">#输出层，输出预期结果，10为输出空间的维数</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 打印网络结构</span>
</code></pre> 
<p>训练数据如下所示：</p> 
<pre><code class="prism language-python">Epoch <span class="token number">1</span><span class="token operator">/</span><span class="token number">15</span>
<span class="token number">1563</span><span class="token operator">/</span><span class="token number">1563</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 51s 32ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">1.5991</span> <span class="token operator">-</span> accuracy<span class="token punctuation">:</span> <span class="token number">0.4103</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">1.2660</span> <span class="token operator">-</span> val_accuracy<span class="token punctuation">:</span> <span class="token number">0.5516</span>
Epoch <span class="token number">2</span><span class="token operator">/</span><span class="token number">15</span>
<span class="token number">1563</span><span class="token operator">/</span><span class="token number">1563</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 50s 32ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">1.2697</span> <span class="token operator">-</span> accuracy<span class="token punctuation">:</span> <span class="token number">0.5447</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">1.1952</span> <span class="token operator">-</span> val_accuracy<span class="token punctuation">:</span> <span class="token number">0.5719</span>
Epoch <span class="token number">3</span><span class="token operator">/</span><span class="token number">15</span>
<span class="token number">1563</span><span class="token operator">/</span><span class="token number">1563</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 49s 31ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">1.1372</span> <span class="token operator">-</span> accuracy<span class="token punctuation">:</span> <span class="token number">0.5962</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">1.0070</span> <span class="token operator">-</span> val_accuracy<span class="token punctuation">:</span> <span class="token number">0.6447</span>
Epoch <span class="token number">4</span><span class="token operator">/</span><span class="token number">15</span>
<span class="token number">1563</span><span class="token operator">/</span><span class="token number">1563</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 49s 31ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">1.0468</span> <span class="token operator">-</span> accuracy<span class="token punctuation">:</span> <span class="token number">0.6295</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.9739</span> <span class="token operator">-</span> val_accuracy<span class="token punctuation">:</span> <span class="token number">0.6545</span>
Epoch <span class="token number">5</span><span class="token operator">/</span><span class="token number">15</span>
<span class="token number">1563</span><span class="token operator">/</span><span class="token number">1563</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 57s 37ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.9842</span> <span class="token operator">-</span> accuracy<span class="token punctuation">:</span> <span class="token number">0.6517</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.8994</span> <span class="token operator">-</span> val_accuracy<span class="token punctuation">:</span> <span class="token number">0.6838</span>
Epoch <span class="token number">6</span><span class="token operator">/</span><span class="token number">15</span>
<span class="token number">1563</span><span class="token operator">/</span><span class="token number">1563</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 56s 36ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.9279</span> <span class="token operator">-</span> accuracy<span class="token punctuation">:</span> <span class="token number">0.6723</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.8807</span> <span class="token operator">-</span> val_accuracy<span class="token punctuation">:</span> <span class="token number">0.6915</span>
Epoch <span class="token number">7</span><span class="token operator">/</span><span class="token number">15</span>
<span class="token number">1563</span><span class="token operator">/</span><span class="token number">1563</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 57s 36ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.8926</span> <span class="token operator">-</span> accuracy<span class="token punctuation">:</span> <span class="token number">0.6842</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.8701</span> <span class="token operator">-</span> val_accuracy<span class="token punctuation">:</span> <span class="token number">0.6974</span>
Epoch <span class="token number">8</span><span class="token operator">/</span><span class="token number">15</span>
<span class="token number">1563</span><span class="token operator">/</span><span class="token number">1563</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 57s 37ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.8517</span> <span class="token operator">-</span> accuracy<span class="token punctuation">:</span> <span class="token number">0.6993</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.8823</span> <span class="token operator">-</span> val_accuracy<span class="token punctuation">:</span> <span class="token number">0.6904</span>
Epoch <span class="token number">9</span><span class="token operator">/</span><span class="token number">15</span>
<span class="token number">1563</span><span class="token operator">/</span><span class="token number">1563</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 55s 35ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.8212</span> <span class="token operator">-</span> accuracy<span class="token punctuation">:</span> <span class="token number">0.7099</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.8147</span> <span class="token operator">-</span> val_accuracy<span class="token punctuation">:</span> <span class="token number">0.7160</span>
Epoch <span class="token number">10</span><span class="token operator">/</span><span class="token number">15</span>
<span class="token number">1563</span><span class="token operator">/</span><span class="token number">1563</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 53s 34ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.8004</span> <span class="token operator">-</span> accuracy<span class="token punctuation">:</span> <span class="token number">0.7171</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.7914</span> <span class="token operator">-</span> val_accuracy<span class="token punctuation">:</span> <span class="token number">0.7226</span>
Epoch <span class="token number">11</span><span class="token operator">/</span><span class="token number">15</span>
<span class="token number">1563</span><span class="token operator">/</span><span class="token number">1563</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 51s 33ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.7729</span> <span class="token operator">-</span> accuracy<span class="token punctuation">:</span> <span class="token number">0.7263</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.8080</span> <span class="token operator">-</span> val_accuracy<span class="token punctuation">:</span> <span class="token number">0.7227</span>
Epoch <span class="token number">12</span><span class="token operator">/</span><span class="token number">15</span>
<span class="token number">1563</span><span class="token operator">/</span><span class="token number">1563</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 51s 33ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.7541</span> <span class="token operator">-</span> accuracy<span class="token punctuation">:</span> <span class="token number">0.7346</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.8217</span> <span class="token operator">-</span> val_accuracy<span class="token punctuation">:</span> <span class="token number">0.7129</span>
Epoch <span class="token number">13</span><span class="token operator">/</span><span class="token number">15</span>
<span class="token number">1563</span><span class="token operator">/</span><span class="token number">1563</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 47s 30ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.7330</span> <span class="token operator">-</span> accuracy<span class="token punctuation">:</span> <span class="token number">0.7408</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.7825</span> <span class="token operator">-</span> val_accuracy<span class="token punctuation">:</span> <span class="token number">0.7264</span>
Epoch <span class="token number">14</span><span class="token operator">/</span><span class="token number">15</span>
<span class="token number">1563</span><span class="token operator">/</span><span class="token number">1563</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 47s 30ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.7204</span> <span class="token operator">-</span> accuracy<span class="token punctuation">:</span> <span class="token number">0.7458</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.7820</span> <span class="token operator">-</span> val_accuracy<span class="token punctuation">:</span> <span class="token number">0.7262</span>
Epoch <span class="token number">15</span><span class="token operator">/</span><span class="token number">15</span>
<span class="token number">1563</span><span class="token operator">/</span><span class="token number">1563</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 48s 31ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.6966</span> <span class="token operator">-</span> accuracy<span class="token punctuation">:</span> <span class="token number">0.7535</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.7707</span> <span class="token operator">-</span> val_accuracy<span class="token punctuation">:</span> <span class="token number">0.7329</span>
</code></pre> 
<p>模型评估的图形如下所示：<br> <img src="https://images2.imgbox.com/5b/64/8yA8XZFv_o.png" alt="在这里插入图片描述"></p> 
<p>可见测试集accuracy到达了72%以上，过拟合现象也得到极大改善。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0992e3a0db9ba907aa614d6f487845fb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">SOEX从去中心化的链上社交关系到创收策略</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/02d3c880fb818a2f33cbcd18661d6a9f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">DevOps学习笔记</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>