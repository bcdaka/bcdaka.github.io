<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Elasticsearch拼音分词器的安装、配置与测试实践 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/e243a5bf13997af3747f9de7b38e5753/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Elasticsearch拼音分词器的安装、配置与测试实践">
  <meta property="og:description" content="Elasticsearch的分词器对于文本分析至关重要。对于中文等语言，合适的分词器可以显著提高搜索相关性和结果的准确性。拼音分词器不仅支持基于拼音的搜索，还能实现拼音自动补全等功能。本文将介绍如何在Elasticsearch中安装拼音分词器，以及如何配置和测试它。
分词器的三要素 在Elasticsearch中，分词器（Analyzer）由以下三个主要部分组成：
Character Filters（字符过滤器）：在Tokenizer处理之前对文本进行预处理，如删除或替换特定字符。Tokenizer（分词器）：按照一定的规则将文本切分成词条（Term），例如ik_max_word就是智能切分中文。Token Filters（词条过滤器）：对Tokenizer输出的词条进行进一步处理，如转换为小写、同义词替换、拼音转换等。 安装拼音分词器插件 步骤1：下载插件 访问elasticsearch-analysis-pinyin GitHub页面，下载与您的Elasticsearch版本相匹配的插件。
步骤2：上传插件 将下载的插件压缩包上传到Elasticsearch的plugins目录。
步骤3：重启Elasticsearch ./elasticsearch-plugin install file:///path/to/elasticsearch-analysis-pinyin-7.x.x.zip 步骤4：测试插件 使用_analyze API测试拼音分词器：
POST /_analyze { &#34;text&#34;: &#34;如家酒店&#34;, &#34;analyzer&#34;: &#34;pinyin&#34; } 配置自定义分词器 自定义分词器可以在创建索引时通过settings配置。
简版配置示例 PUT /my_index { &#34;settings&#34;: { &#34;analysis&#34;: { &#34;analyzer&#34;: { &#34;my_pinyin_analyzer&#34;: { &#34;tokenizer&#34;: &#34;ik_max_word&#34;, &#34;filter&#34;: [&#34;pinyin&#34;] } } } } } 完整版配置示例 以下是完整版的配置示例：
PUT /my_index { &#34;settings&#34;: { &#34;analysis&#34;: { &#34;analyzer&#34;: { &#34;my_pinyin_analyzer&#34;: { &#34;tokenizer&#34;: &#34;ik_max_word&#34;, &#34;filter&#34;: [&#34;my_pinyin_filter&#34;] } }, &#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-14T00:04:35+08:00">
    <meta property="article:modified_time" content="2024-08-14T00:04:35+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Elasticsearch拼音分词器的安装、配置与测试实践</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>Elasticsearch的分词器对于文本分析至关重要。对于中文等语言，合适的分词器可以显著提高搜索相关性和结果的准确性。拼音分词器不仅支持基于拼音的搜索，还能实现拼音自动补全等功能。本文将介绍如何在Elasticsearch中安装拼音分词器，以及如何配置和测试它。</p> 
<h3><a id="_2"></a>分词器的三要素</h3> 
<p>在Elasticsearch中，分词器（Analyzer）由以下三个主要部分组成：</p> 
<ol><li><strong>Character Filters（字符过滤器）</strong>：在Tokenizer处理之前对文本进行预处理，如删除或替换特定字符。</li><li><strong>Tokenizer（分词器）</strong>：按照一定的规则将文本切分成词条（Term），例如ik_max_word就是智能切分中文。</li><li><strong>Token Filters（词条过滤器）</strong>：对Tokenizer输出的词条进行进一步处理，如转换为小写、同义词替换、拼音转换等。</li></ol> 
<h3><a id="_10"></a>安装拼音分词器插件</h3> 
<h4><a id="1_12"></a>步骤1：下载插件</h4> 
<p>访问<a href="https://github.com/medcl/elasticsearch-analysis-pinyin">elasticsearch-analysis-pinyin GitHub页面</a>，下载与您的Elasticsearch版本相匹配的插件。</p> 
<h4><a id="2_16"></a>步骤2：上传插件</h4> 
<p>将下载的插件压缩包上传到Elasticsearch的<code>plugins</code>目录。</p> 
<h4><a id="3Elasticsearch_20"></a>步骤3：重启Elasticsearch</h4> 
<pre><code class="prism language-shell">./elasticsearch-plugin <span class="token function">install</span> file:///path/to/elasticsearch-analysis-pinyin-7.x.x.zip
</code></pre> 
<h4><a id="4_26"></a>步骤4：测试插件</h4> 
<p>使用<code>_analyze</code> API测试拼音分词器：</p> 
<pre><code class="prism language-shell">POST /_analyze
<span class="token punctuation">{<!-- --></span>
  <span class="token string">"text"</span><span class="token builtin class-name">:</span> <span class="token string">"如家酒店"</span>,
  <span class="token string">"analyzer"</span><span class="token builtin class-name">:</span> <span class="token string">"pinyin"</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_38"></a>配置自定义分词器</h3> 
<p>自定义分词器可以在创建索引时通过settings配置。</p> 
<h4><a id="_42"></a>简版配置示例</h4> 
<pre><code class="prism language-json"><span class="token constant">PUT</span> <span class="token operator">/</span>my_index
<span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"settings"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"analysis"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">"analyzer"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string-property property">"my_pinyin_analyzer"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
          <span class="token string-property property">"tokenizer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>
          <span class="token string-property property">"filter"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"pinyin"</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="_60"></a>完整版配置示例</h4> 
<p>以下是完整版的配置示例：</p> 
<pre><code class="prism language-json"><span class="token constant">PUT</span> <span class="token operator">/</span>my_index
<span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"settings"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"analysis"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">"analyzer"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string-property property">"my_pinyin_analyzer"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
          <span class="token string-property property">"tokenizer"</span><span class="token operator">:</span> <span class="token string">"ik_max_word"</span><span class="token punctuation">,</span>
          <span class="token string-property property">"filter"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"my_pinyin_filter"</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string-property property">"filter"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string-property property">"my_pinyin_filter"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
          <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"pinyin"</span><span class="token punctuation">,</span>
          <span class="token string-property property">"keep_full_pinyin"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
          <span class="token string-property property">"keep_joined_full_pinyin"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token string-property property">"keep_original"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token string-property property">"limit_first_letter_length"</span><span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
          <span class="token string-property property">"remove_duplicated_term"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token string-property property">"none_chinese_pinyin_tokenize"</span><span class="token operator">:</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_91"></a>测试自定义分词器</h3> 
<p>使用自定义分词器进行测试：</p> 
<pre><code class="prism language-shell">POST /my_index/_analyze
<span class="token punctuation">{<!-- --></span>
  <span class="token string">"text"</span><span class="token builtin class-name">:</span> <span class="token string">"如家酒店"</span>,
  <span class="token string">"analyzer"</span><span class="token builtin class-name">:</span> <span class="token string">"my_pinyin_analyzer"</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_103"></a>结语</h3> 
<p>通过上述步骤，我们完成了拼音分词器的安装、配置和测试。拼音分词器的引入为Elasticsearch在中文文本处理方面提供了更多可能性，特别是在实现拼音搜索和自动补全等场景下非常有用。希望本文能够帮助开发者更好地利用Elasticsearch的分词器功能。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/52c401eb33a7841a231e37d499d2b5c6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">第七节 流编辑器sed(stream editor)(7.2)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/185f4d0d407084d0f509b0b62fc3a36f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Docker 容器化技术：现代化应用部署的利器</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>