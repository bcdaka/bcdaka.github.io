<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用Python做一个微信机器人 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/cafda5271965c96a493868777f413f5e/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="使用Python做一个微信机器人">
  <meta property="og:description" content="项目功能介绍
现在我们用小程序做一个模拟的应用，智能聊天机器人。发送文字它可以回复一段话，或一张图片，是不是有点小酷！
下面是小程序开发的一个智能聊天机器人的应用界面：
当然，这种智能回复的算法和数据库我们自己肯定是没有的，所以我们借助于gewe框架的开放API接口来完成我们的功能。
gewe框架接口：开发前必读 - GeWe开放平台
智能聊天机器人的开发步骤
1、整体框架
很简单，两个页面。两个tab，并修改window标题栏和tabBar的颜色等属性就好。这个全部在app.json中完成。
2、form表单的使用
表单，将组件内的用户输入的&lt;switch/&gt; &lt;input/&gt; &lt;checkbox/&gt; &lt;slider/&gt; &lt;radio/&gt; &lt;picker/&gt; 提交。
属性名 类型 说明 report-submit Boolean 是否返回formId用于发送模板消息 bindsubmit EventHandle 携带form中的数据触发submit事件，event.detail = {value : {‘name’: ‘value’} , formId: ”} bindreset EventHandle 表单重置时会触发reset事件 当点击 表单中 formType 为 submit 的 &lt;button/&gt; 组件时，会将表单组件中的 value 值进行提交，需要在表单组件中加上 name 来作为 key。 表单提交的要点：
在form内的表单组件必须有name属性。
在form内的button的 formType 属性为 submit 。
form的属性bindsubmit即为数据提交事件绑定的响应函数。
4、wx.request接口的使用
wx.request发起的是 HTTPS 请求。一个微信小程序，同时只能有5个网络请求连接。
在开发调试模式开发工具没有做安全检查，因此是可以请求http的。
wx.request({
url: &#39;test.php&#39;, //仅为示例，并非真实的接口地址
data: { x: &#39;&#39; , y: &#39;&#39; }, header: { &#39;content-type&#39;: &#39;application/json&#39; }, method: &#39;GET&#39;, success: function(res) { console.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-01T17:15:53+08:00">
    <meta property="article:modified_time" content="2024-08-01T17:15:53+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用Python做一个微信机器人</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>项目功能介绍</p> 
<p>现在我们用小程序做一个模拟的应用，智能聊天机器人。发送文字它可以回复一段话，或一张图片，是不是有点小酷！</p> 
<p>下面是小程序开发的一个智能聊天机器人的应用界面：</p> 
<p>当然，这种智能回复的算法和数据库我们自己肯定是没有的，所以我们借助于gewe框架的开放API接口来完成我们的功能。</p> 
<p>gewe框架接口：<a href="http://doc.geweapi.com/" rel="nofollow" title="开发前必读 - GeWe开放平台">开发前必读 - GeWe开放平台</a></p> 
<p>智能聊天机器人的开发步骤</p> 
<p>1、整体框架</p> 
<p>很简单，两个页面。两个tab，并修改window标题栏和tabBar的颜色等属性就好。这个全部在app.json中完成。</p> 
<p>2、form表单的使用</p> 
<p>表单，将组件内的用户输入的&lt;switch/&gt; &lt;input/&gt; &lt;checkbox/&gt; &lt;slider/&gt; &lt;radio/&gt; &lt;picker/&gt; 提交。</p> 
<pre><code class="hljs">属性名 类型 说明

report-submit Boolean 是否返回formId用于发送模板消息

bindsubmit EventHandle 携带form中的数据触发submit事件，event.detail = {value : {‘name’: ‘value’} , formId: ”}

bindreset EventHandle 表单重置时会触发reset事件

当点击 表单中 formType 为 submit 的 &lt;button/&gt; 组件时，会将表单组件中的 value 值进行提交，需要在表单组件中加上 name 来作为 key。</code></pre> 
<p>表单提交的要点：</p> 
<p>在form内的表单组件必须有name属性。</p> 
<p>在form内的button的 formType 属性为 submit 。</p> 
<p>form的属性bindsubmit即为数据提交事件绑定的响应函数。</p> 
<p>4、wx.request接口的使用</p> 
<p>wx.request发起的是 HTTPS 请求。一个微信小程序，同时只能有5个网络请求连接。</p> 
<p>在开发调试模式开发工具没有做安全检查，因此是可以请求http的。</p> 
<p>wx.request({<!-- --><br> url: 'test.php', //仅为示例，并非真实的接口地址</p> 
<pre><code class="hljs">data: {
x: '' ,

y: ''

},

header: {
'content-type': 'application/json'

},

method: 'GET',

success: function(res) {
console.log(res.data)

}

})</code></pre> 
<p>了解http的对这个接口参数应该不陌生，首先url为接口地址，data为请求的参数，header为请求的头，header中不能设置header 中不能设置 Referer。method为请求的方法，包括：OPTIONS, GET, HEAD, POST, PUT, DELETE, TRACE, CONNECT</p> 
<p>5、scroll-view组件的使用</p> 
<p>scroll-view为可滚动视图容器。这个主要用于聊天界面在有新的消息时需要自动滚动到最新聊天的位置。它的属性还是比较多的，参看文档：<a href="http://doc.geweapi.com/" rel="nofollow" title="开发前必读 - GeWe开放平台">开发前必读 - GeWe开放平台</a></p> 
<p>属性名 类型 默认值 说明</p> 
<p>scroll-x Boolean false</p> 
<p>scroll-y Boolean false 允许纵向滚动</p> 
<p>upper-threshold Number 50 距顶部/左边多远时（单位px），触发 scrolltoupper 事件</p> 
<p>lower-threshold Number 50 距底部/右边多远时（单位px），触发 scrolltolower 事件</p> 
<p>scroll-top Number 设置竖向滚动条位置</p> 
<p>scroll-left Number 设置横向滚动条位置</p> 
<p>scroll-into-view String 值应为某子元素id，则滚动到该元素，元素顶部对齐滚动区域顶部</p> 
<p>bindscrolltoupper EventHandle 滚动到顶部/左边，会触发 scrolltoupper 事件</p> 
<p>bindscrolltolower EventHandle 滚动到底部/右边，会触发 scrolltolower 事件</p> 
<p>bindscroll EventHandle 滚动时触发，event.detail = {scrollLeft, scrollTop, scrollHeight, scrollWidth, deltaX, deltaY}</p> 
<p>这里我们主要用到scroll-y（允许纵向滚动）和scroll-top（设置竖向滚动条位置）属性，以完成聊天内容的自动下翻。</p> 
<p>6、两个坑</p> 
<p>a、更新数据同时更新scrollTop，无法达到效果</p> 
<p>需要先更新数据，然后更新scrollTop</p> 
<p>要这样写才可以更新聊天页面内容并将滚动条置于正确的位置</p> 
<pre><code class="hljs">this.setData({content:newContent});

this.setData({scrollTop:newScrollTop});</code></pre> 
<p>而不能写为下面这样</p> 
<pre><code class="hljs">this.setData({
content:newContent,

scrollTop:newScrollTop

});</code></pre> 
<p>b、textarea的value属性绑定逻辑层的data数据段</p> 
<p>在逻辑层调用setData({text:”“})，textarea中数据并不会被清空。这个问题还没找出解决方案，等研究出方法再更新。</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/7a/fa/rybwDMza_o.png"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bb17ab004c9b202ce7137b398538a54c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">类和对象(下)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/19562f6a1fd33071cb380a81c5312d2f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">创新食堂管理：采购系统源码与供应链APP开发详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>