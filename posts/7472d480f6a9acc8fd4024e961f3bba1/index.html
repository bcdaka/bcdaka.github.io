<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python tqdm进度条详解 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/7472d480f6a9acc8fd4024e961f3bba1/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="python tqdm进度条详解">
  <meta property="og:description" content="文章目录 1. 语法1.1 tqdm 参数1.2 bar_format案例 2. 基本用法2.1 指定可迭代对象2.2 指定迭代次数2.3 设置显示信息2.3.1 设置进度条前缀(左侧)信息2.3.2 显示进度条后缀(右侧)信息 3. 项目案例参考 tqdm 是 Python 进度条库，可以在 Python 长循环中添加一个进度提示信息。用户只需要封装任意的迭代器，是一个快速、扩展性强的进度条工具库。
1. 语法 1.1 tqdm 参数 tqdm(iterable=None, desc=None, total=None, leave=True, file=None, ncols=None, mininterval=0.1, maxinterval=10.0, miniters=None, ascii=None, disable=False, unit=&#39;it&#39;, unit_scale=False, dynamic_ncols=False, smoothing=0.3, bar_format=None, initial=0, position=None, postfix=None, unit_divisor=1000, write_bytes=None, lock_args=None, nrows=None, colour=None, delay=0, gui=False, **kwargs): iterable: 接收一个可迭代对象。如果iterable为空的话，则手动通过update来更新迭代total: 总的迭代次数，用于计算进度百分比, 默认等于len(iterable)desc: 进度条的显示信息，显示在进度条前面(前缀)postfix: 字典形式信息，例如：loss=0.56, 显示在进度条的末尾(后缀)mininterval:设置进度条最小的更新间隔，单位秒，默认：0.1smaxinterval: 设置进度条最大更新间隔，单位秒，默认：10sbar_format: 设置进度条显示格式,默认为 {desc}: {percentage:3.0f}%|{bar}| {n_fmt}/{total_fmt}ncols: 设置进度条的宽度nrows: 设置进度条的高度unit: 设置进度条的单位,str类型，默认为it 这些参数为相对比较常用的参数，并且全部都是可选参数(optional)；在自定义进度条当中比较重要的的一个参数为：bar_format，用于定义进度条的具体格式，所包含的具体数据信息；">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-02-02T22:23:24+08:00">
    <meta property="article:modified_time" content="2024-02-02T22:23:24+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python tqdm进度条详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#1__5" rel="nofollow">1. 语法</a></li><li><ul><li><a href="#11_tqdm__6" rel="nofollow">1.1 tqdm 参数</a></li><li><a href="#12_bar_format_29" rel="nofollow">1.2 bar_format</a></li><li><ul><li><a href="#_53" rel="nofollow">案例</a></li></ul> 
   </li></ul> 
   </li><li><a href="#2__75" rel="nofollow">2. 基本用法</a></li><li><ul><li><a href="#21__76" rel="nofollow">2.1 指定可迭代对象</a></li><li><a href="#22__87" rel="nofollow">2.2 指定迭代次数</a></li><li><a href="#23___104" rel="nofollow">2.3 设置显示信息</a></li><li><ul><li><a href="#231__105" rel="nofollow">2.3.1 设置进度条前缀(左侧)信息</a></li><li><a href="#232__155" rel="nofollow">2.3.2 显示进度条后缀(右侧)信息</a></li></ul> 
   </li></ul> 
   </li><li><a href="#3__200" rel="nofollow">3. 项目案例</a></li><li><a href="#_231" rel="nofollow">参考</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<blockquote> 
 <p><code>tqdm </code>是 Python 进度条库，可以在 Python 长循环中添加一个<code>进度提示信息</code>。用户只需要封装任意的<code>迭代器</code>，是一个快速、扩展性强的进度条工具库。</p> 
</blockquote> 
<h3><a id="1__5"></a>1. 语法</h3> 
<h4><a id="11_tqdm__6"></a>1.1 tqdm 参数</h4> 
<pre><code class="prism language-py">tqdm<span class="token punctuation">(</span>iterable<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> desc<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> total<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> leave<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token builtin">file</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
     ncols<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> mininterval<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span> maxinterval<span class="token operator">=</span><span class="token number">10.0</span><span class="token punctuation">,</span> miniters<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
     <span class="token builtin">ascii</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> disable<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> unit<span class="token operator">=</span><span class="token string">'it'</span><span class="token punctuation">,</span> unit_scale<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
     dynamic_ncols<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> smoothing<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> bar_format<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> initial<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
     position<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> postfix<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> unit_divisor<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span> write_bytes<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
     lock_args<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> nrows<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> colour<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> delay<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> gui<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
     <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
</code></pre> 
<ul><li><code>iterable</code>: 接收一个可迭代对象。如果<code>iterable为空</code>的话，则手动通过<code>update</code>来更新迭代</li><li><code>total</code>: 总的迭代次数，用于计算进度百分比, 默认等于<code>len(iterable)</code></li><li><code>desc</code>: 进度条的显示信息，显示在进度条前面(前缀)</li><li><code>postfix</code>: 字典形式信息，例如：loss=0.56, 显示在进度条的末尾(后缀)</li><li><code>mininterval</code>:设置进度条<code>最小的更新间隔</code>，单位<code>秒</code>，默认：<code>0.1s</code></li><li><code>maxinterval</code>: 设置进度条<code>最大更新间隔</code>，单位<code>秒</code>，默认：<code>10s</code></li><li><code>bar_format</code>: 设置进度条显示格式,默认为<code> {desc}: {percentage:3.0f}%|{bar}| {n_fmt}/{total_fmt}</code></li><li><code>ncols</code>: 设置进度条的宽度</li><li><code>nrows</code>: 设置进度条的高度</li><li><code>unit</code>: 设置进度条的单位,str类型，默认为<code>it</code></li></ul> 
<p>这些参数为相对比较<code>常用</code>的参数，并且全部都是<code>可选参数</code>(optional)；在自定义进度条当中比较重要的的一个参数为：<code>bar_format</code>，用于定义进度条的具体格式，所包含的具体数据信息；</p> 
<h4><a id="12_bar_format_29"></a>1.2 bar_format</h4> 
<p>下面主要介绍这个参数的具体用法；</p> 
<ul><li><code>bar_format</code>默认格式为：<code> {l_bar}{bar}{r_bar}</code></li><li>进度条分为三部分： 中间的条形图(bar)，条形图左边信息(l_bar)、条形图右边信息(r_bar)</li><li><code> l_bar</code>：<code> {desc}: {percentage:3.0f}%|</code> , 即<code>前缀信息(desc)</code>+ <code>当前进度的百分比</code></li><li><code>bar: </code> 进度条</li><li><code>r_bar</code>: <code>|{n_fmt}/{total_fmt}[{elapsed}&lt;{remaining},{rate_fmt}{postfix}]</code></li></ul> 
<p>100%|█████████████████| 3/3 [00:03&lt;00:00, 1.00s/it]</p> 
<pre><code class="prism language-json"><span class="token literal-property property">percentage</span><span class="token operator">:</span>百分比
n_fmt：当前数
total_fmt：总数
elapsed：消耗的时间
remaining：剩余时间
rate_fmt：速率
postifx：后缀字典描述
<span class="token literal-property property">desc</span><span class="token operator">:</span> 前缀字符串描述
desc、postfix默认为空；
</code></pre> 
<pre><code class="prism language-py"><span class="token keyword">for</span> item <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span>data<span class="token punctuation">,</span> desc<span class="token operator">=</span><span class="token string">"Processing"</span><span class="token punctuation">,</span> bar_format<span class="token operator">=</span><span class="token string">"{l_bar}{bar}| {n_fmt}/{total_fmt} [{elapsed}&lt;{remaining}, {rate_fmt}{postfix}]"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 在这里添加你的代码</span>
</code></pre> 
<h5><a id="_53"></a>案例</h5> 
<p><code>yolov8 </code>代码中将tqdm中的<code>bar_format</code>进行了设置，没有使用原有的<code>bar_format</code>格式， 简化了显示内容。</p> 
<pre><code class="prism language-shell">TQDM_BAR_FORMAT <span class="token operator">=</span> <span class="token string">"{l_bar}{bar:10}{r_bar}"</span> <span class="token keyword">if</span> VERBOSE <span class="token keyword">else</span> None
</code></pre> 
<p>基于新的bar_format格式，重新封装了<code>tqdm</code>，代码如下</p> 
<pre><code class="prism language-py"><span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm <span class="token keyword">as</span> tqdm_original
<span class="token keyword">class</span> <span class="token class-name">TQDM</span><span class="token punctuation">(</span>tqdm_original<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Initialize custom Ultralytics tqdm class with different default arguments."""</span>
        <span class="token comment"># Set new default values (these can still be overridden when calling TQDM)</span>
        kwargs<span class="token punctuation">[</span><span class="token string">"disable"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">not</span> VERBOSE <span class="token keyword">or</span> kwargs<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"disable"</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">)</span>  <span class="token comment"># logical 'and' with default value if passed</span>
        kwargs<span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span><span class="token string">"bar_format"</span><span class="token punctuation">,</span> TQDM_BAR_FORMAT<span class="token punctuation">)</span>  <span class="token comment"># override default value if passed</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
</code></pre> 
<ul><li>可以看到，<code>TQDM</code>和原来的<code>tqdm</code> 基本是是一样的，只是自定义了<code>bar_format</code>的形式，使得显示更加简洁。</li><li>利用<code>TQDM</code>代替原有的<code>tqdm</code>, 使用方法是一样的</li></ul> 
<pre><code class="prism language-py">pbar <span class="token operator">=</span> TQDM<span class="token punctuation">(</span><span class="token builtin">enumerate</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>train_loader<span class="token punctuation">)</span><span class="token punctuation">,</span> total<span class="token operator">=</span>nb<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="2__75"></a>2. 基本用法</h3> 
<h4><a id="21__76"></a>2.1 指定可迭代对象</h4> 
<p>传入<code>迭代器对象(iterable)</code>, 默认迭代次数为:<code>len(iterable)</code>,：</p> 
<pre><code class="prism language-py"><span class="token keyword">import</span> time
<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">.01</span><span class="token punctuation">)</span>   <span class="token comment">#进度条每0.01s前进一次，总时间为1000*0.01=10s </span>

<span class="token comment"># 运行结果如下</span>
<span class="token number">100</span><span class="token operator">%</span><span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">1000</span><span class="token operator">/</span><span class="token number">1000</span> <span class="token punctuation">[</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token operator">&lt;</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">,</span> <span class="token number">93</span><span class="token punctuation">.</span>21it<span class="token operator">/</span>s<span class="token punctuation">]</span>  
</code></pre> 
<h4><a id="22__87"></a>2.2 指定迭代次数</h4> 
<p>如果没有传入可迭代对象，可以使用<code>total</code>指定迭代总数，并配合<code>update</code>手动更新进度条</p> 
<pre><code class="prism language-py"><span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm
<span class="token keyword">import</span> time

pbar <span class="token operator">=</span> tqdm<span class="token punctuation">(</span>total<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token comment"># 设置总长度</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">)</span>
    <span class="token comment"># 每次更新进度条的长度</span>
    pbar<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 相当于在当前长度的基础上 +1 的操作</span>

pbar<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>由于进度条总长200，现在累加到100就停止，因此最终会停在50%</li><li><code>pbar.update(1) </code>: update中传入更新的步长</li></ul> 
<h4><a id="23___104"></a>2.3 设置显示信息</h4> 
<h5><a id="231__105"></a>2.3.1 设置进度条前缀(左侧)信息</h5> 
<ul><li>(1) 利用<code>desc</code>参数，指定进度条<code>左侧</code>显示的信息</li></ul> 
<pre><code class="prism language-py">s <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'%20s'</span> <span class="token operator">+</span> <span class="token string">'%11s'</span> <span class="token operator">*</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token string">'Class'</span><span class="token punctuation">,</span> <span class="token string">'Images'</span><span class="token punctuation">,</span> <span class="token string">'Labels'</span><span class="token punctuation">,</span> <span class="token string">'P'</span><span class="token punctuation">,</span> <span class="token string">'R'</span><span class="token punctuation">,</span> <span class="token string">'mAP@.5'</span><span class="token punctuation">,</span> <span class="token string">'mAP@.5:.95'</span><span class="token punctuation">)</span>
pbar <span class="token operator">=</span> tqdm<span class="token punctuation">(</span>dataloader<span class="token punctuation">,</span> desc<span class="token operator">=</span>s<span class="token punctuation">,</span> bar_format<span class="token operator">=</span><span class="token string">'{l_bar}{bar:10}{r_bar}{bar:-10b}'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> batch_i<span class="token punctuation">,</span> <span class="token punctuation">(</span>im<span class="token punctuation">,</span> targets<span class="token punctuation">,</span> paths<span class="token punctuation">,</span> shapes<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>pbar<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">pass</span>
</code></pre> 
<p><code>等价于</code>:</p> 
<pre><code class="prism language-py">s <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'%20s'</span> <span class="token operator">+</span> <span class="token string">'%11s'</span> <span class="token operator">*</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token string">'Class'</span><span class="token punctuation">,</span> <span class="token string">'Images'</span><span class="token punctuation">,</span> <span class="token string">'Labels'</span><span class="token punctuation">,</span> <span class="token string">'P'</span><span class="token punctuation">,</span> <span class="token string">'R'</span><span class="token punctuation">,</span> <span class="token string">'mAP@.5'</span><span class="token punctuation">,</span> <span class="token string">'mAP@.5:.95'</span><span class="token punctuation">)</span>
pbar <span class="token operator">=</span> tqdm<span class="token punctuation">(</span>dataloader<span class="token punctuation">,</span> bar_format<span class="token operator">=</span><span class="token string">'{l_bar}{bar:10}{r_bar}{bar:-10b}'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> batch_i<span class="token punctuation">,</span> <span class="token punctuation">(</span>im<span class="token punctuation">,</span> targets<span class="token punctuation">,</span> paths<span class="token punctuation">,</span> shapes<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>pbar<span class="token punctuation">)</span><span class="token punctuation">:</span>
	pbar<span class="token punctuation">.</span>desc <span class="token operator">=</span> s
</code></pre> 
<ul><li>(2) 使用<code>set_description</code>, 指定进度条<code>左侧</code>(前缀)显示的信息</li></ul> 
<pre><code class="prism language-py"><span class="token keyword">import</span> time
<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm

pbar <span class="token operator">=</span> tqdm<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"a"</span><span class="token punctuation">,</span><span class="token string">"b"</span><span class="token punctuation">,</span><span class="token string">"c"</span><span class="token punctuation">,</span><span class="token string">"d"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> char <span class="token keyword">in</span> pbar<span class="token punctuation">:</span>
    pbar<span class="token punctuation">.</span>set_description<span class="token punctuation">(</span><span class="token string">"Processing %s"</span> <span class="token operator">%</span> char<span class="token punctuation">)</span> <span class="token comment"># 设置描述</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 每个任务分配1s</span>
    
<span class="token comment"># 结果如下</span>

Processing a<span class="token punctuation">:</span>   <span class="token number">0</span><span class="token operator">%</span><span class="token operator">|</span>          <span class="token operator">|</span> <span class="token number">0</span><span class="token operator">/</span><span class="token number">4</span> <span class="token punctuation">[</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token operator">&lt;</span>?<span class="token punctuation">,</span> ?it<span class="token operator">/</span>s<span class="token punctuation">]</span>
Processing b<span class="token punctuation">:</span>  <span class="token number">25</span><span class="token operator">%</span><span class="token operator">|</span>██▌       <span class="token operator">|</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">4</span> <span class="token punctuation">[</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">01</span><span class="token operator">&lt;</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">03</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">.</span>01s<span class="token operator">/</span>it<span class="token punctuation">]</span>
Processing c<span class="token punctuation">:</span>  <span class="token number">50</span><span class="token operator">%</span><span class="token operator">|</span>█████     <span class="token operator">|</span> <span class="token number">2</span><span class="token operator">/</span><span class="token number">4</span> <span class="token punctuation">[</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token operator">&lt;</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">.</span>01s<span class="token operator">/</span>it<span class="token punctuation">]</span>
Processing d<span class="token punctuation">:</span>  <span class="token number">75</span><span class="token operator">%</span><span class="token operator">|</span>███████▌  <span class="token operator">|</span> <span class="token number">3</span><span class="token operator">/</span><span class="token number">4</span> <span class="token punctuation">[</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">03</span><span class="token operator">&lt;</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">01</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">.</span>01s<span class="token operator">/</span>it<span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-py"><span class="token keyword">for</span> epoch <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>start_epoch<span class="token punctuation">,</span> self<span class="token punctuation">.</span>epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>
	pbar <span class="token operator">=</span> TQDM<span class="token punctuation">(</span><span class="token builtin">enumerate</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>train_loader<span class="token punctuation">)</span><span class="token punctuation">,</span> total<span class="token operator">=</span>nb<span class="token punctuation">)</span>
	<span class="token keyword">for</span> i<span class="token punctuation">,</span> batch <span class="token keyword">in</span> pbar<span class="token punctuation">:</span>
		self<span class="token punctuation">.</span>loss<span class="token punctuation">,</span> self<span class="token punctuation">.</span>loss_items <span class="token operator">=</span> self<span class="token punctuation">.</span>model<span class="token punctuation">(</span>batch<span class="token punctuation">)</span>
		
		<span class="token keyword">if</span> RANK <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
             pbar<span class="token punctuation">.</span>set_description<span class="token punctuation">(</span>
                  <span class="token punctuation">(</span><span class="token string">"%11s"</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token string">"%11.4g"</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">+</span> loss_len<span class="token punctuation">)</span><span class="token punctuation">)</span>
                  <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>epoch <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>self<span class="token punctuation">.</span>epochs<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> mem<span class="token punctuation">,</span> <span class="token operator">*</span>losses<span class="token punctuation">,</span> batch<span class="token punctuation">[</span><span class="token string">"cls"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> batch<span class="token punctuation">[</span><span class="token string">"img"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
              <span class="token punctuation">)</span>

pbar<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li><code>set_description</code>以及参数<code>desc</code>都可以设置进度条<code>左侧</code>(前缀)信息，</li><li>但<code>set_description</code>相比<code>desc</code>更加灵活，可以在每次<code>迭代</code>时，传入计算的结果。比如可以显示模型训练的<code>loss</code>, 图像的<code>shape</code>大小，以及当前的<code>epoch</code>等，用起来更加灵活。</li></ul> 
<h5><a id="232__155"></a>2.3.2 显示进度条后缀(右侧)信息</h5> 
<ul><li><strong>(1)</strong> 利用<code>postfix</code>参数，指定进度条<code>右侧</code>(后缀)显示的信息</li></ul> 
<pre><code class="prism language-py">pbar <span class="token operator">=</span> tqdm<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">,</span>total<span class="token operator">=</span>N<span class="token punctuation">,</span> desc<span class="token operator">=</span><span class="token string">"N"</span><span class="token punctuation">)</span>
start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> pbar<span class="token punctuation">:</span>
    pbar<span class="token punctuation">.</span>postfix<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>i<span class="token punctuation">}</span></span><span class="token string">"</span></span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"w .postfix: {:.2f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li><strong>(2)</strong> 使用<code>set_postfix</code>, 指定进度条<code>右侧</code>(后缀)显示的信息</li></ul> 
<pre><code class="prism language-py"><span class="token comment"># -*- coding: utf-8 -*-</span>
 
<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm
<span class="token keyword">from</span> collections <span class="token keyword">import</span> OrderedDict
 
total <span class="token operator">=</span> <span class="token number">10000</span> <span class="token comment">#总迭代次数</span>
loss <span class="token operator">=</span> total
<span class="token keyword">with</span> tqdm<span class="token punctuation">(</span>total<span class="token operator">=</span>total<span class="token punctuation">,</span> desc<span class="token operator">=</span><span class="token string">"进度条"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> pbar<span class="token punctuation">:</span>
    <span class="token keyword">for</span> i  <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>total<span class="token punctuation">)</span><span class="token punctuation">:</span>
        loss <span class="token operator">-=</span> <span class="token number">1</span> 
<span class="token comment">#        pbar.set_postfix(OrderedDict(loss='{0:1.5f}'.format(loss)))</span>
        pbar<span class="token punctuation">.</span>set_postfix<span class="token punctuation">(</span>val_loss<span class="token operator">=</span><span class="token number">1.63</span><span class="token punctuation">,</span>fscore<span class="token operator">=</span><span class="token number">0.88</span><span class="token punctuation">,</span>batch<span class="token operator">=</span>i<span class="token punctuation">)</span> <span class="token comment">#输入一个字典，显示实验指标</span>
        pbar<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
 
</code></pre> 
<ul><li><code>set_postfix</code>用于设置进度条右侧信息，可以将训练的结果，设置在进度条右侧显示。</li><li><code>set_postfix</code> 在指定信息时，需要使用<code>关键字参数</code>的信息，比如以<code>loss=5, bach=3</code>的形式，这样也可以容易的参数，某个<code>参数的值</code>。</li><li>当传入的是<code>字典dict</code>时，需要使用<code>**</code>解包dict对象的每个元素，然后传入到<code>set_postfix</code>中，如下所示</li></ul> 
<pre><code class="prism language-py">model_train<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> iteration<span class="token punctuation">,</span> batch <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>gen_val<span class="token punctuation">)</span><span class="token punctuation">:</span>
	imgs<span class="token punctuation">,</span> pngs<span class="token punctuation">,</span> labels <span class="token operator">=</span> batch
	outputs     <span class="token operator">=</span> model_train<span class="token punctuation">(</span>imgs<span class="token punctuation">)</span>
	loss <span class="token operator">=</span> CE_Loss<span class="token punctuation">(</span>outputs<span class="token punctuation">,</span> pngs<span class="token punctuation">,</span> weights<span class="token punctuation">,</span> num_classes <span class="token operator">=</span> num_classes<span class="token punctuation">)</span>
	f_score    <span class="token operator">=</span> f_score<span class="token punctuation">(</span>outputs<span class="token punctuation">,</span> labels<span class="token punctuation">)</span>
	pbar<span class="token punctuation">.</span>set_postfix<span class="token punctuation">(</span><span class="token operator">**</span><span class="token punctuation">{<!-- --></span><span class="token string">'loss'</span>  <span class="token punctuation">:</span> loss <span class="token operator">/</span> <span class="token punctuation">(</span>iteration <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                      <span class="token string">'f_score'</span>   <span class="token punctuation">:</span> f_score <span class="token operator">/</span> <span class="token punctuation">(</span>iteration <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                       <span class="token string">'lr'</span>        <span class="token punctuation">:</span> get_lr<span class="token punctuation">(</span>optimizer<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	pbar<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> 
<p>可以看到如果传入<code>字典dict</code>，需要<code>**</code>将dict解包为<code>关键字参数</code>，通过字典<code>dict</code>传参，在实际中应用的更加普遍。</p> 
<h3><a id="3__200"></a>3. 项目案例</h3> 
<pre><code class="prism language-py">Init_Epoch <span class="token operator">=</span><span class="token number">0</span> 
Total_Epoch <span class="token operator">=</span><span class="token number">300</span>

epoch_iters      <span class="token operator">=</span> num_train <span class="token operator">//</span> batch_size  <span class="token comment">#  iters of one epoch for train</span>
epoch_iters_val  <span class="token operator">=</span> num_val <span class="token operator">//</span> batch_size    <span class="token comment">#  #  iters of one epoch for val</span>
<span class="token keyword">for</span> epoch <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>Init_Epoch<span class="token punctuation">,</span> Total_Epoch<span class="token punctuation">)</span><span class="token punctuation">:</span>

	pbar <span class="token operator">=</span> tqdm<span class="token punctuation">(</span>total<span class="token operator">=</span>epoch_iters<span class="token punctuation">,</span>desc<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f'Epoch </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>epoch <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>Total_Epoch<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">,</span>postfix<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">,</span>mininterval<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span>
	
	<span class="token keyword">for</span> iteration<span class="token punctuation">,</span> batch <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>train_dataloader<span class="token punctuation">)</span><span class="token punctuation">:</span>
		imgs<span class="token punctuation">,</span> pngs<span class="token punctuation">,</span> labels <span class="token operator">=</span> batch
		outputs <span class="token operator">=</span> model_train<span class="token punctuation">(</span>imgs<span class="token punctuation">)</span>
		loss <span class="token operator">=</span> CE_Loss<span class="token punctuation">(</span>outputs<span class="token punctuation">,</span> pngs<span class="token punctuation">,</span> weights<span class="token punctuation">,</span> num_classes <span class="token operator">=</span> num_classes<span class="token punctuation">)</span>
		_f_score <span class="token operator">=</span> f_score<span class="token punctuation">(</span>outputs<span class="token punctuation">,</span> labels<span class="token punctuation">)</span>
		
		pbar<span class="token punctuation">.</span>set_postfix<span class="token punctuation">(</span><span class="token operator">**</span><span class="token punctuation">{<!-- --></span><span class="token string">'total_loss'</span><span class="token punctuation">:</span> total_loss <span class="token operator">/</span> <span class="token punctuation">(</span>iteration <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                                <span class="token string">'f_score'</span>   <span class="token punctuation">:</span> total_f_score <span class="token operator">/</span> <span class="token punctuation">(</span>iteration <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                <span class="token string">'lr'</span>        <span class="token punctuation">:</span> get_lr<span class="token punctuation">(</span>optimizer<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        pbar<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    
	pbar<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
	
</code></pre> 
<ul><li>在每个<code>epoch</code>中，利用<code>tqdm</code>定义进度条<code>pbar</code></li><li>在<code>tqdm</code>中通过<code>total</code>设置每个epoch的迭代次数</li><li>在每次迭代中，通过<code>pbar.set_postfix</code>设置<code>进度条右侧</code>显示信息，由于是通过<code>total</code>设置总迭代数而不是利用一个可迭代对象来控制迭代，因此需要利用<code>update</code>来更新迭代</li><li>进度条使用完毕后，记得关闭:<code>pbar.close()</code></li></ul> 
<h3><a id="_231"></a>参考</h3> 
<p><a href="https://github.com/bubbliiiing/deeplabv3-plus-pytorch">https://github.com/bubbliiiing/deeplabv3-plus-pytorch</a><br> <a href="https://www.cnblogs.com/softlin/p/13339766.html" rel="nofollow">https://www.cnblogs.com/softlin/p/13339766.html</a><br> <a href="https://github.com/ultralytics/ultralytics">https://github.com/ultralytics/ultralytics</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5a61733c33a75ef4cace68b37d0a856e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">选课|基于Springboot的大学生选课系统设计与实现(源码&#43;数据库&#43;文档)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7443ff6fadae5bcc452d5611d5573244/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C&#43;&#43; 引用（&amp;）的超详细解析（小白必看系列）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>