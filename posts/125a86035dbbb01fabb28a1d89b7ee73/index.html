<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>LEfSe分析：R语言一句代码轻松实现 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/125a86035dbbb01fabb28a1d89b7ee73/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="LEfSe分析：R语言一句代码轻松实现">
  <meta property="og:description" content="数据和代码获取：请查看主页个人信息！！！ 大家好，今天我将介绍如何使用R语言进行LEfSe（Linear discriminant analysis Effect Size）分析及可视化。LEfSe是一种基于线性判别分析的算法，可以帮助我们鉴别和发现在不同组间具有显著差异的微生物特征。
目前大部分童鞋们进行LEfSe分析时会使用一些在线网站或者本地安装的软件，分析过程比较头疼~~
偶然看到一个微生物生态学中优质R包【microeco】，可以轻松实现LEfSe，在此分享给大家！
microeco包是一个功能极其强大的微生物管道包，几乎可以做所有常见的微生物组下游分析，并且最最最重要的一点是，可视化图都是【ggplot2对象】，可以充分的满足大家的图片的个性化需求。
话不多说，我们直接开始：
Step1：载入数据
rm(list=ls()) pacman::p_load(tidyverse,microeco,magrittr) feature_table &lt;- read.csv(&#39;feature_table.csv&#39;, row.names = 1) sample_table &lt;- read.csv(&#39;sample_table.csv&#39;, row.names = 1) tax_table &lt;- read.csv(&#39;tax_table.csv&#39;, row.names = 1) head(feature_table)[,1:6]; head(sample_table); head(tax_table)[,1:6] 使用microeco包进行所有分析之前，我们需要构建一个【microtable对象】，这是所有后续分析的基础；这也是大多数功能强大的R包所具有的的共同特点，第一步数据对象搞定之后，后续的分析往往很简单！
Step2：构建microtable对象
上述代码将使用样本信息、物种特征表和分类信息的CSV文件，并创建了一个microtable对象，为LEfSe分析做好准备。
Step3：执行LEfSe分析
lefse &lt;- trans_diff$new(dataset = dataset, method = &#34;lefse&#34;, group = &#34;Group&#34;, alpha = 0.01, lefse_subgroup = NULL) Step4：绘制差异柱状图
# we show 20 taxa with the highest LDA (log10) lefse$plot_diff_bar(use_number = 1:30, width = 0.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-29T15:16:44+08:00">
    <meta property="article:modified_time" content="2024-05-29T15:16:44+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">LEfSe分析：R语言一句代码轻松实现</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>数据和代码获取：请查看主页个人信息！！！</h3> 
<h4><a name="t1"></a></h4> 
<p>大家好，今天我将介绍如何使用R语言进行LEfSe（Linear discriminant analysis Effect Size）分析及可视化。LEfSe是一种基于线性判别分析的算法，可以帮助我们鉴别和发现在不同组间具有显著差异的微生物特征。</p> 
<p></p> 
<p></p> 
<p class="img-center"><img alt="图片" height="463" src="https://images2.imgbox.com/53/9a/eNcU8r9g_o.png" width="1080"></p> 
<p></p> 
<p>目前大部分童鞋们进行LEfSe分析时会使用一些在线网站或者本地安装的软件，分析过程比较头疼~~</p> 
<p>偶然看到一个微生物生态学中优质R包【<strong>microeco</strong>】，可以轻松实现LEfSe，在此分享给大家！</p> 
<p>microeco包是一个功能极其强大的微生物管道包，几乎可以做所有常见的微生物组下游分析，并且最最最重要的一点是，可视化图都是【<strong>ggplot2对象</strong>】，可以充分的满足大家的图片的个性化需求。</p> 
<p>话不多说，我们直接开始：</p> 
<p></p> 
<p><strong>Step1：载入数据</strong></p> 
<pre><code>rm(list=ls())
pacman::p_load(tidyverse,microeco,magrittr)

feature_table &lt;- read.csv('feature_table.csv', row.names = 1)
sample_table &lt;- read.csv('sample_table.csv', row.names = 1)
tax_table &lt;- read.csv('tax_table.csv', row.names = 1)

head(feature_table)[,1:6]; head(sample_table); head(tax_table)[,1:6]</code></pre> 
<p></p> 
<p class="img-center"><img alt="图片" height="347" src="https://images2.imgbox.com/9d/2d/ssJflvsV_o.png" width="1080"></p> 
<p></p> 
<p>使用microeco包进行所有分析之前，我们需要构建一个<strong>【microtable对象】</strong>，这是所有后续分析的基础；这也是大多数功能强大的R包所具有的的共同特点，第一步数据对象搞定之后，后续的分析往往很简单！</p> 
<p><strong>Step2：构建microtable对象</strong></p> 
<p></p> 
<p class="img-center"><img alt="图片" height="98" src="https://images2.imgbox.com/20/5b/D7OfzJ14_o.png" width="401"></p> 
<p></p> 
<p>上述代码将使用样本信息、物种特征表和分类信息的CSV文件，并创建了一个microtable对象，为LEfSe分析做好准备。</p> 
<p></p> 
<p><strong>Step3：执行LEfSe分析</strong></p> 
<pre><code>lefse &lt;- trans_diff$new(dataset = dataset, 
                        method = "lefse", 
                        group = "Group", 
                        alpha = 0.01, 
                        lefse_subgroup = NULL)</code></pre> 
<p></p> 
<p class="img-center"><img alt="图片" height="235" src="https://images2.imgbox.com/2e/39/wo5glFmn_o.png" width="1080"></p> 
<p></p> 
<p><strong>Step4：绘制差异柱状图</strong></p> 
<pre><code># we show 20 taxa with the highest LDA (log10)
lefse$plot_diff_bar(use_number = 1:30, 
                    width = 0.8, 
                    group_order = c("CW", "IW", "TW"))</code></pre> 
<p></p> 
<p></p> 
<p class="img-center"><img alt="图片" height="523" src="https://images2.imgbox.com/a0/da/GjaFABBU_o.png" width="600"></p> 
<p></p> 
<p><strong>Step5：绘制分类树状图</strong></p> 
<pre><code># clade_label_level 5 represent phylum level in this analysis
# require ggtree package
lefse$plot_diff_cladogram(use_taxa_num = 200, 
                          use_feature_num = 50, 
                          clade_label_level = 5, 
                          group_order = c("CW", "IW", "TW"))</code></pre> 
<p></p> 
<p class="img-center"><img alt="图片" height="689" src="https://images2.imgbox.com/4c/01/ORtHR9Zq_o.png" width="1080"></p> 
<p>根据前一张图的展示结果，手动选择一些分类单元以减少重叠</p> 
<p></p> 
<p><strong>Step6：图片美化</strong></p> 
<pre><code># 图中可能存在与分类标签相关的问题。 当显示的级别过多时，分类标签可能会有太多重叠。 
# 但是，如果只标明门的标签，图例中带有标记字母的分类群太多了。 此时，可以手动选择分类群以显示如下操作。
# choose some taxa according to the positions in the previous picture; those taxa labels have minimum overlap
use_labels &lt;- c("c__Deltaproteobacteria", "c__Actinobacteria", "o__Rhizobiales", "p__Proteobacteria", "p__Bacteroidetes", 
                "o__Micrococcales", "p__Acidobacteria", "p__Verrucomicrobia", "p__Firmicutes", 
                "p__Chloroflexi", "c__Acidobacteria", "c__Gammaproteobacteria", "c__Betaproteobacteria", "c__KD4-96",
                "c__Bacilli", "o__Gemmatimonadales", "f__Gemmatimonadaceae", "o__Bacillales", "o__Rhodobacterales")
# then use parameter select_show_labels to show
lefse$plot_diff_cladogram(use_taxa_num = 200, 
                       use_feature_num = 50, 
                       select_show_labels = use_labels)</code></pre> 
<p></p> 
<p class="img-center"><img alt="图片" height="689" src="https://images2.imgbox.com/b4/ae/xliTKLbM_o.png" width="1080"></p> 
<p>如果您对LEfSe的更多功能和应用感兴趣，建议您查阅相关文献或官方文档（Tutorial for R microeco package (v0.17.0) (chiliubio.github.io)），深入了解其更多的应用细节和参数设置。</p> 
<p><strong>回复</strong><strong><strong>“LEfSe”</strong></strong><strong>获得本期代码和数据。</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7e5b8b6e306a31a49affb44c061f09e4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【C&#43;&#43;奇妙冒险】拷贝构造函数、运算符重载（赋值重载|const成员|取地址重载|const取地址重载）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7b1bfe4aef452257e4eedfc40bb7c087/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">GPT-4o：引领人工智能新时代的强大引擎</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>