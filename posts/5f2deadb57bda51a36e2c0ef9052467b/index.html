<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>探索WebKit的WebUSB API：开启浏览器与硬件的无缝对话 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/5f2deadb57bda51a36e2c0ef9052467b/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="探索WebKit的WebUSB API：开启浏览器与硬件的无缝对话">
  <meta property="og:description" content="探索WebKit的WebUSB API：开启浏览器与硬件的无缝对话 在当今技术日益融合的时代，浏览器已成为连接用户与各种硬件设备的重要桥梁。WebKit的WebUSB API为Web开发者提供了一种新的方式，允许网页直接与USB设备进行通信，无需安装任何插件或扩展。这一功能极大地扩展了Web应用的潜力，从简单的数据传输到复杂的硬件控制，都可以通过浏览器实现。本文将详细介绍WebKit的WebUSB API，并提供实际的代码示例。
一、WebUSB API简介 WebUSB API是一种允许Web页面与USB设备进行通信的Web标准，它提供了一种简单、安全的方法来访问连接到用户计算机的USB设备。通过WebUSB，开发者可以创建能够与各种硬件设备交互的Web应用。
二、WebKit对WebUSB API的支持 截至2024年，WebKit已经在其浏览器中对WebUSB API提供了实验性支持。这意味着在基于WebKit的浏览器（如Safari）中，开发者可以开始尝试使用这项技术。然而，由于这是一项相对较新的技术，可能还需要一些时间才能在所有浏览器中得到广泛支持。
三、基本语法和流程 使用WebUSB API的基本流程如下：
检查浏览器支持：首先需要检查浏览器是否支持WebUSB API。
if (&#39;navigator&#39; in window &amp;&amp; &#39;usb&#39; in navigator) { console.log(&#39;WebUSB is supported!&#39;); } else { console.log(&#39;WebUSB is not supported in this browser.&#39;); } 请求设备：通过navigator.usb.requestDevice方法请求访问用户设备。
async function requestDevice() { try { const device = await navigator.usb.requestDevice({ filters: [{ vendorId: 0x1234, productId: 0x5678 }] }); console.log(&#39;Device connected:&#39;, device); return device; } catch (error) { console.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-24T20:40:27+08:00">
    <meta property="article:modified_time" content="2024-07-24T20:40:27+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">探索WebKit的WebUSB API：开启浏览器与硬件的无缝对话</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="WebKitWebUSB_API_0"></a><strong>探索WebKit的WebUSB API：开启浏览器与硬件的无缝对话</strong></h4> 
<p>在当今技术日益融合的时代，浏览器已成为连接用户与各种硬件设备的重要桥梁。WebKit的WebUSB API为Web开发者提供了一种新的方式，允许网页直接与USB设备进行通信，无需安装任何插件或扩展。这一功能极大地扩展了Web应用的潜力，从简单的数据传输到复杂的硬件控制，都可以通过浏览器实现。本文将详细介绍WebKit的WebUSB API，并提供实际的代码示例。</p> 
<h5><a id="WebUSB_API_4"></a><strong>一、WebUSB API简介</strong></h5> 
<p>WebUSB API是一种允许Web页面与USB设备进行通信的Web标准，它提供了一种简单、安全的方法来访问连接到用户计算机的USB设备。通过WebUSB，开发者可以创建能够与各种硬件设备交互的Web应用。</p> 
<h5><a id="WebKitWebUSB_API_8"></a><strong>二、WebKit对WebUSB API的支持</strong></h5> 
<p>截至2024年，WebKit已经在其浏览器中对WebUSB API提供了实验性支持。这意味着在基于WebKit的浏览器（如Safari）中，开发者可以开始尝试使用这项技术。然而，由于这是一项相对较新的技术，可能还需要一些时间才能在所有浏览器中得到广泛支持。</p> 
<h5><a id="_12"></a><strong>三、基本语法和流程</strong></h5> 
<p>使用WebUSB API的基本流程如下：</p> 
<ol><li> <p><strong>检查浏览器支持</strong>：首先需要检查浏览器是否支持WebUSB API。</p> <pre><code class="prism language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'navigator'</span> <span class="token keyword">in</span> window <span class="token operator">&amp;&amp;</span> <span class="token string">'usb'</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'WebUSB is supported!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'WebUSB is not supported in this browser.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> </li><li> <p><strong>请求设备</strong>：通过<code>navigator.usb.requestDevice</code>方法请求访问用户设备。</p> <pre><code class="prism language-javascript"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">requestDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> device <span class="token operator">=</span> <span class="token keyword">await</span> navigator<span class="token punctuation">.</span>usb<span class="token punctuation">.</span><span class="token function">requestDevice</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">filters</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">vendorId</span><span class="token operator">:</span> <span class="token number">0x1234</span><span class="token punctuation">,</span> <span class="token literal-property property">productId</span><span class="token operator">:</span> <span class="token number">0x5678</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Device connected:'</span><span class="token punctuation">,</span> device<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> device<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error requesting device:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> </li><li> <p><strong>打开设备</strong>：在获得用户授权的设备后，打开设备并与之交互。</p> <pre><code class="prism language-javascript"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">openDevice</span><span class="token punctuation">(</span><span class="token parameter">device</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> configuration <span class="token operator">=</span> <span class="token keyword">await</span> device<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Device opened:'</span><span class="token punctuation">,</span> configuration<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error opening device:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> </li><li> <p><strong>传输数据</strong>：使用打开的设备进行数据传输。</p> <pre><code class="prism language-javascript"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">transferData</span><span class="token punctuation">(</span><span class="token parameter">device</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> controlTransfer <span class="token operator">=</span> device<span class="token punctuation">.</span><span class="token function">controlTransferOut</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">requestType</span><span class="token operator">:</span> <span class="token string">'vendor'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">recipient</span><span class="token operator">:</span> device<span class="token punctuation">.</span><span class="token constant">CONTROL_RECIPIENT</span><span class="token punctuation">,</span>
            <span class="token literal-property property">request</span><span class="token operator">:</span> <span class="token number">0x01</span><span class="token punctuation">,</span>
            <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">0x02</span><span class="token punctuation">,</span>
            <span class="token literal-property property">index</span><span class="token operator">:</span> <span class="token number">0x03</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">await</span> controlTransfer<span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Data transferred successfully'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error transferring data:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> </li></ol> 
<h5><a id="WebUSB_API_75"></a><strong>四、WebUSB API的应用场景</strong></h5> 
<p>WebUSB API的应用场景非常广泛，包括但不限于：</p> 
<ul><li><strong>数据传输</strong>：在网页和USB存储设备之间传输文件。</li><li><strong>硬件控制</strong>：控制连接到计算机的外部设备，如Arduino板。</li><li><strong>设备监测</strong>：监测USB设备的连接和断开事件。</li></ul> 
<h5><a id="_83"></a><strong>五、浏览器兼容性和安全性</strong></h5> 
<p>由于WebUSB API是一项相对较新的技术，浏览器的兼容性仍在不断发展中。在使用WebUSB API时，开发者应注意以下几点：</p> 
<ul><li><strong>用户授权</strong>：WebUSB要求用户明确授权网页访问特定的USB设备。</li><li><strong>安全性</strong>：合理使用WebUSB API，避免潜在的安全风险，如恶意访问用户的硬件设备。</li></ul> 
<h5><a id="_90"></a><strong>六、实际应用示例</strong></h5> 
<p>假设您正在开发一个网页，用于与连接的Arduino板进行通信：</p> 
<pre><code class="prism language-javascript">document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'connect'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> device <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">requestDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>device<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">await</span> <span class="token function">openDevice</span><span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">await</span> <span class="token function">transferData</span><span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_104"></a><strong>七、总结</strong></h5> 
<p>WebKit的WebUSB API为开发者提供了一种新的与USB设备通信的方式。通过本文的介绍，读者应该已经了解了WebUSB API的基本概念、基本语法、使用流程、应用场景以及浏览器兼容性和安全性。</p> 
<p>随着Web技术的发展，WebUSB API将继续在硬件交互领域发挥重要作用。通过本文的指导，读者可以开始在自己的项目中尝试使用WebUSB API，享受更丰富的硬件交互体验。</p> 
<p>通过本文的指导，您可以开始在您的Web应用中使用WebUSB API，探索浏览器与硬件设备之间更深层次的集成。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dbf36a0a40826f014438e0ebd26ef2a0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【数据结构】二叉树———Lesson2</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/559ad27d4eee10720a90482a21905831/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">WebKit的图像魔法：深入CSS Image Values支持</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>