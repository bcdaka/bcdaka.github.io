<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【项目实践】贪吃蛇 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/8abd0708939febfb4ed4d478c54d02e8/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【项目实践】贪吃蛇">
  <meta property="og:description" content="一、游戏效果展示二、博客目标三、使用到的知识四、Win32 API 介绍 4.1 WIn32 API4.2 控制台程序4.3 控制屏幕上的坐标COORD4.4 GetStdHandle4.5 GetConsoleCursorInfo 4.5.1 CONSOLE_CURSOR_INFO 4.6 SetConsoleCursorInfo4.7 SetConsoleCursorPosition4.8 GetAsyncKeyState 五、贪吃蛇游戏设计与分析 5.1 地图 5.1.1 &lt;locale.h&gt;本地化5.1.2 类项5.1.3 setlocale函数5.1.4 宽字符打印5.1.5 地图坐标 5.2 蛇身与食物5.3 数据结构设计5.4 游戏流程设计 六、核心逻辑实现分析 6.1 游戏主逻辑6.2 游戏开始 6.2.1 打印欢迎界面6.2.2 创建地图6.2.3 创建蛇身6.2.4 创建第一个食物 6.3 游戏运行 6.3.1 KEY_PRESS6.3.2 打印右侧的帮助信息6.3.3 蛇身的移动 6.4游戏结束 七、参考代码八、控制台设置 一、游戏效果展示 贪吃蛇效果展示
二、博客目标 使用C语言在Windows环境的控制台中模拟实现经典小游戏贪吃蛇。
实现基本的功能：
贪吃蛇地图绘制蛇吃食物的功能（上、下、左、右方向键控制蛇的动作）蛇撞墙死亡蛇撞自身死亡计算得分蛇身加速、减速暂停游戏 三、使用到的知识 C语言函数、枚举、结构体、动态内存管理、预处理指令、链表、Win32 API等。
四、Win32 API介绍 本次实现贪吃蛇会使用到的⼀些Win32 API知识，接下来我们就学习⼀下。
4.1Win32 API Windows 这个多作业系统除了协调应用程序的执行、分配内存、管理资源之外，它同时也是⼀个很大的服务中心，调用这个服务中心的各种服务（每⼀种服务就是⼀个函数），可以帮应用程序达到开启视窗、描绘图形、使用周边设备等目的，由于这些函数服务的对象是应用程序(Application)，所以便称之为Application Programming Interface，简称 API 函数。WIN32 API 也就是Microsoft Windows 32位平台的应用程序编程接口。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-04T14:25:19+08:00">
    <meta property="article:modified_time" content="2024-07-04T14:25:19+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【项目实践】贪吃蛇</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <ul><li>一、游戏效果展示</li><li>二、博客目标</li><li>三、使用到的知识</li><li>四、Win32 API 介绍 
  <ul><li>4.1 WIn32 API</li><li>4.2 控制台程序</li><li>4.3 控制屏幕上的坐标COORD</li><li>4.4 GetStdHandle</li><li>4.5 GetConsoleCursorInfo 
    <ul><li>4.5.1 CONSOLE_CURSOR_INFO</li></ul> </li><li>4.6 SetConsoleCursorInfo</li><li>4.7 SetConsoleCursorPosition</li><li>4.8 GetAsyncKeyState</li></ul> </li><li>五、贪吃蛇游戏设计与分析 
  <ul><li>5.1 地图 
    <ul><li>5.1.1 &lt;locale.h&gt;本地化</li><li>5.1.2 类项</li><li>5.1.3 setlocale函数</li><li>5.1.4 宽字符打印</li><li>5.1.5 地图坐标</li></ul> </li><li>5.2 蛇身与食物</li><li>5.3 数据结构设计</li><li>5.4 游戏流程设计</li></ul> </li><li>六、核心逻辑实现分析 
  <ul><li>6.1 游戏主逻辑</li><li>6.2 游戏开始 
    <ul><li>6.2.1 打印欢迎界面</li><li>6.2.2 创建地图</li><li>6.2.3 创建蛇身</li><li>6.2.4 创建第一个食物</li></ul> </li><li>6.3 游戏运行 
    <ul><li>6.3.1 KEY_PRESS</li><li>6.3.2 打印右侧的帮助信息</li><li>6.3.3 蛇身的移动</li></ul> </li><li>6.4游戏结束</li></ul> </li><li>七、参考代码</li><li>八、控制台设置</li></ul> 
<h2><a id="_41"></a>一、游戏效果展示</h2> 
<p></p> 
<div class="csdn-video-box"> 
 <iframe id="wo4mZuGd-1720074310495" frameborder="0" src="https://live.csdn.net/v/embed/406306" allowfullscreen="true" data-mediaembed="csdn"></iframe> 
 <p>贪吃蛇效果展示</p> 
</div> 
<p></p> 
<p><img src="https://images2.imgbox.com/88/d1/fKWL0kOm_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f8/b1/Bim8bv8l_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c9/d7/pcIPRQKx_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/6d/00/TDzSH2j1_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_51"></a>二、博客目标</h2> 
<p>使用C语言在Windows环境的控制台中模拟实现经典小游戏贪吃蛇。</p> 
<blockquote> 
 <p>实现基本的功能：</p> 
 <ul><li>贪吃蛇地图绘制</li><li>蛇吃食物的功能（上、下、左、右方向键控制蛇的动作）</li><li>蛇撞墙死亡</li><li>蛇撞自身死亡</li><li>计算得分</li><li>蛇身加速、减速</li><li>暂停游戏</li></ul> 
</blockquote> 
<h2><a id="_62"></a>三、使用到的知识</h2> 
<p>C语言函数、枚举、结构体、动态内存管理、预处理指令、链表、<strong>Win32 AP</strong>I等。</p> 
<h2><a id="Win32_API_64"></a>四、Win32 API介绍</h2> 
<p>本次实现贪吃蛇会使用到的⼀些Win32 API知识，接下来我们就学习⼀下。</p> 
<h3><a id="41Win32_API_66"></a>4.1Win32 API</h3> 
<p>Windows 这个多作业系统除了协调应用程序的执行、分配内存、管理资源之外，它同时也是⼀个很大的服务中心，调用这个服务中心的各种服务（每⼀种服务就是⼀个函数），可以帮应用程序达到开启视窗、描绘图形、使用周边设备等目的，由于这些函数服务的对象是应用程序(Application)，所以便称之为Application Programming Interface，<strong>简称 API 函数</strong>。<strong>WIN32 API</strong> 也就是Microsoft Windows 32位平台的应用程序编程接口。</p> 
<h3><a id="42__68"></a>4.2 控制台程序</h3> 
<p>平常我们运行起来的黑框程序其实就是控制台程序。能在控制台窗口执行的命令，也可以<strong>调用C语言函数system来执行</strong>。</p> 
<h3><a id="43_COORDhttpslearnmicrosoftcomzhcnwindowsconsolecoordstr_70"></a>4.3 控制台屏幕上的坐标<a href="https://learn.microsoft.com/zh-cn/windows/console/coord-str" rel="nofollow">COORD</a></h3> 
<p>COORD 是Windows API中定义的⼀个结构体，表示⼀个字符在控制台屏幕幕缓冲区上的坐标，坐标系(0，0)的原点位于缓冲区的顶部左侧单元格。<br> <img src="https://images2.imgbox.com/16/a9/AYT6FCaC_o.png" alt="在这里插入图片描述"><br> COORD类型的声明：</p> 
<pre><code class="prism language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_COORD</span> 
<span class="token punctuation">{<!-- --></span>
	 SHORT X<span class="token punctuation">;</span>
	 SHORT Y<span class="token punctuation">;</span>
<span class="token punctuation">}</span> COORD<span class="token punctuation">,</span> <span class="token operator">*</span>PCOORD<span class="token punctuation">;</span>
</code></pre> 
<h3><a id="44_GetStdHandlehttpslearnmicrosoftcomzhcnwindowsconsolegetstdhandle_81"></a>4.4 <a href="https://learn.microsoft.com/zh-cn/windows/console/getstdhandle" rel="nofollow">GetStdHandle</a></h3> 
<p>GetStdHandle是⼀个Windows API函数。它用于从⼀个特定的标准设备（标准输⼊、标准输出或标准错误）中取得⼀个句柄（用来标识不同设备的数值），使用这个句柄可以操作设备。</p> 
<pre><code class="prism language-c">HANDLE <span class="token function">GetStdHandle</span><span class="token punctuation">(</span>DWORD nStdHandle<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="45_GetConsoleCursorInfohttpslearnmicrosoftcomzhcnwindowsconsolegetconsolecursorinfo_86"></a>4.5<a href="https://learn.microsoft.com/zh-cn/windows/console/getconsolecursorinfo" rel="nofollow"> GetConsoleCursorInfo</a></h3> 
<p>检索有关指定控制台屏幕缓冲区的光标大小和可见性的信息。</p> 
<pre><code class="prism language-c">BOOL WINAPI <span class="token function">GetConsoleCursorInfo</span><span class="token punctuation">(</span> HANDLE hConsoleOutput<span class="token punctuation">,</span>PCONSOLE_CURSOR_INFO lpConsoleCursorInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//PCONSOLE_CURSOR_INFO 是指向 CONSOLE_CURSOR_INFO 结构的指针，该结构接收有关主机游标.</span>
</code></pre> 
<h4><a id="451_CONSOLE_CURSOR_INFO_92"></a>4.5.1 CONSOLE_CURSOR_INFO</h4> 
<p>这个结构体，包含有关控制台光标的信息</p> 
<pre><code class="prism language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_CONSOLE_CURSOR_INFO</span> 
<span class="token punctuation">{<!-- --></span>
	 DWORD dwSize<span class="token punctuation">;</span>
	 BOOL bVisible<span class="token punctuation">;</span>
<span class="token punctuation">}</span> CONSOLE_CURSOR_INFO<span class="token punctuation">,</span> <span class="token operator">*</span>PCONSOLE_CURSOR_INFO<span class="token punctuation">;</span>
</code></pre> 
<ul><li>dwSize，由光标填充的字符单元格的百分比。此值介于1到100之间。光标外观会变化，范围从完全填充单元格到单元底部的水平线条。</li><li>bVisible，游标的可见性。如果光标可见，则此成员为 TRUE。</li></ul> 
<pre><code class="prism language-c">CursorInfo<span class="token punctuation">.</span>bVisible <span class="token operator">=</span> false<span class="token punctuation">;</span> <span class="token comment">//隐藏控制台光标 </span>
</code></pre> 
<h3><a id="46SetConsoleCursorInfohttpslearnmicrosoftcomzhcnwindowsconsolesetconsolecursorinfo_106"></a>4.6<a href="https://learn.microsoft.com/zh-cn/windows/console/setconsolecursorinfo" rel="nofollow">SetConsoleCursorInfo</a></h3> 
<p>设置指定控制台屏幕缓冲区的光标的大小和可见性。</p> 
<pre><code class="prism language-c">BOOL WINAPI <span class="token function">SetConsoleCursorInfo</span><span class="token punctuation">(</span>HANDLE hConsoleOutput<span class="token punctuation">,</span><span class="token keyword">const</span> CONSOLE_CURSOR_INFO <span class="token operator">*</span>lpConsoleCursorInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="47__SetConsoleCursorPosition_httpslearnmicrosoftcomzhcnwindowsconsolesetconsolecursorposition_111"></a>4.7 <a href="https://learn.microsoft.com/zh-cn/windows/console/setconsolecursorposition" rel="nofollow">SetConsoleCursorPosition </a></h3> 
<p>设置指定控制台屏幕缓冲区中的光标位置，我们将想要设置的坐标信息放在COORD类型的pos中，调用SetConsoleCursorPosition函数将光标位置设置到指定的位置。</p> 
<pre><code class="prism language-c">BOOL WINAPI <span class="token function">SetConsoleCursorPosition</span><span class="token punctuation">(</span>HANDLE hConsoleOutput<span class="token punctuation">,</span>COORD pos<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="48_GetAsyncKeyStatehttpslearnmicrosoftcomzhcnwindowswin32apiwinusernfwinusergetasynckeystate_116"></a>4.8 <a href="https://learn.microsoft.com/zh-cn/windows/win32/api/winuser/nf-winuser-getasynckeystate" rel="nofollow">GetAsyncKeyState</a></h3> 
<p>获取按键情况，GetAsyncKeyState的函数原型如下：</p> 
<pre><code class="prism language-c">SHORT <span class="token function">GetAsyncKeyState</span><span class="token punctuation">(</span><span class="token keyword">int</span> vKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>将键盘上每个键的虚拟键值传递给函数，函数通过返回值来分辨按键的状态。<br> GetAsyncKeyState 的返回值是short类型，在上⼀次调用 GetAsyncKeyState 函数后，如果返回的16位的short数据中，最高位是1，说明按键的状态是按下，如果最高是0，说明按键的状态是抬起；如果最低位被置为1则说明，该按键被按过，否则为0。如果我们要判断⼀个键是否被按过，可以检测GetAsyncKeyState返回值的最低值是否为1。<br> <a href="https://learn.microsoft.com/zh-cn/windows/win32/inputdev/virtual-key-codes" rel="nofollow">虚拟键码</a></p> 
<h2><a id="_124"></a>五、贪吃蛇游戏设计与分析</h2> 
<h3><a id="51__125"></a>5.1 地图</h3> 
<p>这里不得不讲⼀下控制台窗口的⼀些知识，如果想在控制台的窗口中指定位置输出信息，我们得知道该位置的坐标，所以首先介绍⼀下控制台窗口的坐标知识。<br> <strong>控制台窗口的坐标，横向的是X轴，从左向右依次增长，纵向是Y轴，从上到下依次增长。</strong><br> 在游戏地图上，我们打印墙体使用宽字符 □ ，打印蛇使用宽字符 ● ，打印食物使用宽字符 ★</p> 
<p>普通的字符是占⼀个字节的，这类宽字符是占用2个字节。</p> 
<blockquote> 
 <p>这里再简单的讲⼀下C语言的国际化特性相关的知识，过去C语言并不适合非英语国家（地区）使用。<br> C语言最初假定字符都是单字节的。但是这些假定并不是在世界的任何地方都适用。<br> C语言字符默认是采用ASCII编码的，ASCII字符集采用的是单字节编码，且只使用了单字节中的低7位，最高位是没有使用的，可表示为0xxxxxxxx；可以看到，ASCII字符集共包含128个字符，在英语国家中，128个字符是基本够用的，但是，在其他国家语言中，比如，在法语中，字母上方有注音符号，它就无法用 ASCII 码表示。于是，⼀些欧洲国家就决定，利用字节中闲置的最高位编入新的符号。比如，法语中的 é 的编码为130（⼆进制10000010）。这样⼀来，这些欧洲国家使用的编码体系，可以表示最多256个符号。但是，这里又出现了新的问题。不同的国家有不同的字母，因此，哪怕它们都使用256个符号的编码方式，代表的字母却不⼀样。比如，130在法语编码中代表了 é ，在俄语编码中又会代表另⼀个符号。但是不管怎样，所有这些编码方式中，0–127表示的符号是⼀样的，不⼀样的只是128–255的这⼀段。<br> 至于亚洲国家的文字，使用的符号就更多了，汉字就多达10万左右。⼀个字节只能表示256种符号，肯定是不够的，就必须使用多个字节表达⼀个符号。比如，简体中文常见的编码方式是GB2312，使用两个字节表示⼀个汉字，所以理论上最多可以表示256 x 256 = 65536 个符号。<br> 后来为了使C语言适应国际化，C语言的标准中不断加入了国际化的至支持。比如：加入了宽字符的类型<code>wchar_t</code> 和宽字符的输⼊和输出函数，加⼊了<code>&lt;locale.h&gt;</code>头文件，其中提供了允许程序员针对特定地区（通常是国家或者说某种特定语言的地理区域）调整程序行为的函数。</p> 
</blockquote> 
<h3><a id="511_localeh_136"></a>5.1.1 &lt;locale.h&gt;本地化</h3> 
<p>&lt;locale.h&gt;提供的函数用于控制C标准库中对于不同的地区会产生不⼀样行为的部分。<br> 在标准中，依赖地区的部分有以下几项：</p> 
<ul><li>数字量的格式</li><li>货币量的格式</li><li>字符集</li><li>日期和时间的表示形式</li></ul> 
<h3><a id="512__143"></a>5.1.2 类项</h3> 
<p>通过修改地区，程序可以改变它的行为来适应世界的不同区域。但地区的改变可能会影响库的许多部分，其中⼀部分可能是我们不希望修改的。所以C语言支持针对不同的类项进行修改，下面的⼀个宏，<br> 指定⼀个类项：</p> 
<ul><li>LC_COLLATE：影响字符串比较函数 strcoll() 和 strxfrm() 。</li><li>LC_CTYPE：影响字符处理函数的行为。</li><li>LC_MONETARY：影响货币格式。</li><li>LC_NUMERIC：影响 printf() 的数字格式。</li><li>LC_TIME：影响时间格式 strftime() 和 wcsftime() 。</li><li>LC_ALL：针对所有类项修改，将以上所有类别设置为给定的语言环境。</li></ul> 
<h3><a id="513_setlocale_152"></a>5.1.3 setlocale函数</h3> 
<pre><code class="prism language-c"><span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">setlocale</span> <span class="token punctuation">(</span><span class="token keyword">int</span> category<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> locale<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>setlocale 函数用于修改当前地区，可以针对⼀个类项修改，也可以针对所有类项。<br> setlocale 的第⼀个参数可以是前面说明的类项中的⼀个，那么每次只会影响⼀个类项，如果第⼀个参数是LC_ALL，就会影响所有的类项。<br> C标准给第二个参数仅定义了2种可能取值：<strong>“C”（正常模式）和" "（本地模式）</strong>。<br> 当程序运行起来后想改变地区，就只能显示调用 setlocale 函数。用" "作为第2个参数，调用 setlocale 函数就可以切换到本地模式，这种模式下程序会适应本地环境。比如：切换到我们的本地模式后就支持宽字符（汉字）的输出等。</p> 
<pre><code class="prism language-c"><span class="token function">setlocale</span><span class="token punctuation">(</span>LC_ALL<span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//切换到本地环境 </span>
</code></pre> 
<h3><a id="514__163"></a>5.1.4 宽字符的打印</h3> 
<p>那如果想在屏幕上打印宽字符，怎么打印呢？<br> 宽字符的字面量<strong>必须加上前缀“L”</strong>，否则 C 语言会把字面量当作窄字符类型处理。前缀“L”在单引号前面，表示宽字符，对应 wprintf() 的占位符为 %lc ；在双引号前面，表示宽字符串，对应wprintf() 的占位符为 %ls 。<br> <img src="https://images2.imgbox.com/e8/a1/snrN04z8_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="515__167"></a>5.1.5 地图坐标</h3> 
<p>我们假设实现⼀个棋盘27行，58列的棋盘（行和列可以根据自己的情况修改），再围绕地图画出墙，如下：<br> <img src="https://images2.imgbox.com/14/02/amilt1QK_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="52__170"></a>5.2 蛇身与食物</h3> 
<p>初始化状态，假设蛇的蛇度是5，蛇身的每个节点是 ● ，在固定的⼀个坐标处，比如(24,5)处开始出现蛇，连续5个节点。<br> 注意：蛇的每个节点的x坐标必须是2个倍数，否则可能会出现蛇的⼀个节点有⼀半儿出现在墙体中，另外⼀般在墙外的现象，坐标不好对齐。<br> 关于食物，就是在墙体内随机生成⼀个坐标（x坐标必须是2的倍数），坐标不能和蛇的身体重合，然后打印★。<br> <img src="https://images2.imgbox.com/5e/d6/iQqL8gDH_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="53__175"></a>5.3 数据结构设计</h3> 
<p>在游戏运行的过程中，蛇每次吃⼀个食物物，蛇的身体就会变长⼀节，如果我们使用链表存储蛇的信息，那么蛇的每⼀节其实就是链表的每个节点。每个节点只要记录好蛇身节点在地图上的坐标就行，所以蛇节点结构如下：</p> 
<pre><code class="prism language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">SnakeNode</span>
<span class="token punctuation">{<!-- --></span>
	 <span class="token keyword">int</span> x<span class="token punctuation">;</span>
	 <span class="token keyword">int</span> y<span class="token punctuation">;</span>
	 <span class="token keyword">struct</span> <span class="token class-name">SnakeNode</span><span class="token operator">*</span> next<span class="token punctuation">;</span>
<span class="token punctuation">}</span>SnakeNode<span class="token punctuation">,</span> <span class="token operator">*</span> pSnakeNode<span class="token punctuation">;</span>
</code></pre> 
<p>要管理整条贪吃蛇，我们再封装⼀个Snake的结构来维护整条贪吃蛇：</p> 
<pre><code class="prism language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Snake</span>
<span class="token punctuation">{<!-- --></span>
	 pSnakeNode _pSnake<span class="token punctuation">;</span><span class="token comment">//维护整条蛇的指针 </span>
	 pSnakeNode _pFood<span class="token punctuation">;</span><span class="token comment">//维护⻝物的指针 </span>
	 <span class="token keyword">enum</span> <span class="token class-name">DIRECTION</span> _Dir<span class="token punctuation">;</span><span class="token comment">//蛇头的⽅向,默认是向右 </span>
	 <span class="token keyword">enum</span> <span class="token class-name">GAME_STATUS</span> _Status<span class="token punctuation">;</span><span class="token comment">//游戏状态 </span>
	 <span class="token keyword">int</span> _Socre<span class="token punctuation">;</span><span class="token comment">//游戏当前获得分数 </span>
	 <span class="token keyword">int</span> _foodWeight<span class="token punctuation">;</span><span class="token comment">//默认每个⻝物分数 </span>
	 <span class="token keyword">int</span> _SleepTime<span class="token punctuation">;</span><span class="token comment">//每⾛⼀步休眠时间 </span>
<span class="token punctuation">}</span>Snake<span class="token punctuation">,</span> <span class="token operator">*</span> pSnake<span class="token punctuation">;</span>
</code></pre> 
<p>蛇的方向，可以⼀⼀列举，使用枚举</p> 
<pre><code class="prism language-c"><span class="token comment">//⽅向 </span>
<span class="token keyword">enum</span> <span class="token class-name">DIRECTION</span>
<span class="token punctuation">{<!-- --></span> 
	UP <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>	<span class="token comment">//向上</span>
	DOWN<span class="token punctuation">,</span>	<span class="token comment">//向下</span>
	LEFT<span class="token punctuation">,</span>	<span class="token comment">//向左</span>
	RIGHT	<span class="token comment">//向右</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>游戏状态，可以⼀⼀列举，使用枚举</p> 
<pre><code class="prism language-c"><span class="token comment">//游戏状态 </span>
<span class="token keyword">enum</span> <span class="token class-name">GAME_STATUS</span>
<span class="token punctuation">{<!-- --></span>
	 OK<span class="token punctuation">,</span><span class="token comment">//正常运⾏ </span>
	 KILL_BY_WALL<span class="token punctuation">,</span><span class="token comment">//撞墙 </span>
	 KILL_BY_SELF<span class="token punctuation">,</span><span class="token comment">//咬到⾃⼰ </span>
	 END_NOMAL<span class="token comment">//正常结束 </span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="54__220"></a>5.4 游戏流程设计</h3> 
<p><img src="https://images2.imgbox.com/ab/eb/d85yfJ72_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_222"></a>六、核心逻辑实现分析</h2> 
<h3><a id="61__223"></a>6.1 游戏主逻辑</h3> 
<p>程序开始就设置程序支持本地模式，然后进入游戏的主逻辑。<br> 主逻辑分为3个过程：</p> 
<ul><li>游戏开始（GameStart）完成游戏的初始化</li><li>游戏运行（GameRun）完成游戏运行逻辑的实现</li><li>游戏结束（GameEnd）完成游戏结束的说明，实现资源释放</li></ul> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">game</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> ch <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">srand</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">do</span>
	<span class="token punctuation">{<!-- --></span>
		Snake snake <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token function">GameStart</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>snake<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">GameRun</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>snake<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">GameEnd</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>snake<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"再来⼀局吗？(Y/N):"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//清理\n </span>
	<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token char">'Y'</span> <span class="token operator">||</span> ch <span class="token operator">==</span> <span class="token char">'y'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//修改当前地区为本地模式，为了支持中文宽字符的打印 </span>
	<span class="token function">setlocale</span><span class="token punctuation">(</span>LC_ALL<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//测试逻辑 </span>
	<span class="token function">game</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="62GameStart_257"></a>6.2游戏开始（GameStart）</h3> 
<p>这个模块完成游戏的初始化任务：</p> 
<ul><li>控制台窗口大小的设置</li><li>控制台窗口名字的设置</li><li>光标的隐藏</li><li>打印欢迎界面</li><li>创建地图</li><li>初始化蛇</li><li>创建第一个食物</li></ul> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">GameStart</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//设置控制台窗口的大小，30行，100列 </span>
	<span class="token comment">//mode 为DOS命令 </span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"mode con cols=100 lines=30"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//设置cmd窗口名称 </span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"title 贪吃蛇"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//获取标准输出的句柄(用来标识不同设备的数值) </span>
	HANDLE handle <span class="token operator">=</span> <span class="token function">GetStdHandle</span><span class="token punctuation">(</span>STD_OUTPUT_HANDLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//影藏光标操作 </span>
	CONSOLE_CURSOR_INFO CursorInfo<span class="token punctuation">;</span>
	<span class="token function">GetConsoleCursorInfo</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token operator">&amp;</span>CursorInfo<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取控制台光标信息 </span>
	CursorInfo<span class="token punctuation">.</span>bVisible <span class="token operator">=</span> false<span class="token punctuation">;</span> <span class="token comment">//隐藏控制台光标 </span>
	<span class="token function">SetConsoleCursorInfo</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token operator">&amp;</span>CursorInfo<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设置控制台光标状态 </span>
	<span class="token comment">//打印欢迎界面</span>
	<span class="token function">WelcomeToGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//打印地图 </span>
	<span class="token function">CreateMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//初始化蛇 </span>
	<span class="token function">InitSnake</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//创建食物 </span>
	<span class="token function">CreateFood</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="621__291"></a>6.2.1 打印欢迎界面</h4> 
<p>在游戏正式开始之前，做⼀些功能提醒.</p> 
<pre><code class="prism language-c"><span class="token comment">//设置光标的坐标 </span>
<span class="token keyword">void</span> <span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token keyword">short</span> x<span class="token punctuation">,</span> <span class="token keyword">short</span> y<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	COORD pos <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span><span class="token punctuation">;</span>
	HANDLE hOutput <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token comment">//获取标准输出的句柄(用来标识不同设备的数值) </span>
	hOutput <span class="token operator">=</span> <span class="token function">GetStdHandle</span><span class="token punctuation">(</span>STD_OUTPUT_HANDLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//设置标准输出上光标的位置为pos </span>
	<span class="token function">SetConsoleCursorPosition</span><span class="token punctuation">(</span>hOutput<span class="token punctuation">,</span> pos<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//打印欢迎进入游戏</span>
<span class="token keyword">void</span> <span class="token function">WelcomeToGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"欢迎进入贪吃蛇游戏"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//让按任意键继续的出现的位置好看点 </span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"用 ↑  ↓  ←   → 分别控制蛇的移动， K为加速，L为减速"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"加速将能得到更高的分数"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//让按任意键继续的出现的位置好看点 </span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="622__321"></a>6.2.2 创建地图</h4> 
<p>创建地图就是将墙打印出来，因为是宽字符打印，所有使用wprintf函数，打印格式串前使用L。<br> 打印地图的关键是要算好坐标，才能在想要的位置打印墙体。<br> 墙体打印的宽字符：</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">WALL</span> <span class="token expression">L</span><span class="token char">'□'</span> </span>
</code></pre> 
<pre><code class="prism language-c"><span class="token comment">//创建地图</span>
<span class="token keyword">void</span> <span class="token function">CreateMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token comment">//上(0,0)-(56, 0) </span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">58</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%c"</span><span class="token punctuation">,</span> WALL<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//下(0,26)-(56, 26) </span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">58</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%c"</span><span class="token punctuation">,</span> WALL<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//左 </span>
	<span class="token comment">//x是0，y从1开始增长</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">26</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%c"</span><span class="token punctuation">,</span> WALL<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//x是56，y从1开始增长</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">26</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">56</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%c"</span><span class="token punctuation">,</span> WALL<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="623__360"></a>6.2.3 初始化蛇身</h4> 
<p>蛇最开始长度为5节，每节对应链表的⼀个节点，蛇身的每⼀个节点都有自己的坐标。<br> 创建5个节点，然后将每个节点存放在链表中进行管理。创建完蛇身后，将蛇的每⼀节打印在屏幕上。</p> 
<ul><li>蛇的初始位置从(24,5)开始。再设置当前游戏的状态，蛇移动的速度，默认的方向，初始成绩，每个食物的分数。</li><li>游戏状态是：OK</li><li>蛇的移动速度：200毫秒</li><li>蛇的默认方向：RIGHT</li><li>初始成绩：0</li><li>每个食物的分数：10<br> 蛇身打印的宽字符：</li></ul> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BODY</span> <span class="token expression">L</span><span class="token char">'●'</span> </span>
</code></pre> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">InitSnake</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	pSnakeNode cur <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token comment">//创建蛇身节点，并初始化坐标 </span>
	<span class="token comment">//头插法 </span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//创建蛇身的节点 </span>
		cur <span class="token operator">=</span> <span class="token punctuation">(</span>pSnakeNode<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>SnakeNode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>cur <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"InitSnake()::malloc()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//设置坐标 </span>
		cur<span class="token operator">-&gt;</span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
		cur<span class="token operator">-&gt;</span>x <span class="token operator">=</span> POS_X <span class="token operator">+</span> i <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
		cur<span class="token operator">-&gt;</span>y <span class="token operator">=</span> POS_Y<span class="token punctuation">;</span>
		<span class="token comment">//头插法 </span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_pSnake <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			ps<span class="token operator">-&gt;</span>_pSnake <span class="token operator">=</span> cur<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{<!-- --></span>
			cur<span class="token operator">-&gt;</span>next <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token punctuation">;</span>
			ps<span class="token operator">-&gt;</span>_pSnake <span class="token operator">=</span> cur<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//打印蛇的身体 </span>
	cur <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">SetPos</span><span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>x<span class="token punctuation">,</span> cur<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%c"</span><span class="token punctuation">,</span> BODY<span class="token punctuation">)</span><span class="token punctuation">;</span>
		cur <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//初始化贪吃蛇数据 </span>
	ps<span class="token operator">-&gt;</span>_SleepTime <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
	ps<span class="token operator">-&gt;</span>_Socre <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	ps<span class="token operator">-&gt;</span>_Status <span class="token operator">=</span> OK<span class="token punctuation">;</span>
	ps<span class="token operator">-&gt;</span>_Dir <span class="token operator">=</span> RIGHT<span class="token punctuation">;</span>
	ps<span class="token operator">-&gt;</span>_foodWeight <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="624__420"></a>6.2.4 创建第一个食物</h4> 
<ul><li>先随机生成食物的坐标 
  <ul><li>x坐标必须是2的倍数</li><li>食物的坐标不能和蛇身每个节点的坐标重复</li></ul> </li><li>创建食物节点，打印食物<br> 食物打印的宽字符:</li></ul> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">FOOD</span> <span class="token expression">L</span><span class="token char">'★'</span></span>
</code></pre> 
<pre><code class="prism language-c"><span class="token comment">//创建食物</span>
<span class="token keyword">void</span> <span class="token function">CreateFood</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
again<span class="token operator">:</span>
	<span class="token comment">//产生的x坐标应该是2的倍数，这样才可能和蛇头坐标对齐。 </span>
	<span class="token keyword">do</span>
	<span class="token punctuation">{<!-- --></span>
		x <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">53</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
		y <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">25</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>x <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//获取指向蛇头的指针 </span>
	pSnakeNode cur <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token punctuation">;</span>
	<span class="token comment">//食物不能和蛇身冲突 </span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>x <span class="token operator">==</span> x <span class="token operator">&amp;&amp;</span> cur<span class="token operator">-&gt;</span>y <span class="token operator">==</span> y<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">goto</span> again<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		cur <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//创建食物</span>
	pSnakeNode pFood <span class="token operator">=</span> <span class="token punctuation">(</span>pSnakeNode<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>SnakeNode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pFood <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"CreateFood::malloc()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{<!-- --></span>
		pFood<span class="token operator">-&gt;</span>x <span class="token operator">=</span> x<span class="token punctuation">;</span>
		pFood<span class="token operator">-&gt;</span>y <span class="token operator">=</span> y<span class="token punctuation">;</span>
		<span class="token function">SetPos</span><span class="token punctuation">(</span>pFood<span class="token operator">-&gt;</span>x<span class="token punctuation">,</span> pFood<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%c"</span><span class="token punctuation">,</span> FOOD<span class="token punctuation">)</span><span class="token punctuation">;</span>
		ps<span class="token operator">-&gt;</span>_pFood <span class="token operator">=</span> pFood<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="63_GameRun_470"></a>6.3 游戏运行（GameRun）</h3> 
<p>游戏运行期间，右侧打印帮助信息，提示玩家。<br> 根据游戏状态检查游戏是否继续，如果是状态是OK，游戏继续，否则游戏结束。<br> 如果游戏继续，就是检测按键情况，确定蛇下一步的方向，或者是否加速减速，是否暂停或者退出游戏。<br> 虚拟按键上面给过。</p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">GameRun</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//打印右侧帮助信息 </span>
	<span class="token function">PrintHelpInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">do</span>
	<span class="token punctuation">{<!-- --></span>
 		<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"得分：%d  "</span><span class="token punctuation">,</span> ps<span class="token operator">-&gt;</span>_Socre<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"每个食物得分：%d分"</span><span class="token punctuation">,</span> ps<span class="token operator">-&gt;</span>_foodWeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//按键判断，上下左右WSAD或者数字8246,虚拟键</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span><span class="token number">0x57</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_NUMPAD8<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> ps<span class="token operator">-&gt;</span>_Dir <span class="token operator">!=</span> DOWN<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			ps<span class="token operator">-&gt;</span>_Dir <span class="token operator">=</span> UP<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span><span class="token number">0x53</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_NUMPAD2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> ps<span class="token operator">-&gt;</span>_Dir <span class="token operator">!=</span> UP<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			ps<span class="token operator">-&gt;</span>_Dir <span class="token operator">=</span> DOWN<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span><span class="token number">0x41</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_NUMPAD4<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> ps<span class="token operator">-&gt;</span>_Dir <span class="token operator">!=</span> RIGHT<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			ps<span class="token operator">-&gt;</span>_Dir <span class="token operator">=</span> LEFT<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span><span class="token number">0x44</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_NUMPAD6<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> ps<span class="token operator">-&gt;</span>_Dir <span class="token operator">!=</span> LEFT<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			ps<span class="token operator">-&gt;</span>_Dir <span class="token operator">=</span> RIGHT<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_SPACE<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_ESCAPE<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			ps<span class="token operator">-&gt;</span>_Status <span class="token operator">=</span> END_NOMAL<span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span><span class="token number">0x4B</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_SleepTime <span class="token operator">&gt;=</span> <span class="token number">50</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				ps<span class="token operator">-&gt;</span>_SleepTime <span class="token operator">-=</span> <span class="token number">30</span><span class="token punctuation">;</span>
				ps<span class="token operator">-&gt;</span>_foodWeight <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span><span class="token number">0x4C</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_SleepTime <span class="token operator">&lt;</span> <span class="token number">350</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				ps<span class="token operator">-&gt;</span>_SleepTime <span class="token operator">+=</span> <span class="token number">30</span><span class="token punctuation">;</span>
				ps<span class="token operator">-&gt;</span>_foodWeight <span class="token operator">-=</span> <span class="token number">2</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_SleepTime <span class="token operator">==</span> <span class="token number">350</span><span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					ps<span class="token operator">-&gt;</span>_foodWeight <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//蛇每次⼀定之间要休眠的时间，时间短，蛇移动速度就快 </span>
		<span class="token function">Sleep</span><span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_SleepTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">SnakeMove</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_Status <span class="token operator">==</span> OK<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="631_KEY_PRESS_537"></a>6.3.1 KEY_PRESS</h4> 
<p>检测按键状态，我们封装了⼀个宏</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">KEY_PRESS</span><span class="token expression"><span class="token punctuation">(</span>VK<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">GetAsyncKeyState</span><span class="token punctuation">(</span>VK<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0x1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span></span></span>
</code></pre> 
<h4><a id="632_542"></a>6.3.2打印右侧的帮助信息</h4> 
<pre><code class="prism language-c"><span class="token comment">//打印提示信息</span>
<span class="token keyword">void</span> <span class="token function">PrintHelpInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>	 
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"不能穿墙，不能咬到自己"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"用 ↑ . ↓ . ← . → 分别控制蛇的移动."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"K 为加速，L 为减速"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ESC：退出游戏."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"space：暂停游戏."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"卡戎-caryon@版权"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="633_561"></a>6.3.3蛇身的移动</h4> 
<p>先创建下⼀个节点，根据移动方向和蛇头的坐标，蛇移动到下⼀个位置的坐标。<br> 确定了下⼀个位置后，看下⼀个位置是否是食物（NextIsFood），是食物就做吃食物处理（EatFood），如果不是食物则做前进一步的处理（NoFood）。<br> 蛇身移动后，判断此次移动是否会造成撞墙（KillByWall）或者撞上自己蛇身（KillBySelf），从而影响游戏的状态。</p> 
<pre><code class="prism language-c"><span class="token comment">//暂停 </span>
<span class="token keyword">void</span> <span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_SPACE<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//pSnakeNode psn 是下一个节点的地址 </span>
<span class="token comment">//pSnake ps 维护蛇的指针 </span>
<span class="token keyword">int</span> <span class="token function">NextIsFood</span><span class="token punctuation">(</span>pSnakeNode psn<span class="token punctuation">,</span> pSnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span>psn<span class="token operator">-&gt;</span>x <span class="token operator">==</span> ps<span class="token operator">-&gt;</span>_pFood<span class="token operator">-&gt;</span>x<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>psn<span class="token operator">-&gt;</span>y <span class="token operator">==</span> ps<span class="token operator">-&gt;</span>_pFood<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//pSnakeNode psn 是下一个节点的地址 </span>
<span class="token comment">//pSnake ps 维护蛇的指针 </span>
<span class="token keyword">void</span> <span class="token function">EatFood</span><span class="token punctuation">(</span>pSnakeNode psn<span class="token punctuation">,</span> pSnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//头插法 </span>
	psn<span class="token operator">-&gt;</span>next <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token punctuation">;</span>
	ps<span class="token operator">-&gt;</span>_pSnake <span class="token operator">=</span> psn<span class="token punctuation">;</span>
	pSnakeNode cur <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token punctuation">;</span>
	<span class="token comment">//打印蛇</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">SetPos</span><span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>x<span class="token punctuation">,</span> cur<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%c"</span><span class="token punctuation">,</span> BODY<span class="token punctuation">)</span><span class="token punctuation">;</span>
		cur <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	ps<span class="token operator">-&gt;</span>_Socre <span class="token operator">+=</span> ps<span class="token operator">-&gt;</span>_foodWeight<span class="token punctuation">;</span>
	<span class="token function">free</span><span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_pFood<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">CreateFood</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//pSnakeNode psn 是下一个节点的地址 </span>
<span class="token comment">//pSnake ps 维护蛇的指针 </span>
<span class="token keyword">void</span> <span class="token function">NoFood</span><span class="token punctuation">(</span>pSnakeNode psn<span class="token punctuation">,</span> pSnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//头插法 </span>
	psn<span class="token operator">-&gt;</span>next <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token punctuation">;</span>
	ps<span class="token operator">-&gt;</span>_pSnake <span class="token operator">=</span> psn<span class="token punctuation">;</span>
	pSnakeNode cur <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token punctuation">;</span>
	<span class="token comment">//打印蛇 </span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>next<span class="token operator">-&gt;</span>next<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">SetPos</span><span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>x<span class="token punctuation">,</span> cur<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%c"</span><span class="token punctuation">,</span> BODY<span class="token punctuation">)</span><span class="token punctuation">;</span>
		cur <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//最后一个位置打印空格，然后释放节点 </span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>next<span class="token operator">-&gt;</span>x<span class="token punctuation">,</span> cur<span class="token operator">-&gt;</span>next<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"  "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">free</span><span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>next<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cur<span class="token operator">-&gt;</span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//pSnake ps 维护蛇的指针 </span>
<span class="token keyword">int</span> <span class="token function">KillByWall</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>x <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token operator">||</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>x <span class="token operator">==</span> <span class="token number">56</span><span class="token punctuation">)</span>
		<span class="token operator">||</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>y <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token operator">||</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>y <span class="token operator">==</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		ps<span class="token operator">-&gt;</span>_Status <span class="token operator">=</span> KILL_BY_WALL<span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//pSnake ps 维护蛇的指针 </span>
<span class="token keyword">int</span> <span class="token function">KillBySelf</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	pSnakeNode cur <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>x <span class="token operator">==</span> cur<span class="token operator">-&gt;</span>x<span class="token punctuation">)</span>
			<span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>y <span class="token operator">==</span> cur<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			ps<span class="token operator">-&gt;</span>_Status <span class="token operator">=</span> KILL_BY_SELF<span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		cur <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//蛇的移动</span>
<span class="token keyword">void</span> <span class="token function">SnakeMove</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//创建下一个节点 </span>
	pSnakeNode pNextNode <span class="token operator">=</span> <span class="token punctuation">(</span>pSnakeNode<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>SnakeNode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pNextNode <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"SnakeMove()::malloc()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//确定下一个节点的坐标，下一个节点的坐标根据，蛇头的坐标和方向确定 </span>
	<span class="token keyword">switch</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_Dir<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">case</span> UP<span class="token operator">:</span>
		pNextNode<span class="token operator">-&gt;</span>x <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>x<span class="token punctuation">;</span>
		pNextNode<span class="token operator">-&gt;</span>y <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>y <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> DOWN<span class="token operator">:</span>
		pNextNode<span class="token operator">-&gt;</span>x <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>x<span class="token punctuation">;</span>
		pNextNode<span class="token operator">-&gt;</span>y <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>y <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> LEFT<span class="token operator">:</span>
		pNextNode<span class="token operator">-&gt;</span>x <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>x <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span>
		pNextNode<span class="token operator">-&gt;</span>y <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>y<span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> RIGHT<span class="token operator">:</span>
		pNextNode<span class="token operator">-&gt;</span>x <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>x <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
		pNextNode<span class="token operator">-&gt;</span>y <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>y<span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//如果下一个位置就是食物</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">NextIsFood</span><span class="token punctuation">(</span>pNextNode<span class="token punctuation">,</span> ps<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">EatFood</span><span class="token punctuation">(</span>pNextNode<span class="token punctuation">,</span> ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span><span class="token comment">//如果没有食物 </span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">NoFood</span><span class="token punctuation">(</span>pNextNode<span class="token punctuation">,</span> ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">KillByWall</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">KillBySelf</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="64__698"></a>6.4 游戏结束</h3> 
<p>游戏状态不再是OK（游戏继续）的时候，要告知游戏结束的原因，并且释放蛇身节点。</p> 
<pre><code class="prism language-c"><span class="token comment">//游戏结束</span>
<span class="token keyword">void</span> <span class="token function">GameEnd</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	pSnakeNode cur <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token punctuation">;</span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">switch</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_Status<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">case</span> END_NOMAL<span class="token operator">:</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"您主动退出游戏\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> KILL_BY_SELF<span class="token operator">:</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"您撞上自己了 ,游戏结束!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> KILL_BY_WALL<span class="token operator">:</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"您撞墙了,游戏结束!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//释放蛇身的节点 </span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		pSnakeNode del <span class="token operator">=</span> cur<span class="token punctuation">;</span>
		cur <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span>
		<span class="token function">free</span><span class="token punctuation">(</span>del<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="_727"></a>七、参考代码</h2> 
<pre><code class="prism language-c"><span class="token comment">//test.c</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"snake.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"Game_Start.h"</span></span>


<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;locale.h&gt;</span></span>
<span class="token keyword">void</span> <span class="token function">game</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> ch <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">srand</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">do</span>
	<span class="token punctuation">{<!-- --></span>
		Snake snake <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token function">GameStart</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>snake<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">GameRun</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>snake<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">GameEnd</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>snake<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"再来⼀局吗？(Y/N):"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//清理\n </span>
	<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token char">'Y'</span> <span class="token operator">||</span> ch <span class="token operator">==</span> <span class="token char">'y'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//修改当前地区为本地模式，为了支持中文宽字符的打印 </span>
	<span class="token function">setlocale</span><span class="token punctuation">(</span>LC_ALL<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//测试逻辑 </span>
	<span class="token function">game</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-c"><span class="token comment">//snake.h</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;windows.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;time.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdbool.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>

<span class="token comment">//判断按键是否被按下过</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">KEY_PRESS</span><span class="token expression"><span class="token punctuation">(</span>VK<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">GetAsyncKeyState</span><span class="token punctuation">(</span>VK<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0x1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span></span></span>

<span class="token comment">//方向</span>
<span class="token keyword">enum</span> <span class="token class-name">DIRECTION</span>
<span class="token punctuation">{<!-- --></span>
	UP <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
	DOWN<span class="token punctuation">,</span>
	LEFT<span class="token punctuation">,</span>
	RIGHT
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//游戏状态 </span>
<span class="token keyword">enum</span> <span class="token class-name">GAME_STATUS</span>
<span class="token punctuation">{<!-- --></span>
	OK<span class="token punctuation">,</span><span class="token comment">//正常运⾏ </span>
	KILL_BY_WALL<span class="token punctuation">,</span><span class="token comment">//撞墙 </span>
	KILL_BY_SELF<span class="token punctuation">,</span><span class="token comment">//咬到⾃⼰ </span>
	END_NOMAL<span class="token comment">//正常结束 </span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">WALL</span>  <span class="token expression">L</span><span class="token char">'□'</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BODY</span> <span class="token expression">L</span><span class="token char">'●'</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">FOOD</span> <span class="token expression">L</span><span class="token char">'★'</span> </span>
<span class="token comment">//蛇的初始位置 </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">POS_X</span> <span class="token expression"><span class="token number">24</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">POS_Y</span> <span class="token expression"><span class="token number">5</span></span></span>
<span class="token comment">//蛇身节点 </span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">SnakeNode</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> x<span class="token punctuation">;</span>
	<span class="token keyword">int</span> y<span class="token punctuation">;</span>
	<span class="token keyword">struct</span> <span class="token class-name">SnakeNode</span><span class="token operator">*</span> next<span class="token punctuation">;</span>
<span class="token punctuation">}</span>SnakeNode<span class="token punctuation">,</span> <span class="token operator">*</span> pSnakeNode<span class="token punctuation">;</span>
<span class="token comment">//蛇</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Snake</span>
<span class="token punctuation">{<!-- --></span>
	pSnakeNode _pSnake<span class="token punctuation">;</span><span class="token comment">//维护整条蛇的指针 </span>
	pSnakeNode _pFood<span class="token punctuation">;</span><span class="token comment">//维护食物的指针 </span>
	<span class="token keyword">enum</span> <span class="token class-name">DIRECTION</span> _Dir<span class="token punctuation">;</span><span class="token comment">//蛇头的方向默认是向右 </span>
	<span class="token keyword">enum</span> <span class="token class-name">GAME_STATUS</span> _Status<span class="token punctuation">;</span><span class="token comment">//游戏状态 </span>
	<span class="token keyword">int</span> _Socre<span class="token punctuation">;</span><span class="token comment">//当前获得分数 </span>
	<span class="token keyword">int</span> _foodWeight<span class="token punctuation">;</span><span class="token comment">//默认每个食物10分 </span>
	<span class="token keyword">int</span> _SleepTime<span class="token punctuation">;</span><span class="token comment">//每走一步休眠时间 </span>
<span class="token punctuation">}</span>Snake<span class="token punctuation">,</span> <span class="token operator">*</span> pSnake<span class="token punctuation">;</span>


<span class="token comment">//游戏开始前的初始化 </span>
<span class="token keyword">void</span> <span class="token function">GameStart</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//游戏运行过程 </span>
<span class="token keyword">void</span> <span class="token function">GameRun</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//游戏结束 </span>
<span class="token keyword">void</span> <span class="token function">GameEnd</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-c"><span class="token comment">//snack.c</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"snake.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"Game_Start.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"Game_Run.h"</span></span>

<span class="token keyword">void</span> <span class="token function">GameStart</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//设置控制台窗口的大小，30行，100列 </span>
	<span class="token comment">//mode 为DOS命令 </span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"mode con cols=100 lines=30"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//设置cmd窗口名称 </span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"title 贪吃蛇"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//获取标准输出的句柄(用来标识不同设备的数值) </span>
	HANDLE handle <span class="token operator">=</span> <span class="token function">GetStdHandle</span><span class="token punctuation">(</span>STD_OUTPUT_HANDLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//影藏光标操作 </span>
	CONSOLE_CURSOR_INFO CursorInfo<span class="token punctuation">;</span>
	<span class="token function">GetConsoleCursorInfo</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token operator">&amp;</span>CursorInfo<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取控制台光标信息 </span>
	CursorInfo<span class="token punctuation">.</span>bVisible <span class="token operator">=</span> false<span class="token punctuation">;</span> <span class="token comment">//隐藏控制台光标 </span>
	<span class="token function">SetConsoleCursorInfo</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token operator">&amp;</span>CursorInfo<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设置控制台光标状态 </span>
	<span class="token comment">//打印欢迎界面</span>
	<span class="token function">WelcomeToGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//打印地图 </span>
	<span class="token function">CreateMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//初始化蛇 </span>
	<span class="token function">InitSnake</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//创建食物 </span>
	<span class="token function">CreateFood</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">GameRun</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//打印右侧帮助信息 </span>
	<span class="token function">PrintHelpInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">do</span>
	<span class="token punctuation">{<!-- --></span>
 		<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"得分：%d  "</span><span class="token punctuation">,</span> ps<span class="token operator">-&gt;</span>_Socre<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"每个食物得分：%d分"</span><span class="token punctuation">,</span> ps<span class="token operator">-&gt;</span>_foodWeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//按键判断，上下左右WSAD或者数字8246,虚拟键</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span><span class="token number">0x57</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_NUMPAD8<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> ps<span class="token operator">-&gt;</span>_Dir <span class="token operator">!=</span> DOWN<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			ps<span class="token operator">-&gt;</span>_Dir <span class="token operator">=</span> UP<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span><span class="token number">0x53</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_NUMPAD2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> ps<span class="token operator">-&gt;</span>_Dir <span class="token operator">!=</span> UP<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			ps<span class="token operator">-&gt;</span>_Dir <span class="token operator">=</span> DOWN<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span><span class="token number">0x41</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_NUMPAD4<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> ps<span class="token operator">-&gt;</span>_Dir <span class="token operator">!=</span> RIGHT<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			ps<span class="token operator">-&gt;</span>_Dir <span class="token operator">=</span> LEFT<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span><span class="token number">0x44</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_NUMPAD6<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> ps<span class="token operator">-&gt;</span>_Dir <span class="token operator">!=</span> LEFT<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			ps<span class="token operator">-&gt;</span>_Dir <span class="token operator">=</span> RIGHT<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_SPACE<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_ESCAPE<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			ps<span class="token operator">-&gt;</span>_Status <span class="token operator">=</span> END_NOMAL<span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span><span class="token number">0x4B</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_SleepTime <span class="token operator">&gt;=</span> <span class="token number">50</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				ps<span class="token operator">-&gt;</span>_SleepTime <span class="token operator">-=</span> <span class="token number">30</span><span class="token punctuation">;</span>
				ps<span class="token operator">-&gt;</span>_foodWeight <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span><span class="token number">0x4C</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_SleepTime <span class="token operator">&lt;</span> <span class="token number">350</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				ps<span class="token operator">-&gt;</span>_SleepTime <span class="token operator">+=</span> <span class="token number">30</span><span class="token punctuation">;</span>
				ps<span class="token operator">-&gt;</span>_foodWeight <span class="token operator">-=</span> <span class="token number">2</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_SleepTime <span class="token operator">==</span> <span class="token number">350</span><span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					ps<span class="token operator">-&gt;</span>_foodWeight <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//蛇每次⼀定之间要休眠的时间，时间短，蛇移动速度就快 </span>
		<span class="token function">Sleep</span><span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_SleepTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">SnakeMove</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_Status <span class="token operator">==</span> OK<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//游戏结束</span>
<span class="token keyword">void</span> <span class="token function">GameEnd</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	pSnakeNode cur <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token punctuation">;</span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">switch</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_Status<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">case</span> END_NOMAL<span class="token operator">:</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"您主动退出游戏\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> KILL_BY_SELF<span class="token operator">:</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"您撞上自己了 ,游戏结束!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> KILL_BY_WALL<span class="token operator">:</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"您撞墙了,游戏结束!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//释放蛇身的节点 </span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		pSnakeNode del <span class="token operator">=</span> cur<span class="token punctuation">;</span>
		cur <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span>
		<span class="token function">free</span><span class="token punctuation">(</span>del<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-c"><span class="token comment">//Game_Start.h</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"snake.h"</span></span>
<span class="token comment">//设置光标的坐标 </span>
<span class="token keyword">void</span> <span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token keyword">short</span> x<span class="token punctuation">,</span> <span class="token keyword">short</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//欢迎界面</span>
<span class="token keyword">void</span> <span class="token function">WelcomeToGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//打印帮助信息 </span>
<span class="token keyword">void</span> <span class="token function">PrintHelpInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//创建地图 </span>
<span class="token keyword">void</span> <span class="token function">CreateMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//初始化蛇 </span>
<span class="token keyword">void</span> <span class="token function">InitSnake</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//创建食物</span>
<span class="token keyword">void</span> <span class="token function">CreateFood</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-c"><span class="token comment">//Game_Start.c</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"Game_Start.h"</span></span>

<span class="token comment">//设置光标的坐标 </span>
<span class="token keyword">void</span> <span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token keyword">short</span> x<span class="token punctuation">,</span> <span class="token keyword">short</span> y<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	COORD pos <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span><span class="token punctuation">;</span>
	HANDLE hOutput <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token comment">//获取标准输出的句柄(用来标识不同设备的数值) </span>
	hOutput <span class="token operator">=</span> <span class="token function">GetStdHandle</span><span class="token punctuation">(</span>STD_OUTPUT_HANDLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//设置标准输出上光标的位置为pos </span>
	<span class="token function">SetConsoleCursorPosition</span><span class="token punctuation">(</span>hOutput<span class="token punctuation">,</span> pos<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//打印欢迎进入游戏</span>
<span class="token keyword">void</span> <span class="token function">WelcomeToGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"欢迎进入贪吃蛇游戏"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//让按任意键继续的出现的位置好看点 </span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"用 ↑  ↓  ←   → 分别控制蛇的移动， K为加速，L为减速"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"加速将能得到更高的分数"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//让按任意键继续的出现的位置好看点 </span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//创建地图</span>
<span class="token keyword">void</span> <span class="token function">CreateMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token comment">//上(0,0)-(56, 0) </span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">58</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%c"</span><span class="token punctuation">,</span> WALL<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//下(0,26)-(56, 26) </span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">58</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%c"</span><span class="token punctuation">,</span> WALL<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//左 </span>
	<span class="token comment">//x是0，y从1开始增长</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">26</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%c"</span><span class="token punctuation">,</span> WALL<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//x是56，y从1开始增长</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">26</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">56</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%c"</span><span class="token punctuation">,</span> WALL<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//初始化蛇，给五节身体</span>
<span class="token keyword">void</span> <span class="token function">InitSnake</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	pSnakeNode cur <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token comment">//创建蛇身节点，并初始化坐标 </span>
	<span class="token comment">//头插法 </span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//创建蛇身的节点 </span>
		cur <span class="token operator">=</span> <span class="token punctuation">(</span>pSnakeNode<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>SnakeNode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>cur <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"InitSnake()::malloc()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//设置坐标 </span>
		cur<span class="token operator">-&gt;</span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
		cur<span class="token operator">-&gt;</span>x <span class="token operator">=</span> POS_X <span class="token operator">+</span> i <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
		cur<span class="token operator">-&gt;</span>y <span class="token operator">=</span> POS_Y<span class="token punctuation">;</span>
		<span class="token comment">//头插法 </span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_pSnake <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			ps<span class="token operator">-&gt;</span>_pSnake <span class="token operator">=</span> cur<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{<!-- --></span>
			cur<span class="token operator">-&gt;</span>next <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token punctuation">;</span>
			ps<span class="token operator">-&gt;</span>_pSnake <span class="token operator">=</span> cur<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//打印蛇的身体 </span>
	cur <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">SetPos</span><span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>x<span class="token punctuation">,</span> cur<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%c"</span><span class="token punctuation">,</span> BODY<span class="token punctuation">)</span><span class="token punctuation">;</span>
		cur <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//初始化贪吃蛇数据 </span>
	ps<span class="token operator">-&gt;</span>_SleepTime <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
	ps<span class="token operator">-&gt;</span>_Socre <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	ps<span class="token operator">-&gt;</span>_Status <span class="token operator">=</span> OK<span class="token punctuation">;</span>
	ps<span class="token operator">-&gt;</span>_Dir <span class="token operator">=</span> RIGHT<span class="token punctuation">;</span>
	ps<span class="token operator">-&gt;</span>_foodWeight <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//创建食物</span>
<span class="token keyword">void</span> <span class="token function">CreateFood</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
again<span class="token operator">:</span>
	<span class="token comment">//产生的x坐标应该是2的倍数，这样才可能和蛇头坐标对齐。 </span>
	<span class="token keyword">do</span>
	<span class="token punctuation">{<!-- --></span>
		x <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">53</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
		y <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">25</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>x <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//获取指向蛇头的指针 </span>
	pSnakeNode cur <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token punctuation">;</span>
	<span class="token comment">//食物不能和蛇身冲突 </span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>x <span class="token operator">==</span> x <span class="token operator">&amp;&amp;</span> cur<span class="token operator">-&gt;</span>y <span class="token operator">==</span> y<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">goto</span> again<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		cur <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//创建食物</span>
	pSnakeNode pFood <span class="token operator">=</span> <span class="token punctuation">(</span>pSnakeNode<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>SnakeNode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pFood <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"CreateFood::malloc()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{<!-- --></span>
		pFood<span class="token operator">-&gt;</span>x <span class="token operator">=</span> x<span class="token punctuation">;</span>
		pFood<span class="token operator">-&gt;</span>y <span class="token operator">=</span> y<span class="token punctuation">;</span>
		<span class="token function">SetPos</span><span class="token punctuation">(</span>pFood<span class="token operator">-&gt;</span>x<span class="token punctuation">,</span> pFood<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%c"</span><span class="token punctuation">,</span> FOOD<span class="token punctuation">)</span><span class="token punctuation">;</span>
		ps<span class="token operator">-&gt;</span>_pFood <span class="token operator">=</span> pFood<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-c"><span class="token comment">//Game_Run.h</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"snake.h"</span></span>
<span class="token comment">//打印提示信息</span>
<span class="token keyword">void</span> <span class="token function">PrintHelpInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//暂停响应 </span>
<span class="token keyword">void</span> <span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//下一个节点是食物</span>
<span class="token keyword">int</span> <span class="token function">NextIsFood</span><span class="token punctuation">(</span>pSnakeNode psn<span class="token punctuation">,</span> pSnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//吃食物 </span>
<span class="token keyword">void</span> <span class="token function">EatFood</span><span class="token punctuation">(</span>pSnakeNode psn<span class="token punctuation">,</span> pSnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//不吃食物</span>
<span class="token keyword">void</span> <span class="token function">NoFood</span><span class="token punctuation">(</span>pSnakeNode psn<span class="token punctuation">,</span> pSnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//撞墙检测 </span>
<span class="token keyword">int</span> <span class="token function">KillByWall</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//撞自身检测 </span>
<span class="token keyword">int</span> <span class="token function">KillBySelf</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//蛇的移动 </span>
<span class="token keyword">void</span> <span class="token function">SnakeMove</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//游戏初始化 </span>
<span class="token keyword">void</span> <span class="token function">GameStart</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//游戏运行</span>
<span class="token keyword">void</span> <span class="token function">GameRun</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//游戏结束 </span>
<span class="token keyword">void</span> <span class="token function">GameEnd</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-c"><span class="token comment">//Game_Run.c</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"Game_Run.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"Game_Start.h"</span></span>
<span class="token comment">//打印提示信息</span>
<span class="token keyword">void</span> <span class="token function">PrintHelpInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>	 
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"不能穿墙，不能咬到自己"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"用 ↑ . ↓ . ← . → 分别控制蛇的移动."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"K 为加速，L 为减速"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ESC：退出游戏."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"space：暂停游戏."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"卡戎-caryon@版权"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//暂停 </span>
<span class="token keyword">void</span> <span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_SPACE<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//pSnakeNode psn 是下一个节点的地址 </span>
<span class="token comment">//pSnake ps 维护蛇的指针 </span>
<span class="token keyword">int</span> <span class="token function">NextIsFood</span><span class="token punctuation">(</span>pSnakeNode psn<span class="token punctuation">,</span> pSnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span>psn<span class="token operator">-&gt;</span>x <span class="token operator">==</span> ps<span class="token operator">-&gt;</span>_pFood<span class="token operator">-&gt;</span>x<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>psn<span class="token operator">-&gt;</span>y <span class="token operator">==</span> ps<span class="token operator">-&gt;</span>_pFood<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//pSnakeNode psn 是下一个节点的地址 </span>
<span class="token comment">//pSnake ps 维护蛇的指针 </span>
<span class="token keyword">void</span> <span class="token function">EatFood</span><span class="token punctuation">(</span>pSnakeNode psn<span class="token punctuation">,</span> pSnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//头插法 </span>
	psn<span class="token operator">-&gt;</span>next <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token punctuation">;</span>
	ps<span class="token operator">-&gt;</span>_pSnake <span class="token operator">=</span> psn<span class="token punctuation">;</span>
	pSnakeNode cur <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token punctuation">;</span>
	<span class="token comment">//打印蛇</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">SetPos</span><span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>x<span class="token punctuation">,</span> cur<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%c"</span><span class="token punctuation">,</span> BODY<span class="token punctuation">)</span><span class="token punctuation">;</span>
		cur <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	ps<span class="token operator">-&gt;</span>_Socre <span class="token operator">+=</span> ps<span class="token operator">-&gt;</span>_foodWeight<span class="token punctuation">;</span>
	<span class="token function">free</span><span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_pFood<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">CreateFood</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//pSnakeNode psn 是下一个节点的地址 </span>
<span class="token comment">//pSnake ps 维护蛇的指针 </span>
<span class="token keyword">void</span> <span class="token function">NoFood</span><span class="token punctuation">(</span>pSnakeNode psn<span class="token punctuation">,</span> pSnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//头插法 </span>
	psn<span class="token operator">-&gt;</span>next <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token punctuation">;</span>
	ps<span class="token operator">-&gt;</span>_pSnake <span class="token operator">=</span> psn<span class="token punctuation">;</span>
	pSnakeNode cur <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token punctuation">;</span>
	<span class="token comment">//打印蛇 </span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>next<span class="token operator">-&gt;</span>next<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">SetPos</span><span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>x<span class="token punctuation">,</span> cur<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%c"</span><span class="token punctuation">,</span> BODY<span class="token punctuation">)</span><span class="token punctuation">;</span>
		cur <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//最后一个位置打印空格，然后释放节点 </span>
	<span class="token function">SetPos</span><span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>next<span class="token operator">-&gt;</span>x<span class="token punctuation">,</span> cur<span class="token operator">-&gt;</span>next<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"  "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">free</span><span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>next<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cur<span class="token operator">-&gt;</span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//pSnake ps 维护蛇的指针 </span>
<span class="token keyword">int</span> <span class="token function">KillByWall</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>x <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token operator">||</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>x <span class="token operator">==</span> <span class="token number">56</span><span class="token punctuation">)</span>
		<span class="token operator">||</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>y <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token operator">||</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>y <span class="token operator">==</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		ps<span class="token operator">-&gt;</span>_Status <span class="token operator">=</span> KILL_BY_WALL<span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//pSnake ps 维护蛇的指针 </span>
<span class="token keyword">int</span> <span class="token function">KillBySelf</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	pSnakeNode cur <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>x <span class="token operator">==</span> cur<span class="token operator">-&gt;</span>x<span class="token punctuation">)</span>
			<span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>y <span class="token operator">==</span> cur<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			ps<span class="token operator">-&gt;</span>_Status <span class="token operator">=</span> KILL_BY_SELF<span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		cur <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//蛇的移动</span>
<span class="token keyword">void</span> <span class="token function">SnakeMove</span><span class="token punctuation">(</span>pSnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//创建下一个节点 </span>
	pSnakeNode pNextNode <span class="token operator">=</span> <span class="token punctuation">(</span>pSnakeNode<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>SnakeNode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pNextNode <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"SnakeMove()::malloc()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//确定下一个节点的坐标，下一个节点的坐标根据，蛇头的坐标和方向确定 </span>
	<span class="token keyword">switch</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>_Dir<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">case</span> UP<span class="token operator">:</span>
		pNextNode<span class="token operator">-&gt;</span>x <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>x<span class="token punctuation">;</span>
		pNextNode<span class="token operator">-&gt;</span>y <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>y <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> DOWN<span class="token operator">:</span>
		pNextNode<span class="token operator">-&gt;</span>x <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>x<span class="token punctuation">;</span>
		pNextNode<span class="token operator">-&gt;</span>y <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>y <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> LEFT<span class="token operator">:</span>
		pNextNode<span class="token operator">-&gt;</span>x <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>x <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span>
		pNextNode<span class="token operator">-&gt;</span>y <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>y<span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> RIGHT<span class="token operator">:</span>
		pNextNode<span class="token operator">-&gt;</span>x <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>x <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
		pNextNode<span class="token operator">-&gt;</span>y <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>_pSnake<span class="token operator">-&gt;</span>y<span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//如果下一个位置就是食物</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">NextIsFood</span><span class="token punctuation">(</span>pNextNode<span class="token punctuation">,</span> ps<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">EatFood</span><span class="token punctuation">(</span>pNextNode<span class="token punctuation">,</span> ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span><span class="token comment">//如果没有食物 </span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">NoFood</span><span class="token punctuation">(</span>pNextNode<span class="token punctuation">,</span> ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">KillByWall</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">KillBySelf</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="_1282"></a>八、控制台设置</h2> 
<p>如果同学Win11系统的控制台窗口是这样显示，可以调整⼀下<br> <img src="https://images2.imgbox.com/37/89/n2a83uZx_o.png" alt="在这里插入图片描述"><br> 调整方式：<br> <img src="https://images2.imgbox.com/58/3c/YKWOs1jy_o.png" alt="在这里插入图片描述"><br> 保存后，重新打开cmd即可</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ecf5256a441fad3c783547f9bb487a40/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">前端Vue3开发工具对比：VSCode，IntelliJ IDEA，WebStorm</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1a61ea08769f87a5829721d486b99de1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Windows 11 安装 安卓子系统 (WSA)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>