<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>湖仓一体架构解析：数仓架构选择（第48天） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/e850e47ebc5b0df06a4e8e674659d1ac/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="湖仓一体架构解析：数仓架构选择（第48天）">
  <meta property="og:description" content="系列文章目录 1、Lambda 架构
2、Kappa 架构
3、混合架构
4、架构选择
5、实时数仓现状
6、湖仓一体架构
7、流批一体架构
文章目录 系列文章目录前言1、Lambda 架构2、Kappa 架构3、混合架构4、架构选择5、实时数仓现状6、湖仓一体架构7、流批一体架构 前言 本文解析了Lambda 架构，Kappa 架构，湖仓一体架构，流批一体架构，以及在大数据场景中，如何选择架构。
1、Lambda 架构 在Lambda架构中，为了计算一些实时指标，就在原来的离线数仓基础之上增加了一个实时处理的链路，并对数据源做流式改造：把消息发送到消息队列中（大数据中常用Kafka），实时计算去消费消息队列中的数据，完成实时指标计算，推送到下游的数据服务中去，由数据服务层完成离线与实时结果的合并。
Lambda架构总结 优点: Lambda架构使开发人员能够构建大规模分布式数据处理系统，它具备很好的灵活性和可扩展性。也对硬件故障和人为失误有很好的容错性 缺点: 1- Lambda架构最大的问题是需要维护两套计算链路，开发和维护成本 2- 计算资源占用增多，服务器存储大 2、Kappa 架构 Kappa 架构可以认为是 Lambda 架构的简化版（只要移除 lambda 架构中的批处理部分即可）。
Kappa架构的核心思想是通过改进流计算系统来解决数据全量处理的问题，使得实时计算和批处理过程使用同一套代码。
Kappa 架构的重新处理过程：
（1）选择一个具有重放功能的、能够保存历史数据并支持多消费者的消息队列，根据需求设置历史数据保存的时长，比如 Kafka，可以保存全部历史数据。
（2）当某个或某些指标有重新处理的需求时，按照新逻辑写一个新作业，然后从上游消息队列的最开始重新消费，把结果写到一个新的下游表中。
（3）当新作业赶上进度后，应用切换结果表，读取 2 中产生的新结果表。
（4）停止老的作业，删除老的结果表。
Kappa架构总结 优点: 使用一条计算链路完成离线计算和实时计算，节约成本 缺点: 1- Kappa架构最大的问题是需要重新处理历史数据，程序处理数据的吞吐量会降低 2- 数据可能丢失 3- 不适用于离线计算和实时计算代码逻辑不一致的情况。举例: 全局去重 4- 消息中间件临时存储的数据量和回溯的数据量有性能瓶颈 5- 无法复用目前已经非常成熟的基于离线计算的数据质量管理体系（数据治理） 3、混合架构 Lambda 架构与 Kappa 架构的对比：
4、架构选择 5、实时数仓现状 总结： 1- Lambda架构的最大缺点是需要维护两条链路，维护和计算成本高 2- Kappa架构最大的缺点是数据处理的吞吐量低 3- Kappa架构可以称之为真正的实时数仓，目前企业中实时数仓最常使用的计算框架Flink 6、湖仓一体架构 湖仓一体架构总结 优点: 1- 可以存储海量数据 2- 可以对中间结果进行查询 3- 可以复用离线计算中形成的数据质量管理体系（数据治理） 4- 数据可以进行update更新操作 缺点： 1- 相对Flink实时数仓来说，数据湖对数据的处理延迟相对比较高。数据的分析查询耗时基本在10秒及以上 2- 如果基于数据湖搭建Lambda架构，这也是相当于需要维护两条线路 7、流批一体架构 理念：使用同一套API、同一套开发范式来实现大数据的流式计算和批量计算，进而保证处理过程和结果数据的一致性。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-28T07:30:00+08:00">
    <meta property="article:modified_time" content="2024-07-28T07:30:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">湖仓一体架构解析：数仓架构选择（第48天）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="_0"></a>系列文章目录</h4> 
<p>1、Lambda 架构<br> 2、Kappa 架构<br> 3、混合架构<br> 4、架构选择<br> 5、实时数仓现状<br> 6、湖仓一体架构<br> 7、流批一体架构</p> 
<hr> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><ul><li><a href="#_0" rel="nofollow">系列文章目录</a></li><li><a href="#_18" rel="nofollow">前言</a></li><li><a href="#1Lambda__22" rel="nofollow">1、Lambda 架构</a></li><li><a href="#2Kappa__40" rel="nofollow">2、Kappa 架构</a></li><li><a href="#3_76" rel="nofollow">3、混合架构</a></li><li><a href="#4_85" rel="nofollow">4、架构选择</a></li><li><a href="#5_89" rel="nofollow">5、实时数仓现状</a></li><li><a href="#6_106" rel="nofollow">6、湖仓一体架构</a></li><li><a href="#7_126" rel="nofollow">7、流批一体架构</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<hr> 
<h4><a id="_18"></a>前言</h4> 
<p>本文解析了Lambda 架构，Kappa 架构，湖仓一体架构，流批一体架构，以及在大数据场景中，如何选择架构。</p> 
<h4><a id="1Lambda__22"></a>1、Lambda 架构</h4> 
<p>在Lambda架构中，为了计算一些实时指标，就在原来的<strong>离线数仓基础之上增加了一个实时处理的链路</strong>，并对数据源做流式改造：把消息发送到消息队列中（大数据中常用Kafka），实时计算去消费消息队列中的数据，完成实时指标计算，推送到下游的数据服务中去，由数据服务层完成离线与实时结果的合并。</p> 
<p><img src="https://images2.imgbox.com/a5/c1/EcWIUYZ6_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-properties">Lambda架构总结
优点: Lambda架构使开发人员能够构建大规模分布式数据处理系统，它具备很好的灵活性和可扩展性。也对硬件故障和人为失误有很好的容错性

缺点:
	1- Lambda架构最大的问题是需要维护两套计算链路，开发和维护成本
	2- 计算资源占用增多，服务器存储大
</code></pre> 
<h4><a id="2Kappa__40"></a>2、Kappa 架构</h4> 
<p>Kappa 架构可以认为是 Lambda 架构的简化版（只要移除 lambda 架构中的批处理部分即可）。</p> 
<p><strong>Kappa架构的核心思想是通过改进流计算系统来解决数据全量处理的问题，使得实时计算和批处理过程使用同一套代码</strong>。</p> 
<p><img src="https://images2.imgbox.com/7c/22/iRdviZEP_o.png" alt="在这里插入图片描述"></p> 
<p><strong>Kappa 架构的重新处理过程：</strong></p> 
<p>（1）选择一个具有重放功能的、能够保存历史数据并支持多消费者的消息队列，根据需求设置历史数据保存的时长，比如 Kafka，可以保存全部历史数据。</p> 
<p>（2）当某个或某些指标有重新处理的需求时，按照新逻辑写一个新作业，然后从上游消息队列的最开始重新消费，把结果写到一个新的下游表中。</p> 
<p>（3）当新作业赶上进度后，应用切换结果表，读取 2 中产生的新结果表。</p> 
<p>（4）停止老的作业，删除老的结果表。</p> 
<p><img src="https://images2.imgbox.com/0a/ea/ccVtYHyF_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-properties">Kappa架构总结
优点: 使用一条计算链路完成离线计算和实时计算，节约成本

缺点:
	1- Kappa架构最大的问题是需要重新处理历史数据，程序处理数据的吞吐量会降低
	2- 数据可能丢失
	3- 不适用于离线计算和实时计算代码逻辑不一致的情况。举例: 全局去重
	4- 消息中间件临时存储的数据量和回溯的数据量有性能瓶颈
	5- 无法复用目前已经非常成熟的基于离线计算的数据质量管理体系（数据治理）
</code></pre> 
<h4><a id="3_76"></a>3、混合架构</h4> 
<p><strong>Lambda 架构与 Kappa 架构的对比：</strong></p> 
<p><img src="https://images2.imgbox.com/c7/e9/XVzUSPuL_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="4_85"></a>4、架构选择</h4> 
<p><img src="https://images2.imgbox.com/58/a4/tydw56l3_o.png" alt=""></p> 
<h4><a id="5_89"></a>5、实时数仓现状</h4> 
<p><img src="https://images2.imgbox.com/9b/92/sDfhG4mJ_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/7d/91/Gdbrai9k_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-properties">总结：
1- Lambda架构的最大缺点是需要维护两条链路，维护和计算成本高
2- Kappa架构最大的缺点是数据处理的吞吐量低
3- Kappa架构可以称之为真正的实时数仓，目前企业中实时数仓最常使用的计算框架Flink
</code></pre> 
<h4><a id="6_106"></a>6、湖仓一体架构</h4> 
<p><img src="https://images2.imgbox.com/ba/39/ItPHhaA3_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-properties">湖仓一体架构总结
优点:
	1- 可以存储海量数据
	2- 可以对中间结果进行查询
	3- 可以复用离线计算中形成的数据质量管理体系（数据治理）
	4- 数据可以进行update更新操作
	
缺点：
	1- 相对Flink实时数仓来说，数据湖对数据的处理延迟相对比较高。数据的分析查询耗时基本在10秒及以上
	2- 如果基于数据湖搭建Lambda架构，这也是相当于需要维护两条线路
</code></pre> 
<h4><a id="7_126"></a>7、流批一体架构</h4> 
<p><img src="https://images2.imgbox.com/a4/ef/nYMjGQ4l_o.png" alt="在这里插入图片描述"></p> 
<p><strong>理念：使用同一套API、同一套开发范式来实现大数据的流式计算和批量计算，进而保证处理过程和结果数据的一致性。</strong></p> 
<ol><li>数据集成流批一体：离线与实时是否使用统一数据采集方式；如统一通过 CDC 或者 OGG 将数据实时捕获推送到 kafka，批与流在从 kafka 中消费数据，载入明细层。</li><li>数据存储流批一体：离线与实时数据是否统一分层、统一存储；兼容数据的一致性和实时性。</li><li>处理逻辑流批一体：流与批处理是否使用统一 SQL 语法或者 ETL 组件，再通过底层分别适配流与批计算引擎，保证数据口径的一致性。</li><li>计算引擎流批一体：流与批使用同一套计算引擎，从根本上避免同一个处理逻辑流批两套代码 问题。</li><li>元数据流批一体：流与批使用同一套元数据管理系统，一方面方便管理，另一方面可以相互访问。</li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/08659d0b24606296a7ab0956b4b314a0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ubuntu2004 android webRTC编译环境搭建</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d9f9f7930b26ab8050f847560eabfcdb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【萌宠案例】</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>