<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Cannot connect to the Docker daemon at unix:///var/run/docker.sock. 问题解决 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/fdb8728a8211a44aca678cdba3ee7ff3/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Cannot connect to the Docker daemon at unix:///var/run/docker.sock. 问题解决">
  <meta property="og:description" content="问题描述 原来我的服务器docker服务运行正常，但在某次尝试用时, 根据系统的错误提示执行了snap install docker指令之后，
再执行docker ps命令则提示Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running? 无法访问docker服务了, 查看状态是正常, 并且重启也没报错, 就是无法通过docker命令操作docker了
网上很多相同的报错, 都是一开始下载的时候才出现问题,
而不是像我这种正常使用后, 因为用了另一种方式安装docker导致原来的服务无法被访问到
因此解决的方式会和别的不太一样
问题分析 执行 snap install docker 后，你实际上通过 Snap 安装了 Docker 的另一个实例，
这个实例可能与系统中原有的 Docker 实例（可能是通过包管理器如 apt, yum, dnf 等安装的）发生冲突。
这通常会导致 /var/run/docker.sock 文件被新的 Docker 实例使用，或者原有的 Docker 服务被停止。
解决步骤 要解决这个问题，需要有以下几个步骤：
1. 停止并卸载通过 Snap 安装的 Docker 首先，尝试停止并卸载通过 Snap 安装的 Docker：
sudo snap stop docker sudo snap remove docker 2.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-14T08:32:00+08:00">
    <meta property="article:modified_time" content="2024-08-14T08:32:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Cannot connect to the Docker daemon at unix:///var/run/docker.sock. 问题解决</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_1"></a>问题描述</h3> 
<blockquote> 
 <p>原来我的服务器docker服务运行正常，但在某次尝试用时, 根据系统的错误提示执行了<code>snap install docker</code>指令之后，<br> 再执行<code>docker ps</code>命令则提示<code>Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?</code> 无法访问docker服务了, 查看状态是正常, 并且重启也没报错, 就是无法通过docker命令操作docker了</p> 
</blockquote> 
<blockquote> 
 <p><strong>网上很多相同的报错, 都是一开始下载的时候才出现问题,<br> 而不是像我这种正常使用后, 因为用了另一种方式安装docker导致原来的服务无法被访问到</strong><br> 因此解决的方式会和别的不太一样</p> 
</blockquote> 
<h3><a id="_9"></a>问题分析</h3> 
<blockquote> 
 <p>执行 <code>snap install docker</code> 后，你实际上通过 Snap 安装了 Docker 的另一个实例，<br> 这个实例可能与系统中原有的 Docker 实例（可能是通过包管理器如 apt, yum, dnf 等安装的）发生冲突。<br> 这通常会导致 <code>/var/run/docker.sock</code> 文件被新的 Docker 实例使用，或者原有的 Docker 服务被停止。</p> 
</blockquote> 
<h3><a id="_15"></a>解决步骤</h3> 
<blockquote> 
 <p>要解决这个问题，需要有以下几个步骤：</p> 
</blockquote> 
<h4><a id="1__Snap__Docker_18"></a>1. 停止并卸载通过 Snap 安装的 Docker</h4> 
<p>首先，尝试停止并卸载通过 Snap 安装的 Docker：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> snap stop <span class="token function">docker</span>
<span class="token function">sudo</span> snap remove <span class="token function">docker</span>
</code></pre> 
<h4><a id="2__Docker__27"></a>2. 确认原有的 Docker 是否正在运行</h4> 
<p>卸载 Snap 版本的 Docker 后，检查原有的 Docker 是否正在运行：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> systemctl status <span class="token function">docker</span>  <span class="token comment"># 对于使用 systemd 的系统</span>
<span class="token comment"># 或者</span>
<span class="token function">sudo</span> <span class="token function">service</span> <span class="token function">docker</span> status    <span class="token comment"># 对于较旧的系统</span>
</code></pre> 
<p>如果 Docker 没有运行，尝试启动它：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> systemctl start <span class="token function">docker</span>  <span class="token comment"># 对于使用 systemd 的系统</span>
<span class="token comment"># 或者</span>
<span class="token function">sudo</span> <span class="token function">service</span> <span class="token function">docker</span> start    <span class="token comment"># 对于较旧的系统</span>
</code></pre> 
<h4><a id="3__varrundockersock_45"></a>3. 检查 <code>/var/run/docker.sock</code></h4> 
<p>确认 <code>/var/run/docker.sock</code> 文件存在并且 Docker 用户（通常是 <code>docker</code> 用户组）有权访问它。<br> 你可以使用 <code>ls -l /var/run/docker.sock</code> 来查看文件权限。</p> 
<h4><a id="4__docker__53"></a>4. 将你的用户添加到 docker 组（如果尚未添加）</h4> 
<p>如果你之前没有将你的用户添加到 <code>docker</code> 组，你需要这样做以确保你的用户可以无需 sudo 就能运行 Docker 命令：</p> 
<pre><code class="prism language-bash"><span class="token comment"># 直接执行,无需修改</span>
<span class="token function">sudo</span> <span class="token function">usermod</span> <span class="token parameter variable">-aG</span> <span class="token function">docker</span> <span class="token environment constant">$USER</span>
</code></pre> 
<h4><a id="5__62"></a>5. 重启你的机器</h4> 
<p>有时候，重启你的机器可以解决由于服务冲突或状态不一致引起的问题。<code>reboot</code></p> 
<h4><a id="6__Docker__66"></a>6. 检查 Docker 守护进程的日志</h4> 
<p>如果 Docker 仍然无法启动，查看 Docker 守护进程的日志可能会提供有用的信息：</p> 
<pre><code class="prism language-bash">journalctl <span class="token parameter variable">-u</span> docker.service  <span class="token comment"># 对于使用 systemd 的系统</span>
<span class="token comment"># 或者查看 /var/log/docker.log 或使用 dmesg（如果相关日志被记录在那里）</span>
</code></pre> 
<h4><a id="7_docker_ps_75"></a>7. docker ps查看是否恢复成功</h4> 
<p><img src="https://images2.imgbox.com/2f/5f/u01AAzNB_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<p>至此我的问题解决完成, 如果执行到此步骤你还没有成功, 建议查看下面推荐的其他文章, 或者卸载重装</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fb6c6b2a573686b736fe36a4033e7db2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">API-System</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/10e86705c5cdd9c0fdad33ad3cdcb9ff/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">新形势下职业教育云计算人才培养策略</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>