<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>git提交错了？别慌，直接删除提交记录 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/bf681969dedfd7f812a960c2c7cbc5c9/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="git提交错了？别慌，直接删除提交记录">
  <meta property="og:description" content="为什么要删除提交历史 前几天产品提了个很扯淡的需求，我在代码了进行了吐槽....
要命的是我不下心进行了代码提交：
我们的远程仓库大家都能看见的
这要是被其他人发现就惨了！当务之急，我必须立刻马上删除这一条提交记录！！
于是，我打开百度，搜索到两个救命关键词：git revert和git reset！这两个命令都有撤销操作的功能！
使用git revert撤销提交 revert的英文释义是回复、恢复（到原来的状态）
作用 git revert 是 Git 中用于撤销一个或多个提交的命令，但是会保留历史记录。它创建一个新的提交，该提交是对原提交的相反操作，以撤销原提交的更改。通过 git revert 撤销提交，可以保持历史记录的完整性，不会修改已经共享的提交历史。
语法 撤销单个提交：
git revert &lt;commit-hash&gt; 这会创建一个新的提交，用于撤销指定的提交 的更改。
撤销多个提交：
git revert &lt;commit-hash1&gt; &lt;commit-hash2&gt; ... 这会为每个指定的提交创建一个新的撤销提交。
撤销最近的提交：
git revert HEAD 撤销某个范围内的提交：
git revert &lt;commit-hash1&gt;^..&lt;commit-hash2&gt; 这会撤销从 （不包括）到 （包括）范围内的所有提交。
撤销提交时，Git 会打开一个文本编辑器，让你输入撤销提交的信息。你可以修改默认的提交信息，然后保存并关闭编辑器。
撤销实操 不管3721，我们先试着用它撤销下提交试试。
先试用git log（其他可视化面板也行）找到要撤销的commit哈希码
b1b56b50a0859556623283946972e495d4a42fc1 然后，执行单个文件撤销命令
git revert b1b56b50a0859556623283946972e495d4a42fc1 执行命令后，控制台会出现vim编辑器，让我们为本次更改提交说明
vim编辑器小技巧
进入编辑模式：进入编辑模式的方式取决于当前编辑器的模式。通常情况下，按下 i 键可以进入插入模式，允许你编辑文本。
编辑文本：在插入模式下，你可以编辑文本。使用方向键或者 h, j, k, l 键移动光标。
退出编辑模式：编辑完成后，按下 Esc 键退出插入模式。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-02T11:11:59+08:00">
    <meta property="article:modified_time" content="2024-05-02T11:11:59+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">git提交错了？别慌，直接删除提交记录</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3><br> 为什么要删除提交历史</h3> 
<p>前几天产品提了个很扯淡的需求，我在代码了进行了吐槽....</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="171" src="https://images2.imgbox.com/78/de/2L0Pyzh4_o.png" width="477"></p> 
<p>要命的是我不下心进行了代码提交：</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="161" src="https://images2.imgbox.com/69/c7/EtKL4RE1_o.png" width="561"></p> 
<p>我们的远程仓库大家都能看见的</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="194" src="https://images2.imgbox.com/3d/18/K95KaZ7D_o.png" width="350"></p> 
<p>这要是被其他人发现就惨了！当务之急，我必须立刻马上<strong>删除</strong>这一条提交记录！！</p> 
<p>于是，我打开百度，搜索到两个救命关键词：<strong>git revert</strong>和<strong>git reset</strong>！这两个命令都有撤销操作的功能！</p> 
<h3>使用git revert撤销提交</h3> 
<p>revert的英文释义是回复、恢复（到原来的状态）</p> 
<h6>作用</h6> 
<p>git revert 是 Git 中用于撤销一个或多个提交的命令，但是会保留历史记录。它创建一个新的提交，该提交是对原提交的相反操作，以撤销原提交的更改。通过 git revert 撤销提交，可以保持历史记录的完整性，不会修改已经共享的提交历史。</p> 
<h6>语法</h6> 
<p>撤销单个提交：</p> 
<pre><code>git revert &lt;commit-hash&gt;
</code></pre> 
<p>这会创建一个新的提交，用于撤销指定的提交  的更改。</p> 
<p>撤销多个提交：</p> 
<pre><code>git revert &lt;commit-hash1&gt; &lt;commit-hash2&gt; ...
</code></pre> 
<p>这会为每个指定的提交创建一个新的撤销提交。</p> 
<p>撤销最近的提交：</p> 
<pre><code>git revert HEAD
</code></pre> 
<p>撤销某个范围内的提交：</p> 
<pre><code>git revert &lt;commit-hash1&gt;^..&lt;commit-hash2&gt;
</code></pre> 
<p>这会撤销从 （不包括）到 （包括）范围内的所有提交。</p> 
<p>撤销提交时，Git 会打开一个文本编辑器，让你输入撤销提交的信息。你可以修改默认的提交信息，然后保存并关闭编辑器。</p> 
<h6>撤销实操</h6> 
<p>不管3721，我们先试着用它撤销下提交试试。</p> 
<p>先试用git log（其他可视化面板也行）找到要撤销的commit哈希码</p> 
<pre><code>b1b56b50a0859556623283946972e495d4a42fc1
</code></pre> 
<p></p> 
<p class="img-center"><img alt="图片" height="291" src="https://images2.imgbox.com/00/6b/6DdhwioN_o.jpg" width="1080"></p> 
<p>然后，执行单个文件撤销命令</p> 
<pre><code>git revert b1b56b50a0859556623283946972e495d4a42fc1
</code></pre> 
<p>执行命令后，控制台会出现vim编辑器，让我们为本次更改提交说明</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="201" src="https://images2.imgbox.com/a2/9b/JdU2SkMm_o.png" width="491"></p> 
<blockquote> 
 <p>vim编辑器小技巧</p> 
 <ul><li> <p>进入编辑模式：进入编辑模式的方式取决于当前编辑器的模式。通常情况下，按下 i 键可以进入插入模式，允许你编辑文本。</p> </li><li> <p>编辑文本：在插入模式下，你可以编辑文本。使用方向键或者 h, j, k, l 键移动光标。</p> </li><li> <p>退出编辑模式：编辑完成后，按下 Esc 键退出插入模式。</p> </li><li> <p>保存并退出：在退出编辑模式后，输入 :wq 并按下 Enter 键，可以保存并退出编辑器。</p> </li><li> <p>放弃更改并退出：在退出编辑模式后，输入 :q! 并按下 Enter 键，可以放弃更改并退出编辑器。</p> </li></ul> 
</blockquote> 
<p>我们点击i输入提交说明【删除错误提交】，然后点击ESC退出编辑模式，最后输入:wq保存并退出。</p> 
<p>退出vim编辑器后，直接输入<strong>git push</strong>推送代码！</p> 
<p>我们来看看效果：</p> 
<p>代码里上次提交的内容确实没了！</p> 
<p>第一次错误提交时的代码内容</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="166" src="https://images2.imgbox.com/b3/e3/CZBxET8s_o.png" width="468"></p> 
<p>revert后的代码内容</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="201" src="https://images2.imgbox.com/ca/a5/OzBlaWsq_o.png" width="551"></p> 
<p>但是，git的推送历史上有啊！！</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="173" src="https://images2.imgbox.com/3c/8f/dU8rxlcM_o.png" width="462"></p> 
<p>这下我算明白了git revert的作用了：用于撤销一个或多个提交的命令，但是会<strong>保留历史记录</strong>！</p> 
<p>这显然不是我的意图，我想做的是删除git提交历史！删除！不保留任何痕迹呢种！只能试试git reset了！</p> 
<h3>使用git reset撤销提交</h3> 
<p>凭借我初中毕业的水平，我一眼就明白了reset的含义：重置！现在，我们先看看<code>git reset</code>的作用。</p> 
<h6>作用</h6> 
<p><code>git reset</code> 用于移动 HEAD 指针并可选地更改暂存区和工作目录的状态。它是一个非常强大的工具，常用于撤销提交、取消暂存文件、修改提交内容等操作。</p> 
<h6>语法</h6> 
<p><strong>撤销提交，保留修改</strong></p> 
<pre><code>git reset --soft HEAD~1
</code></pre> 
<p>这会将 HEAD 指向的分支的最新提交撤销掉，并保留所有更改在工作目录中。这样你就可以重新提交，并修改提交信息。</p> 
<p><strong>撤销提交，取消暂存的文件</strong></p> 
<pre><code>git reset HEAD~1
</code></pre> 
<p>这会将 HEAD 指向的分支的最新提交撤销掉，并将暂存区的文件取消暂存，但保留在工作目录中。这样你可以重新选择要暂存的文件。</p> 
<p><strong>撤销提交，丢弃修改</strong></p> 
<pre><code>git reset --hard HEAD~1
</code></pre> 
<p>这会将 HEAD 指向的分支的最新提交撤销掉，并丢弃所有更改，包括暂存区和工作目录中的文件。这样你就可以完全回到上一个提交的状态。</p> 
<p><strong>将 HEAD 指针移动到指定的提交</strong></p> 
<pre><code>git reset --hard &lt;commit-hash&gt;
</code></pre> 
<p>这会将 HEAD 指针移动到指定的提交，并丢弃所有更改。这可以用来回滚到历史提交状态</p> 
<h6>撤销实操</h6> 
<p>由于本地没有其他修改，暂存区也没有文件，因此，使用</p> 
<pre><code>git reset HEAD~1
</code></pre> 
<p>但是，我们刚才的误操作，导致有两条不应该出现的操作记录</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="174" src="https://images2.imgbox.com/d1/db/iaMf9RZ3_o.png" width="567"></p> 
<p>所以，我们HEAD指针应该向下移动2个</p> 
<pre><code>git reset HEAD~2
</code></pre> 
<p>命令行输入后，我们就会发现本地代码已经恢复到没有提交这两个记录前的状态了！</p> 
<p>但云端的记录还在</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="210" src="https://images2.imgbox.com/20/0b/7kbAMdwf_o.png" width="488"></p> 
<p>那如何删除云端的记录呢？很简单，将本地仓库的代码强推到远端仓库覆盖掉就行！（本地仓库已经是未提交两个错误信息时的状态了）</p> 
<p>最后，我们使用下面的命令将本地代码强行覆盖云端</p> 
<pre><code>git push --force
</code></pre> 
<p>执行完后，就是见证奇迹的时刻</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="244" src="https://images2.imgbox.com/17/71/kBog3sB5_o.png" width="471"></p> 
<p>再看看git上</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="210" src="https://images2.imgbox.com/fb/fe/ujmIafnI_o.png" width="471"></p> 
<p>也没有，nice！！</p> 
<h6>重要提示</h6> 
<p>使用 <strong>--force</strong> 选项将覆盖远程仓库的提交历史，这意味着远程仓库的历史将会变为你本地仓库的历史。这是非常<strong>危险</strong>的操作！！一定要确保本地代码和远程代码是相关的！！<code>一定要谨慎操作</code>！！</p> 
<p>注git push --force是下面命令的简写</p> 
<pre><code>git push origin &lt;branch-name&gt; --force
</code></pre> 
<blockquote> 
 <p>git push origin  --force 命令用于将本地分支推送到远程仓库，并且使用 --force 选项强制覆盖远程仓库中的提交历史。</p> 
 <ul><li> <p>git push: 将本地分支的提交推送到远程仓库。</p> </li><li> <p>origin: 指定远程仓库的别名。通常指向你克隆或者添加远程仓库时所使用的 URL。</p> </li><li> <p>: 要推送的本地分支的名称。</p> </li><li> <p>--force (或 -f): 强制推送选项。这会覆盖远程仓库的提交历史，即使本地分支的提交历史不是远程分支的子集也会强制推送。</p> </li></ul> 
</blockquote> 
<h3>总结</h3> 
<p><code>git reset</code> 用于移动分支的指针，可以修改提交历史，但不会创建新的提交；而 <code>git revert</code> 用于撤销先前的提交，并创建一个新的提交来保持提交历史的完整性。</p> 
<p>通过本实例，你一定学会了使用<code>git reset</code> 加 <code>git push --force</code>的方法删除远程仓库的错误提交历史！如果有收获，记得收藏点赞哈~</p> 
<p>最后说一句(求关注!别白嫖！)</p> 
<p>如果这篇文章对您有所帮助，或者有所启发的话，求一键三连：点赞、转发、在看。</p> 
<p>关注公众号：<strong>woniuxgg</strong>，在公众号中回复：笔记  就可以获得蜗牛为你精心准备的java实战语雀笔记，回复面试、开发手册、有超赞的粉丝福利！</p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/12a3a81baa52ab31098af99091124a85/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">智能消费记账|基于SSM&#43;vue的大学生智能消费记账系统(源码&#43;数据库&#43;文档)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b52bb1cc65cbd23483c815d7eee507b9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">spring Ai框架整合Ollama，调用本地大模型</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>