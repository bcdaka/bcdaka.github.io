<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>JUC åŒ…ä¸­çš„ Atomic åŸå­ç±»æ€»ç»“ - ç¼–ç¨‹å¤§å’–</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/66b15c9dd15e6851e6855d4f65736b7f/">
  <meta property="og:site_name" content="ç¼–ç¨‹å¤§å’–">
  <meta property="og:title" content="JUC åŒ…ä¸­çš„ Atomic åŸå­ç±»æ€»ç»“">
  <meta property="og:description" content="äººä¸èµ°ç©º ğŸŒˆä¸ªäººä¸»é¡µï¼šäººä¸èµ°ç©ºÂ ğŸ’–ç³»åˆ—ä¸“æ ï¼šç®—æ³•ä¸“é¢˜ â°è¯—è¯æ­Œèµ‹ï¼šæ–¯æ˜¯é™‹å®¤ï¼ŒæƒŸå¾å¾·é¦¨ ç›®å½•
ğŸŒˆä¸ªäººä¸»é¡µï¼šäººä¸èµ°ç©ºÂ ğŸ’–ç³»åˆ—ä¸“æ ï¼šç®—æ³•ä¸“é¢˜
â°è¯—è¯æ­Œèµ‹ï¼šæ–¯æ˜¯é™‹å®¤ï¼ŒæƒŸå¾å¾·é¦¨
Atomic åŸå­ç±»ä»‹ç»
åŸºæœ¬ç±»å‹åŸå­ç±»
æ•°ç»„ç±»å‹åŸå­ç±»
å¼•ç”¨ç±»å‹åŸå­ç±»
å¯¹è±¡çš„å±æ€§ä¿®æ”¹ç±»å‹åŸå­ç±»
ä½œè€…å…¶ä»–ä½œå“ï¼š
JavaGuideå®˜æ–¹ç½‘ç«™ï¼šjavaguide.cn
Atomic åŸå­ç±»ä»‹ç» AtomicÂ ç¿»è¯‘æˆä¸­æ–‡æ˜¯â€œåŸå­â€çš„æ„æ€ã€‚åœ¨åŒ–å­¦ä¸Šï¼ŒåŸå­æ˜¯æ„æˆç‰©è´¨çš„æœ€å°å•ä½ï¼Œåœ¨åŒ–å­¦ååº”ä¸­ä¸å¯åˆ†å‰²ã€‚åœ¨ç¼–ç¨‹ä¸­ï¼ŒAtomicÂ æŒ‡çš„æ˜¯ä¸€ä¸ªæ“ä½œå…·æœ‰åŸå­æ€§ï¼Œå³è¯¥æ“ä½œä¸å¯åˆ†å‰²ã€ä¸å¯ä¸­æ–­ã€‚å³ä½¿åœ¨å¤šä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œæ—¶ï¼Œè¯¥æ“ä½œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œå®Œæˆï¼Œè¦ä¹ˆä¸æ‰§è¡Œï¼Œä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹çœ‹åˆ°éƒ¨åˆ†å®Œæˆçš„çŠ¶æ€ã€‚
åŸå­ç±»ç®€å•æ¥è¯´å°±æ˜¯å…·æœ‰åŸå­æ€§æ“ä½œç‰¹å¾çš„ç±»ã€‚
java.util.concurrent.atomicÂ åŒ…ä¸­çš„Â AtomicÂ åŸå­ç±»æä¾›äº†ä¸€ç§çº¿ç¨‹å®‰å…¨çš„æ–¹å¼æ¥æ“ä½œå•ä¸ªå˜é‡ã€‚
AtomicÂ ç±»ä¾èµ–äº CASï¼ˆCompare-And-Swapï¼Œæ¯”è¾ƒå¹¶äº¤æ¢ï¼‰ä¹è§‚é”æ¥ä¿è¯å…¶æ–¹æ³•çš„åŸå­æ€§ï¼Œè€Œä¸éœ€è¦ä½¿ç”¨ä¼ ç»Ÿçš„é”æœºåˆ¶ï¼ˆå¦‚Â synchronizedÂ å—æˆ–Â ReentrantLockï¼‰ã€‚
è¿™ç¯‡æ–‡ç« æˆ‘ä»¬åªä»‹ç» Atomic åŸå­ç±»çš„æ¦‚å¿µï¼Œå…·ä½“å®ç°åŸç†å¯ä»¥é˜…è¯»ç¬”è€…å†™çš„è¿™ç¯‡æ–‡ç« ï¼šä»€ä¹ˆæ˜¯ä¹è§‚é”å’Œæ‚²è§‚é”ï¼ŸJava ä¸­ CAS æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿã€‚
JUCåŸå­ç±»æ¦‚è§ˆ
æ ¹æ®æ“ä½œçš„æ•°æ®ç±»å‹ï¼Œå¯ä»¥å°† JUC åŒ…ä¸­çš„åŸå­ç±»åˆ†ä¸º 4 ç±»ï¼š
1ã€åŸºæœ¬ç±»å‹
ä½¿ç”¨åŸå­çš„æ–¹å¼æ›´æ–°åŸºæœ¬ç±»å‹
AtomicIntegerï¼šæ•´å‹åŸå­ç±»
AtomicLongï¼šé•¿æ•´å‹åŸå­ç±»
AtomicBooleanï¼šå¸ƒå°”å‹åŸå­ç±»
2ã€æ•°ç»„ç±»å‹
ä½¿ç”¨åŸå­çš„æ–¹å¼æ›´æ–°æ•°ç»„é‡Œçš„æŸä¸ªå…ƒç´ 
AtomicIntegerArrayï¼šæ•´å‹æ•°ç»„åŸå­ç±»
AtomicLongArrayï¼šé•¿æ•´å‹æ•°ç»„åŸå­ç±»
AtomicReferenceArrayï¼šå¼•ç”¨ç±»å‹æ•°ç»„åŸå­ç±»
3ã€å¼•ç”¨ç±»å‹
AtomicReferenceï¼šå¼•ç”¨ç±»å‹åŸå­ç±»
AtomicMarkableReferenceï¼šåŸå­æ›´æ–°å¸¦æœ‰æ ‡è®°çš„å¼•ç”¨ç±»å‹ã€‚è¯¥ç±»å°†Â booleanÂ æ ‡è®°ä¸å¼•ç”¨å…³è”èµ·æ¥ï¼Œä¹Ÿå¯ä»¥è§£å†³ä½¿ç”¨ CAS è¿›è¡ŒåŸå­æ›´æ–°æ—¶å¯èƒ½å‡ºç°çš„ ABA é—®é¢˜ã€‚
AtomicStampedReferenceï¼šåŸå­æ›´æ–°å¸¦æœ‰ç‰ˆæœ¬å·çš„å¼•ç”¨ç±»å‹ã€‚è¯¥ç±»å°†æ•´æ•°å€¼ä¸å¼•ç”¨å…³è”èµ·æ¥ï¼Œå¯ç”¨äºè§£å†³åŸå­çš„æ›´æ–°æ•°æ®å’Œæ•°æ®çš„ç‰ˆæœ¬å·ï¼Œå¯ä»¥è§£å†³ä½¿ç”¨ CAS è¿›è¡ŒåŸå­æ›´æ–°æ—¶å¯èƒ½å‡ºç°çš„ ABA é—®é¢˜ã€‚
ğŸ› ä¿®æ­£ï¼ˆå‚è§ï¼šissue#626ï¼šhttps://github.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-17T21:51:53+08:00">
    <meta property="article:modified_time" content="2024-07-17T21:51:53+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§å’–" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§å’–</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">JUC åŒ…ä¸­çš„ Atomic åŸå­ç±»æ€»ç»“</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p></p> 
<div style="text-align:center;"> 
 <figure class="image"> 
  <img alt="" src="https://images2.imgbox.com/f9/f5/csXcZ8wm_o.png"> 
  <figcaption> 
   <strong>äººä¸èµ°ç©º</strong> 
  </figcaption> 
 </figure> 
</div> 
<p></p> 
<p>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â </p> 
<h3 id="%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%F0%9F%8C%88%E4%B8%AA%E4%BA%BA%E4%B8%BB%E9%A1%B5%EF%BC%9A%E4%BA%BA%E4%B8%8D%E8%B5%B0%E7%A9%BA%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0" style="text-align:center;">Â Â Â Â Â Â ğŸŒˆ<strong>ä¸ªäººä¸»é¡µï¼š<strong><a href="https://blog.csdn.net/double222222?type=blog" title="äººä¸èµ°ç©º">äººä¸èµ°ç©º</a></strong></strong><strong>Â Â Â Â Â Â </strong></h3> 
<h3 id="%F0%9F%92%96%E7%B3%BB%E5%88%97%E4%B8%93%E6%A0%8F%EF%BC%9A%E7%AE%97%E6%B3%95%E4%B8%93%E9%A2%98" style="text-align:center;"><strong>ğŸ’–ç³»åˆ—ä¸“æ ï¼š<strong><a href="https://blog.csdn.net/double222222/category_12487653.html?spm=1001.2014.3001.5482" title="ç®—æ³•ä¸“é¢˜">ç®—æ³•ä¸“é¢˜</a></strong></strong></h3> 
<h3 id="%E2%8F%B0%E8%AF%97%E8%AF%8D%E6%AD%8C%E8%B5%8B%EF%BC%9A%E6%96%AF%E6%98%AF%E9%99%8B%E5%AE%A4%EF%BC%8C%E6%83%9F%E5%90%BE%E5%BE%B7%E9%A6%A8" style="text-align:center;"><strong>â°è¯—è¯æ­Œèµ‹ï¼š</strong>æ–¯æ˜¯é™‹å®¤ï¼ŒæƒŸå¾å¾·é¦¨</h3> 
<p></p> 
<p><img alt="" height="92" src="https://images2.imgbox.com/04/bf/AJXfuFmp_o.gif" width="733"></p> 
<p id="main-toc"><strong>ç›®å½•</strong></p> 
<p id="%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%F0%9F%8C%88%E4%B8%AA%E4%BA%BA%E4%B8%BB%E9%A1%B5%EF%BC%9A%E4%BA%BA%E4%B8%8D%E8%B5%B0%E7%A9%BA%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-toc" style="margin-left:40px;"><a href="#%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%F0%9F%8C%88%E4%B8%AA%E4%BA%BA%E4%B8%BB%E9%A1%B5%EF%BC%9A%E4%BA%BA%E4%B8%8D%E8%B5%B0%E7%A9%BA%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0" rel="nofollow">Â Â Â Â Â Â ğŸŒˆä¸ªäººä¸»é¡µï¼šäººä¸èµ°ç©ºÂ Â Â Â Â Â </a></p> 
<p id="%F0%9F%92%96%E7%B3%BB%E5%88%97%E4%B8%93%E6%A0%8F%EF%BC%9A%E7%AE%97%E6%B3%95%E4%B8%93%E9%A2%98-toc" style="margin-left:40px;"><a href="#%F0%9F%92%96%E7%B3%BB%E5%88%97%E4%B8%93%E6%A0%8F%EF%BC%9A%E7%AE%97%E6%B3%95%E4%B8%93%E9%A2%98" rel="nofollow">ğŸ’–ç³»åˆ—ä¸“æ ï¼šç®—æ³•ä¸“é¢˜</a></p> 
<p id="%E2%8F%B0%E8%AF%97%E8%AF%8D%E6%AD%8C%E8%B5%8B%EF%BC%9A%E6%96%AF%E6%98%AF%E9%99%8B%E5%AE%A4%EF%BC%8C%E6%83%9F%E5%90%BE%E5%BE%B7%E9%A6%A8-toc" style="margin-left:40px;"><a href="#%E2%8F%B0%E8%AF%97%E8%AF%8D%E6%AD%8C%E8%B5%8B%EF%BC%9A%E6%96%AF%E6%98%AF%E9%99%8B%E5%AE%A4%EF%BC%8C%E6%83%9F%E5%90%BE%E5%BE%B7%E9%A6%A8" rel="nofollow">â°è¯—è¯æ­Œèµ‹ï¼šæ–¯æ˜¯é™‹å®¤ï¼ŒæƒŸå¾å¾·é¦¨</a></p> 
<p id="-toc" style="margin-left:40px;"></p> 
<p id="Atomic%20%E5%8E%9F%E5%AD%90%E7%B1%BB%E4%BB%8B%E7%BB%8D-toc" style="margin-left:40px;"><a href="#Atomic%20%E5%8E%9F%E5%AD%90%E7%B1%BB%E4%BB%8B%E7%BB%8D" rel="nofollow">Atomic åŸå­ç±»ä»‹ç»</a></p> 
<p id="%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B%E5%8E%9F%E5%AD%90%E7%B1%BB-toc" style="margin-left:40px;"><a href="#%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B%E5%8E%9F%E5%AD%90%E7%B1%BB" rel="nofollow">åŸºæœ¬ç±»å‹åŸå­ç±»</a></p> 
<p id="%E6%95%B0%E7%BB%84%E7%B1%BB%E5%9E%8B%E5%8E%9F%E5%AD%90%E7%B1%BB-toc" style="margin-left:40px;"><a href="#%E6%95%B0%E7%BB%84%E7%B1%BB%E5%9E%8B%E5%8E%9F%E5%AD%90%E7%B1%BB" rel="nofollow">æ•°ç»„ç±»å‹åŸå­ç±»</a></p> 
<p id="%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B%E5%8E%9F%E5%AD%90%E7%B1%BB-toc" style="margin-left:40px;"><a href="#%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B%E5%8E%9F%E5%AD%90%E7%B1%BB" rel="nofollow">å¼•ç”¨ç±»å‹åŸå­ç±»</a></p> 
<p id="%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%B1%9E%E6%80%A7%E4%BF%AE%E6%94%B9%E7%B1%BB%E5%9E%8B%E5%8E%9F%E5%AD%90%E7%B1%BB-toc" style="margin-left:40px;"><a href="#%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%B1%9E%E6%80%A7%E4%BF%AE%E6%94%B9%E7%B1%BB%E5%9E%8B%E5%8E%9F%E5%AD%90%E7%B1%BB" rel="nofollow">å¯¹è±¡çš„å±æ€§ä¿®æ”¹ç±»å‹åŸå­ç±»</a></p> 
<p id="%E4%BD%9C%E8%80%85%E5%85%B6%E4%BB%96%E4%BD%9C%E5%93%81%EF%BC%9A-toc" style="margin-left:0px;"><a href="#%E4%BD%9C%E8%80%85%E5%85%B6%E4%BB%96%E4%BD%9C%E5%93%81%EF%BC%9A" rel="nofollow">ä½œè€…å…¶ä»–ä½œå“ï¼š</a></p> 
<hr id="hr-toc"> 
<p></p> 
<p>Â </p> 
<p></p> 
<p class="img-center"><img alt="å›¾ç‰‡" height="579" src="https://images2.imgbox.com/38/d9/8cc3KrtZ_o.png" width="1080"></p> 
<p><strong>JavaGuideå®˜æ–¹ç½‘ç«™</strong>ï¼š<strong>javaguide.cn</strong></p> 
<h3></h3> 
<h3 id="Atomic%20%E5%8E%9F%E5%AD%90%E7%B1%BB%E4%BB%8B%E7%BB%8D">Atomic åŸå­ç±»ä»‹ç»</h3> 
<p><code>Atomic</code>Â ç¿»è¯‘æˆä¸­æ–‡æ˜¯â€œåŸå­â€çš„æ„æ€ã€‚åœ¨åŒ–å­¦ä¸Šï¼ŒåŸå­æ˜¯æ„æˆç‰©è´¨çš„æœ€å°å•ä½ï¼Œåœ¨åŒ–å­¦ååº”ä¸­ä¸å¯åˆ†å‰²ã€‚åœ¨ç¼–ç¨‹ä¸­ï¼Œ<code>Atomic</code>Â æŒ‡çš„æ˜¯ä¸€ä¸ªæ“ä½œå…·æœ‰åŸå­æ€§ï¼Œå³è¯¥æ“ä½œä¸å¯åˆ†å‰²ã€ä¸å¯ä¸­æ–­ã€‚å³ä½¿åœ¨å¤šä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œæ—¶ï¼Œè¯¥æ“ä½œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œå®Œæˆï¼Œè¦ä¹ˆä¸æ‰§è¡Œï¼Œä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹çœ‹åˆ°éƒ¨åˆ†å®Œæˆçš„çŠ¶æ€ã€‚</p> 
<p>åŸå­ç±»ç®€å•æ¥è¯´å°±æ˜¯å…·æœ‰åŸå­æ€§æ“ä½œç‰¹å¾çš„ç±»ã€‚</p> 
<p><code>java.util.concurrent.atomic</code>Â åŒ…ä¸­çš„Â <code>Atomic</code>Â åŸå­ç±»æä¾›äº†ä¸€ç§çº¿ç¨‹å®‰å…¨çš„æ–¹å¼æ¥æ“ä½œå•ä¸ªå˜é‡ã€‚</p> 
<p><code>Atomic</code>Â ç±»ä¾èµ–äº CASï¼ˆCompare-And-Swapï¼Œæ¯”è¾ƒå¹¶äº¤æ¢ï¼‰ä¹è§‚é”æ¥ä¿è¯å…¶æ–¹æ³•çš„åŸå­æ€§ï¼Œè€Œä¸éœ€è¦ä½¿ç”¨ä¼ ç»Ÿçš„é”æœºåˆ¶ï¼ˆå¦‚Â <code>synchronized</code>Â å—æˆ–Â <code>ReentrantLock</code>ï¼‰ã€‚</p> 
<p>è¿™ç¯‡æ–‡ç« æˆ‘ä»¬åªä»‹ç» Atomic åŸå­ç±»çš„æ¦‚å¿µï¼Œå…·ä½“å®ç°åŸç†å¯ä»¥é˜…è¯»ç¬”è€…å†™çš„è¿™ç¯‡æ–‡ç« ï¼š<a href="https://mp.weixin.qq.com/s?__biz=Mzg2OTA0Njk0OA==&amp;mid=2247544503&amp;idx=1&amp;sn=949c4e8cf2a1d23cf85af413e1ba6498&amp;scene=21#wechat_redirect" rel="nofollow" title="ä»€ä¹ˆæ˜¯ä¹è§‚é”å’Œæ‚²è§‚é”ï¼ŸJava ä¸­ CAS æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ">ä»€ä¹ˆæ˜¯ä¹è§‚é”å’Œæ‚²è§‚é”ï¼ŸJava ä¸­ CAS æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</a>ã€‚</p> 
<p></p> 
<p class="img-center"><img alt="å›¾ç‰‡" height="367" src="https://images2.imgbox.com/25/41/dErXtwR3_o.png" width="317"></p> 
<p>JUCåŸå­ç±»æ¦‚è§ˆ</p> 
<p>æ ¹æ®æ“ä½œçš„æ•°æ®ç±»å‹ï¼Œå¯ä»¥å°† JUC åŒ…ä¸­çš„åŸå­ç±»åˆ†ä¸º 4 ç±»ï¼š</p> 
<p><strong>1ã€åŸºæœ¬ç±»å‹</strong></p> 
<p>ä½¿ç”¨åŸå­çš„æ–¹å¼æ›´æ–°åŸºæœ¬ç±»å‹</p> 
<ul><li> <p><code>AtomicInteger</code>ï¼šæ•´å‹åŸå­ç±»</p> </li><li> <p><code>AtomicLong</code>ï¼šé•¿æ•´å‹åŸå­ç±»</p> </li><li> <p><code>AtomicBoolean</code>ï¼šå¸ƒå°”å‹åŸå­ç±»</p> </li></ul> 
<p><strong>2ã€æ•°ç»„ç±»å‹</strong></p> 
<p>ä½¿ç”¨åŸå­çš„æ–¹å¼æ›´æ–°æ•°ç»„é‡Œçš„æŸä¸ªå…ƒç´ </p> 
<ul><li> <p><code>AtomicIntegerArray</code>ï¼šæ•´å‹æ•°ç»„åŸå­ç±»</p> </li><li> <p><code>AtomicLongArray</code>ï¼šé•¿æ•´å‹æ•°ç»„åŸå­ç±»</p> </li><li> <p><code>AtomicReferenceArray</code>ï¼šå¼•ç”¨ç±»å‹æ•°ç»„åŸå­ç±»</p> </li></ul> 
<p><strong>3ã€å¼•ç”¨ç±»å‹</strong></p> 
<ul><li> <p><code>AtomicReference</code>ï¼šå¼•ç”¨ç±»å‹åŸå­ç±»</p> </li><li> <p><code>AtomicMarkableReference</code>ï¼šåŸå­æ›´æ–°å¸¦æœ‰æ ‡è®°çš„å¼•ç”¨ç±»å‹ã€‚è¯¥ç±»å°†Â booleanÂ æ ‡è®°ä¸å¼•ç”¨å…³è”èµ·æ¥ï¼Œä¹Ÿå¯ä»¥è§£å†³ä½¿ç”¨ CAS è¿›è¡ŒåŸå­æ›´æ–°æ—¶å¯èƒ½å‡ºç°çš„ ABA é—®é¢˜ã€‚</p> </li><li> <p><code>AtomicStampedReference</code>ï¼šåŸå­æ›´æ–°å¸¦æœ‰ç‰ˆæœ¬å·çš„å¼•ç”¨ç±»å‹ã€‚è¯¥ç±»å°†æ•´æ•°å€¼ä¸å¼•ç”¨å…³è”èµ·æ¥ï¼Œå¯ç”¨äºè§£å†³åŸå­çš„æ›´æ–°æ•°æ®å’Œæ•°æ®çš„ç‰ˆæœ¬å·ï¼Œå¯ä»¥è§£å†³ä½¿ç”¨ CAS è¿›è¡ŒåŸå­æ›´æ–°æ—¶å¯èƒ½å‡ºç°çš„ ABA é—®é¢˜ã€‚</p> </li></ul> 
<p><strong>ğŸ› ä¿®æ­£ï¼ˆå‚è§ï¼š</strong><strong>issue#626ï¼š<em>https://github.com/Snailclimb/JavaGuide/issues/626</em></strong><strong>ï¼‰</strong>Â :Â <code>AtomicMarkableReference</code>Â ä¸èƒ½è§£å†³ ABA é—®é¢˜ã€‚</p> 
<p><strong>4ã€å¯¹è±¡çš„å±æ€§ä¿®æ”¹ç±»å‹</strong></p> 
<ul><li> <p><code>AtomicIntegerFieldUpdater</code>:åŸå­æ›´æ–°æ•´å‹å­—æ®µçš„æ›´æ–°å™¨</p> </li><li> <p><code>AtomicLongFieldUpdater</code>ï¼šåŸå­æ›´æ–°é•¿æ•´å‹å­—æ®µçš„æ›´æ–°å™¨</p> </li><li> <p><code>AtomicReferenceFieldUpdater</code>ï¼šåŸå­æ›´æ–°å¼•ç”¨ç±»å‹é‡Œçš„å­—æ®µ</p> </li></ul> 
<h3 id="%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B%E5%8E%9F%E5%AD%90%E7%B1%BB">åŸºæœ¬ç±»å‹åŸå­ç±»</h3> 
<p>ä½¿ç”¨åŸå­çš„æ–¹å¼æ›´æ–°åŸºæœ¬ç±»å‹</p> 
<ul><li> <p><code>AtomicInteger</code>ï¼šæ•´å‹åŸå­ç±»</p> </li><li> <p><code>AtomicLong</code>ï¼šé•¿æ•´å‹åŸå­ç±»</p> </li><li> <p><code>AtomicBoolean</code>ï¼šå¸ƒå°”å‹åŸå­ç±»</p> </li></ul> 
<p>ä¸Šé¢ä¸‰ä¸ªç±»æä¾›çš„æ–¹æ³•å‡ ä¹ç›¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä»¥Â <code>AtomicInteger</code>Â ä¸ºä¾‹å­æ¥ä»‹ç»ã€‚</p> 
<p><strong><code>AtomicInteger</code>Â ç±»å¸¸ç”¨æ–¹æ³•</strong>Â ï¼š</p> 
<pre><code>publicÂ finalÂ intÂ get()Â //è·å–å½“å‰çš„å€¼
publicÂ finalÂ intÂ getAndSet(intÂ newValue)//è·å–å½“å‰çš„å€¼ï¼Œå¹¶è®¾ç½®æ–°çš„å€¼
publicÂ finalÂ intÂ getAndIncrement()//è·å–å½“å‰çš„å€¼ï¼Œå¹¶è‡ªå¢
publicÂ finalÂ intÂ getAndDecrement()Â //è·å–å½“å‰çš„å€¼ï¼Œå¹¶è‡ªå‡
publicÂ finalÂ intÂ getAndAdd(intÂ delta)Â //è·å–å½“å‰çš„å€¼ï¼Œå¹¶åŠ ä¸Šé¢„æœŸçš„å€¼
booleanÂ compareAndSet(intÂ expect,Â intÂ update)Â //å¦‚æœè¾“å…¥çš„æ•°å€¼ç­‰äºé¢„æœŸå€¼ï¼Œåˆ™ä»¥åŸå­æ–¹å¼å°†è¯¥å€¼è®¾ç½®ä¸ºè¾“å…¥å€¼ï¼ˆupdateï¼‰
publicÂ finalÂ voidÂ lazySet(intÂ newValue)//æœ€ç»ˆè®¾ç½®ä¸ºnewValue,Â lazySetÂ æä¾›äº†ä¸€ç§æ¯”Â setÂ æ–¹æ³•æ›´å¼±çš„è¯­ä¹‰ï¼Œå¯èƒ½å¯¼è‡´å…¶ä»–çº¿ç¨‹åœ¨ä¹‹åçš„ä¸€å°æ®µæ—¶é—´å†…è¿˜æ˜¯å¯ä»¥è¯»åˆ°æ—§çš„å€¼ï¼Œä½†å¯èƒ½æ›´é«˜æ•ˆã€‚
</code></pre> 
<p><strong><code>AtomicInteger</code>Â ç±»ä½¿ç”¨ç¤ºä¾‹</strong>Â :</p> 
<pre><code class="language-java">//Â åˆå§‹åŒ–Â AtomicIntegerÂ å¯¹è±¡ï¼Œåˆå§‹å€¼ä¸ºÂ 0
AtomicIntegerÂ atomicIntÂ =Â newÂ AtomicInteger(0);

//Â ä½¿ç”¨Â getAndSetÂ æ–¹æ³•è·å–å½“å‰å€¼ï¼Œå¹¶è®¾ç½®æ–°å€¼ä¸ºÂ 3
intÂ tempValueÂ =Â atomicInt.getAndSet(3);
System.out.println("tempValue:Â "Â +Â tempValueÂ +Â ";Â atomicInt:Â "Â +Â atomicInt);

//Â ä½¿ç”¨Â getAndIncrementÂ æ–¹æ³•è·å–å½“å‰å€¼ï¼Œå¹¶è‡ªå¢Â 1
tempValueÂ =Â atomicInt.getAndIncrement();
System.out.println("tempValue:Â "Â +Â tempValueÂ +Â ";Â atomicInt:Â "Â +Â atomicInt);

//Â ä½¿ç”¨Â getAndAddÂ æ–¹æ³•è·å–å½“å‰å€¼ï¼Œå¹¶å¢åŠ æŒ‡å®šå€¼Â 5
tempValueÂ =Â atomicInt.getAndAdd(5);
System.out.println("tempValue:Â "Â +Â tempValueÂ +Â ";Â atomicInt:Â "Â +Â atomicInt);

//Â ä½¿ç”¨Â compareAndSetÂ æ–¹æ³•è¿›è¡ŒåŸå­æ€§æ¡ä»¶æ›´æ–°ï¼ŒæœŸæœ›å€¼ä¸ºÂ 9ï¼Œæ›´æ–°å€¼ä¸ºÂ 10
booleanÂ updateSuccessÂ =Â atomicInt.compareAndSet(9,Â 10);
System.out.println("UpdateÂ Success:Â "Â +Â updateSuccessÂ +Â ";Â atomicInt:Â "Â +Â atomicInt);

//Â è·å–å½“å‰å€¼
intÂ currentValueÂ =Â atomicInt.get();
System.out.println("CurrentÂ value:Â "Â +Â currentValue);

//Â ä½¿ç”¨Â lazySetÂ æ–¹æ³•è®¾ç½®æ–°å€¼ä¸ºÂ 15
atomicInt.lazySet(15);
System.out.println("AfterÂ lazySet,Â atomicInt:Â "Â +Â atomicInt);
</code></pre> 
<p>è¾“å‡ºï¼š</p> 
<pre><code>tempValue:Â 0;Â atomicInt:Â 3
tempValue:Â 3;Â atomicInt:Â 4
tempValue:Â 4;Â atomicInt:Â 9
UpdateÂ Success:Â true;Â atomicInt:Â 10
CurrentÂ value:Â 10
AfterÂ lazySet,Â atomicInt:Â 15
</code></pre> 
<h3 id="%E6%95%B0%E7%BB%84%E7%B1%BB%E5%9E%8B%E5%8E%9F%E5%AD%90%E7%B1%BB">æ•°ç»„ç±»å‹åŸå­ç±»</h3> 
<p>ä½¿ç”¨åŸå­çš„æ–¹å¼æ›´æ–°æ•°ç»„é‡Œçš„æŸä¸ªå…ƒç´ </p> 
<ul><li> <p><code>AtomicIntegerArray</code>ï¼šæ•´å½¢æ•°ç»„åŸå­ç±»</p> </li><li> <p><code>AtomicLongArray</code>ï¼šé•¿æ•´å½¢æ•°ç»„åŸå­ç±»</p> </li><li> <p><code>AtomicReferenceArray</code>ï¼šå¼•ç”¨ç±»å‹æ•°ç»„åŸå­ç±»</p> </li></ul> 
<p>ä¸Šé¢ä¸‰ä¸ªç±»æä¾›çš„æ–¹æ³•å‡ ä¹ç›¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä»¥Â <code>AtomicIntegerArray</code>Â ä¸ºä¾‹å­æ¥ä»‹ç»ã€‚</p> 
<p><strong><code>AtomicIntegerArray</code>Â ç±»å¸¸ç”¨æ–¹æ³•</strong>ï¼š</p> 
<pre><code>publicÂ finalÂ intÂ get(intÂ i)Â //è·å–Â index=iÂ ä½ç½®å…ƒç´ çš„å€¼
publicÂ finalÂ intÂ getAndSet(intÂ i,Â intÂ newValue)//è¿”å›Â index=iÂ ä½ç½®çš„å½“å‰çš„å€¼ï¼Œå¹¶å°†å…¶è®¾ç½®ä¸ºæ–°å€¼ï¼šnewValue
publicÂ finalÂ intÂ getAndIncrement(intÂ i)//è·å–Â index=iÂ ä½ç½®å…ƒç´ çš„å€¼ï¼Œå¹¶è®©è¯¥ä½ç½®çš„å…ƒç´ è‡ªå¢
publicÂ finalÂ intÂ getAndDecrement(intÂ i)Â //è·å–Â index=iÂ ä½ç½®å…ƒç´ çš„å€¼ï¼Œå¹¶è®©è¯¥ä½ç½®çš„å…ƒç´ è‡ªå‡
publicÂ finalÂ intÂ getAndAdd(intÂ i,Â intÂ delta)Â //è·å–Â index=iÂ ä½ç½®å…ƒç´ çš„å€¼ï¼Œå¹¶åŠ ä¸Šé¢„æœŸçš„å€¼
booleanÂ compareAndSet(intÂ i,Â intÂ expect,Â intÂ update)Â //å¦‚æœè¾“å…¥çš„æ•°å€¼ç­‰äºé¢„æœŸå€¼ï¼Œåˆ™ä»¥åŸå­æ–¹å¼å°†Â index=iÂ ä½ç½®çš„å…ƒç´ å€¼è®¾ç½®ä¸ºè¾“å…¥å€¼ï¼ˆupdateï¼‰
publicÂ finalÂ voidÂ lazySet(intÂ i,Â intÂ newValue)//æœ€ç»ˆÂ å°†index=iÂ ä½ç½®çš„å…ƒç´ è®¾ç½®ä¸ºnewValue,ä½¿ç”¨Â lazySetÂ è®¾ç½®ä¹‹åå¯èƒ½å¯¼è‡´å…¶ä»–çº¿ç¨‹åœ¨ä¹‹åçš„ä¸€å°æ®µæ—¶é—´å†…è¿˜æ˜¯å¯ä»¥è¯»åˆ°æ—§çš„å€¼ã€‚
</code></pre> 
<p><strong><code>AtomicIntegerArray</code>Â ç±»ä½¿ç”¨ç¤ºä¾‹</strong>Â :</p> 
<pre><code class="language-java">int[]Â numsÂ =Â {1,Â 2,Â 3,Â 4,Â 5,Â 6};
//Â åˆ›å»ºÂ AtomicIntegerArray
AtomicIntegerArrayÂ atomicArrayÂ =Â newÂ AtomicIntegerArray(nums);

//Â æ‰“å°Â AtomicIntegerArrayÂ ä¸­çš„åˆå§‹å€¼
System.out.println("InitialÂ valuesÂ inÂ AtomicIntegerArray:");
forÂ (intÂ jÂ =Â 0;Â jÂ &lt;Â nums.length;Â j++)Â {
Â Â Â Â System.out.print("IndexÂ "Â +Â jÂ +Â ":Â "Â +Â atomicArray.get(j)Â +Â "Â ");
}

//Â ä½¿ç”¨Â getAndSetÂ æ–¹æ³•å°†ç´¢å¼•Â 0Â å¤„çš„å€¼è®¾ç½®ä¸ºÂ 2ï¼Œå¹¶è¿”å›æ—§å€¼
intÂ tempValueÂ =Â atomicArray.getAndSet(0,Â 2);
System.out.println("\nAfterÂ getAndSet(0,Â 2):");
System.out.println("ReturnedÂ value:Â "Â +Â tempValue);
forÂ (intÂ jÂ =Â 0;Â jÂ &lt;Â atomicArray.length();Â j++)Â {
Â Â Â Â System.out.print("IndexÂ "Â +Â jÂ +Â ":Â "Â +Â atomicArray.get(j)Â +Â "Â ");
}

//Â ä½¿ç”¨Â getAndIncrementÂ æ–¹æ³•å°†ç´¢å¼•Â 0Â å¤„çš„å€¼åŠ Â 1ï¼Œå¹¶è¿”å›æ—§å€¼
tempValueÂ =Â atomicArray.getAndIncrement(0);
System.out.println("\nAfterÂ getAndIncrement(0):");
System.out.println("ReturnedÂ value:Â "Â +Â tempValue);
forÂ (intÂ jÂ =Â 0;Â jÂ &lt;Â atomicArray.length();Â j++)Â {
Â Â Â Â System.out.print("IndexÂ "Â +Â jÂ +Â ":Â "Â +Â atomicArray.get(j)Â +Â "Â ");
}

//Â ä½¿ç”¨Â getAndAddÂ æ–¹æ³•å°†ç´¢å¼•Â 0Â å¤„çš„å€¼å¢åŠ Â 5ï¼Œå¹¶è¿”å›æ—§å€¼
tempValueÂ =Â atomicArray.getAndAdd(0,Â 5);
System.out.println("\nAfterÂ getAndAdd(0,Â 5):");
System.out.println("ReturnedÂ value:Â "Â +Â tempValue);
forÂ (intÂ jÂ =Â 0;Â jÂ &lt;Â atomicArray.length();Â j++)Â {
Â Â Â Â System.out.print("IndexÂ "Â +Â jÂ +Â ":Â "Â +Â atomicArray.get(j)Â +Â "Â ");
}
</code></pre> 
<p>è¾“å‡ºï¼š</p> 
<pre><code>InitialÂ valuesÂ inÂ AtomicIntegerArray:
IndexÂ 0:Â 1Â IndexÂ 1:Â 2Â IndexÂ 2:Â 3Â IndexÂ 3:Â 4Â IndexÂ 4:Â 5Â IndexÂ 5:Â 6Â 
AfterÂ getAndSet(0,Â 2):
ReturnedÂ value:Â 1
IndexÂ 0:Â 2Â IndexÂ 1:Â 2Â IndexÂ 2:Â 3Â IndexÂ 3:Â 4Â IndexÂ 4:Â 5Â IndexÂ 5:Â 6Â 
AfterÂ getAndIncrement(0):
ReturnedÂ value:Â 2
IndexÂ 0:Â 3Â IndexÂ 1:Â 2Â IndexÂ 2:Â 3Â IndexÂ 3:Â 4Â IndexÂ 4:Â 5Â IndexÂ 5:Â 6Â 
AfterÂ getAndAdd(0,Â 5):
ReturnedÂ value:Â 3
IndexÂ 0:Â 8Â IndexÂ 1:Â 2Â IndexÂ 2:Â 3Â IndexÂ 3:Â 4Â IndexÂ 4:Â 5Â IndexÂ 5:Â 6Â 
</code></pre> 
<h3 id="%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B%E5%8E%9F%E5%AD%90%E7%B1%BB">å¼•ç”¨ç±»å‹åŸå­ç±»</h3> 
<p>åŸºæœ¬ç±»å‹åŸå­ç±»åªèƒ½æ›´æ–°ä¸€ä¸ªå˜é‡ï¼Œå¦‚æœéœ€è¦åŸå­æ›´æ–°å¤šä¸ªå˜é‡ï¼Œéœ€è¦ä½¿ç”¨ å¼•ç”¨ç±»å‹åŸå­ç±»ã€‚</p> 
<ul><li> <p><code>AtomicReference</code>ï¼šå¼•ç”¨ç±»å‹åŸå­ç±»</p> </li><li> <p><code>AtomicStampedReference</code>ï¼šåŸå­æ›´æ–°å¸¦æœ‰ç‰ˆæœ¬å·çš„å¼•ç”¨ç±»å‹ã€‚è¯¥ç±»å°†æ•´æ•°å€¼ä¸å¼•ç”¨å…³è”èµ·æ¥ï¼Œå¯ç”¨äºè§£å†³åŸå­çš„æ›´æ–°æ•°æ®å’Œæ•°æ®çš„ç‰ˆæœ¬å·ï¼Œå¯ä»¥è§£å†³ä½¿ç”¨ CAS è¿›è¡ŒåŸå­æ›´æ–°æ—¶å¯èƒ½å‡ºç°çš„ ABA é—®é¢˜ã€‚</p> </li><li> <p><code>AtomicMarkableReference</code>ï¼šåŸå­æ›´æ–°å¸¦æœ‰æ ‡è®°çš„å¼•ç”¨ç±»å‹ã€‚è¯¥ç±»å°† boolean æ ‡è®°ä¸å¼•ç”¨å…³è”èµ·æ¥ï¼Œä¹Ÿå¯ä»¥è§£å†³ä½¿ç”¨ CAS è¿›è¡ŒåŸå­æ›´æ–°æ—¶å¯èƒ½å‡ºç°çš„ ABA é—®é¢˜ã€‚</p> </li></ul> 
<p>ä¸Šé¢ä¸‰ä¸ªç±»æä¾›çš„æ–¹æ³•å‡ ä¹ç›¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä»¥Â <code>AtomicReference</code>Â ä¸ºä¾‹å­æ¥ä»‹ç»ã€‚</p> 
<p><strong><code>AtomicReference</code>Â ç±»ä½¿ç”¨ç¤ºä¾‹</strong>Â :</p> 
<pre><code class="language-java">//Â PersonÂ ç±»
classÂ PersonÂ {
Â Â Â Â privateÂ StringÂ name;
Â Â Â Â privateÂ intÂ age;
Â Â Â Â //çœç•¥getter/setterå’ŒtoString
}


//Â åˆ›å»ºÂ AtomicReferenceÂ å¯¹è±¡å¹¶è®¾ç½®åˆå§‹å€¼
AtomicReference&lt;Person&gt;Â arÂ =Â newÂ AtomicReference&lt;&gt;(newÂ Person("SnailClimb",Â 22));

//Â æ‰“å°åˆå§‹å€¼
System.out.println("InitialÂ Person:Â "Â +Â ar.get().toString());

//Â æ›´æ–°å€¼
PersonÂ updatePersonÂ =Â newÂ Person("Daisy",Â 20);
ar.compareAndSet(ar.get(),Â updatePerson);

//Â æ‰“å°æ›´æ–°åçš„å€¼
System.out.println("UpdatedÂ Person:Â "Â +Â ar.get().toString());

//Â å°è¯•å†æ¬¡æ›´æ–°
PersonÂ anotherUpdatePersonÂ =Â newÂ Person("John",Â 30);
booleanÂ isUpdatedÂ =Â ar.compareAndSet(updatePerson,Â anotherUpdatePerson);

//Â æ‰“å°æ˜¯å¦æ›´æ–°æˆåŠŸåŠæœ€ç»ˆå€¼
System.out.println("SecondÂ UpdateÂ Success:Â "Â +Â isUpdated);
System.out.println("FinalÂ Person:Â "Â +Â ar.get().toString());
</code></pre> 
<p>è¾“å‡ºï¼š</p> 
<pre><code>Initial Person: Person{name='SnailClimb', age=22}
Updated Person: Person{name='Daisy', age=20}
Second Update Success: true
Final Person: Person{name='John', age=30}
</code></pre> 
<p><strong><code>AtomicStampedReference</code>Â ç±»ä½¿ç”¨ç¤ºä¾‹</strong>Â :</p> 
<pre><code class="language-java">//Â åˆ›å»ºä¸€ä¸ªÂ AtomicStampedReferenceÂ å¯¹è±¡ï¼Œåˆå§‹å€¼ä¸ºÂ "SnailClimb"ï¼Œåˆå§‹ç‰ˆæœ¬å·ä¸ºÂ 1
AtomicStampedReference&lt;String&gt;Â asrÂ =Â newÂ AtomicStampedReference&lt;&gt;("SnailClimb",Â 1);

//Â æ‰“å°åˆå§‹å€¼å’Œç‰ˆæœ¬å·
int[]Â initialStampÂ =Â newÂ int[1];
StringÂ initialRefÂ =Â asr.get(initialStamp);
System.out.println("InitialÂ Reference:Â "Â +Â initialRefÂ +Â ",Â InitialÂ Stamp:Â "Â +Â initialStamp[0]);

//Â æ›´æ–°å€¼å’Œç‰ˆæœ¬å·
intÂ oldStampÂ =Â initialStamp[0];
StringÂ oldRefÂ =Â initialRef;
StringÂ newRefÂ =Â "Daisy";
intÂ newStampÂ =Â oldStampÂ +Â 1;

booleanÂ isUpdatedÂ =Â asr.compareAndSet(oldRef,Â newRef,Â oldStamp,Â newStamp);
System.out.println("UpdateÂ Success:Â "Â +Â isUpdated);

//Â æ‰“å°æ›´æ–°åçš„å€¼å’Œç‰ˆæœ¬å·
int[]Â updatedStampÂ =Â newÂ int[1];
StringÂ updatedRefÂ =Â asr.get(updatedStamp);
System.out.println("UpdatedÂ Reference:Â "Â +Â updatedRefÂ +Â ",Â UpdatedÂ Stamp:Â "Â +Â updatedStamp[0]);

//Â å°è¯•ç”¨é”™è¯¯çš„ç‰ˆæœ¬å·æ›´æ–°
booleanÂ isUpdatedWithWrongStampÂ =Â asr.compareAndSet(newRef,Â "John",Â oldStamp,Â newStampÂ +Â 1);
System.out.println("UpdateÂ withÂ WrongÂ StampÂ Success:Â "Â +Â isUpdatedWithWrongStamp);

//Â æ‰“å°æœ€ç»ˆçš„å€¼å’Œç‰ˆæœ¬å·
int[]Â finalStampÂ =Â newÂ int[1];
StringÂ finalRefÂ =Â asr.get(finalStamp);
System.out.println("FinalÂ Reference:Â "Â +Â finalRefÂ +Â ",Â FinalÂ Stamp:Â "Â +Â finalStamp[0]);
</code></pre> 
<p>è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p> 
<pre><code>Initial Reference: SnailClimb, Initial Stamp: 1
Update Success: true
Updated Reference: Daisy, Updated Stamp: 2
Update with Wrong Stamp Success: false
Final Reference: Daisy, Final Stamp: 2
</code></pre> 
<p><strong><code>AtomicMarkableReference</code>Â ç±»ä½¿ç”¨ç¤ºä¾‹</strong>Â :</p> 
<pre><code class="language-java">//Â åˆ›å»ºä¸€ä¸ªÂ AtomicMarkableReferenceÂ å¯¹è±¡ï¼Œåˆå§‹å€¼ä¸ºÂ "SnailClimb"ï¼Œåˆå§‹æ ‡è®°ä¸ºÂ false
AtomicMarkableReference&lt;String&gt;Â amrÂ =Â newÂ AtomicMarkableReference&lt;&gt;("SnailClimb",Â false);

//Â æ‰“å°åˆå§‹å€¼å’Œæ ‡è®°
boolean[]Â initialMarkÂ =Â newÂ boolean[1];
StringÂ initialRefÂ =Â amr.get(initialMark);
System.out.println("InitialÂ Reference:Â "Â +Â initialRefÂ +Â ",Â InitialÂ Mark:Â "Â +Â initialMark[0]);

//Â æ›´æ–°å€¼å’Œæ ‡è®°
StringÂ oldRefÂ =Â initialRef;
StringÂ newRefÂ =Â "Daisy";
booleanÂ oldMarkÂ =Â initialMark[0];
booleanÂ newMarkÂ =Â true;

booleanÂ isUpdatedÂ =Â amr.compareAndSet(oldRef,Â newRef,Â oldMark,Â newMark);
System.out.println("UpdateÂ Success:Â "Â +Â isUpdated);

//Â æ‰“å°æ›´æ–°åçš„å€¼å’Œæ ‡è®°
boolean[]Â updatedMarkÂ =Â newÂ boolean[1];
StringÂ updatedRefÂ =Â amr.get(updatedMark);
System.out.println("UpdatedÂ Reference:Â "Â +Â updatedRefÂ +Â ",Â UpdatedÂ Mark:Â "Â +Â updatedMark[0]);

//Â å°è¯•ç”¨é”™è¯¯çš„æ ‡è®°æ›´æ–°
booleanÂ isUpdatedWithWrongMarkÂ =Â amr.compareAndSet(newRef,Â "John",Â oldMark,Â !newMark);
System.out.println("UpdateÂ withÂ WrongÂ MarkÂ Success:Â "Â +Â isUpdatedWithWrongMark);

//Â æ‰“å°æœ€ç»ˆçš„å€¼å’Œæ ‡è®°
boolean[]Â finalMarkÂ =Â newÂ boolean[1];
StringÂ finalRefÂ =Â amr.get(finalMark);
System.out.println("FinalÂ Reference:Â "Â +Â finalRefÂ +Â ",Â FinalÂ Mark:Â "Â +Â finalMark[0]);
</code></pre> 
<p>è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p> 
<pre><code>Initial Reference: SnailClimb, Initial Mark: false
Update Success: true
Updated Reference: Daisy, Updated Mark: true
Update with Wrong Mark Success: false
Final Reference: Daisy, Final Mark: true
</code></pre> 
<h3 id="%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%B1%9E%E6%80%A7%E4%BF%AE%E6%94%B9%E7%B1%BB%E5%9E%8B%E5%8E%9F%E5%AD%90%E7%B1%BB">å¯¹è±¡çš„å±æ€§ä¿®æ”¹ç±»å‹åŸå­ç±»</h3> 
<p>å¦‚æœéœ€è¦åŸå­æ›´æ–°æŸä¸ªç±»é‡Œçš„æŸä¸ªå­—æ®µæ—¶ï¼Œéœ€è¦ç”¨åˆ°å¯¹è±¡çš„å±æ€§ä¿®æ”¹ç±»å‹åŸå­ç±»ã€‚</p> 
<ul><li> <p><code>AtomicIntegerFieldUpdater</code>:åŸå­æ›´æ–°æ•´å½¢å­—æ®µçš„æ›´æ–°å™¨</p> </li><li> <p><code>AtomicLongFieldUpdater</code>ï¼šåŸå­æ›´æ–°é•¿æ•´å½¢å­—æ®µçš„æ›´æ–°å™¨</p> </li><li> <p><code>AtomicReferenceFieldUpdater</code>ï¼šåŸå­æ›´æ–°å¼•ç”¨ç±»å‹é‡Œçš„å­—æ®µçš„æ›´æ–°å™¨</p> </li></ul> 
<p>è¦æƒ³åŸå­åœ°æ›´æ–°å¯¹è±¡çš„å±æ€§éœ€è¦ä¸¤æ­¥ã€‚ç¬¬ä¸€æ­¥ï¼Œå› ä¸ºå¯¹è±¡çš„å±æ€§ä¿®æ”¹ç±»å‹åŸå­ç±»éƒ½æ˜¯æŠ½è±¡ç±»ï¼Œæ‰€ä»¥æ¯æ¬¡ä½¿ç”¨éƒ½å¿…é¡»ä½¿ç”¨é™æ€æ–¹æ³• newUpdater()åˆ›å»ºä¸€ä¸ªæ›´æ–°å™¨ï¼Œå¹¶ä¸”éœ€è¦è®¾ç½®æƒ³è¦æ›´æ–°çš„ç±»å’Œå±æ€§ã€‚ç¬¬äºŒæ­¥ï¼Œæ›´æ–°çš„å¯¹è±¡å±æ€§å¿…é¡»ä½¿ç”¨ public volatile ä¿®é¥°ç¬¦ã€‚</p> 
<p>ä¸Šé¢ä¸‰ä¸ªç±»æä¾›çš„æ–¹æ³•å‡ ä¹ç›¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä»¥Â <code>AtomicIntegerFieldUpdater</code>ä¸ºä¾‹å­æ¥ä»‹ç»ã€‚</p> 
<p><strong><code>AtomicIntegerFieldUpdater</code>Â ç±»ä½¿ç”¨ç¤ºä¾‹</strong>Â :</p> 
<pre><code class="language-java">//Â PersonÂ ç±»
classÂ PersonÂ {
Â Â Â Â privateÂ StringÂ name;
Â Â Â Â //Â è¦ä½¿ç”¨Â AtomicIntegerFieldUpdaterï¼Œå­—æ®µå¿…é¡»æ˜¯Â publicÂ volatile
Â Â Â Â privateÂ volatileÂ intÂ age;
Â Â Â Â //çœç•¥getter/setterå’ŒtoString
}

//Â åˆ›å»ºÂ AtomicIntegerFieldUpdaterÂ å¯¹è±¡
AtomicIntegerFieldUpdater&lt;Person&gt;Â ageUpdaterÂ =Â AtomicIntegerFieldUpdater.newUpdater(Person.class,Â "age");

//Â åˆ›å»ºÂ PersonÂ å¯¹è±¡
PersonÂ personÂ =Â newÂ Person("SnailClimb",Â 22);

//Â æ‰“å°åˆå§‹å€¼
System.out.println("InitialÂ Person:Â "Â +Â person);

//Â æ›´æ–°Â ageÂ å­—æ®µ
ageUpdater.incrementAndGet(person);Â //Â è‡ªå¢
System.out.println("AfterÂ Increment:Â "Â +Â person);

ageUpdater.addAndGet(person,Â 5);Â //Â å¢åŠ Â 5
System.out.println("AfterÂ AddingÂ 5:Â "Â +Â person);

ageUpdater.compareAndSet(person,Â 28,Â 30);Â //Â å¦‚æœå½“å‰å€¼æ˜¯Â 28ï¼Œåˆ™è®¾ç½®ä¸ºÂ 30
System.out.println("AfterÂ CompareÂ andÂ SetÂ (28Â toÂ 30):Â "Â +Â person);

//Â å°è¯•ä½¿ç”¨é”™è¯¯çš„æ¯”è¾ƒå€¼è¿›è¡Œæ›´æ–°
booleanÂ isUpdatedÂ =Â ageUpdater.compareAndSet(person,Â 28,Â 35);Â //Â è¿™æ¬¡åº”è¯¥å¤±è´¥
System.out.println("CompareÂ andÂ SetÂ (28Â toÂ 35)Â Success:Â "Â +Â isUpdated);
System.out.println("FinalÂ Person:Â "Â +Â person);
</code></pre> 
<p>è¾“å‡ºç»“æœï¼š</p> 
<pre><code>Initial Person: Name: SnailClimb, Age: 22
After Increment: Name: SnailClimb, Age: 23
After Adding 5: Name: SnailClimb, Age: 28
After Compare and Set (28 to 30): Name: SnailClimb, Age: 30
Compare and Set (28 to 35) Success: false
Final Person: Name: SnailClimb, Age: 30</code></pre> 
<h2>æœ¬æ–‡æ¥è‡ªäºæ©å¸ˆ å…¬ä¼—å·GuideÂ <a id="js_name">JavaGuide</a></h2> 
<hr> 
<h2 id="%E4%BD%9C%E8%80%85%E5%85%B6%E4%BB%96%E4%BD%9C%E5%93%81%EF%BC%9A">ä½œè€…å…¶ä»–ä½œå“ï¼š</h2> 
<p><a href="https://cyberspace.blog.csdn.net/article/details/136338757?spm=1001.2014.3001.5502" rel="nofollow" title="ã€Javaã€‘Springå¾ªç¯ä¾èµ–ï¼šåŸå› ä¸è§£å†³æ–¹æ³•">ã€Javaã€‘Springå¾ªç¯ä¾èµ–ï¼šåŸå› ä¸è§£å†³æ–¹æ³•</a></p> 
<p><a href="https://cyberspace.blog.csdn.net/article/details/136336417?spm=1001.2014.3001.5502" rel="nofollow" title="OpenAI Soraæ¥äº†ï¼Œè§†é¢‘ç”Ÿæˆé¢†åŸŸçš„GPT-4æ—¶ä»£æ¥äº†">OpenAI Soraæ¥äº†ï¼Œè§†é¢‘ç”Ÿæˆé¢†åŸŸçš„GPT-4æ—¶ä»£æ¥äº†</a></p> 
<p><a href="https://cyberspace.blog.csdn.net/article/details/136200396?spm=1001.2014.3001.5502" rel="nofollow" title="[JavaÂ·ç®—æ³•Â·ç®€å•] LeetCode 14. æœ€é•¿å…¬å…±å‰ç¼€ è¯¦ç»†è§£è¯»">[JavaÂ·ç®—æ³•Â·ç®€å•] LeetCode 14. æœ€é•¿å…¬å…±å‰ç¼€ è¯¦ç»†è§£è¯»</a></p> 
<p><a href="https://cyberspace.blog.csdn.net/article/details/136318553?spm=1001.2014.3001.5502" rel="nofollow" title="ã€Javaã€‘æ·±å…¥ç†è§£Javaä¸­çš„staticå…³é”®å­—">ã€Javaã€‘æ·±å…¥ç†è§£Javaä¸­çš„staticå…³é”®å­—</a></p> 
<p><a href="https://cyberspace.blog.csdn.net/article/details/136292910?spm=1001.2014.3001.5502" rel="nofollow" title="[JavaÂ·ç®—æ³•Â·ç®€å•] LeetCode 28. æ‰¾å‡ºå­—aç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹çš„ä¸‹æ ‡ è¯¦ç»†è§£è¯»">[JavaÂ·ç®—æ³•Â·ç®€å•] LeetCode 28. æ‰¾å‡ºå­—aç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹çš„ä¸‹æ ‡ è¯¦ç»†è§£è¯»</a></p> 
<p><a href="https://cyberspace.blog.csdn.net/article/details/136256523?spm=1001.2014.3001.5502" rel="nofollow" title="äº†è§£ Java ä¸­çš„ AtomicInteger ç±»">äº†è§£ Java ä¸­çš„ AtomicInteger ç±»</a></p> 
<p><a href="https://cyberspace.blog.csdn.net/article/details/136275183?spm=1001.2014.3001.5502" rel="nofollow" title="ç®—æ³•é¢˜ â€” æ•´æ•°è½¬äºŒè¿›åˆ¶ï¼ŒæŸ¥æ‰¾å…¶ä¸­1çš„æ•°é‡">ç®—æ³•é¢˜ â€” æ•´æ•°è½¬äºŒè¿›åˆ¶ï¼ŒæŸ¥æ‰¾å…¶ä¸­1çš„æ•°é‡</a></p> 
<p><a class="link-info" href="https://cyberspace.blog.csdn.net/article/details/136223146?spm=1001.2014.3001.5502" rel="nofollow" title="æ·±å…¥ç†è§£MySQLäº‹åŠ¡ç‰¹æ€§ï¼šä¿è¯æ•°æ®å®Œæ•´æ€§ä¸ä¸€è‡´æ€§">æ·±å…¥ç†è§£MySQLäº‹åŠ¡ç‰¹æ€§ï¼šä¿è¯æ•°æ®å®Œæ•´æ€§ä¸ä¸€è‡´æ€§</a></p> 
<p><a class="link-info" href="https://cyberspace.blog.csdn.net/article/details/136102269?spm=1001.2014.3001.5502" rel="nofollow" title="Javaä¼ä¸šåº”ç”¨è½¯ä»¶ç³»ç»Ÿæ¶æ„æ¼”å˜å²">Javaä¼ä¸šåº”ç”¨è½¯ä»¶ç³»ç»Ÿæ¶æ„æ¼”å˜å²</a>Â </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ebf2b3fc0db1dff9c76c67843427d3e6/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">Jupyter: äº¤äº’å¼è®¡ç®—çš„é©å‘½</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/550f6d951e74c1ef42df24ae6e4b538e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">listæ¨¡æ‹Ÿå®ç°ã€C&#43;&#43;ã€‘</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§å’–.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>