<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Spring Boot学习｜Stopwatch 在 Spring Boot 中的使用 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/cd6a0a9223c5a04debad5626f8433526/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Spring Boot学习｜Stopwatch 在 Spring Boot 中的使用">
  <meta property="og:description" content="文章目录 什么是 Stopwatch？使用场景优点缺点注意事项使用步骤使用案例及结果可能面试题1. **理解与解释**2. **技术细节**3. **实际应用**4. **优缺点与替代方案**5. **面向框架的具体问题**6. **高级主题** 什么是 Stopwatch？ Stopwatch 是由 Apache Commons Lang 库提供的一种工具类，它允许你测量经过的时间。它可以用来追踪代码中某部分、方法或应用内任何流程的执行时间。它特别适用于性能分析和优化。
使用场景 性能剖析：识别应用中的瓶颈。日志记录：记录关键操作的执行时间。测试：确保在单元测试中某些操作能在可接受的时间范围内完成。基准测试：比较不同算法或实现的性能。 优点 易于使用：API 设计直观，容易上手。准确性：使用纳秒精度进行时间测量，适合高精度需求。灵活：可以暂停、重启、重置，适应不同的使用场景。 缺点 依赖外部库：使用 Stopwatch 需要引入 Apache Commons Lang 库，这会增加项目依赖。资源消耗：频繁使用可能带来额外的 CPU 和内存开销。 注意事项 确保在不再需要时停止并清除 Stopwatch 实例，避免资源浪费。谨慎使用，避免在性能关键路径上过度使用，以免影响应用性能。 使用步骤 添加依赖：在你的 Spring Boot 项目中添加 Apache Commons Lang 库的依赖。 &lt;dependency&gt; &lt;groupId&gt;org.apache.commons&lt;/groupId&gt; &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt; &lt;version&gt;3.12.0&lt;/version&gt; &lt;/dependency&gt; 创建 Stopwatch 实例：在需要测量时间的地方创建一个 Stopwatch 对象。 Stopwatch stopwatch = new Stopwatch(); 开始计时：调用 start() 方法开始计时。 stopwatch.start(); 执行操作：这里插入你想测量时间的操作或代码块。停止计时：执行完操作后调用 stop() 方法停止计时。 stopwatch.stop(); 获取结果：通过 elapsed(TimeUnit) 方法获取经过的时间，可以指定返回的时间单位（如毫秒、微秒等）。 long elapsedTimeMillis = stopwatch.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-23T21:41:01+08:00">
    <meta property="article:modified_time" content="2024-07-23T21:41:01+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Spring Boot学习｜Stopwatch 在 Spring Boot 中的使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><ul><li><ul><li><a href="#_Stopwatch_1" rel="nofollow">什么是 Stopwatch？</a></li><li><a href="#_3" rel="nofollow">使用场景</a></li><li><a href="#_9" rel="nofollow">优点</a></li><li><a href="#_14" rel="nofollow">缺点</a></li><li><a href="#_18" rel="nofollow">注意事项</a></li><li><a href="#_22" rel="nofollow">使用步骤</a></li><li><a href="#_57" rel="nofollow">使用案例及结果</a></li><li><a href="#_81" rel="nofollow">可能面试题</a></li><li><ul><li><a href="#1__83" rel="nofollow">1. **理解与解释**</a></li><li><a href="#2__94" rel="nofollow">2. **技术细节**</a></li><li><a href="#3__102" rel="nofollow">3. **实际应用**</a></li><li><a href="#4__106" rel="nofollow">4. **优缺点与替代方案**</a></li><li><a href="#5__121" rel="nofollow">5. **面向框架的具体问题**</a></li><li><a href="#6__145" rel="nofollow">6. **高级主题**</a></li></ul> 
    </li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h5><a id="_Stopwatch_1"></a>什么是 Stopwatch？</h5> 
<p><code>Stopwatch</code> 是由 Apache Commons Lang 库提供的一种工具类，它允许你测量经过的时间。它可以用来追踪代码中某部分、方法或应用内任何流程的执行时间。它特别适用于性能分析和优化。</p> 
<h5><a id="_3"></a>使用场景</h5> 
<ul><li><strong>性能剖析</strong>：识别应用中的瓶颈。</li><li><strong>日志记录</strong>：记录关键操作的执行时间。</li><li><strong>测试</strong>：确保在单元测试中某些操作能在可接受的时间范围内完成。</li><li><strong>基准测试</strong>：比较不同算法或实现的性能。</li></ul> 
<h5><a id="_9"></a>优点</h5> 
<ul><li><strong>易于使用</strong>：API 设计直观，容易上手。</li><li><strong>准确性</strong>：使用纳秒精度进行时间测量，适合高精度需求。</li><li><strong>灵活</strong>：可以暂停、重启、重置，适应不同的使用场景。</li></ul> 
<h5><a id="_14"></a>缺点</h5> 
<ul><li><strong>依赖外部库</strong>：使用 Stopwatch 需要引入 Apache Commons Lang 库，这会增加项目依赖。</li><li><strong>资源消耗</strong>：频繁使用可能带来额外的 CPU 和内存开销。</li></ul> 
<h5><a id="_18"></a>注意事项</h5> 
<ul><li>确保在不再需要时停止并清除 Stopwatch 实例，避免资源浪费。</li><li>谨慎使用，避免在性能关键路径上过度使用，以免影响应用性能。</li></ul> 
<h5><a id="_22"></a>使用步骤</h5> 
<ol><li>添加依赖：在你的 Spring Boot 项目中添加 Apache Commons Lang 库的依赖。</li></ol> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.commons<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>commons-lang3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.12.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

</code></pre> 
<ol><li>创建 Stopwatch 实例：在需要测量时间的地方创建一个 Stopwatch 对象。</li></ol> 
<pre><code class="prism language-java"><span class="token class-name">Stopwatch</span> stopwatch <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Stopwatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ol><li>开始计时：调用 <code>start()</code> 方法开始计时。</li></ol> 
<pre><code class="prism language-java">stopwatch<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ol><li>执行操作：这里插入你想测量时间的操作或代码块。</li><li>停止计时：执行完操作后调用 <code>stop()</code> 方法停止计时。</li></ol> 
<pre><code class="prism language-java">stopwatch<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ol><li>获取结果：通过 <code>elapsed(TimeUnit)</code> 方法获取经过的时间，可以指定返回的时间单位（如毫秒、微秒等）。</li></ol> 
<pre><code class="prism language-java"><span class="token keyword">long</span> elapsedTimeMillis <span class="token operator">=</span> stopwatch<span class="token punctuation">.</span><span class="token function">elapsed</span><span class="token punctuation">(</span><span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MILLISECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_57"></a>使用案例及结果</h5> 
<p>假设我们有一个方法 <code>processData()</code>，我们想要测量这个方法的执行时间：</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">processData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Stopwatch</span> stopwatch <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Stopwatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    stopwatch<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 模拟数据处理过程</span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 模拟耗时操作</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">interrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    stopwatch<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">long</span> elapsedTimeMillis <span class="token operator">=</span> stopwatch<span class="token punctuation">.</span><span class="token function">elapsed</span><span class="token punctuation">(</span><span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MILLISECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"处理数据耗时: "</span> <span class="token operator">+</span> elapsedTimeMillis <span class="token operator">+</span> <span class="token string">" ms"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>运行上述代码，输出将显示方法执行所花费的时间，例如：</p> 
<pre><code>处理数据耗时: 1000 ms
</code></pre> 
<p>这表示 <code>processData()</code> 方法的执行时间大约为 1 秒。</p> 
<h5><a id="_81"></a>可能面试题</h5> 
<p>下面是一系列围绕 <code>StopWatch</code> 和性能监控在后端开发面试中可能出现的问题与详细答案：</p> 
<h6><a id="1__83"></a>1. <strong>理解与解释</strong></h6> 
<ul><li>什么是 <code>StopWatch</code>？ 
  <ul><li><code>StopWatch</code> 是一个实用工具类，来源于 Apache Commons Lang 库，用于测量代码片段或方法的执行时间。它可以帮助开发者跟踪和分析应用程序的性能，识别潜在的性能瓶颈。</li></ul> </li><li><code>StopWatch</code> 在后端开发中通常用于哪些场景？</li></ul> 
<p><code>StopWatch</code> 可以用于多种场景，包括但不限于：</p> 
<ul><li>性能分析：监测数据库查询、网络请求、算法执行等操作的耗时。</li><li>代码优化：确定哪些代码段或方法耗时较长，以便进行优化。</li><li>日志记录：在日志中记录关键操作的执行时间，有助于后期的故障排查和性能调优。</li></ul> 
<h6><a id="2__94"></a>2. <strong>技术细节</strong></h6> 
<ul><li><code>StopWatch</code> 如何开始和结束计时？ 
  <ul><li><code>StopWatch</code> 提供了 <code>start()</code> 方法来开始计时，以及 <code>stop()</code> 方法来结束计时。一旦计时开始，你可以多次调用 <code>start()</code> 和 <code>stop()</code> 方法来分段计时。</li></ul> </li><li><code>StopWatch</code> 能否同时测量多个任务的执行时间？如果是，它是如何做到的？ 
  <ul><li>是的，<code>StopWatch</code> 支持并发任务的时间测量。它可以通过创建多个任务分段（通过 <code>startTask()</code> 和 <code>stopTask()</code>）来同时测量多个任务的执行时间，每个任务分段可以独立计时和停止。</li></ul> </li><li><code>StopWatch</code> 的内部机制是什么？它是如何保证时间测量的准确性的？ 
  <ul><li><code>StopWatch</code> 内部使用了 <code>System.nanoTime()</code> 来获取当前时间戳，这种方法提供了比 <code>System.currentTimeMillis()</code> 更高的精度，因为它基于系统纳秒计时器，因此可以提供更准确的时间测量。</li></ul> </li></ul> 
<h6><a id="3__102"></a>3. <strong>实际应用</strong></h6> 
<ul><li>描述一个你曾经使用 <code>StopWatch</code> 进行性能分析的实际例子。 
  <ul><li>在一次数据库查询优化项目中，我使用了 <code>StopWatch</code> 来测量每个 SQL 查询的执行时间。通过在查询前后调用 <code>start()</code> 和 <code>stop()</code> 方法，我能够确定哪些查询是最耗时的，进而对这些查询进行优化，比如通过索引调整、SQL 语句重构等方式。</li></ul> </li></ul> 
<h6><a id="4__106"></a>4. <strong>优缺点与替代方案</strong></h6> 
<ul><li>使用 <code>StopWatch</code> 进行性能监控的优点和缺点是什么？ 
  <ul><li><strong>优点</strong>： 
    <ul><li>易于集成和使用。</li><li>提供了灵活的计时方式，支持多个任务分段。</li><li>准确的时间测量，尤其是对于短时间间隔。</li></ul> </li><li><strong>缺点</strong>： 
    <ul><li>引入了微小的性能开销。</li><li>如果不正确使用，可能会导致计时不准确，比如忘记调用 <code>stop()</code> 方法。</li></ul> </li></ul> </li><li>除了 <code>StopWatch</code>，还有哪些工具或技术可以用来监控后端应用程序的性能？ 
  <ul><li>APM 工具（Application Performance Management），如 New Relic、Datadog、Dynatrace。</li><li>Java Profiling 工具，如 VisualVM、JProfiler。</li><li>日志分析工具，如 ELK Stack（Elasticsearch、Logstash、Kibana）。</li><li>分布式追踪系统，如 Jaeger、Zipkin。</li></ul> </li></ul> 
<h6><a id="5__121"></a>5. <strong>面向框架的具体问题</strong></h6> 
<ul><li>在 Spring Boot 中使用 <code>StopWatch</code>，需要添加哪些依赖？ 
  <ul><li>为了使用 <code>StopWatch</code>，需要在 <code>pom.xml</code> 文件中添加 Apache Commons Lang 的依赖：</li></ul> </li></ul> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.commons<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>commons-lang3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.12.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

</code></pre> 
<ul><li>在 Spring Boot 应用中，你如何配置和使用 <code>StopWatch</code> 来收集性能指标？ 
  <ul><li>配置和使用 <code>StopWatch</code> 通常涉及以下步骤： 
    <ol><li>添加依赖至项目。</li><li>在适当的位置创建 <code>StopWatch</code> 实例。</li><li>调用 <code>start()</code> 方法开始计时。</li><li>执行待测代码。</li><li>调用 <code>stop()</code> 方法停止计时。</li><li>访问 <code>StopWatch</code> 的统计信息，如总时间、平均时间等，并将其记录到日志或其他存储介质。</li></ol> </li></ul> </li></ul> 
<h6><a id="6__145"></a>6. <strong>高级主题</strong></h6> 
<ul><li>在高并发环境下，<code>StopWatch</code> 是否仍然有效？为什么？ 
  <ul><li>在高并发环境下，<code>StopWatch</code> 依然有效，但它必须被正确地使用，尤其是在多线程环境中。由于 <code>StopWatch</code> 是线程安全的，所以可以用于多线程场景，但是每一个线程应该有自己独立的 <code>StopWatch</code> 实例，以防止计时混乱。</li></ul> </li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5743f2d10b4a3c1acd4c81590cbcb231/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【离散数学】（联结词按优先级，3个变量及以下）真值表及范式（有源码c语言，拿来就用）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3b5ba647dc74c06bcbbedf4c883c1cd8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">CSP-J模拟赛day2——试题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>