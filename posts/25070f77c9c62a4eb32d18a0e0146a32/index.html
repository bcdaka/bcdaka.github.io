<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用 ZipArchiveInputStream 读取压缩包内文件总数 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/25070f77c9c62a4eb32d18a0e0146a32/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="使用 ZipArchiveInputStream 读取压缩包内文件总数">
  <meta property="og:description" content="读取压缩包内文件总数 简介 ZipArchiveInputStream 是 Apache Commons Compress 库中的一个类，用于读取 ZIP 格式的压缩文件。在处理 ZIP 文件时，编码格式是一个重要的问题，因为它决定了如何解释文件中的字符数据。通常情况下，ZIP 文件中的文本文件是以特定的字符编码格式存储的，例如 UTF-8 或 ISO-8859-1。但是，ZIP 规范并没有规定文件的编码格式，因此不同的 ZIP 文件可能使用不同的编码。
ZipArchiveInputStream 允许用户设置编码格式，以正确处理 ZIP 文件中的文件名或文件内容。默认情况下，ZipArchiveInputStream 可能使用 UTF-8 编码来读取文件名，但如果 ZIP 文件中的文件名使用了不同的编码，那么就需要显式地设置正确的编码格式。
例如，如果 ZIP 文件中的文件名使用了 GBK 编码，那么在创建 ZipArchiveInputStream 对象时，需要调用 setEncoding(&#34;GBK&#34;) 方法来设置正确的编码格式。这样，ZipArchiveInputStream 就能正确地解析文件名，避免乱码问题。
使用 ZipArchiveInputStream 的基本步骤如下：
创建一个 ZipFile 对象，传入一个 ZIP 文件的 File 对象或 ZIP 文件的路径作为参数。通过 ZipFile 对象的 getInputStream 方法获取一个 InputStream 对象，用于读取 ZIP 文件的数据。创建一个 ZipArchiveInputStream 对象，传入上一步获取的 InputStream 对象作为参数。使用 ZipArchiveInputStream 对象的 getNextEntry 方法来获取 ZIP 文件中的每一个条目（即压缩包内的文件或文件夹），并对其进行处理。可以使用 read 方法读取条目的数据。处理完一个条目后，使用 closeEntry 方法关闭该条目。 代码逻辑 public class Test { public static void main(String[] args) { AtomicInteger atomicInteger = new AtomicInteger(0); File file = FileUtil.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-15T16:35:27+08:00">
    <meta property="article:modified_time" content="2024-03-15T16:35:27+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用 ZipArchiveInputStream 读取压缩包内文件总数</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>读取压缩包内文件总数</h2> 
<h3><a id="_4"></a>简介</h3> 
<p><code>ZipArchiveInputStream</code> 是 Apache Commons Compress 库中的一个类，用于读取 ZIP 格式的压缩文件。在处理 ZIP 文件时，编码格式是一个重要的问题，因为它决定了如何解释文件中的字符数据。通常情况下，ZIP 文件中的文本文件是以特定的字符编码格式存储的，例如 UTF-8 或 ISO-8859-1。但是，ZIP 规范并没有规定文件的编码格式，因此不同的 ZIP 文件可能使用不同的编码。</p> 
<p><code>ZipArchiveInputStream</code> 允许用户设置编码格式，以正确处理 ZIP 文件中的文件名或文件内容。默认情况下，<code>ZipArchiveInputStream</code> 可能使用 UTF-8 编码来读取文件名，但如果 ZIP 文件中的文件名使用了不同的编码，那么就需要显式地设置正确的编码格式。</p> 
<p>例如，如果 ZIP 文件中的文件名使用了 GBK 编码，那么在创建 <code>ZipArchiveInputStream</code> 对象时，需要调用 <code>setEncoding("GBK")</code> 方法来设置正确的编码格式。这样，<code>ZipArchiveInputStream</code> 就能正确地解析文件名，避免乱码问题。</p> 
<p>使用 <code>ZipArchiveInputStream</code> 的基本步骤如下：</p> 
<ol><li>创建一个 <code>ZipFile</code> 对象，传入一个 ZIP 文件的 <code>File</code> 对象或 ZIP 文件的路径作为参数。</li><li>通过 <code>ZipFile</code> 对象的 <code>getInputStream</code> 方法获取一个 <code>InputStream</code> 对象，用于读取 ZIP 文件的数据。</li><li>创建一个 <code>ZipArchiveInputStream</code> 对象，传入上一步获取的 <code>InputStream</code> 对象作为参数。</li><li>使用 <code>ZipArchiveInputStream</code> 对象的 <code>getNextEntry</code> 方法来获取 ZIP 文件中的每一个条目（即压缩包内的文件或文件夹），并对其进行处理。可以使用 <code>read</code> 方法读取条目的数据。</li><li>处理完一个条目后，使用 <code>closeEntry</code> 方法关闭该条目。</li></ol> 
<h3><a id="_22"></a>代码逻辑</h3> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">AtomicInteger</span> atomicInteger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token class-name">FileUtil</span><span class="token punctuation">.</span><span class="token function">file</span><span class="token punctuation">(</span><span class="token string">"C:\\Users\\a\\Downloads\\train_val_images.zip"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">ZipArchiveInputStream</span> inputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ZipArchiveInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">ZipArchiveEntry</span> nextZipEntry<span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>nextZipEntry <span class="token operator">=</span> inputStream<span class="token punctuation">.</span><span class="token function">getNextZipEntry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>nextZipEntry<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                atomicInteger<span class="token punctuation">.</span><span class="token function">incrementAndGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>  <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>atomicInteger<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_45"></a>测试效果</h3> 
<p><img src="https://images2.imgbox.com/b2/e0/aiAmBxt1_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/4a/c5/lvpnzLyj_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a0a96999736a15663c32b55180ad0b1e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Android - 常用adb命令总结</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/efd2cf267077114511b5faa4f409424e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">手把手教你搭建 Android MVI架构: MVI &#43; kotlin &#43; Flow</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>