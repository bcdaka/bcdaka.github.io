<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MATLAB——FFT(快速傅里叶变换) - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/34862e8f0cba3d6282c6e5c245d08a1d/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="MATLAB——FFT(快速傅里叶变换)">
  <meta property="og:description" content="基础知识
FFT即快速傅里叶变换，利用周期性和可约性，减少了DFT的运算量。常见的有按时间抽取的基2算法（DIT-FFT）按频率抽取的基2算法（DIF-FFT）。
1.利用自带函数fft进行快速傅里叶变换
若已知序列 x = [ 4 , 3 , 2 , 6 , 7 , 8 , 9 , 0 ] x=[4,3,2,6,7,8,9,0] x=[4,3,2,6,7,8,9,0]，求 X ( k ) = D F T [ x ( n ) ] X(k)=DFT[x(n)] X(k)=DFT[x(n)]
代码非常简单，只有两行
x=[4,3,2,6,7,8,9,0]; xk=fft(x) 一般，对MATLAB而言，要想让它显示出结果，计算的部分不要加分号。
2.绘制128点DFT的幅频图
已知信号由15Hz幅值0.5的正弦信号和40Hz幅值2的正弦信号组成，数据采样频率为100Hz,试绘制N=128点DFT的幅频图。
关于下列代码的解释
f=(0:N-1)&#39;*fs/N; 其中(0:N-1)&#39;是生成了一个长度为N，间隔为1的列向量转置所得到的行向量。fs/N是指频域上的频率间隔。
若N点序列x(n)(n=0,1,…,N-1)是在采样频率fs(Hz)下获得的。它的FFT也是N点序列，即X(k)（k=0,1,…,N-1），则第K点对应实际频率值为:
f=k*fs/N
clc; fs=100; Ts=1/fs;%采样时间间隔 N=128; n=0:N-1; t=n*Ts; %x不是直接关于n的函数，因为是固定的采样时间点 x=0.5*sin(2*pi*15*t)&#43;2*sin(2*pi*40*t); y=fft(x,N); f=(0:N-1)&#39;*fs/N; stem(f,abs(y)); 运行结果
同时也可以可看到这个幅度谱是关于fN对称的。
3.利用FFT进行功率谱的噪声分析
已知带有测量噪声信号 x ( t ) = s i n ( 2 π f 1 t ) &#43; s i n ( 2 π f 2 t ) &#43; 2 w ( t ) x(t)=sin(2πf1t)&#43;sin(2πf2t)&#43;2w(t) x(t)=sin(2πf1t)&#43;sin(2πf2t)&#43;2w(t) 其中f1=50Hz，f2=120Hz， w(t)为均值为零、方差为1的随机信号，采样频率为1000Hz，数据点数N=512。试绘制信号的功率谱图。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-03-10T19:28:19+08:00">
    <meta property="article:modified_time" content="2023-03-10T19:28:19+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MATLAB——FFT(快速傅里叶变换)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><strong>基础知识</strong><br> FFT即快速傅里叶变换，利用周期性和可约性，减少了DFT的运算量。常见的有按时间抽取的基2算法（DIT-FFT）按频率抽取的基2算法（DIF-FFT）。</p> 
<p><strong>1.利用自带函数fft进行快速傅里叶变换</strong><br> 若已知序列<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         x 
        
       
         = 
        
       
         [ 
        
       
         4 
        
       
         , 
        
       
         3 
        
       
         , 
        
       
         2 
        
       
         , 
        
       
         6 
        
       
         , 
        
       
         7 
        
       
         , 
        
       
         8 
        
       
         , 
        
       
         9 
        
       
         , 
        
       
         0 
        
       
         ] 
        
       
      
        x=[4,3,2,6,7,8,9,0] 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">7</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">9</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">0</span><span class="mclose">]</span></span></span></span></span>，求<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         X 
        
       
         ( 
        
       
         k 
        
       
         ) 
        
       
         = 
        
       
         D 
        
       
         F 
        
       
         T 
        
       
         [ 
        
       
         x 
        
       
         ( 
        
       
         n 
        
       
         ) 
        
       
         ] 
        
       
      
        X(k)=DFT[x(n)] 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">D</span><span class="mord mathnormal" style="margin-right: 0.1389em;">FT</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)]</span></span></span></span></span><br> 代码非常简单，只有两行</p> 
<pre><code class="prism language-javascript">x<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
xk<span class="token operator">=</span><span class="token function">fft</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d2/8e/YXEjwzyk_o.png" alt="在这里插入图片描述"><br> 一般，对MATLAB而言，要想让它显示出结果，计算的部分不要加分号。<br> <strong>2.绘制128点DFT的幅频图</strong><br> 已知信号由15Hz幅值0.5的正弦信号和40Hz幅值2的正弦信号组成，数据采样频率为100Hz,试绘制N=128点DFT的幅频图。<br> 关于下列代码的解释</p> 
<pre><code class="prism language-javascript">f<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token constant">N</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>'<span class="token operator">*</span>fs<span class="token operator">/</span><span class="token constant">N</span><span class="token punctuation">;</span>
</code></pre> 
<p>其中(0:N-1)'是生成了一个长度为N，间隔为1的列向量转置所得到的行向量。fs/N是指频域上的频率间隔。<br> 若N点序列x(n)(n=0,1,…,N-1)是在采样频率fs(Hz)下获得的。它的FFT也是N点序列，即X(k)（k=0,1,…,N-1），则第K点对应实际频率值为:<br> f=k*fs/N</p> 
<pre><code class="prism language-javascript">clc<span class="token punctuation">;</span>
fs<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span>
Ts<span class="token operator">=</span><span class="token number">1</span><span class="token operator">/</span>fs<span class="token punctuation">;</span><span class="token operator">%</span>采样时间间隔
<span class="token constant">N</span><span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">;</span>
n<span class="token operator">=</span><span class="token number">0</span><span class="token operator">:</span><span class="token constant">N</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
t<span class="token operator">=</span>n<span class="token operator">*</span>Ts<span class="token punctuation">;</span>    <span class="token operator">%</span>x不是直接关于n的函数，因为是固定的采样时间点
x<span class="token operator">=</span><span class="token number">0.5</span><span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span><span class="token number">15</span><span class="token operator">*</span>t<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span><span class="token number">40</span><span class="token operator">*</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>

y<span class="token operator">=</span><span class="token function">fft</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token constant">N</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
f<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token constant">N</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>'<span class="token operator">*</span>fs<span class="token operator">/</span><span class="token constant">N</span><span class="token punctuation">;</span>
<span class="token function">stem</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span><span class="token function">abs</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>运行结果</strong><br> <img src="https://images2.imgbox.com/52/ee/GtgKVgh3_o.png" alt="在这里插入图片描述"><br> 同时也可以可看到这个幅度谱是关于fN对称的。<br> <strong>3.利用FFT进行功率谱的噪声分析</strong><br> 已知带有测量噪声信号<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         x 
        
       
         ( 
        
       
         t 
        
       
         ) 
        
       
         = 
        
       
         s 
        
       
         i 
        
       
         n 
        
       
         ( 
        
       
         2 
        
       
         π 
        
       
         f 
        
       
         1 
        
       
         t 
        
       
         ) 
        
       
         + 
        
       
         s 
        
       
         i 
        
       
         n 
        
       
         ( 
        
       
         2 
        
       
         π 
        
       
         f 
        
       
         2 
        
       
         t 
        
       
         ) 
        
       
         + 
        
       
         2 
        
       
         w 
        
       
         ( 
        
       
         t 
        
       
         ) 
        
       
      
        x(t)=sin(2πf1t)+sin(2πf2t)+2w(t) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">in</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right: 0.0359em;">π</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mord">1</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">in</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right: 0.0359em;">π</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mord">2</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span> 其中f1=50Hz，f2=120Hz， w(t)为均值为零、方差为1的随机信号，采样频率为1000Hz，数据点数N=512。试绘制信号的功率谱图。<br> 下面先介绍几个基本的函数和知识：<br> <strong>conj(Y)</strong><br> conj(Y) 是 MATLAB 中的一个函数，表示对 Y 中的每个元素取其共轭复数。如果 Y 是一个实数数组，则返回其本身。在信号处理中，常常使用共轭复数进行频域变换的处理。<br> <strong>求功率</strong><br> P=Y.*conj(Y)/512;<br> 注意这里是点乘啊。<br> 在信号处理中，功率可以表示为信号的平均能量。对于一个离散时间信号，其能量可以表示为其幅度平方的总和，即：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          E 
         
        
          = 
         
         
         
           ∑ 
          
          
          
            n 
           
          
            = 
           
          
            0 
           
          
          
          
            N 
           
          
            − 
           
          
            1 
           
          
         
        
          ∣ 
         
        
          x 
         
        
          [ 
         
        
          n 
         
        
          ] 
         
         
         
           ∣ 
          
         
           2 
          
         
        
       
         E = \sum_{n=0}^{N-1} |x[n]|^2 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0576em;">E</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3.0954em; vertical-align: -1.2671em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.8283em;"><span class="" style="top: -1.8829em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.109em;">N</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.2671em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span><br> 其中，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         N 
        
       
      
        N 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span></span></span></span></span> 是信号的抽样点数，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         x 
        
       
         [ 
        
       
         n 
        
       
         ] 
        
       
      
        x[n] 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span></span> 是信号在时刻 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         n 
        
       
      
        n 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span> 的采样值。这里的 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ∣ 
        
       
         x 
        
       
         [ 
        
       
         n 
        
       
         ] 
        
        
        
          ∣ 
         
        
          2 
         
        
       
      
        |x[n]|^2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0641em; vertical-align: -0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> 表示对 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         x 
        
       
         [ 
        
       
         n 
        
       
         ] 
        
       
      
        x[n] 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span></span> 取模长平方。<br> 如果要计算信号的平均功率，可以将其总能量除以抽样点数，即：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          P 
         
        
          = 
         
         
         
           E 
          
         
           N 
          
         
        
          = 
         
         
         
           1 
          
         
           N 
          
         
         
         
           ∑ 
          
          
          
            n 
           
          
            = 
           
          
            0 
           
          
          
          
            N 
           
          
            − 
           
          
            1 
           
          
         
        
          ∣ 
         
        
          x 
         
        
          [ 
         
        
          n 
         
        
          ] 
         
         
         
           ∣ 
          
         
           2 
          
         
        
       
         P = \frac{E}{N} = \frac{1}{N} \sum_{n=0}^{N-1} |x[n]|^2 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.0463em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3603em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.109em;">N</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0576em;">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3.0954em; vertical-align: -1.2671em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.109em;">N</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.8283em;"><span class="" style="top: -1.8829em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.109em;">N</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.2671em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span><br> 这里的 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         P 
        
       
      
        P 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span></span></span></span></span> 表示信号的功率。<br> 在代码中，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Y 
        
       
      
        Y 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span></span></span></span></span> 表示信号的离散傅里叶变换，即频域表示，其幅度 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ∣ 
        
       
         Y 
        
       
         ∣ 
        
       
      
        |Y| 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="mord">∣</span></span></span></span></span> 表示信号在每个频率分量上的贡献。为了计算信号的功率谱，需要将 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Y 
        
       
      
        Y 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span></span></span></span></span> 变换为其幅度平方，即 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ∣ 
        
       
         Y 
        
        
        
          ∣ 
         
        
          2 
         
        
       
      
        |Y|^2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0641em; vertical-align: -0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>。由于 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Y 
        
       
      
        Y 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span></span></span></span></span> 中包含了正频率和负频率的信息，因此需要对其进行共轭操作，即将负频率部分取共轭复数，然后再与正频率部分相乘，即 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Y 
        
       
         ⋅ 
        
       
         conj 
        
       
         ⁡ 
        
       
         ( 
        
       
         Y 
        
       
         ) 
        
       
      
        Y \cdot \operatorname{conj}(Y) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop"><span class="mord mathrm">conj</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="mclose">)</span></span></span></span></span>。最后将结果除以抽样点数 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         N 
        
       
      
        N 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span></span></span></span></span>，即可得到功率谱 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         P 
        
       
      
        P 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span></span></span></span></span>：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          P 
         
        
          = 
         
         
          
          
            Y 
           
          
            ⋅ 
           
          
            conj 
           
          
            ⁡ 
           
          
            ( 
           
          
            Y 
           
          
            ) 
           
          
         
           N 
          
         
        
       
         P = \frac{Y \cdot \operatorname{conj}(Y)}{N} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.113em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.109em;">N</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mop"><span class="mord mathrm">conj</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span><br> 这里的 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         P 
        
       
      
        P 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span></span></span></span></span> 是一个长度为 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         N 
        
       
      
        N 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.109em;">N</span></span></span></span></span> 的向量，表示信号在每个频率分量上的功率。<br> <strong>randn</strong><br> andn是MATLAB中的一个函数，用于生成一个均值为0，方差为1的标准正态分布随机数。例如，可以使用以下代码生成一个大小为3x3的标准正态分布随机矩阵：<br> A = randn(3,3);<br> <strong>完整代码</strong></p> 
<pre><code class="prism language-javascript">clc<span class="token punctuation">;</span>
t<span class="token operator">=</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">0.001</span><span class="token operator">:</span><span class="token number">0.6</span><span class="token punctuation">;</span><span class="token operator">%</span>设置步进与时间区间
x<span class="token operator">=</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span><span class="token number">50</span><span class="token operator">*</span>t<span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span><span class="token number">120</span><span class="token operator">*</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>根据已知写出信号的表达式
noise<span class="token operator">=</span><span class="token function">randn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token function">length</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>生成均值为零、方差为<span class="token number">1</span>的随机信号，也就是噪声
y<span class="token operator">=</span>x<span class="token operator">+</span>noise<span class="token punctuation">;</span><span class="token operator">%</span>带有噪声的信号
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">121</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>

fs<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">;</span>
<span class="token constant">Y</span><span class="token operator">=</span><span class="token function">fft</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span><span class="token number">512</span>点的<span class="token constant">FFT</span>
<span class="token constant">P</span><span class="token operator">=</span><span class="token constant">Y</span><span class="token punctuation">.</span><span class="token operator">*</span><span class="token function">conj</span><span class="token punctuation">(</span><span class="token constant">Y</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">512</span><span class="token punctuation">;</span><span class="token operator">%</span>求功率
f<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token operator">*</span>fs<span class="token operator">/</span><span class="token number">256</span><span class="token operator">%</span>由上面的分析可知，频谱关于奈奎斯特频率对称，所以取其中一半
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span><span class="token constant">P</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span>功率随频率的变化，即功率谱图<span class="token punctuation">,</span>绘制出一半
</code></pre> 
<p><strong>运行结果：</strong><br> <img src="https://images2.imgbox.com/95/d1/BCTehOic_o.png" alt="在这里插入图片描述"><br> <strong>4.序列长度和FFT的长度对信号频谱的影响</strong><br> 已知信号 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         x 
        
       
         ( 
        
       
         t 
        
       
         ) 
        
       
         = 
        
       
         0.5 
        
       
         s 
        
       
         i 
        
       
         n 
        
       
         ( 
        
       
         2 
        
       
         π 
        
       
         f 
        
       
         1 
        
       
         t 
        
       
         ) 
        
       
         + 
        
       
         2 
        
       
         s 
        
       
         i 
        
       
         n 
        
       
         ( 
        
       
         2 
        
       
         π 
        
       
         f 
        
       
         2 
        
       
         t 
        
       
         ) 
        
       
      
        x(t)=0.5sin(2πf1t)+2sin(2πf2t) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">0.5</span><span class="mord mathnormal">s</span><span class="mord mathnormal">in</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right: 0.0359em;">π</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mord">1</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mord mathnormal">s</span><span class="mord mathnormal">in</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right: 0.0359em;">π</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mord">2</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span><br> 其中f1=15Hz,f2=40Hz,采样频率为100Hz.<br> 在下列情况下绘制其幅频谱。<br> 有了前面的基础，这里就比较简单了<br> <strong>代码</strong></p> 
<pre><code class="prism language-javascript">nlength<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">;</span>
nfft1<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">;</span>
nfft2<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">;</span>
fs<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span>
Ts<span class="token operator">=</span><span class="token number">1</span><span class="token operator">/</span>fs<span class="token punctuation">;</span>
n<span class="token operator">=</span><span class="token number">0</span><span class="token operator">:</span>nlength<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
t<span class="token operator">=</span>n<span class="token operator">*</span>Ts<span class="token punctuation">;</span>

x<span class="token operator">=</span><span class="token number">0.5</span><span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span><span class="token number">15</span><span class="token operator">*</span>t<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token operator">*</span><span class="token number">40</span><span class="token operator">*</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>

y1<span class="token operator">=</span><span class="token function">fft</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>nfft1<span class="token punctuation">)</span><span class="token punctuation">;</span>
f1<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">31</span><span class="token punctuation">)</span><span class="token operator">*</span>fs<span class="token operator">/</span><span class="token number">32</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">211</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token constant">Y1</span><span class="token operator">=</span><span class="token function">abs</span><span class="token punctuation">(</span>y1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span><span class="token function">f1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token constant">Y1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

y2<span class="token operator">=</span><span class="token function">fft</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>nfft2<span class="token punctuation">)</span><span class="token punctuation">;</span>
f2<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">127</span><span class="token punctuation">)</span><span class="token operator">*</span>fs<span class="token operator">/</span><span class="token number">128</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">212</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token constant">Y2</span><span class="token operator">=</span><span class="token function">abs</span><span class="token punctuation">(</span>y2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span><span class="token function">f2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token constant">Y2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>运行结果</strong><br> <img src="https://images2.imgbox.com/3c/ed/nisZOXKW_o.png" alt="在这里插入图片描述"><br> <strong>结果分析</strong><br> 采样点数越多，其频谱越光滑。<br> <strong>注意</strong><br> 绘制图形的时候，一定要分析清楚是频谱图，还是某一个变换，其目的在于分清谁是因变量，谁是自变量。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a5cbb42b6b59ce4cbe9ae226ed81bdee/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">六种常用滤波算法代码实现及效果</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/84ed0aa6fbfa4bc7453df332859ee616/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【CSS】CSS 背景设置 ② ( 背景位置 | 背景位置-方位值设置 )</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>