<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>毕业设计项目 基于大数据的电影数据爬取分析可视化系统 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/017919ec0b6fe57f05c308005af0135e/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="毕业设计项目 基于大数据的电影数据爬取分析可视化系统">
  <meta property="og:description" content="文章目录 0 前言1 课题背景2 项目效果展示2.1 主界面展示2.2电影数据查询2.3可视化展示 3 数据爬取3.1 Requests3.2 bs43.3 MySQL数据库 4 可视化技术4.1 Flask4.2 ECharts补充：不做成web系统 5 最后 0 前言 🔥 这两年开始毕业设计和毕业答辩的要求和难度不断提升，传统的毕设题目缺少创新和亮点，往往达不到毕业答辩的要求，这两年不断有学弟学妹告诉学长自己做的项目系统达不到老师的要求。
为了大家能够顺利以及最少的精力通过毕设，学长分享优质毕业设计项目，今天要分享的是
🚩 基于大数据的电影数据爬取分析可视化系统
🥇学长这里给一个题目综合评分(每项满分5分)
难度系数：4分工作量：4分创新点：3分 🧿 选题指导, 项目分享：见文末
1 课题背景 随着互联网的快速发展，越来越多的人喜欢在微博、知乎、豆瓣等社交网站上发表自己对某些事物的想法、态度或意见。用户同时也会将自己购买的产品或体验到的服务，在这些社区式的网站上评价，这样通常会带动他人也前去购买或体验，形成口碑效应。
社交应用及网站上有源源不断的信息发布，这些信息中隐含着大量对我们及企业有收集价值的资源。就像用户评分和评价系统中，用户不但会对作品进行评比，还分享和传播了作品信息。如果能够获取这些数据并对其进行分析，可以让人们挑选到满意的书籍、选择出一部精彩的电影，也可以帮助企业改进产品的服务等。使用爬虫程序可以高效地对社交网站上的信息进行收集、组织和管理。豆瓣网作为社交网站的代表，提供了在图书、电影和音乐等方面独树一帜的评分、推荐及比价体系，在社交网络中产生了深远的影响。
2 项目效果展示 2.1 主界面展示 2.2电影数据查询 管理员可对电影数据进行查询，可根据“最低评分”，“最高评分”，“上映年份”，“电影类型”，“上映地区”，“影名关键字”等标签进行筛选、查询。
2.3可视化展示 电影类型矩形图：可以清楚的看到剧情，纪录片，喜剧类型的电影所占比重较大。 上映年份漏斗图：可以看到中国、美国上映地区较多。 上映年份分布、电影评分分布图。 时间轴图：可随年份动态变化效果。 地区类型分布饼状图 频数统计词云图：可根据主演、导演、编剧和电影排名生成相应的词云图 3 数据爬取 3.1 Requests requests是Python用于网络请求的第三库，也是爬虫获取网络数据的重要工具，使用的时候需要导入
本项目中相关代码：
import requests from bs4 import BeautifulSoup from lxml import html etree = html.etree import csv # 请求头 headers = { &#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-13T15:06:20+08:00">
    <meta property="article:modified_time" content="2024-04-13T15:06:20+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">毕业设计项目 基于大数据的电影数据爬取分析可视化系统</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#0__4" rel="nofollow">0 前言</a></li><li><a href="#1__26" rel="nofollow">1 课题背景</a></li><li><a href="#2__34" rel="nofollow">2 项目效果展示</a></li><li><ul><li><a href="#21__36" rel="nofollow">2.1 主界面展示</a></li><li><a href="#22_41" rel="nofollow">2.2电影数据查询</a></li><li><a href="#23_50" rel="nofollow">2.3可视化展示</a></li></ul> 
  </li><li><a href="#3__90" rel="nofollow">3 数据爬取</a></li><li><ul><li><a href="#31_Requests_92" rel="nofollow">3.1 Requests</a></li><li><a href="#32_bs4_153" rel="nofollow">3.2 bs4</a></li><li><a href="#33_MySQL_163" rel="nofollow">3.3 MySQL数据库</a></li></ul> 
  </li><li><a href="#4__188" rel="nofollow">4 可视化技术</a></li><li><ul><li><a href="#41_Flask_190" rel="nofollow">4.1 Flask</a></li><li><a href="#42_ECharts_332" rel="nofollow">4.2 ECharts</a></li><li><a href="#web_644" rel="nofollow">补充：不做成web系统</a></li></ul> 
  </li><li><a href="#5__947" rel="nofollow">5 最后</a></li></ul> 
</div> 
<p></p> 
<hr color="#000000" size='1"'> 
<h2><a id="0__4"></a>0 前言</h2> 
<p>🔥 这两年开始毕业设计和毕业答辩的要求和难度不断提升，传统的毕设题目缺少创新和亮点，往往达不到毕业答辩的要求，这两年不断有学弟学妹告诉学长自己做的项目系统达不到老师的要求。</p> 
<p>为了大家能够顺利以及最少的精力通过毕设，学长分享优质毕业设计项目，今天要分享的是</p> 
<p>🚩 <strong>基于大数据的电影数据爬取分析可视化系统</strong></p> 
<p>🥇学长这里给一个题目综合评分(每项满分5分)</p> 
<ul><li>难度系数：4分</li><li>工作量：4分</li><li>创新点：3分</li></ul> 
<p>🧿 <strong>选题指导, 项目分享：见文末</strong></p> 
<br> 
<hr color="#000000" size='1"'> 
<h2><a id="1__26"></a>1 课题背景</h2> 
<p>随着互联网的快速发展，越来越多的人喜欢在微博、知乎、豆瓣等社交网站上发表自己对某些事物的想法、态度或意见。用户同时也会将自己购买的产品或体验到的服务，在这些社区式的网站上评价，这样通常会带动他人也前去购买或体验，形成口碑效应。</p> 
<p>社交应用及网站上有源源不断的信息发布，这些信息中隐含着大量对我们及企业有收集价值的资源。就像用户评分和评价系统中，用户不但会对作品进行评比，还分享和传播了作品信息。如果能够获取这些数据并对其进行分析，可以让人们挑选到满意的书籍、选择出一部精彩的电影，也可以帮助企业改进产品的服务等。使用爬虫程序可以高效地对社交网站上的信息进行收集、组织和管理。豆瓣网作为社交网站的代表，提供了在图书、电影和音乐等方面独树一帜的评分、推荐及比价体系，在社交网络中产生了深远的影响。</p> 
<br> 
<h2><a id="2__34"></a>2 项目效果展示</h2> 
<h3><a id="21__36"></a>2.1 主界面展示</h3> 
<p><img src="https://images2.imgbox.com/ad/8b/GrhPxnSG_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="22_41"></a>2.2电影数据查询</h3> 
<p>管理员可对电影数据进行查询，可根据“最低评分”，“最高评分”，“上映年份”，“电影类型”，“上映地区”，“影名关键字”等标签进行筛选、查询。</p> 
<p><img src="https://images2.imgbox.com/27/67/mgTQf2WF_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="23_50"></a>2.3可视化展示</h3> 
<ul><li>电影类型矩形图：可以清楚的看到剧情，纪录片，喜剧类型的电影所占比重较大。</li></ul> 
<p><img src="https://images2.imgbox.com/59/ec/PtdVww3f_o.png" alt="在这里插入图片描述"></p> 
<ul><li>上映年份漏斗图：可以看到中国、美国上映地区较多。</li></ul> 
<p><img src="https://images2.imgbox.com/fe/0e/KJIJguEJ_o.png" alt="在这里插入图片描述"></p> 
<ul><li>上映年份分布、电影评分分布图。</li></ul> 
<p><img src="https://images2.imgbox.com/f0/c4/XI6fNKse_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/00/2c/E8ZQG3Oj_o.png" alt="在这里插入图片描述"></p> 
<ul><li>时间轴图：可随年份动态变化效果。</li></ul> 
<p><img src="https://images2.imgbox.com/33/ee/4CtsdUxM_o.png" alt="在这里插入图片描述"></p> 
<ul><li>地区类型分布饼状图</li></ul> 
<p><img src="https://images2.imgbox.com/c2/80/NnEhiuY8_o.png" alt="在这里插入图片描述"></p> 
<ul><li>频数统计词云图：可根据主演、导演、编剧和电影排名生成相应的词云图</li></ul> 
<p><img src="https://images2.imgbox.com/73/ca/XVtqaQ0P_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="3__90"></a>3 数据爬取</h2> 
<h3><a id="31_Requests_92"></a>3.1 Requests</h3> 
<p><strong>requests</strong>是Python用于网络请求的第三库，也是爬虫获取网络数据的重要工具，使用的时候需要导入</p> 
<p>本项目中相关代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup
<span class="token keyword">from</span> lxml <span class="token keyword">import</span> html

etree <span class="token operator">=</span> html<span class="token punctuation">.</span>etree
<span class="token keyword">import</span> csv

<span class="token comment"># 请求头</span>
headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36"</span>
<span class="token punctuation">}</span>
hrefs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>


<span class="token comment"># 爬取豆瓣电影TOP250的url</span>
<span class="token comment"># 获取电影详情页url</span>
<span class="token keyword">def</span> <span class="token function">get_film_url</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
        selector <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
        movie_hrefs <span class="token operator">=</span> selector<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="hd"]/a/@href'</span><span class="token punctuation">)</span>  <span class="token comment"># 电影的详情地址</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>movie_hrefs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            hrefs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>movie_hrefs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>


<span class="token comment"># 保存电影链接url</span>
<span class="token keyword">def</span> <span class="token function">save_url</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token comment"># 获取链接</span>
        <span class="token keyword">for</span> href <span class="token keyword">in</span> hrefs<span class="token punctuation">:</span>
            <span class="token comment"># 存入csv</span>
            file_path <span class="token operator">=</span> <span class="token string">"./豆瓣电影TOP250链接.csv"</span>
            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">"a+"</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'gb18030'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> csvfile<span class="token punctuation">:</span>
                writer <span class="token operator">=</span> csv<span class="token punctuation">.</span>writer<span class="token punctuation">(</span>csvfile<span class="token punctuation">)</span>
                writer<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span><span class="token punctuation">[</span>href<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 爬取豆瓣电影TOP250的url</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        url <span class="token operator">=</span> <span class="token string">"https://movie.douban.com/top250?start="</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">""</span>
        get_film_url<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    save_url<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<h3><a id="32_bs4_153"></a>3.2 bs4</h3> 
<p>bs4即BeautifulSoup，是python种的一个库，最主要的内容就是从网页中抓取数据。</p> 
<p>Beautiful Soup提供一些简单的、python式的函数用来处理导航、搜索、修改分析树等功能。它是一个工具箱，通过解析文档为用户提供需要抓取的数据，因为简单，所以不需要多少代码就可以写出一个完整的应用程序。</p> 
<p>Beautiful Soup自动将输入文档转换为Unicode编码，输出文档转换为utf-8编码。你不需要考虑编码方式，除非文档没有指定一个编码方式，这时，Beautiful Soup就不能自动识别编码方式了。然后，你仅仅需要说明一下原始编码方式就可以了。</p> 
<p>Beautiful Soup已成为和lxml、html6lib一样出色的python解释器，为用户灵活地提供不同的解析策略或强劲的速度。</p> 
<h3><a id="33_MySQL_163"></a>3.3 MySQL数据库</h3> 
<p>利用Pymysql，将爬取到的数据存入数据库中，相关代码如下：</p> 
<pre><code class="prism language-python"> <span class="token comment"># 打开数据库连接</span>
        conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span> user<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> passwd<span class="token operator">=</span><span class="token string">'123456'</span><span class="token punctuation">,</span> db<span class="token operator">=</span><span class="token string">'douban'</span><span class="token punctuation">,</span> charset<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
        <span class="token comment"># 使用cursor方法创建一个游标</span>
        cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># # 执行sql语句</span>
<span class="token comment">#        query = 'insert into tb_film(url, filmname, score, showtime, genres, areas, mins, directors, scriptwriters, actors, comments) values(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s)'</span>
        query <span class="token operator">=</span> <span class="token string">'insert into tb_film(url, filmname, score, showtime, genres, areas, directors, scriptwriters, actors, comments) values(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s)'</span>

        values <span class="token operator">=</span> <span class="token punctuation">(</span>
            url<span class="token punctuation">,</span> filmname<span class="token punctuation">,</span> score<span class="token punctuation">,</span> showtime<span class="token punctuation">,</span> genres_list<span class="token punctuation">,</span> area_list<span class="token punctuation">,</span>  directors_list<span class="token punctuation">,</span> scriptwriters_list<span class="token punctuation">,</span>
            actors_list<span class="token punctuation">,</span>
            comment<span class="token punctuation">)</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>query<span class="token punctuation">,</span> values<span class="token punctuation">)</span>
        <span class="token comment"># 提交之前的操作，如果之前已经执行多次的execute，那么就都进行提交</span>
        conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<br> 
<h2><a id="4__188"></a>4 可视化技术</h2> 
<h3><a id="41_Flask_190"></a>4.1 Flask</h3> 
<p>Flask是一个基于Werkzeug和Jinja2的轻量级Web应用程序框架。与其他同类型框架相比，Flask的灵活性、轻便性和安全性更高，而且容易上手，它可以与MVC模式很好地结合进行开发。Flask也有强大的定制性，开发者可以依据实际需要增加相应的功能，在实现丰富的功能和扩展的同时能够保证核心功能的简单。Flask丰富的插件库能够让用户实现网站定制的个性化，从而开发出功能强大的网站。</p> 
<p>本项目在Flask开发后端时，前端请求会遇到跨域的问题，解决该问题有修改数据类型为jsonp，采用GET方法，或者在Flask端加上响应头等方式，在此使用安装Flask-CORS库的方式解决跨域问题。此外需要安装请求库axios。</p> 
<p>部分相关代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask
<span class="token keyword">from</span> flask <span class="token keyword">import</span> request<span class="token punctuation">,</span> redirect
<span class="token keyword">from</span> flask <span class="token keyword">import</span> render_template<span class="token punctuation">,</span> url_for
<span class="token keyword">from</span> flask_paginate <span class="token keyword">import</span> Pagination
<span class="token keyword">from</span> sqlalchemy <span class="token keyword">import</span> create_engine<span class="token punctuation">,</span>Column<span class="token punctuation">,</span>Integer<span class="token punctuation">,</span>SmallInteger<span class="token punctuation">,</span>String
<span class="token keyword">from</span> sqlalchemy <span class="token keyword">import</span> create_engine
<span class="token keyword">from</span> sqlalchemy<span class="token punctuation">.</span>orm <span class="token keyword">import</span> sessionmaker
<span class="token keyword">from</span> sqlalchemy<span class="token punctuation">.</span>ext<span class="token punctuation">.</span>declarative <span class="token keyword">import</span> declarative_base
<span class="token keyword">from</span> flask_sqlalchemy <span class="token keyword">import</span> SQLAlchemy
db <span class="token operator">=</span> SQLAlchemy<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> list_data <span class="token keyword">import</span> select_score<span class="token punctuation">,</span> select_showtime<span class="token punctuation">,</span> select_genres<span class="token punctuation">,</span> select_areas<span class="token punctuation">,</span> film_data
<span class="token keyword">from</span> genres <span class="token keyword">import</span> show_genres
<span class="token keyword">from</span> areas <span class="token keyword">import</span> show_areas
<span class="token keyword">from</span> showtime <span class="token keyword">import</span> show_showtime
<span class="token keyword">from</span> score <span class="token keyword">import</span> show_score
<span class="token keyword">from</span> timeline_score <span class="token keyword">import</span> show_score_top
<span class="token keyword">from</span> timeline_comment <span class="token keyword">import</span> show_comment_top
<span class="token keyword">from</span> select_showtime <span class="token keyword">import</span> select_showtime
<span class="token keyword">from</span> select_showtime <span class="token keyword">import</span> showtime_group
<span class="token keyword">from</span> film_search <span class="token keyword">import</span> film_search

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>jinja_env<span class="token punctuation">.</span>auto_reload <span class="token operator">=</span> <span class="token boolean">True</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'TEMPLATES_AUTO_RELOAD'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">True</span>

<span class="token comment">#初始化数据库连接</span>
engine <span class="token operator">=</span> create_engine<span class="token punctuation">(</span><span class="token string">"mysql+pymysql://root:123456@localhost:3306/douban?charset=utf8"</span><span class="token punctuation">,</span>echo <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token comment">#创建缓存对象</span>
Session <span class="token operator">=</span>sessionmaker<span class="token punctuation">(</span>bind<span class="token operator">=</span>engine<span class="token punctuation">)</span>
session <span class="token operator">=</span>Session
<span class="token comment">#声明基类</span>
Base <span class="token operator">=</span> declarative_base<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">#定义Film对象</span>
<span class="token comment">#基于这个基类来创建我们的自定义类，一个类就是一个数据库表；</span>
<span class="token keyword">class</span> <span class="token class-name">Film</span><span class="token punctuation">(</span>Base<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#表的名字</span>
    __tablename__<span class="token operator">=</span> <span class="token string">'tb_film'</span>
    <span class="token comment">#表的结构</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> Column<span class="token punctuation">(</span>Integer<span class="token punctuation">,</span>primary_key<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>autoincrement<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    url <span class="token operator">=</span>Column<span class="token punctuation">(</span>String<span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    filmname <span class="token operator">=</span>Column<span class="token punctuation">(</span>String<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    score <span class="token operator">=</span>Column<span class="token punctuation">(</span>String<span class="token punctuation">)</span>
    comments <span class="token operator">=</span>Column<span class="token punctuation">(</span>Integer<span class="token punctuation">)</span>
    showtime <span class="token operator">=</span>Column<span class="token punctuation">(</span>Integer<span class="token punctuation">)</span>
    genres <span class="token operator">=</span>Column<span class="token punctuation">(</span>String<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    areas <span class="token operator">=</span>Column<span class="token punctuation">(</span>String<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    actors <span class="token operator">=</span>Column<span class="token punctuation">(</span>String<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    directors <span class="token operator">=</span>Column<span class="token punctuation">(</span>String<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    scriptwriters <span class="token operator">=</span>Column<span class="token punctuation">(</span>String<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># return render_template('pages/echarts/e1.html')</span>
    <span class="token comment"># return render_template('index.html')</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'login.html'</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/register'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># return render_template('pages/echarts/e1.html')</span>
    <span class="token comment"># return render_template('index.html')</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'register.html'</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/index'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">welcom2index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># return render_template('pages/echarts/e1.html')</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span>
    <span class="token comment"># return render_template('login.html')</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/welcome'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">welcome</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'pages/welcome.html'</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/page_none"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">page_none</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'page_none'</span><span class="token punctuation">)</span>

<span class="token comment"># 验证用户名和密码</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">#@app.route('/index')</span>
<span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># 需要从request对象读取表单内容：</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'admin'</span> <span class="token keyword">and</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'123456'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span>

<span class="token comment"># 表单list</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/list"</span><span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/list/"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">list</span><span class="token punctuation">(</span>limit<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 列表属性</span>
    t_low <span class="token operator">=</span> select_score<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    t_high <span class="token operator">=</span> select_score<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    t_showtime <span class="token operator">=</span> select_showtime<span class="token punctuation">(</span><span class="token punctuation">)</span>
    t_genres <span class="token operator">=</span> select_genres<span class="token punctuation">(</span><span class="token punctuation">)</span>
    t_areas <span class="token operator">=</span> select_areas<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 分页</span>
    <span class="token comment"># limit = 15</span>
    page <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"page"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    start <span class="token operator">=</span> <span class="token punctuation">(</span>page <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> limit
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"low"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"high"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"showtime"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"areas"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"genres"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"filmname"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 参数选择</span>
        r_low <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"low"</span><span class="token punctuation">)</span>
        r_high <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"high"</span><span class="token punctuation">)</span>
        r_showtime <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"showtime"</span><span class="token punctuation">)</span>
        r_genres <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"genres"</span><span class="token punctuation">)</span>
        r_areas <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"areas"</span><span class="token punctuation">)</span>
        r_filmname <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"filmname"</span><span class="token punctuation">)</span>
        <span class="token comment"># 返回数据</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"参数：{},{},{},{},{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>r_low<span class="token punctuation">,</span> r_high<span class="token punctuation">,</span> r_showtime<span class="token punctuation">,</span> r_genres<span class="token punctuation">,</span> r_areas<span class="token punctuation">,</span>r_filmname<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"参数1：{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>r_low<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"参数2：{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>r_low<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        r_films <span class="token operator">=</span> film_data<span class="token punctuation">(</span>low<span class="token operator">=</span>r_low<span class="token punctuation">,</span> high<span class="token operator">=</span>r_high<span class="token punctuation">,</span> showtime<span class="token operator">=</span>r_showtime<span class="token punctuation">,</span> genres<span class="token operator">=</span>r_genres<span class="token punctuation">,</span> areas<span class="token operator">=</span>r_areas<span class="token punctuation">,</span> filmname<span class="token operator">=</span>r_filmname<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        r_row <span class="token operator">=</span> film_data<span class="token punctuation">(</span>low<span class="token operator">=</span>r_low<span class="token punctuation">,</span> high<span class="token operator">=</span>r_high<span class="token punctuation">,</span> showtime<span class="token operator">=</span>r_showtime<span class="token punctuation">,</span> genres<span class="token operator">=</span>r_genres<span class="token punctuation">,</span> areas<span class="token operator">=</span>r_areas<span class="token punctuation">,</span> filmname<span class="token operator">=</span>r_filmname<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token comment"># 分页</span>
        r_end <span class="token operator">=</span> page <span class="token operator">*</span> limit <span class="token keyword">if</span> r_row <span class="token operator">&gt;</span> page <span class="token operator">*</span> limit <span class="token keyword">else</span> r_row
        r_paginate <span class="token operator">=</span> Pagination<span class="token punctuation">(</span>page<span class="token operator">=</span>page<span class="token punctuation">,</span> total<span class="token operator">=</span>r_row<span class="token punctuation">)</span>
        r_ret <span class="token operator">=</span> r_films<span class="token punctuation">[</span>start<span class="token punctuation">:</span>r_end<span class="token punctuation">]</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'pages/order/list.html'</span><span class="token punctuation">,</span> low<span class="token operator">=</span>t_low<span class="token punctuation">,</span> high<span class="token operator">=</span>t_high<span class="token punctuation">,</span> showtime<span class="token operator">=</span>t_showtime<span class="token punctuation">,</span> genres<span class="token operator">=</span>t_genres<span class="token punctuation">,</span>
                           areas<span class="token operator">=</span>t_areas<span class="token punctuation">,</span> films<span class="token operator">=</span>r_ret<span class="token punctuation">,</span> row<span class="token operator">=</span>r_row<span class="token punctuation">,</span>paginate<span class="token operator">=</span>r_paginate<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token comment"># 返回数据</span>
        films <span class="token operator">=</span> film_data<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        row <span class="token operator">=</span> film_data<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        end <span class="token operator">=</span> page <span class="token operator">*</span> limit <span class="token keyword">if</span> row <span class="token operator">&gt;</span> page <span class="token operator">*</span> limit <span class="token keyword">else</span> row
        paginate <span class="token operator">=</span> Pagination<span class="token punctuation">(</span>page<span class="token operator">=</span>page<span class="token punctuation">,</span> total<span class="token operator">=</span>row<span class="token punctuation">)</span>
        ret<span class="token operator">=</span>films<span class="token punctuation">[</span>start<span class="token punctuation">:</span>end<span class="token punctuation">]</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"res:{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'pages/order/list.html'</span><span class="token punctuation">,</span> low<span class="token operator">=</span>t_low<span class="token punctuation">,</span> high<span class="token operator">=</span>t_high<span class="token punctuation">,</span> showtime<span class="token operator">=</span>t_showtime<span class="token punctuation">,</span> genres<span class="token operator">=</span>t_genres<span class="token punctuation">,</span>
                           areas<span class="token operator">=</span>t_areas<span class="token punctuation">,</span> films<span class="token operator">=</span>ret<span class="token punctuation">,</span>row<span class="token operator">=</span>row<span class="token punctuation">,</span> paginate<span class="token operator">=</span>paginate<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="42_ECharts_332"></a>4.2 ECharts</h3> 
<p>ECharts（Enterprise Charts）是百度开源的数据可视化工具，底层依赖轻量级Canvas库ZRender。兼容了几乎全部常用浏览器的特点，使它可广泛用于PC客户端和手机客户端。ECharts能辅助开发者整合用户数据，创新性的完成个性化设置可视化图表。支持折线图（区域图）、柱状图（条状图）、散点图（气泡图）、K线图、饼图（环形图）等，通过导入 js 库在 Java Web 项目上运行。</p> 
<p><strong>数据预览</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> json

<span class="token comment"># =============================================加载数据===================================</span>

<span class="token comment"># 加载数据 --credits</span>
credits <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./tmdb_5000_credits.csv'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'credits:\n'</span><span class="token punctuation">,</span> credits<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'*'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'credits:\n'</span><span class="token punctuation">,</span> credits<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'*'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'credits:\n'</span><span class="token punctuation">,</span> credits<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'*'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>

<span class="token comment"># 加载数据</span>
movies <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./tmdb_5000_movies.csv'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'movies:\n'</span><span class="token punctuation">,</span> movies<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'movies:\n'</span><span class="token punctuation">,</span> movies<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'movies:\n'</span><span class="token punctuation">,</span> movies<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/78/08/f8trYdoH_o.png" alt="在这里插入图片描述"></p> 
<p><strong>合并数据集</strong></p> 
<p>先将 credits 数据集和 movie 数据集中的数据合并在一起，再查看合并后的数据集信息</p> 
<p>代码实现：</p> 
<pre><code class="prism language-python"><span class="token comment"># （1）合并数据</span>
<span class="token comment"># print(credits['crew'])</span>
<span class="token comment"># credits 中存在 movie_id  和 title</span>
<span class="token comment"># movies 中存在 id 和 title</span>
<span class="token comment"># 将 credits 中的 movie_id 修改为 id</span>
credits<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'movie_id'</span><span class="token punctuation">:</span> <span class="token string">'id'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token comment"># print('credits的列索引：\n', credits.columns)</span>
<span class="token comment"># 主键合并 ---on id 和 title</span>
all_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>left<span class="token operator">=</span>credits<span class="token punctuation">,</span> right<span class="token operator">=</span>movies<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'outer'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_data:\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_data:\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_data:\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">.</span>dtypes<span class="token punctuation">)</span>

</code></pre> 
<p><strong>选取子集</strong></p> 
<p>由于数据集中包含的信息过多，其中部分数据并不是我们研究的重点，所以从中选取我 们需要的数据：</p> 
<p>代码实现：</p> 
<pre><code class="prism language-python"><span class="token comment"># 筛选特征</span>
all_data <span class="token operator">=</span> all_data<span class="token punctuation">[</span><span class="token string">'original_title'</span><span class="token punctuation">,</span> <span class="token string">'crew'</span><span class="token punctuation">,</span> <span class="token string">'release_date'</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">,</span> <span class="token string">'keywords'</span><span class="token punctuation">,</span>
                    <span class="token string">'production_companies'</span><span class="token punctuation">,</span> <span class="token string">'production_countries'</span><span class="token punctuation">,</span> <span class="token string">'revenue'</span><span class="token punctuation">,</span>
                    <span class="token string">'budget'</span><span class="token punctuation">,</span> <span class="token string">'runtime'</span><span class="token punctuation">,</span> <span class="token string">'vote_average'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_data的列索引：\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_data的形状：\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>

</code></pre> 
<p>由于后面的数据分析涉及到电影类型的利润计算，先求出每部电影的利润，并在数据集 data 中增加 profit 数据列</p> 
<p>代码实现：</p> 
<pre><code class="prism language-python"><span class="token comment"># 增加利润</span>
all_data<span class="token punctuation">[</span><span class="token string">'profit'</span><span class="token punctuation">]</span> <span class="token operator">=</span> all_data<span class="token punctuation">[</span><span class="token string">'revenue'</span><span class="token punctuation">]</span> <span class="token operator">-</span> all_data<span class="token punctuation">[</span><span class="token string">'budget'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_data的列索引：\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_data的形状：\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">)</span>

</code></pre> 
<p><strong>缺失值处理</strong></p> 
<p>代码实现：</p> 
<pre><code class="prism language-python"><span class="token comment"># 检测缺失值</span>
<span class="token comment"># pd.isnull + sum</span>
res_null <span class="token operator">=</span> pd<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span>all_data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'缺失值检测结果：\n'</span><span class="token punctuation">,</span> res_null<span class="token punctuation">)</span>

<span class="token comment"># 检测到 release_date 存在一个缺失值 ---针对方式：填充，查找具体的电影名称，根据电影名称查找上映时间</span>
<span class="token comment"># a、确定bool数组</span>
mask <span class="token operator">=</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'release_date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># b、根据bool数组来获取缺失值位置的电影名称</span>
movie_name <span class="token operator">=</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>mask<span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'缺失上映日期的电影名称为：\n'</span><span class="token punctuation">,</span> movie_name<span class="token punctuation">)</span>
<span class="token comment"># 缺失上映日期的电影名称为：</span>
<span class="token comment">#  4553    America Is Still the Place</span>
<span class="token comment"># Name: title, dtype: object</span>

<span class="token comment"># 通过上网查询该电影的上映日期为：2014-06-01</span>
<span class="token comment"># c 、 填充</span>
all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>mask<span class="token punctuation">,</span> <span class="token string">'release_date'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'2014-06-01'</span>

<span class="token comment"># 将 release_date 转化为 pandas支持的时间序列</span>
all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'release_date'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'release_date'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 获取 发行年份</span>
all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'release_year'</span><span class="token punctuation">]</span> <span class="token operator">=</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'release_date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>year

</code></pre> 
<p>通过上面的结果信息可以知道：整个数据集缺失的数据比较少。 其中 release_date（首次上映日期）缺失 1 个数据,可以通过网上查询补齐这个数据，填补 release_date（首次上映日期）数据</p> 
<p><strong>数据格式转换</strong></p> 
<p>genres 列数据处理：</p> 
<p>代码实现：</p> 
<pre><code class="prism language-python"><span class="token comment"># 查看电影风格数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'电影风格：\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># json数据类型</span>

<span class="token comment"># json.loads # 可以将json转化为python类型</span>
<span class="token comment"># 将 all_data.loc[:, 'genres'] 由 json类型转化为 python类型</span>
all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span> <span class="token operator">=</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>transform<span class="token punctuation">(</span>json<span class="token punctuation">.</span>loads<span class="token punctuation">)</span>

<span class="token comment"># 构建所有的电影的类型</span>
all_movie_type <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token comment"># 定义一个函数，来提取电影类型</span>
<span class="token keyword">def</span> <span class="token function">get_movie_type</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    获取电影类型
    :param val: 数据
    :return: 提取之后的电影类型数据
    """</span>
    <span class="token comment"># 构建一个空列表，用来存储每一个电影的电影类型</span>
    type_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token comment"># 遍历 列表</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> val<span class="token punctuation">:</span>
        <span class="token comment"># 如果item存在</span>
        <span class="token keyword">if</span> item<span class="token punctuation">:</span>
            <span class="token comment"># 获取该电影的电影类型</span>
            movie_type <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>
            <span class="token comment"># 将其加入到 type_list</span>
            type_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>movie_type<span class="token punctuation">)</span>
            <span class="token comment"># 将其加入到 all_movie_type</span>
            all_movie_type<span class="token punctuation">.</span>add<span class="token punctuation">(</span>movie_type<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>type_list<span class="token punctuation">)</span>


<span class="token comment"># 调用</span>
all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span> <span class="token operator">=</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>transform<span class="token punctuation">(</span>get_movie_type<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'获取电影类型之后的结果：\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 将所有的电影类型转化为 list</span>
all_movie_type <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>all_movie_type<span class="token punctuation">)</span>

<span class="token comment"># 遍历</span>
<span class="token keyword">for</span> column <span class="token keyword">in</span> all_movie_type<span class="token punctuation">:</span>
    <span class="token comment"># 先增加</span>
    all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> column<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token comment"># 构建bool数组</span>
    mask <span class="token operator">=</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>contains<span class="token punctuation">(</span>column<span class="token punctuation">)</span>
    <span class="token comment"># 修改</span>
    all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>mask<span class="token punctuation">,</span> column<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_data:\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">)</span>

</code></pre> 
<p><strong>数据可视化</strong></p> 
<p>绘制电影数据类型随时间变化趋势图</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment"># 创建画布</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 默认不支持中文 ---修改RC参数</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'SimHei'</span>
<span class="token comment"># 增加字体之后变得不支持负号，需要修改RC参数让其继续支持负号</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>
<span class="token comment"># 构建横轴数据</span>
x <span class="token operator">=</span> groupby_year<span class="token punctuation">.</span>index
<span class="token keyword">for</span> movie_type <span class="token keyword">in</span> groupby_year<span class="token punctuation">.</span>columns<span class="token punctuation">:</span>
    <span class="token comment"># 构建纵轴数据</span>
    y <span class="token operator">=</span> groupby_year<span class="token punctuation">[</span>movie_type<span class="token punctuation">]</span>
    <span class="token comment"># 绘制折线图</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
<span class="token comment"># 增加标题</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'电影数据类型随时间变化趋势图'</span><span class="token punctuation">)</span>
<span class="token comment"># 设置图例</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>groupby_year<span class="token punctuation">.</span>columns<span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token string">'x-small'</span><span class="token punctuation">)</span>
<span class="token comment"># 设置纵轴名称</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'数量'</span><span class="token punctuation">)</span>
<span class="token comment"># 设置横轴名称</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'年份'</span><span class="token punctuation">)</span>
<span class="token comment"># 增加网络曲线</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>b<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span>
<span class="token comment"># 保存图片</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'./电影数据类型随时间变化'</span><span class="token punctuation">)</span>
<span class="token comment"># 展示</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/b0/48/nQM5uOLH_o.png" alt="在这里插入图片描述"><br> 分析结论： 从图中观察到，随着时间的推移，所有电影类型都呈现出增长趋势，尤其是 1992 年以 后各个类型的电影均增长迅速，其中 Drama(戏剧)和 Comedy(喜剧)增长最快，目前仍是最热 门的电影类型</p> 
<p><strong>绘制各种类型电影数量的统计柱状图</strong></p> 
<p><img src="https://images2.imgbox.com/dc/51/X8cH9Laf_o.png" alt="在这里插入图片描述"></p> 
<p><strong>绘制各种电影类型的占比饼图</strong><br> <img src="https://images2.imgbox.com/70/64/LhIyTVKe_o.png" alt="在这里插入图片描述"></p> 
<p><strong>电影类型平均利润数据可视化</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># 可视化 ---比 各种电影类型 的 平均利润 ---柱状图</span>
<span class="token comment"># Pyecharts</span>
<span class="token comment"># 实例化对象</span>
bar <span class="token operator">=</span> Bar<span class="token punctuation">(</span>
    <span class="token comment"># 初始化配置</span>
    init_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>InitOpts<span class="token punctuation">(</span>
        width<span class="token operator">=</span><span class="token string">'900px'</span><span class="token punctuation">,</span>
        height<span class="token operator">=</span><span class="token string">'600px'</span><span class="token punctuation">,</span>
        theme<span class="token operator">=</span><span class="token string">"white"</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment"># 添加数据</span>
bar<span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span>
    xaxis_data<span class="token operator">=</span>res_series<span class="token punctuation">.</span>index<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

bar<span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span>
    series_name<span class="token operator">=</span><span class="token string">' '</span><span class="token punctuation">,</span>
    yaxis_data<span class="token operator">=</span><span class="token punctuation">[</span><span class="token builtin">float</span><span class="token punctuation">(</span><span class="token string">'%.2f'</span> <span class="token operator">%</span> i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">(</span>res_series <span class="token operator">/</span> <span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    color<span class="token operator">=</span><span class="token string">'#6495ED'</span>
<span class="token punctuation">)</span>

<span class="token comment"># 设置全局配置</span>
bar<span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
    <span class="token comment"># 标题</span>
    title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>
        title<span class="token operator">=</span><span class="token string">'各种电影类型利润统计柱状图'</span><span class="token punctuation">,</span>
        <span class="token comment"># subtitle='广州分校Python0421班级'</span>
        pos_left<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span>
        pos_top<span class="token operator">=</span><span class="token string">'3%'</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment"># 图例</span>
    legend_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LegendOpts<span class="token punctuation">(</span>
        is_show<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment"># 横轴坐标设置</span>
    xaxis_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisOpts<span class="token punctuation">(</span>
        name<span class="token operator">=</span><span class="token string">'利润(百万)'</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment"># # 坐标系设置</span>
    yaxis_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisOpts<span class="token punctuation">(</span>
        name<span class="token operator">=</span><span class="token string">'电影类型'</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment"># 设置系列配置</span>
bar<span class="token punctuation">.</span>set_series_opts<span class="token punctuation">(</span>
    label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>
        is_show<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        position<span class="token operator">=</span><span class="token string">'right'</span><span class="token punctuation">,</span>
        color<span class="token operator">=</span><span class="token string">'#000000'</span><span class="token punctuation">,</span>
        formatter<span class="token operator">=</span><span class="token string">'{c}'</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token comment"># 反转坐标轴</span>
bar<span class="token punctuation">.</span>reversal_axis<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 生成文件</span>
bar<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">'./各种电影类型利润统计柱状图.html'</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/b3/61/hr7rPwtQ_o.png" alt="在这里插入图片描述"></p> 
<p>分析结论：</p> 
<p>从图中观察到，拍摄 Animation、Adventure、Fantasy 这三类电影盈利最好，而拍摄 Foreign、TV Movie 这两类电影会存在亏本的风险</p> 
<p><strong>未完待续。。。。。。</strong></p> 
<h3><a id="web_644"></a>补充：不做成web系统</h3> 
<p>** 数据预览**</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> json

<span class="token comment"># =============================================加载数据===================================</span>

<span class="token comment"># 加载数据 --credits</span>
credits <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./tmdb_5000_credits.csv'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'credits:\n'</span><span class="token punctuation">,</span> credits<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'*'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'credits:\n'</span><span class="token punctuation">,</span> credits<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'*'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'credits:\n'</span><span class="token punctuation">,</span> credits<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'*'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>

<span class="token comment"># 加载数据</span>
movies <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./tmdb_5000_movies.csv'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'movies:\n'</span><span class="token punctuation">,</span> movies<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'movies:\n'</span><span class="token punctuation">,</span> movies<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'movies:\n'</span><span class="token punctuation">,</span> movies<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/d4/e2/IKOK6AL9_o.png" alt="在这里插入图片描述"></p> 
<p><strong>合并数据集</strong></p> 
<p>先将 credits 数据集和 movie 数据集中的数据合并在一起，再查看合并后的数据集信息</p> 
<p>代码实现：</p> 
<pre><code class="prism language-python"><span class="token comment"># （1）合并数据</span>
<span class="token comment"># print(credits['crew'])</span>
<span class="token comment"># credits 中存在 movie_id  和 title</span>
<span class="token comment"># movies 中存在 id 和 title</span>
<span class="token comment"># 将 credits 中的 movie_id 修改为 id</span>
credits<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'movie_id'</span><span class="token punctuation">:</span> <span class="token string">'id'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token comment"># print('credits的列索引：\n', credits.columns)</span>
<span class="token comment"># 主键合并 ---on id 和 title</span>
all_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>left<span class="token operator">=</span>credits<span class="token punctuation">,</span> right<span class="token operator">=</span>movies<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'outer'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_data:\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_data:\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_data:\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">.</span>dtypes<span class="token punctuation">)</span>

</code></pre> 
<p><strong>选取子集</strong></p> 
<p>由于数据集中包含的信息过多，其中部分数据并不是我们研究的重点，所以从中选取我 们需要的数据：</p> 
<p>代码实现：</p> 
<pre><code class="prism language-python"><span class="token comment"># 筛选特征</span>
all_data <span class="token operator">=</span> all_data<span class="token punctuation">[</span><span class="token string">'original_title'</span><span class="token punctuation">,</span> <span class="token string">'crew'</span><span class="token punctuation">,</span> <span class="token string">'release_date'</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">,</span> <span class="token string">'keywords'</span><span class="token punctuation">,</span>
                    <span class="token string">'production_companies'</span><span class="token punctuation">,</span> <span class="token string">'production_countries'</span><span class="token punctuation">,</span> <span class="token string">'revenue'</span><span class="token punctuation">,</span>
                    <span class="token string">'budget'</span><span class="token punctuation">,</span> <span class="token string">'runtime'</span><span class="token punctuation">,</span> <span class="token string">'vote_average'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_data的列索引：\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_data的形状：\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>

</code></pre> 
<p>由于后面的数据分析涉及到电影类型的利润计算，先求出每部电影的利润，并在数据集 data 中增加 profit 数据列</p> 
<p>代码实现：</p> 
<pre><code class="prism language-python"><span class="token comment"># 增加利润</span>
all_data<span class="token punctuation">[</span><span class="token string">'profit'</span><span class="token punctuation">]</span> <span class="token operator">=</span> all_data<span class="token punctuation">[</span><span class="token string">'revenue'</span><span class="token punctuation">]</span> <span class="token operator">-</span> all_data<span class="token punctuation">[</span><span class="token string">'budget'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_data的列索引：\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_data的形状：\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">)</span>

</code></pre> 
<p><strong>缺失值处理</strong></p> 
<p>代码实现：</p> 
<pre><code class="prism language-python"><span class="token comment"># 检测缺失值</span>
<span class="token comment"># pd.isnull + sum</span>
res_null <span class="token operator">=</span> pd<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span>all_data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'缺失值检测结果：\n'</span><span class="token punctuation">,</span> res_null<span class="token punctuation">)</span>

<span class="token comment"># 检测到 release_date 存在一个缺失值 ---针对方式：填充，查找具体的电影名称，根据电影名称查找上映时间</span>
<span class="token comment"># a、确定bool数组</span>
mask <span class="token operator">=</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'release_date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># b、根据bool数组来获取缺失值位置的电影名称</span>
movie_name <span class="token operator">=</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>mask<span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'缺失上映日期的电影名称为：\n'</span><span class="token punctuation">,</span> movie_name<span class="token punctuation">)</span>
<span class="token comment"># 缺失上映日期的电影名称为：</span>
<span class="token comment">#  4553    America Is Still the Place</span>
<span class="token comment"># Name: title, dtype: object</span>

<span class="token comment"># 通过上网查询该电影的上映日期为：2014-06-01</span>
<span class="token comment"># c 、 填充</span>
all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>mask<span class="token punctuation">,</span> <span class="token string">'release_date'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'2014-06-01'</span>

<span class="token comment"># 将 release_date 转化为 pandas支持的时间序列</span>
all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'release_date'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'release_date'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 获取 发行年份</span>
all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'release_year'</span><span class="token punctuation">]</span> <span class="token operator">=</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'release_date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>year

</code></pre> 
<p>通过上面的结果信息可以知道：整个数据集缺失的数据比较少。 其中 release_date（首次上映日期）缺失 1 个数据,可以通过网上查询补齐这个数据，填补 release_date（首次上映日期）数据</p> 
<p><strong>数据格式转换</strong></p> 
<p>genres 列数据处理：</p> 
<p>代码实现：</p> 
<pre><code class="prism language-python"><span class="token comment"># 查看电影风格数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'电影风格：\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># json数据类型</span>

<span class="token comment"># json.loads # 可以将json转化为python类型</span>
<span class="token comment"># 将 all_data.loc[:, 'genres'] 由 json类型转化为 python类型</span>
all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span> <span class="token operator">=</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>transform<span class="token punctuation">(</span>json<span class="token punctuation">.</span>loads<span class="token punctuation">)</span>

<span class="token comment"># 构建所有的电影的类型</span>
all_movie_type <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token comment"># 定义一个函数，来提取电影类型</span>
<span class="token keyword">def</span> <span class="token function">get_movie_type</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    获取电影类型
    :param val: 数据
    :return: 提取之后的电影类型数据
    """</span>
    <span class="token comment"># 构建一个空列表，用来存储每一个电影的电影类型</span>
    type_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token comment"># 遍历 列表</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> val<span class="token punctuation">:</span>
        <span class="token comment"># 如果item存在</span>
        <span class="token keyword">if</span> item<span class="token punctuation">:</span>
            <span class="token comment"># 获取该电影的电影类型</span>
            movie_type <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>
            <span class="token comment"># 将其加入到 type_list</span>
            type_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>movie_type<span class="token punctuation">)</span>
            <span class="token comment"># 将其加入到 all_movie_type</span>
            all_movie_type<span class="token punctuation">.</span>add<span class="token punctuation">(</span>movie_type<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>type_list<span class="token punctuation">)</span>


<span class="token comment"># 调用</span>
all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span> <span class="token operator">=</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>transform<span class="token punctuation">(</span>get_movie_type<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'获取电影类型之后的结果：\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 将所有的电影类型转化为 list</span>
all_movie_type <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>all_movie_type<span class="token punctuation">)</span>

<span class="token comment"># 遍历</span>
<span class="token keyword">for</span> column <span class="token keyword">in</span> all_movie_type<span class="token punctuation">:</span>
    <span class="token comment"># 先增加</span>
    all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> column<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token comment"># 构建bool数组</span>
    mask <span class="token operator">=</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>contains<span class="token punctuation">(</span>column<span class="token punctuation">)</span>
    <span class="token comment"># 修改</span>
    all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>mask<span class="token punctuation">,</span> column<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_data:\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">)</span>

</code></pre> 
<p><strong>数据可视化</strong></p> 
<p>绘制电影数据类型随时间变化趋势图</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment"># 创建画布</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 默认不支持中文 ---修改RC参数</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'SimHei'</span>
<span class="token comment"># 增加字体之后变得不支持负号，需要修改RC参数让其继续支持负号</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>
<span class="token comment"># 构建横轴数据</span>
x <span class="token operator">=</span> groupby_year<span class="token punctuation">.</span>index
<span class="token keyword">for</span> movie_type <span class="token keyword">in</span> groupby_year<span class="token punctuation">.</span>columns<span class="token punctuation">:</span>
    <span class="token comment"># 构建纵轴数据</span>
    y <span class="token operator">=</span> groupby_year<span class="token punctuation">[</span>movie_type<span class="token punctuation">]</span>
    <span class="token comment"># 绘制折线图</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
<span class="token comment"># 增加标题</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'电影数据类型随时间变化趋势图'</span><span class="token punctuation">)</span>
<span class="token comment"># 设置图例</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>groupby_year<span class="token punctuation">.</span>columns<span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token string">'x-small'</span><span class="token punctuation">)</span>
<span class="token comment"># 设置纵轴名称</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'数量'</span><span class="token punctuation">)</span>
<span class="token comment"># 设置横轴名称</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'年份'</span><span class="token punctuation">)</span>
<span class="token comment"># 增加网络曲线</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>b<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span>
<span class="token comment"># 保存图片</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'./电影数据类型随时间变化'</span><span class="token punctuation">)</span>
<span class="token comment"># 展示</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/ef/cb/H67SBIM9_o.png" alt="在这里插入图片描述"><br> 分析结论： 从图中观察到，随着时间的推移，所有电影类型都呈现出增长趋势，尤其是 1992 年以 后各个类型的电影均增长迅速，其中 Drama(戏剧)和 Comedy(喜剧)增长最快，目前仍是最热 门的电影类型</p> 
<p><strong>绘制各种类型电影数量的统计柱状图</strong></p> 
<p><img src="https://images2.imgbox.com/a1/87/qVCnsaO2_o.png" alt="在这里插入图片描述"></p> 
<p><strong>绘制各种电影类型的占比饼图</strong><br> <img src="https://images2.imgbox.com/45/09/SV7P1RyL_o.png" alt="在这里插入图片描述"></p> 
<p><strong>电影类型平均利润数据可视化</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># 可视化 ---比 各种电影类型 的 平均利润 ---柱状图</span>
<span class="token comment"># Pyecharts</span>
<span class="token comment"># 实例化对象</span>
bar <span class="token operator">=</span> Bar<span class="token punctuation">(</span>
    <span class="token comment"># 初始化配置</span>
    init_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>InitOpts<span class="token punctuation">(</span>
        width<span class="token operator">=</span><span class="token string">'900px'</span><span class="token punctuation">,</span>
        height<span class="token operator">=</span><span class="token string">'600px'</span><span class="token punctuation">,</span>
        theme<span class="token operator">=</span><span class="token string">"white"</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment"># 添加数据</span>
bar<span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span>
    xaxis_data<span class="token operator">=</span>res_series<span class="token punctuation">.</span>index<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

bar<span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span>
    series_name<span class="token operator">=</span><span class="token string">' '</span><span class="token punctuation">,</span>
    yaxis_data<span class="token operator">=</span><span class="token punctuation">[</span><span class="token builtin">float</span><span class="token punctuation">(</span><span class="token string">'%.2f'</span> <span class="token operator">%</span> i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">(</span>res_series <span class="token operator">/</span> <span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    color<span class="token operator">=</span><span class="token string">'#6495ED'</span>
<span class="token punctuation">)</span>

<span class="token comment"># 设置全局配置</span>
bar<span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
    <span class="token comment"># 标题</span>
    title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>
        title<span class="token operator">=</span><span class="token string">'各种电影类型利润统计柱状图'</span><span class="token punctuation">,</span>
        <span class="token comment"># subtitle='广州分校Python0421班级'</span>
        pos_left<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span>
        pos_top<span class="token operator">=</span><span class="token string">'3%'</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment"># 图例</span>
    legend_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LegendOpts<span class="token punctuation">(</span>
        is_show<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment"># 横轴坐标设置</span>
    xaxis_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisOpts<span class="token punctuation">(</span>
        name<span class="token operator">=</span><span class="token string">'利润(百万)'</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment"># # 坐标系设置</span>
    yaxis_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisOpts<span class="token punctuation">(</span>
        name<span class="token operator">=</span><span class="token string">'电影类型'</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment"># 设置系列配置</span>
bar<span class="token punctuation">.</span>set_series_opts<span class="token punctuation">(</span>
    label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>
        is_show<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        position<span class="token operator">=</span><span class="token string">'right'</span><span class="token punctuation">,</span>
        color<span class="token operator">=</span><span class="token string">'#000000'</span><span class="token punctuation">,</span>
        formatter<span class="token operator">=</span><span class="token string">'{c}'</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token comment"># 反转坐标轴</span>
bar<span class="token punctuation">.</span>reversal_axis<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 生成文件</span>
bar<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">'./各种电影类型利润统计柱状图.html'</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/ec/fd/tA3wNChQ_o.png" alt="在这里插入图片描述"></p> 
<p>🧿 <strong>选题指导, 项目分享：见文末</strong></p> 
<h2><a id="5__947"></a>5 最后</h2> 
<p>**毕设帮助, 选题指导, 项目分享: ** <a href="https://gitee.com/yaa-dc/warehouse-1/blob/master/python/README.md" rel="nofollow">https://gitee.com/yaa-dc/warehouse-1/blob/master/python/README.md</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/394510ba1f0c605c0274f367c1754149/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">springboot集成starrocks、以及采用flink实现mysql与starrocks亚秒级同步_spring&#43;starrocks(1)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6190ed4a0f0b26468c3e06de712a5cc1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">突破编程_前端_SVG（使用 svg-pan-zoom 库进行平移与缩放）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>