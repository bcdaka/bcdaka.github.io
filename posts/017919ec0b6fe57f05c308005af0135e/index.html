<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>æ¯•ä¸šè®¾è®¡é¡¹ç›® åŸºäºå¤§æ•°æ®çš„ç”µå½±æ•°æ®çˆ¬å–åˆ†æå¯è§†åŒ–ç³»ç»Ÿ - ç¼–ç¨‹å¤§å’–</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/017919ec0b6fe57f05c308005af0135e/">
  <meta property="og:site_name" content="ç¼–ç¨‹å¤§å’–">
  <meta property="og:title" content="æ¯•ä¸šè®¾è®¡é¡¹ç›® åŸºäºå¤§æ•°æ®çš„ç”µå½±æ•°æ®çˆ¬å–åˆ†æå¯è§†åŒ–ç³»ç»Ÿ">
  <meta property="og:description" content="æ–‡ç« ç›®å½• 0 å‰è¨€1 è¯¾é¢˜èƒŒæ™¯2 é¡¹ç›®æ•ˆæœå±•ç¤º2.1 ä¸»ç•Œé¢å±•ç¤º2.2ç”µå½±æ•°æ®æŸ¥è¯¢2.3å¯è§†åŒ–å±•ç¤º 3 æ•°æ®çˆ¬å–3.1 Requests3.2 bs43.3 MySQLæ•°æ®åº“ 4 å¯è§†åŒ–æŠ€æœ¯4.1 Flask4.2 EChartsè¡¥å……ï¼šä¸åšæˆwebç³»ç»Ÿ 5 æœ€å 0 å‰è¨€ ğŸ”¥ è¿™ä¸¤å¹´å¼€å§‹æ¯•ä¸šè®¾è®¡å’Œæ¯•ä¸šç­”è¾©çš„è¦æ±‚å’Œéš¾åº¦ä¸æ–­æå‡ï¼Œä¼ ç»Ÿçš„æ¯•è®¾é¢˜ç›®ç¼ºå°‘åˆ›æ–°å’Œäº®ç‚¹ï¼Œå¾€å¾€è¾¾ä¸åˆ°æ¯•ä¸šç­”è¾©çš„è¦æ±‚ï¼Œè¿™ä¸¤å¹´ä¸æ–­æœ‰å­¦å¼Ÿå­¦å¦¹å‘Šè¯‰å­¦é•¿è‡ªå·±åšçš„é¡¹ç›®ç³»ç»Ÿè¾¾ä¸åˆ°è€å¸ˆçš„è¦æ±‚ã€‚
ä¸ºäº†å¤§å®¶èƒ½å¤Ÿé¡ºåˆ©ä»¥åŠæœ€å°‘çš„ç²¾åŠ›é€šè¿‡æ¯•è®¾ï¼Œå­¦é•¿åˆ†äº«ä¼˜è´¨æ¯•ä¸šè®¾è®¡é¡¹ç›®ï¼Œä»Šå¤©è¦åˆ†äº«çš„æ˜¯
ğŸš© åŸºäºå¤§æ•°æ®çš„ç”µå½±æ•°æ®çˆ¬å–åˆ†æå¯è§†åŒ–ç³»ç»Ÿ
ğŸ¥‡å­¦é•¿è¿™é‡Œç»™ä¸€ä¸ªé¢˜ç›®ç»¼åˆè¯„åˆ†(æ¯é¡¹æ»¡åˆ†5åˆ†)
éš¾åº¦ç³»æ•°ï¼š4åˆ†å·¥ä½œé‡ï¼š4åˆ†åˆ›æ–°ç‚¹ï¼š3åˆ† ğŸ§¿ é€‰é¢˜æŒ‡å¯¼, é¡¹ç›®åˆ†äº«ï¼šè§æ–‡æœ«
1 è¯¾é¢˜èƒŒæ™¯ éšç€äº’è”ç½‘çš„å¿«é€Ÿå‘å±•ï¼Œè¶Šæ¥è¶Šå¤šçš„äººå–œæ¬¢åœ¨å¾®åšã€çŸ¥ä¹ã€è±†ç“£ç­‰ç¤¾äº¤ç½‘ç«™ä¸Šå‘è¡¨è‡ªå·±å¯¹æŸäº›äº‹ç‰©çš„æƒ³æ³•ã€æ€åº¦æˆ–æ„è§ã€‚ç”¨æˆ·åŒæ—¶ä¹Ÿä¼šå°†è‡ªå·±è´­ä¹°çš„äº§å“æˆ–ä½“éªŒåˆ°çš„æœåŠ¡ï¼Œåœ¨è¿™äº›ç¤¾åŒºå¼çš„ç½‘ç«™ä¸Šè¯„ä»·ï¼Œè¿™æ ·é€šå¸¸ä¼šå¸¦åŠ¨ä»–äººä¹Ÿå‰å»è´­ä¹°æˆ–ä½“éªŒï¼Œå½¢æˆå£ç¢‘æ•ˆåº”ã€‚
ç¤¾äº¤åº”ç”¨åŠç½‘ç«™ä¸Šæœ‰æºæºä¸æ–­çš„ä¿¡æ¯å‘å¸ƒï¼Œè¿™äº›ä¿¡æ¯ä¸­éšå«ç€å¤§é‡å¯¹æˆ‘ä»¬åŠä¼ä¸šæœ‰æ”¶é›†ä»·å€¼çš„èµ„æºã€‚å°±åƒç”¨æˆ·è¯„åˆ†å’Œè¯„ä»·ç³»ç»Ÿä¸­ï¼Œç”¨æˆ·ä¸ä½†ä¼šå¯¹ä½œå“è¿›è¡Œè¯„æ¯”ï¼Œè¿˜åˆ†äº«å’Œä¼ æ’­äº†ä½œå“ä¿¡æ¯ã€‚å¦‚æœèƒ½å¤Ÿè·å–è¿™äº›æ•°æ®å¹¶å¯¹å…¶è¿›è¡Œåˆ†æï¼Œå¯ä»¥è®©äººä»¬æŒ‘é€‰åˆ°æ»¡æ„çš„ä¹¦ç±ã€é€‰æ‹©å‡ºä¸€éƒ¨ç²¾å½©çš„ç”µå½±ï¼Œä¹Ÿå¯ä»¥å¸®åŠ©ä¼ä¸šæ”¹è¿›äº§å“çš„æœåŠ¡ç­‰ã€‚ä½¿ç”¨çˆ¬è™«ç¨‹åºå¯ä»¥é«˜æ•ˆåœ°å¯¹ç¤¾äº¤ç½‘ç«™ä¸Šçš„ä¿¡æ¯è¿›è¡Œæ”¶é›†ã€ç»„ç»‡å’Œç®¡ç†ã€‚è±†ç“£ç½‘ä½œä¸ºç¤¾äº¤ç½‘ç«™çš„ä»£è¡¨ï¼Œæä¾›äº†åœ¨å›¾ä¹¦ã€ç”µå½±å’ŒéŸ³ä¹ç­‰æ–¹é¢ç‹¬æ ‘ä¸€å¸œçš„è¯„åˆ†ã€æ¨èåŠæ¯”ä»·ä½“ç³»ï¼Œåœ¨ç¤¾äº¤ç½‘ç»œä¸­äº§ç”Ÿäº†æ·±è¿œçš„å½±å“ã€‚
2 é¡¹ç›®æ•ˆæœå±•ç¤º 2.1 ä¸»ç•Œé¢å±•ç¤º 2.2ç”µå½±æ•°æ®æŸ¥è¯¢ ç®¡ç†å‘˜å¯å¯¹ç”µå½±æ•°æ®è¿›è¡ŒæŸ¥è¯¢ï¼Œå¯æ ¹æ®â€œæœ€ä½è¯„åˆ†â€ï¼Œâ€œæœ€é«˜è¯„åˆ†â€ï¼Œâ€œä¸Šæ˜ å¹´ä»½â€ï¼Œâ€œç”µå½±ç±»å‹â€ï¼Œâ€œä¸Šæ˜ åœ°åŒºâ€ï¼Œâ€œå½±åå…³é”®å­—â€ç­‰æ ‡ç­¾è¿›è¡Œç­›é€‰ã€æŸ¥è¯¢ã€‚
2.3å¯è§†åŒ–å±•ç¤º ç”µå½±ç±»å‹çŸ©å½¢å›¾ï¼šå¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°å‰§æƒ…ï¼Œçºªå½•ç‰‡ï¼Œå–œå‰§ç±»å‹çš„ç”µå½±æ‰€å æ¯”é‡è¾ƒå¤§ã€‚ ä¸Šæ˜ å¹´ä»½æ¼æ–—å›¾ï¼šå¯ä»¥çœ‹åˆ°ä¸­å›½ã€ç¾å›½ä¸Šæ˜ åœ°åŒºè¾ƒå¤šã€‚ ä¸Šæ˜ å¹´ä»½åˆ†å¸ƒã€ç”µå½±è¯„åˆ†åˆ†å¸ƒå›¾ã€‚ æ—¶é—´è½´å›¾ï¼šå¯éšå¹´ä»½åŠ¨æ€å˜åŒ–æ•ˆæœã€‚ åœ°åŒºç±»å‹åˆ†å¸ƒé¥¼çŠ¶å›¾ é¢‘æ•°ç»Ÿè®¡è¯äº‘å›¾ï¼šå¯æ ¹æ®ä¸»æ¼”ã€å¯¼æ¼”ã€ç¼–å‰§å’Œç”µå½±æ’åç”Ÿæˆç›¸åº”çš„è¯äº‘å›¾ 3 æ•°æ®çˆ¬å– 3.1 Requests requestsæ˜¯Pythonç”¨äºç½‘ç»œè¯·æ±‚çš„ç¬¬ä¸‰åº“ï¼Œä¹Ÿæ˜¯çˆ¬è™«è·å–ç½‘ç»œæ•°æ®çš„é‡è¦å·¥å…·ï¼Œä½¿ç”¨çš„æ—¶å€™éœ€è¦å¯¼å…¥
æœ¬é¡¹ç›®ä¸­ç›¸å…³ä»£ç ï¼š
import requests from bs4 import BeautifulSoup from lxml import html etree = html.etree import csv # è¯·æ±‚å¤´ headers = { &#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-13T15:06:20+08:00">
    <meta property="article:modified_time" content="2024-04-13T15:06:20+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§å’–" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§å’–</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">æ¯•ä¸šè®¾è®¡é¡¹ç›® åŸºäºå¤§æ•°æ®çš„ç”µå½±æ•°æ®çˆ¬å–åˆ†æå¯è§†åŒ–ç³»ç»Ÿ</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>æ–‡ç« ç›®å½•</h4> 
 <ul><li><a href="#0__4" rel="nofollow">0 å‰è¨€</a></li><li><a href="#1__26" rel="nofollow">1 è¯¾é¢˜èƒŒæ™¯</a></li><li><a href="#2__34" rel="nofollow">2 é¡¹ç›®æ•ˆæœå±•ç¤º</a></li><li><ul><li><a href="#21__36" rel="nofollow">2.1 ä¸»ç•Œé¢å±•ç¤º</a></li><li><a href="#22_41" rel="nofollow">2.2ç”µå½±æ•°æ®æŸ¥è¯¢</a></li><li><a href="#23_50" rel="nofollow">2.3å¯è§†åŒ–å±•ç¤º</a></li></ul> 
  </li><li><a href="#3__90" rel="nofollow">3 æ•°æ®çˆ¬å–</a></li><li><ul><li><a href="#31_Requests_92" rel="nofollow">3.1 Requests</a></li><li><a href="#32_bs4_153" rel="nofollow">3.2 bs4</a></li><li><a href="#33_MySQL_163" rel="nofollow">3.3 MySQLæ•°æ®åº“</a></li></ul> 
  </li><li><a href="#4__188" rel="nofollow">4 å¯è§†åŒ–æŠ€æœ¯</a></li><li><ul><li><a href="#41_Flask_190" rel="nofollow">4.1 Flask</a></li><li><a href="#42_ECharts_332" rel="nofollow">4.2 ECharts</a></li><li><a href="#web_644" rel="nofollow">è¡¥å……ï¼šä¸åšæˆwebç³»ç»Ÿ</a></li></ul> 
  </li><li><a href="#5__947" rel="nofollow">5 æœ€å</a></li></ul> 
</div> 
<p></p> 
<hr color="#000000" size='1"'> 
<h2><a id="0__4"></a>0 å‰è¨€</h2> 
<p>ğŸ”¥ è¿™ä¸¤å¹´å¼€å§‹æ¯•ä¸šè®¾è®¡å’Œæ¯•ä¸šç­”è¾©çš„è¦æ±‚å’Œéš¾åº¦ä¸æ–­æå‡ï¼Œä¼ ç»Ÿçš„æ¯•è®¾é¢˜ç›®ç¼ºå°‘åˆ›æ–°å’Œäº®ç‚¹ï¼Œå¾€å¾€è¾¾ä¸åˆ°æ¯•ä¸šç­”è¾©çš„è¦æ±‚ï¼Œè¿™ä¸¤å¹´ä¸æ–­æœ‰å­¦å¼Ÿå­¦å¦¹å‘Šè¯‰å­¦é•¿è‡ªå·±åšçš„é¡¹ç›®ç³»ç»Ÿè¾¾ä¸åˆ°è€å¸ˆçš„è¦æ±‚ã€‚</p> 
<p>ä¸ºäº†å¤§å®¶èƒ½å¤Ÿé¡ºåˆ©ä»¥åŠæœ€å°‘çš„ç²¾åŠ›é€šè¿‡æ¯•è®¾ï¼Œå­¦é•¿åˆ†äº«ä¼˜è´¨æ¯•ä¸šè®¾è®¡é¡¹ç›®ï¼Œä»Šå¤©è¦åˆ†äº«çš„æ˜¯</p> 
<p>ğŸš© <strong>åŸºäºå¤§æ•°æ®çš„ç”µå½±æ•°æ®çˆ¬å–åˆ†æå¯è§†åŒ–ç³»ç»Ÿ</strong></p> 
<p>ğŸ¥‡å­¦é•¿è¿™é‡Œç»™ä¸€ä¸ªé¢˜ç›®ç»¼åˆè¯„åˆ†(æ¯é¡¹æ»¡åˆ†5åˆ†)</p> 
<ul><li>éš¾åº¦ç³»æ•°ï¼š4åˆ†</li><li>å·¥ä½œé‡ï¼š4åˆ†</li><li>åˆ›æ–°ç‚¹ï¼š3åˆ†</li></ul> 
<p>ğŸ§¿ <strong>é€‰é¢˜æŒ‡å¯¼, é¡¹ç›®åˆ†äº«ï¼šè§æ–‡æœ«</strong></p> 
<br> 
<hr color="#000000" size='1"'> 
<h2><a id="1__26"></a>1 è¯¾é¢˜èƒŒæ™¯</h2> 
<p>éšç€äº’è”ç½‘çš„å¿«é€Ÿå‘å±•ï¼Œè¶Šæ¥è¶Šå¤šçš„äººå–œæ¬¢åœ¨å¾®åšã€çŸ¥ä¹ã€è±†ç“£ç­‰ç¤¾äº¤ç½‘ç«™ä¸Šå‘è¡¨è‡ªå·±å¯¹æŸäº›äº‹ç‰©çš„æƒ³æ³•ã€æ€åº¦æˆ–æ„è§ã€‚ç”¨æˆ·åŒæ—¶ä¹Ÿä¼šå°†è‡ªå·±è´­ä¹°çš„äº§å“æˆ–ä½“éªŒåˆ°çš„æœåŠ¡ï¼Œåœ¨è¿™äº›ç¤¾åŒºå¼çš„ç½‘ç«™ä¸Šè¯„ä»·ï¼Œè¿™æ ·é€šå¸¸ä¼šå¸¦åŠ¨ä»–äººä¹Ÿå‰å»è´­ä¹°æˆ–ä½“éªŒï¼Œå½¢æˆå£ç¢‘æ•ˆåº”ã€‚</p> 
<p>ç¤¾äº¤åº”ç”¨åŠç½‘ç«™ä¸Šæœ‰æºæºä¸æ–­çš„ä¿¡æ¯å‘å¸ƒï¼Œè¿™äº›ä¿¡æ¯ä¸­éšå«ç€å¤§é‡å¯¹æˆ‘ä»¬åŠä¼ä¸šæœ‰æ”¶é›†ä»·å€¼çš„èµ„æºã€‚å°±åƒç”¨æˆ·è¯„åˆ†å’Œè¯„ä»·ç³»ç»Ÿä¸­ï¼Œç”¨æˆ·ä¸ä½†ä¼šå¯¹ä½œå“è¿›è¡Œè¯„æ¯”ï¼Œè¿˜åˆ†äº«å’Œä¼ æ’­äº†ä½œå“ä¿¡æ¯ã€‚å¦‚æœèƒ½å¤Ÿè·å–è¿™äº›æ•°æ®å¹¶å¯¹å…¶è¿›è¡Œåˆ†æï¼Œå¯ä»¥è®©äººä»¬æŒ‘é€‰åˆ°æ»¡æ„çš„ä¹¦ç±ã€é€‰æ‹©å‡ºä¸€éƒ¨ç²¾å½©çš„ç”µå½±ï¼Œä¹Ÿå¯ä»¥å¸®åŠ©ä¼ä¸šæ”¹è¿›äº§å“çš„æœåŠ¡ç­‰ã€‚ä½¿ç”¨çˆ¬è™«ç¨‹åºå¯ä»¥é«˜æ•ˆåœ°å¯¹ç¤¾äº¤ç½‘ç«™ä¸Šçš„ä¿¡æ¯è¿›è¡Œæ”¶é›†ã€ç»„ç»‡å’Œç®¡ç†ã€‚è±†ç“£ç½‘ä½œä¸ºç¤¾äº¤ç½‘ç«™çš„ä»£è¡¨ï¼Œæä¾›äº†åœ¨å›¾ä¹¦ã€ç”µå½±å’ŒéŸ³ä¹ç­‰æ–¹é¢ç‹¬æ ‘ä¸€å¸œçš„è¯„åˆ†ã€æ¨èåŠæ¯”ä»·ä½“ç³»ï¼Œåœ¨ç¤¾äº¤ç½‘ç»œä¸­äº§ç”Ÿäº†æ·±è¿œçš„å½±å“ã€‚</p> 
<br> 
<h2><a id="2__34"></a>2 é¡¹ç›®æ•ˆæœå±•ç¤º</h2> 
<h3><a id="21__36"></a>2.1 ä¸»ç•Œé¢å±•ç¤º</h3> 
<p><img src="https://images2.imgbox.com/ad/8b/GrhPxnSG_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="22_41"></a>2.2ç”µå½±æ•°æ®æŸ¥è¯¢</h3> 
<p>ç®¡ç†å‘˜å¯å¯¹ç”µå½±æ•°æ®è¿›è¡ŒæŸ¥è¯¢ï¼Œå¯æ ¹æ®â€œæœ€ä½è¯„åˆ†â€ï¼Œâ€œæœ€é«˜è¯„åˆ†â€ï¼Œâ€œä¸Šæ˜ å¹´ä»½â€ï¼Œâ€œç”µå½±ç±»å‹â€ï¼Œâ€œä¸Šæ˜ åœ°åŒºâ€ï¼Œâ€œå½±åå…³é”®å­—â€ç­‰æ ‡ç­¾è¿›è¡Œç­›é€‰ã€æŸ¥è¯¢ã€‚</p> 
<p><img src="https://images2.imgbox.com/27/67/mgTQf2WF_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="23_50"></a>2.3å¯è§†åŒ–å±•ç¤º</h3> 
<ul><li>ç”µå½±ç±»å‹çŸ©å½¢å›¾ï¼šå¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°å‰§æƒ…ï¼Œçºªå½•ç‰‡ï¼Œå–œå‰§ç±»å‹çš„ç”µå½±æ‰€å æ¯”é‡è¾ƒå¤§ã€‚</li></ul> 
<p><img src="https://images2.imgbox.com/59/ec/PtdVww3f_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<ul><li>ä¸Šæ˜ å¹´ä»½æ¼æ–—å›¾ï¼šå¯ä»¥çœ‹åˆ°ä¸­å›½ã€ç¾å›½ä¸Šæ˜ åœ°åŒºè¾ƒå¤šã€‚</li></ul> 
<p><img src="https://images2.imgbox.com/fe/0e/KJIJguEJ_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<ul><li>ä¸Šæ˜ å¹´ä»½åˆ†å¸ƒã€ç”µå½±è¯„åˆ†åˆ†å¸ƒå›¾ã€‚</li></ul> 
<p><img src="https://images2.imgbox.com/f0/c4/XI6fNKse_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><img src="https://images2.imgbox.com/00/2c/E8ZQG3Oj_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<ul><li>æ—¶é—´è½´å›¾ï¼šå¯éšå¹´ä»½åŠ¨æ€å˜åŒ–æ•ˆæœã€‚</li></ul> 
<p><img src="https://images2.imgbox.com/33/ee/4CtsdUxM_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<ul><li>åœ°åŒºç±»å‹åˆ†å¸ƒé¥¼çŠ¶å›¾</li></ul> 
<p><img src="https://images2.imgbox.com/c2/80/NnEhiuY8_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<ul><li>é¢‘æ•°ç»Ÿè®¡è¯äº‘å›¾ï¼šå¯æ ¹æ®ä¸»æ¼”ã€å¯¼æ¼”ã€ç¼–å‰§å’Œç”µå½±æ’åç”Ÿæˆç›¸åº”çš„è¯äº‘å›¾</li></ul> 
<p><img src="https://images2.imgbox.com/73/ca/XVtqaQ0P_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h2><a id="3__90"></a>3 æ•°æ®çˆ¬å–</h2> 
<h3><a id="31_Requests_92"></a>3.1 Requests</h3> 
<p><strong>requests</strong>æ˜¯Pythonç”¨äºç½‘ç»œè¯·æ±‚çš„ç¬¬ä¸‰åº“ï¼Œä¹Ÿæ˜¯çˆ¬è™«è·å–ç½‘ç»œæ•°æ®çš„é‡è¦å·¥å…·ï¼Œä½¿ç”¨çš„æ—¶å€™éœ€è¦å¯¼å…¥</p> 
<p>æœ¬é¡¹ç›®ä¸­ç›¸å…³ä»£ç ï¼š</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup
<span class="token keyword">from</span> lxml <span class="token keyword">import</span> html

etree <span class="token operator">=</span> html<span class="token punctuation">.</span>etree
<span class="token keyword">import</span> csv

<span class="token comment"># è¯·æ±‚å¤´</span>
headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36"</span>
<span class="token punctuation">}</span>
hrefs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>


<span class="token comment"># çˆ¬å–è±†ç“£ç”µå½±TOP250çš„url</span>
<span class="token comment"># è·å–ç”µå½±è¯¦æƒ…é¡µurl</span>
<span class="token keyword">def</span> <span class="token function">get_film_url</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
        selector <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
        movie_hrefs <span class="token operator">=</span> selector<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="hd"]/a/@href'</span><span class="token punctuation">)</span>  <span class="token comment"># ç”µå½±çš„è¯¦æƒ…åœ°å€</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>movie_hrefs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            hrefs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>movie_hrefs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>


<span class="token comment"># ä¿å­˜ç”µå½±é“¾æ¥url</span>
<span class="token keyword">def</span> <span class="token function">save_url</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token comment"># è·å–é“¾æ¥</span>
        <span class="token keyword">for</span> href <span class="token keyword">in</span> hrefs<span class="token punctuation">:</span>
            <span class="token comment"># å­˜å…¥csv</span>
            file_path <span class="token operator">=</span> <span class="token string">"./è±†ç“£ç”µå½±TOP250é“¾æ¥.csv"</span>
            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">"a+"</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'gb18030'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> csvfile<span class="token punctuation">:</span>
                writer <span class="token operator">=</span> csv<span class="token punctuation">.</span>writer<span class="token punctuation">(</span>csvfile<span class="token punctuation">)</span>
                writer<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span><span class="token punctuation">[</span>href<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># çˆ¬å–è±†ç“£ç”µå½±TOP250çš„url</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        url <span class="token operator">=</span> <span class="token string">"https://movie.douban.com/top250?start="</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">""</span>
        get_film_url<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    save_url<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<h3><a id="32_bs4_153"></a>3.2 bs4</h3> 
<p>bs4å³BeautifulSoupï¼Œæ˜¯pythonç§çš„ä¸€ä¸ªåº“ï¼Œæœ€ä¸»è¦çš„å†…å®¹å°±æ˜¯ä»ç½‘é¡µä¸­æŠ“å–æ•°æ®ã€‚</p> 
<p>Beautiful Soupæä¾›ä¸€äº›ç®€å•çš„ã€pythonå¼çš„å‡½æ•°ç”¨æ¥å¤„ç†å¯¼èˆªã€æœç´¢ã€ä¿®æ”¹åˆ†ææ ‘ç­‰åŠŸèƒ½ã€‚å®ƒæ˜¯ä¸€ä¸ªå·¥å…·ç®±ï¼Œé€šè¿‡è§£ææ–‡æ¡£ä¸ºç”¨æˆ·æä¾›éœ€è¦æŠ“å–çš„æ•°æ®ï¼Œå› ä¸ºç®€å•ï¼Œæ‰€ä»¥ä¸éœ€è¦å¤šå°‘ä»£ç å°±å¯ä»¥å†™å‡ºä¸€ä¸ªå®Œæ•´çš„åº”ç”¨ç¨‹åºã€‚</p> 
<p>Beautiful Soupè‡ªåŠ¨å°†è¾“å…¥æ–‡æ¡£è½¬æ¢ä¸ºUnicodeç¼–ç ï¼Œè¾“å‡ºæ–‡æ¡£è½¬æ¢ä¸ºutf-8ç¼–ç ã€‚ä½ ä¸éœ€è¦è€ƒè™‘ç¼–ç æ–¹å¼ï¼Œé™¤éæ–‡æ¡£æ²¡æœ‰æŒ‡å®šä¸€ä¸ªç¼–ç æ–¹å¼ï¼Œè¿™æ—¶ï¼ŒBeautiful Soupå°±ä¸èƒ½è‡ªåŠ¨è¯†åˆ«ç¼–ç æ–¹å¼äº†ã€‚ç„¶åï¼Œä½ ä»…ä»…éœ€è¦è¯´æ˜ä¸€ä¸‹åŸå§‹ç¼–ç æ–¹å¼å°±å¯ä»¥äº†ã€‚</p> 
<p>Beautiful Soupå·²æˆä¸ºå’Œlxmlã€html6libä¸€æ ·å‡ºè‰²çš„pythonè§£é‡Šå™¨ï¼Œä¸ºç”¨æˆ·çµæ´»åœ°æä¾›ä¸åŒçš„è§£æç­–ç•¥æˆ–å¼ºåŠ²çš„é€Ÿåº¦ã€‚</p> 
<h3><a id="33_MySQL_163"></a>3.3 MySQLæ•°æ®åº“</h3> 
<p>åˆ©ç”¨Pymysqlï¼Œå°†çˆ¬å–åˆ°çš„æ•°æ®å­˜å…¥æ•°æ®åº“ä¸­ï¼Œç›¸å…³ä»£ç å¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-python"> <span class="token comment"># æ‰“å¼€æ•°æ®åº“è¿æ¥</span>
        conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span> user<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> passwd<span class="token operator">=</span><span class="token string">'123456'</span><span class="token punctuation">,</span> db<span class="token operator">=</span><span class="token string">'douban'</span><span class="token punctuation">,</span> charset<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
        <span class="token comment"># ä½¿ç”¨cursoræ–¹æ³•åˆ›å»ºä¸€ä¸ªæ¸¸æ ‡</span>
        cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># # æ‰§è¡Œsqlè¯­å¥</span>
<span class="token comment">#        query = 'insert into tb_film(url, filmname, score, showtime, genres, areas, mins, directors, scriptwriters, actors, comments) values(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s)'</span>
        query <span class="token operator">=</span> <span class="token string">'insert into tb_film(url, filmname, score, showtime, genres, areas, directors, scriptwriters, actors, comments) values(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s)'</span>

        values <span class="token operator">=</span> <span class="token punctuation">(</span>
            url<span class="token punctuation">,</span> filmname<span class="token punctuation">,</span> score<span class="token punctuation">,</span> showtime<span class="token punctuation">,</span> genres_list<span class="token punctuation">,</span> area_list<span class="token punctuation">,</span>  directors_list<span class="token punctuation">,</span> scriptwriters_list<span class="token punctuation">,</span>
            actors_list<span class="token punctuation">,</span>
            comment<span class="token punctuation">)</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>query<span class="token punctuation">,</span> values<span class="token punctuation">)</span>
        <span class="token comment"># æäº¤ä¹‹å‰çš„æ“ä½œï¼Œå¦‚æœä¹‹å‰å·²ç»æ‰§è¡Œå¤šæ¬¡çš„executeï¼Œé‚£ä¹ˆå°±éƒ½è¿›è¡Œæäº¤</span>
        conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<br> 
<h2><a id="4__188"></a>4 å¯è§†åŒ–æŠ€æœ¯</h2> 
<h3><a id="41_Flask_190"></a>4.1 Flask</h3> 
<p>Flaskæ˜¯ä¸€ä¸ªåŸºäºWerkzeugå’ŒJinja2çš„è½»é‡çº§Webåº”ç”¨ç¨‹åºæ¡†æ¶ã€‚ä¸å…¶ä»–åŒç±»å‹æ¡†æ¶ç›¸æ¯”ï¼ŒFlaskçš„çµæ´»æ€§ã€è½»ä¾¿æ€§å’Œå®‰å…¨æ€§æ›´é«˜ï¼Œè€Œä¸”å®¹æ˜“ä¸Šæ‰‹ï¼Œå®ƒå¯ä»¥ä¸MVCæ¨¡å¼å¾ˆå¥½åœ°ç»“åˆè¿›è¡Œå¼€å‘ã€‚Flaskä¹Ÿæœ‰å¼ºå¤§çš„å®šåˆ¶æ€§ï¼Œå¼€å‘è€…å¯ä»¥ä¾æ®å®é™…éœ€è¦å¢åŠ ç›¸åº”çš„åŠŸèƒ½ï¼Œåœ¨å®ç°ä¸°å¯Œçš„åŠŸèƒ½å’Œæ‰©å±•çš„åŒæ—¶èƒ½å¤Ÿä¿è¯æ ¸å¿ƒåŠŸèƒ½çš„ç®€å•ã€‚Flaskä¸°å¯Œçš„æ’ä»¶åº“èƒ½å¤Ÿè®©ç”¨æˆ·å®ç°ç½‘ç«™å®šåˆ¶çš„ä¸ªæ€§åŒ–ï¼Œä»è€Œå¼€å‘å‡ºåŠŸèƒ½å¼ºå¤§çš„ç½‘ç«™ã€‚</p> 
<p>æœ¬é¡¹ç›®åœ¨Flaskå¼€å‘åç«¯æ—¶ï¼Œå‰ç«¯è¯·æ±‚ä¼šé‡åˆ°è·¨åŸŸçš„é—®é¢˜ï¼Œè§£å†³è¯¥é—®é¢˜æœ‰ä¿®æ”¹æ•°æ®ç±»å‹ä¸ºjsonpï¼Œé‡‡ç”¨GETæ–¹æ³•ï¼Œæˆ–è€…åœ¨Flaskç«¯åŠ ä¸Šå“åº”å¤´ç­‰æ–¹å¼ï¼Œåœ¨æ­¤ä½¿ç”¨å®‰è£…Flask-CORSåº“çš„æ–¹å¼è§£å†³è·¨åŸŸé—®é¢˜ã€‚æ­¤å¤–éœ€è¦å®‰è£…è¯·æ±‚åº“axiosã€‚</p> 
<p>éƒ¨åˆ†ç›¸å…³ä»£ç ï¼š</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask
<span class="token keyword">from</span> flask <span class="token keyword">import</span> request<span class="token punctuation">,</span> redirect
<span class="token keyword">from</span> flask <span class="token keyword">import</span> render_template<span class="token punctuation">,</span> url_for
<span class="token keyword">from</span> flask_paginate <span class="token keyword">import</span> Pagination
<span class="token keyword">from</span> sqlalchemy <span class="token keyword">import</span> create_engine<span class="token punctuation">,</span>Column<span class="token punctuation">,</span>Integer<span class="token punctuation">,</span>SmallInteger<span class="token punctuation">,</span>String
<span class="token keyword">from</span> sqlalchemy <span class="token keyword">import</span> create_engine
<span class="token keyword">from</span> sqlalchemy<span class="token punctuation">.</span>orm <span class="token keyword">import</span> sessionmaker
<span class="token keyword">from</span> sqlalchemy<span class="token punctuation">.</span>ext<span class="token punctuation">.</span>declarative <span class="token keyword">import</span> declarative_base
<span class="token keyword">from</span> flask_sqlalchemy <span class="token keyword">import</span> SQLAlchemy
db <span class="token operator">=</span> SQLAlchemy<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> list_data <span class="token keyword">import</span> select_score<span class="token punctuation">,</span> select_showtime<span class="token punctuation">,</span> select_genres<span class="token punctuation">,</span> select_areas<span class="token punctuation">,</span> film_data
<span class="token keyword">from</span> genres <span class="token keyword">import</span> show_genres
<span class="token keyword">from</span> areas <span class="token keyword">import</span> show_areas
<span class="token keyword">from</span> showtime <span class="token keyword">import</span> show_showtime
<span class="token keyword">from</span> score <span class="token keyword">import</span> show_score
<span class="token keyword">from</span> timeline_score <span class="token keyword">import</span> show_score_top
<span class="token keyword">from</span> timeline_comment <span class="token keyword">import</span> show_comment_top
<span class="token keyword">from</span> select_showtime <span class="token keyword">import</span> select_showtime
<span class="token keyword">from</span> select_showtime <span class="token keyword">import</span> showtime_group
<span class="token keyword">from</span> film_search <span class="token keyword">import</span> film_search

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>jinja_env<span class="token punctuation">.</span>auto_reload <span class="token operator">=</span> <span class="token boolean">True</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'TEMPLATES_AUTO_RELOAD'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">True</span>

<span class="token comment">#åˆå§‹åŒ–æ•°æ®åº“è¿æ¥</span>
engine <span class="token operator">=</span> create_engine<span class="token punctuation">(</span><span class="token string">"mysql+pymysql://root:123456@localhost:3306/douban?charset=utf8"</span><span class="token punctuation">,</span>echo <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token comment">#åˆ›å»ºç¼“å­˜å¯¹è±¡</span>
Session <span class="token operator">=</span>sessionmaker<span class="token punctuation">(</span>bind<span class="token operator">=</span>engine<span class="token punctuation">)</span>
session <span class="token operator">=</span>Session
<span class="token comment">#å£°æ˜åŸºç±»</span>
Base <span class="token operator">=</span> declarative_base<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">#å®šä¹‰Filmå¯¹è±¡</span>
<span class="token comment">#åŸºäºè¿™ä¸ªåŸºç±»æ¥åˆ›å»ºæˆ‘ä»¬çš„è‡ªå®šä¹‰ç±»ï¼Œä¸€ä¸ªç±»å°±æ˜¯ä¸€ä¸ªæ•°æ®åº“è¡¨ï¼›</span>
<span class="token keyword">class</span> <span class="token class-name">Film</span><span class="token punctuation">(</span>Base<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#è¡¨çš„åå­—</span>
    __tablename__<span class="token operator">=</span> <span class="token string">'tb_film'</span>
    <span class="token comment">#è¡¨çš„ç»“æ„</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> Column<span class="token punctuation">(</span>Integer<span class="token punctuation">,</span>primary_key<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>autoincrement<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    url <span class="token operator">=</span>Column<span class="token punctuation">(</span>String<span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    filmname <span class="token operator">=</span>Column<span class="token punctuation">(</span>String<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    score <span class="token operator">=</span>Column<span class="token punctuation">(</span>String<span class="token punctuation">)</span>
    comments <span class="token operator">=</span>Column<span class="token punctuation">(</span>Integer<span class="token punctuation">)</span>
    showtime <span class="token operator">=</span>Column<span class="token punctuation">(</span>Integer<span class="token punctuation">)</span>
    genres <span class="token operator">=</span>Column<span class="token punctuation">(</span>String<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    areas <span class="token operator">=</span>Column<span class="token punctuation">(</span>String<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    actors <span class="token operator">=</span>Column<span class="token punctuation">(</span>String<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    directors <span class="token operator">=</span>Column<span class="token punctuation">(</span>String<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    scriptwriters <span class="token operator">=</span>Column<span class="token punctuation">(</span>String<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># return render_template('pages/echarts/e1.html')</span>
    <span class="token comment"># return render_template('index.html')</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'login.html'</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/register'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># return render_template('pages/echarts/e1.html')</span>
    <span class="token comment"># return render_template('index.html')</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'register.html'</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/index'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">welcom2index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># return render_template('pages/echarts/e1.html')</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span>
    <span class="token comment"># return render_template('login.html')</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/welcome'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">welcome</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'pages/welcome.html'</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/page_none"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">page_none</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'page_none'</span><span class="token punctuation">)</span>

<span class="token comment"># éªŒè¯ç”¨æˆ·åå’Œå¯†ç </span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">#@app.route('/index')</span>
<span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># éœ€è¦ä»requestå¯¹è±¡è¯»å–è¡¨å•å†…å®¹ï¼š</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'admin'</span> <span class="token keyword">and</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'123456'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span>

<span class="token comment"># è¡¨å•list</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/list"</span><span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/list/"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">list</span><span class="token punctuation">(</span>limit<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># åˆ—è¡¨å±æ€§</span>
    t_low <span class="token operator">=</span> select_score<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    t_high <span class="token operator">=</span> select_score<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    t_showtime <span class="token operator">=</span> select_showtime<span class="token punctuation">(</span><span class="token punctuation">)</span>
    t_genres <span class="token operator">=</span> select_genres<span class="token punctuation">(</span><span class="token punctuation">)</span>
    t_areas <span class="token operator">=</span> select_areas<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># åˆ†é¡µ</span>
    <span class="token comment"># limit = 15</span>
    page <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"page"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    start <span class="token operator">=</span> <span class="token punctuation">(</span>page <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> limit
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"low"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"high"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"showtime"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"areas"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"genres"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"filmname"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># å‚æ•°é€‰æ‹©</span>
        r_low <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"low"</span><span class="token punctuation">)</span>
        r_high <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"high"</span><span class="token punctuation">)</span>
        r_showtime <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"showtime"</span><span class="token punctuation">)</span>
        r_genres <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"genres"</span><span class="token punctuation">)</span>
        r_areas <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"areas"</span><span class="token punctuation">)</span>
        r_filmname <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"filmname"</span><span class="token punctuation">)</span>
        <span class="token comment"># è¿”å›æ•°æ®</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å‚æ•°ï¼š{},{},{},{},{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>r_low<span class="token punctuation">,</span> r_high<span class="token punctuation">,</span> r_showtime<span class="token punctuation">,</span> r_genres<span class="token punctuation">,</span> r_areas<span class="token punctuation">,</span>r_filmname<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å‚æ•°1ï¼š{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>r_low<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å‚æ•°2ï¼š{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>r_low<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        r_films <span class="token operator">=</span> film_data<span class="token punctuation">(</span>low<span class="token operator">=</span>r_low<span class="token punctuation">,</span> high<span class="token operator">=</span>r_high<span class="token punctuation">,</span> showtime<span class="token operator">=</span>r_showtime<span class="token punctuation">,</span> genres<span class="token operator">=</span>r_genres<span class="token punctuation">,</span> areas<span class="token operator">=</span>r_areas<span class="token punctuation">,</span> filmname<span class="token operator">=</span>r_filmname<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        r_row <span class="token operator">=</span> film_data<span class="token punctuation">(</span>low<span class="token operator">=</span>r_low<span class="token punctuation">,</span> high<span class="token operator">=</span>r_high<span class="token punctuation">,</span> showtime<span class="token operator">=</span>r_showtime<span class="token punctuation">,</span> genres<span class="token operator">=</span>r_genres<span class="token punctuation">,</span> areas<span class="token operator">=</span>r_areas<span class="token punctuation">,</span> filmname<span class="token operator">=</span>r_filmname<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token comment"># åˆ†é¡µ</span>
        r_end <span class="token operator">=</span> page <span class="token operator">*</span> limit <span class="token keyword">if</span> r_row <span class="token operator">&gt;</span> page <span class="token operator">*</span> limit <span class="token keyword">else</span> r_row
        r_paginate <span class="token operator">=</span> Pagination<span class="token punctuation">(</span>page<span class="token operator">=</span>page<span class="token punctuation">,</span> total<span class="token operator">=</span>r_row<span class="token punctuation">)</span>
        r_ret <span class="token operator">=</span> r_films<span class="token punctuation">[</span>start<span class="token punctuation">:</span>r_end<span class="token punctuation">]</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'pages/order/list.html'</span><span class="token punctuation">,</span> low<span class="token operator">=</span>t_low<span class="token punctuation">,</span> high<span class="token operator">=</span>t_high<span class="token punctuation">,</span> showtime<span class="token operator">=</span>t_showtime<span class="token punctuation">,</span> genres<span class="token operator">=</span>t_genres<span class="token punctuation">,</span>
                           areas<span class="token operator">=</span>t_areas<span class="token punctuation">,</span> films<span class="token operator">=</span>r_ret<span class="token punctuation">,</span> row<span class="token operator">=</span>r_row<span class="token punctuation">,</span>paginate<span class="token operator">=</span>r_paginate<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token comment"># è¿”å›æ•°æ®</span>
        films <span class="token operator">=</span> film_data<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        row <span class="token operator">=</span> film_data<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        end <span class="token operator">=</span> page <span class="token operator">*</span> limit <span class="token keyword">if</span> row <span class="token operator">&gt;</span> page <span class="token operator">*</span> limit <span class="token keyword">else</span> row
        paginate <span class="token operator">=</span> Pagination<span class="token punctuation">(</span>page<span class="token operator">=</span>page<span class="token punctuation">,</span> total<span class="token operator">=</span>row<span class="token punctuation">)</span>
        ret<span class="token operator">=</span>films<span class="token punctuation">[</span>start<span class="token punctuation">:</span>end<span class="token punctuation">]</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"res:{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'pages/order/list.html'</span><span class="token punctuation">,</span> low<span class="token operator">=</span>t_low<span class="token punctuation">,</span> high<span class="token operator">=</span>t_high<span class="token punctuation">,</span> showtime<span class="token operator">=</span>t_showtime<span class="token punctuation">,</span> genres<span class="token operator">=</span>t_genres<span class="token punctuation">,</span>
                           areas<span class="token operator">=</span>t_areas<span class="token punctuation">,</span> films<span class="token operator">=</span>ret<span class="token punctuation">,</span>row<span class="token operator">=</span>row<span class="token punctuation">,</span> paginate<span class="token operator">=</span>paginate<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="42_ECharts_332"></a>4.2 ECharts</h3> 
<p>EChartsï¼ˆEnterprise Chartsï¼‰æ˜¯ç™¾åº¦å¼€æºçš„æ•°æ®å¯è§†åŒ–å·¥å…·ï¼Œåº•å±‚ä¾èµ–è½»é‡çº§Canvasåº“ZRenderã€‚å…¼å®¹äº†å‡ ä¹å…¨éƒ¨å¸¸ç”¨æµè§ˆå™¨çš„ç‰¹ç‚¹ï¼Œä½¿å®ƒå¯å¹¿æ³›ç”¨äºPCå®¢æˆ·ç«¯å’Œæ‰‹æœºå®¢æˆ·ç«¯ã€‚EChartsèƒ½è¾…åŠ©å¼€å‘è€…æ•´åˆç”¨æˆ·æ•°æ®ï¼Œåˆ›æ–°æ€§çš„å®Œæˆä¸ªæ€§åŒ–è®¾ç½®å¯è§†åŒ–å›¾è¡¨ã€‚æ”¯æŒæŠ˜çº¿å›¾ï¼ˆåŒºåŸŸå›¾ï¼‰ã€æŸ±çŠ¶å›¾ï¼ˆæ¡çŠ¶å›¾ï¼‰ã€æ•£ç‚¹å›¾ï¼ˆæ°”æ³¡å›¾ï¼‰ã€Kçº¿å›¾ã€é¥¼å›¾ï¼ˆç¯å½¢å›¾ï¼‰ç­‰ï¼Œé€šè¿‡å¯¼å…¥ js åº“åœ¨ Java Web é¡¹ç›®ä¸Šè¿è¡Œã€‚</p> 
<p><strong>æ•°æ®é¢„è§ˆ</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> json

<span class="token comment"># =============================================åŠ è½½æ•°æ®===================================</span>

<span class="token comment"># åŠ è½½æ•°æ® --credits</span>
credits <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./tmdb_5000_credits.csv'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'credits:\n'</span><span class="token punctuation">,</span> credits<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'*'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'credits:\n'</span><span class="token punctuation">,</span> credits<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'*'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'credits:\n'</span><span class="token punctuation">,</span> credits<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'*'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>

<span class="token comment"># åŠ è½½æ•°æ®</span>
movies <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./tmdb_5000_movies.csv'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'movies:\n'</span><span class="token punctuation">,</span> movies<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'movies:\n'</span><span class="token punctuation">,</span> movies<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'movies:\n'</span><span class="token punctuation">,</span> movies<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/78/08/f8trYdoH_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><strong>åˆå¹¶æ•°æ®é›†</strong></p> 
<p>å…ˆå°† credits æ•°æ®é›†å’Œ movie æ•°æ®é›†ä¸­çš„æ•°æ®åˆå¹¶åœ¨ä¸€èµ·ï¼Œå†æŸ¥çœ‹åˆå¹¶åçš„æ•°æ®é›†ä¿¡æ¯</p> 
<p>ä»£ç å®ç°ï¼š</p> 
<pre><code class="prism language-python"><span class="token comment"># ï¼ˆ1ï¼‰åˆå¹¶æ•°æ®</span>
<span class="token comment"># print(credits['crew'])</span>
<span class="token comment"># credits ä¸­å­˜åœ¨ movie_id  å’Œ title</span>
<span class="token comment"># movies ä¸­å­˜åœ¨ id å’Œ title</span>
<span class="token comment"># å°† credits ä¸­çš„ movie_id ä¿®æ”¹ä¸º id</span>
credits<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'movie_id'</span><span class="token punctuation">:</span> <span class="token string">'id'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token comment"># print('creditsçš„åˆ—ç´¢å¼•ï¼š\n', credits.columns)</span>
<span class="token comment"># ä¸»é”®åˆå¹¶ ---on id å’Œ title</span>
all_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>left<span class="token operator">=</span>credits<span class="token punctuation">,</span> right<span class="token operator">=</span>movies<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'outer'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_data:\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_data:\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_data:\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">.</span>dtypes<span class="token punctuation">)</span>

</code></pre> 
<p><strong>é€‰å–å­é›†</strong></p> 
<p>ç”±äºæ•°æ®é›†ä¸­åŒ…å«çš„ä¿¡æ¯è¿‡å¤šï¼Œå…¶ä¸­éƒ¨åˆ†æ•°æ®å¹¶ä¸æ˜¯æˆ‘ä»¬ç ”ç©¶çš„é‡ç‚¹ï¼Œæ‰€ä»¥ä»ä¸­é€‰å–æˆ‘ ä»¬éœ€è¦çš„æ•°æ®ï¼š</p> 
<p>ä»£ç å®ç°ï¼š</p> 
<pre><code class="prism language-python"><span class="token comment"># ç­›é€‰ç‰¹å¾</span>
all_data <span class="token operator">=</span> all_data<span class="token punctuation">[</span><span class="token string">'original_title'</span><span class="token punctuation">,</span> <span class="token string">'crew'</span><span class="token punctuation">,</span> <span class="token string">'release_date'</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">,</span> <span class="token string">'keywords'</span><span class="token punctuation">,</span>
                    <span class="token string">'production_companies'</span><span class="token punctuation">,</span> <span class="token string">'production_countries'</span><span class="token punctuation">,</span> <span class="token string">'revenue'</span><span class="token punctuation">,</span>
                    <span class="token string">'budget'</span><span class="token punctuation">,</span> <span class="token string">'runtime'</span><span class="token punctuation">,</span> <span class="token string">'vote_average'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_dataçš„åˆ—ç´¢å¼•ï¼š\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_dataçš„å½¢çŠ¶ï¼š\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>

</code></pre> 
<p>ç”±äºåé¢çš„æ•°æ®åˆ†ææ¶‰åŠåˆ°ç”µå½±ç±»å‹çš„åˆ©æ¶¦è®¡ç®—ï¼Œå…ˆæ±‚å‡ºæ¯éƒ¨ç”µå½±çš„åˆ©æ¶¦ï¼Œå¹¶åœ¨æ•°æ®é›† data ä¸­å¢åŠ  profit æ•°æ®åˆ—</p> 
<p>ä»£ç å®ç°ï¼š</p> 
<pre><code class="prism language-python"><span class="token comment"># å¢åŠ åˆ©æ¶¦</span>
all_data<span class="token punctuation">[</span><span class="token string">'profit'</span><span class="token punctuation">]</span> <span class="token operator">=</span> all_data<span class="token punctuation">[</span><span class="token string">'revenue'</span><span class="token punctuation">]</span> <span class="token operator">-</span> all_data<span class="token punctuation">[</span><span class="token string">'budget'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_dataçš„åˆ—ç´¢å¼•ï¼š\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_dataçš„å½¢çŠ¶ï¼š\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">)</span>

</code></pre> 
<p><strong>ç¼ºå¤±å€¼å¤„ç†</strong></p> 
<p>ä»£ç å®ç°ï¼š</p> 
<pre><code class="prism language-python"><span class="token comment"># æ£€æµ‹ç¼ºå¤±å€¼</span>
<span class="token comment"># pd.isnull + sum</span>
res_null <span class="token operator">=</span> pd<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span>all_data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'ç¼ºå¤±å€¼æ£€æµ‹ç»“æœï¼š\n'</span><span class="token punctuation">,</span> res_null<span class="token punctuation">)</span>

<span class="token comment"># æ£€æµ‹åˆ° release_date å­˜åœ¨ä¸€ä¸ªç¼ºå¤±å€¼ ---é’ˆå¯¹æ–¹å¼ï¼šå¡«å……ï¼ŒæŸ¥æ‰¾å…·ä½“çš„ç”µå½±åç§°ï¼Œæ ¹æ®ç”µå½±åç§°æŸ¥æ‰¾ä¸Šæ˜ æ—¶é—´</span>
<span class="token comment"># aã€ç¡®å®šboolæ•°ç»„</span>
mask <span class="token operator">=</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'release_date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># bã€æ ¹æ®boolæ•°ç»„æ¥è·å–ç¼ºå¤±å€¼ä½ç½®çš„ç”µå½±åç§°</span>
movie_name <span class="token operator">=</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>mask<span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'ç¼ºå¤±ä¸Šæ˜ æ—¥æœŸçš„ç”µå½±åç§°ä¸ºï¼š\n'</span><span class="token punctuation">,</span> movie_name<span class="token punctuation">)</span>
<span class="token comment"># ç¼ºå¤±ä¸Šæ˜ æ—¥æœŸçš„ç”µå½±åç§°ä¸ºï¼š</span>
<span class="token comment">#  4553    America Is Still the Place</span>
<span class="token comment"># Name: title, dtype: object</span>

<span class="token comment"># é€šè¿‡ä¸Šç½‘æŸ¥è¯¢è¯¥ç”µå½±çš„ä¸Šæ˜ æ—¥æœŸä¸ºï¼š2014-06-01</span>
<span class="token comment"># c ã€ å¡«å……</span>
all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>mask<span class="token punctuation">,</span> <span class="token string">'release_date'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'2014-06-01'</span>

<span class="token comment"># å°† release_date è½¬åŒ–ä¸º pandasæ”¯æŒçš„æ—¶é—´åºåˆ—</span>
all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'release_date'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'release_date'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># è·å– å‘è¡Œå¹´ä»½</span>
all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'release_year'</span><span class="token punctuation">]</span> <span class="token operator">=</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'release_date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>year

</code></pre> 
<p>é€šè¿‡ä¸Šé¢çš„ç»“æœä¿¡æ¯å¯ä»¥çŸ¥é“ï¼šæ•´ä¸ªæ•°æ®é›†ç¼ºå¤±çš„æ•°æ®æ¯”è¾ƒå°‘ã€‚ å…¶ä¸­ release_dateï¼ˆé¦–æ¬¡ä¸Šæ˜ æ—¥æœŸï¼‰ç¼ºå¤± 1 ä¸ªæ•°æ®,å¯ä»¥é€šè¿‡ç½‘ä¸ŠæŸ¥è¯¢è¡¥é½è¿™ä¸ªæ•°æ®ï¼Œå¡«è¡¥ release_dateï¼ˆé¦–æ¬¡ä¸Šæ˜ æ—¥æœŸï¼‰æ•°æ®</p> 
<p><strong>æ•°æ®æ ¼å¼è½¬æ¢</strong></p> 
<p>genres åˆ—æ•°æ®å¤„ç†ï¼š</p> 
<p>ä»£ç å®ç°ï¼š</p> 
<pre><code class="prism language-python"><span class="token comment"># æŸ¥çœ‹ç”µå½±é£æ ¼æ•°æ®</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'ç”µå½±é£æ ¼ï¼š\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># jsonæ•°æ®ç±»å‹</span>

<span class="token comment"># json.loads # å¯ä»¥å°†jsonè½¬åŒ–ä¸ºpythonç±»å‹</span>
<span class="token comment"># å°† all_data.loc[:, 'genres'] ç”± jsonç±»å‹è½¬åŒ–ä¸º pythonç±»å‹</span>
all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span> <span class="token operator">=</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>transform<span class="token punctuation">(</span>json<span class="token punctuation">.</span>loads<span class="token punctuation">)</span>

<span class="token comment"># æ„å»ºæ‰€æœ‰çš„ç”µå½±çš„ç±»å‹</span>
all_movie_type <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token comment"># å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œæ¥æå–ç”µå½±ç±»å‹</span>
<span class="token keyword">def</span> <span class="token function">get_movie_type</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    è·å–ç”µå½±ç±»å‹
    :param val: æ•°æ®
    :return: æå–ä¹‹åçš„ç”µå½±ç±»å‹æ•°æ®
    """</span>
    <span class="token comment"># æ„å»ºä¸€ä¸ªç©ºåˆ—è¡¨ï¼Œç”¨æ¥å­˜å‚¨æ¯ä¸€ä¸ªç”µå½±çš„ç”µå½±ç±»å‹</span>
    type_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token comment"># éå† åˆ—è¡¨</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> val<span class="token punctuation">:</span>
        <span class="token comment"># å¦‚æœitemå­˜åœ¨</span>
        <span class="token keyword">if</span> item<span class="token punctuation">:</span>
            <span class="token comment"># è·å–è¯¥ç”µå½±çš„ç”µå½±ç±»å‹</span>
            movie_type <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>
            <span class="token comment"># å°†å…¶åŠ å…¥åˆ° type_list</span>
            type_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>movie_type<span class="token punctuation">)</span>
            <span class="token comment"># å°†å…¶åŠ å…¥åˆ° all_movie_type</span>
            all_movie_type<span class="token punctuation">.</span>add<span class="token punctuation">(</span>movie_type<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>type_list<span class="token punctuation">)</span>


<span class="token comment"># è°ƒç”¨</span>
all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span> <span class="token operator">=</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>transform<span class="token punctuation">(</span>get_movie_type<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'è·å–ç”µå½±ç±»å‹ä¹‹åçš„ç»“æœï¼š\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># å°†æ‰€æœ‰çš„ç”µå½±ç±»å‹è½¬åŒ–ä¸º list</span>
all_movie_type <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>all_movie_type<span class="token punctuation">)</span>

<span class="token comment"># éå†</span>
<span class="token keyword">for</span> column <span class="token keyword">in</span> all_movie_type<span class="token punctuation">:</span>
    <span class="token comment"># å…ˆå¢åŠ </span>
    all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> column<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token comment"># æ„å»ºboolæ•°ç»„</span>
    mask <span class="token operator">=</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>contains<span class="token punctuation">(</span>column<span class="token punctuation">)</span>
    <span class="token comment"># ä¿®æ”¹</span>
    all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>mask<span class="token punctuation">,</span> column<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_data:\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">)</span>

</code></pre> 
<p><strong>æ•°æ®å¯è§†åŒ–</strong></p> 
<p>ç»˜åˆ¶ç”µå½±æ•°æ®ç±»å‹éšæ—¶é—´å˜åŒ–è¶‹åŠ¿å›¾</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment"># åˆ›å»ºç”»å¸ƒ</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># é»˜è®¤ä¸æ”¯æŒä¸­æ–‡ ---ä¿®æ”¹RCå‚æ•°</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'SimHei'</span>
<span class="token comment"># å¢åŠ å­—ä½“ä¹‹åå˜å¾—ä¸æ”¯æŒè´Ÿå·ï¼Œéœ€è¦ä¿®æ”¹RCå‚æ•°è®©å…¶ç»§ç»­æ”¯æŒè´Ÿå·</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>
<span class="token comment"># æ„å»ºæ¨ªè½´æ•°æ®</span>
x <span class="token operator">=</span> groupby_year<span class="token punctuation">.</span>index
<span class="token keyword">for</span> movie_type <span class="token keyword">in</span> groupby_year<span class="token punctuation">.</span>columns<span class="token punctuation">:</span>
    <span class="token comment"># æ„å»ºçºµè½´æ•°æ®</span>
    y <span class="token operator">=</span> groupby_year<span class="token punctuation">[</span>movie_type<span class="token punctuation">]</span>
    <span class="token comment"># ç»˜åˆ¶æŠ˜çº¿å›¾</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
<span class="token comment"># å¢åŠ æ ‡é¢˜</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'ç”µå½±æ•°æ®ç±»å‹éšæ—¶é—´å˜åŒ–è¶‹åŠ¿å›¾'</span><span class="token punctuation">)</span>
<span class="token comment"># è®¾ç½®å›¾ä¾‹</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>groupby_year<span class="token punctuation">.</span>columns<span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token string">'x-small'</span><span class="token punctuation">)</span>
<span class="token comment"># è®¾ç½®çºµè½´åç§°</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'æ•°é‡'</span><span class="token punctuation">)</span>
<span class="token comment"># è®¾ç½®æ¨ªè½´åç§°</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'å¹´ä»½'</span><span class="token punctuation">)</span>
<span class="token comment"># å¢åŠ ç½‘ç»œæ›²çº¿</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>b<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span>
<span class="token comment"># ä¿å­˜å›¾ç‰‡</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'./ç”µå½±æ•°æ®ç±»å‹éšæ—¶é—´å˜åŒ–'</span><span class="token punctuation">)</span>
<span class="token comment"># å±•ç¤º</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/b0/48/nQM5uOLH_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> åˆ†æç»“è®ºï¼š ä»å›¾ä¸­è§‚å¯Ÿåˆ°ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œæ‰€æœ‰ç”µå½±ç±»å‹éƒ½å‘ˆç°å‡ºå¢é•¿è¶‹åŠ¿ï¼Œå°¤å…¶æ˜¯ 1992 å¹´ä»¥ åå„ä¸ªç±»å‹çš„ç”µå½±å‡å¢é•¿è¿…é€Ÿï¼Œå…¶ä¸­ Drama(æˆå‰§)å’Œ Comedy(å–œå‰§)å¢é•¿æœ€å¿«ï¼Œç›®å‰ä»æ˜¯æœ€çƒ­ é—¨çš„ç”µå½±ç±»å‹</p> 
<p><strong>ç»˜åˆ¶å„ç§ç±»å‹ç”µå½±æ•°é‡çš„ç»Ÿè®¡æŸ±çŠ¶å›¾</strong></p> 
<p><img src="https://images2.imgbox.com/dc/51/X8cH9Laf_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><strong>ç»˜åˆ¶å„ç§ç”µå½±ç±»å‹çš„å æ¯”é¥¼å›¾</strong><br> <img src="https://images2.imgbox.com/70/64/LhIyTVKe_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><strong>ç”µå½±ç±»å‹å¹³å‡åˆ©æ¶¦æ•°æ®å¯è§†åŒ–</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># å¯è§†åŒ– ---æ¯” å„ç§ç”µå½±ç±»å‹ çš„ å¹³å‡åˆ©æ¶¦ ---æŸ±çŠ¶å›¾</span>
<span class="token comment"># Pyecharts</span>
<span class="token comment"># å®ä¾‹åŒ–å¯¹è±¡</span>
bar <span class="token operator">=</span> Bar<span class="token punctuation">(</span>
    <span class="token comment"># åˆå§‹åŒ–é…ç½®</span>
    init_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>InitOpts<span class="token punctuation">(</span>
        width<span class="token operator">=</span><span class="token string">'900px'</span><span class="token punctuation">,</span>
        height<span class="token operator">=</span><span class="token string">'600px'</span><span class="token punctuation">,</span>
        theme<span class="token operator">=</span><span class="token string">"white"</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment"># æ·»åŠ æ•°æ®</span>
bar<span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span>
    xaxis_data<span class="token operator">=</span>res_series<span class="token punctuation">.</span>index<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

bar<span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span>
    series_name<span class="token operator">=</span><span class="token string">' '</span><span class="token punctuation">,</span>
    yaxis_data<span class="token operator">=</span><span class="token punctuation">[</span><span class="token builtin">float</span><span class="token punctuation">(</span><span class="token string">'%.2f'</span> <span class="token operator">%</span> i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">(</span>res_series <span class="token operator">/</span> <span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    color<span class="token operator">=</span><span class="token string">'#6495ED'</span>
<span class="token punctuation">)</span>

<span class="token comment"># è®¾ç½®å…¨å±€é…ç½®</span>
bar<span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
    <span class="token comment"># æ ‡é¢˜</span>
    title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>
        title<span class="token operator">=</span><span class="token string">'å„ç§ç”µå½±ç±»å‹åˆ©æ¶¦ç»Ÿè®¡æŸ±çŠ¶å›¾'</span><span class="token punctuation">,</span>
        <span class="token comment"># subtitle='å¹¿å·åˆ†æ ¡Python0421ç­çº§'</span>
        pos_left<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span>
        pos_top<span class="token operator">=</span><span class="token string">'3%'</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment"># å›¾ä¾‹</span>
    legend_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LegendOpts<span class="token punctuation">(</span>
        is_show<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment"># æ¨ªè½´åæ ‡è®¾ç½®</span>
    xaxis_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisOpts<span class="token punctuation">(</span>
        name<span class="token operator">=</span><span class="token string">'åˆ©æ¶¦(ç™¾ä¸‡)'</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment"># # åæ ‡ç³»è®¾ç½®</span>
    yaxis_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisOpts<span class="token punctuation">(</span>
        name<span class="token operator">=</span><span class="token string">'ç”µå½±ç±»å‹'</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment"># è®¾ç½®ç³»åˆ—é…ç½®</span>
bar<span class="token punctuation">.</span>set_series_opts<span class="token punctuation">(</span>
    label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>
        is_show<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        position<span class="token operator">=</span><span class="token string">'right'</span><span class="token punctuation">,</span>
        color<span class="token operator">=</span><span class="token string">'#000000'</span><span class="token punctuation">,</span>
        formatter<span class="token operator">=</span><span class="token string">'{c}'</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token comment"># åè½¬åæ ‡è½´</span>
bar<span class="token punctuation">.</span>reversal_axis<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># ç”Ÿæˆæ–‡ä»¶</span>
bar<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">'./å„ç§ç”µå½±ç±»å‹åˆ©æ¶¦ç»Ÿè®¡æŸ±çŠ¶å›¾.html'</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/b3/61/hr7rPwtQ_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>åˆ†æç»“è®ºï¼š</p> 
<p>ä»å›¾ä¸­è§‚å¯Ÿåˆ°ï¼Œæ‹æ‘„ Animationã€Adventureã€Fantasy è¿™ä¸‰ç±»ç”µå½±ç›ˆåˆ©æœ€å¥½ï¼Œè€Œæ‹æ‘„ Foreignã€TV Movie è¿™ä¸¤ç±»ç”µå½±ä¼šå­˜åœ¨äºæœ¬çš„é£é™©</p> 
<p><strong>æœªå®Œå¾…ç»­ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</strong></p> 
<h3><a id="web_644"></a>è¡¥å……ï¼šä¸åšæˆwebç³»ç»Ÿ</h3> 
<p>** æ•°æ®é¢„è§ˆ**</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> json

<span class="token comment"># =============================================åŠ è½½æ•°æ®===================================</span>

<span class="token comment"># åŠ è½½æ•°æ® --credits</span>
credits <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./tmdb_5000_credits.csv'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'credits:\n'</span><span class="token punctuation">,</span> credits<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'*'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'credits:\n'</span><span class="token punctuation">,</span> credits<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'*'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'credits:\n'</span><span class="token punctuation">,</span> credits<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'*'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>

<span class="token comment"># åŠ è½½æ•°æ®</span>
movies <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./tmdb_5000_movies.csv'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'movies:\n'</span><span class="token punctuation">,</span> movies<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'movies:\n'</span><span class="token punctuation">,</span> movies<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'movies:\n'</span><span class="token punctuation">,</span> movies<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/d4/e2/IKOK6AL9_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><strong>åˆå¹¶æ•°æ®é›†</strong></p> 
<p>å…ˆå°† credits æ•°æ®é›†å’Œ movie æ•°æ®é›†ä¸­çš„æ•°æ®åˆå¹¶åœ¨ä¸€èµ·ï¼Œå†æŸ¥çœ‹åˆå¹¶åçš„æ•°æ®é›†ä¿¡æ¯</p> 
<p>ä»£ç å®ç°ï¼š</p> 
<pre><code class="prism language-python"><span class="token comment"># ï¼ˆ1ï¼‰åˆå¹¶æ•°æ®</span>
<span class="token comment"># print(credits['crew'])</span>
<span class="token comment"># credits ä¸­å­˜åœ¨ movie_id  å’Œ title</span>
<span class="token comment"># movies ä¸­å­˜åœ¨ id å’Œ title</span>
<span class="token comment"># å°† credits ä¸­çš„ movie_id ä¿®æ”¹ä¸º id</span>
credits<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'movie_id'</span><span class="token punctuation">:</span> <span class="token string">'id'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token comment"># print('creditsçš„åˆ—ç´¢å¼•ï¼š\n', credits.columns)</span>
<span class="token comment"># ä¸»é”®åˆå¹¶ ---on id å’Œ title</span>
all_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>left<span class="token operator">=</span>credits<span class="token punctuation">,</span> right<span class="token operator">=</span>movies<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'outer'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_data:\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_data:\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_data:\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">.</span>dtypes<span class="token punctuation">)</span>

</code></pre> 
<p><strong>é€‰å–å­é›†</strong></p> 
<p>ç”±äºæ•°æ®é›†ä¸­åŒ…å«çš„ä¿¡æ¯è¿‡å¤šï¼Œå…¶ä¸­éƒ¨åˆ†æ•°æ®å¹¶ä¸æ˜¯æˆ‘ä»¬ç ”ç©¶çš„é‡ç‚¹ï¼Œæ‰€ä»¥ä»ä¸­é€‰å–æˆ‘ ä»¬éœ€è¦çš„æ•°æ®ï¼š</p> 
<p>ä»£ç å®ç°ï¼š</p> 
<pre><code class="prism language-python"><span class="token comment"># ç­›é€‰ç‰¹å¾</span>
all_data <span class="token operator">=</span> all_data<span class="token punctuation">[</span><span class="token string">'original_title'</span><span class="token punctuation">,</span> <span class="token string">'crew'</span><span class="token punctuation">,</span> <span class="token string">'release_date'</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">,</span> <span class="token string">'keywords'</span><span class="token punctuation">,</span>
                    <span class="token string">'production_companies'</span><span class="token punctuation">,</span> <span class="token string">'production_countries'</span><span class="token punctuation">,</span> <span class="token string">'revenue'</span><span class="token punctuation">,</span>
                    <span class="token string">'budget'</span><span class="token punctuation">,</span> <span class="token string">'runtime'</span><span class="token punctuation">,</span> <span class="token string">'vote_average'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_dataçš„åˆ—ç´¢å¼•ï¼š\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_dataçš„å½¢çŠ¶ï¼š\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>

</code></pre> 
<p>ç”±äºåé¢çš„æ•°æ®åˆ†ææ¶‰åŠåˆ°ç”µå½±ç±»å‹çš„åˆ©æ¶¦è®¡ç®—ï¼Œå…ˆæ±‚å‡ºæ¯éƒ¨ç”µå½±çš„åˆ©æ¶¦ï¼Œå¹¶åœ¨æ•°æ®é›† data ä¸­å¢åŠ  profit æ•°æ®åˆ—</p> 
<p>ä»£ç å®ç°ï¼š</p> 
<pre><code class="prism language-python"><span class="token comment"># å¢åŠ åˆ©æ¶¦</span>
all_data<span class="token punctuation">[</span><span class="token string">'profit'</span><span class="token punctuation">]</span> <span class="token operator">=</span> all_data<span class="token punctuation">[</span><span class="token string">'revenue'</span><span class="token punctuation">]</span> <span class="token operator">-</span> all_data<span class="token punctuation">[</span><span class="token string">'budget'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_dataçš„åˆ—ç´¢å¼•ï¼š\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_dataçš„å½¢çŠ¶ï¼š\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">)</span>

</code></pre> 
<p><strong>ç¼ºå¤±å€¼å¤„ç†</strong></p> 
<p>ä»£ç å®ç°ï¼š</p> 
<pre><code class="prism language-python"><span class="token comment"># æ£€æµ‹ç¼ºå¤±å€¼</span>
<span class="token comment"># pd.isnull + sum</span>
res_null <span class="token operator">=</span> pd<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span>all_data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'ç¼ºå¤±å€¼æ£€æµ‹ç»“æœï¼š\n'</span><span class="token punctuation">,</span> res_null<span class="token punctuation">)</span>

<span class="token comment"># æ£€æµ‹åˆ° release_date å­˜åœ¨ä¸€ä¸ªç¼ºå¤±å€¼ ---é’ˆå¯¹æ–¹å¼ï¼šå¡«å……ï¼ŒæŸ¥æ‰¾å…·ä½“çš„ç”µå½±åç§°ï¼Œæ ¹æ®ç”µå½±åç§°æŸ¥æ‰¾ä¸Šæ˜ æ—¶é—´</span>
<span class="token comment"># aã€ç¡®å®šboolæ•°ç»„</span>
mask <span class="token operator">=</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'release_date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># bã€æ ¹æ®boolæ•°ç»„æ¥è·å–ç¼ºå¤±å€¼ä½ç½®çš„ç”µå½±åç§°</span>
movie_name <span class="token operator">=</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>mask<span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'ç¼ºå¤±ä¸Šæ˜ æ—¥æœŸçš„ç”µå½±åç§°ä¸ºï¼š\n'</span><span class="token punctuation">,</span> movie_name<span class="token punctuation">)</span>
<span class="token comment"># ç¼ºå¤±ä¸Šæ˜ æ—¥æœŸçš„ç”µå½±åç§°ä¸ºï¼š</span>
<span class="token comment">#  4553    America Is Still the Place</span>
<span class="token comment"># Name: title, dtype: object</span>

<span class="token comment"># é€šè¿‡ä¸Šç½‘æŸ¥è¯¢è¯¥ç”µå½±çš„ä¸Šæ˜ æ—¥æœŸä¸ºï¼š2014-06-01</span>
<span class="token comment"># c ã€ å¡«å……</span>
all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>mask<span class="token punctuation">,</span> <span class="token string">'release_date'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'2014-06-01'</span>

<span class="token comment"># å°† release_date è½¬åŒ–ä¸º pandasæ”¯æŒçš„æ—¶é—´åºåˆ—</span>
all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'release_date'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'release_date'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># è·å– å‘è¡Œå¹´ä»½</span>
all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'release_year'</span><span class="token punctuation">]</span> <span class="token operator">=</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'release_date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>year

</code></pre> 
<p>é€šè¿‡ä¸Šé¢çš„ç»“æœä¿¡æ¯å¯ä»¥çŸ¥é“ï¼šæ•´ä¸ªæ•°æ®é›†ç¼ºå¤±çš„æ•°æ®æ¯”è¾ƒå°‘ã€‚ å…¶ä¸­ release_dateï¼ˆé¦–æ¬¡ä¸Šæ˜ æ—¥æœŸï¼‰ç¼ºå¤± 1 ä¸ªæ•°æ®,å¯ä»¥é€šè¿‡ç½‘ä¸ŠæŸ¥è¯¢è¡¥é½è¿™ä¸ªæ•°æ®ï¼Œå¡«è¡¥ release_dateï¼ˆé¦–æ¬¡ä¸Šæ˜ æ—¥æœŸï¼‰æ•°æ®</p> 
<p><strong>æ•°æ®æ ¼å¼è½¬æ¢</strong></p> 
<p>genres åˆ—æ•°æ®å¤„ç†ï¼š</p> 
<p>ä»£ç å®ç°ï¼š</p> 
<pre><code class="prism language-python"><span class="token comment"># æŸ¥çœ‹ç”µå½±é£æ ¼æ•°æ®</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'ç”µå½±é£æ ¼ï¼š\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># jsonæ•°æ®ç±»å‹</span>

<span class="token comment"># json.loads # å¯ä»¥å°†jsonè½¬åŒ–ä¸ºpythonç±»å‹</span>
<span class="token comment"># å°† all_data.loc[:, 'genres'] ç”± jsonç±»å‹è½¬åŒ–ä¸º pythonç±»å‹</span>
all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span> <span class="token operator">=</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>transform<span class="token punctuation">(</span>json<span class="token punctuation">.</span>loads<span class="token punctuation">)</span>

<span class="token comment"># æ„å»ºæ‰€æœ‰çš„ç”µå½±çš„ç±»å‹</span>
all_movie_type <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token comment"># å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œæ¥æå–ç”µå½±ç±»å‹</span>
<span class="token keyword">def</span> <span class="token function">get_movie_type</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    è·å–ç”µå½±ç±»å‹
    :param val: æ•°æ®
    :return: æå–ä¹‹åçš„ç”µå½±ç±»å‹æ•°æ®
    """</span>
    <span class="token comment"># æ„å»ºä¸€ä¸ªç©ºåˆ—è¡¨ï¼Œç”¨æ¥å­˜å‚¨æ¯ä¸€ä¸ªç”µå½±çš„ç”µå½±ç±»å‹</span>
    type_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token comment"># éå† åˆ—è¡¨</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> val<span class="token punctuation">:</span>
        <span class="token comment"># å¦‚æœitemå­˜åœ¨</span>
        <span class="token keyword">if</span> item<span class="token punctuation">:</span>
            <span class="token comment"># è·å–è¯¥ç”µå½±çš„ç”µå½±ç±»å‹</span>
            movie_type <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>
            <span class="token comment"># å°†å…¶åŠ å…¥åˆ° type_list</span>
            type_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>movie_type<span class="token punctuation">)</span>
            <span class="token comment"># å°†å…¶åŠ å…¥åˆ° all_movie_type</span>
            all_movie_type<span class="token punctuation">.</span>add<span class="token punctuation">(</span>movie_type<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>type_list<span class="token punctuation">)</span>


<span class="token comment"># è°ƒç”¨</span>
all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span> <span class="token operator">=</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>transform<span class="token punctuation">(</span>get_movie_type<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'è·å–ç”µå½±ç±»å‹ä¹‹åçš„ç»“æœï¼š\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># å°†æ‰€æœ‰çš„ç”µå½±ç±»å‹è½¬åŒ–ä¸º list</span>
all_movie_type <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>all_movie_type<span class="token punctuation">)</span>

<span class="token comment"># éå†</span>
<span class="token keyword">for</span> column <span class="token keyword">in</span> all_movie_type<span class="token punctuation">:</span>
    <span class="token comment"># å…ˆå¢åŠ </span>
    all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> column<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token comment"># æ„å»ºboolæ•°ç»„</span>
    mask <span class="token operator">=</span> all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'genres'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>contains<span class="token punctuation">(</span>column<span class="token punctuation">)</span>
    <span class="token comment"># ä¿®æ”¹</span>
    all_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>mask<span class="token punctuation">,</span> column<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'all_data:\n'</span><span class="token punctuation">,</span> all_data<span class="token punctuation">)</span>

</code></pre> 
<p><strong>æ•°æ®å¯è§†åŒ–</strong></p> 
<p>ç»˜åˆ¶ç”µå½±æ•°æ®ç±»å‹éšæ—¶é—´å˜åŒ–è¶‹åŠ¿å›¾</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment"># åˆ›å»ºç”»å¸ƒ</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># é»˜è®¤ä¸æ”¯æŒä¸­æ–‡ ---ä¿®æ”¹RCå‚æ•°</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'SimHei'</span>
<span class="token comment"># å¢åŠ å­—ä½“ä¹‹åå˜å¾—ä¸æ”¯æŒè´Ÿå·ï¼Œéœ€è¦ä¿®æ”¹RCå‚æ•°è®©å…¶ç»§ç»­æ”¯æŒè´Ÿå·</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>
<span class="token comment"># æ„å»ºæ¨ªè½´æ•°æ®</span>
x <span class="token operator">=</span> groupby_year<span class="token punctuation">.</span>index
<span class="token keyword">for</span> movie_type <span class="token keyword">in</span> groupby_year<span class="token punctuation">.</span>columns<span class="token punctuation">:</span>
    <span class="token comment"># æ„å»ºçºµè½´æ•°æ®</span>
    y <span class="token operator">=</span> groupby_year<span class="token punctuation">[</span>movie_type<span class="token punctuation">]</span>
    <span class="token comment"># ç»˜åˆ¶æŠ˜çº¿å›¾</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
<span class="token comment"># å¢åŠ æ ‡é¢˜</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'ç”µå½±æ•°æ®ç±»å‹éšæ—¶é—´å˜åŒ–è¶‹åŠ¿å›¾'</span><span class="token punctuation">)</span>
<span class="token comment"># è®¾ç½®å›¾ä¾‹</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>groupby_year<span class="token punctuation">.</span>columns<span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token string">'x-small'</span><span class="token punctuation">)</span>
<span class="token comment"># è®¾ç½®çºµè½´åç§°</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'æ•°é‡'</span><span class="token punctuation">)</span>
<span class="token comment"># è®¾ç½®æ¨ªè½´åç§°</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'å¹´ä»½'</span><span class="token punctuation">)</span>
<span class="token comment"># å¢åŠ ç½‘ç»œæ›²çº¿</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>b<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span>
<span class="token comment"># ä¿å­˜å›¾ç‰‡</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'./ç”µå½±æ•°æ®ç±»å‹éšæ—¶é—´å˜åŒ–'</span><span class="token punctuation">)</span>
<span class="token comment"># å±•ç¤º</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/ef/cb/H67SBIM9_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> åˆ†æç»“è®ºï¼š ä»å›¾ä¸­è§‚å¯Ÿåˆ°ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œæ‰€æœ‰ç”µå½±ç±»å‹éƒ½å‘ˆç°å‡ºå¢é•¿è¶‹åŠ¿ï¼Œå°¤å…¶æ˜¯ 1992 å¹´ä»¥ åå„ä¸ªç±»å‹çš„ç”µå½±å‡å¢é•¿è¿…é€Ÿï¼Œå…¶ä¸­ Drama(æˆå‰§)å’Œ Comedy(å–œå‰§)å¢é•¿æœ€å¿«ï¼Œç›®å‰ä»æ˜¯æœ€çƒ­ é—¨çš„ç”µå½±ç±»å‹</p> 
<p><strong>ç»˜åˆ¶å„ç§ç±»å‹ç”µå½±æ•°é‡çš„ç»Ÿè®¡æŸ±çŠ¶å›¾</strong></p> 
<p><img src="https://images2.imgbox.com/a1/87/qVCnsaO2_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><strong>ç»˜åˆ¶å„ç§ç”µå½±ç±»å‹çš„å æ¯”é¥¼å›¾</strong><br> <img src="https://images2.imgbox.com/45/09/SV7P1RyL_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><strong>ç”µå½±ç±»å‹å¹³å‡åˆ©æ¶¦æ•°æ®å¯è§†åŒ–</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># å¯è§†åŒ– ---æ¯” å„ç§ç”µå½±ç±»å‹ çš„ å¹³å‡åˆ©æ¶¦ ---æŸ±çŠ¶å›¾</span>
<span class="token comment"># Pyecharts</span>
<span class="token comment"># å®ä¾‹åŒ–å¯¹è±¡</span>
bar <span class="token operator">=</span> Bar<span class="token punctuation">(</span>
    <span class="token comment"># åˆå§‹åŒ–é…ç½®</span>
    init_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>InitOpts<span class="token punctuation">(</span>
        width<span class="token operator">=</span><span class="token string">'900px'</span><span class="token punctuation">,</span>
        height<span class="token operator">=</span><span class="token string">'600px'</span><span class="token punctuation">,</span>
        theme<span class="token operator">=</span><span class="token string">"white"</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment"># æ·»åŠ æ•°æ®</span>
bar<span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span>
    xaxis_data<span class="token operator">=</span>res_series<span class="token punctuation">.</span>index<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

bar<span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span>
    series_name<span class="token operator">=</span><span class="token string">' '</span><span class="token punctuation">,</span>
    yaxis_data<span class="token operator">=</span><span class="token punctuation">[</span><span class="token builtin">float</span><span class="token punctuation">(</span><span class="token string">'%.2f'</span> <span class="token operator">%</span> i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">(</span>res_series <span class="token operator">/</span> <span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    color<span class="token operator">=</span><span class="token string">'#6495ED'</span>
<span class="token punctuation">)</span>

<span class="token comment"># è®¾ç½®å…¨å±€é…ç½®</span>
bar<span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
    <span class="token comment"># æ ‡é¢˜</span>
    title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>
        title<span class="token operator">=</span><span class="token string">'å„ç§ç”µå½±ç±»å‹åˆ©æ¶¦ç»Ÿè®¡æŸ±çŠ¶å›¾'</span><span class="token punctuation">,</span>
        <span class="token comment"># subtitle='å¹¿å·åˆ†æ ¡Python0421ç­çº§'</span>
        pos_left<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span>
        pos_top<span class="token operator">=</span><span class="token string">'3%'</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment"># å›¾ä¾‹</span>
    legend_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LegendOpts<span class="token punctuation">(</span>
        is_show<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment"># æ¨ªè½´åæ ‡è®¾ç½®</span>
    xaxis_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisOpts<span class="token punctuation">(</span>
        name<span class="token operator">=</span><span class="token string">'åˆ©æ¶¦(ç™¾ä¸‡)'</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment"># # åæ ‡ç³»è®¾ç½®</span>
    yaxis_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisOpts<span class="token punctuation">(</span>
        name<span class="token operator">=</span><span class="token string">'ç”µå½±ç±»å‹'</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment"># è®¾ç½®ç³»åˆ—é…ç½®</span>
bar<span class="token punctuation">.</span>set_series_opts<span class="token punctuation">(</span>
    label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>
        is_show<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        position<span class="token operator">=</span><span class="token string">'right'</span><span class="token punctuation">,</span>
        color<span class="token operator">=</span><span class="token string">'#000000'</span><span class="token punctuation">,</span>
        formatter<span class="token operator">=</span><span class="token string">'{c}'</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token comment"># åè½¬åæ ‡è½´</span>
bar<span class="token punctuation">.</span>reversal_axis<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># ç”Ÿæˆæ–‡ä»¶</span>
bar<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">'./å„ç§ç”µå½±ç±»å‹åˆ©æ¶¦ç»Ÿè®¡æŸ±çŠ¶å›¾.html'</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/ec/fd/tA3wNChQ_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>ğŸ§¿ <strong>é€‰é¢˜æŒ‡å¯¼, é¡¹ç›®åˆ†äº«ï¼šè§æ–‡æœ«</strong></p> 
<h2><a id="5__947"></a>5 æœ€å</h2> 
<p>**æ¯•è®¾å¸®åŠ©, é€‰é¢˜æŒ‡å¯¼, é¡¹ç›®åˆ†äº«: ** <a href="https://gitee.com/yaa-dc/warehouse-1/blob/master/python/README.md" rel="nofollow">https://gitee.com/yaa-dc/warehouse-1/blob/master/python/README.md</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/394510ba1f0c605c0274f367c1754149/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">springbooté›†æˆstarrocksã€ä»¥åŠé‡‡ç”¨flinkå®ç°mysqlä¸starrocksäºšç§’çº§åŒæ­¥_spring&#43;starrocks(1)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6190ed4a0f0b26468c3e06de712a5cc1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">çªç ´ç¼–ç¨‹_å‰ç«¯_SVGï¼ˆä½¿ç”¨ svg-pan-zoom åº“è¿›è¡Œå¹³ç§»ä¸ç¼©æ”¾ï¼‰</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§å’–.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>