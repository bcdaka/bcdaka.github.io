<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>whisper、whisper.cpp、faster-whisper的比较 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/a9a071317789d09ac8163f7ccb4ba6a0/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="whisper、whisper.cpp、faster-whisper的比较">
  <meta property="og:description" content="让我们比较一下当前的whisper、whisper.cpp和faster-whisper。
OpenAI / Whisper 自发布以来，似乎在各个方面都发生了变化，例如在 2022 年 12 月增加了 large-v2 模型和各种版本升级。
whisper.cpp是用 CPU 的 C/C&#43;&#43; 编写的。 它似乎是Core ML支持，所以它对于Mac用户有强烈的感觉。
而 faster-whisper是基于 CTranslate2 重写了 Whisper 模型，似乎它的速度比原版的快 4 倍，精度也相同，并且使用的内存更少。
以下是测试音频 （WAV）（48 秒）的测试示例。
结果
Faster-whisper 的 GPU 和传闻中的一样快。
Faster-whisper CPU运算速度更快，GPU的速度也从85.62秒→23.9秒加快。
whisper.cpp 效果反而不是很好。 可能真正的价值体现在支持Mac CoreML加速上。
ImplementationDeviceTime结果openai/whisperCPU3分1秒上午和今天的东京股市，日经平均指数小幅走高，收于11.72日元，比昨天上涨22.72日元。 是088.58日元，最初价格上涨的股票数量为1146只，而下跌的股票数量为368只，保持不变的股票数量为104只股票，以下是礼物的公告： 在这个节目中，将抽签选出10人来接收每月出版的月报4月号，申请在东京通过电话03-0107-837303-0107-8373openai/whisperGPU23.9秒上午和今天的东京股市，日经平均指数小幅走高，收于11.72日元，比昨天上涨22.72日元。 是088.58日元，最初价格上涨的股票数量为1146只，而下跌的股票数量为368只，保持不变的股票数量为104只股票，以下是礼物的公告： 在这个节目中，将抽签选出10人来接收每月出版的月报4月号，申请在东京通过电话03-0107-837303-0107-8373whisper.cppCPU7分13秒上午和今天的东京股市，日经平均指数小幅走高，收于11.72日元，比昨天上涨22.72日元。 是088.58日元，最初价格上涨的股票数量为1146只，但价格下跌了368只，104只股票保持不变，这是礼物公告该计划将通过抽签将月度报告4月号赠送给10人申请，请致电东京03-0107-8373,03-0107-8373faster-whisperCPU（Float32）4分 18秒我是浅野智美 今天东京股市的日经平均指数略高 收盘价为11,088.58日元，比昨天上涨22.72日元 最初价格上涨的股票数量为1146只，而价格下跌的股票数量为368只股票保持不变 104只股票 以下是礼物的公告： 在本节目中，出版了月度报告4月号。 我们将通过抽签将其赠送给 10 人 申请，请致电东京 03-0107-8373 03-0107-8373 以上是该计划的公告faster-whisperCPU（int8）2分 27秒我是浅野智美 今天东京股市的日经平均指数略高 收盘价为11,088.58日元，比昨天上涨22.72日元 最初价格上涨的股票数量为1146只，而价格下跌的股票数量为368只股票保持不变 104只股票 以下是礼物的公告： 在本节目中，出版了月度报告4月号。 我们将通过抽签将其赠送给 10 人 申请时，请致电东京0301078373 0301078373 以上是该计划的公告。faster-whisperGPU（Float16）5.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-28T22:36:46+08:00">
    <meta property="article:modified_time" content="2024-03-28T22:36:46+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">whisper、whisper.cpp、faster-whisper的比较</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>让我们比较一下当前的whisper、whisper.cpp和faster-whisper。</p> 
<p>OpenAI / Whisper 自发布以来，似乎在各个方面都发生了变化，例如在 2022 年 12 月增加了 large-v2 模型和各种版本升级。</p> 
<p>whisper.cpp是用 CPU 的 C/C++ 编写的。 它似乎是Core ML支持，所以它对于Mac用户有强烈的感觉。</p> 
<p>而 faster-whisper是基于 CTranslate2 重写了 Whisper 模型，似乎它的速度比原版的快 4 倍，精度也相同，并且使用的内存更少。</p> 
<p>以下是<a href="https://choimitena.com/Audio/SampleJPX" rel="nofollow">测试音频 （WAV）（</a>48 秒）的测试示例。</p> 
<p><strong>结果</strong></p> 
<p>Faster-whisper 的 GPU 和传闻中的一样快。<br> Faster-whisper CPU运算速度更快，GPU的速度也从85.62秒→23.9秒加快。<br> whisper.cpp 效果反而不是很好。 可能真正的价值体现在支持Mac CoreML加速上。</p> 
<table><thead><tr><th>Implementation</th><th>Device</th><th>Time</th><th>结果</th></tr></thead><tbody><tr><td>openai/whisper</td><td>CPU</td><td>3分1秒</td><td>上午和今天的东京股市，日经平均指数小幅走高，收于11.72日元，比昨天上涨22.72日元。 是088.58日元，最初价格上涨的股票数量为1146只，而下跌的股票数量为368只，保持不变的股票数量为104只股票，以下是礼物的公告： 在这个节目中，将抽签选出10人来接收每月出版的月报4月号，申请在东京通过电话03-0107-837303-0107-8373</td></tr><tr><td>openai/whisper</td><td>GPU</td><td>23.9秒</td><td>上午和今天的东京股市，日经平均指数小幅走高，收于11.72日元，比昨天上涨22.72日元。 是088.58日元，最初价格上涨的股票数量为1146只，而下跌的股票数量为368只，保持不变的股票数量为104只股票，以下是礼物的公告： 在这个节目中，将抽签选出10人来接收每月出版的月报4月号，申请在东京通过电话03-0107-837303-0107-8373</td></tr><tr><td>whisper.cpp</td><td>CPU</td><td>7分13秒</td><td>上午和今天的东京股市，日经平均指数小幅走高，收于11.72日元，比昨天上涨22.72日元。 是088.58日元，最初价格上涨的股票数量为1146只，但价格下跌了368只，104只股票保持不变，这是礼物公告该计划将通过抽签将月度报告4月号赠送给10人申请，请致电东京03-0107-8373,03-0107-8373</td></tr><tr><td>faster-whisper</td><td>CPU（Float32）</td><td>4分 18秒</td><td>我是浅野智美 今天东京股市的日经平均指数略高 收盘价为11,088.58日元，比昨天上涨22.72日元 最初价格上涨的股票数量为1146只，而价格下跌的股票数量为368只股票保持不变 104只股票 以下是礼物的公告： 在本节目中，出版了月度报告4月号。 我们将通过抽签将其赠送给 10 人 申请，请致电东京 03-0107-8373 03-0107-8373 以上是该计划的公告</td></tr><tr><td>faster-whisper</td><td>CPU（int8）</td><td>2分 27秒</td><td>我是浅野智美 今天东京股市的日经平均指数略高 收盘价为11,088.58日元，比昨天上涨22.72日元 最初价格上涨的股票数量为1146只，而价格下跌的股票数量为368只股票保持不变 104只股票 以下是礼物的公告： 在本节目中，出版了月度报告4月号。 我们将通过抽签将其赠送给 10 人 申请时，请致电东京0301078373 0301078373 以上是该计划的公告。</td></tr><tr><td>faster-whisper</td><td>GPU（Float16）</td><td>5.22 秒</td><td>我是浅野智美 今天东京股市的日经平均指数略高 收盘价为11,088.58日元，比昨天上涨22.72日元 最初价格上涨的股票数量为1146只，而价格下跌的股票数量为368只股票保持不变 104只股票 以下是礼物的公告： 在本节目中，出版了月度报告4月号。 我们将通过抽签将其赠送给 10 人 申请，请致电东京 03-0107-8373 03-0107-8373 以上是该计划的公告</td></tr><tr><td>faster-whisper</td><td>GPU（int8_float16）</td><td>4.73 秒</td><td>我是浅野智美 今天东京股市的日经平均指数略高 收盘价为11,088.58日元，比昨天上涨22.72日元 最初价格上涨的股票数量为1146只，而价格下跌的股票数量为368只股票保持不变 104只股票 以下是礼物的公告： 在本节目中，出版了月度报告4月号。 我们将通过抽签将其赠送给 10 人 申请时，请致电东京0301078373 0301078373 以上是该计划的公告。</td></tr></tbody></table> 
<h2><a id="httpszenndevpimentarticles24269616aa9c04whisperWhisper_26"></a><a href="https://zenn.dev/piment/articles/24269616aa9c04#whisper" rel="nofollow"></a>Whisper</h2> 
<p>安装</p> 
<pre><code>!pip install -U openai-whisper
</code></pre> 
<p>模型加载</p> 
<pre><code>import whisper
model = whisper.load_model("large", device="cpu")
</code></pre> 
<p>执行</p> 
<pre><code>%%time
result = model.transcribe("sampleTokyo.WAV")
print(result["text"])
</code></pre> 
<h2><a id="httpszenndevpimentarticles24269616aa9c04whispercppwhispercpp_52"></a><a href="https://zenn.dev/piment/articles/24269616aa9c04#whisper.cpp" rel="nofollow"></a>whisper.cpp</h2> 
<p>安装</p> 
<pre><code>!git clone https://github.com/ggerganov/whisper.cpp.git
%cd whisper.cpp
!bash ./models/download-ggml-model.sh large
!make
</code></pre> 
<p>转换为 16kHz 的 WAV</p> 
<pre><code>!ffmpeg -i ../sampleTokyo.WAV -ar 16000 sampleTokyo.wav
</code></pre> 
<p>执行</p> 
<pre><code>%%time
!./main -f ./sampleTokyo.wav -nt -l ja -m models/ggml-large.bin
</code></pre> 
<h2><a id="fasterwhisper_79"></a>faster-whisper</h2> 
<p>安装</p> 
<pre><code>!pip install faster-whisper
</code></pre> 
<p>模型加载</p> 
<pre><code>from faster_whisper import WhisperModel
model_size = "large-v2"

model = WhisperModel(model_size, device="cpu", compute_type="float32")
#model = WhisperModel(model_size, device="cpu", compute_type="int8")
#model = WhisperModel(model_size, device="cuda", compute_type="float16")
#model = WhisperModel(model_size, device="cuda", compute_type="int8_float16")
</code></pre> 
<pre><code>%%time
segments, info = model.transcribe("sampleTokyo.WAV", beam_size=5, language='ja')
results = list(segments)
print(' '.join([result.text for result in results]))
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f0d79f679259ebe01e22b17567a65210/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">eNSP综合实验合集（eNSP综合大作业合集）_可先收藏</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cba135bee43d969600dbe5be72998589/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">hadoop 单节点模式安装</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>