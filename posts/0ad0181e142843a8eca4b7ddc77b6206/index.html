<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【Python】Pandas Groupby操作的25个示例 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/0ad0181e142843a8eca4b7ddc77b6206/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【Python】Pandas Groupby操作的25个示例">
  <meta property="og:description" content="Pandas Groupby操作的25个示例 1. Groupby的基本原理2. agg聚合操作3. transform4. apply5. 25个代码示例1. 单列聚合2. 多列聚合3. 多方式聚合4. 对聚合结果进行命名5. 多个聚合和多个函数6. 不同列的聚合进行命名7. as_index参数8. 用于分组的多列9. 排序输出10. 最大的Top N11. 最小的Top N12. 第n个值13. 第n个值，倒排序14. 唯一值15. 唯一值的数量16. Lambda表达式17. apply函数18. dropna19. 求组的个数20. 获得一个特定分组21. rank函数22. 累计操作23. expanding函数24. 累积平均25. 展开后的最大值 参考资料 在日常的数据分析中，经常需要将数据根据某个（多个）字段划分为不同的群体（group）进行分析，如电商领域将全国的总销售额根据省份进行划分，分析各省销售额的变化情况，社交领域将用户根据画像（性别、年龄）进行细分，研究用户的使用情况和偏好等。在Pandas中，上述的数据处理操作主要运用groupby完成，本文就介绍一下 groupby的基本原理及对应的 agg、 transform和 apply等操作，总共包含25个代码示例。 首先，模拟生成10个样本数据：
import pandas as pd import numpy as np company=[&#34;A&#34;,&#34;B&#34;,&#34;C&#34;] data=pd.DataFrame({ &#34;company&#34;:[company[x] for x in np.random.randint(0,len(company),10)], &#34;salary&#34;:np.random.randint(5,50,10), &#34;age&#34;:np.random.randint(15,50,10) } ) 1. Groupby的基本原理 在pandas中，实现分组操作的代码很简单，仅需一行代码，在这里，将上面的数据集按照company字段进行划分：
这个生成的DataFrameGroupBy是啥呢？对data进行了groupby后发生了什么？ipython所返回的结果是其内存地址，并不利于直观地理解，为了看看group内部究竟是什么，这里把group转换成list的形式来看一看：
转换成列表的形式后，可以看到，列表由三个元组组成，每个元组中，第一个元素是组别（这里是按照company进行分组，所以最后分为了A,B,C），第二个元素的是对应组别下的DataFrame，整个过程可以图解如下：
总结来说，groupby的过程就是将原有的DataFrame按照groupby的字段（这里是company），划分为若干个分组DataFrame，被分为多少个组就有多少个分组DataFrame。所以说，在groupby之后的一系列操作（如agg、apply等），均是基于子DataFrame的操作。理解了这点，也就基本摸清了Pandas中groupby操作的主要原理。
2. agg聚合操作 聚合操作是groupby操作之后非常常见的操作。聚合操作可以用来求和、均值、最大值、最小值等，下面的表格列出了Pandas中常见的聚合操作。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-03-24T08:00:00+08:00">
    <meta property="article:modified_time" content="2023-03-24T08:00:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Python】Pandas Groupby操作的25个示例</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>Pandas Groupby操作的25个示例</h4> 
 <ul><li><a href="#1_Groupby_17" rel="nofollow">1. Groupby的基本原理</a></li><li><a href="#2_agg_26" rel="nofollow">2. agg聚合操作</a></li><li><a href="#3_transform_36" rel="nofollow">3. transform</a></li><li><a href="#4_apply_46" rel="nofollow">4. apply</a></li><li><a href="#5_25_56" rel="nofollow">5. 25个代码示例</a></li><li><ul><li><a href="#1__57" rel="nofollow">1. 单列聚合</a></li><li><a href="#2__60" rel="nofollow">2. 多列聚合</a></li><li><a href="#3__64" rel="nofollow">3. 多方式聚合</a></li><li><a href="#4__67" rel="nofollow">4. 对聚合结果进行命名</a></li><li><a href="#5__70" rel="nofollow">5. 多个聚合和多个函数</a></li><li><a href="#6__72" rel="nofollow">6. 不同列的聚合进行命名</a></li><li><a href="#7_as_index_74" rel="nofollow">7. as_index参数</a></li><li><a href="#8__77" rel="nofollow">8. 用于分组的多列</a></li><li><a href="#9__83" rel="nofollow">9. 排序输出</a></li><li><a href="#10_Top_N_89" rel="nofollow">10. 最大的Top N</a></li><li><a href="#11_Top_N_93" rel="nofollow">11. 最小的Top N</a></li><li><a href="#12_n_96" rel="nofollow">12. 第n个值</a></li><li><a href="#13_n_99" rel="nofollow">13. 第n个值，倒排序</a></li><li><a href="#14__102" rel="nofollow">14. 唯一值</a></li><li><a href="#15__105" rel="nofollow">15. 唯一值的数量</a></li><li><a href="#16_Lambda_108" rel="nofollow">16. Lambda表达式</a></li><li><a href="#17_apply_111" rel="nofollow">17. apply函数</a></li><li><a href="#18_dropna_114" rel="nofollow">18. dropna</a></li><li><a href="#19__121" rel="nofollow">19. 求组的个数</a></li><li><a href="#20__124" rel="nofollow">20. 获得一个特定分组</a></li><li><a href="#21_rank_127" rel="nofollow">21. rank函数</a></li><li><a href="#22__130" rel="nofollow">22. 累计操作</a></li><li><a href="#23_expanding_136" rel="nofollow">23. expanding函数</a></li><li><a href="#24__139" rel="nofollow">24. 累积平均</a></li><li><a href="#25__142" rel="nofollow">25. 展开后的最大值</a></li></ul> 
  </li><li><a href="#_146" rel="nofollow">参考资料</a></li></ul> 
</div> 
<br> 在日常的数据分析中，经常需要将数据根据某个（多个）字段划分为不同的群体（group）进行分析，如电商领域将全国的总销售额根据省份进行划分，分析各省销售额的变化情况，社交领域将用户根据画像（性别、年龄）进行细分，研究用户的使用情况和偏好等。在Pandas中，上述的数据处理操作主要运用groupby完成，本文就介绍一下 
<code>groupby</code>的基本原理及对应的 
<code>agg</code>、 
<code>transform</code>和 
<code>apply</code>等操作，总共包含25个代码示例。 
<p></p> 
<p>首先，模拟生成10个样本数据：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

company<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"A"</span><span class="token punctuation">,</span><span class="token string">"B"</span><span class="token punctuation">,</span><span class="token string">"C"</span><span class="token punctuation">]</span>
data<span class="token operator">=</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token string">"company"</span><span class="token punctuation">:</span><span class="token punctuation">[</span>company<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>company<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">"salary"</span><span class="token punctuation">:</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">"age"</span><span class="token punctuation">:</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c6/3d/kX2MVBww_o.png" alt="模拟数据"></p> 
<h2><a id="1_Groupby_17"></a>1. Groupby的基本原理</h2> 
<p>在pandas中，实现分组操作的代码很简单，仅需一行代码，在这里，将上面的数据集按照<code>company</code>字段进行划分：<br> <img src="https://images2.imgbox.com/dd/2d/qTqJLWy0_o.png" alt="group"><br> 这个生成的<code>DataFrameGroupBy</code>是啥呢？对data进行了groupby后发生了什么？ipython所返回的结果是其内存地址，并不利于直观地理解，为了看看group内部究竟是什么，这里<strong>把group转换成list的形式</strong>来看一看：<br> <img src="https://images2.imgbox.com/2a/2b/vGlQesml_o.png" alt="list"><br> 转换成列表的形式后，可以看到，列表由三个元组组成，每个元组中，第一个元素是组别（这里是按照company进行分组，所以最后分为了A,B,C），第二个元素的是对应组别下的DataFrame，整个过程可以图解如下：<br> <img src="https://images2.imgbox.com/04/29/tttJCTBz_o.png" alt="groupby过程图解"></p> 
<p>总结来说，groupby的过程就是将原有的DataFrame按照groupby的字段（这里是company），划分为若干个分组DataFrame，被分为多少个组就有多少个分组DataFrame。所以说，在groupby之后的一系列操作（如agg、apply等），均是基于子DataFrame的操作。理解了这点，也就基本摸清了Pandas中groupby操作的主要原理。</p> 
<h2><a id="2_agg_26"></a>2. agg聚合操作</h2> 
<p>聚合操作是groupby操作之后非常常见的操作。聚合操作可以用来求和、均值、最大值、最小值等，下面的表格列出了Pandas中常见的聚合操作。<br> <img src="https://images2.imgbox.com/3c/79/tL7RGj5L_o.png" alt="聚合操作"><br> 针对样例数据集，如果想求不同公司员工的平均年龄和平均薪水，可以按照下方的代码进行：<br> <img src="https://images2.imgbox.com/92/4e/uCvZ8VaA_o.png" alt="mean"><br> 如果想对针对不同的列求不同的值，比如要计算不同公司员工的平均年龄以及薪水的中位数，可以利用字典进行聚合操作的指定：<br> <img src="https://images2.imgbox.com/da/41/6jmONSz4_o.png" alt="median"><br> agg聚合过程可以图解如下（第二个例子为例）：<br> <img src="https://images2.imgbox.com/a2/f4/ITStVbRI_o.png" alt="agg聚合过程图解"></p> 
<h2><a id="3_transform_36"></a>3. transform</h2> 
<p>transform是一种什么数据操作？和agg有什么区别呢？为了更好地理解transform和agg的不同，下面从实际的应用场景出发进行对比。</p> 
<p>在上面的agg中，我们知道了如何求不同公司员工的平均薪水，如果现在需要在原数据集中<strong>新增一列avg_salary</strong>，代表员工所在的公司的平均薪水（相同公司的员工具有一样的平均薪水），该怎么实现呢？如果按照正常的步骤来计算，需要先求得不同公司的平均薪水，然后按照员工和公司的对应关系填充到对应的位置，不用transform的话，实现代码如下：<br> <img src="https://images2.imgbox.com/73/c6/uEUS0U97_o.png" alt="新增一列avg_salary"><br> 如果使用<code>transform</code>的话，仅需要一行代码：<br> <img src="https://images2.imgbox.com/93/f5/4E8oTbeY_o.png" alt="avg_salary"><br> 还是以图解的方式来看看进行groupby后transform的实现过程（为了更直观展示，图中加入了company列，实际按照上面的代码只有salary列）：<br> <img src="https://images2.imgbox.com/95/f9/1bJ4otmg_o.png" alt="transform过程图解"><br> 图中的大方框是transform和agg所不一样的地方，对agg而言，会计算得到A，B，C公司对应的均值并直接返回，但对transform而言，则会对每一条数据求得相应的结果，同一组内的样本会有相同的值，组内求完均值后会按照原索引的顺序返回结果，如果有不理解的可以拿这张图和agg那张对比一下。</p> 
<h2><a id="4_apply_46"></a>4. apply</h2> 
<p>apply应该是大家的老朋友了，它相比agg和transform而言更加灵活，能够传入任意自定义的函数，实现复杂的数据操作。那么问题来了，在groupby后使用apply和groupby之前使用有什么区别呢？</p> 
<p>区别是有的，但是整个实现原理是基本一致的。两者的区别在于，对于groupby后的apply，以分组后的子DataFrame作为参数传入指定函数的，基本操作单位是DataFrame，而之前介绍的apply的基本操作单位是Series。还是以一个案例来介绍groupby后的apply用法。</p> 
<p>假设现在需要获取各个公司年龄最大的员工的数据，该怎么实现呢？可以用以下代码实现：<br> <img src="https://images2.imgbox.com/1b/e8/O6QY5BMn_o.png" alt="apply"><br> 这样便得到了每个公司年龄最大的员工的数据，整个流程图解如下：<br> <img src="https://images2.imgbox.com/20/d5/r5XBiUF8_o.png" alt="apply过程图解"><br> 最后，关于apply的使用，这里有个小建议，虽然说apply拥有更大的灵活性，但<strong>apply的运行效率会比agg和transform更慢</strong>。所以，<strong>groupby之后能用agg和transform解决的问题还是优先使用这两个方法</strong>，实在解决不了了才考虑使用apply进行操作。</p> 
<h2><a id="5_25_56"></a>5. 25个代码示例</h2> 
<h3><a id="1__57"></a>1. 单列聚合</h3> 
<p>计算出每个company的平均salary：<br> <img src="https://images2.imgbox.com/6d/55/04d34gp3_o.png" alt="单列聚合"></p> 
<h3><a id="2__60"></a>2. 多列聚合</h3> 
<p>在一个操作中进行多个聚合。下面是计算每个company的平均薪资和年龄：<br> <img src="https://images2.imgbox.com/42/3e/NhRXfM8f_o.png" alt="聚合"><br> 注意，这里使用的是双方括号“[[]]”。</p> 
<h3><a id="3__64"></a>3. 多方式聚合</h3> 
<p>使用agg函数来计算多个聚合值：<br> <img src="https://images2.imgbox.com/c9/24/PPd7YDuy_o.png" alt="agg"></p> 
<h3><a id="4__67"></a>4. 对聚合结果进行命名</h3> 
<p>可以对聚合的结果进行命名：<br> <img src="https://images2.imgbox.com/cc/b6/9EXAAk0D_o.png" alt="我们可以对聚合的结果进行命名。"></p> 
<h3><a id="5__70"></a>5. 多个聚合和多个函数</h3> 
<p><img src="https://images2.imgbox.com/df/73/RCcIGnV2_o.png" alt="多个聚合和多个函数"></p> 
<h3><a id="6__72"></a>6. 不同列的聚合进行命名</h3> 
<p><img src="https://images2.imgbox.com/f1/74/kYHTHifx_o.png" alt="不同列的聚合进行命名"></p> 
<h3><a id="7_as_index_74"></a>7. as_index参数</h3> 
<p>如果groupby操作的输出是DataFrame，可以使用as_index参数使它们成为DataFrame中的一列。<br> <img src="https://images2.imgbox.com/2d/41/cGZnIUdF_o.png" alt="as_index"></p> 
<h3><a id="8__77"></a>8. 用于分组的多列</h3> 
<p>就像可以聚合多个列一样，也可以使用多个列进行分组。</p> 
<pre><code class="prism language-python">sales<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"store"</span><span class="token punctuation">,</span><span class="token string">"product_group"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> as_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span>avg_sales <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">"last_week_sales"</span><span class="token punctuation">,</span> <span class="token string">"mean"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/65/87/wXLXcXJW_o.png" alt="用于分组的多列"></p> 
<h3><a id="9__83"></a>9. 排序输出</h3> 
<p>可以使用<code>sort_values</code>函数根据聚合列对输出进行排序.</p> 
<pre><code class="prism language-python">sales<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"store"</span><span class="token punctuation">,</span><span class="token string">"product_group"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> as_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span>avg_sales <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">"last_week_sales"</span><span class="token punctuation">,</span> <span class="token string">"mean"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'avg_sales'</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/85/2c/aBHMMFOG_o.png" alt="排序输出"></p> 
<h3><a id="10_Top_N_89"></a>10. 最大的Top N</h3> 
<p>max函数返回每个组的最大值。如果需要n个最大的值，可以用下面的方法：<br> <img src="https://images2.imgbox.com/18/9b/SqiYoBiB_o.png" alt="Top N"></p> 
<h3><a id="11_Top_N_93"></a>11. 最小的Top N</h3> 
<p>与最大值相似，也可以求最小值<br> <img src="https://images2.imgbox.com/4e/65/HuoWYF7d_o.png" alt="tail N"></p> 
<h3><a id="12_n_96"></a>12. 第n个值</h3> 
<p>还可以找到一组中的第n个值，例如，找到每个company中年龄第2的薪水：<br> <img src="https://images2.imgbox.com/3d/b2/h8zAV9Gm_o.png" alt="第n个值"></p> 
<h3><a id="13_n_99"></a>13. 第n个值，倒排序</h3> 
<p>也可以用负的第n项。例如，" nth(-2) "返回从末尾开始的第二行。<br> <img src="https://images2.imgbox.com/95/1d/Pvh0yFIV_o.png" alt="倒排序"></p> 
<h3><a id="14__102"></a>14. 唯一值</h3> 
<p><code>unique</code>函数可用于查找每组中唯一的值。例如，可以找到每个company中唯一的年龄，代码如下:<br> <img src="https://images2.imgbox.com/a7/a3/aHxj0CKS_o.png" alt="unique"></p> 
<h3><a id="15__105"></a>15. 唯一值的数量</h3> 
<p>可以使用nunique函数找到每组中唯一值的数量:<br> <img src="https://images2.imgbox.com/ff/df/8LpackwA_o.png" alt="nunique"></p> 
<h3><a id="16_Lambda_108"></a>16. Lambda表达式</h3> 
<p>可以在agg函数中<strong>使用lambda表达式作为自定义聚合操作</strong>。<br> <img src="https://images2.imgbox.com/55/f7/ZqgPuUwA_o.png" alt="lambda"></p> 
<h3><a id="17_apply_111"></a>17. apply函数</h3> 
<p>使用apply函数将Lambda表达式应用到每个组，如下所示:<br> <img src="https://images2.imgbox.com/69/7e/6HRloS5s_o.png" alt="apply"></p> 
<h3><a id="18_dropna_114"></a>18. dropna</h3> 
<p>缺省情况下，<code>groupby</code>函数忽略缺失值。<strong>如果用于分组的列中缺少一个值，那么它将不包含在任何组中，也不会单独显示</strong>。所以可以使用dropna参数来改变这个行为。</p> 
<p>首先添加一个缺少存储值的新行:<br> <img src="https://images2.imgbox.com/af/7e/04uBu2IS_o.png" alt="添加新行"><br> 然后计算带有dropna参数和不带有dropna参数的每个company的平均age，以查看差异。<br> <img src="https://images2.imgbox.com/a0/d2/K3UWZcDR_o.png" alt="dropna"></p> 
<h3><a id="19__121"></a>19. 求组的个数</h3> 
<p>有时需要知道生成了多少组，这可以使用<code>ngroups</code>：<br> <img src="https://images2.imgbox.com/bd/a6/iGoLD6l1_o.png" alt="ngroups"></p> 
<h3><a id="20__124"></a>20. 获得一个特定分组</h3> 
<p><code>get_group</code>函数可获取特定组并且返回DataFrame。<br> <img src="https://images2.imgbox.com/e3/72/aUmzZ75L_o.png" alt="获得一个特定分组"></p> 
<h3><a id="21_rank_127"></a>21. rank函数</h3> 
<p><code>rank</code>函数用于<strong>根据给定列中的值为行分配秩</strong>。可以使用rank和groupby函数分别对每个组中的行进行排序。<br> <img src="https://images2.imgbox.com/c2/2a/CB1gOqCa_o.png" alt="rank"></p> 
<h3><a id="22__130"></a>22. 累计操作</h3> 
<p>可以计算出每组的累计总和:<br> 先创建一个示例dataframe:<br> <img src="https://images2.imgbox.com/7d/b8/NkBmYMDm_o.png" alt="df"><br> 然后单独创建一个列，包含值列的累计总和，如下所示：<br> <img src="https://images2.imgbox.com/5e/a4/uEt8V1it_o.png" alt="df"></p> 
<h3><a id="23_expanding_136"></a>23. expanding函数</h3> 
<p><code>expanding</code>函数提供<strong>展开转换</strong>。但是对于展开以后的操作还是需要一个累计函数来对其操作。例如它与cumsum 函数一起使用，结果将与与sum函数相同。<br> <img src="https://images2.imgbox.com/38/9f/VGSisaHi_o.png" alt="expanding"></p> 
<h3><a id="24__139"></a>24. 累积平均</h3> 
<p>利用展开函数和均值函数计算累积平均：<br> <img src="https://images2.imgbox.com/bb/62/loaDZsQW_o.png" alt="累计平均"></p> 
<h3><a id="25__142"></a>25. 展开后的最大值</h3> 
<p>可以使用expand和max函数记录组当前最大值：<br> <img src="https://images2.imgbox.com/fa/4c/LMGhiU2t_o.png" alt="展开后的最大值"><br> 在Pandas中groupby函数与aggregate函数共同构成了高效的数据分析工具。</p> 
<h2><a id="_146"></a>参考资料</h2> 
<ol><li><a href="https://zhuanlan.zhihu.com/p/101284491" rel="nofollow">超好用的Groupby用法详解</a></li><li><a href="https://mp.weixin.qq.com/s/cb0Ct6-cLB25JXQ_8DjsBA?scene=25#wechat_redirect" rel="nofollow">25个例子学会Pandas Groupby 操作</a></li><li><a href="https://zhuanlan.zhihu.com/p/100064394" rel="nofollow">数据处理三板斧——map、apply、applymap详解</a></li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/046de0940bd95e45f59504c1a34c9d17/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">〖大前端 - 基础入门三大核心之CSS篇⑱〗- CSS中的背景</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1c44f3b5bcb0a59edf686863ee881dac/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Cookie和Session（会话技术）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>