<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>一起玩儿物联网人工智能小车（ESP32）——38. 激光测距模块VL53L0X的使用 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/fcb27dfc78a3e4872f30a90837ccde9b/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="一起玩儿物联网人工智能小车（ESP32）——38. 激光测距模块VL53L0X的使用">
  <meta property="og:description" content="摘要：本文介绍ESP32如何使用激光测距模块VL53L0X进行距离测量
在前面的自动避障小车中，主要使用超声波传感器来进行障碍物距离的测量，接下来将介绍另一种经常用到的测距传感器——激光测距传感器。其测量原理是传感器发出激光，然后再通过接收到的返回的激光来测量距离的方法。激光测距的方法有两种，一种是脉冲法，一种是相位法。脉冲法的原理与超声波传感器类似，是利用激光发射出去到返回之间的时间来计算激光器到物体之间的距离。而相位法则利用发出去的激光返回后的相位与仪器内直接返回激光的相位差来计算激光器到物体之间的距离。
这次使用的为新一代飞行时间（ToF）激光测距模块，这款飞行测距模块是基于基于VL53L0X设计的。样子如下图所示：
VL53L0X是ST推出的第二代FlightSense技术的飞行时间传感器，与传统的测距传感器不同，VL53L0X采用ST的ToF技术，是目前最小的激光测距芯片，无论目标颜色和反射率如何，都可以进行距离测量，抗干扰能力更强。芯片如下图所示：
VL53L0X是完全集成的传感器，配有嵌入式红外、人眼安全激光，先进的滤波器和超高速光子探测阵列。VL53L0X增强了ST FlightSense™系列，测量距离更长，速度和精度更高，从而开启了新应用之门。即使在恶劣工作条件下，该传感器也可以直接确定与目标物体之间的距离，最远2米，并且不受目标反射率影响。
VL53L0X芯片的主要特征：
完全集成的微型模块 n 940nm激光VCSEL
n VCSEL驱动器
n 测距传感器，配有高级的嵌入式微控制器
n 4.4mmx2.4mmx1.0mm
n 快速、准确的距离测量
n 测量绝对距离达2m
n 报告的距离不受目标反射率影响
n 在高红外光环境下运行
n 先进的嵌入式光学串扰补偿，以简化玻璃罩的设计
人眼安全 n 1类激光设备，符合最新标准IEC 60825-1:2014（第3版）
易于集成 n 可回流焊元件
n 无需额外光学器件
n 单电源
n I2C接口，用于器件控制和数据传输
n Xshutdown（复位）和中断GPIO
VL53L0X的参数：
工作电压：3.3V/5V
产品尺寸：4.4mm × 2.4mm × 1.0mm
测距范围：30 ~ 2000mm
测距精度：±5% (高速模式)，±3% (高精度模式)
测距时间(min)：20ms (高速模式)，200ms(高精度模式)
测距角度：25°
激光波长：940nm
工作温度：-20 ~ 70°C
VL53L0X传感器提供了3种测量模式：单次测量模式、连续测量模式和定时测量模式。
（1）单次测量模式：在这种测量模式下，一次触发只执行一次距离测量，测量结束后，VL53L0X传感器会返回待机状态，等待下一次触发。
（2）连续测量模式：在该模式下会以连续的方式执行距离测量。一次测量结束，下一次测量就会立即启动，用户必须停止测距才能返回到待机状态，最后的一次测量在停止前完成。
（3）定时测量模式：这种模式实际上就是指定时间间隔的连续测量模式。当一次测量结束后，经过用户定义的延迟时间之后，才会启动下一次测量。用户必须停止测距才能返回到待机状态，最后的一次测量在停机前完成。
VL53L0X传感器还提供了4种不同的精度模式：
精度模式
测量时间预算范围(ms)
测距距离(m)">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-17T08:30:00+08:00">
    <meta property="article:modified_time" content="2024-01-17T08:30:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">一起玩儿物联网人工智能小车（ESP32）——38. 激光测距模块VL53L0X的使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:.0001pt;text-align:justify;">摘要：本文介绍ESP32如何使用激光测距模块VL53L0X进行距离测量</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">在前面的自动避障小车中，主要使用超声波传感器来进行障碍物距离的测量，接下来将介绍另一种经常用到的测距传感器——激光测距传感器。其测量原理是传感器发出激光，然后再通过接收到的返回的激光来测量距离的方法。激光测距的方法有两种，一种是脉冲法，一种是相位法。脉冲法的原理与超声波传感器类似，是利用激光发射出去到返回之间的时间来计算激光器到物体之间的距离。而相位法则利用发出去的激光返回后的相位与仪器内直接返回激光的相位差来计算激光器到物体之间的距离。</p> 
<p style="margin-left:.0001pt;text-align:justify;">这次使用的为新一代飞行时间（ToF）激光测距模块，这款飞行测距模块是基于基于VL53L0X设计的。样子如下图所示：</p> 
<p style="margin-left:.0001pt;text-align:center;"><img alt="" src="https://images2.imgbox.com/09/13/vfdEVxqP_o.png"></p> 
<p style="margin-left:.0001pt;text-align:justify;">VL53L0X是ST推出的第二代FlightSense技术的飞行时间传感器，与传统的测距传感器不同，VL53L0X采用ST的ToF技术，是目前最小的激光测距芯片，无论目标颜色和反射率如何，都可以进行距离测量，抗干扰能力更强。芯片如下图所示：</p> 
<p style="margin-left:.0001pt;text-align:center;"><img alt="" src="https://images2.imgbox.com/e6/58/cKoVaDI0_o.png"></p> 
<p style="margin-left:.0001pt;text-align:justify;">VL53L0X是完全集成的传感器，配有嵌入式红外、人眼安全激光，先进的滤波器和超高速光子探测阵列。VL53L0X增强了ST FlightSense™系列，测量距离更长，速度和精度更高，从而开启了新应用之门。即使在恶劣工作条件下，该传感器也可以直接确定与目标物体之间的距离，最远2米，并且不受目标反射率影响。</p> 
<p style="margin-left:.0001pt;text-align:justify;">VL53L0X芯片的主要特征：</p> 
<ol><li style="text-align:justify;">完全集成的微型模块</li></ol> 
<p style="margin-left:.0001pt;text-align:justify;">n 940nm激光VCSEL</p> 
<p style="margin-left:.0001pt;text-align:justify;">n VCSEL驱动器</p> 
<p style="margin-left:.0001pt;text-align:justify;">n 测距传感器，配有高级的嵌入式微控制器</p> 
<p style="margin-left:.0001pt;text-align:justify;">n 4.4mmx2.4mmx1.0mm</p> 
<p style="margin-left:.0001pt;text-align:justify;">n 快速、准确的距离测量</p> 
<p style="margin-left:.0001pt;text-align:justify;">n 测量绝对距离达2m</p> 
<p style="margin-left:.0001pt;text-align:justify;">n 报告的距离不受目标反射率影响</p> 
<p style="margin-left:.0001pt;text-align:justify;">n 在高红外光环境下运行</p> 
<p style="margin-left:.0001pt;text-align:justify;">n 先进的嵌入式光学串扰补偿，以简化玻璃罩的设计</p> 
<ol><li style="text-align:justify;">人眼安全</li></ol> 
<p style="margin-left:.0001pt;text-align:justify;">n 1类激光设备，符合最新标准IEC 60825-1:2014（第3版）</p> 
<ol><li style="text-align:justify;">易于集成</li></ol> 
<p style="margin-left:.0001pt;text-align:justify;">n 可回流焊元件</p> 
<p style="margin-left:.0001pt;text-align:justify;">n 无需额外光学器件</p> 
<p style="margin-left:.0001pt;text-align:justify;">n 单电源</p> 
<p style="margin-left:.0001pt;text-align:justify;">n I2C接口，用于器件控制和数据传输</p> 
<p style="margin-left:.0001pt;text-align:justify;">n Xshutdown（复位）和中断GPIO</p> 
<p style="margin-left:.0001pt;text-align:justify;">VL53L0X的参数：</p> 
<p style="margin-left:.0001pt;text-align:justify;">工作电压：3.3V/5V</p> 
<p style="margin-left:.0001pt;text-align:justify;">产品尺寸：4.4mm × 2.4mm × 1.0mm</p> 
<p style="margin-left:.0001pt;text-align:justify;">测距范围：30 ~ 2000mm</p> 
<p style="margin-left:.0001pt;text-align:justify;">测距精度：±5% (高速模式)，±3% (高精度模式)</p> 
<p style="margin-left:.0001pt;text-align:justify;">测距时间(min)：20ms (高速模式)，200ms(高精度模式)</p> 
<p style="margin-left:.0001pt;text-align:justify;">测距角度：25°</p> 
<p style="margin-left:.0001pt;text-align:justify;">激光波长：940nm</p> 
<p style="margin-left:.0001pt;text-align:justify;">工作温度：-20 ~ 70°C</p> 
<p style="margin-left:.0001pt;text-align:justify;">VL53L0X传感器提供了3种测量模式：单次测量模式、连续测量模式和定时测量模式。</p> 
<p style="margin-left:.0001pt;text-align:justify;">（1）单次测量模式：在这种测量模式下，一次触发只执行一次距离测量，测量结束后，VL53L0X传感器会返回待机状态，等待下一次触发。</p> 
<p style="margin-left:.0001pt;text-align:justify;">（2）连续测量模式：在该模式下会以连续的方式执行距离测量。一次测量结束，下一次测量就会立即启动，用户必须停止测距才能返回到待机状态，最后的一次测量在停止前完成。</p> 
<p style="margin-left:.0001pt;text-align:justify;">（3）定时测量模式：这种模式实际上就是指定时间间隔的连续测量模式。当一次测量结束后，经过用户定义的延迟时间之后，才会启动下一次测量。用户必须停止测距才能返回到待机状态，最后的一次测量在停机前完成。</p> 
<p style="margin-left:.0001pt;text-align:justify;">VL53L0X传感器还提供了4种不同的精度模式：</p> 
<table border="1" cellspacing="0" style="margin-left:4.8pt;width:448.8pt;"><tbody><tr><td style="background-color:#ffffff;width:62.35pt;"> <p style="margin-left:.0001pt;text-align:justify;">精度模式</p> </td><td style="background-color:#ffffff;width:117.3pt;"> <p style="margin-left:.0001pt;text-align:justify;">测量时间预算范围(ms)</p> </td><td style="background-color:#ffffff;width:84.5pt;"> <p style="margin-left:.0001pt;text-align:justify;">测距距离(m)</p> </td><td style="background-color:#ffffff;width:184.65pt;"> <p style="margin-left:.0001pt;text-align:justify;">典型应用场景</p> </td></tr><tr><td style="width:62.35pt;"> <p style="margin-left:.0001pt;text-align:justify;">默认</p> </td><td style="width:117.3pt;"> <p style="margin-left:.0001pt;text-align:justify;">30</p> </td><td style="width:84.5pt;"> <p style="margin-left:.0001pt;text-align:justify;">1.2</p> </td><td style="width:184.65pt;"> <p style="margin-left:.0001pt;text-align:justify;">标准</p> </td></tr><tr><td style="vertical-align:top;width:62.35pt;"> <p style="margin-left:.0001pt;text-align:justify;">高精度</p> </td><td style="width:117.3pt;"> <p style="margin-left:.0001pt;text-align:justify;">200</p> </td><td style="vertical-align:top;width:84.5pt;"> <p style="margin-left:.0001pt;text-align:justify;">1.2（精度&lt;±3%）</p> </td><td style="vertical-align:top;width:184.65pt;"> <p style="margin-left:.0001pt;text-align:justify;">精确测量</p> </td></tr><tr><td style="vertical-align:top;width:62.35pt;"> <p style="margin-left:.0001pt;text-align:justify;">长距离</p> </td><td style="vertical-align:top;width:117.3pt;"> <p style="margin-left:.0001pt;text-align:justify;">33</p> </td><td style="vertical-align:top;width:84.5pt;"> <p style="margin-left:.0001pt;text-align:justify;">2</p> </td><td style="vertical-align:top;width:184.65pt;"> <p style="margin-left:.0001pt;text-align:justify;">长距离，只适用于黑暗无红外线条件</p> </td></tr><tr><td style="width:62.35pt;"> <p style="margin-left:.0001pt;text-align:justify;">高速</p> </td><td style="vertical-align:bottom;width:117.3pt;"> <p style="margin-left:.0001pt;text-align:justify;">20</p> </td><td style="width:84.5pt;"> <p style="margin-left:.0001pt;text-align:justify;">1.2（精度&lt;±5%）</p> </td><td style="width:184.65pt;"> <p style="margin-left:.0001pt;text-align:justify;">高速，精度不优先</p> </td></tr></tbody></table> 
<p style="margin-left:.0001pt;text-align:justify;">在实际的应用中，需根据当前的要求去选择合适的精度模式，以达到最佳的测量效果。</p> 
<p style="margin-left:.0001pt;text-align:justify;">VL53L0X的激光测距模块的接口如下：</p> 
<table border="1" cellspacing="0"><tbody><tr><td style="vertical-align:top;width:101.5pt;"> <p style="margin-left:.0001pt;text-align:justify;">VCC</p> </td><td style="vertical-align:top;width:324.6pt;"> <p style="margin-left:.0001pt;text-align:justify;">电源正（3.3V/5V电源输入）</p> </td></tr><tr><td style="vertical-align:top;width:101.5pt;"> <p style="margin-left:.0001pt;text-align:justify;">GND</p> </td><td style="vertical-align:top;width:324.6pt;"> <p style="margin-left:.0001pt;text-align:justify;">电源地</p> </td></tr><tr><td style="vertical-align:top;width:101.5pt;"> <p style="margin-left:.0001pt;text-align:justify;">SDA</p> </td><td style="vertical-align:top;width:324.6pt;"> <p style="margin-left:.0001pt;text-align:justify;">I2C的数据引脚</p> </td></tr><tr><td style="vertical-align:top;width:101.5pt;"> <p style="margin-left:.0001pt;text-align:justify;">SCL</p> </td><td style="vertical-align:top;width:324.6pt;"> <p style="margin-left:.0001pt;text-align:justify;">I2C的时钟引脚</p> </td></tr><tr><td style="vertical-align:top;width:101.5pt;"> <p style="margin-left:.0001pt;text-align:justify;">SHUT</p> </td><td style="vertical-align:top;width:324.6pt;"> <p style="margin-left:.0001pt;text-align:justify;">引脚，可接IO口</p> </td></tr><tr><td style="vertical-align:top;width:101.5pt;"> <p style="margin-left:.0001pt;text-align:justify;">INT</p> </td><td style="vertical-align:top;width:324.6pt;"> <p style="margin-left:.0001pt;text-align:justify;">中断输出引脚，可接IO口</p> </td></tr></tbody></table> 
<p style="margin-left:.0001pt;text-align:justify;">下面就来将激光测距模块与ESP32开发板连接到一起。在这里，IIC通信使用的是ESP32的默认引脚21和22。具体连接如下表所示：</p> 
<table border="1" cellspacing="0"><tbody><tr><td style="vertical-align:top;width:213.05pt;"> <p style="margin-left:.0001pt;text-align:justify;">激光测距模块</p> </td><td style="vertical-align:top;width:213.05pt;"> <p style="margin-left:.0001pt;text-align:justify;">ESP32模块</p> </td></tr><tr><td style="vertical-align:top;width:213.05pt;"> <p style="margin-left:.0001pt;text-align:justify;">VCC</p> </td><td style="vertical-align:top;width:213.05pt;"> <p style="margin-left:.0001pt;text-align:justify;">+5V</p> </td></tr><tr><td style="vertical-align:top;width:213.05pt;"> <p style="margin-left:.0001pt;text-align:justify;">GND</p> </td><td style="vertical-align:top;width:213.05pt;"> <p style="margin-left:.0001pt;text-align:justify;">GND</p> </td></tr><tr><td style="vertical-align:top;width:213.05pt;"> <p style="margin-left:.0001pt;text-align:justify;">SDA</p> </td><td style="vertical-align:top;width:213.05pt;"> <p style="margin-left:.0001pt;text-align:justify;">P21</p> </td></tr><tr><td style="vertical-align:top;width:213.05pt;"> <p style="margin-left:.0001pt;text-align:justify;">SCL</p> </td><td style="vertical-align:top;width:213.05pt;"> <p style="margin-left:.0001pt;text-align:justify;">P22</p> </td></tr></tbody></table> 
<p style="margin-left:.0001pt;text-align:justify;">接下来就是打开开发软件Arduino IDE，首先需要安装VL53L0X的库，利用库可以免去我们很多底层的开发工作，需不要关注IIC通信的细节，也不需要仔细的去了解VL53L0X内部寄存器的结构，使用库文件所提供的函数，直接就可以完成模块的使用了。</p> 
<p style="margin-left:.0001pt;text-align:justify;">打开Arduino IDE的库管理面板，在搜索框中输入“VL53L0X”然后选择安装“Adafruit_VL53L0X”库，如下图所示：</p> 
<p style="margin-left:.0001pt;text-align:center;"><img alt="" src="https://images2.imgbox.com/ad/5a/WH43gW9Q_o.png"></p> 
<p style="margin-left:.0001pt;text-align:justify;">接下来就来看一个简单的单次测量模式的模板程序。如下所示：</p> 
<table border="1" cellspacing="0"><tbody><tr><td style="vertical-align:top;width:426.1pt;"> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="background-color:#ffffff;"><span style="color:#728e00;">#include</span></span> <span style="background-color:#ffffff;"><span style="color:#005c5f;">"Adafruit_VL53L0X.h"</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="color:#4e5b61;">//创建Adafruit_VL53L0X对象的实例</span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="background-color:#ffffff;"><span style="color:#4e5b61;">Adafruit_VL53L0X lox = </span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">Adafruit_VL53L0X</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">()</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">;</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="background-color:#ffffff;"><span style="color:#00979d;">void</span></span> <span style="background-color:#ffffff;"><span style="color:#d35400;">setup</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">()</span></span> <span style="background-color:#ffffff;"><span style="color:#434f54;">{<!-- --></span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="background-color:#ffffff;"><span style="color:#95a5a6;">  // put your setup code here, to run once:</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">  <span style="background-color:#ffffff;"><span style="color:#d35400;">Serial</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">.</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">begin</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">(</span></span><span style="background-color:#ffffff;"><span style="color:#005c5f;">115200</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">)</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">;</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">  <span style="background-color:#ffffff;"><span style="color:#4e5b61;">// 初始化激光测距模块</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">  <span style="background-color:#ffffff;"><span style="color:#728e00;">if</span></span> <span style="background-color:#ffffff;"><span style="color:#434f54;">(</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">!</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">lox</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">.</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">begin</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">())</span></span> <span style="background-color:#ffffff;"><span style="color:#434f54;">{<!-- --></span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">    <span style="background-color:#ffffff;"><span style="color:#d35400;">Serial</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">.</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">println</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">(</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">F</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">(</span></span><span style="background-color:#ffffff;"><span style="color:#005c5f;">"Failed to boot VL53L0X"</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">))</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">;</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">    <span style="background-color:#ffffff;"><span style="color:#728e00;">while</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">(</span></span><span style="background-color:#ffffff;"><span style="color:#005c5f;">1</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">)</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">;</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">  <span style="background-color:#ffffff;"><span style="color:#434f54;">}</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="background-color:#ffffff;"><span style="color:#434f54;">}</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="background-color:#ffffff;"><span style="color:#00979d;">void</span></span> <span style="background-color:#ffffff;"><span style="color:#d35400;">loop</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">()</span></span> <span style="background-color:#ffffff;"><span style="color:#434f54;">{<!-- --></span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="background-color:#ffffff;"><span style="color:#95a5a6;">  // put your main code here, to run repeatedly:</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="background-color:#ffffff;"><span style="color:#95a5a6;">// 创建测量对象实例</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">  <span style="background-color:#ffffff;"><span style="color:#00979d;">VL53L0X_RangingMeasurementData_t</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;"> measure;</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">    </span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="background-color:#ffffff;"><span style="color:#4e5b61;">  // 触发单次测量</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">  <span style="background-color:#ffffff;"><span style="color:#d35400;">lox</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">.</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">rangingTest</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">(</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">&amp;measure, </span></span><span style="background-color:#ffffff;"><span style="color:#005c5f;">false</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">)</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">;</span></span><span style="background-color:#ffffff;"><span style="color:#95a5a6;"> // pass in 'true' to get debug data printout!</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">  <span style="background-color:#ffffff;"><span style="color:#728e00;">if</span></span> <span style="background-color:#ffffff;"><span style="color:#434f54;">(</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">measure</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">.</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">RangeStatus</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;"> != </span></span><span style="background-color:#ffffff;"><span style="color:#005c5f;">4</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">)</span></span> <span style="background-color:#ffffff;"><span style="color:#434f54;">{<!-- --></span></span><span style="background-color:#ffffff;"><span style="color:#95a5a6;">  // </span></span><span style="background-color:#ffffff;"><span style="color:#95a5a6;">判断测量结果的状态</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="background-color:#ffffff;"><span style="color:#95a5a6;">    //输出测量结果</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="background-color:#ffffff;"><span style="color:#d35400;">Serial</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">.</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">print</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">(</span></span><span style="background-color:#ffffff;"><span style="color:#005c5f;">"Distance (mm): "</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">)</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">;</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="background-color:#ffffff;"><span style="color:#d35400;">Serial</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">.</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">println</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">(</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">measure</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">.</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">RangeMilliMeter</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">)</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">;</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">  <span style="background-color:#ffffff;"><span style="color:#434f54;">}</span></span> <span style="background-color:#ffffff;"><span style="color:#728e00;">else</span></span> <span style="background-color:#ffffff;"><span style="color:#434f54;">{<!-- --></span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="background-color:#ffffff;"><span style="color:#434f54;">    //超出测量范围</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">    <span style="background-color:#ffffff;"><span style="color:#d35400;">Serial</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">.</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">println</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">(</span></span><span style="background-color:#ffffff;"><span style="color:#005c5f;">" out of range "</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">)</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">;</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">  <span style="background-color:#ffffff;"><span style="color:#434f54;">}</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">    </span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">  <span style="background-color:#ffffff;"><span style="color:#d35400;">delay</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">(</span></span><span style="background-color:#ffffff;"><span style="color:#005c5f;">100</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">)</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">;</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="background-color:#ffffff;"><span style="color:#434f54;">}</span></span></span></p> </td></tr></tbody></table> 
<p style="margin-left:.0001pt;text-align:justify;">在上面的代码中可以看到，完成激光测距模块的单次测量需要经过以下这些步骤：</p> 
<p style="margin-left:.0001pt;text-align:justify;">（1）创建Adafruit_VL53L0X对象的实例</p> 
<p style="margin-left:.0001pt;text-align:justify;">Adafruit_VL53L0X lox = Adafruit_VL53L0X();</p> 
<ol><li style="text-align:justify;">调用begin()方法完成激光测距模块的初始化</li></ol> 
<p style="margin-left:.0001pt;text-align:justify;">（3）创建保存测量结果的VL53L0X_RangingMeasurementData_t结构的实例</p> 
<p style="margin-left:.0001pt;text-align:justify;">（4）调用rangingTest()方法完成一次测量</p> 
<p style="margin-left:.0001pt;text-align:justify;">（5）测量结果对象的RangeStatus属性表示测量结果的状态，RangeMilliMeter属性的值为测量的距离（单位是毫米）。</p> 
<p style="margin-left:.0001pt;text-align:justify;">对于连续测量，与上面单次测量的区别是在调用begin()完成模块初始化之后，还要调用startRangeContinuous()方法，将激光测距模块切换到连续测量模式。在读取数据上的区别是要使用isRangeComplete()方法判断激光测距模块是否完成了一次测量，然后再通过readRange()方法来读取测量的结果。程序模板如下所示：</p> 
<table border="1" cellspacing="0"><tbody><tr><td style="vertical-align:top;width:426.1pt;"> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="background-color:#ffffff;"><span style="color:#728e00;">#include</span></span> <span style="background-color:#ffffff;"><span style="color:#005c5f;">"Adafruit_VL53L0X.h"</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="background-color:#ffffff;"><span style="color:#4e5b61;">Adafruit_VL53L0X lox = </span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">Adafruit_VL53L0X</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">()</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">;</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="background-color:#ffffff;"><span style="color:#00979d;">void</span></span> <span style="background-color:#ffffff;"><span style="color:#d35400;">setup</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">()</span></span> <span style="background-color:#ffffff;"><span style="color:#434f54;">{<!-- --></span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">  <span style="background-color:#ffffff;"><span style="color:#d35400;">Serial</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">.</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">begin</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">(</span></span><span style="background-color:#ffffff;"><span style="color:#005c5f;">115200</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">)</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">;</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">  <span style="background-color:#ffffff;"><span style="color:#728e00;">if</span></span> <span style="background-color:#ffffff;"><span style="color:#434f54;">(</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">!</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">lox</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">.</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">begin</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">())</span></span> <span style="background-color:#ffffff;"><span style="color:#434f54;">{<!-- --></span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">    <span style="background-color:#ffffff;"><span style="color:#d35400;">Serial</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">.</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">println</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">(</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">F</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">(</span></span><span style="background-color:#ffffff;"><span style="color:#005c5f;">"Failed to boot VL53L0X"</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">))</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">;</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">    <span style="background-color:#ffffff;"><span style="color:#728e00;">while</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">(</span></span><span style="background-color:#ffffff;"><span style="color:#005c5f;">1</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">)</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">;</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">  <span style="background-color:#ffffff;"><span style="color:#434f54;">}</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="background-color:#ffffff;"><span style="color:#95a5a6;">  // start continuous ranging</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">  <span style="background-color:#ffffff;"><span style="color:#d35400;">lox</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">.</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">startRangeContinuous</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">()</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">;</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="background-color:#ffffff;"><span style="color:#434f54;">}</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="background-color:#ffffff;"><span style="color:#00979d;">void</span></span> <span style="background-color:#ffffff;"><span style="color:#d35400;">loop</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">()</span></span> <span style="background-color:#ffffff;"><span style="color:#434f54;">{<!-- --></span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">  <span style="background-color:#ffffff;"><span style="color:#728e00;">if</span></span> <span style="background-color:#ffffff;"><span style="color:#434f54;">(</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">lox</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">.</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">isRangeComplete</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">())</span></span> <span style="background-color:#ffffff;"><span style="color:#434f54;">{<!-- --></span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">    <span style="background-color:#ffffff;"><span style="color:#d35400;">Serial</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">.</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">print</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">(</span></span><span style="background-color:#ffffff;"><span style="color:#005c5f;">"Distance in mm: "</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">)</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">;</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">    <span style="background-color:#ffffff;"><span style="color:#d35400;">Serial</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">.</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">println</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">(</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">lox</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">.</span></span><span style="background-color:#ffffff;"><span style="color:#d35400;">readRange</span></span><span style="background-color:#ffffff;"><span style="color:#434f54;">())</span></span><span style="background-color:#ffffff;"><span style="color:#4e5b61;">;</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;">  <span style="background-color:#ffffff;"><span style="color:#434f54;">}</span></span></span></p> <p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="background-color:#ffffff;"><span style="color:#434f54;">}</span></span></span></p> </td></tr></tbody></table> 
<p style="margin-left:.0001pt;text-align:justify;">好了，激光测距模块就基本介绍到这里了。有兴趣的可以将这个模块装到小车上，替换掉超声波测距模块，然后测试一下用激光测距模块实现的避障小车的效果咋样了。</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5e9a4ea6a79bacb2533cba8c65e7a695/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">详解--Hash（中文也称散列、哈希）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2a6ebb80ed762c35ed2a68422e88a4ec/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Python连接打印机：实现自动化打印的利器</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>