<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用Django Rest Framework构建API - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/faecb9060729d1cf8167d1cb44244af1/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="使用Django Rest Framework构建API">
  <meta property="og:description" content="Django Rest Framework (DRF) 是一个强大且灵活的工具集，用以构建Web API。它基于Django，一个非常流行的Python Web框架。在本文中，我们将深入探讨如何使用DRF来构建一个高效、结构化的API。
目录
使用Django Rest Framework构建API
一、环境设置和项目创建
1. Python和Django的安装
2. Django和DRF的安装
3. 创建新的Django项目
4. 添加应用
5. 虚拟环境与依赖管理
二、序列化数据
1. 理解序列化和反序列化
2. 创建序列化器
3. 序列化器的高级用法
三、视图和路由
1. 创建API视图
2. 配置路由
3. 高级路由配置
四、安全性和权限
1. 全局设置认证和权限
2. 细节级别安全设置
五、测试和文档
1. 单元测试
2. 集成测试和验收测试
3. 文档生成
六、总结
使用Django Rest Framework构建API 一、环境设置和项目创建 在开始之前，确保您已经安装了Python和Django的环境。Python和Django是开发任何Django项目的基石，因此，确认安装是初步且关键的步骤。安装Python通常是直接的，但确保您正在使用支持的版本（至少是Python 3.6及以上版本）。
1. Python和Django的安装 下载并安装Python： 访问Python官方网站，下载适合您操作系统的Python版本，并执行安装程序。（Welcome to Python.org）设置Python环境变量： 确保Python可执行文件的路径被添加到系统的环境变量中，这使得您可以在命令行中全局访问Python命令。验证Python安装： 在命令行中输入python或python3，您应该看到Python的交互式 shell。 2. Django和DRF的安装 安装Django： Django可以通过Python的包管理工具pip进行安装。在命令行中运行pip install django应该足够安装Django框架。 pip install djangorestframework 检查Django安装： 通过创建一个新的Django项目来测试安装是否成功。在命令行中输入django-admin startproject testproject，然后进入该项目目录，运行python manage.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-23T12:51:38+08:00">
    <meta property="article:modified_time" content="2024-07-23T12:51:38+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用Django Rest Framework构建API</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <blockquote> 
 <p>        Django Rest Framework (DRF) 是一个强大且灵活的工具集，用以构建Web API。它基于Django，一个非常流行的Python Web框架。在本文中，我们将深入探讨如何使用DRF来构建一个高效、结构化的API。</p> 
</blockquote> 
<hr> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%BD%BF%E7%94%A8Django%20Rest%20Framework%E6%9E%84%E5%BB%BAAPI-toc" style="margin-left:0px;"><a href="#%E4%BD%BF%E7%94%A8Django%20Rest%20Framework%E6%9E%84%E5%BB%BAAPI" rel="nofollow">使用Django Rest Framework构建API</a></p> 
<p id="%E4%B8%80%E3%80%81%E7%8E%AF%E5%A2%83%E8%AE%BE%E7%BD%AE%E5%92%8C%E9%A1%B9%E7%9B%AE%E5%88%9B%E5%BB%BA-toc" style="margin-left:40px;"><a href="#%E4%B8%80%E3%80%81%E7%8E%AF%E5%A2%83%E8%AE%BE%E7%BD%AE%E5%92%8C%E9%A1%B9%E7%9B%AE%E5%88%9B%E5%BB%BA" rel="nofollow">一、环境设置和项目创建</a></p> 
<p id="1.%20Python%E5%92%8CDjango%E7%9A%84%E5%AE%89%E8%A3%85-toc" style="margin-left:80px;"><a href="#1.%20Python%E5%92%8CDjango%E7%9A%84%E5%AE%89%E8%A3%85" rel="nofollow">1. Python和Django的安装</a></p> 
<p id="2.%20Django%E5%92%8CDRF%E7%9A%84%E5%AE%89%E8%A3%85-toc" style="margin-left:80px;"><a href="#2.%20Django%E5%92%8CDRF%E7%9A%84%E5%AE%89%E8%A3%85" rel="nofollow">2. Django和DRF的安装</a></p> 
<p id="3.%20%E5%88%9B%E5%BB%BA%E6%96%B0%E7%9A%84Django%E9%A1%B9%E7%9B%AE-toc" style="margin-left:80px;"><a href="#3.%20%E5%88%9B%E5%BB%BA%E6%96%B0%E7%9A%84Django%E9%A1%B9%E7%9B%AE" rel="nofollow">3. 创建新的Django项目</a></p> 
<p id="4.%20%E6%B7%BB%E5%8A%A0%E5%BA%94%E7%94%A8-toc" style="margin-left:80px;"><a href="#4.%20%E6%B7%BB%E5%8A%A0%E5%BA%94%E7%94%A8" rel="nofollow">4. 添加应用</a></p> 
<p id="5.%20%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83%E4%B8%8E%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86-toc" style="margin-left:80px;"><a href="#5.%20%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83%E4%B8%8E%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86" rel="nofollow">5. 虚拟环境与依赖管理</a></p> 
<p id="%E4%BA%8C%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96%E6%95%B0%E6%8D%AE-toc" style="margin-left:40px;"><a href="#%E4%BA%8C%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96%E6%95%B0%E6%8D%AE" rel="nofollow">二、序列化数据</a></p> 
<p id="1.%20%E7%90%86%E8%A7%A3%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-toc" style="margin-left:80px;"><a href="#1.%20%E7%90%86%E8%A7%A3%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96" rel="nofollow">1. 理解序列化和反序列化</a></p> 
<p id="2.%20%E5%88%9B%E5%BB%BA%E5%BA%8F%E5%88%97%E5%8C%96%E5%99%A8-toc" style="margin-left:80px;"><a href="#2.%20%E5%88%9B%E5%BB%BA%E5%BA%8F%E5%88%97%E5%8C%96%E5%99%A8" rel="nofollow">2. 创建序列化器</a></p> 
<p id="3.%20%E5%BA%8F%E5%88%97%E5%8C%96%E5%99%A8%E7%9A%84%E9%AB%98%E7%BA%A7%E7%94%A8%E6%B3%95-toc" style="margin-left:80px;"><a href="#3.%20%E5%BA%8F%E5%88%97%E5%8C%96%E5%99%A8%E7%9A%84%E9%AB%98%E7%BA%A7%E7%94%A8%E6%B3%95" rel="nofollow">3. 序列化器的高级用法</a></p> 
<p id="%E4%B8%89%E3%80%81%E8%A7%86%E5%9B%BE%E5%92%8C%E8%B7%AF%E7%94%B1-toc" style="margin-left:40px;"><a href="#%E4%B8%89%E3%80%81%E8%A7%86%E5%9B%BE%E5%92%8C%E8%B7%AF%E7%94%B1" rel="nofollow">三、视图和路由</a></p> 
<p id="1.%20%E5%88%9B%E5%BB%BAAPI%E8%A7%86%E5%9B%BE-toc" style="margin-left:80px;"><a href="#1.%20%E5%88%9B%E5%BB%BAAPI%E8%A7%86%E5%9B%BE" rel="nofollow">1. 创建API视图</a></p> 
<p id="2.%20%E9%85%8D%E7%BD%AE%E8%B7%AF%E7%94%B1-toc" style="margin-left:80px;"><a href="#2.%20%E9%85%8D%E7%BD%AE%E8%B7%AF%E7%94%B1" rel="nofollow">2. 配置路由</a></p> 
<p id="3.%20%E9%AB%98%E7%BA%A7%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE-toc" style="margin-left:80px;"><a href="#3.%20%E9%AB%98%E7%BA%A7%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE" rel="nofollow">3. 高级路由配置</a></p> 
<p id="%E5%9B%9B%E3%80%81%E5%AE%89%E5%85%A8%E6%80%A7%E5%92%8C%E6%9D%83%E9%99%90-toc" style="margin-left:40px;"><a href="#%E5%9B%9B%E3%80%81%E5%AE%89%E5%85%A8%E6%80%A7%E5%92%8C%E6%9D%83%E9%99%90" rel="nofollow">四、安全性和权限</a></p> 
<p id="1.%20%E5%85%A8%E5%B1%80%E8%AE%BE%E7%BD%AE%E8%AE%A4%E8%AF%81%E5%92%8C%E6%9D%83%E9%99%90-toc" style="margin-left:80px;"><a href="#1.%20%E5%85%A8%E5%B1%80%E8%AE%BE%E7%BD%AE%E8%AE%A4%E8%AF%81%E5%92%8C%E6%9D%83%E9%99%90" rel="nofollow">1. 全局设置认证和权限</a></p> 
<p id="2.%20%E7%BB%86%E8%8A%82%E7%BA%A7%E5%88%AB%E5%AE%89%E5%85%A8%E8%AE%BE%E7%BD%AE-toc" style="margin-left:80px;"><a href="#2.%20%E7%BB%86%E8%8A%82%E7%BA%A7%E5%88%AB%E5%AE%89%E5%85%A8%E8%AE%BE%E7%BD%AE" rel="nofollow">2. 细节级别安全设置</a></p> 
<p id="%E4%BA%94%E3%80%81%E6%B5%8B%E8%AF%95%E5%92%8C%E6%96%87%E6%A1%A3-toc" style="margin-left:40px;"><a href="#%E4%BA%94%E3%80%81%E6%B5%8B%E8%AF%95%E5%92%8C%E6%96%87%E6%A1%A3" rel="nofollow">五、测试和文档</a></p> 
<p id="1.%20%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95-toc" style="margin-left:80px;"><a href="#1.%20%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95" rel="nofollow">1. 单元测试</a></p> 
<p id="2.%20%E9%9B%86%E6%88%90%E6%B5%8B%E8%AF%95%E5%92%8C%E9%AA%8C%E6%94%B6%E6%B5%8B%E8%AF%95-toc" style="margin-left:80px;"><a href="#2.%20%E9%9B%86%E6%88%90%E6%B5%8B%E8%AF%95%E5%92%8C%E9%AA%8C%E6%94%B6%E6%B5%8B%E8%AF%95" rel="nofollow">2. 集成测试和验收测试</a></p> 
<p id="3.%20%E6%96%87%E6%A1%A3%E7%94%9F%E6%88%90-toc" style="margin-left:80px;"><a href="#3.%20%E6%96%87%E6%A1%A3%E7%94%9F%E6%88%90" rel="nofollow">3. 文档生成</a></p> 
<p id="%E5%85%AD%E3%80%81%E6%80%BB%E7%BB%93-toc" style="margin-left:40px;"><a href="#%E5%85%AD%E3%80%81%E6%80%BB%E7%BB%93" rel="nofollow">六、总结</a></p> 
<hr> 
<h2 id="%E4%BD%BF%E7%94%A8Django%20Rest%20Framework%E6%9E%84%E5%BB%BAAPI" style="text-align:center;">使用Django Rest Framework构建API</h2> 
<p> <img alt="" height="634" src="https://images2.imgbox.com/6a/e9/nnT9jx4u_o.png" width="1094"></p> 
<h3 id="%E4%B8%80%E3%80%81%E7%8E%AF%E5%A2%83%E8%AE%BE%E7%BD%AE%E5%92%8C%E9%A1%B9%E7%9B%AE%E5%88%9B%E5%BB%BA">一、环境设置和项目创建</h3> 
<p>        在开始之前，确保您已经安装了Python和Django的环境。Python和Django是开发任何Django项目的基石，因此，确认安装是初步且关键的步骤。安装Python通常是直接的，但确保您正在使用支持的版本（至少是Python 3.6及以上版本）。</p> 
<h4 id="1.%20Python%E5%92%8CDjango%E7%9A%84%E5%AE%89%E8%A3%85">1. Python和Django的安装</h4> 
<ul><li><strong>下载并安装Python：</strong> 访问Python官方网站，下载适合您操作系统的Python版本，并执行安装程序。（<a href="https://www.python.org/" rel="nofollow" title="Welcome to Python.org">Welcome to Python.org</a>）</li><li><strong>设置Python环境变量：</strong> 确保Python可执行文件的路径被添加到系统的环境变量中，这使得您可以在命令行中全局访问Python命令。</li><li><strong>验证Python安装：</strong> 在命令行中输入<code>python</code>或<code>python3</code>，您应该看到Python的交互式 shell。</li></ul> 
<h4 id="2.%20Django%E5%92%8CDRF%E7%9A%84%E5%AE%89%E8%A3%85">2. Django和DRF的安装</h4> 
<ul><li><strong>安装Django：</strong> Django可以通过Python的包管理工具pip进行安装。在命令行中运行<code>pip install django</code>应该足够安装Django框架。</li><li> <pre><code class="language-bash">pip install djangorestframework
</code></pre> </li><li><strong>检查Django安装：</strong> 通过创建一个新的Django项目来测试安装是否成功。在命令行中输入<code>django-admin startproject testproject</code>，然后进入该项目目录，运行<code>python manage.py runserver</code>。如果在浏览器中访问<code><a class="link-info" href="http://localhost:8000" rel="nofollow" title="http://localhost:8000">http://localhost:8000</a></code>能看到默认的Django欢迎页面，则表明Django已正确安装。</li><li><strong>安装Django Rest Framework：</strong> 同样使用pip工具，执行<code>pip install djangorestframework</code>。这将安装所有必要的包以运行DRF。</li><li><strong>简单验证DRF安装：</strong> 为了验证DRF也已正确安装，可以尝试在项目中创建一个简单的路由来查看是否能够正常运行。</li><li><img alt="" height="1158" src="https://images2.imgbox.com/28/44/kkqcdXX4_o.png" width="1200"></li></ul> 
<h4 id="3.%20%E5%88%9B%E5%BB%BA%E6%96%B0%E7%9A%84Django%E9%A1%B9%E7%9B%AE">3. 创建新的Django项目</h4> 
<ul><li><strong>使用django-admin工具：</strong> <code>django-admin</code>是Django自带的命令行工具，可以方便地创建和管理Django项目。</li><li><strong>设定项目名称和目录：</strong> 在创建项目时，您应该思考合适的项目名，这将是您的顶级应用名称。</li><li><strong>项目结构：</strong> Django创建的项目会有基本的目录结构，包括根目录下的<code>manage.py</code>, 核心配置在<code>settings.py</code>以及应用特定的设置在<code>urls.py</code>。</li><li> <pre><code class="language-bash">django-admin startproject myproject
</code></pre> </li></ul> 
<h4 id="4.%20%E6%B7%BB%E5%8A%A0%E5%BA%94%E7%94%A8">4. 添加应用</h4> 
<ul><li><strong>理解Django的应用模型：</strong> 在Django中，每个功能模块通常由一个应用表示。每个应用都有自己的模型、视图、模板等。</li><li><strong>创建API应用：</strong> 对于本教程，我们创建一个叫做<code>api</code>的新应用，它将承载我们的Web API。</li><li><strong>组织代码：</strong> 合理组织您的代码将有助于后续维护和扩展。考虑将模型、视图和路由分成不同的文件，以便管理。</li></ul> 
<h4 id="5.%20%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83%E4%B8%8E%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86">5. 虚拟环境与依赖管理</h4> 
<ul><li><strong>使用虚拟环境：</strong> 强烈建议使用虚拟环境包裹您的项目依赖，避免不同项目间的依赖混乱。</li><li><strong>pipenv或virtualenv：</strong> 选择其中之一作为您的虚拟环境管理器。两者都可以有效地创建隔离的Python环境。</li><li><strong>requirements.txt：</strong> 随着项目的进展，您会添加更多的包。使用<code>pip freeze &gt; requirements.txt</code>来保存您的包及其版本到一个文件中。这有助于项目的部署和团队协作。</li></ul> 
<h3 id="%E4%BA%8C%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96%E6%95%B0%E6%8D%AE">二、序列化数据</h3> 
<p>        在Django Rest Framework中，序列化数据是核心概念之一。序列化器是DRF中一个强大的工具，它转换复杂的数据类型为易于Web API消费的格式，如JSON。反之，它也处理从请求数据中解析用户发送的数据到Python对象的过程。这个双向的数据处理机制使得数据库内容可以容易地被任何客户端使用。</p> 
<h4 id="1.%20%E7%90%86%E8%A7%A3%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96">1. 理解序列化和反序列化</h4> 
<ul><li><strong>序列化：</strong> 是将模型实例转换为可以被存储或传输的格式（通常是JSON，XML等）的过程。这对于API响应非常有用，因为它允许服务器发送可以被多种类型的客户端轻松解析的标准化数据。</li><li><strong>反序列化：</strong> 是将已存储或传输的格式转换回模型实例的过程。当API接收数据时经常用到，比如在创建或更新数据库记录时。</li><li><img alt="" height="377" src="https://images2.imgbox.com/b5/0a/bdwCBaS3_o.png" width="814"></li></ul> 
<h4 id="2.%20%E5%88%9B%E5%BB%BA%E5%BA%8F%E5%88%97%E5%8C%96%E5%99%A8">2. 创建序列化器</h4> 
<p>        DRF通过<code>serializers.py</code>文件来管理序列化器。在这个文件中，您可以定义如何将模型转换为可序列化的格式，以及反之。</p> 
<pre><code class="language-python">from rest_framework import serializers
from .models import YourModel

class YourModelSerializer(serializers.ModelSerializer):
    class Meta:
        model = YourModel
        fields = ['field1', 'field2']
</code></pre> 
<ul><li><strong>定义模型序列化器：</strong> 每个模型通常都有一个相应的序列化器类。例如，对于<code>YourModel</code>，您会创建一个<code>YourModelSerializer</code>。</li><li><strong>字段覆盖和自定义：</strong> 您可以在序列化器中添加、删除或修改模型的字段。这包括指定字段类型、验证方法以及如何从数据库表示转换到序列化表示。</li><li><strong>嵌套和复杂的数据关系：</strong> DRF支持复杂的数据关系，如多表关系和反向关系。您可以使用<code>StringRelatedField</code>, <code>SlugRelatedField</code>, <code>HyperlinkedRelatedField</code>等字段来表示这些关系。</li></ul> 
<h4 id="3.%20%E5%BA%8F%E5%88%97%E5%8C%96%E5%99%A8%E7%9A%84%E9%AB%98%E7%BA%A7%E7%94%A8%E6%B3%95">3. 序列化器的高级用法</h4> 
<ul><li><strong>细节路由和超链接：</strong> 在序列化器中，您可以使用<code>HyperlinkedModelSerializer</code>来自动为模型实例生成超链接。这对于HATEOAS（Hypermedia as the engine of application state）风格的API非常实用。</li><li><strong>自定义字段和验证：</strong> 如果您需要对某个字段进行特定的验证或者处理，可以在序列化器中定义<code>validate_&lt;fieldname&gt;</code>方法。这给了您很大的灵活性来处理如何清理和验证来自用户的输入数据。</li><li><strong>多个表示形式：</strong> 有时您可能需要一个模型的多个序列化表示形式。在这种情况下，您可以为同一模型创建多个序列化器，并在视图中指定使用哪一个。</li></ul> 
<p>        通过灵活地使用序列化器，您可以精确控制数据的显示和提交方式。这是构建强大且安全Web API的关键步骤。现在我们已经了解了如何通过序列化器处理数据，接下来我们会深入到如何使用视图和路由来处理API的请求和响应。这将为我们提供一个完全功能的Web API，能够处理各种HTTP方法，如GET、POST、PUT和DELETE。</p> 
<h3 id="%E4%B8%89%E3%80%81%E8%A7%86%E5%9B%BE%E5%92%8C%E8%B7%AF%E7%94%B1">三、视图和路由</h3> 
<p>        在Django Rest Framework (DRF) 中，视图和路由紧密合作，用以处理传入的请求并返回相应的响应。视图是处理请求的逻辑部分，而路由则定义了这些视图如何与URLs关联。</p> 
<h4 id="1.%20%E5%88%9B%E5%BB%BAAPI%E8%A7%86%E5%9B%BE">1. 创建API视图</h4> 
<p>        DRF中的视图用于处理传入的请求并返回响应。您可以使用通用视图来简化开发流程。</p> 
<ul><li><strong>使用通用视图：</strong> DRF提供了一系列的通用视图，例如<code>retrieve</code>, <code>list</code>, <code>create</code>, <code>update</code>, <code>partial_update</code>, 和 <code>destroy</code>。这些视图封装了API开发中的常见模式。</li><li><strong>自定义视图继承：</strong> 如果您的需求超出了通用视图提供的功能，您可以通过继承这些视图并重写其方法来自定义视图。例如，您可以重写<code>get_queryset</code>方法来自定义返回的数据。</li></ul> 
<pre><code class="language-python">from rest_framework import generics
from .models import YourModel
from .serializers import YourModelSerializer

class YourModelListCreateView(generics.ListCreateAPIView):
    queryset = YourModel.objects.all()
    serializer_class = YourModelSerializer
</code></pre> 
<h4 id="2.%20%E9%85%8D%E7%BD%AE%E8%B7%AF%E7%94%B1">2. 配置路由</h4> 
<p>        路由的作用是将URL模式映射到相应的视图上。在DRF中，通常使用<code>urls.py</code>文件来配置这些路由。</p> 
<ul><li><strong>使用<code>path</code>和<code>register</code>：</strong> 在您的应用的<code>urls.py</code>文件中，使用<code>path</code>函数来定义哪些URL对应您的视图。如果使用路由器（如<code>DefaultRouter</code>），您还可以自动地为你的模型生成一套标准的API路由。</li><li><strong>自定义路由和视图绑定：</strong> 对于复杂的路由，您可以直接在<code>urls.py</code>中使用<code>path</code>精确控制URL结构，并将它们绑定到您的视图类上。</li></ul> 
<pre><code class="language-python">from django.urls import path, include
from rest_framework.routers import DefaultRouter
from .views import YourModelListCreateView

router = DefaultRouter()
router.register(r'yourmodel', YourModelListCreateView, basename='yourmodel')

urlpatterns = [
    path('', include(router.urls)),
]
</code></pre> 
<h4 id="3.%20%E9%AB%98%E7%BA%A7%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE">3. 高级路由配置</h4> 
<ul><li><strong>使用视图集：</strong> 视图集(ViewSets)允许您仅需定义一次视图逻辑，然后将其用在不同的路由上。这对于减少代码重复和维护大型API非常有用。</li><li><strong>复杂路由关系：</strong> 在某些情况下，您可能需要定义更复杂的路由关系。DRF支持使用第三方包如<code>django-rest-framework-nested</code>来处理嵌套的资源路由。</li></ul> 
<p>        通过定义细致的视图和灵活的路由，您可以精确控制API的行为和URL结构。这不仅提高了API的可维护性，也增强了用户体验。接下来，我们将讨论如何通过安全性和权限来保护您的API，确保数据的安全访问和操作。</p> 
<h3 id="%E5%9B%9B%E3%80%81%E5%AE%89%E5%85%A8%E6%80%A7%E5%92%8C%E6%9D%83%E9%99%90">四、安全性和权限</h3> 
<p>        保护您的API免受未经授权的访问是非常重要的。</p> 
<p><img alt="" height="889" src="https://images2.imgbox.com/ec/d7/FHYxCabt_o.png" width="1200"></p> 
<h4 id="1.%20%E5%85%A8%E5%B1%80%E8%AE%BE%E7%BD%AE%E8%AE%A4%E8%AF%81%E5%92%8C%E6%9D%83%E9%99%90">1. 全局设置认证和权限</h4> 
<p>        您可以在settings文件中为整个API配置默认的认证和权限策略。</p> 
<pre><code class="language-python">REST_FRAMEWORK = {
    'DEFAULT_AUTHENTICATION_CLASSES': [
        'rest_framework.authentication.BasicAuthentication',
        'rest_framework.authentication.SessionAuthentication',
    ],
    'DEFAULT_PERMISSION_CLASSES': [
        'rest_framework.permissions.IsAuthenticated',
    ],
}
</code></pre> 
<h4 id="2.%20%E7%BB%86%E8%8A%82%E7%BA%A7%E5%88%AB%E5%AE%89%E5%85%A8%E8%AE%BE%E7%BD%AE">2. 细节级别安全设置</h4> 
<p>        对于更细粒度的控制，您可以在视图级别上设置认证和权限。</p> 
<pre><code class="language-python">class YourModelListCreateView(generics.ListCreateAPIView):
    authentication_classes = [SessionAuthentication, BasicAuthentication]
    permission_classes = [IsAdminUser, ]
</code></pre> 
<h3 id="%E4%BA%94%E3%80%81%E6%B5%8B%E8%AF%95%E5%92%8C%E6%96%87%E6%A1%A3">五、测试和文档</h3> 
<p>        在开发任何应用程序，特别是Web API时，确保您的代码按预期工作是至关重要的。同时，一个好的API需要配备详细的文档，帮助开发者理解和使用接口。Django Rest Framework (DRF) 提供了工具和机制来帮助您轻松进行测试和生成文档。</p> 
<h4 id="1.%20%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95">1. 单元测试</h4> 
<p>单元测试是检查代码各个单元是否正常工作的过程。DRF提供了<code>APITestCase</code>类，它是Django的<code>TestCase</code>类的子类，专门用于API的测试。</p> 
<ul><li><strong>编写测试用例：</strong> 您应该为每个视图或视图集编写测试用例，确保它们正确处理请求和返回预期的响应。</li><li><strong>模拟请求与断言结果：</strong> 使用<code>APIClient</code>来发送模拟的HTTP请求到您的视图，并使用断言来验证响应数据。</li></ul> 
<pre><code class="language-python">from rest_framework.test import APITestCase
from rest_framework.status import HTTP_200_OK
from .models import YourModel

class YourModelApiTests(APITestCase):
    def test_create_yourmodel(self):
        url = reverse('yourmodel-list-create')
        response = self.client.post(url, {'field1': 'value1', 'field2': 'value2'}, format='json')
        self.assertEqual(response.status_code, HTTP_200_OK)
</code></pre> 
<h4 id="2.%20%E9%9B%86%E6%88%90%E6%B5%8B%E8%AF%95%E5%92%8C%E9%AA%8C%E6%94%B6%E6%B5%8B%E8%AF%95">2. 集成测试和验收测试</h4> 
<ul><li><strong>集成测试：</strong> 集成测试用来确保不同的部分（如模型、视图和路由）能够一起正常工作。这通常涉及测试整个API的交互。</li><li><strong>验收测试：</strong> 验收测试从用户的角度出发，确保系统符合业务需求。这包括测试API的端到端功能，确保它在实际使用中表现正常。</li></ul> 
<h4 id="3.%20%E6%96%87%E6%A1%A3%E7%94%9F%E6%88%90">3. 文档生成</h4> 
<p>良好的文档对于任何API都是关键，DRF通过其自动文档生成工具使得创建文档变得简单。</p> 
<ul><li><strong>使用docstrings：</strong> 在您的代码中充分利用Python的docstrings来描述视图、序列化器和模型的功能。</li><li><strong>自动文档生成：</strong> DRF可以自动从您的API中提取信息，生成可读的文档页面。只需几行设置，即可激活此功能。</li></ul> 
<pre><code class="language-python">from rest_framework.documentation import include_docs_urls

urlpatterns += [
    path('docs/', include_docs_urls(title='My API title')),
]
</code></pre> 
<h3 id="%E5%85%AD%E3%80%81%E6%80%BB%E7%BB%93">六、总结</h3> 
<p>        在本指南中，我们深入探讨了使用Django Rest Framework (DRF) 构建Web API的五个关键步骤：环境设置、数据序列化、视图与路由配置、安全性和权限设置、以及测试和文档生成。每一步都是构建强大、安全且易于维护的API的关键组成部分。</p> 
<ul><li><strong>环境设置</strong> 确保了您的项目有正确的基础架构。</li><li><strong>数据序列化</strong> 是处理数据输入输出的核心，关系到数据的标准化和国际化。</li><li><strong>视图与路由配置</strong> 定义了API的行为和URL结构，直接影响到API的用户友好度和可扩展性。</li><li><strong>安全性和权限</strong> 保护您的API免受未授权访问，保证数据的安全和合法使用。</li><li><strong>测试和文档</strong> 保证了API的可靠性和易用性，有助于开发者更快地了解和使用API。</li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ffac3f39754261a4eb4e516719487beb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">防御课第2次作业</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/158aab19583a54dcf31bac9df084a3e0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Django视图与URLs路由详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>