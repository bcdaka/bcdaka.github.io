<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Stable diffusion prompts 使用语法、参数讲解、插件安装教程 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/eb3ca93d7d355b7c3ef79a0659b2dbfb/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Stable diffusion prompts 使用语法、参数讲解、插件安装教程">
  <meta property="og:description" content="Stable diffusion prompts 使用语法、参数讲解、插件安装教程 本文基于 Stable diffusion WebUI 进行讲解（安装在 AutoDL 上，安装在本地电脑上的也同样适用本教程）。
初始界面：
文件目录结构：
上图红框中的 4 个文件夹是我们常用到的，embeddings 放置训练的 embedding 模型，它可以在我们使用基础模型时，再添加此模型进行叠加效果。
extensions 插件安装目录，在 WebUI 插件安装界面安装后，可以此文件夹中查看，并上传相应的插件模型（如 ControlNet 需要专门的模型）
Models 模型文件夹，安装时会默认下载 v1-5-pruned-emaonly，我们从其它地方下载的模型可以拷贝到此文件夹，在需要使用某个模型时，可以进行切换，如下图：
outputs 生成的图系统会输出到这个文件夹里，可进行查看及保存。
上图从左到右，依次是：
txt2img： 文字生成图片
img2img： 图片生成图片
Extras： “无损”放大图片，优化(清晰、扩展)图像
**PNG info：**从图片 exif 里获取图片的信息，如果是 Stable Diffusion 原始生成的 png 图片，图片的 exif 信息里会写入图片生成参数
**Checkpoint Merger：**合并不同的模型，生成新的模型
**Train：**训练 embedding 或者 hypernetwork
**Settings：**设置页面
**Extensions：**插件的安装和管理页面
txt2img **Sampling method：**采样方法
● Euler a ：富有创造力，不同步数可以生产出不同的图片。 超过 30~40 步基本就没什么增益了
● Euler：最常见的基础算法，最简单也最快
● DDIM：速度快，一般 20 步差不多">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-04T09:21:29+08:00">
    <meta property="article:modified_time" content="2024-06-04T09:21:29+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Stable diffusion prompts 使用语法、参数讲解、插件安装教程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Stable_diffusion_prompts__0"></a>Stable diffusion prompts 使用语法、参数讲解、插件安装教程</h2> 
<p>本文基于 Stable diffusion WebUI 进行讲解（安装在 AutoDL 上，安装在本地电脑上的也同样适用本教程）。</p> 
<p>初始界面：</p> 
<p><img src="https://images2.imgbox.com/52/70/5NKdYzB5_o.png" alt="img"></p> 
<p>文件目录结构：</p> 
<p><img src="https://images2.imgbox.com/a0/f6/W2qPJC4M_o.png" alt="img"></p> 
<p>上图红框中的 4 个文件夹是我们常用到的，embeddings 放置训练的 embedding 模型，它可以在我们使用基础模型时，再添加此模型进行叠加效果。</p> 
<p><img src="https://images2.imgbox.com/83/27/tP5Jk7qe_o.png" alt="img"></p> 
<p>extensions 插件安装目录，在 WebUI 插件安装界面安装后，可以此文件夹中查看，并上传相应的插件模型（如 ControlNet 需要专门的模型）</p> 
<p><img src="https://images2.imgbox.com/68/aa/RwJ0iLln_o.png" alt="img"></p> 
<p>Models 模型文件夹，安装时会默认下载 v1-5-pruned-emaonly，我们从其它地方下载的模型可以拷贝到此文件夹，在需要使用某个模型时，可以进行切换，如下图：</p> 
<p><img src="https://images2.imgbox.com/a0/40/3r8urUuh_o.png" alt="img"></p> 
<p>outputs 生成的图系统会输出到这个文件夹里，可进行查看及保存。</p> 
<p><img src="https://images2.imgbox.com/46/1a/NhMK3FzQ_o.png" alt="img"></p> 
<p>上图从左到右，依次是：</p> 
<p><strong>txt2img：</strong> 文字生成图片</p> 
<p><strong>img2img：</strong> 图片生成图片</p> 
<p><strong>Extras：</strong> “无损”放大图片，优化(清晰、扩展)图像</p> 
<p>**PNG info：**从图片 exif 里获取图片的信息，如果是 Stable Diffusion 原始生成的 png 图片，图片的 exif 信息里会写入图片生成参数</p> 
<p>**Checkpoint Merger：**合并不同的模型，生成新的模型</p> 
<p>**Train：**训练 embedding 或者 hypernetwork</p> 
<p>**Settings：**设置页面</p> 
<p>**Extensions：**插件的安装和管理页面</p> 
<h2><a id="txt2img_50"></a>txt2img</h2> 
<p><img src="https://images2.imgbox.com/0e/32/1OqMhZuW_o.png" alt="img"></p> 
<p>**Sampling method：**采样方法</p> 
<p>● Euler a ：富有创造力，不同步数可以生产出不同的图片。 超过 30~40 步基本就没什么增益了</p> 
<p>● Euler：最常见的基础算法，最简单也最快</p> 
<p>● DDIM：速度快，一般 20 步差不多</p> 
<p>● LMS：eular 的延伸算法，相对更稳定一点，30 步就比较稳定</p> 
<p>● PLMS：改进一点的 LMS</p> 
<p>● DPM2：DDIM 的一种改进版，速度大约是 DDIM 的两倍</p> 
<p>**Sampling Steps：**采样迭代步数</p> 
<p>先随机出一个噪声图片，然后一步步调整图片，向提示词 Prompt 靠拢。其实就是告诉 Stable Diffusion，这样的步骤应该进行多少次，步骤越多，每一步移动也就越小越精确，同时也成比例地增加生成图像所需要的时间。大部分采样器超过 50 步后意义就不大了</p> 
<p>**Restore faces：**优化面部，绘制面部图像特别注意。原理是调用一个神经网络模型对面部进行修复</p> 
<p>**Tiling：**生成一个可以平铺的图像</p> 
<p>**Highres. fix：**先生成低分辩率的图，接着添加细节之后再输出，可以把低分辨率的照片调整到高分辨率</p> 
<p><strong>Batch count、 Batch size：</strong> 都是生成几张图，前者计算时间长，后者需要显存大</p> 
<p>**Denoising strength：**决定算法对图像内容的保留程度。因为加的噪声少，原图片部分多，加的噪声多，原图片部分少。在 0 处，什么都不会改变，而在 1 处，你会得到一个不相关的图像</p> 
<p>**CFG Scale：**对描述参数的倾向程度（也就是生成图像与提示词的一致程度），越低的值产生越有创意的结果，如果太低，例如 1，那 Promp t就完全没用了。一般在 5~15 之间为好，7，9，12 是 3 个常见的设置值</p> 
<p>**Seed：**种子数，只要种子数、参数、模型都一致，就能重新生成一样的图像，-1 的话是生成一个随机数</p> 
<h2><a id="Prompt__88"></a>Prompt 语法</h2> 
<p>正向提示词例子：</p> 
<pre><code>(masterpiece:1.331), best quality,illustration,(1girl),(deep pink hair:1.331), (wavy hair:1.21),(disheveled hair:1.331), messy hair, long bangs, hairs between eyes,(white hair:1.331), multicolored hair,(white bloomers:1.46),(open clothes),beautiful detailed eyes,purple|red eyes),expressionless,sitting,dark background, moonlight,flower_petals,city,full_moon,
</code></pre> 
<p>**分隔：**不同的关键词tag之间，需要使用英文逗号 , 分隔，逗号前后有空格或者换行不影响结果。例如：1girl,loli,long hair,low twintails（1 个女孩，loli，长发，低双马尾）</p> 
<p>**混合：**WebUI 使用 | 分隔多个关键词，实现混合多个要素，注意混合是同等比例、同时混。例如：1girl,red|blue hair, long hair（1个女孩，红色与蓝色头发混合，长发）</p> 
<p>**增强/减弱：**有两种写法。</p> 
<p>● 第一种 (提示词:权重数值)：数值从0.1~100，默认状态是 1，低于 1 就是减弱，大于 1 就是加强。例如：(loli:1.21),(one girl:1.21),(cat ears:1.1),(flower hairpin:0.9)</p> 
<p>● 第二种 (((提示词)))，每套一层()括号增强 1.1 倍,每套一层 [] 减弱 1.1 倍。也就是套两层是1.1*1.1=1.21 倍，套三层是 1.331 倍，套 4 层是 1.4641 倍。例如： ((loli)),((one girl)),(cat ears),[flower hairpin]，这与第一种写法等价，所以还是建议使用第一种方式。</p> 
<p>**渐变：**可简单的理解时为，先按某种关键词生成，然后再此基础上向某个方向变化。</p> 
<p>[关键词1:关键词2:数字]，数字大于 1 理解为第 X 步前为关键词 1，第 X 步后变成关键词 2，数字小于 1 理解为总步数的百分之 X 前为关键词 1，之后变成关键词 2。</p> 
<p>例如：a girl with very long [white:yellow:16] hair 等价为开始 a girl with very long white hair</p> 
<p>，16步之后 a girl with very long yellow hair</p> 
<p>例如：a girl with very long [white:yellow:0.5] hair 等价为开始 a girl with very long white hair，50% 步之后 a girl with very long yellow hair</p> 
<p>**交替：**轮流使用关键词，例如：[cow|horse] in a field，这就是个牛与马的混合物；[cow|horse|cat|dog] in a field 就是牛、马、猫、狗之间混合。</p> 
<p>**Negative prompt：**负面提示词，用文字描述不想在图像中出现的内容。</p> 
<p>一些常见的负面提示词：</p> 
<pre><code>lowres,bad anatomy,bad hands,text,error,missing fingers,extra digit,fewer digits,cropped,worst quality,low quality,normal quality,jpeg artifacts,signature,watermark,username,blurry,missing arms,long neck,Humpbacked,missing limb,too many fingers,mutated,poorly drawn,out of frame,bad hands,owres,unclear eyes,poorly drawn,cloned face,bad face
</code></pre> 
<h2><a id="img2img_132"></a>img2img</h2> 
<p><img src="https://images2.imgbox.com/0d/12/VUPTSS0L_o.png" alt="img"></p> 
<p>与 txt2img 类似，在文字提示词的基础上，增加了图片提示。</p> 
<p><img src="https://images2.imgbox.com/ce/62/sxs7ZbuM_o.png" alt="img"></p> 
<p>Denoising strength：与原图一致性的程度，一般大于 0.7 出来的都是新效果，小于 0.3 基本就会原图一致</p> 
<h2><a id="Extras_144"></a>Extras</h2> 
<p><img src="https://images2.imgbox.com/67/85/bbn3UtZf_o.png" alt="img"></p> 
<p>主要将图像进行优化，Resize 设置放大的倍率，GFPGAN visibility 主要对图像清晰度进行优化，CodeFormer visibility 对于老照片及人脸修复很有效，权重参数为 0 时效果最大，为 1 时效果最小，建议从 0.5 开始尝试。</p> 
<p><img src="https://images2.imgbox.com/c5/2b/vQUDjvqE_o.png" alt="img"></p> 
<p>Upscaler 放大算法，一般不清楚可不选，或者选 ESRGAN_4x。</p> 
<p><img src="https://images2.imgbox.com/63/3c/mUrPqyBe_o.png" alt="img"></p> 
<p>Batch from Directory 可以进行批量处理，在 Input directory 中输入需要批量处理图片的目录，在 Output directory 中输入保存结果目录。</p> 
<p><img src="https://images2.imgbox.com/11/38/9b3yqllO_o.png" alt="img"></p> 
<p>Scale to 中，可自定义图片的尺寸。</p> 
<h2><a id="Extensions_164"></a>Extensions</h2> 
<p><img src="https://images2.imgbox.com/c5/d6/tCd85gGI_o.png" alt="img"></p> 
<p>插件界面，installed 表示已经安装好的插件，Available 表示在线可用的插件，一般都是从这里安装。</p> 
<p>点击 Load from: 加载出可用的插件，然后按 Ctrl + F，输入想要安装插件的名称，以此进行查找。</p> 
<p><img src="https://images2.imgbox.com/79/db/sAIiGS5G_o.png" alt="img"></p> 
<p>输入 CN，查找汉化插件：</p> 
<p><img src="https://images2.imgbox.com/dc/99/lPJTGC6w_o.png" alt="img"></p> 
<p>安装后，重新启动 UI 界面，插件就可以生效了。</p> 
<p><img src="https://images2.imgbox.com/df/79/kcyWdQJn_o.png" alt="img"></p> 
<p>两个比较重要的插件：Dreambooth，ControlNet。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/94c0d0d43682097f2a42f84bd1a29f1b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Python魔法之旅-魔法方法(14)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9fb01321fa92d870f6285e05f5ae9cb3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【面试干货】 非关系型数据库（NoSQL）与 关系型数据库（RDBMS）的比较</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>