<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于Hive的招聘网站的大数据分析系统 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/60f185a4f2870472795aaf801b476603/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="基于Hive的招聘网站的大数据分析系统">
  <meta property="og:description" content="1. 数据采集 首先，我们需要通过网络爬虫技术从招聘网站上获取数据。爬虫可以自动地访问网站并抓取所需的数据，例如职位信息、公司信息、薪资水平等。在选择爬虫工具时，需要考虑目标网站的结构和反爬虫机制，确保能够稳定高效地获取数据。
import csv import time import requests import execjs from storage.csv2mysql import sync_data2db def read_js_code(): f= open(&#39;/Users/shareit/workspace/chart_show/demo.js&#39;,encoding=&#39;utf-8&#39;) txt = f.read() js_code = execjs.compile(txt) ckId = js_code.call(&#39;r&#39;,32) return ckId def post_data(): read_js_code() url = &#34;https://api-c.liepin.com/api/com.liepin.searchfront4c.pc-search-job&#34; headers = { &#39;Accept&#39;: &#39;application/json, text/plain, */*&#39;, &#39;Accept-Encoding&#39;: &#39;gzip, deflate, br&#39; } list = [&#34;H01$H0001&#34;,&#34;H01$H0002&#34;, &#34;H01$H0003&#34;,&#34;H01$H0004&#34;,&#34;H01$H0005&#34;, &#34;H01$H0006&#34;,&#34;H01$H0007&#34;,&#34;H01$H0008&#34;, &#34;H01$H0009&#34;,&#34;H01$H00010&#34;,&#34;H02$H0018&#34;,&#34;H02$H0019&#34;,&#34;H03$H0022&#34;, &#34;H03$H0023&#34;,&#34;H03$H0024&#34;,&#34;H03$H0025&#34;,&#34;H04$H0030&#34;,&#34;H04$H0031&#34;, &#34;H04$H0032&#34;,&#34;H05$H05&#34;,&#34;H06$H06&#34;,&#34;H07$H07&#34;,&#34;H08$H08&#34;] for name in list: print(&#34;-------{}---------&#34;.format(name)) for i in range(10): print(&#34;------------第{}页-----------&#34;.format(i)) data = {&#34;data&#34;: {&#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-24T08:22:30+08:00">
    <meta property="article:modified_time" content="2024-03-24T08:22:30+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于Hive的招聘网站的大数据分析系统</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="1__0"></a>1. 数据采集</h3> 
<p>首先，我们需要通过网络爬虫技术从招聘网站上获取数据。爬虫可以自动地访问网站并抓取所需的数据，例如职位信息、公司信息、薪资水平等。在选择爬虫工具时，需要考虑目标网站的结构和反爬虫机制，确保能够稳定高效地获取数据。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> csv
<span class="token keyword">import</span> time

<span class="token keyword">import</span> requests
<span class="token keyword">import</span> execjs

<span class="token keyword">from</span> storage<span class="token punctuation">.</span>csv2mysql <span class="token keyword">import</span> sync_data2db


<span class="token keyword">def</span> <span class="token function">read_js_code</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    f<span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'/Users/shareit/workspace/chart_show/demo.js'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    txt <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    js_code <span class="token operator">=</span> execjs<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>txt<span class="token punctuation">)</span>
    ckId <span class="token operator">=</span> js_code<span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token string">'r'</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> ckId
    

<span class="token keyword">def</span> <span class="token function">post_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    read_js_code<span class="token punctuation">(</span><span class="token punctuation">)</span>
    url <span class="token operator">=</span> <span class="token string">"https://api-c.liepin.com/api/com.liepin.searchfront4c.pc-search-job"</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'Accept'</span><span class="token punctuation">:</span> <span class="token string">'application/json, text/plain, */*'</span><span class="token punctuation">,</span>
        <span class="token string">'Accept-Encoding'</span><span class="token punctuation">:</span> <span class="token string">'gzip, deflate, br'</span>
    <span class="token punctuation">}</span>
    <span class="token builtin">list</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"H01$H0001"</span><span class="token punctuation">,</span><span class="token string">"H01$H0002"</span><span class="token punctuation">,</span>
            <span class="token string">"H01$H0003"</span><span class="token punctuation">,</span><span class="token string">"H01$H0004"</span><span class="token punctuation">,</span><span class="token string">"H01$H0005"</span><span class="token punctuation">,</span>
            <span class="token string">"H01$H0006"</span><span class="token punctuation">,</span><span class="token string">"H01$H0007"</span><span class="token punctuation">,</span><span class="token string">"H01$H0008"</span><span class="token punctuation">,</span>
            <span class="token string">"H01$H0009"</span><span class="token punctuation">,</span><span class="token string">"H01$H00010"</span><span class="token punctuation">,</span><span class="token string">"H02$H0018"</span><span class="token punctuation">,</span><span class="token string">"H02$H0019"</span><span class="token punctuation">,</span><span class="token string">"H03$H0022"</span><span class="token punctuation">,</span>
            <span class="token string">"H03$H0023"</span><span class="token punctuation">,</span><span class="token string">"H03$H0024"</span><span class="token punctuation">,</span><span class="token string">"H03$H0025"</span><span class="token punctuation">,</span><span class="token string">"H04$H0030"</span><span class="token punctuation">,</span><span class="token string">"H04$H0031"</span><span class="token punctuation">,</span>
            <span class="token string">"H04$H0032"</span><span class="token punctuation">,</span><span class="token string">"H05$H05"</span><span class="token punctuation">,</span><span class="token string">"H06$H06"</span><span class="token punctuation">,</span><span class="token string">"H07$H07"</span><span class="token punctuation">,</span><span class="token string">"H08$H08"</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> name <span class="token keyword">in</span> <span class="token builtin">list</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------{}---------"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"------------第{}页-----------"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
            data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token string">"mainSearchPcConditionForm"</span><span class="token punctuation">:</span>
                                 <span class="token punctuation">{<!-- --></span><span class="token string">"city"</span><span class="token punctuation">:</span> <span class="token string">"410"</span><span class="token punctuation">,</span> <span class="token string">"dq"</span><span class="token punctuation">:</span> <span class="token string">"410"</span><span class="token punctuation">,</span> <span class="token string">"pubTime"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"currentPage"</span><span class="token punctuation">:</span> i<span class="token punctuation">,</span> <span class="token string">"pageSize"</span><span class="token punctuation">:</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token string">"key"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
                                  <span class="token string">"suggestTag"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"workYearCode"</span><span class="token punctuation">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"compId"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"compName"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"compTag"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
                                  <span class="token string">"industry"</span><span class="token punctuation">:</span> name<span class="token punctuation">,</span> <span class="token string">"salary"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"jobKind"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"compScale"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"compKind"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"compStage"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
                                  <span class="token string">"eduLevel"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                             <span class="token string">"passThroughForm"</span><span class="token punctuation">:</span>
                                 <span class="token punctuation">{<!-- --></span><span class="token string">"scene"</span><span class="token punctuation">:</span> <span class="token string">"page"</span><span class="token punctuation">,</span> <span class="token string">"skId"</span><span class="token punctuation">:</span> <span class="token string">"z33lm3jhwza7k1xjvcyn8lb8e9ghxx1b"</span><span class="token punctuation">,</span>
                                  <span class="token string">"fkId"</span><span class="token punctuation">:</span> <span class="token string">"z33lm3jhwza7k1xjvcyn8lb8e9ghxx1b"</span><span class="token punctuation">,</span>
                                  <span class="token string">"ckId"</span><span class="token punctuation">:</span> read_js_code<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                  <span class="token string">'sfrom'</span><span class="token punctuation">:</span> <span class="token string">'search_job_pc'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> json<span class="token operator">=</span>data<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
            parse_data<span class="token punctuation">(</span>response<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">parse_data</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        jobCardList <span class="token operator">=</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'jobCardList'</span><span class="token punctuation">]</span>
        sync_data2db<span class="token punctuation">(</span>jobCardList<span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">return</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    post_data<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/cb/9c/8290sypQ_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2__67"></a>2. 数据预处理</h3> 
<p>获取到的原始数据往往杂乱无章，需要进行预处理才能进行后续的分析工作。预处理包括数据清洗、去重、缺失值处理、数据格式转换等环节，以确保数据的质量和一致性。在这一阶段，还可以利用自然语言处理技术对文本数据进行分词、词性标注等操作，为后续的分析提供更多维度的信息。然后将数据加载到hive中进行分析。</p> 
<pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> mydb<span class="token punctuation">.</span><span class="token keyword">data</span> <span class="token punctuation">(</span>
  id <span class="token keyword">INT</span><span class="token punctuation">,</span>
  title STRING<span class="token punctuation">,</span>
  city STRING<span class="token punctuation">,</span>
  salary STRING<span class="token punctuation">,</span>
  campus_job_kind STRING<span class="token punctuation">,</span>
  labels STRING<span class="token punctuation">,</span>
  compName STRING<span class="token punctuation">,</span>
  compIndustry STRING<span class="token punctuation">,</span>
  compScale STRING
<span class="token punctuation">)</span>
<span class="token keyword">COMMENT</span> <span class="token string">'数据表'</span>
<span class="token keyword">ROW</span> FORMAT DELIMITED
<span class="token keyword">FIELDS</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">','</span>
STORED <span class="token keyword">AS</span> TEXTFILE<span class="token punctuation">;</span>

<span class="token keyword">LOAD</span> <span class="token keyword">DATA</span> INPATH <span class="token string">'/file.csv'</span> OVERWRITE <span class="token keyword">INTO</span> <span class="token keyword">TABLE</span> mydb<span class="token punctuation">.</span><span class="token keyword">data</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/3c/51/Z7FVy04u_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3__92"></a>3. 数据分析</h3> 
<p>有了清洗和存储好的数据，接下来就是进行数据分析。数据分析的方法多种多样，可以根据具体的需求选择合适的分析技术和模型。常见的数据分析技术包括统计分析、机器学习、文本挖掘等。通过对招聘数据的分析，我们可以发现人才市场的热点行业、热门职位、薪资水平等信息，为企业招聘决策提供参考。</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">city_count_from_db</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">tuple</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> connection<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> cursor<span class="token punctuation">:</span>
            select_query <span class="token operator">=</span> <span class="token string">"select * from (select city,count(1) cnt FROM data group by city)a limit 10"</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>select_query<span class="token punctuation">)</span>
            result <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> row <span class="token keyword">in</span> result<span class="token punctuation">:</span>
                <span class="token builtin">tuple</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">'city'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>row<span class="token punctuation">[</span><span class="token string">'cnt'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token builtin">tuple</span>



<span class="token keyword">def</span> <span class="token function">salary_avg_from_db</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    x<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> connection<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> cursor<span class="token punctuation">:</span>
            select_query <span class="token operator">=</span> <span class="token string">"select * from (select city,avg(salary) avg FROM data group by city)a limit 20"</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>select_query<span class="token punctuation">)</span>
            result <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> row <span class="token keyword">in</span> result<span class="token punctuation">:</span>
                x<span class="token punctuation">.</span>append<span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">'city'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                y<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">'avg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token keyword">return</span> x<span class="token punctuation">,</span>y


<span class="token keyword">def</span> <span class="token function">salary_industry_from_db</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    x<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> connection<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> cursor<span class="token punctuation">:</span>
            select_query <span class="token operator">=</span> <span class="token string">"select * from (select compIndustry,avg(salary) avg FROM data group by compIndustry)a limit 20"</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>select_query<span class="token punctuation">)</span>
            result <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> row <span class="token keyword">in</span> result<span class="token punctuation">:</span>
                x<span class="token punctuation">.</span>append<span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">'compIndustry'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                y<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">'avg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token keyword">return</span> x<span class="token punctuation">,</span>y

<span class="token keyword">def</span> <span class="token function">salary_title_from_db</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    x<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> connection<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> cursor<span class="token punctuation">:</span>
            select_query <span class="token operator">=</span> <span class="token string">"select title,count(1) cnt from data group by title order by cnt desc limit 10"</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>select_query<span class="token punctuation">)</span>
            result <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> row <span class="token keyword">in</span> result<span class="token punctuation">:</span>
                x<span class="token punctuation">.</span>append<span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                y<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">'cnt'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token keyword">return</span> x<span class="token punctuation">,</span>y

<span class="token keyword">def</span> <span class="token function">comany_from_db</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">tuple</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> connection<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> cursor<span class="token punctuation">:</span>
            select_query <span class="token operator">=</span> <span class="token string">"select compName,count(1) cnt FROM data group by compName order by cnt desc limit 10"</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>select_query<span class="token punctuation">)</span>
            result <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> row <span class="token keyword">in</span> result<span class="token punctuation">:</span>
                <span class="token builtin">tuple</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">'compName'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> row<span class="token punctuation">[</span><span class="token string">'cnt'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token builtin">tuple</span>
</code></pre> 
<h3><a id="4__172"></a>标题4. 数据可视化</h3> 
<p>最后，为了更直观地展示分析结果，我们利用Django框架搭建了数据可视化的平台。Django是一个高效的Web开发框架，通过它可以快速构建出美观、易用的数据可视化界面。在可视化界面上，我们可以展示招聘数据的各种统计图表、热点地图、词云等，帮助用户更直观地理解数据背后的信息。</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">bar_chart</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    line <span class="token operator">=</span> Line<span class="token punctuation">(</span><span class="token punctuation">)</span>
    x<span class="token punctuation">,</span>y<span class="token operator">=</span>salary_avg<span class="token punctuation">(</span><span class="token punctuation">)</span>
    line<span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    line<span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">"全国应届毕业生就业城市薪资分布图"</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span>

    line1 <span class="token operator">=</span> Line<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
        xaxis_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisOpts<span class="token punctuation">(</span>axislabel_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>rotate<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    x<span class="token punctuation">,</span> y <span class="token operator">=</span> title_count<span class="token punctuation">(</span><span class="token punctuation">)</span>
    line1<span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    line1<span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">"全国应届毕业生就业岗位分布图"</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span>


    <span class="token comment"># 创建条形图</span>
    bar <span class="token operator">=</span> Bar<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
        xaxis_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisOpts<span class="token punctuation">(</span>axislabel_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>rotate<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    x<span class="token punctuation">,</span>y <span class="token operator">=</span> industry_avg<span class="token punctuation">(</span><span class="token punctuation">)</span>
    bar<span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    bar<span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">"全国应届毕业生就业领域薪资分布图"</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span>

    <span class="token comment"># 创建饼图</span>
    pie <span class="token operator">=</span> Pie<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token builtin">tuple</span> <span class="token operator">=</span> city_top<span class="token punctuation">(</span><span class="token punctuation">)</span>
    pie<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">"全国应届毕业生就业城市top10"</span><span class="token punctuation">,</span><span class="token builtin">tuple</span><span class="token punctuation">)</span>

    pie1 <span class="token operator">=</span> Pie<span class="token punctuation">(</span><span class="token punctuation">)</span>
    tuple1 <span class="token operator">=</span> comany_count<span class="token punctuation">(</span><span class="token punctuation">)</span>
    pie1<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">"全国应届毕业生就业公司top10"</span><span class="token punctuation">,</span>tuple1<span class="token punctuation">)</span>

    <span class="token comment"># 获取图表的JavaScript代码</span>
    line_js <span class="token operator">=</span> line<span class="token punctuation">.</span>render_embed<span class="token punctuation">(</span><span class="token punctuation">)</span>
    bar_js <span class="token operator">=</span> bar<span class="token punctuation">.</span>render_embed<span class="token punctuation">(</span><span class="token punctuation">)</span>
    pie_js <span class="token operator">=</span> pie<span class="token punctuation">.</span>render_embed<span class="token punctuation">(</span><span class="token punctuation">)</span>
    line1_js <span class="token operator">=</span> line1<span class="token punctuation">.</span>render_embed<span class="token punctuation">(</span><span class="token punctuation">)</span>
    pie1_js <span class="token operator">=</span> pie1<span class="token punctuation">.</span>render_embed<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'charts/bar_chart.html'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token string">'line'</span><span class="token punctuation">:</span> line_js<span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">:</span> bar_js<span class="token punctuation">,</span> <span class="token string">'pie'</span><span class="token punctuation">:</span> pie_js<span class="token punctuation">,</span><span class="token string">'line1'</span><span class="token punctuation">:</span> line1_js<span class="token punctuation">,</span><span class="token string">'pie1'</span><span class="token punctuation">:</span> pie1_js<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>下面是数据分析的展示结果，喜欢的可以加个收藏点个关注哦，更多毕设相关内容，小编将持续分享哦<br> <img src="https://images2.imgbox.com/46/0f/MOTsKnqW_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/0b/8b/OQGgAxkt_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/11/fa/DwKOQISD_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/65/80/4OnBN5UY_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c5/86/WYTsq27d_o.png" alt="在这里插入图片描述"><br> 如有遇到问题可以找小编沟通交流哦。另外小编帮忙辅导大课作业，学生毕设等。不限于python，java，大数据，模型训练等。<br> <img src="https://images2.imgbox.com/1b/37/8NCXqspL_o.jpg" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d285aa5631b3c4204be0732c494885d5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">[MySQL]数据库原理6——喵喵期末不挂科</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/63c8bb37ac0776e745796796a9910b4d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">R语言绘制相关性热图全总结</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>