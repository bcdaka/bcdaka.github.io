<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Hive 排名函数ROW_NUMBER、RANK()、DENSE_RANK等功能介绍、对比和举例 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/abb88ee6b094dbc349a1c15d7578a420/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Hive 排名函数ROW_NUMBER、RANK()、DENSE_RANK等功能介绍、对比和举例">
  <meta property="og:description" content="目录
1. ROW_NUMBER()
2. RANK()
3. DENSE_RANK()
4. NTILE()
5. CUME_DIST()
6. PERCENT_RANK()
1. ROW_NUMBER() 功能：ROW_NUMBER() 函数为每个分组内的行提供唯一的序列号，从1开始。如果在 OVER() 子句中使用 ORDER BY 语句，它将根据指定的列值对行进行排序。
对比：
每个行都会获得一个唯一的排名数字。
即使两行的排序列值相同，它们也会获得连续的排名，不会有相同的排名值。
举例： SELECT name, score, ROW_NUMBER() OVER (ORDER BY score DESC) as rank FROM students; 说明：假设 students 表包含学生的名字和分数。上述查询将根据分数降序排列学生，并为每个学生分配一个唯一的序列号作为排名。如果两个学生分数相同，他们将获得连续的排名编号。
2. RANK() 功能：RANK() 函数在分组内为行提供排名，从1开始。如果两行或多行在 ORDER BY 子句中指定的排序列上的值相等，则它们将获得相同的排名，并且排名数字会跳过。
对比：
如果有相同值的行，它们将共享相同的排名。
在相同值的行之后的排名会跳过那些共享排名的行数。例如，如果有两行共享排名1，那么下一个排名将是3。
举例：
SELECT name, score, RANK() OVER (ORDER BY score DESC) as rank FROM students; 说明：使用与 ROW_NUMBER() 相同的数据，RANK() 函数将为分数相同的学生分配相同的排名。如果两个学生的分数相同，他们将共享排名，例如都是排名1，下一个学生的排名将是3（假设只有两个学生分数相同）。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-30T12:24:33+08:00">
    <meta property="article:modified_time" content="2024-01-30T12:24:33+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Hive 排名函数ROW_NUMBER、RANK()、DENSE_RANK等功能介绍、对比和举例</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="1.%20ROW_NUMBER()-toc" style="margin-left:0px;"><a href="#1.%20ROW_NUMBER%28%29" rel="nofollow">1. ROW_NUMBER()</a></p> 
<p id="2.%20RANK()-toc" style="margin-left:0px;"><a href="#2.%20RANK%28%29" rel="nofollow">2. RANK()</a></p> 
<p id="3.%20DENSE_RANK()-toc" style="margin-left:0px;"><a href="#3.%20DENSE_RANK%28%29" rel="nofollow">3. DENSE_RANK()</a></p> 
<p id="4.%20NTILE()-toc" style="margin-left:0px;"><a href="#4.%20NTILE%28%29" rel="nofollow">4. NTILE()</a></p> 
<p id="5.%20CUME_DIST()-toc" style="margin-left:0px;"><a href="#5.%20CUME_DIST%28%29" rel="nofollow">5. CUME_DIST()</a></p> 
<p id="6.%20PERCENT_RANK()-toc" style="margin-left:0px;"><a href="#6.%20PERCENT_RANK%28%29" rel="nofollow">6. PERCENT_RANK()</a></p> 
<hr> 
<h2 id="1.%20ROW_NUMBER()">1. ROW_NUMBER()</h2> 
<p>  <strong>功能</strong>：ROW_NUMBER() 函数为每个分组内的行提供唯一的序列号，从1开始。如果在 OVER() 子句中使用 ORDER BY 语句，它将根据指定的列值对行进行排序。</p> 
<p>  <strong>对比</strong>：</p> 
<p>   每个行都会获得一个唯一的排名数字。<br>    即使两行的排序列值相同，它们也会获得连续的排名，不会有相同的排名值。</p> 
<p> <strong> 举例： </strong></p> 
<pre><code class="language-sql">SELECT name, score, ROW_NUMBER() OVER (ORDER BY score DESC) as rank
FROM students;
</code></pre> 
<p>  说明：假设 students 表包含学生的名字和分数。上述查询将根据分数降序排列学生，并为每个学生分配一个唯一的序列号作为排名。如果两个学生分数相同，他们将获得连续的排名编号。</p> 
<h2 id="2.%20RANK()"><br> 2. RANK()</h2> 
<p>    <strong>功能</strong>：RANK() 函数在分组内为行提供排名，从1开始。如果两行或多行在 ORDER BY 子句中指定的排序列上的值相等，则它们将获得相同的排名，并且排名数字会跳过。</p> 
<p>    <strong>对比</strong>：</p> 
<p>    如果有相同值的行，它们将共享相同的排名。<br>     在相同值的行之后的排名会跳过那些共享排名的行数。例如，如果有两行共享排名1，那么下一个排名将是3。</p> 
<p>    <strong>举例：</strong></p> 
<pre><code class="language-sql">SELECT name, score, RANK() OVER (ORDER BY score DESC) as rank
FROM students;
</code></pre> 
<p>   说明：使用与 ROW_NUMBER() 相同的数据，RANK() 函数将为分数相同的学生分配相同的排名。如果两个学生的分数相同，他们将共享排名，例如都是排名1，下一个学生的排名将是3（假设只有两个学生分数相同）。</p> 
<h2 id="3.%20DENSE_RANK()"><br> 3. DENSE_RANK()</h2> 
<p>   <strong>功能</strong>：DENSE_RANK() 函数与 RANK() 函数类似，为分组内的行提供排名，但是它不会跳过排名数字。</p> 
<p>   <strong>对比：</strong></p> 
<p>    与 RANK() 类似，相同值的行会获得相同的排名。<br>     不同于 RANK()，DENSE_RANK() 在相同值的行之后不会跳过排名数字。例如，如果有两行共享排名1，那么下一个排名将是2。</p> 
<p><strong>   举例：</strong></p> 
<pre><code class="language-sql">SELECT name, score, DENSE_RANK() OVER (ORDER BY score DESC) as rank
FROM students;
</code></pre> 
<p>   说明：使用与 RANK() 相同的数据，DENSE_RANK() 函数也会为分数相同的学生分配相同的排名。不同之处在于，它不会跳过排名，所以在上述例子中，下一个学生的排名将是2，而不是3。</p> 
<h2 id="4.%20NTILE()"><br> 4. NTILE()</h2> 
<p>   <strong>功能</strong>：NTILE() 函数将分组内的行分配到指定数量的桶中，并为每个行提供桶的编号。这对于数据分区和分布式处理很有用。</p> 
<p>   <strong>对比</strong>：</p> 
<p>    NTILE() 用于更均匀地分配行到固定数量的桶中，而不是基于其值的排名。<br>     它更适合于当你需要将数据均匀地分成几部分时使用。</p> 
<p>   <strong>举例：</strong></p> 
<pre><code class="language-sql">SELECT name, score, NTILE(4) OVER (ORDER BY score DESC) as bucket
FROM students;
</code></pre> 
<p>  说明：假设我们想要将学生根据分数高低分成4个桶。NTILE(4) 将学生分成四个组，每个组有相近数量的学生，并为每个学生分配一个桶编号。</p> 
<h2 id="5.%20CUME_DIST()"><br> 5. CUME_DIST()</h2> 
<p>  <strong>  功能</strong>：<code>CUME_DIST()</code> 函数计算每个记录的累计分布百分比。这个函数返回一个介于 0 和 1 之间的值，表示小于或等于当前记录值的所有记录所占的比例。计算方式是 <code>number of rows preceding or peer with the current row / total rows</code>。</p> 
<p>   <strong> 对比：</strong></p> 
<p>    这是一个统计函数，用于计算行在整体分布中的位置。<br>     它不提供排名，而是提供了每行相对于整个数据集的位置度量。</p> 
<p>    <strong>举例：</strong></p> 
<pre><code class="language-sql">SELECT name, score, CUME_DIST() OVER (ORDER BY score DESC) as cume_dist
FROM students;
</code></pre> 
<p>  说明：这将计算每个学生的累积分布值。在上述查询中，每个学生的 cume_dist 值表示有多少比例的学生分数低于或等于该学生。在这个例子中，每个学生的成绩会根据分数从高到低计算出一个累计分布百分比。例如，如果有 10 名学生，当前学生是按成绩排序后的第 3 名，那么前三名（包括当前学生）的学生数占总学生数的比例即为当前学生的累计分布百分比。如果前三名的成绩相同，那么这三名学生的累计分布百分比相同，都是 0.3。</p> 
<h2 id="6.%20PERCENT_RANK()"><br> 6. PERCENT_RANK()</h2> 
<p>    <strong>功能</strong>：<code>PERCENT_RANK()</code> 函数计算每个记录在结果集中的相对排名百分比。这个函数会返回一个介于 0 和 1 之间的值，其中 0 表示排名最高（第一位），而 1 表示排名最低（最后一位）。计算方式是 <code>(rank - 1) / (total rows - 1)</code>。</p> 
<p>  <strong> 对比</strong>：</p> 
<p>     PERCENT_RANK() 提供了一个介于0和1之间的数值，这个数值表示当前行的相对排名。<br>     它用于确定行在其分组内的相对位置，而不是一个绝对的排名数字。</p> 
<p>    <strong>举例：</strong></p> 
<pre><code class="language-sql">SELECT name, score, PERCENT_RANK() OVER (ORDER BY score DESC) as percent_rank
FROM students;
</code></pre> 
<p>   说明：在这个例子中，每个学生的成绩会根据分数从高到低计算出一个百分比排名。第一名的学生百分比排名是 0，最后一名的百分比排名是 1，其他学生的百分比排名介于两者之间。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1941948d6b2619020f0f96b8865faf1e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">阿里AI代码智能编辑插件通义灵码——对标GitHub Copilot、完爆讯飞iflycode</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/486b5d1a8d43103f7c6e5b59d4d2e1d5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">iOS17使用safari调试wkwebview</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>