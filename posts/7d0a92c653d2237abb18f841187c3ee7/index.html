<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>IDEA连接HBase集群 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/7d0a92c653d2237abb18f841187c3ee7/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="IDEA连接HBase集群">
  <meta property="og:description" content="#环境介绍# 本地电脑window10
IntelliJ IDEA Community Edition 2023.2.3
虚拟机集群Hadoop3.1.4：master/slave1/slave2/slave3
HBase2.2.2
一、在IDEA中创建工程
file-&gt;new-&gt;New Project 设置项目名和存储路径，选择Archetype
2.选择项目，创建目录结构。
项目名右击-&gt;new-&gt;directory(下图的前两个)
得到如下目录结构：
将core-site.xml和hbase-site.xml放入resources目录下
core-site.xml在虚拟机master节点下的/usr/local/hadoop-3.1.4/etc/hadoop/
hbase-site.xml在虚拟机master节点下的/opt/hbase-2.2.2/conf/
在项目中导入jar包（hadoop解压后的jar包和hbase解压后的jar包）
先将hadoop和hbase的压缩包解压到本地
file-&gt;project structure-&gt;libraries-&gt; “&#43;”
导入hadoop解压后（C:\hadoop-3.1.4\share\hadoop\client）路径下所有包
hbase解压后（C:\hbase-2.2.2\lib）路径下所有包
hbase解压后（C:\hbase-2.2.2\lib\client-facing-thirdparty）路径下所有包
导完之后的效果：
二、配置Windows系统环境变量
我的电脑右击属性-&gt;高级系统设置-&gt;环境变量
在系统变量中新建，添加HADOOP_HOME的变量名和对应的路径
在系统变量的Path变量中添加HADOOP_HOME变量
三、配置Windows系统hosts文件
查看虚拟机中/etc/hosts文件 将ip与主机名映射复制，粘贴到windows系统的hosts文件中，hosts文件路径为（C:\Windows\System32\drivers\etc），用记事本打开。
四、hadoop.dll文件导入
将hadoop.dll文件放入C:\Windows\System32\路径下。
五、启动HBase集群
master节点start-dfs.sh 和start-yarn.sh
slave1、slave2和slave3依次启动zookeeper：zkServer.sh start
master节点start-hbase.sh
master节点hbase shell进行hbase，输入list_namespace测试 六、在IDEA中编写程序，测试连接
在src\main\java下创建com.zx.hbase包，在包下创建HBaseTest文件。
将以下代码放入其中 package com.zx.hbase; import org.apache.hadoop.conf.Configuration; import org.apache.hadoop.hbase.*; import org.apache.hadoop.hbase.client.*; import org.apache.hadoop.hbase.util.Bytes; import java.io.IOException; public class HBaseTest { public static Configuration configuration; //管理HBase的配置信息 public static Connection connection; //管理HBase的连接 public static Admin admin; //管理HBase数据库表信息 public static void main(String[] args)throws IOException{ init(); createTable(&#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-12-22T20:09:21+08:00">
    <meta property="article:modified_time" content="2023-12-22T20:09:21+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">IDEA连接HBase集群</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4><strong>#环境介绍#</strong></h4> 
<p>本地电脑window10</p> 
<p>IntelliJ IDEA Community Edition 2023.2.3</p> 
<p>虚拟机集群Hadoop3.1.4：master/slave1/slave2/slave3</p> 
<p>HBase2.2.2</p> 
<p></p> 
<p style="text-align:justify;"><strong>一、在IDEA</strong><strong>中创建工程</strong></p> 
<ol><li style="text-align:justify;"><strong>file-&gt;new-&gt;New Project</strong></li></ol> 
<p style="margin-left:0;text-align:justify;">        设置项目名和存储路径，选择Archetype</p> 
<p class="img-center"><img alt="" height="490" src="https://images2.imgbox.com/c3/03/Shb9hnAx_o.png" width="581"></p> 
<p style="text-align:justify;"><strong>        2.选择项目，创建目录结构。</strong></p> 
<p style="margin-left:0;text-align:justify;">        项目名右击-&gt;new-&gt;directory(下图的前两个)</p> 
<p class="img-center"><img alt="" height="264" src="https://images2.imgbox.com/43/74/RdIZGaSC_o.png" width="513"></p> 
<p style="margin-left:0;text-align:justify;">        得到如下目录结构：</p> 
<p class="img-center"><img alt="" height="224" src="https://images2.imgbox.com/dc/44/mdKMprY5_o.png" width="309"></p> 
<p style="margin-left:0;text-align:justify;">        将core-site.xml和hbase-site.xml放入resources目录下</p> 
<p style="margin-left:0;text-align:justify;">                core-site.xml在虚拟机master节点下的/usr/local/hadoop-3.1.4/etc/hadoop/</p> 
<p style="margin-left:0;text-align:justify;">                hbase-site.xml在虚拟机master节点下的/opt/hbase-2.2.2/conf/</p> 
<p class="img-center"><img alt="" height="448" src="https://images2.imgbox.com/2a/b4/gYDRTu5H_o.png" width="548"></p> 
<p style="margin-left:0;text-align:justify;">        在项目中导入jar包（hadoop解压后的jar包和hbase解压后的jar包）</p> 
<p style="margin-left:0;text-align:justify;">        先将hadoop和hbase的压缩包解压到本地</p> 
<p style="margin-left:0;text-align:justify;">        file-&gt;project structure-&gt;libraries-&gt; “+”</p> 
<p style="margin-left:0;text-align:justify;">        导入hadoop解压后（C:\hadoop-3.1.4\share\hadoop\client）路径下所有包</p> 
<p style="margin-left:0;text-align:justify;">                    hbase解压后（C:\hbase-2.2.2\lib）路径下所有包</p> 
<p style="margin-left:0;text-align:justify;">                    hbase解压后（C:\hbase-2.2.2\lib\client-facing-thirdparty）路径下所有包</p> 
<p style="margin-left:0;text-align:justify;">        导完之后的效果：</p> 
<p style="margin-left:0;text-align:justify;"><strong>二、配置Windows系统环境变量</strong></p> 
<p style="margin-left:0;text-align:justify;">        我的电脑右击属性-&gt;高级系统设置-&gt;环境变量</p> 
<p style="margin-left:0;text-align:justify;">        在<strong>系统变量</strong>中新建，添加HADOOP_HOME的变量名和对应的路径</p> 
<p class="img-center"><img alt="" height="196" src="https://images2.imgbox.com/c4/2f/0irE5m1b_o.png" width="745"></p> 
<p style="margin-left:0;text-align:justify;">        在<strong>系统变量</strong>的Path变量中添加HADOOP_HOME变量</p> 
<p class="img-center"><img alt="" height="131" src="https://images2.imgbox.com/5c/24/dRnJRJJu_o.png" width="781"></p> 
<p style="margin-left:0;text-align:justify;"><strong>三、配置Windows系统hosts</strong><strong>文件</strong></p> 
<p style="margin-left:0;text-align:justify;">        查看虚拟机中/etc/hosts文件      </p> 
<p class="img-center"><img alt="" height="259" src="https://images2.imgbox.com/8e/ef/N64mgDt8_o.png" width="751"></p> 
<p style="margin-left:0;text-align:justify;">     将ip与主机名映射复制，粘贴到windows系统的hosts文件中，hosts文件路径为（C:\Windows\System32\drivers\etc），用记事本打开。</p> 
<p class="img-center"><img alt="" height="262" src="https://images2.imgbox.com/6d/52/QoWDzouA_o.png" width="686"></p> 
<p><strong>四、hadoop.dll文件导入</strong></p> 
<p style="margin-left:0;text-align:justify;">        将hadoop.dll文件放入C:\Windows\System32\路径下。</p> 
<p style="margin-left:0;text-align:justify;"><strong>五、启动HBase集群</strong></p> 
<p style="margin-left:0;text-align:justify;">        master节点start-dfs.sh 和start-yarn.sh</p> 
<p style="margin-left:0;text-align:justify;">        slave1、slave2和slave3依次启动zookeeper：zkServer.sh start</p> 
<p style="margin-left:0;text-align:justify;">        master节点start-hbase.sh</p> 
<p style="margin-left:0;text-align:justify;">        master节点hbase shell进行hbase，输入list_namespace测试        </p> 
<p class="img-center"><img alt="" height="236" src="https://images2.imgbox.com/3d/73/94RAYvVo_o.png" width="435"></p> 
<p style="text-align:justify;"><strong>六、在IDEA</strong><strong>中编写程序，测试连接</strong></p> 
<p style="margin-left:0;text-align:justify;">        在src\main\java下创建com.zx.hbase包，在包下创建HBaseTest文件。</p> 
<p class="img-center"><img alt="" height="227" src="https://images2.imgbox.com/f4/e8/eRomi0XO_o.png" width="472"></p> 
<p style="margin-left:0;text-align:justify;">        将以下代码放入其中        </p> 
<pre><code class="language-java">package com.zx.hbase;
import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.hbase.*;
import org.apache.hadoop.hbase.client.*;
import org.apache.hadoop.hbase.util.Bytes;
import java.io.IOException;
public class HBaseTest {
    public static Configuration configuration;  //管理HBase的配置信息
    public static Connection connection;  //管理HBase的连接
    public static Admin admin;   //管理HBase数据库表信息
    public static void main(String[] args)throws IOException{
        init();
        createTable("my_ns:teacher123",new String[]{"score","info"});
        close();
    }
    //建立连接
    public static void init(){
        configuration  = HBaseConfiguration.create();
        configuration.set("hbase.rootdir","hdfs://master:8020/hbase");
        try{
            connection = ConnectionFactory.createConnection(configuration);
            admin = connection.getAdmin();
        }catch (IOException e){
            e.printStackTrace();
        }
    }
    // 关闭连接
    public static void close() {
        try {
            if (admin != null) {
                admin.close();
            }
            if (null != connection) {
                connection.close();
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    //创建表
    public static void createTable(String myTableName,String[] colFamily) throws IOException {
        TableName tableName = TableName.valueOf(myTableName);
        if(admin.tableExists(tableName)){
            System.out.println("talbe is exists!");
        }else {
            TableDescriptorBuilder tableDescriptor = TableDescriptorBuilder.newBuilder(tableName);
            for(String str:colFamily){
                ColumnFamilyDescriptor family =
                        ColumnFamilyDescriptorBuilder.newBuilder(Bytes.toBytes(str)).build();
                tableDescriptor.setColumnFamily(family);
            }
            admin.createTable(tableDescriptor.build());
        }
    }
}


</code></pre> 
<p></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/59df86eb2c9765a79ff1a8c779db6c8c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【MATLAB】史上最全的13种数据拟合算法全家桶</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9ed1c69fbfbf71b9ca01d81033e7be43/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Oracle中decode函数详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>