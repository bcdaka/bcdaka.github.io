<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Linux[高级管理]——Squid代理服务器的部署和应用(传统模式详解) - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/72e7476b2a975768ef403faad6755de6/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Linux[高级管理]——Squid代理服务器的部署和应用(传统模式详解)">
  <meta property="og:description" content="🏡作者主页：点击！ 👨‍💻Linux高级管理专栏：点击！
⏰️创作时间：2024年6月24日11点11分
🀄️文章质量：95分
目录
————前言————
Squid功能
Squid的几种模式
1. 传统模式
2. 透明模式
3. 反向代理模式
外网服务器
代理服务器
客户端
测试
————前言———— Squid是一种高性能的代理缓存服务器，用于改善网络性能、提供缓存服务以及增强网络安全性。它在企业网络和互联网服务提供商中广泛使用，尤其适用于加速web访问、减少带宽使用和提高网络访问控制。下面是Squid代理服务器的详细介绍，包括其功能、部署和应用。
第一篇：Squid代理服务器的部署和应用(传统模式详解)
第二篇：Squid代理服务器的部署和应用(透明模式详解）
第三篇：Squid代理服务器的部署和应用(反向代理详解)
按着顺序观看效果更好
Squid功能 缓存管理：Squid能够缓存频繁访问的网页内容，从而减少对原始服务器的请求次数，降低带宽消耗并加快用户的访问速度。
访问控制：提供强大的访问控制列表（ACL）功能，可以基于IP地址、时间、URL等条件来控制用户的访问权限。
内容过滤：通过配置，可以过滤不良网站、限制访问某些类型的内容，提高网络使用的安全性。
负载均衡：支持多个上游代理的负载均衡，提升代理服务的可靠性和性能。
日志记录：详细记录用户的访问日志，方便管理员进行审计和分析。
Squid的几种模式 Squid代理服务器可以部署在多种模式下，以满足不同的网络需求。下面是对Squid三种主要模式的介绍：传统模式、透明模式和反向代理模式。
1. 传统模式 传统模式（Forward Proxy）是最常见的代理模式，客户端显式地将请求发送到Squid代理服务器，由代理服务器转发请求到目标服务器，并将响应返回给客户端。
特点：
客户端需要配置代理服务器的IP地址和端口。主要用于缓存和访问控制。常用于网络加速、带宽优化以及网络访问控制。 2. 透明模式 透明模式（Transparent Proxy）允许客户端无需配置代理设置，所有的流量通过网络设备（如路由器或防火墙）自动重定向到Squid代理服务器。
特点：
客户端无需配置代理服务器。常用于企业网络以便无缝管理和控制网络流量。配置相对复杂，需要配合网络设备（如iptables或思科设备）。 3. 反向代理模式 反向代理模式（Reverse Proxy），也称为Web加速器模式，Squid代理服务器位于客户端和Web服务器之间，客户端请求被转发到代理服务器，再由代理服务器请求实际的Web服务器。通常用于加速Web应用和负载均衡。
特点：
客户端请求无感知代理存在。提供Web服务器的缓存和负载均衡服务。常用于提高Web服务器的性能和可靠性。 本次实验讲解传统模式的代理方式
实验环境
一台服务器模拟外网服务器搭建web服务 IP地址 100.0.0.2 24
一台服务器作为squid代理服务器 两块网卡 ens33 192.168.192.111 24 ens36 100.0.0.1 24
一台win7作为客户端
实验要求 win7通过squid代理服务器来访问外网web服务
注释：以上均关闭 防火墙 selinux">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-01T12:11:00+08:00">
    <meta property="article:modified_time" content="2024-07-01T12:11:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Linux[高级管理]——Squid代理服务器的部署和应用(传统模式详解)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="text-align:center;"><img alt="" height="80" src="https://images2.imgbox.com/43/8c/zCPzcMFQ_o.gif" width="640"></p> 
<p style="text-align:center;"><strong>🏡作者主页：<a href="https://blog.csdn.net/jxjdhdnd?type=blog" title="点击！">点击！</a> </strong></p> 
<p style="text-align:center;"><strong>👨‍💻</strong><strong>Linux高级管理专栏：<a href="http://t.csdnimg.cn/vSzgD" rel="nofollow" title="点击！">点击！</a></strong></p> 
<p style="text-align:center;"><strong>⏰️创作时间：2024年6月24日11点11分</strong></p> 
<p style="text-align:center;"><strong>🀄️文章质量：95分</strong></p> 
<p style="text-align:center;"><img alt="" height="80" src="https://images2.imgbox.com/9e/c5/FQXPet7m_o.gif" width="640"></p> 
<hr> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E5%89%8D%E8%A8%80%E2%80%94%E2%80%94%E2%80%94%E2%80%94-toc" style="margin-left:40px;"><a href="#%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E5%89%8D%E8%A8%80%E2%80%94%E2%80%94%E2%80%94%E2%80%94" rel="nofollow">————前言————</a></p> 
<p id="Squid%E5%8A%9F%E8%83%BD-toc" style="margin-left:80px;"><a href="#Squid%E5%8A%9F%E8%83%BD" rel="nofollow">Squid功能</a></p> 
<p id="Squid%E7%9A%84%E5%87%A0%E7%A7%8D%E6%A8%A1%E5%BC%8F-toc" style="margin-left:80px;"><a href="#Squid%E7%9A%84%E5%87%A0%E7%A7%8D%E6%A8%A1%E5%BC%8F" rel="nofollow">Squid的几种模式</a></p> 
<p id="1.%20%E4%BC%A0%E7%BB%9F%E6%A8%A1%E5%BC%8F-toc" style="margin-left:120px;"><a href="#1.%20%E4%BC%A0%E7%BB%9F%E6%A8%A1%E5%BC%8F" rel="nofollow">1. 传统模式</a></p> 
<p id="2.%20%E9%80%8F%E6%98%8E%E6%A8%A1%E5%BC%8F-toc" style="margin-left:120px;"><a href="#2.%20%E9%80%8F%E6%98%8E%E6%A8%A1%E5%BC%8F" rel="nofollow">2. 透明模式</a></p> 
<p id="3.%20%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F-toc" style="margin-left:120px;"><a href="#3.%20%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F" rel="nofollow">3. 反向代理模式</a></p> 
<p id="%E5%A4%96%E7%BD%91%E6%9C%8D%E5%8A%A1%E5%99%A8-toc" style="margin-left:80px;"><a href="#%E5%A4%96%E7%BD%91%E6%9C%8D%E5%8A%A1%E5%99%A8" rel="nofollow">外网服务器</a></p> 
<p id="%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8-toc" style="margin-left:80px;"><a href="#%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8" rel="nofollow">代理服务器</a></p> 
<p id="%E5%AE%A2%E6%88%B7%E7%AB%AF-toc" style="margin-left:80px;"><a href="#%E5%AE%A2%E6%88%B7%E7%AB%AF" rel="nofollow">客户端</a></p> 
<p id="%E6%B5%8B%E8%AF%95-toc" style="margin-left:80px;"><a href="#%E6%B5%8B%E8%AF%95" rel="nofollow">测试</a></p> 
<hr id="hr-toc"> 
<p></p> 
<p></p> 
<h3 id="%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E5%89%8D%E8%A8%80%E2%80%94%E2%80%94%E2%80%94%E2%80%94" style="text-align:center;"><strong>————前言————</strong></h3> 
<p>Squid是一种高性能的代理缓存服务器，用于改善网络性能、提供缓存服务以及增强网络安全性。它在企业网络和互联网服务提供商中广泛使用，尤其适用于加速web访问、减少带宽使用和提高网络访问控制。下面是Squid代理服务器的详细介绍，包括其功能、部署和应用。</p> 
<p></p> 
<p>第一篇：<a class="link-info" href="http://t.csdnimg.cn/K7xc2" rel="nofollow" title="Squid代理服务器的部署和应用(传统模式详解)">Squid代理服务器的部署和应用(传统模式详解)</a></p> 
<p>第二篇：<a class="link-info" href="http://t.csdnimg.cn/bJWll" rel="nofollow" title="Squid代理服务器的部署和应用(透明模式详解）">Squid代理服务器的部署和应用(透明模式详解）</a></p> 
<p>第三篇：<a class="link-info" href="http://t.csdnimg.cn/By8Tz" rel="nofollow" title="Squid代理服务器的部署和应用(反向代理详解)">Squid代理服务器的部署和应用(反向代理详解)</a></p> 
<p>按着顺序观看效果更好</p> 
<p></p> 
<p></p> 
<h4 id="Squid%E5%8A%9F%E8%83%BD">Squid功能</h4> 
<ol><li> <p><strong>缓存管理</strong>：Squid能够缓存频繁访问的网页内容，从而减少对原始服务器的请求次数，降低带宽消耗并加快用户的访问速度。</p> </li><li> <p><strong>访问控制</strong>：提供强大的访问控制列表（ACL）功能，可以基于IP地址、时间、URL等条件来控制用户的访问权限。</p> </li><li> <p><strong>内容过滤</strong>：通过配置，可以过滤不良网站、限制访问某些类型的内容，提高网络使用的安全性。</p> </li><li> <p><strong>负载均衡</strong>：支持多个上游代理的负载均衡，提升代理服务的可靠性和性能。</p> </li><li> <p><strong>日志记录</strong>：详细记录用户的访问日志，方便管理员进行审计和分析。</p> </li></ol> 
<p></p> 
<p></p> 
<h4 id="Squid%E7%9A%84%E5%87%A0%E7%A7%8D%E6%A8%A1%E5%BC%8F">Squid的几种模式</h4> 
<p>Squid代理服务器可以部署在多种模式下，以满足不同的网络需求。下面是对Squid三种主要模式的介绍：传统模式、透明模式和反向代理模式。</p> 
<p></p> 
<h5 id="1.%20%E4%BC%A0%E7%BB%9F%E6%A8%A1%E5%BC%8F"><span style="color:#fe2c24;"><span style="background-color:#fbd4d0;">1. 传统模式</span></span></h5> 
<p><span style="color:#fe2c24;"><strong><span style="background-color:#fbd4d0;">传统模式（Forward Proxy）</span></strong><span style="background-color:#fbd4d0;">是最常见的代理模式，客户端显式地将请求发送到Squid代理服务器，由代理服务器转发请求到目标服务器，并将响应返回给客户端。</span></span></p> 
<p><span style="color:#fe2c24;"><strong><span style="background-color:#fbd4d0;">特点：</span></strong></span></p> 
<ul><li><span style="color:#fe2c24;"><span style="background-color:#fbd4d0;">客户端需要配置代理服务器的IP地址和端口。</span></span></li><li><span style="color:#fe2c24;"><span style="background-color:#fbd4d0;">主要用于缓存和访问控制。</span></span></li><li><span style="color:#fe2c24;"><span style="background-color:#fbd4d0;">常用于网络加速、带宽优化以及网络访问控制。</span></span></li></ul> 
<p></p> 
<h5 id="2.%20%E9%80%8F%E6%98%8E%E6%A8%A1%E5%BC%8F">2. 透明模式</h5> 
<p><strong>透明模式（Transparent Proxy</strong>）允许客户端无需配置代理设置，所有的流量通过网络设备（如路由器或防火墙）自动重定向到Squid代理服务器。</p> 
<p><strong>特点：</strong></p> 
<ul><li>客户端无需配置代理服务器。</li><li>常用于企业网络以便无缝管理和控制网络流量。</li><li>配置相对复杂，需要配合网络设备（如iptables或思科设备）。</li></ul> 
<p></p> 
<h5 id="3.%20%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F">3. 反向代理模式</h5> 
<p><strong>反向代理模式（Reverse Proxy）</strong>，也称为Web加速器模式，Squid代理服务器位于客户端和Web服务器之间，客户端请求被转发到代理服务器，再由代理服务器请求实际的Web服务器。通常用于加速Web应用和负载均衡。</p> 
<p><strong>特点：</strong></p> 
<ul><li>客户端请求无感知代理存在。</li><li>提供Web服务器的缓存和负载均衡服务。</li><li>常用于提高Web服务器的性能和可靠性。</li></ul> 
<p></p> 
<p></p> 
<p><span style="color:#fe2c24;"><span style="background-color:#fbd4d0;">本次实验讲解传统模式的代理方式</span></span></p> 
<p></p> 
<p>实验环境</p> 
<p><span style="color:#fe2c24;">一台服务器模拟外网服务器搭建web服务        IP地址 100.0.0.2 24</span></p> 
<p><span style="color:#fe2c24;">一台服务器作为squid代理服务器                </span></p> 
<p><span style="color:#fe2c24;">两块网卡 ens33 192.168.192.111 24        ens36 100.0.0.1 24</span></p> 
<p></p> 
<p>一台win7作为客户端</p> 
<p><span style="color:#fe2c24;">实验要求 win7通过squid代理服务器来访问外网web服务</span></p> 
<p>注释：以上均关闭 防火墙 selinux</p> 
<p></p> 
<h4 id="%E5%A4%96%E7%BD%91%E6%9C%8D%E5%8A%A1%E5%99%A8">外网服务器</h4> 
<p>安装httpd</p> 
<pre><code>安装httpd
yum install -y httpd</code></pre> 
<p>关闭防火墙 selinux</p> 
<p></p> 
<p>给网页添加内容</p> 
<pre><code>echo smqnz &gt; /var/www/html/index.html</code></pre> 
<p><img alt="" height="118" src="https://images2.imgbox.com/55/4e/TV9lsHRH_o.png" width="788"></p> 
<p></p> 
<p>网络配置</p> 
<p>模拟外网的环境</p> 
<p><img alt="" height="477" src="https://images2.imgbox.com/da/8c/qgbHWdcv_o.png" width="1022"></p> 
<p>配置编辑他的IP地址</p> 
<p><img alt="" height="304" src="https://images2.imgbox.com/13/c8/ClqrwFSl_o.png" width="480"></p> 
<p></p> 
<p></p> 
<p></p> 
<h4 id="%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8">代理服务器</h4> 
<p>首先用本地的IP地址连接Xshell 上传安装文件</p> 
<p><img alt="" height="128" src="https://images2.imgbox.com/62/a6/T0lkKTC2_o.png" width="590"></p> 
<p></p> 
<p></p> 
<p>网络环境</p> 
<p><span style="color:#fe2c24;"><span style="background-color:#fbd4d0;">ens33 192.168.192.111</span></span></p> 
<p><span style="color:#fe2c24;"><span style="background-color:#fbd4d0;">ens36 100.0.0.1</span></span></p> 
<p><img alt="" height="440" src="https://images2.imgbox.com/bb/d1/IUrcAUby_o.png" width="679"></p> 
<p>修改ens36IP地址</p> 
<pre><code>[root@localhost yum.repos.d]# cd /etc/sysconfig/network-scripts/
[root@localhost network-scripts]# cp -p ifcfg-ens33 ifcfg-ens36
vim ifcfg-ens36</code></pre> 
<p><img alt="" height="204" src="https://images2.imgbox.com/ad/bd/uOfEFWYd_o.png" width="400"></p> 
<p></p> 
<p></p> 
<p>安装下载的组件</p> 
<pre><code>[root@localhost ~]# yum install -y gcc gcc-c++</code></pre> 
<p>tar zxf 解压安装包</p> 
<pre><code>tar zxvf squid-3.5.23.tar.gz
cd squid-3.5.23/
</code></pre> 
<p>编译安装</p> 
<p><span style="color:#fe2c24;">我这边空行是因为方便大家观看 我建议你把所有选项 放到txt 文档中整理之后在copy 执行</span></p> 
<pre><code>./configure  --prefix=/usr/local/squid --sysconfdir=/etc 
--enable-linux-netfilter --enable-async-io=240 --enable-default-err-language=Simplify_Chinese --disable-poll --enable-epoll 
--enable-gnuregex
make &amp;&amp; make install
编译安装</code></pre> 
<p></p> 
<p>修改系统配置以启用IP转发</p> 
<pre><code>vim /etc/sysctl.conf
net.ipv4.ip_forward = 1</code></pre> 
<p><img alt="" height="252" src="https://images2.imgbox.com/fc/99/GgMXtZh7_o.png" width="761"></p> 
<p></p> 
<pre><code>ln -s /usr/local/squid/sbin/* /usr/local/sbin/</code></pre> 
<ul><li>将Squid的可执行文件链接到系统的标准可执行路径中，方便使用命令运行Squid。</li></ul> 
<pre><code>useradd -M -s /sbin/nologin squid</code></pre> 
<ul><li>创建一个专门用于运行Squid服务的用户，以提高系统安全性。</li></ul> 
<pre><code>chmod 777 /usr/local/squid/var/logs/</code></pre> 
<ul><li>为Squid的日志目录设置权限，以确保Squid进程能够写入日志文件。</li></ul> 
<p></p> 
<p>开启Squid服务并查看</p> 
<pre><code>squid	开启服务

[root@localhost squid-3.5.23]# netstat -nultp | grep squid
tcp6       0      0 :::3128                 :::*                    LISTEN      56706/(squid-1)     
udp        0      0 0.0.0.0:52440           0.0.0.0:*                           56706/(squid-1)     
udp6       0      0 :::60903                :::*                                56706/(squi
</code></pre> 
<p>如图所示</p> 
<p>看着我操作的图片 </p> 
<p><img alt="" height="247" src="https://images2.imgbox.com/dc/f7/R89f83jw_o.png" width="793"></p> 
<p></p> 
<p></p> 
<h4 id="%E5%AE%A2%E6%88%B7%E7%AB%AF">客户端</h4> 
<p>win7测试</p> 
<p><span style="color:#fe2c24;"><span style="background-color:#fbd4d0;">关闭防火墙</span></span></p> 
<p><span style="color:#fe2c24;"><span style="background-color:#fbd4d0;">IP地址是 192.168.192.130</span></span></p> 
<p><img alt="" height="265" src="https://images2.imgbox.com/fc/63/S6ocUwHH_o.png" width="400"></p> 
<p></p> 
<p><img alt="" height="262" src="https://images2.imgbox.com/c7/4c/nuwhHZjo_o.png" width="400"></p> 
<p></p> 
<p><span style="color:#fe2c24;"><span style="background-color:#fbd4d0;">将浏览器Internet属性中的链接局域网设置 代理服务器指向 192.168.192.111 的3128端口</span></span></p> 
<p><span style="color:#fe2c24;"><span style="background-color:#fbd4d0;">也就是代理服务器指向你 squid服务器的 ens33的ip地址</span></span></p> 
<p><img alt="" height="379" src="https://images2.imgbox.com/51/bd/B02UbpSH_o.png" width="500"></p> 
<h4 id="%E6%B5%8B%E8%AF%95">测试</h4> 
<p>访问模拟的外网web服务器</p> 
<p><img alt="" height="320" src="https://images2.imgbox.com/29/e0/O8ZIw2lC_o.png" width="707"></p> 
<p>成功显示smqnz的内容 访问成功</p> 
<p></p> 
<p>外网服务器查看</p> 
<p>查看httpd的日志</p> 
<p><img alt="" height="202" src="https://images2.imgbox.com/95/f2/9XWxm6FK_o.png" width="789"></p> 
<p>可以看出是100.0.0.1 访问的 web服务器 也就是win7通过squid代理服务器访问的web服务器</p> 
<p>实验成功</p> 
<p></p> 
<p></p> 
<blockquote> 
 <p><span style="color:#fe2c24;"><span style="background-color:#fbd4d0;"> "成功的路上没有捷径，只有不断的努力与坚持。如果你和我一样，坚信努力会带来回报，请关注我，点个赞，一起迎接更加美好的明天！你的支持是我继续前行的动力！"</span></span></p> 
 <p></p> 
 <p>"每一次创作都是一次学习的过程，文章中若有不足之处，还请大家多多包容。你的关注和点赞是对我最大的支持，也欢迎大家提出宝贵的意见和建议，让我不断进步。"</p> 
 <p></p> 
 <p style="text-align:center;">神秘泣男子</p> 
 <p style="text-align:center;"><img alt="" height="289" src="https://images2.imgbox.com/ae/54/qzuKKqlD_o.png" width="296"></p> 
</blockquote> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/402b5cafbabad33f5e173cdb9e88c444/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Spring Data与多数据源配置</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b596e51aa0707f7b8b44e43aefab99ba/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux[高级管理]——Squid代理服务器的部署和应用(反向代理详解)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>