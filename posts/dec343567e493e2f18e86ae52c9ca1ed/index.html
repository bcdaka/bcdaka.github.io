<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Javascriptâ€”â€”asyncã€awaitè¯¦è§£ - ç¼–ç¨‹å¤§å’–</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/dec343567e493e2f18e86ae52c9ca1ed/">
  <meta property="og:site_name" content="ç¼–ç¨‹å¤§å’–">
  <meta property="og:title" content="Javascriptâ€”â€”asyncã€awaitè¯¦è§£">
  <meta property="og:description" content="ä¸€ã€asyncã€awaitæ˜¯ä»€ä¹ˆï¼Ÿ asyncç”¨äºç”³æ˜ä¸€ä¸ªfunctionæ˜¯å¼‚æ­¥çš„ï¼› è€Œawaitåˆ™å¯ä»¥è®¤ä¸ºæ˜¯ async awaitçš„ç®€å†™å½¢å¼ï¼Œæ˜¯ç­‰å¾…ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•æ‰§è¡Œå®Œæˆçš„ã€‚ **asyncå‡½æ•°** é€šè¿‡åœ¨å‡½æ•°å£°æ˜å‰åŠ ä¸Šasyncå…³é”®å­—ï¼Œå¯ä»¥å°†ä»»ä½•å‡½æ•°è½¬æ¢ä¸ºè¿”å›Promiseçš„å¼‚æ­¥å‡½æ•°ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨.then()å’Œ.catch()æ¥å¤„ç†å®ƒä»¬çš„ç»“æœã€‚ åˆ›å»ºä¸€ä¸ªasyncå‡½æ•°
async function asyncFunction() { return &#34;å¼‚æ­¥æ“ä½œå®Œæˆ&#34;; } asyncFunction().then(value =&gt; console.log(value)); // è¾“å‡ºï¼šå¼‚æ­¥æ“ä½œå®Œæˆ awaitå…³é”®å­—åªèƒ½åœ¨asyncå‡½æ•°å†…éƒ¨ä½¿ç”¨ã€‚å®ƒå¯ä»¥æš‚åœasyncå‡½æ•°çš„æ‰§è¡Œï¼Œç­‰å¾…Promiseçš„è§£å†³ï¼ˆresolveï¼‰ï¼Œç„¶åä»¥Promiseçš„å€¼ç»§ç»­æ‰§è¡Œå‡½æ•°ã€‚
åœ¨asyncå‡½æ•°ä¸­ä½¿ç”¨await
async function asyncFunction() { let promise = new Promise((resolve, reject) =&gt; { setTimeout(() =&gt; resolve(&#34;å®Œæˆ&#34;), 1000) }); let result = await promise; // ç­‰å¾…ï¼Œç›´åˆ°promiseè§£å†³ (resolve) console.log(result); // &#34;å®Œæˆ&#34; } asyncFunction(); äºŒã€async/awaitçš„ç‰¹ç‚¹ 1ã€Asyncä½œä¸ºå…³é”®å­—æ”¾åœ¨å‡½æ•°å‰é¢ï¼Œæ™®é€šå‡½æ•°å˜æˆäº†å¼‚æ­¥å‡½æ•° 2ã€å¼‚æ­¥å‡½æ•°asyncå‡½æ•°è°ƒç”¨ï¼Œè·Ÿæ™®é€šå‡½æ•°è°ƒç”¨æ–¹å¼ä¸€æ ·ã€‚åœ¨ä¸€ä¸ªå‡½æ•°å‰é¢åŠ ä¸Šasyncï¼Œå˜æˆ asyncå‡½æ•°ï¼Œå¼‚æ­¥å‡½æ•°ï¼Œreturn:1ï¼Œæ‰“å°è¿”å›å€¼ï¼Œ 3ã€è¿”å›çš„æ˜¯promiseæˆåŠŸçš„å¯¹è±¡ï¼Œ 4ã€Asyncå‡½æ•°é…åˆawaitå…³é”®å­—ä½¿ç”¨ é”™è¯¯å¤„ç†
åœ¨async/awaitä¸­ï¼Œé”™è¯¯å¤„ç†å¯ä»¥é€šè¿‡ä¼ ç»Ÿçš„tryâ€¦catchè¯­å¥å®ç°ï¼Œè¿™ä½¿å¾—å¼‚æ­¥ä»£ç çš„é”™è¯¯å¤„ç†æ›´åŠ ç›´è§‚ã€‚
ä»£ç ç¤ºä¾‹ï¼šä½¿ç”¨try...catchå¤„ç†é”™è¯¯ async function asyncFunction() { try { let response = await fetch(&#39;http://example.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-11T10:27:13+08:00">
    <meta property="article:modified_time" content="2024-03-11T10:27:13+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§å’–" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§å’–</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Javascriptâ€”â€”asyncã€awaitè¯¦è§£</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="asyncawait_0"></a>ä¸€ã€asyncã€awaitæ˜¯ä»€ä¹ˆï¼Ÿ</h3> 
<pre><code class="prism language-javascript"><span class="token keyword">async</span>ç”¨äºç”³æ˜ä¸€ä¸ª<span class="token keyword">function</span>æ˜¯å¼‚æ­¥çš„ï¼›
è€Œ<span class="token keyword">await</span>åˆ™å¯ä»¥è®¤ä¸ºæ˜¯ <span class="token keyword">async</span> <span class="token keyword">await</span>çš„ç®€å†™å½¢å¼ï¼Œæ˜¯ç­‰å¾…ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•æ‰§è¡Œå®Œæˆçš„ã€‚

<span class="token operator">**</span><span class="token keyword">async</span>å‡½æ•°<span class="token operator">**</span>
é€šè¿‡åœ¨å‡½æ•°å£°æ˜å‰åŠ ä¸Š<span class="token keyword">async</span>å…³é”®å­—ï¼Œå¯ä»¥å°†ä»»ä½•å‡½æ•°è½¬æ¢ä¸ºè¿”å›Promiseçš„å¼‚æ­¥å‡½æ•°ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">)</span>å’Œ<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>æ¥å¤„ç†å®ƒä»¬çš„ç»“æœã€‚
</code></pre> 
<p><strong>åˆ›å»ºä¸€ä¸ªasyncå‡½æ•°</strong></p> 
<pre><code class="prism language-javascript"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">asyncFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> <span class="token string">"å¼‚æ­¥æ“ä½œå®Œæˆ"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">asyncFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¾“å‡ºï¼šå¼‚æ­¥æ“ä½œå®Œæˆ</span>

</code></pre> 
<p><strong>awaitå…³é”®å­—åªèƒ½åœ¨asyncå‡½æ•°å†…éƒ¨ä½¿ç”¨ã€‚å®ƒå¯ä»¥æš‚åœasyncå‡½æ•°çš„æ‰§è¡Œï¼Œç­‰å¾…Promiseçš„è§£å†³ï¼ˆresolveï¼‰ï¼Œç„¶åä»¥Promiseçš„å€¼ç»§ç»­æ‰§è¡Œå‡½æ•°ã€‚</strong><br> <strong>åœ¨asyncå‡½æ•°ä¸­ä½¿ç”¨await</strong></p> 
<pre><code class="prism language-javascript"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">asyncFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">let</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">"å®Œæˆ"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> promise<span class="token punctuation">;</span> <span class="token comment">// ç­‰å¾…ï¼Œç›´åˆ°promiseè§£å†³ (resolve)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "å®Œæˆ"</span>
<span class="token punctuation">}</span>
<span class="token function">asyncFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="asyncawait_33"></a>äºŒã€async/awaitçš„ç‰¹ç‚¹</h3> 
<pre><code class="prism language-javascript"><span class="token number">1</span>ã€Asyncä½œä¸ºå…³é”®å­—æ”¾åœ¨å‡½æ•°å‰é¢ï¼Œæ™®é€šå‡½æ•°å˜æˆäº†å¼‚æ­¥å‡½æ•°
<span class="token number">2</span>ã€å¼‚æ­¥å‡½æ•°<span class="token keyword">async</span>å‡½æ•°è°ƒç”¨ï¼Œè·Ÿæ™®é€šå‡½æ•°è°ƒç”¨æ–¹å¼ä¸€æ ·ã€‚åœ¨ä¸€ä¸ªå‡½æ•°å‰é¢åŠ ä¸Š<span class="token keyword">async</span>ï¼Œå˜æˆ <span class="token keyword">async</span>å‡½æ•°ï¼Œå¼‚æ­¥å‡½æ•°ï¼Œ<span class="token keyword">return</span><span class="token operator">:</span><span class="token number">1</span>ï¼Œæ‰“å°è¿”å›å€¼ï¼Œ
<span class="token number">3</span>ã€è¿”å›çš„æ˜¯promiseæˆåŠŸçš„å¯¹è±¡ï¼Œ
<span class="token number">4</span>ã€Asyncå‡½æ•°é…åˆ<span class="token keyword">await</span>å…³é”®å­—ä½¿ç”¨
</code></pre> 
<p><strong>é”™è¯¯å¤„ç†</strong><br> åœ¨async/awaitä¸­ï¼Œé”™è¯¯å¤„ç†å¯ä»¥é€šè¿‡ä¼ ç»Ÿçš„tryâ€¦catchè¯­å¥å®ç°ï¼Œè¿™ä½¿å¾—å¼‚æ­¥ä»£ç çš„é”™è¯¯å¤„ç†æ›´åŠ ç›´è§‚ã€‚</p> 
<pre><code class="prism language-javascript">ä»£ç ç¤ºä¾‹ï¼šä½¿ç”¨<span class="token keyword">try</span><span class="token operator">...</span>catchå¤„ç†é”™è¯¯

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">asyncFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://example.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å¤„ç†æ•°æ®</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ•è·åˆ°é”™è¯¯ï¼š'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">asyncFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<p><strong>ä¸¾ä¸ªğŸŒ°</strong><br> æ¨¡æ‹Ÿå‡ºä¸€ä¸ªæ‘‡è‰²å­çš„å¼‚æ­¥æ“ä½œï¼Œå…ˆé€šè¿‡ä¸€ä¸ªæ–¹æ³•ä¸‰ç§’ä¹‹åæ‹¿åˆ°ä¸€ä¸ªç­›å­æ•°ï¼Œç¬¬äºŒæ­¥è¿›è¡Œè¾“å‡º</p> 
<pre><code class="prism language-javascript"><span class="token comment">//åŸºæœ¬ç”¨æ³•çš„asyncå‡½æ•°</span>
<span class="token keyword">let</span> <span class="token function-variable function">asyncFun</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">asyncFun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">//ä¼šè¿”å›ä¸€ä¸ªpromiseå¯¹è±¡</span>


<span class="token comment">//ä½¿ç”¨åœºæ™¯</span>
<span class="token comment">//æ‘‡è‰²å­æ–¹æ³•</span>
<span class="token keyword">function</span> <span class="token function">dice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">let</span> sino <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">6</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment">//ç”Ÿæˆä¸€ä¸ª1~6ä¹‹é—´çš„éšæœºå°æ•°</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
            <span class="token function">resolve</span><span class="token punctuation">(</span>sino<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>


<span class="token comment">//å¼‚æ­¥æ–¹æ³•</span>
 <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
     <span class="token keyword">let</span> n<span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">dice</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token comment">//await å…³é”®å­—åé¢è°ƒç”¨æ‘‡è‰²å­æ–¹æ³•æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œæ‰è¿›è¡Œå˜é‡èµ‹å€¼</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"æ‘‡å‡ºæ¥"</span><span class="token operator">+</span>n<span class="token punctuation">)</span>  <span class="token comment">//æœ€åæ‰“å°å‡ºæ‘‡å‡ºæ¥çš„æ•°</span>
 <span class="token punctuation">}</span>
<span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="asyncawait_93"></a>ä¸‰ã€async/awaitçš„ä¼˜ç‚¹</h3> 
<pre><code class="prism language-javascript"><span class="token number">1.</span>æ–¹ä¾¿çº§è”è°ƒç”¨ï¼šå³è°ƒç”¨ä¾æ¬¡å‘ç”Ÿçš„åœºæ™¯ï¼›
<span class="token number">2.</span><span class="token literal-property property">åŒæ­¥ä»£ç ç¼–å†™æ–¹å¼</span><span class="token operator">:</span>Promiseä½¿ç”¨thenå‡½æ•°è¿›è¡Œé“¾å¼è°ƒç”¨ï¼Œä¸€ç›´ç‚¹ç‚¹ç‚¹ï¼Œæ˜¯ä¸€ç§ä»å·¦å‘å³çš„æ¨ªå‘å†™æ³•ï¼›async<span class="token operator">/</span><span class="token keyword">await</span>ä»ä¸Šåˆ°ä¸‹ï¼Œé¡ºåºæ‰§è¡Œï¼Œå°±åƒå†™åŒæ­¥ä»£ç ä¸€æ ·ï¼Œæ›´ç¬¦åˆä»£ç ç¼–å†™ä¹ æƒ¯ï¼›
<span class="token number">3.</span><span class="token literal-property property">å¤šä¸ªå‚æ•°ä¼ é€’</span><span class="token operator">:</span>Promiseçš„thenå‡½æ•°åªèƒ½ä¼ é€’ä¸€ä¸ªå‚æ•°ï¼Œè™½ç„¶å¯ä»¥é€šè¿‡åŒ…è£…æˆå¯¹è±¡æ¥ä¼ é€’å¤šä¸ªå‚æ•°ï¼Œä½†æ˜¯ä¼šå¯¼è‡´ä¼ é€’å†—ä½™ä¿¡æ¯ï¼Œé¢‘ç¹çš„è§£æåˆé‡æ–°ç»„åˆå‚æ•°ï¼Œæ¯”è¾ƒéº»çƒ¦ï¼›async<span class="token operator">/</span><span class="token keyword">await</span>æ²¡æœ‰è¿™ä¸ªé™åˆ¶ï¼Œå¯ä»¥å½“åšæ™®é€šçš„å±€éƒ¨å˜é‡æ¥å¤„ç†ï¼Œç”¨<span class="token keyword">let</span>æˆ–è€…<span class="token keyword">const</span>å®šä¹‰çš„å—çº§å˜é‡æƒ³æ€ä¹ˆç”¨å°±æ€ä¹ˆç”¨ï¼Œæƒ³å®šä¹‰å‡ ä¸ªå°±å®šä¹‰å‡ ä¸ªï¼Œå®Œå…¨æ²¡æœ‰é™åˆ¶ï¼Œä¹Ÿæ²¡æœ‰å†—ä½™å·¥ä½œï¼›
<span class="token number">4.</span><span class="token literal-property property">åŒæ­¥ä»£ç å’Œå¼‚æ­¥ä»£ç å¯ä»¥ä¸€èµ·ç¼–å†™</span><span class="token operator">:</span>ä½¿ç”¨Promiseçš„æ—¶å€™æœ€å¥½å°†åŒæ­¥ä»£ç å’Œå¼‚æ­¥ä»£ç æ”¾åœ¨ä¸åŒçš„thenèŠ‚ç‚¹ä¸­ï¼Œè¿™æ ·ç»“æ„æ›´åŠ æ¸…æ™°ï¼›async<span class="token operator">/</span><span class="token keyword">await</span>æ•´ä¸ªä¹¦å†™ä¹ æƒ¯éƒ½æ˜¯åŒæ­¥çš„ï¼Œä¸éœ€è¦çº ç»“åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«ï¼Œå½“ç„¶ï¼Œå¼‚æ­¥è¿‡ç¨‹éœ€è¦åŒ…è£…æˆä¸€ä¸ªPromiseå¯¹è±¡æ”¾åœ¨<span class="token keyword">await</span>å…³é”®å­—åé¢ï¼›
<span class="token number">5.</span><span class="token literal-property property">åŸºäºåç¨‹</span><span class="token operator">:</span>Promiseæ˜¯æ ¹æ®å‡½æ•°å¼ç¼–ç¨‹çš„èŒƒå¼ï¼Œå¯¹å¼‚æ­¥è¿‡ç¨‹è¿›è¡Œäº†ä¸€å±‚å°è£…ï¼Œasync<span class="token operator">/</span><span class="token keyword">await</span>åŸºäºåç¨‹çš„æœºåˆ¶ï¼Œæ˜¯çœŸæ­£çš„â€œä¿å­˜ä¸Šä¸‹æ–‡ï¼Œæ§åˆ¶æƒåˆ‡æ¢â€¦â€¦æ§åˆ¶æƒæ¢å¤ï¼Œå–å›ä¸Šä¸‹æ–‡â€è¿™ç§æœºåˆ¶ï¼Œæ˜¯å¯¹å¼‚æ­¥è¿‡ç¨‹æ›´ç²¾ç¡®çš„ä¸€ç§æè¿°ï¼›
<span class="token number">6</span><span class="token punctuation">.</span>async<span class="token operator">/</span><span class="token keyword">await</span><span class="token literal-property property">æ˜¯å¯¹Promiseçš„ä¼˜åŒ–</span><span class="token operator">:</span>async<span class="token operator">/</span><span class="token keyword">await</span>æ˜¯åŸºäºPromiseçš„ï¼Œæ˜¯è¿›ä¸€æ­¥çš„ä¸€ç§ä¼˜åŒ–ï¼Œä¸è¿‡åœ¨å†™ä»£ç æ—¶ï¼ŒPromiseæœ¬èº«çš„<span class="token constant">API</span>å‡ºç°å¾—å¾ˆå°‘ï¼Œå¾ˆæ¥è¿‘åŒæ­¥ä»£ç çš„å†™æ³•
</code></pre> 
<h3><a id="async_103"></a>å››ã€asyncä¸»è¦æ¥å¤„ç†å¼‚æ­¥çš„æ“ä½œï¼Œ</h3> 
<p>éœ€æ±‚ï¼šæ‰§è¡Œç¬¬ä¸€æ­¥ï¼Œå°†æ‰§è¡Œç¬¬ä¸€æ­¥çš„ç»“æœè¿”å›ç»™ç¬¬äºŒæ­¥ä½¿ç”¨ã€‚åœ¨ajaxä¸­å…ˆæ‹¿åˆ°ä¸€ä¸ªæ¥å£çš„è¿”å›æ•°æ®ï¼Œåä½¿ç”¨ç¬¬ä¸€éƒ¨è¿”å›çš„æ•°æ®æ‰§è¡Œç¬¬äºŒæ­¥æ“ä½œçš„æ¥å£è°ƒç”¨ï¼Œè¾¾åˆ°å¼‚æ­¥æ“ä½œã€‚</p> 
<p>ä¸¾ä¸ªğŸŒ°Vueé¡¹ç›®æ¡ˆä¾‹</p> 
<p><strong>æ™®é€šæ¡ˆä¾‹promiseï¼š</strong></p> 
<pre><code class="prism language-javascript"><span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
     <span class="token function">getLocation</span><span class="token punctuation">(</span><span class="token parameter">phoneNum</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
         <span class="token keyword">return</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/oneæ¥å£'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
             phoneNum
         <span class="token punctuation">}</span><span class="token punctuation">)</span>
     <span class="token punctuation">}</span><span class="token punctuation">,</span>    
     <span class="token function">getFaceList</span><span class="token punctuation">(</span><span class="token parameter">province<span class="token punctuation">,</span> city</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
         <span class="token keyword">return</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/twoæ¥å£'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
             province<span class="token punctuation">,</span>
             city
         <span class="token punctuation">}</span><span class="token punctuation">)</span>
     <span class="token punctuation">}</span><span class="token punctuation">,</span>  
     <span class="token function">getFaceResult</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getLocation</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>phoneNum<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>success<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
              <span class="token keyword">let</span> province <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>obj<span class="token punctuation">.</span>province<span class="token punctuation">;</span>
              <span class="token keyword">let</span> city <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>obj<span class="token punctuation">.</span>city<span class="token punctuation">;</span>
                  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getFaceList</span><span class="token punctuation">(</span>province<span class="token punctuation">,</span> city<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>success<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                             <span class="token keyword">this</span><span class="token punctuation">.</span>faceList <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>obj
                        <span class="token punctuation">}</span>
                  <span class="token punctuation">}</span><span class="token punctuation">)</span>
              <span class="token punctuation">}</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
             console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span>     
     <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


</code></pre> 
<p><strong>async/ awaitæ¡ˆä¾‹ï¼š</strong></p> 
<pre><code class="prism language-javascript">é¦–å…ˆæŠŠ getFaceResult è½¬åŒ–æˆä¸€ä¸ª<span class="token keyword">async</span> å‡½æ•°ï¼Œå°±æ˜¯åœ¨å…¶å‰é¢åŠ <span class="token keyword">async</span>ï¼Œ å› ä¸ºå®ƒçš„è°ƒç”¨æ–¹æ³•å’Œæ™®é€šå‡½æ•°çš„è°ƒç”¨æ–¹æ³•æ˜¯ä¸€è‡´ï¼Œæ‰€ä»¥æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ã€‚ç„¶åå°±æŠŠ getLocation å’ŒgetFaceList æ”¾åˆ°<span class="token keyword">await</span> åé¢ï¼Œç­‰å¾…æ‰§è¡Œï¼Œ getFaceResult å‡½æ•°ä¿®æ”¹å¦‚ä¸‹ï¼š

<span class="token keyword">async</span> <span class="token function">getFaceResult</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">let</span> location <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getLocation</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>phoneNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>location<span class="token punctuation">.</span>data<span class="token punctuation">.</span>success<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">let</span> province <span class="token operator">=</span> location<span class="token punctuation">.</span>data<span class="token punctuation">.</span>obj<span class="token punctuation">.</span>province<span class="token punctuation">;</span>
                    <span class="token keyword">let</span> city <span class="token operator">=</span> location<span class="token punctuation">.</span>data<span class="token punctuation">.</span>obj<span class="token punctuation">.</span>city<span class="token punctuation">;</span>
                    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getFaceList</span><span class="token punctuation">(</span>province<span class="token punctuation">,</span> city<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>success<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">this</span><span class="token punctuation">.</span>faceList <span class="token operator">=</span> result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>obj<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>


ç°åœ¨å°±è¿˜å·®ä¸€ç‚¹éœ€è¦è¯´æ˜ï¼Œé‚£å°±æ˜¯æ€ä¹ˆå¤„ç†å¼‚å¸¸ï¼Œå¦‚æœè¯·æ±‚å‘ç”Ÿå¼‚å¸¸ï¼Œæ€ä¹ˆå¤„ç†ï¼Ÿ å®ƒç”¨çš„æ˜¯<span class="token keyword">try</span><span class="token operator">/</span>catch æ¥æ•è·å¼‚å¸¸ï¼ŒæŠŠ<span class="token keyword">await</span> æ”¾åˆ° <span class="token keyword">try</span> ä¸­è¿›è¡Œæ‰§è¡Œï¼Œå¦‚æœ‰å¼‚å¸¸ï¼Œå°±ä½¿ç”¨catch è¿›è¡Œå¤„ç†ã€‚
å®Œæ•´ä»£ç ï¼š

<span class="token keyword">async</span> <span class="token function">getFaceResult</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">let</span> location <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getLocation</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>phoneNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>location<span class="token punctuation">.</span>data<span class="token punctuation">.</span>success<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">let</span> province <span class="token operator">=</span> location<span class="token punctuation">.</span>data<span class="token punctuation">.</span>obj<span class="token punctuation">.</span>province<span class="token punctuation">;</span>
                        <span class="token keyword">let</span> city <span class="token operator">=</span> location<span class="token punctuation">.</span>data<span class="token punctuation">.</span>obj<span class="token punctuation">.</span>city<span class="token punctuation">;</span>
                        <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getFaceList</span><span class="token punctuation">(</span>province<span class="token punctuation">,</span> city<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>success<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token keyword">this</span><span class="token punctuation">.</span>faceList <span class="token operator">=</span> result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>obj<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>



</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ebc267c2e9498508fbddbaedf5bd1e6a/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">SpringBootä¸­é…ç½®nacos</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/80d5e1c1356eec01cef6fc4ee0e9e0be/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">åœ¨javaä¸­ä½¿ç”¨alibabaæä¾›çš„easyexcelæ–¹æ³•å¯¼å‡ºæ•°æ®åˆ°excelæ–‡æ¡£</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§å’–.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>