<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【wiki知识库】04.SpringBoot后端实现电子书的增删改查以及前端界面的展示 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/813e4fa62855cc88af10370f46d0dd53/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【wiki知识库】04.SpringBoot后端实现电子书的增删改查以及前端界面的展示">
  <meta property="og:description" content="📝个人主页：哈__
期待您的关注 目录
一、🔥今日内容
二、🌏前端页面的改造
2.1新增电子书管理页面
2.2新增路由规则
2.3修改the-header代码
三、🚗SpringBoot后端Ebook模块改造
3.1增加电子书增/改接口
3.1.1新增EbookSaveParam
3.1.2添加Controller代码
3.1.3在Ebook实体类上增加一个注解
3.2 增加电子书删除接口
四、🔨测试 4.1添加功能测试
4.2修改功能测试。
4.3删除功能测试
一、🔥今日内容 【wiki知识库】03.前后端的初步交互（展现所有的电子书）-CSDN博客
上一次带领大家把前端的首页部分实现了一下，成功的从数据库当中取出了我们的信息并且展示在前端页面，到了下图的部分。
今天主要是把这个网页的界面初步优化一下，修改一下导航栏以及增加电子书管理模块。包含电子书的查询功能、新增功能、编辑功能和删除功能（不包括文档管理）。
二、🌏前端页面的改造 2.1新增电子书管理页面 我在src下新建了admin文件夹，这个文件夹中的内容是给网站管理员看到的，所以放到了admin目录，名字为admin-ebook.vue。
admin-ebook.vue的具体内容如下。这个文件里我注释掉了一些信息，而且这个文件中的内容包含了页面需要的功能很多，有的一些并不是今天要讲解的内容，所以并没有使用到。今天主要就是想带着大家做出一个电子书管理的模块来。
&lt;template&gt; &lt;a-layout&gt; &lt;a-layout-content :style=&#34;{ background: &#39;#fff&#39;, padding: &#39;24px&#39;, margin: 0, minHeight: &#39;280px&#39; }&#34; &gt; &lt;p&gt; &lt;a-form layout=&#34;inline&#34; :model=&#34;param&#34;&gt; &lt;a-form-item&gt; &lt;a-input v-model:value=&#34;param.name&#34; placeholder=&#34;名称&#34;&gt; &lt;/a-input&gt; &lt;/a-form-item&gt; &lt;a-form-item&gt; &lt;a-button type=&#34;primary&#34; @click=&#34;handleQuery({page: 1, size: pagination.pageSize})&#34;&gt; 查询 &lt;/a-button&gt; &lt;/a-form-item&gt; &lt;a-form-item&gt; &lt;a-button type=&#34;primary&#34; @click=&#34;add()&#34;&gt; 新增 &lt;/a-button&gt; &lt;/a-form-item&gt; &lt;/a-form&gt; &lt;/p&gt; &lt;a-table :columns=&#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-03T11:34:02+08:00">
    <meta property="article:modified_time" content="2024-06-03T11:34:02+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【wiki知识库】04.SpringBoot后端实现电子书的增删改查以及前端界面的展示</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="text-align:center;"><img alt="" height="150" src="https://images2.imgbox.com/14/1a/vKn4WQyw_o.png" width="150"></p> 
<p style="text-align:center;"> <strong> 📝个人主页：<a class="link-info" href="https://blog.csdn.net/qq_61024956?type=blog" title="哈__">哈__</a></strong></p> 
<p style="text-align:center;"><span style="color:#fe2c24;">期待您的关注 </span></p> 
<p style="text-align:center;"></p> 
<p style="text-align:center;"><img alt="" height="100" src="https://images2.imgbox.com/c0/6d/7b8qXgEn_o.gif" width="1000"></p> 
<p></p> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%B8%80%E3%80%81%F0%9F%94%A5%E4%BB%8A%E6%97%A5%E5%86%85%E5%AE%B9-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%F0%9F%94%A5%E4%BB%8A%E6%97%A5%E5%86%85%E5%AE%B9" rel="nofollow">一、🔥今日内容</a></p> 
<p id="%E4%BA%8C%E3%80%81%F0%9F%8C%8F%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E7%9A%84%E6%94%B9%E9%80%A0-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%F0%9F%8C%8F%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E7%9A%84%E6%94%B9%E9%80%A0" rel="nofollow">二、🌏前端页面的改造</a></p> 
<p id="2.1%E6%96%B0%E5%A2%9E%E7%94%B5%E5%AD%90%E4%B9%A6%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2-toc" style="margin-left:40px;"><a href="#2.1%E6%96%B0%E5%A2%9E%E7%94%B5%E5%AD%90%E4%B9%A6%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2" rel="nofollow">2.1新增电子书管理页面</a></p> 
<p id="2.2%E6%96%B0%E5%A2%9E%E8%B7%AF%E7%94%B1%E8%A7%84%E5%88%99-toc" style="margin-left:40px;"><a href="#2.2%E6%96%B0%E5%A2%9E%E8%B7%AF%E7%94%B1%E8%A7%84%E5%88%99" rel="nofollow">2.2新增路由规则</a></p> 
<p id="2.3%E4%BF%AE%E6%94%B9the-header%E4%BB%A3%E7%A0%81-toc" style="margin-left:40px;"><a href="#2.3%E4%BF%AE%E6%94%B9the-header%E4%BB%A3%E7%A0%81" rel="nofollow">2.3修改the-header代码</a></p> 
<p id="%E4%B8%89%E3%80%81%F0%9F%9A%97SpringBoot%E5%90%8E%E7%AB%AFEbook%E6%A8%A1%E5%9D%97%E6%94%B9%E9%80%A0-toc" style="margin-left:0px;"><a href="#%E4%B8%89%E3%80%81%F0%9F%9A%97SpringBoot%E5%90%8E%E7%AB%AFEbook%E6%A8%A1%E5%9D%97%E6%94%B9%E9%80%A0" rel="nofollow">三、🚗SpringBoot后端Ebook模块改造</a></p> 
<p id="3.1%E5%A2%9E%E5%8A%A0%E7%94%B5%E5%AD%90%E4%B9%A6%E5%A2%9E%2F%E6%94%B9%E6%8E%A5%E5%8F%A3-toc" style="margin-left:40px;"><a href="#3.1%E5%A2%9E%E5%8A%A0%E7%94%B5%E5%AD%90%E4%B9%A6%E5%A2%9E%2F%E6%94%B9%E6%8E%A5%E5%8F%A3" rel="nofollow">3.1增加电子书增/改接口</a></p> 
<p id="3.1.1%E6%96%B0%E5%A2%9EEbookSaveParam-toc" style="margin-left:80px;"><a href="#3.1.1%E6%96%B0%E5%A2%9EEbookSaveParam" rel="nofollow">3.1.1新增EbookSaveParam</a></p> 
<p id="3.1.2%E6%B7%BB%E5%8A%A0Controller%E4%BB%A3%E7%A0%81-toc" style="margin-left:80px;"><a href="#3.1.2%E6%B7%BB%E5%8A%A0Controller%E4%BB%A3%E7%A0%81" rel="nofollow">3.1.2添加Controller代码</a></p> 
<p id="3.1.3%E5%9C%A8Ebook%E5%AE%9E%E4%BD%93%E7%B1%BB%E4%B8%8A%E5%A2%9E%E5%8A%A0%E4%B8%80%E4%B8%AA%E6%B3%A8%E8%A7%A3-toc" style="margin-left:80px;"><a href="#3.1.3%E5%9C%A8Ebook%E5%AE%9E%E4%BD%93%E7%B1%BB%E4%B8%8A%E5%A2%9E%E5%8A%A0%E4%B8%80%E4%B8%AA%E6%B3%A8%E8%A7%A3" rel="nofollow">3.1.3在Ebook实体类上增加一个注解</a></p> 
<p id="3.2%C2%A0%E5%A2%9E%E5%8A%A0%E7%94%B5%E5%AD%90%E4%B9%A6%E5%88%A0%E9%99%A4%E6%8E%A5%E5%8F%A3-toc" style="margin-left:40px;"><a href="#3.2%C2%A0%E5%A2%9E%E5%8A%A0%E7%94%B5%E5%AD%90%E4%B9%A6%E5%88%A0%E9%99%A4%E6%8E%A5%E5%8F%A3" rel="nofollow">3.2 增加电子书删除接口</a></p> 
<p id="%E5%9B%9B%E3%80%81%F0%9F%94%A8%E6%B5%8B%E8%AF%95%C2%A0-toc" style="margin-left:0px;"><a href="#%E5%9B%9B%E3%80%81%F0%9F%94%A8%E6%B5%8B%E8%AF%95%C2%A0" rel="nofollow">四、🔨测试 </a></p> 
<p id="4.1%E6%B7%BB%E5%8A%A0%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-toc" style="margin-left:40px;"><a href="#4.1%E6%B7%BB%E5%8A%A0%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95" rel="nofollow">4.1添加功能测试</a></p> 
<p id="4.2%E4%BF%AE%E6%94%B9%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95%E3%80%82-toc" style="margin-left:40px;"><a href="#4.2%E4%BF%AE%E6%94%B9%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95%E3%80%82" rel="nofollow">4.2修改功能测试。</a></p> 
<p id="4.3%E5%88%A0%E9%99%A4%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-toc" style="margin-left:40px;"><a href="#4.3%E5%88%A0%E9%99%A4%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95" rel="nofollow">4.3删除功能测试</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="%E4%B8%80%E3%80%81%F0%9F%94%A5%E4%BB%8A%E6%97%A5%E5%86%85%E5%AE%B9">一、🔥今日内容</h2> 
<blockquote> 
 <p><a href="https://blog.csdn.net/qq_61024956/article/details/139275167?spm=1001.2014.3001.5502" title="【wiki知识库】03.前后端的初步交互（展现所有的电子书）-CSDN博客">【wiki知识库】03.前后端的初步交互（展现所有的电子书）-CSDN博客</a></p> 
 <p>上一次带领大家把前端的首页部分实现了一下，成功的从数据库当中取出了我们的信息并且展示在前端页面，到了下图的部分。</p> 
 <p><img alt="" height="778" src="https://images2.imgbox.com/4d/27/IEEy6e6C_o.png" width="1200"></p> 
 <p><span style="color:#fe2c24;">今天主要是把这个网页的界面初步优化一下，修改一下导航栏以及增加电子书管理模块。包含电子书的查询功能、新增功能、编辑功能和删除功能（不包括文档管理）。</span></p> 
 <p><img alt="" height="879" src="https://images2.imgbox.com/cb/a9/2lgZU1Uc_o.png" width="1200"></p> 
</blockquote> 
<h2 id="%E4%BA%8C%E3%80%81%F0%9F%8C%8F%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E7%9A%84%E6%94%B9%E9%80%A0">二、🌏前端页面的改造</h2> 
<blockquote> 
 <h3 id="2.1%E6%96%B0%E5%A2%9E%E7%94%B5%E5%AD%90%E4%B9%A6%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2">2.1新增电子书管理页面</h3> 
 <p>我在src下新建了admin文件夹，这个文件夹中的内容是给网站管理员看到的，所以放到了admin目录，名字为admin-ebook.vue。</p> 
 <p><img alt="" height="258" src="https://images2.imgbox.com/d3/5c/CVAURKTW_o.png" width="883"></p> 
 <p> admin-ebook.vue的具体内容如下。这个文件里我注释掉了一些信息，而且这个文件中的内容包含了页面需要的功能很多，有的一些并不是今天要讲解的内容，所以并没有使用到。今天主要就是想带着大家做出一个电子书管理的模块来。</p> 
 <pre><code class="language-html">&lt;template&gt;
  &lt;a-layout&gt;
    &lt;a-layout-content
      :style="{ background: '#fff', padding: '24px', margin: 0, minHeight: '280px' }"
    &gt;
      &lt;p&gt;
        &lt;a-form layout="inline" :model="param"&gt;
          &lt;a-form-item&gt;
            &lt;a-input v-model:value="param.name" placeholder="名称"&gt;
            &lt;/a-input&gt;
          &lt;/a-form-item&gt;
          &lt;a-form-item&gt;
            &lt;a-button type="primary" @click="handleQuery({page: 1, size: pagination.pageSize})"&gt;
              查询
            &lt;/a-button&gt;
          &lt;/a-form-item&gt;
          &lt;a-form-item&gt;
            &lt;a-button type="primary" @click="add()"&gt;
              新增
            &lt;/a-button&gt;
          &lt;/a-form-item&gt;
        &lt;/a-form&gt;
      &lt;/p&gt;
      &lt;a-table
        :columns="columns"
        :row-key="record =&gt; record.id"
        :data-source="ebooks"
        :pagination="pagination"
        :loading="loading"
        @change="handleTableChange"
      &gt;
        &lt;template #cover="{ text: cover }"&gt;
          &lt;img v-if="cover" :src="cover" alt="avatar" /&gt;
        &lt;/template&gt;
        &lt;template v-slot:category="{ text, record }"&gt;
          &lt;!-- &lt;span&gt;{<!-- -->{ getCategoryName(record.category1Id) }} / {<!-- -->{ getCategoryName(record.category2Id) }}&lt;/span&gt; --&gt;
        &lt;/template&gt;
        &lt;template v-slot:action="{ text, record }"&gt;
          &lt;a-space size="small"&gt;
            &lt;!-- &lt;router-link :to="'/admin/doc?ebookId=' + record.id"&gt; --&gt;
              &lt;a-button type="primary"&gt;
                文档管理
              &lt;/a-button&gt;
            &lt;!-- &lt;/router-link&gt; --&gt;
            &lt;a-button type="primary" @click="edit(record)"&gt;
              编辑
            &lt;/a-button&gt;
            &lt;a-popconfirm
              title="删除后不可恢复，确认删除?"
              ok-text="是"
              cancel-text="否"
              @confirm="handleDelete(record.id)"
            &gt;
              &lt;a-button type="danger"&gt;
                删除
              &lt;/a-button&gt;
            &lt;/a-popconfirm&gt;
          &lt;/a-space&gt;
        &lt;/template&gt;
      &lt;/a-table&gt;
    &lt;/a-layout-content&gt;
  &lt;/a-layout&gt;

  &lt;a-modal
    title="电子书表单"
    v-model:visible="modalVisible"
    :confirm-loading="modalLoading"
    @ok="handleModalOk"
  &gt;
    &lt;a-form :model="ebook" :label-col="{ span: 6 }" :wrapper-col="{ span: 18 }"&gt;
      &lt;a-form-item label="封面"&gt;
        &lt;a-input v-model:value="ebook.cover" /&gt;
      &lt;/a-form-item&gt;
      &lt;a-form-item label="名称"&gt;
        &lt;a-input v-model:value="ebook.name" /&gt;
      &lt;/a-form-item&gt;
      &lt;a-form-item label="分类"&gt;
        &lt;a-cascader
          v-model:value="categoryIds"
          :field-names="{ label: 'name', value: 'id', children: 'children' }"
          :options="level1"
        /&gt;
      &lt;/a-form-item&gt;
      &lt;a-form-item label="描述"&gt;
        &lt;a-input v-model:value="ebook.description" type="textarea" /&gt;
      &lt;/a-form-item&gt;
    &lt;/a-form&gt;
  &lt;/a-modal&gt;
&lt;/template&gt;

&lt;script lang="ts"&gt;
  import { defineComponent, onMounted, ref } from 'vue';
  import axios from 'axios';
  import { message } from 'ant-design-vue';
  import {Tool} from "@/util/tool";

  export default defineComponent({
    name: 'AdminEbook',
    setup() {
      const param = ref();
      param.value = {};
      const ebooks = ref();
      const pagination = ref({
        current: 1,
        pageSize: 10,
        total: 0
      });
      const loading = ref(false);

      const columns = [
        {
          title: '封面',
          dataIndex: 'cover',
          slots: { customRender: 'cover' }
        },
        {
          title: '名称',
          dataIndex: 'name'
        },
        {
          title: '分类',
          slots: { customRender: 'category' }
        },
        {
          title: '文档数',
          dataIndex: 'docCount'
        },
        {
          title: '阅读数',
          dataIndex: 'viewCount'
        },
        {
          title: '点赞数',
          dataIndex: 'voteCount'
        },
        {
          title: 'Action',
          key: 'action',
          slots: { customRender: 'action' }
        }
      ];

      /**
       * 数据查询
       **/
      const handleQuery = (params: any) =&gt; {
        loading.value = true;
        // 如果不清空现有数据，则编辑保存重新加载数据后，再点编辑，则列表显示的还是编辑前的数据
        ebooks.value = [];
        axios.get("/ebook/list", {
          params: {
            page: params.page,
            size: params.size,
            name: param.value.name
          }
        }).then((response) =&gt; {
          loading.value = false;
          const data = response.data;
          if (data.success) {
            ebooks.value = data.content.list;

            // 重置分页按钮
            pagination.value.current = params.page;
            pagination.value.total = data.content.total;
          } else {
            message.error(data.message);
          }
        });
      };

      /**
       * 表格点击页码时触发
       */
      const handleTableChange = (pagination: any) =&gt; {
        console.log("看看自带的分页参数都有啥：" + pagination);
        handleQuery({
          page: pagination.current,
          size: pagination.pageSize
        });
      };

      // -------- 表单 ---------
      /**
       * 数组，[100, 101]对应：前端开发 / Vue
       */
      const categoryIds = ref();
      const ebook = ref();
      const modalVisible = ref(false);
      const modalLoading = ref(false);
      const handleModalOk = () =&gt; {
        modalLoading.value = true;
        ebook.value.category1Id = categoryIds.value[0];
        ebook.value.category2Id = categoryIds.value[1];
        axios.post("/ebook/save", ebook.value).then((response) =&gt; {
          modalLoading.value = false;
          const data = response.data; // data = commonResp
          if (data.success) {
            modalVisible.value = false;

            // 重新加载列表
            handleQuery({
              page: pagination.value.current,
              size: pagination.value.pageSize,
            });
          } else {
            message.error(data.message);
          }
        });
      };

      /**
       * 编辑
       */
      const edit = (record: any) =&gt; {
        modalVisible.value = true;
        ebook.value = Tool.copy(record);
        categoryIds.value = [ebook.value.category1Id, ebook.value.category2Id]
      };

      /**
       * 新增
       */
      const add = () =&gt; {
        modalVisible.value = true;
        ebook.value = {};
      };

      const handleDelete = (id: number) =&gt; {
        axios.delete("/ebook/delete/" + id).then((response) =&gt; {
          const data = response.data; // data = commonResp
          if (data.success) {
            // 重新加载列表
            handleQuery({
              page: pagination.value.current,
              size: pagination.value.pageSize,
            });
          } else {
            message.error(data.message);
          }
        });
      };

      const level1 =  ref();
      let categorys: any;
      /**
       * 查询所有分类
       **/
      const handleQueryCategory = () =&gt; {
        loading.value = true;
        axios.get("/category/all").then((response) =&gt; {
          loading.value = false;
          const data = response.data;
          if (data.success) {
            categorys = data.content;
            console.log("原始数组：", categorys);

            level1.value = [];
            level1.value = Tool.array2Tree(categorys, 0);
            console.log("树形结构：", level1.value);

            // 加载完分类后，再加载电子书，否则如果分类树加载很慢，则电子书渲染会报错
            handleQuery({
              page: 1,
              size: pagination.value.pageSize,
            });
          } else {
            message.error(data.message);
          }
        });
      };

      const getCategoryName = (cid: number) =&gt; {
        // console.log(cid)
        let result = "";
        categorys.forEach((item: any) =&gt; {
          if (item.id === cid) {
            // return item.name; // 注意，这里直接return不起作用
            result = item.name;
          }
        });
        return result;
      };

      onMounted(() =&gt; {
        handleQuery({
              page: pagination.value.current,
              size: pagination.value.pageSize,
            });
      });

      return {
        param,
        ebooks,
        pagination,
        columns,
        loading,
        handleTableChange,
        handleQuery,
        getCategoryName,

        edit,
        add,

        ebook,
        modalVisible,
        modalLoading,
        handleModalOk,
        categoryIds,
        level1,

        handleDelete
      }
    }
  });
&lt;/script&gt;

&lt;style scoped&gt;
  img {
    width: 50px;
    height: 50px;
  }
&lt;/style&gt;
</code></pre> 
 <p>上边的内容很多，但我们今天核心的前端调用部分是下边的代码。</p> 
 <pre><code class="language-javascript">const handleQuery = (params: any) =&gt; {
        loading.value = true;
        // 如果不清空现有数据，则编辑保存重新加载数据后，再点编辑，则列表显示的还是编辑前的数据
        ebooks.value = [];
        axios.get("/ebook/list", {
          params: {
            page: params.page,
            size: params.size,
            name: param.value.name
          }
        }).then((response) =&gt; {
          loading.value = false;
          const data = response.data;
          if (data.success) {
            ebooks.value = data.content.list;

            // 重置分页按钮
            pagination.value.current = params.page;
            pagination.value.total = data.content.total;
          } else {
            message.error(data.message);
          }
        });
      };</code></pre> 
 <p>当我们进去这个页面的时候，首先就会调用下方代码，请求路径也恰好是我们后端之前写过的list接口，用来分页查询电子书信息。</p> 
 <pre><code class="language-javascript">onMounted(() =&gt; {
        handleQuery({
              page: pagination.value.current,
              size: pagination.value.pageSize,
            });
      });
</code></pre> 
 <hr> 
 <h3 id="2.2%E6%96%B0%E5%A2%9E%E8%B7%AF%E7%94%B1%E8%A7%84%E5%88%99">2.2新增路由规则</h3> 
 <p>既然都要新增一个电子书的管理页面了，那我们也要为这个页面分配一个能够匹配到的路由路径。</p> 
 <pre><code class="language-javascript">import { createRouter, createWebHistory, RouteRecordRaw } from 'vue-router'
import HomeView from '../views/HomeView.vue'
import AdminEbook from '@/views/admin/admin-ebook.vue'
import AboutView from '../views/AboutView.vue'
const routes: Array&lt;RouteRecordRaw&gt; = [
  {
    path: '/',
    name: 'home',
    component: HomeView
  },
  {
    path: '/about',
    name: 'about',
    component:AboutView
  },
  {
    path: '/admin/ebook',
    name: 'AdminEbook',
    component: AdminEbook
  },
]

const router = createRouter({
  history: createWebHistory(process.env.BASE_URL),
  routes
})

export default router
</code></pre> 
 <hr> 
 <h3 id="2.3%E4%BF%AE%E6%94%B9the-header%E4%BB%A3%E7%A0%81">2.3修改the-header代码</h3> 
 <p> 我们新增的组件是通过点击the-header组件中的按钮实现跳转的，这里要修改一些代码。我在这个页面添加了一些路由用于跳转我们的组件。</p> 
 <pre><code class="language-html">&lt;template&gt;
     &lt;a-layout-header class="header"&gt;
      &lt;div class="logo" &gt;&lt;/div&gt;
      &lt;a-menu
        theme="dark"
        mode="horizontal"
        v-model:selectedKeys="sselectedKeys1"
        :style="{ lineHeight: '64px' }"
      &gt;
        &lt;a-menu-item key="/"&gt;&lt;router-link to="/"&gt;首页&lt;/router-link&gt;&lt;/a-menu-item&gt;
        &lt;a-menu-item key="/admin/ebook"&gt;&lt;router-link to="/admin/ebook"&gt;电子书管理&lt;/router-link&gt;&lt;/a-menu-item&gt;
        &lt;a-menu-item key="/about"&gt;&lt;router-link to="/about"&gt;关于我们&lt;/router-link&gt;&lt;/a-menu-item&gt;
      &lt;/a-menu&gt;
    &lt;/a-layout-header&gt;
&lt;/template&gt;</code></pre> 
 <p>至此我们前端改造成功，接下来就是后端了。</p> 
</blockquote> 
<h2 id="%E4%B8%89%E3%80%81%F0%9F%9A%97SpringBoot%E5%90%8E%E7%AB%AFEbook%E6%A8%A1%E5%9D%97%E6%94%B9%E9%80%A0">三、🚗SpringBoot后端Ebook模块改造</h2> 
<blockquote> 
 <h3 id="3.1%E5%A2%9E%E5%8A%A0%E7%94%B5%E5%AD%90%E4%B9%A6%E5%A2%9E%2F%E6%94%B9%E6%8E%A5%E5%8F%A3">3.1增加电子书增/改接口</h3> 
 <p>在我们点击新增按钮或者编辑按钮的时候，会弹出一个窗口来添加或者修改电子书的信息，当我们点击确定之后会向后端发送请求。请求接口是/ebook/save，<span style="color:#fe2c24;">注意，这里的save指代两个功能，第一个是新增，第二个是修改。</span></p> 
 <p><img alt="" height="240" src="https://images2.imgbox.com/e0/f6/z7o3bMxO_o.png" width="646"></p> 
 <h4 id="3.1.1%E6%96%B0%E5%A2%9EEbookSaveParam">3.1.1新增EbookSaveParam</h4> 
 <p>这个实体类用于封装我们前端传过来的电子书的信息。</p> 
 <pre><code class="language-java">@Data
public class EbookSaveParam {
    private Long id;
    @NotNull(message = "【名称】不能为空")
    private String name;
    private Long category1Id;
    private Long category2Id;
    private String description;
    private String cover;
    private Integer docCount;
    private Integer viewCount;
    private Integer voteCount;
}
</code></pre> 
 <hr> 
 <h4 id="3.1.2%E6%B7%BB%E5%8A%A0Controller%E4%BB%A3%E7%A0%81">3.1.2添加Controller代码</h4> 
 <p>这里我直接使用的MybatisPlus封装好的函数</p> 
 <pre><code class="language-java">    /**
     *  保存/修改电子书
     * @param ebookQueryParam
     * @return
     */
    @PostMapping("/save")
    public CommonResp save(@Validated @RequestBody EbookSaveParam ebookQueryParam){
        boolean res = ebookService.saveOrUpdate(CopyUtil.copy(ebookQueryParam,Ebook.class));
        String message = Boolean.TRUE.equals(res) ? "操作成功":"操作失败";
        return new CommonResp&lt;&gt;(true,message,null);
    }</code></pre> 
 <hr> 
 <h4 id="3.1.3%E5%9C%A8Ebook%E5%AE%9E%E4%BD%93%E7%B1%BB%E4%B8%8A%E5%A2%9E%E5%8A%A0%E4%B8%80%E4%B8%AA%E6%B3%A8%E8%A7%A3">3.1.3在Ebook实体类上增加一个注解</h4> 
 <p>我们要使用雪花算法生成的id存储在数据库当中。</p> 
 <pre><code class="language-java">  /**
     * id
     */
    @TableId(type = IdType.ASSIGN_UUID)
    private Long id;</code></pre> 
 <p>当然除了雪花id还有其他的id可供选择。这里就不一一给大家说了。</p> 
 <p><img alt="" height="363" src="https://images2.imgbox.com/c8/5c/GpUdIBTm_o.png" width="1088"></p> 
 <hr> 
 <h3 id="3.2%C2%A0%E5%A2%9E%E5%8A%A0%E7%94%B5%E5%AD%90%E4%B9%A6%E5%88%A0%E9%99%A4%E6%8E%A5%E5%8F%A3">3.2 增加电子书删除接口</h3> 
 <p>删除功能的接口是下边图中所示。采用的是Restful风格的请求。</p> 
 <p><img alt="" height="338" src="https://images2.imgbox.com/9a/b4/2zFPsWJH_o.png" width="758"></p> 
 <p> 对应Controller代码。</p> 
 <pre><code class="language-java"> /**
     * 删除电子书
     * @param id 电子书id
     * @return
     */
    @DeleteMapping("/delete/{id}")
    public CommonResp delete(@PathVariable("id") Long id){
        boolean res = ebookService.removeById(id);
        String message = Boolean.TRUE.equals(res) ? "删除成功":"删除失败";
        return new CommonResp&lt;&gt;(true,message,null);
    }</code></pre> 
 <p></p> 
</blockquote> 
<h2 id="%E5%9B%9B%E3%80%81%F0%9F%94%A8%E6%B5%8B%E8%AF%95%C2%A0">四、🔨测试 </h2> 
<blockquote> 
 <h3 id="4.1%E6%B7%BB%E5%8A%A0%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95">4.1添加功能测试</h3> 
 <p>测试之前还要注释两行代码。因为我们的分类模块还没写，这里不能传值。</p> 
 <p><img alt="" height="237" src="https://images2.imgbox.com/c4/e5/hiKqDbLk_o.png" width="735"></p> 
 <p>随便加一个电子书上去。</p> 
 <p><img alt="" height="464" src="https://images2.imgbox.com/2d/be/b9093ThV_o.png" width="656"></p> 
 <p>结果还是没问题的。</p> 
 <p><img alt="" height="691" src="https://images2.imgbox.com/87/50/PwJ8guJV_o.png" width="1200"></p> 
 <h3 id="4.2%E4%BF%AE%E6%94%B9%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95%E3%80%82">4.2修改功能测试。</h3> 
 <p>不在截图展示了，点击编辑按钮之后哦修改数据我这里是正确的。</p> 
 <h3 id="4.3%E5%88%A0%E9%99%A4%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95">4.3删除功能测试</h3> 
 <p>这时就有问题了，我删除怎么成功不了？那么你是否会分析原因呢？先看看前端的打印。</p> 
 <p><img alt="" height="393" src="https://images2.imgbox.com/7e/09/EVh9vveL_o.png" width="945"></p> 
 <p>仔细看看我们传过去的id是什么，再看看你的数据库里是否有这个id？ 显然是没有的。</p> 
 <p><img alt="" height="74" src="https://images2.imgbox.com/6c/f2/UnwcDILD_o.png" width="934"></p> 
 <p>这里就要说一下前后端传输数据的数据精度丢失问题了，因为我们传的数据是一个整形，而且数值很大，在传输的过程总是有精度问题得，想要解决就需要在后端加一个配置类。</p> 
 <p></p> 
 <pre><code class="language-java">package com.my.hawiki.config;

import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.module.SimpleModule;
import com.fasterxml.jackson.databind.ser.std.ToStringSerializer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.http.converter.json.Jackson2ObjectMapperBuilder;

/**
 * 统一注解，解决前后端交互Long类型精度丢失的问题
 */
@Configuration
public class JacksonConfig {
    @Bean
    public ObjectMapper jacksonObjectMapper(Jackson2ObjectMapperBuilder builder) {
        ObjectMapper objectMapper = builder.createXmlMapper(false).build();
        SimpleModule simpleModule = new SimpleModule();
        simpleModule.addSerializer(Long.class, ToStringSerializer.instance);
        objectMapper.registerModule(simpleModule);
        return objectMapper;
    }
}</code></pre> 
 <p>之后在运行代码试试。大功告成。</p> 
 <p><img alt="" height="391" src="https://images2.imgbox.com/ee/4f/oOcLfeD2_o.png" width="965"></p> 
 <p> 电子书管理页面的基本几个功能差不多就这么多了。</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8c44c5fd109775795ae953610b478514/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">oracle正则表达式</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c71a926eca6d0194da6a43bf20babad1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java邮件客户端设计实现：使用JavaMail向QQ邮箱发邮件</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>