<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python｜闲谈2048小游戏和数组的旋转及翻转和转置 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/55b97714330054f700490de78f8b9fde/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="python｜闲谈2048小游戏和数组的旋转及翻转和转置">
  <meta property="og:description" content="目录
2048
生成数组
n阶方阵
方阵旋转
顺时针旋转
逆时针旋转
mxn矩阵
矩阵旋转
测试代码
测试结果
翻转和转置
2048 《2048》是一款比较流行​的数字游戏​，最早于2014年3月20日发行。原版2048由Gabriele Cirulli首先在GitHub上发布，后被移植到各个平台，并且衍生出不计其数的版本。但在网上看到，居说它也不算是原创，是基于《1024》和《小3传奇》的玩法开发而成的；还有一说，它来源于另一款游戏《Threes!》，由Asher Vollmer和Greg Wohlwend合作开发，于2014年2月6日在App Store上架。
2048游戏规则很简单，游戏开始时在4x4的方格中随机出现数字2，每次可以选择上下左右其中一个方向去滑动，每滑动一次，所有的数字方块都会往滑动的方向靠拢外，相邻的相同数字在靠拢时会相加，系统也会在空白的格子里随机增加一个数字2或4。玩家要想办法在这16格范围中，不断上下左右滑动相加数字，从而凑出“2048”这个数字方块。
实际上，这个游戏就是在操作一个4x4的二维数组，数组的元素只要1-11就行了，因为2的11次方就是2048。同样，相邻相同数字的累加就变成了相邻相同指数的递增1。
在编写这个2048游戏前，先来谈谈4x4数组的操作，对python来说虽然也有数组，但通常会用列表来操作。以下就在IDLE shell上流水账操作：
生成数组 16个数字的列表推导式：
&gt;&gt;&gt; [i for i in range(16)]
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
用*解包更pythonic：
&gt;&gt;&gt; [*range(16)]
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
分割成4x4二维列表：
&gt;&gt;&gt; [[*range(16)][i*4:i*4&#43;4] for i in range(4)]">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-02-28T08:40:47+08:00">
    <meta property="article:modified_time" content="2024-02-28T08:40:47+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python｜闲谈2048小游戏和数组的旋转及翻转和转置</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="2048-toc" style="margin-left:0px;"><a href="#2048" rel="nofollow">2048</a></p> 
<p id="%E7%94%9F%E6%88%90%E6%95%B0%E7%BB%84-toc" style="margin-left:40px;"><a href="#%E7%94%9F%E6%88%90%E6%95%B0%E7%BB%84" rel="nofollow">生成数组</a></p> 
<p id="n%E9%98%B6%E6%96%B9%E9%98%B5-toc" style="margin-left:40px;"><a href="#n%E9%98%B6%E6%96%B9%E9%98%B5" rel="nofollow">n阶方阵</a></p> 
<p id="%E6%96%B9%E9%98%B5%E6%97%8B%E8%BD%AC-toc" style="margin-left:40px;"><a href="#%E6%96%B9%E9%98%B5%E6%97%8B%E8%BD%AC" rel="nofollow">方阵旋转</a></p> 
<p id="%E9%A1%BA%E6%97%B6%E9%92%88%E6%97%8B%E8%BD%AC-toc" style="margin-left:80px;"><a href="#%E9%A1%BA%E6%97%B6%E9%92%88%E6%97%8B%E8%BD%AC" rel="nofollow">顺时针旋转</a></p> 
<p id="%E9%80%86%E6%97%B6%E9%92%88%E6%97%8B%E8%BD%AC-toc" style="margin-left:80px;"><a href="#%E9%80%86%E6%97%B6%E9%92%88%E6%97%8B%E8%BD%AC" rel="nofollow">逆时针旋转</a></p> 
<p id="mxn%E7%9F%A9%E9%98%B5-toc" style="margin-left:40px;"><a href="#mxn%E7%9F%A9%E9%98%B5" rel="nofollow">mxn矩阵</a></p> 
<p id="%E7%9F%A9%E9%98%B5%E6%97%8B%E8%BD%AC-toc" style="margin-left:40px;"><a href="#%E7%9F%A9%E9%98%B5%E6%97%8B%E8%BD%AC" rel="nofollow">矩阵旋转</a></p> 
<p id="%E6%B5%8B%E8%AF%95%E4%BB%A3%E7%A0%81-toc" style="margin-left:80px;"><a href="#%E6%B5%8B%E8%AF%95%E4%BB%A3%E7%A0%81" rel="nofollow">测试代码</a></p> 
<p id="%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C-toc" style="margin-left:80px;"><a href="#%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C" rel="nofollow">测试结果</a></p> 
<p id="%E7%BF%BB%E8%BD%AC%E5%92%8C%E8%BD%AC%E7%BD%AE-toc" style="margin-left:40px;"><a href="#%E7%BF%BB%E8%BD%AC%E5%92%8C%E8%BD%AC%E7%BD%AE" rel="nofollow">翻转和转置</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="2048">2048</h2> 
<p>《2048》是一款比较流行​的数字游戏​，最早于2014年3月20日发行。原版2048由Gabriele Cirulli首先在GitHub上发布，后被移植到各个平台，并且衍生出不计其数的版本。但在网上看到，居说它也不算是原创，是基于《1024》和《小3传奇》的玩法开发而成的；还有一说，它来源于另一款游戏《Threes!》，由Asher Vollmer和Greg Wohlwend合作开发，于2014年2月6日在App Store上架。</p> 
<p>2048游戏规则很简单，游戏开始时在4x4的方格中随机出现数字2，每次可以选择上下左右其中一个方向去滑动，每滑动一次，所有的数字方块都会往滑动的方向靠拢外，相邻的相同数字在靠拢时会相加，系统也会在空白的格子里随机增加一个数字2或4。玩家要想办法在这16格范围中，不断上下左右滑动相加数字，从而凑出“2048”这个数字方块。</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/0c/99/rDuEFDPN_o.png" width="1200"></p> 
<p>实际上，这个游戏就是在操作一个4x4的二维数组，数组的元素只要1-11就行了，因为2的11次方就是2048。同样，相邻相同数字的累加就变成了相邻相同指数的递增1。</p> 
<p>在编写这个2048游戏前，先来谈谈4x4数组的操作，对python来说虽然也有数组，但通常会用列表来操作。以下就在IDLE shell上流水账操作：</p> 
<h3 id="%E7%94%9F%E6%88%90%E6%95%B0%E7%BB%84">生成数组</h3> 
<p>16个数字的列表推导式：</p> 
<p>&gt;&gt;&gt; [i for i in range(16)]<br> [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]</p> 
<p>用*解包更pythonic：</p> 
<p>&gt;&gt;&gt; [*range(16)]<br> [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]</p> 
<p>分割成4x4二维列表：</p> 
<p>&gt;&gt;&gt; [[*range(16)][i*4:i*4+4] for i in range(4)]<br> [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]]</p> 
<p>只是数列如此写法可能更好：</p> 
<p>&gt;&gt;&gt; [[*range(i*4,i*4+4)] for i in range(4)]<br> [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]]</p> 
<p>全0列表：</p> 
<p>&gt;&gt;&gt; [[0]*4 for _ in range(4)]<br> [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]</p> 
<h3 id="n%E9%98%B6%E6%96%B9%E9%98%B5">n阶方阵</h3> 
<p>从4阶方阵扩展到n阶：</p> 
<p>&gt;&gt;&gt; matrix = lambda n:[[*range(i*n,i*n+n)] for i in range(n)]<br> &gt;&gt;&gt; matrix(4)<br> [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]]<br> &gt;&gt;&gt; matrix(5)<br> [[0, 1, 2, 3, 4], [5, 6, 7, 8, 9], [10, 11, 12, 13, 14], [15, 16, 17, 18, 19], [20, 21, 22, 23, 24]]<br> &gt;&gt;&gt; matrix(6)<br> [[0, 1, 2, 3, 4, 5], [6, 7, 8, 9, 10, 11], [12, 13, 14, 15, 16, 17], [18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29], [30, 31, 32, 33, 34, 35]]</p> 
<p>随机生成数字1或2，比例为3:1：</p> 
<p>&gt;&gt;&gt; from random import sample as rnd<br> &gt;&gt;&gt; rnd([1,1,1,2],1)<br> [1]<br> &gt;&gt;&gt; rnd([1,1,1,2],1)<br> [2]<br> &gt;&gt;&gt; rnd([1,1,1,2],1)<br> [2]<br> &gt;&gt;&gt; rnd([1,1,1,2],1)</p> 
<p>随机产生1或者2个“1”，比例为2:1：</p> 
<p>&gt;&gt;&gt; from random import sample as rnd<br> &gt;&gt;&gt; x = 4<br> &gt;&gt;&gt; rnd([0]*(x*x-2)+rnd([0,1,1],2),x*x)<br> [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]<br> &gt;&gt;&gt; rnd([0]*(x*x-2)+rnd([0,1,1],2),x*x)<br> [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0]<br> &gt;&gt;&gt; rnd([0]*(x*x-2)+rnd([0,1,1],2),x*x)<br> [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0]<br> x = 5<br> rnd([0]*(x*x-2)+rnd([0,1,1],2),x*x)<br> [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]<br> rnd([0]*(x*x-2)+rnd([0,1,1],2),x*x)<br> [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0]<br> rnd([0]*(x*x-2)+rnd([0,1,1],2),x*x)<br> [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]<br> rnd([0]*(x*x-2)+rnd([0,1,1],2),x*x)<br> [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</p> 
<h3 id="%E6%96%B9%E9%98%B5%E6%97%8B%E8%BD%AC">方阵旋转</h3> 
<p>numpy有现成的函数rot90()，表示顺时针旋转数组90度。</p> 
<p>&gt;&gt;&gt; import numpy as np<br> &gt;&gt;&gt; np.array(range(16))<br> array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15])<br> &gt;&gt;&gt; np.array([[*range(i*4,i*4+4)] for i in range(4)])<br> array([[ 0,  1,  2,  3],<br>        [ 4,  5,  6,  7],<br>        [ 8,  9, 10, 11],<br>        [12, 13, 14, 15]])<br> &gt;&gt;&gt; array = np.array([[*range(i*4,i*4+4)] for i in range(4)])</p> 
<p>逆时针旋转，参数k为正数：</p> 
<p>&gt;&gt;&gt; np.rot90(array)<br> array([[ 3,  7, 11, 15],<br>        [ 2,  6, 10, 14],<br>        [ 1,  5,  9, 13],<br>        [ 0,  4,  8, 12]])<br> &gt;&gt;&gt; np.rot90(array, k=2)<br> array([[15, 14, 13, 12],<br>        [11, 10,  9,  8],<br>        [ 7,  6,  5,  4],<br>        [ 3,  2,  1,  0]])<br> &gt;&gt;&gt; np.rot90(array, k=3)<br> array([[12,  8,  4,  0],<br>        [13,  9,  5,  1],<br>        [14, 10,  6,  2],<br>        [15, 11,  7,  3]])</p> 
<p>顺时针旋转，参数k为负数：</p> 
<p>&gt;&gt;&gt; np.rot90(array, k=-1)<br> array([[12,  8,  4,  0],<br>        [13,  9,  5,  1],<br>        [14, 10,  6,  2],<br>        [15, 11,  7,  3]])<br> &gt;&gt;&gt; np.rot90(array, k=-2)<br> array([[15, 14, 13, 12],<br>        [11, 10,  9,  8],<br>        [ 7,  6,  5,  4],<br>        [ 3,  2,  1,  0]])<br> &gt;&gt;&gt; np.rot90(array, k=-3)<br> array([[ 3,  7, 11, 15],<br>        [ 2,  6, 10, 14],<br>        [ 1,  5,  9, 13],<br>        [ 0,  4,  8, 12]])</p> 
<p>不使用numpy，只用列表推导式也能实现旋转：</p> 
<h4 id="%E9%A1%BA%E6%97%B6%E9%92%88%E6%97%8B%E8%BD%AC">顺时针旋转</h4> 
<p>&gt;&gt;&gt; matrix = lambda n:[[*range(i*n,i*n+n)] for i in range(n)]<br> &gt;&gt;&gt; mat4 = matrix(4)<br> &gt;&gt;&gt; mat4<br> [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]]<br> &gt;&gt;&gt; [[mat[len(mat[0])-j-1][i] for j in range(len(mat[0]))] for i in range(len(mat))]<br> [[12, 8, 4, 0], [13, 9, 5, 1], [14, 10, 6, 2], [15, 11, 7, 3]]</p> 
<p>写一个模拟np.array的__repr__方法来检测旋转效果：</p> 
<pre><code class="language-python">class List():# 仅支持二维数组的展示
    def __init__(self, lst):
        self.x = lst
    def __repr__(self):
        n = len(str(max(sum(self.x,[]))))
        res = []
        for mat in self.x:
            res.append(', '.join(f'{x:&gt;{n}}' for x in mat))
        return '],\n\t['.join(res).join(['Array([ [','] ])'])</code></pre> 
<p>检测结果如下：</p> 
<p>&gt;&gt;&gt; matrix = lambda n:[[*range(i*n,i*n+n)] for i in range(n)]<br> &gt;&gt;&gt; rotate = lambda m: [[m[len(m)-j-1][i] for j in range(len(m))] for i in range(len(m[0]))]<br> &gt;&gt;&gt; mat4 =matrix(4)<br> &gt;&gt;&gt; List(mat4)<br> Array([ [ 0,  1,  2,  3],<br>     [ 4,  5,  6,  7],<br>     [ 8,  9, 10, 11],<br>     [12, 13, 14, 15] ])<br> &gt;&gt;&gt; List(rotate(mat4))<br> Array([ [12,  8,  4,  0],<br>     [13,  9,  5,  1],<br>     [14, 10,  6,  2],<br>     [15, 11,  7,  3] ])<br> &gt;&gt;&gt; List(rotate(rotate(mat4)))<br> Array([ [15, 14, 13, 12],<br>     [11, 10,  9,  8],<br>     [ 7,  6,  5,  4],<br>     [ 3,  2,  1,  0] ])<br> &gt;&gt;&gt; List(rotate(rotate(rotate(mat4))))<br> Array([ [ 3,  7, 11, 15],<br>     [ 2,  6, 10, 14],<br>     [ 1,  5,  9, 13],<br>     [ 0,  4,  8, 12] ])<br> &gt;&gt;&gt; List(rotate(rotate(rotate(rotate(mat4)))))<br> Array([ [ 0,  1,  2,  3],<br>     [ 4,  5,  6,  7],<br>     [ 8,  9, 10, 11],<br>     [12, 13, 14, 15] ])</p> 
<p>结果符合预期，旋转4次恢复原样；同样更高阶方阵也符合：</p> 
<p>&gt;&gt;&gt; List(matrix(5))<br> Array([ [ 0,  1,  2,  3,  4],<br>     [ 5,  6,  7,  8,  9],<br>     [10, 11, 12, 13, 14],<br>     [15, 16, 17, 18, 19],<br>     [20, 21, 22, 23, 24] ])<br> &gt;&gt;&gt; List(rotate(matrix(5)))<br> Array([ [20, 15, 10,  5,  0],<br>     [21, 16, 11,  6,  1],<br>     [22, 17, 12,  7,  2],<br>     [23, 18, 13,  8,  3],<br>     [24, 19, 14,  9,  4] ])</p> 
<h4 id="%E9%80%86%E6%97%B6%E9%92%88%E6%97%8B%E8%BD%AC">逆时针旋转</h4> 
<p>&gt;&gt;&gt; matrix = lambda n:[[*range(i*n,i*n+n)] for i in range(n)]<br> &gt;&gt;&gt; rotate2 = lambda m:[[m[j][len(m[0])-i-1] for j in range(len(m))] for i in range(len(m[0]))]<br> &gt;&gt;&gt; List(rotate2(matrix(4)))<br> Array([ [ 3,  7, 11, 15],<br>     [ 2,  6, 10, 14],<br>     [ 1,  5,  9, 13],<br>     [ 0,  4,  8, 12] ])<br> &gt;&gt;&gt; List(rotate2(rotate2(matrix(4))))<br> Array([ [15, 14, 13, 12],<br>     [11, 10,  9,  8],<br>     [ 7,  6,  5,  4],<br>     [ 3,  2,  1,  0] ])<br> &gt;&gt;&gt; List(rotate2(rotate2(rotate2(matrix(4)))))<br> Array([ [12,  8,  4,  0],<br>     [13,  9,  5,  1],<br>     [14, 10,  6,  2],<br>     [15, 11,  7,  3] ])<br> &gt;&gt;&gt; List(rotate2(rotate2(rotate2(rotate2(matrix(4))))))<br> Array([ [ 0,  1,  2,  3],<br>     [ 4,  5,  6,  7],<br>     [ 8,  9, 10, 11],<br>     [12, 13, 14, 15] ])<br> &gt;&gt;&gt; List(rotate2(matrix(5)))<br> Array([ [ 4,  9, 14, 19, 24],<br>     [ 3,  8, 13, 18, 23],<br>     [ 2,  7, 12, 17, 22],<br>     [ 1,  6, 11, 16, 21],<br>     [ 0,  5, 10, 15, 20] ])<br> &gt;&gt;&gt; List(rotate2(rotate2(matrix(5))))<br> Array([ [24, 23, 22, 21, 20],<br>     [19, 18, 17, 16, 15],<br>     [14, 13, 12, 11, 10],<br>     [ 9,  8,  7,  6,  5],<br>     [ 4,  3,  2,  1,  0] ])</p> 
<h3 id="mxn%E7%9F%A9%E9%98%B5">mxn矩阵</h3> 
<p>把方阵拓展到矩阵：</p> 
<p>&gt;&gt;&gt; matrix = lambda m, n: [[i * n + j for j in range(n)] for i in range(m)]<br> &gt;&gt;&gt; List(matrix(3,4))<br> Array([ [ 0,  1,  2,  3],<br>     [ 4,  5,  6,  7],<br>     [ 8,  9, 10, 11] ])<br> &gt;&gt;&gt; List(matrix(5,4))<br> Array([ [ 0,  1,  2,  3],<br>     [ 4,  5,  6,  7],<br>     [ 8,  9, 10, 11],<br>     [12, 13, 14, 15],<br>     [16, 17, 18, 19] ])<br> &gt;&gt;&gt; List(matrix(5,5))<br> Array([ [ 0,  1,  2,  3,  4],<br>     [ 5,  6,  7,  8,  9],<br>     [10, 11, 12, 13, 14],<br>     [15, 16, 17, 18, 19],<br>     [20, 21, 22, 23, 24] ])</p> 
<h3 id="%E7%9F%A9%E9%98%B5%E6%97%8B%E8%BD%AC">矩阵旋转</h3> 
<p>rotate顺时针旋转，rotate2逆时针旋转</p> 
<p>&gt;&gt;&gt; matrix = lambda m, n: [[i * n + j for j in range(n)] for i in range(m)]<br> &gt;&gt;&gt; rotate = lambda m: [[m[len(m)-j-1][i] for j in range(len(m))] for i in range(len(m[0]))]<br> &gt;&gt;&gt; rotate2 = lambda m:[[m[j][len(m[0])-i-1] for j in range(len(m))] for i in range(len(m[0]))]<br> &gt;&gt;&gt; List(matrix(3,4))<br> Array([ [ 0,  1,  2,  3],<br>     [ 4,  5,  6,  7],<br>     [ 8,  9, 10, 11] ])<br> &gt;&gt;&gt; List(rotate(matrix(3,4)))<br> Array([ [ 8,  4,  0],<br>     [ 9,  5,  1],<br>     [10,  6,  2],<br>     [11,  7,  3] ])<br> &gt;&gt;&gt; List(rotate2(rotate2(rotate2(matrix(3,4)))))<br> Array([ [ 8,  4,  0],<br>     [ 9,  5,  1],<br>     [10,  6,  2],<br>     [11,  7,  3] ])<br> &gt;&gt;&gt; List(rotate(rotate(matrix(3,4))))<br> Array([ [11, 10,  9,  8],<br>     [ 7,  6,  5,  4],<br>     [ 3,  2,  1,  0] ])<br> &gt;&gt;&gt; List(rotate2(rotate2(matrix(3,4))))<br> Array([ [11, 10,  9,  8],<br>     [ 7,  6,  5,  4],<br>     [ 3,  2,  1,  0] ])<br> &gt;&gt;&gt; List(rotate(rotate(rotate(matrix(3,4)))))<br> Array([ [ 3,  7, 11],<br>     [ 2,  6, 10],<br>     [ 1,  5,  9],<br>     [ 0,  4,  8] ])<br> &gt;&gt;&gt; List(rotate2(matrix(3,4)))<br> Array([ [ 3,  7, 11],<br>     [ 2,  6, 10],<br>     [ 1,  5,  9],<br>     [ 0,  4,  8] ])<br> &gt;&gt;&gt; List(rotate(rotate(rotate(rotate(matrix(3,4))))))<br> Array([ [ 0,  1,  2,  3],<br>     [ 4,  5,  6,  7],<br>     [ 8,  9, 10, 11] ])<br> List(rotate2(rotate2(rotate2(rotate2(matrix(3,4))))))<br> Array([ [ 0,  1,  2,  3],<br>     [ 4,  5,  6,  7],<br>     [ 8,  9, 10, 11] ])</p> 
<p>旋转函数还能写成如下形式，只是坐标与range参数的互调形式：</p> 
<p>&gt;&gt;&gt; rotate = lambda m: [[m[j][i] for j in range(len(m)-1,-1,-1)] for i in range(len(m[0]))]<br> &gt;&gt;&gt; rotate2 = lambda m: [[m[j][i] for j in range(len(m))] for i in range(len(m[0])-1,-1,-1)]</p> 
<p>lambda匿名函数虽然很简洁，但没有普通函数易懂，我们把lambda函数改成模拟np.rot90()的普通函数rotate(matrix, k=1)，其中参数k为90度的倍数，正数顺时针旋转，负数则逆时针旋转：</p> 
<pre><code class="language-python">def rotate(matrix, k=1):
    rows = len(matrix)
    cols = len(matrix[0])
    res = [[0]*rows for _ in range(cols)]
    k %= 4
    if k==1:
        for i in range(rows):
            for j in range(cols):
                res[j][rows-i-1] = matrix[i][j]
    elif k==2:
        res = [[0]*cols for _ in range(rows)]
        for i in range(rows):
            for j in range(cols):
                res[rows-i-1][cols-j-1] = matrix[i][j]
    elif k==3:
        for i in range(rows):
            for j in range(cols):
                res[cols-j-1][i] = matrix[i][j]
    else:
        return matrix
    return res</code></pre> 
<h4 id="%E6%B5%8B%E8%AF%95%E4%BB%A3%E7%A0%81">测试代码</h4> 
<pre><code class="language-python">def rotate(matrix, k=1):
    rows = len(matrix)
    cols = len(matrix[0])
    res = [[0]*rows for _ in range(cols)]
    k %= 4
    if k==1:
        for i in range(rows):
            for j in range(cols):
                res[j][rows-i-1] = matrix[i][j]
    elif k==2:
        res = [[0]*cols for _ in range(rows)]
        for i in range(rows):
            for j in range(cols):
                res[rows-i-1][cols-j-1] = matrix[i][j]
    elif k==3:
        for i in range(rows):
            for j in range(cols):
                res[cols-j-1][i] = matrix[i][j]
    else:
        return matrix
    return res


def show(matrix):
    n = len(str(max(sum(matrix,[]))))
    res = []
    for mat in matrix:
        res.append(', '.join(f'{x:&gt;{n}}' for x in mat))
    print('],\n\t['.join(res).join(['Array([ [','] ])']))


matrix = lambda m, n: [[i * n + j for j in range(n)] for i in range(m)]

for i in range(-4,5):
    show(rotate(matrix(4,4), i))

for i in range(-4,5):
    show(rotate(matrix(5,3), i))</code></pre> 
<h4 id="%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C">测试结果</h4> 
<p>Array([ [ 0,  1,  2,  3],<br>     [ 4,  5,  6,  7],<br>     [ 8,  9, 10, 11],<br>     [12, 13, 14, 15] ])<br> Array([ [12,  8,  4,  0],<br>     [13,  9,  5,  1],<br>     [14, 10,  6,  2],<br>     [15, 11,  7,  3] ])<br> Array([ [15, 14, 13, 12],<br>     [11, 10,  9,  8],<br>     [ 7,  6,  5,  4],<br>     [ 3,  2,  1,  0] ])<br> Array([ [ 3,  7, 11, 15],<br>     [ 2,  6, 10, 14],<br>     [ 1,  5,  9, 13],<br>     [ 0,  4,  8, 12] ])<br> Array([ [ 0,  1,  2,  3],<br>     [ 4,  5,  6,  7],<br>     [ 8,  9, 10, 11],<br>     [12, 13, 14, 15] ])<br> Array([ [12,  8,  4,  0],<br>     [13,  9,  5,  1],<br>     [14, 10,  6,  2],<br>     [15, 11,  7,  3] ])<br> Array([ [15, 14, 13, 12],<br>     [11, 10,  9,  8],<br>     [ 7,  6,  5,  4],<br>     [ 3,  2,  1,  0] ])<br> Array([ [ 3,  7, 11, 15],<br>     [ 2,  6, 10, 14],<br>     [ 1,  5,  9, 13],<br>     [ 0,  4,  8, 12] ])<br> Array([ [ 0,  1,  2,  3],<br>     [ 4,  5,  6,  7],<br>     [ 8,  9, 10, 11],<br>     [12, 13, 14, 15] ])<br> Array([ [ 0,  1,  2],<br>     [ 3,  4,  5],<br>     [ 6,  7,  8],<br>     [ 9, 10, 11],<br>     [12, 13, 14] ])<br> Array([ [12,  9,  6,  3,  0],<br>     [13, 10,  7,  4,  1],<br>     [14, 11,  8,  5,  2] ])<br> Array([ [14, 13, 12],<br>     [11, 10,  9],<br>     [ 8,  7,  6],<br>     [ 5,  4,  3],<br>     [ 2,  1,  0] ])<br> Array([ [ 2,  5,  8, 11, 14],<br>     [ 1,  4,  7, 10, 13],<br>     [ 0,  3,  6,  9, 12] ])<br> Array([ [ 0,  1,  2],<br>     [ 3,  4,  5],<br>     [ 6,  7,  8],<br>     [ 9, 10, 11],<br>     [12, 13, 14] ])<br> Array([ [12,  9,  6,  3,  0],<br>     [13, 10,  7,  4,  1],<br>     [14, 11,  8,  5,  2] ])<br> Array([ [14, 13, 12],<br>     [11, 10,  9],<br>     [ 8,  7,  6],<br>     [ 5,  4,  3],<br>     [ 2,  1,  0] ])<br> Array([ [ 2,  5,  8, 11, 14],<br>     [ 1,  4,  7, 10, 13],<br>     [ 0,  3,  6,  9, 12] ])<br> Array([ [ 0,  1,  2],<br>     [ 3,  4,  5],<br>     [ 6,  7,  8],<br>     [ 9, 10, 11],<br>     [12, 13, 14] ])</p> 
<h3 id="%E7%BF%BB%E8%BD%AC%E5%92%8C%E8%BD%AC%E7%BD%AE">翻转和转置</h3> 
<p>翻转可以是水平方向和重置方向的：</p> 
<p>&gt;&gt;&gt; matrix = lambda m, n: [[i * n + j for j in range(n)] for i in range(m)]<br> &gt;&gt;&gt; flipH = lambda m: [[m[i][len(m[0])-j-1] for j in range(len(m[0]))] for i in range(len(m))]<br> &gt;&gt;&gt; flipV = lambda m: [[m[len(m)-j-1][i] for i in range(len(m[0]))] for j in range(len(m))]<br> &gt;&gt;&gt; List(flipH(matrix(4,4)))<br> Array([ [ 3,  2,  1,  0],<br>     [ 7,  6,  5,  4],<br>     [11, 10,  9,  8],<br>     [15, 14, 13, 12] ])<br> &gt;&gt;&gt; List(flipV(matrix(4,4)))<br> Array([ [12, 13, 14, 15],<br>     [ 8,  9, 10, 11],<br>     [ 4,  5,  6,  7],<br>     [ 0,  1,  2,  3] ])<br> &gt;&gt;&gt; List(flipH(matrix(3,5)))<br> Array([ [ 4,  3,  2,  1,  0],<br>     [ 9,  8,  7,  6,  5],<br>     [14, 13, 12, 11, 10] ])<br> &gt;&gt;&gt; List(flipV(matrix(3,5)))<br> Array([ [10, 11, 12, 13, 14],<br>     [ 5,  6,  7,  8,  9],<br>     [ 0,  1,  2,  3,  4] ])<br> &gt;&gt;&gt; List(flipH(matrix(5,4)))<br> Array([ [ 3,  2,  1,  0],<br>     [ 7,  6,  5,  4],<br>     [11, 10,  9,  8],<br>     [15, 14, 13, 12],<br>     [19, 18, 17, 16] ])<br> &gt;&gt;&gt; List(flipV(matrix(5,4)))<br> Array([ [16, 17, 18, 19],<br>     [12, 13, 14, 15],<br>     [ 8,  9, 10, 11],<br>     [ 4,  5,  6,  7],<br>     [ 0,  1,  2,  3] ])</p> 
<p>转置可以看作是翻转和旋转的组合，对方阵来说就是以对角线为轴的翻转：</p> 
<p>&gt;&gt;&gt; transpose = lambda m: [[m[j][i] for j in range(len(m))] for i in range(len(m[0]))]<br> &gt;&gt;&gt; List(transpose(matrix(4,4)))<br> Array([ [ 0,  4,  8, 12],<br>     [ 1,  5,  9, 13],<br>     [ 2,  6, 10, 14],<br>     [ 3,  7, 11, 15] ])<br> &gt;&gt;&gt; List(transpose(transpose(matrix(4,4))))<br> Array([ [ 0,  1,  2,  3],<br>     [ 4,  5,  6,  7],<br>     [ 8,  9, 10, 11],<br>     [12, 13, 14, 15] ])<br> &gt;&gt;&gt; List(rotate(matrix(4,4)))<br> Array([ [12,  8,  4,  0],<br>     [13,  9,  5,  1],<br>     [14, 10,  6,  2],<br>     [15, 11,  7,  3] ])<br> &gt;&gt;&gt; List(flipH(rotate(matrix(4,4))))<br> Array([ [ 0,  4,  8, 12],<br>     [ 1,  5,  9, 13],<br>     [ 2,  6, 10, 14],<br>     [ 3,  7, 11, 15] ])<br> &gt;&gt;&gt; List(rotate2(matrix(4,4)))<br> Array([ [ 3,  7, 11, 15],<br>     [ 2,  6, 10, 14],<br>     [ 1,  5,  9, 13],<br>     [ 0,  4,  8, 12] ])<br> &gt;&gt;&gt; List(flipV(rotate2(matrix(4,4))))<br> Array([ [ 0,  4,  8, 12],<br>     [ 1,  5,  9, 13],<br>     [ 2,  6, 10, 14],<br>     [ 3,  7, 11, 15] ])</p> 
<p>在numpy中，转置由.T属性完成</p> 
<p>&gt;&gt;&gt; import numpy as np<br> &gt;&gt;&gt; arr = np.array(matrix(3,4))<br> &gt;&gt;&gt; arr<br> array([[ 0,  1,  2,  3],<br>        [ 4,  5,  6,  7],<br>        [ 8,  9, 10, 11]])<br> &gt;&gt;&gt; arr.T<br> array([[ 0,  4,  8],<br>        [ 1,  5,  9],<br>        [ 2,  6, 10],<br>        [ 3,  7, 11]])<br> &gt;&gt;&gt; arr = np.array(matrix(4,4))<br> &gt;&gt;&gt; arr.T<br> array([[ 0,  4,  8, 12],<br>        [ 1,  5,  9, 13],<br>        [ 2,  6, 10, 14],<br>        [ 3,  7, 11, 15]])<br> &gt;&gt;&gt; arr.T.T<br> array([[ 0,  1,  2,  3],<br>        [ 4,  5,  6,  7],<br>        [ 8,  9, 10, 11],<br>        [12, 13, 14, 15]])<br> &gt;&gt;&gt; arr = np.array(matrix(5,4))<br> &gt;&gt;&gt; arr.T<br> array([[ 0,  4,  8, 12, 16],<br>        [ 1,  5,  9, 13, 17],<br>        [ 2,  6, 10, 14, 18],<br>        [ 3,  7, 11, 15, 19]])</p> 
<hr> 
<p>完</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c66a5d541afbb5bff87ee2957ef57f47/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">SpringBoot 集成 RabbitMQ</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/97279637bc7031db3f442860ffcee020/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【zookeeper】在Windows上启动zookeeper</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>