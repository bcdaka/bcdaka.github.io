<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【多线程】进程与线程 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/70ab9483cea3d59619cb2d417dccea2d/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【多线程】进程与线程">
  <meta property="og:description" content="🥰🥰🥰来都来了，不妨点个关注叭！
👉博客主页：欢迎各位大佬!👈
文章目录 1. 操作系统2. 进程2.1 进程是什么2.2 进程管理2.3 进程调度2.3 内存管理2.4 进程间通信 3. 线程3.1 线程是什么3.2 多线程编程3.3 线程与进程联系与区别 1. 操作系统 【概念】是一个软件，是一组做计算机资源管理的软件统称，非常复杂，所以操作系统本身是一个很大的话题(这里简单了解，引入进程概念)
【常见的操作系统】
【基本功能】
1）防止硬件被时空的应用程序滥用
2）向应用程序提供简单一致的机制来控制复杂低级硬件设备
【对上】要给软件提供稳定的运行环境
【对下】要管理好各种硬件设备
操作系统的功能非常多，其中一个与我们密切相关的功能模块—&gt;进程管理
接下来让我们一起来看看，进程是什么吧~~~
2. 进程 2.1 进程是什么 【进程】也称作任务，一个运行起来的程序，就是进程~
这个.exe是一个可执行文件，即程序，当我们双击这个exe，这个程序微信就运行起来，在系统中形成一个进程
即进程是操作系统对一个正在运行的程序的一种抽象，可以把进程看做程序的一次运行过程
【基本单位】进程是操作系统进行资源分配的基本单位
(此处涉及到的资源包括不限于内存，硬盘，CPU等等)
在任务管理器中，我们可以看到电脑的进程，打开任务管理器的快捷键为Ctrl&#43;Alt&#43;Del，如图：
通过任务管理器，我们能看到系统中有如此多的进程都在跑着！那么进程有如此之多，如何去管理呢~
2.2 进程管理 所谓进程管理，即进程多了才需要管理，分为以下两步：
1）描述一个进程：使用结构体/类，表示一个进程的信息
2）组织这些进程：使用一定的数据结构，把这些结构体/对象放到一起
举一个生活中常见的栗子叭~
一个大型超市，有特别多的商品，超市需要管理这些商品，建立一个商品信息管理系统，需要做：
1）明确每个商品的相关信息(价格、生产日期等)
2）通过一定的数据结构将这些商品信息都组织起来(如通过表格等)
2.3 进程调度 【进程调度概念】操作系统对CPU资源的分配，采用时间模式，不同的进程在不同的时间段去使用 CPU 资源即为进程调度~
先来了解进程的基本知识叭~
在Java中，我们通过类/对象描述这个特征，即每一个PCB对象代表一个在运行的程序即进程
进程类—&gt; PCB(process control block)
class PCB { //属性1 pid //属性2 内存指针 //属性3 文件描述表 //属性4 进程调度信息 //.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-12T21:01:19+08:00">
    <meta property="article:modified_time" content="2024-06-12T21:01:19+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【多线程】进程与线程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p><font color="A0B0A5" face="微软雅黑" size="5">🥰🥰🥰来都来了，不妨点个关注叭！</font><br> <a href="https://blog.csdn.net/m0_61814277?type=blog"><font size="5" face="微软雅黑">👉博客主页：欢迎各位大佬!👈</font></a></p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/1a/8f/pFb3mcgJ_o.png" alt="在这里插入图片描述"><br> </p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#1__5" rel="nofollow">1. 操作系统</a></li><li><a href="#2__17" rel="nofollow">2. 进程</a></li><li><ul><li><a href="#21__18" rel="nofollow">2.1 进程是什么</a></li><li><a href="#22__28" rel="nofollow">2.2 进程管理</a></li><li><a href="#23__38" rel="nofollow">2.3 进程调度</a></li><li><a href="#23__90" rel="nofollow">2.3 内存管理</a></li><li><a href="#24__100" rel="nofollow">2.4 进程间通信</a></li></ul> 
  </li><li><a href="#3__106" rel="nofollow">3. 线程</a></li><li><ul><li><a href="#31__107" rel="nofollow">3.1 线程是什么</a></li><li><a href="#32___118" rel="nofollow">3.2 多线程编程</a></li><li><a href="#33__138" rel="nofollow">3.3 线程与进程联系与区别</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="1__5"></a>1. 操作系统</h2> 
<p>【<strong>概念</strong>】是一个<strong>软件</strong>，是一组做<strong>计算机资源管理</strong>的软件统称，非常复杂，所以操作系统本身是一个很大的话题(这里简单了解，引入进程概念)<br> 【<strong>常见的操作系统</strong>】<br> <img src="https://images2.imgbox.com/5a/5b/neNhFr7U_o.png" alt="在这里插入图片描述"><br> 【<strong>基本功能</strong>】<br> 1）防止硬件被时空的应用程序滥用<br> 2）向应用程序提供简单一致的机制来控制复杂低级硬件设备<br> <img src="https://images2.imgbox.com/73/ce/o7Zf0T0m_o.png" alt="在这里插入图片描述"><br> 【<strong>对上</strong>】要给<strong>软件提供稳定的运行环境</strong><br> 【<strong>对下</strong>】要<strong>管理好</strong>各种<strong>硬件设备</strong><br> 操作系统的功能非常多，其中一个与我们密切相关的功能模块—&gt;<strong>进程管理</strong><br> 接下来让我们一起来看看，进程是什么吧~~~</p> 
<h2><a id="2__17"></a>2. 进程</h2> 
<h3><a id="21__18"></a>2.1 进程是什么</h3> 
<p>【<strong>进程</strong>】也称作<strong>任务</strong>，<strong>一个运行起来的程序</strong>，就是进程~<br> <img src="https://images2.imgbox.com/11/c3/b7iaK0ZU_o.png" alt="在这里插入图片描述"><br> 这个.exe是一个可执行文件，即程序，当我们双击这个exe，这个程序微信就运行起来，在系统中形成一个进程<br> 即进程是操作系统对一个正在运行的程序的一种抽象，可以把<strong>进程看做程序的一次运行过程</strong><br> 【<strong>基本单位</strong>】<strong>进程</strong>是操作系统进行<strong>资源分配</strong>的<strong>基本单位</strong><br> (此处涉及到的资源包括不限于内存，硬盘，CPU等等)<br> 在任务管理器中，我们可以看到电脑的进程，打开任务管理器的快捷键为Ctrl+Alt+Del，如图：<br> <img src="https://images2.imgbox.com/0b/2f/WitdYZW3_o.png" alt="在这里插入图片描述"><br> 通过任务管理器，我们能看到系统中有如此多的进程都在跑着！那么进程有如此之多，如何去管理呢~</p> 
<h3><a id="22__28"></a>2.2 进程管理</h3> 
<p>所谓进程管理，即进程多了才需要管理，分为以下两步：</p> 
<blockquote> 
 <p>1）<strong>描述一个进程</strong>：使用结构体/类，表示一个进程的信息<br> 2）<strong>组织这些进程</strong>：使用一定的数据结构，把这些结构体/对象放到一起</p> 
</blockquote> 
<p>举一个生活中常见的栗子叭~<br> 一个大型超市，有特别多的商品，超市需要管理这些商品，建立一个商品信息管理系统，需要做：<br> 1）明确每个商品的<strong>相关信息</strong>(价格、生产日期等)<br> 2）通过<strong>一定的数据结构</strong>将这些商品信息都组织起来(如通过表格等)</p> 
<h3><a id="23__38"></a>2.3 进程调度</h3> 
<p>【<strong>进程调度概念</strong>】操作系统对<strong>CPU资源</strong>的分配，采用<strong>时间</strong>模式，<strong>不同的进程在不同的时间段去使用 CPU 资源即为进程调度~</strong><br> 先来了解进程的基本知识叭~<br> 在Java中，我们通过类/对象描述这个特征，即<strong>每一个PCB对象代表一个在运行的程序即进程</strong><br> 进程类—&gt; <strong>PCB</strong>(process control block)</p> 
<pre><code class="prism language-c">class PCB <span class="token punctuation">{<!-- --></span>
<span class="token comment">//属性1 pid</span>
<span class="token comment">//属性2 内存指针</span>
<span class="token comment">//属性3 文件描述表</span>
<span class="token comment">//属性4 进程调度信息</span>
<span class="token comment">//...</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>操作系统再通过数据结构把PCB对象组织起来，往往使用<strong>双向链表</strong>来组织PCB对象，进程相当于链表中的节点，方便管理时进行增删改查的操作</p> 
<blockquote> 
 <ol><li>创建一个进程，即创建一个链表的节点</li><li>销毁一个进程，即把链表的节点删除</li><li>遍历进程列表，即遍历链表</li></ol> 
</blockquote> 
<p>PCB中的属性非常多，在这里枚举4个核心的属性：<br> 1）<strong>pid</strong><br> 每个进程需要有一个唯一的身份标识(如每个人都有独一无二的身份证~~)<br> 2）<strong>内存指针</strong><br> 当前这个进程使用的内存是哪一部分(进程要跑起来，就需要消耗一定的硬件资源，比如内存~进程运行的时候，使用哪些内存上的资源)<br> 3）<strong>文件描述符表</strong><br> 进程每次打开一个文件，就会产生一个"文件描述符"，标识了这个被打开的文件，一个进程可能会打开很多文件，对应一组文件描述符，把这些文件描述符放到一个<strong>顺序表</strong>这样的结构，构成文件描述符表<br> 4）<strong>进程调度信息</strong><br> 这一组属性都是描述和CPU资源相关的属性，这些属性都辅助进行<strong>进程调度</strong><br> 【<strong>预备知识</strong>】先来了解了解CPU！<br> 我们的程序能运行，全靠CPU，每一个程序相当于一组"<strong>二进制指令</strong>"的集合<br> CPU中的一个概念：<strong>核心数</strong>(在任务管理器中可以看到我们电脑的核心数)<br> <img src="https://images2.imgbox.com/aa/54/wtCriahf_o.png" alt="在这里插入图片描述"><br> 这个表示16核32线程，即CPU里有16个核心，每个核心顶两个！16个人可以干32个人的活~<br> 但是我们可以看到一个电脑上可以运行很多程序，不止这些，那么计算机是如何做的呢~<br> 【<strong>并行</strong>】同一时刻，两个核心同时执行两个进程，此时这两个进程就是并行执行的(<strong>强调同时</strong>)<br> 【<strong>并发</strong>】一个核心先执行进程1执行一会后再去执行进程2…只要这里切换进程的速度足够快，看起来进程1和2就是"同时"进行的<br> 所以虽然只有这些核心，但是也可以同时执行很多很多个任务啦~<br> 在计算机中，通过并行+并发的方式来完成的(由操作系统控制，我们感知不到的~)所以很多时候把并行+并发统称为并发！<br> 【<strong>进程调度意义</strong>】如上所述，<strong>进程调度就是为了解决电脑核心数是固定的但是电脑有很多程序要运行的问题</strong>~<br> A) <strong>进程状态</strong><br> 简单认为进程状态主要是这两个：<br> 【<strong>就绪态</strong>】该进程已准备好，随时可以上CPU执行<br> 【<strong>阻塞态</strong>】该进程暂时无法上CPU执行<br> B）<strong>进程的优先级</strong><br> 进程之间的调度不一定是"公平"的，有的会优先调度(在现实生活中，我们也会将事情根据重要性排个序，有的事情就需要优先做~)<br> C) <strong>进程的上下文</strong><br> 即描述当前进程执行到哪里的"存档记录"，进程在暂时离开CPU时把当前运行的中间结果进行"存档"，等下次进程回到CPU执行时，恢复之前的"存档"，从上次的结果继续往后执行(即记录离开结果，这样回来时我可以从离开的地方继续执行)具体过程如下：<br> <img src="https://images2.imgbox.com/8a/9f/tljPnuZz_o.png" alt="在这里插入图片描述"><br> D)<strong>进程的记账信息</strong><br> 统计了每个进程在CPU上执行多久(这个可以作为调度的参考依据~)</p> 
<h3><a id="23__90"></a>2.3 内存管理</h3> 
<p>操作系统对<strong>内存资源</strong>的分配，采用<strong>空间</strong>模式，不同进程使用内存中的不同区域，互相之间不会干扰，相互独立的~<br> 每个进程访问的内存地址<strong>并不是真实的物理内存地址</strong>，操作系统给进程分配的内存是以"<strong>虚拟地址空间</strong>"的方式进行分配的~<br> 【<strong>直接访问物理内存地址缺点</strong>】如果进程1内容改变则会可能会影响进程2的内存内容<br> (比如进程1数组下标越界、野指针情况等)<br> 【<strong>虚拟地址空间优点</strong>】<br> <img src="https://images2.imgbox.com/a1/8c/8rBo7niv_o.png" alt="在这里插入图片描述">【<strong>解释说明</strong>】站在进程角度，它们的代码操作的内存地址是图中0x00-0x33这一段，这里访问的内存就会被操作系统自动映射到真实的物理内存上，当然进程自己是感受不到实际物理内存地址是什么的，如果进程1代码出bug，就没有什么影响，因为<strong>任何一个内存操作都需要通过页表翻译</strong>，如果拿着这个地址发现页表没有这个地址，则不会翻译，也就不会修改真正物理内存，即不会对进程2的内存数据进行干扰<br> 1）方便校验，当前地址是否有效<br> 2）一个进程无法直接影响另一个进程的内存内容，每个地址都有自己独立的地址空间，具有独立性<br> 3）大大提升操作系统的稳定性</p> 
<h3><a id="24__100"></a>2.4 进程间通信</h3> 
<p>进程是操作系统进行资源分配的最小单位，即各个进程互相之间是无法感受到对方存在的，是相互独立的，这样<strong>进程之间</strong>互相具备"<strong>隔离性</strong>"，但有时候需要进程之间进行交互，相互配合~<br> 【<strong>进程间通信</strong>】即在隔离性前提下，<strong>找一个公共区域</strong>，让进程<strong>借助这个区域完成数据交换</strong><br> 【<strong>实现方式</strong>】操作系统提供进程间通信具体实现方式，有很多种，如以下：<br> 1）管道 2）共享内存 3）文件 4）信号 5）消息队列 6）网络 等等<br> 其中网络是一种相对特殊的 IPC 机制，支持<strong>同主机</strong>也支持<strong>同一网络内部非同一主机</strong>，进行进程间通信</p> 
<h2><a id="3__106"></a>3. 线程</h2> 
<h3><a id="31__107"></a>3.1 线程是什么</h3> 
<p>【<strong>线程</strong>】是更轻量的进程，约定：一个进程中可以包含多个线程，此时这多个线程的每一个线程都是一个可以调度执行一个独立的"执行流"，多个线程之间也是并发执行(多个线程可能是在多个CPU核心同时运行，也可能是在一个CPU核心上，通过快速调度进行运行)，同时<strong>这些线程共用同一份进程的系统资源</strong><br> 即对于线程来说，<strong>系统资源已经分配好，创建线程就省下分配资源开销</strong>，但是创建进程则需要系统分配资源，较耗时~<br> 【<strong>为什么资源分配如此耗时</strong>】<br> 比如系统要给进程分配一块内存需要做的以及遇到的情况：<br> 1）系统需遍历自己的空闲内存的表(数据结构) 找到差不多的空间，进行分配内存<br> 2）很多进程都在向系统申请资源~但是系统进行资源分配时候，得一个个来，很耗时<br> 【<strong>为什么要线程</strong>】<br> (1) 并发编程能更充分利用多核 CPU 资源，多进程编程和多线程编程都满足并发编程需求场景(并发编程即同一时刻要运行多个任务)<br> (2) 线程比进程更轻量，<strong>进程创建、销毁、调度成本高</strong>且速度慢不高效，线程则相反，<strong>线程创建、销毁、调度成本</strong>比进程<strong>低</strong>~(只有在进程启动，创建第一个线程的时候，需花成本去申请系统资源，一旦进程创建完毕，后续再创建的线程，就不需要再申请资源，这样创建/销毁的效率大大提高)<br> (3) 在Java中不鼓励多进程编程，<strong>非常鼓励多线程编程</strong>~</p> 
<h3><a id="32___118"></a>3.2 多线程编程</h3> 
<p>【<strong>意义</strong>】解决并发编程问题<br> 举个栗子吧！更加深入理解一下多进程和多线程编程~<br> 比如想加工一大批零件，有两种做法：<br> <strong>一是再建一个工厂重新再搭一套机器(多进程)</strong><br> <img src="https://images2.imgbox.com/65/07/7a9m9pld_o.png" alt="在这里插入图片描述">此时这两套机器可以同时生产，不过这种方式需要再建立一个工厂，建工厂比较麻烦，成本较高，但这两个工厂之间是相互独立的，相互不影响~<br> <strong>二是还在当前工厂，引进机器再弄一套生产线(多线程)</strong><br> <img src="https://images2.imgbox.com/c5/44/2my8oApF_o.png" alt="在这里插入图片描述"><br> 这两套机器也可以各自独立生产，是两个独立的执行流，共用同一个资源工厂，除工厂共用，存储原料/成品/仓库/物流运输等等，都能共用，成本降低~<br> 这两种方式均提高了工厂的生产效率，进程相当于工厂，线程相当于流水线~<br> 多进程工厂方式，需多建工厂，开销大，且两机器之间看不到对方进度<br> 多线程工厂方式，有两个机器，共用一个工厂，可以互相了解对方进度<br> 此时想要生产更多的零件，在工厂内弄更多的机器，以此提高生产效率，但是并不是越多越好，如下图：<br> <img src="https://images2.imgbox.com/9f/cd/0KNw0UFA_o.png" alt="在这里插入图片描述"><br> 1）一个工厂的大小提供的空间是固定的即CPU核心数是固定的，此时想进一步提高机器的数量，工厂已经没有空余位置了，机器只能在工厂外干着急~这时，<strong>程序的效率并没进一步提升，可能不仅没提升，可能还会下降，因为调度本身也是有开销的</strong>，调度上一个机器，需要把之前的机器移出来，再把这个机器移进去，有开销，总并发程度依旧固定<br> 2）机器是有脾气的，在这个调度来调度去的过程中，可能很生气很累，出现异常，<strong>如果一个线程出现异常，可能会带走整个进程！</strong><br> 在我们的电脑中：<br> 1）在同一程序中，内部需要并发完成多组任务，此时使用多线程比较合适(比如微信，可以同时的视频，也可以聊天，网络传输等等)<br> 2）多个程序之间，此时是多进程，进程之间具有"隔离性"(比如微信是一个进程，qq是一个进程等等)<br> 所以多进程和多线程在电脑中是同时存在的~不是多线程代替了全部！且多进程和多线程都是可以并发和并行的</p> 
<h3><a id="33__138"></a>3.3 线程与进程联系与区别</h3> 
<p>【<strong>联系</strong>】<br> 进程包含线程，一个进程可以有多个线程<br> 【<strong>区别</strong>】</p> 
<blockquote> 
 <p>(1) 进程有自己独立的内存空间和文件描述符表，同一进程多个线程之间共享同一份地址空间和文件描述符表<br> (2) 进程是操作系统资源分配的基本单位，线程是操作系统调度执行的基本单位<br> (3) <strong>进程具有独立性</strong>，一个进程不会影响另一个进程，但在同一进程的多个线程之间，一个线程挂了，可能会把整个线程带走，影响其它线程~<br> (4) 进程开销大，消耗资源多，线程执行开销小，但不利于资源的管理和保护</p> 
</blockquote> 
<p>💛💛💛本期内容回顾💛💛💛<br> <img src="https://images2.imgbox.com/f2/0d/Imv4Bnbc_o.png" alt="在这里插入图片描述"><br> ✨✨✨本期内容到此结束啦~下期再见！</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b68754b90495e0c2da031e8786159e03/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">数据结构之LinkedList与链表（上）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/214fbb8b92b3f4db8a761772ae637e02/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Python数据魔术】：揭秘类型奥秘，赋能代码创造</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>