<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>HarmonyOS NEXT星河版零基础入门（3） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/941291b26e7879be5fcbc9d79830fca9/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="HarmonyOS NEXT星河版零基础入门（3）">
  <meta property="og:description" content="1. 系统弹出框 import { promptAction } from &#39;@kit.ArkUI&#39;; @Component struct weChat { @State text:string =&#39;&#39; build(){ Column(){ Text(this.text ) Search({value:$$this.text}) Button(&#39;改值&#39;).onClick(()=&gt;{ promptAction.showToast({ message:this.text,duration:10000 }) }) } } } message是弹出的内容 duration是控制弹出的时间
2.interface转成class类 npm i -g interface2class 在IndexPage声明了两个interface
点击回车就自动生成了
3.vp/fp 不论是什么样的像素密度的设备，可呈现区域是一样的
fp---》字体大小
vp-----&gt;宽高大小
4. 写一个正方形 设置它的宽度 但不设定高度 不论屏幕怎么变实现他的宽高比 .aspectRatio(长/宽) 5.@State state修饰的数据是响应式数据，他只能检测到单层的数据变化，如果要更新多层
要么连带着更新单层要么重新new一个先声明interface，用工具生成class实现 interface2classinterface生命类型也是可以的 ，如果用到了嵌套更新，必须得用class 6.图片和资源 本地路径 线上路径 必须开启网络权限
svg着色-主题资源目录下-base/media(图片）(推荐）图片不需要跟后缀 rawfile（原始文件） 7.淘宝镜像 npm config get registry npm config set registry https://registry.npmirror.com/ 7.1windows 脚本禁用（操作策略 允许npm包的命令可执行） 8.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-16T15:58:58+08:00">
    <meta property="article:modified_time" content="2024-08-16T15:58:58+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">HarmonyOS NEXT星河版零基础入门（3）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3 id="main-toc">1. 系统弹出框</h3> 
<pre><code class="language-TypeScript">import { promptAction } from '@kit.ArkUI';
</code></pre> 
<pre><code class="language-TypeScript">@Component
struct weChat {
  @State text:string =''
  build(){
        Column(){
          Text(this.text )
          Search({value:$$this.text})
          Button('改值').onClick(()=&gt;{
        promptAction.showToast({
          message:this.text,duration:10000
        })
          })
        }

  }
}</code></pre> 
<p><span style="color:#fe2c24;">message是弹出的内容  duration是控制弹出的时间</span></p> 
<h3 id="2.interface%E8%BD%AC%E6%88%90class%E7%B1%BB">2.interface转成class类</h3> 
<pre><code class="language-TypeScript"> npm i -g interface2class
</code></pre> 
<p><img alt="" height="55" src="https://images2.imgbox.com/0e/a2/sohH3zsm_o.png" width="708"></p> 
<p>在IndexPage声明了两个interface</p> 
<p><img alt="" height="632" src="https://images2.imgbox.com/40/ea/dt5NRKgQ_o.png" width="1200"></p> 
<p></p> 
<p><img alt="" height="625" src="https://images2.imgbox.com/76/fc/HRzlgUeH_o.png" width="800"></p> 
<p><img alt="" height="777" src="https://images2.imgbox.com/1d/e3/ruEtUHDz_o.png" width="977"></p> 
<p>点击回车就自动生成了</p> 
<p><img alt="" height="831" src="https://images2.imgbox.com/87/97/ih5AdKkQ_o.png" width="537"></p> 
<h3 id="3.vp%2Ffp">3.vp/fp</h3> 
<p>不论是什么样的像素密度的设备，可呈现区域是一样的</p> 
<p>fp---》字体大小</p> 
<p>vp-----&gt;宽高大小</p> 
<h3 id="4.%C2%A0%20%C2%A0%E5%86%99%E4%B8%80%E4%B8%AA%E6%AD%A3%E6%96%B9%E5%BD%A2%C2%A0%20%E8%AE%BE%E7%BD%AE%E5%AE%83%E7%9A%84%E5%AE%BD%E5%BA%A6%20%E4%BD%86%E4%B8%8D%E8%AE%BE%E5%AE%9A%E9%AB%98%E5%BA%A6%20%E4%B8%8D%E8%AE%BA%E5%B1%8F%E5%B9%95%E6%80%8E%E4%B9%88%E5%8F%98%E5%AE%9E%E7%8E%B0%E4%BB%96%E7%9A%84%E5%AE%BD%E9%AB%98%E6%AF%94">4.   写一个正方形  设置它的宽度 但不设定高度 不论屏幕怎么变实现他的宽高比</h3> 
<pre><code class="language-TypeScript">.aspectRatio(长/宽)</code></pre> 
<h3 id="5.%40State">5.@State</h3> 
<p>state修饰的数据是响应式数据，他只能检测到单层的数据变化，如果要更新多层</p> 
<ul><li>要么连带着更新单层</li><li>要么重新new一个</li><li>先声明interface，用工具生成class实现 interface2class</li><li>interface生命类型也是可以的 ，如果用到了嵌套更新，必须得用class</li></ul> 
<h3 id="6.%E5%9B%BE%E7%89%87%E5%92%8C%E8%B5%84%E6%BA%90">6.图片和资源</h3> 
<ul><li>本地路径</li></ul> 
<p><img alt="" height="385" src="https://images2.imgbox.com/63/49/q0o438L0_o.png" width="1147"></p> 
<ul><li>线上路径</li></ul> 
<p>必须开启网络权限</p> 
<p><img alt="" height="498" src="https://images2.imgbox.com/af/79/tzVxOvY2_o.png" width="806"></p> 
<ul><li>svg着色-主题</li><li>资源目录下-base/media(图片）(推荐）图片不需要跟后缀</li></ul> 
<p><img alt="" height="553" src="https://images2.imgbox.com/19/08/G1DVBZ87_o.png" width="1200"></p> 
<ul><li>  rawfile（原始文件）</li><li><img alt="" height="600" src="https://images2.imgbox.com/30/f1/ESoy4pMu_o.png" width="974"></li></ul> 
<h3 id="7.%E6%B7%98%E5%AE%9D%E9%95%9C%E5%83%8F">7.淘宝镜像</h3> 
<pre><code class="language-javascript"> npm config get registry 
npm config set registry https://registry.npmirror.com/

</code></pre> 
<h4 id="7.1windows%20%E8%84%9A%E6%9C%AC%E7%A6%81%E7%94%A8%EF%BC%88%E6%93%8D%E4%BD%9C%E7%AD%96%E7%95%A5%20%E5%85%81%E8%AE%B8npm%E5%8C%85%E7%9A%84%E5%91%BD%E4%BB%A4%E5%8F%AF%E6%89%A7%E8%A1%8C%EF%BC%89">7.1windows 脚本禁用（操作策略 允许npm包的命令可执行）</h4> 
<p><img alt="" height="166" src="https://images2.imgbox.com/26/2b/m9nF6Z7Z_o.png" width="632"></p> 
<h3 id="8.%20es6%26ArkTS%E4%B8%AD%E7%9A%84%E5%AF%BC%E5%85%A5%E5%92%8C%E5%AF%BC%E5%87%BA">8. es6&amp;ArkTS中的导入和导出</h3> 
<p><img alt="" height="519" src="https://images2.imgbox.com/9f/de/Vh2CWcSa_o.png" width="1058"></p> 
<h3 id="9.%E6%8C%89%E9%92%AE%E5%88%87%E6%8D%A2%E7%BB%84%E4%BB%B6%20SegmentButton">9.按钮切换组件 SegmentButton</h3> 
<p><img alt="" height="654" src="https://images2.imgbox.com/26/e8/nMq1d5mB_o.png" width="1200"></p> 
<p><img alt="" height="327" src="https://images2.imgbox.com/41/e3/ZKjmOANo_o.png" width="1147"></p> 
<h3 id="10.waterFlow%E7%BB%84%E4%BB%B6">10.waterFlow组件</h3> 
<p><img alt="" height="600" src="https://images2.imgbox.com/66/41/9weSwMhH_o.png" width="1200"></p> 
<p>它的用法和Grid布局很像</p> 
<p><img alt="" height="651" src="https://images2.imgbox.com/48/38/VJK2JJdo_o.png" width="885"></p> 
<pre><code class="language-TypeScript">@Entry
@Component
struct WaterFlowPage {
  @State message: string = 'Hello water';

  build() {
    Column() {
         WaterFlow(){
           FlowItem(){
              Image('https://pic.rmb.bdstatic.com/bjh/gallery/03e17cba710868d9153176b50a5fca0d1090.jpeg').height(150)
                    }
           FlowItem(){
             Image('https://img1.baidu.com/it/u=1535232938,2370569369&amp;fm=253&amp;fmt=auto&amp;app=120&amp;f=JPEG?w=1280&amp;h=800').height(200)
           }
           FlowItem(){
             Image('https://img1.baidu.com/it/u=1535232938,2370569369&amp;fm=253&amp;fmt=auto&amp;app=120&amp;f=JPEG?w=1280&amp;h=800').height(200)
           }
}
.columnsTemplate('1fr 1fr ')
      .columnsGap(20)
      .padding(20)
      .rowsGap(20)
    }
    .height('100%')
    .width('100%')
  }
}</code></pre> 
<p>看下效果图</p> 
<p><img alt="" height="509" src="https://images2.imgbox.com/43/c1/wKMYbRf9_o.png" width="365"></p> 
<p></p> 
<p></p> 
<h4 id="%E5%A6%82%E6%9E%9C%E6%83%B3%E8%A6%81%E5%AE%9E%E7%8E%B0%E5%8A%A0%E8%BD%BD%E4%B8%8B%E4%B8%80%E9%A1%B5%20%E5%B0%B1%E5%BE%97%E7%94%A8%E5%88%B0%E5%8A%A0%E8%BD%BD%E4%B8%AD">如果想要实现加载下一页 就得用到加载中</h4> 
<pre><span style="color:#fe2c24;">WaterFlow({footer:this.Loading})</span></pre> 
<h4 id="%E5%92%8C%E6%BB%9A%E5%8A%A8%E5%88%B0%E5%BA%95%E9%83%A8%E7%9A%84%E4%BA%8B%E4%BB%B6%C2%A0">和滚动到底部的事件 </h4> 
<pre><span style="color:#fe2c24;">onReachEnd</span>
</pre> 
<p><img alt="" height="761" src="https://images2.imgbox.com/f0/9f/8NGC272z_o.png" width="995"></p> 
<p>全部代码： 11.11.</p> 
<p></p> 
<blockquote> 
 <pre><code class="language-TypeScript">import { GoodItem } from './modules'
import { promptAction } from '@kit.ArkUI'

@Entry
@Component
struct WaterFlowGoodPage {
  @State GoodList:GoodItem[]=[{

    goods_name:'dsfjlsjkfsf',
    goods_price:100,
    goods_img:'https://img1.baidu.com/it/u=1535232938,2370569369&amp;fm=253&amp;fmt=auto&amp;app=120&amp;f=JPEG?w=1280&amp;h=800',
    goods_count:1,
    id:1

  },
    {

      goods_name:'dfhlsdjflkdsjklfs 加速度的佛教山東i附件',
      goods_price:200,
      goods_img:'https://img1.baidu.com/it/u=2603934083,3021636721&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=889&amp;h=500',
      goods_count:2,
      id:2

    },
    {

      goods_name:'收到回复技术大会哦恶化日发方大化工iu而韩国佛热',
      goods_price:300,
      goods_img:'https://img0.baidu.com/it/u=4289818793,3552718550&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=889&amp;h=500',
      goods_count:3,
      id:3

    }
    ,{

      goods_name:'的時間佛薩飛機埃里克森放假哦i二fore多氟多化工i額方法過後i額外人',
      goods_price:400,
      goods_img:'https://img0.baidu.com/it/u=2080725050,2021436341&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=1200&amp;h=800',
      goods_count:4,
      id:4

    }
    ,{

      goods_name:'时间佛ID分机构IE',
      goods_price:500,
      goods_img:'https://img1.baidu.com/it/u=4202924242,2178453218&amp;fm=253&amp;fmt=auto&amp;app=120&amp;f=JPEG?w=1422&amp;h=800',
      goods_count:5,
      id:5

    }
    ,{

      goods_name:'司法鉴定哦is叫哦私人',
      goods_price:600,
      goods_img:'https://10wallpaper.com/wallpaper/1680x1050/1405/Lavender_mountain_river-Landscape_HD_Wallpaper_1680x1050.jpg',
      goods_count:6,
      id:6

    }
  ]

  //开启个阀门 意味着如果数据没有加载成功就不会继续加载
  @State isLoadding:boolean=false


   //加载中函数
  @Builder
  Loading(){
    Row(){
      Text(
        '加载中'
      )
      LoadingProgress()
        .width(20)

    }
    .width('100%')
    .justifyContent(FlexAlign.Center)
    .height(60)

  }

//加载下一页方法
  loadMore(){
    setTimeout(()=&gt;{
      this.GoodList.push(...this.GoodList.slice(0,9))
     this.isLoadding=false

    },1000)
  }
  build() {
    Column(){
      WaterFlow({footer:this.Loading}){
        ForEach(this.GoodList,(item:GoodItem,index:number)=&gt;{
          FlowItem(){
            Column({space:20}){
              Image(item.goods_img)
                .height(index%2?220:180)


              Text(item.goods_name)
                .fontSize(14)
            }
          }
        })

      }
      .onReachEnd(()=&gt;{
        if(!this.isLoadding){
          this.isLoadding=true

          this.loadMore()

        }


      })
      .columnsTemplate('1fr 1fr')
      .columnsGap(20)
      .rowsGap(20)



    }
    .height('100%')
    .width('100%')
    .padding(20)
  }
}</code></pre> 
</blockquote> 
<h3 id="11.%C2%A0async%2Fawait">11. async/await</h3> 
<p><img alt="" height="538" src="https://images2.imgbox.com/29/e9/7B7jW6Tn_o.png" width="1200"></p> 
<p>模拟一个网络请求</p> 
<p><img alt="" height="793" src="https://images2.imgbox.com/8b/37/hvOOv6Dt_o.png" width="913"></p> 
<h3 id="12.Builder%E5%92%8CBuilderParams%E7%9A%84%E5%8C%BA%E5%88%AB">12.Builder和BuilderParams的区别</h3> 
<p><img alt="" height="644" src="https://images2.imgbox.com/28/b9/butGYyLQ_o.png" width="1085"></p> 
<h3 id="13.%E5%B8%B8%E7%94%A8%E7%9A%84%E4%BF%AE%E9%A5%B0%E7%AC%A6%E6%9C%89%E5%93%AA%E4%BA%9B" style="background-color:transparent;">13.常用的修饰符有哪些</h3> 
<p></p> 
<h3 id="14.CustomDialog%E7%9A%84%E4%BD%BF%E7%94%A8">14.CustomDialog的使用</h3> 
<p><img alt="" height="236" src="https://images2.imgbox.com/62/fd/eTagaCTF_o.png" width="1027"></p> 
<pre><code class="language-TypeScript">@CustomDialog
struct PreviewDilog {
  controller: CustomDialogController = new CustomDialogController({ builder: CustomDialogController })
  url: ResourceStr | string = ''

  build() {
    Column() {
      Image(this.url)
        .width('100%')

    }
    .width('100%')
    .height('100%')
    .backgroundColor(Color.Black)
    .justifyContent(FlexAlign.Center)
    .onClick(() =&gt; {
      this.controller.close()
    })

  }
}</code></pre> 
<p>如果需要使用弹层 ，需要在使用的组件或者页面中显式的声明一个对象</p> 
<pre><code class="language-TypeScript">  @State selectImage: ResourceStr | string = ''
  previw: CustomDialogController = new CustomDialogController({
    builder: PreviewDilog({ url: this.selectImage }),//这里需要传入自定义弹层的对象
    customStyle: true //是否使用自定义样式


  })</code></pre> 
<p>弹层就两个方法</p> 
<ul><li>open--创建弹层组件-显示-会有动画的弹出<br>  </li><li>close--销毁组件-退出-会有动画的退出</li></ul> 
<p>涉及到Dialog传值</p> 
<p>因为open/close会创建和销毁组件，不会存在缓存现象，里边的参数实际上没有任何必要用修饰符</p> 
<p>在父组件中调用打开</p> 
<pre><code class="language-TypeScript"> GridItem() {
            Image(item.goods_img)
              .aspectRatio(1)
              .onClick(() =&gt; {
                this.selectImage = item.goods_img
                this.previw.open()
              })
          }</code></pre> 
<p>在本身组件中同样可以打开和关闭</p> 
<p><img alt="" height="614" src="https://images2.imgbox.com/3d/a7/QARA3CRF_o.png" width="1048"></p> 
<h3>15.sheet用法</h3> 
<p><img alt="" height="180" src="https://images2.imgbox.com/d0/e2/2h7sUDpj_o.png" width="1200"></p> 
<pre><code class="language-TypeScript">  .bindSheet($$this.isShowPhotoCom, this.sheetBuilder, {
      showClose: false
    })</code></pre> 
<blockquote> 
 <p>$$为什么在这里使用？</p> 
 <p>因为需要数据驱动视图，视图发生变化，他同样需要更新数据</p> 
</blockquote> 
<p>视图内容</p> 
<pre><code class="language-TypeScript"> @Builder
  sheetBuilder() {
    Column() {
      photoCom({
        List: this.List,
        isShowPhotoCom: this.isShowPhotoCom,
        maxSelectNum: this.maxSelectNum,
        showSelectImgs: this.showSelectImgs

      })

    }
  }</code></pre> 
<h3>16.弹窗UI是怎么在页面中使用的</h3> 
<p><img alt="" height="322" src="https://images2.imgbox.com/4c/3f/yzhkCdde_o.png" width="731"></p> 
<h3>17.常用的修饰符有哪些  -介绍下</h3> 
<blockquote> 
 <ul><li>Entry -修饰页面</li><li>Component-修饰成为组件</li><li>Preview-让组件可预览</li><li>State-在组件内部定义响应式数据-<span style="color:#fe2c24;">必须给初始值</span></li><li>Prop-接收父组件的响应式数据-<span style="color:#fe2c24;">可给也可不给初始值</span></li><li>Builder-声明轻量复用UI</li><li>BuilderParam-接收传入的轻量复用UI-<span style="color:#fe2c24;">必须给初始值</span></li><li><span style="color:#0d0016;">CustomDialog-修饰自定义弹层</span></li><li><span style="color:#0d0016;">Styles-修饰样式复用集合-不允许传参数</span></li><li><span style="color:#0d0016;">Extend-修饰某个特定组件包的样式复用集合-允许传参数</span></li><li><span style="color:#0d0016;">Link-可以实现父-子的双向绑定-注意：$$指的是组件内的双向绑定，$$同样可以实现和Link绑定-</span><span style="color:#fe2c24;">不允许给初始值</span></li></ul> 
 <p><span style="color:#1a439c;"><strong>新增-API11</strong></span></p> 
 <ul><li> <p><span style="color:#0d0016;">Requir-可以约束Prop和BuilderParam的参数为必须传递</span></p> </li><li><span style="color:#0d0016;">Track-用来标记一个对象中的哪些字段可以被更新和使用-如果一个Track都没有，那无所谓，只要有一个Track，只有被Track标记的字段才可以使用</span></li><li><span style="color:#0d0016;">ObjectLink-它可以实现局部的数据更新-但是必须和Observed修饰的class配合使用，不能再Entry修饰的组件中使用ObjectLink，场景是子组件想要局部组件更新</span></li><li><span style="color:#0d0016;">LocalStorageProp-单向读取LocalStorage共享的属性</span><span style="color:#fe2c24;">（必须给初始值）</span></li><li><span style="color:#0d0016;">LocalStorageLink -双向读取LocalStorage共享的属性 </span><span style="color:#fe2c24;">（必须给初始值）</span></li></ul> 
 <p></p> 
</blockquote> 
<p></p> 
<h3>18.watch状态监听器</h3> 
<p><img alt="" height="332" src="https://images2.imgbox.com/22/eb/y0eOh7XP_o.png" width="1200"></p> 
<p><img alt="" height="488" src="https://images2.imgbox.com/50/a2/hQNxHfEM_o.png" width="1017"></p> 
<h3>19.组件通信的方式有哪些?</h3> 
<p><img alt="" height="552" src="https://images2.imgbox.com/b1/fc/kxJHgUFX_o.png" width="796"></p> 
<h3>20.Next新增修饰符</h3> 
<h4>1.Require修饰符</h4> 
<p><img alt="" height="344" src="https://images2.imgbox.com/02/88/0OqqevgC_o.png" width="1096"></p> 
<p><img alt="" height="805" src="https://images2.imgbox.com/b9/30/oPlRgqHF_o.png" width="807"></p> 
<h4>2.Track修饰符</h4> 
<p><img alt="" height="155" src="https://images2.imgbox.com/ec/f2/4DEdQAsk_o.png" width="802"></p> 
<p></p> 
<h3><img alt="" height="731" src="https://images2.imgbox.com/35/da/B7QXRgF2_o.png" width="857">21.鸿蒙的刷新机制是怎么样的，多层嵌套时，是从build开始刷新吗？</h3> 
<p><img alt="" height="608" src="https://images2.imgbox.com/47/04/fQczIR6u_o.png" width="1190"></p> 
<h3>22.全局存储状态有哪些方式？</h3> 
<p><img alt="" height="263" src="https://images2.imgbox.com/5b/98/74pb9I79_o.png" width="605"></p> 
<h4 style="background-color:transparent;">1.UIAbility内状态-LocalStorage</h4> 
<h5 style="background-color:transparent;">1.1</h5> 
<p><img alt="" height="352" src="https://images2.imgbox.com/8a/da/gMOxUSOk_o.png" width="1200"></p> 
<p>代码实现</p> 
<p>1.首先定义：</p> 
<p><img alt="" height="299" src="https://images2.imgbox.com/52/5c/X1uyN4bu_o.png" width="500"></p> 
<p>2.</p> 
<p><img alt="" height="616" src="https://images2.imgbox.com/f1/5f/iLgzvcit_o.png" width="663"></p> 
<h5 style="background-color:transparent;">1.2在页面中传入</h5> 
<p>UIAbility中</p> 
<p><img alt="" height="767" src="https://images2.imgbox.com/67/f2/wOFtU3UY_o.png" width="1200"></p> 
<p>页面引入：重点代码</p> 
<pre><code class="language-TypeScript">let local = LocalStorage.getShared()

@Entry(local)</code></pre> 
<p> 全部代码：</p> 
<pre><code class="language-TypeScript">import { Car } from '../../entryability/EntryAbility';

let local = LocalStorage.getShared()

@Entry(local)
@Component
struct LocalStoragePage {
  @State message: string = 'Hello World11';
  @LocalStorageLink('car')
  car: Car = new Car()

  build() {
    RelativeContainer() {
      Text(this.car.title)
        .id('LocalStoragePageHelloWorld')
        .fontSize(50)
      
    }
    .height('100%')
    .width('100%')
  }
}</code></pre> 
<blockquote> 
 <p></p> 
 <p>注意：测试全局分享LocalStorage时需要使用模拟器  Preview不支持</p> 
</blockquote> 
<h4>2.应用状态-AppStorage（需要模拟器）</h4> 
<p><img alt="" height="590" src="https://images2.imgbox.com/e9/3e/4aKY1IVg_o.png" width="1088"></p> 
<p>代码 </p> 
<p>存入</p> 
<pre><code class="language-TypeScript">import { router } from '@kit.ArkUI';

@Entry
@Component
struct AppStroragePage {
  @State message: string = 'Hello World';

  build() {
    Column() {
      Button('AppStrorage存入')
        .onClick(() =&gt; {
          AppStorage.setOrCreate&lt;InfoModel&gt;('userInfo', new InfoModel({ name: '小孩', age: 18 }))
          router.pushUrl({
            url: 'pages/09/AppMainPage'
          })
        })
    }
    .height('100%')
    .width('100%')
  }
}

export interface Info {
  name: string,
  age: number
}

export class InfoModel implements Info {
  name: string = ''
  age: number = 0

  constructor(model: Info) {
    this.name = model.name
    this.age = model.age
  }
}
</code></pre> 
<h5>2.1获取</h5> 
<pre><code class="language-TypeScript">import { Info, InfoModel } from './AppStroragePage';

@Entry
@Component
struct AppMainPage {
  @State message: string = 'Hello World';
  @StorageLink('userInfo')
  userInfo: InfoModel = new InfoModel({} as Info)

  build() {
    RelativeContainer() {
      Text(this.userInfo.name)
        .id('AppMainPageHelloWorld')
        .fontSize(50)
        .fontWeight(FontWeight.Bold)
        .alignRules({
          center: { anchor: '__container__', align: VerticalAlign.Center },
          middle: { anchor: '__container__', align: HorizontalAlign.Center }
        })
    }
    .height('100%')
    .width('100%')
  }
}</code></pre> 
<h5>2.2还有第二种获取方式</h5> 
<pre><code class="language-TypeScript">import { Info, InfoModel } from './AppStroragePage';
import { router } from '@kit.ArkUI';

@Entry
@Component
struct AppMainPage {
  @State message: string = 'Hello World';
  // @StorageLink('userInfo')
  // userInfo: InfoModel = new InfoModel({} as Info)
   userInfo: InfoModel = new InfoModel({} as Info)

  aboutToAppear(): void {
    let obj = AppStorage.get&lt;InfoModel&gt;('userInfo')
    if (obj) {
      this.userInfo = obj
    }

  }

  build() {
    Column() {
      Text(this.userInfo.name)
        .id('AppMainPageHelloWorld')
        .fontSize(50)
       
      Button('退出')
        .onClick(() =&gt; {
          AppStorage.set('userInfo', new InfoModel({} as Info))
          router.back()
        })
    }
    .height('100%')
    .width('100%')
  }
}</code></pre> 
<p>重点代码部分截图</p> 
<p><img alt="" height="776" src="https://images2.imgbox.com/78/5d/WNIgw7jQ_o.png" width="1172"></p> 
<p>获取的两种方式</p> 
<p><img alt="" height="482" src="https://images2.imgbox.com/e9/2e/O5zXRyDp_o.png" width="1200"></p> 
<p>还有一种set方法</p> 
<p><img alt="" height="764" src="https://images2.imgbox.com/3b/b9/zGZNaHz0_o.png" width="1087"></p> 
<h4>3.状态持久化-PersistenStorage</h4> 
<p><span style="color:#fe2c24;"><img alt="" height="736" src="https://images2.imgbox.com/c2/d2/gmdqx5IP_o.png" width="1200"></span></p> 
<p><span style="color:#fe2c24;">注意：如果使用了持久化，那么AppStorage读取出来的对象实际上是个json字符串</span></p> 
<p><span style="color:#fe2c24;">   如果没有持久化，那么读取出来的对象就是对象</span></p> 
<p>重点代码截图：</p> 
<p><img alt="" height="708" src="https://images2.imgbox.com/4a/01/prIjb6Lb_o.png" width="1128"></p> 
<p></p> 
<p><img alt="" height="531" src="https://images2.imgbox.com/aa/aa/C3T5vF7W_o.png" width="892"></p> 
<p>代码：</p> 
<pre><code class="language-TypeScript">import { router } from '@kit.ArkUI';

PersistentStorage.persistProp('huawei', '1000')

@Entry
@Component
struct PersistenStoragePage {
  @State message: string = 'Hello World';
  @StorageProp('huawei')
  huawei: string = ''

  build() {
    Column() {
      Text(this.huawei)
        .id('PersistenStoragePageHelloWorld')
        .fontSize(50)
      
      Button('登录').onClick(() =&gt; {
        router.pushUrl({
          url: 'pages/09/PerMainPage'
        })
      })
    }
    .height('100%')
    .width('100%')
  }
}</code></pre> 
<pre><code class="language-TypeScript">@Entry
@Component
struct PerMainPage {
  @State message: string = 'Hello World';
  @StorageLink('huawei')
  money: string = '李四'

  build() {
    Column() {

      TextInput({ text: $$this.money })
      Text(this.money)
      Text('fdjgkdj')
    }
    .height('100%')
    .width('100%')
  }
}</code></pre> 
<p><span style="color:#fe2c24;">PersistenStorage虽说是存在磁盘里  但是在entryAbility中访问不到  所以不能根据他去调用不同的页面（比如：登录页和主页  因在entryAbility中控制入口页面  一般都是登录页  但因每次都获取不到PersistenStorage的值 所以每次都会进入登录页）</span></p> 
<h4 style="background-color:transparent;"><span style="color:#0d0016;">4.首选项</span></h4> 
<p>写一个首选项</p> 
<pre><code class="language-TypeScript">import { preferences } from '@kit.ArkData'
import { Context } from '@kit.AbilityKit'

export class TonkenManager {
  // 获取仓库
  static async getStore(context?: Context) {
    return await preferences.getPreferences(getContext() || context, 'token_store')
  }

  // 写入数据
  static async setToken(token: string, context?: Context) {
    const store = await TonkenManager.getStore(context)
    store.putSync('my_token', token) //同步写入内容
    // 写入磁盘
    await store.flush()
  }

  // 写入数据
  static async getToken(context?: Context) {
    const store = await TonkenManager.getStore(context)

    return store.getSync('my_token', '') as string

  }
}

</code></pre> 
<p>在登录页 存入一个数据</p> 
<p><img alt="" height="629" src="https://images2.imgbox.com/51/18/mv5Ok2k7_o.png" width="803"></p> 
<p>然后再bility模块获取</p> 
<p><img alt="" height="753" src="https://images2.imgbox.com/b4/9d/p2idZpKt_o.png" width="1021"></p> 
<p>看下完整代码吧</p> 
<p>登录页代码</p> 
<pre><code class="language-TypeScript">import { router } from '@kit.ArkUI';
import { TonkenManager } from './uitils/token';

// PersistentStorage.persistProp('huawei', '1000')

@Entry
@Component
struct PersistenStoragePage {
  @State message: string = 'Hello World';
  @StorageProp('huawei')
  huawei: string = ''

  build() {
    Column() {
      Text(this.huawei)
        .id('PersistenStoragePageHelloWorld')
        .fontSize(50)

      Button('登录').onClick(() =&gt; {
        TonkenManager.setToken('123456')
        router.pushUrl({
          url: 'pages/09/PerMainPage'
        })
      })
    }
    .height('100%')
    .width('100%')
  }
}</code></pre> 
<p>Ability代码：</p> 
<pre><code class="language-TypeScript">  async onWindowStageCreate(windowStage: window.WindowStage): Promise&lt;void&gt; {
    // Main window is created, set main page for this ability
    hilog.info(0x0000, 'testTag', '%{public}s', 'Ability onWindowStageCreate');

    if (await TonkenManager.getToken(this.context)) {

      windowStage.loadContent('pages/09/PerMainPage', local, (err) =&gt; {
        if (err.code) {
          hilog.error(0x0000, 'testTag', 'Failed to load the content. Cause: %{public}s', JSON.stringify(err) ?? '');
          return;
        }
        hilog.info(0x0000, 'testTag', 'Succeeded in loading the content.');
      });

    } else {
      windowStage.loadContent('pages/09/persistenStoragePage', local, (err) =&gt; {
        if (err.code) {
          hilog.error(0x0000, 'testTag', 'Failed to load the content. Cause: %{public}s', JSON.stringify(err) ?? '');
          return;
        }
        hilog.info(0x0000, 'testTag', 'Succeeded in loading the content.');
      });
    }


  }</code></pre> 
<h3>23.HTTP用法、</h3> 
<h4>1.原生用法</h4> 
<p>hormony原生用法返回的值是字符串类型<span style="color:#fe2c24;">(取得是res.result)</span></p> 
<pre><code class="language-TypeScript">  aboutToAppear(): void {
    console.log('aboutToAppear')

    this.sendHttp()
  }

  async sendHttp() {
    const req = http.createHttp()
    const res =
      await req.request('https://jsonplaceholder.typicode.com/posts')

    AlertDialog.show({ message: res.result as string })
    req.destroy()

  }  }</code></pre> 
<h4>2.第三方库 axios</h4> 
<p>axios用法返回的值是object类型<span style="color:#fe2c24;">(取得是res.data)</span></p> 
<pre><code class="language-TypeScript"> ohpm install @ohos/axios
</code></pre> 
<pre><code class="language-TypeScript"> Button('获取数据').onClick(() =&gt; {
        this.testaxios()
      })

  async testaxios() {
 // axios的泛型的第二个参数是声明返回数据的类型的结构
    let res = await axios.get&lt;object, AxiosResponse&lt;object, null&gt;&gt;('https://jsonplaceholder.typicode.com/posts')
    AlertDialog.show({ message: JSON.stringify(res.data) })
  }

</code></pre> 
<h3>24.进程 线程 </h3> 
<p>进程通信</p> 
<p><img alt="" height="255" src="https://images2.imgbox.com/a1/76/TshL1O3m_o.png" width="901"></p> 
<p></p> 
<h4>1.进程</h4> 
<p><img alt="" height="419" src="https://images2.imgbox.com/85/d5/ARTWZDY0_o.png" width="750"></p> 
<p><span style="color:#fe2c24;">进程通信</span></p> 
<p><img alt="" height="196" src="https://images2.imgbox.com/02/4e/x7e4cmlT_o.png" width="1200"></p> 
<h4>2.线程</h4> 
<p><img alt="" height="549" src="https://images2.imgbox.com/a8/2e/kWaX5OnB_o.png" width="1200"></p> 
<p><img alt="" height="445" src="https://images2.imgbox.com/02/4f/jG03vcZf_o.png" width="1200"></p> 
<h5>TaskPool多线程代码：</h5> 
<pre><code class="language-TypeScript">import { taskpool } from '@kit.ArkTS';

@Entry
@Component
struct TaskpoolPage {
  @State message: string = 'Hello World';

  // 开启多线程方法
  beginTaskPool() {
    taskpool.execute(getData)
    taskpool.execute(addData)
  }

  build() {
    Column() {
      Button('开启多线程')
        .onClick(() =&gt; {
          // 调用开启多线程方法
          this.beginTaskPool()
        })

    }
    .height('100%')
    .width('100%')
  }
}

// 第一个线程方法
@Concurrent
function getData() {
  for (let index = 0; index &lt; 10000; index++) {
    console.log('任务1', index)

  }
}

// 第二个线程方法
@Concurrent
function addData() {
  for (let index = 10000; index &gt; 0; index--) {
    console.log('任务2', index)

  }
}</code></pre> 
<p>然后看下控制台</p> 
<h5><img alt="" height="279" src="https://images2.imgbox.com/74/3f/ij6PE2dJ_o.png" width="933">Worker进程代码：</h5> 
<p>先新建个worker</p> 
<p><img alt="" height="510" src="https://images2.imgbox.com/6d/f7/SdJ3rofi_o.png" width="708"></p> 
<p>然后建一个worker页面</p> 
<pre><code class="language-TypeScript">import worker, { MessageEvents } from '@ohos.worker';

@Entry
@Component
struct WorkCasePage {
  @State message: string = 'Hello World';

  build() {
    Column() {
      Button('worker开启多线程')
        .onClick(() =&gt; {
          let w = new worker.ThreadWorker('entry/ets/workers/Worker')
          w.postMessage('我是测试woker页面')
          w.onmessage = (e: MessageEvents) =&gt; {
            console.log(e.data, 'worker页面接收到了')
            w.terminate() //自毁线程
          }
        })


    }
    .height('100%')
    .width('100%')
  }
}</code></pre> 
<p>woker页面里边的代码</p> 
<pre><code class="language-TypeScript">import { ErrorEvent, MessageEvents, ThreadWorkerGlobalScope, worker } from '@kit.ArkTS';

const workerPort: ThreadWorkerGlobalScope = worker.workerPort;

/**
 * Defines the event handler to be called when the worker thread receives a message sent by the host thread.
 * The event handler is executed in the worker thread.
 *
 * @param e message data
 */
workerPort.onmessage = (e: MessageEvents) =&gt; {
  console.log(e.data, 'worker页面收到')
  for (let index = 0; index &lt; 10000; index++) {
    console.log(index.toString(), '多线程执行')

  }
  workerPort.postMessage('我已经干完活了')

}

/**
 * Defines the event handler to be called when the worker receives a message that cannot be deserialized.
 * The event handler is executed in the worker thread.
 *
 * @param e message data
 */
workerPort.onmessageerror = (e: MessageEvents) =&gt; {
}

/**
 * Defines the event handler to be called when an exception occurs during worker execution.
 * The event handler is executed in the worker thread.
 *
 * @param e error message
 */
workerPort.onerror = (e: ErrorEvent) =&gt; {
}</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/70ff1acc3670f18a23f475e253ec0997/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">日期类代码实现-C&#43;&#43;</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2a7da9b19d26391cc697bc914466196f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">坐牢第二十七天（聊天室）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>