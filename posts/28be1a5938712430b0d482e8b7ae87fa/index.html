<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【学习笔记】LeetCode SQL刷题（高频50基础版&#43;进阶版） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/28be1a5938712430b0d482e8b7ae87fa/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【学习笔记】LeetCode SQL刷题（高频50基础版&#43;进阶版）">
  <meta property="og:description" content="一、高频SQL50题(基础版) 题目考查类型题号查询1-5连接6-14聚合函数15-22排序和分组23-29高级查询和连接30-36子查询37-43高级字符串函数 / 正则表达式 / 子句44-50 1757. 可回收且低脂的产品 SELECT product_id FROM Products WHERE low_fats=&#39;Y&#39; and recyclable=&#39;Y&#39;; 584. 寻找用户推荐人 select name from Customer where referee_id != 2 or referee_id is null 595. 大的国家 select name,population,area from World where area&gt;=3000000 or population&gt;=25000000 1148. 文章浏览 I select distinct author_id as id from Views where author_id=viewer_id order by id 1683. 无效的推文 select tweet_id from Tweets where length(content)&gt;15 1378. 使用唯一标识码替换员工ID select unique_id,name from Employees left join EmployeeUNI on EmployeeUNI.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-12-21T09:37:55+08:00">
    <meta property="article:modified_time" content="2023-12-21T09:37:55+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【学习笔记】LeetCode SQL刷题（高频50基础版&#43;进阶版）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="SQL50_0"></a>一、高频SQL50题(基础版)</h2> 
<table><thead><tr><th>题目考查类型</th><th>题号</th></tr></thead><tbody><tr><td>查询</td><td>1-5</td></tr><tr><td>连接</td><td>6-14</td></tr><tr><td>聚合函数</td><td>15-22</td></tr><tr><td>排序和分组</td><td>23-29</td></tr><tr><td>高级查询和连接</td><td>30-36</td></tr><tr><td>子查询</td><td>37-43</td></tr><tr><td>高级字符串函数 / 正则表达式 / 子句</td><td>44-50</td></tr></tbody></table> 
<ol><li><strong><a href="https://leetcode.cn/problems/recyclable-and-low-fat-products/" rel="nofollow">1757. 可回收且低脂的产品</a></strong></li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> product_id
<span class="token keyword">FROM</span> Products 
<span class="token keyword">WHERE</span> low_fats<span class="token operator">=</span><span class="token string">'Y'</span> <span class="token operator">and</span> recyclable<span class="token operator">=</span><span class="token string">'Y'</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="2"><li><strong><a href="https://leetcode.cn/problems/find-customer-referee/" rel="nofollow">584. 寻找用户推荐人</a></strong></li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name
<span class="token keyword">from</span> Customer
<span class="token keyword">where</span> referee_id <span class="token operator">!=</span> <span class="token number">2</span> <span class="token operator">or</span> referee_id <span class="token operator">is</span> <span class="token boolean">null</span>
</code></pre> 
<ol start="3"><li><strong><a href="https://leetcode.cn/problems/big-countries/" rel="nofollow">595. 大的国家</a></strong></li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name<span class="token punctuation">,</span>population<span class="token punctuation">,</span>area
<span class="token keyword">from</span> World
<span class="token keyword">where</span> area<span class="token operator">&gt;=</span><span class="token number">3000000</span> <span class="token operator">or</span> population<span class="token operator">&gt;=</span><span class="token number">25000000</span>
</code></pre> 
<ol start="4"><li><strong><a href="https://leetcode.cn/problems/article-views-i/" rel="nofollow">1148. 文章浏览 I</a></strong></li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token keyword">distinct</span> author_id <span class="token keyword">as</span> id
<span class="token keyword">from</span> Views
<span class="token keyword">where</span> author_id<span class="token operator">=</span>viewer_id
<span class="token keyword">order</span> <span class="token keyword">by</span> id
</code></pre> 
<ol start="5"><li><strong><a href="https://leetcode.cn/problems/invalid-tweets/" rel="nofollow">1683. 无效的推文</a></strong></li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> tweet_id
<span class="token keyword">from</span> Tweets
<span class="token keyword">where</span> length<span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">15</span>
</code></pre> 
<ol start="6"><li><strong><a href="https://leetcode.cn/problems/replace-employee-id-with-the-unique-identifier/" rel="nofollow">1378. 使用唯一标识码替换员工ID</a></strong></li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> unique_id<span class="token punctuation">,</span>name
<span class="token keyword">from</span> Employees <span class="token keyword">left</span> <span class="token keyword">join</span>  EmployeeUNI
<span class="token keyword">on</span> EmployeeUNI<span class="token punctuation">.</span>ID<span class="token operator">=</span>Employees<span class="token punctuation">.</span>ID
</code></pre> 
<ol start="7"><li><strong><a href="https://leetcode.cn/problems/product-sales-analysis-i/" rel="nofollow">1068. 产品销售分析 I</a></strong></li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> product_name<span class="token punctuation">,</span><span class="token keyword">year</span><span class="token punctuation">,</span>price
<span class="token keyword">from</span> Sales <span class="token keyword">join</span> Product
<span class="token keyword">on</span> Sales<span class="token punctuation">.</span>product_id <span class="token operator">=</span> Product<span class="token punctuation">.</span>product_id
</code></pre> 
<ol start="8"><li><strong><a href="https://leetcode.cn/problems/customer-who-visited-but-did-not-make-any-transactions/" rel="nofollow">1581. 进店却未进行过交易的顾客</a></strong></li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> customer_id<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> count_no_trans
<span class="token keyword">from</span> Visits v <span class="token keyword">left</span> <span class="token keyword">join</span> <span class="token keyword">Transactions</span> t <span class="token keyword">on</span>
v<span class="token punctuation">.</span>visit_id <span class="token operator">=</span> t<span class="token punctuation">.</span>visit_id
<span class="token keyword">where</span> transaction_id <span class="token operator">is</span> <span class="token boolean">null</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> customer_id
</code></pre> 
<ol start="9"><li><strong><a href="https://leetcode.cn/problems/rising-temperature/" rel="nofollow">197. 上升的温度</a></strong></li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> w2<span class="token punctuation">.</span>id id
<span class="token keyword">from</span> Weather w1 <span class="token keyword">join</span> Weather w2
<span class="token keyword">on</span> w1<span class="token punctuation">.</span>recordDate <span class="token operator">=</span> w2<span class="token punctuation">.</span>recordDate<span class="token operator">-</span><span class="token keyword">interval</span> <span class="token number">1</span> <span class="token keyword">day</span>
<span class="token keyword">where</span> w1<span class="token punctuation">.</span>Temperature <span class="token operator">&lt;</span> w2<span class="token punctuation">.</span>Temperature
</code></pre> 
<ol start="10"><li><strong><a href="https://leetcode.cn/problems/average-time-of-process-per-machine/" rel="nofollow">1661. 每台机器的进程平均运行时间</a></strong></li></ol> 
<pre><code class="prism language-sql"><span class="token comment"># 运行时间17%</span>
<span class="token keyword">select</span> <span class="token keyword">start</span><span class="token punctuation">.</span>machine_id<span class="token punctuation">,</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">.</span><span class="token keyword">timestamp</span><span class="token operator">-</span><span class="token keyword">start</span><span class="token punctuation">.</span><span class="token keyword">timestamp</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> processing_time
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span>  <span class="token operator">*</span>
<span class="token keyword">from</span> Activity
<span class="token keyword">where</span> activity_type <span class="token operator">=</span><span class="token string">'start'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">start</span>
<span class="token keyword">join</span>
<span class="token punctuation">(</span><span class="token keyword">select</span>   <span class="token operator">*</span>
<span class="token keyword">from</span> Activity
<span class="token keyword">where</span> activity_type <span class="token operator">=</span><span class="token string">'end'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">end</span>
<span class="token keyword">on</span>
<span class="token keyword">start</span><span class="token punctuation">.</span>machine_id<span class="token operator">=</span><span class="token keyword">end</span><span class="token punctuation">.</span>machine_id <span class="token operator">and</span> <span class="token keyword">start</span><span class="token punctuation">.</span>process_id<span class="token operator">=</span><span class="token keyword">end</span><span class="token punctuation">.</span>process_id
<span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token keyword">start</span><span class="token punctuation">.</span>machine_id
</code></pre> 
<pre><code class="prism language-sql"><span class="token comment"># 运行时间45%</span>
<span class="token keyword">select</span> machine_id<span class="token punctuation">,</span>
<span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">timestamp</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> activity_type <span class="token operator">=</span> <span class="token string">'start'</span> <span class="token keyword">then</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">else</span> <span class="token number">1</span> <span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">count</span><span class="token punctuation">(</span>activity_type<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">as</span> processing_time
<span class="token keyword">from</span> Activity
<span class="token keyword">group</span> <span class="token keyword">by</span> machine_id
</code></pre> 
<p>11.<strong><a href="https://leetcode.cn/problems/employee-bonus/" rel="nofollow">577. 员工奖金</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name<span class="token punctuation">,</span>bonus
<span class="token keyword">from</span> Employee <span class="token keyword">left</span> <span class="token keyword">join</span> Bonus
<span class="token keyword">on</span> Employee<span class="token punctuation">.</span>empId <span class="token operator">=</span> Bonus<span class="token punctuation">.</span>empid
<span class="token keyword">where</span> bonus<span class="token operator">&lt;</span><span class="token number">1000</span> <span class="token operator">or</span> bonus <span class="token operator">is</span> <span class="token boolean">null</span>
</code></pre> 
<p>12.<strong><a href="https://leetcode.cn/problems/students-and-examinations/" rel="nofollow">1280. 学生们参加各科测试的次数</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> a<span class="token punctuation">.</span>student_id<span class="token punctuation">,</span>a<span class="token punctuation">.</span>student_name<span class="token punctuation">,</span>a<span class="token punctuation">.</span>subject_name<span class="token punctuation">,</span>ifnull<span class="token punctuation">(</span>attended_exams<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> attended_exams
<span class="token keyword">from</span>

<span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> subjects <span class="token keyword">join</span> students<span class="token punctuation">)</span> a
<span class="token keyword">left</span> <span class="token keyword">join</span>

<span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>student_id<span class="token punctuation">)</span> <span class="token keyword">as</span> attended_exams
<span class="token keyword">from</span> Examinations e
<span class="token keyword">group</span> <span class="token keyword">by</span> e<span class="token punctuation">.</span>student_id<span class="token punctuation">,</span>e<span class="token punctuation">.</span>subject_name<span class="token punctuation">)</span> b

<span class="token keyword">on</span> a<span class="token punctuation">.</span>student_id <span class="token operator">=</span> b<span class="token punctuation">.</span>student_id
<span class="token operator">and</span> a<span class="token punctuation">.</span>subject_name <span class="token operator">=</span> b<span class="token punctuation">.</span>subject_name

<span class="token keyword">order</span> <span class="token keyword">by</span> a<span class="token punctuation">.</span>student_id<span class="token punctuation">,</span>a<span class="token punctuation">.</span>subject_name
</code></pre> 
<p>13.<strong><a href="https://leetcode.cn/problems/managers-with-at-least-5-direct-reports/" rel="nofollow">570. 至少有5名直接下属的经理</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> e2<span class="token punctuation">.</span>name name
<span class="token keyword">from</span> Employee e2
<span class="token keyword">left</span> <span class="token keyword">join</span> Employee e1
<span class="token keyword">on</span>  e1<span class="token punctuation">.</span>managerId<span class="token operator">=</span>e2<span class="token punctuation">.</span>id
<span class="token keyword">group</span> <span class="token keyword">by</span> e2<span class="token punctuation">.</span>id
<span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">5</span>
</code></pre> 
<p>14.<strong><a href="https://leetcode.cn/problems/confirmation-rate/" rel="nofollow">1934. 确认率</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span>  s<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">action</span><span class="token operator">=</span><span class="token string">'confirmed'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> confirmation_rate
<span class="token keyword">from</span> Signups  s
<span class="token keyword">left</span> <span class="token keyword">join</span> Confirmations c
<span class="token keyword">on</span> s<span class="token punctuation">.</span>user_id <span class="token operator">=</span> c<span class="token punctuation">.</span>user_id
<span class="token keyword">group</span> <span class="token keyword">by</span> s<span class="token punctuation">.</span>user_id
</code></pre> 
<p>15.<strong><a href="https://leetcode.cn/problems/not-boring-movies/" rel="nofollow">620. 有趣的电影</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> cinema
<span class="token keyword">where</span> description<span class="token operator">!=</span><span class="token string">'boring'</span> <span class="token operator">and</span> id<span class="token operator">%</span><span class="token number">2</span><span class="token operator">!=</span><span class="token number">0</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> rating <span class="token keyword">desc</span>
</code></pre> 
<p>16.<strong><a href="https://leetcode.cn/problems/average-selling-price/" rel="nofollow">1251. 平均售价</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> p<span class="token punctuation">.</span>product_id<span class="token punctuation">,</span>ifnull<span class="token punctuation">(</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span>price<span class="token operator">*</span>units<span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">sum</span><span class="token punctuation">(</span>units<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">as</span> average_price
<span class="token keyword">from</span> Prices  p <span class="token keyword">left</span> <span class="token keyword">join</span> UnitsSold u
<span class="token keyword">on</span> p<span class="token punctuation">.</span>product_id <span class="token operator">=</span> u<span class="token punctuation">.</span>product_id
<span class="token operator">and</span> u<span class="token punctuation">.</span>purchase_date <span class="token operator">between</span> p<span class="token punctuation">.</span>start_date <span class="token operator">and</span> p<span class="token punctuation">.</span>end_date
<span class="token keyword">group</span> <span class="token keyword">by</span> p<span class="token punctuation">.</span>product_id
</code></pre> 
<p>17.<strong><a href="https://leetcode.cn/problems/project-employees-i/" rel="nofollow">1075. 项目员工 I</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> project_id<span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>experience_years<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span>  average_years
<span class="token keyword">from</span> Project p <span class="token keyword">left</span> <span class="token keyword">join</span> Employee e
<span class="token keyword">on</span> p<span class="token punctuation">.</span>employee_id <span class="token operator">=</span> e<span class="token punctuation">.</span>employee_id
<span class="token keyword">group</span> <span class="token keyword">by</span> project_id
</code></pre> 
<p>18.<strong><a href="https://leetcode.cn/problems/percentage-of-users-attended-a-contest/" rel="nofollow">1633. 各赛事的用户注册率</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> contest_id<span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span>contest_id<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> Users<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> percentage
<span class="token keyword">from</span> Register r <span class="token keyword">left</span> <span class="token keyword">join</span> Users u
<span class="token keyword">on</span> r<span class="token punctuation">.</span>user_id <span class="token operator">=</span> u<span class="token punctuation">.</span>user_id
<span class="token keyword">group</span> <span class="token keyword">by</span> contest_id
<span class="token keyword">order</span> <span class="token keyword">by</span> percentage <span class="token keyword">desc</span><span class="token punctuation">,</span>contest_id
</code></pre> 
<p>19.<strong><a href="https://leetcode.cn/problems/queries-quality-and-percentage/" rel="nofollow">1211. 查询结果的质量和占比</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> query_name<span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>rating<span class="token operator">/</span>position<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> quality<span class="token punctuation">,</span>
<span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token operator">*</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> rating<span class="token operator">&lt;</span><span class="token number">3</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">end</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token keyword">as</span> poor_query_percentage
<span class="token keyword">from</span> Queries
<span class="token keyword">group</span> <span class="token keyword">by</span> query_name
<span class="token keyword">having</span> query_name <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>
</code></pre> 
<p>20.<strong><a href="https://leetcode.cn/problems/monthly-transactions-i/" rel="nofollow">1193. 每月交易 I</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token keyword">left</span><span class="token punctuation">(</span>trans_date<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">month</span><span class="token punctuation">,</span>
country<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> trans_count<span class="token punctuation">,</span>
<span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> state<span class="token operator">=</span><span class="token string">'approved'</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> approved_count<span class="token punctuation">,</span>
<span class="token function">sum</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span> <span class="token keyword">as</span> trans_total_amount<span class="token punctuation">,</span>
<span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> state<span class="token operator">=</span><span class="token string">'approved'</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">end</span><span class="token punctuation">)</span><span class="token operator">*</span>amount<span class="token punctuation">)</span> <span class="token keyword">as</span> approved_total_amount
<span class="token keyword">from</span> <span class="token keyword">Transactions</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token keyword">month</span><span class="token punctuation">,</span>country
</code></pre> 
<p>21.<strong><a href="https://leetcode.cn/problems/immediate-food-delivery-ii/" rel="nofollow">1174. 即时食物配送 II</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> customer_pref_delivery_date<span class="token operator">=</span>order_date <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">end</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token operator">/</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> immediate_percentage
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> customer_id<span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>order_date<span class="token punctuation">)</span>  <span class="token keyword">as</span> order_date<span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>customer_pref_delivery_date<span class="token punctuation">)</span> <span class="token keyword">as</span> customer_pref_delivery_date
<span class="token keyword">from</span> Delivery
<span class="token keyword">group</span> <span class="token keyword">by</span> customer_id<span class="token punctuation">)</span> <span class="token keyword">as</span> first_order
</code></pre> 
<p>22.<strong><a href="https://leetcode.cn/problems/game-play-analysis-iv/" rel="nofollow">550. 游戏玩法分析 IV</a></strong></p> 
<pre><code class="prism language-sql">
<span class="token comment"># 卡了很久最小时间</span>
<span class="token keyword">select</span>  <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> player_id<span class="token punctuation">)</span> <span class="token keyword">from</span> Activity<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fraction
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span> player_id<span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>event_date<span class="token punctuation">)</span> <span class="token keyword">as</span> event_date
<span class="token keyword">from</span> Activity 
<span class="token keyword">group</span> <span class="token keyword">by</span> player_id<span class="token punctuation">)</span> <span class="token keyword">as</span> a1

<span class="token keyword">join</span> Activity a2
<span class="token keyword">on</span> a1<span class="token punctuation">.</span>player_id<span class="token operator">=</span>a2<span class="token punctuation">.</span>player_id
<span class="token operator">and</span> a1<span class="token punctuation">.</span>event_date<span class="token operator">=</span>a2<span class="token punctuation">.</span>event_date <span class="token operator">-</span> <span class="token keyword">interval</span> <span class="token number">1</span> <span class="token keyword">day</span><span class="token punctuation">)</span>
</code></pre> 
<p>23.<strong><a href="https://leetcode.cn/problems/number-of-unique-subjects-taught-by-each-teacher/" rel="nofollow">2356. 每位教师所教授的科目种类的数量</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> teacher_id<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> subject_id<span class="token punctuation">)</span> <span class="token keyword">as</span> cnt
<span class="token keyword">from</span> teacher
<span class="token keyword">group</span> <span class="token keyword">by</span> teacher_id
</code></pre> 
<p>24.<strong><a href="https://leetcode.cn/problems/user-activity-for-the-past-30-days-i/" rel="nofollow">1141. 查询近30天活跃用户数</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> activity_date <span class="token keyword">as</span> <span class="token keyword">day</span><span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> user_id<span class="token punctuation">)</span> <span class="token keyword">as</span> active_users
<span class="token keyword">from</span> Activity
<span class="token keyword">group</span> <span class="token keyword">by</span> activity_date
<span class="token keyword">having</span> activity_date <span class="token operator">between</span> <span class="token punctuation">(</span><span class="token string">"2019-07-27"</span><span class="token operator">-</span> <span class="token keyword">interval</span> <span class="token number">29</span> <span class="token keyword">day</span><span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token string">"2019-07-27"</span>
</code></pre> 
<p>25.<strong><a href="https://leetcode.cn/problems/sales-analysis-iii/" rel="nofollow">1084. 销售分析III</a></strong></p> 
<pre><code class="prism language-sql"><span class="token comment"># 注意sum=count的用法，用于“所有都是……”的场景</span>
<span class="token keyword">select</span> s<span class="token punctuation">.</span>product_id<span class="token punctuation">,</span>product_name
<span class="token keyword">from</span> Sales s <span class="token keyword">left</span> <span class="token keyword">join</span> Product p
<span class="token keyword">on</span> s<span class="token punctuation">.</span>product_id<span class="token operator">=</span>p<span class="token punctuation">.</span>product_id
<span class="token keyword">group</span> <span class="token keyword">by</span>  s<span class="token punctuation">.</span>product_id
<span class="token keyword">having</span> <span class="token function">sum</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>sale_date <span class="token operator">between</span> <span class="token string">"2019-01-01"</span> <span class="token operator">and</span> <span class="token string">"2019-03-31"</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="26"><li><strong><a href="https://leetcode.cn/problems/classes-more-than-5-students/" rel="nofollow">596. 超过5名学生的课</a></strong></li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> class
<span class="token keyword">from</span> Courses
<span class="token keyword">group</span> <span class="token keyword">by</span> class
<span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">5</span>
</code></pre> 
<p>27.<strong><a href="https://leetcode.cn/problems/find-followers-count/" rel="nofollow">1729. 求关注者的数量</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> user_id<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> followers_count
<span class="token keyword">from</span> Followers
<span class="token keyword">group</span> <span class="token keyword">by</span> user_id
<span class="token keyword">order</span> <span class="token keyword">by</span> user_id
</code></pre> 
<p>28.<strong><a href="https://leetcode.cn/problems/biggest-single-number/" rel="nofollow">619. 只出现一次的最大数字</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> num
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> num
<span class="token keyword">from</span> MyNumbers
<span class="token keyword">group</span> <span class="token keyword">by</span> num
<span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> num1
</code></pre> 
<p>29.<strong><a href="https://leetcode.cn/problems/customers-who-bought-all-products/" rel="nofollow">1045. 买下所有产品的客户</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> customer_id
<span class="token keyword">from</span> Customer
<span class="token keyword">group</span> <span class="token keyword">by</span> customer_id
<span class="token keyword">having</span>  <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> product_key<span class="token punctuation">)</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> Product<span class="token punctuation">)</span>
</code></pre> 
<p>30.<strong><a href="https://leetcode.cn/problems/the-number-of-employees-which-report-to-each-employee/" rel="nofollow">1731. 每位经理的下属员工数量</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span>  e2<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>e2<span class="token punctuation">.</span>name<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> reports_count<span class="token punctuation">,</span>
<span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>e1<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">as</span> average_age
<span class="token keyword">from</span> Employees e1 <span class="token keyword">left</span> <span class="token keyword">join</span> Employees e2
<span class="token keyword">on</span> e1<span class="token punctuation">.</span>reports_to <span class="token operator">=</span> e2<span class="token punctuation">.</span>employee_id
<span class="token keyword">group</span> <span class="token keyword">by</span> e2<span class="token punctuation">.</span>employee_id
<span class="token keyword">having</span> e2<span class="token punctuation">.</span>employee_id <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> employee_id
</code></pre> 
<p>31.<strong><a href="https://leetcode.cn/problems/primary-department-for-each-employee/" rel="nofollow">1789. 员工的直属部门</a></strong></p> 
<pre><code class="prism language-sql"><span class="token punctuation">(</span><span class="token keyword">select</span> employee_id<span class="token punctuation">,</span>department_id
<span class="token keyword">from</span> Employee
<span class="token keyword">where</span> primary_flag <span class="token operator">=</span><span class="token string">'Y'</span><span class="token punctuation">)</span>
<span class="token keyword">UNION</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> employee_id<span class="token punctuation">,</span>department_id
<span class="token keyword">from</span> Employee
<span class="token keyword">group</span> <span class="token keyword">by</span>  employee_id
<span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> employee_id
</code></pre> 
<p>32.<strong><a href="https://leetcode.cn/problems/triangle-judgement/" rel="nofollow">610. 判断三角形</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> <span class="token punctuation">(</span>x<span class="token operator">+</span>y<span class="token operator">&gt;</span>z <span class="token operator">and</span> x<span class="token operator">+</span>z<span class="token operator">&gt;</span>y <span class="token operator">and</span> z<span class="token operator">+</span>y<span class="token operator">&gt;</span>x<span class="token punctuation">)</span> <span class="token keyword">then</span> <span class="token string">"Yes"</span>
<span class="token keyword">else</span> <span class="token string">"No"</span>
<span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> triangle
<span class="token keyword">from</span> Triangle
</code></pre> 
<p>33.<strong><a href="https://leetcode.cn/problems/consecutive-numbers/" rel="nofollow">180. 连续出现的数字</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token keyword">distinct</span> L1<span class="token punctuation">.</span>num <span class="token keyword">as</span> ConsecutiveNums
<span class="token keyword">from</span> Logs L1
<span class="token keyword">join</span> Logs L2 <span class="token keyword">on</span> L1<span class="token punctuation">.</span>id<span class="token operator">=</span>L2<span class="token punctuation">.</span>id<span class="token operator">-</span><span class="token number">1</span>
<span class="token keyword">join</span> Logs L3 <span class="token keyword">on</span> L2<span class="token punctuation">.</span>id<span class="token operator">=</span>L3<span class="token punctuation">.</span>id<span class="token operator">-</span><span class="token number">1</span>
<span class="token keyword">where</span> L1<span class="token punctuation">.</span>num<span class="token operator">=</span>L2<span class="token punctuation">.</span>num <span class="token operator">and</span> L2<span class="token punctuation">.</span>num<span class="token operator">=</span>L3<span class="token punctuation">.</span>num
</code></pre> 
<p>34.<strong><a href="https://leetcode.cn/problems/product-price-at-a-given-date/" rel="nofollow">1164. 指定日期的产品价格</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> product_id<span class="token punctuation">,</span> new_price <span class="token keyword">as</span> price
<span class="token keyword">from</span> Products
<span class="token keyword">where</span> <span class="token punctuation">(</span>product_id<span class="token punctuation">,</span>change_date<span class="token punctuation">)</span> <span class="token operator">in</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> product_id<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>change_date<span class="token punctuation">)</span>
<span class="token keyword">from</span> Products
<span class="token keyword">where</span> change_date<span class="token operator">&lt;=</span><span class="token string">"2019-08-16"</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> product_id<span class="token punctuation">)</span>

<span class="token keyword">union</span>

<span class="token keyword">select</span> product_id<span class="token punctuation">,</span><span class="token number">10</span> <span class="token keyword">as</span> price
<span class="token keyword">from</span> Products
<span class="token keyword">where</span> product_id  <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> product_id <span class="token keyword">from</span> Products <span class="token keyword">where</span> change_date<span class="token operator">&lt;=</span><span class="token string">"2019-08-16"</span><span class="token punctuation">)</span>
</code></pre> 
<p>⭐35.<strong><a href="https://leetcode.cn/problems/last-person-to-fit-in-the-bus/" rel="nofollow">1204. 最后一个能进入巴士的人</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> q1<span class="token punctuation">.</span>person_name
<span class="token keyword">from</span> Queue q1
<span class="token keyword">join</span> Queue q2 <span class="token keyword">on</span> q1<span class="token punctuation">.</span>turn<span class="token operator">&gt;=</span>q2<span class="token punctuation">.</span>turn
<span class="token keyword">group</span> <span class="token keyword">by</span> q1<span class="token punctuation">.</span>person_id
<span class="token keyword">having</span> <span class="token function">sum</span><span class="token punctuation">(</span>q2<span class="token punctuation">.</span>weight<span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">1000</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> q1<span class="token punctuation">.</span>turn <span class="token keyword">desc</span> <span class="token keyword">limit</span> <span class="token number">1</span>
</code></pre> 
<p>36.<strong><a href="https://leetcode.cn/problems/count-salary-categories/" rel="nofollow">1907. 按分类统计薪水</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token string">"Low Salary"</span> category<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> accounts_count
<span class="token keyword">from</span> Accounts
<span class="token keyword">where</span> income<span class="token operator">&lt;</span><span class="token number">20000</span>

<span class="token keyword">union</span>

<span class="token keyword">select</span> <span class="token string">"Average Salary"</span> category<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> accounts_count
<span class="token keyword">from</span> Accounts
<span class="token keyword">where</span> income <span class="token operator">between</span> <span class="token number">20000</span> <span class="token operator">and</span> <span class="token number">50000</span>

<span class="token keyword">union</span>

<span class="token keyword">select</span> <span class="token string">"High Salary"</span> category<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> accounts_count
<span class="token keyword">from</span> Accounts
<span class="token keyword">where</span> income<span class="token operator">&gt;</span><span class="token number">50000</span>
</code></pre> 
<p>37.<strong><a href="https://leetcode.cn/problems/employees-whose-manager-left-the-company/" rel="nofollow">1978. 上级经理已离职的公司员工</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> employee_id
<span class="token keyword">from</span> Employees
<span class="token keyword">where</span> salary<span class="token operator">&lt;</span><span class="token number">30000</span> <span class="token operator">and</span>  manager_id <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> employee_id <span class="token keyword">from</span> Employees<span class="token punctuation">)</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> employee_id
</code></pre> 
<p>38.<strong><a href="https://leetcode.cn/problems/exchange-seats/" rel="nofollow">626. 换座位</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span>
<span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> id<span class="token operator">%</span><span class="token number">2</span><span class="token operator">!=</span><span class="token number">0</span> <span class="token operator">and</span> id<span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> Seat<span class="token punctuation">)</span> <span class="token keyword">then</span> id<span class="token operator">+</span><span class="token number">1</span>
      <span class="token keyword">when</span> id<span class="token operator">%</span><span class="token number">2</span><span class="token operator">=</span><span class="token number">0</span>  <span class="token keyword">then</span> id<span class="token operator">-</span><span class="token number">1</span>
      <span class="token keyword">else</span> id <span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> id<span class="token punctuation">,</span>student
<span class="token keyword">from</span> Seat
<span class="token keyword">order</span> <span class="token keyword">by</span> id
</code></pre> 
<p>39.<strong><a href="https://leetcode.cn/problems/movie-rating/" rel="nofollow">1341. 电影评分</a></strong></p> 
<pre><code class="prism language-sql"><span class="token punctuation">(</span><span class="token keyword">select</span> name <span class="token keyword">as</span> results
<span class="token keyword">from</span> Users u
<span class="token keyword">join</span> MovieRating r1 <span class="token keyword">on</span> u<span class="token punctuation">.</span>user_id <span class="token operator">=</span> r1<span class="token punctuation">.</span>user_id 
<span class="token keyword">group</span> <span class="token keyword">by</span> u<span class="token punctuation">.</span>user_id
<span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">desc</span><span class="token punctuation">,</span>name <span class="token keyword">limit</span> <span class="token number">1</span><span class="token punctuation">)</span>

<span class="token keyword">union</span> <span class="token keyword">all</span>

<span class="token punctuation">(</span><span class="token keyword">select</span> title <span class="token keyword">as</span> results
<span class="token keyword">from</span> Movies m
<span class="token keyword">join</span>  MovieRating r2 <span class="token keyword">on</span> m<span class="token punctuation">.</span>movie_id <span class="token operator">=</span> r2<span class="token punctuation">.</span>movie_id <span class="token operator">and</span> <span class="token keyword">left</span><span class="token punctuation">(</span>r2<span class="token punctuation">.</span>created_at<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"2020-02"</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> r2<span class="token punctuation">.</span>movie_id 
<span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">avg</span><span class="token punctuation">(</span>rating<span class="token punctuation">)</span> <span class="token keyword">desc</span><span class="token punctuation">,</span>title <span class="token keyword">limit</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> 
<p>⭐⭐40.<strong><a href="https://leetcode.cn/problems/restaurant-growth/" rel="nofollow">1321. 餐馆营业额变化增长</a></strong></p> 
<pre><code class="prism language-sql"><span class="token comment">#注意join时where的用法以及分组之后avg函数的使用</span>
<span class="token keyword">select</span> a<span class="token punctuation">.</span>visited_on<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>amount<span class="token punctuation">)</span> <span class="token keyword">as</span> amount<span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>amount<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> average_amount
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">distinct</span> visited_on 
<span class="token keyword">from</span> Customer<span class="token punctuation">)</span> <span class="token keyword">as</span> a
<span class="token keyword">left</span> <span class="token keyword">join</span>  customer c
<span class="token keyword">on</span> <span class="token punctuation">(</span>c<span class="token punctuation">.</span>visited_on<span class="token operator">&gt;=</span>a<span class="token punctuation">.</span>visited_on <span class="token operator">-</span> <span class="token keyword">interval</span> <span class="token number">6</span> <span class="token keyword">day</span><span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token punctuation">(</span>c<span class="token punctuation">.</span>visited_on<span class="token operator">&lt;=</span>a<span class="token punctuation">.</span>visited_on<span class="token punctuation">)</span>
<span class="token keyword">where</span> a<span class="token punctuation">.</span>visited_on<span class="token operator">&gt;=</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>visited_on<span class="token punctuation">)</span> <span class="token keyword">from</span> customer<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">6</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> a<span class="token punctuation">.</span>visited_on
<span class="token keyword">order</span> <span class="token keyword">by</span> a<span class="token punctuation">.</span>visited_on
</code></pre> 
<p>41.<strong><a href="https://leetcode.cn/problems/friend-requests-ii-who-has-the-most-friends/" rel="nofollow">602. 好友申请 II ：谁有最多的好友</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> a<span class="token punctuation">.</span>id<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> num
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> requester_id <span class="token keyword">as</span> id <span class="token keyword">from</span> RequestAccepted r1
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> accepter_id <span class="token keyword">as</span> id <span class="token keyword">from</span> RequestAccepted r2<span class="token punctuation">)</span> <span class="token keyword">as</span> a
<span class="token keyword">group</span> <span class="token keyword">by</span> id
<span class="token keyword">order</span> <span class="token keyword">by</span> num <span class="token keyword">desc</span> <span class="token keyword">limit</span> <span class="token number">1</span>
</code></pre> 
<p>42.<strong><a href="https://leetcode.cn/problems/investments-in-2016/" rel="nofollow">585. 2016年的投资</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span>tiv_2016<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> tiv_2016
<span class="token keyword">from</span> Insurance
<span class="token keyword">where</span> tiv_2015 <span class="token operator">in</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> tiv_2015 <span class="token keyword">from</span> Insurance 
<span class="token keyword">group</span> <span class="token keyword">by</span> tiv_2015 <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token operator">and</span> concat<span class="token punctuation">(</span>lat<span class="token punctuation">,</span> lon<span class="token punctuation">)</span>  <span class="token operator">in</span> 
<span class="token punctuation">(</span><span class="token keyword">select</span> concat<span class="token punctuation">(</span>lat<span class="token punctuation">,</span> lon<span class="token punctuation">)</span> 
<span class="token keyword">from</span> Insurance 
<span class="token keyword">group</span> <span class="token keyword">by</span> concat<span class="token punctuation">(</span>lat<span class="token punctuation">,</span> lon<span class="token punctuation">)</span> 
<span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> 
<p>⭐⭐⭐43.<strong><a href="https://leetcode.cn/problems/department-top-three-salaries/" rel="nofollow">185. 部门工资前三高的所有员工</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> d<span class="token punctuation">.</span>name <span class="token keyword">as</span>  Department<span class="token punctuation">,</span>e<span class="token punctuation">.</span>name  <span class="token keyword">as</span> Employee<span class="token punctuation">,</span>e<span class="token punctuation">.</span>salary
<span class="token keyword">from</span> Employee e <span class="token keyword">left</span> <span class="token keyword">join</span> Department d
<span class="token keyword">on</span> e<span class="token punctuation">.</span>departmentId<span class="token operator">=</span>d<span class="token punctuation">.</span>id
<span class="token keyword">where</span> e<span class="token punctuation">.</span>id <span class="token operator">in</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> e1<span class="token punctuation">.</span>id
<span class="token keyword">from</span> Employee e1 <span class="token keyword">left</span> <span class="token keyword">join</span>  Employee e2
<span class="token keyword">on</span> e1<span class="token punctuation">.</span>departmentId<span class="token operator">=</span>e2<span class="token punctuation">.</span>departmentId <span class="token operator">and</span> e1<span class="token punctuation">.</span>salary<span class="token operator">&lt;</span>e2<span class="token punctuation">.</span>salary
<span class="token keyword">group</span> <span class="token keyword">by</span> e1<span class="token punctuation">.</span>id
<span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> e2<span class="token punctuation">.</span>salary<span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre> 
<p>44.<strong><a href="https://leetcode.cn/problems/fix-names-in-a-table/" rel="nofollow">1667. 修复表中的名字</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> user_id<span class="token punctuation">,</span>concat<span class="token punctuation">(</span>upper<span class="token punctuation">(</span><span class="token keyword">left</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>lower<span class="token punctuation">(</span>SUBSTRING<span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> name
<span class="token keyword">from</span> Users
<span class="token keyword">order</span> <span class="token keyword">by</span> user_id
</code></pre> 
<p>45.<strong><a href="https://leetcode.cn/problems/patients-with-a-condition/" rel="nofollow">1527. 患某种疾病的患者</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> Patients
<span class="token keyword">where</span> conditions <span class="token operator">like</span> <span class="token string">"DIAB1%"</span> <span class="token operator">or</span> conditions <span class="token operator">like</span> <span class="token string">"% DIAB1%"</span>
</code></pre> 
<p>46.<strong><a href="https://leetcode.cn/problems/delete-duplicate-emails/" rel="nofollow">196. 删除重复的电子邮箱</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">delete</span> <span class="token keyword">from</span>
Person
<span class="token keyword">where</span> id <span class="token operator">not</span> <span class="token operator">in</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> id <span class="token keyword">from</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> id
<span class="token keyword">from</span> Person
<span class="token keyword">group</span> <span class="token keyword">by</span> email<span class="token punctuation">)</span> <span class="token keyword">as</span> a<span class="token punctuation">)</span>
</code></pre> 
<p>47.<strong><a href="https://leetcode.cn/problems/second-highest-salary/" rel="nofollow">176. 第二高的薪水</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> ifnull<span class="token punctuation">(</span><span class="token punctuation">(</span>
<span class="token keyword">select</span> <span class="token keyword">distinct</span> salary
<span class="token keyword">from</span> Employee
<span class="token keyword">order</span> <span class="token keyword">by</span>  salary <span class="token keyword">desc</span>
<span class="token keyword">limit</span> <span class="token number">1</span> <span class="token keyword">offset</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">null</span><span class="token punctuation">)</span> <span class="token keyword">as</span> SecondHighestSalary
</code></pre> 
<p>48.<strong><a href="https://leetcode.cn/problems/group-sold-products-by-the-date/" rel="nofollow">1484. 按日期分组销售产品</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> sell_date<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> product<span class="token punctuation">)</span> <span class="token keyword">as</span> num_sold<span class="token punctuation">,</span>
group_concat<span class="token punctuation">(</span><span class="token keyword">distinct</span> product <span class="token keyword">order</span> <span class="token keyword">by</span> product SEPARATOR <span class="token string">','</span><span class="token punctuation">)</span> <span class="token keyword">as</span> products
<span class="token keyword">from</span> Activities
<span class="token keyword">group</span> <span class="token keyword">by</span> sell_date
<span class="token keyword">order</span> <span class="token keyword">by</span> sell_date
</code></pre> 
<p>49.<strong><a href="https://leetcode.cn/problems/list-the-products-ordered-in-a-period/" rel="nofollow">1327. 列出指定时间段内所有的下单产品</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> product_name<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>unit<span class="token punctuation">)</span> <span class="token keyword">as</span> unit
<span class="token keyword">from</span> Products p <span class="token keyword">join</span> Orders o
<span class="token keyword">on</span> p<span class="token punctuation">.</span>product_id<span class="token operator">=</span>o<span class="token punctuation">.</span>product_id <span class="token operator">and</span>  <span class="token keyword">left</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>order_date<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">"2020-02"</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> product_name
<span class="token keyword">having</span> <span class="token function">sum</span><span class="token punctuation">(</span>unit<span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">100</span>
</code></pre> 
<p>50.<strong><a href="https://leetcode.cn/problems/find-users-with-valid-e-mails/" rel="nofollow">1517. 查找拥有有效邮箱的用户</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> user_id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> mail
<span class="token keyword">FROM</span> Users
<span class="token keyword">WHERE</span> mail <span class="token operator">REGEXP</span> <span class="token string">'^[a-zA-Z][a-zA-Z0-9_.-]*\\@leetcode\\.com$'</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="SQL50_572"></a>二、高频SQL50题（进阶版）</h2> 
<table><thead><tr><th>题目考查类型</th><th>题号</th></tr></thead><tbody><tr><td>查询</td><td>1-5</td></tr><tr><td>连接</td><td>6-11</td></tr><tr><td>聚合函数</td><td>12-19</td></tr><tr><td>排序和分组</td><td>20-26</td></tr><tr><td>高级查询和连接</td><td>27-35</td></tr><tr><td>子查询</td><td>36-43</td></tr><tr><td>高级字符串函数 / 正则表达式 / 子句</td><td>44-50</td></tr></tbody></table> 
<p>1.<strong><strong><a href="https://leetcode.cn/problems/find-customers-with-positive-revenue-this-year/" rel="nofollow">1821. 寻找今年具有正收入的客户</a></strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> customer_id
<span class="token keyword">from</span> Customers
<span class="token keyword">where</span> <span class="token keyword">year</span><span class="token operator">=</span><span class="token number">2021</span> <span class="token operator">and</span> revenue<span class="token operator">&gt;</span><span class="token number">0</span>
</code></pre> 
<p>2.<strong><strong>183. 从不订购的客户</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name <span class="token keyword">as</span> Customers
<span class="token keyword">from</span> Customers
<span class="token keyword">where</span> id <span class="token operator">not</span> <span class="token operator">in</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> customerId <span class="token keyword">from</span> Orders<span class="token punctuation">)</span>
</code></pre> 
<ol start="3"><li><strong><strong>1873. 计算特殊奖金</strong></strong></li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> employee_id<span class="token punctuation">,</span>salary<span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> employee_id<span class="token operator">%</span><span class="token number">2</span><span class="token operator">!=</span><span class="token number">0</span> <span class="token operator">and</span> <span class="token keyword">left</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token string">"M"</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> bonus
<span class="token keyword">from</span> Employees
<span class="token keyword">order</span> <span class="token keyword">by</span> employee_id
</code></pre> 
<p>4.<strong><strong>1398. 购买了产品 A 和产品 B 却没有购买产品 C 的顾客</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token comment"># 方法一</span>
<span class="token keyword">select</span> customer_id<span class="token punctuation">,</span>customer_name
<span class="token keyword">from</span> Customers
<span class="token keyword">where</span> customer_id <span class="token operator">in</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> customer_id
<span class="token keyword">from</span> Orders
<span class="token keyword">where</span> product_name<span class="token operator">=</span><span class="token string">"A"</span> <span class="token operator">or</span> product_name<span class="token operator">=</span><span class="token string">"B"</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> customer_id
<span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> product_name<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token operator">and</span> customer_id <span class="token operator">not</span> <span class="token operator">in</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> customer_id
<span class="token keyword">from</span> Orders
<span class="token keyword">where</span> product_name<span class="token operator">=</span><span class="token string">"C"</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> customer_id<span class="token punctuation">)</span>

<span class="token comment"># 方法二：巧用sum</span>
<span class="token keyword">select</span> customer_id<span class="token punctuation">,</span>customer_name
<span class="token keyword">from</span> Customers
<span class="token keyword">where</span> customer_id <span class="token operator">in</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> customer_id
<span class="token keyword">from</span> Orders
<span class="token keyword">group</span> <span class="token keyword">by</span> customer_id
<span class="token keyword">having</span> <span class="token function">sum</span><span class="token punctuation">(</span>product_name<span class="token operator">=</span><span class="token string">"A"</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">sum</span><span class="token punctuation">(</span>product_name<span class="token operator">=</span><span class="token string">"B"</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span>
<span class="token operator">and</span> <span class="token function">sum</span><span class="token punctuation">(</span>product_name<span class="token operator">=</span><span class="token string">"C"</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> 
<p>5.<strong><strong>1112. 每位学生的最高成绩</strong></strong></p> 
<pre><code class="prism language-sql">
<span class="token keyword">select</span> student_id<span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>course_id<span class="token punctuation">)</span> course_id<span class="token punctuation">,</span>grade
<span class="token keyword">from</span> Enrollments
<span class="token keyword">where</span> <span class="token punctuation">(</span>student_id<span class="token punctuation">,</span>grade<span class="token punctuation">)</span> <span class="token operator">in</span>
<span class="token punctuation">(</span>
<span class="token keyword">select</span> student_id<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>grade<span class="token punctuation">)</span> grade
<span class="token keyword">from</span> Enrollments 
<span class="token keyword">group</span> <span class="token keyword">by</span> student_id<span class="token punctuation">)</span>
<span class="token comment"># 注意这里的group by，因为取了min，所有要group by</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> student_id
<span class="token keyword">order</span> <span class="token keyword">by</span> student_id<span class="token punctuation">,</span>course_id

</code></pre> 
<p>6.<strong><strong>175. 组合两个表</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> firstName<span class="token punctuation">,</span>lastName<span class="token punctuation">,</span>city<span class="token punctuation">,</span>state
<span class="token keyword">from</span> Person p <span class="token keyword">left</span> <span class="token keyword">join</span> Address a <span class="token keyword">on</span> p<span class="token punctuation">.</span>PersonId <span class="token operator">=</span> a<span class="token punctuation">.</span>personId
</code></pre> 
<ol start="7"><li><strong><strong><a href="https://leetcode.cn/problems/sellers-with-no-sales/" rel="nofollow">1607. 没有卖出的卖家</a></strong></strong></li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> seller_name
<span class="token keyword">from</span> Seller s
<span class="token keyword">where</span> seller_id <span class="token operator">not</span> <span class="token operator">in</span> 
<span class="token punctuation">(</span><span class="token keyword">select</span> seller_id
<span class="token keyword">from</span>  Orders 
<span class="token keyword">where</span> <span class="token keyword">left</span><span class="token punctuation">(</span>sale_date<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">"2020"</span><span class="token punctuation">)</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> seller_name
</code></pre> 
<ol start="8"><li><strong><strong>1407. 排名靠前的旅行者</strong></strong></li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name<span class="token punctuation">,</span>ifnull<span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>distance<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> travelled_distance
<span class="token keyword">from</span> Users u
<span class="token keyword">left</span> <span class="token keyword">join</span> Rides r <span class="token keyword">on</span> u<span class="token punctuation">.</span>id<span class="token operator">=</span>r<span class="token punctuation">.</span>user_id
<span class="token keyword">group</span> <span class="token keyword">by</span> u<span class="token punctuation">.</span>id
<span class="token keyword">order</span> <span class="token keyword">by</span>  travelled_distance <span class="token keyword">desc</span><span class="token punctuation">,</span>name
</code></pre> 
<p>9.<strong><strong>607. 销售员</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name
<span class="token keyword">from</span> SalesPerson
<span class="token keyword">where</span> sales_id <span class="token operator">not</span> <span class="token operator">in</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> sales_id
<span class="token keyword">from</span> Orders o  <span class="token keyword">join</span> Company c
<span class="token keyword">on</span> o<span class="token punctuation">.</span>com_id <span class="token operator">=</span> c<span class="token punctuation">.</span>com_id <span class="token operator">and</span> c<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">"RED"</span> <span class="token punctuation">)</span>
</code></pre> 
<p>10.<strong><strong>1440. 计算布尔表达式的值</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> e<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> operator<span class="token operator">=</span><span class="token string">"&gt;"</span> <span class="token operator">and</span> v1<span class="token punctuation">.</span><span class="token keyword">value</span><span class="token operator">&gt;</span>v2<span class="token punctuation">.</span><span class="token keyword">value</span> <span class="token keyword">then</span> <span class="token string">"true"</span>
      <span class="token keyword">when</span> operator<span class="token operator">=</span><span class="token string">"&lt;"</span> <span class="token operator">and</span> v1<span class="token punctuation">.</span><span class="token keyword">value</span><span class="token operator">&lt;</span>v2<span class="token punctuation">.</span><span class="token keyword">value</span> <span class="token keyword">then</span> <span class="token string">"true"</span>
      <span class="token keyword">when</span> operator<span class="token operator">=</span><span class="token string">"="</span> <span class="token operator">and</span> v1<span class="token punctuation">.</span><span class="token keyword">value</span><span class="token operator">=</span>v2<span class="token punctuation">.</span><span class="token keyword">value</span> <span class="token keyword">then</span> <span class="token string">"true"</span>
<span class="token keyword">else</span> <span class="token string">"false"</span>
<span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">value</span>
<span class="token keyword">from</span> Expressions e
<span class="token keyword">left</span> <span class="token keyword">join</span> Variables v1 <span class="token keyword">on</span> v1<span class="token punctuation">.</span>name<span class="token operator">=</span>e<span class="token punctuation">.</span>left_operand
<span class="token keyword">left</span> <span class="token keyword">join</span> Variables v2 <span class="token keyword">on</span> v2<span class="token punctuation">.</span>name<span class="token operator">=</span>e<span class="token punctuation">.</span>right_operand
</code></pre> 
<p>11.<strong><strong>1212. 查询球队积分</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> t<span class="token punctuation">.</span>team_id<span class="token punctuation">,</span>t<span class="token punctuation">.</span>team_name<span class="token punctuation">,</span>
<span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> m<span class="token punctuation">.</span>host_team <span class="token operator">=</span> t<span class="token punctuation">.</span>team_id <span class="token operator">and</span> host_goals<span class="token operator">&gt;</span>guest_goals <span class="token keyword">then</span> <span class="token number">3</span>
      <span class="token keyword">when</span> m<span class="token punctuation">.</span>guest_team <span class="token operator">=</span> t<span class="token punctuation">.</span>team_id <span class="token operator">and</span> host_goals<span class="token operator">&lt;</span>guest_goals <span class="token keyword">then</span> <span class="token number">3</span>
      <span class="token keyword">when</span>   host_goals<span class="token operator">=</span>guest_goals <span class="token keyword">then</span> <span class="token number">1</span>
<span class="token keyword">else</span> <span class="token number">0</span> 
<span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> num_points
<span class="token keyword">from</span> Matches m
<span class="token keyword">right</span> <span class="token keyword">join</span> Teams t  <span class="token keyword">on</span> m<span class="token punctuation">.</span>host_team <span class="token operator">=</span> t<span class="token punctuation">.</span>team_id <span class="token operator">or</span> m<span class="token punctuation">.</span>guest_team<span class="token operator">=</span>t<span class="token punctuation">.</span>team_id
<span class="token keyword">group</span> <span class="token keyword">by</span> t<span class="token punctuation">.</span>team_id
<span class="token keyword">order</span> <span class="token keyword">by</span> num_points <span class="token keyword">desc</span><span class="token punctuation">,</span>team_id
</code></pre> 
<p>12.<strong><strong>1890. 2020年最后一次登录</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> user_id<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>time_stamp<span class="token punctuation">)</span> <span class="token keyword">as</span> last_stamp
<span class="token keyword">from</span> Logins
<span class="token keyword">where</span> <span class="token keyword">left</span><span class="token punctuation">(</span>time_stamp<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'2020'</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> user_id
</code></pre> 
<p>13.<strong><strong>511. 游戏玩法分析 I</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> player_id<span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>event_date<span class="token punctuation">)</span> <span class="token keyword">as</span> first_login
<span class="token keyword">from</span> Activity
<span class="token keyword">group</span> <span class="token keyword">by</span> player_id
</code></pre> 
<p>14.<strong><strong>1571. 仓库经理</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name <span class="token keyword">as</span> warehouse_name<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>units<span class="token operator">*</span>Width<span class="token operator">*</span>Length<span class="token operator">*</span>Height<span class="token punctuation">)</span> <span class="token keyword">as</span> volume
<span class="token keyword">from</span> Warehouse w <span class="token keyword">left</span> <span class="token keyword">join</span> Products p
<span class="token keyword">on</span> w<span class="token punctuation">.</span>product_id<span class="token operator">=</span>p<span class="token punctuation">.</span>product_id
<span class="token keyword">group</span> <span class="token keyword">by</span> w<span class="token punctuation">.</span>name
</code></pre> 
<p>15.<strong><strong>586. 订单最多的客户</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> customer_number
<span class="token keyword">from</span> Orders
<span class="token keyword">group</span> <span class="token keyword">by</span> customer_number
<span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">count</span><span class="token punctuation">(</span>customer_number<span class="token punctuation">)</span> <span class="token keyword">desc</span> <span class="token keyword">limit</span> <span class="token number">1</span>
</code></pre> 
<p>16.<strong><strong>1741. 查找每个员工花费的总时间</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> event_day <span class="token keyword">as</span> <span class="token keyword">day</span><span class="token punctuation">,</span>emp_id<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>out_time<span class="token operator">-</span>in_time<span class="token punctuation">)</span> <span class="token keyword">as</span> total_time
<span class="token keyword">from</span> Employees
<span class="token keyword">group</span> <span class="token keyword">by</span> event_day<span class="token punctuation">,</span>emp_id
</code></pre> 
<p>17.<strong><strong>1173. 即时食物配送 I</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token operator">*</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> order_date<span class="token operator">=</span>customer_pref_delivery_date <span class="token keyword">then</span> <span class="token number">1</span>
        <span class="token keyword">else</span> <span class="token number">0</span>
        <span class="token keyword">end</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span>delivery_id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> immediate_percentage
<span class="token keyword">from</span> Delivery
</code></pre> 
<p>18.<strong><strong>1445. 苹果和桔子</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> sale_date<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> fruit<span class="token operator">=</span><span class="token string">"apples"</span> <span class="token keyword">then</span> sold_num
                          <span class="token keyword">else</span> <span class="token operator">-</span>sold_num
                          <span class="token keyword">end</span> <span class="token punctuation">)</span> <span class="token keyword">as</span> diff 
<span class="token keyword">from</span> Sales
<span class="token keyword">group</span> <span class="token keyword">by</span> sale_date
</code></pre> 
<p>19.<strong><strong>1699. 两人之间的通话次数</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token comment"># 先找到适合的顺序</span>
<span class="token keyword">select</span> 
<span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> from_id<span class="token operator">&lt;</span>to_id <span class="token keyword">then</span> from_id  <span class="token keyword">else</span> to_id <span class="token keyword">end</span><span class="token punctuation">)</span><span class="token keyword">as</span> person1<span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> from_id<span class="token operator">&lt;</span>to_id <span class="token keyword">then</span> to_id  <span class="token keyword">else</span> from_id <span class="token keyword">end</span><span class="token punctuation">)</span><span class="token keyword">as</span> person2<span class="token punctuation">,</span>
<span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> call_count<span class="token punctuation">,</span>
<span class="token function">sum</span><span class="token punctuation">(</span>duration<span class="token punctuation">)</span> <span class="token keyword">as</span> total_duration
<span class="token keyword">from</span> Calls
<span class="token keyword">group</span> <span class="token keyword">by</span> person1<span class="token punctuation">,</span>person2
</code></pre> 
<p>20.<strong><strong>1587. 银行账户概要 II</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span>  u<span class="token punctuation">.</span>name <span class="token keyword">as</span> NAME<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>amount<span class="token punctuation">)</span> <span class="token keyword">as</span> BALANCE
<span class="token keyword">from</span> <span class="token keyword">Transactions</span> t <span class="token keyword">left</span> <span class="token keyword">join</span> Users u <span class="token keyword">on</span> t<span class="token punctuation">.</span>account<span class="token operator">=</span>u<span class="token punctuation">.</span>account
<span class="token keyword">group</span> <span class="token keyword">by</span> t<span class="token punctuation">.</span>account
<span class="token keyword">having</span> <span class="token function">sum</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">10000</span>
</code></pre> 
<p>21.<strong><strong>182. 查找重复的电子邮箱</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> email Email
<span class="token keyword">from</span> Person
<span class="token keyword">group</span> <span class="token keyword">by</span> email
<span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">2</span>
</code></pre> 
<p>22.<strong><strong>1050. 合作过至少三次的演员和导演</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> actor_id<span class="token punctuation">,</span>director_id
<span class="token keyword">from</span> ActorDirector
<span class="token keyword">group</span> <span class="token keyword">by</span> actor_id<span class="token punctuation">,</span>director_id
<span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">3</span>
</code></pre> 
<p>23.<strong><strong>1511. 消费者下单频率</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> o<span class="token punctuation">.</span>customer_id<span class="token punctuation">,</span>c<span class="token punctuation">.</span>name
<span class="token keyword">from</span> Orders o  <span class="token keyword">join</span> Product p <span class="token keyword">on</span> o<span class="token punctuation">.</span>product_id<span class="token operator">=</span>p<span class="token punctuation">.</span>product_id
               <span class="token keyword">join</span> Customers c <span class="token keyword">on</span> o<span class="token punctuation">.</span>customer_id<span class="token operator">=</span>c<span class="token punctuation">.</span>customer_id
<span class="token keyword">group</span> <span class="token keyword">by</span> customer_id
<span class="token keyword">having</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> <span class="token keyword">left</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>order_date<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">"2020-06"</span> <span class="token keyword">then</span> quantity<span class="token operator">*</span>price <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">end</span><span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">100</span>
<span class="token operator">and</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> <span class="token keyword">left</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>order_date<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">"2020-07"</span> <span class="token keyword">then</span> quantity<span class="token operator">*</span>price <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">end</span><span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">100</span>
</code></pre> 
<p>24.<strong><strong>1693. 每天的领导和合伙人</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> date_id<span class="token punctuation">,</span>make_name<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> lead_id<span class="token punctuation">)</span> unique_leads<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> partner_id<span class="token punctuation">)</span> unique_partners
<span class="token keyword">from</span> DailySales
<span class="token keyword">group</span> <span class="token keyword">by</span> date_id<span class="token punctuation">,</span>make_name
</code></pre> 
<p>25.<strong><strong>1495. 上月播放的儿童适宜电影</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token keyword">distinct</span> title
<span class="token keyword">from</span> Content c <span class="token keyword">left</span> <span class="token keyword">join</span> TVProgram t <span class="token keyword">on</span> c<span class="token punctuation">.</span>content_id <span class="token operator">=</span>t<span class="token punctuation">.</span>content_id 
<span class="token keyword">where</span> c<span class="token punctuation">.</span>Kids_content<span class="token operator">=</span><span class="token string">'Y'</span> <span class="token operator">and</span> <span class="token keyword">left</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>program_date<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">"2020-06"</span> <span class="token operator">and</span> content_type<span class="token operator">=</span><span class="token string">"Movies"</span>
</code></pre> 
<p>26.<strong><strong>1501. 可以放心投资的国家</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> co<span class="token punctuation">.</span>name <span class="token keyword">as</span>  country
<span class="token keyword">from</span> Person p <span class="token keyword">join</span> Country co <span class="token keyword">on</span> <span class="token keyword">left</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>phone_number<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">=</span>co<span class="token punctuation">.</span>country_code
              <span class="token keyword">join</span> Calls ca   <span class="token keyword">on</span> p<span class="token punctuation">.</span>id<span class="token operator">=</span>ca<span class="token punctuation">.</span>caller_id <span class="token operator">or</span> p<span class="token punctuation">.</span>id<span class="token operator">=</span>ca<span class="token punctuation">.</span>callee_id
<span class="token keyword">group</span> <span class="token keyword">by</span> co<span class="token punctuation">.</span>country_code
<span class="token keyword">having</span> <span class="token function">avg</span><span class="token punctuation">(</span>duration<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>duration<span class="token punctuation">)</span> <span class="token keyword">from</span> Calls<span class="token punctuation">)</span>
</code></pre> 
<p>27.<strong><strong>603. 连续空余座位</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token keyword">distinct</span> c1<span class="token punctuation">.</span>seat_id
<span class="token keyword">from</span> Cinema c1 <span class="token keyword">join</span> Cinema c2
<span class="token keyword">on</span> abs<span class="token punctuation">(</span>c1<span class="token punctuation">.</span>seat_id <span class="token operator">-</span> c2<span class="token punctuation">.</span>seat_id<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token keyword">where</span> c1<span class="token punctuation">.</span>free<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">and</span> c2<span class="token punctuation">.</span>free<span class="token operator">=</span><span class="token number">1</span>
<span class="token keyword">order</span> <span class="token keyword">by</span>  c1<span class="token punctuation">.</span>seat_id
</code></pre> 
<p>28.<strong><strong>1795. 每个产品在不同商店的价格</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> product_id<span class="token punctuation">,</span><span class="token string">"store1"</span> <span class="token keyword">as</span> store<span class="token punctuation">,</span>store1 price
<span class="token keyword">from</span> Products
<span class="token keyword">where</span> store1 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> product_id<span class="token punctuation">,</span><span class="token string">"store2"</span> <span class="token keyword">as</span> store<span class="token punctuation">,</span>store2 price
<span class="token keyword">from</span> Products
<span class="token keyword">where</span> store2 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> product_id<span class="token punctuation">,</span><span class="token string">"store3"</span> <span class="token keyword">as</span> store<span class="token punctuation">,</span>store3 price
<span class="token keyword">from</span> Products
<span class="token keyword">where</span> store3 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>
</code></pre> 
<p>29.<strong><strong>613. 直线上的最近距离</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>abs<span class="token punctuation">(</span>p1<span class="token punctuation">.</span>x<span class="token operator">-</span>p2<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> shortest
<span class="token keyword">from</span> <span class="token keyword">Point</span> p1  <span class="token keyword">join</span> <span class="token keyword">Point</span> p2 <span class="token keyword">on</span> p1<span class="token punctuation">.</span>x<span class="token operator">!=</span>p2<span class="token punctuation">.</span>x
</code></pre> 
<p>30.<strong><strong>1965. 丢失信息的雇员</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> employee_id
<span class="token keyword">from</span> Employees
<span class="token keyword">where</span> employee_id  <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> employee_id <span class="token keyword">from</span> Salaries<span class="token punctuation">)</span>
<span class="token keyword">union</span>
<span class="token keyword">select</span> employee_id
<span class="token keyword">from</span> Salaries
<span class="token keyword">where</span> employee_id  <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> employee_id <span class="token keyword">from</span> Employees<span class="token punctuation">)</span>
<span class="token keyword">order</span> <span class="token keyword">by</span>  employee_id
</code></pre> 
<p>31.<strong><strong>1264. 页面推荐</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token keyword">distinct</span> page_id <span class="token keyword">as</span> recommended_page
<span class="token keyword">from</span> Likes
<span class="token keyword">where</span> user_id <span class="token operator">in</span><span class="token punctuation">(</span>
<span class="token keyword">select</span> user2_id user_id
<span class="token keyword">from</span> Friendship
<span class="token keyword">where</span> user1_id <span class="token operator">=</span><span class="token string">"1"</span>
<span class="token keyword">union</span>
<span class="token keyword">select</span> user1_id user_id
<span class="token keyword">from</span> Friendship
<span class="token keyword">where</span> user2_id <span class="token operator">=</span><span class="token string">"1"</span><span class="token punctuation">)</span>
<span class="token operator">and</span> page_id <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> page_id <span class="token keyword">from</span> Likes <span class="token keyword">where</span> user_id<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> 
<p>32.<strong><strong>608. 树节点</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> id<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> p_id <span class="token operator">is</span> <span class="token boolean">null</span> <span class="token keyword">then</span> <span class="token string">"Root"</span>
                <span class="token keyword">when</span> id <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> p_id <span class="token keyword">from</span> Tree <span class="token keyword">where</span>  p_id <span class="token operator">is</span> <span class="token operator">not</span>  <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token keyword">then</span>  <span class="token string">"Leaf"</span>
            <span class="token keyword">else</span> <span class="token string">"Inner"</span>
            <span class="token keyword">end</span> <span class="token punctuation">)</span><span class="token keyword">type</span>
<span class="token keyword">from</span> Tree
</code></pre> 
<p>33.<strong><strong>534. 游戏玩法分析 III</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> a2<span class="token punctuation">.</span>player_id<span class="token punctuation">,</span>a2<span class="token punctuation">.</span>event_date<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>a1<span class="token punctuation">.</span>games_played<span class="token punctuation">)</span> <span class="token keyword">as</span> games_played_so_far
<span class="token keyword">FROM</span> Activity a1 <span class="token keyword">left</span> <span class="token keyword">join</span> Activity a2  <span class="token keyword">on</span> a1<span class="token punctuation">.</span>player_id<span class="token operator">=</span>a2<span class="token punctuation">.</span>player_id <span class="token operator">and</span> a2<span class="token punctuation">.</span>event_date<span class="token operator">&gt;=</span>a1<span class="token punctuation">.</span>event_date
<span class="token keyword">group</span> <span class="token keyword">by</span> a2<span class="token punctuation">.</span>event_date<span class="token punctuation">,</span>player_id
</code></pre> 
<p>34.<strong><strong>1783. 大满贯数量</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> p<span class="token punctuation">.</span>player_id<span class="token punctuation">,</span>p<span class="token punctuation">.</span>player_name<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>Wimbledon<span class="token operator">=</span>p<span class="token punctuation">.</span>player_id<span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">sum</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>Fr_open<span class="token operator">=</span>p<span class="token punctuation">.</span>player_id<span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">sum</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>US_open<span class="token operator">=</span>p<span class="token punctuation">.</span>player_id<span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">sum</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>Au_open<span class="token operator">=</span>p<span class="token punctuation">.</span>player_id<span class="token punctuation">)</span>grand_slams_count
<span class="token keyword">from</span> Players p<span class="token punctuation">,</span>Championships c
<span class="token keyword">group</span> <span class="token keyword">by</span> p<span class="token punctuation">.</span>player_id
<span class="token keyword">having</span> grand_slams_count<span class="token operator">&gt;</span><span class="token number">0</span>
</code></pre> 
<p>35.<strong><strong>1747. 应该被禁止的 Leetflex 账户</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> account_id
<span class="token keyword">from</span><span class="token punctuation">(</span><span class="token keyword">select</span> account_id<span class="token punctuation">,</span>login<span class="token punctuation">,</span>logout<span class="token punctuation">,</span>lead <span class="token punctuation">(</span>login<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> ll<span class="token punctuation">,</span>nums
<span class="token keyword">from</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span>row_number<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> account_id <span class="token keyword">order</span> <span class="token keyword">by</span> login<span class="token punctuation">)</span> <span class="token keyword">as</span> nums
<span class="token keyword">from</span> loginfo<span class="token punctuation">)</span>aaa<span class="token punctuation">)</span>bbb
<span class="token keyword">where</span> nums<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">and</span> ll <span class="token operator">between</span> login <span class="token operator">and</span> logout
</code></pre> 
<p>36.<strong><a href="https://leetcode.cn/problems/students-with-invalid-departments/" rel="nofollow">1350. 院系无效的学生</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> id<span class="token punctuation">,</span>name
<span class="token keyword">from</span> Students s 
<span class="token keyword">where</span> s<span class="token punctuation">.</span>department_id <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> id <span class="token keyword">from</span> Departments<span class="token punctuation">)</span>
</code></pre> 
<p>37.<strong><a href="https://leetcode.cn/problems/find-the-team-size/" rel="nofollow">1303. 求团队人数</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> e1<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> team_size
<span class="token keyword">from</span> Employee e1 <span class="token keyword">left</span> <span class="token keyword">join</span> Employee e2 <span class="token keyword">on</span> e1<span class="token punctuation">.</span>team_id<span class="token operator">=</span>e2<span class="token punctuation">.</span>team_id
<span class="token keyword">group</span> <span class="token keyword">by</span> e1<span class="token punctuation">.</span>employee_id
</code></pre> 
<p>38.<strong><a href="https://leetcode.cn/problems/game-play-analysis-ii/" rel="nofollow">512. 游戏玩法分析 II</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span>  player_id<span class="token punctuation">,</span>device_id
<span class="token keyword">from</span> Activity
<span class="token keyword">where</span> <span class="token punctuation">(</span>player_id<span class="token punctuation">,</span>event_date<span class="token punctuation">)</span> <span class="token operator">in</span>
<span class="token punctuation">(</span><span class="token keyword">select</span>  player_id<span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>event_date<span class="token punctuation">)</span>
<span class="token keyword">from</span> Activity
<span class="token keyword">group</span> <span class="token keyword">by</span> player_id<span class="token punctuation">)</span>
</code></pre> 
<p>39.<strong><a href="https://leetcode.cn/problems/department-highest-salary/" rel="nofollow">184. 部门工资最高的员工</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> d<span class="token punctuation">.</span>name Department<span class="token punctuation">,</span>e<span class="token punctuation">.</span>name Employee<span class="token punctuation">,</span>e<span class="token punctuation">.</span>salary
<span class="token keyword">from</span>  Employee e <span class="token keyword">left</span> <span class="token keyword">join</span> Department d <span class="token keyword">on</span> e<span class="token punctuation">.</span>departmentId<span class="token operator">=</span>d<span class="token punctuation">.</span>id 
<span class="token keyword">where</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>departmentId<span class="token punctuation">,</span>e<span class="token punctuation">.</span>salary<span class="token punctuation">)</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> departmentId<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">from</span>  Employee  
<span class="token keyword">group</span> <span class="token keyword">by</span> departmentId <span class="token punctuation">)</span>
</code></pre> 
<p>40.<strong><a href="https://leetcode.cn/problems/the-most-recent-orders-for-each-product/" rel="nofollow">1549. 每件商品的最新订单</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> p<span class="token punctuation">.</span>product_name<span class="token punctuation">,</span>o<span class="token punctuation">.</span>product_id<span class="token punctuation">,</span>o<span class="token punctuation">.</span>order_id<span class="token punctuation">,</span>o<span class="token punctuation">.</span>order_date
<span class="token keyword">from</span> Orders o <span class="token keyword">left</span> <span class="token keyword">join</span> Products p <span class="token keyword">on</span> o<span class="token punctuation">.</span>product_id<span class="token operator">=</span>p<span class="token punctuation">.</span>product_id
<span class="token keyword">where</span> <span class="token punctuation">(</span>o<span class="token punctuation">.</span>product_id<span class="token punctuation">,</span>o<span class="token punctuation">.</span>order_date<span class="token punctuation">)</span> <span class="token operator">in</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> product_id<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>order_date<span class="token punctuation">)</span>
<span class="token keyword">from</span> Orders
<span class="token keyword">group</span> <span class="token keyword">by</span> product_id<span class="token punctuation">)</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> p<span class="token punctuation">.</span>product_name<span class="token punctuation">,</span>o<span class="token punctuation">.</span>product_id<span class="token punctuation">,</span>o<span class="token punctuation">.</span>order_id
</code></pre> 
<p>41.<strong><a href="https://leetcode.cn/problems/the-most-recent-three-orders/" rel="nofollow">1532. 最近的三笔订单</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> c<span class="token punctuation">.</span>name <span class="token keyword">as</span> customer_name<span class="token punctuation">,</span>c<span class="token punctuation">.</span>customer_id<span class="token punctuation">,</span>o2<span class="token punctuation">.</span>order_id<span class="token punctuation">,</span>o2<span class="token punctuation">.</span>order_date
<span class="token keyword">from</span> Orders o1 <span class="token keyword">left</span> <span class="token keyword">join</span> Orders o2 <span class="token keyword">on</span> o1<span class="token punctuation">.</span>customer_id<span class="token operator">=</span>o2<span class="token punctuation">.</span>customer_id <span class="token operator">and</span> o1<span class="token punctuation">.</span>order_date<span class="token operator">&gt;=</span>o2<span class="token punctuation">.</span>order_date 
                <span class="token keyword">left</span> <span class="token keyword">join</span> Customers c <span class="token keyword">on</span> o1<span class="token punctuation">.</span>customer_id<span class="token operator">=</span>c<span class="token punctuation">.</span>customer_id
<span class="token keyword">group</span> <span class="token keyword">by</span> o2<span class="token punctuation">.</span>order_id
<span class="token comment">#比我日期更近的order_date不超过3个，所以是前三</span>
<span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span>o1<span class="token punctuation">.</span>order_date<span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">3</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> c<span class="token punctuation">.</span>name<span class="token punctuation">,</span>c<span class="token punctuation">.</span>customer_id<span class="token punctuation">,</span>o2<span class="token punctuation">.</span>order_date <span class="token keyword">desc</span>
</code></pre> 
<p>42.<strong><a href="https://leetcode.cn/problems/maximum-transaction-each-day/" rel="nofollow">1831. 每天的最大交易</a></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> transaction_id
<span class="token keyword">from</span> <span class="token keyword">Transactions</span>
<span class="token keyword">where</span> <span class="token punctuation">(</span><span class="token keyword">day</span><span class="token punctuation">,</span>amount<span class="token punctuation">)</span> <span class="token operator">in</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">day</span><span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span>
<span class="token keyword">from</span> <span class="token keyword">Transactions</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token keyword">day</span><span class="token punctuation">)</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> transaction_id
</code></pre> 
<p>43.<strong><strong>1077. 项目员工 III</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token comment"># 解题思路同39题</span>
<span class="token keyword">select</span> p<span class="token punctuation">.</span>project_id<span class="token punctuation">,</span>p<span class="token punctuation">.</span>employee_id
<span class="token keyword">from</span> Project p <span class="token keyword">left</span> <span class="token keyword">join</span> Employee e <span class="token keyword">on</span> p<span class="token punctuation">.</span>employee_id<span class="token operator">=</span>e<span class="token punctuation">.</span>employee_id
<span class="token keyword">where</span> <span class="token punctuation">(</span>p<span class="token punctuation">.</span>project_id<span class="token punctuation">,</span>e<span class="token punctuation">.</span>experience_years<span class="token punctuation">)</span> <span class="token operator">in</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> p<span class="token punctuation">.</span>project_id<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>experience_years<span class="token punctuation">)</span>
<span class="token keyword">from</span> Project p <span class="token keyword">left</span> <span class="token keyword">join</span> Employee e <span class="token keyword">on</span> p<span class="token punctuation">.</span>employee_id<span class="token operator">=</span>e<span class="token punctuation">.</span>employee_id
<span class="token keyword">group</span> <span class="token keyword">by</span> p<span class="token punctuation">.</span>project_id<span class="token punctuation">)</span>
</code></pre> 
<p>44.<strong><strong>1285. 找到连续区间的开始和结束数字</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token comment">#开窗函数，还看不太懂</span>
<span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>log_id<span class="token punctuation">)</span> <span class="token keyword">as</span> start_id<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>log_id<span class="token punctuation">)</span> <span class="token keyword">as</span> end_id
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span>
    log_id<span class="token punctuation">,</span>
    log_id <span class="token operator">-</span> row_number<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token punctuation">)</span> diff
<span class="token keyword">FROM</span> logs<span class="token punctuation">)</span><span class="token keyword">as</span> t
<span class="token keyword">group</span> <span class="token keyword">by</span> diff
</code></pre> 
<p>45.<strong><strong>1596. 每位顾客最经常订购的商品</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> o<span class="token punctuation">.</span>customer_id<span class="token punctuation">,</span>o<span class="token punctuation">.</span>product_id<span class="token punctuation">,</span>p<span class="token punctuation">.</span>product_name
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> customer_id<span class="token punctuation">,</span>product_id<span class="token punctuation">,</span>
rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span>  customer_id <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">count</span><span class="token punctuation">(</span>product_id<span class="token punctuation">)</span> <span class="token keyword">desc</span><span class="token punctuation">)</span>rnk 
<span class="token keyword">from</span> Orders
<span class="token keyword">group</span> <span class="token keyword">by</span> customer_id<span class="token punctuation">,</span>product_id<span class="token punctuation">)</span>o
<span class="token keyword">join</span> products p <span class="token keyword">on</span> o<span class="token punctuation">.</span>product_id<span class="token operator">=</span>p<span class="token punctuation">.</span>product_id
<span class="token keyword">where</span> rnk<span class="token operator">=</span><span class="token number">1</span>
</code></pre> 
<p>46.<strong><strong>1709. 访问日期之间最大的空档期</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> user_id<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>datediff<span class="token punctuation">(</span>next_day<span class="token punctuation">,</span>visit_date<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span>  biggest_window
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> user_id<span class="token punctuation">,</span>visit_date<span class="token punctuation">,</span>LEAD<span class="token punctuation">(</span>visit_date<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'2021-1-1'</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> user_id <span class="token keyword">order</span> <span class="token keyword">by</span> visit_date<span class="token punctuation">)</span><span class="token keyword">as</span> next_day
<span class="token keyword">from</span>  UserVisits<span class="token punctuation">)</span><span class="token keyword">as</span> tmp
<span class="token keyword">group</span> <span class="token keyword">by</span> user_id
<span class="token keyword">order</span> <span class="token keyword">by</span> user_id
</code></pre> 
<p>47.<strong><strong>1270. 向公司 CEO 汇报工作的所有人</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token keyword">distinct</span> employee_id
<span class="token keyword">from</span> 
<span class="token punctuation">(</span><span class="token keyword">select</span> employee_id <span class="token keyword">from</span> Employees <span class="token keyword">where</span> manager_id<span class="token operator">=</span><span class="token number">1</span>
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> employee_id <span class="token keyword">from</span> Employees
<span class="token keyword">where</span> manager_id  <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> employee_id <span class="token keyword">from</span> Employees <span class="token keyword">where</span> manager_id<span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> employee_id <span class="token keyword">from</span> Employees
<span class="token keyword">where</span> manager_id  <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> employee_id <span class="token keyword">from</span> Employees
<span class="token keyword">where</span> manager_id  <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> employee_id <span class="token keyword">from</span> Employees <span class="token keyword">where</span> manager_id<span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>e
<span class="token keyword">where</span> employee_id<span class="token operator">!=</span><span class="token number">1</span>

<span class="token keyword">SELECT</span> e1<span class="token punctuation">.</span>employee_id
<span class="token keyword">FROM</span> Employees e1
<span class="token keyword">JOIN</span> Employees e2 <span class="token keyword">ON</span> e1<span class="token punctuation">.</span>manager_id <span class="token operator">=</span> e2<span class="token punctuation">.</span>employee_id
<span class="token keyword">JOIN</span> Employees e3 <span class="token keyword">ON</span> e2<span class="token punctuation">.</span>manager_id <span class="token operator">=</span> e3<span class="token punctuation">.</span>employee_id
<span class="token keyword">WHERE</span> e1<span class="token punctuation">.</span>employee_id <span class="token operator">!=</span> <span class="token number">1</span> <span class="token operator">AND</span> e3<span class="token punctuation">.</span>manager_id <span class="token operator">=</span> <span class="token number">1</span>
</code></pre> 
<p>48.<strong><strong>1412. 查找成绩处于中游的学生</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> tmp<span class="token punctuation">.</span>student_id<span class="token punctuation">,</span>s<span class="token punctuation">.</span>student_name
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>dense_rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> exam_id <span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token keyword">desc</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> d_rank<span class="token punctuation">,</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>dense_rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> exam_id <span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> a_rank
<span class="token keyword">from</span> Exam<span class="token punctuation">)</span>tmp
<span class="token keyword">left</span> <span class="token keyword">join</span> Student s <span class="token keyword">on</span> tmp<span class="token punctuation">.</span>student_id<span class="token operator">=</span>s<span class="token punctuation">.</span>student_id
<span class="token keyword">group</span> <span class="token keyword">by</span> tmp<span class="token punctuation">.</span>student_id
<span class="token keyword">having</span> <span class="token function">sum</span><span class="token punctuation">(</span>d_rank<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span> <span class="token operator">and</span> <span class="token function">sum</span><span class="token punctuation">(</span>a_rank<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> tmp<span class="token punctuation">.</span>student_id
</code></pre> 
<p>⭐⭐⭐49.<strong><strong>1767. 寻找没有被执行的任务对</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">with</span> recursive table1 <span class="token keyword">as</span><span class="token punctuation">(</span><span class="token keyword">select</span> task_id<span class="token punctuation">,</span>subtasks_count subtask_id 
<span class="token keyword">from</span> Tasks
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> task_id<span class="token punctuation">,</span>subtask_id<span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">from</span> table1 <span class="token keyword">where</span>  subtask_id <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span>

<span class="token keyword">select</span> task_id<span class="token punctuation">,</span>subtask_id
<span class="token keyword">from</span> table1
<span class="token keyword">left</span> <span class="token keyword">join</span> Executed E <span class="token keyword">using</span><span class="token punctuation">(</span>task_id<span class="token punctuation">,</span> subtask_id<span class="token punctuation">)</span>
<span class="token keyword">where</span> E<span class="token punctuation">.</span>task_id <span class="token operator">is</span> <span class="token boolean">null</span>
</code></pre> 
<p>⭐⭐⭐<strong><strong>1225. 报告系统状态的连续日期</strong></strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token keyword">type</span> <span class="token keyword">as</span> period_state<span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token keyword">date</span><span class="token punctuation">)</span> <span class="token keyword">as</span> start_date<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">date</span><span class="token punctuation">)</span> <span class="token keyword">as</span> end_date
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">type</span><span class="token punctuation">,</span><span class="token keyword">date</span><span class="token punctuation">,</span>subdate<span class="token punctuation">(</span><span class="token keyword">date</span><span class="token punctuation">,</span>row_number<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> <span class="token keyword">type</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token keyword">date</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">as</span> diff
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token string">"failed"</span> <span class="token keyword">as</span> <span class="token keyword">type</span><span class="token punctuation">,</span>fail_date <span class="token keyword">as</span> <span class="token keyword">date</span> <span class="token keyword">from</span> Failed
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> <span class="token string">"succeeded"</span> <span class="token keyword">as</span> <span class="token keyword">type</span><span class="token punctuation">,</span>success_date  <span class="token keyword">as</span> <span class="token keyword">date</span> <span class="token keyword">from</span> Succeeded<span class="token punctuation">)</span>tmp1<span class="token punctuation">)</span>tmp2
<span class="token keyword">where</span> <span class="token keyword">date</span> <span class="token operator">between</span> <span class="token string">"2019-01-01"</span> <span class="token operator">and</span> <span class="token string">"2019-12-31"</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token keyword">type</span><span class="token punctuation">,</span>diff
<span class="token keyword">order</span> <span class="token keyword">by</span>  start_date
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c6e053b66b9e3ad3dd1954516942b673/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">VSCode中的AI工具</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6f79eb4682678b5b70aa84ac67e3308b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">AIGC：阿里开源大模型通义千问部署与实战</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>