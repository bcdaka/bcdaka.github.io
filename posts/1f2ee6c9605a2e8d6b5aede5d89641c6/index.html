<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ã€æœºå™¨å­¦ä¹ èšç±»ç®—æ³•å®æˆ˜-4ã€‘æœºå™¨å­¦ä¹ èšç±»ç®—æ³•ä¹‹k-å‡å€¼èšç±»ã€åˆ†å±‚èšç±»ç®—æ³•ã€å‡èšèšç±»å’Œè°±èšç±»å®ä¾‹åˆ†æ - ç¼–ç¨‹å¤§å’–</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/1f2ee6c9605a2e8d6b5aede5d89641c6/">
  <meta property="og:site_name" content="ç¼–ç¨‹å¤§å’–">
  <meta property="og:title" content="ã€æœºå™¨å­¦ä¹ èšç±»ç®—æ³•å®æˆ˜-4ã€‘æœºå™¨å­¦ä¹ èšç±»ç®—æ³•ä¹‹k-å‡å€¼èšç±»ã€åˆ†å±‚èšç±»ç®—æ³•ã€å‡èšèšç±»å’Œè°±èšç±»å®ä¾‹åˆ†æ">
  <meta property="og:description" content="ğŸ© æ¬¢è¿æ¥åˆ°æŠ€æœ¯æ¢ç´¢çš„å¥‡å¹»ä¸–ç•ŒğŸ‘¨â€ğŸ’»
ğŸ“œ ä¸ªäººä¸»é¡µï¼š@ä¸€ä¼¦æ˜æ‚¦-CSDNåšå®¢
âœğŸ» ä½œè€…ç®€ä»‹ï¼šÂ C&#43;&#43;è½¯ä»¶å¼€å‘ã€Pythonæœºå™¨å­¦ä¹ çˆ±å¥½è€…
ğŸ—£ï¸Â äº’åŠ¨ä¸æ”¯æŒï¼šğŸ’¬è¯„è®ºÂ ğŸ‘ğŸ»ç‚¹èµÂ ğŸ“‚æ”¶è—Â ğŸ‘€å…³æ³¨&#43;
å¦‚æœæ–‡ç« æœ‰æ‰€å¸®åŠ©ï¼Œæ¬¢è¿ç•™ä¸‹æ‚¨å®è´µçš„è¯„è®ºï¼Œç‚¹èµåŠ æ”¶è—æ”¯æŒæˆ‘ï¼Œç‚¹å‡»å…³æ³¨ï¼Œä¸€èµ·è¿›æ­¥ï¼
ç›®å½•
å‰è¨€Â æ­£æ–‡
01-åŸºäºå‡èšèšç±»ç®—æ³•çš„äºŒç»´æ•°å­—åµŒå…¥ä¸Šçš„å„ç§å‡èšèšç±»Â 02-åŸºäºK-meansèšç±»ç®—æ³•å¯¹é¸¢å°¾èŠ±æ•°æ®é›†è¿›è¡Œèšç±»Â 03-åŸºäºå…‰è°±èšç±»ç®—æ³•åœ¨å›¾åƒåˆ†å‰²ä¸­çš„åº”ç”¨å®ä¾‹Â 04-åŸºäºç¡¬å¸å›¾åƒçš„ç»“æ„åŒ–åŒºåŸŸåˆ†å±‚èšç±»æ¼”ç¤ºÂ å‰è¨€Â åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œèšç±»ç®—æ³•æ˜¯ä¸€ç±»é‡è¦çš„æ— ç›‘ç£å­¦ä¹ æ–¹æ³•ï¼Œç”¨äºå°†æ•°æ®é›†ä¸­çš„æ ·æœ¬åˆ†æˆå…·æœ‰ç›¸ä¼¼ç‰¹å¾çš„ç»„æˆ–ç°‡ã€‚æœ¬ç¯‡åšå®¢å°†æ·±å…¥æ¢è®¨å››ç§å¸¸ç”¨çš„èšç±»ç®—æ³•ï¼šk-å‡å€¼èšç±»ã€åˆ†å±‚èšç±»ç®—æ³•ã€å‡èšèšç±»å’Œè°±èšç±»ã€‚é€šè¿‡è¯¦ç»†çš„ä»£ç ç¤ºä¾‹å’Œå¯è§†åŒ–åˆ†æï¼Œæˆ‘ä»¬å°†ç†è§£æ¯ç§ç®—æ³•çš„åŸç†ã€ä¼˜ç¼ºç‚¹ä»¥åŠé€‚ç”¨åœºæ™¯ã€‚é€šè¿‡æœ¬æ–‡çš„é˜…è¯»ï¼Œè¯»è€…å°†èƒ½å¤Ÿæ›´å¥½åœ°é€‰æ‹©å¹¶ç†è§£å¦‚ä½•åº”ç”¨é€‚åˆè‡ªå·±æ•°æ®é›†çš„èšç±»ç®—æ³•ï¼Œä»è€Œæ›´æœ‰æ•ˆåœ°è¿›è¡Œæ•°æ®åˆ†æå’ŒæŒ–æ˜ã€‚
æ­£æ–‡ 01-åŸºäºå‡èšèšç±»ç®—æ³•çš„äºŒç»´æ•°å­—åµŒå…¥ä¸Šçš„å„ç§å‡èšèšç±»Â è¿™ä¸ªä¾‹å­å‘æˆ‘ä»¬å±•ç¤ºçš„æ˜¯èšé›†æ€§èšç±»çš„â€œrich getting richerâ€çš„è¡Œä¸ºï¼Œè¿™ç§è¡Œä¸ºå¾€å¾€ä¼šé€ æˆä¸å‡åŒ€çš„èšç±»å¤§å°ã€‚è¿™ç§è¡Œä¸ºå¯¹äºå¹³å‡é“¾æ¥ç­–ç•¥æ¥è¯´æ˜¯éå¸¸æ˜æ˜¾çš„ï¼Œå®ƒæœ€ç»ˆäº§ç”Ÿäº†å‡ ä¸ªå•ç‚¹ç°‡ï¼Œè€Œåœ¨å•ä¸ªé“¾æ¥ä¸­ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªå•ä¸€çš„ä¸­å¿ƒç°‡ï¼Œæ‰€æœ‰å…¶ä»–çš„ç°‡éƒ½æ˜¯ä»è¾¹ç¼˜çš„å™ªå£°ç‚¹ä¸­æå–å‡ºæ¥çš„ã€‚
ä¸‹é¢æ˜¯å…·ä½“ä»£ç ï¼šè¿™æ®µä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨å±‚æ¬¡èšç±»ï¼ˆHierarchical Clusteringï¼‰æ–¹æ³•å¯¹æ‰‹å†™æ•°å­—æ•°æ®é›†ï¼ˆdigits datasetï¼‰è¿›è¡Œèšç±»ï¼Œå¹¶å°†ä¸åŒé“¾æ¥æ–¹å¼ï¼ˆlinkage methodsï¼‰çš„èšç±»ç»“æœå¯è§†åŒ–ã€‚
å¯¼å…¥å¿…è¦çš„åº“ï¼štimeï¼šç”¨äºè®¡ç®—ä»£ç è¿è¡Œæ—¶é—´ã€‚numpyï¼šç”¨äºæ•°å€¼è®¡ç®—ã€‚scipy.ndimageï¼šç”¨äºå›¾åƒå¤„ç†ã€‚matplotlib.pyplotï¼šç”¨äºç»˜å›¾ã€‚sklearn.manifoldï¼šç”¨äºé™ç»´ã€‚sklearn.datasetsï¼šç”¨äºåŠ è½½æ•°æ®é›†ã€‚sklearn.cluster.AgglomerativeClusteringï¼šç”¨äºè¿›è¡Œå±‚æ¬¡èšç±»ã€‚
åŠ è½½æ•°æ®é›†ï¼šä½¿ç”¨datasets.load_digits()åŠ è½½æ‰‹å†™æ•°å­—æ•°æ®é›†ï¼Œè¿”å›ç‰¹å¾çŸ©é˜µXå’Œæ ‡ç­¾yã€‚
å®šä¹‰nudge_imageså‡½æ•°ï¼šè¯¥å‡½æ•°ç”¨äºå¾®è°ƒå›¾åƒï¼Œä»¥å¢åŠ æ•°æ®é›†çš„å¤šæ ·æ€§ã€‚å¯¹æ¯å¼ å›¾åƒè¿›è¡Œå¾®å°çš„å¹³ç§»æ“ä½œã€‚
å®šä¹‰plot_clusteringå‡½æ•°ï¼šç”¨äºç»˜åˆ¶èšç±»ç»“æœçš„æ•£ç‚¹å›¾ã€‚å°†é™ç»´åçš„æ•°æ®X_redæ˜ å°„åˆ°äºŒç»´ç©ºé—´ï¼Œå¹¶æ ¹æ®èšç±»æ ‡ç­¾labelsç»™ä¸åŒç±»åˆ«çš„ç‚¹ä¸Šè‰²ã€‚
é™ç»´ï¼šä½¿ç”¨manifold.SpectralEmbeddingå¯¹æ•°æ®è¿›è¡Œé™ç»´ï¼Œå‡å°‘ç‰¹å¾ç»´åº¦åˆ°2ç»´ï¼Œä»¥ä¾¿å¯è§†åŒ–ã€‚
å¾ªç¯éå†ä¸åŒçš„é“¾æ¥æ–¹å¼ï¼šå¯¹äºæ¯ä¸€ç§é“¾æ¥æ–¹å¼ï¼ˆwardã€averageã€completeã€singleï¼‰ï¼šå°†å›¾åƒä¿å­˜ä¸º.pngæ–‡ä»¶ã€‚Â è°ƒç”¨plot_clusteringå‡½æ•°ç»˜åˆ¶èšç±»ç»“æœçš„æ•£ç‚¹å›¾ã€‚è®°å½•èšç±»è¿è¡Œæ—¶é—´ã€‚ä½¿ç”¨AgglomerativeClusteringè¿›è¡Œå±‚æ¬¡èšç±»ï¼ŒæŒ‡å®šèšç±»æ•°é‡ä¸º10ã€‚
from time import time import numpy as np from scipy import ndimage from matplotlib import pyplot as plt from sklearn import manifold, datasets from sklearn.cluster import AgglomerativeClustering X, y = datasets.load_digits(return_X_y=True) n_samples, n_features = X.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-18T20:26:35+08:00">
    <meta property="article:modified_time" content="2024-05-18T20:26:35+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§å’–" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§å’–</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ã€æœºå™¨å­¦ä¹ èšç±»ç®—æ³•å®æˆ˜-4ã€‘æœºå™¨å­¦ä¹ èšç±»ç®—æ³•ä¹‹k-å‡å€¼èšç±»ã€åˆ†å±‚èšç±»ç®—æ³•ã€å‡èšèšç±»å’Œè°±èšç±»å®ä¾‹åˆ†æ</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><img alt="" height="100" src="https://images2.imgbox.com/76/36/6cMXzVbh_o.png" width="1200"></p> 
<blockquote> 
 <p>ğŸ© <span style="color:#511b78;"><strong>æ¬¢è¿æ¥åˆ°æŠ€æœ¯æ¢ç´¢çš„å¥‡å¹»ä¸–ç•Œ</strong></span>ğŸ‘¨â€ğŸ’»</p> 
 <p>ğŸ“œ <strong>ä¸ªäººä¸»é¡µ</strong><a href="https://blog.csdn.net/m0_64336780" title="ï¼š">ï¼š</a><a href="https://blog.csdn.net/m0_59951855?type=lately" title="@ä¸€ä¼¦æ˜æ‚¦-CSDNåšå®¢">@ä¸€ä¼¦æ˜æ‚¦-CSDNåšå®¢</a></p> 
 <p>âœğŸ» <strong>ä½œè€…ç®€ä»‹</strong>ï¼šÂ <span style="color:#1a439c;"><strong>C++è½¯ä»¶å¼€å‘ã€Pythonæœºå™¨å­¦ä¹ çˆ±å¥½è€…</strong></span></p> 
 <p>ğŸ—£ï¸Â <strong>äº’åŠ¨ä¸æ”¯æŒï¼š</strong><span style="color:#1a439c;">ğŸ’¬<strong>è¯„è®ºÂ </strong>Â  Â  Â ğŸ‘ğŸ»<strong>ç‚¹èµÂ </strong>Â  Â  Â ğŸ“‚<strong>æ”¶è—Â </strong>Â  Â  ğŸ‘€<strong>å…³æ³¨+</strong></span></p> 
 <p><span style="color:#1a439c;"><strong>å¦‚æœæ–‡ç« æœ‰æ‰€å¸®åŠ©ï¼Œæ¬¢è¿ç•™ä¸‹æ‚¨å®è´µçš„è¯„è®ºï¼Œç‚¹èµåŠ æ”¶è—æ”¯æŒæˆ‘ï¼Œç‚¹å‡»å…³æ³¨ï¼Œä¸€èµ·è¿›æ­¥ï¼</strong></span></p> 
</blockquote> 
<hr> 
<p id="main-toc"><strong>ç›®å½•</strong></p> 
<p id="%E5%89%8D%E8%A8%80%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%C2%A0-toc" style="margin-left:0px;"><a href="#%E5%89%8D%E8%A8%80%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%C2%A0" rel="nofollow">å‰è¨€Â  Â  Â  Â Â </a></p> 
<p id="%E6%AD%A3%E6%96%87-toc" style="margin-left:0px;"><a href="#%E6%AD%A3%E6%96%87" rel="nofollow">æ­£æ–‡</a></p> 
<p id="01-%E5%9F%BA%E4%BA%8E%E5%87%9D%E8%81%9A%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95%E7%9A%84%E4%BA%8C%E7%BB%B4%E6%95%B0%E5%AD%97%E5%B5%8C%E5%85%A5%E4%B8%8A%E7%9A%84%E5%90%84%E7%A7%8D%E5%87%9D%E8%81%9A%E8%81%9A%E7%B1%BB%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%C2%A0-toc" style="margin-left:40px;"><a href="#01-%E5%9F%BA%E4%BA%8E%E5%87%9D%E8%81%9A%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95%E7%9A%84%E4%BA%8C%E7%BB%B4%E6%95%B0%E5%AD%97%E5%B5%8C%E5%85%A5%E4%B8%8A%E7%9A%84%E5%90%84%E7%A7%8D%E5%87%9D%E8%81%9A%E8%81%9A%E7%B1%BB%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%C2%A0" rel="nofollow">01-åŸºäºå‡èšèšç±»ç®—æ³•çš„äºŒç»´æ•°å­—åµŒå…¥ä¸Šçš„å„ç§å‡èšèšç±»Â  Â  Â  Â Â </a></p> 
<p id="02-%E5%9F%BA%E4%BA%8EK-means%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95%E5%AF%B9%E9%B8%A2%E5%B0%BE%E8%8A%B1%E6%95%B0%E6%8D%AE%E9%9B%86%E8%BF%9B%E8%A1%8C%E8%81%9A%E7%B1%BB%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%C2%A0-toc" style="margin-left:40px;"><a href="#02-%E5%9F%BA%E4%BA%8EK-means%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95%E5%AF%B9%E9%B8%A2%E5%B0%BE%E8%8A%B1%E6%95%B0%E6%8D%AE%E9%9B%86%E8%BF%9B%E8%A1%8C%E8%81%9A%E7%B1%BB%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%C2%A0" rel="nofollow">02-åŸºäºK-meansèšç±»ç®—æ³•å¯¹é¸¢å°¾èŠ±æ•°æ®é›†è¿›è¡Œèšç±»Â  Â  Â  Â Â </a></p> 
<p id="03-%E5%9F%BA%E4%BA%8E%E5%85%89%E8%B0%B1%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95%E5%9C%A8%E5%9B%BE%E5%83%8F%E5%88%86%E5%89%B2%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%C2%A0-toc" style="margin-left:40px;"><a href="#03-%E5%9F%BA%E4%BA%8E%E5%85%89%E8%B0%B1%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95%E5%9C%A8%E5%9B%BE%E5%83%8F%E5%88%86%E5%89%B2%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%C2%A0" rel="nofollow">03-åŸºäºå…‰è°±èšç±»ç®—æ³•åœ¨å›¾åƒåˆ†å‰²ä¸­çš„åº”ç”¨å®ä¾‹Â  Â  Â  Â Â </a></p> 
<p id="%C2%A004-%E5%9F%BA%E4%BA%8E%E7%A1%AC%E5%B8%81%E5%9B%BE%E5%83%8F%E7%9A%84%E7%BB%93%E6%9E%84%E5%8C%96%E5%8C%BA%E5%9F%9F%E5%88%86%E5%B1%82%E8%81%9A%E7%B1%BB%E6%BC%94%E7%A4%BA%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%C2%A0-toc" style="margin-left:40px;"><a href="#%C2%A004-%E5%9F%BA%E4%BA%8E%E7%A1%AC%E5%B8%81%E5%9B%BE%E5%83%8F%E7%9A%84%E7%BB%93%E6%9E%84%E5%8C%96%E5%8C%BA%E5%9F%9F%E5%88%86%E5%B1%82%E8%81%9A%E7%B1%BB%E6%BC%94%E7%A4%BA%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%C2%A0" rel="nofollow">Â 04-åŸºäºç¡¬å¸å›¾åƒçš„ç»“æ„åŒ–åŒºåŸŸåˆ†å±‚èšç±»æ¼”ç¤ºÂ  Â  Â  Â Â </a></p> 
<hr id="hr-toc"> 
<h2><strong>å‰è¨€Â  Â  Â  Â Â </strong></h2> 
<p><strong>Â  Â  Â  Â  </strong>åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œèšç±»ç®—æ³•æ˜¯ä¸€ç±»é‡è¦çš„æ— ç›‘ç£å­¦ä¹ æ–¹æ³•ï¼Œç”¨äºå°†æ•°æ®é›†ä¸­çš„æ ·æœ¬åˆ†æˆå…·æœ‰ç›¸ä¼¼ç‰¹å¾çš„ç»„æˆ–ç°‡ã€‚<strong>æœ¬ç¯‡åšå®¢å°†æ·±å…¥æ¢è®¨å››ç§å¸¸ç”¨çš„èšç±»ç®—æ³•ï¼šk-å‡å€¼èšç±»ã€åˆ†å±‚èšç±»ç®—æ³•ã€å‡èšèšç±»å’Œè°±èšç±»ã€‚</strong>é€šè¿‡è¯¦ç»†çš„ä»£ç ç¤ºä¾‹å’Œå¯è§†åŒ–åˆ†æï¼Œæˆ‘ä»¬å°†ç†è§£æ¯ç§ç®—æ³•çš„åŸç†ã€ä¼˜ç¼ºç‚¹ä»¥åŠé€‚ç”¨åœºæ™¯ã€‚é€šè¿‡æœ¬æ–‡çš„é˜…è¯»ï¼Œè¯»è€…å°†èƒ½å¤Ÿæ›´å¥½åœ°é€‰æ‹©å¹¶ç†è§£å¦‚ä½•åº”ç”¨é€‚åˆè‡ªå·±æ•°æ®é›†çš„èšç±»ç®—æ³•ï¼Œä»è€Œæ›´æœ‰æ•ˆåœ°è¿›è¡Œæ•°æ®åˆ†æå’ŒæŒ–æ˜ã€‚</p> 
<h2 id="%E6%AD%A3%E6%96%87"><strong>æ­£æ–‡</strong></h2> 
<h3 id="01-%E5%9F%BA%E4%BA%8E%E5%87%9D%E8%81%9A%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95%E7%9A%84%E4%BA%8C%E7%BB%B4%E6%95%B0%E5%AD%97%E5%B5%8C%E5%85%A5%E4%B8%8A%E7%9A%84%E5%90%84%E7%A7%8D%E5%87%9D%E8%81%9A%E8%81%9A%E7%B1%BB%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%C2%A0"><strong>01-åŸºäº</strong>å‡èšèšç±»ç®—æ³•çš„äºŒç»´æ•°å­—åµŒå…¥ä¸Šçš„å„ç§å‡èšèšç±»<strong>Â  Â  Â  Â Â </strong></h3> 
<p><strong>Â Â Â Â Â Â Â Â </strong>è¿™ä¸ªä¾‹å­å‘æˆ‘ä»¬å±•ç¤ºçš„æ˜¯èšé›†æ€§èšç±»çš„â€œrich getting richerâ€çš„è¡Œä¸ºï¼Œè¿™ç§è¡Œä¸ºå¾€å¾€ä¼šé€ æˆä¸å‡åŒ€çš„èšç±»å¤§å°ã€‚è¿™ç§è¡Œä¸ºå¯¹äºå¹³å‡é“¾æ¥ç­–ç•¥æ¥è¯´æ˜¯éå¸¸æ˜æ˜¾çš„ï¼Œå®ƒæœ€ç»ˆäº§ç”Ÿäº†å‡ ä¸ªå•ç‚¹ç°‡ï¼Œè€Œåœ¨å•ä¸ªé“¾æ¥ä¸­ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªå•ä¸€çš„ä¸­å¿ƒç°‡ï¼Œæ‰€æœ‰å…¶ä»–çš„ç°‡éƒ½æ˜¯ä»è¾¹ç¼˜çš„å™ªå£°ç‚¹ä¸­æå–å‡ºæ¥çš„ã€‚</p> 
<p>Â Â Â Â Â Â Â Â ä¸‹é¢æ˜¯å…·ä½“ä»£ç ï¼šè¿™æ®µä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨å±‚æ¬¡èšç±»ï¼ˆHierarchical Clusteringï¼‰æ–¹æ³•å¯¹æ‰‹å†™æ•°å­—æ•°æ®é›†ï¼ˆdigits datasetï¼‰è¿›è¡Œèšç±»ï¼Œå¹¶å°†ä¸åŒé“¾æ¥æ–¹å¼ï¼ˆlinkage methodsï¼‰çš„èšç±»ç»“æœå¯è§†åŒ–ã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â Â å¯¼å…¥å¿…è¦çš„åº“</strong>ï¼š<code>time</code>ï¼šç”¨äºè®¡ç®—ä»£ç è¿è¡Œæ—¶é—´ã€‚<code>numpy</code>ï¼šç”¨äºæ•°å€¼è®¡ç®—ã€‚<code>scipy.ndimage</code>ï¼šç”¨äºå›¾åƒå¤„ç†ã€‚<code>matplotlib.pyplot</code>ï¼šç”¨äºç»˜å›¾ã€‚<code>sklearn.manifold</code>ï¼šç”¨äºé™ç»´ã€‚<code>sklearn.datasets</code>ï¼šç”¨äºåŠ è½½æ•°æ®é›†ã€‚<code>sklearn.cluster.AgglomerativeClustering</code>ï¼šç”¨äºè¿›è¡Œå±‚æ¬¡èšç±»ã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â Â åŠ è½½æ•°æ®é›†</strong>ï¼šä½¿ç”¨<code>datasets.load_digits()</code>åŠ è½½æ‰‹å†™æ•°å­—æ•°æ®é›†ï¼Œè¿”å›ç‰¹å¾çŸ©é˜µ<code>X</code>å’Œæ ‡ç­¾<code>y</code>ã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â Â å®šä¹‰<code>nudge_images</code>å‡½æ•°</strong>ï¼šè¯¥å‡½æ•°ç”¨äºå¾®è°ƒå›¾åƒï¼Œä»¥å¢åŠ æ•°æ®é›†çš„å¤šæ ·æ€§ã€‚å¯¹æ¯å¼ å›¾åƒè¿›è¡Œå¾®å°çš„å¹³ç§»æ“ä½œã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â Â å®šä¹‰<code>plot_clustering</code>å‡½æ•°</strong>ï¼šç”¨äºç»˜åˆ¶èšç±»ç»“æœçš„æ•£ç‚¹å›¾ã€‚å°†é™ç»´åçš„æ•°æ®<code>X_red</code>æ˜ å°„åˆ°äºŒç»´ç©ºé—´ï¼Œå¹¶æ ¹æ®èšç±»æ ‡ç­¾<code>labels</code>ç»™ä¸åŒç±»åˆ«çš„ç‚¹ä¸Šè‰²ã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â Â é™ç»´</strong>ï¼šä½¿ç”¨<code>manifold.SpectralEmbedding</code>å¯¹æ•°æ®è¿›è¡Œé™ç»´ï¼Œå‡å°‘ç‰¹å¾ç»´åº¦åˆ°2ç»´ï¼Œä»¥ä¾¿å¯è§†åŒ–ã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â Â å¾ªç¯éå†ä¸åŒçš„é“¾æ¥æ–¹å¼</strong>ï¼šå¯¹äºæ¯ä¸€ç§é“¾æ¥æ–¹å¼ï¼ˆwardã€averageã€completeã€singleï¼‰ï¼šå°†å›¾åƒä¿å­˜ä¸º<code>.png</code>æ–‡ä»¶ã€‚Â  è°ƒç”¨<code>plot_clustering</code>å‡½æ•°ç»˜åˆ¶èšç±»ç»“æœçš„æ•£ç‚¹å›¾ã€‚è®°å½•èšç±»è¿è¡Œæ—¶é—´ã€‚ä½¿ç”¨<code>AgglomerativeClustering</code>è¿›è¡Œå±‚æ¬¡èšç±»ï¼ŒæŒ‡å®šèšç±»æ•°é‡ä¸º10ã€‚</p> 
<pre><code class="language-python">from time import time
import numpy as np
from scipy import ndimage
from matplotlib import pyplot as plt
from sklearn import manifold, datasets
from sklearn.cluster import AgglomerativeClustering

X, y = datasets.load_digits(return_X_y=True)
n_samples, n_features = X.shape
np.random.seed(0)

def nudge_images(X, y):
    shift = lambda x: ndimage.shift(x.reshape((8, 8)),
                                  .3 * np.random.normal(size=2),
                                  mode='constant').ravel()
    X = np.concatenate([X, np.apply_along_axis(shift, 1, X)])
    Y = np.concatenate([y, y], axis=0)
    return X, Y

X, y = nudge_images(X, y)

def plot_clustering(X_red, labels, title=None):
    x_min, x_max = np.min(X_red, axis=0), np.max(X_red, axis=0)
    X_red = (X_red - x_min) / (x_max - x_min)
    plt.figure(figsize=(6, 4))
    for i in range(X_red.shape[0]):
        plt.text(X_red[i, 0], X_red[i, 1], str(y[i]),
                 color=plt.cm.nipy_spectral(labels[i] / 10.),
                 fontdict={'weight': 'bold', 'size': 9})
    plt.xticks([])
    plt.yticks([])
    if title is not None:
        plt.title(title, size=17)
    plt.axis('off')
    plt.tight_layout(rect=[0, 0.03, 1, 0.95])

print("Computing embedding")
X_red = manifold.SpectralEmbedding(n_components=2).fit_transform(X)
print("Done.")

for linkage in ('ward', 'average', 'complete', 'single'):
    clustering = AgglomerativeClustering(linkage=linkage, n_clusters=10)
    t0 = time()
    clustering.fit(X_red)
    print("%s :\t%.2fs" % (linkage, time() - t0))
    plot_clustering(X_red, clustering.labels_, "%s linkage" % linkage)
    plt.savefig("../%s.png" % linkage, dpi=500)
    plt.show()</code></pre> 
<p>Â Â Â Â Â Â Â Â å®ä¾‹è¿è¡Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p> 
<p>Â Â Â Â Â Â Â Â æ¯å¼ å›¾åƒå±•ç¤ºäº†æ‰‹å†™æ•°å­—æ•°æ®é›†çš„èšç±»ç»“æœï¼Œé¢œè‰²ä»£è¡¨ä¸åŒçš„èšç±»ç°‡ã€‚</p> 
<p>Â Â Â Â Â Â Â Â æ¨ªåæ ‡å’Œçºµåæ ‡ä»£è¡¨é™ç»´åçš„ç‰¹å¾ç©ºé—´ï¼Œç‚¹çš„ä½ç½®è¡¨ç¤ºæ ·æœ¬åœ¨è¿™ä¸ªç‰¹å¾ç©ºé—´çš„æŠ•å½±ã€‚</p> 
<p>Â Â Â Â Â Â Â Â æ¯ä¸ªç‚¹çš„æ ‡ç­¾æ˜¯å¯¹åº”æ ·æœ¬çš„çœŸå®æ•°å­—æ ‡ç­¾ï¼Œä»¥å¸®åŠ©ç†è§£èšç±»æ•ˆæœã€‚</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/48/d5/Rj39icop_o.png" width="1200"></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/83/35/07MfpxNh_o.png" width="1200"></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/2f/47/Jbx08fSE_o.png" width="1200"></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/e5/a0/tneHlVWI_o.png" width="1200"></p> 
<h3 id="02-%E5%9F%BA%E4%BA%8EK-means%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95%E5%AF%B9%E9%B8%A2%E5%B0%BE%E8%8A%B1%E6%95%B0%E6%8D%AE%E9%9B%86%E8%BF%9B%E8%A1%8C%E8%81%9A%E7%B1%BB%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%C2%A0"><strong>02-åŸºäº</strong>K-meansèšç±»ç®—æ³•å¯¹é¸¢å°¾èŠ±æ•°æ®é›†è¿›è¡Œèšç±»<strong>Â  Â  Â  Â Â </strong></h3> 
<p>Â Â Â Â Â Â Â Â å›¾ä¸­é¦–å…ˆæ˜¾ç¤ºäº†ä½¿ç”¨ä¸€ä¸ªK-meansç®—æ³•äº§ç”Ÿä¸‰ä¸ªèšç±»ä¼šæ˜¯ä»€ä¹ˆæ ·çš„ç»“æœã€‚ç„¶åæ˜¾ç¤ºé”™è¯¯åˆå§‹åŒ–å¯¹åˆ†ç±»è¿‡ç¨‹çš„å½±å“ã€‚é€šè¿‡å°†n_initè®¾ç½®ä¸º1(é»˜è®¤å€¼ä¸º10)ï¼Œå¯ä»¥å‡å°‘ç®—æ³•ä½¿ç”¨ä¸åŒçš„è´¨å¿ƒç§å­è¿è¡Œçš„æ¬¡æ•°ã€‚ä¸‹ä¸€å¹…å›¾æ˜¾ç¤ºäº†ä½¿ç”¨å…«ä¸ªèšç±»æ‰€èƒ½æä¾›çš„ä¿¡æ¯ï¼Œå¹¶æœ€ç»ˆå¾—å‡ºäº†åŸºæœ¬äº‹å®ã€‚</p> 
<p>Â Â Â Â Â Â Â Â è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ä½¿ç”¨Kå‡å€¼èšç±»ç®—æ³•å¯¹é¸¢å°¾èŠ±æ•°æ®é›†è¿›è¡Œèšç±»ï¼Œå¹¶é€šè¿‡å¯è§†åŒ–å±•ç¤ºèšç±»ç»“æœã€‚å®ƒå¯ä»¥å¸®åŠ©ç†è§£Kå‡å€¼èšç±»ç®—æ³•å¦‚ä½•å°†æ•°æ®ç‚¹åˆ†æˆä¸åŒçš„èšç±»ï¼Œå¹¶ä¸å®é™…æ•°æ®é›†è¿›è¡Œæ¯”è¾ƒï¼Œä»è€Œè¯„ä¼°èšç±»çš„æ•ˆæœã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â å¯¼å…¥åº“</strong>ï¼š<code>numpy</code>ï¼šç”¨äºæ•°å€¼æ“ä½œã€‚<code>matplotlib.pyplot</code>ï¼šç”¨äºç»˜å›¾ã€‚<code>mpl_toolkits.mplot3d</code>Â ä¸­çš„Â <code>Axes3D</code>ï¼šç”¨äº3DæŠ•å½±ã€‚<code>sklearn.cluster</code>Â ä¸­çš„Â <code>KMeans</code>ï¼šç”¨äºKå‡å€¼èšç±»ã€‚<code>sklearn</code>Â ä¸­çš„Â <code>datasets</code>ï¼šç”¨äºåŠ è½½é¸¢å°¾èŠ±æ•°æ®é›†ã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â è®¾ç½®éšæœºç§å­</strong>ï¼šç¡®ä¿éšæœºæ“ä½œçš„å¯é‡ç°æ€§ã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â åŠ è½½é¸¢å°¾èŠ±æ•°æ®é›†</strong>ï¼šåŠ è½½é¸¢å°¾èŠ±æ•°æ®é›†ã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â å®šä¹‰ä¼°è®¡å™¨</strong>ï¼šå®šä¹‰äº†ä¸‰ä¸ªKå‡å€¼èšç±»ä¼°è®¡å™¨ï¼Œå…·æœ‰ä¸åŒçš„å‚æ•°ï¼š<code>k_means_iris_8</code>ï¼š8ä¸ªèšç±»çš„Kå‡å€¼èšç±»ã€‚<code>k_means_iris_3</code>ï¼š3ä¸ªèšç±»çš„Kå‡å€¼èšç±»ã€‚<code>k_means_iris_bad_init</code>ï¼š3ä¸ªèšç±»çš„Kå‡å€¼èšç±»ï¼Œä½¿ç”¨äº†ç³Ÿç³•çš„åˆå§‹åŒ–ç­–ç•¥ã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â è®¾ç½®å›¾å½¢ç¼–å·å’Œæ ‡é¢˜</strong>ï¼šåˆå§‹åŒ–å˜é‡Â <code>fignum</code>Â å’ŒÂ <code>titles</code>Â ä»¥è·Ÿè¸ªå›¾å½¢å’Œå®ƒä»¬çš„æ ‡é¢˜ã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â ç»˜åˆ¶èšç±»å¹¶ä¿å­˜å›¾åƒ</strong>ï¼šå¯¹äºæ¯ä¸ªä¼°è®¡å™¨ï¼Œåˆ›å»ºä¸€ä¸ª3Dæ•£ç‚¹å›¾ã€‚æ¯ä¸ªæ•°æ®ç‚¹æ ¹æ®å…¶èšç±»åˆ†é…è¿›è¡Œç€è‰²ã€‚å°†ç»˜å›¾ä¿å­˜ä¸ºå›¾åƒã€‚é€’å¢å›¾å½¢ç¼–å·ã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â ç»˜åˆ¶åœ°é¢çœŸç›¸</strong>ï¼šåˆ›å»ºå¦ä¸€ä¸ª3Dæ•£ç‚¹å›¾ä»¥å¯è§†åŒ–åœ°é¢çœŸç›¸ã€‚æ¯ä¸ªç±»åˆ«éƒ½æœ‰æ ‡ç­¾ï¼ˆSetosaï¼ŒVersicolourï¼ŒVirginicaï¼‰ã€‚å°†ç»˜å›¾ä¿å­˜ä¸ºå›¾åƒã€‚</p> 
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D  # Required for 3D projection

from sklearn.cluster import KMeans
from sklearn import datasets

np.random.seed(5)

iris = datasets.load_iris()
X = iris.data
y = iris.target

estimators = [('k_means_iris_8', KMeans(n_clusters=8)),
              ('k_means_iris_3', KMeans(n_clusters=3)),
              ('k_means_iris_bad_init', KMeans(n_clusters=3, n_init=1,
                                               init='random'))]

fignum = 1
titles = ['8 clusters', '3 clusters', '3 clusters, bad initialization']

# Save each figure individually
for name, est in estimators:
    fig = plt.figure(fignum, figsize=(4, 3))
    ax = Axes3D(fig, rect=[0, 0, .95, 1], elev=48, azim=134)
    est.fit(X)
    labels = est.labels_

    ax.scatter(X[:, 3], X[:, 0], X[:, 2],
               c=labels.astype(np.float), edgecolor='k')

    ax.w_xaxis.set_ticklabels([])
    ax.w_yaxis.set_ticklabels([])
    ax.w_zaxis.set_ticklabels([])
    ax.set_xlabel('Petal width')
    ax.set_ylabel('Sepal length')
    ax.set_zlabel('Petal length')
    ax.set_title(titles[fignum - 1])
    ax.dist = 12
    
    plt.savefig("..figure_{}.png".format(fignum), dpi=500)  # Save each figure
    fignum += 1

# Plot the ground truth
fig = plt.figure(fignum, figsize=(4, 3))
ax = Axes3D(fig, rect=[0, 0, .95, 1], elev=48, azim=134)

for name, label in [('Setosa', 0),
                    ('Versicolour', 1),
                    ('Virginica', 2)]:
    ax.text3D(X[y == label, 3].mean(),
              X[y == label, 0].mean(),
              X[y == label, 2].mean() + 2, name,
              horizontalalignment='center',
              bbox=dict(alpha=.2, edgecolor='w', facecolor='w'))
# Reorder the labels to have colors matching the cluster results
y = np.choose(y, [1, 2, 0]).astype(np.float)
ax.scatter(X[:, 3], X[:, 0], X[:, 2], c=y, edgecolor='k')

ax.w_xaxis.set_ticklabels([])
ax.w_yaxis.set_ticklabels([])
ax.w_zaxis.set_ticklabels([])
ax.set_xlabel('Petal width')
ax.set_ylabel('Sepal length')
ax.set_zlabel('Petal length')
ax.set_title('Ground Truth')
ax.dist = 12

plt.savefig("..ground_truth.png", dpi=500)  # Save the ground truth figure

plt.show()</code></pre> 
<p>Â Â Â Â Â Â Â Â å®ä¾‹è¿è¡Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šè¿™äº›å¯è§†åŒ–å¸®åŠ©ç†è§£Kå‡å€¼èšç±»ç®—æ³•å¦‚ä½•å°†é¸¢å°¾èŠ±æ•°æ®é›†åˆ†æˆä¸åŒçš„èšç±»ï¼Œå¹¶å°†å…¶ä¸å®é™…åœ°é¢çœŸç›¸è¿›è¡Œæ¯”è¾ƒã€‚Â </p> 
<p><strong>Â Â Â Â Â Â Â Â 8ä¸ªèšç±»</strong>ï¼šå±•ç¤ºäº†ä½¿ç”¨Kå‡å€¼èšç±»ç®—æ³•å°†æ•°æ®ç‚¹åˆ’åˆ†ä¸º8ä¸ªèšç±»ã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â 3ä¸ªèšç±»ï¼ˆè‰¯å¥½åˆå§‹åŒ–ï¼‰</strong>ï¼šç”¨Kå‡å€¼èšç±»ç®—æ³•å°†æ•°æ®ç‚¹åˆ†ç»„ä¸º3ä¸ªèšç±»ã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â 3ä¸ªèšç±»ï¼ˆç³Ÿç³•åˆå§‹åŒ–ï¼‰</strong>ï¼šä½¿ç”¨ç³Ÿç³•çš„åˆå§‹åŒ–ç­–ç•¥ï¼Œå°†æ•°æ®ç‚¹èšç±»ä¸º3ä¸ªèšç±»ã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â åœ°é¢çœŸç›¸</strong>ï¼šè¡¨ç¤ºé¸¢å°¾èŠ±æ•°æ®é›†çš„å®é™…åˆ†å¸ƒï¼Œå…¶ä¸­æ¯ä¸ªç±»åˆ«ï¼ˆSetosaï¼ŒVersicolourï¼ŒVirginicaï¼‰ä»¥ä¸åŒçš„é¢œè‰²æ˜¾ç¤ºã€‚</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/ba/94/BaguQXdG_o.png" width="1200"></p> 
<p>Â <img alt="" height="1200" src="https://images2.imgbox.com/79/e9/xarjhumH_o.png" width="1200"></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/bb/84/XSYnxcGC_o.png" width="1200"></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/f0/db/86lJuCAq_o.png" width="1200"></p> 
<h3 id="03-%E5%9F%BA%E4%BA%8E%E5%85%89%E8%B0%B1%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95%E5%9C%A8%E5%9B%BE%E5%83%8F%E5%88%86%E5%89%B2%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%C2%A0"><strong>03-åŸºäº</strong>å…‰è°±èšç±»ç®—æ³•åœ¨å›¾åƒåˆ†å‰²ä¸­çš„åº”ç”¨å®ä¾‹<strong>Â  Â  Â  Â Â </strong></h3> 
<p>Â  Â  Â  Â  ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨å¯¹è±¡çš„æ©ç å°†å›¾å½¢é™åˆ¶åœ¨å¯¹è±¡çš„è½®å»“ä¸Šã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬æ„Ÿå…´è¶£çš„æ˜¯å°†å¯¹è±¡ä»ä¸€ä¸ªå¯¹è±¡å’Œå¦ä¸€ä¸ªå¯¹è±¡ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œè€Œä¸æ˜¯ä»èƒŒæ™¯ä¸­åˆ†ç¦»å‡ºæ¥ã€‚è¿™æ®µä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨è°±èšç±»ï¼ˆspectral clusteringï¼‰ç®—æ³•å¯¹äººå·¥ç”Ÿæˆçš„å›¾åƒè¿›è¡Œåˆ†å‰²ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p> 
<p><strong>Â Â Â Â Â Â Â Â ç”Ÿæˆå›¾åƒ</strong>ï¼šé¦–å…ˆç”Ÿæˆä¸€ä¸ª100x100çš„äºŒç»´æ•°ç»„ï¼Œè¡¨ç¤ºä¸€ä¸ªå›¾åƒã€‚åœ¨å›¾åƒä¸­å¿ƒç”Ÿæˆäº†4ä¸ªåœ†å½¢åŒºåŸŸï¼Œæ¨¡æ‹Ÿäº†ä¸åŒçš„ç‰©ä½“æˆ–åŒºåŸŸã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â åˆ›å»ºæ©æ¨¡</strong>ï¼šå°†ç”Ÿæˆçš„å›¾åƒè½¬æ¢ä¸ºå¸ƒå°”å‹æ©æ¨¡ï¼Œä»¥é™åˆ¶è°±èšç±»ç®—æ³•åªåœ¨æ„Ÿå…´è¶£çš„å‰æ™¯åŒºåŸŸå†…è¿›è¡Œåˆ†å‰²ï¼Œè€Œä¸å…³å¿ƒèƒŒæ™¯ã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â æ·»åŠ å™ªå£°</strong>ï¼šä¸ºäº†ä½¿é—®é¢˜æ›´è´´è¿‘å®é™…ï¼Œç»™å›¾åƒæ·»åŠ äº†ä¸€äº›éšæœºå™ªå£°ã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â æ„å»ºå›¾</strong>ï¼šå°†å›¾åƒè½¬æ¢ä¸ºå›¾å½¢ç»“æ„ï¼Œå…¶ä¸­æ¯ä¸ªåƒç´ ä½œä¸ºå›¾çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç›¸é‚»åƒç´ ä¹‹é—´çš„è¿æ¥è¡¨ç¤ºå›¾çš„è¾¹ã€‚è¿æ¥çš„æƒé‡ç”±åƒç´ ä¹‹é—´çš„æ¢¯åº¦å€¼å†³å®šã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â è°±èšç±»</strong>ï¼šå¯¹æ„å»ºçš„å›¾åº”ç”¨è°±èšç±»ç®—æ³•ï¼Œå°†å›¾åƒåˆ†æˆæŒ‡å®šæ•°é‡çš„èšç±»ã€‚è¿™é‡Œåˆ†åˆ«å°è¯•äº†å°†å›¾åƒåˆ†æˆ4ä¸ªå’Œ2ä¸ªèšç±»ã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â å¯è§†åŒ–</strong>ï¼šä½¿ç”¨<code>matplotlib</code>åº“å°†åŸå§‹å›¾åƒå’Œåˆ†å‰²åçš„å›¾åƒè¿›è¡Œå¯è§†åŒ–ï¼Œå…¶ä¸­åˆ†å‰²åçš„å›¾åƒä¸­ä¸åŒçš„é¢œè‰²ä»£è¡¨ä¸åŒçš„èšç±»ã€‚</p> 
<p>Â Â Â Â Â Â Â Â è¿™æ®µä»£ç å±•ç¤ºäº†è°±èšç±»ç®—æ³•åœ¨å›¾åƒåˆ†å‰²ä¸­çš„åº”ç”¨ï¼Œé€šè¿‡è°±èšç±»ï¼Œå¯ä»¥æœ‰æ•ˆåœ°å°†å›¾åƒåˆ†å‰²æˆä¸åŒçš„åŒºåŸŸæˆ–å¯¹è±¡ã€‚</p> 
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

from sklearn.feature_extraction import image
from sklearn.cluster import spectral_clustering

l = 100
x, y = np.indices((l, l))

center1 = (28, 24)
center2 = (40, 50)
center3 = (67, 58)
center4 = (24, 70)

radius1, radius2, radius3, radius4 = 16, 14, 15, 14

circle1 = (x - center1[0]) ** 2 + (y - center1[1]) ** 2 &lt; radius1 ** 2
circle2 = (x - center2[0]) ** 2 + (y - center2[1]) ** 2 &lt; radius2 ** 2
circle3 = (x - center3[0]) ** 2 + (y - center3[1]) ** 2 &lt; radius3 ** 2
circle4 = (x - center4[0]) ** 2 + (y - center4[1]) ** 2 &lt; radius4 ** 2

# #############################################################################
# 4 circles
img = circle1 + circle2 + circle3 + circle4

mask = img.astype(bool)

img = img.astype(float)
img += 1 + 0.2 * np.random.randn(*img.shape)

graph = image.img_to_graph(img, mask=mask)

graph.data = np.exp(-graph.data / graph.data.std())

labels = spectral_clustering(graph, n_clusters=4, eigen_solver='arpack')
label_im = np.full(mask.shape, -1.)
label_im[mask] = labels

plt.matshow(img)
plt.matshow(label_im)
plt.savefig("/segmentation_4.png", dpi=500)  # Save the first segmentation figure
plt.show()

# #############################################################################
# 2 circles
img = circle1 + circle2
mask = img.astype(bool)
img = img.astype(float)

img += 1 + 0.2 * np.random.randn(*img.shape)

graph = image.img_to_graph(img, mask=mask)
graph.data = np.exp(-graph.data / graph.data.std())

labels = spectral_clustering(graph, n_clusters=2, eigen_solver='arpack')
label_im = np.full(mask.shape, -1.)
label_im[mask] = labels

plt.matshow(img)
plt.matshow(label_im)
plt.savefig("/segmentation_2.png", dpi=500)  # Save the second segmentation figure
plt.show()</code></pre> 
<p>Â Â Â Â Â Â Â Â å®ä¾‹è¿è¡Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šè¿™æ®µä»£ç ç”Ÿæˆäº†ä¸€ä¸ªäººå·¥å›¾åƒï¼Œå…¶ä¸­åŒ…å«äº†å››ä¸ªåœ†å½¢åŒºåŸŸï¼Œæ¯ä¸ªåœ†å½¢åŒºåŸŸå…·æœ‰ä¸åŒçš„ä¸­å¿ƒç‚¹å’ŒåŠå¾„ã€‚ä»¥ä¸‹æ˜¯å¯¹ç”Ÿæˆçš„å›¾åƒçš„è§£é‡Šï¼š</p> 
<p><strong>Â Â Â Â Â Â Â Â å››ä¸ªåœ†å½¢åŒºåŸŸ</strong>ï¼šç¬¬ä¸€ä¸ªåœ†ï¼šä¸­å¿ƒç‚¹ä¸º (28, 24)ï¼ŒåŠå¾„ä¸º 16ã€‚ç¬¬äºŒä¸ªåœ†ï¼šä¸­å¿ƒç‚¹ä¸º (40, 50)ï¼ŒåŠå¾„ä¸º 14ã€‚ç¬¬ä¸‰ä¸ªåœ†ï¼šä¸­å¿ƒç‚¹ä¸º (67, 58)ï¼ŒåŠå¾„ä¸º 15ã€‚ç¬¬å››ä¸ªåœ†ï¼šä¸­å¿ƒç‚¹ä¸º (24, 70)ï¼ŒåŠå¾„ä¸º 14ã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â å›¾åƒè¡¨ç¤º</strong>ï¼šå›¾åƒå¤§å°ä¸º 100x100 åƒç´ ã€‚æ¯ä¸ªåƒç´ é€šè¿‡å…¶ä¸åœ†å¿ƒçš„è·ç¦»æ¥ç¡®å®šæ˜¯å¦å±äºåœ†å½¢åŒºåŸŸã€‚æ¯ä¸ªåƒç´ è¢«åˆ†é…ä¸€ä¸ªå€¼ï¼Œè¡¨ç¤ºå…¶æ˜¯å¦å±äºä¸€ä¸ªæˆ–å¤šä¸ªåœ†å½¢åŒºåŸŸã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â å™ªå£°æ·»åŠ </strong>ï¼šå¯¹å›¾åƒè¿›è¡Œäº†ä¸€å®šç¨‹åº¦çš„å™ªå£°æ·»åŠ ï¼Œä½¿å¾—å›¾åƒä¸æ˜¯å®Œç¾çš„å‡ ä½•å½¢çŠ¶ã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â æ©æ¨¡</strong>ï¼šå›¾åƒè½¬æ¢ä¸ºæ©æ¨¡ï¼Œä»¥é™åˆ¶èšç±»ç®—æ³•åªåœ¨æ„Ÿå…´è¶£çš„å‰æ™¯åŒºåŸŸè¿›è¡Œåˆ†å‰²ã€‚</p> 
<p>Â Â Â Â Â Â Â Â è¿™ä¸ªç”Ÿæˆçš„å›¾åƒç”¨äºæ¨¡æ‹Ÿå…·æœ‰ä¸åŒå½¢çŠ¶å’Œå¤§å°çš„ç‰©ä½“æˆ–åŒºåŸŸï¼Œå¹¶ä½œä¸ºè°±èšç±»ç®—æ³•çš„è¾“å…¥ï¼Œä»¥å±•ç¤ºç®—æ³•å¯¹ä¸åŒåŒºåŸŸè¿›è¡Œåˆ†å‰²çš„æ•ˆæœã€‚</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/7f/09/k2Dxkqy1_o.png" width="1200"></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/ba/76/Kjal9haW_o.png" width="1200"></p> 
<h3 id="%C2%A004-%E5%9F%BA%E4%BA%8E%E7%A1%AC%E5%B8%81%E5%9B%BE%E5%83%8F%E7%9A%84%E7%BB%93%E6%9E%84%E5%8C%96%E5%8C%BA%E5%9F%9F%E5%88%86%E5%B1%82%E8%81%9A%E7%B1%BB%E6%BC%94%E7%A4%BA%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%C2%A0">Â <strong>04-</strong>åŸºäºç¡¬å¸å›¾åƒçš„ç»“æ„åŒ–åŒºåŸŸåˆ†å±‚èšç±»æ¼”ç¤º<strong>Â  Â  Â  Â Â </strong></h3> 
<p>Â  Â  Â  Â  ä¸‹é¢ç»™å‡ºä»£ç åŸºäºåŒºåŸŸå±‚æ¬¡èšç±»çš„äºŒç»´å›¾åƒåˆ†å‰²è®¡ç®—ã€‚èšç±»åœ¨ç©ºé—´ä¸Šå—åˆ°çº¦æŸï¼Œä»¥ä½¿æ¯ä¸ªåˆ†å‰²åŒºåŸŸæˆä¸ºä¸€ä½“ã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â æ•°æ®ç”Ÿæˆå’Œé¢„å¤„ç†</strong>ï¼šåŸå§‹ç¡¬å¸å›¾åƒè¢«ç¼©å°åˆ°åŸå§‹å¤§å°çš„20%ï¼Œä»¥åŠ å¿«å¤„ç†é€Ÿåº¦ã€‚åº”ç”¨é«˜æ–¯æ»¤æ³¢å™¨å¯¹å›¾åƒè¿›è¡Œå¹³æ»‘å¤„ç†ï¼Œå‡å°‘ç¼©å°æ—¶çš„é”¯é½¿çŠ¶ä¼ªå½±ã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â æ•°æ®è½¬æ¢</strong>ï¼šå°†å¤„ç†åçš„å›¾åƒè½¬æ¢ä¸ºä¸€ç»´æ•°ç»„ï¼ˆXï¼‰ï¼Œä»¥ä¾¿è¿›è¡Œåç»­èšç±»æ“ä½œã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â å®šä¹‰æ•°æ®ç»“æ„</strong>ï¼šåˆ©ç”¨<code>grid_to_graph</code>å‡½æ•°å®šä¹‰æ•°æ®çš„ç»“æ„ï¼Œå³åƒç´ ä¸å…¶é‚»åŸŸåƒç´ çš„è¿æ¥å…³ç³»ã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â æ‰§è¡Œèšç±»</strong>ï¼šåˆ©ç”¨å‡èšå¼èšç±»ç®—æ³•ï¼ˆAgglomerative Clusteringï¼‰ï¼Œå°†åƒç´ åˆ†æˆ27ä¸ªåŒºåŸŸï¼ˆn_clusters = 27ï¼‰ã€‚é‡‡ç”¨wardé“¾æ¥æ–¹å¼è¿›è¡Œèšç±»ï¼Œå¹¶åˆ©ç”¨å®šä¹‰çš„æ•°æ®ç»“æ„ï¼ˆconnectivityï¼‰çº¦æŸèšç±»è¿‡ç¨‹ã€‚</p> 
<p><strong>Â Â Â Â Â Â Â Â ç»˜åˆ¶ç»“æœ</strong>ï¼šåœ¨ä¸€ä¸ªæ–°çš„å›¾åƒä¸Šæ˜¾ç¤ºå¤„ç†åçš„ç¡¬å¸å›¾åƒï¼Œå¹¶ç”¨ä¸åŒçš„é¢œè‰²è½®å»“æ ‡è¯†å‡ºä¸åŒåŒºåŸŸçš„èšç±»ç»“æœã€‚</p> 
<p>Â Â Â Â Â Â Â Â ä»£ç é¦–å…ˆå°†åŸå§‹ç¡¬å¸å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼Œç„¶åå°†å…¶è½¬æ¢ä¸ºä¸€ç»´æ•°ç»„ä»¥è¿›è¡Œèšç±»ã€‚</p> 
<p>Â Â Â Â Â Â Â Â æ¥ç€å®šä¹‰äº†æ•°æ®ç»“æ„ä»¥ç¡®ä¿èšç±»åœ¨åƒç´ ä¹‹é—´çš„è¿é€šæ€§ã€‚</p> 
<p>Â Â Â Â Â Â Â Â èšç±»è¿‡ç¨‹é‡‡ç”¨å‡èšå¼èšç±»ï¼Œé€šè¿‡wardé“¾æ¥æ–¹å¼å’Œæ•°æ®ç»“æ„è¿›è¡Œçº¦æŸã€‚</p> 
<p>Â Â Â Â Â Â Â Â æœ€åï¼Œä»£ç ç»˜åˆ¶äº†å¤„ç†åçš„å›¾åƒï¼Œå¹¶ç”¨ä¸åŒé¢œè‰²çš„è½®å»“æ˜¾ç¤ºå‡ºèšç±»çš„åŒºåŸŸã€‚</p> 
<pre><code class="language-python">import time as time

import numpy as np
from distutils.version import LooseVersion
from scipy.ndimage.filters import gaussian_filter

import matplotlib.pyplot as plt

import skimage
from skimage.data import coins
from skimage.transform import rescale

from sklearn.feature_extraction.image import grid_to_graph
from sklearn.cluster import AgglomerativeClustering

# these were introduced in skimage-0.14
if LooseVersion(skimage.__version__) &gt;= '0.14':
    rescale_params = {'anti_aliasing': False, 'multichannel': False}
else:
    rescale_params = {}

# #############################################################################
# Generate data
orig_coins = coins()

# Resize it to 20% of the original size to speed up the processing
# Applying a Gaussian filter for smoothing prior to down-scaling
# reduces aliasing artifacts.
smoothened_coins = gaussian_filter(orig_coins, sigma=2)
rescaled_coins = rescale(smoothened_coins, 0.2, mode="reflect",
                         **rescale_params)

X = np.reshape(rescaled_coins, (-1, 1))

# #############################################################################
# Define the structure A of the data. Pixels connected to their neighbors.
connectivity = grid_to_graph(*rescaled_coins.shape)

# #############################################################################
# Compute clustering
print("Compute structured hierarchical clustering...")
st = time.time()
n_clusters = 27  # number of regions
ward = AgglomerativeClustering(n_clusters=n_clusters, linkage='ward',
                               connectivity=connectivity)
ward.fit(X)
label = np.reshape(ward.labels_, rescaled_coins.shape)
print("Elapsed time: ", time.time() - st)
print("Number of pixels: ", label.size)
print("Number of clusters: ", np.unique(label).size)

# #############################################################################
# Plot the results on an image
plt.figure(figsize=(5, 5))
plt.imshow(rescaled_coins, cmap=plt.cm.gray)
for l in range(n_clusters):
    plt.contour(label == l,
                colors=[plt.cm.nipy_spectral(l / float(n_clusters)), ])
plt.xticks(())
plt.yticks(())
plt.savefig("/2.png", dpi=500)
plt.show()</code></pre> 
<p>Â Â Â Â Â Â Â Â å®ä¾‹è¿è¡Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šè¿™æ®µä»£ç å¯¹ç¡¬å¸å›¾åƒè¿›è¡Œäº†èšç±»åˆ†å‰²ï¼Œå°†å›¾åƒåˆ†æˆäº†27ä¸ªä¸åŒçš„åŒºåŸŸã€‚æ¯ä¸ªåŒºåŸŸä»£è¡¨å›¾åƒä¸­ç›¸ä¼¼çš„åƒç´ é›†åˆï¼Œè¿™äº›åƒç´ åœ¨è§†è§‰ä¸Šå…·æœ‰ç›¸ä¼¼çš„ç‰¹å¾ã€‚èšç±»è¿‡ç¨‹åˆ©ç”¨äº†ç¡¬å¸å›¾åƒçš„åƒç´ ä¹‹é—´çš„è¿é€šæ€§ï¼Œç¡®ä¿äº†ç›¸é‚»åƒç´ åœ¨åŒä¸€åŒºåŸŸä¸­ã€‚æœ€åï¼Œé€šè¿‡åœ¨å›¾åƒä¸Šç»˜åˆ¶ä¸åŒé¢œè‰²çš„è½®å»“æ¥å¯è§†åŒ–è¿™äº›åŒºåŸŸï¼Œä½¿å¾—æ¯ä¸ªåŒºåŸŸçš„è¾¹ç•Œæ¸…æ™°å¯è§ã€‚</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/e9/5f/l0mhBLsV_o.png" width="1200"></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2c557d8a378b6d70055a798889a339de/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">Ubuntuç³»ç»Ÿä¸‹éƒ¨ç½²å¤§è¯­è¨€æ¨¡å‹ï¼šOllamaå’ŒOpenWebUIå®ç°å„å¤§æ¨¡å‹çš„äººå·¥æ™ºèƒ½è‡ªç”±</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fd5588ba8277b4e893d08ed5e1d8679e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">ã€C&#43;&#43;ã€‘stringæ¨¡æ‹Ÿå®ç°</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§å’–.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>