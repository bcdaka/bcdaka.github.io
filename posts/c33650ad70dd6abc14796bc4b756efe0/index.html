<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【C&#43;&#43;】—— 类与对象（四） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/c33650ad70dd6abc14796bc4b756efe0/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【C&#43;&#43;】—— 类与对象（四）">
  <meta property="og:description" content="【C&#43;&#43;】—— 类与对象（四） 6、赋值运算符重载6.1、运算符重载6.1.1、基础知识6.1.2、调用方法6.1.3、前置&#43;&#43; 与 后置&#43;&#43; 的重载6.1.4、注意事项6.1.5、&lt;&lt; 和 &gt;&gt; 运算符重载6.1.5.1、&lt;&lt; 和 &gt;&gt; 基础6.1.5.2、日期类 operator&lt;&lt; 的实现6.1.5.2.1、类型不匹配问题6.1.5.2.2、连续赋值问题 6.1.5.3、日期类 operator&gt;&gt; 的实现 6.1.6、总结 6.2、赋值运算符重载5.2.1、赋值运算符重载的特点6.2.1、赋值运算符重载进阶6.2.2、赋值重载拷贝与拷贝构造 7、日期类的完整实现7.1、Date.h7.2、Date.cpp 6、赋值运算符重载 6.1、运算符重载 6.1.1、基础知识 像&#43;、— 、% 、&gt; 等运算符，只对内置有效，但对于自定义类型又该怎么办呢？
就拿 D a t e Date Date类 来说，日期与日期如何比较大小呢？简单地只使用一个 &gt;/&lt; 肯定是无法完成任务的。
解决上述问题，就需要用到 运算符重载
运算符重载的基本特点：
当运算符被用于类类型对象时，C&#43;&#43; 允许我们通过运算符重载的形式制定新的含义。C&#43;&#43; 规定类类型对象使用运算符时，必须转换成调用对应运算符重载，若没有对应的运算符重载，则会编译报错
运算符重载是具有特殊名字的函数，它的名字是由 o p e r a t o r operator operator 和后面要定义的运算符共同构成。和其他函数一样，它也有返回类型和参数列表以及函数体
重载运算符函数的参数个数和该运算符作用的运算对象一样多。一元运算符有一个参数，二元运算符有两个参数，二元运算符的左侧运算对象向传给第一个参数，右测运算对象传给第二个参数
如果一个重载运算符函数是成员函数，则它的第一个运算对象默认传给隐式的 t h i s this this指针，因此运算符重在作为成员函数是，参数比运算对象少一个。 我们先写一个运算符重载函数来判断两个日期是否相等
class Date { public: Date(int year = 2024, int month = 1, int day = 1) { _year = year; _month = month; _day = day; } private: int _year; int _month; int _day; }; bool operator==(const Date&amp; d1, const Date&amp; d2) { return d1.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-10T10:40:05+08:00">
    <meta property="article:modified_time" content="2024-08-10T10:40:05+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【C&#43;&#43;】—— 类与对象（四）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>【C++】—— 类与对象（四）</h4> 
 <ul><li><a href="#6_1" rel="nofollow">6、赋值运算符重载</a></li><li><ul><li><a href="#61_2" rel="nofollow">6.1、运算符重载</a></li><li><ul><li><a href="#611_3" rel="nofollow">6.1.1、基础知识</a></li><li><a href="#612_85" rel="nofollow">6.1.2、调用方法</a></li><li><a href="#613____107" rel="nofollow">6.1.3、前置++ 与 后置++ 的重载</a></li><li><a href="#614_138" rel="nofollow">6.1.4、注意事项</a></li><li><a href="#615____172" rel="nofollow">6.1.5、&lt;&lt; 和 &gt;&gt; 运算符重载</a></li><li><ul><li><a href="#6151____173" rel="nofollow">6.1.5.1、&lt;&lt; 和 &gt;&gt; 基础</a></li><li><a href="#6152_operator__191" rel="nofollow">6.1.5.2、日期类 operator&lt;&lt; 的实现</a></li><li><ul><li><a href="#61521_239" rel="nofollow">6.1.5.2.1、类型不匹配问题</a></li><li><a href="#61522_310" rel="nofollow">6.1.5.2.2、连续赋值问题</a></li></ul> 
     </li><li><a href="#6153_operator__345" rel="nofollow">6.1.5.3、日期类 operator&gt;&gt; 的实现</a></li></ul> 
    </li><li><a href="#616_362" rel="nofollow">6.1.6、总结</a></li></ul> 
   </li><li><a href="#62_389" rel="nofollow">6.2、赋值运算符重载</a></li><li><ul><li><a href="#521_393" rel="nofollow">5.2.1、赋值运算符重载的特点</a></li><li><a href="#621_457" rel="nofollow">6.2.1、赋值运算符重载进阶</a></li><li><a href="#622_467" rel="nofollow">6.2.2、赋值重载拷贝与拷贝构造</a></li></ul> 
  </li></ul> 
  </li><li><a href="#7_476" rel="nofollow">7、日期类的完整实现</a></li><li><ul><li><a href="#71Dateh_478" rel="nofollow">7.1、Date.h</a></li><li><a href="#72Datecpp_558" rel="nofollow">7.2、Date.cpp</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="6_1"></a>6、赋值运算符重载</h2> 
<h3><a id="61_2"></a>6.1、运算符重载</h3> 
<h4><a id="611_3"></a>6.1.1、基础知识</h4> 
<p>  像<code>+、— 、% 、&gt;</code> 等运算符，<mark>只对内置有效</mark>，但对于<code>自定义类型</code>又该怎么办呢？<br>   就拿 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         D 
        
       
         a 
        
       
         t 
        
       
         e 
        
       
      
        Date 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">D</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span></span></span></span></span>类 来说，日期与日期如何比较大小呢？简单地只使用一个 <code>&gt;/&lt;</code> 肯定是无法完成任务的。</p> 
<p>  解决上述问题，就需要用到 <mark><font color="red">运算符重载</font></mark></p> 
<p>运算符重载的<mark>基本特点</mark>：</p> 
<blockquote> 
 <ul><li>当运算符被用于<code>类类型</code>对象时，C++ 允许我们通过<mark>运算符重载</mark>的形式<mark>制定新的含义</mark>。C++ 规定类类型对象使用运算符时，<code>必须转换成调用对应运算符重载</code>，若没有对应的运算符重载，则会编译<font color="red">报错</font><br>   </li><li>运算符重载是<font color="red">具有特殊名字的函数</font>，它的名字是由 <mark><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            o 
           
          
            p 
           
          
            e 
           
          
            r 
           
          
            a 
           
          
            t 
           
          
            o 
           
          
            r 
           
          
         
           operator 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8095em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right: 0.0278em;">er</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right: 0.0278em;">or</span></span></span></span></span></mark> 和后面要定义的<mark>运算符</mark>共同构成。和其他函数一样，它也有<code>返回类型</code>和<code>参数列表</code>以及<code>函数体</code><br>   </li><li>重载运算符函数的<mark>参数个数</mark>和该运算符作用的<mark>运算对象</mark><font color="red"><strong>一样多</strong></font>。一元运算符有<code>一个参数</code>，二元运算符有<code>两个参数</code>，二元运算符的<strong>左侧运算对象</strong>向传给<strong>第一个参数</strong>，<strong>右测运算对象</strong>传给<strong>第二个参数</strong><br>   </li><li>如果一个重载运算符函数是<font color="red">成员函数</font>，则它的第一个运算对象默认传给隐式的 <mark><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            t 
           
          
            h 
           
          
            i 
           
          
            s 
           
          
         
           this 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">hi</span><span class="mord mathnormal">s</span></span></span></span></span>指针</mark>，因此运算符重在作为成员函数是，<code>参数比运算对象少一个</code>。</li></ul> 
</blockquote> 
<p>  <br>   我们先写一个运算符重载函数来判断两个日期是否相等</p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Date</span><span class="token punctuation">(</span><span class="token keyword">int</span> year <span class="token operator">=</span> <span class="token number">2024</span><span class="token punctuation">,</span> <span class="token keyword">int</span> month <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">int</span> day <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_year <span class="token operator">=</span> year<span class="token punctuation">;</span>
		_month <span class="token operator">=</span> month<span class="token punctuation">;</span>
		_day <span class="token operator">=</span> day<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _month<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d1<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d2<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span>  d1<span class="token punctuation">.</span>_year <span class="token operator">==</span> d2<span class="token punctuation">.</span>_year <span class="token operator">&amp;&amp;</span> \
			d1<span class="token punctuation">.</span>_month <span class="token operator">==</span> d2<span class="token punctuation">.</span>_month <span class="token operator">&amp;&amp;</span> \
			d1<span class="token punctuation">.</span>_day <span class="token operator">==</span> d2<span class="token punctuation">.</span>_day<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>  但现在还有一个问题：<code>operator==</code> 在类外，成员变量是私有，没有访问权限<br>   <br> 有三种方法：</p> 
<blockquote> 
 <ol><li>把成员变量的访问权限改为<mark>公有</mark></li><li><mark>提供</mark> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           G 
          
         
           e 
          
         
           t 
          
         
           Y 
          
         
           e 
          
         
           a 
          
         
           r 
          
         
        
          GetYear 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">G</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span></span></span></span></span> 等<mark>函数</mark></li><li><mark>友元函数</mark>（之后讲）</li></ol> 
</blockquote> 
<p>  这次，三种方法我们都不用(虚晃一枪)，直接把它变成成员函数不香吗</p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Date</span><span class="token punctuation">(</span><span class="token keyword">int</span> year <span class="token operator">=</span> <span class="token number">2024</span><span class="token punctuation">,</span> <span class="token keyword">int</span> month <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">int</span> day <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_year <span class="token operator">=</span> year<span class="token punctuation">;</span>
		_month <span class="token operator">=</span> month<span class="token punctuation">;</span>
		_day <span class="token operator">=</span> day<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d1<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span>  _year <span class="token operator">==</span> d1<span class="token punctuation">.</span>_year <span class="token operator">&amp;&amp;</span> \
			_month <span class="token operator">==</span> d1<span class="token punctuation">.</span>_month <span class="token operator">&amp;&amp;</span> \
			_day <span class="token operator">==</span> d1<span class="token punctuation">.</span>_day<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _month<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>  当运算符重载函数是<font color="red">成员函数</font>时，它的第一个参数默认是 <mark><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          t 
         
        
          h 
         
        
          i 
         
        
          s 
         
        
       
         this 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">hi</span><span class="mord mathnormal">s</span></span></span></span></span>指针</mark>，因此<mark>参数比运算对象<font color="red">少一个</font></mark>。<br>   <br>   </p> 
<h4><a id="612_85"></a>6.1.2、调用方法</h4> 
<p>  那运算符重载函数怎么调用呢？</p> 
<p>它有<strong>两种</strong>调用方法：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Date <span class="token function">d1</span><span class="token punctuation">(</span><span class="token number">2023</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Date <span class="token function">d2</span><span class="token punctuation">(</span><span class="token number">2024</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//法一：如普通函数一样的调用方法</span>
	d1<span class="token punctuation">.</span><span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span>d2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token comment">//法二：写成运算符的调用方法（推荐）</span>
	d1 <span class="token operator">==</span> d2<span class="token punctuation">;</span>
	
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>  <br>   </p> 
<h4><a id="613____107"></a>6.1.3、前置++ 与 后置++ 的重载</h4> 
<p>  大家有没有想过，<code>++运算符</code>怎么重载呢？毕竟 <mark>前置++</mark> 和 <mark>后置++</mark> 的运算符重载函数名都是 <code>operator++</code>，并且<strong>参数都是一样的</strong>(都为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         t 
        
       
         h 
        
       
         i 
        
       
         s 
        
       
      
        this 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">hi</span><span class="mord mathnormal">s</span></span></span></span></span>指针)，怎么进行区分呢？<br>   <br>   C++ 规定，<code>后置++</code> 重载时，<mark>增加一个 <font color="red"><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           i 
          
         
           n 
          
         
           t 
          
         
        
          int 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">in</span><span class="mord mathnormal">t</span></span></span></span></span></font> 参数</mark>，跟 <code>前置++</code> 构成<mark>函数重载</mark>，方便区分。<br>   <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         i 
        
       
         n 
        
       
         t 
        
       
      
        int 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">in</span><span class="mord mathnormal">t</span></span></span></span></span> 参数后面加不加形参名都可以，实际编译器实际上并不接受，只是为了<code>标识</code><br>   <br> 我们简单写一下 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         D 
        
       
         a 
        
       
         t 
        
       
         e 
        
       
      
        Date 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">D</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span></span></span></span></span> 的 <strong>前置++</strong> 和 <strong>后置++</strong>：</p> 
<pre><code class="prism language-cpp"><span class="token comment">//假设operator+=已经实现</span>

<span class="token comment">//后置++</span>
Date <span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Date tmp <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> tmp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//前置++</span>
Date<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>  可以看见 <strong>后置++</strong> 比 <strong>前置++</strong> <mark><font color="red">多了两次拷贝构造</font></mark>，因此对<code>自定义类型</code>，<mark><font color="red">尽量使用前置++</font></mark>，以减少拷贝提高效率<br>   <br>   </p> 
<h4><a id="614_138"></a>6.1.4、注意事项</h4> 
<ol><li> <p>运算符重载后，其<code>优先级</code>和<code>结合性</code>与对应的内置类型运算符<mark>保持一致</mark>。<br>   重载后，运算符的优先级和结合性该怎样还是怎样，比如 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           ∗ 
          
         
        
          * 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4653em;"></span><span class="mord">∗</span></span></span></span></span> 的优先级依然比 ± 高。</p> </li><li> <p><code>不能</code>通过链接语法中没有的符号来<code>产生新的操作符</code>：比如 operator@</p> </li><li> <p><code>.*</code> <code>::</code> <code>sizeof</code> <code>?:</code> <code>.</code>以上5个运算符<mark>不能重载</mark>（选择题例常考，大家要记住）</p> </li><li> <p><code>运算符重载</code>可以构成 <mark>函数重载</mark>。<br>   比如对于日期类，以下两个运算符重载就构成函数重载</p> </li></ol> 
<pre><code class="prism language-cpp"><span class="token comment">//以下两个运算符重载虽然函数名相同，但参数不同，构成运算符重载</span>
<span class="token comment">//日期 - 天数</span>
<span class="token keyword">int</span> <span class="token keyword">operator</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//日期 - 日期</span>
Date <span class="token keyword">operator</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d1<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>  </p> 
<blockquote> 
 <p>运算符重载和函数重载虽然都有 <strong>“重载”</strong> 二字，但他们之间<mark>并没有关系</mark>。</p> 
 <ul><li><mark>函数重载</mark>指的是<code>函数名相同，参数不同</code>。</li><li><mark>运算符重载</mark>指的是<code>重新定义这个运算符</code>的行为。</li><li>再就是 <mark><font color="red">两个运算符重载</font>的函数可以构成<font color="red">函数重载</font></mark></li></ul> 
</blockquote> 
<p>  <br> 5. 重载操作符<mark>至少有一个类类型参数</mark>，不能通过运算符重载改变内置类型对象的含义，如：<code>int operator+(int x, int y)</code><br>   当然，不是全部参数都要自定义类型，<mark>有一个即可</mark>，比如上面的<code>int operator-(const Date&amp; d, int day);</code></p> 
<ol start="6"><li>一个类需要重载那些运算符，是看哪些运算符重载有意义<br> 比如 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          D 
         
        
          a 
         
        
          t 
         
        
          e 
         
        
       
         Date 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">D</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span></span></span></span></span>类 重载 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          o 
         
        
          p 
         
        
          e 
         
        
          r 
         
        
          a 
         
        
          t 
         
        
          o 
         
        
          r 
         
        
       
         operator 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8095em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right: 0.0278em;">er</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right: 0.0278em;">or</span></span></span></span></span>- 就有意义，重载成 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          o 
         
        
          p 
         
        
          e 
         
        
          r 
         
        
          a 
         
        
          t 
         
        
          o 
         
        
          r 
         
        
       
         operator 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8095em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right: 0.0278em;">er</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right: 0.0278em;">or</span></span></span></span></span>+ 就没有意义（日期 + 日期是什么意思呢）<br>   <br>   </li></ol> 
<h4><a id="615____172"></a>6.1.5、&lt;&lt; 和 &gt;&gt; 运算符重载</h4> 
<h5><a id="6151____173"></a>6.1.5.1、&lt;&lt; 和 &gt;&gt; 基础</h5> 
<p>  我们想重载 <code>&lt;&lt;</code> 和 <code>&gt;&gt;</code> 来输入输出日期可不可以呢？我们来试一下</p> 
<p>  首先我们要知道，<mark><code>cout</code> 是 <code>ostream</code> 类型的对象</mark>；<mark><code>cin</code> 是 <code>istream</code> 类型的对象</mark></p> 
<blockquote> 
 <p><img src="https://images2.imgbox.com/3e/eb/8bJRnAQB_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<p>  <br>   为什么对<code>内置类型 &lt;&lt;</code> 能 <mark><font color="red">自动识别类型</font>并输出</mark> 呢？<br>   是因为<font color="red">函数重载</font></p> 
<blockquote> 
 <p><img src="https://images2.imgbox.com/cd/67/N3f6nsjv_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<p>  类中把<mark>所有的内置类型都重载好了</mark>，他能<code>自动识别</code>出函数重载，调用相应的函数进行<code>输出</code>。<br>   <br>   </p> 
<h5><a id="6152_operator__191"></a>6.1.5.2、日期类 operator&lt;&lt; 的实现</h5> 
<p>  那对于<code>自定义类型</code>我们想继续使用 <code>&lt;&lt;</code>，就需要我们<strong>自己重载运算符</strong></p> 
<p>我们来写日期类的流插入：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span> <span class="token operator">:</span>
	<span class="token function">Date</span><span class="token punctuation">(</span><span class="token keyword">int</span> year <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">int</span> month <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">int</span> day <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token operator">:</span><span class="token function">_year</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span>
		<span class="token punctuation">,</span><span class="token function">_month</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span>
		<span class="token punctuation">,</span><span class="token function">_day</span><span class="token punctuation">(</span>day<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>

	 <span class="token keyword">void</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		out <span class="token operator">&lt;&lt;</span> _year <span class="token operator">&lt;&lt;</span> <span class="token string">"年"</span> <span class="token operator">&lt;&lt;</span> _month <span class="token operator">&lt;&lt;</span> <span class="token string">"月"</span> <span class="token operator">&lt;&lt;</span> _day <span class="token operator">&lt;&lt;</span> <span class="token string">"号"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _month<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>  上述代码的 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         o 
        
       
         u 
        
       
         t 
        
       
      
        out 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span></span></span></span></span> 是 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         c 
        
       
         o 
        
       
         u 
        
       
         t 
        
       
      
        cout 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span></span></span></span></span> 的<code>引用</code>，<mark><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          o 
         
        
          u 
         
        
          t 
         
        
       
         out 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span></span></span></span></span> <font color="red">就是</font> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          c 
         
        
          o 
         
        
          u 
         
        
          t 
         
        
       
         cout 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span></span></span></span></span></mark><br>   <br> 我们测试一下：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">{<!-- --></span>
	Date <span class="token function">d</span><span class="token punctuation">(</span><span class="token number">2024</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	d<span class="token punctuation">.</span><span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>cout<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>运行结果：</strong></p> 
<blockquote> 
 <p><img src="https://images2.imgbox.com/95/d9/ICfezmti_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<p>  可以看到，没有问题。<br>   <br>   </p> 
<h6><a id="61521_239"></a>6.1.5.2.1、类型不匹配问题</h6> 
<p>  运算符重载还有另外一种调用方式，我们也试一试</p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">{<!-- --></span>
	Date <span class="token function">d</span><span class="token punctuation">(</span><span class="token number">2024</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p><img src="https://images2.imgbox.com/d4/48/f5JQDU5d_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<p>  <strong>报错了！</strong><br>   为什么呢？两种调用方法不是等价的吗？</p> 
<p>  别急，我们仔细看一下报错信息：<code>“没有找到接受“Date”类型的右操作数的运算符（或没有可接受的转换）”</code><br>   简单来说就是 <mark><font color="red">参数不匹配</font></mark></p> 
<p>  对于运算符重载函数来说，当操作数为二元操作数，<code>左侧</code>的运算对象默认传给<code>第一个参数</code>，<code>右侧</code>的传给的<code>第二个参数</code>。而成员函数的第一个参数<mark>默认是 <font color="red"><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           t 
          
         
           h 
          
         
           i 
          
         
           s 
          
         
        
          this 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">hi</span><span class="mord mathnormal">s</span></span></span></span></span>指针</font></mark>，上述的传参方式会导致类型不匹配<br>   <br> 因此正确的传参是：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Date <span class="token function">d</span><span class="token punctuation">(</span><span class="token number">2024</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	d <span class="token operator">&lt;&lt;</span> cout<span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>  <br>   但<code>d &lt;&lt; cout;</code>这样传参是不是感觉怪怪的，想要<code>cout &lt;&lt; d;</code>传参，那只能把 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         t 
        
       
         h 
        
       
         i 
        
       
         s 
        
       
      
        this 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">hi</span><span class="mord mathnormal">s</span></span></span></span></span>指针 放在<code>第二位</code>，<code>ostream&amp; out</code>放在<code>第一位</code>。</p> 
<p>  那有没有办法把this指针放在第二个参数位置上呢？<mark>没有</mark>。因为 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         t 
        
       
         h 
        
       
         i 
        
       
         s 
        
       
      
        this 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">hi</span><span class="mord mathnormal">s</span></span></span></span></span>指针 是<code>隐式</code>的，我们<strong>无法改变</strong>，C++规定 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         t 
        
       
         h 
        
       
         i 
        
       
         s 
        
       
      
        this 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">hi</span><span class="mord mathnormal">s</span></span></span></span></span>指针 默认是第一个参数</p> 
<p>  因此，<code>operator&lt;&lt;</code> 的重载只能放在类外，成 <mark><font color="red">全局函数</font></mark> 。<br>   但全局函数有一个问题：不能访问私有<br>   我们可以在类中加一个<mark>友元声明</mark>（下期介绍），这样，<code>类外的函数就可以访问私有啦</code><br>   </p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//有元声明</span>
	<span class="token keyword">friend</span> <span class="token keyword">void</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>	
	
<span class="token keyword">public</span> <span class="token operator">:</span>
	<span class="token function">Date</span><span class="token punctuation">(</span><span class="token keyword">int</span> year <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">int</span> month <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">int</span> day <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token operator">:</span><span class="token function">_year</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span>
		<span class="token punctuation">,</span><span class="token function">_month</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span>
		<span class="token punctuation">,</span><span class="token function">_day</span><span class="token punctuation">(</span>day<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _month<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	out <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">.</span>_year <span class="token operator">&lt;&lt;</span> <span class="token string">"年"</span> <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">.</span>_month <span class="token operator">&lt;&lt;</span> <span class="token string">"月"</span> <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">.</span>_day <span class="token operator">&lt;&lt;</span> <span class="token string">"号"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>  <br>   </p> 
<h6><a id="61522_310"></a>6.1.5.2.2、连续赋值问题</h6> 
<p>  但现在还有一个问题，它<code>不支持连续输出</code></p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Date <span class="token function">d1</span><span class="token punctuation">(</span><span class="token number">2024</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Date <span class="token function">d2</span><span class="token punctuation">(</span><span class="token number">2023</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token comment">//无法连续输出</span>
	cout <span class="token operator">&lt;&lt;</span> d1 <span class="token operator">&lt;&lt;</span> d2<span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>  <br>   怎么解决呢？<br>   首先我们要知道<code>&lt;&lt;运算符</code>的结合性是<mark>从左往右</mark>的，因此先进行运算的是<code>cout &lt;&lt; d1</code>。<br>   而<code>cout &lt;&lt; d1</code>应该要有一个<code>返回值</code>以便能支持接下来 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         d 
        
       
         2 
        
       
      
        d2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord">2</span></span></span></span></span> 的输出，那这个返回值是什么呢？很显然是 <mark><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          c 
         
        
          o 
         
        
          u 
         
        
          t 
         
        
       
         cout 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span></span></span></span></span></mark></p> 
<blockquote> 
 <p><img src="https://images2.imgbox.com/88/80/S8M4xSkF_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<p>  <br>   因此，正确的重载应该是这样：</p> 
<pre><code class="prism language-cpp">ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	out <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">.</span>_year <span class="token operator">&lt;&lt;</span> <span class="token string">"年"</span> <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">.</span>_month <span class="token operator">&lt;&lt;</span> <span class="token string">"月"</span> <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">.</span>_day <span class="token operator">&lt;&lt;</span> <span class="token string">"号"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">return</span> out<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>  这里用 <mark><font color="red">引用返回</font></mark>，返回 <mark><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          o 
         
        
          u 
         
        
          t 
         
        
       
         out 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span></span></span></span></span></mark>，即 <mark><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          c 
         
        
          o 
         
        
          u 
         
        
          t 
         
        
       
         cout 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span></span></span></span></span></mark><br>   <br>   </p> 
<h5><a id="6153_operator__345"></a>6.1.5.3、日期类 operator&gt;&gt; 的实现</h5> 
<p>  接下来我们实现<mark>流提取</mark></p> 
<pre><code class="prism language-cpp">istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> in<span class="token punctuation">,</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"请依次输入年月日：&gt;"</span><span class="token punctuation">;</span>
	in <span class="token operator">&gt;&gt;</span> d<span class="token punctuation">.</span>_year <span class="token operator">&gt;&gt;</span> d<span class="token punctuation">.</span>_month <span class="token operator">&gt;&gt;</span> d<span class="token punctuation">.</span>_day<span class="token punctuation">;</span>
	<span class="token keyword">return</span> in<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>  流提取中，<code>Date&amp; d</code>不能加 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         c 
        
       
         o 
        
       
         n 
        
       
         s 
        
       
         t 
        
       
      
        const 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">n</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span></span></span></span></span>，因为提取出的数据要放在对象里面，是要改变对象的。</p> 
<p>  <br>   </p> 
<h4><a id="616_362"></a>6.1.6、总结</h4> 
<blockquote> 
 <ul><li>当运算符被用于<code>类类型</code>对象时，C++ 允许我们通过<mark>运算符重载</mark>的形式<mark>制定新的含义</mark>。C++ 规定类类型对象使用运算符时，<code>必须转换成调用对应运算符重载</code>，若没有对应的运算符重载，则会编译<font color="red">报错</font><br>   </li><li>运算符重载是<font color="red">具有特殊名字的函数</font>，它的名字是由 <mark><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            o 
           
          
            p 
           
          
            e 
           
          
            r 
           
          
            a 
           
          
            t 
           
          
            o 
           
          
            r 
           
          
         
           operator 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8095em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right: 0.0278em;">er</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right: 0.0278em;">or</span></span></span></span></span></mark> 和后面要定义的<mark>运算符</mark>共同构成。和其他函数一样，它也有<code>返回类型</code>和<code>参数列表</code>以及<code>函数体</code><br>   </li><li>重载运算符函数的<mark>参数个数</mark>和该运算符作用的<mark>运算对象</mark><font color="red"><strong>一样多</strong></font>。一元运算符有<code>一个参数</code>，二元运算符有<code>两个参数</code>，二元运算符的<strong>左侧运算对象</strong>向传给<strong>第一个参数</strong>，<strong>右测运算对象</strong>传给<strong>第二个参数</strong><br>   </li><li>如果一个重载运算符函数是<font color="red">成员函数</font>，则它的第一个运算对象默认传给隐式的 <mark><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            t 
           
          
            h 
           
          
            i 
           
          
            s 
           
          
         
           this 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">hi</span><span class="mord mathnormal">s</span></span></span></span></span>指针</mark>，因此运算符重在作为成员函数是，<code>参数比运算对象少一个</code>。<br>   </li><li>运算符重载后，其<code>优先级</code>和<code>结合性</code>与对应的内置类型运算符<mark>保持一致</mark><br>   </li><li>不能通过链接语法中没有的符号来<code>创建新的操作符</code>：比如 <code>operator@</code><br>   </li><li><code>.*</code> <code>::</code> <code>sizeof</code> <code>?:</code> <code>.</code> 以上5个运算符<mark>不能重载</mark>（选择题例常考，大家要记住）<br>   </li><li>重载操作符 <mark><font color="red">至少有一个类类型参数</font></mark>，不能通过运算符重载改变内置类型对象的含义<br>   </li><li>一个类需<mark>要重载运算符</mark>，<code>是看哪些运算符重载后有意义</code>，比如 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           D 
          
         
           a 
          
         
           t 
          
         
           e 
          
         
        
          Date 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">D</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span></span></span></span></span>类 重载 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           o 
          
         
           p 
          
         
           e 
          
         
           r 
          
         
           a 
          
         
           t 
          
         
           o 
          
         
           r 
          
         
        
          operator 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8095em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right: 0.0278em;">er</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right: 0.0278em;">or</span></span></span></span></span>- 就有意义，但是重载 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           o 
          
         
           p 
          
         
           e 
          
         
           r 
          
         
           a 
          
         
           t 
          
         
           o 
          
         
           r 
          
         
        
          operator 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8095em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right: 0.0278em;">er</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right: 0.0278em;">or</span></span></span></span></span>+ 就没有意义<br>   </li><li>重载++ 运算符时，有 <code>前置++</code> 和 <code>后置++</code>，运算符重载函数名都是 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           o 
          
         
           p 
          
         
           e 
          
         
           r 
          
         
           a 
          
         
           t 
          
         
           o 
          
         
           r 
          
         
        
          operator 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8095em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right: 0.0278em;">er</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right: 0.0278em;">or</span></span></span></span></span>++，无法很好的区分。C++ 规定，<mark>后置++</mark> 重载时，<mark>增加一个<font color="red"><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
           
             i 
            
           
             n 
            
           
             t 
            
           
          
            int 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">in</span><span class="mord mathnormal">t</span></span></span></span></span></font> 形参</mark>，跟 前置++ 构成<mark>函数重载</mark>，方面区分<br>   </li><li>重载 <code>&lt;&lt;</code> 和 <code>&gt;&gt;</code> 时，需要重载为<mark>全局函数</mark>，因为重载为成员函数，==<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           t 
          
         
           h 
          
         
           i 
          
         
           s 
          
         
        
          this 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">hi</span><span class="mord mathnormal">s</span></span></span></span></span>指针 ==默认<code>抢占了第一个形参位置</code>，第一个形参位置是左侧运算对象，调用时就变成了 <code>对象 &lt;&lt; cout</code>，不符合使用习惯和可读性。重载为全局函数把 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           o 
          
         
           s 
          
         
           t 
          
         
           r 
          
         
           e 
          
         
           a 
          
         
           m 
          
         
        
          ostream 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal">os</span><span class="mord mathnormal">t</span><span class="mord mathnormal">re</span><span class="mord mathnormal">am</span></span></span></span></span> / <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           i 
          
         
           s 
          
         
           t 
          
         
           r 
          
         
           e 
          
         
           a 
          
         
           m 
          
         
        
          istream 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">re</span><span class="mord mathnormal">am</span></span></span></span></span> 放到第一个形参位置就可以了，第二个形参位置当类类型对象。</li></ul> 
</blockquote> 
<p>  <br>   </p> 
<h3><a id="62_389"></a>6.2、赋值运算符重载</h3> 
<p>  <mark>赋值运算符重载是一个<font color="red">默认成员函数</font></mark>，用于<mark>完成<font color="red">两个已经存在的对象</font>直接的拷贝赋值</mark>，这里要注意跟<code>拷贝构造</code>区分，拷贝构造<mark>用于一个对象<font color="red">拷贝初始化</font>给另一个要创建的对象</mark><br>   </p> 
<h4><a id="521_393"></a>5.2.1、赋值运算符重载的特点</h4> 
<p>赋值运算符重载的特点：</p> 
<blockquote> 
 <ul><li>赋值运算符重载是一个<mark>运算符重载</mark>，规定必须重载为<code>成员函数</code>。赋值运算符重载的参数建议写成 <mark><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            c 
           
          
            o 
           
          
            n 
           
          
            s 
           
          
            t 
           
          
         
           const 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">n</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span></span></span></span></span> 当前类类型引用</mark>，否则会<code>传值传参会有拷贝</code><br>   </li><li><mark>有返回值</mark>，且建议<code>写成当前类类型的引用</code>，引用返回可以<strong>提高效率</strong>，有返回值目的是为了<mark>支持连续赋值</mark>场景</li></ul> 
</blockquote> 
<p>  <br>   我们先尝试写一个赋值运算符重载</p> 
<pre><code class="prism language-cpp">	<span class="token keyword">void</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_year <span class="token operator">=</span> d<span class="token punctuation">.</span>_yaer<span class="token punctuation">;</span>
		_month <span class="token operator">=</span> d<span class="token punctuation">.</span>_month<span class="token punctuation">;</span>
		_day <span class="token operator">=</span> d<span class="token punctuation">.</span>day<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<p><font color="red">注</font>：赋值运算符重载<mark>必须为<font color="red">成员函数</font></mark><br>   </p> 
<blockquote> 
 <ol><li>拷贝构造的参数建议写成<mark>引用</mark>。但不像调用拷贝构造，赋值重载可以写成传值传参，但传值传参要<code>多调用一次拷贝构造</code></li><li>赋值重载是有<mark>返回值</mark>的，返回值建议是<code>自身类类型的引用</code>。为什么呢？主要是存在连续复制的情况</li></ol> 
</blockquote> 
<p>  </p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Date <span class="token function">d1</span><span class="token punctuation">(</span><span class="token number">2024</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Date d2<span class="token punctuation">;</span>
	Date d3<span class="token punctuation">;</span>

	d3 <span class="token operator">=</span> d2 <span class="token operator">=</span> d1<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>  赋值这个运算符是<code>支持连续赋值</code>的，重载后的赋值函数也应支持连续赋值<br>   <br> <strong>比如：</strong></p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> k<span class="token punctuation">;</span>
i <span class="token operator">=</span> j <span class="token operator">=</span> k <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> 
<p>  这个表达式是怎么执行的呢？<br>   “=” 运算符的结合性是<mark>从右往左</mark>的；1 赋值给 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         k 
        
       
      
        k 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span></span></span>， <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         k 
        
       
      
        k 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span></span></span> = 1 这个表达式是<code>有返回值</code>的，返回<mark>左操作数 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          k 
         
        
       
         k 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span></span></span></mark>；<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         k 
        
       
      
        k 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span></span></span> 赋值给 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         j 
        
       
      
        j 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0572em;">j</span></span></span></span></span>，返回 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         j 
        
       
      
        j 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0572em;">j</span></span></span></span></span>；<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         j 
        
       
      
        j 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0572em;">j</span></span></span></span></span> 再赋值给 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         i 
        
       
      
        i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span>，返回 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         i 
        
       
      
        i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span>。</p> 
<blockquote> 
 <p><img src="https://images2.imgbox.com/d5/ca/2KSNfx9I_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<p>  <br>   所以上述赋值重载正确写法是：</p> 
<pre><code class="prism language-cpp">	Date<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_year <span class="token operator">=</span> d<span class="token punctuation">.</span>_yaer<span class="token punctuation">;</span>
		_month <span class="token operator">=</span> d<span class="token punctuation">.</span>_month<span class="token punctuation">;</span>
		_day <span class="token operator">=</span> d<span class="token punctuation">.</span>day<span class="token punctuation">;</span>

		<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<p>  这里返回值建议用<mark>引用</mark>，传值返回的话会多调用 一次拷贝构造<br>   <br>   </p> 
<h4><a id="621_457"></a>6.2.1、赋值运算符重载进阶</h4> 
<p>赋值运算符重载的<strong>进阶特点</strong></p> 
<blockquote> 
 <ul><li><strong>没有显式实现时</strong>，编译器会<code>自动生成</code>一个默认赋值运算符重载，默认运算符重载行为跟默认拷贝构造函数类似，对<code>内置类型</code>成员变量会完成<mark>值拷贝/浅拷贝</mark>（一个字节一个字节的拷贝），对<code>自定义类型</code>成员变量会<mark>调用他的拷贝构造</mark><br>   </li><li>像 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           D 
          
         
           a 
          
         
           t 
          
         
           e 
          
         
        
          Date 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">D</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span></span></span></span></span> 这样的类成员变量<mark>全是内置类型且没有指向什么资源</mark>，编译器自动生成的赋值运算符重载就可以完成需要的拷贝，所以<code>不需要我们显式实现赋值运算符重载</code>。像 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           S 
          
         
           t 
          
         
           a 
          
         
           c 
          
         
           k 
          
         
        
          Stack 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">St</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span></span></span> 这样的类，<mark>虽然也都是内置类型，但是 /_<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            a 
           
          
         
           a 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span></span> 指向了资源</mark>，编译器自动生成的赋值运算符重载完成的值拷贝/浅拷贝不符合我们的需求，<code>所以需要我们自己实现深拷贝</code>（对指向的资源也进行拷贝）。像 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           M 
          
         
           y 
          
         
           Q 
          
         
           u 
          
         
           e 
          
         
           u 
          
         
           e 
          
         
        
          MyQueue 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.109em;">M</span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mord mathnormal">Q</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span></span></span></span></span> 这样的<mark>内部主要是自定义类型 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            S 
           
          
            t 
           
          
            a 
           
          
            c 
           
          
            k 
           
          
         
           Stack 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">St</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span></span></span> 成员</mark>，编译器自动生成的赋值运算符重载会调用 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           S 
          
         
           t 
          
         
           a 
          
         
           c 
          
         
           k 
          
         
        
          Stack 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">St</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span></span></span> 的赋值运算符重载，也<mark>不需要我们显式实现 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            M 
           
          
            y 
           
          
            Q 
           
          
            u 
           
          
            e 
           
          
            u 
           
          
            e 
           
          
         
           MyQueue 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.109em;">M</span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mord mathnormal">Q</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span></span></span></span></span> 的赋值运算重载</mark>。这里有一个小技巧，<strong>如一个类显式实现了析构并释放了资源，那它就需要显示写赋值运算符重载，否则不需要</strong></li></ul> 
</blockquote> 
<p>这两点特点与拷贝构造是类似的，这里就不再赘述。<br>   <br>   </p> 
<h4><a id="622_467"></a>6.2.2、赋值重载拷贝与拷贝构造</h4> 
<p>  这里赋值重载拷贝与拷贝构造很容易混淆，我们来看看<br>   需要知道：<mark>赋值运算符重载与默认构造函数<font color="red">都是默认成员函数</font></mark><br>   <mark><font color="red">赋值运算符重载</font>用于完成两个<font color="red">已经存在的对象</font>直接的<font color="red">拷贝赋值</font></mark>，而 <mark><font color="red">拷贝构造</font>是用于一个对象拷贝<font color="red">初始化</font>给另一个要创建的对象</mark></p> 
<blockquote> 
 <p><img src="https://images2.imgbox.com/04/3f/yZK4doYs_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<p>  <br>   </p> 
<h2><a id="7_476"></a>7、日期类的完整实现</h2> 
<p>  下面，是日期类的完整实现，以便大家检验一下类与对象的成果</p> 
<h3><a id="71Dateh_478"></a>7.1、Date.h</h3> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;assert.h&gt;</span></span>

<span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//友元声明</span>
	<span class="token keyword">friend</span> ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">friend</span> istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> in<span class="token punctuation">,</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token comment">//检查日期是否合法</span>
	<span class="token keyword">bool</span> <span class="token function">CheckDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
	<span class="token comment">//构造函数</span>
	<span class="token function">Date</span><span class="token punctuation">(</span><span class="token keyword">int</span> year <span class="token operator">=</span> <span class="token number">2024</span><span class="token punctuation">,</span> <span class="token keyword">int</span> month <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">int</span> day <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//打印日期</span>
	<span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>

	<span class="token comment">// 频繁调用，Ĭinline函数</span>
	<span class="token keyword">int</span> <span class="token function">GetMonthDay</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">)</span> <span class="token keyword">const</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">assert</span><span class="token punctuation">(</span>month <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> month <span class="token operator">&lt;</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">static</span> <span class="token keyword">int</span> monthDayArray<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span>
<span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">31</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>month <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>year <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> year <span class="token operator">%</span> <span class="token number">100</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>year <span class="token operator">%</span> <span class="token number">400</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> <span class="token number">29</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">return</span> monthDayArray<span class="token punctuation">[</span>month<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
	<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
	<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
	<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&gt;=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
	<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
	<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>

	Date <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">int</span> day<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
	Date<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">int</span> day<span class="token punctuation">)</span><span class="token punctuation">;</span>

	Date <span class="token keyword">operator</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">int</span> day<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
	Date<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">-=</span><span class="token punctuation">(</span><span class="token keyword">int</span> day<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// d1++;</span>
	<span class="token comment">// d1.operator++(0);</span>
	Date <span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// ++d1;</span>
	<span class="token comment">// d1.operator++();</span>
	Date<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// d1--;</span>
	<span class="token comment">// d1.operator--(0);</span>
	Date <span class="token keyword">operator</span><span class="token operator">--</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// --d1;</span>
	<span class="token comment">// d1.operator--();</span>
	Date<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">--</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// d1 - d2</span>
	<span class="token keyword">int</span> <span class="token keyword">operator</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>

<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _month<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>
istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> in<span class="token punctuation">,</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="72Datecpp_558"></a>7.2、Date.cpp</h3> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"Date.h"</span></span>

<span class="token comment">//检查日期是否合法</span>
<span class="token keyword">bool</span> <span class="token class-name">Date</span><span class="token double-colon punctuation">::</span><span class="token function">CheckDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>_month <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> _month <span class="token operator">&gt;</span> <span class="token number">12</span>
		<span class="token operator">||</span> _day <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> _day <span class="token operator">&gt;</span> <span class="token function">GetMonthDay</span><span class="token punctuation">(</span>_year<span class="token punctuation">,</span> _month<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//构造函数</span>
<span class="token class-name">Date</span><span class="token double-colon punctuation">::</span><span class="token function">Date</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	_year <span class="token operator">=</span> year<span class="token punctuation">;</span>
	_month <span class="token operator">=</span> month<span class="token punctuation">;</span>
	_day <span class="token operator">=</span> day<span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">CheckDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"非法日期:"</span><span class="token punctuation">;</span>
		<span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// void Date::Print(const Date* const this)</span>
<span class="token keyword">void</span> <span class="token class-name">Date</span><span class="token double-colon punctuation">::</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	cout <span class="token operator">&lt;&lt;</span> _year <span class="token operator">&lt;&lt;</span> <span class="token string">"/"</span> <span class="token operator">&lt;&lt;</span> _month <span class="token operator">&lt;&lt;</span> <span class="token string">"/"</span> <span class="token operator">&lt;&lt;</span> _day <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// d1 &lt; d2</span>
<span class="token keyword">bool</span> Date<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>_year <span class="token operator">&lt;</span> d<span class="token punctuation">.</span>_year<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>_year <span class="token operator">==</span> d<span class="token punctuation">.</span>_year<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>_month <span class="token operator">&lt;</span> d<span class="token punctuation">.</span>_month<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>_month <span class="token operator">==</span> d<span class="token punctuation">.</span>_month<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _day <span class="token operator">&lt;</span> d<span class="token punctuation">.</span>_day<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// d1 &lt;= d2</span>
<span class="token keyword">bool</span> Date<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">&lt;=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token operator">*</span><span class="token generic-function"><span class="token function">this</span> <span class="token generic class-name"><span class="token operator">&lt;</span> d <span class="token operator">||</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">==</span> d<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> Date<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">&lt;=</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> Date<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">&gt;=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">&lt;</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> Date<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> _year <span class="token operator">==</span> d<span class="token punctuation">.</span>_year
		<span class="token operator">&amp;&amp;</span> _month <span class="token operator">==</span> d<span class="token punctuation">.</span>_month
		<span class="token operator">&amp;&amp;</span> _day <span class="token operator">==</span> d<span class="token punctuation">.</span>_day<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> Date<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">==</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// d1 += 100</span>
Date<span class="token operator">&amp;</span> Date<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">int</span> day<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>day <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token operator">-</span>day<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	_day <span class="token operator">+=</span> day<span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>_day <span class="token operator">&gt;</span> <span class="token function">GetMonthDay</span><span class="token punctuation">(</span>_year<span class="token punctuation">,</span> _month<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_day <span class="token operator">-=</span> <span class="token function">GetMonthDay</span><span class="token punctuation">(</span>_year<span class="token punctuation">,</span> _month<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token operator">++</span>_month<span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>_month <span class="token operator">==</span> <span class="token number">13</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_year<span class="token operator">++</span><span class="token punctuation">;</span>
			_month <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// d1 + 100</span>
Date Date<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">int</span> day<span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	Date tmp <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
	tmp <span class="token operator">+=</span> day<span class="token punctuation">;</span>

	<span class="token keyword">return</span> tmp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// d1 - 100</span>
Date Date<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">int</span> day<span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	Date tmp <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
	tmp <span class="token operator">-=</span> day<span class="token punctuation">;</span>

	<span class="token keyword">return</span> tmp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// d1 -= 100</span>
Date<span class="token operator">&amp;</span> Date<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">-=</span><span class="token punctuation">(</span><span class="token keyword">int</span> day<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>day <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token operator">-</span>day<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	_day <span class="token operator">-=</span> day<span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>_day <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token operator">--</span>_month<span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>_month <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_month <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
			<span class="token operator">--</span>_year<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		_day <span class="token operator">+=</span> <span class="token function">GetMonthDay</span><span class="token punctuation">(</span>_year<span class="token punctuation">,</span> _month<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// d1++;</span>
<span class="token comment">// d1.operator++(0);</span>
Date Date<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Date tmp <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> tmp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// ++d1;</span>
<span class="token comment">// d1.operator++();</span>
Date<span class="token operator">&amp;</span> Date<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// d1 - d2</span>
<span class="token keyword">int</span> Date<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	Date max <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
	Date min <span class="token operator">=</span> d<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">&lt;</span> d<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		max <span class="token operator">=</span> d<span class="token punctuation">;</span>
		min <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
		flag <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>min <span class="token operator">!=</span> max<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token operator">++</span>min<span class="token punctuation">;</span>
		<span class="token operator">++</span>n<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> n <span class="token operator">*</span> flag<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	out <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">.</span>_year <span class="token operator">&lt;&lt;</span> <span class="token string">"年"</span> <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">.</span>_month <span class="token operator">&lt;&lt;</span> <span class="token string">"月"</span> <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">.</span>_day <span class="token operator">&lt;&lt;</span> <span class="token string">"日"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">return</span> out<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> in<span class="token punctuation">,</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"请依次输入年月日:&gt;"</span><span class="token punctuation">;</span>
		in <span class="token operator">&gt;&gt;</span> d<span class="token punctuation">.</span>_year <span class="token operator">&gt;&gt;</span> d<span class="token punctuation">.</span>_month <span class="token operator">&gt;&gt;</span> d<span class="token punctuation">.</span>_day<span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>d<span class="token punctuation">.</span><span class="token function">CheckDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			cout <span class="token operator">&lt;&lt;</span> <span class="token string">"输入日期非法:"</span><span class="token punctuation">;</span>
			d<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			cout <span class="token operator">&lt;&lt;</span> <span class="token string">"请重新输入!!!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> in<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><font color="red"><strong>注：</strong></font></p> 
<blockquote> 
 <ol><li><code>int GetMonthDay(int year, int month) const</code>是用来获取该年该月日期，因为需要多次调用，因此直接在<mark>类内实现成<font color="red">内联函数</font></mark></li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           o 
          
         
           p 
          
         
           e 
          
         
           e 
          
         
           r 
          
         
           a 
          
         
           t 
          
         
           o 
          
         
           r 
          
         
        
          opeerator 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8095em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right: 0.0278em;">eer</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right: 0.0278em;">or</span></span></span></span></span>+ 可通过 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           o 
          
         
           p 
          
         
           e 
          
         
           e 
          
         
           r 
          
         
           a 
          
         
           t 
          
         
           o 
          
         
           r 
          
         
        
          opeerator 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8095em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right: 0.0278em;">eer</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right: 0.0278em;">or</span></span></span></span></span>+= <mark>复用实现</mark>。<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           o 
          
         
           p 
          
         
           e 
          
         
           e 
          
         
           r 
          
         
           a 
          
         
           t 
          
         
           o 
          
         
           r 
          
         
        
          opeerator 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8095em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right: 0.0278em;">eer</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right: 0.0278em;">or</span></span></span></span></span>+= 可通过 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           o 
          
         
           p 
          
         
           e 
          
         
           e 
          
         
           r 
          
         
           a 
          
         
           t 
          
         
           o 
          
         
           r 
          
         
        
          opeerator 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8095em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right: 0.0278em;">eer</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right: 0.0278em;">or</span></span></span></span></span>+ <mark>复用实现</mark>，但<mark>更推荐前者</mark>（<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           o 
          
         
           p 
          
         
           e 
          
         
           r 
          
         
           a 
          
         
           t 
          
         
           o 
          
         
           r 
          
         
        
          operator 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8095em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right: 0.0278em;">er</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right: 0.0278em;">or</span></span></span></span></span>+ 达到实现效率一致，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           o 
          
         
           p 
          
         
           e 
          
         
           e 
          
         
           r 
          
         
           a 
          
         
           t 
          
         
           o 
          
         
           r 
          
         
        
          opeerator 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8095em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right: 0.0278em;">eer</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right: 0.0278em;">or</span></span></span></span></span>+=<br> 后者要多调用两次拷贝构造和一次赋值）</li><li>对于 <code>&lt;，&lt;=，==，&gt;，&gt;=，!=</code> ，他们 6 个 <mark>任意实现 2 个即可</mark>，其他 4 个均可 <mark>通过逻辑间相互复用实现</mark></li></ol> 
</blockquote> 
<p>  <br>   <br>   <br>   <br>   </p> 
<hr> 
<p>  <em><font color="orange">好啦，本期关于类和对象的知识就介绍到这里啦，希望本期博客能对你有所帮助。同时，如果有错误的地方请多多指正，让我们在C语言的学习路上一起进步！</font></em></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6b122934de8e2969c599f46d6b47bcf0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">大数据-76 Kafka 高级特性 稳定性-消费重复 生产者、Broker、消费者 导致的重复消费问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3ab8fc09479e384b781f36d681adc933/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ubuntu中设置开机自动运行的（sudo）指令</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>