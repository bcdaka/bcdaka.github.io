<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>poi库简单使用（java如何实现动态替换模板Word内容） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/2eedbc29297284b433b44cf9c47d0994/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="poi库简单使用（java如何实现动态替换模板Word内容）">
  <meta property="og:description" content="目录
Blue留言：
Blue的推荐：
什么是poi库？ 实现动态替换
第一步：依赖
第二步：实现word模板中替换文字
模板word：
通过以下代码：（自己建一个类，随意取名，主要是看test2这个函数）
第三步：实现word模板中替换图片
模板：
通过以下代码：
效果：
第四步：实现word模板表格 模板：
代码：
效果：
结语：
Blue留言： 💕💕💕Hello，Hello！！！好久没发文了，最近一直在写我的竞赛的项目，导致没时间写文章。正好，今天也差不多把竞赛项目写的差不多了，也可以来写写文章。俺今天分享一下简单的去使用poi库，希望各位能够从文章中获取经验！！！💕💕💕
Blue的推荐： 推荐学习poi库的网站：
https://www.w3ccoo.com/apache_poi/apache_poi_overview.html
推荐视频：
http://【Java导出Word太简单了，有手就会？】https://www.bilibili.com/video/BV18X4y1v7yD?vd_source=bb412cc25ca27e171f8e17085daad038
什么是poi库？ Apache POI 是一种流行的 API，允许程序员使用 Java 程序创建、修改和显示 MS Office 文件。 它是由 Apache Software Foundation 开发和分发的开源库，用于使用 Java 程序设计或修改 Microsoft Office 文件。 它包含将用户输入数据或文件解码为 MS Office 文档的类和方法。
实现动态替换 第一步：依赖 &lt;dependency&gt; &lt;groupId&gt;com.deepoove&lt;/groupId&gt; &lt;artifactId&gt;poi-tl&lt;/artifactId&gt; &lt;version&gt;1.12.1&lt;/version&gt; &lt;/dependency&gt; 第二步：实现word模板中替换文字 首先我们制作一个模板word，将需要动态替换的文字用{{text}}去替换，其中text可以是任意名称
模板word： 通过以下代码：（自己建一个类，随意取名，主要是看test2这个函数） import com.deepoove.poi.XWPFTemplate; import com.deepoove.poi.data.PictureRenderData; import com.deepoove.poi.data.Pictures; import java.io.FileOutputStream; import java.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-19T12:29:22+08:00">
    <meta property="article:modified_time" content="2024-07-19T12:29:22+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">poi库简单使用（java如何实现动态替换模板Word内容）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/89/2e/laOd00OT_o.jpg"></p> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="Blue%E7%95%99%E8%A8%80%EF%BC%9A-toc" style="margin-left:0px;"><a href="#Blue%E7%95%99%E8%A8%80%EF%BC%9A" rel="nofollow">Blue留言：</a></p> 
<p id="Blue%E7%9A%84%E6%8E%A8%E8%8D%90%EF%BC%9A-toc" style="margin-left:0px;"><a href="#Blue%E7%9A%84%E6%8E%A8%E8%8D%90%EF%BC%9A" rel="nofollow">Blue的推荐：</a></p> 
<p id="%E4%BB%80%E4%B9%88%E6%98%AFpoi%E5%BA%93%EF%BC%9F%C2%A0-toc" style="margin-left:0px;"><a href="#%E4%BB%80%E4%B9%88%E6%98%AFpoi%E5%BA%93%EF%BC%9F%C2%A0" rel="nofollow">什么是poi库？ </a></p> 
<p id="%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E6%9B%BF%E6%8D%A2-toc" style="margin-left:0px;"><a href="#%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E6%9B%BF%E6%8D%A2" rel="nofollow">实现动态替换</a></p> 
<p id="%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A%E4%BE%9D%E8%B5%96-toc" style="margin-left:40px;"><a href="#%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A%E4%BE%9D%E8%B5%96" rel="nofollow">第一步：依赖</a></p> 
<p id="%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A%E5%AE%9E%E7%8E%B0word%E6%A8%A1%E6%9D%BF%E4%B8%AD%E6%9B%BF%E6%8D%A2%E6%96%87%E5%AD%97-toc" style="margin-left:40px;"><a href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A%E5%AE%9E%E7%8E%B0word%E6%A8%A1%E6%9D%BF%E4%B8%AD%E6%9B%BF%E6%8D%A2%E6%96%87%E5%AD%97" rel="nofollow">第二步：实现word模板中替换文字</a></p> 
<p id="%E6%A8%A1%E6%9D%BFword%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E6%A8%A1%E6%9D%BFword%EF%BC%9A" rel="nofollow">模板word：</a></p> 
<p id="%E9%80%9A%E8%BF%87%E4%BB%A5%E4%B8%8B%E4%BB%A3%E7%A0%81%EF%BC%9A%EF%BC%88%E8%87%AA%E5%B7%B1%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%B1%BB%EF%BC%8C%E9%9A%8F%E6%84%8F%E5%8F%96%E5%90%8D%EF%BC%8C%E4%B8%BB%E8%A6%81%E6%98%AF%E7%9C%8Btest2%E8%BF%99%E4%B8%AA%E5%87%BD%E6%95%B0%EF%BC%89-toc" style="margin-left:80px;"><a href="#%E9%80%9A%E8%BF%87%E4%BB%A5%E4%B8%8B%E4%BB%A3%E7%A0%81%EF%BC%9A%EF%BC%88%E8%87%AA%E5%B7%B1%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%B1%BB%EF%BC%8C%E9%9A%8F%E6%84%8F%E5%8F%96%E5%90%8D%EF%BC%8C%E4%B8%BB%E8%A6%81%E6%98%AF%E7%9C%8Btest2%E8%BF%99%E4%B8%AA%E5%87%BD%E6%95%B0%EF%BC%89" rel="nofollow">通过以下代码：（自己建一个类，随意取名，主要是看test2这个函数）</a></p> 
<p id="%E7%AC%AC%E4%B8%89%E6%AD%A5%EF%BC%9A%E5%AE%9E%E7%8E%B0word%E6%A8%A1%E6%9D%BF%E4%B8%AD%E6%9B%BF%E6%8D%A2%E5%9B%BE%E7%89%87-toc" style="margin-left:40px;"><a href="#%E7%AC%AC%E4%B8%89%E6%AD%A5%EF%BC%9A%E5%AE%9E%E7%8E%B0word%E6%A8%A1%E6%9D%BF%E4%B8%AD%E6%9B%BF%E6%8D%A2%E5%9B%BE%E7%89%87" rel="nofollow">第三步：实现word模板中替换图片</a></p> 
<p id="%E6%A8%A1%E6%9D%BF%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E6%A8%A1%E6%9D%BF%EF%BC%9A" rel="nofollow">模板：</a></p> 
<p id="%E9%80%9A%E8%BF%87%E4%BB%A5%E4%B8%8B%E4%BB%A3%E7%A0%81%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E9%80%9A%E8%BF%87%E4%BB%A5%E4%B8%8B%E4%BB%A3%E7%A0%81%EF%BC%9A" rel="nofollow">通过以下代码：</a></p> 
<p id="%E6%95%88%E6%9E%9C%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E6%95%88%E6%9E%9C%EF%BC%9A" rel="nofollow">效果：</a></p> 
<p id="%E7%AC%AC%E5%9B%9B%E6%AD%A5%EF%BC%9A%E5%AE%9E%E7%8E%B0word%E6%A8%A1%E6%9D%BF%E8%A1%A8%E6%A0%BC%C2%A0-toc" style="margin-left:40px;"><a href="#%E7%AC%AC%E5%9B%9B%E6%AD%A5%EF%BC%9A%E5%AE%9E%E7%8E%B0word%E6%A8%A1%E6%9D%BF%E8%A1%A8%E6%A0%BC%C2%A0" rel="nofollow">第四步：实现word模板表格 </a></p> 
<p id="%E6%A8%A1%E6%9D%BF%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E6%A8%A1%E6%9D%BF%EF%BC%9A" rel="nofollow">模板：</a></p> 
<p id="%C2%A0%E4%BB%A3%E7%A0%81%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%C2%A0%E4%BB%A3%E7%A0%81%EF%BC%9A" rel="nofollow"> 代码：</a></p> 
<p id="%E6%95%88%E6%9E%9C%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E6%95%88%E6%9E%9C%EF%BC%9A" rel="nofollow">效果：</a></p> 
<p id="%C2%A0%E7%BB%93%E8%AF%AD%EF%BC%9A-toc" style="margin-left:0px;"><a href="#%C2%A0%E7%BB%93%E8%AF%AD%EF%BC%9A" rel="nofollow"> 结语：</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="Blue%E7%95%99%E8%A8%80%EF%BC%9A">Blue留言：</h2> 
<blockquote> 
 <p>  💕💕💕Hello，Hello！！！好久没发文了，最近一直在写我的竞赛的项目，导致没时间写文章。正好，今天也差不多把竞赛项目写的差不多了，也可以来写写文章。俺今天分享一下简单的去使用poi库，希望各位能够从文章中获取经验！！！💕💕💕</p> 
</blockquote> 
<h2 id="Blue%E7%9A%84%E6%8E%A8%E8%8D%90%EF%BC%9A">Blue的推荐：</h2> 
<p>推荐学习poi库的网站：</p> 
<p><a class="link-info" href="https://www.w3ccoo.com/apache_poi/apache_poi_overview.html" rel="nofollow" title="https://www.w3ccoo.com/apache_poi/apache_poi_overview.html">https://www.w3ccoo.com/apache_poi/apache_poi_overview.html</a></p> 
<p>推荐视频：</p> 
<p><a class="link-info" href="?vd_source=bb412cc25ca27e171f8e17085daad038" rel="nofollow" title="http://【Java导出Word太简单了，有手就会？】https://www.bilibili.com/video/BV18X4y1v7yD?vd_source=bb412cc25ca27e171f8e17085daad038">http://【Java导出Word太简单了，有手就会？】https://www.bilibili.com/video/BV18X4y1v7yD?vd_source=bb412cc25ca27e171f8e17085daad038</a></p> 
<h2 id="%E4%BB%80%E4%B9%88%E6%98%AFpoi%E5%BA%93%EF%BC%9F%C2%A0">什么是poi库？ </h2> 
<p>Apache POI 是一种流行的 API，允许程序员使用 Java 程序创建、修改和显示 MS Office 文件。 它是由 Apache Software Foundation 开发和分发的开源库，用于使用 Java 程序设计或修改 Microsoft Office 文件。 它包含将用户输入数据或文件解码为 MS Office 文档的类和方法。</p> 
<h2 id="%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E6%9B%BF%E6%8D%A2">实现动态替换</h2> 
<h3 id="%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A%E4%BE%9D%E8%B5%96">第一步：依赖</h3> 
<pre><code class="hljs">&lt;dependency&gt;
    &lt;groupId&gt;com.deepoove&lt;/groupId&gt;
    &lt;artifactId&gt;poi-tl&lt;/artifactId&gt;
    &lt;version&gt;1.12.1&lt;/version&gt;
&lt;/dependency&gt;
</code></pre> 
<h3 id="%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A%E5%AE%9E%E7%8E%B0word%E6%A8%A1%E6%9D%BF%E4%B8%AD%E6%9B%BF%E6%8D%A2%E6%96%87%E5%AD%97">第二步：实现word模板中替换文字</h3> 
<p>首先我们制作一个模板word，将需要动态替换的文字用<span style="color:#fe2c24;">{<!-- -->{text}}</span>去替换，其中<span style="color:#fe2c24;">text</span>可以是任意名称</p> 
<h4 id="%E6%A8%A1%E6%9D%BFword%EF%BC%9A">模板word：</h4> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/2b/18/4mSC8sMt_o.png"></p> 
<h4 id="%E9%80%9A%E8%BF%87%E4%BB%A5%E4%B8%8B%E4%BB%A3%E7%A0%81%EF%BC%9A%EF%BC%88%E8%87%AA%E5%B7%B1%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%B1%BB%EF%BC%8C%E9%9A%8F%E6%84%8F%E5%8F%96%E5%90%8D%EF%BC%8C%E4%B8%BB%E8%A6%81%E6%98%AF%E7%9C%8Btest2%E8%BF%99%E4%B8%AA%E5%87%BD%E6%95%B0%EF%BC%89">通过以下代码：（自己建一个类，随意取名，主要是看test2这个函数）</h4> 
<pre><code class="language-java">import com.deepoove.poi.XWPFTemplate;
import com.deepoove.poi.data.PictureRenderData;
import com.deepoove.poi.data.Pictures;

import java.io.FileOutputStream;
import java.io.IOException;
import java.util.HashMap;
import java.util.Map;

public class demo1 {
    public static String test2(String mess,String pname) throws IOException {
        
//模板的本地路径
        String path = "D:\\ml\\idea\\jishedemo1\\src\\main\\resources\\doc\\demo1.docx";
//生成后的world的路径
 String pathend="D:\\ml\\idea\\jishedemo1\\src\\main\\resources\\doc\\"+pname+".docx";

//固定写法
        XWPFTemplate template = XWPFTemplate.compile(path);
        Map&lt;String,Object&gt; map= new HashMap&lt;&gt;();
//文字
        String ws=mess;//mess是你想要去动态替换进的文字
        map.put("text",ws);//固定写法
        //固定写法
        template.render(map);
        template.writeAndClose(new FileOutputStream(pathend));
        return pathend;
    }
}
</code></pre> 
<p>效果：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/66/d3/owdXcZV2_o.png"> </p> 
<h3 id="%E7%AC%AC%E4%B8%89%E6%AD%A5%EF%BC%9A%E5%AE%9E%E7%8E%B0word%E6%A8%A1%E6%9D%BF%E4%B8%AD%E6%9B%BF%E6%8D%A2%E5%9B%BE%E7%89%87">第三步：实现word模板中替换图片</h3> 
<p>依旧是制作一个模板word，将需要动态替换的图片用<span style="color:#fe2c24;">{<!-- -->{@text}}</span>去替换，其中<span style="color:#fe2c24;">text</span>可以是任意名称，@是必须有的符号。</p> 
<h4 id="%E6%A8%A1%E6%9D%BF%EF%BC%9A">模板：</h4> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/48/00/m5MI4cWx_o.png"></p> 
<h4 id="%E9%80%9A%E8%BF%87%E4%BB%A5%E4%B8%8B%E4%BB%A3%E7%A0%81%EF%BC%9A">通过以下代码：</h4> 
<pre><code class="language-java"> //图片
    @Test
    public void test4() throws IOException {
        //文本
        String path = "D:\\ml\\idea\\jishedemo1\\src\\main\\resources\\doc\\img.docx";
        XWPFTemplate template = XWPFTemplate.compile(path);
        Map&lt;String,Object&gt; map= new HashMap&lt;&gt;();
        //本地图片
        PictureRenderData img=Pictures.of("C:\\Users\\王\\OneDrive\\屏幕截图 2024-07-15 094619.png").create();
        //网络图片
        PictureRenderData img2=Pictures.ofUrl("https://p3.itc.cn/images01/20230925/43d7f951f84549d69fdaa790d1d5dbeb.png").size(300,300).create();
        map.put("img",img);
        map.put("urlImg",img2);

        template.render(map);
        template.writeAndClose(new FileOutputStream("D:\\ml\\idea\\jishedemo1\\src\\main\\resources\\doc\\img1.docx"));
    }</code></pre> 
<h4 id="%E6%95%88%E6%9E%9C%EF%BC%9A">效果：</h4> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/b6/03/nl79Vuai_o.png"> </p> 
<p>注意：可以通过如下代码指定 图片大小</p> 
<pre><code class="language-java">  PictureRenderData img2=Pictures.ofUrl("https://p3.itc.cn/images01/20230925/43d7f951f84549d69fdaa790d1d5dbeb.png").size(300,300).create();</code></pre> 
<p> </p> 
<h3 id="%E7%AC%AC%E5%9B%9B%E6%AD%A5%EF%BC%9A%E5%AE%9E%E7%8E%B0word%E6%A8%A1%E6%9D%BF%E8%A1%A8%E6%A0%BC%C2%A0">第四步：实现word模板表格 </h3> 
<p style="margin-left:0;text-align:justify;">依旧是制作一个模板word，将需要动态替换的表格用{<!-- -->{#table}}替换</p> 
<h4 style="margin-left:0px;text-align:justify;">模板：</h4> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="1200" src="https://images2.imgbox.com/6a/09/2W8UTMZ0_o.png" width="1200"></p> 
<h4 id="%C2%A0%E4%BB%A3%E7%A0%81%EF%BC%9A"> 代码：</h4> 
<pre><code class="language-java"> //表格
    @Test
    public void test3() throws IOException {
        //
        String path = "D:\\ml\\idea\\jishedemo1\\src\\main\\resources\\doc\\table.docx";
        XWPFTemplate template = XWPFTemplate.compile(path);
        Map&lt;String,Object&gt; map= new HashMap&lt;&gt;();
        RowRenderData row0 =Rows.of("姓名","年龄").create();//
        RowRenderData row1 =Rows.of("占山","18").create();
        RowRenderData row2 =Rows.of("万兽","20").create();
        TableRenderData table =Tables.create(row0,row1,row2);

        map.put("table",table);//
        template.render(map);
        template.writeAndClose(new FileOutputStream("D:\\ml\\idea\\jishedemo1\\src\\main\\resources\\doc\\table1.docx"));

    }</code></pre> 
<h4>效果：</h4> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/8e/80/PqI2UNvH_o.png"></p> 
<h2 id="%C2%A0%E7%BB%93%E8%AF%AD%EF%BC%9A"> 结语：</h2> 
<blockquote> 
 <p> 💕💕💕 好了，到了这里我们又该说再见了，＞﹏＜，我们已简单探讨了Apache POI这一强大的Java库，它在处理Microsoft Office文档（如Excel、Word等）时展现出的卓越能力令人印象深刻。通过本文的详细阐述，我们简单的去了解了Apache POI的基本架构、核心功能，还通过实例展示了如何在实际项目中灵活应用这些功能来解决具体问题。希望这篇文章能够成为您在使用Apache POI进行开发时的得力助手，助您在数据处理与文档自动化领域更加游刃有余。</p> 
 <p>随着技术的不断进步，Apache POI也在持续更新迭代，引入更多新特性和优化。各位观众老爷可以持续关注Apache POI的官方文档和社区动态，以便第一时间掌握最新信息，充分利用这一强大工具提升工作效率。最后，感谢观众老爷花时间阅读本文，期待您在未来的开发旅程中，能够利用Apache POI创造出更多精彩的应用与解决方案。💕💕💕</p> 
</blockquote> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/84b65dc5bdf9022a30d42042263d27f4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java版Flink使用指南——安装Flink和使用IntelliJ制作任务包</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/edfd42b9cf8f3d6e42b334c618f7436f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">JavaScript进阶：探索模块化、ES6&#43;与前端框架</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>