<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ã€JavaScriptã€‘æ·±å…¥ç†è§£Promiseï¼šä»åŸºç¡€æ¦‚å¿µåˆ°è¿›é˜¶ç”¨æ³•ã€æ‰‹å†™promise - ç¼–ç¨‹å¤§å’–</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/cd944e8373c593c9ad650fed899fbc64/">
  <meta property="og:site_name" content="ç¼–ç¨‹å¤§å’–">
  <meta property="og:title" content="ã€JavaScriptã€‘æ·±å…¥ç†è§£Promiseï¼šä»åŸºç¡€æ¦‚å¿µåˆ°è¿›é˜¶ç”¨æ³•ã€æ‰‹å†™promise">
  <meta property="og:description" content="ğŸ”¥ ä¸ªäººä¸»é¡µï¼šç©ºç™½è¯— æ–‡ç« ç›®å½• ä¸€ã€å¼•è¨€äºŒã€Promiseæ¦‚è¿°1. Promiseçš„å®šä¹‰2. Promiseçš„ç”¨é€”3. Promiseçš„ä¸‰ç§çŠ¶æ€4. Promiseçš„æ„é€ å‡½æ•°å’ŒåŸºç¡€ç»“æ„5. Promiseçš„ä¼˜ç‚¹6. Promiseçš„å®ä¾‹æ–¹æ³•7. Promiseçš„é™æ€æ–¹æ³• ä¸‰ã€Promiseçš„åŸºæœ¬ç”¨æ³•1. åˆ›å»ºä¸€ä¸ªPromise2. `then`æ–¹æ³•3. `catch`æ–¹æ³•4. `finally`æ–¹æ³•5. é“¾å¼è°ƒç”¨6. ç¤ºä¾‹ä»£ç  å››ã€Promiseçš„è¿›é˜¶ç”¨æ³•1. `Promise.all`2. `Promise.race`3. `Promise.allSettled`4. `Promise.any`5. ä½¿ç”¨ç¤ºä¾‹ äº”ã€å¦‚ä½•æ‰‹å†™ä¸€ä¸ªç®€å•çš„Promise1. å®ç°Promiseçš„åŸºæœ¬ç»“æ„2. å®ç°`then`æ–¹æ³•3. å®ç°`catch`æ–¹æ³•4. å®ç°`finally`æ–¹æ³•5. å®Œæ•´çš„Promiseå®ç° å…­ã€Promiseçš„å®é™…åº”ç”¨ç¤ºä¾‹1. å¼‚æ­¥æ•°æ®åŠ è½½2. å¤šä¸ªå¼‚æ­¥ä»»åŠ¡çš„å¹¶è¡Œå¤„ç†3. é¡ºåºæ‰§è¡Œå¤šä¸ªå¼‚æ­¥ä»»åŠ¡4. å¤„ç†å¹¶å‘çš„å¼‚æ­¥ä»»åŠ¡ ä¸ƒã€æ€»ç»“ ä¸€ã€å¼•è¨€ åœ¨ç°ä»£Webå¼€å‘ä¸­ï¼Œå¼‚æ­¥ç¼–ç¨‹æ˜¯ä¸å¯é¿å…çš„ã€‚æ— è®ºæ˜¯å‘èµ·ç½‘ç»œè¯·æ±‚ã€è¯»å–æ–‡ä»¶ã€å®šæ—¶æ“ä½œï¼Œè¿˜æ˜¯å¤„ç†äº‹ä»¶ï¼Œå¼‚æ­¥æ“ä½œéƒ½æ— å¤„ä¸åœ¨ã€‚è€Œåœ¨ä¼—å¤šå¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆä¸­ï¼ŒPromiseå› å…¶ç®€æ´æ˜“ç”¨ã€é“¾å¼è°ƒç”¨å’Œæ›´å¥½çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œæˆä¸ºäº†å¼€å‘è€…ä»¬çš„é¦–é€‰ã€‚
Promiseæ˜¯ä¸€ç§ç”¨äºå¤„ç†å¼‚æ­¥æ“ä½œçš„JavaScriptå¯¹è±¡ï¼Œå®ƒä»£è¡¨äº†ä¸€ä¸ªåœ¨æœªæ¥æŸä¸ªæ—¶é—´ç‚¹æ‰ä¼šå®Œæˆï¼ˆæˆ–å¤±è´¥ï¼‰çš„æ“ä½œåŠå…¶ç»“æœã€‚ç›¸æ¯”äºä¼ ç»Ÿçš„å›è°ƒå‡½æ•°ï¼ŒPromiseæä¾›äº†ä¸€ç§æ›´åŠ ä¼˜é›…å’Œä¾¿æ·çš„æ–¹å¼æ¥å¤„ç†å¼‚æ­¥ä»»åŠ¡ï¼Œä»è€Œé¿å…äº†â€œå›è°ƒåœ°ç‹±â€çš„é—®é¢˜ã€‚
æœ¬æ–‡å°†è¯¦ç»†è®²è§£Promiseçš„æ¦‚å¿µã€åŸºæœ¬ç”¨æ³•å’Œè¿›é˜¶ç”¨æ³•ï¼Œå¹¶æœ€ç»ˆæ‰‹å†™ä¸€ä¸ªç®€å•çš„Promiseå®ç°ã€‚é€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œè¯»è€…å°†ä¸ä»…èƒ½å¤Ÿæ·±å…¥ç†è§£Promiseçš„å·¥ä½œåŸç†ï¼Œè¿˜èƒ½å­¦ä¼šå¦‚ä½•åœ¨å®é™…é¡¹ç›®ä¸­æœ‰æ•ˆåœ°ä½¿ç”¨Promiseå¤„ç†å¼‚æ­¥æ“ä½œã€‚
äºŒã€Promiseæ¦‚è¿° 1. Promiseçš„å®šä¹‰ Promiseæ˜¯JavaScriptä¸­çš„ä¸€ç§å¯¹è±¡ï¼Œç”¨äºè¡¨ç¤ºä¸€ä¸ªåœ¨æœªæ¥æŸä¸ªæ—¶é—´ç‚¹æ‰ä¼šå®Œæˆï¼ˆæˆ–å¤±è´¥ï¼‰çš„å¼‚æ­¥æ“ä½œåŠå…¶ç»“æœã€‚å®ƒæä¾›äº†ä¸€ç§å¤„ç†å¼‚æ­¥æ“ä½œçš„ç»Ÿä¸€æ¥å£ï¼Œä½¿ä»£ç æ›´åŠ ç®€æ´å’Œæ˜“äºç†è§£ã€‚ä¸ä¼ ç»Ÿçš„å›è°ƒå‡½æ•°ç›¸æ¯”ï¼ŒPromiseèƒ½å¤Ÿæ›´å¥½åœ°å¤„ç†å¼‚æ­¥æ“ä½œçš„ç»“æœå’Œé”™è¯¯ã€‚
2. Promiseçš„ç”¨é€” Promiseå¹¿æ³›ç”¨äºå¤„ç†å„ç§å¼‚æ­¥æ“ä½œï¼Œç‰¹åˆ«æ˜¯åœ¨ä»¥ä¸‹åœºæ™¯ä¸­ï¼š
ç½‘ç»œè¯·æ±‚ï¼šä½¿ç”¨fetchæˆ–XMLHttpRequestè¿›è¡ŒAjaxè°ƒç”¨ã€‚æ–‡ä»¶æ“ä½œï¼šè¯»å–æ–‡ä»¶ã€å†™å…¥æ–‡ä»¶ç­‰I/Oæ“ä½œã€‚å®šæ—¶æ“ä½œï¼šä½¿ç”¨setTimeoutæˆ–setIntervalè¿›è¡Œå»¶æ—¶æ“ä½œã€‚äº‹ä»¶å¤„ç†ï¼šå¤„ç†ç”¨æˆ·äº‹ä»¶ï¼Œå¦‚ç‚¹å‡»ã€è¾“å…¥ç­‰ã€‚æ•°æ®åº“æ“ä½œï¼šæ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢ã€æ’å…¥ã€æ›´æ–°ç­‰æ“ä½œã€‚ é€šè¿‡ä½¿ç”¨Promiseï¼Œå¼€å‘è€…å¯ä»¥é¿å…åµŒå¥—çš„å›è°ƒå‡½æ•°ï¼ˆå³â€œå›è°ƒåœ°ç‹±â€ï¼‰ï¼Œä»è€Œä½¿ä»£ç æ›´åŠ çº¿æ€§å’Œæ˜“è¯»ã€‚
3. Promiseçš„ä¸‰ç§çŠ¶æ€ Promiseæœ‰ä¸‰ç§çŠ¶æ€ï¼š
Pendingï¼ˆå¾…å®šï¼‰ï¼šåˆå§‹çŠ¶æ€ï¼Œæ“ä½œå°šæœªå®Œæˆã€‚Fulfilledï¼ˆå·²å®Œæˆï¼‰ï¼šæ“ä½œæˆåŠŸå®Œæˆï¼Œå¹¶æœ‰ä¸€ä¸ªç»“æœå€¼ã€‚Rejectedï¼ˆå·²æ‹’ç»ï¼‰ï¼šæ“ä½œå¤±è´¥ï¼Œå¹¶æœ‰ä¸€ä¸ªå¤±è´¥åŸå› ã€‚ ä¸€ä¸ªPromiseå¯¹è±¡åªèƒ½ä»PendingçŠ¶æ€è½¬å˜ä¸ºFulfilledçŠ¶æ€æˆ–RejectedçŠ¶æ€ï¼Œå¹¶ä¸”çŠ¶æ€ä¸€æ—¦æ”¹å˜ï¼Œå°±ä¸èƒ½å†æ”¹å˜ã€‚è¿™ç§ä¸å¯å˜æ€§ä¿è¯äº†Promiseçš„å¯é æ€§å’Œå¯é¢„æµ‹æ€§ã€‚
4. Promiseçš„æ„é€ å‡½æ•°å’ŒåŸºç¡€ç»“æ„ åˆ›å»ºä¸€ä¸ªPromiseå®ä¾‹éœ€è¦ä¼ é€’ä¸€ä¸ªæ‰§è¡Œå‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šresolveå’Œrejectã€‚è¿™ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯å‡½æ•°ï¼Œç”¨äºå°†Promiseçš„çŠ¶æ€ä»Pendingå˜ä¸ºFulfilledæˆ–Rejectedã€‚
const promise = new Promise((resolve, reject) =&gt; { // å¼‚æ­¥æ“ä½œ if (æ“ä½œæˆåŠŸ) { resolve(æˆåŠŸçš„ç»“æœ); } else { reject(å¤±è´¥çš„åŸå› ); } }); åœ¨è¿™ä¸ªåŸºç¡€ç»“æ„ä¸­ï¼Œresolveå’Œrejectå‡½æ•°åˆ†åˆ«ç”¨äºå¤„ç†æ“ä½œæˆåŠŸå’Œå¤±è´¥çš„æƒ…å†µã€‚å½“å¼‚æ­¥æ“ä½œå®Œæˆæ—¶ï¼Œè°ƒç”¨resolveå°†Promiseçš„çŠ¶æ€å˜ä¸ºFulfilledï¼Œè°ƒç”¨rejectå°†çŠ¶æ€å˜ä¸ºRejectedã€‚">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-10T10:56:08+08:00">
    <meta property="article:modified_time" content="2024-07-10T10:56:08+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§å’–" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§å’–</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ã€JavaScriptã€‘æ·±å…¥ç†è§£Promiseï¼šä»åŸºç¡€æ¦‚å¿µåˆ°è¿›é˜¶ç”¨æ³•ã€æ‰‹å†™promise</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/97/dc/LTVvHe4X_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<center> 
 <strong><font color="red">ğŸ”¥ ä¸ªäººä¸»é¡µï¼š<a href="https://blog.csdn.net/m0_52827996?spm=1010.2135.3001.5343">ç©ºç™½è¯—</a></font></strong> 
</center> 
<p><img src="https://images2.imgbox.com/55/de/XYjQHFYs_o.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p></p> 
<div class="toc"> 
 <h4>æ–‡ç« ç›®å½•</h4> 
 <ul><li><ul><li><a href="#_11" rel="nofollow">ä¸€ã€å¼•è¨€</a></li><li><a href="#Promise_22" rel="nofollow">äºŒã€Promiseæ¦‚è¿°</a></li><li><ul><li><a href="#1_Promise_24" rel="nofollow">1. Promiseçš„å®šä¹‰</a></li><li><a href="#2_Promise_28" rel="nofollow">2. Promiseçš„ç”¨é€”</a></li><li><a href="#3_Promise_40" rel="nofollow">3. Promiseçš„ä¸‰ç§çŠ¶æ€</a></li><li><a href="#4_Promise_50" rel="nofollow">4. Promiseçš„æ„é€ å‡½æ•°å’ŒåŸºç¡€ç»“æ„</a></li><li><a href="#5_Promise_67" rel="nofollow">5. Promiseçš„ä¼˜ç‚¹</a></li><li><a href="#6_Promise_76" rel="nofollow">6. Promiseçš„å®ä¾‹æ–¹æ³•</a></li><li><a href="#7_Promise_97" rel="nofollow">7. Promiseçš„é™æ€æ–¹æ³•</a></li></ul> 
   </li><li><a href="#Promise_119" rel="nofollow">ä¸‰ã€Promiseçš„åŸºæœ¬ç”¨æ³•</a></li><li><ul><li><a href="#1_Promise_121" rel="nofollow">1. åˆ›å»ºä¸€ä¸ªPromise</a></li><li><a href="#2_then_136" rel="nofollow">2. `then`æ–¹æ³•</a></li><li><a href="#3_catch_151" rel="nofollow">3. `catch`æ–¹æ³•</a></li><li><a href="#4_finally_165" rel="nofollow">4. `finally`æ–¹æ³•</a></li><li><a href="#5__182" rel="nofollow">5. é“¾å¼è°ƒç”¨</a></li><li><a href="#6__200" rel="nofollow">6. ç¤ºä¾‹ä»£ç </a></li></ul> 
   </li><li><a href="#Promise_235" rel="nofollow">å››ã€Promiseçš„è¿›é˜¶ç”¨æ³•</a></li><li><ul><li><a href="#1_Promiseall_237" rel="nofollow">1. `Promise.all`</a></li><li><a href="#2_Promiserace_255" rel="nofollow">2. `Promise.race`</a></li><li><a href="#3_PromiseallSettled_275" rel="nofollow">3. `Promise.allSettled`</a></li><li><a href="#4_Promiseany_294" rel="nofollow">4. `Promise.any`</a></li><li><a href="#5__310" rel="nofollow">5. ä½¿ç”¨ç¤ºä¾‹</a></li></ul> 
   </li><li><a href="#Promise_367" rel="nofollow">äº”ã€å¦‚ä½•æ‰‹å†™ä¸€ä¸ªç®€å•çš„Promise</a></li><li><ul><li><a href="#1_Promise_371" rel="nofollow">1. å®ç°Promiseçš„åŸºæœ¬ç»“æ„</a></li><li><a href="#2_then_424" rel="nofollow">2. å®ç°`then`æ–¹æ³•</a></li><li><a href="#3_catch_482" rel="nofollow">3. å®ç°`catch`æ–¹æ³•</a></li><li><a href="#4_finally_507" rel="nofollow">4. å®ç°`finally`æ–¹æ³•</a></li><li><a href="#5_Promise_540" rel="nofollow">5. å®Œæ•´çš„Promiseå®ç°</a></li></ul> 
   </li><li><a href="#Promise_696" rel="nofollow">å…­ã€Promiseçš„å®é™…åº”ç”¨ç¤ºä¾‹</a></li><li><ul><li><a href="#1__698" rel="nofollow">1. å¼‚æ­¥æ•°æ®åŠ è½½</a></li><li><a href="#2__734" rel="nofollow">2. å¤šä¸ªå¼‚æ­¥ä»»åŠ¡çš„å¹¶è¡Œå¤„ç†</a></li><li><a href="#3__777" rel="nofollow">3. é¡ºåºæ‰§è¡Œå¤šä¸ªå¼‚æ­¥ä»»åŠ¡</a></li><li><a href="#4__828" rel="nofollow">4. å¤„ç†å¹¶å‘çš„å¼‚æ­¥ä»»åŠ¡</a></li></ul> 
   </li><li><a href="#_868" rel="nofollow">ä¸ƒã€æ€»ç»“</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<p><img src="https://images2.imgbox.com/0d/30/xZB9MkpR_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="_11"></a>ä¸€ã€å¼•è¨€</h3> 
<p>åœ¨ç°ä»£Webå¼€å‘ä¸­ï¼Œå¼‚æ­¥ç¼–ç¨‹æ˜¯ä¸å¯é¿å…çš„ã€‚æ— è®ºæ˜¯å‘èµ·ç½‘ç»œè¯·æ±‚ã€è¯»å–æ–‡ä»¶ã€å®šæ—¶æ“ä½œï¼Œè¿˜æ˜¯å¤„ç†äº‹ä»¶ï¼Œå¼‚æ­¥æ“ä½œéƒ½æ— å¤„ä¸åœ¨ã€‚è€Œåœ¨ä¼—å¤šå¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆä¸­ï¼ŒPromiseå› å…¶ç®€æ´æ˜“ç”¨ã€é“¾å¼è°ƒç”¨å’Œæ›´å¥½çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œæˆä¸ºäº†å¼€å‘è€…ä»¬çš„é¦–é€‰ã€‚</p> 
<p>Promiseæ˜¯ä¸€ç§ç”¨äºå¤„ç†å¼‚æ­¥æ“ä½œçš„JavaScriptå¯¹è±¡ï¼Œå®ƒä»£è¡¨äº†ä¸€ä¸ªåœ¨æœªæ¥æŸä¸ªæ—¶é—´ç‚¹æ‰ä¼šå®Œæˆï¼ˆæˆ–å¤±è´¥ï¼‰çš„æ“ä½œåŠå…¶ç»“æœã€‚ç›¸æ¯”äºä¼ ç»Ÿçš„å›è°ƒå‡½æ•°ï¼ŒPromiseæä¾›äº†ä¸€ç§æ›´åŠ ä¼˜é›…å’Œä¾¿æ·çš„æ–¹å¼æ¥å¤„ç†å¼‚æ­¥ä»»åŠ¡ï¼Œä»è€Œé¿å…äº†â€œå›è°ƒåœ°ç‹±â€çš„é—®é¢˜ã€‚</p> 
<p>æœ¬æ–‡å°†è¯¦ç»†è®²è§£Promiseçš„æ¦‚å¿µã€åŸºæœ¬ç”¨æ³•å’Œè¿›é˜¶ç”¨æ³•ï¼Œå¹¶æœ€ç»ˆæ‰‹å†™ä¸€ä¸ªç®€å•çš„Promiseå®ç°ã€‚é€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œè¯»è€…å°†ä¸ä»…èƒ½å¤Ÿæ·±å…¥ç†è§£Promiseçš„å·¥ä½œåŸç†ï¼Œè¿˜èƒ½å­¦ä¼šå¦‚ä½•åœ¨å®é™…é¡¹ç›®ä¸­æœ‰æ•ˆåœ°ä½¿ç”¨Promiseå¤„ç†å¼‚æ­¥æ“ä½œã€‚</p> 
<hr> 
<h3><a id="Promise_22"></a>äºŒã€Promiseæ¦‚è¿°</h3> 
<h4><a id="1_Promise_24"></a>1. Promiseçš„å®šä¹‰</h4> 
<p>Promiseæ˜¯JavaScriptä¸­çš„ä¸€ç§å¯¹è±¡ï¼Œç”¨äºè¡¨ç¤ºä¸€ä¸ªåœ¨æœªæ¥æŸä¸ªæ—¶é—´ç‚¹æ‰ä¼šå®Œæˆï¼ˆæˆ–å¤±è´¥ï¼‰çš„å¼‚æ­¥æ“ä½œåŠå…¶ç»“æœã€‚å®ƒæä¾›äº†ä¸€ç§å¤„ç†å¼‚æ­¥æ“ä½œçš„ç»Ÿä¸€æ¥å£ï¼Œä½¿ä»£ç æ›´åŠ ç®€æ´å’Œæ˜“äºç†è§£ã€‚ä¸ä¼ ç»Ÿçš„å›è°ƒå‡½æ•°ç›¸æ¯”ï¼ŒPromiseèƒ½å¤Ÿæ›´å¥½åœ°å¤„ç†å¼‚æ­¥æ“ä½œçš„ç»“æœå’Œé”™è¯¯ã€‚</p> 
<h4><a id="2_Promise_28"></a>2. Promiseçš„ç”¨é€”</h4> 
<p>Promiseå¹¿æ³›ç”¨äºå¤„ç†å„ç§å¼‚æ­¥æ“ä½œï¼Œç‰¹åˆ«æ˜¯åœ¨ä»¥ä¸‹åœºæ™¯ä¸­ï¼š</p> 
<ul><li><strong>ç½‘ç»œè¯·æ±‚</strong>ï¼šä½¿ç”¨<code>fetch</code>æˆ–<code>XMLHttpRequest</code>è¿›è¡ŒAjaxè°ƒç”¨ã€‚</li><li><strong>æ–‡ä»¶æ“ä½œ</strong>ï¼šè¯»å–æ–‡ä»¶ã€å†™å…¥æ–‡ä»¶ç­‰I/Oæ“ä½œã€‚</li><li><strong>å®šæ—¶æ“ä½œ</strong>ï¼šä½¿ç”¨<code>setTimeout</code>æˆ–<code>setInterval</code>è¿›è¡Œå»¶æ—¶æ“ä½œã€‚</li><li><strong>äº‹ä»¶å¤„ç†</strong>ï¼šå¤„ç†ç”¨æˆ·äº‹ä»¶ï¼Œå¦‚ç‚¹å‡»ã€è¾“å…¥ç­‰ã€‚</li><li><strong>æ•°æ®åº“æ“ä½œ</strong>ï¼šæ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢ã€æ’å…¥ã€æ›´æ–°ç­‰æ“ä½œã€‚</li></ul> 
<p>é€šè¿‡ä½¿ç”¨Promiseï¼Œå¼€å‘è€…å¯ä»¥é¿å…åµŒå¥—çš„å›è°ƒå‡½æ•°ï¼ˆå³â€œå›è°ƒåœ°ç‹±â€ï¼‰ï¼Œä»è€Œä½¿ä»£ç æ›´åŠ çº¿æ€§å’Œæ˜“è¯»ã€‚</p> 
<h4><a id="3_Promise_40"></a>3. Promiseçš„ä¸‰ç§çŠ¶æ€</h4> 
<p>Promiseæœ‰ä¸‰ç§çŠ¶æ€ï¼š</p> 
<ol><li><strong>Pendingï¼ˆå¾…å®šï¼‰</strong>ï¼šåˆå§‹çŠ¶æ€ï¼Œæ“ä½œå°šæœªå®Œæˆã€‚</li><li><strong>Fulfilledï¼ˆå·²å®Œæˆï¼‰</strong>ï¼šæ“ä½œæˆåŠŸå®Œæˆï¼Œå¹¶æœ‰ä¸€ä¸ªç»“æœå€¼ã€‚</li><li><strong>Rejectedï¼ˆå·²æ‹’ç»ï¼‰</strong>ï¼šæ“ä½œå¤±è´¥ï¼Œå¹¶æœ‰ä¸€ä¸ªå¤±è´¥åŸå› ã€‚</li></ol> 
<p>ä¸€ä¸ªPromiseå¯¹è±¡åªèƒ½ä»PendingçŠ¶æ€è½¬å˜ä¸ºFulfilledçŠ¶æ€æˆ–RejectedçŠ¶æ€ï¼Œå¹¶ä¸”çŠ¶æ€ä¸€æ—¦æ”¹å˜ï¼Œå°±ä¸èƒ½å†æ”¹å˜ã€‚è¿™ç§ä¸å¯å˜æ€§ä¿è¯äº†Promiseçš„å¯é æ€§å’Œå¯é¢„æµ‹æ€§ã€‚</p> 
<h4><a id="4_Promise_50"></a>4. Promiseçš„æ„é€ å‡½æ•°å’ŒåŸºç¡€ç»“æ„</h4> 
<p>åˆ›å»ºä¸€ä¸ªPromiseå®ä¾‹éœ€è¦ä¼ é€’ä¸€ä¸ªæ‰§è¡Œå‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šresolveå’Œrejectã€‚è¿™ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯å‡½æ•°ï¼Œç”¨äºå°†Promiseçš„çŠ¶æ€ä»Pendingå˜ä¸ºFulfilledæˆ–Rejectedã€‚</p> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// å¼‚æ­¥æ“ä½œ</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>æ“ä½œæˆåŠŸ<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">resolve</span><span class="token punctuation">(</span>æˆåŠŸçš„ç»“æœ<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">reject</span><span class="token punctuation">(</span>å¤±è´¥çš„åŸå› <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>åœ¨è¿™ä¸ªåŸºç¡€ç»“æ„ä¸­ï¼Œ<code>resolve</code>å’Œ<code>reject</code>å‡½æ•°åˆ†åˆ«ç”¨äºå¤„ç†æ“ä½œæˆåŠŸå’Œå¤±è´¥çš„æƒ…å†µã€‚å½“å¼‚æ­¥æ“ä½œå®Œæˆæ—¶ï¼Œè°ƒç”¨<code>resolve</code>å°†Promiseçš„çŠ¶æ€å˜ä¸ºFulfilledï¼Œè°ƒç”¨<code>reject</code>å°†çŠ¶æ€å˜ä¸ºRejectedã€‚</p> 
<h4><a id="5_Promise_67"></a>5. Promiseçš„ä¼˜ç‚¹</h4> 
<p>Promiseå…·æœ‰ä»¥ä¸‹å‡ ä¸ªæ˜¾è‘—çš„ä¼˜ç‚¹ï¼š</p> 
<ul><li><strong>é“¾å¼è°ƒç”¨</strong>ï¼šå¯ä»¥é€šè¿‡é“¾å¼è°ƒç”¨<code>then</code>æ–¹æ³•æ¥å¤„ç†å¼‚æ­¥æ“ä½œçš„ç»“æœï¼Œä½¿ä»£ç æ›´åŠ ç®€æ´ã€‚</li><li><strong>é”™è¯¯å¤„ç†</strong>ï¼šé€šè¿‡<code>catch</code>æ–¹æ³•ç»Ÿä¸€å¤„ç†é”™è¯¯ï¼Œé¿å…äº†å¤šä¸ªå›è°ƒå‡½æ•°ä¸­é‡å¤çš„é”™è¯¯å¤„ç†ä»£ç ã€‚</li><li><strong>çŠ¶æ€ç®¡ç†</strong>ï¼šPromiseçš„çŠ¶æ€ä¸€æ—¦æ”¹å˜ï¼Œå°±ä¸èƒ½å†å˜ï¼Œè¿™ç§ä¸å¯å˜æ€§ä¿è¯äº†å¼‚æ­¥æ“ä½œç»“æœçš„å¯é æ€§ã€‚</li><li><strong>ç»„åˆæ“ä½œ</strong>ï¼šPromiseæä¾›äº†å¤šç§ç»„åˆæ–¹æ³•ï¼Œå¦‚<code>Promise.all</code>ã€<code>Promise.race</code>ã€<code>Promise.allSettled</code>ã€<code>Promise.any</code>ï¼Œä½¿å¾—å¤„ç†å¤šä¸ªå¼‚æ­¥æ“ä½œå˜å¾—æ›´åŠ æ–¹ä¾¿ã€‚</li></ul> 
<h4><a id="6_Promise_76"></a>6. Promiseçš„å®ä¾‹æ–¹æ³•</h4> 
<ul><li><strong><code>then</code>æ–¹æ³•</strong>ï¼šç”¨äºåœ¨PromiseçŠ¶æ€å˜ä¸º<code>Fulfilled</code>æ—¶ï¼Œæ‰§è¡ŒæŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„Promiseå®ä¾‹ã€‚</li><li><strong><code>catch</code>æ–¹æ³•</strong>ï¼šç”¨äºåœ¨PromiseçŠ¶æ€å˜ä¸º<code>Rejected</code>æ—¶ï¼Œæ‰§è¡ŒæŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„Promiseå®ä¾‹ã€‚</li><li><strong><code>finally</code>æ–¹æ³•</strong>ï¼šç”¨äºåœ¨PromiseçŠ¶æ€å˜ä¸º<code>Fulfilled</code>æˆ–<code>Rejected</code>æ—¶ï¼Œæ‰§è¡ŒæŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„Promiseå®ä¾‹ã€‚</li></ul> 
<pre><code class="prism language-javascript">promise
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// å¤„ç†æˆåŠŸç»“æœ</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// å¤„ç†é”™è¯¯</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// æ— è®ºæˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œéƒ½ä¼šæ‰§è¡Œçš„æ“ä½œ</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>é€šè¿‡è¿™äº›å®ä¾‹æ–¹æ³•ï¼Œå¼€å‘è€…å¯ä»¥çµæ´»åœ°å¤„ç†å¼‚æ­¥æ“ä½œçš„ç»“æœå’Œé”™è¯¯ï¼Œå¹¶æ‰§è¡Œæœ€ç»ˆçš„æ¸…ç†æ“ä½œã€‚</p> 
<h4><a id="7_Promise_97"></a>7. Promiseçš„é™æ€æ–¹æ³•</h4> 
<table><thead><tr><th>æ–¹æ³•å</th><th>æè¿°</th><th>ç¤ºä¾‹ä»£ç </th></tr></thead><tbody><tr><td><code>Promise.resolve</code></td><td>è¿”å›ä¸€ä¸ªçŠ¶æ€ä¸º<code>Fulfilled</code>çš„Promiseå®ä¾‹ã€‚</td><td><code>Promise.resolve(42).then(value =&gt; console.log(value));</code></td></tr><tr><td><code>Promise.reject</code></td><td>è¿”å›ä¸€ä¸ªçŠ¶æ€ä¸º<code>Rejected</code>çš„Promiseå®ä¾‹ã€‚</td><td><code>Promise.reject(new Error('Error')).catch(error =&gt; console.error(error));</code></td></tr><tr><td><code>Promise.all</code></td><td>æ¥å—ä¸€ä¸ªPromiseæ•°ç»„ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„Promiseå®ä¾‹ã€‚å½“æ‰€æœ‰Promiseéƒ½å˜ä¸º<code>Fulfilled</code>æ—¶ï¼ŒçŠ¶æ€å˜ä¸º<code>Fulfilled</code>ï¼›å¦‚æœæœ‰ä»»ä½•ä¸€ä¸ªPromiseå˜ä¸º<code>Rejected</code>ï¼ŒçŠ¶æ€å˜ä¸º<code>Rejected</code>ã€‚</td><td><code>Promise.all([promise1, promise2]).then(values =&gt; console.log(values)).catch(error =&gt; console.error(error));</code></td></tr><tr><td><code>Promise.race</code></td><td>æ¥å—ä¸€ä¸ªPromiseæ•°ç»„ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„Promiseå®ä¾‹ã€‚å½“ç¬¬ä¸€ä¸ªPromiseå˜ä¸º<code>Fulfilled</code>æˆ–<code>Rejected</code>æ—¶ï¼ŒçŠ¶æ€ç«‹å³å˜ä¸º<code>Fulfilled</code>æˆ–<code>Rejected</code>ã€‚</td><td><code>Promise.race([promise1, promise2]).then(value =&gt; console.log(value)).catch(error =&gt; console.error(error));</code></td></tr><tr><td><code>Promise.allSettled</code></td><td>æ¥å—ä¸€ä¸ªPromiseæ•°ç»„ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„Promiseå®ä¾‹ã€‚å½“æ‰€æœ‰Promiseéƒ½å˜ä¸º<code>Fulfilled</code>æˆ–<code>Rejected</code>æ—¶ï¼ŒçŠ¶æ€å˜ä¸º<code>Fulfilled</code>ã€‚</td><td><code>Promise.allSettled([promise1, promise2]).then(results =&gt; console.log(results));</code></td></tr><tr><td><code>Promise.any</code></td><td>æ¥å—ä¸€ä¸ªPromiseæ•°ç»„ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„Promiseå®ä¾‹ã€‚å½“ä»»æ„ä¸€ä¸ªPromiseå˜ä¸º<code>Fulfilled</code>æ—¶ï¼ŒçŠ¶æ€å˜ä¸º<code>Fulfilled</code>ï¼›å¦‚æœæ‰€æœ‰Promiseéƒ½å˜ä¸º<code>Rejected</code>ï¼ŒçŠ¶æ€å˜ä¸º<code>Rejected</code>ã€‚</td><td><code>Promise.any([promise1, promise2]).then(value =&gt; console.log(value)).catch(error =&gt; console.error(error));</code></td></tr></tbody></table> 
<p>è¿™äº›é™æ€æ–¹æ³•ä¸ºå¤„ç†å¤šä¸ªå¼‚æ­¥æ“ä½œæä¾›äº†å¼ºå¤§çš„å·¥å…·ï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥æ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ–¹æ³•æ¥ç»„åˆPromiseã€‚</p> 
<p>ç»¼ä¸Šæ‰€è¿°ï¼ŒPromiseæä¾›äº†ä¸€ç§ç®€æ´ã€é«˜æ•ˆã€å¯ç»´æŠ¤çš„æ–¹å¼æ¥å¤„ç†å¼‚æ­¥æ“ä½œï¼Œä½¿å¾—JavaScriptçš„å¼‚æ­¥ç¼–ç¨‹å˜å¾—æ›´åŠ ä¾¿æ·å’Œå¼ºå¤§ã€‚</p> 
<hr> 
<h3><a id="Promise_119"></a>ä¸‰ã€Promiseçš„åŸºæœ¬ç”¨æ³•</h3> 
<h4><a id="1_Promise_121"></a>1. åˆ›å»ºä¸€ä¸ªPromise</h4> 
<p>åˆ›å»ºä¸€ä¸ªPromiseå®ä¾‹æ—¶ï¼Œéœ€è¦ä¼ é€’ä¸€ä¸ªæ‰§è¡Œå‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š<code>resolve</code>å’Œ<code>reject</code>ã€‚è¿™ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯å‡½æ•°ï¼Œç”¨äºå°†Promiseçš„çŠ¶æ€ä»Pendingå˜ä¸ºFulfilledæˆ–Rejectedã€‚</p> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// å¼‚æ­¥æ“ä½œ</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>æ“ä½œæˆåŠŸ<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">resolve</span><span class="token punctuation">(</span>æˆåŠŸçš„ç»“æœ<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">reject</span><span class="token punctuation">(</span>å¤±è´¥çš„åŸå› <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="2_then_136"></a>2. <code>then</code>æ–¹æ³•</h4> 
<p><code>then</code>æ–¹æ³•ç”¨äºåœ¨PromiseçŠ¶æ€å˜ä¸ºFulfilledæ—¶ï¼Œæ‰§è¡ŒæŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚å®ƒæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šç¬¬ä¸€ä¸ªæ˜¯å¤„ç†FulfilledçŠ¶æ€çš„å›è°ƒå‡½æ•°ï¼Œç¬¬äºŒä¸ªæ˜¯å¤„ç†RejectedçŠ¶æ€çš„å›è°ƒå‡½æ•°ï¼ˆå¯é€‰ï¼‰ã€‚</p> 
<pre><code class="prism language-javascript">promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
    <span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ“ä½œæˆåŠŸ:'</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'æ“ä½œå¤±è´¥:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="3_catch_151"></a>3. <code>catch</code>æ–¹æ³•</h4> 
<p><code>catch</code>æ–¹æ³•ç”¨äºåœ¨PromiseçŠ¶æ€å˜ä¸ºRejectedæ—¶ï¼Œæ‰§è¡ŒæŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚å®ƒæ˜¯<code>then</code>æ–¹æ³•çš„è¯­æ³•ç³–ï¼Œä¸“é—¨ç”¨äºå¤„ç†RejectedçŠ¶æ€ã€‚</p> 
<pre><code class="prism language-javascript">promise
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ“ä½œæˆåŠŸ:'</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'æ“ä½œå¤±è´¥:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="4_finally_165"></a>4. <code>finally</code>æ–¹æ³•</h4> 
<p><code>finally</code>æ–¹æ³•ç”¨äºåœ¨PromiseçŠ¶æ€å˜ä¸ºFulfilledæˆ–Rejectedæ—¶ï¼Œæ‰§è¡ŒæŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚æ— è®ºPromiseçš„æœ€ç»ˆçŠ¶æ€å¦‚ä½•ï¼Œ<code>finally</code>ä¸­çš„å›è°ƒå‡½æ•°éƒ½ä¼šæ‰§è¡Œã€‚</p> 
<pre><code class="prism language-javascript">promise
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ“ä½œæˆåŠŸ:'</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'æ“ä½œå¤±è´¥:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ“ä½œç»“æŸ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="5__182"></a>5. é“¾å¼è°ƒç”¨</h4> 
<p>Promiseæ”¯æŒé“¾å¼è°ƒç”¨ï¼Œè¿™æ„å‘³ç€å¯ä»¥åœ¨ä¸€ä¸ª<code>then</code>æ–¹æ³•ä¹‹åç»§ç»­è°ƒç”¨å¦ä¸€ä¸ª<code>then</code>æ–¹æ³•ã€‚è¿™ä½¿å¾—å¤„ç†å¤šä¸ªå¼‚æ­¥æ“ä½œå˜å¾—æ›´åŠ æ–¹ä¾¿ã€‚</p> 
<pre><code class="prism language-javascript">promise
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ç¬¬ä¸€æ¬¡æ“ä½œæˆåŠŸ:'</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> å¦ä¸€ä¸ªPromise<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ç¬¬äºŒæ¬¡æ“ä½œæˆåŠŸ:'</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'æ“ä½œå¤±è´¥:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="6__200"></a>6. ç¤ºä¾‹ä»£ç </h4> 
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹ä»£ç ï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ›å»ºä¸€ä¸ªPromiseå¹¶ä½¿ç”¨<code>then</code>ã€<code>catch</code>å’Œ<code>finally</code>æ–¹æ³•æ¥å¤„ç†å¼‚æ­¥æ“ä½œçš„ç»“æœå’Œé”™è¯¯ã€‚</p> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">asyncOperation</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">const</span> success <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0.5</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>success<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'æ“ä½œæˆåŠŸ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                <span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'æ“ä½œå¤±è´¥'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">asyncOperation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ“ä½œç»“æŸ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œ<code>asyncOperation</code>å‡½æ•°è¿”å›ä¸€ä¸ªPromiseï¼Œå®ƒæ¨¡æ‹Ÿäº†ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œå¹¶åœ¨1ç§’é’Ÿåæ ¹æ®éšæœºæ•°å†³å®šæ“ä½œæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ã€‚<code>then</code>ã€<code>catch</code>å’Œ<code>finally</code>æ–¹æ³•åˆ†åˆ«ç”¨äºå¤„ç†æ“ä½œçš„æˆåŠŸç»“æœã€é”™è¯¯å’Œæœ€ç»ˆçš„æ¸…ç†å·¥ä½œã€‚</p> 
<hr> 
<h3><a id="Promise_235"></a>å››ã€Promiseçš„è¿›é˜¶ç”¨æ³•</h3> 
<h4><a id="1_Promiseall_237"></a>1. <code>Promise.all</code></h4> 
<p><code>Promise.all</code>æ¥å—ä¸€ä¸ªPromiseæ•°ç»„ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„Promiseå®ä¾‹ã€‚å½“æ‰€æœ‰Promiseéƒ½å˜ä¸ºFulfilledæ—¶ï¼Œæ–°Promiseçš„çŠ¶æ€å˜ä¸ºFulfilledï¼Œå¹¶ä¸”å®ƒçš„ç»“æœæ˜¯ä¸€ä¸ªåŒ…å«æ‰€æœ‰Promiseç»“æœçš„æ•°ç»„ï¼›å¦‚æœæœ‰ä»»ä½•ä¸€ä¸ªPromiseå˜ä¸ºRejectedï¼Œæ–°Promiseçš„çŠ¶æ€å˜ä¸ºRejectedï¼Œå¹¶ä¸”å®ƒçš„ç»“æœæ˜¯ç¬¬ä¸€ä¸ªè¢«æ‹’ç»çš„Promiseçš„åŸå› ã€‚</p> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> promise1 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> promise2 <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> promise3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>promise1<span class="token punctuation">,</span> promise2<span class="token punctuation">,</span> promise3<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">values</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [3, 42, "foo"]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="2_Promiserace_255"></a>2. <code>Promise.race</code></h4> 
<p><code>Promise.race</code>æ¥å—ä¸€ä¸ªPromiseæ•°ç»„ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„Promiseå®ä¾‹ã€‚å½“ç¬¬ä¸€ä¸ªPromiseå˜ä¸ºFulfilledæˆ–Rejectedæ—¶ï¼Œæ–°Promiseçš„çŠ¶æ€ç«‹å³å˜ä¸ºFulfilledæˆ–Rejectedï¼Œå…¶ç»“æœå°±æ˜¯ç¬¬ä¸€ä¸ªå®Œæˆçš„Promiseçš„ç»“æœã€‚</p> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> promise1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token string">'one'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> promise2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Promise<span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span>promise1<span class="token punctuation">,</span> promise2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "two"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="3_PromiseallSettled_275"></a>3. <code>Promise.allSettled</code></h4> 
<p><code>Promise.allSettled</code>æ¥å—ä¸€ä¸ªPromiseæ•°ç»„ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„Promiseå®ä¾‹ã€‚å½“æ‰€æœ‰Promiseéƒ½å˜ä¸ºFulfilledæˆ–Rejectedæ—¶ï¼Œæ–°Promiseçš„çŠ¶æ€å˜ä¸ºFulfilledï¼Œå¹¶ä¸”å®ƒçš„ç»“æœæ˜¯ä¸€ä¸ªå¯¹è±¡æ•°ç»„ï¼Œæ¯ä¸ªå¯¹è±¡è¡¨ç¤ºå¯¹åº”çš„Promiseçš„çŠ¶æ€å’Œç»“æœæˆ–åŸå› ã€‚</p> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> promise1 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'æˆåŠŸ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> promise2 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'å¤±è´¥'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Promise<span class="token punctuation">.</span><span class="token function">allSettled</span><span class="token punctuation">(</span><span class="token punctuation">[</span>promise1<span class="token punctuation">,</span> promise2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">results</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    results<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token string">'fulfilled'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æˆåŠŸ:'</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å¤±è´¥:'</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="4_Promiseany_294"></a>4. <code>Promise.any</code></h4> 
<p><code>Promise.any</code>æ¥å—ä¸€ä¸ªPromiseæ•°ç»„ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„Promiseå®ä¾‹ã€‚å½“ä»»æ„ä¸€ä¸ªPromiseå˜ä¸ºFulfilledæ—¶ï¼Œæ–°Promiseçš„çŠ¶æ€å˜ä¸ºFulfilledï¼Œå¹¶ä¸”å®ƒçš„ç»“æœå°±æ˜¯ç¬¬ä¸€ä¸ªæˆåŠŸçš„Promiseçš„ç»“æœï¼›å¦‚æœæ‰€æœ‰Promiseéƒ½å˜ä¸ºRejectedï¼Œæ–°Promiseçš„çŠ¶æ€å˜ä¸ºRejectedï¼Œå¹¶ä¸”å®ƒçš„ç»“æœæ˜¯ä¸€ä¸ªåŒ…å«æ‰€æœ‰è¢«æ‹’ç»åŸå› çš„AggregateErrorå¯¹è±¡ã€‚</p> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> promise1 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'å¤±è´¥1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> promise2 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'å¤±è´¥2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> promise3 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'æˆåŠŸ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Promise<span class="token punctuation">.</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">[</span>promise1<span class="token punctuation">,</span> promise2<span class="token punctuation">,</span> promise3<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "æˆåŠŸ"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// AggregateError: All promises were rejected</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="5__310"></a>5. ä½¿ç”¨ç¤ºä¾‹</h4> 
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç»¼åˆç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>Promise.all</code>ã€<code>Promise.race</code>ã€<code>Promise.allSettled</code>å’Œ<code>Promise.any</code>å¤„ç†å¤šä¸ªå¼‚æ­¥æ“ä½œã€‚</p> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> fetchData1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token string">'æ•°æ®1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> fetchData2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">,</span> <span class="token string">'æ•°æ®2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> fetchData3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>reject<span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">,</span> <span class="token string">'æ•°æ®3å¤±è´¥'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨Promise.all</span>
Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>fetchData1<span class="token punctuation">,</span> fetchData2<span class="token punctuation">,</span> fetchData3<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">values</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Promise.allç»“æœ:'</span><span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Promise.allé”™è¯¯:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨Promise.race</span>
Promise<span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span>fetchData1<span class="token punctuation">,</span> fetchData2<span class="token punctuation">,</span> fetchData3<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Promise.raceç»“æœ:'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Promise.raceé”™è¯¯:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨Promise.allSettled</span>
Promise<span class="token punctuation">.</span><span class="token function">allSettled</span><span class="token punctuation">(</span><span class="token punctuation">[</span>fetchData1<span class="token punctuation">,</span> fetchData2<span class="token punctuation">,</span> fetchData3<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">results</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Promise.allSettledç»“æœ:'</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨Promise.any</span>
Promise<span class="token punctuation">.</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">[</span>fetchData1<span class="token punctuation">,</span> fetchData2<span class="token punctuation">,</span> fetchData3<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Promise.anyç»“æœ:'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Promise.anyé”™è¯¯:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ä¸åŒçš„Promiseé™æ€æ–¹æ³•æ¥å¤„ç†å¤šä¸ªå¼‚æ­¥æ“ä½œã€‚<code>fetchData1</code>ã€<code>fetchData2</code>å’Œ<code>fetchData3</code>æ˜¯ä¸‰ä¸ªæ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œçš„Promiseï¼Œé€šè¿‡ä¸åŒçš„æ–¹æ³•ç»„åˆæ¥å±•ç¤ºå®ƒä»¬çš„ç»“æœå’Œé”™è¯¯å¤„ç†ã€‚</p> 
<hr> 
<h3><a id="Promise_367"></a>äº”ã€å¦‚ä½•æ‰‹å†™ä¸€ä¸ªç®€å•çš„Promise</h3> 
<p>ä¸ºäº†æ›´æ·±å…¥ç†è§£Promiseçš„å·¥ä½œåŸç†ï¼Œæˆ‘ä»¬å°†æ‰‹å†™ä¸€ä¸ªç®€å•çš„Promiseå®ç°ï¼Œæ¶µç›–Promiseçš„åŸºæœ¬åŠŸèƒ½ï¼ŒåŒ…æ‹¬çŠ¶æ€ç®¡ç†ã€<code>then</code>æ–¹æ³•ã€<code>catch</code>æ–¹æ³•å’Œ<code>finally</code>æ–¹æ³•ã€‚</p> 
<h4><a id="1_Promise_371"></a>1. å®ç°Promiseçš„åŸºæœ¬ç»“æ„</h4> 
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰Promiseçš„ä¸‰ç§çŠ¶æ€ï¼š<code>Pending</code>ã€<code>Fulfilled</code>å’Œ<code>Rejected</code>ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªPromiseç±»ï¼Œå¹¶åœ¨æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–çŠ¶æ€å’Œç»“æœã€‚</p> 
<pre><code class="prism language-javascript"><span class="token keyword">class</span> <span class="token class-name">MyPromise</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// å®šä¹‰é™æ€å¸¸é‡ï¼Œè¡¨ç¤ºPromiseçš„ä¸‰ç§çŠ¶æ€</span>
    <span class="token keyword">static</span> <span class="token constant">PENDING</span> <span class="token operator">=</span> <span class="token string">'pending'</span><span class="token punctuation">;</span> <span class="token comment">// å¾…å®šæ€</span>
    <span class="token keyword">static</span> <span class="token constant">FULFILLED</span> <span class="token operator">=</span> <span class="token string">'fulfilled'</span><span class="token punctuation">;</span> <span class="token comment">// å·²å®Œæˆæ€</span>
    <span class="token keyword">static</span> <span class="token constant">REJECTED</span> <span class="token operator">=</span> <span class="token string">'rejected'</span><span class="token punctuation">;</span> <span class="token comment">// å·²æ‹’ç»æ€</span>

    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">executor</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> MyPromise<span class="token punctuation">.</span><span class="token constant">PENDING</span><span class="token punctuation">;</span> <span class="token comment">// åˆå§‹çŠ¶æ€ä¸ºå¾…å®šæ€</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>result <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// åˆå§‹ç»“æœå€¼ä¸ºnull</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>callbacks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// åˆå§‹å›è°ƒæ•°ç»„ä¸ºç©º</span>

        <span class="token comment">// å®šä¹‰ä¸€ä¸ªresolveå‡½æ•°ï¼Œç”¨äºå°†Promiseçš„çŠ¶æ€æ”¹ä¸ºå·²å®Œæˆæ€</span>
        <span class="token keyword">const</span> <span class="token function-variable function">resolve</span> <span class="token operator">=</span> <span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">===</span> MyPromise<span class="token punctuation">.</span><span class="token constant">PENDING</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> MyPromise<span class="token punctuation">.</span><span class="token constant">FULFILLED</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>result <span class="token operator">=</span> value<span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">callback</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                    callback<span class="token punctuation">.</span><span class="token function">onFulfilled</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">// å®šä¹‰ä¸€ä¸ªrejectå‡½æ•°ï¼Œç”¨äºå°†Promiseçš„çŠ¶æ€æ”¹ä¸ºå·²æ‹’ç»æ€</span>
        <span class="token keyword">const</span> <span class="token function-variable function">reject</span> <span class="token operator">=</span> <span class="token parameter">reason</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">===</span> MyPromise<span class="token punctuation">.</span><span class="token constant">PENDING</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> MyPromise<span class="token punctuation">.</span><span class="token constant">REJECTED</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>result <span class="token operator">=</span> reason<span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">callback</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                    callback<span class="token punctuation">.</span><span class="token function">onRejected</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">// å°è¯•æ‰§è¡Œexecutorå‡½æ•°ï¼Œå¹¶ä¼ å…¥resolveå’Œrejectä½œä¸ºå‚æ•°</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">executor</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// å¦‚æœexecutoræ‰§è¡Œè¿‡ç¨‹ä¸­æŠ›å‡ºé”™è¯¯ï¼Œåˆ™è°ƒç”¨rejectå‡½æ•°</span>
            <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ...then, catch, finally æ–¹æ³•å¾…å®ç°</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>è¿™æ®µä»£ç ä¸­ï¼Œ<code>MyPromise</code>ç±»æ¨¡æ‹Ÿäº†Promiseçš„åŸºæœ¬è¡Œä¸ºï¼ŒåŒ…æ‹¬åˆ›å»ºPromiseæ—¶ä¼ å…¥çš„executorå‡½æ•°ï¼Œä»¥åŠresolveå’Œrejectä¸¤ä¸ªå‡½æ•°ç”¨äºæ”¹å˜Promiseçš„çŠ¶æ€ã€‚åŒæ—¶ï¼Œè¿˜åŒ…å«äº†å¤„ç†executoræ‰§è¡Œè¿‡ç¨‹ä¸­å¯èƒ½æŠ›å‡ºçš„é”™è¯¯ã€‚</p> 
<h4><a id="2_then_424"></a>2. å®ç°<code>then</code>æ–¹æ³•</h4> 
<p><code>then</code>æ–¹æ³•ç”¨äºåœ¨PromiseçŠ¶æ€å˜ä¸ºFulfilledæˆ–Rejectedæ—¶ï¼Œæ‰§è¡ŒæŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚æˆ‘ä»¬éœ€è¦å¤„ç†åŒæ­¥å’Œå¼‚æ­¥æ‰§è¡Œçš„æƒ…å†µï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„Promiseã€‚</p> 
<pre><code class="prism language-javascript"><span class="token keyword">class</span> <span class="token class-name">MyPromise</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// ...constructor å’Œå…¶ä»–ä»£ç </span>

    <span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">onFulfilled<span class="token punctuation">,</span> onRejected</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„Promiseå®ä¾‹å¹¶è¿”å›</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MyPromise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// å®šä¹‰ä¸€ä¸ªå¤„ç†å›è°ƒçš„å‡½æ•°</span>
            <span class="token keyword">const</span> <span class="token function-variable function">handleCallback</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">callback<span class="token punctuation">,</span> state<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// æ‰§è¡Œç›¸åº”çš„å›è°ƒå‡½æ•°ï¼Œå¹¶è·å–å…¶è¿”å›å€¼</span>
                    <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token function">callback</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// å¦‚æœè¿”å›å€¼æ˜¯ä¸€ä¸ªPromiseå®ä¾‹ï¼Œåˆ™ç­‰å¾…å…¶è§£å†³æˆ–æ‹’ç»</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token keyword">instanceof</span> <span class="token class-name">MyPromise</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        value<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token comment">// å¦‚æœè¿”å›å€¼ä¸æ˜¯Promiseï¼Œåˆ™ç›´æ¥è§£å†³æ–°çš„Promise</span>
                        <span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// å¦‚æœæ‰§è¡Œå›è°ƒå‡½æ•°æ—¶æŠ›å‡ºé”™è¯¯ï¼Œåˆ™æ‹’ç»æ–°çš„Promise</span>
                    <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>

            <span class="token comment">// æ ¹æ®å½“å‰Promiseçš„çŠ¶æ€ï¼Œæ‰§è¡Œç›¸åº”çš„å›è°ƒå‡½æ•°</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">===</span> MyPromise<span class="token punctuation">.</span><span class="token constant">FULFILLED</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// å¦‚æœå½“å‰Promiseå·²æˆåŠŸï¼Œåˆ™å¼‚æ­¥æ‰§è¡ŒonFulfilledå›è°ƒ</span>
                <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">handleCallback</span><span class="token punctuation">(</span>onFulfilled<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">===</span> MyPromise<span class="token punctuation">.</span><span class="token constant">REJECTED</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// å¦‚æœå½“å‰Promiseå·²å¤±è´¥ï¼Œåˆ™å¼‚æ­¥æ‰§è¡ŒonRejectedå›è°ƒ</span>
                <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">handleCallback</span><span class="token punctuation">(</span>onRejected<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// å¦‚æœå½“å‰Promiseè¿˜å¤„äºå¾…å®šçŠ¶æ€ï¼Œåˆ™å°†å›è°ƒå‡½æ•°ä¿å­˜åˆ°callbacksæ•°ç»„ä¸­</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                    <span class="token function-variable function">onFulfilled</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">handleCallback</span><span class="token punctuation">(</span>onFulfilled<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token function-variable function">onRejected</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">handleCallback</span><span class="token punctuation">(</span>onRejected<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ...catch, finally æ–¹æ³•å¾…å®ç°</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>åœ¨è¿™ä¸ªå®ç°ä¸­ï¼Œ<code>then</code>æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š<code>onFulfilled</code>å’Œ<code>onRejected</code>ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯PromiseæˆåŠŸå’Œå¤±è´¥æ—¶çš„å›è°ƒå‡½æ•°ã€‚<code>then</code>æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªæ–°çš„Promiseå®ä¾‹ã€‚</p> 
<p>å¦‚æœå½“å‰Promiseå·²ç»æˆåŠŸæˆ–å¤±è´¥ï¼Œ<code>then</code>æ–¹æ³•ä¼šå¼‚æ­¥æ‰§è¡Œç›¸åº”çš„å›è°ƒå‡½æ•°ï¼Œå¹¶æ ¹æ®å›è°ƒå‡½æ•°çš„è¿”å›å€¼æ¥è§£å†³æˆ–æ‹’ç»è¿”å›çš„æ–°çš„Promiseã€‚</p> 
<p>å¦‚æœå½“å‰Promiseè¿˜å¤„äºå¾…å®šçŠ¶æ€ï¼Œ<code>then</code>æ–¹æ³•ä¼šå°†å›è°ƒå‡½æ•°ä¿å­˜åˆ°<code>callbacks</code>æ•°ç»„ä¸­ï¼Œç­‰å¾…PromiseçŠ¶æ€æ”¹å˜æ—¶å†æ‰§è¡Œã€‚</p> 
<p>ä½¿ç”¨<code>setTimeout</code>æ˜¯ä¸ºäº†ç¡®ä¿å›è°ƒå‡½æ•°çš„æ‰§è¡Œæ˜¯å¼‚æ­¥çš„ï¼Œè¿™ç¬¦åˆPromiseçš„è§„èŒƒã€‚</p> 
<h4><a id="3_catch_482"></a>3. å®ç°<code>catch</code>æ–¹æ³•</h4> 
<p>åœ¨<code>MyPromise</code>ç±»ä¸­ï¼Œ<code>catch</code>æ–¹æ³•æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†Promiseè¢«æ‹’ç»ï¼ˆrejectedï¼‰æƒ…å†µçš„ä¾¿æ·æ–¹æ³•ã€‚å®ƒå®é™…ä¸Šæ˜¯å¯¹<code>then</code>æ–¹æ³•çš„ç®€åŒ–è°ƒç”¨ï¼Œåªå…³æ³¨æ‹’ç»æƒ…å†µçš„å›è°ƒå‡½æ•°ã€‚å› æ­¤å¯ä»¥è¯´ï¼š<code>catch</code>æ–¹æ³•æ˜¯<code>then</code>æ–¹æ³•çš„è¯­æ³•ç³–ï¼Œåªéœ€è°ƒç”¨<code>then</code>æ–¹æ³•å¹¶å°†<code>onRejected</code>ä½œä¸ºå‚æ•°ä¼ é€’ã€‚</p> 
<pre><code class="prism language-javascript"><span class="token keyword">class</span> <span class="token class-name">MyPromise</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// ...constructor, then method, å’Œå…¶ä»–ä»£ç </span>

    <span class="token keyword">catch</span><span class="token punctuation">(</span>onRejected<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// è°ƒç”¨this.thenæ–¹æ³•ï¼Œä¼ å…¥nullä½œä¸ºæˆåŠŸçš„å›è°ƒå‡½æ•°ï¼ˆå› ä¸ºä¸å…³å¿ƒæˆåŠŸæƒ…å†µï¼‰ï¼Œ</span>
        <span class="token comment">// å¹¶ä¼ å…¥onRejectedä½œä¸ºæ‹’ç»çš„å›è°ƒå‡½æ•°ã€‚</span>
        <span class="token comment">// ç„¶åè¿”å›this.thenæ–¹æ³•çš„ç»“æœï¼Œå®ƒæ˜¯ä¸€ä¸ªæ–°çš„Promiseå®ä¾‹ã€‚</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> onRejected<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ...finallyæ–¹æ³•å¾…å®ç°</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>åœ¨è¿™ä¸ªå®ç°ä¸­ï¼Œ<code>catch</code>æ–¹æ³•åªæ¥å—ä¸€ä¸ªå‚æ•°<code>onRejected</code>ï¼Œå®ƒæ˜¯Promiseè¢«æ‹’ç»æ—¶çš„å›è°ƒå‡½æ•°ã€‚<code>catch</code>æ–¹æ³•ä¼šè°ƒç”¨<code>then</code>æ–¹æ³•ï¼Œå¹¶ä¼ å…¥<code>null</code>ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆè¡¨ç¤ºä¸å…³å¿ƒPromiseæˆåŠŸçš„æƒ…å†µï¼‰ï¼Œç„¶åä¼ å…¥<code>onRejected</code>ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ã€‚æœ€åï¼Œ<code>catch</code>æ–¹æ³•ä¼šè¿”å›<code>then</code>æ–¹æ³•çš„ç»“æœï¼Œå³ä¸€ä¸ªæ–°çš„Promiseå®ä¾‹ã€‚</p> 
<p>è¿™æ ·ï¼Œå½“Promiseè¢«æ‹’ç»æ—¶ï¼Œ<code>catch</code>æ–¹æ³•æä¾›çš„<code>onRejected</code>å›è°ƒå‡½æ•°ä¼šè¢«è°ƒç”¨ï¼Œå¹¶ä¸”ä»»ä½•åœ¨<code>catch</code>æ–¹æ³•ä¸­è¿”å›çš„Promiseéƒ½ä¼šæˆä¸º<code>catch</code>æ–¹æ³•è¿”å›çš„Promiseçš„ç»“æœã€‚å¦‚æœ<code>onRejected</code>å›è°ƒå‡½æ•°æœ¬èº«è¿”å›ä¸€ä¸ªPromiseï¼Œé‚£ä¹ˆ<code>catch</code>æ–¹æ³•è¿”å›çš„Promiseå°†ä¼šç­‰å¾…è¿™ä¸ªè¿”å›çš„Promiseè§£å†³æˆ–æ‹’ç»ã€‚</p> 
<h4><a id="4_finally_507"></a>4. å®ç°<code>finally</code>æ–¹æ³•</h4> 
<p>åœ¨<code>MyPromise</code>ç±»ä¸­ï¼Œ<code>finally</code>æ–¹æ³•æ˜¯ä¸€ä¸ªç”¨äºæŒ‡å®šä¸è®ºPromiseæœ€ç»ˆæ˜¯fulfilledè¿˜æ˜¯rejectedï¼Œéƒ½ä¼šæ‰§è¡Œçš„æ“ä½œçš„æ–¹æ³•ã€‚å®ƒè¿”å›ä¸€ä¸ªPromiseã€‚</p> 
<pre><code class="prism language-javascript"><span class="token keyword">class</span> <span class="token class-name">MyPromise</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// ...constructor, then method, catch method, å’Œå…¶ä»–ä»£ç </span>

    <span class="token function">finally</span><span class="token punctuation">(</span>onFinally<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// è°ƒç”¨this.thenæ–¹æ³•ï¼Œä¼ å…¥ä¸¤ä¸ªå›è°ƒå‡½æ•°ï¼š</span>
        <span class="token comment">// ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°å¤„ç†fulfilledæƒ…å†µï¼Œè°ƒç”¨onFinally()å¹¶æ‰§è¡Œå®Œæ¯•åè¿”å›valueï¼›</span>
        <span class="token comment">// ç¬¬äºŒä¸ªå›è°ƒå‡½æ•°å¤„ç†rejectedæƒ…å†µï¼Œè°ƒç”¨onFinally()å¹¶æ‰§è¡Œå®Œæ¯•åæŠ›å‡ºreasonã€‚</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
            <span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// å½“PromiseæˆåŠŸè§£å†³æ—¶æ‰§è¡Œ</span>
                <span class="token function">onFinally</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‰§è¡Œfinallyä¸­çš„å›è°ƒå‡½æ•°</span>
                <span class="token keyword">return</span> value<span class="token punctuation">;</span> <span class="token comment">// è¿”å›åŸå§‹å€¼ï¼Œä»¥ä¾¿é“¾å¼è°ƒç”¨ä¸­çš„ä¸‹ä¸€ä¸ªthenå¯ä»¥ä½¿ç”¨</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token parameter">reason</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// å½“Promiseè¢«æ‹’ç»æ—¶æ‰§è¡Œ</span>
                <span class="token function">onFinally</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‰§è¡Œfinallyä¸­çš„å›è°ƒå‡½æ•°</span>
                <span class="token keyword">throw</span> reason<span class="token punctuation">;</span> <span class="token comment">// æŠ›å‡ºæ‹’ç»çš„åŸå› ï¼Œä»¥ä¾¿é“¾å¼è°ƒç”¨ä¸­çš„ä¸‹ä¸€ä¸ªcatchå¯ä»¥æ•è·</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>åœ¨è¿™ä¸ªå®ç°ä¸­ï¼Œ<code>finally</code>æ–¹æ³•æ¥å—ä¸€ä¸ªå‚æ•°<code>onFinally</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ²¡æœ‰å‚æ•°çš„å‡½æ•°ï¼Œè¡¨ç¤ºæ— è®ºPromiseæœ€ç»ˆçŠ¶æ€å¦‚ä½•éƒ½éœ€è¦æ‰§è¡Œçš„æ“ä½œã€‚<code>finally</code>æ–¹æ³•é€šè¿‡è°ƒç”¨<code>then</code>æ–¹æ³•æ¥å®ç°ï¼Œå®ƒä¼ å…¥ä¸¤ä¸ªå›è°ƒå‡½æ•°ï¼šä¸€ä¸ªç”¨äºå¤„ç†fulfilledæƒ…å†µï¼Œå¦ä¸€ä¸ªç”¨äºå¤„ç†rejectedæƒ…å†µã€‚åœ¨è¿™ä¸¤ä¸ªå›è°ƒå‡½æ•°ä¸­ï¼Œéƒ½æ‰§è¡Œäº†<code>onFinally()</code>ï¼Œä»¥ç¡®ä¿æ— è®ºPromiseçš„çŠ¶æ€å¦‚ä½•ï¼Œ<code>onFinally</code>éƒ½ä¼šè¢«è°ƒç”¨ã€‚ç„¶åï¼Œæ ¹æ®Promiseçš„çŠ¶æ€ï¼Œè¿”å›ç›¸åº”çš„å€¼æˆ–æŠ›å‡ºç›¸åº”çš„é”™è¯¯ã€‚</p> 
<p>è¿™æ ·ï¼Œä½¿ç”¨<code>finally</code>æ–¹æ³•å¯ä»¥è®©æˆ‘ä»¬åœ¨Promiseé“¾çš„æœ«å°¾æ·»åŠ ä¸€äº›æ¸…ç†æ“ä½œï¼Œæ¯”å¦‚å…³é—­æ–‡ä»¶ã€é‡Šæ”¾èµ„æºç­‰ï¼Œè€Œä¸ç”¨æ‹…å¿ƒè¿™äº›æ“ä½œä¼šå› ä¸ºPromiseçš„çŠ¶æ€è€Œæ”¹å˜ã€‚</p> 
<h4><a id="5_Promise_540"></a>5. å®Œæ•´çš„Promiseå®ç°</h4> 
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„Promiseå®ç°ï¼ŒåŒ…æ‹¬çŠ¶æ€ç®¡ç†ã€<code>then</code>ã€<code>catch</code>å’Œ<code>finally</code>æ–¹æ³•ã€‚</p> 
<pre><code class="prism language-javascript"><span class="token comment">// å®šä¹‰ä¸€ä¸ªç®€å•çš„Promiseç±»</span>
<span class="token keyword">class</span> <span class="token class-name">MyPromise</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// å®šä¹‰Promiseçš„ä¸‰ç§çŠ¶æ€å¸¸é‡</span>
    <span class="token keyword">static</span> <span class="token constant">PENDING</span> <span class="token operator">=</span> <span class="token string">'pending'</span><span class="token punctuation">;</span> <span class="token comment">// ç­‰å¾…çŠ¶æ€</span>
    <span class="token keyword">static</span> <span class="token constant">FULFILLED</span> <span class="token operator">=</span> <span class="token string">'fulfilled'</span><span class="token punctuation">;</span> <span class="token comment">// æˆåŠŸçŠ¶æ€</span>
    <span class="token keyword">static</span> <span class="token constant">REJECTED</span> <span class="token operator">=</span> <span class="token string">'rejected'</span><span class="token punctuation">;</span> <span class="token comment">// å¤±è´¥çŠ¶æ€</span>

    <span class="token comment">// æ„é€ å‡½æ•°ï¼Œexecutoræ˜¯æ‰§è¡Œå™¨å‡½æ•°ï¼Œæ¥æ”¶resolveå’Œrejectä¸¤ä¸ªå‚æ•°</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">executor</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> MyPromise<span class="token punctuation">.</span><span class="token constant">PENDING</span><span class="token punctuation">;</span> <span class="token comment">// åˆå§‹çŠ¶æ€ä¸ºpending</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>result <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// å­˜å‚¨Promiseçš„ç»“æœå€¼æˆ–åŸå› </span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>callbacks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// å­˜å‚¨æˆåŠŸå’Œå¤±è´¥çš„å›è°ƒå‡½æ•°</span>

        <span class="token comment">// å®šä¹‰resolveå‡½æ•°ï¼Œå°†PromiseçŠ¶æ€å˜ä¸ºæˆåŠŸ</span>
        <span class="token keyword">const</span> <span class="token function-variable function">resolve</span> <span class="token operator">=</span> <span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">===</span> MyPromise<span class="token punctuation">.</span><span class="token constant">PENDING</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// åªæœ‰åœ¨pendingçŠ¶æ€æ—¶æ‰èƒ½æ”¹å˜çŠ¶æ€</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> MyPromise<span class="token punctuation">.</span><span class="token constant">FULFILLED</span><span class="token punctuation">;</span> <span class="token comment">// å°†çŠ¶æ€å˜ä¸ºæˆåŠŸ</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>result <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token comment">// å­˜å‚¨æˆåŠŸçš„ç»“æœå€¼</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">callback</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// æ‰§è¡Œæ‰€æœ‰æˆåŠŸçš„å›è°ƒ</span>
                    callback<span class="token punctuation">.</span><span class="token function">onFulfilled</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">// å®šä¹‰rejectå‡½æ•°ï¼Œå°†PromiseçŠ¶æ€å˜ä¸ºå¤±è´¥</span>
        <span class="token keyword">const</span> <span class="token function-variable function">reject</span> <span class="token operator">=</span> <span class="token parameter">reason</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">===</span> MyPromise<span class="token punctuation">.</span><span class="token constant">PENDING</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// åªæœ‰åœ¨pendingçŠ¶æ€æ—¶æ‰èƒ½æ”¹å˜çŠ¶æ€</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> MyPromise<span class="token punctuation">.</span><span class="token constant">REJECTED</span><span class="token punctuation">;</span> <span class="token comment">// å°†çŠ¶æ€å˜ä¸ºå¤±è´¥</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>result <span class="token operator">=</span> reason<span class="token punctuation">;</span> <span class="token comment">// å­˜å‚¨å¤±è´¥çš„åŸå› </span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">callback</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// æ‰§è¡Œæ‰€æœ‰å¤±è´¥çš„å›è°ƒ</span>
                    callback<span class="token punctuation">.</span><span class="token function">onRejected</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">// æ‰§è¡Œä¼ å…¥çš„executorå‡½æ•°ï¼Œä¼ å…¥resolveå’Œrejectå‡½æ•°ï¼Œå¹¶æ•è·å¼‚å¸¸</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">executor</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¦‚æœexecutoræ‰§è¡Œè¿‡ç¨‹ä¸­æŠ›å‡ºå¼‚å¸¸ï¼Œç›´æ¥è°ƒç”¨reject</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// thenæ–¹æ³•ï¼Œæ¥æ”¶æˆåŠŸå’Œå¤±è´¥çš„å›è°ƒå‡½æ•°</span>
    <span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">onFulfilled<span class="token punctuation">,</span> onRejected</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// è¿”å›ä¸€ä¸ªæ–°çš„Promiseå®ä¾‹</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MyPromise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// å¤„ç†å›è°ƒå‡½æ•°çš„æ‰§è¡Œå’ŒçŠ¶æ€ä¼ é€’</span>
            <span class="token keyword">const</span> <span class="token function-variable function">handleCallback</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">callback<span class="token punctuation">,</span> state<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token function">callback</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‰§è¡Œå›è°ƒå‡½æ•°è·å–è¿”å›å€¼</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token keyword">instanceof</span> <span class="token class-name">MyPromise</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// å¦‚æœè¿”å›å€¼æ˜¯Promiseï¼Œç­‰å¾…å…¶çŠ¶æ€å˜åŒ–</span>
                        value<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¦åˆ™ç›´æ¥å°†è¿”å›å€¼ä½œä¸ºæ–°Promiseçš„æˆåŠŸç»“æœ</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ•è·å¼‚å¸¸å¹¶å°†å¼‚å¸¸ä½œä¸ºæ–°Promiseçš„å¤±è´¥ç»“æœ</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">===</span> MyPromise<span class="token punctuation">.</span><span class="token constant">FULFILLED</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// å¦‚æœå½“å‰Promiseå·²ç»æ˜¯fulfilledçŠ¶æ€ï¼Œå¼‚æ­¥æ‰§è¡ŒonFulfilledå›è°ƒ</span>
                <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">handleCallback</span><span class="token punctuation">(</span>onFulfilled<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">===</span> MyPromise<span class="token punctuation">.</span><span class="token constant">REJECTED</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// å¦‚æœå½“å‰Promiseå·²ç»æ˜¯rejectedçŠ¶æ€ï¼Œå¼‚æ­¥æ‰§è¡ŒonRejectedå›è°ƒ</span>
                <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">handleCallback</span><span class="token punctuation">(</span>onRejected<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// å¦‚æœå½“å‰Promiseä»å¤„äºpendingçŠ¶æ€ï¼Œå°†å›è°ƒå‡½æ•°å­˜å‚¨èµ·æ¥ç­‰å¾…æ‰§è¡Œ</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                    <span class="token function-variable function">onFulfilled</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">handleCallback</span><span class="token punctuation">(</span>onFulfilled<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token function-variable function">onRejected</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">handleCallback</span><span class="token punctuation">(</span>onRejected<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// catchæ–¹æ³•ï¼Œç”¨äºæ•è·Promiseé“¾ä¸­çš„é”™è¯¯ï¼Œç­‰åŒäºthen(null, onRejected)</span>
    <span class="token keyword">catch</span><span class="token punctuation">(</span>onRejected<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> onRejected<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// finallyæ–¹æ³•ï¼Œç”¨äºåœ¨Promiseæ‰§è¡Œç»“æŸåæ— è®ºç»“æœå¦‚ä½•éƒ½ä¼šæ‰§è¡Œçš„å›è°ƒ</span>
    <span class="token function">finally</span><span class="token punctuation">(</span>onFinally<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
            <span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                <span class="token function">onFinally</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‰§è¡Œfinallyå›è°ƒ</span>
                <span class="token keyword">return</span> value<span class="token punctuation">;</span> <span class="token comment">// ç»§ç»­ä¼ é€’æˆåŠŸçš„ç»“æœå€¼</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token parameter">reason</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                <span class="token function">onFinally</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‰§è¡Œfinallyå›è°ƒ</span>
                <span class="token keyword">throw</span> reason<span class="token punctuation">;</span> <span class="token comment">// ç»§ç»­ä¼ é€’å¤±è´¥çš„åŸå› </span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// ç¤ºä¾‹ç”¨æ³•</span>
<span class="token keyword">const</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyPromise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> random <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>random <span class="token operator">&lt;</span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'æˆåŠŸå€¼'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'å¤±è´¥åŸå› '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
    <span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æˆåŠŸ:'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">'å¤„ç†åçš„å€¼'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token parameter">reason</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'å¤±è´¥:'</span><span class="token punctuation">,</span> reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'å¤„ç†å¤±è´¥'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
    <span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å¤„ç†åçš„ç»“æœ:'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>
    <span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'æ•è·åˆ°çš„é”™è¯¯:'</span><span class="token punctuation">,</span> error<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">finally</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ— è®ºå¦‚ä½•éƒ½ä¼šæ‰§è¡Œçš„æ“ä½œ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>æˆåŠŸæƒ…å†µï¼š</p> 
<pre><code class="prism language-bash">æˆåŠŸ: æˆåŠŸå€¼
å¤„ç†åçš„ç»“æœ: å¤„ç†åçš„å€¼
æ— è®ºå¦‚ä½•éƒ½ä¼šæ‰§è¡Œçš„æ“ä½œ
</code></pre> 
<p>å¤±è´¥æƒ…å†µï¼š</p> 
<pre><code class="prism language-bash">å¤±è´¥: å¤±è´¥åŸå› 
æ•è·åˆ°çš„é”™è¯¯: callback is not a <span class="token keyword">function</span>
æ— è®ºå¦‚ä½•éƒ½ä¼šæ‰§è¡Œçš„æ“ä½œ
</code></pre> 
<p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ªç®€åŒ–ç‰ˆçš„Promiseï¼Œæ¶µç›–äº†Promiseçš„æ ¸å¿ƒåŠŸèƒ½ã€‚è¿™ä¸ªå®ç°å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç†è§£Promiseçš„å·¥ä½œåŸç†å’Œå¼‚æ­¥ç¼–ç¨‹çš„æœºåˆ¶ã€‚</p> 
<hr> 
<h3><a id="Promise_696"></a>å…­ã€Promiseçš„å®é™…åº”ç”¨ç¤ºä¾‹</h3> 
<h4><a id="1__698"></a>1. å¼‚æ­¥æ•°æ®åŠ è½½</h4> 
<p>Promiseå¸¸ç”¨äºå¤„ç†å¼‚æ­¥æ•°æ®åŠ è½½ï¼Œä¾‹å¦‚ä»æœåŠ¡å™¨è·å–æ•°æ®å¹¶åœ¨é¡µé¢ä¸Šå±•ç¤ºï¼š</p> 
<pre><code class="prism language-javascript"><span class="token comment">// å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºä»æœåŠ¡å™¨è·å–æ•°æ®</span>
<span class="token keyword">function</span> <span class="token function">fetchDataFromServer</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// ä½¿ç”¨fetch APIå‘é€è¯·æ±‚</span>
        <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// æ£€æŸ¥ç½‘ç»œå“åº”æ˜¯å¦æˆåŠŸ</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿”å›JSONæ•°æ®</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Network response was not ok.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ç½‘ç»œè¯·æ±‚é”™è¯¯å¤„ç†</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// å°†è·å–çš„æ•°æ®ä¼ é€’ç»™resolve</span>
            <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ•è·å¼‚å¸¸å¹¶ä¼ é€’ç»™reject</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="token function">fetchDataFromServer</span><span class="token punctuation">(</span><span class="token string">'https://api.example.com/data'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æˆåŠŸè·å–æ•°æ®:'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‰“å°æˆåŠŸè·å–çš„æ•°æ®</span>
        <span class="token comment">// åœ¨é¡µé¢ä¸Šå±•ç¤ºæ•°æ®</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'è·å–æ•°æ®å¤±è´¥:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‰“å°è·å–æ•°æ®å¤±è´¥çš„é”™è¯¯ä¿¡æ¯</span>
        <span class="token comment">// å¤„ç†é”™è¯¯æƒ…å†µ</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>è¿™æ®µä»£ç å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°<code>fetchDataFromServer</code>ï¼Œè¯¥å‡½æ•°æ¥æ”¶ä¸€ä¸ªURLä½œä¸ºå‚æ•°ï¼Œä½¿ç”¨<code>fetch</code> APIå¼‚æ­¥ä»è¯¥URLè·å–æ•°æ®ï¼Œå¹¶å°†è·å–çš„æ•°æ®è§£æä¸ºJSONæ ¼å¼ã€‚</p> 
<p>å¦‚æœæ•°æ®æˆåŠŸè·å–å¹¶è§£æï¼Œå‡½æ•°å°†é€šè¿‡Promiseçš„<code>resolve</code>æ–¹æ³•è¿”å›è¿™äº›æ•°æ®ï¼›å¦‚æœåœ¨è·å–æ•°æ®æˆ–è§£ææ•°æ®è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œå‡½æ•°å°†é€šè¿‡Promiseçš„<code>reject</code>æ–¹æ³•è¿”å›é”™è¯¯ä¿¡æ¯ã€‚è¿™æ ·ï¼Œè°ƒç”¨è€…å¯ä»¥ä½¿ç”¨<code>.then()</code>å’Œ<code>.catch()</code>æ–¹æ³•æ¥å¤„ç†æˆåŠŸè·å–æ•°æ®å’Œè·å–æ•°æ®å¤±è´¥çš„æƒ…å†µã€‚</p> 
<h4><a id="2__734"></a>2. å¤šä¸ªå¼‚æ­¥ä»»åŠ¡çš„å¹¶è¡Œå¤„ç†</h4> 
<p>Promise.allæ–¹æ³•ç”¨äºå¤„ç†å¤šä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆåè¿›è¡Œç»Ÿä¸€å¤„ç†ï¼š</p> 
<pre><code class="prism language-javascript"><span class="token comment">// å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œæ¨¡æ‹Ÿä»æœåŠ¡å™¨è·å–ç”¨æˆ·æ•°æ®</span>
<span class="token keyword">const</span> <span class="token function-variable function">fetchUsers</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token string">'Charlie'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ¨¡æ‹Ÿå¼‚æ­¥è·å–ç”¨æˆ·æ•°æ®</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œæ¨¡æ‹Ÿä»æœåŠ¡å™¨è·å–æ–‡ç« æ•°æ®</span>
<span class="token keyword">const</span> <span class="token function-variable function">fetchPosts</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Post 1'</span><span class="token punctuation">,</span> <span class="token string">'Post 2'</span><span class="token punctuation">,</span> <span class="token string">'Post 3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ¨¡æ‹Ÿå¼‚æ­¥è·å–æ–‡ç« æ•°æ®</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨Promise.allå¤„ç†å¤šä¸ªå¼‚æ­¥ä»»åŠ¡</span>
Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">fetchUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">fetchPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>users<span class="token punctuation">,</span> posts<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ‰€æœ‰æ•°æ®åŠ è½½å®Œæˆ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‰€æœ‰æ•°æ®åŠ è½½å®Œæˆ</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ç”¨æˆ·åˆ—è¡¨:'</span><span class="token punctuation">,</span> users<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‰“å°ç”¨æˆ·åˆ—è¡¨</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ–‡ç« åˆ—è¡¨:'</span><span class="token punctuation">,</span> posts<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‰“å°æ–‡ç« åˆ—è¡¨</span>
        <span class="token comment">// åœ¨é¡µé¢ä¸Šå±•ç¤ºç”¨æˆ·å’Œæ–‡ç« </span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'æ•°æ®åŠ è½½å¤±è´¥:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‰“å°æ•°æ®åŠ è½½å¤±è´¥çš„é”™è¯¯ä¿¡æ¯</span>
        <span class="token comment">// å¤„ç†é”™è¯¯æƒ…å†µ</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>è¿™æ®µä»£ç å®šä¹‰äº†ä¸¤ä¸ªå‡½æ•°<code>fetchUsers</code>å’Œ<code>fetchPosts</code>ï¼Œå®ƒä»¬åˆ†åˆ«æ¨¡æ‹Ÿä»æœåŠ¡å™¨å¼‚æ­¥è·å–ç”¨æˆ·æ•°æ®å’Œæ–‡ç« æ•°æ®ã€‚è¿™ä¸¤ä¸ªå‡½æ•°éƒ½è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨å¼‚æ­¥æ“ä½œå®Œæˆæ—¶è§£æã€‚</p> 
<p>ç„¶åï¼Œä»£ç ä½¿ç”¨<code>Promise.all</code>æ–¹æ³•æ¥å¹¶è¡Œæ‰§è¡Œ<code>fetchUsers</code>å’Œ<code>fetchPosts</code>è¿™ä¸¤ä¸ªå¼‚æ­¥ä»»åŠ¡ã€‚<code>Promise.all</code>æ¥æ”¶ä¸€ä¸ªPromiseæ•°ç»„ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡ã€‚è¿™ä¸ªæ–°çš„Promiseå¯¹è±¡ä¼šåœ¨æ‰€æœ‰ä¼ å…¥çš„Promiseéƒ½æˆåŠŸè§£æåè§£æï¼Œè§£æå€¼ä¸ºä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«æ‰€æœ‰ä¼ å…¥Promiseçš„è§£æå€¼ã€‚</p> 
<p>åœ¨<code>Promise.all</code>çš„<code>.then</code>å›è°ƒä¸­ï¼Œä»£ç å¤„ç†äº†æ‰€æœ‰å¼‚æ­¥ä»»åŠ¡æˆåŠŸå®Œæˆçš„æƒ…å†µã€‚å®ƒæ‰“å°å‡ºä¸€æ¡æ¶ˆæ¯è¡¨ç¤ºæ‰€æœ‰æ•°æ®å·²åŠ è½½å®Œæˆï¼Œå¹¶åˆ†åˆ«æ‰“å°å‡ºç”¨æˆ·åˆ—è¡¨å’Œæ–‡ç« åˆ—è¡¨ã€‚</p> 
<p>å¦‚æœä»»ä½•ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡å¤±è´¥ï¼Œ<code>Promise.all</code>è¿”å›çš„Promiseå¯¹è±¡ä¼šç«‹å³æ‹’ç»ï¼Œå¹¶å°†æ‹’ç»åŸå› ä¼ é€’ç»™<code>.catch</code>å›è°ƒã€‚åœ¨<code>.catch</code>å›è°ƒä¸­ï¼Œä»£ç å¤„ç†äº†æ•°æ®åŠ è½½å¤±è´¥çš„æƒ…å†µï¼Œå¹¶æ‰“å°å‡ºé”™è¯¯ä¿¡æ¯ã€‚</p> 
<p>æ€»çš„æ¥è¯´ï¼Œè¿™æ®µä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>Promise.all</code>æ¥å¹¶è¡Œå¤„ç†å¤šä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œå¹¶åœ¨æ‰€æœ‰ä»»åŠ¡éƒ½å®Œæˆåæˆ–ä»»ä½•ä¸€ä¸ªä»»åŠ¡å¤±è´¥æ—¶è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚</p> 
<h4><a id="3__777"></a>3. é¡ºåºæ‰§è¡Œå¤šä¸ªå¼‚æ­¥ä»»åŠ¡</h4> 
<p>Promiseå¯ä»¥é“¾å¼è°ƒç”¨ï¼Œå®ç°å¤šä¸ªå¼‚æ­¥ä»»åŠ¡çš„é¡ºåºæ‰§è¡Œï¼Œç¡®ä¿æ¯ä¸ªä»»åŠ¡åœ¨ä¸Šä¸€ä¸ªä»»åŠ¡å®Œæˆåå†æ‰§è¡Œï¼š</p> 
<pre><code class="prism language-javascript"><span class="token comment">// å®šä¹‰ä¸€ä¸ªæ¨¡æ‹Ÿæ‰§è¡Œä»»åŠ¡1çš„å‡½æ•°</span>
<span class="token keyword">const</span> <span class="token function-variable function">performTask1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ä»»åŠ¡1å®Œæˆ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‰“å°ä»»åŠ¡1å®Œæˆ</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'ä»»åŠ¡1ç»“æœ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å°†ä»»åŠ¡1çš„ç»“æœä¼ é€’ç»™resolve</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ¨¡æ‹Ÿå¼‚æ­¥æ‰§è¡Œä»»åŠ¡1</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// å®šä¹‰ä¸€ä¸ªæ¨¡æ‹Ÿæ‰§è¡Œä»»åŠ¡2çš„å‡½æ•°</span>
<span class="token keyword">const</span> <span class="token function-variable function">performTask2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ä»»åŠ¡2å®Œæˆ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‰“å°ä»»åŠ¡2å®Œæˆ</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'ä»»åŠ¡2ç»“æœ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å°†ä»»åŠ¡2çš„ç»“æœä¼ é€’ç»™resolve</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ¨¡æ‹Ÿå¼‚æ­¥æ‰§è¡Œä»»åŠ¡2</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// æ‰§è¡Œä»»åŠ¡1ï¼Œç„¶ååœ¨ä»»åŠ¡1å®Œæˆåæ‰§è¡Œä»»åŠ¡2</span>
<span class="token function">performTask1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ä»»åŠ¡1è¿”å›ç»“æœ:'</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‰“å°ä»»åŠ¡1è¿”å›çš„ç»“æœ</span>
        <span class="token keyword">return</span> <span class="token function">performTask2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿”å›æ‰§è¡Œä»»åŠ¡2çš„Promiseå¯¹è±¡</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ä»»åŠ¡2è¿”å›ç»“æœ:'</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‰“å°ä»»åŠ¡2è¿”å›çš„ç»“æœ</span>
        <span class="token comment">// ç»§ç»­æ‰§è¡Œåç»­ä»»åŠ¡</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'ä»»åŠ¡æ‰§è¡Œå‡ºé”™:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‰“å°ä»»åŠ¡æ‰§è¡Œå‡ºé”™çš„é”™è¯¯ä¿¡æ¯</span>
        <span class="token comment">// å¤„ç†é”™è¯¯æƒ…å†µ</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>è¿™æ®µä»£ç å®šä¹‰äº†ä¸¤ä¸ªå‡½æ•°<code>performTask1</code>å’Œ<code>performTask2</code>ï¼Œå®ƒä»¬åˆ†åˆ«æ¨¡æ‹Ÿå¼‚æ­¥æ‰§è¡Œä»»åŠ¡1å’Œä»»åŠ¡2ã€‚è¿™ä¸¤ä¸ªå‡½æ•°éƒ½è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨å¼‚æ­¥æ“ä½œå®Œæˆæ—¶è§£æï¼Œå¹¶ä¼ é€’ä»»åŠ¡çš„ç»“æœã€‚</p> 
<p>ç„¶åï¼Œä»£ç é€šè¿‡è°ƒç”¨<code>performTask1</code>å‡½æ•°å¼€å§‹æ‰§è¡Œä»»åŠ¡1ã€‚åœ¨ä»»åŠ¡1çš„Promiseè§£æåï¼Œ<code>.then</code>å›è°ƒè¢«è°ƒç”¨ï¼Œå¹¶æ¥æ”¶ä»»åŠ¡1çš„ç»“æœä½œä¸ºå‚æ•°ã€‚åœ¨è¿™ä¸ªå›è°ƒä¸­ï¼Œä»£ç æ‰“å°å‡ºä»»åŠ¡1çš„ç»“æœï¼Œå¹¶è¿”å›<code>performTask2</code>å‡½æ•°çš„è°ƒç”¨ç»“æœï¼Œè¿™æ˜¯ä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡ï¼Œä»£è¡¨ä»»åŠ¡2çš„æ‰§è¡Œã€‚</p> 
<p>å½“ä»»åŠ¡2çš„Promiseè§£æåï¼Œç¬¬äºŒä¸ª<code>.then</code>å›è°ƒè¢«è°ƒç”¨ï¼Œå¹¶æ¥æ”¶ä»»åŠ¡2çš„ç»“æœä½œä¸ºå‚æ•°ã€‚åœ¨è¿™ä¸ªå›è°ƒä¸­ï¼Œä»£ç æ‰“å°å‡ºä»»åŠ¡2çš„ç»“æœï¼Œå¹¶å¯ä»¥ç»§ç»­æ‰§è¡Œåç»­çš„ä»»åŠ¡ã€‚</p> 
<p>å¦‚æœä»»ä½•ä¸€ä¸ªä»»åŠ¡å¤±è´¥ï¼Œå³ä»»ä½•ä¸€ä¸ªPromiseè¢«æ‹’ç»ï¼Œ<code>.catch</code>å›è°ƒä¼šè¢«è°ƒç”¨ï¼Œå¹¶æ¥æ”¶æ‹’ç»åŸå› ä½œä¸ºå‚æ•°ã€‚åœ¨è¿™ä¸ªå›è°ƒä¸­ï¼Œä»£ç å¯ä»¥å¤„ç†é”™è¯¯æƒ…å†µï¼Œå¹¶æ‰“å°å‡ºé”™è¯¯ä¿¡æ¯ã€‚</p> 
<p>æ€»çš„æ¥è¯´ï¼Œè¿™æ®µä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨Promiseçš„é“¾å¼è°ƒç”¨æ¥é¡ºåºæ‰§è¡Œå¤šä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œå¹¶åœ¨æ¯ä¸ªä»»åŠ¡å®Œæˆåæˆ–ä»»ä½•ä¸€ä¸ªä»»åŠ¡å¤±è´¥æ—¶è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚è¿™ç§æ¨¡å¼åœ¨å®é™…å¼€å‘ä¸­éå¸¸æœ‰ç”¨ï¼Œç‰¹åˆ«æ˜¯å½“æ‚¨éœ€è¦æŒ‰é¡ºåºæ‰§è¡Œä¸€ç³»åˆ—å¼‚æ­¥æ“ä½œï¼Œå¹¶ä¸”æ¯ä¸ªæ“ä½œéƒ½ä¾èµ–äºå‰ä¸€ä¸ªæ“ä½œçš„ç»“æœæ—¶ã€‚</p> 
<h4><a id="4__828"></a>4. å¤„ç†å¹¶å‘çš„å¼‚æ­¥ä»»åŠ¡</h4> 
<p>Promise.raceæ–¹æ³•ç”¨äºå¤„ç†å¤šä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œåªå¤„ç†ç¬¬ä¸€ä¸ªå®Œæˆçš„ä»»åŠ¡ç»“æœï¼Œå¿½ç•¥å…¶ä½™çš„ä»»åŠ¡ï¼š</p> 
<pre><code class="prism language-javascript"><span class="token comment">// å®šä¹‰ä¸€ä¸ªæ¨¡æ‹Ÿæ‰§è¡Œä»»åŠ¡1çš„Promiseå¯¹è±¡</span>
<span class="token keyword">const</span> task1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'ä»»åŠ¡1å®Œæˆ'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ¨¡æ‹Ÿå¼‚æ­¥æ‰§è¡Œä»»åŠ¡1</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å®šä¹‰ä¸€ä¸ªæ¨¡æ‹Ÿæ‰§è¡Œä»»åŠ¡2çš„Promiseå¯¹è±¡</span>
<span class="token keyword">const</span> task2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'ä»»åŠ¡2å®Œæˆ'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ¨¡æ‹Ÿå¼‚æ­¥æ‰§è¡Œä»»åŠ¡2</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨Promise.raceå¤„ç†å¹¶å‘çš„å¼‚æ­¥ä»»åŠ¡</span>
Promise<span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span>task1<span class="token punctuation">,</span> task2<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ç¬¬ä¸€ä¸ªå®Œæˆçš„ä»»åŠ¡ç»“æœ:'</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‰“å°ç¬¬ä¸€ä¸ªå®Œæˆçš„ä»»åŠ¡ç»“æœ</span>
        <span class="token comment">// å¤„ç†ç¬¬ä¸€ä¸ªå®Œæˆçš„ä»»åŠ¡ç»“æœ</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'ä»»åŠ¡æ‰§è¡Œå‡ºé”™:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‰“å°ä»»åŠ¡æ‰§è¡Œå‡ºé”™çš„é”™è¯¯ä¿¡æ¯</span>
        <span class="token comment">// å¤„ç†é”™è¯¯æƒ…å†µ</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>è¿™æ®µä»£ç å®šä¹‰äº†ä¸¤ä¸ªPromiseå¯¹è±¡<code>task1</code>å’Œ<code>task2</code>ï¼Œå®ƒä»¬åˆ†åˆ«æ¨¡æ‹Ÿå¼‚æ­¥æ‰§è¡Œä»»åŠ¡1å’Œä»»åŠ¡2ã€‚<code>task1</code>å°†åœ¨1000æ¯«ç§’åè§£æï¼Œè€Œ<code>task2</code>å°†åœ¨500æ¯«ç§’åè§£æã€‚</p> 
<p>ç„¶åï¼Œä»£ç ä½¿ç”¨<code>Promise.race</code>æ–¹æ³•æ¥å¤„ç†è¿™ä¸¤ä¸ªå¹¶å‘çš„å¼‚æ­¥ä»»åŠ¡ã€‚ç”±äº<code>task2</code>çš„è§£ææ—¶é—´æ¯”<code>task1</code>çŸ­ï¼Œå› æ­¤<code>Promise.race</code>è¿”å›çš„Promiseå¯¹è±¡å°†åœ¨<code>task2</code>è§£ææ—¶è§£æã€‚</p> 
<p>åœ¨<code>Promise.race</code>çš„<code>.then</code>å›è°ƒä¸­ï¼Œä»£ç å¤„ç†äº†ç¬¬ä¸€ä¸ªå®Œæˆçš„ä»»åŠ¡çš„ç»“æœã€‚å®ƒæ‰“å°å‡ºç¬¬ä¸€ä¸ªå®Œæˆçš„ä»»åŠ¡çš„ç»“æœï¼Œå¹¶å¯ä»¥åœ¨è¿™é‡Œè¿›è¡Œè¿›ä¸€æ­¥çš„å¤„ç†ã€‚</p> 
<p>å¦‚æœä»»ä½•ä¸€ä¸ªä»»åŠ¡å¤±è´¥ï¼Œå³ä»»ä½•ä¸€ä¸ªPromiseè¢«æ‹’ç»ï¼Œ<code>Promise.race</code>è¿”å›çš„Promiseå¯¹è±¡ä¹Ÿä¼šè¢«æ‹’ç»ï¼Œå¹¶å°†æ‹’ç»åŸå› ä¼ é€’ç»™<code>.catch</code>å›è°ƒã€‚åœ¨è¿™ä¸ªå›è°ƒä¸­ï¼Œä»£ç å¯ä»¥å¤„ç†é”™è¯¯æƒ…å†µï¼Œå¹¶æ‰“å°å‡ºé”™è¯¯ä¿¡æ¯ã€‚</p> 
<p>æ€»çš„æ¥è¯´ï¼Œè¿™æ®µä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>Promise.race</code>æ¥å¤„ç†å¤šä¸ªå¹¶å‘çš„å¼‚æ­¥ä»»åŠ¡ï¼Œå¹¶åªå…³æ³¨ç¬¬ä¸€ä¸ªå®Œæˆçš„ä»»åŠ¡çš„ç»“æœã€‚è¿™ç§æ¨¡å¼åœ¨å®é™…å¼€å‘ä¸­éå¸¸æœ‰ç”¨ï¼Œç‰¹åˆ«æ˜¯å½“æ‚¨æœ‰å¤šä¸ªå¼‚æ­¥æ•°æ®æºï¼Œå¹¶ä¸”åªéœ€è¦ä»æœ€å¿«å“åº”çš„é‚£ä¸ªæ•°æ®æºè·å–ç»“æœæ—¶ã€‚</p> 
<hr> 
<h3><a id="_868"></a>ä¸ƒã€æ€»ç»“</h3> 
<p>Promiseä½œä¸ºJavaScriptä¸­å¤„ç†å¼‚æ­¥æ“ä½œçš„ä¸€ç§é‡è¦æœºåˆ¶ï¼Œæå¤§åœ°ç®€åŒ–äº†ä»£ç ç¼–å†™å’Œå¼‚æ­¥æµç¨‹æ§åˆ¶ã€‚åœ¨æœ¬ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æ·±å…¥æ¢è®¨äº†Promiseçš„æ ¸å¿ƒæ¦‚å¿µã€åŸºæœ¬ç”¨æ³•ã€è¿›é˜¶æŠ€å·§ä»¥åŠå¦‚ä½•æ‰‹å†™ä¸€ä¸ªç®€å•çš„Promiseï¼Œå¹¶é€šè¿‡å®é™…åº”ç”¨ç¤ºä¾‹å±•ç¤ºäº†Promiseåœ¨å¼€å‘ä¸­çš„å¼ºå¤§åŠŸèƒ½ã€‚</p> 
<ol><li> <p><strong>Promiseæ¦‚è¿°</strong>ï¼šPromiseæ˜¯JavaScriptå¼‚æ­¥ç¼–ç¨‹çš„æ ¸å¿ƒï¼Œæä¾›äº†ä¸€ç§æ›´æ¸…æ™°ã€æ›´ç›´è§‚çš„æ–¹å¼æ¥å¤„ç†å¼‚æ­¥æ“ä½œã€‚å®ƒå…·æœ‰ä¸‰ç§çŠ¶æ€ï¼š<code>Pending</code>ã€<code>Fulfilled</code>å’Œ<code>Rejected</code>ï¼Œå¹¶ä¸”ä¸€æ—¦çŠ¶æ€æ”¹å˜ï¼Œå°±ä¸ä¼šå†æ¬¡æ”¹å˜ã€‚</p> </li><li> <p><strong>Promiseçš„åŸºæœ¬ç”¨æ³•</strong>ï¼šé€šè¿‡Promiseå¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>then</code>æ–¹æ³•å¤„ç†æˆåŠŸçš„å¼‚æ­¥ç»“æœï¼Œä½¿ç”¨<code>catch</code>æ–¹æ³•å¤„ç†å¤±è´¥çš„å¼‚æ­¥ç»“æœï¼Œå¹¶ä½¿ç”¨<code>finally</code>æ–¹æ³•åœ¨Promiseç»“æŸæ—¶æ‰§è¡Œä¸€äº›æ¸…ç†æ“ä½œã€‚</p> </li><li> <p><strong>Promiseçš„è¿›é˜¶ç”¨æ³•</strong>ï¼šPromiseçš„é“¾å¼è°ƒç”¨å’Œé™æ€æ–¹æ³•ï¼ˆå¦‚<code>Promise.all</code>ã€<code>Promise.race</code>ç­‰ï¼‰è®©æˆ‘ä»¬èƒ½å¤Ÿæ›´åŠ çµæ´»åœ°å¤„ç†å¤šä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œæä¾›äº†å¹¶è¡Œå’Œé¡ºåºæ‰§è¡Œå¼‚æ­¥ä»»åŠ¡çš„è§£å†³æ–¹æ¡ˆã€‚</p> </li><li> <p><strong>æ‰‹å†™ä¸€ä¸ªç®€å•çš„Promise</strong>ï¼šé€šè¿‡æ‰‹å†™ä¸€ä¸ªç®€å•çš„Promiseå®ç°ï¼Œæˆ‘ä»¬æ›´åŠ æ·±å…¥åœ°ç†è§£äº†Promiseçš„å†…éƒ¨å·¥ä½œæœºåˆ¶ï¼ŒåŒ…æ‹¬çŠ¶æ€ç®¡ç†ã€å›è°ƒé˜Ÿåˆ—çš„å¤„ç†ä»¥åŠå¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œã€‚</p> </li><li> <p><strong>Promiseçš„å®é™…åº”ç”¨</strong>ï¼šåœ¨å®é™…å¼€å‘ä¸­ï¼ŒPromiseè¢«å¹¿æ³›åº”ç”¨äºå¼‚æ­¥æ•°æ®åŠ è½½ã€å¹¶è¡Œå¤„ç†å¤šä¸ªå¼‚æ­¥ä»»åŠ¡ã€é¡ºåºæ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ä»¥åŠå¤„ç†å¹¶å‘çš„å¼‚æ­¥ä»»åŠ¡ç­‰åœºæ™¯ï¼Œæå‡äº†ä»£ç çš„å¯è¯»æ€§å’Œç»´æŠ¤æ€§ã€‚</p> </li></ol> 
<p>æ€»çš„æ¥è¯´ï¼ŒæŒæ¡Promiseå¯¹äºç°ä»£JavaScriptå¼€å‘è€…æ¥è¯´è‡³å…³é‡è¦ã€‚å®ƒä¸ä»…å¸®åŠ©æˆ‘ä»¬è§£å†³äº†å›è°ƒåœ°ç‹±é—®é¢˜ï¼Œè¿˜è®©ä»£ç æ›´åŠ ç®€æ´å’Œæ˜“äºç†è§£ã€‚å¸Œæœ›é€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œä½ å¯¹Promiseæœ‰äº†æ›´åŠ å…¨é¢å’Œæ·±å…¥çš„ç†è§£ï¼Œå¹¶èƒ½å¤Ÿåœ¨å®é™…å¼€å‘ä¸­çµæ´»è¿ç”¨å®ƒæ¥ç¼–å†™é«˜è´¨é‡çš„å¼‚æ­¥ä»£ç ã€‚</p> 
<p><img src="https://images2.imgbox.com/ba/25/NgG6Mdqv_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f5710febe46f6b4499a681d00142f7e3/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">æœ€æ–°WiresharkæŸ¥çœ‹åŒ…ä¸­gzipå†…å®¹</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3856c203a71828ea634b9173a88d782b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">è§£å†³pythonå®‰è£…åŒ…â€œERROR: Could not install packages due to an OSErrorâ€é”™è¯¯</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§å’–.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>