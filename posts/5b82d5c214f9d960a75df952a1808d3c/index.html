<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Vue &#43; Element UI 前端篇（六）：更换皮肤主题 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/5b82d5c214f9d960a75df952a1808d3c/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Vue &#43; Element UI 前端篇（六）：更换皮肤主题">
  <meta property="og:description" content="自定义主题 命令行主题工具 1.安装主题工具 首先安装「主题生成工具」，可以全局安装或者安装在当前项目下，推荐安装在项目里，方便别人 clone 项目时能直接安装依赖并启动。
yarn add element-theme --dev 2.安装chalk主题 安装白垩主题，可以从 npm 安装或者从 GitHub 拉取最新代码，这里从 npm 安装。
yarn add element-theme-chalk -D 3.初始化变量文件 主题生成工具安装成功后，如果全局安装可以在命令行里通过 et 调用工具，如果安装在当前目录下，需要通过 node_modules/.bin/et 访问到命令。执行 -i 初始化变量文件。默认输出到 element-variables.scss，当然你可以传参数指定文件输出目录。
node_modules/.bin/et -i 执行命令
命令执行成功之后，会在根目录生成 scss文件 element-variables.scss 。
4、修改主题色 在 element-variables.scss 文件里修改 $–color-primary:#4b5f6e，即你想要的主题颜色
5、编译主题 执行主题编译命令生成主题，根目录会生成一个theme的文件夹 。
node_modules/.bin/et 6、引入自定义主题 把生成的主题按颜色改名放置 src/theme 目录下。
在 main.js 中 import ‘所在路径/index.css’。
7、效果展示 重新加载后，我们看到按钮颜色已经不是默认的蓝色了。
动态换肤器方式 1. 在下图位置添加封装的换肤组件。 index.vue
&lt;template&gt; &lt;el-color-picker class=&#34;theme-picker&#34; popper-class=&#34;theme-picker-dropdown&#34; v-model=&#34;theme&#34;&gt;&lt;/el-color-picker&gt; &lt;/template&gt; &lt;script&gt; const version = require(&#39;element-ui/package.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-09-05T17:20:48+08:00">
    <meta property="article:modified_time" content="2023-09-05T17:20:48+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Vue &#43; Element UI 前端篇（六）：更换皮肤主题</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>自定义主题</h3> 
<h4 id="ming-ling-xing-zhu-ti-gong-ju">命令行主题工具</h4> 
<h5>1.安装主题工具</h5> 
<p>首先安装「主题生成工具」，可以全局安装或者安装在当前项目下，推荐安装在项目里，方便别人 clone 项目时能直接安装依赖并启动。</p> 
<pre>yarn add element-theme --dev</pre> 
<h5>2.安装chalk主题</h5> 
<p>安装白垩主题，可以从 npm 安装或者从 GitHub 拉取最新代码，这里从 npm 安装。</p> 
<pre>yarn add element-theme-chalk -D</pre> 
<h5>3.初始化变量文件 </h5> 
<p>主题生成工具安装成功后，如果全局安装可以在命令行里通过 <code>et</code> 调用工具，如果安装在当前目录下，需要通过 <code>node_modules/.bin/et</code> 访问到命令。执行 <code>-i</code> 初始化变量文件。默认输出到 <code>element-variables.scss</code>，当然你可以传参数指定文件输出目录。</p> 
<pre>node_modules/.bin/et -i</pre> 
<p>执行命令</p> 
<p></p> 
<p class="img-center"><img alt="" height="71" src="https://images2.imgbox.com/59/c0/H2YKByWp_o.png" width="399"></p> 
<p>命令执行成功之后，会在根目录生成 scss文件 element-variables.scss 。</p> 
<p> </p> 
<p class="img-center"><img alt="" height="272" src="https://images2.imgbox.com/b6/4c/8smrRnMr_o.png" width="281"></p> 
<h5>4、修改主题色 </h5> 
<p>在 element-variables.scss 文件里修改 $–color-primary:#4b5f6e，即你想要的主题颜色</p> 
<p></p> 
<p class="img-center"><img alt="" height="353" src="https://images2.imgbox.com/f7/c0/i3Gouo5j_o.png" width="720"></p> 
<h5>5、编译主题 </h5> 
<p>执行主题编译命令生成主题，根目录会生成一个theme的文件夹 。</p> 
<pre>node_modules/.bin/et</pre> 
<p></p> 
<p class="img-center"><img alt="" height="79" src="https://images2.imgbox.com/58/9a/JkTWSMR1_o.png" width="398"></p> 
<h5>6、引入自定义主题 </h5> 
<p>把生成的主题按颜色改名放置 src/theme 目录下。</p> 
<p>在 main.js 中 import ‘所在路径/index.css’。</p> 
<p></p> 
<p class="img-center"><img alt="" height="264" src="https://images2.imgbox.com/ae/8d/gfaW0NHz_o.png" width="654"></p> 
<h5>7、效果展示</h5> 
<p>重新加载后，我们看到按钮颜色已经不是默认的蓝色了。</p> 
<p> </p> 
<p class="img-center"><img alt="" height="363" src="https://images2.imgbox.com/46/06/VYcGp7KZ_o.png" width="488"></p> 
<h4>动态换肤器方式</h4> 
<h5>1. 在下图位置添加封装的换肤组件。</h5> 
<p></p> 
<p class="img-center"><img alt="" height="215" src="https://images2.imgbox.com/b2/51/gkPXqKBc_o.png" width="304"></p> 
<p>index.vue</p> 
<p></p> 
<p class="img-center"><img alt="复制代码" height="20" src="https://images2.imgbox.com/a1/90/ZmCqXDkB_o.gif" width="20"></p> 
<pre>&lt;template&gt;
  &lt;el-color-picker
    class="theme-picker"
    popper-class="theme-picker-dropdown"
    v-model="theme"&gt;&lt;/el-color-picker&gt;
&lt;/template&gt;

&lt;script&gt;

const version = require('element-ui/package.json').version // element-ui version from node_modules
const ORIGINAL_THEME = '#409EFF' // default color

export default {
  data() {
    return {
      chalk: '', // content of theme-chalk css
      theme: ORIGINAL_THEME
    }
  },
  watch: {
    theme(val, oldVal) {
      if (typeof val !== 'string') return
      const themeCluster = this.getThemeCluster(val.replace('#', ''))
      const originalCluster = this.getThemeCluster(oldVal.replace('#', ''))
      console.log(themeCluster, originalCluster)
      const getHandler = (variable, id) =&gt; {
        return () =&gt; {
          const originalCluster = this.getThemeCluster(ORIGINAL_THEME.replace('#', ''))
          const newStyle = this.updateStyle(this[variable], originalCluster, themeCluster)

          let styleTag = document.getElementById(id)
          if (!styleTag) {
            styleTag = document.createElement('style')
            styleTag.setAttribute('id', id)
            document.head.appendChild(styleTag)
          }
          styleTag.innerText = newStyle
        }
      }

      const chalkHandler = getHandler('chalk', 'chalk-style')

      if (!this.chalk) {
        const url = `https://unpkg.com/element-ui@${version}/lib/theme-chalk/index.css`
        this.getCSSString(url, chalkHandler, 'chalk')
      } else {
        chalkHandler()
      }

      const styles = [].slice.call(document.querySelectorAll('style'))
        .filter(style =&gt; {
          const text = style.innerText
          return new RegExp(oldVal, 'i').test(text) &amp;&amp; !/Chalk Variables/.test(text)
        })
      styles.forEach(style =&gt; {
        const { innerText } = style
        if (typeof innerText !== 'string') return
        style.innerText = this.updateStyle(innerText, originalCluster, themeCluster)
      })
      this.$message({
        message: '换肤成功',
        type: 'success'
      })
    }
  },

  methods: {
    updateStyle(style, oldCluster, newCluster) {
      let newStyle = style
      oldCluster.forEach((color, index) =&gt; {
        newStyle = newStyle.replace(new RegExp(color, 'ig'), newCluster[index])
      })
      return newStyle
    },

    getCSSString(url, callback, variable) {
      const xhr = new XMLHttpRequest()
      xhr.onreadystatechange = () =&gt; {
        if (xhr.readyState === 4 &amp;&amp; xhr.status === 200) {
          this[variable] = xhr.responseText.replace(/@font-face{[^}]+}/, '')
          callback()
        }
      }
      xhr.open('GET', url)
      xhr.send()
    },

    getThemeCluster(theme) {
      const tintColor = (color, tint) =&gt; {
        let red = parseInt(color.slice(0, 2), 16)
        let green = parseInt(color.slice(2, 4), 16)
        let blue = parseInt(color.slice(4, 6), 16)

        if (tint === 0) { // when primary color is in its rgb space
          return [red, green, blue].join(',')
        } else {
          red += Math.round(tint * (255 - red))
          green += Math.round(tint * (255 - green))
          blue += Math.round(tint * (255 - blue))

          red = red.toString(16)
          green = green.toString(16)
          blue = blue.toString(16)

          return `#${red}${green}${blue}`
        }
      }

      const shadeColor = (color, shade) =&gt; {
        let red = parseInt(color.slice(0, 2), 16)
        let green = parseInt(color.slice(2, 4), 16)
        let blue = parseInt(color.slice(4, 6), 16)

        red = Math.round((1 - shade) * red)
        green = Math.round((1 - shade) * green)
        blue = Math.round((1 - shade) * blue)

        red = red.toString(16)
        green = green.toString(16)
        blue = blue.toString(16)

        return `#${red}${green}${blue}`
      }

      const clusters = [theme]
      for (let i = 0; i &lt;= 9; i++) {
        clusters.push(tintColor(theme, Number((i / 10).toFixed(2))))
      }
      clusters.push(shadeColor(theme, 0.1))
      return clusters
    }
  }
}
&lt;/script&gt;

&lt;style&gt;
.theme-picker .el-color-picker__trigger {
  vertical-align: middle;
}

.theme-picker-dropdown .el-color-dropdown__link-btn {
  display: none;
}
&lt;/style&gt;</pre> 
<p class="img-center"><img alt="复制代码" height="299" src="https://images2.imgbox.com/72/37/YXwQ3Uv1_o.png" width="534"></p> 
<h5> 2.直接在组件中引用</h5> 
<p> 在 Home.vue 中引入</p> 
<p></p> 
<p class="img-center"><img alt="" height="221" src="https://images2.imgbox.com/45/8b/xvpCcfzD_o.png" width="466"></p> 
<p>在语言切换左边添加换肤组件</p> 
<p></p> 
<p class="img-center"><img alt="" height="265" src="https://images2.imgbox.com/80/de/VSmtlL8j_o.png" width="499"></p> 
<h5> 3.换肤测试</h5> 
<p>点击组件，选择一个颜色确定</p> 
<p></p> 
<p class="img-center"><img alt="" height="322" src="https://images2.imgbox.com/5e/59/7DtxQ4Hl_o.png" width="705"></p> 
<p>我们看到相关主题颜色即刻生效</p> 
<p></p> 
<p class="img-center"><img alt="" height="254" src="https://images2.imgbox.com/90/53/nLe6IwZt_o.png" width="465"></p> 
<p>退回登录界面查看</p> 
<p> </p> 
<p class="img-center"><img alt="" height="387" src="https://images2.imgbox.com/53/d0/StlzmXIS_o.png" width="572"></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/79885a547a3fcbbad72d617932e1a77b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">FastAPI &#43; NGINX &#43; Gunicorn：一步一步教你部署一个高性能的Python网页应用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bfaf792768d26255c35fa25ab1e49dc8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">通过nginx将https协议反向代理到http协议请求上</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>