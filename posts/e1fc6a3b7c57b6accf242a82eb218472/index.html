<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Arduino 控制理论（3）- 如何在 Arduino 中调节 PID 控制器 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/e1fc6a3b7c57b6accf242a82eb218472/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Arduino 控制理论（3）- 如何在 Arduino 中调节 PID 控制器">
  <meta property="og:description" content="How to adjust a PID controller in Arduino We continue with this mini-series of posts dedicated to control systems in Arduino. The most feared moment for many arrives, making the adjustment or tuning of the PID.
In previous posts, we have seen what a controller is, hysteresis control, and we have introduced the powerful PID controller. We emphasize that, without being the perfect controller, the PID is popular for being relatively simple and achieving good behavior in a large number of plants, without knowing their nature.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-09T15:14:10+08:00">
    <meta property="article:modified_time" content="2024-08-09T15:14:10+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Arduino 控制理论（3）- 如何在 Arduino 中调节 PID 控制器</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="How_to_adjust_a_PID_controller_in_Arduinohttpswwwluisllamasesenadjustpidcontrollerarduino_0"></a><a href="https://www.luisllamas.es/en/adjust-pid-controller-arduino/" rel="nofollow">How to adjust a PID controller in Arduino</a></h2> 
<p>We continue with this mini-series of posts dedicated to <a href="https://www.luisllamas.es/en/tag/controller/" rel="nofollow">control systems</a> in Arduino. The most feared moment for many arrives, making the adjustment or tuning of the PID.</p> 
<p>In previous posts, we have seen <a href="https://www.luisllamas.es/en/introduction-controllers-theory-arduino/" rel="nofollow">what a controller is</a>, <a href="https://www.luisllamas.es/en/all-or-nothing-control-hysteresis-arduino/" rel="nofollow">hysteresis control</a>, and we have introduced the powerful <a href="https://www.luisllamas.es/en/control-theory-arduino-pid-controller/" rel="nofollow">PID controller</a>. We emphasize that, without being the perfect controller, the PID is popular for being relatively simple and achieving good behavior in a large number of plants, without knowing their nature.</p> 
<p>我们继续这一系列关于 Arduino 控制系统的文章。 在之前的文章中，我们已经了解了什么是控制器、滞后控制，并介绍了功能强大的 PID 控制器。 我们要强调的是，PID 虽然不是完美的控制器，但却因其相对简单、可在不了解植物性质的情况下对大量植物进行良好控制而广受欢迎。</p> 
<p>We also said that the <strong>response of a PID depends on the parameters K, Ki, and Kd</strong> of the controller. And that these depend on the plant we are controlling, that is, <strong>there are no “magic values”</strong> that always make it work well.</p> 
<p>Depending on the value we put on the parameters, we will obtain a good response, or a slow response, or oscillating, or even … remember, death, destruction, dismissal.</p> 
<p>To make it more complicated, the effect of the factors in the response is not independent. Their contribution mixes and intertwines. So <strong>we cannot adjust the parameters “one by one”</strong>.</p> 
<p>The goodness and success of our controller <strong>depends entirely on the adjustment</strong>. Therefore, it is important that we know the characteristics and effects of each factor on the system’s response.</p> 
<p>我们还说过，PID 的响应取决于控制器的参数 K、Ki 和 Kd。 而这些参数取决于我们所控制的系统，也就是说，并没有一个 "神奇的值 "能让控制器始终运行良好。 根据我们为参数设定的值，我们将获得良好的响应，或缓慢的响应，或振荡，甚至…记住，死亡、毁灭、解雇。 更为复杂的是，各因素对响应的影响并不是独立的。 它们的作用是混合和交织在一起的。 因此，我们不能 "一个一个 "地调整参数，控制器的好坏和成功与否完全取决于调整。 因此，我们必须了解每个因素的特性及其对系统响应的影响。</p> 
<h3><a id="Summary_of_the_effects_of_the_PID_26"></a>Summary of the effects of the PID</h3> 
<p>Summarizing what we saw in the previous post, as a cheat sheet:</p> 
<p>总结一下我们在上一篇文章中看到的内容，作为小抄：</p> 
<h4><a id="Proportional_Component_34"></a>Proportional Component</h4> 
<ul><li>Low K, slow response：K 值低，反应慢</li><li>High K, overshoot, oscillation, and even instability：高 K 值、过冲、振荡甚至不稳定</li><li>It does not eliminate the steady-state error：它不能消除稳态误差</li></ul> 
<h4><a id="Integral_42"></a>Integral</h4> 
<ul><li>Eliminates the steady-state error：消除稳态误差</li><li>Too much Ki, oscillation and instability：Ki 过大，振荡和不稳定：</li></ul> 
<h4><a id="Derivative_49"></a>Derivative</h4> 
<ul><li>Improves the overall performance：提高整体性能：</li><li>Too much Kd, “weird” behavior in the output：Kd 过多，输出中出现 "奇怪 "的行为：</li><li>Very sensitive to noise：对噪音非常敏感：</li><li>Very sensitive to sudden changes in the error (disturbances or setpoint changes)：对误差的突然变化非常敏感（干扰或设定点变化）</li></ul> 
<p>On the other hand, with an oscillating input, we will get an oscillating response. It is important to know</p> 
<p>另一方面，如果输入振荡，我们就会得到振荡响应。 重要的是要知道</p> 
<ul><li>The effect caused by K, has the same frequency；由 K 引起的效果具有相同的频率；</li><li>The effect caused by Ki, has a different frequency：由 Ki 引起的效果具有不同的频率： Ki 的频率越高，效果越明显。</li></ul> 
<h3><a id="Adjusting_the_PID_68"></a>Adjusting the PID</h3> 
<p>There are many ways to adjust a PID, some more or less theoretical. Let’s take a brief look.<br> 调整 PID 的方法有很多，有些或多或少是理论性的。 让我们简单了解一下。</p> 
<h4><a id="Plant_characterization_74"></a>Plant characterization</h4> 
<p>It consists of determining the transfer function of the plant. Common practices are to apply a step or frequency input, and analyze the characteristics of the output.</p> 
<p>Then we can operate mathematically to make an exact calculation of the controller for the required response</p> 
<p>它包括确定系统的传递函数。 通常的做法是应用阶跃或频率输入，并分析输出特性。 然后，我们可以通过数学运算，对控制器进行精确计算，以获得所需的响应</p> 
<h4><a id="Application_of_tuning_rules_85"></a>Application of tuning rules</h4> 
<p>Similarly, it consists of applying a certain input to the system, and measuring the output. Then, one of the many tuning rules is applied (famous example, Ziegler-Nichols rules) to obtain the PID parameters.</p> 
<p>同样，它包括对系统施加一定的输入，并测量输出。 然后，应用众多调整规则中的一种（例如著名的齐格勒-尼科尔斯规则）来获得 PID 参数。</p> 
<h4><a id="Auto_tuning_93"></a>Auto tuning</h4> 
<p>Similar to the previous one, but carried out automatically by the controller. PID controllers have advanced a lot and, currently, many have great auto-tuning algorithms.</p> 
<p>Precisely, this auto-tuning capability is one of the reasons for the commercial success of PID controllers.</p> 
<p>与前者类似，但由控制器自动执行。 PID 控制器已经取得了长足的进步，目前，许多控制器都有很好的自动调整算法。 确切地说，这种自动调整能力是 PID 控制器在商业上取得成功的原因之一。</p> 
<h4><a id="Manual_adjustment_104"></a>Manual adjustment</h4> 
<p>Finally, we have the “manual” adjustment. Which, although it sounds terrible, is a very valid and very popular option. On many occasions, a human operator can achieve an adjustment as good (or even better) than a generic Auto tuning.</p> 
<p>And that’s what we’re going to focus on in this post, because it is much less theoretical and more appropriate for #maker projects (robots, light control, etc) that are frequently done with Arduino.</p> 
<p>最后是 "手动 "调整。 虽然听起来很糟糕，但这是一个非常有效和流行的选择。 在很多情况下，人工操作可以实现与普通自动调整一样好（甚至更好）的调整效果。 这就是我们在本篇文章中要重点讨论的内容，因为它的理论性更低，更适合经常使用 Arduino 完成的创客项目（机器人、灯光控制等）。</p> 
<h3><a id="Manual_PID_adjustment_115"></a>Manual PID adjustment</h3> 
<p>To adjust the PID manually, we must be able to act on the system input, on the PID parameters, and visualize the response. And here, “visualize” does not necessarily mean using an oscilloscope. In the case of a motor, for example, we can “see” the system response simply by looking at how it turns (or sounds).</p> 
<p>If you look for tutorials on the internet, you will mainly see two “schools”.</p> 
<p>要手动调整 PID，我们必须能够对系统输入和 PID 参数进行操作，并将响应可视化。 这里的 "可视化 "并不一定是指使用示波器。 以电机为例，我们只需观察它的转动（或声音），就能 "看到 "系统的响应。 如果您在互联网上查找相关教程，主要会看到两个 “流派”。</p> 
<h4><a id="Proportionalintegralderivative_adjustment_124"></a>Proportional/integral/derivative adjustment</h4> 
<ul><li> <p>Adjust K until the system overshoots or starts to oscillate</p> </li><li> <p>Adjust Ki to eliminate steady-state error</p> </li><li> <p>Increase Kd until weird things start to happen</p> </li><li> <p>调整 K，直到系统超调或开始振荡</p> </li><li> <p>调整 Ki，消除稳态误差</p> </li><li> <p>增加 Kd，直到开始出现怪异现象</p> </li></ul> 
<h4><a id="Proportionalderivativeintegral_adjustment_135"></a>Proportional/derivative/integral adjustment</h4> 
<ul><li> <p>Adjust K until the system overshoots or starts to oscillate</p> </li><li> <p>Increase Kd until weird things start to happen</p> </li><li> <p>Adjust Ki to eliminate steady-state error</p> </li><li> <p>调整 K 直到系统超调或开始振荡</p> </li><li> <p>增加 Kd 直到怪异现象开始出现</p> </li><li> <p>调整 Ki 以消除稳态误差</p> </li></ul> 
<p>With both, you will achieve similar results, ultimately. Personally, <strong>I recommend the first one</strong> and I do not understand why they insist on explaining the second one.</p> 
<p>The reason is that the derivative term is very sensitive to measurement noise and, therefore, it is difficult to adjust in a real case. But, you can try it for yourselves.</p> 
<p>And to practice manual parameter adjustment, here is a PID simulator, with a generic plant that has a little bit of everything (it is a second-order with a bit of pure delay).</p> 
<p>两种方法最终都能获得相似的结果。 我个人推荐第一种方法，我不明白他们为什么坚持解释第二种方法，原因是导数项对测量噪声非常敏感，因此在实际情况下很难调整。 为了练习手动调整参数，这里有一个 PID 模拟器，其中有一个什么都有的普通系统（这是一个带点纯延迟的二阶系统）。</p> 
<p>Move the Kp, Ki, and Kd sliders to see the changes in the controller response.</p> 
<p><a href="https://www.luisllamas.es/en/adjust-pid-controller-arduino/" rel="nofollow">观看模拟</a></p> 
<p>You can play with the different methods to adjust the PID until you get an adequate response. (hint, around K = 2.5, Ki = 0.02, Kd = 12 looks good)</p> 
<p>Of course, the parameters depend on the response you want. Do we accept exceeding the setpoint a bit in exchange for more speed? Do we prefer it to be slower, but with less effort in the motor? It depends on your design criteria.</p> 
<p>And we have finished the topic of PID adjustment. In the next post, we will see how to implement a PID control in Arduino.<br> 您可以使用不同的方法来调整 PID，直到获得适当的响应。 (提示，K = 2.5、Ki = 0.02、Kd = 12 左右看起来不错）当然，参数取决于您想要的响应。 我们是否可以接受稍稍超出设定点以换取更快的速度？ 我们是否更希望速度更慢，但电机消耗更少？ 这取决于您的设计标准。 PID 调节的话题到此结束。 在下一篇文章中，我们将了解如何在 Arduino 中实现 PID 控制。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d0f08e4f4a2cdc5891c877907b821e25/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">最新版的AutoGPT，我搭建好了</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e299ad725c954d55c8f2e9ffbfbeceb1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">设计模式——中介者模式</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>