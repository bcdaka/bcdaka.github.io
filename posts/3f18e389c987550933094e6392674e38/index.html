<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>搭建自己的AI智能QQ机器人，可实现单聊或者群聊，新手可看，手把手保姆级教学，可实现机器人托管自己的QQ，机器人可以定时发送消息，个性化定制机器人的类型 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/3f18e389c987550933094e6392674e38/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="搭建自己的AI智能QQ机器人，可实现单聊或者群聊，新手可看，手把手保姆级教学，可实现机器人托管自己的QQ，机器人可以定时发送消息，个性化定制机器人的类型">
  <meta property="og:description" content="一、搭建自己的QQ服务器 GitHub上开源的项目go-cqhttp可以帮助快速搭建，并且操作十分简单 1. go-cqhttp官网：go-cqhttp 帮助中心 官网界面如下图 2. 下载自己机器适配的版本 如果你是Windows，推荐使用下面的两个文件，Linux也没事，文档中写的很清楚
3. 必要操作和配置文件 下载好之后是下面的三个文件：
双击go-cqhttp.exe，会出现控制台和三个弹窗，弹窗全部点击确定，控制台会自动关闭，这时会发现文件夹里多了一个文件go-cqhttp.bat，如下图所示，双击打开它
在出现的控制台上选择0，并将控制台关闭，接下来就是配置文件
返回文件夹，会发现多出一个文件：config.yml 如下图所示，使用记事本编辑它
文本内容如下图所示，uin是QQ号，password为QQ密码， 因为现在的QQ都有登陆保护或者验证，本次使用的是扫码登录，将uin和password全部置为空，多出的空格不必删除，删除就会报错
再将倒数几行的 地址 和 密钥 前面的 # 删掉，这一步不可以省略
保存文件之后，双击打开go-cqhttp.bat，此时会在文件夹内生成几个登录文件并尝试打开摄像头进行QQ的登录扫描，如果打开摄像头时报错协议不支持或者版本过低，则用记事本打开device.json并将其内容&#34;protocol&#34;:6改为&#34;protocol&#34;:2
到此，必要的操作和配置文件已经整理好，双击go-cqhttp.bat就可以登录我们自己的QQ了
如果自己弄不明白或者环境配置不上以及任何问题，欢迎和我私聊，如果希望快一点也可加我的微信：BeWhite_Studio
二、使用python语言进行消息的接收和发送 1. 接收QQ消息 将以下代码命名为：receive.py
# 接收QQ端消息 import socket import json ListenSocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM) ListenSocket.bind((&#39;127.0.0.1&#39;, 5701)) ListenSocket.listen(100) HttpResponseHeader = &#39;&#39;&#39;HTTP/1.1 200 OK\r\n Content-Type: text/html\r\n\r\n &#39;&#39;&#39; def request_to_json(msg): for i in range(len(msg)): if msg[i] == &#34;{&#34; and msg[-1] == &#34;\n&#34;: return json.loads(msg[i:]) return None # 需要循环执行，返回值为json格式 def rev_msg(): # json or None Client, Address = ListenSocket.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-07T18:01:49+08:00">
    <meta property="article:modified_time" content="2024-05-07T18:01:49+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">搭建自己的AI智能QQ机器人，可实现单聊或者群聊，新手可看，手把手保姆级教学，可实现机器人托管自己的QQ，机器人可以定时发送消息，个性化定制机器人的类型</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>一、搭建自己的QQ服务器</h2> 
<p>GitHub上开源的项目go-cqhttp可以帮助快速搭建，并且操作十分简单<span style="color:#4f4f4f;"><span style="background-color:#ffffff;"><span style="color:#696969;">  </span></span></span></p> 
<h3><span style="color:#4f4f4f;"><span style="background-color:#ffffff;"><span style="color:#696969;">1. go-cqhttp官网：</span></span></span><a href="https://docs.go-cqhttp.org/" rel="nofollow" title="go-cqhttp 帮助中心">go-cqhttp 帮助中心</a>  官网界面如下图</h3> 
<p><img alt="" height="831" src="https://images2.imgbox.com/18/72/ICWrRxCV_o.png" width="1200"></p> 
<h3>2. 下载自己机器适配的版本 </h3> 
<p>如果你是Windows，推荐使用下面的两个文件，Linux也没事，文档中写的很清楚</p> 
<p><img alt="" height="324" src="https://images2.imgbox.com/ac/ac/whmEb7wQ_o.png" width="1099"></p> 
<h3>3. 必要操作和配置文件</h3> 
<p>下载好之后是下面的三个文件：</p> 
<p><img alt="" height="171" src="https://images2.imgbox.com/3f/99/18NgJPdC_o.png" width="791"></p> 
<p>双击go-cqhttp.exe，会出现控制台和三个弹窗，弹窗全部点击确定，控制台会自动关闭，这时会发现文件夹里多了一个文件go-cqhttp.bat，如下图所示，双击打开它</p> 
<p><img alt="" height="210" src="https://images2.imgbox.com/cf/e6/bNCj8jkc_o.png" width="792"></p> 
<p>在出现的控制台上选择0，并将控制台关闭，接下来就是配置文件</p> 
<p><img alt="" height="248" src="https://images2.imgbox.com/87/a5/FPHUlGgy_o.png" width="904"></p> 
<p>返回文件夹，会发现多出一个文件：config.yml 如下图所示，使用记事本编辑它</p> 
<p><img alt="" height="211" src="https://images2.imgbox.com/9b/eb/CjhXBGUQ_o.png" width="683"></p> 
<p>文本内容如下图所示，uin是QQ号，password为QQ密码， 因为现在的QQ都有登陆保护或者验证，本次使用的是扫码登录，将uin和password全部置为空，<span style="color:#ff9900;">多出的空格不必删除</span>，删除就会报错</p> 
<p><img alt="" height="166" src="https://images2.imgbox.com/9a/a7/vJEB0Dke_o.png" width="880"></p> 
<p>再将倒数几行的 地址 和 密钥 前面的 # 删掉，这一步不可以省略</p> 
<p><img alt="" height="106" src="https://images2.imgbox.com/86/dc/gZlKGonX_o.png" width="862"></p> 
<p>保存文件之后，双击打开go-cqhttp.bat，此时会在文件夹内生成几个登录文件并尝试打开摄像头进行QQ的登录扫描，如果打开摄像头时报错协议不支持或者版本过低，则用记事本打开device.json并将其内容"protocol":6改为"protocol":2</p> 
<p><img alt="" height="130" src="https://images2.imgbox.com/14/cc/VBXonIcg_o.png" width="1055"></p> 
<p><img alt="" height="367" src="https://images2.imgbox.com/98/60/kjHX4Ihe_o.png" width="799"></p> 
<p>到此，必要的操作和配置文件已经整理好，双击go-cqhttp.bat就可以登录我们自己的QQ了</p> 
<p>如果自己弄不明白或者环境配置不上以及任何问题，欢迎和我私聊，如果希望快一点也可加我的微信：BeWhite_Studio</p> 
<h2>二、使用python语言进行消息的接收和发送</h2> 
<h3>1. 接收QQ消息</h3> 
<p>将以下代码命名为：receive.py</p> 
<pre><code class="language-python"># 接收QQ端消息
import socket
import json

ListenSocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
ListenSocket.bind(('127.0.0.1', 5701))
ListenSocket.listen(100)

HttpResponseHeader = '''HTTP/1.1 200 OK\r\n
Content-Type: text/html\r\n\r\n
'''


def request_to_json(msg):
    for i in range(len(msg)):
        if msg[i] == "{" and msg[-1] == "\n":
            return json.loads(msg[i:])
    return None


# 需要循环执行，返回值为json格式
def rev_msg():  # json or None
    Client, Address = ListenSocket.accept()
    Request = Client.recv(1024).decode(encoding='utf-8')
    rev_json = request_to_json(Request)
    Client.sendall(HttpResponseHeader.encode(encoding='utf-8'))
    Client.close()
    return rev_json
</code></pre> 
<h3>2. 发送QQ消息</h3> 
<p>将以下代码命令为：QQMessages.py</p> 
<pre><code class="language-python"># 发送QQ端消息

import socket


def send_msg(resp_dict):
    client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

    ip = '127.0.0.1'
    client.connect((ip, 5700))

    msg_type = resp_dict['msg_type']  # 回复类型（群聊/私聊）
    number = resp_dict['number']  # 回复账号（群号/好友号）
    msg = resp_dict['msg']  # 要回复的消息

    # 将字符中的特殊字符进行url编码
    msg = msg.replace(" ", "%20")
    msg = msg.replace("\n", "%0a")

    if msg_type == 'group':
        payload = "GET /send_group_msg?group_id=" + str(
            number) + "&amp;message=" + msg + " HTTP/1.1\r\nHost:" + ip + ":5700\r\nConnection: close\r\n\r\n"
    elif msg_type == 'private':
        payload = "GET /send_private_msg?user_id=" + str(
            number) + "&amp;message=" + msg + " HTTP/1.1\r\nHost:" + ip + ":5700\r\nConnection: close\r\n\r\n"
    else:
        return 0
    print("发送" + payload)
    client.send(payload.encode("utf-8"))
    client.close()
    return 0
</code></pre> 
<h3> 3. 测试接收和发送消息的功能</h3> 
<p>将以下代码命名为Main.py 并运行，如果当有人给你的QQ发消息“在吗”时，自动回复“我在”，则功能正常，其他功能可自行完善</p> 
<pre><code class="language-python">from receive import rev_msg
from QQMessages import send_msg


def TEST():
    while 1:
        rev = rev_msg()
        if rev["post_type"] == "message":
            if rev["message_type"] == "private":
                if rev['raw_message'] == '在吗':
                    qq = rev['sender']['user_id']
                    send_msg({'msg_type': 'private', 'number': qq, 'msg': '我在'})
            elif rev["message_type"] == "group":
                group = rev['group_id']
                if "[CQ:at,qq=机器人的QQ号]" in rev["raw_message"]:
                    if rev['raw_message'].split(' ')[1] == '在吗':
                        qq = rev['sender']['user_id']
                        send_msg({'msg_type': 'group', 'number': group, 'msg': '[CQ:poke,qq={}]'.format(qq)})
            else:
                continue
        else:
            continue


if __name__ == '__main__':
    TEST()
</code></pre> 
<p>如果自己弄不明白或者环境配置不上以及任何问题，欢迎和我私聊，如果希望快一点也可加我的微信：BeWhite_Studio </p> 
<h2></h2> 
<h2>三、引用人工智能到服务器上，实现AI机器人</h2> 
<h3>1. 调用文心一言的接口</h3> 
<p>我在测试的时候使用的是文心一言，其他的大家可以自行读官网文档</p> 
<p>这里推荐一个网站：<a href="https://luckycola.com.cn/public/dist/#/" rel="nofollow" title="LuckyCola">LuckyCola</a>，该网站集成了很多的人工智能，简单方便</p> 
<p>以下是人工智能对话的代码，此代码中的账密都是我自己的，故不方便展示。当有文心一言的appKey和uid之后，就可以将以下代码中的appKey和uid切换成自己的，并调用方法则可实现</p> 
<pre><code class="language-python">import configparser
import requests
import json


class res:
    def __init__(self):
        super().__init__()
        config = configparser.ConfigParser()
        config.read('properties/constant.properties', encoding='utf-8-sig')
        self.appKey = config.get('api', 'appKey')
        self.uid = config.get('api', 'uid')
        self.url = config.get('WenXin', 'url')
        self.body = None
        self.text = None

    def response(self, text):
        try:
            self.text = text
            self.body = {
                'appKey': self.appKey,
                'ques': self.text,
                'uid': self.uid,
                'isLongChat': 1
            }
            # 将字典转换为JSON格式的字符串
            body_json = json.dumps(self.body)
            # 发送POST请求
            response = requests.post(self.url, data=body_json, headers={'Content-Type': 'application/json'})
            start = "result"
            end = "countMsg"
            start_index = response.text.find(start) + len(start)
            end_index = response.text.find(end)
            # 打印响应结果
            return response.text[start_index + 3:end_index - 4]
        except Exception:
            return "发生错误，请稍后重试"
</code></pre> 
<h3>2. 在代码上进行简单的自我扩展，即可实现机器人账号或者是机器人托管</h3> 
<p>以下代码都是我在基础的功能上加的一些强化功能，演示如下：</p> 
<p>群聊：</p> 
<p><img alt="" height="660" src="https://images2.imgbox.com/ab/da/smIfhrm6_o.png" width="1200"></p> 
<p>单聊：</p> 
<p><img alt="" height="392" src="https://images2.imgbox.com/b9/b2/RWx8OYry_o.png" width="1200"></p> 
<p>自定义机器人可以实现自己的AI小助手，或者是个性化的群管家，也可实现托管自己的QQ</p> 
<p>如果自己弄不明白或者环境配置不上以及任何问题，欢迎和我私聊，如果希望快一点也可加我的微信：BeWhite_Studio</p> 
<p></p> 
<p></p> 
<p>作者声明：未经允许，禁止转载，如果需要，请联系微信：BeWhite_Studio</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ede653d5f48a8b62637726e5653c6e2f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java导入导出csv格式文件完整版详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/34f8a3619f510f8c01af8086eec7469a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">手把手教你从0到1搭建一个AI Agent(智能体)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>