<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python爬取豆瓣电影&#43;数据可视化，爬虫教程！ - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/ba0109b7694e4eec8fa580479974b35e/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Python爬取豆瓣电影&#43;数据可视化，爬虫教程！">
  <meta property="og:description" content="1. 爬取数据 1.1 导入以下模块 import os import re import time import requests from bs4 import BeautifulSoup from fake_useragent import UserAgent from openpyxl import Workbook, load_workbook 1.2 获取每页电影链接 def getonepagelist(url,headers): try: r = requests.get(url, headers=headers, timeout=10) r.raise_for_status() r.encoding = &#39;utf-8&#39; soup = BeautifulSoup(r.text, &#39;html.parser&#39;) lsts = soup.find_all(attrs={&#39;class&#39;: &#39;hd&#39;}) for lst in lsts: href = lst.a[&#39;href&#39;] time.sleep(0.5) getfilminfo(href, headers) except: print(&#39;getonepagelist error!&#39;) 1.3 获取每部电影具体信息 def getfilminfo(url,headers): filminfo = [] r = requests.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-01T17:12:36+08:00">
    <meta property="article:modified_time" content="2024-07-01T17:12:36+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python爬取豆瓣电影&#43;数据可视化，爬虫教程！</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 style="text-align:center;"><img alt="" src="https://images2.imgbox.com/8e/21/Z9pMZQuv_o.png"></h2> 
<h2 id="1-爬取数据">1. 爬取数据</h2> 
<h3 id="11-导入以下模块">1.1 导入以下模块</h3> 
<pre><code>import os
import re
import time
import requests
from bs4 import BeautifulSoup
from fake_useragent import UserAgent
from openpyxl import Workbook, load_workbook
</code></pre> 
<h3 id="12-获取每页电影链接">1.2 获取每页电影链接</h3> 
<pre><code>def getonepagelist(url,headers):
    try:
        r = requests.get(url, headers=headers, timeout=10)
        r.raise_for_status()
        r.encoding = 'utf-8'
        soup = BeautifulSoup(r.text, 'html.parser')
        lsts = soup.find_all(attrs={'class': 'hd'})
        for lst in lsts:
            href = lst.a['href']
            time.sleep(0.5)
            getfilminfo(href, headers)
    except:
        print('getonepagelist error!')
</code></pre> 
<h3 id="13-获取每部电影具体信息">1.3 获取每部电影具体信息</h3> 
<pre><code>def getfilminfo(url,headers):
    filminfo = []
    r = requests.get(url, headers=headers, timeout=10)
    r.raise_for_status()
    r.encoding = 'utf-8'
    soup = BeautifulSoup(r.text, 'html.parser')
</code></pre> 
<h3 id="14-保存数据">1.4 保存数据</h3> 
<pre><code>def insert2excel(filepath,allinfo):
    try:
        if not os.path.exists(filepath):
            tableTitle = ['片名','上映年份','评分','评价人数','导演','编剧','主演','类型','国家/地区','语言','时长(分钟)']
            wb = Workbook()
            ws = wb.active
            ws.title = 'sheet1'
            ws.append(tableTitle)
            wb.save(filepath)
            time.sleep(3)
        wb = load_workbook(filepath)
        ws = wb.active
        ws.title = 'sheet1'
        ws.append(allinfo)
        wb.save(filepath)
        return True
    except:
        return False
</code></pre> 
<p></p> 
<p class="img-center"><img alt="" height="476" src="https://images2.imgbox.com/1a/c0/GvaYHrxy_o.png" width="1075"></p> 
<h2 id="2-数据可视化">2. 数据可视化</h2> 
<h3 id="21-导入以下模块">2.1 导入以下模块</h3> 
<pre><code>import pandas as pd
from pyecharts import options as opts
from pyecharts.charts import Bar
</code></pre> 
<h3 id="22-用pandas模块读取数据">2.2 用pandas模块读取数据</h3> 
<pre><code>data = pd.read_excel('/home/mw/input/TOP2508837/TOP250.xlsx')
data.head(10)
</code></pre> 
<h3 id="23-各年份上映电影数量柱状图纵向">2.3 各年份上映电影数量柱状图（纵向）</h3> 
<pre><code>def getzoombar(data):
    year_counts = data['上映年份'].value_counts()
    year_counts.columns = ['上映年份', '数量']
    year_counts = year_counts.sort_index()
    c = (
        Bar()
        .add_xaxis(list(year_counts.index))
        .add_yaxis('上映数量', year_counts.values.tolist())
        .set_global_opts(
            title_opts=opts.TitleOpts(title='各年份上映电影数量'),
            yaxis_opts=opts.AxisOpts(name='上映数量'),
            xaxis_opts=opts.AxisOpts(name='上映年份'),
            datazoom_opts=[opts.DataZoomOpts(), opts.DataZoomOpts(type_='inside')],)
        )
</code></pre> 
<h3 id="24-各地区上映电影数量前十柱状图横向">2.4 各地区上映电影数量前十柱状图（横向）</h3> 
<pre><code>def getcountrybar(data):
    country_counts = data['国家/地区'].value_counts()
    country_counts.columns = ['国家/地区', '数量']
    country_counts = country_counts.sort_values(ascending=True)
    c = (
        Bar()
        .add_xaxis(list(country_counts.index)[-10:])
        .add_yaxis('地区上映数量', country_counts.values.tolist()[-10:])
        .reversal_axis()
        .set_global_opts(
        title_opts=opts.TitleOpts(title='地区上映电影数量'),
        yaxis_opts=opts.AxisOpts(name='国家/地区'),
        xaxis_opts=opts.AxisOpts(name='上映数量'),
        )
        .set_series_opts(label_opts=opts.LabelOpts(position="right"))
        )

</code></pre> 
<h3 id="25-电影评价人数前二十柱状图横向">2.5 电影评价人数前二十柱状图（横向）</h3> 
<pre><code>def getscorebar(data):
    df = data.sort_values(by='评价人数', ascending=True)
    c = (
        Bar()
        .add_xaxis(df['片名'].values.tolist()[-20:])
        .add_yaxis('评价人数', df['评价人数'].values.tolist()[-20:])
        .reversal_axis()
        .set_global_opts(
            title_opts=opts.TitleOpts(title='电影评价人数'),
            yaxis_opts=opts.AxisOpts(name='片名'),
            xaxis_opts=opts.AxisOpts(name='人数'),
            datazoom_opts=opts.DataZoomOpts(type_='inside'),
            )
        .set_series_opts(label_opts=opts.LabelOpts(position="right"))
        )
</code></pre> 
<p></p> 
<p><strong>最后：</strong>如果你对Python感兴趣，想要学习Python，希望可以帮到你，一起加油！以上是给大家分享的<strong>Python全套学习资料</strong>，都是我自己学习时整理的： </p> 
<h6>一、Python所有方向的学习路线</h6> 
<p>Python所有方向路线就是把Python常用的技术点做整理，形成各个领域的知识点汇总，它的用处就在于，你可以按照上面的知识点去找对应的学习资源，保证自己学得较为全面。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="578" src="https://images2.imgbox.com/48/05/j31WBDdR_o.png" width="761"></p> 
<p></p> 
<p></p> 
<p class="img-center"><img alt="图片" height="392" src="https://images2.imgbox.com/b3/64/fGvw5DjN_o.png" width="543"></p> 
<p></p> 
<p>二、学习软件</p> 
<p>工欲善其事必先利其器。学习Python常用的开发软件都在这里了，还有环境配置的教程，给大家节省了很多时间。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="352" src="https://images2.imgbox.com/45/19/wWNCa29R_o.png" width="550"></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<h6>三、全套PDF电子书</h6> 
<p>书籍的好处就在于权威和体系健全，刚开始学习的时候你可以只看视频或者听某个人讲课，但等你学完之后，你觉得你掌握了，这时候建议还是得去看一下书籍，看权威技术书籍也是每个程序员必经之路。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="409" src="https://images2.imgbox.com/6c/4a/394OFj7K_o.png" width="674"></p> 
<h6>四、入门学习视频全套</h6> 
<p>我们在看视频学习的时候，不能光动眼动脑不动手，比较科学的学习方法是在理解之后运用它们，这时候练手项目就很适合了。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="584" src="https://images2.imgbox.com/41/80/3dtg5As9_o.png" width="1027"></p> 
<p></p> 
<p class="img-center"><img alt="图片" height="519" src="https://images2.imgbox.com/4e/44/mtXDJh4j_o.png" width="1080"></p> 
<p></p> 
<p></p> 
<p>五、实战案例</p> 
<p></p> 
<p>光学理论是没用的，要学会跟着一起敲，要动手实操，才能将自己的所学运用到实际当中去，这时候可以搞点实战案例来学习。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="547" src="https://images2.imgbox.com/6c/79/hSpmJDBU_o.png" width="835"></p> 
<p></p> 
<p class="img-center"><img alt="图片" height="456" src="https://images2.imgbox.com/f8/78/WKKjQGDy_o.png" width="693"></p> 
<p> **学习资源已打包，需要的小伙伴可以戳这里：<a class="link-info" href="https://mp.weixin.qq.com/s?__biz=MzkzNDcwNjE0OA==&amp;mid=2247483664&amp;idx=1&amp;sn=b56b6869dfdc14963cbd9b2ef5c182e6&amp;chksm=c2b86f9bf5cfe68df3fb14cb599392ffad1bc1cdf18a05e25a4845345663b320926c95ccee60&amp;token=1505772728&amp;lang=zh_CN#rd" rel="nofollow" title="【学习资料】">【学习资料】</a> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bb26192a6dd09566e2e7bac536e8dc1b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">VSCode创建Vue 项目</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f742bdfba2e7db80b0b01f7bb16686d8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">分享10个很酷、简单且有趣的 Python 项目及其源代码</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>