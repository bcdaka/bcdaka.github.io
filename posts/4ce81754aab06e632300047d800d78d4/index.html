<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Linux 安装 kafka - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/4ce81754aab06e632300047d800d78d4/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Linux 安装 kafka">
  <meta property="og:description" content="文章目录 前言一、Kafka简介kafka核心概念 二、安装Kafka1.准备工作1.1 Java1.2 安装包下载 2.安装KafKa1. 解压安装包2. 配置kafka3 进入配置文件目录4 修改配置文件server.properties，添加下面内容5 配置zookeeper服务 zookeeper.properties6 创建启动和关闭的 kafka 执行脚本6.1 创建启动脚本6.2 创建关闭脚本 kafkaStop.sh 7 启动脚本，关闭脚本赋予权限8 创建生产者 topic 和 消费者 topic9 Spring boot集成Kafka 前言 例如：随着人工智能的不断发展，机器学习这门技术也越来越重要，很多人都开启了学习机器学习，本文就介绍了机器学习的基础内容。
提示：以下是本篇文章正文内容，下面案例可供参考
一、Kafka简介 Kafka是由Apache软件基金会开发的一个开源流处理平台，由Scala和Java编写。Kafka是一种高吞吐量的分布式发布订阅消息系统，它可以处理消费者规模的网站中的所有动作流数据。 这种动作（网页浏览，搜索和其他用户的行动）是在现代网络上的许多社会功能的一个关键因素。 这些数据通常是由于吞吐量的要求而通过处理日志和日志聚合来解决。 对于像Hadoop的一样的日志数据和离线分析系统，但又要求实时处理的限制，这是一个可行的解决方案。Kafka的目的是通过Hadoop的并行加载机制来统一线上和离线的消息处理，也是为了通过集群来提供实时的消息。
kafka核心概念 在深入了解 Kafka 的使用教程之前，让我们先介绍一些 Kafka 的核心概念，这些概念是理解 Kafka 的基础：
Broker： Kafka 集群中的每个服务器节点称为 Broker，它们负责存储和处理数据。
Topic： 消息发布的主题，是数据流的类别。生产者将消息发布到主题，消费者从主题中订阅消息。
Partition： 每个 Topic 可以分成多个 Partition，每个 Partition 是一个有序的消息队列。分区允许数据水平分布和并行处理。
Producer： 数据的发布者，将消息发送到一个或多个 Topic。
Consumer： 数据的订阅者，从一个或多个 Topic 中消费消息。
Consumer Group： 一组消费者的集合，共同消费一个 Topic 的消息。每个分区只能由一个消费者组中的一个消费者消费。
Offset： 每个消息在 Partition 中的唯一标识，消费者使用 Offset 来追踪已消费的消息。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-28T09:59:19+08:00">
    <meta property="article:modified_time" content="2024-03-28T09:59:19+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Linux 安装 kafka</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_6" rel="nofollow">前言</a></li><li><a href="#Kafka_14" rel="nofollow">一、Kafka简介</a></li><li><ul><li><ul><li><ul><li><ul><li><ul><li><a href="#kafka_16" rel="nofollow">kafka核心概念</a></li></ul> 
     </li></ul> 
    </li></ul> 
   </li></ul> 
  </li></ul> 
  </li><li><a href="#Kafka_33" rel="nofollow">二、安装Kafka</a></li><li><ul><li><a href="#1_34" rel="nofollow">1.准备工作</a></li><li><ul><li><ul><li><ul><li><ul><li><a href="#11_Java_35" rel="nofollow">1.1 Java</a></li><li><a href="#12___37" rel="nofollow">1.2 安装包下载</a></li></ul> 
     </li></ul> 
    </li></ul> 
   </li></ul> 
   </li><li><a href="#2KafKa_46" rel="nofollow">2.安装KafKa</a></li><li><ul><li><ul><li><ul><li><a href="#1__48" rel="nofollow">1. 解压安装包</a></li><li><a href="#2_kafka_55" rel="nofollow">2. 配置kafka</a></li><li><a href="#3__64" rel="nofollow">3 进入配置文件目录</a></li><li><a href="#4_serverproperties_69" rel="nofollow">4 修改配置文件server.properties，添加下面内容</a></li><li><a href="#5_zookeeper_zookeeperproperties_79" rel="nofollow">5 配置zookeeper服务 zookeeper.properties</a></li><li><a href="#6___kafka__89" rel="nofollow">6 创建启动和关闭的 kafka 执行脚本</a></li><li><ul><li><a href="#61__90" rel="nofollow">6.1 创建启动脚本</a></li><li><a href="#62__kafkaStopsh_105" rel="nofollow">6.2 创建关闭脚本 kafkaStop.sh</a></li></ul> 
      </li><li><a href="#7__120" rel="nofollow">7 启动脚本，关闭脚本赋予权限</a></li><li><a href="#8__topic___topic_132" rel="nofollow">8 创建生产者 topic 和 消费者 topic</a></li><li><a href="#9_Spring_bootKafka_158" rel="nofollow">9 Spring boot集成Kafka</a></li></ul> 
    </li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_6"></a>前言</h2> 
<p>例如：随着人工智能的不断发展，机器学习这门技术也越来越重要，很多人都开启了学习机器学习，本文就介绍了机器学习的基础内容。</p> 
<hr> 
<p><code>提示：以下是本篇文章正文内容，下面案例可供参考</code></p> 
<h2><a id="Kafka_14"></a>一、Kafka简介</h2> 
<p>Kafka是由Apache软件基金会开发的一个开源流处理平台，由Scala和Java编写。Kafka是一种高吞吐量的分布式发布订阅消息系统，它可以处理消费者规模的网站中的所有动作流数据。 这种动作（网页浏览，搜索和其他用户的行动）是在现代网络上的许多社会功能的一个关键因素。 这些数据通常是由于吞吐量的要求而通过处理日志和日志聚合来解决。 对于像Hadoop的一样的日志数据和离线分析系统，但又要求实时处理的限制，这是一个可行的解决方案。Kafka的目的是通过Hadoop的并行加载机制来统一线上和离线的消息处理，也是为了通过集群来提供实时的消息。</p> 
<h6><a id="kafka_16"></a>kafka核心概念</h6> 
<p>在深入了解 Kafka 的使用教程之前，让我们先介绍一些 Kafka 的核心概念，这些概念是理解 Kafka 的基础：</p> 
<p>Broker： Kafka 集群中的每个服务器节点称为 Broker，它们负责存储和处理数据。</p> 
<p>Topic： 消息发布的主题，是数据流的类别。生产者将消息发布到主题，消费者从主题中订阅消息。</p> 
<p>Partition： 每个 Topic 可以分成多个 Partition，每个 Partition 是一个有序的消息队列。分区允许数据水平分布和并行处理。</p> 
<p>Producer： 数据的发布者，将消息发送到一个或多个 Topic。</p> 
<p>Consumer： 数据的订阅者，从一个或多个 Topic 中消费消息。</p> 
<p>Consumer Group： 一组消费者的集合，共同消费一个 Topic 的消息。每个分区只能由一个消费者组中的一个消费者消费。</p> 
<p>Offset： 每个消息在 Partition 中的唯一标识，消费者使用 Offset 来追踪已消费的消息。</p> 
<h2><a id="Kafka_33"></a>二、安装Kafka</h2> 
<h3><a id="1_34"></a>1.准备工作</h3> 
<h6><a id="11_Java_35"></a>1.1 Java</h6> 
<p>Kafka是依赖Java环境运行，所以需要在Linux系统内安装Java环境。</p> 
<h6><a id="12___37"></a>1.2 安装包下载</h6> 
<p><a href="http://kafka.apache.org/downloads.html" rel="nofollow">官方下载地址：http://kafka.apache.org/downloads.html</a><br> <img src="https://images2.imgbox.com/b2/dc/Uh1FI4nt_o.png" alt="在这里插入图片描述"><br> 我这里下载的是：kafka_2.12-3.6.0.tgz</p> 
<pre><code class="prism language-c"># 在线下载安装包
wget https<span class="token operator">:</span><span class="token comment">//archive.apache.org/dist/kafka/3.6.0/kafka_2.12-3.6.0.tgz</span>
</code></pre> 
<h3><a id="2KafKa_46"></a>2.安装KafKa</h3> 
<p>将安装包传送到服务器并解压，这里我放到opt下面</p> 
<h6><a id="1__48"></a>1. 解压安装包</h6> 
<pre><code class="prism language-c">cd  opt
tar <span class="token operator">-</span>zxvf kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">3.6</span><span class="token number">.0</span><span class="token punctuation">.</span>tgz
</code></pre> 
<h6><a id="2_kafka_55"></a>2. 配置kafka</h6> 
<p>在kafka解压目录同一路径下创建</p> 
<pre><code class="prism language-c">mkdir <span class="token operator">-</span>p <span class="token operator">/</span>opt<span class="token operator">/</span>software<span class="token operator">/</span>kafka
mkdir <span class="token operator">-</span>p <span class="token operator">/</span>opt<span class="token operator">/</span>software<span class="token operator">/</span>kafka<span class="token operator">/</span>zookeeper  #zookeeper数据目录
mkdir <span class="token operator">-</span>p <span class="token operator">/</span>opt<span class="token operator">/</span>software<span class="token operator">/</span>kafka<span class="token operator">/</span>log        #kafka日志
mkdir <span class="token operator">-</span>p <span class="token operator">/</span>opt<span class="token operator">/</span>software<span class="token operator">/</span>kafka<span class="token operator">/</span>zookeeper<span class="token operator">/</span>log  #zookeeper日志
</code></pre> 
<h6><a id="3__64"></a>3 进入配置文件目录</h6> 
<pre><code class="prism language-c">cd <span class="token operator">/</span>opt<span class="token operator">/</span>kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">3.6</span><span class="token number">.0</span><span class="token operator">/</span>config<span class="token operator">/</span>
</code></pre> 
<h6><a id="4_serverproperties_69"></a>4 修改配置文件server.properties，添加下面内容</h6> 
<pre><code class="prism language-c">broker<span class="token punctuation">.</span>id<span class="token operator">=</span><span class="token number">0</span>
port<span class="token operator">=</span><span class="token number">9092</span> #端口号
host<span class="token punctuation">.</span>name<span class="token operator">=</span>localhost #服务器IP地址，修改为自己的服务器IP
log<span class="token punctuation">.</span>dirs<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>software<span class="token operator">/</span>kafka<span class="token operator">/</span>log  #日志存放路径，上面创建的目录
zookeeper<span class="token punctuation">.</span>connect<span class="token operator">=</span>localhost<span class="token operator">:</span><span class="token number">2181</span> #zookeeper地址和端口，单机配置部署，localhost<span class="token operator">:</span><span class="token number">2181</span>

</code></pre> 
<h6><a id="5_zookeeper_zookeeperproperties_79"></a>5 配置zookeeper服务 zookeeper.properties</h6> 
<pre><code class="prism language-c">dataDir<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>software<span class="token operator">/</span>kafka<span class="token operator">/</span>zookeeper   #zookeeper数据目录
dataLogDir<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>software<span class="token operator">/</span>kafka<span class="token operator">/</span>zookeeper<span class="token operator">/</span>log #zookeeper日志目录
clientPort<span class="token operator">=</span><span class="token number">2181</span>
maxClientCnxns<span class="token operator">=</span><span class="token number">100</span>
tickTimes<span class="token operator">=</span><span class="token number">2000</span>
initLimit<span class="token operator">=</span><span class="token number">10</span>
syncLimit<span class="token operator">=</span><span class="token number">5</span>
</code></pre> 
<h6><a id="6___kafka__89"></a>6 创建启动和关闭的 kafka 执行脚本</h6> 
<h6><a id="61__90"></a>6.1 创建启动脚本</h6> 
<pre><code class="prism language-c">cd <span class="token operator">/</span>opt<span class="token operator">/</span>kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">3.6</span><span class="token number">.0</span><span class="token operator">/</span>
vi kafkaStart<span class="token punctuation">.</span>sh
</code></pre> 
<p>配置启动脚本 kafkaStart.sh</p> 
<pre><code class="prism language-c">#启动zookeeper
<span class="token operator">/</span>opt<span class="token operator">/</span>kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">3.6</span><span class="token number">.0</span><span class="token operator">/</span>bin<span class="token operator">/</span>zookeeper<span class="token operator">-</span>server<span class="token operator">-</span>start<span class="token punctuation">.</span>sh <span class="token operator">/</span>opt<span class="token operator">/</span>kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">3.6</span><span class="token number">.0</span><span class="token operator">/</span>config<span class="token operator">/</span>zookeeper<span class="token punctuation">.</span>properties <span class="token operator">&amp;</span>
 
sleep <span class="token number">3</span> #等<span class="token number">3</span>秒后执行
 
#启动kafka
<span class="token operator">/</span>opt<span class="token operator">/</span>kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">3.6</span><span class="token number">.0</span><span class="token operator">/</span>bin<span class="token operator">/</span>kafka<span class="token operator">-</span>server<span class="token operator">-</span>start<span class="token punctuation">.</span>sh <span class="token operator">/</span>opt<span class="token operator">/</span>kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">3.6</span><span class="token number">.0</span><span class="token operator">/</span>config<span class="token operator">/</span>server<span class="token punctuation">.</span>properties <span class="token operator">&amp;</span>
</code></pre> 
<h6><a id="62__kafkaStopsh_105"></a>6.2 创建关闭脚本 kafkaStop.sh</h6> 
<pre><code class="prism language-c">cd <span class="token operator">/</span>opt<span class="token operator">/</span>kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">3.6</span><span class="token number">.0</span><span class="token operator">/</span>
vi kafkaStop<span class="token punctuation">.</span>sh
</code></pre> 
<p>配置关闭脚本 kafkaStop.sh</p> 
<pre><code class="prism language-c">#关闭zookeeper
<span class="token operator">/</span>opt<span class="token operator">/</span>kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">3.6</span><span class="token number">.0</span><span class="token operator">/</span>bin<span class="token operator">/</span>zookeeper<span class="token operator">-</span>server<span class="token operator">-</span>stop<span class="token punctuation">.</span>sh <span class="token operator">/</span>opt<span class="token operator">/</span>kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">3.6</span><span class="token number">.0</span><span class="token operator">/</span>config<span class="token operator">/</span>zookeeper<span class="token punctuation">.</span>properties <span class="token operator">&amp;</span>
 
sleep <span class="token number">3</span> #等<span class="token number">3</span>秒后执行
 
#关闭kafka
<span class="token operator">/</span>opt<span class="token operator">/</span>kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">3.6</span><span class="token number">.0</span><span class="token operator">/</span>bin<span class="token operator">/</span>kafka<span class="token operator">-</span>server<span class="token operator">-</span>stop<span class="token punctuation">.</span>sh <span class="token operator">/</span>opt<span class="token operator">/</span>kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">3.6</span><span class="token number">.0</span><span class="token operator">/</span>config<span class="token operator">/</span>server<span class="token punctuation">.</span>properties <span class="token operator">&amp;</span>
</code></pre> 
<h6><a id="7__120"></a>7 启动脚本，关闭脚本赋予权限</h6> 
<pre><code class="prism language-c">chmod <span class="token number">777</span> kafkaStart<span class="token punctuation">.</span>sh
chmod <span class="token number">777</span> kafkaStop<span class="token punctuation">.</span>sh
</code></pre> 
<p>启动和关闭kafka</p> 
<pre><code class="prism language-c">cd <span class="token operator">/</span>opt<span class="token operator">/</span>kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">3.6</span><span class="token number">.0</span><span class="token operator">/</span> 
sh kafkaStart<span class="token punctuation">.</span>sh #启动
sh kafkaStop<span class="token punctuation">.</span>sh  #关闭
</code></pre> 
<h6><a id="8__topic___topic_132"></a>8 创建生产者 topic 和 消费者 topic</h6> 
<hr> 
<pre><code class="prism language-c">cd <span class="token operator">/</span>opt<span class="token operator">/</span>kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">3.6</span><span class="token number">.0</span><span class="token operator">/</span>bin<span class="token operator">/</span>   #进入kafka目录
<span class="token punctuation">.</span><span class="token operator">/</span>kafka<span class="token operator">-</span>console<span class="token operator">-</span>producer<span class="token punctuation">.</span>sh <span class="token operator">--</span>broker<span class="token operator">-</span>list localhost<span class="token operator">:</span><span class="token number">9092</span> <span class="token operator">--</span>topic test  #创建生产者 test你要建立的topic名

<span class="token punctuation">.</span><span class="token operator">/</span>kafka<span class="token operator">-</span>console<span class="token operator">-</span>consumer<span class="token punctuation">.</span>sh <span class="token operator">--</span>bootstrap<span class="token operator">-</span>server localhost<span class="token operator">:</span><span class="token number">9092</span> <span class="token operator">--</span>topic test #创建消费者
</code></pre> 
<p>​ 查看 kafka 是否启动</p> 
<pre><code class="prism language-c"><span class="token punctuation">[</span>root@localhost kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">3.6</span><span class="token number">.0</span><span class="token punctuation">]</span># jps
<span class="token number">21324</span> QuorumPeerMain 
<span class="token number">15211</span> Jps
<span class="token number">21215</span> Kafka
</code></pre> 
<p>里面有QuorumPeerMain和kafkas说明启动成功了</p> 
<p>查看当前的一些topic</p> 
<pre><code class="prism language-c">cd <span class="token operator">/</span>opt<span class="token operator">/</span>kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">3.6</span><span class="token number">.0</span><span class="token operator">/</span>bin<span class="token operator">/</span>
 
<span class="token punctuation">.</span><span class="token operator">/</span>kafka<span class="token operator">-</span>topics<span class="token punctuation">.</span>sh <span class="token operator">--</span>zookeeper localhost<span class="token operator">:</span><span class="token number">2181</span> <span class="token operator">--</span>list
<span class="token punctuation">.</span><span class="token operator">/</span>kafka<span class="token operator">-</span>topics<span class="token punctuation">.</span>sh <span class="token operator">--</span>list <span class="token operator">--</span>bootstrap<span class="token operator">-</span>server localhost<span class="token operator">:</span><span class="token number">9092</span>
</code></pre> 
<h6><a id="9_Spring_bootKafka_158"></a>9 Spring boot集成Kafka</h6> 
<p>1、pom依赖</p> 
<pre><code class="prism language-c"><span class="token operator">&lt;</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>groupId<span class="token operator">&gt;</span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>kafka<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>artifactId<span class="token operator">&gt;</span>spring<span class="token operator">-</span>kafka<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>dependency<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>groupId<span class="token operator">&gt;</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>artifactId<span class="token operator">&gt;</span>kafka<span class="token operator">-</span>clients<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>version<span class="token operator">&gt;</span><span class="token number">2.4</span><span class="token number">.1</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>

</code></pre> 
<p>2.消费者</p> 
<pre><code class="prism language-c">@Autowired
private KafkaTemplate<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> String<span class="token operator">&gt;</span> kafkaTemplate<span class="token punctuation">;</span>
@<span class="token function">RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/userGets"</span><span class="token punctuation">)</span>
public Object <span class="token function">gets</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// send 第一个参数为topic的名称，第二个参数为我们要发送的信息</span>
    kafkaTemplate<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"topic.quick.default"</span><span class="token punctuation">,</span><span class="token string">"1231235"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">"发送成功"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

@<span class="token function">KafkaListener</span><span class="token punctuation">(</span>topics <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"topic1"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
public <span class="token keyword">void</span> <span class="token function">onMessage</span><span class="token punctuation">(</span>ConsumerRecord<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token punctuation">,</span> <span class="token operator">?</span><span class="token operator">&gt;</span> record<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>record<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

@<span class="token function">KafkaListener</span><span class="token punctuation">(</span>topics <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"topic2"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
public <span class="token keyword">void</span> <span class="token function">getMessage</span><span class="token punctuation">(</span>ConsumerRecord<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> String<span class="token operator">&gt;</span> record<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    String key <span class="token operator">=</span> record<span class="token punctuation">.</span><span class="token function">key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    String value <span class="token operator">=</span> record<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


</code></pre> 
<ol start="3"><li>测试</li></ol> 
<pre><code class="prism language-c"> <span class="token comment">//生产者</span>
 public <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        Properties properties <span class="token operator">=</span> new <span class="token function">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>ProducerConfig<span class="token punctuation">.</span>BOOTSTRAP_SERVERS_CONFIG<span class="token punctuation">,</span> <span class="token string">"localhost:9092"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>ProducerConfig<span class="token punctuation">.</span>KEY_SERIALIZER_CLASS_CONFIG<span class="token punctuation">,</span> StringSerializer<span class="token punctuation">.</span>class<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>ProducerConfig<span class="token punctuation">.</span>VALUE_SERIALIZER_CLASS_CONFIG<span class="token punctuation">,</span> StringSerializer<span class="token punctuation">.</span>class<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        KafkaProducer<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> String<span class="token operator">&gt;</span> producer <span class="token operator">=</span> new KafkaProducer<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
        String topic <span class="token operator">=</span> <span class="token string">"test-topic"</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            String message <span class="token operator">=</span> <span class="token string">"Message "</span> <span class="token operator">+</span> i<span class="token punctuation">;</span>
            producer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>new ProducerRecord<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>topic<span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Sent: "</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        producer<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//消费者</span>
    public <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        Properties properties <span class="token operator">=</span> new <span class="token function">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>ConsumerConfig<span class="token punctuation">.</span>BOOTSTRAP_SERVERS_CONFIG<span class="token punctuation">,</span> <span class="token string">"localhost:9092"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>ConsumerConfig<span class="token punctuation">.</span>GROUP_ID_CONFIG<span class="token punctuation">,</span> <span class="token string">"group1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>ConsumerConfig<span class="token punctuation">.</span>KEY_DESERIALIZER_CLASS_CONFIG<span class="token punctuation">,</span> StringDeserializer<span class="token punctuation">.</span>class<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>ConsumerConfig<span class="token punctuation">.</span>VALUE_DESERIALIZER_CLASS_CONFIG<span class="token punctuation">,</span> StringDeserializer<span class="token punctuation">.</span>class<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        KafkaConsumer<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> String<span class="token operator">&gt;</span> consumer <span class="token operator">=</span> new KafkaConsumer<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//消息者订阅主题</span>
        consumer<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Collections<span class="token punctuation">.</span><span class="token function">singletonList</span><span class="token punctuation">(</span><span class="token string">"test-topic"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//循环</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>true<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//每次拉取 1千条消息</span>
            ConsumerRecords<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> String<span class="token operator">&gt;</span> records <span class="token operator">=</span> consumer<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span>Duration<span class="token punctuation">.</span><span class="token function">ofMillis</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>ConsumerRecord<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> String<span class="token operator">&gt;</span> record <span class="token operator">:</span> records<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"=============&gt; 消费kafka消息："</span><span class="token operator">+</span> record<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>4.配置文件</p> 
<pre><code class="prism language-c">server<span class="token operator">:</span>
    port<span class="token operator">:</span> <span class="token number">8080</span>
spring<span class="token operator">:</span>
    kafka<span class="token operator">:</span>
        bootstrap<span class="token operator">-</span>servers<span class="token operator">:</span> <span class="token number">172.16</span><span class="token number">.253</span><span class="token number">.21</span><span class="token operator">:</span> <span class="token number">9093</span>
        producer<span class="token operator">:</span> # 生产者
            retries<span class="token operator">:</span> <span class="token number">3</span> # 设置大于 <span class="token number">0</span> 的值，则客户端会将发送失败的记录重新发送
            batch<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">16384</span>
            buffer<span class="token operator">-</span>memory<span class="token operator">:</span> <span class="token number">33554432</span>
            acks<span class="token operator">:</span> <span class="token number">1</span>
            # 指定消息key和消息体的编解码方式
            key<span class="token operator">-</span>serializer<span class="token operator">:</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>common<span class="token punctuation">.</span>serialization<span class="token punctuation">.</span>StringSerializer
            value<span class="token operator">-</span>serializer<span class="token operator">:</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>common<span class="token punctuation">.</span>serialization<span class="token punctuation">.</span>StringSerializer
        consumer<span class="token operator">:</span>
            group<span class="token operator">-</span>id<span class="token operator">:</span> <span class="token keyword">default</span><span class="token operator">-</span>group
            enable<span class="token operator">-</span><span class="token keyword">auto</span><span class="token operator">-</span>commit<span class="token operator">:</span> false
            <span class="token keyword">auto</span><span class="token operator">-</span>offset<span class="token operator">-</span>reset<span class="token operator">:</span> earliest
            key<span class="token operator">-</span>deserializer<span class="token operator">:</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>common<span class="token punctuation">.</span>serialization<span class="token punctuation">.</span>StringDeserializer
            value<span class="token operator">-</span>deserializer<span class="token operator">:</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>common<span class="token punctuation">.</span>serialization<span class="token punctuation">.</span>StringDeserializer
            max<span class="token operator">-</span>poll<span class="token operator">-</span>records<span class="token operator">:</span> <span class="token number">500</span>
        listener<span class="token operator">:</span>
        # 当每一条记录被消费者监听器（ListenerConsumer）处理之后提交
        <span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">RECORD</span></span>
        # 当每一批<span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>的数据被消费者监听器（ListenerConsumer）处理之后提交
        <span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">BATCH</span></span>
        # 当每一批<span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>的数据被消费者监听器（ListenerConsumer）处理之后，距离上次提交时间大于TIME时提交
        <span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">TIME</span></span>
        # 当每一批<span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>的数据被消费者监听器（ListenerConsumer）处理之后，被处理record数量大于等于COUNT时提交
        <span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">COUNT</span></span>
        <span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">TIME <span class="token operator">|</span> COUNT　有一个条件满足时提交</span></span>
        <span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">COUNT_TIME</span></span>
        # 当每一批<span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>的数据被消费者监听器（ListenerConsumer）处理之后<span class="token punctuation">,</span> 手动调用Acknowledgment<span class="token punctuation">.</span><span class="token function">acknowledge</span><span class="token punctuation">(</span><span class="token punctuation">)</span>后提交
        <span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">MANUAL</span></span>
        # 手动调用Acknowledgment<span class="token punctuation">.</span><span class="token function">acknowledge</span><span class="token punctuation">(</span><span class="token punctuation">)</span>后立即提交，一般使用这种
        <span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">MANUAL_IMMEDIATE</span></span>
            ack<span class="token operator">-</span>mode<span class="token operator">:</span> MANUAL_IMMEDIATE

</code></pre> 
<p><a href="https://www.kafkatool.com/download.html" rel="nofollow">可视化工具地址</a></p> 
<p><a href="https://www.kafkatool.com/download.html" rel="nofollow">https://www.kafkatool.com/download.html</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6a202dc647655f5c8de309fbc9fe02aa/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">uniapp小程序路由跳转，使用uni.navigateBack方法，实现页面返回上一页</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ac3c0d738d9b619e869d9f67cf24df36/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">rabbitMq的status报错Error: unable to perform an operation on node ‘rabbit……</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>