<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>谷粒商城-全文检索-ElasticSearch - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/92d4908977a57827b5bf0c7e6b80e93a/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="谷粒商城-全文检索-ElasticSearch">
  <meta property="og:description" content="1.简介 一个分布式的开源搜索和分析引擎,可以 秒 级的从海量数据中检索
主要功能:做数据的检索和分析(MySQL专攻于数据的持久化存储与管理CRUD达到百万以上的数据MSQL就会很慢,海量数据的检索和分析还是要用ElasticSearch)
用途:我们电商项目里的所有的检索功能都是由ElasticSearch完成的
底层:开源库 Lucene ,然后对 Lucene 进行封装,提供了 REST API 接口,开箱即用
REST API: 天然的跨平台
版本对应:
1.基本概念 类比MySQL:
1.Index(索引) 1.动词:类似于MySQL的insert: 创建一条数据在 ElasticSearch 里叫 索引一条数据
2.名词:类似于MySQL的Database
2.Type(类型) (es7以后不能再创建多个type,只能用默认的,已被弃用) 在 Index 中可以定义一个或者多个 Type
类似于MySQL 数据库 和 表 的关系:MySQL里叫在某个数据库的某张表里,在ES里叫某个索引的某个类型下
已经没有type了 现在索引就是表 索引还有映射 然后索引库里边存的就是文档了.......
3.Document(文档) 保存在某个索引(Index)下，某种类型(Type)的一个数据(Document)，文档是JSON格式的，Document就像是 MySQL中的某个Table 里面的内容;
4.倒排索引 比如我们保存一条记录:红海行动
ES会先把 红海行动 进行分词,比如分成 红海 和 行动 两个单词,除了存入1号记录 红海行动 这个文档之外,额外又维护了一张 倒排索引表 :倒排索引表就会存 红海 1,行动 1,两个文档
然后我们再来保存2号记录 探索红海行动
先分词成: 探索 红海 行动 ,先存入2号记录 探索红海行动 ,再额外维护 倒排索引表 更新 红海 和 行动的记录 加入 探索 的记录 :红海 1,2 和 行动 1,2 和 探索 2 以此类推.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-18T19:26:16+08:00">
    <meta property="article:modified_time" content="2024-07-18T19:26:16+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">谷粒商城-全文检索-ElasticSearch</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>1.简介</h2> 
<p>一个分布式的开源搜索和分析引擎,可以 秒 级的从海量数据中检索</p> 
<p><strong>主要功能:</strong>做数据的检索和分析(MySQL专攻于数据的持久化存储与管理CRUD达到百万以上的数据MSQL就会很慢,海量数据的检索和分析还是要用ElasticSearch)</p> 
<p><strong>用途:</strong>我们电商项目里的所有的<strong>检索功能</strong>都是由ElasticSearch完成的</p> 
<p><img alt="" height="322" src="https://images2.imgbox.com/a9/e9/KZXPaGPX_o.png" width="418"></p> 
<p><strong>底层</strong>:开源库 <strong>Lucene </strong>,然后对 Lucene 进行封装,提供了 <strong>REST API</strong> 接口,开箱即用</p> 
<p><strong>REST API: </strong>天然的跨平台</p> 
<p>版本对应:</p> 
<p><img alt="" height="524" src="https://images2.imgbox.com/f3/a7/p3rk0RtL_o.png" width="910"></p> 
<h3>1.基本概念</h3> 
<p>类比MySQL:</p> 
<p><img alt="" height="510" src="https://images2.imgbox.com/59/6a/Obp830Y8_o.png" width="1029"></p> 
<h4>1.Index(索引)</h4> 
<p>1.动词:类似于MySQL的insert: 创建一条数据在 ElasticSearch 里叫 索引一条数据</p> 
<p>2.名词:类似于MySQL的Database</p> 
<h4>2.Type(类型) (es7以后不能再创建多个type,只能用默认的,已被弃用)</h4> 
<p>在 Index 中可以定义一个或者多个 Type</p> 
<p>类似于MySQL 数据库 和 表 的关系:MySQL里叫在某个数据库的某张表里,在ES里叫某个索引的某个类型下</p> 
<p>已经没有type了 现在索引就是表 索引还有映射  然后索引库里边存的就是文档了.......</p> 
<h4>3.Document(文档)</h4> 
<p>保存在某个索引(Index)下，某种类型(Type)的一个数据(Document)，文档是JSON格式的，Document就像是 MySQL中的某个Table 里面的内容;</p> 
<h4>4.倒排索引</h4> 
<p><img alt="" height="402" src="https://images2.imgbox.com/51/e5/MD1DRpYe_o.png" width="869"></p> 
<p>比如我们保存一条记录:红海行动</p> 
<p>ES会先把 红海行动 进行分词,比如分成 红海 和 行动 两个单词,除了存入1号记录 红海行动 这个文档之外,额外又维护了一张 倒排索引表 :倒排索引表就会存 红海 1,行动 1,两个文档</p> 
<p>然后我们再来保存2号记录 探索红海行动</p> 
<p>先分词成: 探索 红海 行动 ,先存入2号记录 探索红海行动 ,再额外维护 倒排索引表 更新 红海 和 行动的记录 加入 探索 的记录 :红海 1,2 和 行动 1,2 和 探索 2 </p> 
<p>以此类推....</p> 
<p>然后当我们检索时 输入 红海特工行动 它也会分词成为 红海 特工 行动 三个单词,然后会从倒排索引表里找到 红海 特工 行动  这三个词的记录 就会查到 12345条记录,但是哪一个才是更贴和我们的搜索目标呢,引入一个<strong>相关性得分(比如3号记录共有3个单词命中了两个,相关性得分2/3)</strong>,我们就会根据相关性得分从高到低排序</p> 
<h3>2.Docker安装(国内镜像已经停用了,解决谷粒商城docker pull的问题)</h3> 
<h4>替换视频中的docker镜像,直接装在centOS7上</h4> 
<p><a href="https://blog.csdn.net/rubys007/article/details/140024151" title="在CentOS 7上安装和配置Elasticsearch的方法_centos7搭建elasticsearch-CSDN博客">在CentOS 7上安装和配置Elasticsearch的方法_centos7搭建elasticsearch-CSDN博客</a></p> 
<p>然后要在elasticsearch.yml上添加这个配置: http.host: 0.0.0.0</p> 
<p>然后安装kibana:</p> 
<p>参考这个博主:</p> 
<p><a href="https://blog.csdn.net/qq_31464633/article/details/139500957" title="CentOS 7 上安装 Kibana 7.12.1_kibana 7.12.1 license-CSDN博客">CentOS 7 上安装 Kibana 7.12.1_kibana 7.12.1 license-CSDN博客</a></p> 
<p>做完这两个博主的内容就能跳过视频P104</p> 
<h3>3.初步检索</h3> 
<p>因为封装成 <strong>REST API,</strong>我们直接使用APIfox发请求就能用</p> 
<h4>1._cat</h4> 
<p>GET/_cat/nodes:查看所有节点</p> 
<p><img alt="" height="950" src="https://images2.imgbox.com/fb/f6/81DzDsZv_o.png" width="1200"><br> GET/_cat/health:查看 es 健康状况</p> 
<p><img alt="" height="950" src="https://images2.imgbox.com/c6/ca/k2c02QTj_o.png" width="1200"><br> GET/_cat/master:查看主节点</p> 
<p><img alt="" height="950" src="https://images2.imgbox.com/42/b9/xR4Hbykg_o.png" width="1200"><br> GET/ cat/indices:查看所有索引 相当于MySQL里的show databases;</p> 
<p><img alt="" height="950" src="https://images2.imgbox.com/44/cc/k35SK9ni_o.png" width="1200"></p> 
<h4>2.索引一个文档(保存)</h4> 
<p>因为ES8以后不能创建多个type所以我们用到的请求是</p> 
<p><img alt="" height="52" src="https://images2.imgbox.com/ad/b5/X7GCNt1Z_o.png" width="982"></p> 
<p>emmmES7应该只是化了type的概念,跟着视频里应该也可以,因为我们这里装的是7.9.2的ES</p> 
<p>我建议还是使用post发/_doc吧,以后会慢慢更新淘汰掉视频里的语法的</p> 
<p>视频中的方法:</p> 
<p><img alt="" height="772" src="https://images2.imgbox.com/bc/ee/2xZD9tnr_o.png" width="1159"></p> 
<p>POST:</p> 
<p><img alt="" height="904" src="https://images2.imgbox.com/7c/16/LrUdkP65_o.png" width="1016"></p> 
<h4>3.查询文档(乐观锁)</h4> 
<p><img alt="" height="797" src="https://images2.imgbox.com/ed/0f/SaQ8GTBV_o.png" width="1005"></p> 
<p>乐观锁,当他们并发发送请求的时候,可以加上判断条件if_seq_no=3,当seq_no=3时才能操作成功,且成功后seq_no会改变,当另一条请求也带上判断条件if_seq_no=3时,操作就会失败</p> 
<p>模拟并发更改:</p> 
<p>同时对id为1的数据发送put请求更改name:</p> 
<p><img alt="" height="103" src="https://images2.imgbox.com/cc/23/Nhtlteql_o.png" width="414"></p> 
<p><img alt="" height="110" src="https://images2.imgbox.com/9a/2a/gaymSLbC_o.png" width="449"></p> 
<p>当第一条请求带上乐观锁操作发出去且seq_no=3时</p> 
<p><img alt="" height="775" src="https://images2.imgbox.com/be/47/9cgUsq0m_o.png" width="1063"></p> 
<p>此时再发送第二条请求也带上乐观锁操作让seq_no=3时:</p> 
<p><img alt="" height="799" src="https://images2.imgbox.com/32/8a/GFG9q3El_o.png" width="1003"></p> 
<h4>4.更新文档</h4> 
<p>POST:</p> 
<p>当带了_update 语法一定要带上 doc</p> 
<p>_update会对比原数据,如果本次传的数据和原数据一模一样,版本号就不会加,操作就是noop(没有操作),序列号(_seq_no)也不变</p> 
<p><img alt="" height="181" src="https://images2.imgbox.com/44/e2/QqNxx8GQ_o.png" width="559"></p> 
<p>不带_update 语法不加 doc://等同于PUT不加_update</p> 
<p>不会检测原数据直接更新,版本号,序列号都会加</p> 
<p><img alt="" height="233" src="https://images2.imgbox.com/99/d5/QliR89cO_o.png" width="826"></p> 
<p><img alt="" height="165" src="https://images2.imgbox.com/c8/ea/80d0RoPm_o.png" width="489"></p> 
<h4>5.删除文档</h4> 
<p><img alt="" height="82" src="https://images2.imgbox.com/bc/01/IxmVy5Ya_o.png" width="346"></p> 
<h4>6.bulk批量API</h4> 
<p>必须发POST请求</p> 
<p><img alt="" height="546" src="https://images2.imgbox.com/a9/7d/l4n2S9WH_o.png" width="869"></p> 
<p>来到Kiana</p> 
<p><img alt="" height="933" src="https://images2.imgbox.com/eb/8b/gJDA8ZsC_o.png" width="1200"></p> 
<p><img alt="" height="741" src="https://images2.imgbox.com/8e/3d/ggcWfYc3_o.png" width="1200"></p> 
<p>批量保存测试数据:</p> 
<p><a href="https://gitee.com/xlh_blog/common_content/blob/master/es%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE.json#" rel="nofollow" title="es测试数据.json · 坐看云起时/common_content - Gitee.com">es测试数据.json · 坐看云起时/common_content - Gitee.com</a></p> 
<p><img alt="" height="650" src="https://images2.imgbox.com/35/03/Gi1zinJ5_o.png" width="1200"></p> 
<h3>4.进阶检索</h3> 
<h4>1.SearchAPI</h4> 
<p>ES 支持两种基本方式检索</p> 
<p>        一个是通过使用 REST request URl 发送搜索参数(uri+检索参数)</p> 
<p><img alt="" height="805" src="https://images2.imgbox.com/b1/02/kYN1OO5k_o.png" width="1200"></p> 
<p>        另一个是通过使用 REST requestbody 来发送它们(uri+请求体)</p> 
<p><img alt="" height="666" src="https://images2.imgbox.com/9b/2d/FVYtydOT_o.png" width="1200"></p> 
<h4>2.Query DSL(查询领域对象语言)上面第二种方法的请求体</h4> 
<h5>1.基本语法格式</h5> 
<p><img alt="" height="345" src="https://images2.imgbox.com/ac/aa/aPTtUbkm_o.png" width="764"></p> 
<h5>2.只返回部分字段</h5> 
<p>"_source":["name","age"],只返回name和age字段</p> 
<p><img alt="" height="380" src="https://images2.imgbox.com/93/e4/OyRxSXk0_o.png" width="1200"></p> 
<h5>3.match匹配查询</h5> 
<p>match,条件查询指定的是一个非字符串的属性,就是精确查询</p> 
<p><img alt="" height="547" src="https://images2.imgbox.com/d9/92/knFgViSv_o.png" width="1200"></p> 
<p>当指定的是字符串的属性就是模糊查询:(全文检索)(倒排索引),最终会按照评分去进行排序,会对检索的字符串进行分词</p> 
<p><img alt="" height="615" src="https://images2.imgbox.com/48/3e/DHfbHvc4_o.png" width="1200"></p> 
<h5>4.match_phrase(短语匹配)</h5> 
<p>对字符串不进行分词(精确查询)</p> 
<p><img alt="" height="320" src="https://images2.imgbox.com/08/fa/gGm8HcKg_o.png" width="841"></p> 
<h5>5.multi_match(多字段匹配)</h5> 
<p><img alt="" height="328" src="https://images2.imgbox.com/b8/24/MAE7pCIX_o.png" width="846"></p> 
<h5>6.bool(复合查询)</h5> 
<p>must:必须满足,</p> 
<p>must_not:必须不满足</p> 
<p>should:应该,满足最好,不满足也行(满足了加评分,会排在前面)</p> 
<p><img alt="" height="546" src="https://images2.imgbox.com/1c/31/bwjnZDS4_o.png" width="1200"></p> 
<p><img alt="" height="505" src="https://images2.imgbox.com/04/1b/sGI4cpxA_o.png" width="1200"></p> 
<h5>7.filter(结果过滤)</h5> 
<p>不会贡献文档的<strong>相关性得分</strong></p> 
<p>不用filter:</p> 
<p><img alt="" height="772" src="https://images2.imgbox.com/c7/2c/vVaTVCYC_o.png" width="1200"></p> 
<p>用了filter</p> 
<p><img alt="" height="705" src="https://images2.imgbox.com/4c/1e/Z6QOb6kJ_o.png" width="1200"></p> 
<h5>8.term</h5> 
<p>类似于match,term用来找精确值字段,例如age</p> 
<p>match用来全文检索,字符串模糊查询用,例如address</p> 
<p>文本用match，数字用term</p> 
<p>另外,区别 match_phrase 和 属性名.keyword :</p> 
<p><img alt="" height="404" src="https://images2.imgbox.com/7d/53/bAF4k5zv_o.png" width="774"></p> 
<h5>9.aggregations(执行聚合)</h5> 
<p>分析和检索是一次性的:一次请求过去,我们既能查出数据,也能把数据分析到位</p> 
<p>例如需求是:搜索 address 中包含 mill 的所有人的年龄分布以及平均年龄，但不显示这些人的详情。</p> 
<p>先看看查出所有 address 中包含 mill 的所有人, 并列举出他们的年龄分布</p> 
<p><img alt="" height="717" src="https://images2.imgbox.com/35/9a/dw6N2JHA_o.png" width="1200"></p> 
<p>再加一个平均值聚合</p> 
<p><img alt="" height="723" src="https://images2.imgbox.com/dd/54/xqesSHSj_o.png" width="1200"></p> 
<p>如何不看这些人的详细信息呢,我们让size=0,就可以只看聚合结果:</p> 
<p><img alt="" height="738" src="https://images2.imgbox.com/28/38/8Xp7nPD8_o.png" width="1200"></p> 
<p>进阶:子聚合 按照年龄聚合，并且请求这些年龄段的这些人的平均薪资</p> 
<p><img alt="" height="469" src="https://images2.imgbox.com/53/fb/PFpxcSn4_o.png" width="738"></p> 
<p>就可以查到如下结果:</p> 
<p><img alt="" height="293" src="https://images2.imgbox.com/c5/73/j9pEV0z2_o.png" width="650"></p> 
<p>再进阶:查出所有年龄分布，并且这些年龄段中M(男)的平均薪资和F(女)的平均薪资以及这个年龄<br> 段的总体平均薪资</p> 
<p><img alt="" height="775" src="https://images2.imgbox.com/70/80/DmCrXX8C_o.png" width="1200"></p> 
<h4>3.Mapping映射</h4> 
<p>定义一个文档如何被进行处理的:例如我们可以定义那个string类型的字段是可以被当作全文检索的</p> 
<p>像是创建SQL表时定义每一列数据类型是什么</p> 
<h5>1.字段类型</h5> 
<p>ES会在第一次保存数据的时候自动猜测数据类型</p> 
<h5>2.映射</h5> 
<p>就是每一个文档的数据类型是什么</p> 
<p>我们可以查看mapping信息</p> 
<p><img alt="" height="668" src="https://images2.imgbox.com/17/d9/BIlbPxjX_o.png" width="1200"></p> 
<p>我们也可以在创建索引时指定映射(有很多类型,可以参考文档)</p> 
<p><img alt="" height="332" src="https://images2.imgbox.com/0b/00/Xllzhx9R_o.png" width="627"></p> 
<h6>1.修改映射</h6> 
<p>1.添加新的字段映射:</p> 
<p><img alt="" height="293" src="https://images2.imgbox.com/b9/03/OGpV3wzN_o.png" width="661"></p> 
<p>2.修改已经存在的字段</p> 
<p>对于已经存在的映射字段,我我们是不能更新的</p> 
<p>3.数据迁移</p> 
<p>因为映射不支持修改,我们想要修改,能用的办法就是新建一个映射字段,把数据迁移进去:</p> 
<p>先创建一个新索引</p> 
<p><img alt="" height="762" src="https://images2.imgbox.com/10/4c/JVldiFFl_o.png" width="1200"></p> 
<p>下一步数据迁移:</p> 
<p>这是没有type的写法</p> 
<p><img alt="" height="295" src="https://images2.imgbox.com/a9/71/78F03EvG_o.png" width="480"></p> 
<p><img alt="" height="576" src="https://images2.imgbox.com/03/da/qNtZ7VOS_o.png" width="1200"></p> 
<h4>4.分词</h4> 
<p>一个  tokenizer(分词器)  接收一个字符流，将之分割为独立的 tokens(词元，通常是独立的单词)，然后输出 tokens 流。例如，whitespace tokenizer遇到空白字符时分割文本。它会将文本"Quick brown fox!"分割为 [Quick, brown, fox!]。<br> 该 tokenizer(分词器)  还负责记录各个term(词条) 的顺序或 position 位置(用于 phrase 短语和 word proximity词近邻查询)，以及 term(词条)所代表的原始word(单词)的 start(起始)和 end(结束)的 characteroffsets(字符偏移量)(用于高亮显示搜索的内容)。</p> 
<p>Elasticsearch提供了很多内置的分词器，可以用来构建custom analyzers(自定义分词器)</p> 
<p>为虚拟机的elasticsearch装ik分词器:</p> 
<p>找到<a href="https://github.com/infinilabs/analysis-ik/releases?page=9" title="Releases · infinilabs/analysis-ik · GitHub">Releases · infinilabs/analysis-ik · GitHub</a>对应的版本(我用的7.9.2)</p> 
<p>解压放在ik文件夹里放进plugins目录下,重启elasticsearch服务</p> 
<p>测试分词:</p> 
<p><img alt="" height="733" src="https://images2.imgbox.com/37/2c/9prOIadl_o.png" width="1200"></p> 
<p>创建自定义词库:</p> 
<p>下载nginx:</p> 
<p><a href="https://blog.csdn.net/weixin_46107120/article/details/135828785" title="CentOS7下安装NGINX_centos7下载nginx-CSDN博客">CentOS7下安装NGINX_centos7下载nginx-CSDN博客</a>,跟着这个步骤来,记得开防火墙的80端口,然后在/usr/local/nginx/html这个路径下新建es文件夹,fenci.txt,会出现乱码问题,后续解决;</p> 
<p>配置ik分词器的远程词库地址:</p> 
<p>来到ik的config文件夹:</p> 
<p><img alt="" height="268" src="https://images2.imgbox.com/c5/be/rrEQCk6t_o.png" width="736"></p> 
<p>至此,新词就可以添加进/usr/local/nginx/html/es文件夹下的fenci.txt</p> 
<h3>5.Elasticsearch-Rest-Client</h3> 
<p>新建模块:</p> 
<p><img alt="" height="372" src="https://images2.imgbox.com/42/02/ZEkvNDSs_o.png" width="508"></p> 
<p>修改配置文件,添加依赖:</p> 
<p><img alt="" height="480" src="https://images2.imgbox.com/8a/f6/pWV9jiEI_o.png" width="1200"></p> 
<p>新建config包,<img alt="" height="229" src="https://images2.imgbox.com/d0/24/r1wip2f4_o.png" width="1200"></p> 
<p>添加common依赖,配置nacos注册中心:</p> 
<p><img alt="" height="400" src="https://images2.imgbox.com/05/c5/yXrakJ8x_o.png" width="1200"></p> 
<p>启用服务注册发现:</p> 
<p><img alt="" height="261" src="https://images2.imgbox.com/97/2a/ZrrmgBpJ_o.png" width="1200"></p> 
<p>引入ElasticSearch-Rest-Client的步骤;</p> 
<p>1.在pom文件里导入依赖</p> 
<p>2.给容器中注入一个RestHighLevelClient</p> 
<p><img alt="" height="431" src="https://images2.imgbox.com/fa/8d/ts27XfLm_o.png" width="1110"></p> 
<p>3.参照官方API进行操作:<a href="https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/java-rest-high.html" rel="nofollow" title="Java High Level REST Client | Java REST Client [7.17] | Elastic">Java High Level REST Client | Java REST Client [7.17] | Elastic</a></p> 
<p>RequestOptions:请求设置项:</p> 
<p><img alt="" height="268" src="https://images2.imgbox.com/d2/5e/jfUxTrk8_o.png" width="1131"></p> 
<p>开始测试:</p> 
<p>1.index:(保存更新都可以)</p> 
<p><img alt="" height="559" src="https://images2.imgbox.com/f1/78/pAHQ2lDG_o.png" width="1200"></p> 
<p><img alt="" height="348" src="https://images2.imgbox.com/6e/b6/FsK7vIzr_o.png" width="1200"></p> 
<p>2.复杂检索:</p> 
<p>1.先构造一个检索请求searchRequest</p> 
<p>2.构造检索条件:</p> 
<p>query条件构造:</p> 
<p><img alt="" height="396" src="https://images2.imgbox.com/72/ea/WXg0BWCH_o.png" width="1173"></p> 
<p><img alt="" height="621" src="https://images2.imgbox.com/5b/1e/U1eISK5F_o.png" width="1084"></p> 
<p>聚合条件构造:嵌套使用 .subAggregation()</p> 
<p><img alt="" height="442" src="https://images2.imgbox.com/76/8f/NRrFJBJn_o.png" width="1200"></p> 
<p>获取查询结果:<img alt="" height="251" src="https://images2.imgbox.com/12/5f/Y848UM26_o.png" width="1079"></p> 
<p>获取分析数据:</p> 
<p><img alt="" height="617" src="https://images2.imgbox.com/f7/34/oAOW5YR4_o.png" width="1073"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9ae03779a89c3c0203e990346cbe5872/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【排序算法】—— 计数排序</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9dc006e3ea9f48e9a76d8fbaa86c1c4c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">香橙派AIpro-携手华为-为AI赋能</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>