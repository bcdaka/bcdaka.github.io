<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>大数据开发工作中的数仓设计（Hadoop，hive ，mysql ） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/10937de8f94988bc10446c62e1ad2572/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="大数据开发工作中的数仓设计（Hadoop，hive ，mysql ）">
  <meta property="og:description" content="1.HUE工具介绍使用 HUE是CDH提供一个hive和hdfs的操作工具，在hue中编写了hiveSQl也可以操作hdfs的文件
http://主机名字:端口号 hdfs的web访问端口
http://主机名字:端口号 hdfs的程序访问端口
进入后确保hdfs hive yarn 开启 在点击hue开启
在这里面也可以进行hive的sql操作，但是不太建议，依旧还是使用datagrip进行操作
2.数仓介绍 数据仓库是由一整套体系构成，包含数据采集，数据存储，数据计算，数据展示等
数据仓库主要作用对过往的历史数据进行分析处理，为公司决策停供数据支撑。
2-1 数仓特征 面向主题
集成性
非易失性
时变性
2-2 OLTP和OLAP OLTP（On-Line Transaction Processing）即联机事务处理，也称为面向交易的处理过程，
OLAP（On-Line Analytical Processing）即联机分析处理，有时也称为决策支持系统（DSS）
2-3 ETL ETL（Extra, Transfer, Load）包括数据抽取、数据转换、数据导入三个过程。
3.主题和主题域 主题 是对数据进行归类，每个分类是一个主题
主题域 根据分析的领域，将联系较为紧密的数据主题的集合在一起
主题域下面可以有多个主题，主题还可以划分成更多的子主题，主题和主题之间的建设可能会有交叉现象
3-2 主题域的划分 按照系统划分
生产系统 生产主题域
商品原材料库存核销数据 商品主题
订单主题
财务系统
商品原材料库存核销数据 商品主题
销售主题
人力系统
按照部门划分
人力部门 人力主题域
员工主题 员工数据
招聘主题 招聘数据
生产部门
销售部门
后勤部门
按照业务划分
门店零售业务
批发业务
团购业务
按照行业经验
银行证券业">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-29T19:48:45+08:00">
    <meta property="article:modified_time" content="2024-04-29T19:48:45+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">大数据开发工作中的数仓设计（Hadoop，hive ，mysql ）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 style="background-color:transparent;">1.HUE工具介绍使用</h2> 
<p>HUE是CDH提供一个hive和hdfs的操作工具，在hue中编写了hiveSQl也可以操作hdfs的文件</p> 
<p><a href="http://hadoop01:9870" rel="nofollow" title="http://主机名字:端口号">http://主机名字:端口号</a> hdfs的web访问端口</p> 
<p>http://主机名字:端口号 hdfs的程序访问端口</p> 
<p></p> 
<p><img alt="" height="445" src="https://images2.imgbox.com/fa/8a/sLycTqRJ_o.png" width="600"></p> 
<p>进入后确保hdfs hive yarn 开启 在点击hue开启</p> 
<p><img alt="" height="456" src="https://images2.imgbox.com/4c/21/fJFG1z0G_o.png" width="936"></p> 
<p>在这里面也可以进行hive的sql操作，但是不太建议，依旧还是使用datagrip进行操作</p> 
<h2 style="background-color:transparent;">2.数仓介绍</h2> 
<p></p> 
<p>数据仓库是由一整套体系构成，包含数据采集，数据存储，数据计算，数据展示等</p> 
<p>数据仓库主要作用对过往的历史数据进行分析处理，为公司决策停供数据支撑。</p> 
<h4>2-1 数仓特征</h4> 
<ul><li> <p>面向主题</p> </li><li> <p>集成性</p> </li><li> <p>非易失性</p> </li><li> <p>时变性</p> </li></ul> 
<h4>2-2 OLTP和OLAP</h4> 
<p></p> 
<p>OLTP（On-Line Transaction Processing）即联机事务处理，也称为面向交易的处理过程，</p> 
<p>OLAP（On-Line Analytical Processing）即联机分析处理，有时也称为决策支持系统（DSS）</p> 
<p></p> 
<h4>2-3 ETL</h4> 
<blockquote> 
 <p>ETL（Extra, Transfer, Load）包括<strong>数据抽取、数据转换、数据导入</strong>三个过程。</p> 
</blockquote> 
<h2>3.主题和主题域</h2> 
<blockquote> 
 <p><strong><code>主题</code></strong> 是对数据进行归类，每个分类是一个主题</p> 
</blockquote> 
<blockquote> 
 <p><strong><code>主题域</code></strong> 根据分析的领域，将联系较为紧密的数据主题的集合在一起</p> 
</blockquote> 
<blockquote> 
 <p>主题域下面可以有多个主题，主题还可以划分成更多的子主题，主题和主题之间的建设可能会有交叉现象</p> 
</blockquote> 
<p></p> 
<h4>3-2 主题域的划分</h4> 
<p></p> 
<ul><li> <p>按照系统划分</p> 
  <ul><li> <p>生产系统 生产主题域</p> 
    <ul><li> <p>商品原材料库存核销数据 商品主题</p> </li><li> <p>订单主题</p> </li></ul></li><li> <p>财务系统</p> 
    <ul><li> <p>商品原材料库存核销数据 商品主题</p> </li><li> <p>销售主题</p> </li></ul></li><li> <p>人力系统</p> </li></ul></li><li> <p>按照部门划分</p> 
  <ul><li> <p>人力部门 人力主题域</p> 
    <ul><li> <p>员工主题 员工数据</p> </li><li> <p>招聘主题 招聘数据</p> </li></ul></li><li> <p>生产部门</p> </li><li> <p>销售部门</p> </li><li> <p>后勤部门</p> </li></ul></li><li> <p>按照业务划分</p> 
  <ul><li> <p>门店零售业务</p> </li><li> <p>批发业务</p> </li><li> <p>团购业务</p> </li></ul></li><li> <p>按照行业经验</p> 
  <ul><li> <p>银行证券业</p> 
    <ul><li> <p>当事人、产品、协议、事件、资产、财务、机构、地域、营销、渠道</p> </li></ul></li></ul></li></ul> 
<h2 style="background-color:transparent;">4.数据仓库和数据集市</h2> 
<p></p> 
<p><code>数据集市</code>就是<code>数据仓库</code>的一个子集，它主要面向部门级业务，并且只面向某个特定的主题</p> 
<p>数据集市由业务部门定义、设计和开发，业务部门进行管理和维护</p> 
<p></p> 
<p><img alt="" height="442" src="https://images2.imgbox.com/f4/82/srUYf9m4_o.png" width="951"></p> 
<h2>5. 数仓设计</h2> 
<h4>5-1 定义规范设计</h4> 
<ul><li> <p>表命名</p> 
  <ul><li> <p><code>分层_主题_实体+业务+维度_分区</code></p> </li></ul></li></ul> 
<p>分层 ods，dw，dwd</p> 
<p>主题 sale（销售主题） user（用户主题）</p> 
<p>实体+业务+维度</p> 
<ul><li> <p>示例：</p> 
  <ul><li> <p>store_goods_statistics_day</p> </li><li> <p>store_member_statistics_day</p> </li><li> <p>mysql中的表名+计算维度</p> </li></ul></li></ul> 
<p>ods_sale_store_goods_statistics_day_dt</p> 
<blockquote> 
 <p>规范不是前置要求，不同公司可能根据业务设计表名</p> 
</blockquote> 
<ul><li> <p>字段类型规范</p> 
  <ul><li> <p>数量类型整数为bigint</p> </li><li> <p>金额类型为decimal(27, 2)，表示：27位有效数字，其中小数部分2位</p> </li><li> <p>数量类型小数为decimal(27, 3)，表示：27位有效数字，其中小数部分3位</p> </li><li> <p>字符串(名字，描述信息等)类型为string</p> </li><li> <p>日期类型为string</p> </li><li> <p>时间类型为timestamp</p> </li></ul></li></ul> 
<h4>5-2 数仓分层设计</h4> 
<p></p> 
<blockquote> 
 <p>数据仓库最基础分层 ，分层本质就是创建不同的数据库，</p> 
 <p>原始数据层 ODS</p> 
 <ul><li> <p>将数据源的数据导入数仓ods层</p> </li><li> <p>创建一个ods的数据库，然后按照数据源中的表创建ods库下的hive表</p> </li></ul> 
 <p>数据仓库层 DW 数据处理</p> 
 <p>数据服务层 ADS 计算结果</p> 
</blockquote> 
<p>数据分层设计到的有什么作用？</p> 
<blockquote> 
 <ul><li> <p>简化复杂问题。</p> 
   <ul><li> <p>通过将复杂的数据处理过程分解为多个步骤或层次，可以使问题更加易于理解和处理。</p> </li><li> <p>select sum(age) from tb1 join tb2 on tb1.id =tb2.id where age &gt; 20 group by gender</p> </li></ul></li><li> <p>结构更清晰。</p> 
   <ul><li> <p>每个数据层都有其明确的作用域，这有助于在使用表时方便地定位和理解。</p> </li></ul></li><li> <p>数据血缘追踪。</p> 
   <ul><li> <p>分层结构使得数据血缘关系更加明确，便于追踪和调试。</p> </li></ul></li><li> <p>用空间换时间。</p> 
   <ul><li> <p>通过预处理大量数据，可以提高应用系统的用户体验（效率），虽然这可能导致数据仓库中存在冗余数据。</p> </li></ul></li><li> <p>数据重复使用，减少重复开发。</p> 
   <ul><li> <p>规范的数据分层可以促进数据和指标的统一，减少重复开发，并提高数据复用率。</p> </li></ul></li><li> <p>数据隔离和屏蔽原始数据异常。</p> 
   <ul><li> <p>分层结构可以帮助隔离原始数据的异常或敏感性，保护真实数据与统计数据解耦。</p> </li></ul></li><li> <p>数据安全。</p> 
   <ul><li> <p>通过分层，可以更方便地对不同层的数据进行权限管理，屏蔽敏感数据。</p> </li></ul></li><li> <p>增强扩展性和便于后期维护。</p> 
   <ul><li> <p>不分层可能会导致整个数据清洗过程受到源业务系统规则变化的影响，而分层可以简化数据清洗过程，提高扩展性，便于后期维护。</p> </li></ul></li></ul> 
</blockquote> 
<p><img alt="" height="1077" src="https://images2.imgbox.com/a3/03/mSUXshk7_o.png" width="852"></p> 
<h4>5-3 数仓建模设计</h4> 
<p>数仓建模本质就是在数仓中如何设计表存储计算数据</p> 
<p>数仓一般采用维度建模方式来设计不同的表</p> 
<p>维度模型是Ralph Kimall所倡导，他的《数据仓库工具箱》是数据仓库工程领域最流行的数仓建模经典。维度建模以分析决策的需求出发构建模型，构建的数据模型为分析需求服务，因此它重点解决用户如何更快速完成分析需求，同时还有较好的大规模复杂查询的响应性能。</p> 
<p></p> 
<p></p> 
<blockquote> 
 <p>在DWD层确认维度表和事实表，然后将事实表和维度表数据进行管理</p> 
 <p>在DWM层进行主题宽表关联</p> 
</blockquote> 
<p>众多模型中最实用的是星座模型</p> 
<p><img alt="" height="715" src="https://images2.imgbox.com/ea/f4/sPgqW1ta_o.png" width="966"></p> 
<h2>6.DIM维度层数据处理</h2> 
<p></p> 
<h5>I-hive表的中文问题解决</h5> 
<p>首先需要把hive中要传输的表的类型进行更改 使用alter table字段变为 set utf8  因为utf8可以显示中文</p> 
<p></p> 
<h5>II-创建DIM层表</h5> 
<p></p> 
<p>创建原始数据表，根据mysql中的维度表字段数据创建dim层中表数据</p> 
<p>表需要进行分区，一天为单位进行分区保存数据</p> 
<p></p> 
<h5>III-导入dataxweb任务</h5> 
<p>需要把需要导入的字段写入dataxweb 或者自己手动进行json文件进行 mysql导入hive中的操作 （上一章节有格式以及教程）</p> 
<h5>IV-执行datax任务导入ods原始表数据</h5> 
<p>在datax 中进行执行</p> 
<h5>V-处理维度表数据</h5> 
<p>-- 开启动态分区方案<br> -- 开启非严格模式<br> set hive.exec.dynamic.partition.mode=nonstrict;<br> -- 开启动态分区支持(默认true)<br> set hive.exec.dynamic.partition=true;<br> -- 设置各个节点生成动态分区的最大数量: 默认为100个  (一般在生产环境中, 都需要调整更大)<br> set hive.exec.max.dynamic.partitions.pernode=10000;<br> -- 设置最大生成动态分区的数量: 默认为1000 (一般在生产环境中, 都需要调整更大)<br> set hive.exec.max.dynamic.partitions=100000;<br> -- hive一次性最大能够创建多少个文件: 默认为10w<br> set hive.exec.max.created.files=150000;</p> 
<p><br> -- hive压缩<br> -- 开启中间结果压缩<br> set hive.exec.compress.intermediate=true;<br> -- 开启最终结果压缩<br> set hive.exec.compress.output=true;<br> -- 写入时压缩生效<br> set hive.exec.orc.compression.strategy=COMPRESSION;</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/334dfc4307cb57cf656549f7e38fc5a3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Android studio报错Caused by: org.gradle.api.internal.plugins.</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6898c1c47257c2690a43451a32bcfc8c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">(python)cf火线瞄准红名自动开枪</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>