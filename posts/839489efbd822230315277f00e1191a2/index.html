<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C#WinForm连接sql server数据库进行增删改查详细步骤（包会） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/839489efbd822230315277f00e1191a2/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="C#WinForm连接sql server数据库进行增删改查详细步骤（包会）">
  <meta property="og:description" content="1 需要下载的软件vs2022社区版，sql server
1.1 vs2022社区版 下载完成后点击新建项目，创建windows窗体应用，如图：
1.2 在创建好的窗体应用中创建一个button控件和一个datagrewview控件，如图所示：
2 下载sql server数据库，创建自己的账户和密码，进行登录 如下图所示：
2.1 创建20240401数据库 在其中创建学生信息表 如下图所示：
3 在vs中点击工具，连接到数据库，输入自己的服务器名字和数据库的账户，密码进行连接 如下图所示：
3.1 双击button控件 编写代码 如下所示 注意：代码中的ip 数据库名称，表名称要更换为自己的名称
using System.Data;
using System.Data.SqlClient;
using System.Windows.Forms;
namespace _2024042501
{
public partial class Form1 : Form
{
public Form1()
{
InitializeComponent();
}
private void button1_Click(object sender, EventArgs e)
{
//连接
string conStr = &#34;server=DESKTOP-N0NGI; user id = xx; password = 123456; database = 数据库&#34;;
SqlConnection con = new SqlConnection(conStr);">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-07T14:41:32+08:00">
    <meta property="article:modified_time" content="2024-05-07T14:41:32+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C#WinForm连接sql server数据库进行增删改查详细步骤（包会）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>1 需要下载的软件vs2022社区版，sql server</p> 
<p>1.1 vs2022社区版 下载完成后点击新建项目，创建windows窗体应用，如图：</p> 
<p><img alt="" src="https://images2.imgbox.com/11/e7/KTj7vG4i_o.png"></p> 
<p>1.2 在创建好的窗体应用中创建一个button控件和一个datagrewview控件，如图所示：</p> 
<p><img alt="" src="https://images2.imgbox.com/0a/75/UWXP723e_o.png"></p> 
<p>2 下载sql server数据库，创建自己的账户和密码，进行登录 如下图所示：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/c2/56/ry9hMKW9_o.png"></p> 
<p>2.1 创建20240401数据库 在其中创建学生信息表 如下图所示：</p> 
<p><img alt="" src="https://images2.imgbox.com/92/f2/gIdRSOuD_o.png"></p> 
<p>3 在vs中点击工具，连接到数据库，输入自己的服务器名字和数据库的账户，密码进行连接 如下图所示：</p> 
<p><img alt="" src="https://images2.imgbox.com/c2/ef/pv17Sv3W_o.png">3.1 双击button控件 编写代码 如下所示 注意：代码中的ip 数据库名称，表名称要更换为自己的名称</p> 
<p>using System.Data;<br> using System.Data.SqlClient;<br> using System.Windows.Forms;<br> namespace _2024042501<br> {<!-- --><br>     public partial class Form1 : Form<br>     {<!-- --><br>         public Form1()<br>         {<!-- --><br>             InitializeComponent();<br>         }</p> 
<p>        private void button1_Click(object sender, EventArgs e)<br>         {<!-- --><br>             //连接<br>             string conStr = "server=DESKTOP-N0NGI; user id = xx; password = 123456; database = 数据库";<br>             SqlConnection con = new SqlConnection(conStr);<br>             con.Open();</p> 
<p>            //查询<br>             string sql1 = "select *from 数据库";<br>             SqlDataAdapter da = new SqlDataAdapter(sql1, con);<br>             //建表保存并显示<br>             DataTable dt = new DataTable();<br>             da.Fill(dt);<br>             dataGridView1.DataSource = dt;<br>             con.Close();</p> 
<p>            //增加<br>             con.Open();<br>             string sql2 = "INSERT INTO 数据库 (姓名, 学号, 班级, 电话)VALUES('John','202205','计算机2班','1987899')";<br>             SqlCommand mycommand1 = new SqlCommand(sql2, con);<br>             mycommand1.ExecuteNonQuery();<br>             con.Close();</p> 
<p>            //删除<br>             con.Open();<br>             string sql3 = "DELETE FROM 数据库 WHERE 姓名 = 'John'";<br>             SqlCommand mycommand2 = new SqlCommand(sql3, con);<br>             mycommand2.ExecuteNonQuery();<br>             con.Close();</p> 
<p>            //更新<br>             con.Open();<br>             string sql4 = "UPDATE 数据库 SET 学号 = 202206 WHERE 姓名 = '张三'";<br>             SqlCommand mycommand3 = new SqlCommand(sql4, con);<br>             mycommand3.ExecuteNonQuery();<br>             con.Close();<br>             <br>         }<br>     }<br> }<br>  </p> 
<p>3.2 点击运行 点击bbutton按钮 即可进行增删改查操做 如图所示</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/b3/ff/sLY0kcDB_o.png"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/960e7468d9d39f8ee9db6e9ae05b4a50/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【WebGIS实例】（14）MapboxGL 加载地形高程数据</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2b45acd5e6db2f789a18ba0d7ec30691/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">纯净化安装EasyConnect：macOS Sonoma使用docker安装EasyConnect---docker-easyconnect</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>