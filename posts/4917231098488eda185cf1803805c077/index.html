<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>在没有源程序的情况时，如何通过控制鼠标按钮控制电脑exe程序？ - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/4917231098488eda185cf1803805c077/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="在没有源程序的情况时，如何通过控制鼠标按钮控制电脑exe程序？">
  <meta property="og:description" content="有时候想控制第三方软件，但是没有源程序，可以控制鼠标键盘自动操作软件达到我们想要的目的
首先建一个功能类包含窗口控制，鼠标控制和输入控制等
```csharp using System; using System.Collections.Generic; using System.Linq; using System.Runtime.InteropServices; using System.Text; using System.Threading.Tasks; namespace 进程程序名 { public class Win32Api { [DllImport(&#34;user32.dll&#34;, SetLastError = true)] static extern IntPtr FindWindow(string lpClassName, string lpWindowName); [DllImport(&#34;user32.dll&#34;)] [return: MarshalAs(UnmanagedType.Bool)] public static extern bool SetForegroundWindow(IntPtr hWnd); [DllImport(&#34;user32.dll&#34;, CharSet = CharSet.Auto, SetLastError = false)] public static extern IntPtr SendMessage(IntPtr hWnd, int Msg, int wParam, int lParam); [DllImport(&#34;user32.dll&#34;, SetLastError = true)] public static extern bool PostMessage(IntPtr hWnd, uint Msg, int wParam, int lParam); [DllImport(&#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-25T16:46:40+08:00">
    <meta property="article:modified_time" content="2024-07-25T16:46:40+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">在没有源程序的情况时，如何通过控制鼠标按钮控制电脑exe程序？</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>有时候想控制第三方软件，但是没有源程序，可以控制鼠标键盘自动操作软件达到我们想要的目的</p> 
<p>首先建一个功能类包含窗口控制，鼠标控制和输入控制等</p> 
<pre><code class="prism language-csharp">
```csharp
<span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Linq</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Runtime<span class="token punctuation">.</span>InteropServices</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Text</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> 进程程序名
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Win32Api</span>
    <span class="token punctuation">{<!-- --></span>

        <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DllImport</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"user32.dll"</span><span class="token punctuation">,</span> SetLastError <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
        <span class="token keyword">static</span> <span class="token keyword">extern</span> <span class="token return-type class-name">IntPtr</span> <span class="token function">FindWindow</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> lpClassName<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> lpWindowName<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DllImport</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"user32.dll"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">return</span><span class="token punctuation">:</span> <span class="token class-name">MarshalAs</span><span class="token attribute-arguments"><span class="token punctuation">(</span>UnmanagedType<span class="token punctuation">.</span>Bool<span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">extern</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">SetForegroundWindow</span><span class="token punctuation">(</span><span class="token class-name">IntPtr</span> hWnd<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DllImport</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"user32.dll"</span><span class="token punctuation">,</span> CharSet <span class="token operator">=</span> CharSet<span class="token punctuation">.</span>Auto<span class="token punctuation">,</span> SetLastError <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">extern</span> <span class="token return-type class-name">IntPtr</span> <span class="token function">SendMessage</span><span class="token punctuation">(</span><span class="token class-name">IntPtr</span> hWnd<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> Msg<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> wParam<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> lParam<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DllImport</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"user32.dll"</span><span class="token punctuation">,</span> SetLastError <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">extern</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">PostMessage</span><span class="token punctuation">(</span><span class="token class-name">IntPtr</span> hWnd<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">uint</span></span> Msg<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> wParam<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> lParam<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DllImport</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"user32.dll"</span><span class="token punctuation">,</span> SetLastError <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">extern</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">keybd_event</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">byte</span></span> bVk<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">byte</span></span> bScan<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> dwFlags<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> dwExtraInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DllImport</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"user32.dll"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">return</span><span class="token punctuation">:</span> <span class="token class-name">MarshalAs</span><span class="token attribute-arguments"><span class="token punctuation">(</span>UnmanagedType<span class="token punctuation">.</span>Bool<span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">extern</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">ShowWindow</span><span class="token punctuation">(</span><span class="token class-name">IntPtr</span> hWnd<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> nCmdShow<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">IntPtr</span> <span class="token function">FindWindowByCaption</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> caption<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token function">FindWindow</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> caption<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">IntPtr</span> <span class="token function">FindWindowByClassName</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> className<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token function">FindWindow</span><span class="token punctuation">(</span>className<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">SW</span>
    <span class="token punctuation">{<!-- --></span>
        HIDE <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
        SHOW_NORMAL <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
        SHOW_MINIMIZED <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
        MAXIMIZE <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span>
        SHOW_MAXIMIZED <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span>
        SHOW_NO_ACTIVE <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span>
        SHOW <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span>
        MINIMIZE <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span>
        SHOW_MIN_NO_ACTIVE <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span>
        SHOW_NA <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span>
        RESTORE <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span>
        SHOW_DEFAULT <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span>
        FORCE_MINIMIZE <span class="token operator">=</span> <span class="token number">11</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">WMessages</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token keyword">int</span></span>
    <span class="token punctuation">{<!-- --></span>
        WM_KEYDOWN <span class="token operator">=</span> <span class="token number">0x100</span><span class="token punctuation">,</span>
        WM_KEYUP <span class="token operator">=</span> <span class="token number">0x101</span><span class="token punctuation">,</span>
        WM_CHAR <span class="token operator">=</span> <span class="token number">0x102</span><span class="token punctuation">,</span>
        WM_LBUTTONDOWN <span class="token operator">=</span> <span class="token number">0x201</span><span class="token punctuation">,</span> <span class="token comment">//Left mousebutton down</span>
        WM_LBUTTONUP <span class="token operator">=</span> <span class="token number">0x202</span><span class="token punctuation">,</span>   <span class="token comment">//Left mousebutton up</span>
        WM_LBUTTONDBLCLK <span class="token operator">=</span> <span class="token number">0x203</span><span class="token punctuation">,</span> <span class="token comment">//Left mousebutton doubleclick</span>
        WM_RBUTTONDOWN <span class="token operator">=</span> <span class="token number">0x204</span><span class="token punctuation">,</span> <span class="token comment">//Right mousebutton down</span>
        WM_RBUTTONUP <span class="token operator">=</span> <span class="token number">0x205</span><span class="token punctuation">,</span>   <span class="token comment">//Right mousebutton up</span>
        WM_RBUTTONDBLCLK <span class="token operator">=</span> <span class="token number">0x206</span><span class="token punctuation">,</span> <span class="token comment">//Right mousebutton do</span>
        WM_CUT <span class="token operator">=</span> <span class="token number">0x300</span><span class="token punctuation">,</span>
        WM_COPY <span class="token operator">=</span> <span class="token number">0x301</span><span class="token punctuation">,</span>
        WM_PASTE <span class="token operator">=</span> <span class="token number">0x302</span><span class="token punctuation">,</span>
        WM_CLEAR <span class="token operator">=</span> <span class="token number">0x303</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">Functions</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token keyword">int</span></span>
    <span class="token punctuation">{<!-- --></span>
        KEYEVENTF_KEYDOWN <span class="token operator">=</span> <span class="token number">0x0000</span><span class="token punctuation">,</span> <span class="token comment">// New definition</span>
        KEYEVENTF_EXTENDEDKEY <span class="token operator">=</span> <span class="token number">0x0001</span><span class="token punctuation">,</span> <span class="token comment">//Key down flag</span>
        KEYEVENTF_KEYUP <span class="token operator">=</span> <span class="token number">0x0002</span><span class="token punctuation">,</span> <span class="token comment">//Key up flag</span>
        VK_LCONTROL <span class="token operator">=</span> <span class="token number">0xA2</span><span class="token punctuation">,</span> <span class="token comment">//Left Control key code</span>
        A <span class="token operator">=</span> <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token comment">//A key code</span>
        C <span class="token operator">=</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token comment">//C key code</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<pre><code>再写一个实际应用，根据实际软件大小和位置设置相应的控制点位

using System;
using System.Collections.Generic;
using System.Collections.Specialized;
using System.Diagnostics;
using System.Drawing;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace 进程程序名
{
    public class 进程程序名
    {
        public Process 进程程序名
        {
            get =&gt; Process.GetProcessesByName("进程程序名").FirstOrDefault(i =&gt; i.MainWindowHandle != IntPtr.Zero); 
        }

        public void SendMsg(string msg)
        {
            if(SunnyLink==null)
            {
                Console.WriteLine("请打开SunnyLink窗口，之后重试！");
                return;
            }
            if(string.IsNullOrEmpty(msg))
            {
                Console.WriteLine("发送的字符为空！");
                return;
            }
            var x = 357;
            var y = 540;
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (uint)WMessages.WM_LBUTTONDOWN, 0, x + (y &lt;&lt; 16));
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (uint)WMessages.WM_LBUTTONUP, 0, x + (y &lt;&lt; 16));
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (uint)WMessages.WM_LBUTTONDOWN, 0, x + (y &lt;&lt; 16));
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (uint)WMessages.WM_LBUTTONUP, 0, x + (y &lt;&lt; 16));
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (uint)WMessages.WM_LBUTTONDOWN, 0, x + (y &lt;&lt; 16));
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (uint)WMessages.WM_LBUTTONUP, 0, x + (y &lt;&lt; 16));
            Clipboard.SetText(msg);
            Task.Delay(1).Wait();
            //复制
            Win32Api.keybd_event((byte)Functions.VK_LCONTROL, 0, (int)Functions.KEYEVENTF_KEYDOWN, 0);
            Task.Delay(100).Wait();
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (int)WMessages.WM_KEYDOWN, (int)System.Windows.Forms.Keys.V, 0);
            Task.Delay(1).Wait();
            Win32Api.keybd_event((byte)Functions.VK_LCONTROL, 0, (int)Functions.KEYEVENTF_KEYUP, 0);
            //发送消息
            Task.Delay(500).Wait();
            x = 920; y = 570;
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (uint)WMessages.WM_LBUTTONDOWN, 0, x + (y &lt;&lt; 16));
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (uint)WMessages.WM_LBUTTONUP, 0, x + (y &lt;&lt; 16));
            x = 940; y = 610;
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (uint)WMessages.WM_LBUTTONDOWN, 0, x + (y &lt;&lt; 16));
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (uint)WMessages.WM_LBUTTONUP, 0, x + (y &lt;&lt; 16));
            Task.Delay(100).Wait();
        }

        public void FindUser(string msg)
        {
            if (SunnyLink == null)
            {
                Console.WriteLine("请打开目标程序窗口，之后重试！");
                return;
            }

            var x = 98;
            var y = 26;
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (uint)WMessages.WM_LBUTTONDOWN, 0, x + (y &lt;&lt; 16));
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (uint)WMessages.WM_LBUTTONUP, 0, x + (y &lt;&lt; 16));
            Clipboard.SetText(msg);
            Task.Delay(100).Wait();
            //复制
            Win32Api.keybd_event((byte)Functions.VK_LCONTROL, 0, (int)Functions.KEYEVENTF_KEYDOWN, 0);
            Task.Delay(100).Wait();
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (int)WMessages.WM_KEYDOWN, (int)System.Windows.Forms.Keys.V, 0);
            Task.Delay(1).Wait();
            Win32Api.keybd_event((byte)Functions.VK_LCONTROL, 0, (int)Functions.KEYEVENTF_KEYUP, 0);
            Task.Delay(2000).Wait();
            //选择用户
            x = 321; y = 159;
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (uint)WMessages.WM_LBUTTONDOWN, 0, x + (y &lt;&lt; 16));
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (uint)WMessages.WM_LBUTTONUP, 0, x + (y &lt;&lt; 16));
            Task.Delay(100).Wait();
        }

        public void sendMsg(Image image)
        {
            if (SunnyLink == null)
            {
                Console.WriteLine("请打开目标程序窗口，之后重试！");
                return;
            }

            var x = 357;
            var y = 540;
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (uint)WMessages.WM_LBUTTONDOWN, 0, x + (y &lt;&lt; 16));
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (uint)WMessages.WM_LBUTTONUP, 0, x + (y &lt;&lt; 16));
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (uint)WMessages.WM_LBUTTONDOWN, 0, x + (y &lt;&lt; 16));
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (uint)WMessages.WM_LBUTTONUP, 0, x + (y &lt;&lt; 16));
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (uint)WMessages.WM_LBUTTONDOWN, 0, x + (y &lt;&lt; 16));
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (uint)WMessages.WM_LBUTTONUP, 0, x + (y &lt;&lt; 16));
            Clipboard.SetImage(image); 
            Task.Delay(10).Wait();
            //复制
            Win32Api.keybd_event((byte)Functions.VK_LCONTROL, 0, (int)Functions.KEYEVENTF_KEYDOWN, 0);
            Task.Delay(100).Wait();
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (int)WMessages.WM_KEYDOWN, (int)System.Windows.Forms.Keys.V, 0);
            Task.Delay(1).Wait();
            Win32Api.keybd_event((byte)Functions.VK_LCONTROL, 0, (int)Functions.KEYEVENTF_KEYUP, 0);
            //发送消息
            Task.Delay(100).Wait();
            x = 920; y = 570;
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (uint)WMessages.WM_LBUTTONDOWN, 0, x + (y &lt;&lt; 16));
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (uint)WMessages.WM_LBUTTONUP, 0, x + (y &lt;&lt; 16));
            x = 940; y = 610;
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (uint)WMessages.WM_LBUTTONDOWN, 0, x + (y &lt;&lt; 16));
            Win32Api.PostMessage(SunnyLink.MainWindowHandle, (uint)WMessages.WM_LBUTTONUP, 0, x + (y &lt;&lt; 16));
            Task.Delay(100).Wait();
        }
    }
}



运行测试
 class Program
 {
     [STAThreadAttribute]
     static void Main(string[] args)
     {
         SunnyLinker sunnyLinker = new SunnyLinker();
         //找到用户
         进程程序名.FindUser("1234567");
         //发送文本
         for (int i = 0; i &lt; 50; i++)
         {
             进程程序名.SendMsg($"[雪花][雪花][雪花]");
             进程程序名.SendMsg($"你好{i}");
         }
         //发送图片
         Image img = Image.FromFile("img.jpeg");
         进程程序名.sendMsg(img);
     }
 }
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/52222ceb05498ecd729054a919a9773c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">智能编程，一触即发：使用AIGC优化CSS——提升前端开发效率与质量</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/89fe8cfcdd101ca79ce9760009d8cfc6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">从MySQL迁移到PostgreSQL的完整指南</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>