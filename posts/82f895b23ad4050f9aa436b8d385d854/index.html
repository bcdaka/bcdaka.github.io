<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>JDBC教程：JDBC连接Mysql数据库超详细讲解（从入门到熟练使用） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/82f895b23ad4050f9aa436b8d385d854/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="JDBC教程：JDBC连接Mysql数据库超详细讲解（从入门到熟练使用）">
  <meta property="og:description" content="JDBC 1.概念： 【 Java DataBase Connectivity 】，Java数据库连接即 ，JDBC的作用是：用Java语言操作数据库 2.本质： 官方定义的一套操作所有关系型数据库的规则/规范（ 即接口-- API（Application Programming Interface ））
且由关系型数据库厂商自己写JDBC的实现类，实现这套接口（数据库驱动）
真正执行的代码是驱动jar包中的实现类
3.快速入门 步骤 导入驱动jar包
图1--查看MySQL版本 图2---到官网下载对应版本的jar包 https://downloads.mysql.com/archives/c-j/ 是旧版本 页面有所不同
MySQL :: Download Connector/J 附上最新版下载地址
图3---直接下载无需登录注册Oracle官网账号 在src中新建libs包
复制mysql-connector-java-8.0.26.jar 到项目libs目录下
图4.图5.图6--复制jar包并粘贴 右键—&gt;add as library(添加为库)
图7--添加为库 注册驱动
Class.forName(&#34;com.mysql.jdbc.Driver&#34;); 注：需要抛出异常（如图）
使用throws Exception代替具体的异常类型（如throws ClassNotFoundException）
获取数据库连接对象 Connection
create database JDBC_study; use JDBC_study; create table account ( id int auto_increment primary key , name varchar(10) null, balance double null ); ​ 图8–提前准备的数据表">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-02-04T11:22:34+08:00">
    <meta property="article:modified_time" content="2024-02-04T11:22:34+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">JDBC教程：JDBC连接Mysql数据库超详细讲解（从入门到熟练使用）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="JDBC_0"></a>JDBC</h2> 
<h3><a id="1_2"></a>1.概念：</h3> 
<ul><li>【 <strong>J</strong>ava <strong>D</strong>ata<strong>B</strong>ase <strong>C</strong>onnectivity 】，<code>Java数据库连接</code></li><li>即 ，JDBC的作用是：用Java语言操作数据库</li></ul> 
<h3><a id="2_7"></a>2.本质：</h3> 
<ul><li> <p>官方定义的一套操作所有关系型数据库的<u>规则/规范</u>（ 即<strong>接口-- API</strong>（Application Programming Interface ））</p> </li><li> <p>且由关系型数据库厂商自己写JDBC的实现类，实现这套接口（数据库驱动）</p> </li><li> <p>真正执行的代码是驱动jar包中的实现类</p> </li></ul> 
<h3><a id="3_14"></a>3.快速入门</h3> 
<h4><a id="_16"></a>步骤</h4> 
<ol><li> <p>导入驱动jar包</p> <p><img src="https://images2.imgbox.com/8d/58/xyp3zgpF_o.png" alt="在这里插入图片描述"></p> <pre><code>                                   图1--查看MySQL版本
</code></pre> <p><img src="https://images2.imgbox.com/99/6f/TCCJZ0ue_o.png" alt="在这里插入图片描述"></p> <pre><code>                              图2---到官网下载对应版本的jar包
</code></pre> 
  <blockquote> 
   <p><a href="https://downloads.mysql.com/archives/c-j/" rel="nofollow">https://downloads.mysql.com/archives/c-j/</a> 是旧版本 页面有所不同</p> 
   <p><a href="https://dev.mysql.com/downloads/connector/j/" rel="nofollow">MySQL :: Download Connector/J</a> 附上最新版下载地址</p> 
   <p><img src="https://images2.imgbox.com/37/67/MtZnh4AM_o.png" alt="在这里插入图片描述"></p> 
  </blockquote> <pre><code>                                 图3---直接下载无需登录注册Oracle官网账号
</code></pre> 
  <ul><li> <p>在src中新建libs包</p> </li><li> <p>复制mysql-connector-java-8.0.26.jar 到项目libs目录下</p> <p><img src="https://images2.imgbox.com/a6/ec/aD2zAP2Y_o.png" alt="在这里插入图片描述"></p> <p><img src="https://images2.imgbox.com/d6/45/SR1ed9AQ_o.png" alt="在这里插入图片描述"></p> <p><img src="https://images2.imgbox.com/e0/1b/Yt9JLlzu_o.png" alt="在这里插入图片描述"></p> <pre><code>                           图4.图5.图6--复制jar包并粘贴
</code></pre> </li><li> <p>右键—&gt;add as library(添加为库)</p> <p><img src="https://images2.imgbox.com/50/8b/KuA7DWqi_o.png" alt="在这里插入图片描述"></p> <pre><code>                                     图7--添加为库
</code></pre> </li></ul> </li><li> <p>注册驱动</p> </li></ol> 
<pre><code>Class.forName("com.mysql.jdbc.Driver");
</code></pre> 
<p><img src="https://images2.imgbox.com/ff/ef/T4jqUtAl_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/5e/34/DztfsCqr_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/60/43/SVR0OLmc_o.png" alt="在这里插入图片描述"></p> 
<p>注：需要抛出异常（如图）</p> 
<blockquote> 
 <p>使用<code>throws Exception</code>代替具体的异常类型（如<code>throws ClassNotFoundException</code>）</p> 
</blockquote> 
<ol start="3"><li> <p>获取数据库连接对象 Connection</p> <pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">database</span> JDBC_study<span class="token punctuation">;</span>
<span class="token keyword">use</span> JDBC_study<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> account
<span class="token punctuation">(</span>
    id      <span class="token keyword">int</span> <span class="token keyword">auto_increment</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">,</span>
    name    <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
    balance <span class="token keyword">double</span>      <span class="token boolean">null</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <p><img src="https://images2.imgbox.com/03/ce/l5SdKhlK_o.png" alt="在这里插入图片描述"></p> <p>​ 图8–提前准备的数据表</p> </li></ol> 
<pre><code class="prism language-java"><span class="token class-name">Connection</span> connection<span class="token operator">=</span><span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql://localhost:3306/JDBC_study"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//JDBC_study是我的数据库名</span>
</code></pre> 
<blockquote> 
 <p>MySQL 8.0 以上版本的数据库连接：</p> 
 <ol><li> <p><strong>com.mysql.jdbc.Driver</strong> <em>更换为</em> <strong>com.mysql.cj.jdbc.Driver</strong></p> </li><li> <p><strong>jdbc:mysql://localhost:3306/数据库名</strong>更换为<strong>jdbc:mysql://localhost:3306/数据库名?useSSL=false&amp;allowPublicKeyRetrieval=true&amp;serverTimezone=UTC</strong></p> </li></ol> 
</blockquote> 
<ol start="4"><li> <p>定义sql语句</p> <pre><code class="prism language-sql">String <span class="token keyword">sql</span><span class="token operator">=</span><span class="token string">"update account set balance =500 where id=1"</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p>获取执行sql语句的对象 statement</p> <pre><code class="prism language-java"><span class="token class-name">Statement</span> statement <span class="token operator">=</span>connection<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p>执行sql，接收返回结果</p> <pre><code class="prism language-java"><span class="token keyword">int</span> count<span class="token operator">=</span>statement<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p>处理结果</p> <pre><code class="prism language-java"><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//</span>
</code></pre> </li><li> <p>释放资源</p> <pre><code class="prism language-java">statement<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> </li></ol> 
<blockquote> 
 <p>完整代码：</p> 
 <pre><code class="prism language-Java">/*
JDBC快速入门
*/
public class jdbcDemo1 {
 public static void main(String[] args) throws Exception {
//        1. 导入驱动jar包(已完成)
//        2. 注册驱动
     Class.forName("com.mysql.cj.jdbc.Driver");//可省略
//        3. 获取数据库连接对象 Connection
		//第二、三个参数是连接数据库的用户名和密码		     
     Connection connection=DriverManager.getConnection("jdbc:mysql://localhost:3306/JDBC_study?useSSL=false&amp;allowPublicKeyRetrieval=true&amp;serverTimezone=UTC", "root", "Hky6600115");
//        4. 定义sql语句
     String sql="update account set balance =500 where id=1";
//        5. 获取执行sql语句的对象 statement
     Statement statement =connection.createStatement();
//        6. 执行sql，接收返回结果
     int count=statement.executeUpdate(sql);
//        7. 处理结果
     System.out.println(count);
//        8. 释放资源
     statement.close();
     connection.close();
 }
}
</code></pre> 
</blockquote> 
<p>运行检验：</p> 
<p><img src="https://images2.imgbox.com/43/ae/iADUAUdb_o.png" alt="在这里插入图片描述"></p> 
<pre><code>                                 图9--控制台输出(暂时不解读)
</code></pre> 
<p><img src="https://images2.imgbox.com/4c/33/AMHGEgsO_o.png" alt="在这里插入图片描述"></p> 
<pre><code>                                 图10--刷新数据库可见数据已修改
</code></pre> 
<br> 
<h4><a id="_183"></a>详解各对象</h4> 
<h5><a id="1DriverManager___185"></a>1️⃣.DriverManager 驱动管理对象</h5> 
<p>【一个类】</p> 
<p>功能：</p> 
<ul><li> <p><mark>一、注册驱动</mark>：告诉程序应当使用哪一个数据库去驱动jar包</p> 
  <ul><li> <p><code>static void registerDriver(Driver driver)</code> DriverManager 的方法</p> 
    <blockquote> 
     <p>上面快速入门的时候没有注册驱动 ，取而代之的是Class.forName(“com.mysql.jdbc.Driver”)也成功运行，原因如下：</p> 
    </blockquote> </li><li> <p>查看<code>mysql.jdbc.Driver</code>的源码可知</p> <pre><code class="prism language-java"><span class="token comment">//这是com.mysql.jdbc.Driver的静态代码块，只要使用这个类，就会执行这段代码</span>
<span class="token comment">//而Class.forName("com.mysql.jdbc.Driver")就正好使用到了这个类</span>
<span class="token keyword">static</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
		<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span>DriverManager</span><span class="token punctuation">.</span><span class="token function">registerDriver</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Driver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> <span class="token class-name">E</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"Can't register driver!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>因此，我们是通过给<code>forName</code>指定了MySQL的驱动，它帮助我们注册驱动</p> </li><li> <p>注意：MySQL5.0之后可以省略注册驱动的步骤</p> 
    <blockquote> 
     <p>在jar包中，存在一个java.sql.Driver配置文件，文件中指定了com.mysql.jdbc.Driver</p> 
    </blockquote> </li></ul> </li><li> <p><mark>二、获取数据库连接</mark></p> 
  <ul><li> <p>方法：<code>static Connection getConnection(String url, String user, String password);</code> 带三个参数</p> </li><li> <p>参数：</p> 
    <ul><li> <p>url:指定连接的路径</p> 
      <ul><li> <p>语法：<code>jdbc:mysql://ip地址（域名）：端口号/数据库名称</code>【MySQL5.0写法】</p> </li><li> <p>语法：<code>jdbc:mysql://ip地址（域名）：端口号/JDBC_study?useSSL=false&amp;allowPublicKeyRetrieval=true&amp;serverTimezone=UTC</code>【MySQL8.0写法】</p> 
        <blockquote> 
         <p>ip地址（域名）可以找到某一台计算机</p> 
         <p>端口号可以找到计算机上安装的MySQL服务器</p> 
        </blockquote> </li><li> <p><strong>细节</strong>：若连接的是本机mysql服务器，并且mysql服务默认端口是3306，则url可以简写为<code>jdbc:mysql:///数据库名称</code>【MySQL5.0写法】,即省略 <u><code>ip地址（域名）：端口号</code></u></p> </li></ul> </li><li> <p>user:用户名（本机常为root）</p> </li><li> <p>password:密码</p> </li></ul> </li></ul> </li></ul> 
<br> 
<h5><a id="2_Connection___241"></a>2️⃣. Connection 数据库连接对象</h5> 
<p><strong>功能：</strong></p> 
<ul><li> <p><mark>一、获取执行sql的对象</mark></p> 
  <ul><li>获取<u>普通</u>执行者对象：<code>Statement createStatement();</code></li><li>获取<u>预编译</u>执行者对象：<code>PreparedStatement prepareStatement(String sql);</code></li></ul> </li><li> <p><mark>二、管理事务</mark></p> 
  <blockquote> 
   <p>业务操作的多个步骤：要么同时成功，要么同时失败</p> 
   <p>数据库可以：开启/提交/回滚事务，针对此有以下三个对应方法：</p> 
  </blockquote> 
  <ul><li>开启事务：<code>setAutoCommit(boolean autoCommit); </code>参数为false，则开启事务</li><li>提交事务：<code>commit();</code></li><li>回滚事务：<code>rollback();</code></li></ul> </li></ul> 
<br> 
<h5><a id="3statement__sql_262"></a>3️⃣.statement 执行sql的对象⭐</h5> 
<p><strong>功能：</strong></p> 
<p><mark>执行sql对象</mark></p> 
<ul><li> <p><code>boolean execute(String sql);</code> 可以执行任意sql语句（了解即可）</p> </li><li> <p><code>int executeUpdate(String sql);</code> 执行DML（insert、update、delete）语句以及DDL(create、alert、drop)</p> 
  <ul><li> <p>返回值：影响的行数</p> </li><li> <p>eg. 前面运行过的，原先的表格经修改，id=1的balance由1000变成500，则这一行数据受到影响被改变返回值为1（见图9）</p> 
    <table><thead><tr><th>id</th><th>name</th><th>balance</th></tr></thead><tbody><tr><td>1</td><td>zhangsan</td><td>1000----&gt;500</td></tr><tr><td>2</td><td>lisi</td><td>1000</td></tr></tbody></table></li><li> <p>作用：可以通过这个影响的行数判断DML语句是否执行成功 返回值&gt;0的则执行成功；反之，则失败</p> </li></ul> </li><li> <p><code>ResultSet executeQuery(String sql);</code> 执行DQL（select）</p> </li></ul> 
<br> 
<h5><a id="_287"></a>练习：基础</h5> 
<p>1.accunt表 添加一条记录<br> 2.account表 修改记录<br> 3.account表 删除一条记录</p> 
<pre><code class="prism language-Java">import java.sql.*;
/*
1.accunt表 添加一条记录
 */
public class jdbcDemo2 {
    public static void main(String[] args) throws Exception{
        Statement statement=null;
        Connection connection=null;
        try {
            //1.注册驱动
            Class.forName("com.mysql.cj.jdbc.Driver");
            //2.定义sql
            String sql="insert into account values(null,'wangwu',3000)";
            //3.获取connection对象
            connection= DriverManager.getConnection("jdbc:mysql:///JDBC_study?useSSL=false&amp;allowPublicKeyRetrieval=true&amp;serverTimezone=UTC", "root", "Hky6600115");
            //4.获取执行sql的对象statement
            statement=connection.createStatement();
            //5.执行sql
            int count=statement.executeUpdate(sql);//影响行数【增加一行，应返回1】
            //6.处理结果
            System.out.println(count);
            if (count&gt;0){
                System.out.println("执行成功");
            }else {
                System.out.println("执行失败");
            }
        }catch (ClassNotFoundException e){
            e.printStackTrace();
        }catch (SQLException e){
            e.printStackTrace();
            /*
            释放但因作用域问题报错--&gt;因此提升作用域
                statement.close();
                connection.close();
             */
        }finally {
            //7.释放资源
            //避免空指针异常
            if(statement!=null){
                try {
                    statement.close();
                }catch (SQLException e){
                    e.printStackTrace();
                }
            }
            if(connection!=null){
                try {
                    connection.close();
                }catch (SQLException e){
                    e.printStackTrace();
                }
            }
        }
    }
}
</code></pre> 
<blockquote> 
 <p>请仿造以上练习1的代码 ，完成练习2以及练习3</p> 
</blockquote> 
<br> 
<h5><a id="4ResultSet___355"></a>4️⃣.ResultSet 结果集对象</h5> 
<ul><li><code>boolean next()</code> 
  <ul><li>如果有数据返回true，且光标向下移动一行</li><li>没有则返回false</li></ul> </li><li><code>XXX getXxx(列名/列编号)</code> 
  <ul><li>XXX 表示数据类型 eg.int、String</li><li>例如：<code>int getInt(int)</code>可以有 <code>int getInt(1)</code>或者<code>int getInt("id")</code></li></ul> </li></ul> 
<p>代码示例：</p> 
<pre><code class="prism language-Java">import java.sql.*;

public class jdbcDemo5 {
    public static void main(String[] args) {
        Connection connection=null;
        Statement statement=null;
        ResultSet resultSet=null;
        try {
            Class.forName("com.mysql.cj.jdbc.Driver");
            String sql="select * from account";
            connection= DriverManager.getConnection("jdbc:mysql:///JDBC_study?useSSL=false&amp;allowPublicKeyRetrieval=true&amp;serverTimezone=UTC","root","Hky6600115");
            statement=connection.createStatement();
            resultSet= statement.executeQuery(sql);
            //处理结果
            //1.让光标向下移动一行(默认在列名一行)
            resultSet.next();
            //2.获取数据
            int id=resultSet.getInt("id");
            String name=resultSet.getString("name");
            double balance=resultSet.getDouble("balance");
            //3.打印数据
            System.out.println(id+"---"+name+"---"+balance);
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        } catch (SQLException e) {
            e.printStackTrace();
        }finally {
            if(resultSet!=null){
                try {
                    resultSet.close();
                } catch (SQLException e) {
                    e.printStackTrace();
                }
            }
            if(statement!=null){
                try {
                    statement.close();
                } catch (SQLException e) {
                    e.printStackTrace();
                }
            }
            if(connection!=null){
                try {
                    connection.close();
                } catch (SQLException e) {
                    e.printStackTrace();
                }
            }
        }
    }
}
</code></pre> 
<p><img src="https://images2.imgbox.com/9b/e5/Q878wyoG_o.png" alt="在这里插入图片描述"></p> 
<pre><code>                                        图--运行结果
</code></pre> 
<br> 
<h5><a id="_427"></a>练习：遍历</h5> 
<p>案例代码：</p> 
<blockquote> 
 <p>其他步骤不变，仅改变数据处理过程</p> 
</blockquote> 
<pre><code class="prism language-java"><span class="token comment">//处理结果（输出全部数据）</span>
<span class="token comment">//1.判断游标是否为最后一行末尾</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token comment">//2.获取数据</span>
	<span class="token keyword">int</span> id<span class="token operator">=</span>resultSet<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> name<span class="token operator">=</span>resultSet<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> balance<span class="token operator">=</span>resultSet<span class="token punctuation">.</span><span class="token function">getDouble</span><span class="token punctuation">(</span><span class="token string">"balance"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//3.打印数据</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>id<span class="token operator">+</span><span class="token string">"---"</span><span class="token operator">+</span>name<span class="token operator">+</span><span class="token string">"---"</span><span class="token operator">+</span>balance<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<br> 
<h5><a id="_448"></a>练习：封装对象</h5> 
<p>数据准备：</p> 
<pre><code class="prism language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> emp <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span><span class="token string">'孙悟空'</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1004</span><span class="token punctuation">,</span><span class="token string">'2000-12-17'</span><span class="token punctuation">,</span><span class="token string">'8000.00'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span><span class="token string">'卢俊义'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1006</span><span class="token punctuation">,</span><span class="token string">'2001-02-20'</span><span class="token punctuation">,</span><span class="token string">'16000.00'</span><span class="token punctuation">,</span><span class="token string">'3000.00'</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token string">'林冲'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1006</span><span class="token punctuation">,</span><span class="token string">'2001-02-22'</span><span class="token punctuation">,</span><span class="token string">'12500.00'</span><span class="token punctuation">,</span><span class="token string">'5000.00'</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span><span class="token string">'唐僧'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1009</span><span class="token punctuation">,</span><span class="token string">'2001-04-02'</span><span class="token punctuation">,</span><span class="token string">'29750.00'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span><span class="token string">'李逵'</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1006</span><span class="token punctuation">,</span><span class="token string">'2001-09-28'</span><span class="token punctuation">,</span><span class="token string">'12500.00'</span><span class="token punctuation">,</span><span class="token string">'14000.00'</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span><span class="token string">'宋江'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1009</span><span class="token punctuation">,</span> <span class="token string">'2001-05-01'</span><span class="token punctuation">,</span><span class="token string">'28500.00'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1007</span><span class="token punctuation">,</span><span class="token string">'刘备'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1009</span><span class="token punctuation">,</span><span class="token string">'2001-09-01'</span><span class="token punctuation">,</span><span class="token string">'24500.00'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1008</span><span class="token punctuation">,</span><span class="token string">'猪八戒'</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1004</span><span class="token punctuation">,</span><span class="token string">'2007-04-19'</span><span class="token punctuation">,</span><span class="token string">'30000.00'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1009</span><span class="token punctuation">,</span><span class="token string">'罗贯中'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token string">'2001-11-17'</span><span class="token punctuation">,</span><span class="token string">'50000.00'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1010</span><span class="token punctuation">,</span><span class="token string">'吴用'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1006</span><span class="token punctuation">,</span><span class="token string">'2001-09-08'</span><span class="token punctuation">,</span><span class="token string">'15000.00'</span><span class="token punctuation">,</span><span class="token string">'0.00'</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1011</span><span class="token punctuation">,</span><span class="token string">'沙僧'</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1004</span><span class="token punctuation">,</span><span class="token string">'2007-05-23'</span><span class="token punctuation">,</span><span class="token string">'11000.00'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1012</span><span class="token punctuation">,</span><span class="token string">'李逵'</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1006</span><span class="token punctuation">,</span><span class="token string">'2001-12-03'</span><span class="token punctuation">,</span><span class="token string">'9500.00'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1013</span><span class="token punctuation">,</span><span class="token string">'小白龙'</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1004</span><span class="token punctuation">,</span><span class="token string">'2001-12-03'</span><span class="token punctuation">,</span><span class="token string">'30000.00'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1014</span><span class="token punctuation">,</span><span class="token string">'关羽'</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1007</span><span class="token punctuation">,</span><span class="token string">'2002-01-23'</span><span class="token punctuation">,</span><span class="token string">'13000.00'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>要求：定义一个方法，查询emp表中的数据并将其封装为对象，然后装载集合，返回</p> 
 <p>步骤：</p> 
 <ol><li>定义emp类</li><li>定义方法 public List&lt; EMP &gt; findAll(){}</li><li>实现方法 select*from emp;</li></ol> 
</blockquote> 
<p>代码实现：</p> 
<ol><li>配置文件<code>jdbc.properties</code></li></ol> 
<pre><code class="prism language-java">url<span class="token operator">=</span><span class="token string">"jdbc:mysql:///JDBC_study?useSSL=false&amp;allowPublicKeyRetrieval=true&amp;serverTimezone=UTC"</span>
user<span class="token operator">=</span>root
password<span class="token operator">=</span><span class="token class-name">Hky6600115</span>'
driver<span class="token operator">=</span><span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>cj<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span></span>Driver</span>
</code></pre> 
<ol start="2"><li><code>JDBCUtils</code>工具类</li></ol> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JDBCUtils</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> url<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> user<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> 
<span class="token punctuation">}</span>
</code></pre> 
<br> 
<h5><a id="JDBCJDBCUtils_501"></a>抽取JDBC工具类（JDBCUtils）</h5> 
<ul><li> <p>目的：简化书写</p> </li><li> <p>分析：</p> 
  <ol><li> <p>注册驱动</p> </li><li> <p>连接对象</p> 
    <ol><li> <p>需求：</p> 
      <ul><li> <p>传递参数❌（太麻烦）</p> </li><li> <p>保障工具类的通用性（MySQL5.0/MySQL8.0的url不同）</p> </li></ul> </li><li> <p>解决：配置文件<code>jdbc.properties</code>【在src下创建】</p> <p><img src="https://images2.imgbox.com/9c/6f/KbUVGU4W_o.png" alt="在这里插入图片描述"></p> 
      <blockquote> 
       <p>url=“”</p> 
       <p>user=“”</p> 
       <p>password=“”</p> 
       <p>driver=“”</p> 
      </blockquote> </li></ol> </li></ol> </li></ul> 
<p>实现代码：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileReader</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span><span class="token class-name">URL</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Properties</span></span><span class="token punctuation">;</span>

<span class="token comment">/*
    JDBC工具类
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JDBCUtils</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">/*
    文件的读取只需要一次，便可以得到所有值
            利用【静态代码块】
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> url<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> user<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> driver<span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//读取资源文件，获取值</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//1.创建properties集合类</span>
            <span class="token class-name">Properties</span> properties<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//获取src路径下的文件的方式---&gt;classLoader 类加载器</span>
            <span class="token class-name">ClassLoader</span> classLoader <span class="token operator">=</span> <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">URL</span> resource  <span class="token operator">=</span> classLoader<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token string">"jdbc.properties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> path <span class="token operator">=</span> resource<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//System.out.println(path);</span>
            <span class="token comment">//2.加载文件</span>
<span class="token comment">//            properties.load(new FileReader("jdbc.properties"));</span>
            properties<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//3.获取数据，赋值</span>
            url<span class="token operator">=</span>properties<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            user<span class="token operator">=</span>properties<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            password<span class="token operator">=</span>properties<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            driver<span class="token operator">=</span>properties<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//4.注册驱动</span>
            <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token comment">//    获取连接</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Connection</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> user<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">//    释放资源</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token class-name">ResultSet</span> resultSet<span class="token punctuation">,</span> <span class="token class-name">Statement</span> statement<span class="token punctuation">,</span> <span class="token class-name">Connection</span> connection<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>resultSet<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                resultSet<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>statement<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                statement<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>connection<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token class-name">PreparedStatement</span> preparedStatement<span class="token punctuation">,</span> <span class="token class-name">Connection</span> connection<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>preparedStatement<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                preparedStatement<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>connection<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<br> 
<h6><a id="_631"></a>工具类练习</h6> 
<blockquote> 
 <p>需求：</p> 
 <ol><li>通过键盘录入用户名和密码</li><li>判断用户是否登录成功 
   <ul><li>select * from user where username=““and password =””;</li><li>如果该sql语句有查询结果，则表示成功，反之则失败</li></ul> </li></ol> 
</blockquote> 
<blockquote> 
 <p>步骤：</p> 
 <ol><li> <p>创建数据表user</p> <pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">user</span><span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
    username <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    password <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token keyword">user</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'zhangsan'</span><span class="token punctuation">,</span><span class="token string">'123'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token keyword">user</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'lisi'</span><span class="token punctuation">,</span><span class="token string">'234'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p>编写登录方法</p> </li></ol> 
</blockquote> 
<p>代码实现：</p> 
<pre><code class="prism language-java"><span class="token comment">/*
    登录方法
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">logion</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">,</span><span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>username<span class="token operator">==</span><span class="token keyword">null</span><span class="token operator">||</span>password<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//连接数据库判断是否登录成功</span>
        <span class="token class-name">Connection</span> connection<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">Statement</span> statement<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">ResultSet</span> resultSet<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            connection<span class="token operator">=</span> <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> sql<span class="token operator">=</span><span class="token string">"select * from user where username='"</span><span class="token operator">+</span>username<span class="token operator">+</span><span class="token string">"'and password='"</span><span class="token operator">+</span>password<span class="token operator">+</span><span class="token string">"' "</span><span class="token punctuation">;</span>
            statement<span class="token operator">=</span>connection<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            resultSet<span class="token operator">=</span>statement<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> resultSet<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">,</span>statement<span class="token punctuation">,</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<br> 
<h5><a id="5PreparedStatement_sql_689"></a>5️⃣.PreparedStatement 执行sql的对象</h5> 
<ul><li> <p><strong>sql注入</strong>问题：在拼接sql时，有一些sql的特殊关键字参与字符串的拼接，会造成安全性问题</p> 
  <ul><li> <p>以上面的练习为例</p> 
    <ul><li> <p>输入用户名：随机（eg.wangwu）</p> </li><li> <p>输入密码：a ’ or ’ a ’ = ’ a</p> 
      <ul><li>sql语句：select * from user where username =‘wangwu’ and password='a’<mark>or’a’=‘a’</mark>;</li><li>原sql语句：“select * from user where username='”+username+“‘and password=’”+password+"’ "</li></ul> 
      <blockquote> 
       <p>仔细对比观察</p> 
      </blockquote> </li></ul> </li></ul> </li><li> <p>经典例子：</p> </li></ul> 
<ol><li> <p><img src="https://images2.imgbox.com/c7/e3/76EydhG5_o.png" alt="在这里插入图片描述"></p> </li><li> <p><img src="https://images2.imgbox.com/dc/04/Qw1hCDqK_o.png" alt="在这里插入图片描述"></p> </li></ol> 
<blockquote> 
 <p>漫画中，该学生的姓名为“Robert’); DROP TABLE students;–”，导致students表被删除：</p> 
</blockquote> 
<ul><li> <p>解决：使用PreparedStatement 对象</p> </li><li> <p>预编译sql：参数使用<code>?</code>作为占用符</p> </li><li> <p>步骤（稍复杂）：</p> 
  <ol><li>导入驱动jar包</li><li>注册驱动</li><li>获取数据库连接对象 connection</li><li><strong>定义sql</strong> 
    <ul><li>sql的参数使用<code>?</code>作为占位符</li><li>如：<code>select * from user where username = ? and password = ?;</code></li></ul> </li><li>获取执行sgl语句的对象 PreparedStatement 
    <ul><li><code>Connection.PreparedStatement (String sql) </code> <u>需要传参</u></li></ul> </li><li>给<code>?</code>赋值： 
    <ul><li>方法：<code>setXxx(参数1，参数2)</code></li><li>参数1：<code>?</code>的位置</li><li>参数2：<code>?</code>的值</li></ul> </li><li>执行sql，接受返回结果 <u>不需要传参</u></li><li>处理结果</li><li>释放资源</li></ol> </li></ul> 
<p>代码修改：</p> 
<pre><code class="prism language-java"><span class="token comment">/*
    登录方法，使用PreparedStatement 对象
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">logion</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">,</span><span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>username<span class="token operator">==</span><span class="token keyword">null</span><span class="token operator">||</span>password<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//连接数据库判断是否登录成功</span>
        <span class="token class-name">Connection</span> connection<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">ResultSet</span> resultSet<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">PreparedStatement</span> preparedStatement<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            connection<span class="token operator">=</span> <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> sql<span class="token operator">=</span><span class="token string">"select * from user where username=?and password=?"</span><span class="token punctuation">;</span>
            <span class="token class-name">PreparedStatement</span><span class="token operator">=</span>connection<span class="token punctuation">.</span><span class="token function">preparedStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
            preparedStatement<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
            preparedStatement<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>
            resultSet<span class="token operator">=</span>preparedStatement<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> resultSet<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">,</span>preparedStatement<span class="token punctuation">,</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<ul><li>注意：后期改用 preparedStatement 来完成增删改查的操作 
  <ul><li>优势： 
    <ol><li>防止sql注入</li><li>效率更高</li></ol> </li></ul> </li></ul> 
<br> 
<h4><a id="JDBC_775"></a>JDBC控制事务</h4> 
<ul><li> <p>事务 ：一个包含多个步骤的业务操作。如果这个业务操作被事务管理，则这多个步骤要么同时成功，要么同时失败。</p> </li><li> <p>操作：</p> 
  <ul><li>开启事务</li><li>提交事务</li><li>回滚事务</li></ul> </li><li> <p>使用connection对象来管理事务</p> 
  <ul><li>开启事务 <code>setAutoCommit(boolean autoCommit)</code> : 调用该方法设置参数为 false，即开启事务 
    <ul><li>在执行sql之前开启事务</li></ul> </li><li>提交事务 <code>commit()</code> 
    <ul><li>当所有sql都执行完提交事务</li></ul> </li><li>回滚事务 <code>rollback()</code> 
    <ul><li>在catch中回滚事务</li></ul> </li></ul> </li></ul> 
<h5><a id="_791"></a>练习：转账</h5> 
<p>代码实现：</p> 
<pre><code class="prism language-java">
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>itcast<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">JDBCUtils</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token comment">/*
事务操作
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> jdbcDemo10 <span class="token punctuation">{<!-- --></span>
    <span class="token comment">/*
    转账方法
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Connection</span> connection<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">PreparedStatement</span> preparedStatement1<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">PreparedStatement</span> preparedStatement2<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">ResultSet</span> resultSet<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//1.获取连接</span>
            connection<span class="token operator">=</span> <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//                开启事务</span>
            connection<span class="token punctuation">.</span><span class="token function">setAutoCommit</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//2.定义sql</span>
            <span class="token comment">//2.1. 张三-500</span>
            <span class="token comment">//2.2. 李四+500</span>
            <span class="token class-name">String</span> sql1<span class="token operator">=</span><span class="token string">"update account set balance = balance - ? where id = ?"</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> sql2<span class="token operator">=</span><span class="token string">"update account set balance = balance + ? where id = ?"</span><span class="token punctuation">;</span>
            <span class="token comment">//3.获取执行对象</span>
            preparedStatement1<span class="token operator">=</span>connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql1<span class="token punctuation">)</span><span class="token punctuation">;</span>
            preparedStatement2<span class="token operator">=</span>connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql2<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//4.设置参数</span>
            preparedStatement1<span class="token punctuation">.</span><span class="token function">setDouble</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            preparedStatement1<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            preparedStatement2<span class="token punctuation">.</span><span class="token function">setDouble</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            preparedStatement2<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//5.执行sql</span>
            preparedStatement1<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            preparedStatement2<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//                提交事务</span>
            connection<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token comment">//                事务回滚</span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>connection<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    connection<span class="token punctuation">.</span><span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e1<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                e1<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>preparedStatement1<span class="token punctuation">,</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>preparedStatement2<span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<br> 
<br> 
<h2><a id="_859"></a>数据库与连接池</h2> 
<h4><a id="1__861"></a>1. <strong>概念</strong>：</h4> 
<p>存放数据库连接的一个容器（集合）Connection</p> 
<blockquote> 
 <p>当系统运行起来之后，这个连接池就被创建，在这个连接池当中，会申请一些对象，当有用户来访问数据库的时候，就从这个连接池当中获取连接对象，用户访问结束之后，连接池对象会归还给容器</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/d3/d7/MVqj7At8_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2_870"></a>2.优点：</h4> 
<ul><li>节约资源</li><li>用户访问高效</li></ul> 
<h4><a id="3__875"></a>3. 连接池实现：</h4> 
<ul><li>java官方提供的数据库连接池规范(接口)：<code>DataSource</code> (javax.sql包下) 
  <ul><li>方法：【获取连接：<code>getConnection();</code>】</li><li>【归还连接池对象：<code>conn.close();</code>】</li></ul> </li><li>由数据库厂商为我们实现该接口 
  <ul><li>C3P0</li><li>Druid (阿里巴巴开发)</li></ul> </li></ul> 
<h4><a id="4C3P0_884"></a>4.C3P0</h4> 
<h5><a id="_886"></a>步骤：</h5> 
<h6><a id="1_jar_888"></a>1. 导入jar包</h6> 
<blockquote> 
 <p>官网：https://sourceforge.net/</p> 
 <p>进入官网，搜索框中输入c3p0，并点击下面的提示</p> 
 <p><img src="https://images2.imgbox.com/0c/2c/XMj1aJns_o.png" alt="在这里插入图片描述"><br> 点击下载即可</p> 
 <p><img src="https://images2.imgbox.com/2c/a0/lkAhAArT_o.png" alt="在这里插入图片描述"><br> 解压后，在lib文件夹中，复制如下两个jar包到项目lib文件夹中（<mark>还有不能忘记数据库驱动jar包<code>mysql-connector-java-8.0.26.jar</code></mark>）<br> <img src="https://images2.imgbox.com/9d/e2/E04I3yGp_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b1/21/PLyIeS5V_o.png" alt="在这里插入图片描述"><br> 右键libs添加为库</p> 
 <p><img src="https://images2.imgbox.com/b0/25/wdRuPn6z_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<h6><a id="2__905"></a>2. 定义配置文件：</h6> 
<ul><li>文件命名为：<code>c3p0.properties</code> 或者 <code>c3p0-config.xml </code></li><li>位置：src目录下</li><li>1.<em>自定义的</em><code>c3p0-config.xml</code></li></ul> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>c3p0-config</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 使用默认的配置读取连接池对象 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>default-config</span><span class="token punctuation">&gt;</span></span>
  	<span class="token comment">&lt;!--  连接参数 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>driverClass<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>com.mysql.cj.jdbc.Driver<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>jdbcUrl<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>jdbc:mysql://localhost:3306/jdbc_study<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>root<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Hky6600115<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    
    <span class="token comment">&lt;!-- 连接池参数 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>initialPoolSize<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>maxPoolSize<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>checkoutTimeout<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>3000<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>default-config</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>named-config</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>otherc3p0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> 
    <span class="token comment">&lt;!--  连接参数 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>driverClass<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>com.mysql.jdbc.Driver<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>jdbcUrl<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>jdbc:mysql://localhost:3306/day25<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>root<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>root<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    
    <span class="token comment">&lt;!-- 连接池参数 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>initialPoolSize<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>maxPoolSize<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>checkoutTimeout<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>1000<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>named-config</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>c3p0-config</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<ul><li>2.参数解释 
  <ul><li>initialPoolSize：<em>初始化申请的连接数量</em></li><li>maxPoolSize：<em>最大的连接数量</em></li><li>checkoutTimeout：<em>超时时间</em></li></ul> </li></ul> 
<h6><a id="3__947"></a>3. 创建核心对象</h6> 
<p>数据库连接池对象 ComboPooledDataSource</p> 
<h6><a id="4__951"></a>4. 获取连接</h6> 
<p>getConnection</p> 
<p>代码实现：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>mchange<span class="token punctuation">.</span>v2<span class="token punctuation">.</span>c3p0<span class="token punctuation">.</span></span><span class="token class-name">ComboPooledDataSource</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">DataSource</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Connection</span></span><span class="token punctuation">;</span>

<span class="token comment">/*
c3p0的演示
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> c3p0Demo1 <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//1.创建数据库连接池对象</span>
        <span class="token class-name">DataSource</span> dataSource<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ComboPooledDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2.获取连接对象</span>
        <span class="token class-name">Connection</span> connection <span class="token operator">=</span> dataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//3.打印</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<br> 
<h5><a id="_979"></a>参数检验：</h5> 
<blockquote> 
 <p>5</p> 
 <p>10</p> 
 <p>3000</p> 
</blockquote> 
<h6><a id="1__987"></a>1. 检验最大连接数量</h6> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> c3p0Demo2 <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">DataSource</span> dataSource<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ComboPooledDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">10</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Connection</span> connection<span class="token operator">=</span>dataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token string">":"</span><span class="token operator">+</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>运行结果：（正常）</p> 
<p><img src="https://images2.imgbox.com/43/bc/702p7pyc_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="2__1006"></a>2. 检验超时时间</h6> 
<p>–&gt; 运行有错误会等带一段时间再报错</p> 
<pre><code class="prism language-java"> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">11</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Connection</span> connection<span class="token operator">=</span>dataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token string">":"</span><span class="token operator">+</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>运行结果：（先输出正常部分，隔3秒报错）</p> 
<p><img src="https://images2.imgbox.com/81/53/tMIlR7oE_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>若中途归还对象，即可正常（重复使用）</p> 
</blockquote> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">DataSource</span> dataSource<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ComboPooledDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">11</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Connection</span> connection<span class="token operator">=</span>dataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token string">":"</span><span class="token operator">+</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h5><a id="_1038"></a>注：</h5> 
<ul><li><code>DataSource dataSource=new ComboPooledDataSource();</code>表示使用默认配置</li><li><code>DataSource dataSource=new ComboPooledDataSource("otherc3p0");</code>表示使用指定名称配置</li></ul> 
<br> 
<h4><a id="5Druid_1045"></a>5.Druid</h4> 
<h5><a id="_1047"></a>步骤：</h5> 
<h6><a id="1_jar_1049"></a>1. 导入jar包</h6> 
<p>官网下载地址：<a href="https://repo1.maven.org/maven2/com/alibaba/druid/" rel="nofollow">Central Repository: com/alibaba/druid (maven.org)</a></p> 
<p><img src="https://images2.imgbox.com/b6/f3/8W0BeRgl_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/d8/1c/WstACq97_o.png" alt="在这里插入图片描述"></p> 
<p>（详见c3p0）</p> 
<h6><a id="2_1061"></a>2.定义配置文件</h6> 
<ul><li>是properties形式的</li><li>可以叫任意名称，可以放在任意目录下 
  <ul><li>不会自动加载，需要手动</li></ul> </li></ul> 
<pre><code>//示例 druid.properties
driverClassName=com.mysql.cj.jdbc.Driver
url=jdbc:mysql:///JDBC_study?useSSL=false&amp;allowPublicKeyRetrieval=true&amp;serverTimezone=UTC
username=root
password=password
# 初始化连接数量
initialSize=5
#最大连接数
maxActive=10
# 最大等待时间
maxWait=3000
</code></pre> 
<p>步骤+1：加载配置文件</p> 
<h6><a id="3__1083"></a>3. 获取数据库连接池对象</h6> 
<p>通过工厂类来获取 <code>DruidDataSourceFactory</code></p> 
<h6><a id="4__1087"></a>4. 获取连接</h6> 
<p><code>getConnection</code></p> 
<h6><a id="_1091"></a>代码实现：</h6> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>druid<span class="token punctuation">.</span>pool<span class="token punctuation">.</span></span><span class="token class-name">DruidDataSourceFactory</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">DataSource</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Connection</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Properties</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DruidDemo</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//加载配置文件</span>
        <span class="token class-name">Properties</span> properties<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">InputStream</span> inputStream<span class="token operator">=</span><span class="token class-name">DruidDemo</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"druid.properties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//获取连接池对象</span>
        <span class="token class-name">DataSource</span> dataSource <span class="token operator">=</span><span class="token class-name">DruidDataSourceFactory</span><span class="token punctuation">.</span><span class="token function">createDataSource</span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//获取连接</span>
        <span class="token class-name">Connection</span> connection<span class="token operator">=</span>dataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<br> 
<h5><a id="_1119"></a>定义工具类</h5> 
<h6><a id="1__1121"></a>1. 定义一个类</h6> 
<h6><a id="2__1123"></a>2. 静态代码块</h6> 
<ul><li>提供静态代码块加载配置文件，初始化连接池对象</li></ul> 
<h6><a id="3__1127"></a>3. 提供方法</h6> 
<ul><li>获取连接方法；通过数据库连接池获取连接</li><li>释放资源</li><li>获取连接池的方法</li></ul> 
<h6><a id="_1133"></a>代码实现：</h6> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>druid<span class="token punctuation">.</span>pool<span class="token punctuation">.</span></span><span class="token class-name">DruidDataSourceFactory</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">DataSource</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Connection</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">ResultSet</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">SQLException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Statement</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Properties</span></span><span class="token punctuation">;</span>

<span class="token comment">/*
Druid连接池工具类
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JDBCUtils</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">DataSource</span> dataSource<span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Properties</span> properties<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            properties<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"druid.properties"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            dataSource<span class="token operator">=</span> <span class="token class-name">DruidDataSourceFactory</span><span class="token punctuation">.</span><span class="token function">createDataSource</span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/*
    获取连接的方法
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Connection</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> dataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/*
    释放资源
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token class-name">ResultSet</span> resultSet<span class="token punctuation">,</span><span class="token class-name">Statement</span> statement<span class="token punctuation">,</span> <span class="token class-name">Connection</span> connection<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>resultSet<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                resultSet<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>statement<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
           <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
               statement<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
               e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>connection<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//归还连接</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token class-name">Statement</span> statement<span class="token punctuation">,</span> <span class="token class-name">Connection</span> connection<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">close</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span>statement<span class="token punctuation">,</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/*
    获取连接池
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">DataSource</span> <span class="token function">getDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> dataSource<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<br> 
<br> 
<h2><a id="JDBCTemplate_1212"></a>JDBCTemplate</h2> 
<p><code>Spring框架</code>对JDBC的简单封装，提供了一个<code>JdbcTemplate对象</code>，大大的简化了开发</p> 
<h4><a id="_1216"></a>步骤</h4> 
<h6><a id="1_jar_1218"></a>1. 导入jar包</h6> 
<p>以下是我的下载参考页面地址↓</p> 
<p><a href="https://blog.csdn.net/weixin_44133099/article/details/102553900">spring jar包 以及 jdbcTemplate 相关jar包下载_jdbctemplate的jar包-CSDN博客</a></p> 
<p><img src="https://images2.imgbox.com/b9/82/74VLIfHK_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="2JdbcTemplate_1227"></a>2.创建JdbcTemplate对象</h6> 
<ul><li>依赖于数据源DataSource</li></ul> 
<p><code>JdbcTemplate template = new jdbcTemplate(dataSource);</code></p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>itcast<span class="token punctuation">.</span></span><span class="token constant">JDBC</span>数据库与连接池<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>JDBCUtils<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">JdbcTemplate</span></span><span class="token punctuation">;</span>

<span class="token comment">/*
JDBCTemplateDemo1 入门
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JDBCTemplateDemo1</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token comment">//        1.导入jar包</span>
<span class="token comment">//        2.创建JDBCTemplate</span>
        <span class="token class-name">JdbcTemplate</span> template<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">JdbcTemplate</span><span class="token punctuation">(</span><span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token function">getDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        3.调用方法</span>
        <span class="token class-name">String</span> sql<span class="token operator">=</span><span class="token string">"update account set balance=5000 where id=?"</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> count <span class="token operator">=</span>template<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h6><a id="3_JdbcTemplateCRUD_1253"></a>3. 调用JdbcTemplate的方法来完成CRUD的操作</h6> 
<ul><li><code>update()</code>：执行DML语句。增、删、改语句</li><li><code>queryForMap()</code>：查询结果将结果集封装为map集合</li><li><code>queryForList()</code>：查询结果将结果集封装为list集合</li><li><code>query()</code>：查询结果，将结果封装为JavaBean对象</li><li><code>queryForobject</code>：查询结果，将结果封装为对象</li></ul> 
<h6><a id="4__1261"></a>4. 练习</h6> 
<ul><li>修改1号数据的 salary 为 10000</li><li>添加一条记录</li><li>删除刚才添加的记录</li><li>查询id为1的记录，将其封装为Map集合</li><li>查询所有记录，将其封装为List</li><li>查询所有记录，将其封装为Emp对象的List集合</li><li>查询总记录数</li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1a48d9f6c8d0cebe846c6d5dc0b5fd4c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【hive】- 使用insert into/insert overwrite插入数据到静态分区、动态分区、动静态分区</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b434e21944fbeb9a035b17dbca3f9401/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">web 技术栈有哪些？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>