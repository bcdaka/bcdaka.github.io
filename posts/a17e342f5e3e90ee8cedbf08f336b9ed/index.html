<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>RabbitMQ如何测试 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/a17e342f5e3e90ee8cedbf08f336b9ed/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="RabbitMQ如何测试">
  <meta property="og:description" content="结合上一篇的遇到bug如何查日志
我们来学习下，如何使用RabbitMQ管理台来测试MQ；
还是之前的例子，用图片简单介绍下逻辑
01 为什么我们要测MQ？什么时候测？ 当认证成功之后，没有更新账号的认证状态，涉及到MQ的地方都有可能产生bug：
认证系统没有发MQ；认证系统发送的MQ数据错误或字段缺失；账号系统没有消费MQ；账号系统消费了MQ，但是更新认证状态失败； 除了查询服务器日志之外，MQ后台也可以帮助我们定位MQ问题；
02 RabbitMQ工作原理 在讲解如何查询之前，得先了解下MQ的工作原理：
其中，中间的Broker表示RabbitMQ服务，每个Broker里面至少有一个Virtual host虚拟主机，每个虚拟主机中有自己的Exchange交换机、Queue队列以及Exchange交换机与Queue队列之间的绑定关系Binding。producer（生产者）和consumer（消费者）通过与Broker建立Connection来保持连接，然后在Connection的基础上建立若干Channel信道，用来发送与接收消息。
上面是官方解释，我用小白语言翻译一遍，就是如下图：
03 RabbitMQ管理后台 讲完原理，再看下后台长什么样子：
交换机列表： 交换机详情： 选择一个交换机，可以查看到有哪些路由，哪些队列绑定了哪些路由；
可以新增队列、手动触发发送mq消息；
队列列表： 可以看到队列的堆积情况，及消息处理速度；（如果有堆积，且一直在新增，说明并没有被消费）
可以新增自己的队列，绑定交换机及路由；
队列详情： 04 分析问题 现在要开始分析了：
1、认证MQ发了没？认证系统发送的MQ数据错误或字段缺失；
由于MQ被消费了之后，队列就清空了，如果发送和消费都没问题的话，那账号队列是空的，无法查询到；
这个时候，我们可以新增一个自己的队列，去绑定认证的交换机路由；由于自己新增的队列没有程序去消费，会一直积压，就可以通过自己新增队列查询消息；
如果能查询到消息，说明认证是发送了的；
通过get message而且还可以看到消息内容是否正确，有无字段缺失等；
如果没有发送，那么在常规的测试场景下，就无法测试账号的消费是否有bug，我们可以在交换机详情页，手动推送MQ，去看账号是否变更认证状态；（但是这个时候不好把握MQ的消息格式，得去问开发）
2、账号消费了MQ吗？
这个时候只需要去看账号的队列是否有积压就可以了；
3、账号系统消费了MQ，但是更新认证状态失败；
到这一步在MQ阶段就收尾了，就去查询其他问题了，有没有报错之类的（上篇已讲过）；
好了，到此MQ的介绍就已完结；其实关于RabbitMQ管理后台的讲解只是冰山一角，这里只列出了与本文排查有关的，大家可以再多去了解一下～ 欢迎大家一起探讨～">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-08T17:44:19+08:00">
    <meta property="article:modified_time" content="2024-05-08T17:44:19+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">RabbitMQ如何测试</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>结合上一篇的<a class="link-info" href="https://blog.csdn.net/axing194/article/details/138579820" title="遇到bug如何查日志">遇到bug如何查日志</a></p> 
<p>我们来学习下，如何使用RabbitMQ管理台来测试MQ；</p> 
<p></p> 
<p>还是之前的例子，用图片简单介绍下逻辑</p> 
<h4 id="RabbitMQ如何测试-01为什么我们要测MQ？什么时候测？">01 为什么我们要测MQ？什么时候测？</h4> 
<p><img alt="" height="367" src="https://images2.imgbox.com/8d/5d/NJZtiInG_o.png" width="561"></p> 
<p>当认证成功之后，没有更新账号的认证状态，涉及到MQ的地方都有可能产生bug：</p> 
<ul><li>认证系统没有发MQ；</li><li>认证系统发送的MQ数据错误或字段缺失；</li><li>账号系统没有消费MQ；</li><li>账号系统消费了MQ，但是更新认证状态失败；</li></ul> 
<p></p> 
<p>除了查询服务器日志之外，MQ后台也可以帮助我们定位MQ问题；</p> 
<p></p> 
<h4 id="RabbitMQ如何测试-02RabbitMQ工作原理"><strong>02  RabbitMQ工作原理</strong></h4> 
<p>在讲解如何查询之前，得先了解下MQ的工作原理：</p> 
<p><img alt="" height="329" src="https://images2.imgbox.com/24/ac/j6tHvz2u_o.png" width="865"></p> 
<p></p> 
<p>其中，中间的Broker表示RabbitMQ服务，每个Broker里面至少有一个Virtual host虚拟主机，每个虚拟主机中有自己的Exchange交换机、Queue队列以及Exchange交换机与Queue队列之间的绑定关系Binding。producer（生产者）和consumer（消费者）通过与Broker建立Connection来保持连接，然后在Connection的基础上建立若干Channel信道，用来发送与接收消息。</p> 
<p></p> 
<p>上面是官方解释，我用小白语言翻译一遍，就是如下图：</p> 
<p><img alt="" height="377" src="https://images2.imgbox.com/a3/15/vSHHcRpu_o.png" width="828"></p> 
<h4 id="RabbitMQ如何测试-03RabbitMQ管理后台"><strong>03  RabbitMQ管理后台</strong></h4> 
<p>讲完原理，再看下后台长什么样子：</p> 
<p></p> 
<ul><li> <h5 id="RabbitMQ如何测试-交换机列表："><strong><u>交换机列表：</u></strong></h5> </li></ul> 
<p><img alt="" height="443" src="https://images2.imgbox.com/fb/79/3BiaPlyl_o.png" width="805"></p> 
<ul><li> <h5 id="RabbitMQ如何测试-交换机详情："><strong><u>交换机详情：</u></strong></h5> </li></ul> 
<p>选择一个交换机，可以查看到有哪些路由，哪些队列绑定了哪些路由；</p> 
<p>可以新增队列、手动触发发送mq消息；</p> 
<p><img alt="" height="366" src="https://images2.imgbox.com/84/15/Cm0FId7R_o.png" width="707"></p> 
<p><img alt="" height="238" src="https://images2.imgbox.com/ef/19/ASUzKDTH_o.png" width="476"></p> 
<ul><li><strong><u>队列列表：</u></strong></li></ul> 
<p>可以看到队列的堆积情况，及消息处理速度；（如果有堆积，且一直在新增，说明并没有被消费）</p> 
<p>可以新增自己的队列，绑定交换机及路由；</p> 
<p><img alt="" height="261" src="https://images2.imgbox.com/62/12/VthZvZnT_o.png" width="843"></p> 
<ul><li><strong><u>队列详情：</u></strong></li></ul> 
<p><img alt="" height="547" src="https://images2.imgbox.com/7e/3a/D6bX8KPG_o.png" width="731"></p> 
<p></p> 
<h4 id="RabbitMQ如何测试-04分析问题"><strong>04  分析问题</strong></h4> 
<p>现在要开始分析了：</p> 
<p></p> 
<p><strong>1、认证MQ发了没？认证系统发送的MQ数据错误或字段缺失；</strong></p> 
<p></p> 
<p>由于MQ被消费了之后，队列就清空了，如果发送和消费都没问题的话，那账号队列是空的，无法查询到；</p> 
<p></p> 
<p>这个时候，我们可以新增一个自己的队列，去绑定认证的交换机路由；由于自己新增的队列没有程序去消费，会一直积压，就可以通过自己新增队列查询消息；</p> 
<p></p> 
<p>如果能查询到消息，说明认证是发送了的；</p> 
<p>通过get message而且还可以看到消息内容是否正确，有无字段缺失等；</p> 
<p><img alt="" height="359" src="https://images2.imgbox.com/1b/dd/SIb7vXn8_o.png" width="955"></p> 
<p>如果没有发送，那么在常规的测试场景下，就无法测试账号的消费是否有bug，我们可以在交换机详情页，手动推送MQ，去看账号是否变更认证状态；（但是这个时候不好把握MQ的消息格式，得去问开发）</p> 
<p></p> 
<p><strong>2、账号消费了MQ吗？</strong></p> 
<p>这个时候只需要去看账号的队列是否有积压就可以了；</p> 
<p></p> 
<p><strong>3、账号系统消费了MQ，但是更新认证状态失败；</strong></p> 
<p>到这一步在MQ阶段就收尾了，就去查询其他问题了，有没有报错之类的（上篇已讲过）；</p> 
<p></p> 
<p>好了，到此MQ的介绍就已完结；其实关于RabbitMQ管理后台的讲解只是冰山一角，这里只列出了与本文排查有关的，大家可以再多去了解一下～ 欢迎大家一起探讨～</p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0dfa326adf8c4b5efc004c8459693c91/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">OpenCV与AI深度学习 | 如何使用YOLOv9检测图片和视频中的目标</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/326e6f88de2fb0842b80cf3385cfc3bd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">hive中复杂数据类型(array，map，struct)讲解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>