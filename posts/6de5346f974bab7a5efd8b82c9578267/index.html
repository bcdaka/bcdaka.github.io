<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>阿里云&#43;DDNS-GO&#43;宝塔反向代理内网穿透后使用域名无端口访问内网保姆级教程 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/6de5346f974bab7a5efd8b82c9578267/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="阿里云&#43;DDNS-GO&#43;宝塔反向代理内网穿透后使用域名无端口访问内网保姆级教程">
  <meta property="og:description" content="第1章 需求的简介和应用功能的概述
1.1 简介 由于公司没有允许员工使用云服务，同时又需要远程存储家中监控摄像头的数据，笔者决定购买一台NAS设备来解决生活和工作上的问题。在经过多方考虑后，笔者选择了绿联NAS，因为它非常适合初学者，而且自带docker，可扩展性非常高。
但是，想要玩转NAS，必须实现内网穿透。如果不进行内网穿透，那么即使购买了NAS，也无法实现远程访问。由于笔者家里的宽带没有公网IP，所以只能采用DDNS-TO进行内网穿透，但它还是存在一些局限性的，例如连接端口数量上限、带宽容量上限等。此外，如果安装应用程序，还需要在DDNS-TO上添加映射，操作较为繁琐。
然而，DDNS-TO也有其优点，例如支持HTTPS方式访问，安装配置简单等。为了替代DDNS-TO的缺陷并保留其优点，笔者通过学习，决定使用 DDNS-GO、阿里云、NginxWebUI、cloudflare组合来实现我的需求。
1.2 应用功能概述
为了替换DDNS-TO的缺点，笔者决定使用DDNS-GO、阿里云、NginxWebUI下面简单概述这些工具各自的功能和解决的问题。
1.2.1 阿里云
阿里云提供了域名服务，可以申请短期免费或长期付费的域名，并且没有连接端口数量上限和带宽容量上限的限制。此外，用户还可以进行个性化自定义，非常方便。同时，阿里云还提供了API密钥（Accesskey id和Accesskey Secret）以及家庭局域网动态公网IP地址与域名的绑定，在NAS上安装应用程序时，只需要记住应用映射的域名即可。
1.2.2 DDNS-GO
DDNS-GO是一款非常实用的内网穿透工具，仅限于无固定IPV4地址和IPV6地址，但有真实动态IPV4地址的内网环境。如果用户拥有固定IPV6或固定IPV4中的其中一种公网IP地址，则不必关注该工具，也无需安装。需要注意的是，获取公网IP需要将光猫改成桥接，而光猫如何改桥接及光猫开通IPV6因运营商而异，用户需要自行百度或咨询运营商的工作人员。使用DDNS-GO做内网穿透前，必须要确定公网IPV4地址是否真实有效，否则可能会出现问题。
1.2.3 NginxWebUI
NginxWebUI是一款管理Nginx服务器的Web界面，支持在Nginx中添加和删除域名、配置文件等操作。它可以通过docker安装在绿联NAS上，方便用户进行管理。
2.访问你的路由器，找到上网设置，查看你路由器上的公网IP 正常路由器地址：192.168.2.1 192.168.0.1 192.168.31.1
3.如果以上两个公网IP是一致的，这意味着公网动态IPV4地址是真实有效的。如果不一致，则说明当前没有公网IP地址。若出现后者，建议直接联系宽带运营商开通动态IPV4或提供固定IPV6地址。如果这些方式都无法满足需求，可以考虑更换宽带运营商或使用其他内网穿透方式（例如DDNS-TO）。
1.2.3 NginxWebUI
NginxWebUI是一款非常实用的工具，它可以实现反向代理，从而访问内网NAS上安装的应用程序，在访问内网应用之前，需要先经过Nginx进行代理。此外，NginxWebUI还支持根据域名生成免费的SSL证书，并将http请求转化为https请求。
1.2.4 cloudflare
cloudflare是一个全球性的CDN网络，提供了很多有用的功能，例如网站加速、防火墙等。通过将自己的域名指向cloudflare，用户可以隐藏NAS真实的IP地址，避免黑客攻击。同时，它还能够转发URL路径重定向，使用户只需使用域名访问而不用带上特定的端口号。
第2章 各应用的安装配置
2.1 阿里云的注册和域名申请
2.1.1 注册
为了使用阿里云提供的服务，首先需要注册一个账户。如果您已经拥有阿里云账户，则可以直接跳过这一步。在访问阿里云的官方网站后，点击“登录/注册”，按照指示填写信息并完成注册。
2.1.2 域名申请
在注册成功之后，可以开始申请域名。这里推荐申请一个.cn或.com的域名，因为这两种域名是最通用的。在阿里云的控制台中，选择“域名”选项卡，然后按照页面上的提示申请域名。当您完成付款后，就可以获得您自己的域名了。
2.2 DDNS-GO的配置
2.2.1 安装DDNS-GO
DDNS-GO可以通过绿联NAS上的docker进行安装，只需在终端中输入相应的命令即可。
2.2.2 DDNS-GO的配置
在安装完成后，需要进行一些配置工作。首先，在阿里云的控制台中创建一对API密钥，并将其保存起来。然后，在DDNS-GO的设置中输入相关信息，例如域名、密钥等。最后，启动DDNS-GO，测试与阿里云的连接是否正常。
阿里云访问地址：https://www.aliyun.com，支持多种注册方式，自行注册。
2.1.2 申请阿里云 API 的密钥
A.注册并登录阿里云后，双击网站首页右上角的“控制台“并进入。
B.设置权限模式
C.在”AccessKey管理”界面创建AccessKey
D.AccessKey ID和AccessKey Secret申请成功后复制到本地保存，后面安装完DDNS-GO后做动态域名绑定时要用到
2.1.3 注册域名 (有域名的可略过，没域名的买个最便宜的后缀即可)
A.在阿里云首页双击搜索图标，选择域名搜索
使用域名需要进行实名认证，具体操作请根据网站提示完成。注册时选择个人使用即可，不需要进行备案。
2.1.4 添加二级域名">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-05T23:11:22+08:00">
    <meta property="article:modified_time" content="2024-08-05T23:11:22+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">阿里云&#43;DDNS-GO&#43;宝塔反向代理内网穿透后使用域名无端口访问内网保姆级教程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p></p> 
<p><em><strong>第1章 需求的简介和应用功能的概述</strong></em></p> 
<p>1.1 简介 由于公司没有允许员工使用云服务，同时又需要远程存储家中监控摄像头的数据，笔者决定购买一台NAS设备来解决生活和工作上的问题。在经过多方考虑后，笔者选择了绿联NAS，因为它非常适合初学者，而且自带docker，可扩展性非常高。</p> 
<p>但是，想要玩转NAS，必须实现内网穿透。如果不进行内网穿透，那么即使购买了NAS，也无法实现远程访问。由于笔者家里的宽带没有公网IP，所以只能采用DDNS-TO进行内网穿透，但它还是存在一些局限性的，例如连接端口数量上限、带宽容量上限等。此外，如果安装应用程序，还需要在DDNS-TO上添加映射，操作较为繁琐。</p> 
<p>然而，DDNS-TO也有其优点，例如支持HTTPS方式访问，安装配置简单等。为了替代DDNS-TO的缺陷并保留其优点，笔者通过学习，决定使用 DDNS-GO、阿里云、NginxWebUI、cloudflare组合来实现我的需求。</p> 
<p>1.2 应用功能概述</p> 
<p>为了替换DDNS-TO的缺点，笔者决定使用DDNS-GO、阿里云、NginxWebUI下面简单概述这些工具各自的功能和解决的问题。</p> 
<p>1.2.1 阿里云</p> 
<p>阿里云提供了域名服务，可以申请短期免费或长期付费的域名，并且没有连接端口数量上限和带宽容量上限的限制。此外，用户还可以进行个性化自定义，非常方便。同时，阿里云还提供了API密钥（Accesskey id和Accesskey Secret）以及家庭局域网动态公网IP地址与域名的绑定，在NAS上安装应用程序时，只需要记住应用映射的域名即可。</p> 
<p>1.2.2 DDNS-GO</p> 
<p>DDNS-GO是一款非常实用的内网穿透工具，仅限于无固定IPV4地址和IPV6地址，但有真实动态IPV4地址的内网环境。如果用户拥有固定IPV6或固定IPV4中的其中一种公网IP地址，则不必关注该工具，也无需安装。需要注意的是，获取公网IP需要将光猫改成桥接，而光猫如何改桥接及光猫开通IPV6因运营商而异，用户需要自行百度或咨询运营商的工作人员。使用DDNS-GO做内网穿透前，必须要确定公网IPV4地址是否真实有效，否则可能会出现问题。</p> 
<p>1.2.3 NginxWebUI</p> 
<p>NginxWebUI是一款管理Nginx服务器的Web界面，支持在Nginx中添加和删除域名、配置文件等操作。它可以通过docker安装在绿联NAS上，方便用户进行管理。</p> 
<p></p> 
<p class="img-center"><img alt="image.png" height="414" src="https://images2.imgbox.com/cc/ba/j5m4Y0Y6_o.png" width="963"></p> 
<p>2.访问你的路由器，找到上网设置，查看你路由器上的公网IP 正常路由器地址：192.168.2.1  192.168.0.1 192.168.31.1</p> 
<p></p> 
<p class="img-center"><img alt="image-1.png" height="573" src="https://images2.imgbox.com/07/1d/VRXQVtmb_o.png" width="1200"></p> 
<p>3.如果以上两个公网IP是一致的，这意味着公网动态IPV4地址是真实有效的。如果不一致，则说明当前没有公网IP地址。若出现后者，建议直接联系宽带运营商开通动态IPV4或提供固定IPV6地址。如果这些方式都无法满足需求，可以考虑更换宽带运营商或使用其他内网穿透方式（例如DDNS-TO）。<br> 1.2.3 NginxWebUI</p> 
<p>NginxWebUI是一款非常实用的工具，它可以实现反向代理，从而访问内网NAS上安装的应用程序，在访问内网应用之前，需要先经过Nginx进行代理。此外，NginxWebUI还支持根据域名生成免费的SSL证书，并将http请求转化为https请求。</p> 
<p>1.2.4 cloudflare</p> 
<p>cloudflare是一个全球性的CDN网络，提供了很多有用的功能，例如网站加速、防火墙等。通过将自己的域名指向cloudflare，用户可以隐藏NAS真实的IP地址，避免黑客攻击。同时，它还能够转发URL路径重定向，使用户只需使用域名访问而不用带上特定的端口号。</p> 
<p>第2章 各应用的安装配置</p> 
<p>2.1 阿里云的注册和域名申请</p> 
<p>2.1.1 注册</p> 
<p>为了使用阿里云提供的服务，首先需要注册一个账户。如果您已经拥有阿里云账户，则可以直接跳过这一步。在访问阿里云的官方网站后，点击“登录/注册”，按照指示填写信息并完成注册。</p> 
<p>2.1.2 域名申请</p> 
<p>在注册成功之后，可以开始申请域名。这里推荐申请一个.cn或.com的域名，因为这两种域名是最通用的。在阿里云的控制台中，选择“域名”选项卡，然后按照页面上的提示申请域名。当您完成付款后，就可以获得您自己的域名了。</p> 
<p>2.2 DDNS-GO的配置</p> 
<p>2.2.1 安装DDNS-GO</p> 
<p>DDNS-GO可以通过绿联NAS上的docker进行安装，只需在终端中输入相应的命令即可。</p> 
<p>2.2.2 DDNS-GO的配置</p> 
<p>在安装完成后，需要进行一些配置工作。首先，在阿里云的控制台中创建一对API密钥，并将其保存起来。然后，在DDNS-GO的设置中输入相关信息，例如域名、密钥等。最后，启动DDNS-GO，测试与阿里云的连接是否正常。</p> 
<p>阿里云访问地址：<a href="https://www.aliyun.com/" rel="nofollow" title="https://www.aliyun.com">https://www.aliyun.com</a>，支持多种注册方式，自行注册。</p> 
<p></p> 
<p class="img-center"><img alt="image-3.png" height="452" src="https://images2.imgbox.com/d2/fc/oQkrLSPS_o.png" width="1200"></p> 
<p><em>2.1.2 申请阿里云 API 的密钥</em><br> A.注册并登录阿里云后，双击网站首页右上角的“控制台“并进入。</p> 
<p></p> 
<p class="img-center"><img alt="image-4.png" height="703" src="https://images2.imgbox.com/a0/d8/a1ViW5wq_o.png" width="1200"></p> 
<p>B.设置权限模式</p> 
<p></p> 
<p class="img-center"><img alt="image-5.png" height="234" src="https://images2.imgbox.com/08/7d/sskhNeBd_o.png" width="1200"></p> 
<p>C.在”AccessKey管理”界面创建AccessKey</p> 
<p></p> 
<p class="img-center"><img alt="image-6.png" height="631" src="https://images2.imgbox.com/43/e5/wnvGZyqj_o.png" width="1200"></p> 
<p>D.AccessKey ID和AccessKey Secret申请成功后复制到本地保存，后面安装完DDNS-GO后做动态域名绑定时要用到</p> 
<p><em>2.1.3 注册域名 (有域名的可略过，没域名的买个最便宜的后缀即可)</em></p> 
<p>A.在阿里云首页双击搜索图标，选择域名搜索</p> 
<p>使用域名需要进行实名认证，具体操作请根据网站提示完成。注册时选择个人使用即可，不需要进行备案。</p> 
<p>2.1.4 添加二级域名</p> 
<p>在申请一级域名之后，我们需要再添加一个前缀来变成二级域名。例如，如果一级域名是“huixx.com”，那么可以加上前缀“www”来变成二级域名“www.huixx.cc”。理论上，只要前缀不同，我们就可以拥有无数个二级域名。</p> 
<p>A. 申请一级域名后，需要在阿里云的控制台中添加相应的记录来创建二级域名。</p> 
<p></p> 
<p class="img-center"><img alt="image-7.png" height="906" src="https://images2.imgbox.com/57/39/uGjCoqma_o.png" width="1200"></p> 
<p><em>2.2 DDNS-GO的安装和配置</em><br><em>2.2.1 安装配置</em></p> 
<pre>1.wget https://github.com/jeessy2/ddns-go/releases/download/v6.6.2/ddns-go_6.6.2_linux_x86_64.tar.gz
2.tar-zxvf ddns-go_6.6.2_linux_x86_64.tar.gz
3.cd ddns-go_6.6.2_linux_x86_64
4.sudo ./ddns-go -s install</pre> 
<p>启动ddns-go<br><strong>systemctl start ddns-go</strong></p> 
<p>设置开机自启<br><strong>systemctl enable ddns-go</strong></p> 
<p>查看运行状态<br><strong>systemctl status ddns-go.service</strong></p> 
<p>9.通过宿主机访问浏览器页面进行配置（如果是gui的安装可以直接浏览器访问127.0.0.1:9876）</p> 
<p><em>2.2.1 配置DDNS-go （安装机器：192.168.2.x:9876）</em></p> 
<p></p> 
<p class="img-center"><img alt="image-8.png" height="863" src="https://images2.imgbox.com/27/0b/AhN8oY8s_o.png" width="1057"></p> 
<p></p> 
<p><em>2.2.3 验证内网穿透</em></p> 
<p>A.登录阿里云上查看二级域名的记录值（绑定的动态公网IP）是否正确，是否正常</p> 
<p></p> 
<p class="img-center"><img alt="image-9.png" height="366" src="https://images2.imgbox.com/dd/5d/qewOUnNT_o.png" width="1099"></p> 
<p>B.将pve的8006端口在路由器里做端口映射</p> 
<p></p> 
<p class="img-center"><img alt="image-10.png" height="705" src="https://images2.imgbox.com/ef/1c/qklKoCWp_o.png" width="1192"></p> 
<p>C.在公网上用浏览器中域名+端口（例如<a href="https://link.zhihu.com/?target=http%3A//ddnsgo.laoliu.com%3A9876" rel="nofollow" title="http://">http://</a>www.huixx.cc:8006）的方式访问pve。如果能正常访问则说明内网穿透鼓捣成功了。为了验证的严谨性，测试终端连接的公网和pve接入的公网的不要不要在同一个局域网内</p> 
<p></p> 
<p class="img-center"><img alt="image-11.png" height="836" src="https://images2.imgbox.com/73/cc/sc64RUsH_o.png" width="1200"></p> 
<p>通过以上步骤的设置基本解决了pve的内网穿透需求。通过在路由器中映射不同的端口，来开通NAS上安装应用的公网访问限制。但仍然有些小瑕疵，例如：<br> 1.使用的是http协议明文访问，未加密。终极目标是使用https协议加密访问。<br> 2.访问时需要带端口，不像正规的网站,并且不同的应用要映射不同的端口，不便于记忆。目标是只使用域名访问，例如：“https://www.huixx.com”。<br> 3.做端口映射还要登录路由器。目标是使用软件程序代替路由器来做映射。<br> 要解决以上问题，需要继续执行后面的工作。</p> 
<p></p> 
<p class="img-center"><img alt="image-12.png" height="763" src="https://images2.imgbox.com/c9/df/iSPogYtz_o.png" width="861"></p> 
<p></p> 
<p class="img-center"><img alt="image-13.png" height="755" src="https://images2.imgbox.com/df/8a/ZtamMLwk_o.png" width="831"></p> 
<p>原文链接：<a href="https://www.server7.cc/2024/08/05/74.html" rel="nofollow" title="DDNS域名内网穿透建站 家里云秒变服务器教程 - 主机测评|Linux运维">DDNS域名内网穿透建站 家里云秒变服务器教程 - 主机测评|Linux运维</a></p> 
<p class="img-center"><img alt="image-14.png" height="804" src="https://images2.imgbox.com/96/aa/ZQHWXm7K_o.png" width="1200"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/680c8d5e429ac2accdb4b79e2141b688/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Django与数据库</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0cd7f956c37c1a99f1fa9ba15d02a2b3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Java数据结构】---初始数据结构</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>