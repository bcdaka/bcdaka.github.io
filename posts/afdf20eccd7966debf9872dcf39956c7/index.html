<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【java集成onlyoffice实现多人在线编辑的介绍和代码实现】 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/afdf20eccd7966debf9872dcf39956c7/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【java集成onlyoffice实现多人在线编辑的介绍和代码实现】">
  <meta property="og:description" content="Java集成OnlyOffice实现多人在线编辑的具体步骤和代码实现如下：
步骤一：设置OnlyOffice服务端和前端
首先，需要搭建一个OnlyOffice服务器，可以使用Docker部署OnlyOffice服务器。具体的部署方法可以参考OnlyOffice官方文档。
然后，需要在前端页面中集成OnlyOffice编辑器。可以使用OnlyOffice提供的JavaScript API来实现，在前端页面中插入一个iframe元素，并将OnlyOffice编辑器嵌入到iframe中。具体的集成方法可以参考OnlyOffice官方文档。
步骤二：后端代码实现
创建一个Java Web项目，并添加OnlyOffice的Java SDK依赖。
创建一个Controller类，用于接收前端的请求，并将请求转发给OnlyOffice服务器。
import org.onlyoffice.core.request.Request; import org.onlyoffice.core.response.Response; import org.onlyoffice.core.service.request.CreateRequest; import org.onlyoffice.core.service.response.CreateResponse; import org.springframework.http.ResponseEntity; import org.springframework.web.bind.annotation.PostMapping; import org.springframework.web.bind.annotation.RequestBody; import org.springframework.web.bind.annotation.RestController; @RestController public class OnlyOfficeController { @PostMapping(&#34;/create&#34;) public ResponseEntity&lt;String&gt; createFile(@RequestBody CreateRequest createRequest) { // 创建一个OnlyOffice请求对象 Request request = new Request(createRequest); // 发送请求给OnlyOffice服务器，并获取响应 Response response = request.send(); // 将响应返回给前端 return ResponseEntity.ok(response.getBody()); } } 在配置文件中配置OnlyOffice服务器的地址和访问令牌。 onlyoffice.api.url=http://localhost:8080 onlyoffice.api.token=your_token_here 步骤三：前端页面代码实现
在前端页面中发送一个请求给后端，请求后端创建一个OnlyOffice文档。 function createDocument() { var request = { fileType: &#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-02-22T14:50:40+08:00">
    <meta property="article:modified_time" content="2024-02-22T14:50:40+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【java集成onlyoffice实现多人在线编辑的介绍和代码实现】</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>Java集成OnlyOffice实现多人在线编辑的具体步骤和代码实现如下：</p> 
<p>步骤一：设置OnlyOffice服务端和前端</p> 
<ol><li> <p>首先，需要搭建一个OnlyOffice服务器，可以使用Docker部署OnlyOffice服务器。具体的部署方法可以参考OnlyOffice官方文档。</p> </li><li> <p>然后，需要在前端页面中集成OnlyOffice编辑器。可以使用OnlyOffice提供的JavaScript API来实现，在前端页面中插入一个iframe元素，并将OnlyOffice编辑器嵌入到iframe中。具体的集成方法可以参考OnlyOffice官方文档。</p> </li></ol> 
<p>步骤二：后端代码实现</p> 
<ol><li> <p>创建一个Java Web项目，并添加OnlyOffice的Java SDK依赖。</p> </li><li> <p>创建一个Controller类，用于接收前端的请求，并将请求转发给OnlyOffice服务器。</p> </li></ol> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>onlyoffice<span class="token punctuation">.</span>core<span class="token punctuation">.</span>request<span class="token punctuation">.</span></span><span class="token class-name">Request</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>onlyoffice<span class="token punctuation">.</span>core<span class="token punctuation">.</span>response<span class="token punctuation">.</span></span><span class="token class-name">Response</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>onlyoffice<span class="token punctuation">.</span>core<span class="token punctuation">.</span>service<span class="token punctuation">.</span>request<span class="token punctuation">.</span></span><span class="token class-name">CreateRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>onlyoffice<span class="token punctuation">.</span>core<span class="token punctuation">.</span>service<span class="token punctuation">.</span>response<span class="token punctuation">.</span></span><span class="token class-name">CreateResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">ResponseEntity</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PostMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestBody</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OnlyOfficeController</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/create"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">createFile</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">CreateRequest</span> createRequest<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 创建一个OnlyOffice请求对象</span>
        <span class="token class-name">Request</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span>createRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// 发送请求给OnlyOffice服务器，并获取响应</span>
        <span class="token class-name">Response</span> response <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// 将响应返回给前端</span>
        <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<ol start="3"><li>在配置文件中配置OnlyOffice服务器的地址和访问令牌。</li></ol> 
<pre><code class="prism language-properties">onlyoffice.api.url=http://localhost:8080
onlyoffice.api.token=your_token_here
</code></pre> 
<p>步骤三：前端页面代码实现</p> 
<ol><li>在前端页面中发送一个请求给后端，请求后端创建一个OnlyOffice文档。</li></ol> 
<pre><code class="prism language-javascript"><span class="token keyword">function</span> <span class="token function">createDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">var</span> request <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">fileType</span><span class="token operator">:</span> <span class="token string">"docx"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">"Untitled"</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">"/create"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"POST"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">contentType</span><span class="token operator">:</span> <span class="token string">"application/json"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 根据返回的响应数据，加载OnlyOffice编辑器</span>
            <span class="token keyword">var</span> editor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DocsAPI<span class="token punctuation">.</span>DocEditor</span><span class="token punctuation">(</span><span class="token string">"editorContainer"</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">error</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">xhr<span class="token punctuation">,</span> status<span class="token punctuation">,</span> error</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<ol start="2"><li>在页面中添加一个用于显示OnlyOffice编辑器的容器。</li></ol> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>editorContainer<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>完成以上步骤后，就可以实现多人在线编辑功能了。当用户访问前端页面时，会向后端发送一个请求来创建一个OnlyOffice文档，然后将文档加载到前端页面中的iframe元素中。多个用户可以同时编辑同一个文档，并实时同步编辑的内容。</p> 
<p>注意：以上代码仅为示例，实际使用时需要根据具体的业务需求进行适当的修改和调整。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/033888b0622bcc7ef1cb195c60ba0d1e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MySQL报错：sql_mode=only_full_group_by解决方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/94d53f793707381d101ac9be26a6d558/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">将python两个版本添加环境变量（Mac版）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>