<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>springboot æ•´åˆ mybatis-plus - ç¼–ç¨‹å¤§å’–</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/9f0971fe9d8b23e33d4185eba0761cea/">
  <meta property="og:site_name" content="ç¼–ç¨‹å¤§å’–">
  <meta property="og:title" content="springboot æ•´åˆ mybatis-plus">
  <meta property="og:description" content="ä¸€.å‰è¨€ 1.Â mybatis-plusæ˜¯ä»€ä¹ˆ
mybatis-plusæ˜¯ä¸€ä¸ªå¯¹mybatiæ¡†æ¶çš„æ‹“å±•æ¡†æ¶ï¼Œå®ƒåœ¨mybatisæ¡†æ¶åŸºç¡€ä¸Šåšäº†è®¸å¤šçš„å¢å¼ºï¼Œå¸®åŠ©æˆ‘ä»¬å¿«é€Ÿçš„è¿›è¡Œä»£ç å¼€å‘ã€‚ç›®å‰ä¼ä¸šå¼€å‘ä¸­ï¼Œä½¿ç”¨mybatiçš„é¡¹ç›®åŸºæœ¬ä¼šé€‰æ‹©ä½¿ç”¨mybatis-plusæ¥æå‡å¼€å‘æ•ˆç‡ã€‚
2.å®˜ç½‘åœ°å€ï¼šMyBatis-Plus ğŸš€ ä¸ºç®€åŒ–å¼€å‘è€Œç”Ÿ
äºŒ.é¡¹ç›®é›†æˆ 1. é¡¹ç›®ä¸­é›†æˆ(ç¤ºä¾‹ç”¨çš„springboot2.x&#43;mysql)
step1.å¼•å…¥ä¾èµ–
&lt;dependency&gt; &lt;groupId&gt;com.baomidou&lt;/groupId&gt; &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt; &lt;version&gt;3.5.7&lt;/version&gt; &lt;/dependency&gt; step2.é…ç½®æ•°æ®æº
spring: datasource: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql://192.168.**.**:3306/rui username: root password: ****** step3.å¯åŠ¨ç±»æ·»åŠ æ³¨è§£ @MapperScan æŒ‡å‘mapperæ¥å£æ‰€åœ¨åŒ…
@SpringBootApplication @MapperScan(&#34;com.rui.mapper&#34;) @EnableFeignClients(defaultConfiguration = MyFeignConfiguration.class) public class AdminServerApplication { public static void main(String[] args) { SpringApplication.run(AdminServerApplication.class, args); } } step4.å®šä¹‰å®ä½“ç±»
step5.ç¼–ç æµ‹è¯•ï¼š
ï¼ˆç¼–ç æµ‹è¯•æ¼”ç¤ºæ¯”è¾ƒæ¥è¿‘å®é™…å¼€å‘çš„ä»£ç ï¼Œå¦‚æœåªæ˜¯ç®€å•éªŒè¯ï¼Œç”¨baseMapperå°±è¡Œäº†ï¼‰
ä»¥ä¸‹ä»£ç å‡ä¸ºmybatis-plusæä¾›çš„ä»£ç ç”Ÿæˆå™¨ç”Ÿæˆçš„ï¼Œå¦‚ä½•ä½¿ç”¨åœ¨åç»­æ®µè½ä¼šè®²ï¼Œè¿™é‡Œå…ˆçœ‹ä¸€ä¸‹ä»£ç æ ·å­ï¼Œçœ¼ç†Ÿä»¥ä¸‹
ä»£ç ç»“æ„ï¼š
controllerå±‚ï¼š
@Slf4j @RestController @RequestMapping(&#34;/configInfo&#34;) public class ConfigInfoController { @Autowired private IConfigInfoService configInfoService; @GetMapping(&#34;/list&#34;) public List&lt;ConfigInfo&gt; listConfigs () { return configInfoService.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-03T21:26:28+08:00">
    <meta property="article:modified_time" content="2024-07-03T21:26:28+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§å’–" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§å’–</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">springboot æ•´åˆ mybatis-plus</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>ä¸€.å‰è¨€</h2> 
<p>Â  Â  Â  Â  1.Â mybatis-plusæ˜¯ä»€ä¹ˆ</p> 
<p>Â  Â  Â  Â  mybatis-plusæ˜¯ä¸€ä¸ªå¯¹mybatiæ¡†æ¶çš„æ‹“å±•æ¡†æ¶ï¼Œå®ƒåœ¨mybatisæ¡†æ¶åŸºç¡€ä¸Šåšäº†è®¸å¤šçš„å¢å¼ºï¼Œå¸®åŠ©æˆ‘ä»¬å¿«é€Ÿçš„è¿›è¡Œä»£ç å¼€å‘ã€‚ç›®å‰ä¼ä¸šå¼€å‘ä¸­ï¼Œä½¿ç”¨mybatiçš„é¡¹ç›®åŸºæœ¬ä¼šé€‰æ‹©ä½¿ç”¨mybatis-plusæ¥æå‡å¼€å‘æ•ˆç‡ã€‚</p> 
<p>Â  Â  Â  Â  2.å®˜ç½‘åœ°å€ï¼š<a href="https://baomidou.com/" rel="nofollow" title="MyBatis-Plus ğŸš€ ä¸ºç®€åŒ–å¼€å‘è€Œç”Ÿ">MyBatis-Plus ğŸš€ ä¸ºç®€åŒ–å¼€å‘è€Œç”Ÿ</a></p> 
<h2>äºŒ.é¡¹ç›®é›†æˆ</h2> 
<p>Â  Â  Â  Â  1. é¡¹ç›®ä¸­é›†æˆ(ç¤ºä¾‹ç”¨çš„springboot2.x+mysql)</p> 
<p>Â  Â  Â  Â  step1.å¼•å…¥ä¾èµ–</p> 
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;com.baomidou&lt;/groupId&gt;
    &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt;
    &lt;version&gt;3.5.7&lt;/version&gt;
&lt;/dependency&gt;</code></pre> 
<p>Â  Â  Â  Â  step2.é…ç½®æ•°æ®æº</p> 
<pre><code>spring: 
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://192.168.**.**:3306/rui
    username: root
    password: ******</code></pre> 
<p>Â  Â  Â  Â  step3.å¯åŠ¨ç±»æ·»åŠ æ³¨è§£ @MapperScan æŒ‡å‘mapperæ¥å£æ‰€åœ¨åŒ…</p> 
<pre><code>@SpringBootApplication
@MapperScan("com.rui.mapper")
@EnableFeignClients(defaultConfiguration = MyFeignConfiguration.class)
public class AdminServerApplication {
    public static void main(String[] args) {
        SpringApplication.run(AdminServerApplication.class, args);
    }
}</code></pre> 
<p>Â  Â  Â  Â  step4.å®šä¹‰å®ä½“ç±»</p> 
<p><img alt="" height="737" src="https://images2.imgbox.com/8f/7a/i8rbzmnI_o.png" width="1200"></p> 
<p>Â  Â  Â  Â  step5.ç¼–ç æµ‹è¯•ï¼š</p> 
<p>ï¼ˆç¼–ç æµ‹è¯•æ¼”ç¤ºæ¯”è¾ƒæ¥è¿‘å®é™…å¼€å‘çš„ä»£ç ï¼Œå¦‚æœåªæ˜¯ç®€å•éªŒè¯ï¼Œç”¨baseMapperå°±è¡Œäº†ï¼‰</p> 
<p>ä»¥ä¸‹ä»£ç å‡ä¸ºmybatis-plusæä¾›çš„ä»£ç ç”Ÿæˆå™¨ç”Ÿæˆçš„ï¼Œå¦‚ä½•ä½¿ç”¨åœ¨åç»­æ®µè½ä¼šè®²ï¼Œè¿™é‡Œå…ˆçœ‹ä¸€ä¸‹ä»£ç æ ·å­ï¼Œçœ¼ç†Ÿä»¥ä¸‹</p> 
<p>ä»£ç ç»“æ„ï¼š</p> 
<p><img alt="" height="699" src="https://images2.imgbox.com/70/9e/ANJTtlmc_o.png" width="890"></p> 
<p>controllerå±‚ï¼š</p> 
<pre><code>@Slf4j
@RestController
@RequestMapping("/configInfo")
public class ConfigInfoController {

    @Autowired
    private IConfigInfoService configInfoService;

    @GetMapping("/list")
    public List&lt;ConfigInfo&gt;  listConfigs () {
        return configInfoService.list();
    }

}</code></pre> 
<p>serviceå±‚ï¼š</p> 
<p>Â  Â  Â  Â  interfaceï¼š</p> 
<pre><code>public interface IConfigInfoService extends IService&lt;ConfigInfo&gt; {

}</code></pre> 
<p>Â  Â  Â  Â  impl:</p> 
<p>** æ³¨æ„ï¼Œè¿™é‡Œç»§æ‰¿äº†ä¸€ä¸ªServiceImpl å®ƒæ˜¯mybatis-plusæä¾›çš„ç±»ï¼Œå¸®æˆ‘ä»¬å®Œæˆè®¸DBæ“ä½œ**</p> 
<pre><code>@Service
public class ConfigInfoServiceImpl extends ServiceImpl&lt;ConfigInfoMapper, ConfigInfo&gt; implements IConfigInfoService {

}</code></pre> 
<p>mapperå±‚ï¼š</p> 
<p>Â  Â  Â  Â  mapperæ¥å£ï¼š</p> 
<p>** æ³¨æ„ï¼Œæˆ‘ä»¬çš„mapperå®ç°äº†Â BaseMapper ,å®ƒæ˜¯mybatis-plusæä¾›çš„æ¥å£ï¼Œæœ‰å¸¸ç”¨çš„CRUD**</p> 
<pre><code>public interface ConfigInfoMapper extends BaseMapper&lt;ConfigInfo&gt; {

}</code></pre> 
<p>Â  Â  Â  Â  mapper.xml: ï¼ˆå…¶å®å°±æ˜¯ç©ºçš„ï¼Œå¦‚æœåé¢å¼€å§‹æœ‰è‡ªå®šä¹‰sqlï¼Œéœ€è¦è¿™é‡Œå†™ï¼‰</p> 
<pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;
&lt;mapper namespace="com.rui.mapper.ConfigInfoMapper"&gt;

&lt;/mapper&gt;</code></pre> 
<p>Â  Â  Â  Â  ä»¥ä¸Šæ“ä½œç»“æŸåï¼Œå¯åŠ¨é¡¹ç›®ï¼ŒpostManè®¿é—®æ¥å£ï¼Œå‘ç°å¯ä»¥æ­£å¸¸è®¿é—®æ•°æ®åº“ï¼š</p> 
<p><img alt="" height="803" src="https://images2.imgbox.com/f0/cc/719cbegH_o.png" width="834"></p> 
<p></p> 
<p>åœ¨æµ‹è¯•ç¯èŠ‚ï¼Œå¤§å®¶å¯ä»¥å‘ç°æˆ‘çš„serviceå’Œmapperéƒ½æ˜¯ç©ºçš„ï¼Œä½†æ˜¯å´å¯ä»¥è°ƒç”¨listæ–¹æ³•è®¿é—®æ•°æ®åº“ã€‚</p> 
<p>å…¶å®ï¼Œä¸Šé¢çš„ç¼–ç ä¸­ï¼Œæˆ‘ä»¬åœ¨è‡ªå·±çš„ä¸šåŠ¡Serviceä¸­ç»§æ‰¿äº†æŠ½è±¡ç±»ServiceImplï¼ŒServiceImplå®ç°äº†IServiceè¿™ä¸ªæ¥å£ä¸­çš„æ–¹æ³•ï¼Œå¹¶å®šä¹‰äº†å››ä¸ªæˆå‘˜å˜é‡ baseMapperï¼ŒentityClassï¼Œ mapperClassï¼Œlogï¼Œä¸”è¿™å››ä¸ªæˆå‘˜å˜é‡éƒ½æ˜¯protectedçš„ï¼Œå› æ­¤ï¼Œåœ¨æˆ‘ä»¬çš„ä¸šåŠ¡Serviceä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è°ƒç”¨IServiceçš„æ–¹æ³•è¯¸å¦‚saveAndUpdateï¼Œlistï¼Œpageç­‰ï¼Œä¹Ÿå¯ä»¥é€šè¿‡this.baseMapper çš„æ–¹å¼æ¥è·å–baseMapperå¯¹è±¡ï¼Œæ¥è°ƒç”¨baseMapperçš„æ–¹æ³•</p> 
<h2 style="background-color:transparent;">ä¸‰.ä½¿ç”¨æŠ€å·§</h2> 
<h3>Â  Â  Â  Â  1.ç†è§£mybatis-plusåœ¨ä»£ç ä¸­åšçš„äº‹æƒ…</h3> 
<p>Â Â Â Â Â Â Â Â mybatis-plusä¸ºæˆ‘ä»¬æä¾›çš„<strong>æœ€æ ¸å¿ƒçš„åŠŸèƒ½å…¶å®å°±æ˜¯å¯¹Mybatisçš„Mapperæ¥å£çš„å¢å¼º</strong>ï¼Œå®ƒ<strong>æä¾›äº†ä¸€ä¸ªBaseMapper</strong>ï¼Œä¸€ä¸ªmybatisçš„<strong>mapperæ¥å£ç»§æ‰¿äº†BaseMapperçš„è¯ï¼Œå°±ä¼šè¢«mybatis-plusè¿›è¡Œå¢å¼ºï¼Œå®ç°ä¸€ç³»åˆ—çš„å¸¸ç”¨çš„æ•°æ®åº“æ“</strong>ã€‚ä½¿ç”¨mybatis-plusæœ€ç®€å•çš„åŠæ³•å…¶å®å°±æ˜¯å¼•å…¥mybatis-plusçš„ä¾èµ–åï¼Œå®šä¹‰å¥½Entityå¯¹è±¡ï¼ˆå®ä½“å¯¹è±¡ï¼‰ï¼Œç„¶åè®©mapperç»§æ‰¿BaseMapperï¼Œæœ€ç»ˆæˆ‘ä»¬ä½¿ç”¨baseMaperä¸­çš„æ–¹æ³•æ¥è¿›è¡Œå¼€å‘ã€‚</p> 
<p>Â  Â  Â  Â  çœ‹ä¸€ä¸ªä½¿ç”¨baseMapperçš„ä¾‹å­ï¼š</p> 
<p>Â  Â  Â  Â  todo</p> 
<p>Â  Â  Â  Â  ä½†æ˜¯ç›´æ¥ä½¿ç”¨baseMaperçš„è¯ï¼Œæœ‰è®¸å¤šæ“ä½œæˆ‘ä»¬è¿˜éœ€è¦è‡ªå·±å†™ä»£ç ï¼Œæ¯”å¦‚ä¸€äº›æ‰¹é‡æ“ä½œï¼Œå¦‚batchSave(æ‰¹é‡æ’å…¥)ç­‰ã€‚æ‰€ä»¥ï¼Œmybatis-plusè¿˜æä¾›äº†ServiceImplï¼Œæ¥å¸®æˆ‘ä»¬å®ç°è¿™äº›ã€‚</p> 
<p>Â Â Â Â Â Â Â Â ä¸Šé¢çš„ç¼–ç ä¸­ï¼Œæˆ‘ä»¬åœ¨è‡ªå·±çš„ä¸šåŠ¡Serviceä¸­ç»§æ‰¿äº†æŠ½è±¡ç±»ServiceImplï¼ŒServiceImplå®ç°äº†IServiceè¿™ä¸ªæ¥å£ä¸­çš„æ–¹æ³•ï¼Œå¹¶å®šä¹‰äº†å››ä¸ªæˆå‘˜å˜é‡ baseMapperï¼ŒentityClassï¼Œ mapperClassï¼Œlogï¼Œä¸”è¿™å››ä¸ªæˆå‘˜å˜é‡éƒ½æ˜¯protectedçš„ï¼Œå› æ­¤ï¼Œåœ¨æˆ‘ä»¬çš„ä¸šåŠ¡Serviceä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è°ƒç”¨IServiceçš„æ–¹æ³•è¯¸å¦‚saveAndUpdateï¼Œlistï¼Œpageç­‰ï¼Œä¹Ÿå¯ä»¥é€šè¿‡this.baseMapper çš„æ–¹å¼æ¥è·å–baseMapperå¯¹è±¡ï¼Œæ¥è°ƒç”¨baseMapperçš„æ–¹æ³•ã€‚</p> 
<h3>Â  Â  Â  Â  2.ä½¿ç”¨QueryWrapperè¿›è¡ŒæŸ¥è¯¢</h3> 
<p>Â  Â  Â  Â  ä»¥è¯¥serviceä¸ºä¾‹ï¼š<img alt="" height="250" src="https://images2.imgbox.com/5b/ba/w6tH9LHN_o.png" width="968"></p> 
<p>Â Â Â Â Â Â Â Â QueryWrapperæ˜¯æˆ‘ä»¬å·¥ä½œä¸­æ¯å¤©éƒ½å•Šå“Ÿä½¿ç”¨çš„ï¼Œåœºæ™¯éå¸¸å¤šï¼Œæˆ‘åˆ—å‡ºä¸€äº›å¸¸è§çš„åœºæ™¯ï¼Œæ–¹ä¾¿å¤§å®¶æŸ¥é˜…</p> 
<h4>Â  Â  Â  Â  Â  Â  Â  Â  1.1. æ–°å¢</h4> 
<pre><code>        ConfigInfo configInfo = mockData();
        this.baseMapper.insert(configInfo);</code></pre> 
<h4>Â  Â  Â  Â  Â  Â  Â  Â  1.2. åˆ é™¤</h4> 
<pre><code>        LambdaQueryWrapper&lt;ConfigInfo&gt; configInfoQueryWrapper = new LambdaQueryWrapper&lt;&gt;();
        configInfoQueryWrapper.eq(ConfigInfo::getId, 500L);
        this.baseMapper.delete(configInfoQueryWrapper);</code></pre> 
<h4>Â  Â  Â  Â  Â  Â  Â  Â  1.3. ä¿®æ”¹</h4> 
<pre><code>        // æ–¹æ³•1 æ ¹æ®idæ›´æ–°ï¼Œç›´æ¥ä¼ å…¥å¯¹è±¡
        ConfigInfo configInfo = mockData();
        this.baseMapper.updateById(configInfo);

        //æ–¹æ³•2 ä½¿ç”¨wrapperæ›´æ–° setä»£è¡¨è¦ä¿®æ”¹çš„å­—æ®µ eqæ˜¯æ¡ä»¶ä¸ºç›¸ç­‰çš„isi
        UpdateWrapper&lt;ConfigInfo&gt; configInfoUpdateWrapper = Wrappers.update();
        configInfoUpdateWrapper.set("appName","chengxuyuanA");
        configInfoUpdateWrapper.set("groupId", "groupA");
        configInfoUpdateWrapper.eq("id", 500L);
        this.baseMapper.update(configInfoUpdateWrapper);</code></pre> 
<h4 style="background-color:transparent;">Â  Â  Â  Â  Â  Â  Â  Â  1.4. æŸ¥è¯¢</h4> 
<p>Â  Â  Â  Â  Â  Â  Â  Â  åˆ—è¡¨æŸ¥è¯¢</p> 
<p>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ç®€å•æŸ¥è¯¢ï¼ˆç®€å•çš„æ¡ä»¶æŸ¥è¯¢ï¼‰</p> 
<pre><code>        // æŸ¥æ¶¦groupId ä¸º 5001çš„æ•°æ®
        LambdaQueryWrapper&lt;ConfigInfo&gt; configInfoQueryWrapper = new LambdaQueryWrapper&lt;&gt;();
        configInfoQueryWrapper.eq(ConfigInfo::getGroupId, "5001");
        List&lt;ConfigInfo&gt; res = this.baseMapper.selectList(configInfoQueryWrapper);</code></pre> 
<p>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  å¤æ‚æŸ¥è¯¢Â  (åœºæ™¯å¤ªå¤šäº†ï¼Œæˆ‘å°±ç”¨ä¸€ä¸ªåŒ…å« andï¼Œ orï¼Œ in ï¼Œbetween ï¼Œorder by çš„sqlæ¥è¡¨ç¤ºä¸€ä¸‹ç”¨æ³•)</p> 
<pre><code>        // select *
        // from config_info
        // where app_name like '%app%'
        //  and id between 1 and 50
        //  or (src_ip in ('1.0.1.1', '196.123.1.1', '0.0.0.0') and effect is not null)
        LambdaQueryWrapper&lt;ConfigInfo&gt; configInfoQueryWrapper = new LambdaQueryWrapper&lt;&gt;();
        configInfoQueryWrapper.like(ConfigInfo::getAppName, "app")
                        .between(ConfigInfo::getId, 1, 50);
        configInfoQueryWrapper.or(w-&gt;w.in(ConfigInfo::getSrcIp,srcips).isNotNull(ConfigInfo::getEffect));</code></pre> 
<p>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  åˆ†ç»„èšåˆï¼ˆå…¶å®è¿™ä¸ªä¸€èˆ¬ä¸ä¼šç”¨ï¼Œè€ƒè™‘æ€§èƒ½å’Œä¼˜åŒ–ï¼Œèšåˆçš„ä¸œè¥¿ä¸€èˆ¬è‡ªå·±å†™sqlï¼‰</p> 
<pre><code>        LambdaQueryWrapper&lt;ConfigInfo&gt; configInfoQueryWrapper = new LambdaQueryWrapper&lt;&gt;();
        configInfoQueryWrapper.groupBy(ConfigInfo::getGroupId);

        Long res = this.baseMapper.selectCount(configInfoQueryWrapper);</code></pre> 
<p>Â  Â  Â  Â  Â  Â  Â  Â  åˆ†é¡µæŸ¥è¯¢</p> 
<pre><code>        Page page = new Page();
        page.setCurrent(1);
        page.setSize(10);

        LambdaQueryWrapper&lt;ConfigInfo&gt; configInfoQueryWrapper = new LambdaQueryWrapper&lt;&gt;();
        configInfoQueryWrapper.eq(ConfigInfo::getGroupId, "5001");
        IPage&lt;ConfigInfo&gt; pageData = this.page(page, configInfoQueryWrapper);</code></pre> 
<h4>Â  Â  Â  Â  3.è‡ªå®šä¹‰sqlæŸ¥è¯¢</h4> 
<p>Â  Â  Â  Â  Â  Â  Â  Â  3.1.ä½¿ç”¨è‡ªå®šä¹‰sql</p> 
<p>Â  Â  Â  Â  Â  Â  Â  Â  å’Œä½¿ç”¨mybatiså®Œå…¨ä¸€æ ·ï¼Œè¿™é‡Œä¸èµ˜è¿°äº†</p> 
<p>Â  Â  Â  Â  Â  Â  Â  Â  3.2.å¯¹è‡ªå®šä¹‰sqlåˆ†é¡µ</p> 
<p>Â  Â  Â  Â  Â  Â  Â  Â  interfaceå±‚</p> 
<pre><code class="hljs">IPage&lt;ConfigRation&gt; selectUserPage(Page page, @Param("configration") ConfigRation configrationVo);</code></pre> 
<p>Â  Â  Â  Â  Â  Â  Â  Â  åŒmybatisçš„æ­£å¸¸ä½¿ç”¨ï¼Œä½†æ˜¯åœ¨ç¬¬ä¸€ä¸ªå‚æ•°åŠ ä¸Šä¸€ä¸ªPageå…¥å‚</p> 
<h4>Â  Â  Â  Â  4.å­—æ®µæ˜ å°„åŠä¸€äº›æ³¨è§£ä½¿ç”¨æŠ€å·§</h4> 
<h5>Â  Â  Â  Â  Â  Â  Â  Â  æ™®é€šæ˜ å°„</h5> 
<p>Â  Â  Â  Â  Â  Â  Â  Â  é»˜è®¤ä¸éœ€è¦æ³¨è§£ï¼Œåªè¦æŠŠæ•°æ®åº“çš„å­—æ®µçš„_å»æ‰ï¼Œæ¢æˆå°é©¼å³°å°±è¡Œäº†</p> 
<p>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â å¦‚æœéœ€è¦å¯¹è±¡å±æ€§åå’Œæ•°æ®åº“å­—æ®µåç§°ä¸åŒï¼Œå¯ä»¥ç”¨å¦‚ä¸‹æ³¨è§£ï¼š</p> 
<pre><code>@TableField(value = "data_Source")
private String dataType;</code></pre> 
<p>Â  Â  Â  Â  Â  Â  Â  Â  javaå¯¹è±¡çš„å±æ€§åœ¨æ•°æ®åº“ä¸­ä¸å­˜åœ¨</p> 
<pre><code>@TableField(exist = false)
@Schema(description = "æ˜¯å¦ç»‘å®šå‘Šè­¦é€šçŸ¥è§„åˆ™ï¼Œtrueæ˜¯ã€‚falseå¦")
private Boolean isBindNoticeRule;</code></pre> 
<h5>Â  Â  Â  Â  Â  Â  Â  Â  æšä¸¾æ˜ å°„</h5> 
<p>æšä¸¾æ³¨è§£@EnumValueï¼Œéœ€è¦åœ¨æšä¸¾å¯¹è±¡å’Œjavaçš„å®ä½“ç±»ä¸Šéƒ½åŠ ï¼š</p> 
<pre><code>public enum GenderEnum {
   
    MALE(0, "ç”·"),
    FEMALE(1, "å¥³");

    @EnumValue
    private final int code;
    private final String desc;

    GenderEnum(int code, String desc) {
   
        this.code = code;
        this.desc = desc;
    }
}</code></pre> 
<pre><code>@TableName("user")
public class User {
   
    @TableId
    private Long id;

    @TableField("gender")
    @EnumValue
    private GenderEnum gender;

    // çœç•¥å…¶ä»–å±æ€§å’Œæ–¹æ³•
}</code></pre> 
<h5>Â  Â  Â  Â  Â  Â  Â  Â  é€»è¾‘åˆ é™¤æ³¨è§£</h5> 
<p>é€»è¾‘åˆ é™¤éœ€è¦è¿›è¡Œä¸€äº›é…ç½®ï¼š</p> 
<p>step1ï¼šå¢åŠ é…ç½®</p> 
<pre><code>mybatis-plus:
  global-config:
    db-config:
      logic-delete-field: deleted # å…¨å±€é€»è¾‘åˆ é™¤å­—æ®µå
      logic-delete-value: 1 # é€»è¾‘å·²åˆ é™¤å€¼
      logic-not-delete-value: 0 # é€»è¾‘æœªåˆ é™¤å€¼</code></pre> 
<p>step2ï¼šåœ¨å®ä½“ç±»ä¸­ä½¿ç”¨Â <code>@TableLogic</code>Â æ³¨è§£</p> 
<pre><code>public class User {
    // å…¶ä»–å­—æ®µ...

    @TableLogic
    private Integer deleted;
}</code></pre> 
<h5>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â å¤šæ•°æ®æºæ³¨è§£</h5> 
<p>å¤šæ•°æ®æºæ”¯æŒéœ€è¦ä¸€ä¸ªåŒ…Â Â dynamic-datasource</p> 
<p>step1ï¼šmavenå¢åŠ ä¾èµ–</p> 
<pre><code>&lt;dependency&gt;
  &lt;groupId&gt;com.baomidou&lt;/groupId&gt;
  &lt;artifactId&gt;dynamic-datasource-spring-boot-starter&lt;/artifactId&gt;
  &lt;version&gt;${version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre> 
<p>step2ï¼šæ•°æ®æºé…ç½®ï¼š</p> 
<pre><code>spring:
  datasource:
    dynamic:
      primary: master
      strict: false
      datasource:
        master:
          url: jdbc:mysql://xx.xx.xx.xx:3306/dynamic
          username: root
          password: 123456
          driver-class-name: com.mysql.jdbc.Driver
        slave_1:
          url: jdbc:mysql://xx.xx.xx.xx:3307/dynamic
          username: root
          password: 123456
          driver-class-name: com.mysql.jdbc.Driver
        slave_2:
          url: ENC(xxxxx)
          username: ENC(xxxxx)
          password: ENC(xxxxx)
          driver-class-name: com.mysql.jdbc.Driver</code></pre> 
<p>step3ï¼š<strong>ä½¿ç”¨Â <code>@DS</code>Â åˆ‡æ¢æ•°æ®æº</strong></p> 
<pre><code>@Service
@DS("slave")
public class UserServiceImpl implements UserService {

  @Autowired
  private JdbcTemplate jdbcTemplate;

  @Override
  @DS("slave_1")
  public List selectByCondition() {
    return jdbcTemplate.queryForList("select * from user where age &gt;10");
  }
}</code></pre> 
<h5>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â å­—æ®µå¿½ç•¥æ³¨è§£</h5> 
<pre><code>@TableField(exist = false)
private String companyname;</code></pre> 
<h2>å››.å¸¸ç”¨æ’ä»¶</h2> 
<h4>Â  Â  Â  Â 1.æ’ä»¶ä»‹ç»</h4> 
<p>Â  Â  Â  Â  ä»‹ç»ä¸¤ä¸ªæ’ä»¶DataPermissionInterceptorï¼ŒÂ PaginationInnerInterceptor</p> 
<p>Â Â Â Â Â Â Â Â DataPermissionInterceptorï¼š</p> 
<p>Â  Â  Â  Â  æˆ‘ä»¬åœ¨å¼€å‘ä¸­ï¼Œå¾ˆå¤šé¡¹ç›®æœ‰å¤šç§Ÿæˆ·ï¼Œå¤šç»„ç»‡çš„éœ€æ±‚ï¼Œä¸åŒç§Ÿæˆ·å’Œç»„ç»‡èƒ½çœ‹åˆ°çš„æ•°æ®å†…å®¹ä¸åŒã€‚å‡å¦‚ä¸šåŠ¡æ•°æ®æˆ‘ä»¬ç”¨ä¸€ä¸ªå­—æ®µtenent_idåŒºåˆ†ä¸åŒç§Ÿæˆ·çš„æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¸Œæœ›å¼€å‘è€…åœ¨ç¼–ç æ—¶å€™ï¼Œä¸éœ€è¦åˆ»æ„å…³æ³¨è¿™ä¸ªå­—æ®µï¼Œæ­£å¸¸å†™ä¸šåŠ¡é€»è¾‘å°±å¥½ï¼Œæœ‰ä¸€ä¸ªç»Ÿä¸€çš„æ‹¦æˆªå™¨èƒ½å¸®åŠ©æˆ‘ä»¬åœ¨è°ƒç”¨æ•°æ®åº“æ—¶å€™æŠŠ tenent_id = {user_tenent_id} è¿™æ®µsqlåŠ åˆ°æŸ¥è¯¢è¯­å¥ä¸­ï¼ŒDataPermissionInterceptorå°±æ˜¯å¸®æˆ‘ä»¬åšè¿™ä¸ªäº‹æƒ…çš„ã€‚</p> 
<p>Â  Â  Â  Â  å®é™…å¼€å‘ä¸­ï¼ŒåŸºæœ¬æ¶‰åŠåˆ°å¤šç»„ç»‡ï¼Œå¤šç§Ÿæˆ·çš„é¡¹ç›®éƒ½ä¼šä½¿ç”¨è¿™ä¸ªæ’ä»¶ã€‚å¦‚æœå¤§å®¶åœ¨å¼€å‘ä¸­å‘ç°ä½¿ç”¨äº†mybatis-plusçš„é¡¹ç›®é»˜è®¤æ‹¼æ¥äº†ä¸€äº›sqlï¼Œå¯ä»¥å°è¯•æœç´¢DataPermissionInterceptoræ¥æ‰¾ä¸€ä¸‹åŠ çš„åœ°æ–¹ã€‚</p> 
<p>Â Â Â Â Â Â Â Â PaginationInnerInterceptor</p> 
<p>Â Â Â Â Â Â Â Â åˆ†é¡µæ’ä»¶, å¯¹äºå•ä¸€æ•°æ®åº“ç±»å‹æ¥è¯´,éƒ½å»ºè®®é…ç½®è¯¥å€¼,é¿å…æ¯æ¬¡åˆ†é¡µéƒ½å»æŠ“å–æ•°æ®åº“ç±»å‹ï¼Œä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œç›´æ¥new PaginationInnerInterceptor(dataTypeå°±å¥½)</p> 
<h4>Â  Â  Â  Â  2.å®æˆ˜ä½¿ç”¨</h4> 
<p>step1ï¼š æ³¨å†Œæ‹¦æˆªå™¨ï¼ŒåŠ å…¥äº†ä¸Šé¢ä»‹ç»çš„ä¿©æ’ä»¶</p> 
<pre><code>@Configuration
public class MybatisAutoConfiguration implements WebMvcConfigurer {

	@Bean
	public MybatisPlusInterceptor mybatisPlusInterceptor(@Autowired(required = false) DataPermissionHandler dataPermissionHandler) {
		MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor();
		if (dataPermissionHandler != null) {
			interceptor.addInnerInterceptor(new DataPermissionInterceptor(dataPermissionHandler));
		}
		interceptor.addInnerInterceptor(new PaginationInnerInterceptor(DbType.POSTGRE_SQL));
		return interceptor;
	}
}</code></pre> 
<p>Â step2:DataPermissionHandlerç¼–ç </p> 
<pre><code>public class DataPermissionHandler extends MultiDataPermissionHandler {
    @Override
    public Expression getSqlSegment(Table table, Expression where, String mappedStatementId) {
        // åœ¨æ­¤å¤„ç¼–å†™è‡ªå®šä¹‰æ•°æ®æƒé™é€»è¾‘
        try {
            String sqlSegment = "..."; // æ•°æ®æƒé™ç›¸å…³çš„ SQL ç‰‡æ®µ
            return CCJSqlParserUtil.parseCondExpression(sqlSegment);
        } catch (JSQLParserException e) {
            e.printStackTrace();
            return null;
        }
    }
}</code></pre> 
<h2>äº”.ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨</h2> 
<h4>Â Â Â Â Â Â Â Â å…³äºä»£ç ç”Ÿæˆå™¨</h4> 
<p>Â  Â  Â  Â  ä»£ç ç”Ÿæˆå™¨åœ¨å·¥ä½œä¸­å…¶å®å¾ˆå¸¸ç”¨ï¼Œæ‰€ä»¥æˆ‘è§‰å¾—ä¸äº†è§£çš„é“å‹è¿˜æ˜¯éœ€è¦äº†è§£ä¸€ä¸‹ã€‚</p> 
<h4>Â Â Â Â Â Â Â Â 1.ä»£ç ç”Ÿæˆå™¨é…ç½®</h4> 
<p>Â  Â  Â  Â  æˆ‘ä½¿ç”¨çš„mybatis-plusæ˜¯3.5.7ï¼Œä½äº3.5ç‰ˆæœ¬çš„è¯ï¼Œå¯èƒ½ç•¥æœ‰ä¸åŒ</p> 
<p>Â  Â  Â  Â  step1ï¼šå¼•å…¥ä¸¤ä¸ªä¾èµ–åŒ…ï¼š</p> 
<pre><code>        &lt;dependency&gt;
            &lt;groupId&gt;com.baomidou&lt;/groupId&gt;
            &lt;artifactId&gt;mybatis-plus-generator&lt;/artifactId&gt;
            &lt;version&gt;3.5.7&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!-- freemarkeræ¨¡æ¿ --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-freemarker&lt;/artifactId&gt;
            &lt;version&gt;3.1.2&lt;/version&gt;
        &lt;/dependency&gt;</code></pre> 
<p>Â  Â  Â  Â step2ï¼šåˆ›å»ºä¸€ä¸ªjavaç±»ï¼Œç”¨æ¥ç”Ÿæˆä»£ç ï¼Œæˆ‘ä¸€èˆ¬å–œæ¬¢åœ¨é¡¹ç›®ä¸­å»ºä¸€ä¸ªdevæ–‡ä»¶å¤¹ï¼Œæ”¾ä¸€äº›å¼€å‘å·¥å…·</p> 
<p>Â  Â  Â  Â  ç»“æ„å¦‚å›¾ï¼š<img alt="" height="651" src="https://images2.imgbox.com/0b/a7/hmxHAoV6_o.png" width="1197"></p> 
<p>ä»£ç ï¼š</p> 
<pre><code class="language-java">public class CodeGenerator {

    public static void main(String[] args) {
        FastAutoGenerator.create("jdbc:mysql://192.168.**.**:3306/rui",
                        "root",
                        "******")
                .globalConfig(builder -&gt; builder
                        .author("rui")
                        .outputDir(Paths.get(System.getProperty("user.dir")) +
                                "/services/admin-server" +
                                "/src/main/java")
                        .commentDate("yyyy-MM-dd")
                )
                .packageConfig(builder -&gt; builder
                        .parent("com.rui")
                        .entity("entity")
                        .mapper("mapper")
                        .service("service")
                        .serviceImpl("service.impl")
                        .xml("mapper.xml")
                )
                .strategyConfig(builder -&gt; builder
                        // è¦ç”Ÿæˆä»£ç çš„è¡¨åç§°ï¼Œä¸åŠ ä¸‹é¢è¿™è¡Œå°±æ˜¯å…¨åº“ç”Ÿæˆ
                        .addInclude("config_info") 
                        .entityBuilder()
                        .enableLombok()
                )
                .templateEngine(new FreemarkerTemplateEngine())
                .execute();
    }

}</code></pre> 
<h4>Â Â Â Â Â Â Â Â 2.ä»£ç ç”Ÿæˆå™¨ä½¿ç”¨</h4> 
<p>Â  Â  Â  Â  ç›´æ¥å³é”®æ‰§è¡Œå³å¯ï¼Œæ‰§è¡Œåå°±ä¼šåœ¨é¡¹ç›®ä¸­ç”Ÿæˆå¯¹åº”æ–‡ä»¶ã€‚é»˜è®¤çš„æ¨¡æ¿controllerï¼Œserviceä¸­æ˜¯æ²¡æœ‰æ–¹æ³•çš„ï¼Œå¯ä»¥è‡ªå·±é…ç½®ä¸€ä¸‹æ¨¡æ¿ï¼Œæ”¾ä¸€äº›å’Œå‰ç«¯äº¤äº’çš„CRUDã€‚</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b06dc10ea1332a1ea1a59f3f40e78e56/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ˆå †ï¼‰å­¦çš„å¥½ï¼Œå¤´å‘æ‰çš„å°‘(Javaç‰ˆ)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a12be63121323d444dc7042b842672fc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">è®¡ç®—æœºç½‘ç»œâ€”â€”æ•°æ®é“¾è·¯å±‚ï¼ˆç‚¹å¯¹ç‚¹åè®®PPPï¼‰</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§å’–.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>