<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>从头开始学习扩散模型 Stable Diffusion - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/8a2cd77d9dff66b1528a979106313f7a/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="从头开始学习扩散模型 Stable Diffusion">
  <meta property="og:description" content="今天我们来揭开 Stable Diffusion 技术的神秘面纱。
1.稳定扩散原理 Stable Diffusion 在2022年发表，一种基于Latent Diffusion Models的新兴机器学习技术。它基于扩散过程，利用数学模型将机器学习中的高维度数据降低到低维度空间，并在该空间中进行训练。Stable Diffusion的原理涉及到以下三个组件：
Text Encoder 文字特征化：为了输入文字的内容，我们要先有一个powerful的文字特征萃取器，可以是GPT、BERT等常见的主流Transformer model，总之能把文字特征做得好，就好的是Encoder 。
Diffusion Model 扩散模型：透过降躁过程，将一个潜在空间Latent Space的图像，逐步转回真实图像的技术，里面用到U-Net架构及Attenation技术，来提高模型表现，与传统的Diffusion略有不同。
VAE (Variational Autoencoder)：变分自编码器，负责图像在潜在空间的压缩与重建，压缩后的图像能让模型学得更快更好。
以功能来切，大概可以这样理解 以模型的学习与训练来看，可以这样理解：
将高维特征压缩到低维，然后在低维空间上进行操作的方法具有泛用性，可以很容易推广到文本、音频、影像等数据。
Stable Diffusion模型中，有几种不同的sampling方法可以用来生成数据，以下是一些常见的sampling方法：
Gaussian sampling：是Stable Diffusion中最常用的一种sampling方法。它通过将高斯噪声添加到数据中来生成新的样本。这种方法可以帮助模型更好地理解数据的分布和特征。
Langevin sampling：一种基于随机梯度下降的sampling方法。它通过将随机噪声添加到梯度中来生成新的样本。这种方法可以帮助模型更好地处理高度非线性的数据。
Metropolis-Hastings sampling：一种Markov Chain Monte Carlo（MCMC）方法，它可以生成一个序列来表示数据的分布。这种方法可以帮助模型更好地理解数据的复杂性和不确定性。
Hamiltonian Monte Carlo sampling：一种MCMC方法，它可以利用动态系统的特性来生成数据样本。这种方法可以帮助模型更好地理解数据中的隐含结构和特征。
Diffusion Process Model：DPM是基于扩散过程的理论原理，通过对数据样本中的噪声进行建模，可以帮助消除数据中的噪声和偏差，提高模型的准确性和泛化能力。
这些方法在Stable Diffusion的参数中都可以调整，其中Sampling step更会影响图片生成的运算时间及效果，原则上会根据采样方法不同而有所差异。
2.Dreambooth 原理 Google 在2022年提出的技术，可以保留你想想要的图片特征，基于 GAN 模型的核心思想，即通过将生成器和判别器部分相互对抗，从而提高生成器生成图像的质量和真实度。在Dreambooth中，生成器部分利用深度学习技术从文字描述中学习生成图像的能力，而判别器部分则利用深度学习技术评估图像的真实度，从而驱动生成器不断地优化生成图像的效果。
透过对Stable Diffusion的微调，让图片可以在保留特征的情况下生成更多样式，这也是近期很多艺术家反弹的艺术风格道德问题，如果你喜欢某个画师的风格，就能用这个技术将之模仿并创作。 如Civitai上的Checkpoint Model，就是Stable Diffusion用来生成图片的主模型，可以快速找到你想要的风格。 3.LoRA 原理 Low-rank adaptation of large language models，又称 LoRA，微软开发的局部调整模型，非常轻量，可以在Stable Diffusion主模型的基础上，增加局部特征。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-10T10:17:21+08:00">
    <meta property="article:modified_time" content="2024-07-10T10:17:21+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">从头开始学习扩散模型 Stable Diffusion</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>        今天我们来揭开 Stable Diffusion 技术的神秘面纱。</p> 
<h3>1.稳定扩散原理</h3> 
<p>        Stable Diffusion 在2022年发表，一种基于Latent Diffusion Models的新兴机器学习技术。它基于扩散过程，利用数学模型将机器学习中的高维度数据降低到低维度空间，并在该空间中进行训练。Stable Diffusion的原理涉及到以下三个组件：</p> 
<ol><li> <p>Text Encoder 文字特征化：为了输入文字的内容，我们要先有一个powerful的文字特征萃取器，可以是GPT、BERT等常见的主流Transformer model，总之能把文字特征做得好，就好的是Encoder 。</p> </li><li> <p>Diffusion Model 扩散模型：透过降躁过程，将一个潜在空间Latent Space的图像，逐步转回真实图像的技术，里面用到U-Net架构及Attenation技术，来提高模型表现，与传统的Diffusion略有不同。</p> </li><li> <p>VAE (Variational Autoencoder)：变分自编码器，负责图像在潜在空间的压缩与重建，压缩后的图像能让模型学得更快更好。<img alt="" height="433" src="https://images2.imgbox.com/12/7d/rrFOsT4w_o.png" width="847"></p> </li></ol> 
<p>        以功能来切，大概可以这样理解 </p> 
<p><img alt="" height="422" src="https://images2.imgbox.com/ea/84/BSPqehHG_o.png" width="842"></p> 
<p>以模型的学习与训练来看，可以这样理解：</p> 
<p><img alt="" height="410" src="https://images2.imgbox.com/0a/23/15k1MKK5_o.png" width="823">        将高维特征压缩到低维，然后在低维空间上进行操作的方法具有泛用性，可以很容易推广到文本、音频、影像等数据。</p> 
<p><img alt="" height="561" src="https://images2.imgbox.com/23/fd/6MA7QoeI_o.png" width="855"></p> 
<p>        Stable Diffusion模型中，有几种不同的sampling方法可以用来生成数据，以下是一些常见的sampling方法：</p> 
<ol><li> <p>Gaussian sampling：是Stable Diffusion中最常用的一种sampling方法。它通过将高斯噪声添加到数据中来生成新的样本。这种方法可以帮助模型更好地理解数据的分布和特征。</p> </li><li> <p>Langevin sampling：一种基于随机梯度下降的sampling方法。它通过将随机噪声添加到梯度中来生成新的样本。这种方法可以帮助模型更好地处理高度非线性的数据。</p> </li><li> <p>Metropolis-Hastings sampling：一种Markov Chain Monte Carlo（MCMC）方法，它可以生成一个序列来表示数据的分布。这种方法可以帮助模型更好地理解数据的复杂性和不确定性。</p> </li><li> <p>Hamiltonian Monte Carlo sampling：一种MCMC方法，它可以利用动态系统的特性来生成数据样本。这种方法可以帮助模型更好地理解数据中的隐含结构和特征。</p> </li><li> <p>Diffusion Process Model：DPM是基于扩散过程的理论原理，通过对数据样本中的噪声进行建模，可以帮助消除数据中的噪声和偏差，提高模型的准确性和泛化能力。</p> </li></ol> 
<p>        这些方法在Stable Diffusion的参数中都可以调整，其中Sampling step更会影响图片生成的运算时间及效果，原则上会根据采样方法不同而有所差异。</p> 
<h3>2.Dreambooth 原理</h3> 
<p>        Google 在2022年提出的技术，可以保留你想想要的图片特征，基于 GAN 模型的核心思想，即通过将生成器和判别器部分相互对抗，从而提高生成器生成图像的质量和真实度。在Dreambooth中，生成器部分利用深度学习技术从文字描述中学习生成图像的能力，而判别器部分则利用深度学习技术评估图像的真实度，从而驱动生成器不断地优化生成图像的效果。</p> 
<p><img alt="" height="402" src="https://images2.imgbox.com/31/e2/CHDc0sZy_o.png" width="882"></p> 
<p>        透过对Stable Diffusion的微调，让图片可以在保留特征的情况下生成更多样式，这也是近期很多艺术家反弹的艺术风格道德问题，如果你喜欢某个画师的风格，就能用这个技术将之模仿并创作。 </p> 
<p><img alt="" height="462" src="https://images2.imgbox.com/7e/43/0ZXK9Ymf_o.png" width="585"></p> 
<p>        如Civitai上的Checkpoint Model，就是Stable Diffusion用来生成图片的主模型，可以快速找到你想要的风格。 </p> 
<p><img alt="" height="445" src="https://images2.imgbox.com/35/bd/OOMbWMIN_o.png" width="856"></p> 
<h3>3.LoRA 原理 </h3> 
<p>        Low-rank adaptation of large language models，又称 LoRA，微软开发的局部调整模型，非常轻量，可以在Stable Diffusion主模型的基础上，增加局部特征。</p> 
<p><img alt="" height="377" src="https://images2.imgbox.com/d1/22/27EbCs0I_o.png" width="512"></p> 
<p>        主要原理是将低秩矩阵分解应用到大型语言模型中，将模型中的权重矩阵分解成低秩的两个矩阵，从而减少存储需求和计算成本。此外模型还通过自适应学习的方法来调整模型的参数，以更好地适应不同的语言模型和文本数据。</p> 
<p>        如Civitai上的LoRA Model，就能将想要的风格加进主模型中，你就可以建立各种表情、服装的Tifa之类的。</p> 
<p><img alt="" height="437" src="https://images2.imgbox.com/79/02/Q6O4tdST_o.png" width="877"></p> 
<h3>4.ControlNet 原理</h3> 
<p>        ControlNet 模型通常由两个部分组成：一个称为系统动态的部分，用于处理非线性问题，另一个称为控制器的部分，用于调节模型的输出。控制器的输出可以根据系统动态的状态和期望输出值进行调整，从而提高模型的性能和准确度。</p> 
<p><img alt="" height="720" src="https://images2.imgbox.com/86/eb/ROYSgO2l_o.png" width="851">        ControlNet 应该是 Stable Diffusion 目前最夯的应用，主要可以控制人物的动作，或是物体结构，不需要打一堆咒语，快速让AI懂你要的东西。</p> 
<p><img alt="" height="491" src="https://images2.imgbox.com/05/9b/SJdKkm7a_o.png" width="853"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c44cbe278fabeafff9554996ab26ac54/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">JavaScript获取URL参数的几种方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1c8dd1c5cd8a3656be9d4890e6a124a8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">react 的条件渲染</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>