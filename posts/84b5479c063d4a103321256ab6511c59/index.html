<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Java生成RSA公私钥文件(pem格式和der格式) - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/84b5479c063d4a103321256ab6511c59/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Java生成RSA公私钥文件(pem格式和der格式)">
  <meta property="og:description" content="有朋友私信我说，帖子（使用原生Java实现RSA加解密-非对称加密-CSDN博客）中生成RSA公钥、私钥是借助Linux命令完成的，那么Java代码能不能生成呢？笔者在这里明确告知答案：可以。
本篇（纯干货，完整代码）笔者将列出几种使用Java生成非对称加密算法RSA的公钥、私钥文件方法供大家参考。本篇介绍将会生成两种格式的公私钥文件，分别是pem格式、der格式。
方法一、使用原生Java API 1、使用原生Java生成pem格式的RSA公私钥文件 package com.frank.project.test.rsa; import java.io.FileWriter; import java.io.IOException; import java.security.Key; import java.security.KeyPair; import java.security.KeyPairGenerator; import java.util.Base64; /** * 原生Java生成RSA公私钥文件 */ public class PureJavaGenerateRSAKey { public static void main(String[] args) throws Exception { generateRSAPemKeyFiles(); } /** * 生成RSA pem格式的公私钥文件 * * @throws Exception */ private static void generateRSAPemKeyFiles() throws Exception { KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(&#34;RSA&#34;); keyPairGenerator.initialize(4096); KeyPair keyPair = keyPairGenerator.generateKeyPair(); savePrivatePemFile(keyPair.getPrivate(), &#34;D:/private_key_pure_java.pem&#34;); savePublicPemFile(keyPair.getPublic(), &#34;D:/public_key_pure_java.pem&#34;); } private static void savePrivatePemFile(Key key, String filename) throws IOException { String encoded = Base64.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-04T20:57:02+08:00">
    <meta property="article:modified_time" content="2024-03-04T20:57:02+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Java生成RSA公私钥文件(pem格式和der格式)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>有朋友私信我说，帖子（<a href="https://blog.csdn.net/u014137486/article/details/136413532" title="使用原生Java实现RSA加解密-非对称加密-CSDN博客">使用原生Java实现RSA加解密-非对称加密-CSDN博客</a>）中生成RSA公钥、私钥是借助Linux命令完成的，那么Java代码能不能生成呢？笔者在这里明确告知答案：可以。</p> 
<p>本篇（<span style="color:#fe2c24;"><strong>纯干货</strong>，完整代码</span>）笔者将列出几种使用Java生成非对称加密算法RSA的公钥、私钥文件方法供大家参考。本篇介绍将会生成两种格式的公私钥文件，分别是<span style="color:#956fe7;">pem格式</span>、<span style="color:#1c7331;">der格式</span>。</p> 
<h2>方法一、使用原生Java API</h2> 
<h3>1、使用原生Java生成<span style="color:#956fe7;">pem</span>格式的RSA公私钥文件</h3> 
<pre><code class="language-java">package com.frank.project.test.rsa;

import java.io.FileWriter;
import java.io.IOException;
import java.security.Key;
import java.security.KeyPair;
import java.security.KeyPairGenerator;
import java.util.Base64;

/**
 * 原生Java生成RSA公私钥文件
 */
public class PureJavaGenerateRSAKey {
	public static void main(String[] args) throws Exception {
		generateRSAPemKeyFiles();
	}

	/**
	 * 生成RSA pem格式的公私钥文件
	 * 
	 * @throws Exception
	 */
	private static void generateRSAPemKeyFiles() throws Exception {
		KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance("RSA");
		keyPairGenerator.initialize(4096);
		KeyPair keyPair = keyPairGenerator.generateKeyPair();

		savePrivatePemFile(keyPair.getPrivate(), "D:/private_key_pure_java.pem");
		savePublicPemFile(keyPair.getPublic(), "D:/public_key_pure_java.pem");
	}

	private static void savePrivatePemFile(Key key, String filename)
			throws IOException {
		String encoded = Base64.getEncoder().encodeToString(key.getEncoded());

		FileWriter fileWriter = null;
		try {
			fileWriter = new FileWriter(filename);
			fileWriter.write("-----BEGIN PRIVATE KEY-----\n");
			fileWriter.write(encoded);
			fileWriter.write("\n-----END PRIVATE KEY-----");
		} finally {
			if (null != fileWriter) {
				fileWriter.close();
			}
		}
	}

	private static void savePublicPemFile(Key key, String filename)
			throws IOException {
		String encoded = Base64.getEncoder().encodeToString(key.getEncoded());

		FileWriter fileWriter = null;
		try {
			fileWriter = new FileWriter(filename);
			fileWriter.write("-----BEGIN PUBLIC KEY-----\n");
			fileWriter.write(encoded);
			fileWriter.write("\n-----END PUBLIC KEY-----");
		} finally {
			if (null != fileWriter) {
				fileWriter.close();
			}
		}
	}
}
</code></pre> 
<h3>2、使用原生Java生成<span style="color:#1c7331;">der</span>格式的RSA公私钥文件</h3> 
<pre><code class="language-java">import java.io.DataOutputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.security.Key;
import java.security.KeyPair;
import java.security.KeyPairGenerator;

...

/**
 * 生成RSA der格式的公私钥文件
 */
private static void generateRSADerKeyFiles() throws Exception {
	KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance("RSA");
	keyPairGenerator.initialize(2048);
	KeyPair keyPair = keyPairGenerator.generateKeyPair();

	saveRSADerFile(keyPair.getPrivate(), "D:/private_key_pure_java.der");
	saveRSADerFile(keyPair.getPublic(), "D:/public_key_pure_java.der");
}

private static void saveRSADerFile(Key key, String filename)
		throws IOException {
	byte[] keyBytes = key.getEncoded();
	try (DataOutputStream dos = new DataOutputStream(new FileOutputStream(
			filename))) {
		dos.write(keyBytes);
	}
}
</code></pre> 
<h2>方法二、使用bouncycastle工具API</h2> 
<p>maven需引入一下包，</p> 
<pre><code class="language-html">&lt;dependency&gt;
    &lt;groupId&gt;org.bouncycastle&lt;/groupId&gt;
    &lt;artifactId&gt;bcprov-jdk18on&lt;/artifactId&gt;
    &lt;version&gt;1.77&lt;/version&gt;
&lt;/dependency&gt;
</code></pre> 
<h3>1、Java使用bouncycastle工具包生成<span style="color:#956fe7;">pem</span>格式的RSA公私钥文件</h3> 
<pre><code class="language-java">package com.frank.project.test.rsa;

import java.io.FileWriter;
import java.io.IOException;
import java.security.Key;
import java.security.KeyPair;
import java.security.KeyPairGenerator;

import org.bouncycastle.openssl.jcajce.JcaPEMWriter;
import org.bouncycastle.util.io.pem.PemObject;

public class BouncyCastleGenerateRSAKey {
	public static void main(String[] args) throws Exception {
		generateRSAPemKeyFiles();
	}

	/**
	 * 生成RSA pem格式的公私钥文件
	 */
	private static void generateRSAPemKeyFiles() throws Exception {
		KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance("RSA");
		keyPairGenerator.initialize(4096);
		KeyPair keyPair = keyPairGenerator.generateKeyPair();

		savePrivatePemFile(keyPair.getPrivate(), "D:/private_key_bouncycastle.pem");
		savePublicPemFile(keyPair.getPublic(), "D:/public_key_bouncycastle.pem");
	}

	private static void savePrivatePemFile(Key key, String filename)
			throws IOException {
		PemObject pemObject = new PemObject("PRIVATE KEY", key.getEncoded());
		try (JcaPEMWriter pemWriter = new JcaPEMWriter(new FileWriter(filename))) {
			pemWriter.writeObject(pemObject);
		}
	}

	private static void savePublicPemFile(Key key, String filename)
			throws IOException {
		PemObject pemObject = new PemObject("PUBLIC KEY", key.getEncoded());
		try (JcaPEMWriter pemWriter = new JcaPEMWriter(new FileWriter(filename))) {
			pemWriter.writeObject(pemObject);
		}
	}
}
</code></pre> 
<h3><br> 2、Java使用bouncycastle工具包生成<span style="color:#1c7331;">der</span>格式的RSA公私钥文件</h3> 
<pre><code class="language-java">package com.frank.project.test.rsa;

import java.io.FileOutputStream;
import java.io.IOException;
import java.security.Key;
import java.security.KeyPair;
import java.security.KeyPairGenerator;
import java.security.PrivateKey;

import org.bouncycastle.asn1.pkcs.PrivateKeyInfo;
import org.bouncycastle.asn1.x509.SubjectPublicKeyInfo;

public class BouncyCastleGenerateDerRSAKey {
	public static void main(String[] args) throws Exception {
		KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance("RSA");
		keyPairGenerator.initialize(4096);
		KeyPair keyPair = keyPairGenerator.generateKeyPair();

		saveDerFile(keyPair.getPrivate(), "D:/private_key_bouncycastle.der");
		saveDerFile(keyPair.getPublic(), "D:/public_key_bouncycastle.der");
	}

	private static void saveDerFile(Key key, String filename)
			throws IOException {
		byte[] keyBytes;
		// it's different for private key(pkcs), public key(x509)
		if (key instanceof PrivateKey) {
			keyBytes = PrivateKeyInfo.getInstance(key.getEncoded())
					.getEncoded();
		} else {
			keyBytes = SubjectPublicKeyInfo.getInstance(key.getEncoded())
					.getEncoded();
		}

		try (FileOutputStream fos = new FileOutputStream(filename)) {
			fos.write(keyBytes);
		}
	}
}
</code></pre> 
<h2>方法三、使用Hutool工具API</h2> 
<p>需引入以下依赖，</p> 
<pre><code class="language-html">&lt;dependency&gt;
	&lt;groupId&gt;cn.hutool&lt;/groupId&gt;
	&lt;artifactId&gt;hutool-all&lt;/artifactId&gt;
	&lt;version&gt;5.8.26&lt;/version&gt;
&lt;/dependency&gt;
</code></pre> 
<h3>1、Java使用Hutool工具包生成<span style="color:#956fe7;">pem</span>格式的RSA公私钥文件</h3> 
<pre><code class="language-java">package com.frank.project.test.rsa;

import java.io.FileWriter;
import java.io.IOException;
import java.security.Key;
import java.security.KeyPair;
import java.security.PrivateKey;
import java.util.Base64;

import cn.hutool.crypto.SecureUtil;

public class HutoolGeneratePemRSAKey {
	public static void main(String[] args) throws Exception {
		// use hutool's SecureUtil API generate private key, public key
		KeyPair keyPair = SecureUtil.generateKeyPair("RSA", 4096, null);
		savePemFile(keyPair.getPrivate(), "D:/private_key_hutool.pem");
		savePemFile(keyPair.getPublic(), "D:/public_key_hutool.pem");
	}

	private static void savePemFile(Key key, String filename)
			throws IOException {
		String encodedKey = Base64.getEncoder()
				.encodeToString(key.getEncoded());
		String keyType = (key instanceof PrivateKey) ? "PRIVATE KEY"
				: "PUBLIC KEY";

		try (FileWriter writer = new FileWriter(filename)) {
			writer.write("-----BEGIN " + keyType + "-----\n");
			writer.write(encodedKey);
			writer.write("\n-----END " + keyType + "-----");
			writer.flush();
		}
	}
}

</code></pre> 
<h3><br> 2、Java使用Hutool工具包生成<span style="color:#1c7331;">der</span>格式的RSA公私钥文件</h3> 
<pre><code class="language-java">package com.frank.project.test.rsa;

import java.security.KeyPair;

import cn.hutool.core.io.FileUtil;
import cn.hutool.crypto.SecureUtil;

public class HutoolGenerateDerRSAKey {
	public static void main(String[] args) {
        // 生成RSA密钥对
        KeyPair keyPair = SecureUtil.generateKeyPair("RSA", 4096, null);

        // 将公钥和私钥写入到DER文件
        FileUtil.writeBytes(keyPair.getPublic().getEncoded(), "D:/public_key_hutool.der");
        FileUtil.writeBytes(keyPair.getPrivate().getEncoded(), "D:/private_key_hutool.der");
    }
}
</code></pre> 
<p><br>  </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3b42260a20affac992245ec3fe66d181/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Fastwhisper &#43; Pyannote 实现 ASR &#43; 说话者识别</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/90680e447158580c85218fc82953e386/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MySQL常见字段类型长度汇总</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>