<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>è¶…çº§è¯¦ç»†Spring AI&#43;ChatGPTï¼ˆjavaæ¥å…¥OpenAIå¤§æ¨¡å‹ï¼‰ - ç¼–ç¨‹å¤§å’–</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/87015c11295f0a902dda0080bb9bc7c0/">
  <meta property="og:site_name" content="ç¼–ç¨‹å¤§å’–">
  <meta property="og:title" content="è¶…çº§è¯¦ç»†Spring AI&#43;ChatGPTï¼ˆjavaæ¥å…¥OpenAIå¤§æ¨¡å‹ï¼‰">
  <meta property="og:description" content="Spring AI å¯¹æ¥å„ç§AIå¤§æ¨¡å‹ï¼ˆAIå·¥ç¨‹é¢†åŸŸçš„åº”ç”¨ç¨‹åºæ¡†æ¶ï¼‰
å‰æœŸå‡†å¤‡ API-Key:sk-3sfER03LDLG3SDFsdlwe283JSdw023lkrmrHDND32fmREKFD
ï¼ˆæ ¼å¼é•¿è¿™æ ·ï¼Œè¿™ä¸ªä¸å¯ç”¨ï¼‰
å…è´¹ä½¿ç”¨
ğŸš€ç”³è¯·é¢†å–å†…æµ‹å…è´¹API Keyå…è´¹ç‰ˆæ”¯æŒgpt-3.5-turbo, embedding, gpt-4ã€‚å…¶ä¸­gpt-4ç”±äºä»·æ ¼è¿‡é«˜ï¼Œæ¯24å°æ—¶é™åˆ¶10æ¬¡è°ƒç”¨ï¼Œä¸”ä¸æ”¯æŒæµå¼ä¼ è¾“ã€‚éœ€è¦æ›´ç¨³å®šå¿«é€Ÿçš„gpt-4è¯·ä½¿ç”¨ä»˜è´¹ç‰ˆã€‚è½¬å‘Host1:Â https://api.chatanywhere.techÂ (å›½å†…ä¸­è½¬ï¼Œå»¶æ—¶æ›´ä½ï¼Œhost1å’Œhost2äºŒé€‰ä¸€)è½¬å‘Host2:Â https://api.chatanywhere.com.cnÂ (å›½å†…ä¸­è½¬ï¼Œå»¶æ—¶æ›´ä½ï¼Œhost1å’Œhost2äºŒé€‰ä¸€)è½¬å‘Host3:Â https://api.chatanywhere.cnÂ (å›½å¤–ä½¿ç”¨,å›½å†…éœ€è¦å…¨å±€ä»£ç†) åˆ›å»ºé¡¹ç›® â€‹
â€‹
pomæ–‡ä»¶é…ç½® &lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt; &lt;project xmlns=&#34;http://maven.apache.org/POM/4.0.0&#34; xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34; xsi:schemaLocation=&#34;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&#34;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;3.2.5&lt;/version&gt; &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt; &lt;/parent&gt; &lt;groupId&gt;com.zzq&lt;/groupId&gt; &lt;artifactId&gt;spring-ai-chat01&lt;/artifactId&gt; &lt;!-- å¿«ç…§ç‰ˆæœ¬--&gt; &lt;version&gt;1.0.1-SNAPSHOT&lt;/version&gt; &lt;name&gt;spring-ai-chat01&lt;/name&gt; &lt;description&gt;spring-ai-chat01&lt;/description&gt; &lt;properties&gt; &lt;java.version&gt;17&lt;/java.version&gt; &lt;spring-ai.version&gt;1.0.0-SNAPSHOT&lt;/spring-ai.version&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- spring ai-starterä¾èµ– å¯åŠ¨ä¾èµ–--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.ai&lt;/groupId&gt; &lt;artifactId&gt;spring-ai-openai-spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-04T10:39:33+08:00">
    <meta property="article:modified_time" content="2024-06-04T10:39:33+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§å’–" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§å’–</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">è¶…çº§è¯¦ç»†Spring AI&#43;ChatGPTï¼ˆjavaæ¥å…¥OpenAIå¤§æ¨¡å‹ï¼‰</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2><span style="color:#fe2c24;"><strong>Spring AI</strong></span></h2> 
<p>å¯¹æ¥å„ç§AIå¤§æ¨¡å‹ï¼ˆAIå·¥ç¨‹é¢†åŸŸçš„åº”ç”¨ç¨‹åºæ¡†æ¶ï¼‰</p> 
<p><img alt="" height="481" src="https://images2.imgbox.com/47/97/dB0eehLo_o.png" width="1010"><img alt="" height="400" src="https://images2.imgbox.com/13/2b/z8wULcBu_o.png" width="697"></p> 
<p><img alt="" height="386" src="https://images2.imgbox.com/9a/09/Cic2l9Ml_o.png" width="983"></p> 
<p><img alt="" height="387" src="https://images2.imgbox.com/ed/da/jRFMZjMD_o.png" width="959"></p> 
<p><img alt="" height="362" src="https://images2.imgbox.com/79/99/fPEuO5CV_o.png" width="967"></p> 
<p><img alt="" height="191" src="https://images2.imgbox.com/dd/72/ZBqxSaw2_o.png" width="957"></p> 
<h2><span style="color:#fe2c24;"><strong>å‰æœŸå‡†å¤‡</strong></span></h2> 
<p><img alt="" height="180" src="https://images2.imgbox.com/2a/d4/fs2g96y0_o.png" width="886"></p> 
<p><span style="color:#ff9900;"><strong>API-Key:</strong></span><span style="color:#956fe7;"><strong>sk-3sfER03LDLG3SDFsdlwe283JSdw023lkrmrHDND32fmREKFD</strong></span></p> 
<p><span style="color:#956fe7;"><strong>ï¼ˆæ ¼å¼é•¿è¿™æ ·ï¼Œè¿™ä¸ªä¸å¯ç”¨ï¼‰</strong></span></p> 
<p id="å…è´¹ä½¿ç”¨">å…è´¹ä½¿ç”¨</p> 
<ul><li><strong>ğŸš€<strong><strong><strong><a href="https://api.chatanywhere.org/v1/oauth/free/github/render" rel="nofollow" title="ç”³è¯·é¢†å–å†…æµ‹å…è´¹API Key">ç”³è¯·é¢†å–å†…æµ‹å…è´¹API Key</a></strong></strong></strong></strong></li><li>å…è´¹ç‰ˆæ”¯æŒgpt-3.5-turbo, embedding, gpt-4ã€‚å…¶ä¸­gpt-4ç”±äºä»·æ ¼è¿‡é«˜ï¼Œæ¯24å°æ—¶é™åˆ¶10æ¬¡è°ƒç”¨ï¼Œä¸”ä¸æ”¯æŒæµå¼ä¼ è¾“ã€‚éœ€è¦æ›´ç¨³å®šå¿«é€Ÿçš„gpt-4è¯·ä½¿ç”¨ä»˜è´¹ç‰ˆã€‚</li><li><strong>è½¬å‘Host1:Â <code>https://api.chatanywhere.tech</code>Â (å›½å†…ä¸­è½¬ï¼Œå»¶æ—¶æ›´ä½ï¼Œhost1å’Œhost2äºŒé€‰ä¸€)</strong></li><li><strong>è½¬å‘Host2:Â <code>https://api.chatanywhere.com.cn</code>Â (å›½å†…ä¸­è½¬ï¼Œå»¶æ—¶æ›´ä½ï¼Œhost1å’Œhost2äºŒé€‰ä¸€)</strong></li><li><strong>è½¬å‘Host3:Â <code>https://api.chatanywhere.cn</code>Â (å›½å¤–ä½¿ç”¨,å›½å†…éœ€è¦å…¨å±€ä»£ç†)</strong></li></ul> 
<h2>åˆ›å»ºé¡¹ç›®</h2> 
<p><img alt="" height="911" src="https://images2.imgbox.com/8a/7e/XASLe9v1_o.png" width="1160">â€‹</p> 
<p><img alt="" height="915" src="https://images2.imgbox.com/bd/8d/1PQjTiYm_o.png" width="1182">â€‹</p> 
<h2>pomæ–‡ä»¶é…ç½®</h2> 
<div> 
 <pre><code class="language-XML">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;3.2.5&lt;/version&gt;
        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;
    &lt;/parent&gt;
    &lt;groupId&gt;com.zzq&lt;/groupId&gt;
    &lt;artifactId&gt;spring-ai-chat01&lt;/artifactId&gt;
    &lt;!--        å¿«ç…§ç‰ˆæœ¬--&gt;
    &lt;version&gt;1.0.1-SNAPSHOT&lt;/version&gt;
    &lt;name&gt;spring-ai-chat01&lt;/name&gt;
    &lt;description&gt;spring-ai-chat01&lt;/description&gt;
    &lt;properties&gt;
        &lt;java.version&gt;17&lt;/java.version&gt;
        &lt;spring-ai.version&gt;1.0.0-SNAPSHOT&lt;/spring-ai.version&gt;
    &lt;/properties&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;
&lt;!--        spring ai-starterä¾èµ– å¯åŠ¨ä¾èµ–--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.ai&lt;/groupId&gt;
            &lt;artifactId&gt;spring-ai-openai-spring-boot-starter&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;!--    ç»§æ‰¿ä¸€ä¸ªçˆ¶é¡¹ç›®spring-ai-bom--&gt;
    &lt;dependencyManagement&gt;
        &lt;dependencies&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework.ai&lt;/groupId&gt;
                &lt;artifactId&gt;spring-ai-bom&lt;/artifactId&gt;
                &lt;version&gt;${spring-ai.version}&lt;/version&gt;
                &lt;type&gt;pom&lt;/type&gt;
                &lt;scope&gt;import&lt;/scope&gt;
            &lt;/dependency&gt;
        &lt;/dependencies&gt;
    &lt;/dependencyManagement&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
                &lt;configuration&gt;
                    &lt;excludes&gt;
                        &lt;exclude&gt;
                            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
                            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
                        &lt;/exclude&gt;
                    &lt;/excludes&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;
&lt;!--    é…ç½®æœ¬é¡¹ç›®çš„mavenä»“åº“  å› ä¸ºmavenä¸­å¿ƒä»“åº“è¿˜æ²¡æœ‰æ›´æ–°spring aiçš„jaråŒ…--&gt;
&lt;!--é‡Œç¨‹ç¢‘ç‰ˆæœ¬ä»“åº“--&gt;
    &lt;!--    &lt;repositories&gt;--&gt;
&lt;!--        &lt;repository&gt;--&gt;
&lt;!--            &lt;id&gt;spring-milestones&lt;/id&gt;--&gt;
&lt;!--            &lt;name&gt;Spring Milestones&lt;/name&gt;--&gt;
&lt;!--            &lt;url&gt;https://repo.spring.io/milestone&lt;/url&gt;--&gt;
&lt;!--            &lt;snapshots&gt;--&gt;
&lt;!--                &lt;enabled&gt;false&lt;/enabled&gt;--&gt;
&lt;!--            &lt;/snapshots&gt;--&gt;
&lt;!--        &lt;/repository&gt;--&gt;
&lt;!--    &lt;/repositories&gt;--&gt;

&lt;!--    å¿«ç…§ç‰ˆæœ¬--&gt;
    &lt;repositories&gt;
        &lt;repository&gt;
            &lt;id&gt;spring-snapshot&lt;/id&gt;
            &lt;name&gt;Spring Snapshots&lt;/name&gt;
            &lt;url&gt;https://repo.spring.io/snapshot&lt;/url&gt;
            &lt;releases&gt;
                &lt;enabled&gt;false&lt;/enabled&gt;
            &lt;/releases&gt;
        &lt;/repository&gt;
    &lt;/repositories&gt;
&lt;/project&gt;
</code></pre> 
</div> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/db/f0/HO5eKHTm_o.png" width="1200">â€‹</p> 
<h2>é…ç½®applicationæ–‡ä»¶</h2> 
<p><img alt="" height="682" src="https://images2.imgbox.com/d1/94/gByE6b94_o.png" width="715"></p> 
<p>æ–‡ä»¶å†…å®¹ï¼šÂ </p> 
<pre><code class="language-XML">spring:
  application:
     name:spring-ai-01-chat
  ai:
    openai:
     api-key: ${OPENAI_API_KEY}
     base-url: ${OPENAI_API_URL}
     chat:
       option:
         #model:gpt-4-32k
         model:gpt-3.5-turbo
         temperature:0.3F</code></pre> 
<p><a href="http://t.csdnimg.cn/32fqr" rel="nofollow" title="http://t.csdnimg.cn/32fqr">http://t.csdnimg.cn/32fqr</a>å°ç™½å¦‚ä½•è®¾ç½®openai api keyçš„ç¯å¢ƒå˜é‡</p> 
<p>controlleræ–‡ä»¶å†…å®¹ï¼š</p> 
<h2>ç”Ÿæˆæ–‡å­—</h2> 
<pre><code class="language-java">package com.zzq.controller;
 
import jakarta.annotation.Resource;
import org.springframework.ai.chat.ChatResponse;
import org.springframework.ai.chat.prompt.Prompt;
import org.springframework.ai.openai.OpenAiChatClient;
import org.springframework.ai.openai.OpenAiChatOptions;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;
import reactor.core.publisher.Flux;
 
@RestController
public class ChatController {
    /**
     * OpenAiè‡ªåŠ¨è£…é…ï¼Œå¯ä»¥ç›´æ¥æ³¨å…¥ä½¿ç”¨
     */
    @Resource
    private OpenAiChatClient openAiChatClient;
 
    /**
     * è°ƒç”¨OpenAiçš„æ¥å£,callæ–¹æ³•ä¸ºåŒæ­¥çš„api
     * @param msg ä½ è¦é—®çš„é—®é¢˜
     * @return
     */
    @RequestMapping("/ai/chat")
    public String chat(@RequestParam("msg") String msg) {
        String called = openAiChatClient.call(msg);
        return called;
    }
 
    /**
     * è°ƒç”¨OpenAiçš„æ¥å£
     * @param msg ä½ è¦é—®çš„é—®é¢˜
     * @return  Object--jsonå¯¹è±¡
     */
    @RequestMapping ("/ai/chat1")
    public Object chat1(@RequestParam("msg") String msg) {
        ChatResponse response = openAiChatClient.call(new Prompt(msg));
        return response;
//        return response.getResult().getOutput().getContent();//åªæ‹¿åˆ°å†…å®¹
    }
 
    /**
     * è°ƒç”¨OpenAiçš„æ¥å£
     * @param msg ä½ è¦é—®çš„é—®é¢˜
     * @return
     */
    @RequestMapping ("/ai/chat3")
    public String chat3(@RequestParam("msg") String msg) {
        //å¯é€‰å‚æ•°åœ¨ymlé…ç½®ï¼ŒåŒæ—¶åœ¨ä»£ç ä¸­ä¹Ÿé…ç½®ï¼Œé‚£ä¹ˆä¼šä»¥ä»£ç ä¸ºå‡†
        ChatResponse response = openAiChatClient.call(new Prompt(msg, OpenAiChatOptions.builder()
//                .withModel("gpt-4-32k")//ä½¿ç”¨çš„æ¨¡å‹,32kæ˜¯å‚æ•°é‡//å‚æ•°é‡è¶Šé«˜ï¼Œå‡†ç¡®ç‡è¶Šé«˜
                .withTemperature(0.3F)//æ¸©åº¦è¶Šé«˜å›ç­”è¶Šæ…¢ï¼Œæ¸©åº¦è¶Šä½å›ç­”è¶Šå¿«
                .build()));
        return response.getResult().getOutput().getContent();
    }
 
    /**
     * è°ƒç”¨OpenAiçš„æ¥å£ streamæ˜¯æµå¼çš„api
     * @param msg ä½ è¦é—®çš„é—®é¢˜
     * @return
     */
    @RequestMapping ("/ai/chat4")
    public Object chat4(@RequestParam("msg") String msg) {
        //å¯é€‰å‚æ•°åœ¨ymlé…ç½®ï¼ŒåŒæ—¶åœ¨ä»£ç ä¸­ä¹Ÿé…ç½®ï¼Œé‚£ä¹ˆä¼šä»¥ä»£ç ä¸ºå‡†
        Flux&lt;ChatResponse&gt; flux = openAiChatClient.stream(new Prompt(msg, OpenAiChatOptions.builder()
//                .withModel("gpt-3.5")//ä½¿ç”¨çš„æ¨¡å‹
                .withTemperature(0.3F)//æ¸©åº¦è¶Šé«˜å›ç­”è¶Šæ…¢ï¼Œæ¸©åº¦è¶Šä½å›ç­”è¶Šå¿«
                .build()));
        flux.toStream().forEach(chatResponse -&gt;{
            System.out.println(chatResponse.getResult().getOutput().getContent());
        });
        return flux.collectList();//æ•°æ®çš„åºåˆ—,ä¸€åºåˆ—çš„æ•°æ®ï¼Œä¸€ä¸ªä¸€ä¸ªçš„æ•°æ®è¿”å›
    }
}
 </code></pre> 
<p>spring-ai-02-image</p> 
<p>applicationæ–‡ä»¶å†…å®¹(ä»£ç é…ç½®çš„ä¼šè¦†ç›–ymlæ–‡ä»¶ä¸­çš„)</p> 
<p><span style="color:#fe2c24;">æ›´æ”¹å¯ä»¥ç”Ÿæˆimageçš„api-key</span></p> 
<p><span style="color:#fe2c24;">ç”»å›¾æ¨¡å‹ç‰ˆæœ¬</span></p> 
<p>n:1(ç”Ÿæˆå›¾ç‰‡ä¸¤å¼ )</p> 
<p>height:1024(é«˜åº¦)</p> 
<p>width:1024(å®½åº¦)</p> 
<p>quality:hd(é«˜æ¸…)</p> 
<pre><code class="language-XML">spring:
  application:
     name:spring-ai-02-image
  ai:
    openai:
     api-key: ${OPENAI_API_KEY}
     base-url: ${OPENAI_API_URL}
     image:
        options:
           model:gpt-4-dalle
    </code></pre> 
<p></p> 
<p>controllerå†…å®¹ï¼š</p> 
<h2><strong>ç”Ÿæˆå›¾ç‰‡</strong></h2> 
<p>å›¾ç‰‡æ— æ³•ä½¿ç”¨æµå¼api</p> 
<pre><code class="language-java">package com.zzq.controller;
import jakarta.annotation.Resource;
import org.springframework.ai.image.ImageOptionsBuilder;
import org.springframework.ai.image.ImagePrompt;
import org.springframework.ai.image.ImageResponse;
import org.springframework.ai.openai.OpenAiImageClient;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class ImageController {
    @Resource
    private OpenAiImageClient openAiImageClient;

    @RequestMapping("/ai/image")
    private Object image(@RequestParam(value="msg")String msg){
        ImageResponse imageResponse=openAiImageClient.call(new ImagePrompt(msg));
        System.out.println(imageResonse);
//æŠŠå›¾ç‰‡è¿›è¡Œä¸šåŠ¡å¤„ç†
        String imageUrl=return response.getResult().getOutput().getUrl();

     return response.getResult().getOutput().getUrl();

  /*  @GetMapping("/ai/draw")
    public String drawImage(@RequestParam(value = "msg") String msg){
        ImageResponse response = openAiImageClient.call(new ImagePrompt(msg,
                ImageOptionsBuilder
                        .builder()
                        .withQuality("hd")//é«˜æ¸…å›¾åƒ
                        .withModel("dall-e-3") //ç»˜ç”»æ¨¡å‹
                        .withN(1) //ç”Ÿæˆå›¾åƒçš„ä¸ªæ•°
                        .withWidth(1024) //å›¾åƒå®½åº¦ é»˜è®¤å€¼
                        .withHeight(1024) //å›¾åƒé«˜åº¦ é»˜è®¤å€¼
                        .build()
                )
        );
        //è¿”å›ç»“æœå›¾ç‰‡çš„åœ°å€
        return response.getResult().getOutput().getUrl();
*/
    }
}
</code></pre> 
<h2>ç”Ÿæˆè¯­éŸ³</h2> 
<h4>AiéŸ³é¢‘è½¬æ–‡æœ¬</h4> 
<p>spring-ai-03-transcription</p> 
<p><span style="color:#fe2c24;">æ›´æ”¹å¯ä»¥ç”Ÿæˆå£°éŸ³çš„api-key</span></p> 
<p><span style="color:#fe2c24;">å£°éŸ³æ¨¡å‹ç‰ˆæœ¬</span></p> 
<p>applicationæ–‡ä»¶å†…å®¹</p> 
<pre><code class="language-XML">spring:
  application:
     name:spring-ai-03-trascription
  ai:
    openai:
     api-key: ${OPENAI_API_KEY}
     base-url: ${OPENAI_API_URL}
    </code></pre> 
<pre><code class="language-java">import jakarta.annotation.Resource;
import org.springframework.ai.openai.OpenAiAudioSpeechClient;
import org.springframework.ai.openai.OpenAiAudioTranscriptionClient;
import org.springframework.core.io.ClassPathResource;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;
import static com.ysl.utisl.save2File.save2File;


@RestController
public class TranscriptionController {
    @Resource
    private OpenAiudioTranscriptionClient openAiAudioTranscriptionClient;
    @RequestMapping(value="/ai/transcription")
    public Object transcription(){
          org,springframework.core.io.Resourse audioFile = new ClassPathResourse("æ–‡ä»¶åjfk.mp3")
    String called = openAiAudioTranscriptiomClient.call(audioFile)
    System.out.println(called);
    return called;
}

/*
@RestController
public class TranscriptionController {
    //å°†éŸ³é¢‘è½¬æ–‡å­—æ—¶ä½¿ç”¨
    @Resource
    private OpenAiAudioTranscriptionClient transcriptionClient;
    //å°†æ–‡å­—è½¬è¯­éŸ³æ—¶ä½¿ç”¨
    @Resource
    private OpenAiAudioSpeechClient speechClient;

    /**
     * å°†éŸ³é¢‘è½¬æ–‡å­—
     * @return
     */
   /* @RequestMapping("/ai/transcription")
    public Object transcription() {
    //è¯»å–çš„æ˜¯ç£ç›˜çš„è·¯å¾„
    //FileSystemResource audioFile = new FileSystemResource("C:\\Users\\DELL\\Desktop\\luyin.m4a");
        //è¯»å–çš„æ˜¯classpathé™æ€èµ„æºä¸‹çš„æ–‡ä»¶
        ClassPathResource audioFile = new ClassPathResource("luyin.m4a");
        String call = transcriptionClient.call(audioFile);
        System.out.println(call);
        return call;
    }

    /**
     * å°†æ–‡å­—è½¬éŸ³é¢‘
     * @return
     */
   /* @RequestMapping("/ai/tts")
    public Object tts() {
        String text = "Spring AI æ˜¯ AI å·¥ç¨‹çš„åº”ç”¨æ¡†æ¶ã€‚å…¶ç›®æ ‡æ˜¯å°† Spring ç”Ÿæ€ç³»ç»Ÿè®¾è®¡åŸåˆ™ï¼ˆå¦‚å¯ç§»æ¤æ€§å’Œæ¨¡å—åŒ–è®¾è®¡ï¼‰åº”ç”¨äº AIï¼Œå¹¶æ¨å¹¿ä½¿ç”¨ POJO ä½œä¸º AI é¢†åŸŸåº”ç”¨ç¨‹åºçš„æ„å»ºå—ã€‚ è·¨ AI æä¾›å•†çš„å¯ç§»æ¤ API æ”¯æŒï¼Œé€‚ç”¨äºèŠå¤©ã€æ–‡æœ¬åˆ°å›¾åƒå’ŒåµŒå…¥æ¨¡å‹ã€‚æ”¯æŒåŒæ­¥å’Œæµ API é€‰é¡¹ã€‚è¿˜æ”¯æŒä¸‹æ‹‰ä»¥è®¿é—®ç‰¹å®šäºæ¨¡å‹çš„åŠŸèƒ½";
        byte[] bytes = speechClient.call(text);
        save2File("C:\\Users\\DELL\\Desktop\\test.mp3",bytes);
        return "OK";
    }
*/
/*

@RequestMapping("/ai/tts")
    public Object tts() {
        String text = "Spring AI æ˜¯ AI å·¥ç¨‹çš„åº”ç”¨æ¡†æ¶ã€‚å…¶ç›®æ ‡æ˜¯å°† Spring ç”Ÿæ€ç³»ç»Ÿè®¾è®¡åŸåˆ™ï¼ˆå¦‚å¯ç§»æ¤æ€§å’Œæ¨¡å—åŒ–è®¾è®¡ï¼‰åº”ç”¨äº AIï¼Œå¹¶æ¨å¹¿ä½¿ç”¨ POJO ä½œä¸º AI é¢†åŸŸåº”ç”¨ç¨‹åºçš„æ„å»ºå—ã€‚ è·¨ AI æä¾›å•†çš„å¯ç§»æ¤ API æ”¯æŒï¼Œé€‚ç”¨äºèŠå¤©ã€æ–‡æœ¬åˆ°å›¾åƒå’ŒåµŒå…¥æ¨¡å‹ã€‚æ”¯æŒåŒæ­¥å’Œæµ API é€‰é¡¹ã€‚è¿˜æ”¯æŒä¸‹æ‹‰ä»¥è®¿é—®ç‰¹å®šäºæ¨¡å‹çš„åŠŸèƒ½";
        byte[] bytes = openAiAudioSpeechClient..call(text);
        FileUtilssave2File("C:\\Users\\DELL\\Desktop\\test.mp3",bytes);
        return "OK";
}
*/

}
</code></pre> 
<h2>Spring Ai---å¤šæ¨¡æ€</h2> 
<p>å¤šæ¨¡æ€API</p> 
<p>å¤šæ¨¡æ€æ˜¯æŒ‡æ¨¡å‹åŒæ—¶ç†è§£å’Œå¤„ç†æ¥è‡ªå„ç§æ¥æºä¿¡æ¯çš„èƒ½åŠ›ï¼ŒåŒ…æ‹¬æ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘å’Œå…¶ä»–æ•°æ®æ ¼å¼</p> 
<p>å¤šæ¨¡å‹å¤§è¯­è¨€ï¼ˆLLMï¼‰ç‰¹å¾ä½¿æ¨¡å‹èƒ½å¤Ÿç»“åˆå…¶ä»–æ¨¡æ€ï¼ˆå¦‚å›¾åƒã€éŸ³é¢‘æˆ–è§†é¢‘ï¼‰æ¥å¤„ç†å’Œç”Ÿæˆæ–‡æœ¬</p> 
<p>spring-ai-05-multimodel</p> 
<pre><code class="language-java">package com.zzq.controller;

import jakarta.annotation.Resource;
import org.springframework.ai.chat.ChatClient;
import org.springframework.ai.chat.ChatResponse;
import org.springframework.ai.chat.messages.Media;
import org.springframework.ai.chat.messages.UserMessage;
import org.springframework.ai.chat.prompt.Prompt;
import org.springframework.ai.openai.OpenAiChatOptions;
import org.springframework.ai.openai.api.OpenAiApi;
import org.springframework.util.MimeTypeUtils;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import java.util.List;

@RestController
public class MultiModelController {
@Resource
    private ChatClient chatClient;
@RequestMapping(value = "/ai/multi")
    public  Object multi(String msg,String imageUrl){
    UserMessage userMessage=new UserMessage(msg,
            List.of(new Media(MimeTypeUtils.IMAGE_PNG,imageUrl))
            );
    ChatResponse response=chatClient.call(new Prompt(List.of(userMessage),
            OpenAiChatOptions.builder()
                    .withModel(OpenAiApi.ChatModel.GPT_4_VISION_PREVIEW.getValue())
                    .build()
            ));
    return response.getResult().getOutput().getContent();
}
}
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bce5da055f5e5f76512ee09cd1e13f3d/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">ç¨‹åºæ€§èƒ½ä¼˜åŒ–</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/51f8c0b111cefb0d534c1436efe6fe04/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">C&#43;&#43;ç¬¬äºŒåä¸‰å¼¹---æ·±å…¥ç†è§£STLä¸­listçš„ä½¿ç”¨</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§å’–.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>