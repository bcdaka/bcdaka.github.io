<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【Python】Pandas简要教程 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/839b230ed3d10a7c018b03486fd77ac0/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【Python】Pandas简要教程">
  <meta property="og:description" content="文章目录 一、简介二、Pandas基本数据结构及其方法2.1 Series2.2 DataFrame 三、标签和索引四、常用方法4.1 数据读取和写入4.11 🟢CSV文件4.12🟢Excel文件4.13 其它文件 4.2 字符串处理4.3 表格拼接4.4 时间数据处理 一、简介 Pandas 是一个用于数据操作和分析的开源 Python 库。它提供了高效的数据结构和数据分析工具，特别适合处理结构化数据（如表格数据）。Pandas 在数据清洗、预处理、统计分析、数据可视化等方面有广泛的应用。
Github：https://github.com/pandas-dev/pandas
User Guide：https://pandas.pydata.org/docs/user_guide/index.html
主要特点：
易用的数据结构：
Series：一维数组，类似于 Python 的列表或字典。DataFrame：二维数据结构，类似于 Excel 表格或 SQL 表。 数据操作：
支持对数据进行增删改查操作。提供丰富的数据清洗和预处理功能，包括缺失值处理、数据过滤、分组、聚合等。支持多种数据格式的读写，如 CSV、Excel、SQL、JSON 等。 高效的性能：
基于 NumPy 实现，具有高效的计算性能。支持多种加速库，如 Dask、Modin，可以在大数据处理时提升性能。 数据可视化：
与 Matplotlib、Seaborn 等可视化库无缝集成，方便生成各种类型的图表。 二、Pandas基本数据结构及其方法 2.1 Series pd.Series是Pandas库中的一种基本数据结构，用于表示一维的带标签数组。它既可以包含整数、浮点数、字符串等数据类型，也可以包含其他Python对象。
可以通过多种方式创建一个Series：
import pandas as pd # 通过列表创建 s = pd.Series([1, 3, 5, 7, 9]) # 通过字典创建 data = {&#39;a&#39;: 1, &#39;b&#39;: 3, &#39;c&#39;: 5} s = pd.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-23T03:10:49+08:00">
    <meta property="article:modified_time" content="2024-07-23T03:10:49+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Python】Pandas简要教程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_2" rel="nofollow">一、简介</a></li><li><a href="#Pandas_30" rel="nofollow">二、Pandas基本数据结构及其方法</a></li><li><ul><li><a href="#21_Series_32" rel="nofollow">2.1 Series</a></li><li><a href="#22_DataFrame_118" rel="nofollow">2.2 DataFrame</a></li></ul> 
  </li><li><a href="#_233" rel="nofollow">三、标签和索引</a></li><li><a href="#_296" rel="nofollow">四、常用方法</a></li><li><ul><li><a href="#41__299" rel="nofollow">4.1 数据读取和写入</a></li><li><ul><li><a href="#411_CSV_302" rel="nofollow">4.11 🟢CSV文件</a></li><li><a href="#412Excel_407" rel="nofollow">4.12🟢Excel文件</a></li><li><a href="#413__484" rel="nofollow">4.13 其它文件</a></li></ul> 
   </li><li><a href="#42__532" rel="nofollow">4.2 字符串处理</a></li><li><a href="#43__562" rel="nofollow">4.3 表格拼接</a></li><li><a href="#44__710" rel="nofollow">4.4 时间数据处理</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_2"></a>一、简介</h2> 
<p><code>Pandas</code> 是一个用于数据操作和分析的开源 Python 库。它提供了高效的数据结构和数据分析工具，特别适合处理结构化数据（如表格数据）。Pandas 在<code>数据清洗、预处理、统计分析、数据可视化</code>等方面有广泛的应用。</p> 
<p>Github：<a href="https://github.com/pandas-dev/pandas">https://github.com/pandas-dev/pandas</a></p> 
<p>User Guide：<a href="https://pandas.pydata.org/docs/user_guide/index.html" rel="nofollow">https://pandas.pydata.org/docs/user_guide/index.html</a></p> 
<p><strong>主要特点：</strong></p> 
<ol><li> <p><strong>易用的数据结构</strong>：</p> 
  <ul><li><strong>Series</strong>：一维数组，类似于 Python 的列表或字典。</li><li><strong>DataFrame</strong>：二维数据结构，类似于 Excel 表格或 SQL 表。</li></ul> </li><li> <p><strong>数据操作</strong>：</p> 
  <ul><li>支持对数据进行增删改查操作。</li><li>提供丰富的数据清洗和预处理功能，包括缺失值处理、数据过滤、分组、聚合等。</li><li>支持多种数据格式的读写，如 CSV、Excel、SQL、JSON 等。</li></ul> </li><li> <p><strong>高效的性能</strong>：</p> 
  <ul><li>基于 NumPy 实现，具有高效的计算性能。</li><li>支持多种加速库，如 Dask、Modin，可以在大数据处理时提升性能。</li></ul> </li><li> <p><strong>数据可视化</strong>：</p> 
  <ul><li>与 Matplotlib、Seaborn 等可视化库无缝集成，方便生成各种类型的图表。</li></ul> </li></ol> 
<h2><a id="Pandas_30"></a>二、Pandas基本数据结构及其方法</h2> 
<h3><a id="21_Series_32"></a>2.1 Series</h3> 
<p><code>pd.Series</code>是Pandas库中的一种基本数据结构，用于表示一维的带标签数组。它既可以包含整数、浮点数、字符串等数据类型，也可以包含其他Python对象。</p> 
<p><strong>可以通过多种方式创建一个Series：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token comment"># 通过列表创建</span>
s <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 通过字典创建</span>
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">}</span>
s <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token comment"># 通过标量创建（指定索引）</span>
s <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<blockquote> 
 <p>单从这里看，Series是具有列表或字典的特性的。</p> 
</blockquote> 
<p>🟢<strong>Series 属性：</strong></p> 
<table><thead><tr><th>属性</th><th>说明</th><th>例</th></tr></thead><tbody><tr><td>index</td><td>返回或设置Series的索引</td><td>s.index = [‘A’, ‘B’, ‘C’, ‘D’, ‘E’]</td></tr><tr><td>values</td><td>返回Series中的数据（不包含索引）</td><td>s.values</td></tr><tr><td>name</td><td>返回或设置Series的名称</td><td>s.name = ‘my_series’</td></tr><tr><td>dtype</td><td>返回Series的数据类型</td><td>s.dtype</td></tr></tbody></table> 
<p>🟢<strong>Series 方法：</strong></p> 
<p>（1）基本方法</p> 
<table><thead><tr><th>方法</th><th>功能描述</th><th>示例代码</th></tr></thead><tbody><tr><td><code>head(n)</code></td><td>返回前<code>n</code>个元素，默认返回前5个</td><td><code>s.head(3)</code></td></tr><tr><td><code>tail(n)</code></td><td>返回后<code>n</code>个元素，默认返回后5个</td><td><code>s.tail(3)</code></td></tr><tr><td><code>shape</code></td><td>返回Series的形状（元素个数）</td><td><code>s.shape</code></td></tr><tr><td><code>index</code></td><td>返回Series的索引标签</td><td><code>s.index</code></td></tr><tr><td><code>values</code></td><td>返回Series的值（不包含索引）</td><td><code>s.values</code></td></tr><tr><td><code>dtypes</code></td><td>返回Series的数据类型</td><td><code>s.dtypes</code></td></tr></tbody></table> 
<p>（2）数据选择与操作</p> 
<table><thead><tr><th>方法</th><th>功能描述</th><th>示例代码</th></tr></thead><tbody><tr><td><code>loc[]</code></td><td>按标签选择元素</td><td><code>s.loc['a']</code></td></tr><tr><td><code>iloc[]</code></td><td>按位置选择元素</td><td><code>s.iloc[0]</code></td></tr><tr><td><code>at[]</code></td><td>快速访问单个元素（标签方式）</td><td><code>s.at['a']</code></td></tr><tr><td><code>iat[]</code></td><td>快速访问单个元素（位置方式）</td><td><code>s.iat[0]</code></td></tr><tr><td><code>drop(labels)</code></td><td>删除指定的元素</td><td><code>s.drop('a')</code></td></tr><tr><td><code>rename()</code></td><td>重命名索引标签</td><td><code>s.rename({'a': 'alpha'})</code></td></tr><tr><td><code>replace()</code></td><td>替换指定的值</td><td><code>s.replace(10, 100)</code></td></tr><tr><td><code>map()</code></td><td>对Series中的每个元素应用函数或映射</td><td><code>s.map(lambda x: x * 2)</code></td></tr><tr><td><code>apply(func)</code></td><td>对Series中的每个元素应用函数</td><td><code>s.apply(lambda x: x + 1)</code></td></tr></tbody></table> 
<p>（3）数据聚合与统计</p> 
<table><thead><tr><th>方法</th><th>功能描述</th><th>示例代码</th></tr></thead><tbody><tr><td><code>sum()</code></td><td>计算Series中所有元素的和</td><td><code>s.sum()</code></td></tr><tr><td><code>mean()</code></td><td>计算Series中所有元素的均值</td><td><code>s.mean()</code></td></tr><tr><td><code>median()</code></td><td>计算Series中所有元素的中位数</td><td><code>s.median()</code></td></tr><tr><td><code>mode()</code></td><td>计算Series中所有元素的众数</td><td><code>s.mode()</code></td></tr><tr><td><code>std()</code></td><td>计算Series中所有元素的标准差</td><td><code>s.std()</code></td></tr><tr><td><code>var()</code></td><td>计算Series中所有元素的方差</td><td><code>s.var()</code></td></tr><tr><td><code>count()</code></td><td>计算Series中非NA/null值的数量</td><td><code>s.count()</code></td></tr><tr><td><code>min()</code></td><td>计算Series中所有元素的最小值</td><td><code>s.min()</code></td></tr><tr><td><code>max()</code></td><td>计算Series中所有元素的最大值</td><td><code>s.max()</code></td></tr></tbody></table> 
<p>（4） 处理缺失值</p> 
<table><thead><tr><th>方法</th><th>功能描述</th><th>示例代码</th></tr></thead><tbody><tr><td><code>isna()</code></td><td>检测缺失值（NA/null）</td><td><code>s.isna()</code></td></tr><tr><td><code>notna()</code></td><td>检测非缺失值</td><td><code>s.notna()</code></td></tr><tr><td><code>fillna(value)</code></td><td>用指定值填充缺失值</td><td><code>s.fillna(0)</code></td></tr><tr><td><code>dropna()</code></td><td>删除包含缺失值的元素</td><td><code>s.dropna()</code></td></tr></tbody></table> 
<h3><a id="22_DataFrame_118"></a>2.2 DataFrame</h3> 
<p><code>pandas.DataFrame</code>是Pandas库中最重要的数据结构之一，主要用于表示二维的数据表格。它可以看作是由多个<code>Series</code>构成的字典，每个<code>Series</code>表示DataFrame的一列。以下是有关<code>DataFrame</code>的详细介绍：</p> 
<p><strong>可以通过多种方式创建一个<code>DataFrame</code>：</strong></p> 
<ol><li> <p>通过字典创建</p> <pre><code class="prism language-python">data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token string">'Charlie'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'city'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'New York'</span><span class="token punctuation">,</span> <span class="token string">'San Francisco'</span><span class="token punctuation">,</span> <span class="token string">'Los Angeles'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
</code></pre> </li><li> <p>通过列表的列表创建</p> <pre><code class="prism language-python">data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">'New York'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">'San Francisco'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">'Charlie'</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token string">'Los Angeles'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'city'</span><span class="token punctuation">]</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">,</span> columns<span class="token operator">=</span>columns<span class="token punctuation">)</span>
</code></pre> </li><li> <p>通过字典的字典创建</p> <pre><code class="prism language-python">data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token string">'0'</span><span class="token punctuation">:</span> <span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">:</span> <span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">:</span> <span class="token string">'Charlie'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token string">'0'</span><span class="token punctuation">:</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">:</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">:</span> <span class="token number">35</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">'city'</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token string">'0'</span><span class="token punctuation">:</span> <span class="token string">'New York'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">:</span> <span class="token string">'San Francisco'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">:</span> <span class="token string">'Los Angeles'</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
</code></pre> </li><li> <p>通过numpy数组创建</p> <pre><code class="prism language-python">data <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">'New York'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                 <span class="token punctuation">[</span><span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">'San Francisco'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                 <span class="token punctuation">[</span><span class="token string">'Charlie'</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token string">'Los Angeles'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'city'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> </li></ol> 
<p>输出：</p> 
<pre><code class="prism language-bash">      name  age           city
<span class="token number">0</span>    Alice   <span class="token number">25</span>       New York
<span class="token number">1</span>      Bob   <span class="token number">30</span>  San Francisco
<span class="token number">2</span>  Charlie   <span class="token number">35</span>    Los Angeles
</code></pre> 
<p>🟢 <strong>DataFrame 属性：</strong></p> 
<table><thead><tr><th>属性</th><th>说明</th><th>例</th></tr></thead><tbody><tr><td>index</td><td>返回DataFrame的行索引</td><td>print(df.index)</td></tr><tr><td>columns</td><td>返回DataFrame的列标签</td><td>print(df.columns)</td></tr><tr><td>shape</td><td>返回DataFrame的维度（行数，列数）</td><td>print(df.shape)</td></tr><tr><td>values</td><td>返回DataFrame的所有数据（不包含索引和列标签）</td><td>print(df.values)</td></tr><tr><td>dtype</td><td>返回每列的数据类型</td><td>print(df.dtypes)</td></tr></tbody></table> 
<p>🟢<strong>DataFrame 方法：</strong></p> 
<p><code>pandas.DataFrame</code>提供了丰富的方法来进行数据操作和分析。<br> （1）基本方法</p> 
<table><thead><tr><th>方法</th><th>功能描述</th><th>示例代码</th></tr></thead><tbody><tr><td><code>head(n)</code></td><td>返回前<code>n</code>行，默认返回前5行</td><td><code>df.head(3)</code></td></tr><tr><td><code>tail(n)</code></td><td>返回后<code>n</code>行，默认返回后5行</td><td><code>df.tail(3)</code></td></tr><tr><td><code>shape</code></td><td>返回DataFrame的维度（行数，列数）</td><td><code>df.shape</code></td></tr><tr><td><code>describe()</code></td><td>生成描述性统计信息</td><td><code>df.describe()</code></td></tr><tr><td><code>info()</code></td><td>打印DataFrame的信息摘要</td><td><code>df.info()</code></td></tr><tr><td><code>columns</code></td><td>返回DataFrame的列标签</td><td><code>df.columns</code></td></tr><tr><td><code>index</code></td><td>返回DataFrame的行索引</td><td><code>df.index</code></td></tr><tr><td><code>dtypes</code></td><td>返回每列的数据类型</td><td><code>df.dtypes</code></td></tr><tr><td><code>values</code></td><td>返回DataFrame的数据（不含索引和列标签）</td><td><code>df.values</code></td></tr></tbody></table> 
<p>（2） 数据选择与操作</p> 
<table><thead><tr><th>方法</th><th>功能描述</th><th>示例代码</th></tr></thead><tbody><tr><td><code>loc[]</code></td><td>按标签选择行和列</td><td><code>df.loc['row_label', 'col_label']</code></td></tr><tr><td><code>iloc[]</code></td><td>按位置选择行和列</td><td><code>df.iloc[0, 1]</code></td></tr><tr><td><code>at[]</code></td><td>快速访问单个元素（标签方式）</td><td><code>df.at['row_label', 'col_label']</code></td></tr><tr><td><code>iat[]</code></td><td>快速访问单个元素（位置方式）</td><td><code>df.iat[0, 1]</code></td></tr><tr><td><code>drop(labels, axis)</code></td><td>删除指定行或列</td><td><code>df.drop('column_name', axis=1)</code></td></tr><tr><td><code>rename()</code></td><td>重命名行或列标签</td><td><code>df.rename(columns={'old_name': 'new_name'})</code></td></tr><tr><td><code>set_index()</code></td><td>设置指定列为索引</td><td><code>df.set_index('column_name')</code></td></tr><tr><td><code>reset_index()</code></td><td>重置索引为默认整数索引</td><td><code>df.reset_index()</code></td></tr><tr><td><code>sort_values(by)</code></td><td>按指定列排序</td><td><code>df.sort_values(by='column_name')</code></td></tr><tr><td><code>sort_index()</code></td><td>按索引排序</td><td><code>df.sort_index()</code></td></tr><tr><td><code>fillna(value)</code></td><td>用指定值填充缺失值</td><td><code>df.fillna(0)</code></td></tr><tr><td><code>dropna()</code></td><td>删除包含缺失值的行或列</td><td><code>df.dropna()</code></td></tr><tr><td><code>duplicated()</code></td><td>检测重复的行</td><td><code>df.duplicated()</code></td></tr></tbody></table> 
<p>（3）数据聚合与变换</p> 
<table><thead><tr><th>方法</th><th>功能描述</th><th>示例代码</th></tr></thead><tbody><tr><td><code>groupby(by)</code></td><td>按指定列分组</td><td><code>df.groupby('column_name').mean()</code></td></tr><tr><td><code>agg(func)</code></td><td>对分组后的数据应用多个聚合函数</td><td><code>df.groupby('column_name').agg(['sum', 'mean'])</code></td></tr><tr><td><code>apply(func)</code></td><td>对DataFrame的每列或每行应用函数</td><td><code>df.apply(lambda x: x.max())</code></td></tr><tr><td><code>pivot_table()</code></td><td>创建数据透视表</td><td><code>df.pivot_table(index='row_col', values='data_col', aggfunc='mean')</code></td></tr><tr><td><code>melt()</code></td><td>将DataFrame从宽格式转换为长格式</td><td><code>df.melt(id_vars=['id'], value_vars=['var1', 'var2'])</code></td></tr></tbody></table> 
<p>（4）数据合并与连接</p> 
<table><thead><tr><th>方法</th><th>功能描述</th><th>示例代码</th></tr></thead><tbody><tr><td><code>merge()</code></td><td>合并两个DataFrame</td><td><code>pd.merge(df1, df2, on='key')</code></td></tr><tr><td><code>concat()</code></td><td>连接多个DataFrame</td><td><code>pd.concat([df1, df2])</code></td></tr><tr><td><code>join()</code></td><td>按索引连接两个DataFrame</td><td><code>df1.join(df2)</code></td></tr></tbody></table> 
<h2><a id="_233"></a>三、标签和索引</h2> 
<p>在Pandas中，"索引"和"标签"在某些方面相似，但它们的使用和作用有些不同。</p> 
<p><strong>索引（Index）：</strong></p> 
<ul><li> <p>定义：在Pandas中，"索引"指的是用于标识数据的位置的标签。它可以是行索引（对于<code>DataFrame</code>和<code>Series</code>的行）或列索引（对于<code>DataFrame</code>的列）。</p> </li><li> <p>功能：</p> 
  <ul><li>定位和访问数据：索引用于定位和访问数据。例如，通过行索引，可以快速访问特定行的数据。</li><li>对齐数据：在进行数据合并、对齐等操作时，Pandas会自动对齐索引，以确保数据一致性。</li><li>标签的灵活性：索引不仅可以是整数，还可以是字符串、日期、时间等类型，提供了灵活的数据标识方式。</li></ul> </li><li> <p>示例：</p> <pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 创建一个Series</span>
s <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>index<span class="token punctuation">)</span>  <span class="token comment"># 输出: Index(['a', 'b', 'c'], dtype='object')</span>

<span class="token comment"># 创建一个DataFrame</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token string">'Charlie'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>index<span class="token punctuation">)</span>  <span class="token comment"># 输出: Index(['one', 'two', 'three'], dtype='object')</span>
</code></pre> </li></ul> 
<p><strong>标签（Label）：</strong></p> 
<ul><li> <p>定义：在Pandas中，"标签"通常是指数据的具体标识符或名称，用于访问<code>Series</code>或<code>DataFrame</code>中的特定数据。</p> </li><li> <p>功能：</p> 
  <ul><li>数据访问：通过标签可以直接访问<code>Series</code>或<code>DataFrame</code>中的数据。例如，通过标签获取特定的行或列。</li><li>行列操作：标签用于进行行和列的操作，比如选择特定的行或列，或对行列进行重命名等。</li></ul> </li><li> <p>示例：</p> <pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 创建一个Series</span>
s <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 输出: 10</span>

<span class="token comment"># 创建一个DataFrame</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token string">'Charlie'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 输出: name    Alice\nage        25\nName: one, dtype: object</span>
</code></pre> </li></ul> 
<p><strong>区别与联系：</strong></p> 
<ol><li> <p>相似性：</p> 
  <ul><li>索引和标签都是用来标识数据的，索引是Pandas的核心结构之一，标签是索引的一种具体应用。</li><li>标签是索引的一部分：在<code>Series</code>中，标签通常指的是索引的具体值，用于访问数据。</li></ul> </li><li> <p>区别：</p> 
  <ul><li>范围：索引是一种广泛的概念，涉及行索引和列索引，而标签更具体，通常指单个索引值。</li><li>用途：索引用于整体的标识和数据对齐，而标签更多用于数据的实际访问和操作。</li></ul> </li></ol> 
<h2><a id="_296"></a>四、常用方法</h2> 
<p><font color="green"><strong>有很多方法在前面Series和DataFrame的方法表格里面，包括数据的打印预览、索引设置、统计性信息等等，都很常用，这里不重复介绍了。</strong></font></p> 
<h3><a id="41__299"></a>4.1 数据读取和写入</h3> 
<p>Pandas支持多种数据格式的读取和写入，包括CSV、Excel、Txt、SQL数据库、JSON、HDF5等。</p> 
<h4><a id="411_CSV_302"></a>4.11 🟢CSV文件</h4> 
<p><strong>也适用于<code>.txt</code>文件。</strong></p> 
<p>读取：<br> 默认将第一行作为列名即列标签，如果本来有列名，又指定了列名，则会把原来的列名当成第一行数据。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 从CSV文件读取数据</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'file_path.csv'</span><span class="token punctuation">)</span>

<span class="token comment"># 指定分隔符</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'file_path.csv'</span><span class="token punctuation">,</span> delimiter<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">)</span>

<span class="token comment"># 指定列名</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'file_path.csv'</span><span class="token punctuation">,</span> names<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'col1'</span><span class="token punctuation">,</span> <span class="token string">'col2'</span><span class="token punctuation">,</span> <span class="token string">'col3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 指定编码（如果出错）：utf-8,ISO-8859-1,latin1,cp1252</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'file_path.csv'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

<span class="token comment"># 读取特定列,可以是列索引，也可以是列标签</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'file_path.csv'</span><span class="token punctuation">,</span> usecols<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'col1'</span><span class="token punctuation">,</span> <span class="token string">'col2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 将特定列作为索引，可以是列索引，也可以是列标签</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'file_path.csv'</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token string">'A1'</span><span class="token punctuation">)</span>

<span class="token comment"># 将某一列转换为整数</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'file_path.csv'</span><span class="token punctuation">,</span> converters<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'column_name'</span><span class="token punctuation">:</span> to_int<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>参数，只有文件名是必选。</p> 
<table><thead><tr><th>参数名</th><th>类型</th><th>默认值</th><th>描述</th></tr></thead><tbody><tr><td><code>filepath_or_buffer</code></td><td>str, path-like, file-like</td><td>None</td><td>读取的CSV文件路径或文件对象。</td></tr><tr><td><code>sep</code></td><td>str</td><td>‘,’</td><td>分隔符，用于分隔文件中的字段。</td></tr><tr><td><code>delimiter</code></td><td>str</td><td>None</td><td>与 <code>sep</code> 相同，指定字段的分隔符。</td></tr><tr><td><code>header</code></td><td>int, list of int, None</td><td>‘infer’</td><td>用于指定行号作为列名。如果为None，则默认读取第一行作为列名。</td></tr><tr><td><code>names</code></td><td>array-like</td><td>None</td><td>指定列名。如果提供了 <code>header</code> 参数为None，则使用这些列名。</td></tr><tr><td><code>index_col</code></td><td>int, str, sequence of int/str</td><td>None</td><td>用作索引的列编号或列名。</td></tr><tr><td><code>usecols</code></td><td>list-like, callable</td><td>None</td><td>读取的列。可以是列的编号、名称或一个函数。</td></tr><tr><td><code>dtype</code></td><td>Type name or dict of column -&gt; type</td><td>None</td><td>数据类型，用于转换数据。</td></tr><tr><td><code>engine</code></td><td>{‘c’, ‘python’}</td><td>‘c’</td><td>CSV解析器引擎。<code>c</code> 是C语言引擎，<code>python</code> 是Python引擎。</td></tr><tr><td><code>skiprows</code></td><td>int, list-like</td><td>None</td><td>跳过的行数或行号列表。</td></tr><tr><td><code>skipfooter</code></td><td>int</td><td>0</td><td>文件末尾跳过的行数。</td></tr><tr><td><code>nrows</code></td><td>int</td><td>None</td><td>读取的行数。</td></tr><tr><td><code>na_values</code></td><td>scalar, str, list-like, dict</td><td>None</td><td>指定缺失值的标记。</td></tr><tr><td><code>keep_default_na</code></td><td>bool</td><td>True</td><td>是否保留缺失值标记。</td></tr><tr><td><code>converters</code></td><td>dict</td><td>None</td><td>列转换函数字典。</td></tr><tr><td><code>parse_dates</code></td><td>bool, list, dict</td><td>False</td><td>解析日期列。</td></tr><tr><td><code>date_parser</code></td><td>function</td><td>None</td><td>自定义日期解析函数。</td></tr><tr><td><code>thousands</code></td><td>str</td><td>None</td><td>数字中的千分位分隔符。</td></tr><tr><td><code>comment</code></td><td>str</td><td>None</td><td>用于指定注释的开始字符。</td></tr><tr><td><code>encoding</code></td><td>str</td><td>None</td><td>文件的编码格式。</td></tr><tr><td><code>encoding_errors</code></td><td>str</td><td>‘strict’</td><td>编码错误处理策略。</td></tr><tr><td><code>quotechar</code></td><td>str</td><td>‘"’</td><td>字符串引用字符。</td></tr><tr><td><code>quoting</code></td><td>int</td><td>0</td><td>控制字段的引用方式。</td></tr><tr><td><code>doublequote</code></td><td>bool</td><td>True</td><td>是否使用双引号来表示包含双引号的字段。</td></tr><tr><td><code>escapechar</code></td><td>str</td><td>None</td><td>转义字符。</td></tr><tr><td><code>line_terminator</code></td><td>str</td><td>None</td><td>行终止符。</td></tr><tr><td><code>skipinitialspace</code></td><td>bool</td><td>False</td><td>是否跳过字段值中的初始空格。</td></tr><tr><td><code>skip_blank_lines</code></td><td>bool</td><td>True</td><td>是否跳过空白行。</td></tr><tr><td><code>mangle_dupe_cols</code></td><td>bool</td><td>True</td><td>是否处理重复列名。</td></tr><tr><td><code>storage_options</code></td><td>dict</td><td>None</td><td>存储选项，用于文件系统或其他外部存储。</td></tr></tbody></table> 
<p>写入：</p> 
<pre><code class="prism language-python"><span class="token comment"># 写入到CSV文件</span>
df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'file_path.csv'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token comment"># 包含索引</span>
df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'file_path_with_index.csv'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># 不写入列名</span>
df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'file_path_without_header.csv'</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre> 
<table><thead><tr><th>参数名</th><th>类型</th><th>默认值</th><th>描述</th></tr></thead><tbody><tr><td><code>path_or_buf</code></td><td>str, path-like, file-like</td><td>None</td><td>要保存的目标路径或文件对象。如果为 <code>None</code>，则返回字符串。</td></tr><tr><td><code>sep</code></td><td>str</td><td>‘,’</td><td>字段分隔符，用于分隔文件中的字段。</td></tr><tr><td><code>na_rep</code></td><td>str</td><td>‘’</td><td>替换缺失值的字符串。</td></tr><tr><td><code>float_format</code></td><td>str</td><td>None</td><td>浮点数的格式字符串。</td></tr><tr><td><code>columns</code></td><td>sequence, optional</td><td>None</td><td>指定要写入文件的列。如果为 <code>None</code>，则写入所有列。</td></tr><tr><td><code>header</code></td><td>bool, list of str</td><td>True</td><td>是否写入列名。如果为布尔值，表示是否写入列名。如果为列表，指定列名。</td></tr><tr><td><code>index</code></td><td>bool</td><td>True</td><td>是否写入行索引。</td></tr><tr><td><code>index_label</code></td><td>str, sequence, or None</td><td>None</td><td>行索引的标签。</td></tr><tr><td><code>mode</code></td><td>str</td><td>‘w’</td><td>文件打开模式。</td></tr><tr><td><code>encoding</code></td><td>str</td><td>None</td><td>文件的编码格式。</td></tr><tr><td><code>compression</code></td><td>{‘infer’, ‘bz2’, ‘gzip’, ‘xz’, ‘zip’, None}</td><td>None</td><td>文件压缩格式。</td></tr><tr><td><code>quotechar</code></td><td>str</td><td>‘"’</td><td>字符串引用字符。</td></tr><tr><td><code>quoting</code></td><td>int</td><td>0</td><td>控制字段的引用方式。</td></tr><tr><td><code>line_terminator</code></td><td>str</td><td>None</td><td>行终止符。</td></tr><tr><td><code>chunksize</code></td><td>int</td><td>None</td><td>分块大小。如果指定，数据将被分块写入。</td></tr><tr><td><code>date_format</code></td><td>str</td><td>None</td><td>日期格式。</td></tr><tr><td><code>doublequote</code></td><td>bool</td><td>True</td><td>是否使用双引号来表示包含双引号的字段。</td></tr><tr><td><code>escapechar</code></td><td>str</td><td>None</td><td>转义字符。</td></tr><tr><td><code>errors</code></td><td>str</td><td>‘strict’</td><td>错误处理策略。</td></tr><tr><td><code>storage_options</code></td><td>dict</td><td>None</td><td>存储选项，用于文件系统或其他外部存储。</td></tr></tbody></table> 
<h4><a id="412Excel_407"></a>4.12🟢Excel文件</h4> 
<p>读取：</p> 
<pre><code class="prism language-python"><span class="token comment"># 从Excel文件读取数据</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">'file_path.xlsx'</span><span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">'Sheet1'</span><span class="token punctuation">)</span>

<span class="token comment"># 读取多个表单</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">'file_path.xlsx'</span><span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Sheet1'</span><span class="token punctuation">,</span> <span class="token string">'Sheet2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 读取特定列</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">'file_path.xlsx'</span><span class="token punctuation">,</span> usecols<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'col1'</span><span class="token punctuation">,</span> <span class="token string">'col2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 读取特定行</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">'file_path.xlsx'</span><span class="token punctuation">,</span> skiprows<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>

</code></pre> 
<table><thead><tr><th>参数名</th><th>类型</th><th>默认值</th><th>描述</th></tr></thead><tbody><tr><td><code>io</code></td><td>str, path-like, file-like</td><td>None</td><td>要读取的Excel文件路径或文件对象。</td></tr><tr><td><code>sheet_name</code></td><td>str, int, list, None</td><td>0</td><td>要读取的工作表名或索引，<code>None</code> 读取所有工作表。</td></tr><tr><td><code>header</code></td><td>int, list of int, None</td><td>0</td><td>用作列名的行号。如果为None，则默认使用第一行作为列名。</td></tr><tr><td><code>names</code></td><td>array-like</td><td>None</td><td>指定列名。如果提供了 <code>header</code> 参数为None，则使用这些列名。</td></tr><tr><td><code>index_col</code></td><td>int, str, sequence of int/str</td><td>None</td><td>用作索引的列编号或列名。</td></tr><tr><td><code>usecols</code></td><td>list-like, callable</td><td>None</td><td>读取的列。可以是列的编号、名称或一个函数。</td></tr><tr><td><code>dtype</code></td><td>Type name or dict of column -&gt; type</td><td>None</td><td>数据类型，用于转换数据。</td></tr><tr><td><code>engine</code></td><td>{‘xlrd’, ‘openpyxl’, ‘odf’, ‘pyxlsb’}</td><td>None</td><td>Excel解析器引擎。选择用于读取Excel文件的引擎。</td></tr><tr><td><code>converters</code></td><td>dict</td><td>None</td><td>列转换函数字典。</td></tr><tr><td><code>parse_dates</code></td><td>bool, list, dict</td><td>False</td><td>解析日期列。</td></tr><tr><td><code>date_parser</code></td><td>function</td><td>None</td><td>自定义日期解析函数。</td></tr><tr><td><code>thousands</code></td><td>str</td><td>None</td><td>数字中的千分位分隔符。</td></tr><tr><td><code>skiprows</code></td><td>int, list-like</td><td>None</td><td>跳过的行数或行号列表。</td></tr><tr><td><code>skipfooter</code></td><td>int</td><td>0</td><td>文件末尾跳过的行数。</td></tr><tr><td><code>nrows</code></td><td>int</td><td>None</td><td>读取的行数。</td></tr><tr><td><code>na_values</code></td><td>scalar, str, list-like, dict</td><td>None</td><td>指定缺失值的标记。</td></tr><tr><td><code>keep_default_na</code></td><td>bool</td><td>True</td><td>是否保留缺失值标记。</td></tr><tr><td><code>convert_float</code></td><td>bool</td><td>True</td><td>是否将浮点数转换为float类型。</td></tr><tr><td><code>json_normalize</code></td><td>bool</td><td>False</td><td>是否将嵌套JSON数据展平。</td></tr><tr><td><code>storage_options</code></td><td>dict</td><td>None</td><td>存储选项，用于文件系统或其他外部存储。</td></tr></tbody></table> 
<p>写入：</p> 
<pre><code class="prism language-python"><span class="token comment"># 写入到Excel文件</span>
df<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span><span class="token string">'file_path.xlsx'</span><span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">'Sheet1'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token comment"># 写入多个表单</span>
<span class="token keyword">with</span> pd<span class="token punctuation">.</span>ExcelWriter<span class="token punctuation">(</span><span class="token string">'file_path.xlsx'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> writer<span class="token punctuation">:</span>
    df1<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>writer<span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">'Sheet1'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    df2<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>writer<span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">'Sheet2'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

</code></pre> 
<table><thead><tr><th>参数名</th><th>类型</th><th>默认值</th><th>描述</th></tr></thead><tbody><tr><td><code>excel_writer</code></td><td>str, ExcelWriter</td><td>None</td><td>Excel文件路径或 <code>ExcelWriter</code> 对象，用于保存文件。</td></tr><tr><td><code>sheet_name</code></td><td>str</td><td>‘Sheet1’</td><td>要写入的工作表名称。</td></tr><tr><td><code>na_rep</code></td><td>str</td><td>‘’</td><td>替换缺失值的字符串。</td></tr><tr><td><code>float_format</code></td><td>str</td><td>None</td><td>浮点数的格式字符串。</td></tr><tr><td><code>columns</code></td><td>sequence, optional</td><td>None</td><td>指定要写入文件的列。如果为 <code>None</code>，则写入所有列。</td></tr><tr><td><code>header</code></td><td>bool, list of str</td><td>True</td><td>是否写入列名。如果为布尔值，表示是否写入列名。如果为列表，指定列名。</td></tr><tr><td><code>index</code></td><td>bool</td><td>True</td><td>是否写入行索引。</td></tr><tr><td><code>index_label</code></td><td>str, sequence, or None</td><td>None</td><td>行索引的标签。</td></tr><tr><td><code>startrow</code></td><td>int</td><td>0</td><td>写入数据的起始行。</td></tr><tr><td><code>startcol</code></td><td>int</td><td>0</td><td>写入数据的起始列。</td></tr><tr><td><code>engine</code></td><td>{‘xlsxwriter’, ‘openpyxl’, ‘odf’, ‘xlwt’}</td><td>None</td><td>Excel写入引擎。选择用于写入Excel文件的引擎。</td></tr><tr><td><code>merge_cells</code></td><td>bool</td><td>True</td><td>是否合并单元格。</td></tr><tr><td><code>encoding</code></td><td>str</td><td>None</td><td>文件的编码格式。</td></tr><tr><td><code>date_format</code></td><td>str</td><td>None</td><td>日期格式。</td></tr><tr><td><code>datetime_format</code></td><td>str</td><td>None</td><td><code>datetime</code> 对象的格式。</td></tr><tr><td><code>sheet_name</code></td><td>str</td><td>‘Sheet1’</td><td>要写入的工作表名称。</td></tr><tr><td><code>engine</code></td><td>{‘xlsxwriter’, ‘openpyxl’, ‘odf’, ‘xlwt’}</td><td>None</td><td>Excel写入引擎。选择用于写入Excel文件的引擎。</td></tr><tr><td><code>options</code></td><td>dict</td><td>None</td><td>存储选项，用于文件系统或其他外部存储。</td></tr></tbody></table> 
<h4><a id="413__484"></a>4.13 其它文件</h4> 
<p>（1）SQL数据库</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sqlalchemy <span class="token keyword">import</span> create_engine

<span class="token comment"># 创建数据库连接</span>
engine <span class="token operator">=</span> create_engine<span class="token punctuation">(</span><span class="token string">'sqlite:///database.db'</span><span class="token punctuation">)</span>

<span class="token comment"># 从SQL数据库读取数据</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span><span class="token string">'SELECT * FROM table_name'</span><span class="token punctuation">,</span> con<span class="token operator">=</span>engine<span class="token punctuation">)</span>

<span class="token comment"># 读取指定列</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span><span class="token string">'SELECT col1, col2 FROM table_name'</span><span class="token punctuation">,</span> con<span class="token operator">=</span>engine<span class="token punctuation">)</span>

<span class="token comment"># 将DataFrame写入SQL数据库</span>
df<span class="token punctuation">.</span>to_sql<span class="token punctuation">(</span><span class="token string">'table_name'</span><span class="token punctuation">,</span> con<span class="token operator">=</span>engine<span class="token punctuation">,</span> if_exists<span class="token operator">=</span><span class="token string">'replace'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token comment"># if_exists参数：</span>
<span class="token comment"># 'fail' - 如果表存在，则抛出ValueError</span>
<span class="token comment"># 'replace' - 如果表存在，删除表后写入</span>
<span class="token comment"># 'append' - 如果表存在，数据追加到表中</span>
</code></pre> 
<p>（2）JSON</p> 
<pre><code class="prism language-python"><span class="token comment"># 从JSON文件读取数据</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_json<span class="token punctuation">(</span><span class="token string">'file_path.json'</span><span class="token punctuation">)</span>

<span class="token comment"># 读取JSON文件的特定部分</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_json<span class="token punctuation">(</span><span class="token string">'file_path.json'</span><span class="token punctuation">,</span> orient<span class="token operator">=</span><span class="token string">'records'</span><span class="token punctuation">)</span>

<span class="token comment"># 写入到JSON文件</span>
df<span class="token punctuation">.</span>to_json<span class="token punctuation">(</span><span class="token string">'file_path.json'</span><span class="token punctuation">,</span> orient<span class="token operator">=</span><span class="token string">'records'</span><span class="token punctuation">,</span> lines<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># orient参数：</span>
<span class="token comment"># 'split' - 分割格式</span>
<span class="token comment"># 'records' - 记录格式</span>
<span class="token comment"># 'index' - 索引格式</span>
<span class="token comment"># 'columns' - 列格式</span>
<span class="token comment"># 'values' - 值格式</span>
</code></pre> 
<p>还有好多其它格式，不展开了。</p> 
<h3><a id="42__532"></a>4.2 字符串处理</h3> 
<p>在 <code>pandas</code> 中，字符串处理可以通过 <code>Series</code> 对象的 <code>.str</code> 属性来进行。这个属性提供了一系列用于处理字符串的方便方法。</p> 
<table><thead><tr><th>方法名</th><th>描述</th><th>示例代码</th></tr></thead><tbody><tr><td><code>str.lower()</code></td><td>将字符串转换为小写字母。</td><td><code>df['col'].str.lower()</code></td></tr><tr><td><code>str.upper()</code></td><td>将字符串转换为大写字母。</td><td><code>df['col'].str.upper()</code></td></tr><tr><td><code>str.title()</code></td><td>将字符串的每个单词首字母大写。</td><td><code>df['col'].str.title()</code></td></tr><tr><td><code>str.capitalize()</code></td><td>将字符串的首字母大写，其余字母小写。</td><td><code>df['col'].str.capitalize()</code></td></tr><tr><td><code>str.strip()</code></td><td>去除字符串两端的空白字符。</td><td><code>df['col'].str.strip()</code></td></tr><tr><td><code>str.lstrip()</code></td><td>去除字符串左侧的空白字符。</td><td><code>df['col'].str.lstrip()</code></td></tr><tr><td><code>str.rstrip()</code></td><td>去除字符串右侧的空白字符。</td><td><code>df['col'].str.rstrip()</code></td></tr><tr><td><code>str.replace()</code></td><td>替换字符串中的指定子字符串。</td><td><code>df['col'].str.replace('old', 'new')</code></td></tr><tr><td><code>str.find()</code></td><td>查找子字符串的位置，如果不存在则返回 -1。</td><td><code>df['col'].str.find('substring')</code></td></tr><tr><td><code>str.contains()</code></td><td>检查字符串中是否包含指定的子字符串。</td><td><code>df['col'].str.contains('substring')</code></td></tr><tr><td><code>str.startswith()</code></td><td>检查字符串是否以指定子字符串开头。</td><td><code>df['col'].str.startswith('prefix')</code></td></tr><tr><td><code>str.endswith()</code></td><td>检查字符串是否以指定子字符串结尾。</td><td><code>df['col'].str.endswith('suffix')</code></td></tr><tr><td><code>str.split()</code></td><td>根据指定的分隔符拆分字符串，返回一个列表。</td><td><code>df['col'].str.split(',')</code></td></tr><tr><td><code>str.join()</code></td><td>将列表中的字符串用指定分隔符连接成一个字符串。</td><td><code>df['col'].str.join(',')</code></td></tr><tr><td><code>str.extract()</code></td><td>使用正则表达式提取匹配的子字符串。</td><td><code>df['col'].str.extract(r'(\d+)')</code></td></tr><tr><td><code>str.findall()</code></td><td>使用正则表达式查找所有匹配的子字符串。</td><td><code>df['col'].str.findall(r'\d+')</code></td></tr><tr><td><code>str.zfill()</code></td><td>在字符串的左侧填充零，使其达到指定的宽度。</td><td><code>df['col'].str.zfill(5)</code></td></tr><tr><td><code>str.isalpha()</code></td><td>检查字符串是否仅包含字母。</td><td><code>df['col'].str.isalpha()</code></td></tr><tr><td><code>str.isdigit()</code></td><td>检查字符串是否仅包含数字。</td><td><code>df['col'].str.isdigit()</code></td></tr><tr><td><code>str.isnumeric()</code></td><td>检查字符串是否仅包含数字字符。</td><td><code>df['col'].str.isnumeric()</code></td></tr><tr><td><code>str.islower()</code></td><td>检查字符串是否仅包含小写字母。</td><td><code>df['col'].str.islower()</code></td></tr><tr><td><code>str.isupper()</code></td><td>检查字符串是否仅包含大写字母。</td><td><code>df['col'].str.isupper()</code></td></tr></tbody></table> 
<h3><a id="43__562"></a>4.3 表格拼接</h3> 
<p>在 <code>pandas</code> 中，表格拼接主要通过以下方法实现：</p> 
<blockquote> 
 <ol><li><strong><code>concat</code></strong>：用于沿指定轴（行或列）将多个 DataFrame 连接在一起。</li><li><strong><code>append</code></strong>：用于将一个 DataFrame 添加到另一个 DataFrame 的末尾，实际上是 <code>concat</code> 的一种快捷方式。</li><li><strong><code>merge</code></strong>：用于通过一个或多个键将两个 DataFrame 进行连接，类似于 SQL 中的 JOIN 操作。</li><li><strong><code>join</code></strong>：用于将两个 DataFrame 进行基于索引的连接，类似于 <code>merge</code>，但通常用于基于索引的连接。</li></ol> 
</blockquote> 
<p>是Series、DataFrame之间拼接，不能直接把列表这些和它们拼接。</p> 
<pre><code class="prism language-python">add <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token string">'Ha'</span><span class="token punctuation">,</span> <span class="token string">'Nice'</span><span class="token punctuation">]</span>
df<span class="token punctuation">[</span><span class="token string">'A4'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>add<span class="token punctuation">)</span>
</code></pre> 
<p>🟢<strong>concat：</strong></p> 
<p><code>concat</code> 方法用于沿指定轴将多个 DataFrame 合并在一起，可以处理不同的轴和连接方式（如外连接、内连接）。</p> 
<p>主要参数：</p> 
<table><thead><tr><th>参数名</th><th>类型</th><th>默认值</th><th>描述</th></tr></thead><tbody><tr><td><code>objs</code></td><td>list of DataFrame</td><td>None</td><td>要拼接的 DataFrame 对象列表。</td></tr><tr><td><code>axis</code></td><td>int</td><td>0</td><td>指定拼接的轴，<code>0</code> 为行方向（增加行数），<code>1</code> 为列方向（增加列数）。</td></tr><tr><td><code>join</code></td><td>{‘inner’, ‘outer’}</td><td>‘outer’</td><td>指定连接方式，<code>'inner'</code> 表示内连接，<code>'outer'</code> 表示外连接。</td></tr><tr><td><code>ignore_index</code></td><td>bool</td><td>False</td><td>是否忽略原有的行索引，重新生成新的行索引。</td></tr><tr><td><code>keys</code></td><td>list</td><td>None</td><td>生成层次化索引的键。</td></tr></tbody></table> 
<p>示例：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 创建示例 DataFrame</span>
df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'A'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'A0'</span><span class="token punctuation">,</span> <span class="token string">'A1'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'B0'</span><span class="token punctuation">,</span> <span class="token string">'B1'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'A'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'A2'</span><span class="token punctuation">,</span> <span class="token string">'A3'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'B2'</span><span class="token punctuation">,</span> <span class="token string">'B3'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment"># 沿行方向拼接</span>
result <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df1<span class="token punctuation">,</span> df2<span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> ignore_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre> 
<p>输出：</p> 
<pre><code class="prism language-bash">    A   B
<span class="token number">0</span>  A0  B0
<span class="token number">1</span>  A1  B1
<span class="token number">2</span>  A2  B2
<span class="token number">3</span>  A3  B3
</code></pre> 
<p>🟢<strong>append：</strong></p> 
<p><code>append</code> 方法用于将一个 DataFrame 追加到另一个 DataFrame 的末尾。它是 <code>concat</code> 的简化版本，主要用于行拼接（增加行数）。</p> 
<p>示例：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 创建示例 DataFrame</span>
df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'A'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'A0'</span><span class="token punctuation">,</span> <span class="token string">'A1'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'B0'</span><span class="token punctuation">,</span> <span class="token string">'B1'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'A'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'A2'</span><span class="token punctuation">,</span> <span class="token string">'A3'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'B2'</span><span class="token punctuation">,</span> <span class="token string">'B3'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment"># 追加 df2 到 df1</span>
result <span class="token operator">=</span> df1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>df2<span class="token punctuation">,</span> ignore_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre> 
<p>输出：</p> 
<pre><code class="prism language-bash">    A   B
<span class="token number">0</span>  A0  B0
<span class="token number">1</span>  A1  B1
<span class="token number">2</span>  A2  B2
<span class="token number">3</span>  A3  B3
</code></pre> 
<p>🟢<strong>merge：</strong></p> 
<p><code>merge</code> 用于通过一个或多个键将两个 DataFrame 进行连接，支持多种合并方式，包括内连接、外连接、左连接和右连接。</p> 
<p>主要参数：</p> 
<table><thead><tr><th>参数名</th><th>类型</th><th>默认值</th><th>描述</th></tr></thead><tbody><tr><td><code>left</code></td><td>DataFrame</td><td>None</td><td>左侧 DataFrame。</td></tr><tr><td><code>right</code></td><td>DataFrame</td><td>None</td><td>右侧 DataFrame。</td></tr><tr><td><code>how</code></td><td>{‘left’, ‘right’, ‘outer’, ‘inner’}</td><td>‘inner’</td><td>合并方式：<code>'left'</code>、<code>'right'</code>、<code>'outer'</code>、<code>'inner'</code>。</td></tr><tr><td><code>on</code></td><td>str, list of str</td><td>None</td><td>用于合并的列名。如果列名不同，可以使用 <code>left_on</code> 和 <code>right_on</code> 参数。</td></tr><tr><td><code>left_on</code></td><td>str, list of str</td><td>None</td><td>左侧 DataFrame 中用于合并的列名。</td></tr><tr><td><code>right_on</code></td><td>str, list of str</td><td>None</td><td>右侧 DataFrame 中用于合并的列名。</td></tr><tr><td><code>left_index</code></td><td>bool</td><td>False</td><td>是否使用左侧 DataFrame 的索引进行合并。</td></tr><tr><td><code>right_index</code></td><td>bool</td><td>False</td><td>是否使用右侧 DataFrame 的索引进行合并。</td></tr></tbody></table> 
<p>示例代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 创建示例 DataFrame</span>
df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'key'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'value1'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'key'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token string">'D'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'value2'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment"># 内连接</span>
result <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df1<span class="token punctuation">,</span> df2<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'key'</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'inner'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre> 
<p>输出：</p> 
<pre><code class="prism language-bash">  key  value1  value2
<span class="token number">0</span>   B       <span class="token number">2</span>       <span class="token number">4</span>
<span class="token number">1</span>   C       <span class="token number">3</span>       <span class="token number">5</span>
</code></pre> 
<p>🟢<strong>join：</strong></p> 
<p><code>join</code> 方法用于基于索引连接两个 DataFrame，通常用于索引对齐。</p> 
<p>示例代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 创建示例 DataFrame</span>
df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'A'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'B'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 使用 join 基于索引连接</span>
result <span class="token operator">=</span> df1<span class="token punctuation">.</span>join<span class="token punctuation">(</span>df2<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre> 
<p>输出：</p> 
<pre><code class="prism language-bahs">   A    B
a  1  NaN
b  2  4.0
c  3  5.0
</code></pre> 
<h3><a id="44__710"></a>4.4 时间数据处理</h3> 
<p>（1）解析和创建日期时间数据</p> 
<table><thead><tr><th>方法/属性</th><th>主要参数</th><th>描述</th></tr></thead><tbody><tr><td><code>pd.to_datetime</code></td><td><code>arg</code>, <code>format</code>, <code>errors</code></td><td>将日期时间字符串转换为 <code>datetime</code> 对象。</td></tr><tr><td><code>pd.date_range</code></td><td><code>start</code>, <code>end</code>, <code>freq</code>, <code>periods</code></td><td>创建指定频率的日期时间索引。</td></tr></tbody></table> 
<p>（2）日期时间属性访问</p> 
<table><thead><tr><th>方法/属性</th><th>主要参数</th><th>描述</th></tr></thead><tbody><tr><td><code>.dt.year</code></td><td>-</td><td>获取年份</td></tr><tr><td><code>.dt.month</code></td><td>-</td><td>获取月份</td></tr><tr><td><code>.dt.day</code></td><td>-</td><td>获取日期</td></tr><tr><td><code>.dt.hour</code></td><td>-</td><td>获取小时</td></tr><tr><td><code>.dt.minute</code></td><td>-</td><td>获取分钟</td></tr><tr><td><code>.dt.second</code></td><td>-</td><td>获取秒数</td></tr><tr><td><code>.dt.weekday()</code></td><td>-</td><td>获取星期几，0 表示星期一</td></tr><tr><td><code>.dt.strftime()</code></td><td><code>format</code></td><td>按指定格式格式化日期时间对象为字符串。</td></tr></tbody></table> 
<p>（3）时间差和时间计算</p> 
<table><thead><tr><th>方法/属性</th><th>主要参数</th><th>描述</th></tr></thead><tbody><tr><td><code>Timedelta</code></td><td><code>days</code>, <code>hours</code>, <code>minutes</code></td><td>创建时间差对象。</td></tr><tr><td><code>pd.DateOffset</code></td><td><code>days</code>, <code>months</code>, <code>years</code></td><td>创建日期偏移对象，添加或减去时间。</td></tr></tbody></table> 
<p>（4）日期时间索引和重采样</p> 
<table><thead><tr><th>方法/属性</th><th>主要参数</th><th>描述</th></tr></thead><tbody><tr><td><code>pd.date_range</code></td><td><code>start</code>, <code>end</code>, <code>freq</code>, <code>periods</code></td><td>创建日期时间索引。</td></tr><tr><td><code>.resample()</code></td><td><code>rule</code>, <code>how</code></td><td>对时间序列数据进行重采样。</td></tr><tr><td><code>.asfreq()</code></td><td><code>freq</code>, <code>fill_value</code></td><td>设置时间序列的频率，选择填充值。</td></tr></tbody></table> 
<p>（5）日期时间格式化</p> 
<table><thead><tr><th>方法/属性</th><th>主要参数</th><th>描述</th></tr></thead><tbody><tr><td><code>.strftime()</code></td><td><code>format</code></td><td>按指定格式将日期时间对象格式化为字符串。</td></tr></tbody></table> 
<p>（6） 时间窗口操作</p> 
<table><thead><tr><th>方法/属性</th><th>主要参数</th><th>描述</th></tr></thead><tbody><tr><td><code>.rolling()</code></td><td><code>window</code>, <code>min_periods</code></td><td>创建滚动窗口。</td></tr><tr><td><code>.sum()</code></td><td>-</td><td>计算滚动窗口的总和。</td></tr><tr><td><code>.mean()</code></td><td>-</td><td>计算滚动窗口的均值。</td></tr><tr><td><code>.apply()</code></td><td><code>func</code></td><td>对滚动窗口应用自定义函数。</td></tr></tbody></table> 
<p><code>format</code>: 指定格式的字符串。可以包含以下格式符号：</p> 
<table><thead><tr><th>符号</th><th>描述</th><th>示例</th></tr></thead><tbody><tr><td><code>%Y</code></td><td>年（四位数字）</td><td><code>2024</code></td></tr><tr><td><code>%m</code></td><td>月（两位数字）</td><td><code>07</code></td></tr><tr><td><code>%d</code></td><td>日（两位数字）</td><td><code>22</code></td></tr><tr><td><code>%H</code></td><td>小时（24小时制）</td><td><code>10</code></td></tr><tr><td><code>%M</code></td><td>分钟</td><td><code>30</code></td></tr><tr><td><code>%S</code></td><td>秒数</td><td><code>45</code></td></tr><tr><td><code>%f</code></td><td>微秒</td><td><code>123456</code></td></tr><tr><td><code>%a</code></td><td>星期几（缩写）</td><td><code>Mon</code></td></tr><tr><td><code>%A</code></td><td>星期几（全名）</td><td><code>Monday</code></td></tr><tr><td><code>%b</code></td><td>月份（缩写）</td><td><code>Jul</code></td></tr><tr><td><code>%B</code></td><td>月份（全名）</td><td><code>July</code></td></tr></tbody></table> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

ts <span class="token operator">=</span> pd<span class="token punctuation">.</span>Timestamp<span class="token punctuation">(</span><span class="token string">'2024-07-22 10:30:45'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ts<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 2024-07-22</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ts<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%d/%m/%Y'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 22/07/2024</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ts<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%I:%M %p'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 10:30 AM</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dab85cd759ab3d76a615ce4c2657cecf/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">langchain 入门指南 - 让 AI 记住你说过的话</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c0a33944eddad25da76398e35cf0d904/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">PHP SimpleXML</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>