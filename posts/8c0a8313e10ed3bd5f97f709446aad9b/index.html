<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>æ¯•ä¸šè®¾è®¡ åŸºäºå¤§æ•°æ®Bç«™æ•°æ®åˆ†æé¡¹ç›® æƒ…æ„Ÿåˆ†æ - ç¼–ç¨‹å¤§å’–</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/8c0a8313e10ed3bd5f97f709446aad9b/">
  <meta property="og:site_name" content="ç¼–ç¨‹å¤§å’–">
  <meta property="og:title" content="æ¯•ä¸šè®¾è®¡ åŸºäºå¤§æ•°æ®Bç«™æ•°æ®åˆ†æé¡¹ç›® æƒ…æ„Ÿåˆ†æ">
  <meta property="og:description" content="æ–‡ç« ç›®å½• 0 æ•°æ®åˆ†æç›®æ ‡1 Bç«™æ•´ä½“è§†é¢‘æ•°æ®åˆ†æ1.1 æ•°æ®é¢„å¤„ç†1.2 æ•°æ®å¯è§†åŒ–1.3 åˆ†æç»“æœ 2 å•ä¸€è§†é¢‘åˆ†æ2.1 æ•°æ®é¢„å¤„ç†2.2 æ•°æ®æ¸…æ´—2.3 æ•°æ®å¯è§†åŒ– 3 æ–‡æœ¬æŒ–æ˜ï¼ˆNLPï¼‰3.1 æƒ…æ„Ÿåˆ†æ 6 æœ€å 0 æ•°æ®åˆ†æç›®æ ‡ ä»Šå¤©å‘å¤§å®¶ä»‹ç»å¦‚ä½•ä½¿ç”¨å¤§æ•°æ®æŠ€æœ¯ï¼Œå¯¹Bç«™çš„è§†é¢‘æ•°æ®è¿›è¡Œåˆ†æï¼Œå¾—åˆ°å¯è§†åŒ–ç»“æœã€‚
è¿™é‡Œå­¦é•¿åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†æè¿°ï¼š
1 å¯¹Bç«™æ•´ä½“è§†é¢‘è¿›è¡Œæ•°æ®åˆ†æ2 å¯¹Bç«™çš„å…·ä½“è§†é¢‘è¿›è¡Œå¼¹å¹•æƒ…æ„Ÿåˆ†æ ğŸ§¿ é€‰é¢˜æŒ‡å¯¼, é¡¹ç›®åˆ†äº«ï¼šè§æ–‡æœ«
1 Bç«™æ•´ä½“è§†é¢‘æ•°æ®åˆ†æ åˆ†ææ–¹å‘ï¼šé¦–å…ˆä»æ€»ä½“æƒ…å†µè¿›è¡Œåˆ†æï¼Œä¹‹ååˆ†æç»¼åˆæ’åtop100çš„è§†é¢‘ç±»åˆ«ã€‚
æ€»ä½“æƒ…å†µéƒ¨åˆ†åŒ…æ‹¬ï¼š
å„åˆ†åŒºæ’­æ”¾é‡æƒ…å†µã€‚å„åŒºä¸‰è¿ï¼ˆç¡¬å¸ã€æ”¶è—ã€ç‚¹èµï¼‰æƒ…å†µã€‚å¼¹å¹•ã€è¯„è®ºã€è½¬å‘æƒ…å†µã€‚ç»˜åˆ¶ç»¼åˆè¯äº‘å›¾ï¼ŒæŸ¥çœ‹å…³é”®è¯æ±‡ã€‚ ç»¼åˆæ’åtop100éƒ¨åˆ†åŒ…æ‹¬ï¼š
5. top100ç±»åˆ«å æ¯”ã€‚
6. top100æ’­æ”¾é‡æƒ…å†µã€‚
7. ç¡¬å¸ã€æ”¶è—ã€ç‚¹èµå¹³å‡äººæ•°åˆ†å¸ƒã€‚
8. å„åˆ†åŒºå¹³å‡è¯„è®ºã€å¼¹å¹•ã€è½¬å‘é‡æƒ…å†µã€‚
1.1 æ•°æ®é¢„å¤„ç† è¿™é‡Œä¸»è¦æ˜¯è¿›è¡ŒæŸ¥çœ‹æ•°æ®ä¿¡æ¯ã€ç©ºå€¼ã€é‡å¤å€¼ä»¥åŠæ•°æ®ç±»å‹ï¼Œä½†ç”±äºæ•°æ®å¾ˆå®Œæ•´è¿™é‡Œä¸å†åšè¿‡å¤šæ“ä½œã€‚
å¯¹æ•°æ®è¿›è¡Œæ‹†åˆ†ã€èšåˆï¼Œæ–¹ä¾¿ä¹‹åå„é¡¹åˆ†æï¼Œç”±äºâ€œåŒºç±»åˆ«â€åˆ—ä¸­çš„â€œå…¨ç«™â€æ˜¯å„åˆ†ç±»ä¸­æ’åé å‰çš„è§†é¢‘ï¼Œä¼šå‡ºç°é‡å¤æ•°æ®ï¼Œå› æ­¤å¯¹å…¶è¿›è¡Œå»é™¤ã€‚
df.info() df.isnull().count() df.nunique().count() df.dtypes #å‰”é™¤å…¨åŒºæ’å df_nall=df.loc[df[&#39;åŒºç±»åˆ«&#39;]!=&#39;å…¨ç«™&#39;] df_nall[&#39;åŒºç±»åˆ«&#39;].value_counts() #æŒ‰åˆ†æ•°è¿›è¡Œæ’åºasc df_top100 = df_nall.sort_values(by=&#39;åˆ†æ•°&#39;,ascending=False)[:100] df_type = df_nall.drop([&#39;ä½œè€…&#39;,&#39;è§†é¢‘ç¼–å·&#39;,&#39;æ ‡ç­¾åç§°&#39;,&#39;è§†é¢‘åç§°&#39;,&#39;æ’å&#39;],axis=1) gp_type = df_type.groupby(&#39;åŒºç±»åˆ«&#39;).sum().astype(&#39;int&#39;) type_all = gp_type.index.tolist() 1.2 æ•°æ®å¯è§†åŒ– å„åˆ†åŒºæ’­æ”¾æƒ…å†µ
play = [round(i/100000000,2) for i in gp_type[&#39;æ’­æ”¾æ¬¡æ•°&#39;].">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-25T12:19:41+08:00">
    <meta property="article:modified_time" content="2024-06-25T12:19:41+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§å’–" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§å’–</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">æ¯•ä¸šè®¾è®¡ åŸºäºå¤§æ•°æ®Bç«™æ•°æ®åˆ†æé¡¹ç›® æƒ…æ„Ÿåˆ†æ</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>æ–‡ç« ç›®å½•</h4> 
 <ul><li><a href="#0__4" rel="nofollow">0 æ•°æ®åˆ†æç›®æ ‡</a></li><li><a href="#1_B_20" rel="nofollow">1 Bç«™æ•´ä½“è§†é¢‘æ•°æ®åˆ†æ</a></li><li><ul><li><a href="#11__37" rel="nofollow">1.1 æ•°æ®é¢„å¤„ç†</a></li><li><a href="#12__57" rel="nofollow">1.2 æ•°æ®å¯è§†åŒ–</a></li><li><a href="#13__213" rel="nofollow">1.3 åˆ†æç»“æœ</a></li></ul> 
  </li><li><a href="#2__220" rel="nofollow">2 å•ä¸€è§†é¢‘åˆ†æ</a></li><li><ul><li><a href="#21__222" rel="nofollow">2.1 æ•°æ®é¢„å¤„ç†</a></li><li><a href="#22__318" rel="nofollow">2.2 æ•°æ®æ¸…æ´—</a></li><li><a href="#23__462" rel="nofollow">2.3 æ•°æ®å¯è§†åŒ–</a></li></ul> 
  </li><li><a href="#3_NLP_474" rel="nofollow">3 æ–‡æœ¬æŒ–æ˜ï¼ˆNLPï¼‰</a></li><li><ul><li><a href="#31__476" rel="nofollow">3.1 æƒ…æ„Ÿåˆ†æ</a></li></ul> 
  </li><li><a href="#6__657" rel="nofollow">6 æœ€å</a></li></ul> 
</div> 
<p></p> 
<h2><a id="0__4"></a>0 æ•°æ®åˆ†æç›®æ ‡</h2> 
<p>ä»Šå¤©å‘å¤§å®¶ä»‹ç»å¦‚ä½•ä½¿ç”¨å¤§æ•°æ®æŠ€æœ¯ï¼Œå¯¹Bç«™çš„è§†é¢‘æ•°æ®è¿›è¡Œåˆ†æï¼Œå¾—åˆ°å¯è§†åŒ–ç»“æœã€‚</p> 
<p>è¿™é‡Œå­¦é•¿åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†æè¿°ï¼š</p> 
<ul><li>1 å¯¹Bç«™æ•´ä½“è§†é¢‘è¿›è¡Œæ•°æ®åˆ†æ</li><li>2 å¯¹Bç«™çš„å…·ä½“è§†é¢‘è¿›è¡Œå¼¹å¹•æƒ…æ„Ÿåˆ†æ</li></ul> 
<p><img src="https://images2.imgbox.com/d0/cb/kXTsWXUd_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>ğŸ§¿ <strong>é€‰é¢˜æŒ‡å¯¼, é¡¹ç›®åˆ†äº«ï¼šè§æ–‡æœ«</strong></p> 
<br> 
<h2><a id="1_B_20"></a>1 Bç«™æ•´ä½“è§†é¢‘æ•°æ®åˆ†æ</h2> 
<p><strong>åˆ†ææ–¹å‘ï¼šé¦–å…ˆä»æ€»ä½“æƒ…å†µè¿›è¡Œåˆ†æï¼Œä¹‹ååˆ†æç»¼åˆæ’åtop100çš„è§†é¢‘ç±»åˆ«ã€‚</strong></p> 
<p><strong>æ€»ä½“æƒ…å†µéƒ¨åˆ†åŒ…æ‹¬ï¼š</strong></p> 
<ol><li>å„åˆ†åŒºæ’­æ”¾é‡æƒ…å†µã€‚</li><li>å„åŒºä¸‰è¿ï¼ˆç¡¬å¸ã€æ”¶è—ã€ç‚¹èµï¼‰æƒ…å†µã€‚</li><li>å¼¹å¹•ã€è¯„è®ºã€è½¬å‘æƒ…å†µã€‚</li><li>ç»˜åˆ¶ç»¼åˆè¯äº‘å›¾ï¼ŒæŸ¥çœ‹å…³é”®è¯æ±‡ã€‚</li></ol> 
<p><strong>ç»¼åˆæ’åtop100éƒ¨åˆ†åŒ…æ‹¬ï¼š</strong><br> 5. top100ç±»åˆ«å æ¯”ã€‚<br> 6. top100æ’­æ”¾é‡æƒ…å†µã€‚<br> 7. ç¡¬å¸ã€æ”¶è—ã€ç‚¹èµå¹³å‡äººæ•°åˆ†å¸ƒã€‚<br> 8. å„åˆ†åŒºå¹³å‡è¯„è®ºã€å¼¹å¹•ã€è½¬å‘é‡æƒ…å†µã€‚</p> 
<h3><a id="11__37"></a>1.1 æ•°æ®é¢„å¤„ç†</h3> 
<p>è¿™é‡Œä¸»è¦æ˜¯è¿›è¡ŒæŸ¥çœ‹æ•°æ®ä¿¡æ¯ã€ç©ºå€¼ã€é‡å¤å€¼ä»¥åŠæ•°æ®ç±»å‹ï¼Œä½†ç”±äºæ•°æ®å¾ˆå®Œæ•´è¿™é‡Œä¸å†åšè¿‡å¤šæ“ä½œã€‚</p> 
<p>å¯¹æ•°æ®è¿›è¡Œæ‹†åˆ†ã€èšåˆï¼Œæ–¹ä¾¿ä¹‹åå„é¡¹åˆ†æï¼Œç”±äºâ€œåŒºç±»åˆ«â€åˆ—ä¸­çš„â€œå…¨ç«™â€æ˜¯å„åˆ†ç±»ä¸­æ’åé å‰çš„è§†é¢‘ï¼Œä¼šå‡ºç°é‡å¤æ•°æ®ï¼Œå› æ­¤å¯¹å…¶è¿›è¡Œå»é™¤ã€‚</p> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>dtypes
<span class="token comment">#å‰”é™¤å…¨åŒºæ’å</span>
df_nall<span class="token operator">=</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'åŒºç±»åˆ«'</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token string">'å…¨ç«™'</span><span class="token punctuation">]</span>
df_nall<span class="token punctuation">[</span><span class="token string">'åŒºç±»åˆ«'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">#æŒ‰åˆ†æ•°è¿›è¡Œæ’åºasc</span>
df_top100 <span class="token operator">=</span> df_nall<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'åˆ†æ•°'</span><span class="token punctuation">,</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">]</span>
df_type <span class="token operator">=</span> df_nall<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'ä½œè€…'</span><span class="token punctuation">,</span><span class="token string">'è§†é¢‘ç¼–å·'</span><span class="token punctuation">,</span><span class="token string">'æ ‡ç­¾åç§°'</span><span class="token punctuation">,</span><span class="token string">'è§†é¢‘åç§°'</span><span class="token punctuation">,</span><span class="token string">'æ’å'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
gp_type <span class="token operator">=</span> df_type<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'åŒºç±»åˆ«'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'int'</span><span class="token punctuation">)</span>
type_all <span class="token operator">=</span> gp_type<span class="token punctuation">.</span>index<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="12__57"></a>1.2 æ•°æ®å¯è§†åŒ–</h3> 
<p><strong>å„åˆ†åŒºæ’­æ”¾æƒ…å†µ</strong></p> 
<pre><code class="prism language-python">play <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">round</span><span class="token punctuation">(</span>i<span class="token operator">/</span><span class="token number">100000000</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> gp_type<span class="token punctuation">[</span><span class="token string">'æ’­æ”¾æ¬¡æ•°'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment"># bar = (Bar()</span>
<span class="token comment">#             .add_xaxis(type_all)</span>
<span class="token comment">#             .add_yaxis("", play)</span>
<span class="token comment">#             .set_global_opts(</span>
<span class="token comment">#             title_opts=opts.TitleOpts(title="å„åˆ†åŒºæ’­æ”¾é‡æƒ…å†µ"),</span>
<span class="token comment">#             yaxis_opts=opts.AxisOpts(name="æ¬¡/äº¿"),</span>
<span class="token comment">#             xaxis_opts=opts.AxisOpts(name="åˆ†åŒº",axislabel_opts={"rotate":45})</span>
<span class="token comment">#         )</span>
<span class="token comment">#     )</span>
<span class="token comment"># bar.render_notebook()</span>

pie <span class="token operator">=</span> <span class="token punctuation">(</span>
    Pie<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>add<span class="token punctuation">(</span>
        <span class="token string">""</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token builtin">list</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span> <span class="token keyword">for</span> z <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>type_all<span class="token punctuation">,</span> 
                              play<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        radius<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"40%"</span><span class="token punctuation">,</span> <span class="token string">"75%"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
        title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"å„åˆ†åŒºæ’­æ”¾é‡æƒ…å†µ  å•ä½ï¼šäº¿æ¬¡"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        legend_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LegendOpts<span class="token punctuation">(</span>
            orient<span class="token operator">=</span><span class="token string">"vertical"</span><span class="token punctuation">,</span> pos_top<span class="token operator">=</span><span class="token string">"15%"</span><span class="token punctuation">,</span> pos_left<span class="token operator">=</span><span class="token string">"2%"</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    <span class="token punctuation">.</span>set_series_opts<span class="token punctuation">(</span>label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>formatter<span class="token operator">=</span><span class="token string">"{b}: {c}"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
pie<span class="token punctuation">.</span>render_notebook<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/9c/36/eVuD1bFP_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> æ’­æ”¾é‡æ’åå‰ä¸‰çš„åˆ†åˆ«æ˜¯ç”Ÿæ´»ç±»ã€åŠ¨ç”»ç±»ã€é¬¼ç•œç±»ã€‚å…¶ä¸­åŠ¨ç”»ç±»å’Œé¬¼ç•œç±»ï¼Œè¿™ä¸¤ä¸ªæ˜¯Bç«™çš„ç‰¹è‰²ã€‚<br> ç¬¬ä¸‰ã€å››ä½æ˜¯éŸ³ä¹ç±»å’Œç§‘æŠ€ç±»ã€‚</p> 
<p><strong>å„åŒºä¸‰è¿é‡æƒ…å†µå¯è§†åŒ–</strong></p> 
<pre><code class="prism language-python">coin_all <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">round</span><span class="token punctuation">(</span>i<span class="token operator">/</span><span class="token number">1000000</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> gp_type<span class="token punctuation">[</span><span class="token string">'ç¡¬å¸æ•°'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
like_all <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">round</span><span class="token punctuation">(</span>i<span class="token operator">/</span><span class="token number">1000000</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> gp_type<span class="token punctuation">[</span><span class="token string">'ç‚¹èµæ•°'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
favourite_all <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">round</span><span class="token punctuation">(</span>i<span class="token operator">/</span><span class="token number">1000000</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> gp_type<span class="token punctuation">[</span><span class="token string">'å–œæ¬¢äººæ•°'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">def</span> <span class="token function">bar_base</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Bar<span class="token punctuation">:</span>
    c <span class="token operator">=</span> <span class="token punctuation">(</span>
        Bar<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span>type_all<span class="token punctuation">)</span>
        <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">"ç¡¬å¸"</span><span class="token punctuation">,</span> coin_all<span class="token punctuation">)</span>
        <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">"ç‚¹èµ"</span><span class="token punctuation">,</span> like_all<span class="token punctuation">)</span>
        <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">"æ”¶è—"</span><span class="token punctuation">,</span> favourite_all<span class="token punctuation">)</span>
        <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"å„åˆ†åŒºä¸‰è¿æƒ…å†µ"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        yaxis_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisOpts<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"æ¬¡/ç™¾ä¸‡"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        xaxis_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisOpts<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"åˆ†åŒº"</span><span class="token punctuation">,</span>
                                                 axislabel_opts<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">"rotate"</span><span class="token punctuation">:</span><span class="token number">45</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">return</span> c
        
bar_base<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>render_notebook<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/25/78/nKRaHApW_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>è™½ç„¶ç”Ÿæ´»ç±»æŠ•å¸å’Œç‚¹èµæ•°ä¾ç„¶æ˜¯ä¸å¯æ’¼åŠ¨çš„ï¼Œä½†æ˜¯æ”¶è—æ•°å´æ’åœ¨åŠ¨ç”»ä¹‹åï¼Œç§‘æŠ€ç±»æ”¶è—å‡è‡³ç¬¬å››ä½ã€‚</p> 
<p><strong>å¼¹å¹•ã€è¯„è®ºã€ä¸‰è”æƒ…å†µ</strong></p> 
<pre><code class="prism language-python">danmaku_all <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">round</span><span class="token punctuation">(</span>i<span class="token operator">/</span><span class="token number">100000</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> gp_type<span class="token punctuation">[</span><span class="token string">'å¼¹å¹•æ•°'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
reply_all <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">round</span><span class="token punctuation">(</span>i<span class="token operator">/</span><span class="token number">100000</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> gp_type<span class="token punctuation">[</span><span class="token string">'è¯„è®ºæ•°'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
share_all <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">round</span><span class="token punctuation">(</span>i<span class="token operator">/</span><span class="token number">100000</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> gp_type<span class="token punctuation">[</span><span class="token string">'è½¬å‘æ•°'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

line <span class="token operator">=</span> <span class="token punctuation">(</span>
        Line<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>add_xaxis<span class="token punctuation">(</span>type_all<span class="token punctuation">)</span>
        <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">"å¼¹å¹•"</span><span class="token punctuation">,</span> danmaku_all<span class="token punctuation">,</span>label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>is_show<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">"è¯„è®º"</span><span class="token punctuation">,</span> reply_all<span class="token punctuation">,</span>label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>is_show<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>add_yaxis<span class="token punctuation">(</span><span class="token string">"è½¬å‘"</span><span class="token punctuation">,</span> share_all<span class="token punctuation">,</span>label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>is_show<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>
            title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"å¼¹å¹•ã€è¯„è®ºã€è½¬å‘æƒ…å†µ"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            tooltip_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TooltipOpts<span class="token punctuation">(</span>trigger<span class="token operator">=</span><span class="token string">"axis"</span><span class="token punctuation">,</span> axis_pointer_type<span class="token operator">=</span><span class="token string">"cross"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            yaxis_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisOpts<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"äººæ•° å•ä½ï¼šåä¸‡"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            xaxis_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>AxisOpts<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"æ—¶é—´(æ—¥)"</span><span class="token punctuation">,</span>axislabel_opts<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">"rotate"</span><span class="token punctuation">:</span><span class="token number">45</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
line<span class="token punctuation">.</span>render_notebook<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/65/a5/RtGf0Y0Z_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><strong>Bç«™æœç´¢è¯äº‘å›¾</strong></p> 
<pre><code class="prism language-python">tag_list<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>df_nall<span class="token punctuation">[</span><span class="token string">'æ ‡ç­¾åç§°'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>
tags_count<span class="token operator">=</span>pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>tag_list<span class="token punctuation">)</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>

wordcloud <span class="token operator">=</span> <span class="token punctuation">(</span>
    WordCloud<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span>
         <span class="token punctuation">[</span><span class="token builtin">list</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span> <span class="token keyword">for</span> z <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>tags_count<span class="token punctuation">.</span>index<span class="token punctuation">,</span>tags_count<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
         word_size_range<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"çƒ­é—¨æ ‡ç­¾"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
wordcloud<span class="token punctuation">.</span>render_notebook<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/72/73/V64DqP9r_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><strong>ç¡¬å¸ã€æ”¶è—ã€ç‚¹èµå¹³å‡äººæ•°åˆ†å¸ƒ</strong></p> 
<pre><code class="prism language-python">gp_triple_quality <span class="token operator">=</span> df_top100<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'åŒºç±»åˆ«'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'ç¡¬å¸æ•°'</span><span class="token punctuation">,</span><span class="token string">'å–œæ¬¢äººæ•°'</span><span class="token punctuation">,</span><span class="token string">'ç‚¹èµæ•°'</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'int'</span><span class="token punctuation">)</span>
gp_index <span class="token operator">=</span> gp_triple_quality<span class="token punctuation">.</span>index<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
gp_coin <span class="token operator">=</span> gp_triple_quality<span class="token punctuation">[</span><span class="token string">'ç¡¬å¸æ•°'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
gp_favorite <span class="token operator">=</span> gp_triple_quality<span class="token punctuation">[</span><span class="token string">'å–œæ¬¢äººæ•°'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
gp_like <span class="token operator">=</span> gp_triple_quality<span class="token punctuation">[</span><span class="token string">'ç‚¹èµæ•°'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
max_num <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>gp_triple_quality<span class="token punctuation">.</span>values<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">radar_base</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Radar<span class="token punctuation">:</span>
    c <span class="token operator">=</span> <span class="token punctuation">(</span>
        Radar<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>add_schema<span class="token punctuation">(</span>
            schema<span class="token operator">=</span><span class="token punctuation">[</span>
                opts<span class="token punctuation">.</span>RadarIndicatorItem<span class="token punctuation">(</span>name<span class="token operator">=</span>gp_index<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> max_<span class="token operator">=</span><span class="token number">600000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                opts<span class="token punctuation">.</span>RadarIndicatorItem<span class="token punctuation">(</span>name<span class="token operator">=</span>gp_index<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> max_<span class="token operator">=</span><span class="token number">600000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                opts<span class="token punctuation">.</span>RadarIndicatorItem<span class="token punctuation">(</span>name<span class="token operator">=</span>gp_index<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> max_<span class="token operator">=</span><span class="token number">600000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                opts<span class="token punctuation">.</span>RadarIndicatorItem<span class="token punctuation">(</span>name<span class="token operator">=</span>gp_index<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> max_<span class="token operator">=</span><span class="token number">600000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                opts<span class="token punctuation">.</span>RadarIndicatorItem<span class="token punctuation">(</span>name<span class="token operator">=</span>gp_index<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> max_<span class="token operator">=</span><span class="token number">600000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                opts<span class="token punctuation">.</span>RadarIndicatorItem<span class="token punctuation">(</span>name<span class="token operator">=</span>gp_index<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> max_<span class="token operator">=</span><span class="token number">600000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                opts<span class="token punctuation">.</span>RadarIndicatorItem<span class="token punctuation">(</span>name<span class="token operator">=</span>gp_index<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> max_<span class="token operator">=</span><span class="token number">600000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                opts<span class="token punctuation">.</span>RadarIndicatorItem<span class="token punctuation">(</span>name<span class="token operator">=</span>gp_index<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> max_<span class="token operator">=</span><span class="token number">600000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                opts<span class="token punctuation">.</span>RadarIndicatorItem<span class="token punctuation">(</span>name<span class="token operator">=</span>gp_index<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> max_<span class="token operator">=</span><span class="token number">600000</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">]</span>
 
        <span class="token punctuation">)</span>
        <span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">"ç¡¬å¸æ•°"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>gp_coin<span class="token punctuation">]</span><span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'#40e0d0'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">"å–œæ¬¢äººæ•°"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>gp_favorite<span class="token punctuation">]</span><span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'#1e90ff'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">"ç‚¹èµæ•°"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>gp_like<span class="token punctuation">]</span><span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'#b8860b'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>set_series_opts<span class="token punctuation">(</span>label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>is_show<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        linestyle_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LineStyleOpts<span class="token punctuation">(</span>width<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>type_<span class="token operator">=</span><span class="token string">'dotted'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"ç¡¬å¸ã€æ”¶è—ã€ç‚¹èµå¹³å‡äººæ•°åˆ†å¸ƒ"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">return</span> c
radar_base<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>render_notebook<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/5a/e0/VzR0polo_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>ç”Ÿæ´»åŒºçš„å¹³å‡æŠ•å¸å’Œç‚¹èµé‡ä¾ç„¶é«˜äºåŠ¨ç”»åŒºã€‚æŠ•å¸ã€ç‚¹èµã€æ”¶è—æœ€é«˜çš„åˆ†åŒºåˆ†åˆ«æ˜¯ï¼šç”Ÿæ´»ã€å½±è§†ã€æ—¶å°šã€‚é™¤äº†æ—¶å°šåŒºå¤–ï¼Œå…¶ä»–åˆ†åŒºçš„æ”¶è—é‡å‡ä½äºæŠ•å¸å’Œç‚¹èµï¼Œä¸”æ—¶å°šåŒºçš„æ”¶è—é‡æ˜¯è¿œé«˜å…¶ç‚¹èµå’ŒæŠ•å¸é‡ã€‚</p> 
<h3><a id="13__213"></a>1.3 åˆ†æç»“æœ</h3> 
<p>ä»æ•°æ®å¯è§†åŒ–ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæ’­æ”¾é‡æ’åå‰ä¸‰çš„åˆ†åˆ«æ˜¯ç”Ÿæ´»ç±»ã€åŠ¨ç”»ç±»ã€é¬¼ç•œç±»ï¼Œè®©äººè¯§å¼‚çš„æ˜¯ä»¥åŠ¨æ¼«èµ·å®¶çš„Bç«™ï¼Œæ’­æ”¾é‡æœ€å¤šçš„è§†é¢‘åˆ†ç±»ç«Ÿç„¶æ˜¯ç”Ÿæ´»ç±»èŠ‚ç›®ã€‚</p> 
<p>å¯¹æ¯”æ€»ä½“å„åˆ†ç±»æ’­æ”¾æƒ…å†µï¼Œtop100å„ç±»å æ¯”åŸºæœ¬ä¿æŒä¸å˜ã€‚ç”Ÿæ´»ç±»çš„å¹³å‡æŠ•å¸å’Œç‚¹èµé‡ä¾ç„¶é«˜äºåŠ¨ç”»ç±»ã€‚æŠ•å¸ã€ç‚¹èµã€æ”¶è—æœ€é«˜çš„åˆ†åŒºåˆ†åˆ«æ˜¯ï¼šç”Ÿæ´»ã€å½±è§†ã€æ—¶å°šã€‚é™¤äº†æ—¶å°šåŒºå¤–ï¼Œå…¶ä»–åˆ†åŒºçš„æ”¶è—é‡å‡ä½äºæŠ•å¸å’Œç‚¹èµï¼Œä¸”æ—¶å°šåŒºçš„æ”¶è—é‡æ˜¯è¿œé«˜å…¶ç‚¹èµå’ŒæŠ•å¸é‡ã€‚</p> 
<h2><a id="2__220"></a>2 å•ä¸€è§†é¢‘åˆ†æ</h2> 
<h3><a id="21__222"></a>2.1 æ•°æ®é¢„å¤„ç†</h3> 
<p><strong>Bç«™çˆ¬è™«ä»£ç Demo</strong></p> 
<pre><code class="prism language-python">
<span class="token keyword">import</span> requests<span class="token punctuation">,</span>csv<span class="token punctuation">,</span>time
<span class="token keyword">import</span> sys
<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup <span class="token keyword">as</span> BS


<span class="token triple-quoted-string string">'''è·å–ç½‘é¡µå†…å®¹'''</span>
<span class="token keyword">def</span> <span class="token function">request_get_comment</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko)'</span><span class="token punctuation">,</span>
               <span class="token string">'Cookie'</span><span class="token punctuation">:</span> <span class="token string">'LIVE_BUVID=AUTO7215383727315695; stardustvideo=1; rpdid=kwxwwoiokwdoskqkmlspw; '</span>
                         <span class="token string">'fts=1540348439; sid=alz55zmj; CURRENT_FNVAL=16; _uuid=08E6859E-EB68-A6B3-5394-65272461BC6E49706infoc; '</span>
                         <span class="token string">'im_notify_type_64915445=0; UM_distinctid=1673553ca94c37-0491294d1a7e36-36664c08-144000-1673553ca956ac; '</span>
                         <span class="token string">'DedeUserID=64915445; DedeUserID__ckMd5=cc0f686b911c9f2d; SESSDATA=7af19f78%2C1545711896%2Cb812f4b1; '</span>
                         <span class="token string">'bili_jct=dc9a675a0d53e8761351d4fb763922d5; BANGUMI_SS_5852_REC=103088; '</span>
                         <span class="token string">'buvid3=AE1D37C0-553C-445A-9979-70927B6C493785514infoc; finger=edc6ecda; CURRENT_QUALITY=80; '</span>
                         <span class="token string">'bp_t_offset_64915445=199482032395569793; _dfcaptcha=44f6fd1eadc58f99515d2981faadba86'</span><span class="token punctuation">}</span>

    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
    soup <span class="token operator">=</span> BS<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>response<span class="token punctuation">.</span>encoding<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'lxml'</span><span class="token punctuation">)</span>
    result <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'d'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> result
    all_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> result<span class="token punctuation">:</span>
        barrage_list <span class="token operator">=</span> item<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span>
        barrage_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>item<span class="token punctuation">.</span>string<span class="token punctuation">)</span>
        barrage_list<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> time<span class="token punctuation">.</span>ctime<span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>barrage_list<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        all_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>barrage_list<span class="token punctuation">)</span>
    <span class="token keyword">return</span> all_list

<span class="token triple-quoted-string string">'''å°†ç§’è½¬åŒ–ä¸ºå›ºå®šæ ¼å¼ï¼š"æ—¶ï¼šåˆ†ï¼šç§’"'''</span>
<span class="token keyword">def</span> <span class="token function">sec_to_str</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span><span class="token punctuation">:</span>
    second <span class="token operator">=</span> <span class="token builtin">eval</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span>
    m<span class="token punctuation">,</span>s <span class="token operator">=</span> <span class="token builtin">divmod</span><span class="token punctuation">(</span>second<span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">)</span>
    h<span class="token punctuation">,</span>m <span class="token operator">=</span> <span class="token builtin">divmod</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">)</span>
    dtEventTime <span class="token operator">=</span> <span class="token string">"%02d:%02d:%02d"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>h<span class="token punctuation">,</span>m<span class="token punctuation">,</span>s<span class="token punctuation">)</span>
    <span class="token keyword">return</span> dtEventTime


<span class="token triple-quoted-string string">'''ä¸»å‡½æ•°'''</span>
<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sys<span class="token punctuation">.</span>setrecursionlimit<span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span>
    url_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    cid_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">16980576</span><span class="token punctuation">,</span><span class="token number">16980597</span><span class="token punctuation">,</span><span class="token number">16548432</span><span class="token punctuation">,</span><span class="token number">16483358</span><span class="token punctuation">,</span><span class="token number">16740879</span><span class="token punctuation">,</span><span class="token number">17031320</span><span class="token punctuation">,</span>
           <span class="token number">17599975</span><span class="token punctuation">,</span><span class="token number">18226264</span><span class="token punctuation">,</span><span class="token number">17894824</span><span class="token punctuation">,</span><span class="token number">18231028</span><span class="token punctuation">,</span><span class="token number">18491877</span><span class="token punctuation">,</span><span class="token number">18780374</span><span class="token punctuation">]</span>

    tableheader <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'å¼¹å¹•å‡ºç°æ—¶é—´'</span><span class="token punctuation">,</span> <span class="token string">'å¼¹å¹•æ ¼å¼'</span><span class="token punctuation">,</span> <span class="token string">'å¼¹å¹•å­—ä½“'</span><span class="token punctuation">,</span> <span class="token string">'å¼¹å¹•é¢œè‰²'</span><span class="token punctuation">,</span> <span class="token string">'å¼¹å¹•æ—¶é—´æˆ³'</span><span class="token punctuation">,</span>
                        <span class="token string">'å¼¹å¹•æ± '</span><span class="token punctuation">,</span><span class="token string">'ç”¨æˆ·ID'</span><span class="token punctuation">,</span><span class="token string">'rowID'</span><span class="token punctuation">,</span><span class="token string">'å¼¹å¹•ä¿¡æ¯'</span><span class="token punctuation">]</span>

    <span class="token triple-quoted-string string">'''æœ€æ–°å¼¹å¹•æ–‡ä»¶'''</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        url <span class="token operator">=</span> <span class="token string">"https://comment.bilibili.com/%d.xml"</span> <span class="token operator">%</span> cid_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        url_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
        file_name <span class="token operator">=</span> <span class="token string">"now{}.csv"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_name<span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">,</span>newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">,</span>errors<span class="token operator">=</span><span class="token string">'ignore'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fd<span class="token punctuation">:</span>
            comment <span class="token operator">=</span> request_get_comment<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
            writer <span class="token operator">=</span> csv<span class="token punctuation">.</span>writer<span class="token punctuation">(</span>fd<span class="token punctuation">)</span>
            <span class="token comment"># writer.writerow(tableheader)</span>
            <span class="token keyword">if</span> comment<span class="token punctuation">:</span>
                <span class="token keyword">for</span> row <span class="token keyword">in</span> comment<span class="token punctuation">:</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
                    <span class="token comment">#writer.writerow(row)</span>
            <span class="token keyword">del</span> comment

    <span class="token triple-quoted-string string">'''æŒ‰ç…§é›†æ•°ï¼Œå–å‡ºå¼¹å¹•é“¾æ¥ï¼Œè¿›è¡Œçˆ¬è™«ï¼Œè·å–å¼¹å¹•è®°å½•ï¼Œå¹¶ä¿å­˜åˆ°csvæ–‡ä»¶'''</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        file_name <span class="token operator">=</span> <span class="token string">"d{}.csv"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> date <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                barrage_url <span class="token operator">=</span> first_barrage_url<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>cid_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"%02d"</span> <span class="token operator">%</span> j<span class="token punctuation">,</span><span class="token string">"%02d"</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> date <span class="token operator">*</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_name<span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span>newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">,</span>errors<span class="token operator">=</span><span class="token string">'ignore'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fd <span class="token punctuation">:</span>
                    writer <span class="token operator">=</span> csv<span class="token punctuation">.</span>writer<span class="token punctuation">(</span>fd<span class="token punctuation">)</span>
                    writer<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span>tableheader<span class="token punctuation">)</span>
                    final_list <span class="token operator">=</span> request_get_comment<span class="token punctuation">(</span>barrage_url<span class="token punctuation">)</span>

                    <span class="token keyword">if</span> final_list<span class="token punctuation">:</span>
                        <span class="token keyword">for</span> row <span class="token keyword">in</span> final_list<span class="token punctuation">:</span>
                            writer<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span>row<span class="token punctuation">)</span>
                    <span class="token keyword">del</span> <span class="token punctuation">(</span>final_list<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="22__318"></a>2.2 æ•°æ®æ¸…æ´—</h3> 
<p><strong>å¯¼å…¥æ•°æ®åˆ†æåº“</strong></p> 
<pre><code class="prism language-python"><span class="token comment">#æ•°æ®å¤„ç†åº“</span>

<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token keyword">import</span> glob

<span class="token keyword">import</span> re

<span class="token keyword">import</span> jieba

<span class="token comment">#å¯è§†åŒ–åº“</span>

<span class="token keyword">import</span> stylecloud

<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns

<span class="token operator">%</span>matplotlib inline

<span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>charts <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token keyword">from</span> pyecharts <span class="token keyword">import</span> options <span class="token keyword">as</span> opts

<span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span><span class="token builtin">globals</span> <span class="token keyword">import</span> ThemeType 

<span class="token keyword">from</span> IPython<span class="token punctuation">.</span>display <span class="token keyword">import</span> Image

<span class="token comment">#æ–‡æœ¬æŒ–æ˜åº“</span>

<span class="token keyword">from</span> snownlp <span class="token keyword">import</span> SnowNLP

<span class="token keyword">from</span> gensim <span class="token keyword">import</span> corpora<span class="token punctuation">,</span>models
</code></pre> 
<p><strong>åˆå¹¶å¼¹å¹•æ•°æ®</strong></p> 
<pre><code class="prism language-python">csv_list <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">'/danmu/*.csv'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'å…±å‘ç°%sä¸ªCSVæ–‡ä»¶'</span><span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>csv_list<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'æ­£åœ¨å¤„ç†............'</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> csv_list<span class="token punctuation">:</span>

    fr <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'danmu_all.csv'</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>

        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>fr<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'åˆå¹¶å®Œæ¯•ï¼'</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>é‡å¤å€¼ã€ç¼ºå¤±å€¼ç­‰å¤„ç†</strong></p> 
<pre><code class="prism language-python"><span class="token comment">#error_bad_lineså‚æ•°å¯å¿½ç•¥å¼‚å¸¸è¡Œ</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"./danmu_all.csv"</span><span class="token punctuation">,</span>header<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>error_bad_lines<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

df <span class="token operator">=</span> df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment">#é€‰æ‹©ç”¨æˆ·åå’Œå¼¹å¹•å†…å®¹åˆ—</span>

df <span class="token operator">=</span> df<span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#åˆ é™¤é‡å¤è¡Œ</span>

df <span class="token operator">=</span> df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#åˆ é™¤å­˜åœ¨ç¼ºå¤±å€¼çš„è¡Œ</span>

df<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"user"</span><span class="token punctuation">,</span><span class="token string">"danmu"</span><span class="token punctuation">]</span> <span class="token comment">#å¯¹å­—æ®µè¿›è¡Œå‘½å</span>
</code></pre> 
<p><strong>æ¸…æ´—åæ•°æ®å¦‚ä¸‹æ‰€ç¤ºï¼š</strong></p> 
<p><img src="https://images2.imgbox.com/d0/ac/5XcYxBzO_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><strong>æ•°æ®å»é‡</strong></p> 
<p>æœºæ¢°å‹ç¼©å»é‡å³æ•°æ®å¥å†…çš„å»é‡ï¼Œæˆ‘ä»¬å‘ç°å¼¹å¹•å†…å®¹å­˜åœ¨ä¾‹å¦‚"å•Šå•Šå•Šå•Šå•Š"è¿™ç§æ•°æ®ï¼Œè€Œå®é™…åšæƒ…æ„Ÿåˆ†ææ—¶ï¼Œåªéœ€è¦ä¸€ä¸ªâ€œå•Šâ€å³å¯ã€‚</p> 
<p><img src="https://images2.imgbox.com/1f/c2/4TTaFvoP_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<pre><code class="prism language-python"><span class="token comment">#å®šä¹‰æœºæ¢°å‹ç¼©å»é‡å‡½æ•°</span>

<span class="token keyword">def</span> <span class="token function">yasuo</span><span class="token punctuation">(</span>st<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>st<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>st<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

            <span class="token keyword">if</span> st<span class="token punctuation">[</span>j<span class="token punctuation">:</span>j<span class="token operator">+</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> st<span class="token punctuation">[</span>j<span class="token operator">+</span>i<span class="token punctuation">:</span>j<span class="token operator">+</span><span class="token number">2</span><span class="token operator">*</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>

                k <span class="token operator">=</span> j <span class="token operator">+</span> i

                <span class="token keyword">while</span> st<span class="token punctuation">[</span>k<span class="token punctuation">:</span>k<span class="token operator">+</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> st<span class="token punctuation">[</span>k<span class="token operator">+</span>i<span class="token punctuation">:</span>k<span class="token operator">+</span><span class="token number">2</span><span class="token operator">*</span>i<span class="token punctuation">]</span> <span class="token keyword">and</span> k<span class="token operator">&lt;</span><span class="token builtin">len</span><span class="token punctuation">(</span>st<span class="token punctuation">)</span><span class="token punctuation">:</span> 

                    k <span class="token operator">=</span> k <span class="token operator">+</span> i

                st <span class="token operator">=</span> st<span class="token punctuation">[</span><span class="token punctuation">:</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> st<span class="token punctuation">[</span>k<span class="token punctuation">:</span><span class="token punctuation">]</span>   

    <span class="token keyword">return</span> st

yasuo<span class="token punctuation">(</span>st<span class="token operator">=</span><span class="token string">"å•Šå•Šå•Šå•Šå•Šå•Šå•Š"</span><span class="token punctuation">)</span>
</code></pre> 
<p>åº”ç”¨ä»¥ä¸Šå‡½æ•°ï¼Œå¯¹å¼¹å¹•å†…å®¹è¿›è¡Œå¥å†…å»é‡ã€‚</p> 
<pre><code class="prism language-python">df<span class="token punctuation">[</span><span class="token string">"danmu"</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">"danmu"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>yasuo<span class="token punctuation">)</span>
</code></pre> 
<p><strong>ç‰¹æ®Šå­—ç¬¦è¿‡æ»¤</strong></p> 
<p>å¦å¤–ï¼Œæˆ‘ä»¬è¿˜å‘ç°æœ‰äº›å¼¹å¹•å†…å®¹åŒ…å«è¡¨æƒ…åŒ…ã€ç‰¹æ®Šç¬¦å·ç­‰ï¼Œè¿™äº›è„æ•°æ®ä¹Ÿä¼šå¯¹æƒ…æ„Ÿåˆ†æäº§ç”Ÿä¸€å®šå½±å“ã€‚</p> 
<p><img src="https://images2.imgbox.com/07/47/W71uRukg_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> ç‰¹æ®Šå­—ç¬¦ç›´æ¥é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤ï¼ŒåŒ¹é…å‡ºä¸­æ–‡å†…å®¹å³å¯ã€‚</p> 
<pre><code class="prism language-python">df<span class="token punctuation">[</span><span class="token string">'danmu'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'danmu'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token string">r"([\u4e00-\u9fa5]+)"</span><span class="token punctuation">)</span>

df <span class="token operator">=</span> df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">#çº¯è¡¨æƒ…ç›´æ¥åˆ é™¤</span>
</code></pre> 
<p>å¦å¤–ï¼Œè¿‡çŸ­çš„å¼¹å¹•å†…å®¹ä¸€èˆ¬å¾ˆéš¾çœ‹å‡ºæƒ…æ„Ÿå€¾å‘ï¼Œå¯ä»¥å°†å…¶ä¸€å¹¶è¿‡æ»¤ã€‚</p> 
<pre><code class="prism language-python">df <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">"danmu"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">4</span><span class="token punctuation">]</span>

df <span class="token operator">=</span> df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="23__462"></a>2.3 æ•°æ®å¯è§†åŒ–</h3> 
<p>æ•°æ®å¯è§†åŒ–åˆ†æéƒ¨åˆ†ä»£ç æœ¬å…¬ä¼—å·å¾€æœŸåŸåˆ›æ–‡ç« å·²å¤šæ¬¡æåŠï¼Œæœ¬æ–‡ä¸åšèµ˜è¿°ã€‚ä»å¯è§†åŒ–å›¾è¡¨æ¥çœ‹ï¼Œç½‘å‹å¯¹ã€Šæ²‰é»˜çš„çœŸç›¸ã€‹è¿˜æ˜¯ç›¸å½“è®¤å¯çš„ï¼Œå°¤å…¶å¯¹ç™½å®‡å¡‘é€ çš„æ­£ä¹‰å½¢è±¡æ±Ÿé˜³ï¼ŒæåŠé¢‘ç‡è¿œé«˜äºå…¶ä»–è§’è‰²ã€‚</p> 
<p><strong>æ•´ä½“å¼¹å¹•è¯äº‘</strong></p> 
<p><img src="https://images2.imgbox.com/63/ff/meNcxIiQ_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><strong>ä¸»æ¼”æåŠ</strong></p> 
<p><img src="https://images2.imgbox.com/26/fa/OKOa6CX9_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h2><a id="3_NLP_474"></a>3 æ–‡æœ¬æŒ–æ˜ï¼ˆNLPï¼‰</h2> 
<h3><a id="31__476"></a>3.1 æƒ…æ„Ÿåˆ†æ</h3> 
<p>æƒ…æ„Ÿåˆ†ææ˜¯å¯¹å¸¦æœ‰æ„Ÿæƒ…è‰²å½©çš„ä¸»è§‚æ€§æ–‡æœ¬è¿›è¡Œåˆ†æã€å¤„ç†ã€å½’çº³å’Œæ¨ç†çš„è¿‡ç¨‹ã€‚æŒ‰ç…§å¤„ç†æ–‡æœ¬çš„ç±»åˆ«ä¸åŒï¼Œå¯åˆ†ä¸ºåŸºäºæ–°é—»è¯„è®ºçš„æƒ…æ„Ÿåˆ†æå’ŒåŸºäºäº§å“è¯„è®ºçš„æƒ…æ„Ÿåˆ†æã€‚å…¶ä¸­ï¼Œå‰è€…å¤šç”¨äºèˆ†æƒ…ç›‘æ§å’Œä¿¡æ¯é¢„æµ‹ï¼Œåè€…å¯å¸®åŠ©ç”¨æˆ·äº†è§£æŸä¸€äº§å“åœ¨å¤§ä¼—å¿ƒç›®ä¸­çš„å£ç¢‘ã€‚ç›®å‰å¸¸è§çš„æƒ…æ„Ÿææ€§åˆ†ææ–¹æ³•ä¸»è¦æ˜¯ä¸¤ç§ï¼šåŸºäºæƒ…æ„Ÿè¯å…¸çš„æ–¹æ³•å’ŒåŸºäºæœºå™¨å­¦ä¹ çš„æ–¹æ³•ã€‚</p> 
<p>æœ¬æ–‡ä¸»è¦è¿ç”¨Pythonçš„ç¬¬ä¸‰æ–¹åº“SnowNLPå¯¹å¼¹å¹•å†…å®¹è¿›è¡Œæƒ…æ„Ÿåˆ†æï¼Œä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œè®¡ç®—å‡ºçš„æƒ…æ„Ÿscoreè¡¨ç¤ºè¯­ä¹‰ç§¯æçš„æ¦‚ç‡ï¼Œè¶Šæ¥è¿‘0æƒ…æ„Ÿè¡¨ç°è¶Šæ¶ˆæï¼Œè¶Šæ¥è¿‘1æƒ…æ„Ÿè¡¨ç°è¶Šç§¯æã€‚</p> 
<pre><code class="prism language-python">df<span class="token punctuation">[</span><span class="token string">'score'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">"danmu"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span>SnowNLP<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>sentiments<span class="token punctuation">)</span>

df<span class="token punctuation">.</span>sample<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">#éšæœºç­›é€‰10ä¸ªå¼¹å¹•æ ·æœ¬æ•°æ®</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/58/93/h426PNSB_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><strong>æ•´ä½“æƒ…æ„Ÿå€¾å‘</strong></p> 
<pre><code class="prism language-python">plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span>  <span class="token comment"># è®¾ç½®åŠ è½½çš„å­—ä½“å</span>

plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>  <span class="token comment"># è§£å†³ä¿å­˜å›¾åƒæ˜¯è´Ÿå·'-'æ˜¾ç¤ºä¸ºæ–¹å—çš„é—®é¢˜</span>

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#è®¾ç½®ç”»å¸ƒå¤§å°</span>

rate <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'score'</span><span class="token punctuation">]</span>

ax <span class="token operator">=</span> sns<span class="token punctuation">.</span>distplot<span class="token punctuation">(</span>rate<span class="token punctuation">,</span>

            hist_kws<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'color'</span><span class="token punctuation">:</span><span class="token string">'green'</span><span class="token punctuation">,</span><span class="token string">'label'</span><span class="token punctuation">:</span><span class="token string">'ç›´æ–¹å›¾'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

            kde_kws<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'color'</span><span class="token punctuation">:</span><span class="token string">'red'</span><span class="token punctuation">,</span><span class="token string">'label'</span><span class="token punctuation">:</span><span class="token string">'å¯†åº¦æ›²çº¿'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

            bins<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token comment">#å‚æ•°coloræ ·å¼ä¸ºsalmonï¼Œbinså‚æ•°è®¾å®šæ•°æ®ç‰‡æ®µçš„æ•°é‡</span>

ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"å¼¹å¹•æ•´ä½“æƒ…æ„Ÿå€¾å‘  ç»˜å›¾ï¼šã€ŒèœJå­¦Pythonã€å…¬ä¼—å·"</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show
</code></pre> 
<p><img src="https://images2.imgbox.com/4d/77/cnC55h8B_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><strong>è§‚ä¼—å¯¹ä¸»æ¼”çš„æƒ…æ„Ÿå€¾å‘</strong></p> 
<pre><code class="prism language-python">mapping <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'jiangyang'</span><span class="token punctuation">:</span><span class="token string">'ç™½å®‡|æ±Ÿé˜³'</span><span class="token punctuation">,</span> <span class="token string">'yanliang'</span><span class="token punctuation">:</span><span class="token string">'å»–å‡¡|ä¸¥è‰¯'</span><span class="token punctuation">,</span> <span class="token string">'zhangchao'</span><span class="token punctuation">:</span><span class="token string">'å®ç†|å¼ è¶…'</span><span class="token punctuation">,</span><span class="token string">'lijing'</span><span class="token punctuation">:</span><span class="token string">'è°­å“|æé™'</span><span class="token punctuation">,</span> <span class="token string">'wengmeixiang'</span><span class="token punctuation">:</span><span class="token string">'æå˜‰æ¬£|ç¿ç¾é¦™'</span><span class="token punctuation">}</span>

<span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> mapping<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    df<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'danmu'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>contains<span class="token punctuation">(</span>value<span class="token punctuation">)</span>

average_value <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>key<span class="token punctuation">:</span> df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'score'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> key <span class="token keyword">in</span> mapping<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>average_value<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>ç”±å„ä¸»è¦è§’è‰²æƒ…æ„Ÿå¾—åˆ†å‡å€¼å¯çŸ¥ï¼Œè§‚ä¼—å¯¹ä»–ä»¬éƒ½è¡¨ç°å‡ºç§¯æçš„æƒ…æ„Ÿã€‚ç¿ç¾é¦™å’Œæé™çš„æƒ…æ„Ÿå¾—åˆ†å‡å€¼ç›¸å¯¹é«˜ä¸€äº›ï¼Œéš¾é“æ˜¯ç”·æ€§è§‚ä¼—åå¤šï¼Ÿæ±Ÿé˜³çš„æƒ…æ„Ÿå€¾å‘ç›¸å¯¹è¾ƒä½ï¼Œå¯èƒ½æ˜¯è§‚ä¼—å¯¹ä½œä¸ºæ­£ä¹‰åŒ–èº«çš„ä»–æƒ¨é­å„ç§ä¸å…¬è€Œé¸£ä¸å¹³å§ã€‚</p> 
<p><img src="https://images2.imgbox.com/3d/d5/bQes8jNf_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><strong>ä¸»é¢˜åˆ†æ</strong></p> 
<p>è¿™é‡Œçš„ä¸»é¢˜åˆ†æä¸»è¦æ˜¯å°†å¼¹å¹•æƒ…æ„Ÿå¾—åˆ†åˆ’åˆ†ä¸ºä¸¤ç±»ï¼Œåˆ†åˆ«ä¸ºç§¯æç±»ï¼ˆå¾—åˆ†åœ¨0.8ä»¥ä¸Šï¼‰å’Œæ¶ˆæç±»ï¼ˆå¾—åˆ†åœ¨0.3ä»¥ä¸‹ï¼‰ï¼Œç„¶åå†åœ¨å„ç±»é‡Œåˆ†åˆ«ç»†åˆ†å‡º5ä¸ªä¸»é¢˜ï¼Œæœ‰åŠ©äºæŒ–æ˜å‡ºè§‚ä¼—æƒ…æ„Ÿäº§ç”Ÿçš„åŸå› ã€‚</p> 
<p>é¦–å…ˆï¼Œç­›é€‰å‡ºä¸¤å¤§ç±»åˆ†åˆ«è¿›è¡Œåˆ†è¯ã€‚</p> 
<pre><code class="prism language-python"><span class="token comment">#åˆ†è¯</span>

data1 <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'danmu'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">"score"</span><span class="token punctuation">]</span><span class="token operator">&gt;=</span><span class="token number">0.8</span><span class="token punctuation">]</span>

data2 <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'danmu'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">"score"</span><span class="token punctuation">]</span><span class="token operator">&lt;</span><span class="token number">0.3</span><span class="token punctuation">]</span>

word_cut <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span><span class="token string">' '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>jieba<span class="token punctuation">.</span>cut<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#ä»¥ç©ºæ ¼éš”å¼€</span>

data1 <span class="token operator">=</span> data1<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>word_cut<span class="token punctuation">)</span>

data2 <span class="token operator">=</span> data2<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>word_cut<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>data1<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'----------------------'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>data2<span class="token punctuation">)</span>

<span class="token number">123456789</span>

é¦–å…ˆï¼Œç­›é€‰å‡ºä¸¤å¤§ç±»åˆ†åˆ«è¿›è¡Œåˆ†è¯ã€‚

<span class="token comment">#å»é™¤åœç”¨è¯</span>

stop <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"/èœJå­¦Python/stop_words.txt"</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span>header<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>sep<span class="token operator">=</span><span class="token string">'tipdm'</span><span class="token punctuation">)</span>

stop <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">' '</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">list</span><span class="token punctuation">(</span>stop<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">#print(stop)</span>

pos <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data1<span class="token punctuation">)</span>

neg <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data2<span class="token punctuation">)</span>

pos<span class="token punctuation">[</span><span class="token string">"danmu_1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> pos<span class="token punctuation">[</span><span class="token string">"danmu"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> s<span class="token punctuation">:</span>s<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

pos<span class="token punctuation">[</span><span class="token string">"danmu_pos"</span><span class="token punctuation">]</span> <span class="token operator">=</span> pos<span class="token punctuation">[</span><span class="token string">"danmu_1"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span><span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> x <span class="token keyword">if</span> i<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">not</span> <span class="token keyword">in</span> stop<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">#print(pos["danmu_pos"])</span>

neg<span class="token punctuation">[</span><span class="token string">"danmu_1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> neg<span class="token punctuation">[</span><span class="token string">"danmu"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> s<span class="token punctuation">:</span>s<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

neg<span class="token punctuation">[</span><span class="token string">"danmu_neg"</span><span class="token punctuation">]</span> <span class="token operator">=</span> neg<span class="token punctuation">[</span><span class="token string">"danmu_1"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span><span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> x <span class="token keyword">if</span> i<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">not</span> <span class="token keyword">in</span> stop<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>å…¶æ¬¡ï¼Œå¯¹ç§¯æç±»å¼¹å¹•è¿›è¡Œä¸»é¢˜åˆ†æã€‚</p> 
<pre><code class="prism language-python"><span class="token comment">#æ­£é¢ä¸»é¢˜åˆ†æ</span>

pos_dict <span class="token operator">=</span> corpora<span class="token punctuation">.</span>Dictionary<span class="token punctuation">(</span>pos<span class="token punctuation">[</span><span class="token string">"danmu_pos"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#å»ºç«‹è¯å…¸</span>

<span class="token comment">#print(pos_dict)</span>

pos_corpus <span class="token operator">=</span> <span class="token punctuation">[</span>pos_dict<span class="token punctuation">.</span>doc2bow<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> pos<span class="token punctuation">[</span><span class="token string">"danmu_pos"</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment">#å»ºç«‹è¯­æ–™åº“</span>

pos_lda <span class="token operator">=</span> models<span class="token punctuation">.</span>LdaModel<span class="token punctuation">(</span>pos_corpus<span class="token punctuation">,</span>num_topics<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>id2word<span class="token operator">=</span>pos_dict<span class="token punctuation">)</span> <span class="token comment">#LDAæ¨¡å‹è®­ç»ƒ</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æ­£é¢ä¸»é¢˜åˆ†æï¼š"</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'topic'</span><span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span>pos_lda<span class="token punctuation">.</span>print_topic<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#è¾“å‡ºæ¯ä¸ªä¸»é¢˜</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token operator">*</span><span class="token number">50</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>ç»“æœå¦‚ä¸‹ï¼š</strong></p> 
<p><img src="https://images2.imgbox.com/93/6f/BHM6y6dg_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>æœ€åï¼Œå¯¹æ¶ˆæç±»å¼¹å¹•è¿›è¡Œä¸»é¢˜åˆ†æã€‚</p> 
<pre><code class="prism language-python"><span class="token comment">#è´Ÿé¢ä¸»é¢˜åˆ†æ</span>

neg_dict <span class="token operator">=</span> corpora<span class="token punctuation">.</span>Dictionary<span class="token punctuation">(</span>neg<span class="token punctuation">[</span><span class="token string">"danmu_neg"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#å»ºç«‹è¯å…¸</span>

<span class="token comment">#print(neg_dict)</span>

neg_corpus <span class="token operator">=</span> <span class="token punctuation">[</span>neg_dict<span class="token punctuation">.</span>doc2bow<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> neg<span class="token punctuation">[</span><span class="token string">"danmu_neg"</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment">#å»ºç«‹è¯­æ–™åº“</span>

neg_lda <span class="token operator">=</span> models<span class="token punctuation">.</span>LdaModel<span class="token punctuation">(</span>neg_corpus<span class="token punctuation">,</span>num_topics<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>id2word<span class="token operator">=</span>neg_dict<span class="token punctuation">)</span> <span class="token comment">#LDAæ¨¡å‹è®­ç»ƒ</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è´Ÿé¢é¢ä¸»é¢˜åˆ†æï¼š"</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'topic'</span><span class="token punctuation">,</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span>neg_lda<span class="token punctuation">.</span>print_topic<span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#è¾“å‡ºæ¯ä¸ªä¸»é¢˜</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token operator">*</span><span class="token number">50</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>ç»“æœå¦‚ä¸‹ï¼š</strong></p> 
<p><img src="https://images2.imgbox.com/1e/c2/PfXYY2vD_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>ğŸ§¿ <strong>é€‰é¢˜æŒ‡å¯¼, é¡¹ç›®åˆ†äº«ï¼šè§æ–‡æœ«</strong></p> 
<br> 
<h2><a id="6__657"></a>6 æœ€å</h2> 
<p>**æ¯•è®¾å¸®åŠ©, é€‰é¢˜æŒ‡å¯¼, é¡¹ç›®åˆ†äº«: ** <a href="https://gitee.com/yaa-dc/warehouse-1/blob/master/python/README.md" rel="nofollow">https://gitee.com/yaa-dc/warehouse-1/blob/master/python/README.md</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7125cb812e0c48374704bb6b2acc0b6b/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">æ¯•è®¾æˆå“ å¤§æ•°æ®ç”µå•†ç”¨æˆ·è¡Œä¸ºåˆ†æåŠå¯è§†åŒ–(æºç &#43;è®ºæ–‡)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/54d35a97677049374f4c232fa4c472b0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">ã€æ•°æ®ç»“æ„ã€‘çº¿æ€§è¡¨ä¹‹ã€Šé˜Ÿåˆ—ã€‹è¶…è¯¦ç»†å®ç°</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§å’–.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>