<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>cryptographyï¼Œä¸€ä¸ªç¥å¥‡çš„ Python åº“ï¼ - ç¼–ç¨‹å¤§å’–</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/3411e472aa6cc95dd9283bdb843ff12c/">
  <meta property="og:site_name" content="ç¼–ç¨‹å¤§å’–">
  <meta property="og:title" content="cryptographyï¼Œä¸€ä¸ªç¥å¥‡çš„ Python åº“ï¼">
  <meta property="og:description" content="æ›´å¤šèµ„æ–™è·å– ğŸ“š ä¸ªäººç½‘ç«™ï¼šipengtao.com
å¤§å®¶å¥½ï¼Œä»Šå¤©ä¸ºå¤§å®¶åˆ†äº«ä¸€ä¸ªç¥å¥‡çš„ Python åº“ - cryptographyã€‚
Githubåœ°å€ï¼šhttps://github.com/pyca/cryptography
åœ¨å½“ä»Šæ•°å­—åŒ–æ—¶ä»£ï¼Œä¿¡æ¯å®‰å…¨è¶Šæ¥è¶Šå—åˆ°é‡è§†ã€‚æ•°æ®åŠ å¯†æ˜¯ä¿æŠ¤æ•°æ®å®‰å…¨çš„é‡è¦æ‰‹æ®µä¹‹ä¸€ï¼Œè€ŒPythonçš„cryptographyåº“æä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½æ¥æ”¯æŒå„ç§åŠ å¯†ç®—æ³•å’Œåè®®ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨cryptographyåº“çš„å„ä¸ªæ–¹é¢ï¼ŒåŒ…æ‹¬å…¶åŸºæœ¬æ¦‚å¿µã€å¸¸è§ç”¨æ³•ã€é«˜çº§ç‰¹æ€§ã€å®‰å…¨æ€§è€ƒè™‘ä»¥åŠç¤ºä¾‹ä»£ç ã€‚
ä»€ä¹ˆæ˜¯cryptographyåº“ï¼Ÿ cryptographyæ˜¯ä¸€ä¸ªç”¨äºPythonçš„å¯†ç å­¦å·¥å…·åŒ…ï¼Œå®ƒæä¾›äº†å®‰å…¨çš„å¯†ç å­¦ç®—æ³•å’Œåè®®çš„å®ç°ï¼Œç”¨äºåŠ å¯†ã€è§£å¯†ã€ç­¾åã€éªŒè¯ç­‰æ“ä½œã€‚cryptographyåº“è‡´åŠ›äºæä¾›ç®€å•ã€æ˜“ç”¨ä¸”é«˜åº¦å®‰å…¨çš„APIæ¥å£ï¼Œä½¿å¾—å¼€å‘äººå‘˜èƒ½å¤Ÿè½»æ¾åœ°å®ç°æ•°æ®åŠ å¯†å’Œå®‰å…¨é€šä¿¡ã€‚
å®‰è£…cryptographyåº“ åœ¨å¼€å§‹ä½¿ç”¨cryptographyä¹‹å‰ï¼Œéœ€è¦å…ˆå®‰è£…å®ƒã€‚
å¯ä»¥ä½¿ç”¨pipæ¥å®‰è£…cryptographyï¼š
pip install cryptography å®‰è£…å®Œæˆåï¼Œå°±å¯ä»¥å¼€å§‹ä½¿ç”¨cryptographyåº“äº†ã€‚
åŸºæœ¬åŠŸèƒ½ 1. å¯¹ç§°åŠ å¯† cryptographyåº“æ”¯æŒå¸¸è§çš„å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œæ¯”å¦‚AESã€DESç­‰ã€‚
ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨AESå¯¹ç§°åŠ å¯†ç®—æ³•åŠ å¯†å’Œè§£å¯†æ•°æ®çš„ç¤ºä¾‹ï¼š
from cryptography.fernet import Fernet # ç”Ÿæˆå¯†é’¥ key = Fernet.generate_key() # åˆ›å»ºåŠ å¯†å™¨ cipher = Fernet(key) # åŠ å¯†æ•°æ® encrypted_data = cipher.encrypt(b&#34;Hello, World!&#34;) # è§£å¯†æ•°æ® decrypted_data = cipher.decrypt(encrypted_data) print(decrypted_data.decode()) 2. éå¯¹ç§°åŠ å¯† cryptographyåº“è¿˜æ”¯æŒéå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œæ¯”å¦‚RSAã€‚
ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨RSAéå¯¹ç§°åŠ å¯†ç®—æ³•åŠ å¯†å’Œè§£å¯†æ•°æ®çš„ç¤ºä¾‹ï¼š
from cryptography.hazmat.backends import default_backend from cryptography.hazmat.primitives import serialization, rsa from cryptography.hazmat.primitives.asymmetric import padding # ç”ŸæˆRSAå¯†é’¥å¯¹ private_key = rsa.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-26T19:00:00+08:00">
    <meta property="article:modified_time" content="2024-03-26T19:00:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§å’–" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§å’–</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">cryptographyï¼Œä¸€ä¸ªç¥å¥‡çš„ Python åº“ï¼</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/03/df/1EILykdk_o.png" alt=""></p> 
<h2><a id="_1"></a>æ›´å¤šèµ„æ–™è·å–</h2> 
<p>ğŸ“š ä¸ªäººç½‘ç«™ï¼š<a href="http://ipengtao.com/" rel="nofollow">ipengtao.com</a></p> 
<hr> 
<p>å¤§å®¶å¥½ï¼Œä»Šå¤©ä¸ºå¤§å®¶åˆ†äº«ä¸€ä¸ªç¥å¥‡çš„ Python åº“ - cryptographyã€‚</p> 
<p>Githubåœ°å€ï¼šhttps://github.com/pyca/cryptography</p> 
<hr> 
<p>åœ¨å½“ä»Šæ•°å­—åŒ–æ—¶ä»£ï¼Œä¿¡æ¯å®‰å…¨è¶Šæ¥è¶Šå—åˆ°é‡è§†ã€‚æ•°æ®åŠ å¯†æ˜¯ä¿æŠ¤æ•°æ®å®‰å…¨çš„é‡è¦æ‰‹æ®µä¹‹ä¸€ï¼Œè€ŒPythonçš„cryptographyåº“æä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½æ¥æ”¯æŒå„ç§åŠ å¯†ç®—æ³•å’Œåè®®ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨cryptographyåº“çš„å„ä¸ªæ–¹é¢ï¼ŒåŒ…æ‹¬å…¶åŸºæœ¬æ¦‚å¿µã€å¸¸è§ç”¨æ³•ã€é«˜çº§ç‰¹æ€§ã€å®‰å…¨æ€§è€ƒè™‘ä»¥åŠç¤ºä¾‹ä»£ç ã€‚</p> 
<h3><a id="cryptography_16"></a>ä»€ä¹ˆæ˜¯cryptographyåº“ï¼Ÿ</h3> 
<p>cryptographyæ˜¯ä¸€ä¸ªç”¨äºPythonçš„å¯†ç å­¦å·¥å…·åŒ…ï¼Œå®ƒæä¾›äº†å®‰å…¨çš„å¯†ç å­¦ç®—æ³•å’Œåè®®çš„å®ç°ï¼Œç”¨äºåŠ å¯†ã€è§£å¯†ã€ç­¾åã€éªŒè¯ç­‰æ“ä½œã€‚cryptographyåº“è‡´åŠ›äºæä¾›ç®€å•ã€æ˜“ç”¨ä¸”é«˜åº¦å®‰å…¨çš„APIæ¥å£ï¼Œä½¿å¾—å¼€å‘äººå‘˜èƒ½å¤Ÿè½»æ¾åœ°å®ç°æ•°æ®åŠ å¯†å’Œå®‰å…¨é€šä¿¡ã€‚</p> 
<h3><a id="cryptography_20"></a>å®‰è£…cryptographyåº“</h3> 
<p>åœ¨å¼€å§‹ä½¿ç”¨cryptographyä¹‹å‰ï¼Œéœ€è¦å…ˆå®‰è£…å®ƒã€‚</p> 
<p>å¯ä»¥ä½¿ç”¨pipæ¥å®‰è£…cryptographyï¼š</p> 
<pre><code class="prism language-bash">pip <span class="token function">install</span> cryptography
</code></pre> 
<p>å®‰è£…å®Œæˆåï¼Œå°±å¯ä»¥å¼€å§‹ä½¿ç”¨cryptographyåº“äº†ã€‚</p> 
<h3><a id="_32"></a>åŸºæœ¬åŠŸèƒ½</h3> 
<h4><a id="1__34"></a>1. å¯¹ç§°åŠ å¯†</h4> 
<p>cryptographyåº“æ”¯æŒå¸¸è§çš„å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œæ¯”å¦‚AESã€DESç­‰ã€‚</p> 
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨AESå¯¹ç§°åŠ å¯†ç®—æ³•åŠ å¯†å’Œè§£å¯†æ•°æ®çš„ç¤ºä¾‹ï¼š</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>fernet <span class="token keyword">import</span> Fernet

<span class="token comment"># ç”Ÿæˆå¯†é’¥</span>
key <span class="token operator">=</span> Fernet<span class="token punctuation">.</span>generate_key<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># åˆ›å»ºåŠ å¯†å™¨</span>
cipher <span class="token operator">=</span> Fernet<span class="token punctuation">(</span>key<span class="token punctuation">)</span>

<span class="token comment"># åŠ å¯†æ•°æ®</span>
encrypted_data <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span><span class="token string">b"Hello, World!"</span><span class="token punctuation">)</span>

<span class="token comment"># è§£å¯†æ•°æ®</span>
decrypted_data <span class="token operator">=</span> cipher<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>encrypted_data<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>decrypted_data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="2__58"></a>2. éå¯¹ç§°åŠ å¯†</h4> 
<p>cryptographyåº“è¿˜æ”¯æŒéå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œæ¯”å¦‚RSAã€‚</p> 
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨RSAéå¯¹ç§°åŠ å¯†ç®—æ³•åŠ å¯†å’Œè§£å¯†æ•°æ®çš„ç¤ºä¾‹ï¼š</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>backends <span class="token keyword">import</span> default_backend
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives <span class="token keyword">import</span> serialization<span class="token punctuation">,</span> rsa
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span>asymmetric <span class="token keyword">import</span> padding

<span class="token comment"># ç”ŸæˆRSAå¯†é’¥å¯¹</span>
private_key <span class="token operator">=</span> rsa<span class="token punctuation">.</span>generate_private_key<span class="token punctuation">(</span>
    public_exponent<span class="token operator">=</span><span class="token number">65537</span><span class="token punctuation">,</span>
    key_size<span class="token operator">=</span><span class="token number">2048</span><span class="token punctuation">,</span>
    backend<span class="token operator">=</span>default_backend<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
public_key <span class="token operator">=</span> private_key<span class="token punctuation">.</span>public_key<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># åŠ å¯†æ•°æ®</span>
encrypted_data <span class="token operator">=</span> public_key<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>
    <span class="token string">b"Hello, World!"</span><span class="token punctuation">,</span>
    padding<span class="token punctuation">.</span>OAEP<span class="token punctuation">(</span>
        mgf<span class="token operator">=</span>padding<span class="token punctuation">.</span>MGF1<span class="token punctuation">(</span>algorithm<span class="token operator">=</span>hashes<span class="token punctuation">.</span>SHA256<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        algorithm<span class="token operator">=</span>hashes<span class="token punctuation">.</span>SHA256<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        label<span class="token operator">=</span><span class="token boolean">None</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment"># è§£å¯†æ•°æ®</span>
decrypted_data <span class="token operator">=</span> private_key<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>
    encrypted_data<span class="token punctuation">,</span>
    padding<span class="token punctuation">.</span>OAEP<span class="token punctuation">(</span>
        mgf<span class="token operator">=</span>padding<span class="token punctuation">.</span>MGF1<span class="token punctuation">(</span>algorithm<span class="token operator">=</span>hashes<span class="token punctuation">.</span>SHA256<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        algorithm<span class="token operator">=</span>hashes<span class="token punctuation">.</span>SHA256<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        label<span class="token operator">=</span><span class="token boolean">None</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>decrypted_data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="_100"></a>é«˜çº§ç‰¹æ€§</h3> 
<h4><a id="1__102"></a>1. å¯†é’¥æ´¾ç”Ÿ</h4> 
<p>cryptographyåº“æä¾›äº†å¯†é’¥æ´¾ç”ŸåŠŸèƒ½ï¼Œç”¨äºä»å¯†ç æˆ–è€…å¯†ç å“ˆå¸Œä¸­æ´¾ç”Ÿå¯†é’¥ã€‚è¿™åœ¨å¯†ç å­¦ä¸­æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„åŠŸèƒ½ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘äººå‘˜ç”Ÿæˆå®‰å…¨çš„å¯†é’¥ã€‚</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span>kdf<span class="token punctuation">.</span>pbkdf2 <span class="token keyword">import</span> PBKDF2HMAC
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>backends <span class="token keyword">import</span> default_backend
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives <span class="token keyword">import</span> hashes

<span class="token comment"># å¯†ç </span>
password <span class="token operator">=</span> <span class="token string">b"password"</span>
<span class="token comment"># ç›</span>
salt <span class="token operator">=</span> <span class="token string">b"salt"</span>

<span class="token comment"># åˆ›å»ºPBKDF2HMACå¯¹è±¡</span>
kdf <span class="token operator">=</span> PBKDF2HMAC<span class="token punctuation">(</span>
    algorithm<span class="token operator">=</span>hashes<span class="token punctuation">.</span>SHA256<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span>
    salt<span class="token operator">=</span>salt<span class="token punctuation">,</span>
    iterations<span class="token operator">=</span><span class="token number">100000</span><span class="token punctuation">,</span>
    backend<span class="token operator">=</span>default_backend<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment"># æ´¾ç”Ÿå¯†é’¥</span>
key <span class="token operator">=</span> kdf<span class="token punctuation">.</span>derive<span class="token punctuation">(</span>password<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="2__129"></a>2. æ•°å­—ç­¾å</h4> 
<p>cryptographyåº“æ”¯æŒæ•°å­—ç­¾ååŠŸèƒ½ï¼Œç”¨äºå¯¹æ•°æ®è¿›è¡Œç­¾åå’ŒéªŒè¯ã€‚è¿™åœ¨ä¿è¯æ•°æ®å®Œæ•´æ€§å’ŒéªŒè¯æ•°æ®æ¥æºæ–¹é¢éå¸¸æœ‰ç”¨ã€‚</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives <span class="token keyword">import</span> hashes
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span>asymmetric <span class="token keyword">import</span> padding
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>backends <span class="token keyword">import</span> default_backend

<span class="token comment"># ä½¿ç”¨ç§é’¥å¯¹æ•°æ®è¿›è¡Œç­¾å</span>
signature <span class="token operator">=</span> private_key<span class="token punctuation">.</span>sign<span class="token punctuation">(</span>
    data<span class="token punctuation">,</span>
    padding<span class="token punctuation">.</span>PSS<span class="token punctuation">(</span>
        mgf<span class="token operator">=</span>padding<span class="token punctuation">.</span>MGF1<span class="token punctuation">(</span>hashes<span class="token punctuation">.</span>SHA256<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        salt_length<span class="token operator">=</span>padding<span class="token punctuation">.</span>PSS<span class="token punctuation">.</span>MAX_LENGTH
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    hashes<span class="token punctuation">.</span>SHA256<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment"># ä½¿ç”¨å…¬é’¥éªŒè¯ç­¾å</span>
public_key<span class="token punctuation">.</span>verify<span class="token punctuation">(</span>
    signature<span class="token punctuation">,</span>
    data<span class="token punctuation">,</span>
    padding<span class="token punctuation">.</span>PSS<span class="token punctuation">(</span>
        mgf<span class="token operator">=</span>padding<span class="token punctuation">.</span>MGF1<span class="token punctuation">(</span>hashes<span class="token punctuation">.</span>SHA256<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        salt_length<span class="token operator">=</span>padding<span class="token punctuation">.</span>PSS<span class="token punctuation">.</span>MAX_LENGTH
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    hashes<span class="token punctuation">.</span>SHA256<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="_160"></a>åº”ç”¨åœºæ™¯</h3> 
<h4><a id="1__162"></a>1. æ•°æ®åº“åŠ å¯†</h4> 
<p>åœ¨è®¸å¤šåº”ç”¨ç¨‹åºä¸­ï¼Œæ•°æ®åº“ä¸­å­˜å‚¨çš„æ•°æ®å¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚ç”¨æˆ·å¯†ç ã€ä¸ªäººä¿¡æ¯ç­‰ã€‚ä½¿ç”¨cryptographyåº“å¯ä»¥å¯¹è¿™äº›æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œç¡®ä¿æ•°æ®åœ¨æ•°æ®åº“ä¸­å­˜å‚¨å’Œä¼ è¾“è¿‡ç¨‹ä¸­ä¸è¢«æ³„éœ²ã€‚</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>fernet <span class="token keyword">import</span> Fernet

<span class="token comment"># ç”Ÿæˆæ•°æ®åº“åŠ å¯†å¯†é’¥</span>
key <span class="token operator">=</span> Fernet<span class="token punctuation">.</span>generate_key<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># åˆ›å»ºåŠ å¯†å™¨</span>
cipher <span class="token operator">=</span> Fernet<span class="token punctuation">(</span>key<span class="token punctuation">)</span>

<span class="token comment"># åŠ å¯†æ•æ„Ÿæ•°æ®</span>
encrypted_data <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span><span class="token string">b"user_password"</span><span class="token punctuation">)</span>

<span class="token comment"># å°†åŠ å¯†åçš„æ•°æ®å­˜å‚¨åˆ°æ•°æ®åº“ä¸­</span>
<span class="token comment"># ...</span>
</code></pre> 
<h4><a id="2__182"></a>2. æ–‡ä»¶åŠ å¯†</h4> 
<p>åœ¨æ–‡ä»¶å­˜å‚¨å’Œä¼ è¾“è¿‡ç¨‹ä¸­ï¼Œæ–‡ä»¶çš„å†…å®¹å¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚å¯†é’¥æ–‡ä»¶ã€é…ç½®æ–‡ä»¶ç­‰ã€‚ä½¿ç”¨cryptographyåº“å¯ä»¥å¯¹è¿™äº›æ–‡ä»¶è¿›è¡ŒåŠ å¯†ï¼Œç¡®ä¿æ–‡ä»¶å†…å®¹åœ¨å­˜å‚¨å’Œä¼ è¾“è¿‡ç¨‹ä¸­ä¸è¢«æ³„éœ²ã€‚</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>fernet <span class="token keyword">import</span> Fernet

<span class="token comment"># ç”Ÿæˆæ–‡ä»¶åŠ å¯†å¯†é’¥</span>
key <span class="token operator">=</span> Fernet<span class="token punctuation">.</span>generate_key<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># åˆ›å»ºåŠ å¯†å™¨</span>
cipher <span class="token operator">=</span> Fernet<span class="token punctuation">(</span>key<span class="token punctuation">)</span>

<span class="token comment"># åŠ å¯†æ–‡ä»¶å†…å®¹</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"config.txt"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
    file_content <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    encrypted_content <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>file_content<span class="token punctuation">)</span>

<span class="token comment"># å°†åŠ å¯†åçš„å†…å®¹å†™å…¥æ–‡ä»¶</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"config_encrypted.txt"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> encrypted_file<span class="token punctuation">:</span>
    encrypted_file<span class="token punctuation">.</span>write<span class="token punctuation">(</span>encrypted_content<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="3__205"></a>3. ç½‘ç»œé€šä¿¡åŠ å¯†</h4> 
<p>åœ¨ç½‘ç»œé€šä¿¡è¿‡ç¨‹ä¸­ï¼Œæ•°æ®ä¼ è¾“å¯èƒ½ä¼šå—åˆ°çªƒå¬å’Œç¯¡æ”¹çš„å¨èƒã€‚ä½¿ç”¨cryptographyåº“å¯ä»¥å¯¹ç½‘ç»œé€šä¿¡æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œç¡®ä¿æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¸è¢«çªƒå¬å’Œç¯¡æ”¹ã€‚</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives <span class="token keyword">import</span> serialization
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span>asymmetric <span class="token keyword">import</span> padding
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives <span class="token keyword">import</span> hashes
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>backends <span class="token keyword">import</span> default_backend

<span class="token comment"># åŠ è½½å…¬é’¥å’Œç§é’¥</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"public_key.pem"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> key_file<span class="token punctuation">:</span>
    public_key <span class="token operator">=</span> serialization<span class="token punctuation">.</span>load_pem_public_key<span class="token punctuation">(</span>
        key_file<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        backend<span class="token operator">=</span>default_backend<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"private_key.pem"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> key_file<span class="token punctuation">:</span>
    private_key <span class="token operator">=</span> serialization<span class="token punctuation">.</span>load_pem_private_key<span class="token punctuation">(</span>
        key_file<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        password<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
        backend<span class="token operator">=</span>default_backend<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

<span class="token comment"># åŠ å¯†æ•°æ®</span>
encrypted_data <span class="token operator">=</span> public_key<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>
    <span class="token string">b"Sensitive data"</span><span class="token punctuation">,</span>
    padding<span class="token punctuation">.</span>OAEP<span class="token punctuation">(</span>
        mgf<span class="token operator">=</span>padding<span class="token punctuation">.</span>MGF1<span class="token punctuation">(</span>algorithm<span class="token operator">=</span>hashes<span class="token punctuation">.</span>SHA256<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        algorithm<span class="token operator">=</span>hashes<span class="token punctuation">.</span>SHA256<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        label<span class="token operator">=</span><span class="token boolean">None</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment"># è§£å¯†æ•°æ®</span>
decrypted_data <span class="token operator">=</span> private_key<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>
    encrypted_data<span class="token punctuation">,</span>
    padding<span class="token punctuation">.</span>OAEP<span class="token punctuation">(</span>
        mgf<span class="token operator">=</span>padding<span class="token punctuation">.</span>MGF1<span class="token punctuation">(</span>algorithm<span class="token operator">=</span>hashes<span class="token punctuation">.</span>SHA256<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        algorithm<span class="token operator">=</span>hashes<span class="token punctuation">.</span>SHA256<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        label<span class="token operator">=</span><span class="token boolean">None</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="4__250"></a>4. æ•°å­—ç­¾åä¸éªŒè¯</h4> 
<p>æ•°å­—ç­¾åæ˜¯ä¸€ç§ç”¨äºéªŒè¯æ•°æ®å®Œæ•´æ€§å’ŒçœŸå®æ€§çš„æŠ€æœ¯ã€‚ä½¿ç”¨cryptographyåº“å¯ä»¥å¯¹æ•°æ®è¿›è¡Œç­¾åå’ŒéªŒè¯ï¼Œç¡®ä¿æ•°æ®åœ¨ä¼ è¾“å’Œå­˜å‚¨è¿‡ç¨‹ä¸­ä¸è¢«ç¯¡æ”¹å’Œä¼ªé€ ã€‚</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives <span class="token keyword">import</span> hashes
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span>asymmetric <span class="token keyword">import</span> padding

<span class="token comment"># ä½¿ç”¨ç§é’¥å¯¹æ•°æ®è¿›è¡Œç­¾å</span>
signature <span class="token operator">=</span> private_key<span class="token punctuation">.</span>sign<span class="token punctuation">(</span>
    data<span class="token punctuation">,</span>
    padding<span class="token punctuation">.</span>PSS<span class="token punctuation">(</span>
        mgf<span class="token operator">=</span>padding<span class="token punctuation">.</span>MGF1<span class="token punctuation">(</span>hashes<span class="token punctuation">.</span>SHA256<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        salt_length<span class="token operator">=</span>padding<span class="token punctuation">.</span>PSS<span class="token punctuation">.</span>MAX_LENGTH
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    hashes<span class="token punctuation">.</span>SHA256<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment"># ä½¿ç”¨å…¬é’¥éªŒè¯ç­¾å</span>
public_key<span class="token punctuation">.</span>verify<span class="token punctuation">(</span>
    signature<span class="token punctuation">,</span>
    data<span class="token punctuation">,</span>
    padding<span class="token punctuation">.</span>PSS<span class="token punctuation">(</span>
        mgf<span class="token operator">=</span>padding<span class="token punctuation">.</span>MGF1<span class="token punctuation">(</span>hashes<span class="token punctuation">.</span>SHA256<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        salt_length<span class="token operator">=</span>padding<span class="token punctuation">.</span>PSS<span class="token punctuation">.</span>MAX_LENGTH
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    hashes<span class="token punctuation">.</span>SHA256<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="_280"></a>æ€»ç»“</h3> 
<p>é€šè¿‡æœ¬æ–‡ï¼Œæ·±å…¥äº†è§£äº†cryptographyåº“çš„åŸºæœ¬æ¦‚å¿µã€å¸¸è§ç”¨æ³•ã€é«˜çº§ç‰¹æ€§ã€å®‰å…¨æ€§è€ƒè™‘ä»¥åŠåº”ç”¨åœºæ™¯ï¼Œå¹¶æä¾›äº†è¯¦ç»†çš„ç¤ºä¾‹ä»£ç ã€‚cryptographyåº“æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ä¸”å®‰å…¨å¯é çš„å¯†ç å­¦å·¥å…·åŒ…ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘äººå‘˜å®ç°å„ç§åŠ å¯†ã€è§£å¯†ã€ç­¾åã€éªŒè¯ç­‰æ“ä½œï¼Œä¿æŠ¤æ•°æ®çš„å®‰å…¨æ€§å’Œå®Œæ•´æ€§ã€‚å¸Œæœ›æœ¬æ–‡èƒ½å¤Ÿå¸®åŠ©å¤§å®¶æ›´å¥½åœ°äº†è§£å’Œåº”ç”¨cryptographyåº“ï¼Œåœ¨æ•°æ®å®‰å…¨æ–¹é¢å–å¾—æ›´å¥½çš„æˆæœï¼</p> 
<hr> 
<h2><a id="Python_285"></a>Pythonå­¦ä¹ è·¯çº¿</h2> 
<p><img src="https://images2.imgbox.com/b2/db/ATO4ngQc_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h2><a id="_287"></a>æ›´å¤šèµ„æ–™è·å–</h2> 
<p>ğŸ“š ä¸ªäººç½‘ç«™ï¼š<a href="http://ipengtao.com/" rel="nofollow">ipengtao.com</a></p> 
<p>å¦‚æœè¿˜æƒ³è¦é¢†å–æ›´å¤šæ›´ä¸°å¯Œçš„èµ„æ–™ï¼Œå¯ä»¥ç‚¹å‡»æ–‡ç« ä¸‹æ–¹åç‰‡ï¼Œå›å¤ã€<strong>ä¼˜è´¨èµ„æ–™</strong>ã€‘ï¼Œå³å¯è·å– å…¨æ–¹ä½å­¦ä¹ èµ„æ–™åŒ…ã€‚</p> 
<p><img src="https://images2.imgbox.com/7a/c1/LILz7Lxr_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> ç‚¹å‡»æ–‡ç« ä¸‹æ–¹é“¾æ¥å¡ç‰‡ï¼Œå›å¤ã€<strong>ä¼˜è´¨èµ„æ–™</strong>ã€‘ï¼Œå¯ç›´æ¥é¢†å–èµ„æ–™å¤§ç¤¼åŒ…ã€‚</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7c1f9fdad7eaf335982f6bb479d955a2/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">è½¯ä»¶æµ‹è¯•|è§£å†³ Git Push å‡ºç° â€œerror: failed to push some refs toâ€œé”™è¯¯</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4e698db148742731361a01da46aed407/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">C&#43;&#43;ä¸­æ•°ç»„ä½œä¸ºå‡½æ•°å‚æ•°ä¼ å…¥çš„å‡ ç§æ–¹å¼</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§å’–.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>