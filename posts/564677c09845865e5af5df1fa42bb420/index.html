<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>轻松上手MYSQL：MYSQL权限配置全攻略,打造安全的数据库环境 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/564677c09845865e5af5df1fa42bb420/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="轻松上手MYSQL：MYSQL权限配置全攻略,打造安全的数据库环境">
  <meta property="og:description" content="​
🌈 个人主页：danci_
🔥 系列专栏：《设计模式》《MYSQL》
💪🏻 制定明确可量化的目标，坚持默默的做事。
✨欢迎加入探索MYSQL权限配置之旅✨
👋 大家好！文本学习和探索MYSQL权限配置。👋 权限配置是保障数据安全与系统稳定的基石。《MySQL权限配置》将带您深入探索权限管理的奥秘，帮助您轻松掌握用户权限的分配与控制技巧。从基本用户设置到复杂的权限策略，本篇文章将为您提供全面的指导，让您在应对各种安全挑战时游刃有余。无论您是初学者还是资深DBA，这里都有您不可错过的实战经验与最佳实践。准备好让您的数据库更安全了吗？让我们一探究竟！
目录
一、环境
二、MySQL8 用户权限
2.1 账号管理权限
2.1.1 连接数据库
2.1.2 账号权限配置
2.2 密码管理
2.3 锁账号配置（含示例）
三、MySQL8 用户资源限制
一、环境 Windows11；Docker （中文下载：Docker中文网 官网，英文下载:Get Started | Docker，安装：一直下一步即可）；Mysql5、Mysql8.0.28。 # 下载镜像 $ docker pull mysql:8.0.28 # 创建容器并运行 $ docker run -itd --name mysql8 -p 3307:3306 -e MYSQL_ROOT_PASSWORD=root -e MYSQL_ROOT_HOST=&#39;%&#39; mysql 二、MySQL8 用户权限 在 MySQL8 之前，授权表使用 MyISAM 并且是非事务性的，而在 MySQL8 中，授权表使用 InnoDB 存储引擎并且是事务性的。通过查看创建表的语句（命令：show create table user;）来查看表的存储引擎，如下图：">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-18T21:22:27+08:00">
    <meta property="article:modified_time" content="2024-08-18T21:22:27+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">轻松上手MYSQL：MYSQL权限配置全攻略,打造安全的数据库环境</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3><a id="_0"></a></h3> 
<div> 
 <p class="img-center"><img alt="" height="87" src="https://images2.imgbox.com/9a/21/DG6dBTcq_o.png" width="83"><span title="点击并拖拽以改变尺寸">​</span></p> 
</div> 
<p> 🌈 <strong>个人主页：</strong><a href="https://blog.csdn.net/danci_" title="danci_">danci_</a><br> 🔥 <strong>系列专栏：</strong><a href="https://blog.csdn.net/danci_/category_12551117.html" title="《设计模式》">《设计模式》</a><a href="https://blog.csdn.net/danci_/category_12641052.html" title="《MYSQL》">《MYSQL》</a><br> 💪🏻 <strong>制定明确可量化的目标，坚持默默的做事。</strong></p> 
<hr> 
<div class="csdn-video-box" data-report-view='{"spm":"3001.10261","extra":{"id":"eyBKl2Pp-1723987024682"}}'> 
 <iframe id="eyBKl2Pp-1723987024682" frameborder="0" src="https://live.csdn.net/v/embed/418351" allowfullscreen="true" data-mediaembed="csdn"></iframe> 
 <p></p> 
</div> 
<p>✨欢迎加入探索MYSQL权限配置之旅✨<br>     👋 大家好！文本学习和探索MYSQL权限配置。👋 权限配置是保障数据安全与系统稳定的基石。《MySQL权限配置》将带您深入探索权限管理的奥秘，帮助您轻松掌握用户权限的分配与控制技巧。从基本用户设置到复杂的权限策略，本篇文章将为您提供全面的指导，让您在应对各种安全挑战时游刃有余。无论您是初学者还是资深DBA，这里都有您不可错过的实战经验与最佳实践。准备好让您的数据库更安全了吗？让我们一探究竟！</p> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="%C2%A0%E4%B8%80%E3%80%81%E7%8E%AF%E5%A2%83-toc" style="margin-left:0px;"><a href="#%C2%A0%E4%B8%80%E3%80%81%E7%8E%AF%E5%A2%83" rel="nofollow">一、环境</a></p> 
<p id="%E4%BA%8C%E3%80%81MySQL8%20%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81MySQL8%20%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90" rel="nofollow">二、MySQL8 用户权限</a></p> 
<p id="%E4%B8%89%E3%80%81MySQL8%20%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90-toc" style="margin-left:40px;"><a href="#%E4%B8%89%E3%80%81MySQL8%20%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90" rel="nofollow">2.1 账号管理权限</a></p> 
<p id="-toc" style="margin-left:80px;"></p> 
<p id="3.1%20%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93-toc" style="margin-left:80px;"><a href="#3.1%20%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93" rel="nofollow">2.1.1 连接数据库</a></p> 
<p id="3.2%20%E8%B4%A6%E5%8F%B7%E7%AE%A1%E7%90%86-toc" style="margin-left:80px;"><a href="#3.2%20%E8%B4%A6%E5%8F%B7%E7%AE%A1%E7%90%86" rel="nofollow">2.1.2 账号权限配置</a></p> 
<p id="3.3%20%E5%AF%86%E7%A0%81%E7%AE%A1%E7%90%86-toc" style="margin-left:40px;"><a href="#3.3%20%E5%AF%86%E7%A0%81%E7%AE%A1%E7%90%86" rel="nofollow">2.2 密码管理</a></p> 
<p id="-toc" style="margin-left:80px;"></p> 
<p id="3.4%20%E9%85%8D%E7%BD%AE%E7%99%BB%E9%99%86%E5%A4%B1%E8%B4%A5%E5%A4%9A%E6%AC%A1%E9%94%811%E5%A4%A9-toc" style="margin-left:40px;"><a href="#3.4%20%E9%85%8D%E7%BD%AE%E7%99%BB%E9%99%86%E5%A4%B1%E8%B4%A5%E5%A4%9A%E6%AC%A1%E9%94%811%E5%A4%A9" rel="nofollow">2.3 锁账号配置（含示例）</a></p> 
<p id="%E4%B8%89%E3%80%81MySQL8%20%E7%94%A8%E6%88%B7%E8%B5%84%E6%BA%90%E9%99%90%E5%88%B6-toc" style="margin-left:0px;"><a href="#%E4%B8%89%E3%80%81MySQL8%20%E7%94%A8%E6%88%B7%E8%B5%84%E6%BA%90%E9%99%90%E5%88%B6" rel="nofollow">三、MySQL8 用户资源限制</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="%C2%A0%E4%B8%80%E3%80%81%E7%8E%AF%E5%A2%83" style="background-color:transparent;">一、环境</h2> 
<p></p> 
<ul><li>Windows11；</li><li>Docker （中文下载：<a href="http://docker.p2hp.com/" rel="nofollow" title="Docker中文网 官网">Docker中文网 官网</a>，英文下载:<a href="https://www.docker.com/get-started/" rel="nofollow" title="Get Started | Docker">Get Started | Docker</a>，安装：一直下一步即可）；</li><li>Mysql5、Mysql8.0.28。</li></ul> 
<pre><code class="language-sql"># 下载镜像
$ docker pull mysql:8.0.28

# 创建容器并运行
$ docker run -itd --name mysql8 -p 3307:3306 -e MYSQL_ROOT_PASSWORD=root -e MYSQL_ROOT_HOST='%' mysql</code></pre> 
<p></p> 
<h2 id="%E4%BA%8C%E3%80%81MySQL8%20%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90" style="background-color:transparent;">二、MySQL8 用户权限</h2> 
<p></p> 
<p>        在 MySQL8 之前，授权表使用 MyISAM 并且是非事务性的，而在 MySQL8 中，授权表使用 InnoDB 存储引擎并且是事务性的。通过查看创建表的语句（命令：show create table user;）来查看表的存储引擎，如下图：</p> 
<p><img alt="" height="1102" src="https://images2.imgbox.com/65/4e/tPL5UWhs_o.png" width="1200"></p> 
<p></p> 
<p>        服务器在启动时将授权表的内容读入内存，当修改权限时需要通过命令 FLUSH PRIVILEGES 重新加载使权限生效。</p> 
<pre><code class="language-sql">user：用户帐户、静态全局权限表；
global_grants：动态全局权限表；
db：数据库级的权限表；
tables_priv：存储表级权限；
columns_priv: 存储列级权限；
procs_priv: 存储过程和函数权限表；
proxies_priv: 代理用户权限表；
default_roles：默认用户角色表；
role_edges：记录角色与用户的授权关系表；
password_history: 密码更改历史表。</code></pre> 
<p></p> 
<h3 id="%E4%B8%89%E3%80%81MySQL8%20%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90">2.1 账号管理权限</h3> 
<h4></h4> 
<h4 id="3.1%20%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93">2.1.1 连接数据库</h4> 
<pre><code class="language-sql">docker exec -it mysql3307 bash    // 回车
mysql -uroot -p //回车再输入密码</code></pre> 
<p></p> 
<p><img alt="" height="794" src="https://images2.imgbox.com/ae/76/3M0nIGer_o.png" width="1200"></p> 
<p></p> 
<pre><code class="language-sql">docker exec -it mysql3307 bash    // 回车
mysql --user=root --password    // 回车，再输入密码</code></pre> 
<p></p> 
<p><img alt="" height="746" src="https://images2.imgbox.com/ae/fa/xPbQ6Qzi_o.png" width="1200"></p> 
<p></p> 
<h4 id="3.2%20%E8%B4%A6%E5%8F%B7%E7%AE%A1%E7%90%86">2.1.2 账号权限配置</h4> 
<p></p> 
<p>创建和删除帐户<span id="cke_bm_5814C"> </span></p> 
<pre><code class="language-sql">CREATE USER 和 DROP USER 创建和删除帐户；</code></pre> 
<p></p> 
<p><span id="cke_bm_6594C"> </span>分配权限和撤销权限</p> 
<pre><code class="language-sql">GRANT 和 REVOKE 分配权限和撤销权限；</code></pre> 
<p></p> 
<p><em>示例：</em></p> 
<pre><code class="language-sql">CREATE USER 'username'@'localhost' IDENTIFIED BY 'password';  // 创建局域网络账号
GRANT ALL ON *.* TO 'username'@'localhost' WITH GRANT OPTION; // 分配权限
REVOKE ALL ON *.* FROM 'username'@'localhost';                // 撤销权限
SHOW GRANTS FOR 'username'@'localhost';                       // 查看权限
DROP USER 'username'@'localhost';                             // 删除账号</code></pre> 
<p></p> 
<p>       其它机器用户访问的用户权限配置只需要修改localhost，如 localhost修改为% 表示任意机器网络，localhost修改为192.168.2.% 表示给192.168.2这个ip连接数据库配的用户权限。</p> 
<p></p> 
<h3 id="3.3%20%E5%AF%86%E7%A0%81%E7%AE%A1%E7%90%86">2.2 密码管理</h3> 
<h4></h4> 
<p>修改密码</p> 
<pre><code class="language-sql">ALTER USER 'username'@'%' IDENTIFIED BY 'password';//修改密码</code></pre> 
<p></p> 
<p>设置密码过期时间</p> 
<pre><code class="language-sql">ALTER USER 'username'@'%' PASSWORD EXPIRE;                 //设置立即过期
ALTER USER 'username'@'%' PASSWORD EXPIRE INTERVAL 30 DAY; //设置30天过期
ALTER USER 'username'@'%' PASSWORD EXPIRE NEVER;           //禁用密码过期</code></pre> 
<p></p> 
<p>禁止重复使用最近3个或超过30天的密码</p> 
<p>修改文件 my.cnf，mysql8.0.28是/etc/my.cnf：</p> 
<pre><code class="language-sql">[mysqld]
password_history=3
password_reuse_interval=30</code></pre> 
<p></p> 
<h3 id="3.4%20%E9%85%8D%E7%BD%AE%E7%99%BB%E9%99%86%E5%A4%B1%E8%B4%A5%E5%A4%9A%E6%AC%A1%E9%94%811%E5%A4%A9">2.3 锁账号配置（含示例）</h3> 
<p></p> 
<pre><code class="language-sql"># 连续登录失败3次则锁定1天，天数可取值：0-32767，设置 0 则代表解锁
CREATE USER 'test'@'localhost' IDENTIFIED BY 'test123' FAILED_LOGIN_ATTEMPTS 7 PASSWORD_LOCK_TIME 1;
 
# 连续登录失败3次则永久锁定
ALTER USER 'try8'@'localhost' FAILED_LOGIN_ATTEMPTS 3 PASSWORD_LOCK_TIME UNBOUNDED;</code></pre> 
<p></p> 
<p>示例：</p> 
<pre><code class="language-sql"># 登陆MYSQL
PS C:\Users\Administrator&gt; docker exec -it mysql8 bash
bash-4.4# mysql -uroot -p
Enter password:                                    # 此外输入密码完成登陆
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 8
Server version: 8.2.0 MySQL Community Server - GPL
Copyright (c) 2000, 2023, Oracle and/or its affiliates.
Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.
Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.
mysql&gt;
# 登陆连续登陆失败3次锁一天的用户test
mysql&gt; CREATE USER 'test'@'localhost' IDENTIFIED BY 'test123' FAILED_LOGIN_ATTEMPTS 3 PASSWORD_LOCK_TIME 1;
Query OK, 0 rows affected (0.01 sec)
mysql&gt; FLUSH PRIVILEGES;</code></pre> 
<p></p> 
<p>打开另一终端，用正确密码测试是否登陆成功</p> 
<pre><code class="language-sql">
PS C:\Users\Administrator&gt; docker exec -it mysql8 bash
bash-4.4# mysql -utest -ptest123
mysql: [Warning] Using a password on the command line interface can be insecure.
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 9
Server version: 8.2.0 MySQL Community Server - GPL
Copyright (c) 2000, 2023, Oracle and/or its affiliates.
Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.
Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.
mysql&gt;                                # 进到这里说明登陆成功
mysql&gt; exit
Bye</code></pre> 
<p></p> 
<p>测试登陆3次失败</p> 
<pre><code class="language-sql">
bash-4.4# mysql -utest -ptest12345
mysql: [Warning] Using a password on the command line interface can be insecure.
ERROR 1045 (28000): Access denied for user 'test'@'localhost' (using password: YES)
bash-4.4# mysql -utest -ptest12345
mysql: [Warning] Using a password on the command line interface can be insecure.
ERROR 1045 (28000): Access denied for user 'test'@'localhost' (using password: YES)
bash-4.4# mysql -utest -ptest12345
mysql: [Warning] Using a password on the command line interface can be insecure.
ERROR 3955 (HY000): Access denied for user 'test'@'localhost'. Account is blocked for 1 day(s) (1 day(s) remaining) due to 3 consecutive failed logins.
bash-4.4#</code></pre> 
<p></p> 
<p>第三次输入失败后有提示  Account is blocked for 1 day(s) (1 day(s) remaining) 账号已被锁1天。</p> 
<pre><code class="language-sql"># 输入正确的用户名密码登陆看是否成功
bash-4.4# mysql -utest -ptest123
mysql: [Warning] Using a password on the command line interface can be insecure.
ERROR 3955 (HY000): Access denied for user 'test'@'localhost'. Account is blocked for 1 day(s) (1 day(s) remaining) due to 3 consecutive failed logins.
 </code></pre> 
<p>因输入错误3次被锁定，即使再输入正确的用户名和密码也无法登陆。</p> 
<p></p> 
<p>解锁</p> 
<pre><code class="language-sql">ALTER USER 'test'@'localhost' IDENTIFIED BY 'test123' FAILED_LOGIN_ATTEMPTS 3 PASSWORD_LOCK_TIME 0;</code></pre> 
<p>设置0：代表解锁。</p> 
<p></p> 
<h2 id="%E4%B8%89%E3%80%81MySQL8%20%E7%94%A8%E6%88%B7%E8%B5%84%E6%BA%90%E9%99%90%E5%88%B6" style="background-color:transparent;">三、MySQL8 用户资源限制</h2> 
<p></p> 
<p>       将全局系统变量 max_user_connections 设置为非零值，可以限制同时建立的连接数，但是对客户端连接后可以执行的查询更新操作没有限制。客户端可以发出的任何语句都计入查询限制，只有修改库表才计入更新限制。</p> 
<pre><code class="language-sql">MAX_QUERIES_PER_HOUR：客户端每小时可以发出的查询数；
MAX_UPDATES_PER_HOUR：客户端每小时可以发出的更新数；
MAX_CONNECTIONS_PER_HOUR：客户端每小时可以连接到服务器的次数；
MAX_USER_CONNECTIONS：客户端同时连接的服务器数量等。
</code></pre> 
<p></p> 
<p>通过创建用户账号限制示例：</p> 
<pre><code class="language-sql">CREATE USER 'test'@'localhost' IDENTIFIED BY 'test123'
  WITH MAX_QUERIES_PER_HOUR 10000 
  MAX_UPDATES_PER_HOUR 10000 
  MAX_CONNECTIONS_PER_HOUR 10000 
  MAX_USER_CONNECTIONS 10000 ; # 客户端每小时的查询数、更新数、连接服务器的次数和数量为10000 。</code></pre> 
<p></p> 
<p>通过修改和删除账号限制示例：</p> 
<pre><code class="language-sql">ALTER USER 'test'@'localhost' WITH MAX_QUERIES_PER_HOUR 10000; //修改限制
ALTER USER 'test'@'localhost' WITH MAX_CONNECTIONS_PER_HOUR 0; //设置0，为删除限制</code></pre> 
<p></p> 
<p>   <span style="color:#be191c;"> <span style="background-color:#fef2f0;">好了，今天分享到这里。希望你喜欢这次的探索之旅！不要忘记 "点赞" 和 "关注" 哦，我们下次见！🎈</span></span></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ee10dae0b532b7d0bfb7029260a477d7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">IOS 09 R.swift框架和使用方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2b14fe7d1ef70dbeb26765f82823eb9f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【C语言】冒泡排序保姆级教学</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>