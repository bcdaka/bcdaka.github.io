<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>密度峰值聚类(DPC)算法（Python3实现） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/fb5937f5cf78703aa19a4a2dd89e0425/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="密度峰值聚类(DPC)算法（Python3实现）">
  <meta property="og:description" content="一、密度峰值算法简介 1、密度峰值聚类算法 密度峰值聚类（Density peaks clustering, DPC）算法是由Rodriguez和Laio于2014年提出的一种聚类分析算法。其原始文献名是在在 Science上发表的，论文名称为“Clustering by Fast Search and Find of Density Peaks”。这种聚类方法该算法是一种基于密度的聚类算法，可以自动确定聚类中心和聚类的数量并适用于处理各种形状和分布的数据集
2、密度峰值聚类算法基本思想 密度峰值聚类算法要具备两个基本假设条件
聚类中心的局部密度要远远大于其临近区域数据的局部密度；密度较高的数据对象，聚类中心离它的距离相对较远。 密度峰值聚类的核心是找出最佳聚类中心，为此密度峰值聚类算法引入了
局部密度ρ 和相对距离δ两个概念。
局部密度ρ：数据点xi的局部密度为在截断距离(dc)内其他数据点的数量，其中dc是截断距离，通常取数据集样本总数1%至2%作为dc的设定值。
这就意味着如果在这个距离内有更多的数据点，那么数据点i的局部密度就会更大。常见的局部密度的计算方式有很两种，分别为使用截断核计算方式（离散）和使用高斯核函数计算（连续）。
两种方式的计算公式分别如下：
（1）截断核
ρ ( i ) = ∑ j = 1 , j ≠ i n χ ( d i j − d c ) \rho(i) = \sum_{j=1,j \neq i}^n \chi(d_{ij} - d_{c}) ρ(i)=j=1,j=i∑n​χ(dij​−dc​)
χ ( x ) = { 1 , x &lt; 0 0 , x ≥ 0 \chi(x)=\left\{ \begin{aligned} 1 &amp; ,\ x&lt;0 \\ 0 &amp; ,\ x\geq 0 \end{aligned} \right.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-27T16:14:45+08:00">
    <meta property="article:modified_time" content="2024-04-27T16:14:45+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">密度峰值聚类(DPC)算法（Python3实现）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>一、密度峰值算法简介</h2> 
<h3><a id="1_1"></a>1、密度峰值聚类算法</h3> 
<p>密度峰值聚类（Density peaks clustering, DPC）算法是由Rodriguez和Laio于2014年提出的一种聚类分析算法。其原始文献名是在在 Science上发表的，论文名称为“Clustering by Fast Search and Find of Density Peaks”。这种聚类方法该算法是一种基于密度的聚类算法，可以自动确定聚类中心和聚类的数量并适用于处理各种形状和分布的数据集</p> 
<h3><a id="2_3"></a>2、密度峰值聚类算法基本思想</h3> 
<p>密度峰值聚类算法要具备两个基本假设条件</p> 
<ol><li>聚类中心的局部密度要远远大于其临近区域数据的局部密度；</li><li>密度较高的数据对象，聚类中心离它的距离相对较远。</li></ol> 
<p>密度峰值聚类的核心是找出最佳聚类中心，为此密度峰值聚类算法引入了<br> 局部密度<em>ρ <em>和相对距离</em>δ</em>两个概念。</p> 
<ol><li><strong>局部密度<em>ρ</em></strong>：数据点<em>x</em><sub><em>i</em></sub>的局部密度为在截断距离(d<sub>c</sub>)内其他数据点的数量，其中<em>d</em><sub><em>c</em></sub>是截断距离，通常取数据集样本总数1%至2%作为<em>d</em><sub><em>c</em></sub>的设定值。<br> 这就意味着如果在这个距离内有更多的数据点，那么数据点i的局部密度就会更大。常见的局部密度的计算方式有很两种，分别为使用截断核计算方式（离散）和使用高斯核函数计算（连续）。<br> 两种方式的计算公式分别如下：<br> <strong>（1）截断核</strong><br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           ρ 
          
         
           ( 
          
         
           i 
          
         
           ) 
          
         
           = 
          
          
          
            ∑ 
           
           
           
             j 
            
           
             = 
            
           
             1 
            
           
             , 
            
           
             j 
            
           
             ≠ 
            
           
             i 
            
           
          
            n 
           
          
         
           χ 
          
         
           ( 
          
          
          
            d 
           
           
           
             i 
            
           
             j 
            
           
          
         
           − 
          
          
          
            d 
           
          
            c 
           
          
         
           ) 
          
         
        
          \rho(i) = \sum_{j=1,j \neq i}^n \chi(d_{ij} - d_{c}) 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">ρ</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3.0896em; vertical-align: -1.4382em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6514em;"><span class="" style="top: -1.8479em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span><span class="mrel mtight"><span class="mrel mtight"><span class="mord vbox mtight"><span class="thinbox mtight"><span class="rlap mtight"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="inner"><span class="mord mtight"><span class="mrel mtight"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord mathnormal mtight">i</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.4382em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">χ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           χ 
          
         
           ( 
          
         
           x 
          
         
           ) 
          
         
           = 
          
          
          
            { 
           
           
            
             
              
              
                1 
               
              
             
             
              
               
                
               
                 , 
                
               
                   
                
               
                 x 
                
               
                 &lt; 
                
               
                 0 
                
               
              
             
            
            
             
              
              
                0 
               
              
             
             
              
               
                
               
                 , 
                
               
                   
                
               
                 x 
                
               
                 ≥ 
                
               
                 0 
                
               
              
             
            
           
          
         
        
          \chi(x)=\left\{ \begin{aligned} 1 &amp; ,\ x&lt;0 \\ 0 &amp; ,\ x\geq 0 \end{aligned} \right. 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">χ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3em; vertical-align: -1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size4">{<!-- --></span></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.75em;"><span class="" style="top: -3.91em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.75em;"><span class="" style="top: -3.91em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mpunct">,</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord">0</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mpunct">,</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25em;"><span class=""></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span><br> <strong>（2）高斯核</strong><br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           ρ 
          
         
           ( 
          
         
           i 
          
         
           ) 
          
         
           = 
          
          
          
            ∑ 
           
           
           
             j 
            
           
             = 
            
           
             1 
            
           
             , 
            
           
             j 
            
           
             ≠ 
            
           
             i 
            
           
          
            n 
           
          
         
           e 
          
         
           x 
          
         
           p 
          
         
           [ 
          
         
           ( 
          
          
           
           
             d 
            
            
            
              i 
             
            
              j 
             
            
           
           
           
             d 
            
           
             c 
            
           
          
          
          
            ) 
           
          
            2 
           
          
         
           ] 
          
         
        
          \rho(i) = \sum_{j=1,j \neq i}^n exp[ ( \frac{ d_{ij}} { d_{c} } )^2] 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">ρ</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3.0896em; vertical-align: -1.4382em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6514em;"><span class="" style="top: -1.8479em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span><span class="mrel mtight"><span class="mrel mtight"><span class="mord vbox mtight"><span class="thinbox mtight"><span class="rlap mtight"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="inner"><span class="mord mtight"><span class="mrel mtight"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord mathnormal mtight">i</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.4382em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">[(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3714em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span></span><br> 其中<em>d</em><sub><em>ij</em></sub>为第i个数据与第j个数据的距离，<em>d</em><sub><em>c</em></sub>为截断距离。</li><li><strong>相对距离<em>δ</em></strong>：某个数据点到比它密度更大的最近那个数据点的距离为此数据的相对距离。<br> 如果没有比数据点<em>x</em><sub><em>i</em></sub>密度更大的数据点，那么我们将其相对距离定义为到所有其他数据点的最大距离，即<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           δ 
          
         
           ( 
          
         
           i 
          
         
           ) 
          
         
           = 
          
          
           
           
             max 
            
           
             ⁡ 
            
           
          
            j 
           
          
         
           ( 
          
          
          
            d 
           
           
           
             i 
            
           
             j 
            
           
          
         
           ) 
          
         
           ​ 
          
         
        
          \delta(i) = \max_{j} (d_{ij}) ​ 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0379em;">δ</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.6138em; vertical-align: -0.8638em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.4306em;"><span class="" style="top: -2.3723em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.8638em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">​</span></span></span></span></span></span><br> 对于其余数据点，相对距离定义为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           δ 
          
         
           ( 
          
         
           i 
          
         
           ) 
          
         
           = 
          
          
           
           
             min 
            
           
             ⁡ 
            
           
           
           
             j 
            
           
             : 
            
           
             ρ 
            
           
             ( 
            
           
             j 
            
           
             ) 
            
           
             &gt; 
            
           
             ρ 
            
           
             ( 
            
           
             i 
            
           
             ) 
            
           
          
         
           ( 
          
          
          
            d 
           
           
           
             i 
            
           
             j 
            
           
          
         
           ) 
          
         
           ​ 
          
         
        
          \delta(i) = \min_{j: \rho(j) &gt; \rho(i)} (d_{ij}) ​ 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0379em;">δ</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.716em; vertical-align: -0.966em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6679em;"><span class="" style="top: -2.309em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight">ρ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span><span class="mclose mtight">)</span><span class="mrel mtight">&gt;</span><span class="mord mathnormal mtight">ρ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.966em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">​</span></span></span></span></span></span></li></ol> 
<p>密度峰值聚类方法的核心思想是基于两个假设生成一个以<em>ρ</em>为横轴，<em>δ</em>为纵轴的图作为决策图(desision graph)，并通过决策图找到聚类中心，然后将其余的数据分别分配到距离最近的聚类中心。<br> 在决策图中需要选择数据集中 <em>ρ</em>值，<em>δ</em>值都较大的数据对象作为聚类中心。如果某个数据<em>δ</em>值都大而 <em>ρ</em>值却较小，那么它有可能是离群点。<br> <img src="https://images2.imgbox.com/85/7c/F1C1OnWy_o.png" alt="数据点分布"><br> 在上图的数据集中，计算局部密度和相对距离后构造的决策图如下：<br> <img src="https://images2.imgbox.com/59/07/XBAXgaCr_o.png" alt="决策图"><br> 通过上面的决策图可以很轻松的看出来点1和点10分别是两个聚类中心，而点26、点27和点28为离群点（噪声点）。</p> 
<h3><a id="3_47"></a>3、密度峰值聚类算法实现步骤</h3> 
<p>输入：数据集<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         X 
        
       
         = 
        
       
         { 
        
        
        
          x 
         
        
          1 
         
        
       
         , 
        
        
        
          x 
         
        
          2 
         
        
       
         , 
        
       
         … 
        
        
        
          x 
         
        
          i 
         
        
       
         , 
        
       
         … 
        
       
         , 
        
        
        
          x 
         
        
          n 
         
        
       
         } 
        
       
      
        X=\left\{\right.x_1,x_2,…x_i,…,x_n\left\}\right. 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">{<!-- --></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">}</span><span class="mclose nulldelimiter"></span></span></span></span></span></span><br> 输出：聚类中心<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         C 
        
       
         = 
        
       
         [ 
        
        
        
          c 
         
        
          1 
         
        
       
         , 
        
        
        
          c 
         
        
          2 
         
        
       
         , 
        
       
         … 
        
       
         , 
        
        
        
          c 
         
        
          k 
         
        
       
         ] 
        
       
      
        C=[c_1,c _2,…,c_k] 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span><br> Step1. 计算数据集<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         X 
        
       
         = 
        
       
         { 
        
        
        
          x 
         
        
          1 
         
        
       
         , 
        
        
        
          x 
         
        
          2 
         
        
       
         , 
        
       
         … 
        
        
        
          x 
         
        
          i 
         
        
       
         , 
        
       
         … 
        
       
         , 
        
        
        
          x 
         
        
          n 
         
        
       
         } 
        
       
      
        X=\left\{\right.x_1,x_2,…x_i,…,x_n\left\}\right. 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">{<!-- --></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">}</span><span class="mclose nulldelimiter"></span></span></span></span></span></span>中所有样本点之间的欧式距离，构建相似度矩阵，并对这些距离进行降序排序，选取前 2%大小的距离作为截断距离<em>d</em><sub><em>c</em></sub>；<br> Step2. 根据相似度矩阵和截断距离d*<sub><em>c</em></sub> ，并结合局部密度与相对距离公式计算数据集 X 中所有样本点的局部密度<em>ρ</em> 和相对距离 <em>δ</em> ；<br> Step3. 根据局部密度<em>ρ</em> 和相对距离<em>δ</em> 绘制决策图；<br> Step4. 根据决策图选择聚类中心；<br> Step5. 将剩余的样本点，按照局部密度从大到小的顺序排序，依次将其分<br> 配给局部密度比其大的最近点所在的簇。<br> <img src="https://images2.imgbox.com/66/73/A6Ycsk8L_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4_58"></a>4、密度峰值聚类算法伪代码</h3> 
<p>输入：数据集<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         X 
        
       
         = 
        
       
         { 
        
        
        
          x 
         
        
          1 
         
        
       
         , 
        
        
        
          x 
         
        
          2 
         
        
       
         , 
        
       
         … 
        
        
        
          x 
         
        
          i 
         
        
       
         , 
        
       
         … 
        
       
         , 
        
        
        
          x 
         
        
          n 
         
        
       
         } 
        
       
      
        X=\left\{\right.x_1,x_2,…x_i,…,x_n\left\}\right. 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">{<!-- --></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">}</span><span class="mclose nulldelimiter"></span></span></span></span></span></span><br> 输出：聚类中心<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         C 
        
       
         = 
        
       
         [ 
        
        
        
          c 
         
        
          1 
         
        
       
         , 
        
        
        
          c 
         
        
          2 
         
        
       
         , 
        
       
         … 
        
       
         , 
        
        
        
          c 
         
        
          k 
         
        
       
         ] 
        
       
      
        C=[c_1,c _2,…,c_k] 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span>，聚类结果CL</p> 
<pre><code>begin
01.n ← size(X) ;  //  计算距离矩阵 
02.for i ←1 to n do  
03.     for j ←1 to n do  
04.          calculate dij // 计算xi到xj的距离(distance from xi to xj)
05.     end for  
06.end for  
07.for i ← 1 to n do  
08.     calculate ρi // 计算xi的局部密度
09.end for
10.quick_sort(X, ρ,'desc') //  将数据集 X 根据局部密度降序排列 
11.calculate δ0 // 计算最大密度数据的相对距离
12.for i ← 1 to n do
13.     calculate δ  // 计算其余样本点的相对距离 
14. end for    
15.draw desision graph  // 基于局部密度值和相对距离值构造决策图
16.for i ← 1 to n do
17.     if ρi &gt; ε  and δ &gt; ε then // 如果样本点xi位于决策图的右上角
18.     C ← xi // 决策图右上角的样本点标记为聚类中心并加入集合C
19.     end if
20. end for  
21.for i ←0 to C.length do  
22.     CL(i) ← CL(nearest higher density neighbor)  // 分配剩余点 
23.end for  
24. return CL ; 
end
</code></pre> 
<h3><a id="5_89"></a>5、密度峰值聚类算法时间复杂度分析</h3> 
<p>假设给定数据规模为<em>n</em>，DPC 算法在求解相似度矩阵时的时间复杂度为O(<em>n</em><sup>2</sup>) ；计算样本点的局部密度<em>ρ</em> 和相对距离<em>δ</em> 的时间复杂度为O(<em>n</em><sup>2</sup>) ；所以 DPC 算法总的时间复杂度为O(<em>n</em><sup>2</sup>) 。</p> 
<h3><a id="6_92"></a>6、密度峰值聚类算法优缺点</h3> 
<p><strong>密度峰值聚类算法优点</strong></p> 
<ol><li>不需要预先设定聚类数量；</li><li>能发现任意形状的聚类；</li><li>具有较好的噪声抗性。</li></ol> 
<p><strong>密度峰值聚类算法缺点</strong></p> 
<ol><li>样本点的局部密度基于截断距离<em>d</em><sub><em>c</em></sub>，并没有考虑到其邻域内样本点的分布情况，因此<em>d</em><sub><em>c</em></sub>的取值对聚类结果会有较大的影响；</li><li>需要人工选取决策图右上区域内的点作为聚类中心；</li><li>计算复杂度高；</li><li>在处理密度不均数据集和复杂流型结构数据集的剩余点分配阶段，易出现因少数样本点错误分配而导致的连锁错分现象。</li></ol> 
<h2><a id="Python3_104"></a>二、密度峰值算法实现（Python3）</h2> 
<p>本文使用的数据集为UCI数据集，分别使用鸢尾花数据集Iris、葡萄酒数据集Wine、小麦种子数据集seeds进行测试，本文从UCI官网上将这三个数据集下载下来，并放入和python文件同一个文件夹内即可。同时由于程序需要，将数据集的列的位置做出了略微改动。数据集具体信息如下表：</p> 
<table><thead><tr><th>数据集</th><th>样本数</th><th>属性维度</th><th>类别个数</th></tr></thead><tbody><tr><td>Spiral</td><td>312</td><td>2</td><td>3</td></tr><tr><td>Aggregation</td><td>240</td><td>2</td><td>7</td></tr><tr><td>Jain</td><td>373</td><td>2</td><td>2</td></tr></tbody></table> 
<p><em><strong>数据集在我主页资源里有，免积分下载，如果无法下载，可以私信我。</strong></em></p> 
<h3><a id="1Python3_114"></a>1、Python3实现代码</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>decomposition <span class="token keyword">import</span> PCA
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> LabelEncoder
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> normalized_mutual_info_score  <span class="token comment"># NMI</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> rand_score  <span class="token comment"># RI</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> accuracy_score  <span class="token comment"># ACC</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> f1_score  <span class="token comment"># F-measure</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> adjusted_rand_score  <span class="token comment"># ARI</span>

<span class="token comment"># 数据保存在.csv文件中</span>
iris <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"dataset/iris.csv"</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># 鸢尾花数据集 Iris  class=3</span>
wine <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"dataset/wine.csv"</span><span class="token punctuation">)</span>  <span class="token comment"># 葡萄酒数据集 Wine  class=3</span>
seeds <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"dataset/seeds.csv"</span><span class="token punctuation">)</span>  <span class="token comment"># 小麦种子数据集 seeds  class=3</span>
wdbc <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"dataset/wdbc.csv"</span><span class="token punctuation">)</span>  <span class="token comment"># 威斯康星州乳腺癌数据集 Breast Cancer Wisconsin (Diagnostic)  class=2</span>
glass <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"dataset/glass.csv"</span><span class="token punctuation">)</span>  <span class="token comment"># 玻璃辨识数据集 Glass Identification  class=6</span>
jain <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"dataset/Jain.csv"</span><span class="token punctuation">)</span>  <span class="token comment"># 人工数据集</span>
spiral <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"dataset/spiral.csv"</span><span class="token punctuation">)</span>  <span class="token comment"># 人工数据集</span>
flame <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"dataset/Flame.csv"</span><span class="token punctuation">)</span>  <span class="token comment"># 人工数据集</span>
aggregation <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"dataset/Aggregation.csv"</span><span class="token punctuation">)</span>  <span class="token comment"># 人工数据集</span>
df <span class="token operator">=</span> spiral <span class="token comment"># 设置要读取的数据集</span>
<span class="token comment"># print(df)</span>
columns <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>  <span class="token comment"># 获取数据集的第一行，第一行通常为特征名，所以先取出</span>
features <span class="token operator">=</span> columns<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>columns<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment"># 数据集的特征名（去除了最后一列，因为最后一列存放的是标签，不是数据）</span>
dataset <span class="token operator">=</span> df<span class="token punctuation">[</span>features<span class="token punctuation">]</span>  <span class="token comment"># 预处理之后的数据，去除掉了第一行的数据（因为其为特征名，如果数据第一行不是特征名，可跳过这一步）</span>
attributes <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>columns<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span>  <span class="token comment"># 属性数量（数据集维度）</span>
original_labels <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span>columns<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 原始标签</span>


<span class="token comment"># 计算数据点两两之间的距离</span>
<span class="token keyword">def</span> <span class="token function">getDistanceMatrix</span><span class="token punctuation">(</span>datas<span class="token punctuation">)</span><span class="token punctuation">:</span>
    N<span class="token punctuation">,</span> D <span class="token operator">=</span> np<span class="token punctuation">.</span>shape<span class="token punctuation">(</span>datas<span class="token punctuation">)</span>
    dists <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span>N<span class="token punctuation">,</span> N<span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>
            vi <span class="token operator">=</span> datas<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>
            vj <span class="token operator">=</span> datas<span class="token punctuation">[</span>j<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>
            dists<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span><span class="token punctuation">(</span>vi <span class="token operator">-</span> vj<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>vi <span class="token operator">-</span> vj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> dists


<span class="token comment"># 找到密度计算的阈值dc</span>
<span class="token comment"># 要求平均每个点周围距离小于dc的点的数目占总点数的1%-2%</span>
<span class="token keyword">def</span> <span class="token function">select_dc</span><span class="token punctuation">(</span>dists<span class="token punctuation">)</span><span class="token punctuation">:</span>
    N <span class="token operator">=</span> np<span class="token punctuation">.</span>shape<span class="token punctuation">(</span>dists<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    tt <span class="token operator">=</span> np<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>dists<span class="token punctuation">,</span> N <span class="token operator">*</span> N<span class="token punctuation">)</span>
    percent <span class="token operator">=</span> <span class="token number">2.0</span>
    position <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>N <span class="token operator">*</span> <span class="token punctuation">(</span>N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> percent <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">)</span>
    dc <span class="token operator">=</span> np<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>tt<span class="token punctuation">)</span><span class="token punctuation">[</span>position <span class="token operator">+</span> N<span class="token punctuation">]</span>
    <span class="token keyword">return</span> dc


<span class="token comment"># 计算每个点的局部密度</span>
<span class="token keyword">def</span> <span class="token function">get_density</span><span class="token punctuation">(</span>dists<span class="token punctuation">,</span> dc<span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    N <span class="token operator">=</span> np<span class="token punctuation">.</span>shape<span class="token punctuation">(</span>dists<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    rho <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>N<span class="token punctuation">)</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> method <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            rho<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>dists<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> dc<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            rho<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token punctuation">(</span>dists<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">/</span> dc<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token keyword">return</span> rho


<span class="token comment"># 计算每个数据点的密度距离</span>
<span class="token comment"># 即对每个点，找到密度比它大的所有点</span>
<span class="token comment"># 再在这些点中找到距离其最近的点的距离</span>
<span class="token keyword">def</span> <span class="token function">get_deltas</span><span class="token punctuation">(</span>dists<span class="token punctuation">,</span> rho<span class="token punctuation">)</span><span class="token punctuation">:</span>
    N <span class="token operator">=</span> np<span class="token punctuation">.</span>shape<span class="token punctuation">(</span>dists<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    deltas <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>N<span class="token punctuation">)</span>
    nearest_neiber <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>N<span class="token punctuation">)</span>
    <span class="token comment"># 将密度从大到小排序</span>
    index_rho <span class="token operator">=</span> np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span><span class="token operator">-</span>rho<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i<span class="token punctuation">,</span> index <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>index_rho<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 对于密度最大的点</span>
        <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>

        <span class="token comment"># 对于其他的点</span>
        <span class="token comment"># 找到密度比其大的点的序号</span>
        index_higher_rho <span class="token operator">=</span> index_rho<span class="token punctuation">[</span><span class="token punctuation">:</span>i<span class="token punctuation">]</span>
        <span class="token comment"># 获取这些点距离当前点的距离,并找最小值</span>
        deltas<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span>dists<span class="token punctuation">[</span>index<span class="token punctuation">,</span> index_higher_rho<span class="token punctuation">]</span><span class="token punctuation">)</span>

        <span class="token comment"># 保存最近邻点的编号</span>
        index_nn <span class="token operator">=</span> np<span class="token punctuation">.</span>argmin<span class="token punctuation">(</span>dists<span class="token punctuation">[</span>index<span class="token punctuation">,</span> index_higher_rho<span class="token punctuation">]</span><span class="token punctuation">)</span>
        nearest_neiber<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> index_higher_rho<span class="token punctuation">[</span>index_nn<span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span>

    deltas<span class="token punctuation">[</span>index_rho<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>deltas<span class="token punctuation">)</span>
    <span class="token keyword">return</span> deltas<span class="token punctuation">,</span> nearest_neiber


<span class="token comment"># 选取rho与delta乘积较大的点作为聚类中心</span>
<span class="token keyword">def</span> <span class="token function">find_centers</span><span class="token punctuation">(</span>rho<span class="token punctuation">,</span> deltas<span class="token punctuation">,</span> K<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> K <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token comment"># 没有手动设置聚类数K，通过阈值选取rho与delta都大的点</span>
        rho_threshold <span class="token operator">=</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span>rho<span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>rho<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span>
        delta_threshold <span class="token operator">=</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span>deltas<span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>deltas<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span>
        N <span class="token operator">=</span> np<span class="token punctuation">.</span>shape<span class="token punctuation">(</span>rho<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        centers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> rho<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;=</span> rho_threshold <span class="token keyword">and</span> deltas<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> delta_threshold<span class="token punctuation">:</span>
                centers<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
        <span class="token keyword">return</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>centers<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token comment"># 手动输入聚类数K，选取rho与delta乘积最大的K个点作为聚类中心，作为k个中心点</span>
        rho_delta <span class="token operator">=</span> rho <span class="token operator">*</span> deltas
        centers <span class="token operator">=</span> np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span><span class="token operator">-</span>rho_delta<span class="token punctuation">)</span>
        <span class="token keyword">return</span> centers<span class="token punctuation">[</span><span class="token punctuation">:</span>K<span class="token punctuation">]</span>


<span class="token keyword">def</span> <span class="token function">cluster_PD</span><span class="token punctuation">(</span>rho<span class="token punctuation">,</span> centers<span class="token punctuation">,</span> nearest_neiber<span class="token punctuation">)</span><span class="token punctuation">:</span>
    K <span class="token operator">=</span> np<span class="token punctuation">.</span>shape<span class="token punctuation">(</span>centers<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> K <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"can not find centers"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>

    N <span class="token operator">=</span> np<span class="token punctuation">.</span>shape<span class="token punctuation">(</span>rho<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    label <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span>

    <span class="token comment"># 首先对几个聚类中进行标号</span>
    <span class="token keyword">for</span> i<span class="token punctuation">,</span> center <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>centers<span class="token punctuation">)</span><span class="token punctuation">:</span>
        label<span class="token punctuation">[</span>center<span class="token punctuation">]</span> <span class="token operator">=</span> i

    <span class="token comment"># 将密度从大到小排序</span>
    index_rho <span class="token operator">=</span> np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span><span class="token operator">-</span>rho<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i<span class="token punctuation">,</span> index <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>index_rho<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 从密度大的点进行标号</span>
        <span class="token keyword">if</span> label<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token comment"># 如果没有被标记过</span>
            <span class="token comment"># 那么聚类标号与距离其最近且密度比其大</span>
            <span class="token comment"># 的点的标号相同</span>
            label<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> label<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>nearest_neiber<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> label


<span class="token keyword">def</span> <span class="token function">draw_decision</span><span class="token punctuation">(</span>rho<span class="token punctuation">,</span> deltas<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>cla<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>shape<span class="token punctuation">(</span>datas<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>rho<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> deltas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">16.</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>annotate<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> xy<span class="token operator">=</span><span class="token punctuation">(</span>rho<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> deltas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> xytext<span class="token operator">=</span><span class="token punctuation">(</span>rho<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> deltas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"rho"</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"deltas"</span><span class="token punctuation">)</span>
    <span class="token comment"># plt.savefig(filename+"_decision.jpg")</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token comment"># 计算聚类指标</span>
<span class="token keyword">def</span> <span class="token function">clustering_indicators</span><span class="token punctuation">(</span>labels_true<span class="token punctuation">,</span> labels_pred<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token builtin">type</span><span class="token punctuation">(</span>labels_true<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token builtin">int</span><span class="token punctuation">:</span>
        labels_true <span class="token operator">=</span> LabelEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>df<span class="token punctuation">[</span>columns<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>columns<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 如果标签为文本类型，把文本标签转换为数字标签</span>
    f_measure <span class="token operator">=</span> f1_score<span class="token punctuation">(</span>labels_true<span class="token punctuation">,</span> labels_pred<span class="token punctuation">,</span> average<span class="token operator">=</span><span class="token string">'macro'</span><span class="token punctuation">)</span>  <span class="token comment"># F值</span>
    accuracy <span class="token operator">=</span> accuracy_score<span class="token punctuation">(</span>labels_true<span class="token punctuation">,</span> labels_pred<span class="token punctuation">)</span>  <span class="token comment"># ACC</span>
    normalized_mutual_information <span class="token operator">=</span> normalized_mutual_info_score<span class="token punctuation">(</span>labels_true<span class="token punctuation">,</span> labels_pred<span class="token punctuation">)</span>  <span class="token comment"># NMI</span>
    rand_index <span class="token operator">=</span> rand_score<span class="token punctuation">(</span>labels_true<span class="token punctuation">,</span> labels_pred<span class="token punctuation">)</span>  <span class="token comment"># RI</span>
    ARI <span class="token operator">=</span> adjusted_rand_score<span class="token punctuation">(</span>labels_true<span class="token punctuation">,</span> labels_pred<span class="token punctuation">)</span>
    <span class="token keyword">return</span> f_measure<span class="token punctuation">,</span> accuracy<span class="token punctuation">,</span> normalized_mutual_information<span class="token punctuation">,</span> rand_index<span class="token punctuation">,</span> ARI


<span class="token keyword">def</span> <span class="token function">draw_cluster</span><span class="token punctuation">(</span>datas<span class="token punctuation">,</span> label<span class="token punctuation">,</span> centers<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>cla<span class="token punctuation">(</span><span class="token punctuation">)</span>
    K <span class="token operator">=</span> np<span class="token punctuation">.</span>shape<span class="token punctuation">(</span>centers<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    colors <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"blue"</span><span class="token punctuation">,</span> <span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">,</span> <span class="token string">"orange"</span><span class="token punctuation">,</span> <span class="token string">"purple"</span><span class="token punctuation">,</span> <span class="token string">"cyan"</span><span class="token punctuation">,</span> <span class="token string">"magenta"</span><span class="token punctuation">,</span> <span class="token string">"beige"</span><span class="token punctuation">,</span> <span class="token string">"hotpink"</span><span class="token punctuation">,</span> <span class="token string">"#88c999"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> attributes <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">:</span>
        datas <span class="token operator">=</span> PCA<span class="token punctuation">(</span>n_components<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>datas<span class="token punctuation">)</span>  <span class="token comment"># 如果属性数量大于2，降维</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>K<span class="token punctuation">)</span><span class="token punctuation">:</span>
        plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>datas<span class="token punctuation">[</span>np<span class="token punctuation">.</span>nonzero<span class="token punctuation">(</span>label <span class="token operator">==</span> i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> datas<span class="token punctuation">[</span>np<span class="token punctuation">.</span>nonzero<span class="token punctuation">(</span>label <span class="token operator">==</span> i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span>colors<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">)</span>
        <span class="token comment"># plt.scatter(datas[centers[i], 0], datas[centers[i], 1], color="k", marker="+", s=200.)  # 聚类中心</span>
    <span class="token comment"># plt.savefig(file_name + "_cluster.jpg")</span>
    <span class="token comment"># 设置x和y坐标轴刻度的标签字体和字号</span>
    plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>fontproperties<span class="token operator">=</span><span class="token string">'Times New Roman'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">10.5</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span>fontproperties<span class="token operator">=</span><span class="token string">'Times New Roman'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">10.5</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>

    <span class="token comment"># 主程序</span>
    datas <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>dataset<span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
    <span class="token comment"># 计算距离矩阵</span>
    dists <span class="token operator">=</span> getDistanceMatrix<span class="token punctuation">(</span>datas<span class="token punctuation">)</span>
    <span class="token comment"># 计算dc</span>
    dc <span class="token operator">=</span> select_dc<span class="token punctuation">(</span>dists<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"dc"</span><span class="token punctuation">,</span> dc<span class="token punctuation">)</span>
    <span class="token comment"># 计算局部密度ρ</span>
    rho <span class="token operator">=</span> get_density<span class="token punctuation">(</span>dists<span class="token punctuation">,</span> dc<span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">"Gaussion"</span><span class="token punctuation">)</span>
    <span class="token comment"># 计算密度距离δ</span>
    deltas<span class="token punctuation">,</span> nearest_neiber <span class="token operator">=</span> get_deltas<span class="token punctuation">(</span>dists<span class="token punctuation">,</span> rho<span class="token punctuation">)</span>

    <span class="token comment"># 绘制密度/距离分布图</span>
    draw_decision<span class="token punctuation">(</span>rho<span class="token punctuation">,</span> deltas<span class="token punctuation">)</span>

    <span class="token comment"># 获取聚类中心点</span>
    centers <span class="token operator">=</span> find_centers<span class="token punctuation">(</span>rho<span class="token punctuation">,</span> deltas<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"centers"</span><span class="token punctuation">,</span> centers<span class="token punctuation">)</span>

    label <span class="token operator">=</span> cluster_PD<span class="token punctuation">(</span>rho<span class="token punctuation">,</span> centers<span class="token punctuation">,</span> nearest_neiber<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>cla<span class="token punctuation">(</span><span class="token punctuation">)</span>
    K <span class="token operator">=</span> np<span class="token punctuation">.</span>shape<span class="token punctuation">(</span>centers<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    F_measure<span class="token punctuation">,</span> ACC<span class="token punctuation">,</span> NMI<span class="token punctuation">,</span> RI<span class="token punctuation">,</span> ARI <span class="token operator">=</span> clustering_indicators<span class="token punctuation">(</span>original_labels<span class="token punctuation">,</span> label<span class="token punctuation">)</span>  <span class="token comment"># 计算聚类指标</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"F_measure:"</span><span class="token punctuation">,</span> F_measure<span class="token punctuation">,</span> <span class="token string">"ACC:"</span><span class="token punctuation">,</span> ACC<span class="token punctuation">,</span> <span class="token string">"NMI"</span><span class="token punctuation">,</span> NMI<span class="token punctuation">,</span> <span class="token string">"RI"</span><span class="token punctuation">,</span> RI<span class="token punctuation">,</span> <span class="token string">"ARI"</span><span class="token punctuation">,</span> ARI<span class="token punctuation">)</span>
    draw_cluster<span class="token punctuation">(</span>datas<span class="token punctuation">,</span> label<span class="token punctuation">,</span> centers<span class="token punctuation">)</span>

</code></pre> 
<h3><a id="2_325"></a>2、聚类指标</h3> 
<p>本文选择了F值（F-measure，FM）、准确率（Accuracy，ACC）、标准互信息（Normalized Mutual Information，NMI）和兰德指数（Rand Index，RI）作为评估指标，其值域为[0,1]，取值越大说明聚类结果越符合预期。</p> 
<p>F值结合了精度（Precision）与召回率（Recall）两种指标，它的值为精度与召回率的调和平均，其计算公式见公式：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          P 
         
        
          r 
         
        
          e 
         
        
          c 
         
        
          i 
         
        
          s 
         
        
          i 
         
        
          o 
         
        
          n 
         
        
          = 
         
         
          
          
            T 
           
          
            P 
           
          
          
          
            T 
           
          
            P 
           
          
            + 
           
          
            F 
           
          
            P 
           
          
         
        
       
         Precision=\frac{TP}{TP+FP} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span><span class="mord mathnormal">rec</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.1297em; vertical-align: -0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3603em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">TP</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">FP</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">TP</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7693em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          R 
         
        
          e 
         
        
          c 
         
        
          a 
         
        
          l 
         
        
          l 
         
        
          = 
         
         
          
          
            T 
           
          
            P 
           
          
          
          
            T 
           
          
            P 
           
          
            + 
           
          
            F 
           
          
            N 
           
          
         
        
       
         Recall=\frac{TP}{TP+FN} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="mord mathnormal">ec</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right: 0.0197em;">ll</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.1297em; vertical-align: -0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3603em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">TP</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.109em;">FN</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">TP</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7693em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          F 
         
        
          − 
         
        
          m 
         
        
          e 
         
        
          a 
         
        
          s 
         
        
          u 
         
        
          r 
         
        
          e 
         
        
          = 
         
         
          
          
            2 
           
          
            R 
           
          
            e 
           
          
            c 
           
          
            a 
           
          
            l 
           
          
            l 
           
          
            × 
           
          
            P 
           
          
            r 
           
          
            e 
           
          
            c 
           
          
            i 
           
          
            s 
           
          
            i 
           
          
            o 
           
          
            n 
           
          
          
          
            R 
           
          
            e 
           
          
            c 
           
          
            a 
           
          
            l 
           
          
            l 
           
          
            + 
           
          
            P 
           
          
            r 
           
          
            e 
           
          
            c 
           
          
            i 
           
          
            s 
           
          
            i 
           
          
            o 
           
          
            n 
           
          
         
        
       
         F-measure=\frac{2Recall \times Precision}{Recall+Precision} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">F</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal">re</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.1408em; vertical-align: -0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3714em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="mord mathnormal">ec</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right: 0.0197em;">ll</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span><span class="mord mathnormal">rec</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="mord mathnormal">ec</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right: 0.0197em;">ll</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span><span class="mord mathnormal">rec</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7693em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<p>ACC是被正确分类的样本数与数据集总样本数的比值，计算公式如下：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          A 
         
        
          C 
         
        
          C 
         
        
          = 
         
         
          
          
            T 
           
          
            P 
           
          
            + 
           
          
            T 
           
          
            N 
           
          
          
          
            T 
           
          
            P 
           
          
            + 
           
          
            T 
           
          
            N 
           
          
            + 
           
          
            F 
           
          
            P 
           
          
            + 
           
          
            F 
           
          
            N 
           
          
         
        
       
         ACC=\frac{TP+TN}{TP+TN+FP+FN} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right: 0.0715em;">CC</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.1297em; vertical-align: -0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3603em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">TP</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.109em;">TN</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">FP</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.109em;">FN</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">TP</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.109em;">TN</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7693em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<p>其中，TP（True Positive）表示将正类预测为正类数的样本个数，TN （True Negative）表示将负类预测为负类数的样本个数，FP（False Positive）表示将负类预测为正类数误报的样本个数，FN（False Negative）表示将正类预测为负类数的样本个数。</p> 
<p>NMI用于量化聚类结果和已知类别标签的匹配程度，相比于ACC，NMI的值不会受到族类标签排列的影响。计算公式如下：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          N 
         
        
          M 
         
        
          I 
         
        
          = 
         
         
          
          
            I 
           
           
           
             ( 
            
           
             U 
            
           
             , 
            
           
             V 
            
           
             ) 
            
           
          
          
           
           
             H 
            
            
            
              ( 
             
            
              U 
             
            
              ) 
             
            
           
             H 
            
            
            
              ( 
             
            
              V 
             
            
              ) 
             
            
           
          
         
        
       
         NMI=\frac{I\left(U,V\right)}{\sqrt{H\left(U\right)H\left(V\right)}} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.109em;">NM</span><span class="mord mathnormal" style="margin-right: 0.0785em;">I</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.557em; vertical-align: -1.13em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.175em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.935em;"><span class="svg-align" style="top: -3.2em;"><span class="pstrut" style="height: 3.2em;"></span><span class="mord" style="padding-left: 1em;"><span class="mord mathnormal" style="margin-right: 0.0813em;">H</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathnormal" style="margin-right: 0.109em;">U</span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0813em;">H</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathnormal" style="margin-right: 0.2222em;">V</span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span><span class="" style="top: -2.895em;"><span class="pstrut" style="height: 3.2em;"></span><span class="hide-tail" style="min-width: 1.02em; height: 1.28em;"> 
                   <svg width="400em" height="1.28em" viewbox="0 0 400000 1296" preserveaspectratio="xMinYMin slice"> 
                    <path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z"></path> 
                   </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.305em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">I</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathnormal" style="margin-right: 0.109em;">U</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.2222em;">V</span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.13em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<p>其中H(U)代表正确分类的熵，H(V)分别代表通过算法得到的结果的熵。</p> 
<p>其具体实现代吗如下：<br> <em><strong>由于数据集中给定的正确标签可能为文本类型而不是数字标签，所以在计算前先判断数据集的标签是否为数字类型，如果不是，则转化为数字类型</strong></em></p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">clustering_indicators</span><span class="token punctuation">(</span>labels_true<span class="token punctuation">,</span> labels_pred<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token builtin">type</span><span class="token punctuation">(</span>labels_true<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token builtin">int</span><span class="token punctuation">:</span>
        labels_true <span class="token operator">=</span> LabelEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>df<span class="token punctuation">[</span>columns<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>columns<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 如果标签为文本类型，把文本标签转换为数字标签</span>
    f_measure <span class="token operator">=</span> f1_score<span class="token punctuation">(</span>labels_true<span class="token punctuation">,</span> labels_pred<span class="token punctuation">,</span> average<span class="token operator">=</span><span class="token string">'macro'</span><span class="token punctuation">)</span>  <span class="token comment"># F值</span>
    accuracy <span class="token operator">=</span> accuracy_score<span class="token punctuation">(</span>labels_true<span class="token punctuation">,</span> labels_pred<span class="token punctuation">)</span>  <span class="token comment"># ACC</span>
    normalized_mutual_information <span class="token operator">=</span> normalized_mutual_info_score<span class="token punctuation">(</span>labels_true<span class="token punctuation">,</span> labels_pred<span class="token punctuation">)</span>  <span class="token comment"># NMI</span>
    rand_index <span class="token operator">=</span> rand_score<span class="token punctuation">(</span>labels_true<span class="token punctuation">,</span> labels_pred<span class="token punctuation">)</span>  <span class="token comment"># RI</span>
    <span class="token keyword">return</span> f_measure<span class="token punctuation">,</span> accuracy<span class="token punctuation">,</span> normalized_mutual_information<span class="token punctuation">,</span> rand_index


F_measure<span class="token punctuation">,</span> ACC<span class="token punctuation">,</span> NMI<span class="token punctuation">,</span> RI <span class="token operator">=</span> clustering_indicators<span class="token punctuation">(</span>labels_number<span class="token punctuation">,</span> labels<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"F_measure:"</span><span class="token punctuation">,</span> F_measure<span class="token punctuation">,</span> <span class="token string">"ACC:"</span><span class="token punctuation">,</span> ACC<span class="token punctuation">,</span> <span class="token string">"NMI"</span><span class="token punctuation">,</span> NMI<span class="token punctuation">,</span> <span class="token string">"RI"</span><span class="token punctuation">,</span> RI<span class="token punctuation">)</span>
</code></pre> 
<p>如果需要计算出聚类分析指标，只要将以上代码插入实现代码中即可。</p> 
<h3><a id="3_366"></a>3、聚类结果散点图</h3> 
<ol><li> <p>Spiral数据集<br> 原图<br> <img src="https://images2.imgbox.com/4e/b5/UcwT1CWa_o.png" alt="在这里插入图片描述"><br> 决策图：<br> <img src="https://images2.imgbox.com/1d/05/lexel6ZP_o.png" alt="在这里插入图片描述"><br> 散点图<br> <img src="https://images2.imgbox.com/2a/44/vG2m8iAC_o.png" alt="在这里插入图片描述"></p> </li><li> <p>Aggregation数据集<br> 原图<br> <img src="https://images2.imgbox.com/6a/37/RHbIS4XJ_o.png" alt="在这里插入图片描述"></p> </li></ol> 
<p>决策图：<br> <img src="https://images2.imgbox.com/be/2a/aBnXlFLU_o.png" alt="在这里插入图片描述"></p> 
<p>散点图<br> <img src="https://images2.imgbox.com/89/ab/dqDGKeZw_o.png" alt="在这里插入图片描述"></p> 
<ol start="3"><li>Jain数据集<br> 原图<br> <img src="https://images2.imgbox.com/30/79/x0aImCCT_o.png" alt="在这里插入图片描述"></li></ol> 
<p>决策图：<br> <img src="https://images2.imgbox.com/91/e1/FVTVA3Mn_o.png" alt="在这里插入图片描述"></p> 
<p>散点图<br> <img src="https://images2.imgbox.com/c4/5a/7CbCI4cG_o.png" alt="在这里插入图片描述"><br> 由上图可发现，密度峰值聚类算法Aggregation数据集和Jain数据集出现了聚类簇数目判断出错的情况，这也导致聚类结果出现了一定偏差。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4390850074a889153703782c1059f900/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Android基础入门：dataBinding的简单使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f91cdc0939efb87de2e1cd0d11ce3731/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Spring Boot3自定义异常及全局异常捕获</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>