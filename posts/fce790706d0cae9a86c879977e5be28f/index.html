<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>三分钟透彻理解Python中的@staticmethod和@classmethod - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/fce790706d0cae9a86c879977e5be28f/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="三分钟透彻理解Python中的@staticmethod和@classmethod">
  <meta property="og:description" content="三分钟透彻理解Python中的@staticmethod和@classmethod 引入Class MethodStatic Method 这篇博文主要讲解以下问题：
@classmethod和@staticmethod在Python中是什么意思，它们有何区别？我应该在何时使用它们，为什么要使用它们，以及如何使用它们？
@classmethod告诉一个类，这是一个应该被子类继承的方法，或者某种程度上是这样。然而，这样做的目的是什么呢？为什么不直接定义类方法，而不添加@classmethod、@staticmethod或任何@定义呢？
引入 虽然@classmethod和@staticmethod非常相似，但它们在用法上有轻微的区别：classmethod必须将一个类对象的引用作为第一个参数，而staticmethod可以不带任何参数。
Example:
class Date(object): def __init__(self, day=0, month=0, year=0): self.day = day self.month = month self.year = year @classmethod def from_string(cls, date_as_string): day, month, year = map(int, date_as_string.split(&#39;-&#39;)) date1 = cls(day, month, year) return date1 @staticmethod def is_date_valid(date_as_string): day, month, year = map(int, date_as_string.split(&#39;-&#39;)) return day &lt;= 31 and month &lt;= 12 and year &lt;= 3999 date2 = Date.from_string(&#39;11-09-2012&#39;) is_date = Date.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-09-15T17:52:45+08:00">
    <meta property="article:modified_time" content="2023-09-15T17:52:45+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">三分钟透彻理解Python中的@staticmethod和@classmethod</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>三分钟透彻理解Python中的@staticmethod和@classmethod</h4> 
 <ul><li><a href="#_8" rel="nofollow">引入</a></li><li><a href="#Class_Method_50" rel="nofollow">Class Method</a></li><li><a href="#Static_Method_84" rel="nofollow">Static Method</a></li></ul> 
</div> 
<p></p> 
<p>这篇博文主要讲解以下问题：</p> 
<blockquote> 
 <p>@classmethod和@staticmethod在Python中是什么意思，它们有何区别？我应该在何时使用它们，为什么要使用它们，以及如何使用它们？</p> 
</blockquote> 
<blockquote> 
 <p>@classmethod告诉一个类，这是一个应该被子类继承的方法，或者某种程度上是这样。然而，这样做的目的是什么呢？为什么不直接定义类方法，而不添加@classmethod、@staticmethod或任何@定义呢？</p> 
</blockquote> 
<h2><a id="_8"></a>引入</h2> 
<p>虽然@classmethod和@staticmethod非常相似，但它们在用法上有轻微的区别：<strong>classmethod必须将一个类对象的引用作为第一个参数，而staticmethod可以不带任何参数</strong>。</p> 
<p><em><strong>Example:</strong></em></p> 
<pre><code class="prism language-matlab">class <span class="token function">Date</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token operator">:</span>
    
    def <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> day<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> month<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> year<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">:</span>
        self<span class="token punctuation">.</span>day <span class="token operator">=</span> day
        self<span class="token punctuation">.</span>month <span class="token operator">=</span> month
        self<span class="token punctuation">.</span>year <span class="token operator">=</span> year

    <span class="token operator">@</span>classmethod
    def <span class="token function">from_string</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> date_as_string<span class="token punctuation">)</span><span class="token operator">:</span>
        day<span class="token punctuation">,</span> month<span class="token punctuation">,</span> year <span class="token operator">=</span> <span class="token function">map</span><span class="token punctuation">(</span>int<span class="token punctuation">,</span> date_as_string<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        date1 <span class="token operator">=</span> <span class="token function">cls</span><span class="token punctuation">(</span>day<span class="token punctuation">,</span> month<span class="token punctuation">,</span> year<span class="token punctuation">)</span>
        <span class="token keyword">return</span> date1

    <span class="token operator">@</span>staticmethod
    def <span class="token function">is_date_valid</span><span class="token punctuation">(</span>date_as_string<span class="token punctuation">)</span><span class="token operator">:</span>
        day<span class="token punctuation">,</span> month<span class="token punctuation">,</span> year <span class="token operator">=</span> <span class="token function">map</span><span class="token punctuation">(</span>int<span class="token punctuation">,</span> date_as_string<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> day <span class="token operator">&lt;=</span> <span class="token number">31</span> and month <span class="token operator">&lt;=</span> <span class="token number">12</span> and year <span class="token operator">&lt;=</span> <span class="token number">3999</span>

date2 <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">from_string</span><span class="token punctuation">(</span><span class="token string">'11-09-2012'</span><span class="token punctuation">)</span>
is_date <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">is_date_valid</span><span class="token punctuation">(</span><span class="token string">'11-09-2012'</span><span class="token punctuation">)</span>
</code></pre> 
<p><em><strong>Explanation:</strong></em><br> 让我们假设一个处理日期信息的类的示例（这将是我们的模板）：</p> 
<pre><code class="prism language-matlab">class <span class="token function">Date</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token operator">:</span>
    
    def <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> day<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> month<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> year<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">:</span>
        self<span class="token punctuation">.</span>day <span class="token operator">=</span> day
        self<span class="token punctuation">.</span>month <span class="token operator">=</span> month
        self<span class="token punctuation">.</span>year <span class="token operator">=</span> year
</code></pre> 
<p>这个类显然可以用来存储关于特定日期的信息（不包含时区信息；让我们假设所有日期都以UTC时区表示）。</p> 
<p>这里有一个<code>__init__</code>，是Python类实例的典型初始化方法，它接收参数作为典型的实例方法，第一个非可选参数（<code>self</code>）用于保存对新创建实例的引用。</p> 
<h2><a id="Class_Method_50"></a>Class Method</h2> 
<p>有些任务可以很好地使用classmethod完成。</p> 
<p>假设我们想要创建大量的<code>Date</code>类实例，这些实例包含来自外部源的日期信息，以字符串格式 ‘dd-mm-yyyy’ 编码。假设我们在项目源代码的不同位置都需要执行这个操作。</p> 
<p>因此，在这里我们需要做的是：</p> 
<p>1、解析字符串以获取日期、月份和年份，将它们作为三个整数变量或一个包含这些变量的3项元组。<br> 2、通过将这些值传递给初始化调用来实例化<code>Date</code>类。<br> 这将看起来像这样：</p> 
<pre><code class="prism language-matlab">day<span class="token punctuation">,</span> month<span class="token punctuation">,</span> year <span class="token operator">=</span> <span class="token function">map</span><span class="token punctuation">(</span>int<span class="token punctuation">,</span> string_date<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
date1 <span class="token operator">=</span> <span class="token function">Date</span><span class="token punctuation">(</span>day<span class="token punctuation">,</span> month<span class="token punctuation">,</span> year<span class="token punctuation">)</span>
</code></pre> 
<p>为了实现这个目的，C++可以通过重载来实现这样的特性，但Python缺乏这种重载功能。相反，我们可以使用classmethod。让我们创建另一个构造函数。</p> 
<pre><code class="prism language-matlab">    <span class="token operator">@</span>classmethod
    def <span class="token function">from_string</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> date_as_string<span class="token punctuation">)</span><span class="token operator">:</span>
        day<span class="token punctuation">,</span> month<span class="token punctuation">,</span> year <span class="token operator">=</span> <span class="token function">map</span><span class="token punctuation">(</span>int<span class="token punctuation">,</span> date_as_string<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        date1 <span class="token operator">=</span> <span class="token function">cls</span><span class="token punctuation">(</span>day<span class="token punctuation">,</span> month<span class="token punctuation">,</span> year<span class="token punctuation">)</span>
        <span class="token keyword">return</span> date1

date2 <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">from_string</span><span class="token punctuation">(</span><span class="token string">'11-09-2012'</span><span class="token punctuation">)</span>
</code></pre> 
<p>让我们仔细看一下上面的实现，并回顾一下这里的优点：</p> 
<ol><li>我们在一个地方实现了日期字符串的解析，并且现在可以重复使用它。</li><li>封装在这里运作良好（如果您认为您可以在其他地方将字符串解析实现为一个单独的函数，那么这个解决方案更符合面向对象编程范式）。</li><li><code>cls</code> 代表的是类本身，而不是类的实例。这相当酷，因为如果我们继承了我们的 <code>Date</code> 类，所有的子类也都会有 <code>from_string</code> 方法。</li></ol> 
<h2><a id="Static_Method_84"></a>Static Method</h2> 
<p>那么staticmethod呢？它与classmethod非常相似，但不需要任何必须的参数（就像类方法或实例方法那样）。</p> 
<p>让我们看下一个使用情景。</p> 
<p>我们有一个日期字符串，我们想要以某种方式对其进行验证。这个任务在逻辑上也与我们迄今使用的<code>Date</code>类相关，但不需要对其进行实例化。</p> 
<p>这正是staticmethod可以派上用场的地方。让我们来看下面的代码片段：</p> 
<pre><code class="prism language-matlab">    <span class="token operator">@</span>staticmethod
    def <span class="token function">is_date_valid</span><span class="token punctuation">(</span>date_as_string<span class="token punctuation">)</span><span class="token operator">:</span>
        day<span class="token punctuation">,</span> month<span class="token punctuation">,</span> year <span class="token operator">=</span> <span class="token function">map</span><span class="token punctuation">(</span>int<span class="token punctuation">,</span> date_as_string<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> day <span class="token operator">&lt;=</span> <span class="token number">31</span> and month <span class="token operator">&lt;=</span> <span class="token number">12</span> and year <span class="token operator">&lt;=</span> <span class="token number">3999</span>

# usage<span class="token operator">:</span>
is_date <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">is_date_valid</span><span class="token punctuation">(</span><span class="token string">'11-09-2012'</span><span class="token punctuation">)</span>
</code></pre> 
<p>因此，从使用staticmethod的情况可以看出，我们无法访问类的内容——它基本上只是一个函数，从语法上看像是一个方法，但没有访问对象及其内部（字段和其他方法）的权限，而classmethod却有这种权限。</p> 
<p>如果在@staticmethod中要调用到这个类的一些属性方法，只能直接类名.属性名或类名.方法名。而@classmethod因为持有<code>cls</code>参数，可以来调用类的属性，类的方法，实例化对象等，避免硬编码。也就是说在classmethod中可以调用类中定义的其他方法、类的属性，但staticmethod只能通过A.a调用类的属性，但无法通过在该函数内部调用<code>A.foo2()</code>。用代码加以说明：</p> 
<pre><code class="prism language-matlab">class <span class="token function">A</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token operator">:</span>
    a <span class="token operator">=</span> <span class="token string">'a'</span>
    <span class="token operator">@</span>staticmethod
    def <span class="token function">foo1</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token operator">:</span>
        print <span class="token string">'hello'</span><span class="token punctuation">,</span> name
        print A<span class="token punctuation">.</span>a # 正常
        print A<span class="token punctuation">.</span><span class="token function">foo2</span><span class="token punctuation">(</span><span class="token string">'mamq'</span><span class="token punctuation">)</span> # 报错<span class="token operator">:</span> unbound method <span class="token function">foo2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> must be called with A instance as first <span class="token function">argument</span> <span class="token punctuation">(</span>got str instance instead<span class="token punctuation">)</span>
    def <span class="token function">foo2</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token operator">:</span>
        print <span class="token string">'hello'</span><span class="token punctuation">,</span> name
    <span class="token operator">@</span>classmethod
    def <span class="token function">foo3</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token operator">:</span>
        print <span class="token string">'hello'</span><span class="token punctuation">,</span> name
        print A<span class="token punctuation">.</span>a
        print <span class="token function">cls</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">foo2</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0a48607d82ad8be515a7375bdc20bbd0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">nginx配置详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2a344d9d41d249e8d423f64f47bdfbd2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java 转换 WebP 图片，使用 webp-imageio</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>