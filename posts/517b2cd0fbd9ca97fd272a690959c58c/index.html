<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【C&#43;&#43;笔记】类和对象的深入理解(一) - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/517b2cd0fbd9ca97fd272a690959c58c/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【C&#43;&#43;笔记】类和对象的深入理解(一)">
  <meta property="og:description" content="【C&#43;&#43;笔记】类和对象的深入理解(一) 🔥个人主页：大白的编程日记
🔥专栏：C&#43;&#43;笔记
文章目录 【C&#43;&#43;笔记】类和对象的深入理解(一)前言一.类的定义1.1类定义格式1.2访问限定符1.3类域 二.实例化2.1 实例化概念2.2对象大小 三.this指针四.练习五. C&#43;&#43;和C语言实现Stack对比后言 前言 哈喽，各位小伙伴大家好！上期我们讲了C&#43;&#43;的引用。今天我们就开始学习C&#43;&#43;的重点—类和对象。话不多说，咱们进入正题！向大厂冲锋！
一.类的定义 C语言的结构体只能放变量。而C&#43;&#43;的类除了能放成员变量，还能放成员函数。
1.1类定义格式 定义格式
例如我们用类定义一个栈。可以这样写 class为定义类的关键字，Stack为类的名字，{}中为类的主体，注意类定义结束时后面分号不能省略。类体中内容称为类的成员：类中的变量称为类的属性或成员变量;类中的函数称为类的方法或者成员函数。
class Stack//类名就是类型 { // 成员函数 void Init(int n = 4) { array = (int*)malloc(sizeof(int) * n); if (nullptr == array) { perror(&#34;malloc申请空间失败&#34;); return; } capacity = n; top = 0; } void Push(int x) { // ...扩容 array[top&#43;&#43;] = x; } int Top() { assert(top &gt; 0); return array[top - 1]; } void Destroy() { free(array); array = nullptr; top = capacity = 0; } private: // 成员变量 int* array; size_t capacity; size_t top; }; //分号不能省略 成员变量和函数可以在类位置可以任意顺序。一般成员在下，函数在上。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-29T21:44:36+08:00">
    <meta property="article:modified_time" content="2024-08-29T21:44:36+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【C&#43;&#43;笔记】类和对象的深入理解(一)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="C_1"></a>【C++笔记】类和对象的深入理解(一)</h2> 
<p><img src="https://images2.imgbox.com/a9/a9/wDeF1tpy_o.gif" alt=""></p> 
<p><font color="pink" size="4"><b>🔥个人主页</b>：<a href="https://blog.csdn.net/2301_81670477?spm=1011.2415.3001.5343"><font color="#33CCCC" size="4"><b>大白的编程日记</b></font></a></font></p> 
<p><font color="pink" size="4">🔥<strong>专栏</strong></font>：<a href="https://blog.csdn.net/2301_81670477/category_12758635.html"><font color="#33CCCC" size="4"><b>C++笔记</b></font></a><br> <img src="https://images2.imgbox.com/61/b2/97YuZf7u_o.gif" alt=""></p> 
<hr> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#C_1" rel="nofollow">【C++笔记】类和对象的深入理解(一)</a></li><li><ul><li><a href="#_15" rel="nofollow">前言</a></li><li><a href="#_20" rel="nofollow">一.类的定义</a></li><li><ul><li><a href="#11_22" rel="nofollow">1.1类定义格式</a></li><li><a href="#12_83" rel="nofollow">1.2访问限定符</a></li><li><a href="#13_102" rel="nofollow">1.3类域</a></li></ul> 
   </li><li><a href="#_126" rel="nofollow">二.实例化</a></li><li><ul><li><a href="#21__127" rel="nofollow">2.1 实例化概念</a></li><li><a href="#22_170" rel="nofollow">2.2对象大小</a></li></ul> 
   </li><li><a href="#this_290" rel="nofollow">三.this指针</a></li><li><a href="#_385" rel="nofollow">四.练习</a></li><li><a href="#_CCStack_454" rel="nofollow">五. C++和C语言实现Stack对比</a></li><li><a href="#_554" rel="nofollow">后言</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_15"></a>前言</h3> 
<blockquote> 
 <p>哈喽，各位小伙伴大家好！上期我们讲了C++的引用。今天我们就开始学习C++的重点—类和对象。话不多说，咱们进入正题！向大厂冲锋！<br> <img src="https://images2.imgbox.com/ee/c9/bvSIfDb1_o.gif" alt=""></p> 
</blockquote> 
<h3><a id="_20"></a>一.类的定义</h3> 
<p>C语言的结构体只能放变量。而C++的类除了能放成员变量，还能放成员函数。</p> 
<h4><a id="11_22"></a>1.1类定义格式</h4> 
<ul><li>定义格式<br> 例如我们用类定义一个栈。可以这样写</li></ul> 
<blockquote> 
 <p>class为定义类的关键字，Stack为类的名字，{}中为类的主体，注意类定义结束时后面分号不能省略。类体中内容称为类的成员：类中的变量称为类的属性或成员变量;类中的函数称为类的方法或者成员函数。</p> 
</blockquote> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Stack</span><span class="token comment">//类名就是类型</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 成员函数</span>
      <span class="token keyword">void</span> <span class="token function">Init</span><span class="token punctuation">(</span><span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span>
      <span class="token punctuation">{<!-- --></span>
        array <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token operator">*</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">nullptr</span> <span class="token operator">==</span> array<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"malloc申请空间失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        capacity <span class="token operator">=</span> n<span class="token punctuation">;</span>
        top <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Push</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// ...扩容</span>
        array<span class="token punctuation">[</span>top<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">int</span> <span class="token function">Top</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">assert</span><span class="token punctuation">(</span>top <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> array<span class="token punctuation">[</span>top <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">free</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token punctuation">;</span>
        array <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
        top <span class="token operator">=</span> capacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token comment">// 成员变量</span>
    <span class="token keyword">int</span><span class="token operator">*</span> array<span class="token punctuation">;</span>
    size_t capacity<span class="token punctuation">;</span>
    size_t top<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">//分号不能省略</span>
</code></pre> 
<p>成员变量和函数可以在类位置可以任意顺序。一般成员在下，函数在上。</p> 
<ul><li> <p>成员标识<br> 为了区分成员变量，⼀般习惯上成员变量会加⼀个特殊标识，如成员变量前⾯或者后面加_或者m开头，注意C++中这个并不是强制的，只是⼀些惯例，具体看公司的要求。</p> </li><li> <p>struct<br> C++中struct也可以定义类，C++兼容C中struct的用法，同时struct升级成了类，明显的变化是struct中可以定义函数，⼀般情况下我们还是推荐⽤class定义类。</p> </li><li> <p>类名<br> 类的名字就是类的类型。所以我们定义类直接用类名定义即可。</p> </li><li> <p>默认内联<br> 定义在类面的成员函数默认为inline。但声明和定义分离。声明在类里就不是内联了。</p> </li></ul> 
<p><img src="https://images2.imgbox.com/f5/5d/N4mzrEPU_o.png" alt=""></p> 
<h4><a id="12_83"></a>1.2访问限定符</h4> 
<p>C++⼀种实现封装的方式，用类将对象的属性与方法结合在一块，让对象更加完善，通过访问权限选择性的将其接口(函数)提供给外部的用户使用。<br> <img src="https://images2.imgbox.com/27/00/tRO3CVce_o.png" alt=""></p> 
<ul><li> <p>限定符<br> public修饰的成员在类外可以直接被访问；protected和private修饰的成员在类外不能直接被访问，protected和private目前可以认为是⼀样的，以后继承章节才能体现出他们的区别。<br> <img src="https://images2.imgbox.com/cb/d6/cCN3zKlu_o.png" alt=""></p> </li><li> <p>限定范围<br> 访问权限作用域从该访问限定符出现的位置开始直到下⼀个访问限定符出现时为止，如果后面没有访问限定符，作用域就到—} 即类结束。一种访问可以出现多次。但一般同一作用域放在一起。<br> <img src="https://images2.imgbox.com/4a/e7/Jddhi18j_o.png" alt=""></p> </li><li> <p>struct和class<br> class定义成员没有被访问限定符修饰时默认为private，struct默认为public。</p> </li><li> <p>使用场景<br> ⼀般成员变量都会被限制为private/protected，需要给别人使用的成员函数会放为public。因为一般我们不想别人修改我们数据，只需要给别人调用我的函数接口。</p> </li></ul> 
<h4><a id="13_102"></a>1.3类域</h4> 
<ul><li> <p>域<br> 类定义了⼀个新的作用域，类的所有成员都在类的作用域中，在类体外定义成员时，需要使用::作用域操作符指明成员属于哪个类域。</p> </li><li> <p>编译查找<br> 类域影响的是编译的查找规则，下面程序中Init如果不指定类域Stack，那么编译器就把Init当成全局函数，那么编译时，找不到array等成员的声明/定义在哪里，就会报错。指定类域Stack，就是知道Init是成员函数，当前域找不到的array等成员，就会到类域中去查找。</p> </li></ul> 
<pre><code class="prism language-cpp"><span class="token comment">// 声明和定义分离，需要指定类域</span>
 
<span class="token keyword">void</span> <span class="token class-name">Stack</span><span class="token double-colon punctuation">::</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span>
 <span class="token punctuation">{<!-- --></span>
   array <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token operator">*</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">nullptr</span> <span class="token operator">==</span> array<span class="token punctuation">)</span>
   <span class="token punctuation">{<!-- --></span>
   <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"malloc申请空间失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   capacity <span class="token operator">=</span> n<span class="token punctuation">;</span>
   top <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_126"></a>二.实例化</h3> 
<h4><a id="21__127"></a>2.1 实例化概念</h4> 
<ul><li>定义<br> 用类类型在物理内存中创建对象的过程，称为类实例化出对象。</li><li>实例化<br> 类是对象进行⼀种抽象描述，是⼀个模型⼀样的东西，限定了类有哪些成员变量，这些成员变量只是声明，没有分配空间，用类实例化出对象时，才会分配空间</li></ul> 
<p><img src="https://images2.imgbox.com/e5/56/cwT6vRva_o.png" alt=""></p> 
<ul><li>多次实例化<br> ⼀个类可以实例化出多个对象，实例化出的对象 占⽤实际的物理空间，存储类成员变量。<br> 打个比方：类实例化出对象就像现实中使用建筑设计图建造出房子，类就像是设计图，设计图规划了有多少个房间，房间大小功能等，但是并没有实体的建筑存在，也不能住⼈，用设计图修建出房子，房⼦才能住人。同样类就像设计图⼀样，不能存储数据，实例化出的对象分配物理内存存储数据。</li></ul> 
<p><img src="https://images2.imgbox.com/2d/c0/6oVJFZ3c_o.png" alt=""><br> 把类看作一个建筑图，简单来说实例化就是将根据建筑图建出房子。一个建筑图可以建出多个房子。也就是实例化多个对象。</p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span><span class="token comment">//类(建筑图)</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">Init</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        _year <span class="token operator">=</span> year<span class="token punctuation">;</span>
        _month <span class="token operator">=</span> month<span class="token punctuation">;</span>
        _day <span class="token operator">=</span> day<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cout <span class="token operator">&lt;&lt;</span> _year <span class="token operator">&lt;&lt;</span> <span class="token string">"/"</span> <span class="token operator">&lt;&lt;</span> _month <span class="token operator">&lt;&lt;</span> <span class="token string">"/"</span> <span class="token operator">&lt;&lt;</span> _day <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token comment">// 这⾥只是声明，没有开空间</span>
    <span class="token keyword">int</span> _year<span class="token punctuation">;</span>
    <span class="token keyword">int</span> _month<span class="token punctuation">;</span>
    <span class="token keyword">int</span> _day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// Date类实例化出对象d1 d2</span>
    Date d1<span class="token punctuation">;</span>
    Date d2<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="22_170"></a>2.2对象大小</h4> 
<ul><li>存储对象<br> 一个类对象大小还得看他里面存储的是啥。<br> 先说结论类里面只存储了类成员变量。不存储成员函数。<br> 那如果不存储成员函数如何找到函数呢？<br> <img src="https://images2.imgbox.com/54/d8/OPjQkzK2_o.png" alt=""></li></ul> 
<blockquote> 
 <p>首先函数被编译后是⼀段指令，对象中没办法存储，这些指令存储在⼀个单独的区域(代码段)，那么对象中非要存储的话，只能是成员函数的指针。</p> 
</blockquote> 
<p>那为什么又不存储函数指针呢？</p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">Init</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        _year <span class="token operator">=</span> year<span class="token punctuation">;</span>
        _month <span class="token operator">=</span> month<span class="token punctuation">;</span>
        _day <span class="token operator">=</span> day<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cout <span class="token operator">&lt;&lt;</span> _year <span class="token operator">&lt;&lt;</span> <span class="token string">"/"</span> <span class="token operator">&lt;&lt;</span> _month <span class="token operator">&lt;&lt;</span> <span class="token string">"/"</span> <span class="token operator">&lt;&lt;</span> _day <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token comment">// 这⾥只是声明，没有开空间</span>
    <span class="token keyword">int</span> _year<span class="token punctuation">;</span>
    <span class="token keyword">int</span> _month<span class="token punctuation">;</span>
    <span class="token keyword">int</span> _day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// Date类实例化出对象d1 d2</span>
    Date d1<span class="token punctuation">;</span>
    Date d2<span class="token punctuation">;</span>
    d1<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token number">2024</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    d1<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    d2<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token number">2024</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    d2<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>以这段日期类代码来说。D1和D2执行的函数我们通过代码转化的汇编指令可以看到他们执行的函数都是同一个函数。<br> <img src="https://images2.imgbox.com/9b/5c/7C29wSLL_o.png" alt=""></p> 
<blockquote> 
 <p>那再分析⼀下，对象中是否有存储指针的必要呢，Date实例化d1和d2两个对象，d1和d2都有各自独立的成员变量_year/_month/_day存储各自的数据，但是d1和d2的成员函数Init/Print指针却是⼀样的，存储在对象中就浪费了。如果用Date实例化100个对象，那么成员函数指针就重复存储100次，太浪费了。</p> 
</blockquote> 
<p>那如果不存储函数指针调用时又如何找到函数呢？</p> 
<blockquote> 
 <p>其实函数指针是不需要存储的，函数指针是⼀个地址，调用函数被编译成汇编指 令[call<br> 地址]，其实编译器在编译链接时，就要找到函数的地址，不是在运行时找，只有动态多态是在运行时找，就需要存储函数地址，这个我们以后会讲解。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/af/ee/AfY4EiBo_o.png" alt=""><br> <img src="https://images2.imgbox.com/73/c9/mU9FYB9S_o.png" alt=""></p> 
<ul><li>内存对齐<br> 上面我们分析了对象中只存储成员变量，C++规定类实例化的对象也要符合内存对齐的规则。内存对齐的规则和C语言保持一致。<br> <img src="https://images2.imgbox.com/2f/c3/sen1RiZ7_o.png" alt=""></li></ul> 
<pre><code class="prism language-cpp"><span class="token comment">// 计算⼀下</span>
A实例化的对象是多⼤？
 
<span class="token keyword">class</span> <span class="token class-name">A</span>
 <span class="token punctuation">{<!-- --></span>
 <span class="token keyword">public</span><span class="token operator">:</span>
 <span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token punctuation">{<!-- --></span>
 cout <span class="token operator">&lt;&lt;</span> _ch <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">private</span><span class="token operator">:</span>
 <span class="token keyword">char</span> _ch<span class="token punctuation">;</span>
 <span class="token keyword">int</span> _i<span class="token punctuation">;</span>
 <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f7/24/zuvYopL6_o.png" alt=""></p> 
<ul><li>占位</li></ul> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">A</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cout <span class="token operator">&lt;&lt;</span> _ch <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">char</span> _ch<span class="token punctuation">;</span>
    <span class="token keyword">int</span> _i<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">B</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">C</span>
<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    A a<span class="token punctuation">;</span>
    B b<span class="token punctuation">;</span>
    C c<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>这里我们看一下ABC三个类对象的大小是多少。<br> <img src="https://images2.imgbox.com/2b/fb/f4BsHQqL_o.png" alt=""><br> A是8没问题。可是B和C都没有成员变量。前面我们说类只存储成员变量。<br> 那他们没有为什么不是0呢？<br> 因为如果⼀个字节都不给，那他地址是多少？如果定义多个B对象怎么区分？怎么表示对象存在过呢！所以这里给1字节，纯粹是为了占位标识对象存在。</p> 
<h3><a id="this_290"></a>三.this指针</h3> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">Init</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        _year <span class="token operator">=</span> year<span class="token punctuation">;</span>
        _month <span class="token operator">=</span> month<span class="token punctuation">;</span>
        _day <span class="token operator">=</span> day<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cout <span class="token operator">&lt;&lt;</span> _year <span class="token operator">&lt;&lt;</span> <span class="token string">"/"</span> <span class="token operator">&lt;&lt;</span> _month <span class="token operator">&lt;&lt;</span> <span class="token string">"/"</span> <span class="token operator">&lt;&lt;</span> _day <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token comment">// 这⾥只是声明，没有开空间</span>
    <span class="token keyword">int</span> _year<span class="token punctuation">;</span>
    <span class="token keyword">int</span> _month<span class="token punctuation">;</span>
    <span class="token keyword">int</span> _day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// Date类实例化出对象d1d2</span>
    Date d1<span class="token punctuation">;</span>
    Date d2<span class="token punctuation">;</span>
    d1<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token number">2024</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    d1<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    d2<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token number">2024</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    d2<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>这里我们定义d1和d2两个类对象。<br> <img src="https://images2.imgbox.com/16/05/YMBgEksX_o.png" alt=""><br> 这里我们打印分别两个日期类。<br> <img src="https://images2.imgbox.com/dc/e5/VE0mAINK_o.png" alt="在这里插入图片描述"><br> 前面我们说了不同类对象调用的函数都是同一个函数。而且参数都是无参的。<br> 那当d1和d2调用Init和Print函数时，该函数是如何知道应该访问的是d1对象还是d2对象呢？那么这里就要看到C++给了⼀个隐含的this指针解决这里的问题。</p> 
<ul><li>隐含的this指针<br> 编译器编译后，类的成员函数默认都会在形参第⼀个位置，增加⼀个当前类类型的指针，叫做this指针。比如Date类的Init的真实原型为<br> void Init(Date* const this, int year, int month, int day)</li></ul> 
<pre><code class="prism language-cpp"> <span class="token keyword">void</span> <span class="token function">Prin</span><span class="token punctuation">(</span>Date<span class="token operator">*</span> <span class="token keyword">const</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token comment">//原型</span>
 <span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token punctuation">{<!-- --></span>
     cout <span class="token operator">&lt;&lt;</span> _year <span class="token operator">&lt;&lt;</span> <span class="token string">"/"</span> <span class="token operator">&lt;&lt;</span> _month <span class="token operator">&lt;&lt;</span> <span class="token string">"/"</span> <span class="token operator">&lt;&lt;</span> _day <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre> 
<p>那this指针是什么呢？</p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// Date类实例化出对象d1d2</span>
    Date d1<span class="token punctuation">;</span>
    Date d2<span class="token punctuation">;</span>
    d1<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token number">2024</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    d1<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>d1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    d2<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token number">2024</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    d2<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>d2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>函数调用时编译器会自己把类对象的地址传过去。<br> 所以this就是类对象的地址。</p> 
<ul><li>this访问<br> 类的成员函数中访问成员变量，本质都是通过this指针访问的，如Init函数中给_year赋值，this-&gt;_year = year;</li></ul> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">Init</span><span class="token punctuation">(</span>Date<span class="token operator">*</span> <span class="token keyword">const</span> <span class="token keyword">this</span><span class="token punctuation">,</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span>_year <span class="token operator">=</span> year<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span>_month <span class="token operator">=</span> month<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span>_day <span class="token operator">=</span> day<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//void Prin(Date* const this)//原型</span>
<span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span>Date<span class="token operator">*</span> <span class="token keyword">const</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>_year <span class="token operator">&lt;&lt;</span> <span class="token string">"/"</span> <span class="token operator">&lt;&lt;</span><span class="token keyword">this</span><span class="token operator">-&gt;</span> _month <span class="token operator">&lt;&lt;</span> <span class="token string">"/"</span> <span class="token operator">&lt;&lt;</span><span class="token keyword">this</span><span class="token operator">-&gt;</span> _day <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>函数内部编译器会自动加上this指针。<br> 这样函数就可以调用通过this指针访问不同类对象的成员变量。<br> 所以就可以打印不同的日期类。</p> 
<ul><li>规定<br> C++规定不能在实参和形参的位置显示的写this指针(编译时编译器会处理)，但是可以在函数体内显示使用this指针。<br> <img src="https://images2.imgbox.com/12/9b/dc6V7KFj_o.png" alt=""></li></ul> 
<h3><a id="_385"></a>四.练习</h3> 
<p>为了加深学的知识印象。我们接下来做几个题目看看对知识的掌握如何。</p> 
<ul><li>练习一<br> <img src="https://images2.imgbox.com/f7/bc/FdakYJ1r_o.png" alt=""></li></ul> 
<p>首先排出E选项。为什么？前面我们说了类对象里面只存储成员变量。<br> 其次又因为this指针是形参。形参是存储在栈帧里面。所以选A比较合理。<br> 但是VS下因为this指针会频繁使用，所以把this指针放在寄存器里面。<br> 这可以认为是VS做的优化。<br> <img src="https://images2.imgbox.com/d9/76/WfuEz6dY_o.png" alt=""></p> 
<ul><li>练习二<br> <img src="https://images2.imgbox.com/55/98/UAn5XfsH_o.png" alt=""></li></ul> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">A</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"A::Print()"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">int</span> _a<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    A<span class="token operator">*</span> p <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
    p<span class="token operator">-&gt;</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>有人会觉得这对空指针解引用了。那就会运行崩溃。选B。<br> <img src="https://images2.imgbox.com/d1/96/ynNofMd1_o.png" alt=""><br> 其实不是。是正常运行。<br> <img src="https://images2.imgbox.com/f7/26/yBvT1eNQ_o.png" alt=""><br> 我们从汇编底层来看。这段代码会去call和jmp成员函数的地址。<br> 那成员函数在不在p里面。不在，因为前面我们说类对象只存储成员变量。不存储成员函数的地址。<br> 所以p就是为了为了让编译器知道去A这个类找Prit函数和传递this指针。<br> 所以p是类对象的地址也就是this。this就是空指针。<br> <img src="https://images2.imgbox.com/19/70/0qkxkafW_o.png" alt=""><br> 所以这段程序没有对空指针解引用。虽然this指针是空指针。所以正常运行。<br> <img src="https://images2.imgbox.com/41/8f/ABKQs6QV_o.png" alt=""><br> 但是对this解引用就会崩溃。</p> 
<ul><li>练习三<br> <img src="https://images2.imgbox.com/4b/71/MXmAs91C_o.png" alt=""></li></ul> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">A</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"A::Print()"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> _a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">int</span> _a<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    A<span class="token operator">*</span> p <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span><span class="token comment">//成员函数空指针</span>
    p<span class="token operator">-&gt;</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//为了让编译器知道去A这个类找Prit函数和传递this指针</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>这时就和我们前说的一样。_a访问是通过隐含的this指针访问。this指针是空指针。就会崩溃。<br> <img src="https://images2.imgbox.com/20/6f/BS8M4yMJ_o.png" alt=""></p> 
<h3><a id="_CCStack_454"></a>五. C++和C语言实现Stack对比</h3> 
<p>面向对象三大特性：封装、继承、多态，下面的对比我们可以初步了解⼀下封装。<br> 通过下面两份代码对比，我们发现C++实现Stack形态上还是发生了挺多的变化，底层和逻辑上没啥变化。</p> 
<p>C++实现栈：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">Push</span><span class="token punctuation">(</span>STDataType x<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_top <span class="token operator">==</span> _capacity<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> newcapacity <span class="token operator">=</span> _capacity <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
        STDataType<span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token punctuation">(</span>STDataType<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">realloc</span><span class="token punctuation">(</span>_a<span class="token punctuation">,</span> newcapacity <span class="token operator">*</span>
            <span class="token keyword">sizeof</span><span class="token punctuation">(</span>STDataType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>tmp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"realloc fail"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        _a <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
        _capacity <span class="token operator">=</span> newcapacity<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    _a<span class="token punctuation">[</span>_top<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">Pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">assert</span><span class="token punctuation">(</span>_top <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">--</span>_top<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">bool</span> <span class="token function">Empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> _top <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">Top</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">assert</span><span class="token punctuation">(</span>_top <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> _a<span class="token punctuation">[</span>_top <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">Destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">free</span><span class="token punctuation">(</span>_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    _a <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
    _top <span class="token operator">=</span> _capacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>C语言实现栈：</p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">STDestroy</span><span class="token punctuation">(</span>ST<span class="token operator">*</span> ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">assert</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">free</span><span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ps<span class="token operator">-&gt;</span>a <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    ps<span class="token operator">-&gt;</span>top <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>capacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">STPush</span><span class="token punctuation">(</span>ST<span class="token operator">*</span> ps<span class="token punctuation">,</span> STDataType x<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">assert</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 满了，扩容</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>top <span class="token operator">==</span> ps<span class="token operator">-&gt;</span>capacity<span class="token punctuation">)</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> newcapacity <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>capacity <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">4</span> <span class="token operator">:</span> ps<span class="token operator">-&gt;</span>capacity <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
    STDataType<span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token punctuation">(</span>STDataType<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">realloc</span><span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>a<span class="token punctuation">,</span> newcapacity <span class="token operator">*</span>
        <span class="token keyword">sizeof</span><span class="token punctuation">(</span>STDataType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tmp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"realloc fail"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ps<span class="token operator">-&gt;</span>a <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
    ps<span class="token operator">-&gt;</span>capacity <span class="token operator">=</span> newcapacity<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
  ps<span class="token operator">-&gt;</span>a<span class="token punctuation">[</span>ps<span class="token operator">-&gt;</span>top<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">;</span>
  ps<span class="token operator">-&gt;</span>top<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
bool <span class="token function">STEmpty</span><span class="token punctuation">(</span>ST<span class="token operator">*</span> ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">assert</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> ps<span class="token operator">-&gt;</span>top <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">STPop</span><span class="token punctuation">(</span>ST<span class="token operator">*</span> ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">assert</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">assert</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">STEmpty</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ps<span class="token operator">-&gt;</span>top<span class="token operator">--</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
STDataType <span class="token function">STTop</span><span class="token punctuation">(</span>ST<span class="token operator">*</span> ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">assert</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">assert</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">STEmpty</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> ps<span class="token operator">-&gt;</span>a<span class="token punctuation">[</span>ps<span class="token operator">-&gt;</span>top <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<ul><li>封装<br> C++中数据和函数都放到了类里面，通过访问限定符进行了限制，不能再随意通过对象直接修改数据，这是C++封装的⼀种体现，这个是最重要的变化。这⾥的封装的本质是⼀种更严格规范的管理，避免出现乱访问修改的问题。当然封装不仅仅是这样的，我们后面还需要不断的去学习。</li><li>方便<br> C++中有⼀些相对方便的语法，比如Init给的缺省参数会⽅便很多，成员函数每次不需要传对象地址，因为this指针隐含的传递了，⽅便了很多，使⽤类型不再需要typedef用类名就很方便</li></ul> 
<p>在我们这个C++入门阶段实现的Stack看起来变了很多，但是实质上变化不大。等着我们后面看STL中的用适配器实现的Stack，大家再感受C++的魅力。</p> 
<h3><a id="_554"></a>后言</h3> 
<blockquote> 
 <p>这就是类和对象的初步了解。类和对象内柔多，大家一定要多加掌握。今天就分享到这，咱们下期见！拜拜~</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/6f/50/sIGzqqZZ_o.gif" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/86711b29349bc5413a3b151b35991b80/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Git和SVN了解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/85d5de8bd0b6c9b5fd730b03bd983dd9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Go锁 详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>