<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vue3 &#43; jspdf &#43; echarts 前端生成 pdf报告 预览&#43;下载 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/6462469fbe267b46ff7d2ee833bbf75e/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="vue3 &#43; jspdf &#43; echarts 前端生成 pdf报告 预览&#43;下载">
  <meta property="og:description" content="一、导包 1、导入
yarn add jspdf yarn add jspdf-autotable 2、界面引入
import jsPDF from &#39;jspdf&#39;; // 表格插件,这次我这边没用到, 根据需求选择 import &#39;jspdf-autotable&#39;; 3、创建pdf对象
// 创建一个新的PDF文档实例 // 定义页面边距 const PAGE_MARGIN = 10; const doc = new jsPDF({ unit: &#39;mm&#39;, // 单位，本示例为mm format: &#39;a4&#39;, // 页面大小 orientation: &#39;portrait&#39;, // 页面方向，portrait: 纵向，landscape: 横向 putOnlyUsedFonts: true, // 只包含使用的字体 compress: true, // 压缩文档 precision: 16 // 浮点数的精度 }); // 设置第一页内容 doc.setPage(1); // 设置字体，第二个参数为fontStyle，引入的字体是什么fontStyle就设置成什么，如果这里要使用blod粗体，则需要再引入转换后的粗体字体文件 doc.setFont(&#39;SourceHanSerifCN-Regular&#39;, &#39;normal&#39;); // 添加第一页内容 doc.addImage(getAssetsFile(&#39;images/xfaq.png&#39;), &#39;JPEG&#39;, 13, 10, 183, 50); // 添加标题 doc.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-12-27T15:15:35+08:00">
    <meta property="article:modified_time" content="2023-12-27T15:15:35+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vue3 &#43; jspdf &#43; echarts 前端生成 pdf报告 预览&#43;下载</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>一、导包</h2> 
<p>1、导入</p> 
<pre><code class="prism language-javascript">yarn add jspdf
yarn add jspdf<span class="token operator">-</span>autotable
</code></pre> 
<p>2、界面引入</p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> jsPDF <span class="token keyword">from</span> <span class="token string">'jspdf'</span><span class="token punctuation">;</span>
<span class="token comment">// 表格插件,这次我这边没用到, 根据需求选择</span>
<span class="token keyword">import</span> <span class="token string">'jspdf-autotable'</span><span class="token punctuation">;</span>
</code></pre> 
<p>3、创建pdf对象</p> 
<pre><code class="prism language-javascript"><span class="token comment">// 创建一个新的PDF文档实例</span>
  <span class="token comment">// 定义页面边距</span>
  <span class="token keyword">const</span> <span class="token constant">PAGE_MARGIN</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> doc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">jsPDF</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">unit</span><span class="token operator">:</span> <span class="token string">'mm'</span><span class="token punctuation">,</span> <span class="token comment">// 单位，本示例为mm</span>
    <span class="token literal-property property">format</span><span class="token operator">:</span> <span class="token string">'a4'</span><span class="token punctuation">,</span> <span class="token comment">// 页面大小</span>
    <span class="token literal-property property">orientation</span><span class="token operator">:</span> <span class="token string">'portrait'</span><span class="token punctuation">,</span> <span class="token comment">// 页面方向，portrait: 纵向，landscape: 横向</span>
    <span class="token literal-property property">putOnlyUsedFonts</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 只包含使用的字体</span>
    <span class="token literal-property property">compress</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 压缩文档</span>
    <span class="token literal-property property">precision</span><span class="token operator">:</span> <span class="token number">16</span> <span class="token comment">// 浮点数的精度</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 设置第一页内容</span>
  doc<span class="token punctuation">.</span><span class="token function">setPage</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 设置字体，第二个参数为fontStyle，引入的字体是什么fontStyle就设置成什么，如果这里要使用blod粗体，则需要再引入转换后的粗体字体文件</span>
  doc<span class="token punctuation">.</span><span class="token function">setFont</span><span class="token punctuation">(</span><span class="token string">'SourceHanSerifCN-Regular'</span><span class="token punctuation">,</span> <span class="token string">'normal'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 添加第一页内容</span>
  doc<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span><span class="token function">getAssetsFile</span><span class="token punctuation">(</span><span class="token string">'images/xfaq.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'JPEG'</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">183</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 添加标题</span>
  doc<span class="token punctuation">.</span><span class="token function">setFontSize</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 调整为适合你的字体大小</span>
</code></pre> 
<h2><a id="_35"></a>二、引入中文字体</h2> 
<p>1、下载思源黑体字体<br> 链接: <a href="https://github.com/Pal3love/Source-Han-TrueType/releases">下载地址</a><br> 2、转换字体，打开jspdf提供的在线字体转化网站:<br> 链接: <a href="https://rawgit.com/MrRio/jsPDF/master/fontconverter/fontconverter.html" rel="nofollow">转换地址</a><br> 不同的字体样式，选择不同的fontStyle<br> 转换完毕后:<br> <img src="https://images2.imgbox.com/6b/21/mPklIovv_o.png" alt="字体js"><br> 3、引入转换后字体文件</p> 
<pre><code class="prism language-javascript"><span class="token comment">// 引入转换后字体文件</span>
<span class="token keyword">import</span> <span class="token string">'@/assets/fonts/SourceHanSerifCN-Regular-normal.js'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'@/assets/fonts/SourceHanSerifCN-SemiBold-bold.js'</span><span class="token punctuation">;</span>
</code></pre> 
<p>4、界面使用</p> 
<pre><code class="prism language-javascript"><span class="token comment">// 设置字体，第二个参数为fontStyle，引入的字体是什么fontStyle就设置成什么，</span>
<span class="token comment">// 如果这里要使用blod粗体，则需要再引入转换后的粗体字体文件</span>
doc<span class="token punctuation">.</span><span class="token function">setFont</span><span class="token punctuation">(</span><span class="token string">'SourceHanSerifCN-Regular'</span><span class="token punctuation">,</span> <span class="token string">'normal'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
doc<span class="token punctuation">.</span><span class="token function">setFont</span><span class="token punctuation">(</span><span class="token string">'SourceHanSerifCN-SemiBold'</span><span class="token punctuation">,</span> <span class="token string">'bold'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 请确保已经引入了粗体字体</span>
</code></pre> 
<h2><a id="echarts_56"></a>三、引入echarts图表</h2> 
<p>对于pdf中图表来说,目前采用echarts图表方式比较合适,<br> 注意事项:<br> 1、多图表渲染比较耗时, 其中要解决同步异步的问题, 采用 await 方式解决<br> 2、需要等到上一个页面的图表渲染完毕后,才能进入到下一页的内容生成, 否则会出现图表错页的问题</p> 
<p>1、option 数据</p> 
<pre><code class="prism language-javascript"><span class="token keyword">let</span> onePdfEchartsCfg <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">option</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
          <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">'设备总计'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token string">'200'</span><span class="token punctuation">,</span> <span class="token comment">// 这里将 x 的值调整为 '20'</span>
          <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span> <span class="token comment">// 这里将 y 的值调整为 '20'</span>
          <span class="token literal-property property">textStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">fontSize</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
            <span class="token literal-property property">fontWeight</span><span class="token operator">:</span> <span class="token string">'bold'</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
          <span class="token literal-property property">text</span><span class="token operator">:</span> deviceTypeSumDataTotal<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
          <span class="token literal-property property">subtext</span><span class="token operator">:</span> <span class="token string">'设备总数'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">textStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">fontSize</span><span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
            <span class="token literal-property property">fontWeight</span><span class="token operator">:</span> <span class="token string">'bold'</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token literal-property property">tooltip</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">trigger</span><span class="token operator">:</span> <span class="token string">'item'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">formatter</span><span class="token operator">:</span> <span class="token string">'{a} &lt;br/&gt;{b}: {c} ({d}%)'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">legend</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token string">'middle'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">right</span><span class="token operator">:</span> <span class="token string">'5%'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">orient</span><span class="token operator">:</span> <span class="token string">'vertical'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">'circle'</span><span class="token punctuation">,</span>
        <span class="token function-variable function">formatter</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">const</span> seriesData <span class="token operator">=</span> deviceTypeSumData<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
          <span class="token keyword">const</span> total <span class="token operator">=</span> seriesData<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">acc<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> acc <span class="token operator">+</span> cur<span class="token punctuation">.</span>value<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">const</span> dataIndex <span class="token operator">=</span> seriesData<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>name <span class="token operator">===</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">const</span> value <span class="token operator">=</span> seriesData<span class="token punctuation">[</span>dataIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
          <span class="token comment">// 添加条件判断，避免除法错误</span>
          <span class="token keyword">const</span> percentage <span class="token operator">=</span> total <span class="token operator">!==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>value <span class="token operator">/</span> total<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>percentage<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">%</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">series</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
          <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Access From'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'pie'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">radius</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'40%'</span><span class="token punctuation">,</span> <span class="token string">'70%'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token literal-property property">avoidLabelOverlap</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
          <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token string">'center'</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token literal-property property">emphasis</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
              <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
              <span class="token literal-property property">fontSize</span><span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
              <span class="token literal-property property">fontWeight</span><span class="token operator">:</span> <span class="token string">'bold'</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token literal-property property">labelLine</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">false</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token literal-property property">data</span><span class="token operator">:</span> deviceTypeSumData<span class="token punctuation">.</span>value
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span>
    <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">135</span><span class="token punctuation">,</span>
    <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">120</span><span class="token punctuation">,</span>
    <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> deviceTypeSumData<span class="token punctuation">.</span>value
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">option</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
          <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">'设备在线率'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token string">'200'</span><span class="token punctuation">,</span> <span class="token comment">// 这里将 x 的值调整为 '20'</span>
          <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span> <span class="token comment">// 这里将 y 的值调整为 '20'</span>
          <span class="token literal-property property">textStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">fontSize</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
            <span class="token literal-property property">fontWeight</span><span class="token operator">:</span> <span class="token string">'bold'</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
          <span class="token literal-property property">text</span><span class="token operator">:</span> deviceTypeSumDataTotal<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
          <span class="token literal-property property">subtext</span><span class="token operator">:</span> <span class="token string">'设备总数'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">textStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">fontSize</span><span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
            <span class="token literal-property property">fontWeight</span><span class="token operator">:</span> <span class="token string">'bold'</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token literal-property property">tooltip</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">trigger</span><span class="token operator">:</span> <span class="token string">'item'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">formatter</span><span class="token operator">:</span> <span class="token string">'{a} &lt;br/&gt;{b}: {c} ({d}%)'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">legend</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token string">'middle'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">right</span><span class="token operator">:</span> <span class="token string">'5%'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">orient</span><span class="token operator">:</span> <span class="token string">'vertical'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">'circle'</span><span class="token punctuation">,</span>
        <span class="token function-variable function">formatter</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">const</span> seriesData <span class="token operator">=</span> deviceOnlineData<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
          <span class="token keyword">const</span> total <span class="token operator">=</span> seriesData<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">acc<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> acc <span class="token operator">+</span> cur<span class="token punctuation">.</span>value<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">const</span> dataIndex <span class="token operator">=</span> seriesData<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>name <span class="token operator">===</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">const</span> value <span class="token operator">=</span> seriesData<span class="token punctuation">[</span>dataIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
          <span class="token keyword">const</span> percentage <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>value <span class="token operator">/</span> total<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>percentage<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">%</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">series</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
          <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Access From'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'pie'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">radius</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'40%'</span><span class="token punctuation">,</span> <span class="token string">'70%'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token literal-property property">avoidLabelOverlap</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
          <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token string">'center'</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token literal-property property">emphasis</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
              <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
              <span class="token literal-property property">fontSize</span><span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
              <span class="token literal-property property">fontWeight</span><span class="token operator">:</span> <span class="token string">'bold'</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token literal-property property">labelLine</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">false</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token literal-property property">data</span><span class="token operator">:</span> deviceOnlineData<span class="token punctuation">.</span>value
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span>
    <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">135</span><span class="token punctuation">,</span>
    <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">120</span><span class="token punctuation">,</span>
    <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">50</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>2、添加图表</p> 
<pre><code class="prism language-javascript"> <span class="token comment">// 在第二页添加echarts图表</span>
  onePdfEchartsCfg<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{<!-- --></span> option<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> data <span class="token punctuation">}</span><span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 插入图表图片到 jsPDF 文档</span>
    <span class="token keyword">await</span> <span class="token function">generateOnePDF</span><span class="token punctuation">(</span>option<span class="token punctuation">,</span> doc<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> data<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<p>3、图表方法</p> 
<pre><code class="prism language-javascript"><span class="token keyword">function</span> <span class="token function">generateOnePDF</span><span class="token punctuation">(</span><span class="token parameter">option<span class="token punctuation">,</span> doc<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> data<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 创建一个包含 ECharts 图表的 div 元素</span>
  <span class="token keyword">const</span> chartContainer <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  chartContainer<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token string">'700px'</span><span class="token punctuation">;</span>
  chartContainer<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token string">'300px'</span><span class="token punctuation">;</span>
  chartContainer<span class="token punctuation">.</span>style<span class="token punctuation">.</span>marginLeft <span class="token operator">=</span> <span class="token string">'50px'</span><span class="token punctuation">;</span> <span class="token comment">// 设置左边距</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>chartContainer<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 使用 ECharts 在 chartContainer 中生成图表</span>
  <span class="token keyword">const</span> chart <span class="token operator">=</span> echarts<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>chartContainer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  chart<span class="token punctuation">.</span><span class="token function">setOption</span><span class="token punctuation">(</span>option<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 监听图表渲染完成事件</span>
  chart<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'finished'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 获取 ECharts 图表的数据 URL</span>
    <span class="token keyword">const</span> dataURL <span class="token operator">=</span> chart<span class="token punctuation">.</span><span class="token function">getDataURL</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'png'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 移除图表容器</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>chartContainer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 将图表数据 URL 转换为图像</span>
    <span class="token keyword">const</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    img<span class="token punctuation">.</span>src <span class="token operator">=</span> dataURL<span class="token punctuation">;</span>

	<span class="token comment">// 指定图表的页码</span>
    doc<span class="token punctuation">.</span><span class="token function">setPage</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 在 PDF 中添加图表图像</span>
    doc<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token string">'JPEG'</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 如果是最后一个图表，生成下一页, 解决图表错页的问题</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">===</span> onePdfEchartsCfg<span class="token punctuation">.</span>value<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">generateTwoPage</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>



</code></pre> 
<h2><a id="_258"></a>四、完整代码</h2> 
<p>目前缺少后端接口支撑, 前端先mock一些数据展示, 代码还有很多优化的空间,后续抽时间再调整一波, 有问题或者好的建议,随时评论哈</p> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> mockData <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">'11月'</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">oneTitleText</span><span class="token operator">:</span> <span class="token string">'XXXXX月报'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">oneDateText</span><span class="token operator">:</span> <span class="token string">'2023年11月01日-2023年11月30日'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">oneCompanyNameContent</span><span class="token operator">:</span> <span class="token string">'XXXXX公司'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">oneBottomDateText</span><span class="token operator">:</span> <span class="token string">'2023年11月30日'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">overviewModule</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">allDevice</span><span class="token operator">:</span> <span class="token string">'3'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">addDevice</span><span class="token operator">:</span> <span class="token string">'3'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">allCompany</span><span class="token operator">:</span> <span class="token string">'3'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">addCompany</span><span class="token operator">:</span> <span class="token string">'3'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">addsDevice</span><span class="token operator">:</span> <span class="token string">'3'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">addsCompany</span><span class="token operator">:</span> <span class="token string">'3'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">addAlarm</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">stopAlarm</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">stopAlarmTime</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">waitAlarm</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">trueFireAlarm</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">addWarnDevice</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">stopWarnDevice</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">waitWarnDevice</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">deviceOnlineRate</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">onlineDevice</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">offlineDevice</span><span class="token operator">:</span> <span class="token string">'0'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">fireDeviceModule</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 缺图表的数据</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">alarmModule</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 缺图表的数据</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">faultModule</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 缺图表的数据</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">'10月'</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">oneTitleText</span><span class="token operator">:</span> <span class="token string">'XXXXX月报'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">oneDateText</span><span class="token operator">:</span> <span class="token string">'2023年10月01日-2023年10月31日'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">oneCompanyNameContent</span><span class="token operator">:</span> <span class="token string">'XXXXX公司'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">oneBottomDateText</span><span class="token operator">:</span> <span class="token string">'2023年10月31日'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">overviewModule</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">allDevice</span><span class="token operator">:</span> <span class="token string">'3'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">addDevice</span><span class="token operator">:</span> <span class="token string">'3'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">allCompany</span><span class="token operator">:</span> <span class="token string">'3'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">addCompany</span><span class="token operator">:</span> <span class="token string">'3'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">addsDevice</span><span class="token operator">:</span> <span class="token string">'3'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">addsCompany</span><span class="token operator">:</span> <span class="token string">'3'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">addAlarm</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">stopAlarm</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">stopAlarmTime</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">waitAlarm</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">trueFireAlarm</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">addWarnDevice</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">stopWarnDevice</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">waitWarnDevice</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">deviceOnlineRate</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">onlineDevice</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">offlineDevice</span><span class="token operator">:</span> <span class="token string">'0'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">fireDeviceModule</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 缺图表的数据</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">alarmModule</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 缺图表的数据</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">faultModule</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 缺图表的数据</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">'2022年'</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">oneTitleText</span><span class="token operator">:</span> <span class="token string">'XXXXX年报'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">oneDateText</span><span class="token operator">:</span> <span class="token string">'2022年01月01日-2022年12月31日'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">oneCompanyNameContent</span><span class="token operator">:</span> <span class="token string">'XXXXX公司'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">oneBottomDateText</span><span class="token operator">:</span> <span class="token string">'2022年12月31日'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">overviewModule</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">allDevice</span><span class="token operator">:</span> <span class="token string">'3'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">addDevice</span><span class="token operator">:</span> <span class="token string">'3'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">allCompany</span><span class="token operator">:</span> <span class="token string">'3'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">addCompany</span><span class="token operator">:</span> <span class="token string">'3'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">addsDevice</span><span class="token operator">:</span> <span class="token string">'3'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">addsCompany</span><span class="token operator">:</span> <span class="token string">'3'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">addAlarm</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">stopAlarm</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">stopAlarmTime</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">waitAlarm</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">trueFireAlarm</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">addWarnDevice</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">stopWarnDevice</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">waitWarnDevice</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">deviceOnlineRate</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">onlineDevice</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">offlineDevice</span><span class="token operator">:</span> <span class="token string">'0'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">fireDeviceModule</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 缺图表的数据</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">alarmModule</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 缺图表的数据</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">faultModule</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 缺图表的数据</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 预览报告</span>
<span class="token keyword">const</span> <span class="token function-variable function">previewBt</span> <span class="token operator">=</span> <span class="token parameter">o</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>o<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'月'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    name <span class="token operator">=</span> <span class="token string">'运营商运营消防安全月报-2023年'</span> <span class="token operator">+</span> o<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
    name <span class="token operator">=</span> <span class="token string">'运营商运营消防安全年报-'</span> <span class="token operator">+</span> o<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 缺少去后台拉取数据接口 模拟</span>
  pdfData <span class="token operator">=</span> mockData<span class="token punctuation">.</span>value<span class="token punctuation">[</span>o<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> doc <span class="token operator">=</span> <span class="token function">productReport</span><span class="token punctuation">(</span><span class="token string">'preview'</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 下载报告</span>
<span class="token keyword">const</span> <span class="token function-variable function">downloadBt</span> <span class="token operator">=</span> <span class="token parameter">o</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>o<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'月'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    name <span class="token operator">=</span> <span class="token string">'运营商运营消防安全月报-2023年'</span> <span class="token operator">+</span> o<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
    name <span class="token operator">=</span> <span class="token string">'运营商运营消防安全年报-'</span> <span class="token operator">+</span> o<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 缺少去后台拉取数据接口</span>
  pdfData <span class="token operator">=</span> mockData<span class="token punctuation">.</span>value<span class="token punctuation">[</span>o<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> doc <span class="token operator">=</span> <span class="token function">productReport</span><span class="token punctuation">(</span><span class="token string">'download'</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">productReport</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> name</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 显示加载动画</span>
  <span class="token keyword">const</span> loading <span class="token operator">=</span> ElLoading<span class="token punctuation">.</span><span class="token function">service</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">lock</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">'正在生成报告'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">background</span><span class="token operator">:</span> <span class="token string">'rgba(0, 0, 0, 0.7)'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 创建一个新的PDF文档实例</span>
  <span class="token comment">// 定义页面边距</span>
  <span class="token keyword">const</span> <span class="token constant">PAGE_MARGIN</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> doc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">jsPDF</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">unit</span><span class="token operator">:</span> <span class="token string">'mm'</span><span class="token punctuation">,</span> <span class="token comment">// 单位，本示例为mm</span>
    <span class="token literal-property property">format</span><span class="token operator">:</span> <span class="token string">'a4'</span><span class="token punctuation">,</span> <span class="token comment">// 页面大小</span>
    <span class="token literal-property property">orientation</span><span class="token operator">:</span> <span class="token string">'portrait'</span><span class="token punctuation">,</span> <span class="token comment">// 页面方向，portrait: 纵向，landscape: 横向</span>
    <span class="token literal-property property">putOnlyUsedFonts</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 只包含使用的字体</span>
    <span class="token literal-property property">compress</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 压缩文档</span>
    <span class="token literal-property property">precision</span><span class="token operator">:</span> <span class="token number">16</span> <span class="token comment">// 浮点数的精度</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 设置第一页内容</span>
  doc<span class="token punctuation">.</span><span class="token function">setPage</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 设置字体，第二个参数为fontStyle，引入的字体是什么fontStyle就设置成什么，如果这里要使用blod粗体，则需要再引入转换后的粗体字体文件</span>
  doc<span class="token punctuation">.</span><span class="token function">setFont</span><span class="token punctuation">(</span><span class="token string">'SourceHanSerifCN-Regular'</span><span class="token punctuation">,</span> <span class="token string">'normal'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 添加第一页内容</span>
  doc<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span><span class="token function">getAssetsFile</span><span class="token punctuation">(</span><span class="token string">'images/xfaq.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'JPEG'</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">183</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 添加标题</span>
  doc<span class="token punctuation">.</span><span class="token function">setFontSize</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 调整为适合你的字体大小</span>
  <span class="token keyword">const</span> textWidth <span class="token operator">=</span>
    <span class="token punctuation">(</span>doc<span class="token punctuation">.</span><span class="token function">getStringUnitWidth</span><span class="token punctuation">(</span>pdfData<span class="token punctuation">.</span>oneTitleText<span class="token punctuation">)</span> <span class="token operator">*</span> doc<span class="token punctuation">.</span>internal<span class="token punctuation">.</span><span class="token function">getFontSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> doc<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>scaleFactor<span class="token punctuation">;</span>
  <span class="token keyword">const</span> textX <span class="token operator">=</span> <span class="token punctuation">(</span>doc<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>pageSize<span class="token punctuation">.</span>width <span class="token operator">-</span> textWidth<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> textY <span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">;</span> <span class="token comment">// 调整为适合你的位置</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>pdfData<span class="token punctuation">.</span>oneTitleText<span class="token punctuation">,</span> textX<span class="token punctuation">,</span> textY<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 添加日期</span>
  <span class="token keyword">const</span> dateFontSize <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">setFontSize</span><span class="token punctuation">(</span>dateFontSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> dateWidth <span class="token operator">=</span> <span class="token punctuation">(</span>doc<span class="token punctuation">.</span><span class="token function">getStringUnitWidth</span><span class="token punctuation">(</span>pdfData<span class="token punctuation">.</span>oneDateText<span class="token punctuation">)</span> <span class="token operator">*</span> dateFontSize<span class="token punctuation">)</span> <span class="token operator">/</span> doc<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>scaleFactor<span class="token punctuation">;</span>
  <span class="token keyword">const</span> dateX <span class="token operator">=</span> <span class="token punctuation">(</span>doc<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>pageSize<span class="token punctuation">.</span>width <span class="token operator">-</span> dateWidth<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> dateY <span class="token operator">=</span> textY <span class="token operator">+</span> doc<span class="token punctuation">.</span><span class="token function">getTextDimensions</span><span class="token punctuation">(</span>pdfData<span class="token punctuation">.</span>oneTitleText<span class="token punctuation">)</span><span class="token punctuation">.</span>h <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>pdfData<span class="token punctuation">.</span>oneDateText<span class="token punctuation">,</span> dateX<span class="token punctuation">,</span> dateY<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 计算 "值守商名称：" 文本宽度</span>
  <span class="token keyword">const</span> companyNameLabel <span class="token operator">=</span> <span class="token string">'值守商名称：'</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> companyNameLabelFontSize <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> companyNameLabelWidth <span class="token operator">=</span>
    <span class="token punctuation">(</span>doc<span class="token punctuation">.</span><span class="token function">getStringUnitWidth</span><span class="token punctuation">(</span>companyNameLabel<span class="token punctuation">)</span> <span class="token operator">*</span> companyNameLabelFontSize<span class="token punctuation">)</span> <span class="token operator">/</span> doc<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>scaleFactor<span class="token punctuation">;</span>

  <span class="token comment">// 计算  文本宽度</span>
  <span class="token keyword">const</span> companyNameContentFontSize <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> companyNameContentWidth <span class="token operator">=</span>
    <span class="token punctuation">(</span>doc<span class="token punctuation">.</span><span class="token function">getStringUnitWidth</span><span class="token punctuation">(</span>pdfData<span class="token punctuation">.</span>oneCompanyNameContent<span class="token punctuation">)</span> <span class="token operator">*</span> companyNameContentFontSize<span class="token punctuation">)</span> <span class="token operator">/</span> doc<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>scaleFactor<span class="token punctuation">;</span>
  <span class="token comment">// 计算文本总宽度</span>
  <span class="token keyword">const</span> totalWidth <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>companyNameLabelWidth<span class="token punctuation">,</span> companyNameContentWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 计算居中位置</span>
  <span class="token keyword">const</span> center <span class="token operator">=</span> <span class="token punctuation">(</span>doc<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>pageSize<span class="token punctuation">.</span>width <span class="token operator">-</span> totalWidth<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>

  <span class="token comment">// 添加 "值守商名称：" 文本</span>
  doc<span class="token punctuation">.</span><span class="token function">setFontSize</span><span class="token punctuation">(</span>companyNameLabelFontSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>companyNameLabel<span class="token punctuation">,</span> center <span class="token operator">-</span> <span class="token number">10</span><span class="token punctuation">,</span> dateY <span class="token operator">+</span> doc<span class="token punctuation">.</span><span class="token function">getTextDimensions</span><span class="token punctuation">(</span>pdfData<span class="token punctuation">.</span>oneDateText<span class="token punctuation">)</span><span class="token punctuation">.</span>h <span class="token operator">+</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 计算  的位置</span>
  <span class="token keyword">const</span> companyNameContentY <span class="token operator">=</span> dateY <span class="token operator">+</span> doc<span class="token punctuation">.</span><span class="token function">getTextDimensions</span><span class="token punctuation">(</span>pdfData<span class="token punctuation">.</span>oneDateText<span class="token punctuation">)</span><span class="token punctuation">.</span>h <span class="token operator">+</span> <span class="token number">50</span><span class="token punctuation">;</span>
  <span class="token comment">// 添加 文本</span>
  doc<span class="token punctuation">.</span><span class="token function">setFontSize</span><span class="token punctuation">(</span>companyNameContentFontSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>pdfData<span class="token punctuation">.</span>oneCompanyNameContent<span class="token punctuation">,</span> center <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">,</span> companyNameContentY<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 添加下方的横线</span>
  doc<span class="token punctuation">.</span><span class="token function">line</span><span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">,</span> companyNameContentY <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">,</span> doc<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>pageSize<span class="token punctuation">.</span>width <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">,</span> companyNameContentY <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 添加编制人员</span>
  <span class="token keyword">const</span> authorText <span class="token operator">=</span> <span class="token string">'编制人员：'</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>authorText<span class="token punctuation">,</span> center <span class="token operator">-</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">152</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">line</span><span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">152</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">,</span> doc<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>pageSize<span class="token punctuation">.</span>width <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">152</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 添加审核人员</span>
  <span class="token keyword">const</span> reviewerText <span class="token operator">=</span> <span class="token string">'审核人员：'</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>reviewerText<span class="token punctuation">,</span> center <span class="token operator">-</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">161</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">line</span><span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">161</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">,</span> doc<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>pageSize<span class="token punctuation">.</span>width <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">161</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 添加底部日期</span>
  <span class="token keyword">const</span> bottomDateFontSize <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> bottomDateWidth <span class="token operator">=</span>
    <span class="token punctuation">(</span>doc<span class="token punctuation">.</span><span class="token function">getStringUnitWidth</span><span class="token punctuation">(</span>pdfData<span class="token punctuation">.</span>oneBottomDateText<span class="token punctuation">)</span> <span class="token operator">*</span> bottomDateFontSize<span class="token punctuation">)</span> <span class="token operator">/</span> doc<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>scaleFactor<span class="token punctuation">;</span>
  <span class="token comment">// 计算底部日期文本居中位置</span>
  <span class="token keyword">const</span> bottomDateX <span class="token operator">=</span> <span class="token punctuation">(</span>doc<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>pageSize<span class="token punctuation">.</span>width <span class="token operator">-</span> bottomDateWidth<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>pdfData<span class="token punctuation">.</span>oneBottomDateText<span class="token punctuation">,</span> bottomDateX<span class="token punctuation">,</span> <span class="token number">270</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 新建第二页</span>
  doc<span class="token punctuation">.</span><span class="token function">addPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 设置第二页内容</span>
  doc<span class="token punctuation">.</span><span class="token function">setPage</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>pdfData<span class="token punctuation">.</span>oneTitleText<span class="token punctuation">,</span> dateX<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">line</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">,</span> doc<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>pageSize<span class="token punctuation">.</span>width <span class="token operator">-</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 在第二页添加标题图标</span>
  <span class="token keyword">const</span> titleIconX <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> titleIconY <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> titleIconWidth <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> titleIconHeight <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span><span class="token function">getAssetsFile</span><span class="token punctuation">(</span><span class="token string">'images/overview.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'PNG'</span><span class="token punctuation">,</span> titleIconX<span class="token punctuation">,</span> titleIconY<span class="token punctuation">,</span> titleIconWidth<span class="token punctuation">,</span> titleIconHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 在第二页添加标题文本</span>
  <span class="token keyword">const</span> titleText1 <span class="token operator">=</span> <span class="token string">'运营总览'</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">setFontSize</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">setFont</span><span class="token punctuation">(</span><span class="token string">'SourceHanSerifCN-SemiBold'</span><span class="token punctuation">,</span> <span class="token string">'bold'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 请确保已经引入了粗体字体</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>titleText1<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">setFont</span><span class="token punctuation">(</span><span class="token string">'SourceHanSerifCN-Regular'</span><span class="token punctuation">,</span> <span class="token string">'normal'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 恢复正常字体</span>

  doc<span class="token punctuation">.</span><span class="token function">setFontSize</span><span class="token punctuation">(</span><span class="token number">10.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>
    <span class="token string">'本月新增设备接入'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>addDevice <span class="token operator">+</span>
      <span class="token string">'个，新增单位接入'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>addCompany <span class="token operator">+</span>
      <span class="token string">'家，截止'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>oneBottomDateText <span class="token operator">+</span>
      <span class="token string">'，累计接入设备数'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>addsDevice <span class="token operator">+</span>
      <span class="token string">'个，单位数'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>addsCompany <span class="token operator">+</span>
      <span class="token string">'家；'</span><span class="token punctuation">,</span>
    <span class="token number">14</span><span class="token punctuation">,</span>
    <span class="token number">40</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>
    <span class="token string">'本月平台接收到报警'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>addAlarm <span class="token operator">+</span>
      <span class="token string">'个，已处理'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>stopAlarm <span class="token operator">+</span>
      <span class="token string">'个，遗留未处理'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>waitAlarm <span class="token operator">+</span>
      <span class="token string">'个，发生真实火警'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>trueFireAlarm <span class="token operator">+</span>
      <span class="token string">'起；'</span><span class="token punctuation">,</span>
    <span class="token number">14</span><span class="token punctuation">,</span>
    <span class="token number">45</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>
    <span class="token string">'本月平台接收到设备故障'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>addWarnDevice <span class="token operator">+</span>
      <span class="token string">'个，已处理'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>stopWarnDevice <span class="token operator">+</span>
      <span class="token string">'个，遗留未处理'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>waitWarnDevice <span class="token operator">+</span>
      <span class="token string">'个；'</span><span class="token punctuation">,</span>
    <span class="token number">14</span><span class="token punctuation">,</span>
    <span class="token number">50</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>
    <span class="token string">'平台设备在线率为'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>deviceOnlineRate <span class="token operator">+</span>
      <span class="token string">'%，截止'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>oneBottomDateText <span class="token operator">+</span>
      <span class="token string">'，有'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>offlineDevice <span class="token operator">+</span>
      <span class="token string">'个设备处于离线状态；'</span><span class="token punctuation">,</span>
    <span class="token number">14</span><span class="token punctuation">,</span>
    <span class="token number">55</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 绘制矩形 x y width height</span>
  <span class="token keyword">const</span> backgroundColor <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">247</span><span class="token punctuation">,</span> <span class="token number">247</span><span class="token punctuation">,</span> <span class="token number">247</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 灰色背景色 RGB</span>
  doc<span class="token punctuation">.</span><span class="token function">setFillColor</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> backgroundColor<span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">rect</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">'F'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 在矩形内添加文本</span>
  doc<span class="token punctuation">.</span><span class="token function">setTextColor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置文本颜色为黑色</span>
  doc<span class="token punctuation">.</span><span class="token function">setFontSize</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'资源接入统计'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">setFontSize</span><span class="token punctuation">(</span><span class="token number">10.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span><span class="token function">getAssetsFile</span><span class="token punctuation">(</span><span class="token string">'images/overview.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'PNG'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">67.5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>
    <span class="token string">'设备数 '</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>allDevice <span class="token operator">+</span>
      <span class="token string">' (在线率：'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>deviceOnlineRate <span class="token operator">+</span>
      <span class="token string">'%) 新增 '</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>addDevice <span class="token operator">+</span>
      <span class="token string">''</span><span class="token punctuation">,</span>
    <span class="token number">20</span><span class="token punctuation">,</span>
    <span class="token number">71</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span><span class="token function">getAssetsFile</span><span class="token punctuation">(</span><span class="token string">'images/overview.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'PNG'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">72.5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'单位数 '</span> <span class="token operator">+</span> pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>allCompany <span class="token operator">+</span> <span class="token string">' 新增 '</span> <span class="token operator">+</span> pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>addCompany <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 绘制矩形 x y width height</span>
  doc<span class="token punctuation">.</span><span class="token function">setFillColor</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> backgroundColor<span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">rect</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">'F'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 在矩形内添加文本</span>
  doc<span class="token punctuation">.</span><span class="token function">setTextColor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置文本颜色为黑色</span>
  doc<span class="token punctuation">.</span><span class="token function">setFontSize</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'报警处理'</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">setFontSize</span><span class="token punctuation">(</span><span class="token number">10.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span><span class="token function">getAssetsFile</span><span class="token punctuation">(</span><span class="token string">'images/overview.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'PNG'</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">67.5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>
    <span class="token string">'报警总数 '</span> <span class="token operator">+</span> pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>addAlarm <span class="token operator">+</span> <span class="token string">' 真实火警 '</span> <span class="token operator">+</span> pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>trueFireAlarm <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">,</span>
    <span class="token number">110</span><span class="token punctuation">,</span>
    <span class="token number">71</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span><span class="token function">getAssetsFile</span><span class="token punctuation">(</span><span class="token string">'images/overview.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'PNG'</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">72.5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'遗留未处理 '</span> <span class="token operator">+</span> pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>waitAlarm <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 绘制矩形 x y width height</span>
  doc<span class="token punctuation">.</span><span class="token function">setFillColor</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> backgroundColor<span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">rect</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">'F'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 在矩形内添加文本</span>
  doc<span class="token punctuation">.</span><span class="token function">setTextColor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置文本颜色为黑色</span>
  doc<span class="token punctuation">.</span><span class="token function">setFontSize</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'故障处理'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">setFontSize</span><span class="token punctuation">(</span><span class="token number">10.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span><span class="token function">getAssetsFile</span><span class="token punctuation">(</span><span class="token string">'images/overview.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'PNG'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">92.5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'故障总数 '</span> <span class="token operator">+</span> pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>addWarnDevice <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span><span class="token function">getAssetsFile</span><span class="token punctuation">(</span><span class="token string">'images/overview.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'PNG'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">97.5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'遗留未处理 '</span> <span class="token operator">+</span> pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>waitWarnDevice <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 在第二页添加标题图标</span>
  doc<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span><span class="token function">getAssetsFile</span><span class="token punctuation">(</span><span class="token string">'images/overview.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'PNG'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 在第二页添加标题文本</span>
  doc<span class="token punctuation">.</span><span class="token function">setFontSize</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">setFont</span><span class="token punctuation">(</span><span class="token string">'SourceHanSerifCN-SemiBold'</span><span class="token punctuation">,</span> <span class="token string">'bold'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 请确保已经引入了粗体字体</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'消防设备统计'</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">114</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">setFont</span><span class="token punctuation">(</span><span class="token string">'SourceHanSerifCN-Regular'</span><span class="token punctuation">,</span> <span class="token string">'normal'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 恢复正常字体</span>

  doc<span class="token punctuation">.</span><span class="token function">setFontSize</span><span class="token punctuation">(</span><span class="token number">10.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>
    <span class="token string">'本月新增设备接入'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>addDevice <span class="token operator">+</span>
      <span class="token string">'个，截止'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>oneBottomDateText <span class="token operator">+</span>
      <span class="token string">'，累计接入设备数'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>allDevice <span class="token operator">+</span>
      <span class="token string">'个'</span><span class="token punctuation">,</span>
    <span class="token number">14</span><span class="token punctuation">,</span>
    <span class="token number">120</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'设备品类涵盖独立式烟温感系统，电气火灾系统'</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">125</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>
    <span class="token string">'平台设备在线率为'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>deviceOnlineRate <span class="token operator">+</span>
      <span class="token string">'%，其中独立式烟温感系统离线率最高，截止'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>oneBottomDateText <span class="token operator">+</span>
      <span class="token string">'，有'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>offlineDevice <span class="token operator">+</span>
      <span class="token string">'个设备处于离线状态'</span><span class="token punctuation">,</span>
    <span class="token number">14</span><span class="token punctuation">,</span>
    <span class="token number">130</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 绘制矩形 x y width height</span>
  doc<span class="token punctuation">.</span><span class="token function">setFillColor</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> backgroundColor<span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">rect</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">185</span><span class="token punctuation">,</span> <span class="token number">190</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token string">'F'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 在矩形内添加文本</span>
  doc<span class="token punctuation">.</span><span class="token function">setTextColor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置文本颜色为黑色</span>
  doc<span class="token punctuation">.</span><span class="token function">setFontSize</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>
    <span class="token string">'设备在线率：'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>deviceOnlineRate <span class="token operator">+</span>
      <span class="token string">'%（在线数/总数：'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>onlineDevice <span class="token operator">+</span>
      <span class="token string">'/'</span> <span class="token operator">+</span>
      pdfData<span class="token punctuation">.</span>overviewModule<span class="token punctuation">.</span>allDevice <span class="token operator">+</span>
      <span class="token string">'）'</span><span class="token punctuation">,</span>
    <span class="token number">15</span><span class="token punctuation">,</span>
    <span class="token number">190</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span><span class="token function">getAssetsFile</span><span class="token punctuation">(</span><span class="token string">'images/overview.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'PNG'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">196.5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">setFontSize</span><span class="token punctuation">(</span><span class="token number">10.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'防排烟系统 0% (0/0)'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span><span class="token function">getAssetsFile</span><span class="token punctuation">(</span><span class="token string">'images/overview.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'PNG'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">201.5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'独立式烟温感系统 0% (0/1)'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">205</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span><span class="token function">getAssetsFile</span><span class="token punctuation">(</span><span class="token string">'images/overview.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'PNG'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">206.5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'视频监控系统 0% (0/0)'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">210</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 在矩形内添加文本</span>
  doc<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span><span class="token function">getAssetsFile</span><span class="token punctuation">(</span><span class="token string">'images/overview.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'PNG'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">196.5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">setFontSize</span><span class="token punctuation">(</span><span class="token number">10.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'可燃气体系统 0% (0/0)'</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span><span class="token function">getAssetsFile</span><span class="token punctuation">(</span><span class="token string">'images/overview.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'PNG'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">201.5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'电气火灾系统 0% (0/2)'</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">205</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span><span class="token function">getAssetsFile</span><span class="token punctuation">(</span><span class="token string">'images/overview.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'PNG'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">206.5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'消防用水系统 0% (0/0)'</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">210</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 在矩形内添加文本</span>
  doc<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span><span class="token function">getAssetsFile</span><span class="token punctuation">(</span><span class="token string">'images/overview.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'PNG'</span><span class="token punctuation">,</span> <span class="token number">145</span><span class="token punctuation">,</span> <span class="token number">196.5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">setFontSize</span><span class="token punctuation">(</span><span class="token number">10.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'火灾报警系统 0% (0/0)'</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span><span class="token function">getAssetsFile</span><span class="token punctuation">(</span><span class="token string">'images/overview.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'PNG'</span><span class="token punctuation">,</span> <span class="token number">145</span><span class="token punctuation">,</span> <span class="token number">201.5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'充电桩系统 0% (0/0)'</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">205</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span><span class="token function">getAssetsFile</span><span class="token punctuation">(</span><span class="token string">'images/overview.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'PNG'</span><span class="token punctuation">,</span> <span class="token number">145</span><span class="token punctuation">,</span> <span class="token number">206.5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'其他系统 0% (0/0)'</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">210</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 在第二页添加echarts图表</span>
  onePdfEchartsCfg<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{<!-- --></span> option<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> data <span class="token punctuation">}</span><span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 插入图表图片到 jsPDF 文档</span>
    <span class="token keyword">await</span> <span class="token function">generateOnePDF</span><span class="token punctuation">(</span>option<span class="token punctuation">,</span> doc<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> data<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 延迟两秒后获取图表数据</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    loading<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">'download'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      doc<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">'.pdf'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> doc<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 将生成的 PDF 转换为数据 URL</span>
      <span class="token keyword">const</span> dataURL <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string">'dataurl'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">filename</span><span class="token operator">:</span> name <span class="token operator">+</span> <span class="token string">'.pdf'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 创建一个新窗口进行预览</span>
      <span class="token keyword">debugger</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> previewWindow <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      previewWindow<span class="token punctuation">.</span>document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;iframe width='100%' height='100%' src='</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>dataURL<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'&gt;&lt;/iframe&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> doc<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2000 毫秒即 2 秒</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">generateOnePDF</span><span class="token punctuation">(</span><span class="token parameter">option<span class="token punctuation">,</span> doc<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> data<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 创建一个包含 ECharts 图表的 div 元素</span>
  <span class="token keyword">const</span> chartContainer <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  chartContainer<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token string">'700px'</span><span class="token punctuation">;</span>
  chartContainer<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token string">'300px'</span><span class="token punctuation">;</span>
  chartContainer<span class="token punctuation">.</span>style<span class="token punctuation">.</span>marginLeft <span class="token operator">=</span> <span class="token string">'50px'</span><span class="token punctuation">;</span> <span class="token comment">// 设置左边距</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>chartContainer<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 使用 ECharts 在 chartContainer 中生成图表</span>
  <span class="token keyword">const</span> chart <span class="token operator">=</span> echarts<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>chartContainer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  chart<span class="token punctuation">.</span><span class="token function">setOption</span><span class="token punctuation">(</span>option<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 监听图表渲染完成事件</span>
  chart<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'finished'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 延迟两秒后获取图表数据</span>
    <span class="token comment">// 获取 ECharts 图表的数据 URL</span>
    <span class="token keyword">const</span> dataURL <span class="token operator">=</span> chart<span class="token punctuation">.</span><span class="token function">getDataURL</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'png'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 移除图表容器</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>chartContainer<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 将图表数据 URL 转换为图像</span>
    <span class="token keyword">const</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    img<span class="token punctuation">.</span>src <span class="token operator">=</span> dataURL<span class="token punctuation">;</span>

    doc<span class="token punctuation">.</span><span class="token function">setPage</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 在 PDF 中添加图表图像</span>
    doc<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token string">'JPEG'</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 如果是最后一个图表，生成下一页, 解决图表错页的问题</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">===</span> onePdfEchartsCfg<span class="token punctuation">.</span>value<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">generateTwoPage</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2b0552b3ad78eb7ee2097e359fe737f1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">pnpm安装常见问题（command not found: pnmp）仅针对mac</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/959e37b4c943f4cd65ae538c317b798b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java中List转Map的几种方式</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>