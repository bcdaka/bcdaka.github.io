<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于Python&#43;OpenCV智能答题卡识别系统——深度学习和图像识别算法应用(含Python全部工程源码)&#43;训练与测试数据集 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/d594cc14c5670bfd93f09f8134fe0ae8/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="基于Python&#43;OpenCV智能答题卡识别系统——深度学习和图像识别算法应用(含Python全部工程源码)&#43;训练与测试数据集">
  <meta property="og:description" content="目录 前言总体设计系统整体结构图系统流程图 运行环境Python 环境PyCharm安装OpenCV环境 模块实现1. 信息识别2. Excel导出模块3. 图形用户界面模块4. 手写识别模块 系统测试1. 系统识别准确率2. 系统识别应用 工程源代码下载其它资料下载 前言 本项目基于Python和OpenCV图像处理库，在Windows平台下开发了一个答题卡识别系统。系统运用精巧的计算机视觉算法，实现了批量识别答题卡并将信息导出至Excel表格的功能。这一解决方案使得答题卡的判卷过程变得轻便、高效且准确。
首先，我们以Python语言作为开发基础，结合OpenCV图像处理库，为系统提供了强大的图像处理和分析能力。这使得我们能够在图像中准确地定位答题卡，检测填涂区域，以及识别填涂的内容。
在Windows平台下进行开发，我们能够充分利用操作系统的功能，确保系统在用户环境中的稳定性和兼容性。
系统中的计算机视觉算法经过精心设计，可以可靠地识别答题卡上的填涂信息。从扫描的图像中，我们能够确定哪些选项被填涂，并将这些信息精准地提取出来。
一旦信息被提取，系统能够将这些数据导出至Excel表格，实现了高效的数据整理和统计功能。这使得判卷过程变得高度自动化，减少了繁琐的手动工作，同时也降低了错误的风险。
总结而言，本项目的开发利用了Python语言和OpenCV图像处理库的强大功能，实现了一个全面的答题卡识别系统。通过高效的图像处理和数据导出功能，系统不仅减轻了判卷的负担，还大幅度提高了识别的准确性和效率。这对于教育机构和考试机构来说，都具有极大的实用价值。
总体设计 本部分包括系统整体结构图和系统流程图。
系统整体结构图 系统整体结构如图所示。
系统流程图 系统流程如图所示。
运行环境 本部分包括Python环境、OpenCV环境、图像处理工具包、requests、 base64和xlwt模块 。
Python 环境 需要Python 3.6及以上配置。在Windows环境下下载Anaconda完成Python所需配置，下载地址为https://www.anaconda.com/。
PyCharm安装 在网站https://www.jetbrains.com/pycharm/中下载对应机器的安装包。采用免费社区版下载exe格式文件即可。
OpenCV环境 在PyCharm中安装OpenCV 3.4.15，选择Settings下Project中的Interpreter，单击右上角加号，搜索需要添加的库，选中Specifyversion和3.4.15，单击OK按钮即可。
按如上方法安装imutils、requests和base64。 通过pip install xlwt安装xlwt模块，实现数据写入Excel表格的功能。
模块实现 本项目包括4个模块：信息识别、Excel导出、图形用户界面和手写识别，下面分别介绍各模块的功能及相关代码。
1. 信息识别 基于OpenCV算法，实现对图片中选项信息、学生身份信息的检测。在开始编写系统前，用Photoshop软件绘制用到的答题卡，如图所示。
答题卡中共计50道单选题，每选对1题得2分，漏选提示“漏选”，多选提示“多选”，最后返回成绩和统计错误选项的字典。
学院、班级、学号等信息采用“涂出来”的方式，相比初版系统中“写出来”的方式，识别准确率更高，代码更简单。
具体描述如下：
（1）利用get_position函数，通过上述信息识别算法，拿到身份信息被涂轮廓的重心坐标数组Info和选项信息被涂轮廓重心坐标数组Answer。
图片预处理：将图片做滤波去噪后，进行透视变换，并调整至2400X 2800的统一规格， 如图1~图9所示。
相关代码如下:
#导入相应数据包 import cv2 import matplotlib.pyplot as plt import imutils import numpy as np def cv_show(name, img): #展示图片 cv2.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-09-01T09:26:27+08:00">
    <meta property="article:modified_time" content="2023-09-01T09:26:27+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于Python&#43;OpenCV智能答题卡识别系统——深度学习和图像识别算法应用(含Python全部工程源码)&#43;训练与测试数据集</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#_8" rel="nofollow">前言</a></li><li><a href="#_23" rel="nofollow">总体设计</a></li><li><ul><li><a href="#_27" rel="nofollow">系统整体结构图</a></li><li><a href="#_33" rel="nofollow">系统流程图</a></li></ul> 
  </li><li><a href="#_38" rel="nofollow">运行环境</a></li><li><ul><li><a href="#Python__41" rel="nofollow">Python 环境</a></li><li><a href="#PyCharm_44" rel="nofollow">PyCharm安装</a></li><li><a href="#OpenCV_47" rel="nofollow">OpenCV环境</a></li></ul> 
  </li><li><a href="#_52" rel="nofollow">模块实现</a></li><li><ul><li><a href="#1__56" rel="nofollow">1. 信息识别</a></li><li><a href="#2_Excel_388" rel="nofollow">2. Excel导出模块</a></li><li><a href="#3__439" rel="nofollow">3. 图形用户界面模块</a></li><li><a href="#4__598" rel="nofollow">4. 手写识别模块</a></li></ul> 
  </li><li><a href="#_673" rel="nofollow">系统测试</a></li><li><ul><li><a href="#1__676" rel="nofollow">1. 系统识别准确率</a></li><li><a href="#2__721" rel="nofollow">2. 系统识别应用</a></li></ul> 
  </li><li><a href="#_743" rel="nofollow">工程源代码下载</a></li><li><a href="#_749" rel="nofollow">其它资料下载</a></li></ul> 
</div> 
<p></p> 
<hr> 
<p><img src="https://images2.imgbox.com/83/e3/MbeJZGui_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_8"></a>前言</h2> 
<p>本项目基于Python和OpenCV图像处理库，在Windows平台下开发了一个答题卡识别系统。系统运用精巧的计算机视觉算法，实现了批量识别答题卡并将信息导出至Excel表格的功能。这一解决方案使得答题卡的判卷过程变得轻便、高效且准确。</p> 
<p>首先，我们以Python语言作为开发基础，结合OpenCV图像处理库，为系统提供了强大的图像处理和分析能力。这使得我们能够在图像中准确地定位答题卡，检测填涂区域，以及识别填涂的内容。</p> 
<p>在Windows平台下进行开发，我们能够充分利用操作系统的功能，确保系统在用户环境中的稳定性和兼容性。</p> 
<p>系统中的计算机视觉算法经过精心设计，可以可靠地识别答题卡上的填涂信息。从扫描的图像中，我们能够确定哪些选项被填涂，并将这些信息精准地提取出来。</p> 
<p>一旦信息被提取，系统能够将这些数据导出至Excel表格，实现了高效的数据整理和统计功能。这使得判卷过程变得高度自动化，减少了繁琐的手动工作，同时也降低了错误的风险。</p> 
<p>总结而言，本项目的开发利用了Python语言和OpenCV图像处理库的强大功能，实现了一个全面的答题卡识别系统。通过高效的图像处理和数据导出功能，系统不仅减轻了判卷的负担，还大幅度提高了识别的准确性和效率。这对于教育机构和考试机构来说，都具有极大的实用价值。</p> 
<h2><a id="_23"></a>总体设计</h2> 
<p>本部分包括系统整体结构图和系统流程图。</p> 
<h3><a id="_27"></a>系统整体结构图</h3> 
<p>系统整体结构如图所示。</p> 
<p><img src="https://images2.imgbox.com/8f/47/3WjOiHUV_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_33"></a>系统流程图</h3> 
<p>系统流程如图所示。</p> 
<p><img src="https://images2.imgbox.com/50/e3/NR0rnqgy_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_38"></a>运行环境</h2> 
<p>本部分包括Python环境、OpenCV环境、图像处理工具包、requests、 base64和xlwt模块 。</p> 
<h3><a id="Python__41"></a>Python 环境</h3> 
<p>需要Python 3.6及以上配置。在Windows环境下下载Anaconda完成Python所需配置，下载地址为<a href="https://www.anaconda.com/" rel="nofollow">https://www.anaconda.com/</a>。</p> 
<h3><a id="PyCharm_44"></a>PyCharm安装</h3> 
<p>在网站<a href="https://www.jetbrains.com/pycharm/" rel="nofollow">https://www.jetbrains.com/pycharm/</a>中下载对应机器的安装包。采用免费社区版下载exe格式文件即可。</p> 
<h3><a id="OpenCV_47"></a>OpenCV环境</h3> 
<p>在PyCharm中安装OpenCV 3.4.15，选择Settings下Project中的Interpreter，单击右上角加号，搜索需要添加的库，选中Specifyversion和3.4.15，单击OK按钮即可。</p> 
<p>按如上方法安装imutils、requests和base64。 通过<code>pip install xlwt</code>安装xlwt模块，实现数据写入Excel表格的功能。</p> 
<h2><a id="_52"></a>模块实现</h2> 
<p>本项目包括4个模块：信息识别、Excel导出、图形用户界面和手写识别，下面分别介绍各模块的功能及相关代码。</p> 
<h3><a id="1__56"></a>1. 信息识别</h3> 
<p>基于OpenCV算法，实现对图片中选项信息、学生身份信息的检测。在开始编写系统前，用Photoshop软件绘制用到的答题卡，如图所示。</p> 
<p><img src="https://images2.imgbox.com/4c/d4/NdtoXfZW_o.png" alt="在这里插入图片描述"><br> 答题卡中共计50道单选题，每选对1题得2分，漏选提示“漏选”，多选提示“多选”，最后返回成绩和统计错误选项的字典。</p> 
<p>学院、班级、学号等信息采用“涂出来”的方式，相比初版系统中“写出来”的方式，识别准确率更高，代码更简单。</p> 
<p>具体描述如下：<br> （1）利用<code>get_position</code>函数，通过上述信息识别算法，拿到身份信息被涂轮廓的重心坐标数组Info和选项信息被涂轮廓重心坐标数组Answer。</p> 
<p>图片预处理：将图片做滤波去噪后，进行透视变换，并调整至2400X 2800的统一规格， 如图1~图9所示。</p> 
<p>相关代码如下:</p> 
<pre><code class="prism language-python"><span class="token comment">#导入相应数据包</span>
<span class="token keyword">import</span> cv2
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> imutils
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">def</span> <span class="token function">cv_show</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> img<span class="token punctuation">)</span><span class="token punctuation">:</span>   <span class="token comment">#展示图片</span>
    cv2<span class="token punctuation">.</span>namedWindow<span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>name<span class="token punctuation">,</span> img<span class="token punctuation">)</span>
    cv2<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>destroyAllWindows<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">order_points</span><span class="token punctuation">(</span>pts<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment">#对4点进行排序</span>
	<span class="token comment">#共4个坐标点</span>
	rect <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype <span class="token operator">=</span> <span class="token string">"float32"</span><span class="token punctuation">)</span>
	<span class="token comment">#按顺序找到对应坐标0、1、2、3分别是左上、右上、右下、左下</span>
	<span class="token comment">#计算左上和右下</span>
	s <span class="token operator">=</span> pts<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
	rect<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> pts<span class="token punctuation">[</span>np<span class="token punctuation">.</span>argmin<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">]</span>
	rect<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> pts<span class="token punctuation">[</span>np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">]</span>
	<span class="token comment">#计算右上和左下</span>
	diff <span class="token operator">=</span> np<span class="token punctuation">.</span>diff<span class="token punctuation">(</span>pts<span class="token punctuation">,</span> axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
	rect<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> pts<span class="token punctuation">[</span>np<span class="token punctuation">.</span>argmin<span class="token punctuation">(</span>diff<span class="token punctuation">)</span><span class="token punctuation">]</span>
	rect<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> pts<span class="token punctuation">[</span>np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>diff<span class="token punctuation">)</span><span class="token punctuation">]</span>
	<span class="token keyword">return</span> rect
<span class="token keyword">def</span> <span class="token function">toushi_transform</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> pts<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#输入原始图像和4角点坐标</span>
	<span class="token comment">#获取输入坐标点</span>
	rect <span class="token operator">=</span>  order_points<span class="token punctuation">(</span>pts<span class="token punctuation">)</span>
	<span class="token punctuation">(</span>tl<span class="token punctuation">,</span> tr<span class="token punctuation">,</span> br<span class="token punctuation">,</span> bl<span class="token punctuation">)</span> <span class="token operator">=</span> rect
	<span class="token comment">#计算输入的w和h值</span>
	widthA <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>br<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> bl<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>br<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> bl<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	widthB <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> tl<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> tl<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	maxWidth <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>widthA<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>widthB<span class="token punctuation">)</span><span class="token punctuation">)</span>
	heightA <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> br<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> br<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	heightB <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tl<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> bl<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tl<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> bl<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	maxHeight <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>heightA<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>heightB<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token comment">#变换后对应坐标位置</span>
	dst <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>
		<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		<span class="token punctuation">[</span>maxWidth <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		<span class="token punctuation">[</span>maxWidth <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> maxHeight <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> maxHeight <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype <span class="token operator">=</span> <span class="token string">"float32"</span><span class="token punctuation">)</span>
	<span class="token comment">#计算变换矩阵</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"原始四点坐标:\n"</span><span class="token punctuation">,</span>rect<span class="token punctuation">,</span><span class="token string">"\n变换后四角点坐标：\n"</span><span class="token punctuation">,</span>dst<span class="token punctuation">)</span>
	M <span class="token operator">=</span> cv2<span class="token punctuation">.</span>getPerspectiveTransform<span class="token punctuation">(</span>rect<span class="token punctuation">,</span> dst<span class="token punctuation">)</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"变换矩阵："</span><span class="token punctuation">,</span>M<span class="token punctuation">)</span>
	warped <span class="token operator">=</span> cv2<span class="token punctuation">.</span>warpPerspective<span class="token punctuation">(</span>image<span class="token punctuation">,</span> M<span class="token punctuation">,</span> <span class="token punctuation">(</span>maxWidth<span class="token punctuation">,</span> maxHeight<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token comment">#返回变换后结果</span>
	<span class="token keyword">return</span> warped
<span class="token keyword">def</span> <span class="token function">get_postion</span><span class="token punctuation">(</span>image_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#读入图片</span>
image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>image_name<span class="token punctuation">)</span>
<span class="token comment">#预处理</span>
<span class="token comment">#转换为灰度图像</span>
gray <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>image<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span>
<span class="token comment">#高斯滤波</span>
blurred <span class="token operator">=</span> cv2<span class="token punctuation">.</span>GaussianBlur<span class="token punctuation">(</span>gray<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment">#自适应二值化方法</span>
blurred<span class="token operator">=</span>cv2<span class="token punctuation">.</span>adaptiveThreshold<span class="token punctuation">(</span>blurred<span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>ADAPTIVE_THRESH_MEAN_C<span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>THRESH_BINARY<span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
cv_show<span class="token punctuation">(</span><span class="token string">'blurred'</span><span class="token punctuation">,</span>blurred<span class="token punctuation">)</span>
edged <span class="token operator">=</span> cv2<span class="token punctuation">.</span>Canny<span class="token punctuation">(</span>blurred<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token comment">#为透视变换做准备</span>
    cnts <span class="token operator">=</span> cv2<span class="token punctuation">.</span>findContours<span class="token punctuation">(</span>edged<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>RETR_EXTERNAL<span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>CHAIN_APPROX_SIMPLE<span class="token punctuation">)</span>
    cnts <span class="token operator">=</span> cnts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">if</span> imutils<span class="token punctuation">.</span>is_cv2<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> cnts<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    docCnt <span class="token operator">=</span> <span class="token boolean">None</span>
    <span class="token comment">#确保至少有一个轮廓被找到</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>cnts<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token comment">#将轮廓按大小降序排序</span>
        cnts <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>cnts<span class="token punctuation">,</span> key<span class="token operator">=</span>cv2<span class="token punctuation">.</span>contourArea<span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token comment">#对排序后的轮廓循环处理</span>
        <span class="token keyword">for</span> c <span class="token keyword">in</span> cnts<span class="token punctuation">:</span>
            <span class="token comment">#获取近似的轮廓</span>
            peri <span class="token operator">=</span> cv2<span class="token punctuation">.</span>arcLength<span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
            approx <span class="token operator">=</span> cv2<span class="token punctuation">.</span>approxPolyDP<span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token number">0.02</span> <span class="token operator">*</span> peri<span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
            <span class="token comment">#如果近似轮廓有4个顶点，认为找到了答题卡</span>
            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>approx<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">:</span>
                docCnt <span class="token operator">=</span> approx
                <span class="token keyword">break</span>
    newimage<span class="token operator">=</span>image<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> docCnt<span class="token punctuation">:</span>
        <span class="token comment">#circle函数为在图像上作图，新建一个图像用来演示4角选取</span>
        cv2<span class="token punctuation">.</span>circle<span class="token punctuation">(</span>newimage<span class="token punctuation">,</span> <span class="token punctuation">(</span>i<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>i<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token comment">#透视变换</span>
    paper <span class="token operator">=</span> toushi_transform<span class="token punctuation">(</span>image<span class="token punctuation">,</span> docCnt<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    warped <span class="token operator">=</span> toushi_transform<span class="token punctuation">(</span>gray<span class="token punctuation">,</span> docCnt<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">#cv_show('warped',warped)</span>
    <span class="token comment">#对灰度图应用二值化算法</span>
thresh<span class="token operator">=</span>cv2<span class="token punctuation">.</span>adaptiveThreshold<span class="token punctuation">(</span>warped<span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>ADAPTIVE_THRESH_MEAN_C<span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>THRESH_BINARY<span class="token punctuation">,</span><span class="token number">53</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token comment">#重塑可能用到的图像</span>
    width1<span class="token operator">=</span><span class="token number">2400</span>
    height1<span class="token operator">=</span><span class="token number">2800</span>
    <span class="token comment">#转换成标准大小：2400*2800</span>
    thresh <span class="token operator">=</span> cv2<span class="token punctuation">.</span>resize<span class="token punctuation">(</span>thresh<span class="token punctuation">,</span> <span class="token punctuation">(</span>width1<span class="token punctuation">,</span> height1<span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>INTER_LANCZOS4<span class="token punctuation">)</span>
    paper <span class="token operator">=</span> cv2<span class="token punctuation">.</span>resize<span class="token punctuation">(</span>paper<span class="token punctuation">,</span> <span class="token punctuation">(</span>width1<span class="token punctuation">,</span> height1<span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>INTER_LANCZOS4<span class="token punctuation">)</span>
    warped <span class="token operator">=</span> cv2<span class="token punctuation">.</span>resize<span class="token punctuation">(</span>warped<span class="token punctuation">,</span> <span class="token punctuation">(</span>width1<span class="token punctuation">,</span> height1<span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>INTER_LANCZOS4<span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>imwrite<span class="token punctuation">(</span><span class="token string">"warped.jpg"</span><span class="token punctuation">,</span> warped<span class="token punctuation">)</span>
识别被涂选项轮廓的重心相关代码如下：
<span class="token comment">#透视变换、resize成2400*2800的图片</span>
    <span class="token comment">#均值滤波</span>
    ChQImg <span class="token operator">=</span> cv2<span class="token punctuation">.</span>blur<span class="token punctuation">(</span>thresh<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">#二进制二值化</span>
    ChQImg <span class="token operator">=</span> cv2<span class="token punctuation">.</span>threshold<span class="token punctuation">(</span>ChQImg<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">225</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>THRESH_BINARY<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token comment">#cv_show('ChQImg',ChQImg)</span>
    <span class="token comment">#在二值图像中查找轮廓</span>
    cnts <span class="token operator">=</span> cv2<span class="token punctuation">.</span>findContours<span class="token punctuation">(</span>ChQImg<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>RETR_TREE<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>CHAIN_APPROX_SIMPLE<span class="token punctuation">)</span>
    cnts <span class="token operator">=</span> cnts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">if</span> imutils<span class="token punctuation">.</span>is_cv2<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> cnts<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    Answer<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    Info<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> cnts<span class="token punctuation">:</span>
    <span class="token comment">#计算轮廓的边界框，利用边界框数据计算宽高比</span>
        <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">)</span> <span class="token operator">=</span> cv2<span class="token punctuation">.</span>boundingRect<span class="token punctuation">(</span>c<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&gt;</span> <span class="token number">1200</span> <span class="token keyword">and</span> y <span class="token operator">&gt;</span> <span class="token number">1700</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">continue</span>  <span class="token comment">#排除右下角区域的误选</span>
    <span class="token comment">#if (w &gt; 60 &amp;h &gt; 20)and y&gt;900 and y&lt;2000:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">95</span> <span class="token operator">&gt;</span> w <span class="token operator">&gt;</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token keyword">and</span> y <span class="token operator">&gt;</span> <span class="token number">880</span> <span class="token keyword">and</span> y <span class="token operator">&lt;</span> <span class="token number">2050</span><span class="token punctuation">:</span>
            M <span class="token operator">=</span> cv2<span class="token punctuation">.</span>moments<span class="token punctuation">(</span>c<span class="token punctuation">)</span>
            cX <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>M<span class="token punctuation">[</span><span class="token string">"m10"</span><span class="token punctuation">]</span> <span class="token operator">/</span> M<span class="token punctuation">[</span><span class="token string">"m00"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            cY <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>M<span class="token punctuation">[</span><span class="token string">"m01"</span><span class="token punctuation">]</span> <span class="token operator">/</span> M<span class="token punctuation">[</span><span class="token string">"m00"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token comment">#绘制中心及其轮廓</span>
            cv2<span class="token punctuation">.</span>drawContours<span class="token punctuation">(</span>paper<span class="token punctuation">,</span> c<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> lineType<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
            cv2<span class="token punctuation">.</span>circle<span class="token punctuation">(</span>paper<span class="token punctuation">,</span> <span class="token punctuation">(</span>cX<span class="token punctuation">,</span> cY<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token comment">#保存题目坐标信息</span>
            Answer<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>cX<span class="token punctuation">,</span> cY<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">90</span><span class="token operator">&gt;</span> w <span class="token operator">&gt;</span> <span class="token number">55</span><span class="token punctuation">)</span> <span class="token keyword">and</span> y<span class="token operator">&lt;</span><span class="token number">800</span> <span class="token keyword">and</span> x<span class="token operator">&lt;</span><span class="token number">1750</span> <span class="token punctuation">:</span>
            M <span class="token operator">=</span> cv2<span class="token punctuation">.</span>moments<span class="token punctuation">(</span>c<span class="token punctuation">)</span>
            cX <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>M<span class="token punctuation">[</span><span class="token string">"m10"</span><span class="token punctuation">]</span> <span class="token operator">/</span> M<span class="token punctuation">[</span><span class="token string">"m00"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            cY <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>M<span class="token punctuation">[</span><span class="token string">"m01"</span><span class="token punctuation">]</span> <span class="token operator">/</span> M<span class="token punctuation">[</span><span class="token string">"m00"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token comment">#绘制中心及其轮廓</span>
            cv2<span class="token punctuation">.</span>drawContours<span class="token punctuation">(</span>paper<span class="token punctuation">,</span> c<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> lineType<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
            cv2<span class="token punctuation">.</span>circle<span class="token punctuation">(</span>paper<span class="token punctuation">,</span> <span class="token punctuation">(</span>cX<span class="token punctuation">,</span> cY<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token comment">#保存题目坐标信息</span>
            Info<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>cX<span class="token punctuation">,</span> cY<span class="token punctuation">)</span><span class="token punctuation">)</span>
cv_show<span class="token punctuation">(</span><span class="token string">'paper'</span><span class="token punctuation">,</span>paper<span class="token punctuation">)</span>
    cv2<span class="token punctuation">.</span>imwrite<span class="token punctuation">(</span><span class="token string">"paper.jpg"</span><span class="token punctuation">,</span> paper<span class="token punctuation">)</span>
    imm <span class="token operator">=</span> cv2<span class="token punctuation">.</span>resize<span class="token punctuation">(</span>paper<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">210</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>INTER_LANCZOS4<span class="token punctuation">)</span>
    cv2<span class="token punctuation">.</span>imwrite<span class="token punctuation">(</span><span class="token string">"imm.jpg"</span><span class="token punctuation">,</span> imm<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>Answer<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>Answer<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>Info<span class="token punctuation">)</span>
<span class="token keyword">return</span> Info<span class="token punctuation">,</span>Answer
</code></pre> 
<p><img src="https://images2.imgbox.com/e1/4e/Ypdkzzyi_o.png" alt="在这里插入图片描述"></p> 
<center>
  图1 读取的图片 
</center> 
<p><img src="https://images2.imgbox.com/e0/42/2X514qRp_o.png" alt="在这里插入图片描述"></p> 
<center>
  图2 灰度化处理后的图片 
</center> 
<p><img src="https://images2.imgbox.com/ef/0b/ClssrVdf_o.png" alt="在这里插入图片描述"></p> 
<center>
  图3 利用高斯滤波去噪后的图片 
</center> 
<p><img src="https://images2.imgbox.com/f0/c7/n7w1bUGv_o.png" alt="在这里插入图片描述"></p> 
<center>
  图4 二值化处理后的图片 
</center> 
<p><img src="https://images2.imgbox.com/bc/85/IfEFnQ3X_o.png" alt="在这里插入图片描述"></p> 
<center>
  图5 Canny滤波后的图片 
</center> 
<p><img src="https://images2.imgbox.com/02/de/70jzUwDo_o.png" alt="在这里插入图片描述"></p> 
<center>
  图6 透视变换、二值化后的图片 
</center> 
<p><img src="https://images2.imgbox.com/a5/a9/5XjX58ct_o.png" alt="在这里插入图片描述"></p> 
<center>
  图7 透视变换后的灰度图 
</center> 
<p><img src="https://images2.imgbox.com/bb/3f/GbnglKfz_o.png" alt="在这里插入图片描述"></p> 
<center>
  图8 调整尺寸后二值化处理结果图 
</center> 
<p><img src="https://images2.imgbox.com/39/09/vxxIpbOP_o.png" alt="在这里插入图片描述"></p> 
<center>
  图9 最终结果图 以测试图片为例，返回选项轮廓重心坐标Answer： 
</center> 
<blockquote> 
 <p>[ (977, 1992)，(165, 1992)，(523, 1926)，(861，1925 )，( 1097，1859 )，(403,1853 )，(978,1790),( 284, 1784 )，(861,1717)，(166,1716),(2239, 1643),( 1544, 1638),(978, 1631)，(406, 1629)，(2237, 1572)，(1542, 1569)，(286, 1557 ),( 859，1561 )，( 2238，1503 )，(1422，1497)，(167,1486 )，(739,1490)，( 1306, 1428 ),(2118, 1432)，(1095, 1424)，(523,1417)，( 1657，1362)， (1997，1360)， (976，1359)， (405，1347)，(1999，1273)，(1424，1264)，( 738，1264)，(165，1256) ，(1303， 1200) ，(1877， 1199) ，(1094，1199)，( 521， 1189)， ( 2242，1130)，(976 ，1129)，(1660， 1128) ，(402，1118)，(1542， 1062)，(2123，1060) ，(853， 1058)，( 282，1049)，( 2000，990),(1423，991) ，(161， 976)，(734， 982) ]</p> 
</blockquote> 
<p>共计50个，与所涂的50个选项相匹配。</p> 
<p>返回个人信息轮廓重心坐标Info: [ (1531， 528) ，(1218，238)，(336， 239)，(889， 235)，(437， 167)，(992， 165) ，(1428， 162) ，(1634， 96) ]，共计8个点，包括2个确定学院、2个确定班级、3个确定学号、1个学号确认点。</p> 
<p>（2）使用<code>explain ()</code>函数，对个人信息轮廓重心坐标进行解释。返回对应的学院、班级和学号。在预处理时，通过透视变换，从拍摄图片中取出答题卡，将图片调整至2400 X 2800的规格，如图10和图11所示。</p> 
<p><img src="https://images2.imgbox.com/82/b8/gE85per4_o.png" alt="在这里插入图片描述"></p> 
<center>
  图10 系统读入图片 
</center> 
<p><img src="https://images2.imgbox.com/cf/dd/WtynM3LO_o.png" alt="在这里插入图片描述"></p> 
<center>
  图11 预处理后的图片 
</center> 
<p>各信息所在位置基本不变，用Photoshop查看像素位置坐标，反复调整边界参数，如下图所示。</p> 
<p><img src="https://images2.imgbox.com/d0/de/wGxg6ZNt_o.png" alt="在这里插入图片描述"></p> 
<center>
  图12 个人信息区域像素分割 
</center> 
<p>判断上述信息数组中轮廓重心的图像像素坐标。根据重心x坐标所在区间，判断信息类型(学号、班级或学院)；根据重心y坐标所在区间，判断数字大小：</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">judge</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    xt0<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">285</span><span class="token punctuation">,</span><span class="token number">385</span><span class="token punctuation">,</span><span class="token number">485</span><span class="token punctuation">,</span> <span class="token number">850</span><span class="token punctuation">,</span><span class="token number">940</span><span class="token punctuation">,</span><span class="token number">1040</span><span class="token punctuation">,</span> <span class="token number">1385</span><span class="token punctuation">,</span><span class="token number">1480</span><span class="token punctuation">,</span><span class="token number">1580</span><span class="token punctuation">,</span><span class="token number">1680</span><span class="token punctuation">]</span>
    yt0<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">,</span><span class="token number">195</span><span class="token punctuation">,</span><span class="token number">265</span><span class="token punctuation">,</span><span class="token number">340</span><span class="token punctuation">,</span><span class="token number">410</span><span class="token punctuation">,</span><span class="token number">480</span><span class="token punctuation">,</span><span class="token number">555</span><span class="token punctuation">,</span><span class="token number">625</span><span class="token punctuation">,</span><span class="token number">700</span><span class="token punctuation">,</span><span class="token number">756</span><span class="token punctuation">]</span>
flagy<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span>
    flagx<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> yt0<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&lt;</span>y <span class="token keyword">and</span> y<span class="token operator">&lt;</span>yt0<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            flagy<span class="token operator">=</span>j
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> i<span class="token operator">&lt;=</span><span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> xt0<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;</span>x <span class="token keyword">and</span> x<span class="token operator">&lt;</span>xt0<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                flagx<span class="token operator">=</span>i
        <span class="token keyword">elif</span> i<span class="token operator">&lt;=</span><span class="token number">3</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> xt0<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;</span>x <span class="token keyword">and</span> x<span class="token operator">&lt;</span>xt0<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                flagx<span class="token operator">=</span>i
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> xt0<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;</span>x <span class="token keyword">and</span> x<span class="token operator">&lt;</span>xt0<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                flagx<span class="token operator">=</span>i
<span class="token keyword">return</span> flagx<span class="token punctuation">,</span>flagy
<span class="token keyword">def</span> <span class="token function">explain</span><span class="token punctuation">(</span>Info<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> Info<span class="token punctuation">:</span>
        <span class="token keyword">if</span> item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">or</span> item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
            pos<span class="token punctuation">,</span>num<span class="token operator">=</span>judge<span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token builtin">id</span><span class="token punctuation">[</span>pos<span class="token punctuation">]</span><span class="token operator">=</span>num
    sch_num<span class="token operator">=</span><span class="token builtin">id</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">10</span><span class="token operator">+</span><span class="token builtin">id</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    cls_num<span class="token operator">=</span><span class="token builtin">id</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">10</span><span class="token operator">+</span><span class="token builtin">id</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
    stu_num<span class="token operator">=</span><span class="token builtin">id</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">100</span><span class="token operator">+</span><span class="token builtin">id</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">10</span><span class="token operator">+</span><span class="token builtin">id</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"学号："</span><span class="token punctuation">,</span>sch_num<span class="token punctuation">,</span><span class="token string">"班级:"</span><span class="token punctuation">,</span>cls_num<span class="token punctuation">,</span><span class="token string">"学号:"</span><span class="token punctuation">,</span>stu_num<span class="token punctuation">)</span>
<span class="token keyword">return</span> sch_num<span class="token punctuation">,</span>cls_num<span class="token punctuation">,</span>stu_num
</code></pre> 
<p>以测试图片为例返回结果——学院: 21、班级: 21、学号: 160。</p> 
<p>（3）使用calculate ()函数，对选项轮廓重心坐标进行解释。返回包含对应的题号和选项的字典，如果遇到多涂、漏涂情况，则返回“多涂”“漏涂”的提示。同样使用Photoshop查看像素位置坐标，反复调整边界参数，如下图所示。</p> 
<p><img src="https://images2.imgbox.com/f2/66/ByLEWVOP_o.png" alt="在这里插入图片描述"></p> 
<center>
  图13 答题卡像素区域分割 
</center> 
<p>编写judgey0()函数判断题号和judgex0函数判断选项。根据选项每四个为一堆的特点，做除法和取余数，使用judge0()函数，将题号与所涂选项匹配。</p> 
<p>相关代码如下:</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">judgey0</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>y <span class="token operator">/</span> <span class="token number">5</span> <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span>  y <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">elif</span> y <span class="token operator">/</span> <span class="token number">5</span> <span class="token operator">&lt;</span> <span class="token number">2</span> <span class="token keyword">and</span> y<span class="token operator">/</span><span class="token number">5</span><span class="token operator">&gt;=</span><span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> y <span class="token operator">%</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> y <span class="token operator">%</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token number">40</span> <span class="token operator">+</span> <span class="token number">1</span>
<span class="token keyword">def</span> <span class="token function">judgex0</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">%</span><span class="token number">5</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">'A'</span>
    <span class="token keyword">elif</span><span class="token punctuation">(</span>x<span class="token operator">%</span><span class="token number">5</span><span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">'B'</span>
    <span class="token keyword">elif</span><span class="token punctuation">(</span>x<span class="token operator">%</span><span class="token number">5</span><span class="token operator">==</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">'C'</span>
    <span class="token keyword">elif</span><span class="token punctuation">(</span>x<span class="token operator">%</span><span class="token number">5</span><span class="token operator">==</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">'D'</span>
<span class="token keyword">def</span> <span class="token function">judge0</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>   <span class="token comment">#返回题号和答案</span>
    <span class="token keyword">if</span> x<span class="token operator">/</span><span class="token number">5</span><span class="token operator">&lt;</span><span class="token number">1</span> <span class="token punctuation">:</span>
        <span class="token comment">#print(judgey0(y))</span>
        <span class="token keyword">return</span> judgey0<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span>judgex0<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    <span class="token keyword">elif</span> x<span class="token operator">/</span><span class="token number">5</span><span class="token operator">&lt;</span><span class="token number">2</span> <span class="token keyword">and</span> x<span class="token operator">/</span><span class="token number">5</span><span class="token operator">&gt;=</span><span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token comment">#print(judgey0(y)+5)</span>
        <span class="token keyword">return</span> judgey0<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">,</span>judgex0<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    <span class="token keyword">elif</span> x<span class="token operator">/</span><span class="token number">5</span><span class="token operator">&lt;</span><span class="token number">3</span> <span class="token keyword">and</span> x<span class="token operator">/</span><span class="token number">5</span><span class="token operator">&gt;=</span><span class="token number">2</span><span class="token punctuation">:</span>
        <span class="token comment">#print(judgey0(y)+10)</span>
        <span class="token keyword">return</span> judgey0<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">,</span>judgex0<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token comment">#print(judgey0(y)+15)</span>
        <span class="token keyword">return</span> judgey0<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">15</span><span class="token punctuation">,</span>judgex0<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">calculate</span><span class="token punctuation">(</span>Answer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    xt1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">350</span><span class="token punctuation">,</span> <span class="token number">455</span><span class="token punctuation">,</span> <span class="token number">575</span><span class="token punctuation">,</span> <span class="token number">680</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">,</span> <span class="token number">920</span><span class="token punctuation">,</span> <span class="token number">1040</span><span class="token punctuation">,</span> <span class="token number">1160</span><span class="token punctuation">,</span> <span class="token number">1260</span><span class="token punctuation">,</span> <span class="token number">1370</span><span class="token punctuation">,</span> <span class="token number">1490</span><span class="token punctuation">,</span> <span class="token number">1600</span><span class="token punctuation">,</span> <span class="token number">1720</span><span class="token punctuation">,</span> <span class="token number">1830</span><span class="token punctuation">,</span> <span class="token number">1940</span><span class="token punctuation">,</span> <span class="token number">2060</span><span class="token punctuation">,</span> <span class="token number">2180</span><span class="token punctuation">,</span> <span class="token number">2330</span><span class="token punctuation">]</span><span class="token comment">#横向划分点</span>
    yt1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">960</span><span class="token punctuation">,</span> <span class="token number">1027</span><span class="token punctuation">,</span> <span class="token number">1100</span><span class="token punctuation">,</span> <span class="token number">1165</span><span class="token punctuation">,</span> <span class="token number">1235</span><span class="token punctuation">,</span> <span class="token number">1300</span><span class="token punctuation">,</span> <span class="token number">1385</span><span class="token punctuation">,</span> <span class="token number">1465</span><span class="token punctuation">,</span> <span class="token number">1536</span><span class="token punctuation">,</span> <span class="token number">1600</span><span class="token punctuation">,</span> <span class="token number">1655</span><span class="token punctuation">,</span> <span class="token number">1755</span><span class="token punctuation">,</span> <span class="token number">1820</span><span class="token punctuation">,</span> <span class="token number">1885</span><span class="token punctuation">,</span> <span class="token number">1960</span><span class="token punctuation">,</span> <span class="token number">2040</span><span class="token punctuation">]</span><span class="token comment">#纵向划分点</span>
    ans_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> Answer<span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>xt1<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> i<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> xt1<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token keyword">and</span> i<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> xt1<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>yt1<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token keyword">if</span> i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> yt1<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token keyword">and</span> i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> yt1<span class="token punctuation">[</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                        a<span class="token punctuation">,</span> b <span class="token operator">=</span> judge0<span class="token punctuation">(</span>j<span class="token punctuation">,</span> k<span class="token punctuation">)</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token keyword">in</span> ans_dict<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                            ans_dict<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'多选'</span> <span class="token comment">#之前有被选过，判多选</span>
                        <span class="token keyword">else</span><span class="token punctuation">:</span>
                            ans_dict<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">=</span> b
                        <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'ans:'</span><span class="token punctuation">,</span>ans_dict<span class="token punctuation">)</span>
<span class="token keyword">return</span> ans_dict
</code></pre> 
<p>根据重心坐标所在区间，得到对应的题号和选项。以测试图片为例，返回携带选项信息字典ans:{50: ‘C’ ,45: ‘A’,44: ‘D’,49: ‘B’ ,48: ‘D’,43: ‘C’ ,47: ‘C’, 42:‘B’,46: ‘B’, 41 : ‘A’, 40: ‘D’, 35: ‘C’ ,30:‘C’,25:‘C’,39: ‘D’,34: ‘C’,24:‘B’,29 :‘B’,38:‘D’,33: ‘B’ ,23: ‘A’,28: ‘A’,32: ‘A’,37: ‘C’ ,27:‘D’,22:‘D’,31 : ‘D’, 36: ‘B’,26: ‘C’,21: ‘C’,20: ‘B’, 15:‘B’,10: ‘A’,5:‘A’, 14: ‘A’, 19: ‘A’, 9 :‘D’,4:‘D’ ,18 :‘D’,8:‘C’,13 :‘D’,3:‘C’ ,12:‘C’,17:‘C’, 7:‘B’,2:‘B’,16 : ‘B’,11 : ‘B’,1:‘A’,6: ‘A’}。 其中ans[题号]=所涂答案。</p> 
<p>（4）使用<code>sumall()</code>函数，对上述功能进行汇总，并对比正确答案和学生涂写答案，返回学院、班级、学号、分数、错题完成信息识别功能。</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">sumall</span><span class="token punctuation">(</span>image_name<span class="token punctuation">,</span>true_ans<span class="token operator">=</span>true_ans<span class="token punctuation">)</span><span class="token punctuation">:</span>
    Info<span class="token punctuation">,</span>Answer<span class="token operator">=</span>get_postion<span class="token punctuation">(</span>image_name<span class="token punctuation">)</span>        <span class="token comment">#拿到信息轮廓数组</span>
    sch_num<span class="token punctuation">,</span> cls_num<span class="token punctuation">,</span> stu_num<span class="token operator">=</span>explain<span class="token punctuation">(</span>Info<span class="token punctuation">)</span>   <span class="token comment">#解释个人信息		</span>
    ans<span class="token operator">=</span>calculate<span class="token punctuation">(</span>Answer<span class="token punctuation">)</span>					   <span class="token comment">#判断所涂选项</span>
    score<span class="token operator">=</span><span class="token number">0</span>
    false_ans<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>true_ans<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token keyword">in</span> ans<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>true_ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                score<span class="token operator">+=</span><span class="token number">2</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                false_ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            false_ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'漏选'</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>false_ans<span class="token punctuation">)</span>
<span class="token keyword">return</span> sch_num<span class="token punctuation">,</span>cls_num<span class="token punctuation">,</span>stu_num<span class="token punctuation">,</span>score<span class="token punctuation">,</span>false_ans
</code></pre> 
<h3><a id="2_Excel_388"></a>2. Excel导出模块</h3> 
<p>本系统用data字典记录每次识别的信息，其中data字典初始化如下: <code>data={"序号": ["学 院"，"班级"，"学号"，"成绩"，"错题"]}</code>，使用xlwt将data字典中信息导出到当前路径下名为data.xls的Excel表格中。</p> 
<p>相关代码如下:</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> xlrd<span class="token punctuation">,</span>xlwt<span class="token punctuation">,</span>os
<span class="token keyword">def</span> <span class="token function">set_stlye</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>height<span class="token punctuation">,</span>bold<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#初始化样式</span>
    style <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>XFStyle<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">#创建字体</span>
    font <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>Font<span class="token punctuation">(</span><span class="token punctuation">)</span>
    font<span class="token punctuation">.</span>bold <span class="token operator">=</span> bold
    font<span class="token punctuation">.</span>colour_index <span class="token operator">=</span> <span class="token number">4</span>
    font<span class="token punctuation">.</span>height <span class="token operator">=</span> height
    font<span class="token punctuation">.</span>name <span class="token operator">=</span> name
    style<span class="token punctuation">.</span>font <span class="token operator">=</span> font
<span class="token keyword">return</span> style
<span class="token keyword">def</span> <span class="token function">write_excel</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"data.xls"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token string">"data.xls"</span><span class="token punctuation">)</span>
    book <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>  <span class="token comment">#创建Workbook，相当于创建Excel</span>
    <span class="token comment">#创建sheet，Sheet1为表的名字，cell_overwrite_ok为覆盖单元格</span>
    sheet1 <span class="token operator">=</span> book<span class="token punctuation">.</span>add_sheet<span class="token punctuation">(</span><span class="token string">u'Sheet1'</span><span class="token punctuation">,</span> cell_overwrite_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    r <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> i<span class="token punctuation">,</span> j <span class="token keyword">in</span> data<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment">#i表示data中的key，j表示data中的value</span>
        le <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>  <span class="token comment">#values返回的列表长度</span>
        <span class="token keyword">if</span> r <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span>set_stlye<span class="token punctuation">(</span><span class="token string">"Time New Roman"</span><span class="token punctuation">,</span><span class="token number">220</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
<span class="token comment">#添加第 0 行 0 列数据单元格背景设为黄色</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span>set_stlye<span class="token punctuation">(</span><span class="token string">"Time New Roman"</span><span class="token punctuation">,</span><span class="token number">220</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>  
<span class="token comment">#添加第1列的数据</span>
        <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> le <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment">#values列表中索引</span>
            <span class="token keyword">if</span> r <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>r<span class="token punctuation">,</span> c<span class="token punctuation">,</span> j<span class="token punctuation">[</span>c <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>set_stlye<span class="token punctuation">(</span><span class="token string">"Time New Roman"</span><span class="token punctuation">,</span><span class="token number">220</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
<span class="token comment">#添加第 0 行2 列到第 5 列的数据单元格背景设为黄色</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>r<span class="token punctuation">,</span> c<span class="token punctuation">,</span> j<span class="token punctuation">[</span>c <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>set_stlye<span class="token punctuation">(</span><span class="token string">"Time New Roman"</span><span class="token punctuation">,</span><span class="token number">220</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        r <span class="token operator">+=</span> <span class="token number">1</span>  <span class="token comment">#行数</span>
    <span class="token comment">#sheet_merge()合并单元格</span>
    book<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'data.xls'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"已导出至：data.xls"</span><span class="token punctuation">)</span>
</code></pre> 
<p>如果data.xls存在，导出时将其覆盖。以测试为例，结果如图所示。</p> 
<p><img src="https://images2.imgbox.com/82/d7/Jafvw90n_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3__439"></a>3. 图形用户界面模块</h3> 
<p>利用Python标准GUI库Tkinter实现本模块功能，如图14和图15所示。</p> 
<p><img src="https://images2.imgbox.com/91/fb/DPIBxAVU_o.png" alt="在这里插入图片描述"></p> 
<center>
  图14 系统主界面 
</center> 
<p><img src="https://images2.imgbox.com/bb/3a/dM7uFYZ2_o.png" alt="在这里插入图片描述"></p> 
<center>
  图15 初始化试卷主界面 
</center> 
<p>读取图片时，用户可以输入图片地址，单击【选择文件】按钮，批量处理本地图片文件。选择图片所在的文件夹，系统将识别每个满足条件的图片。</p> 
<p>在设置中，用户可以自定义确定答案。单击【识别】按钮，系统可识别所选中的图片文件，并将识别后的学院、班级、学号、成绩、错题等信息显示在右边。单击【导出】按钮，将本次系统识别的所有数据导出到data.xls表格中。</p> 
<p>相关代码如下：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> tkinter <span class="token keyword">as</span> tk
<span class="token keyword">from</span> iidd <span class="token keyword">import</span> sumall
<span class="token keyword">from</span> ooctest <span class="token keyword">import</span>  getinfo
<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token punctuation">,</span>ImageTk
<span class="token keyword">import</span> cv2
<span class="token keyword">from</span> excel <span class="token keyword">import</span> write_excel
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"序号"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"学院"</span><span class="token punctuation">,</span> <span class="token string">"班级"</span><span class="token punctuation">,</span> <span class="token string">"学号"</span><span class="token punctuation">,</span> <span class="token string">"成绩"</span><span class="token punctuation">,</span><span class="token string">"错题"</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
cnt<span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">import</span> os
<span class="token keyword">def</span> <span class="token function">walk</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    files<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>
    <span class="token keyword">for</span> root<span class="token punctuation">,</span> dirs<span class="token punctuation">,</span> names <span class="token keyword">in</span> os<span class="token punctuation">.</span>walk<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> filename <span class="token keyword">in</span> names<span class="token punctuation">:</span>
            <span class="token builtin">file</span><span class="token operator">=</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>root<span class="token punctuation">,</span> filename<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>  <span class="token comment">#路径和文件名连接构成完整路径</span>
            files<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> files
<span class="token comment">#if __name__=='__main__':</span>
<span class="token comment">#path='C:/Users/wanli/answer sheet/images'</span>
<span class="token comment">#walk(path)</span>
<span class="token keyword">def</span> <span class="token function">discern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> imgs
    <span class="token keyword">print</span><span class="token punctuation">(</span>entry_img_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">global</span> cnt
    cnt<span class="token operator">+=</span><span class="token number">1</span>
    da<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    sch_num<span class="token punctuation">,</span>cls_num<span class="token punctuation">,</span>stu_num<span class="token punctuation">,</span>score<span class="token punctuation">,</span>false_ans<span class="token operator">=</span>sumall<span class="token punctuation">(</span>entry_img_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>true_ans<span class="token operator">=</span>true_ans<span class="token punctuation">)</span>    da<span class="token punctuation">.</span>append<span class="token punctuation">(</span>sch_num<span class="token punctuation">)</span><span class="token punctuation">;</span>da<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cls_num<span class="token punctuation">)</span><span class="token punctuation">;</span>da<span class="token punctuation">.</span>append<span class="token punctuation">(</span>stu_num<span class="token punctuation">)</span><span class="token punctuation">;</span>da<span class="token punctuation">.</span>append<span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">;</span>da<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>false_ans<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    data<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span><span class="token operator">=</span>da
    imm <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'imm.jpg'</span><span class="token punctuation">)</span>       <span class="token comment">#将照片展示</span>
    imgs <span class="token operator">=</span> ImageTk<span class="token punctuation">.</span>PhotoImage<span class="token punctuation">(</span>imm<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span>
    l_info1<span class="token punctuation">.</span>config<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">'学院：'</span><span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>sch_num<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'班级: '</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>cls_num<span class="token punctuation">)</span><span class="token punctuation">)</span>
    l_info2<span class="token punctuation">.</span>config<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">'学号: '</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>stu_num<span class="token punctuation">)</span><span class="token punctuation">)</span>
    l_info3<span class="token punctuation">.</span>config<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">'错题：'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>false_ans<span class="token punctuation">)</span><span class="token punctuation">)</span>
    l_score<span class="token punctuation">.</span>config<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">'成绩：'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">)</span>
    imLabel<span class="token punctuation">.</span>config<span class="token punctuation">(</span>image<span class="token operator">=</span>imgs<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">set_ans</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">confirm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">global</span> ans_str<span class="token punctuation">,</span>true_ans
        ans_str <span class="token operator">=</span> new_ans<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
        window_set_ans<span class="token punctuation">.</span>destroy<span class="token punctuation">(</span><span class="token punctuation">)</span>
        true_ans<span class="token operator">=</span><span class="token builtin">eval</span><span class="token punctuation">(</span>ans_str<span class="token punctuation">)</span>
    window_set_ans<span class="token operator">=</span>tk<span class="token punctuation">.</span>Toplevel<span class="token punctuation">(</span>window<span class="token punctuation">)</span>
    window_set_ans<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">'350x200'</span><span class="token punctuation">)</span>
    window_set_ans<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'初始化试卷'</span><span class="token punctuation">)</span>
    new_ans <span class="token operator">=</span> tk<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
    new_ans<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>true_ans<span class="token punctuation">)</span><span class="token punctuation">)</span>
    tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>window_set_ans<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'输入正确答案'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
    entry_new_ans <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>window_set_ans<span class="token punctuation">,</span> textvariable<span class="token operator">=</span>new_ans<span class="token punctuation">,</span>
justify<span class="token operator">=</span><span class="token string">'left'</span><span class="token punctuation">)</span>
    entry_new_ans<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token number">230</span><span class="token punctuation">,</span>height<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">)</span>
    btn_confirm <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>window_set_ans<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'确定'</span><span class="token punctuation">,</span> command<span class="token operator">=</span>confirm<span class="token punctuation">)</span>
    btn_confirm<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">130</span><span class="token punctuation">)</span>
    hbar<span class="token operator">=</span>tk<span class="token punctuation">.</span>Scrollbar<span class="token punctuation">(</span>window_set_ans<span class="token punctuation">,</span>orient<span class="token operator">=</span><span class="token string">'horizontal'</span><span class="token punctuation">,</span> command<span class="token operator">=</span>entry_new_ans<span class="token punctuation">.</span>xview<span class="token punctuation">)</span>
    entry_new_ans<span class="token punctuation">.</span>configure<span class="token punctuation">(</span>xscrollcommand<span class="token operator">=</span>hbar<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">)</span>
    hbar<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span><span class="token string">'bottom'</span><span class="token punctuation">,</span>fill<span class="token operator">=</span><span class="token string">'x'</span><span class="token punctuation">)</span>
    entry_new_ans<span class="token punctuation">.</span>columnconfigure<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> weight<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
true_ans<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string">"A"</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">:</span><span class="token string">'B'</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">:</span><span class="token string">'C'</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">:</span><span class="token string">'D'</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">:</span><span class="token string">'A'</span><span class="token punctuation">,</span>
        <span class="token number">6</span><span class="token punctuation">:</span><span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">:</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">:</span><span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">:</span><span class="token string">'D'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">:</span><span class="token string">'A'</span><span class="token punctuation">,</span>
        <span class="token number">11</span><span class="token punctuation">:</span><span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">:</span><span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">:</span><span class="token string">'D'</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">:</span><span class="token string">'B'</span><span class="token punctuation">,</span>
        <span class="token number">16</span><span class="token punctuation">:</span><span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">:</span><span class="token string">'C'</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">:</span><span class="token string">'D'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token string">'B'</span><span class="token punctuation">,</span>
        <span class="token number">21</span><span class="token punctuation">:</span><span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">:</span><span class="token string">'D'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">:</span><span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">:</span><span class="token string">'C'</span><span class="token punctuation">,</span>
        <span class="token number">26</span><span class="token punctuation">:</span><span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">:</span><span class="token string">'D'</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">:</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">:</span><span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">:</span><span class="token string">'C'</span><span class="token punctuation">,</span>
        <span class="token number">31</span><span class="token punctuation">:</span><span class="token string">"D"</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">:</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">:</span><span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">:</span><span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">:</span><span class="token string">'D'</span><span class="token punctuation">,</span>
        <span class="token number">36</span><span class="token punctuation">:</span><span class="token string">"D"</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">:</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">:</span><span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">:</span><span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">:</span><span class="token string">'D'</span><span class="token punctuation">,</span>
        <span class="token number">41</span><span class="token punctuation">:</span><span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">:</span><span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">:</span><span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">:</span><span class="token string">'D'</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">:</span><span class="token string">'A'</span><span class="token punctuation">,</span>
        <span class="token number">46</span><span class="token punctuation">:</span><span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">:</span><span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">:</span><span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token number">49</span> <span class="token punctuation">:</span><span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">:</span><span class="token string">'C'</span> <span class="token punctuation">}</span>
<span class="token keyword">def</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    write_excel<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    tell<span class="token punctuation">.</span>config<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">'已导入到data.xls'</span><span class="token punctuation">)</span>
window <span class="token operator">=</span> tk<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>
window<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'答题卡识别系统'</span><span class="token punctuation">)</span>
window<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">'550x400'</span><span class="token punctuation">)</span>
menubar<span class="token operator">=</span>tk<span class="token punctuation">.</span>Menu<span class="token punctuation">(</span>window<span class="token punctuation">)</span>
filemenu <span class="token operator">=</span> tk<span class="token punctuation">.</span>Menu<span class="token punctuation">(</span>menubar<span class="token punctuation">,</span>tearoff<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
menubar<span class="token punctuation">.</span>add_cascade<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">'设置'</span><span class="token punctuation">,</span>menu<span class="token operator">=</span>filemenu<span class="token punctuation">)</span>
filemenu<span class="token punctuation">.</span>add_cascade<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">'初始化试卷'</span><span class="token punctuation">,</span>command<span class="token operator">=</span>set_ans<span class="token punctuation">)</span>
l_score<span class="token operator">=</span>tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>window<span class="token punctuation">,</span>text<span class="token operator">=</span><span class="token string">'成绩：'</span><span class="token punctuation">)</span>
l_score<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">350</span><span class="token punctuation">)</span>
l_info1<span class="token operator">=</span>tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>window<span class="token punctuation">,</span>text<span class="token operator">=</span><span class="token string">'学院：班级:'</span><span class="token punctuation">)</span>
l_info1<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">)</span>
l_info2<span class="token operator">=</span>tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>window<span class="token punctuation">,</span>text<span class="token operator">=</span><span class="token string">'姓名：学号：'</span><span class="token punctuation">)</span>
l_info2<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span>
l_info3<span class="token operator">=</span>tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>window<span class="token punctuation">,</span>text<span class="token operator">=</span><span class="token string">'错题：'</span><span class="token punctuation">)</span>
l_info3<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">330</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">350</span><span class="token punctuation">)</span>
var_img_name<span class="token operator">=</span>tk<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
var_img_name<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">"new2.jpg"</span><span class="token punctuation">)</span>
<span class="token comment">#var_name=tk.StringVar()</span>
<span class="token comment">#var_id=tk.StringVar()</span>
<span class="token comment">#var_class=tk.StringVar()</span>
<span class="token comment">#var_school=tk.StringVar()</span>
l_en<span class="token operator">=</span>tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>window<span class="token punctuation">,</span>text<span class="token operator">=</span><span class="token string">'输出图片地址'</span><span class="token punctuation">)</span>
l_en<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">225</span><span class="token punctuation">)</span>
entry_img_name<span class="token operator">=</span>tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>window<span class="token punctuation">,</span>textvariable<span class="token operator">=</span>var_img_name<span class="token punctuation">)</span>
entry_img_name<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">)</span>
btn_test<span class="token operator">=</span>tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>window<span class="token punctuation">,</span>text<span class="token operator">=</span><span class="token string">'识别'</span><span class="token punctuation">,</span>command<span class="token operator">=</span>discern<span class="token punctuation">)</span>
btn_test<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span>
btn_excel<span class="token operator">=</span>tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>window<span class="token punctuation">,</span>text<span class="token operator">=</span><span class="token string">'导出'</span><span class="token punctuation">,</span>command<span class="token operator">=</span>write<span class="token punctuation">)</span>
btn_excel<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">350</span><span class="token punctuation">)</span>
<span class="token comment">#显示图片</span>
<span class="token comment">#im = Image.open('mario_star.jpg')</span>
<span class="token comment">#mario= ImageTk.PhotoImage(im)</span>
imLabel <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>window<span class="token punctuation">,</span>text<span class="token operator">=</span><span class="token string">'结果：'</span><span class="token punctuation">)</span>
imLabel<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">270</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">choose_fiel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    selectFileName <span class="token operator">=</span> tk<span class="token punctuation">.</span>filedialog<span class="token punctuation">.</span>askopenfilename<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'选择文件'</span><span class="token punctuation">)</span>  <span class="token comment">#选择文件</span>
    var_img_name<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>selectFileName<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">getall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    selectFileName0 <span class="token operator">=</span> tk<span class="token punctuation">.</span>filedialog<span class="token punctuation">.</span>askdirectory<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">#选择文件</span>
    <span class="token comment">#var_img_name.set(selectFileName0)</span>
    files<span class="token operator">=</span>walk<span class="token punctuation">(</span>selectFileName0<span class="token punctuation">)</span>
    <span class="token keyword">for</span> filename <span class="token keyword">in</span> files<span class="token punctuation">:</span>
        <span class="token keyword">global</span> cnt
        cnt <span class="token operator">+=</span> <span class="token number">1</span>
        da <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        sch_num<span class="token punctuation">,</span> cls_num<span class="token punctuation">,</span> stu_num<span class="token punctuation">,</span> score<span class="token punctuation">,</span> false_ans <span class="token operator">=</span> sumall<span class="token punctuation">(</span>filename<span class="token punctuation">,</span> true_ans<span class="token operator">=</span>true_ans<span class="token punctuation">)</span>
        da<span class="token punctuation">.</span>append<span class="token punctuation">(</span>sch_num<span class="token punctuation">)</span><span class="token punctuation">;</span>
        da<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cls_num<span class="token punctuation">)</span><span class="token punctuation">;</span>
        da<span class="token punctuation">.</span>append<span class="token punctuation">(</span>stu_num<span class="token punctuation">)</span><span class="token punctuation">;</span>
        da<span class="token punctuation">.</span>append<span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">;</span>
        da<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>false_ans<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        data<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span> <span class="token operator">=</span> da
    tell<span class="token punctuation">.</span>config<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">'批量处理完毕'</span><span class="token punctuation">)</span>
submit_button1 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>window<span class="token punctuation">,</span> text <span class="token operator">=</span><span class="token string">"选择文件"</span><span class="token punctuation">,</span> command <span class="token operator">=</span> choose_fiel<span class="token punctuation">)</span>
submit_button1<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">180</span><span class="token punctuation">)</span>
submit_button1 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>window<span class="token punctuation">,</span> text <span class="token operator">=</span><span class="token string">"批量处理"</span><span class="token punctuation">,</span> command <span class="token operator">=</span> getall<span class="token punctuation">)</span>
submit_button1<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">180</span><span class="token punctuation">)</span>
tell<span class="token operator">=</span>tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>window<span class="token punctuation">,</span>text<span class="token operator">=</span><span class="token string">'欢迎进入机读卡识别系统'</span><span class="token punctuation">)</span>
tell<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">70</span><span class="token punctuation">)</span>
window<span class="token punctuation">.</span>config<span class="token punctuation">(</span>menu<span class="token operator">=</span>menubar<span class="token punctuation">)</span>
window<span class="token punctuation">.</span>mainloop<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="4__598"></a>4. 手写识别模块</h3> 
<p>初版系统答题卡如图所示。</p> 
<p><img src="https://images2.imgbox.com/ee/ce/ruBmQiEu_o.png" alt="在这里插入图片描述"></p> 
<p>与最终版系统相似，对传入图片进行预处理、区域划分等操作。但这里让学生以“写出来”的方式填写个人信息，针对个人信息部分，调用百度API对学院、姓名进行手写文字识别，对班级、学号进行数字识别，如图所示。</p> 
<p><img src="https://images2.imgbox.com/2e/94/IWPQmFe6_o.png" alt="在这里插入图片描述"></p> 
<p>在百度AI开放平台注册，并创建调用手写文字识别和数字识别的应用，如图所示。</p> 
<p><img src="https://images2.imgbox.com/f9/a9/eBB1OOl5_o.png" alt="在这里插入图片描述"></p> 
<p>使用API Key和Secret Key获得access_token, 对从答题卡中获取的学院、姓名做手写文字识别，对班级、学号做数字识别，将信息汇总到dict字典。</p> 
<p>相关代码如下:</p> 
<pre><code class="prism language-python"><span class="token comment">#encoding:utf-8</span>
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> base64
host<span class="token operator">=</span> <span class="token string">'https://aip.baidubce.com/oauth/2.0/token?grant_type=client_credentials&amp;client_id= &amp;client_secret= '</span>
response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>host<span class="token punctuation">)</span>
<span class="token keyword">if</span> response<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
request_url <span class="token operator">=</span> <span class="token string">"https://aip.baidubce.com/rest/2.0/ocr/v1/handwriting"</span>
<span class="token comment">#二进制方式打开图片文件</span>
school <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'school.jpg'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span>
school_img <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>school<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
name <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'name.jpg'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span>
name_img <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>name<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
params_s <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"image"</span><span class="token punctuation">:</span>school_img<span class="token punctuation">}</span>
params_n <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"image"</span><span class="token punctuation">:</span>name_img<span class="token punctuation">}</span>
<span class="token comment">#access_token =“按上面方法获得” </span>
<span class="token comment">#print(access_token)</span>
request_url <span class="token operator">=</span> request_url <span class="token operator">+</span> <span class="token string">"?access_token="</span> <span class="token operator">+</span> access_token
headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'content-type'</span><span class="token punctuation">:</span> <span class="token string">'application/x-www-form-urlencoded'</span><span class="token punctuation">}</span>
responseS <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>request_url<span class="token punctuation">,</span> data<span class="token operator">=</span>params_s<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
<span class="token builtin">dict</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token keyword">if</span> responseS<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>responseS<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span> <span class="token punctuation">(</span>responseS<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'words_result'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'words'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token builtin">dict</span><span class="token punctuation">[</span><span class="token string">'school'</span><span class="token punctuation">]</span><span class="token operator">=</span>responseS<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'words_result'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'words'</span><span class="token punctuation">]</span>
responseN <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>request_url<span class="token punctuation">,</span> data<span class="token operator">=</span>params_n<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
<span class="token keyword">if</span> responseN<span class="token punctuation">:</span>
    <span class="token keyword">print</span> <span class="token punctuation">(</span>responseN<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'words_result'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'words'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token builtin">dict</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token operator">=</span>responseN<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'words_result'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'words'</span><span class="token punctuation">]</span>
<span class="token comment">#数字识别</span>
cls <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'cls.jpg'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span>
cls_img <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>cls<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token builtin">id</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'id.jpg'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span>
id_img <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
params_c <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"image"</span><span class="token punctuation">:</span>cls_img<span class="token punctuation">}</span>
params_i <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"image"</span><span class="token punctuation">:</span>id_img<span class="token punctuation">}</span>
ru<span class="token operator">=</span><span class="token string">'https://aip.baidubce.com/rest/2.0/ocr/v1/numbers'</span>
ru <span class="token operator">=</span> ru <span class="token operator">+</span> <span class="token string">"?access_token="</span> <span class="token operator">+</span> access_token
responseC <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>ru<span class="token punctuation">,</span> data<span class="token operator">=</span>params_c<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
responseI <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>ru<span class="token punctuation">,</span> data<span class="token operator">=</span>params_i<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
<span class="token keyword">if</span> responseS<span class="token punctuation">:</span>
    <span class="token keyword">print</span> <span class="token punctuation">(</span>responseC<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'words_result'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'words'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token builtin">dict</span><span class="token punctuation">[</span><span class="token string">'class'</span><span class="token punctuation">]</span><span class="token operator">=</span>responseC<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'words_result'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'words'</span><span class="token punctuation">]</span>
<span class="token keyword">if</span> responseN<span class="token punctuation">:</span>
    <span class="token keyword">print</span> <span class="token punctuation">(</span>responseI<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'words_result'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'words'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token builtin">dict</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token operator">=</span>responseI<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'words_result'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'words'</span><span class="token punctuation">]</span>
</code></pre> 
<p>初版系统运行结果如图所示。</p> 
<p><img src="https://images2.imgbox.com/5d/a6/ISm9YoB2_o.png" alt="在这里插入图片描述"></p> 
<p>由于这种方法准确率低、需联网、速度慢、有使用次数限制等原因，已不在目前系统中使用。曾考虑搭建神经网络，但准确率仍然达不到要求，且代码烦琐，违背构建轻量系统的初衷，所以选择让学生把信息涂出来的方式，按上述OpenCV算法进行识别，准确率几乎达到100%。</p> 
<h2><a id="_673"></a>系统测试</h2> 
<p>本部分包括系统识别准确率和系统识别应用。</p> 
<h3><a id="1__676"></a>1. 系统识别准确率</h3> 
<p>通过绘制数张答题卡进行测试，识别准确率达到100%。识别答题卡的原则是：如果照片不规范，则系统不识别；如果系统可识别，则需保证识别结果完全正确。每张答题卡测试效果如图16~图22所示。</p> 
<p><img src="https://images2.imgbox.com/9b/71/0FQfuywi_o.png" alt="在这里插入图片描述"></p> 
<center>
  图16 测试示例1 
</center> 
<p><img src="https://images2.imgbox.com/c2/50/e9907ILi_o.png" alt="在这里插入图片描述"></p> 
<center>
  图17 测试示例2 
</center> 
<p><img src="https://images2.imgbox.com/33/78/Vdqq4q36_o.png" alt="在这里插入图片描述"></p> 
<center>
  图18 测试示例3 
</center> 
<p><img src="https://images2.imgbox.com/c5/c6/L24At2bb_o.png" alt="在这里插入图片描述"></p> 
<center>
  图19 测试示例4 
</center> 
<p><img src="https://images2.imgbox.com/39/07/02h1Y6p0_o.png" alt="在这里插入图片描述"></p> 
<center>
  图20 无效输入 
</center> 
<p><img src="https://images2.imgbox.com/07/07/72udXnvj_o.png" alt="在这里插入图片描述"></p> 
<center>
  图21 漏涂、多涂 
</center> 
<p><img src="https://images2.imgbox.com/28/26/WdlyHPoX_o.png" alt="在这里插入图片描述"></p> 
<center>
  图22 漏涂 
</center> 
<p>前4张测试图正常随机填涂，均准确无误。</p> 
<p>针对不符合要求的图片，系统提示不合法。</p> 
<p>针对多涂、漏涂情况，本系统能准确识别，并在错题字典中反馈信息。</p> 
<p>虽然不能通过大量数据验证系统的稳定性，但至少说明程序是准确的，对于符合要求的图片，能够正确识别照片答题卡中学生信息和选项信息。</p> 
<h3><a id="2__721"></a>2. 系统识别应用</h3> 
<p>配置环境后，运行<code>answer sheet</code>中的<code>turntogui.py</code>文件，即可成功进入本系统，如图所示。</p> 
<p><img src="https://images2.imgbox.com/1b/14/lLiGHByu_o.png" alt="在这里插入图片描述"></p> 
<p>顶端为【设置】菜单，单击将弹出【初始化试卷】窗口，拖动滚动条，修改标准答案的字典。单击【确定】按钮完成修改，返回主界面，如图所示。</p> 
<p><img src="https://images2.imgbox.com/58/db/1cPMB8FP_o.png" alt="在这里插入图片描述"></p> 
<p>菜单栏下方为提示信息。</p> 
<p>单击【选择文件】可以选择本地文件识别;单击【批量处理】按钮可以选择指定文件夹，识别文件夹内符合要求的图片。</p> 
<p>手动输入图片地址，单击【识别】 按钮识别图片，单击【导出】按钮将信息导出为data.xls文件。</p> 
<p>在启动识别后，窗口右侧将展示识别得到的信息，如图片、学院、学号、成绩和错题集等。</p> 
<p>系统测试效果如图所示。</p> 
<p><img src="https://images2.imgbox.com/b6/55/455BvJPz_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_743"></a>工程源代码下载</h2> 
<p><a href="https://download.csdn.net/download/qq_31136513/88280326">详见本人博客资源下载页</a></p> 
<hr> 
<h2><a id="_749"></a>其它资料下载</h2> 
<p>如果大家想继续了解人工智能相关学习路线和知识体系，欢迎大家翻阅我的另外一篇博客《<a href="https://blog.csdn.net/qq_31136513/article/details/115563890">重磅 | 完备的人工智能AI 学习——基础知识学习路线，所有资料免关注免套路直接网盘下载</a>》<br> 这篇博客参考了Github知名开源平台，AI技术平台以及相关领域专家：Datawhale，ApacheCN，AI有道和黄海广博士等约有近100G相关资料，希望能帮助到所有小伙伴们。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/18e3672b8e011a368079efad4d34ab34/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">AI 绘画Stable Diffusion 研究（八）sd采样方法详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/51f30fac454a99849e2f0278c88ceab8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">《人工智能算法图解》书籍分享（包邮送书）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>