<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>若依项目(前端后分离版)整合百度(Ueditor)富文本编辑器 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/e56ad771989840322d725113864f04c9/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="若依项目(前端后分离版)整合百度(Ueditor)富文本编辑器">
  <meta property="og:description" content="1、Ueditor 资源下载
ueditor 官网：http://ueditor.baidu.com
ueditor API 文档：http://ueditor.baidu.com/doc
ueditor github 地址：http://github.com/fex-team/ueditor
2、资源下载之后的文件解压，改个名字，改为UEditor，复制放入项目public文件夹下
3、方便使用，形成组件，放入components文件夹下
ueditor.vue 代码，如果需要在headers中配置Authorization，在config中配置无效，需修改js文件，具体修改见下文
&lt;template&gt; &lt;div&gt; &lt;div :id=&#34;id&#34; type=&#34;text/plain&#34;&gt;&lt;/div&gt; &lt;/div&gt; &lt;/template&gt; &lt;script&gt; import &#39;/public/static/Ueditor/ueditor.config.js&#39; import &#39;/public/static/Ueditor/ueditor.all.min.js&#39; import &#39;/public/static/Ueditor/lang/zh-cn/zh-cn.js&#39; import &#39;/public/static/Ueditor/ueditor.parse.min.js&#39; import { getToken } from &#34;@/utils/auth&#34;; export default { name: &#39;UEditor&#39;, props: { /* 编辑器的内容 */ value: { type: String, default: &#34;&#34;, }, /* 只读 */ readOnly: { type: Boolean, default: false, }, id: { type: String, default: &#39;editor&#39; } }, data () { return { editor: null, defaultMsg:&#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-10T14:40:13+08:00">
    <meta property="article:modified_time" content="2024-01-10T14:40:13+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">若依项目(前端后分离版)整合百度(Ueditor)富文本编辑器</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p></p> 
<p>1、Ueditor 资源下载</p> 
<p>ueditor 官网：<a href="https://gitee.com/link?target=http%3A%2F%2Fueditor.baidu.com" rel="nofollow" title="http://ueditor.baidu.com">http://ueditor.baidu.com</a></p> 
<p>ueditor API 文档：<a href="https://gitee.com/link?target=http%3A%2F%2Fueditor.baidu.com%2Fdoc" rel="nofollow" title="http://ueditor.baidu.com/doc">http://ueditor.baidu.com/doc</a></p> 
<p>ueditor github 地址：<a href="https://gitee.com/link?target=http%3A%2F%2Fgithub.com%2Ffex-team%2Fueditor" title="http://github.com/fex-team/ueditor">http://github.com/fex-team/ueditor</a></p> 
<p>2、资源下载之后的文件解压，改个名字，改为UEditor，复制放入项目public文件夹下</p> 
<p><img alt="" height="515" src="https://images2.imgbox.com/b4/86/C80UeAfU_o.png" width="393"></p> 
<p>3、方便使用，形成组件，放入components文件夹下</p> 
<p><img alt="" height="870" src="https://images2.imgbox.com/8e/c4/W9l193Gt_o.png" width="370"></p> 
<p>ueditor.vue 代码，如果需要在headers中配置Authorization，在config中配置无效，需修改js文件，具体修改见下文</p> 
<pre><code>&lt;template&gt;
  &lt;div&gt;
    &lt;div :id="id" type="text/plain"&gt;&lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
 import '/public/static/Ueditor/ueditor.config.js'
 import '/public/static/Ueditor/ueditor.all.min.js'
 import '/public/static/Ueditor/lang/zh-cn/zh-cn.js'
 import '/public/static/Ueditor/ueditor.parse.min.js'

 import { getToken } from "@/utils/auth";

  export default {
    name: 'UEditor',
    props: {
      /* 编辑器的内容 */
      value: {
        type: String,
        default: "",
      },
      /* 只读 */
      readOnly: {
        type: Boolean,
        default: false,
      },
      id: {
          type: String,
          default: 'editor'
      }
    },
    data () {
      return {
        editor: null,
        defaultMsg:"",
        config: {
          initialFrameWidth: '100%',
          initialFrameHeight: 280,
          //上传文件接口
          serverUrl: process.env.VUE_APP_BASE_API + "/ueditor/upload",
          //serverUrl : '/ueditor/jsp/config.json',
          readonly: this.readOnly,
          placeholder: "请输入内容",
          imageUrlPrefix: process.env.VUE_APP_BASE_FILE_API,//图片访问前缀
        },
      }
    },
    mounted() {   
        this.$nextTick(() =&gt; {
            this.editor = UE.getEditor(this.id,this.config); // 初始化UE
            this.editor.addListener("ready", () =&gt; {
                this.editor.execCommand('insertHtml', this.value);
                // 确保UE加载完成后，放入内容
                this.editor.focus()
            })
        })

    },
     watch: {
      value : function(val) {
        if(val==null||val==undefined){
          val="";
        }
        this.editor.setContent(val);    
      }
    },
    methods: {
      // 获取内容方法
      getUEContent() {
        return this.editor.getContent()
      },
     // 清空编辑器内容
      clearContent() {
          return this.editor.execCommand('cleardoc');
      },
    },
    destroyed() {
      this.editor.destroy();
    },
    beforeDestroy() {
        // 组件销毁的时候，要销毁 UEditor 实例，下次进入页面才能重新加载出编辑器
       if (this.editor !== null &amp;&amp; this.editor.destroy) {
           this.editor.destroy();
       }
    },
  }
&lt;/script&gt;

</code></pre> 
<p>4、在main.js中引入组件，可全局使用</p> 
<pre><code>// 百度富文本组件
import Editor from "@/components/Editor"
//全局组件挂载
Vue.component('UEditor', UEditor)</code></pre> 
<p><img alt="" height="477" src="https://images2.imgbox.com/9e/53/GFdrLuqm_o.png" width="388"></p> 
<p>5、实现图片上传，配置后端接口</p> 
<p>(1)Java端建个EditorController，配置图片上传接口，路径与serverUrl保持一致；</p> 
<p><img alt="" height="565" src="https://images2.imgbox.com/62/2a/EOCkFMqu_o.png" width="1200"></p> 
<p>(2)将UEditorConfig.json文件放在项目的resources文件夹下，内容从 UEditor/jsp/config.json 下复制</p> 
<p><img alt="" height="477" src="https://images2.imgbox.com/18/db/RF2TtaxK_o.png" width="493"></p> 
<p>(3)EditorController代码，文件文件和获取配置写成两个接口，获取配置使用get请求，上传使用post请求</p> 
<pre><code>

/**
 * 百度编辑器图片上传
 * 
 * @author ruoyi
 */
@RestController
@RequestMapping("/ueditor")
public class EditorController
{
    @Autowired
    private ServerConfig serverConfig;

    /**
     * 读取配置文件
     * @param action
     * @param noCache
     * @return
     * @throws IOException
     */
    @GetMapping("/upload")
    public String getConfig(String action,String noCache) throws IOException {
        Resource resource = new ClassPathResource("UEditorConfig.json");
        InputStream in=resource.getInputStream();
        if (in != null) {
            String  text = Utils.read(in);
            return text;
        }
        return null;
    }

    /**
     * editor通用上传请求（单个）
     */
    @PostMapping("/upload")
    public AjaxResult editorUploadFile(String action, MultipartFile upfile) {
        try{
            AjaxResult ajax = AjaxResult.success();
            // 上传文件路径
            String filePath = RuoYiConfig.getUploadPath()+"/ueditor";
            // 上传并返回新文件名称
            String fileName = FileUploadUtils.upload(filePath, upfile);
            //String url = serverConfig.getUrl() + fileName;
            ajax.put("state", "SUCCESS");
            ajax.put("url", fileName);
            ajax.put("original", upfile.getOriginalFilename());
            if (action.equals("uploadimage")) {
                ajax.put("title", "图片文件");
            } else if (action.equals("uploadvideo")) {
                ajax.put("title", "视频文件");
            } else {
                ajax.put("title", "文件");
            }
            return ajax;
        }catch (Exception e){
            e.printStackTrace();
            return AjaxResult.error("上传失败");
        }

    }

}
</code></pre> 
<p>(4)配置授权认证，不配置，则访问授权报错</p> 
<p>第一种不鉴权，在java端SecurityConfig 文件中开放/ueditor 接口，方便快捷；</p> 
<p><img alt="" height="587" src="https://images2.imgbox.com/f6/5f/r95kYWSi_o.png" width="1200">第二种增加授权，在前端，修改ueditor.all.js 文件，get请求时需加上Authorization权鉴信息</p> 
<p><img alt="" height="442" src="https://images2.imgbox.com/cf/18/VT0g4x1m_o.png" width="1200"></p> 
<p>post请求上传图片并回显，需修改请求代码以及返回消息解析代码</p> 
<p><img alt="" height="784" src="https://images2.imgbox.com/26/77/1HpIFhxe_o.png" width="1200"></p> 
<p><img alt="" height="783" src="https://images2.imgbox.com/46/41/5rwXscDt_o.png" width="1200"></p> 
<pre><code class="hljs">  var fileForm = new FormData();
                fileForm.append("upfile",input.files[0]);

                var oReq = new XMLHttpRequest();
                var list = window.document.cookie.split(";")
                let filterList = list.filter(item =&gt;{
                     return item.substring(0,11) === "Admin-Token";
                 })
                var token = filterList[0].substr(12);

                oReq.open("POST",imageActionUrl,true);
                oReq.setRequestHeader("Authorization", "Bearer "+token);
                oReq.send(fileForm);
                oReq.onreadystatechange = function(responseText) {
                    if (oReq.readyState == 4 &amp;&amp; oReq.status == 200) {
                        var responseData = eval("("+oReq.responseText+")");
                        callback(responseData); //回调函数
                    }
                };</code></pre> 
<p>修改后，删除ueditor.all.min.js，复制ueditor.all.js并重命名为ueditor.all.min.js；</p> 
<p>6、图片回显，若前后端部署在同一个服务器，可以不用配置imageUrlPrefix路径UEditorConfig.json保持不动，上传接口返回全路径；若不在同一服务器，可删除UEditorConfig.json中imageUrlPrefix，同时在ueditor.vue中配置访问前缀，且在上传接口返回路径使用半路径</p> 
<p><img alt="" height="394" src="https://images2.imgbox.com/03/74/aeHPTTZe_o.png" width="973"></p> 
<p><img alt="" height="513" src="https://images2.imgbox.com/9b/74/f2MHuF7x_o.png" width="1167"></p> 
<p>7、项目使用</p> 
<p>配置id，每次引用，配置不同id值；</p> 
<pre><code>  &lt;UEditor v-model="form.content"  :id="ueidtorName" ref="ue"/&gt;</code></pre> 
<p>获取编辑器内容，并赋值；</p> 
<pre><code> this.form.content = this.$refs.ue.getUEContent();</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/23846fbb50ba51db660cc2bf65167fff/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">如何使用web文件管理器Net2FTP搭建个人网盘</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d1bf134dee30f5e5ca5cdfb6a31a1112/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">springboot在线订单管理系统设计与实现-附源码080941</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>