<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Terminal Web终端基础（Web IDE 技术探索 二） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/49d155b948906d2a92563b904b6edb39/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Terminal Web终端基础（Web IDE 技术探索 二）">
  <meta property="og:description" content="Terminal是web终端技术，类似cmd命令窗口，Webcontainer 中推荐使用的是Xterm.js，这里就不细说Xterm.js 的使用了，我们使用第三方库来实现（原生确实有点难用）。
vue-web-terminal 一个由 Vue 构建的支持多内容格式显示的网页端命令行窗口插件，支持表格、json、代码等多种消息格式，支持自定义消息样式、命令行库、键入搜索提示等，模拟原生终端窗口支持 ← → 光标切换和 ↑ ↓ 历史命令切换。其完善的API、中文文档、拖拽、缩放、实时回显等功能是我选择其的原因之一。
在线体验地址
github 地址
中文文档
npm install vue-web-terminal@3 --save import Terminal from &#39;vue-web-terminal&#39; // 3.2.0 及 2.1.13 以后版本需要引入此样式，之前版本无需引入主题样式 import &#39;vue-web-terminal/lib/theme/dark.css&#39; // for vue3 const app = createApp(App).use(Terminal) &lt;template&gt; &lt;terminal name=&#34;my-terminal&#34; @exec-cmd=&#34;onExecCmd&#34;&gt;&lt;/terminal&gt; &lt;/template&gt; &lt;script setup&gt; function onExecCmd(cmd) { console.log(cmd); } &lt;/script&gt; 切换主题 主题的核心是导入的style 文件里面自定义的css变量，因此，我们可以通过控制导入的文件实现主题切换： 经过分析观察，两个文件的节点是一样的，无法通过js控制，因此，复制文件到外部文件夹，并添加标识,main.js 中引入外部文件： function changeTheme() { document .querySelector(&#34;html&#34;) .setAttribute(&#34;t-theme&#34;, dark.value ? &#34;dark&#34; : &#34;lignt&#34;); dark.value = !">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-21T09:44:39+08:00">
    <meta property="article:modified_time" content="2024-05-21T09:44:39+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Terminal Web终端基础（Web IDE 技术探索 二）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>        Terminal是web终端技术，类似cmd命令窗口，Webcontainer 中推荐使用的是<a class="link-info" href="https://xtermjs.org/" rel="nofollow" title="Xterm.js">Xterm.js</a>，这里就不细说Xterm.js 的使用了，我们使用第三方库来实现（原生确实有点难用）。</p> 
<p><img alt="" height="542" src="https://images2.imgbox.com/7a/10/1if6ibrl_o.png" width="842"></p> 
<h2> vue-web-terminal</h2> 
<p>        一个由 Vue 构建的支持多内容格式显示的网页端命令行窗口插件，支持表格、json、代码等多种消息格式，支持自定义消息样式、命令行库、键入搜索提示等，模拟原生终端窗口支持 ← → 光标切换和 ↑ ↓ 历史命令切换。其完善的API、中文文档、拖拽、缩放、实时回显等功能是我选择其的原因之一。</p> 
<p><a class="link-info" href="https://tzfun.github.io/vue-web-terminal/" rel="nofollow" title="在线体验地址">在线体验地址</a></p> 
<p><a class="link-info" href="https://github.com/tzfun/vue-web-terminal" title="github 地址">github 地址</a></p> 
<p><a class="link-info" href="https://toscode.mulanos.cn/tzfun/vue-web-terminal#vue-web-terminal" rel="nofollow" title="中文文档">中文文档</a></p> 
<pre><code class="language-javascript">npm install vue-web-terminal@3 --save </code></pre> 
<pre><code class="language-javascript">import Terminal from 'vue-web-terminal'
//  3.2.0 及 2.1.13 以后版本需要引入此样式，之前版本无需引入主题样式
import 'vue-web-terminal/lib/theme/dark.css'

// for vue3
const app = createApp(App).use(Terminal)</code></pre> 
<pre><code class="language-javascript">&lt;template&gt;
  &lt;terminal name="my-terminal" @exec-cmd="onExecCmd"&gt;&lt;/terminal&gt;
&lt;/template&gt;

&lt;script setup&gt;
function onExecCmd(cmd) {
  console.log(cmd);
}
&lt;/script&gt;</code></pre> 
<p><img alt="" height="218" src="https://images2.imgbox.com/99/66/UiBrna1j_o.png" width="856"></p> 
<p></p> 
<h2>切换主题</h2> 
<p>        主题的核心是导入的style 文件里面自定义的css变量，因此，我们可以通过控制导入的文件实现主题切换：<img alt="" height="162" src="https://images2.imgbox.com/d7/90/KwjFKOEU_o.png" width="651"> </p> 
<p><img alt="" height="499" src="https://images2.imgbox.com/d9/d3/DBI2EIy9_o.png" width="1200"></p> 
<p>        经过分析观察，两个文件的节点是一样的，无法通过js控制，因此，复制文件到外部文件夹，并添加标识,main.js 中引入外部文件： </p> 
<p><img alt="" height="81" src="https://images2.imgbox.com/1e/82/aDVEY4Hi_o.png" width="395"></p> 
<p><img alt="" height="127" src="https://images2.imgbox.com/55/26/2A0n8PAo_o.png" width="1187"></p> 
<p><img alt="" height="54" src="https://images2.imgbox.com/1b/a4/t33YhfAL_o.png" width="345"></p> 
<pre><code class="language-javascript">function changeTheme() {
  document
    .querySelector("html")
    .setAttribute("t-theme", dark.value ? "dark" : "lignt");

  dark.value = !dark.value;
}</code></pre> 
<p><img alt="" height="251" src="https://images2.imgbox.com/c0/0d/jCYlOrBF_o.gif" width="1200"></p> 
<p>        这样更利于我们自定义主题，直接在原有基础上进行拓展即可。</p> 
<h2>个性化配置</h2> 
<p><strong>show-header</strong> 是否显示头部</p> 
<p><strong>context </strong>上下文内容（Root）</p> 
<p><strong>context-suffix </strong>上下文后缀符号（@）</p> 
<p><img alt="" height="66" src="https://images2.imgbox.com/8f/48/r3V4tZEo_o.png" width="236"></p> 
<p>...更多配置项，大家去官网看下，比较简单，就不细说了。</p> 
<h2>事件列表</h2> 
<p>        事件这块我就说一个 exec-cmd：执行自定义命令时触发。<code>success</code>和<code>failed</code>为回调函数，<strong>必须调用两个回调其中之一才会回显</strong>！<code>failed</code>回调参数为一个string，exec-cmd的<code>success</code>回调参数支持多种数据类型，不同数据类型执行逻辑也会不同：</p> 
<ul><li>不传任何参数，立即结束本次执行</li><li>传入一个<a href="https://toscode.mulanos.cn/tzfun/vue-web-terminal#%E6%B6%88%E6%81%AF%E5%AF%B9%E8%B1%A1" rel="nofollow" title="消息对象">消息对象</a>，将会向记录中追加一条消息，并立即结束本次执行</li><li>传入一个<a href="https://toscode.mulanos.cn/tzfun/vue-web-terminal#%E6%B6%88%E6%81%AF%E5%AF%B9%E8%B1%A1" rel="nofollow" title="消息对象">消息对象</a>数组，将会向记录中追加多条消息，并立即结束本次执行</li><li>传入一个<code>TerminalFlash</code>对象，将会进入<a href="https://toscode.mulanos.cn/tzfun/vue-web-terminal#%E5%AE%9E%E6%97%B6%E5%9B%9E%E6%98%BE" rel="nofollow" title="实时回显">实时回显</a>处理逻辑，本次执行并不会结束，直到调用<code>finish()</code></li><li>传入一个<code>TerminalAsk</code>对象，将会进入<a href="https://toscode.mulanos.cn/tzfun/vue-web-terminal#%E7%94%A8%E6%88%B7%E8%AF%A2%E9%97%AE%E8%BE%93%E5%85%A5" rel="nofollow" title="用户询问输入">用户询问输入</a>处理逻辑，本次执行并不会结束，直到调用<code>finish()</code></li></ul> 
<pre><code class="language-javascript">function onExecCmd(cmdKey, command, success, failed, name) {}</code></pre> 
<p><img alt="" height="107" src="https://images2.imgbox.com/5c/a1/aK6vAual_o.gif" width="720"></p> 
<pre><code class="language-javascript">function onExecCmd(cmdKey, command, success, failed, name) {
  success(); // 什么都不传，直接结束
}</code></pre> 
<p><img alt="" height="107" src="https://images2.imgbox.com/13/24/zZfMtbpm_o.gif" width="720"></p> 
<pre><code class="language-javascript">function onExecCmd(cmdKey, command, success, failed, name) {
  success({ content: "hello world" }); // 传一个消息对象
}</code></pre> 
<p><img alt="" height="150" src="https://images2.imgbox.com/07/f3/DpLC199O_o.gif" width="720"></p> 
<pre><code class="language-javascript">function onExecCmd(cmdKey, command, success, failed, name) {
  success([{ content: "hello world" }, { content: "hello javascript" }]); // 传一个消息对象数组
}</code></pre> 
<p><img alt="" height="200" src="https://images2.imgbox.com/57/43/Iww6qUgE_o.gif" width="720"></p> 
<pre><code class="language-javascript">import { TerminalFlash } from "vue-web-terminal";
const flash = new TerminalFlash();
function onExecCmd(cmdKey, command, success, failed, name) {
  let count = 0;
  success(flash); // 传一个 TerminalFlash

  let flashInterval = setInterval(() =&gt; {
    //  显示数据调用 flag.flush(string)
    flash.flush(`This is flash content: ${count}`);

    if (++count &gt;= 20) {
      clearInterval(flashInterval);
      //  结束回显调用 flag.finish()
      flash.finish();
    }
  }, 200);
}</code></pre> 
<p><img alt="" height="200" src="https://images2.imgbox.com/67/7d/USxkaVTq_o.gif" width="720"></p> 
<pre><code class="language-javascript">import { TerminalFlash, TerminalAsk } from "vue-web-terminal";
const flash = new TerminalFlash();
const asker = new TerminalAsk();
function onExecCmd(cmdKey, command, success, failed, name) {
  success(asker); // 传一个 TerminalAsk
  // 询问账号
  asker.ask({
    question: "Please input user name:",
    callback: askPassword,
  });

  function askPassword(value) {
    console.log("输入的username ==&gt;", value);
    asker.ask({
      question: "Please input password: ",
      autoReview: true,
      isPassword: true,
      callback: (pass) =&gt; {
        //    do something
        console.log("输入的password ==&gt;", pass);
        asker.finish();
      },
    });
  }
}</code></pre> 
<p><img alt="" height="200" src="https://images2.imgbox.com/ac/e3/uHnVeFL0_o.gif" width="915">         后面两种复杂的情况在构建应用时常用到，大家多练习下。还支持插槽，这块大家自己看下文档，应该也能学会，就不细说了。</p> 
<h2>Terminal API</h2> 
<p>        API无非就是主动向终端发送消息，具体api 可以看官网哈</p> 
<pre><code class="language-javascript">TerminalApi.textEditorOpen('my-terminal', {
    content: 'This is the preset content',
    onClose: (value, options) =&gt; {
        console.log('Final content: ', value, "options:", options)
    }
})</code></pre> 
<p>        在xshell中，可以在终端直接编辑 nginx配置文件，vue-web-terminal 支持调用textEditorOpen方法，打开编辑器：</p> 
<p><img alt="" height="702" src="https://images2.imgbox.com/6b/cb/Z41DHixb_o.gif" width="898"></p> 
<h2> 与WebContainer结合</h2> 
<p>        terminal只是网页端命令行窗口插件，并不具备实际的命令执行能力。当我输入 node -v 的时候，terminal的显示值，还需要通过 success 决定。</p> 
<p><img alt="" height="96" src="https://images2.imgbox.com/61/46/9GQGoBFT_o.png" width="187"></p> 
<p>        因此，需要与webcontainer 结合，使得 terminal的输入，转化为 spawn 的参数，获取到output 输出流后，再回显到 terminal上。</p> 
<pre><code class="language-javascript">async function onExecCmd(cmdKey, command, success, failed, name) {
  // 将命令行拆分为数组
  let argus = command.split(" ");

  let res = await wcInstance.spawn(argus[0], argus.slice(1));

  // 读取流
  res.output.pipeTo(
    new WritableStream({
      write(data) {
        success(data);
      },
    })
  );
}</code></pre> 
<p><img alt="" height="292" src="https://images2.imgbox.com/ab/38/IiuVzVDV_o.gif" width="763">         这只是一个简单的示例哈，并不是所有的回显都是 success，也并不是所有的回显都是直接显示文本，例如 ls 查看文件列表，使用表格更合适，npm install 使用实时回显flash 更合适。 </p> 
<h2>总结</h2> 
<p>        确实vue-web-terminal使用起来更加方便，封装的API、事件列表为我们省去了很多麻烦。使用起来也不难，大家多看文档即可学会。但是大家要记住哈，terminal仅是终端展示用，实际的执行能力还是依靠webContainer，因此，两者的参数传递、数据回显需要做精细化处理。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/64051a20e5de889e7fa940a1ba96674d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">人工智能是“数字鹦鹉”还是有了自我意识？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f04002b58169d4d775b041f4a46b65eb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">[Android]运行项目报错The application could not be installed: INSTALL_FAILED_SHARED_USER_INCOMPATIBLE</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>