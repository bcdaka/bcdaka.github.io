<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python自动化测试 环境搭建 Selenium、WebDriver下载、安装、配置、基本使用详解 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/146357faf0c9c914a5723a1766ad6dba/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Python自动化测试 环境搭建 Selenium、WebDriver下载、安装、配置、基本使用详解">
  <meta property="og:description" content="基本于Python语言 和 Selenium框架，使用PyCharm 开发环境，详细介绍自动化测试环境的搭建 以及 基本的使用方法。
一、安装Python环境 Python环境目前已被大部分主流操作系统所支持，比如在Linux、Mac、Unix等系统上就自带了Python环境，但在Windows系统上目前还需要自己安装，（当然如已经安装过了的话，这步可以直接跳过）。
1、下载Python Python下载地址：https://www.python.org/downloads
根据自己的需求下载对应的Python版本，一般进入官网的下载地址默认是最新版。
点击Downlad Python 3.11.2 按扭后，进入下载页面，选择自己想要安装的版下载
2、安装Python 点击下载好的python-3.11.3-amd64.exe可执行文件，进入Python安装对话界面，选择各安装项，如：Documentation文档、pip包管理工具（必选）、tcl/tk等（一般全都选上）、配置安装路径（这里选择安装在D盘的Program Files (x86)目录下，[因为一般Windows系统默认C盘为系统盘，所以将软件安装在其他盘如：D盘]）。
根据提示 Next 直到安装完成后，在命令窗口中输入 python --version 命令测试是否安装成功（注：若提示python命令不存在，先去检查否是有配置path环境变量（环境变量配置方法），如果path中没有配置python可手动将如下python路径添加到path中，或配置了没生效需要重启一下电脑即可）。
python --version # 或 py --version Python 3.11.3 # 显示版本号则表示安装成功！ # 输入python命令 或 py命令 按回车键 python # 进入如下python命令模式 Python 3.11.3 (tags/v3.11.3:f3909b8, Apr 4 2023, 23:49:59) [MSC v.1934 64 bit (AMD64)] on win64 Type &#34;help&#34;, &#34;copyright&#34;, &#34;credits&#34; or &#34;license&#34; for more information. &gt;&gt;&gt; 3、安装pip包管理工具 注：如果已安装过pip包管理工具的话，此步也可直接路过（一般在安装Python环境时，可以在安装配置项中勾选上pip，这样在安装Python环境时自动将pip也安装上了），以下是没有过安装pip的安装步骤！">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-23T14:33:29+08:00">
    <meta property="article:modified_time" content="2024-01-23T14:33:29+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python自动化测试 环境搭建 Selenium、WebDriver下载、安装、配置、基本使用详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>基本于Python语言 和 Selenium框架，使用PyCharm 开发环境，详细介绍自动化测试环境的搭建 以及 基本的使用方法。</p> 
</blockquote> 
<h3><a id="Python_1"></a>一、安装Python环境</h3> 
<blockquote> 
 <p>Python环境目前已被大部分主流操作系统所支持，比如在Linux、Mac、Unix等系统上就自带了Python环境，但在Windows系统上目前还需要自己安装，（当然如已经安装过了的话，这步可以直接跳过）。</p> 
</blockquote> 
<h5><a id="1Python_6"></a>1、下载Python</h5> 
<p><a href="https://www.python.org/downloads" rel="nofollow">Python下载地址：https://www.python.org/downloads</a></p> 
<p><img src="https://images2.imgbox.com/95/65/Gn2ShOc8_o.png" alt="在这里插入图片描述"></p> 
<p>根据自己的需求下载对应的Python版本，一般进入官网的下载地址默认是最新版。</p> 
<p><img src="https://images2.imgbox.com/ba/fc/huIEzCpP_o.png" alt="在这里插入图片描述"></p> 
<p>点击Downlad Python 3.11.2 按扭后，进入下载页面，选择自己想要安装的版下载</p> 
<p><img src="https://images2.imgbox.com/43/00/2PWairGy_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="2Python_23"></a>2、安装Python</h5> 
<p>点击下载好的python-3.11.3-amd64.exe可执行文件，进入Python安装对话界面，选择各安装项，如：Documentation文档、<strong>pip包管理工具（必选）</strong>、tcl/tk等（一般全都选上）、配置安装路径（这里选择安装在D盘的Program Files (x86)目录下，[因为一般Windows系统默认C盘为系统盘，所以将软件安装在其他盘如：D盘]）。</p> 
<p><img src="https://images2.imgbox.com/92/03/alTfQJbi_o.png" alt="在这里插入图片描述"></p> 
<p>根据提示 Next 直到安装完成后，在命令窗口中输入 python --version 命令测试是否安装成功（注：若提示python命令不存在，先去检查否是有配置path环境变量（<a href="https://blog.csdn.net/muguli2008/article/details/109108527">环境变量配置方法</a>），如果path中没有配置python可手动将如下python路径添加到path中，或配置了没生效需要重启一下电脑即可）。</p> 
<pre><code class="prism language-sh">python <span class="token parameter variable">--version</span>
<span class="token comment"># 或</span>
py <span class="token parameter variable">--version</span>
Python <span class="token number">3.11</span>.3   <span class="token comment"># 显示版本号则表示安装成功！</span>
	
<span class="token comment"># 输入python命令 或 py命令 按回车键 </span>
python
	
<span class="token comment"># 进入如下python命令模式</span>
Python <span class="token number">3.11</span>.3 <span class="token punctuation">(</span>tags/v3.11.3:f3909b8, Apr  <span class="token number">4</span> <span class="token number">2023</span>, <span class="token number">23</span>:49:59<span class="token punctuation">)</span> <span class="token punctuation">[</span>MSC v.1934 <span class="token number">64</span> bit <span class="token punctuation">(</span>AMD64<span class="token punctuation">)</span><span class="token punctuation">]</span> on win64
Type <span class="token string">"help"</span>, <span class="token string">"copyright"</span>, <span class="token string">"credits"</span> or <span class="token string">"license"</span> <span class="token keyword">for</span> <span class="token function">more</span> information.
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>
</code></pre> 
<h5><a id="3pip_47"></a>3、安装pip包管理工具</h5> 
<blockquote> 
 <p>注：如果已安装过pip包管理工具的话，此步也可直接路过（一般在安装Python环境时，可以在安装配置项中勾选上pip，这样在安装Python环境时自动将pip也安装上了），以下是没有过安装pip的安装步骤！</p> 
</blockquote> 
<blockquote> 
 <p>pip是一个安装Python包的管理工具，很多功能强大、使用方便的Python框架、插件、工具等，都是通过pip来进行安装的，在后面的自动化测试就需要pip来安装selenium自动化集成测试框架。</p> 
</blockquote> 
<h6><a id="1pip_52"></a>(1)、下载pip</h6> 
<p>注：如果是在Linux系统环境下（只要支持apt-get命令），可以直接执行如下命令安装即可！</p> 
<pre><code class="prism language-sh"><span class="token function">apt-get</span> <span class="token function">install</span> python-pip
</code></pre> 
<p><a href="https://pypi.org/project/pip" rel="nofollow">pip下载地址：https://pypi.org/project/pip</a></p> 
<p><img src="https://images2.imgbox.com/38/2b/8Hbs04Tl_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="2pip_65"></a>(2)、安装pip</h6> 
<p>将下载的pip-23.0.1.tar.gz文件解压，并在解压后的文件目录中打开命令行工具，执行安装命令（注：应步骤先安装好python环境才能执行成功哦！！）</p> 
<pre><code class="prism language-sh">python setup.py <span class="token function">install</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/00/72/UP5Ga3hv_o.png" alt="在这里插入图片描述"></p> 
<p>在命令执行结束后，执行如下命令，可查看是否安装成功。</p> 
<pre><code class="prism language-sh">pip <span class="token parameter variable">--version</span>

<span class="token comment"># 如果显示版本号则表示安装成功！ </span>
pip <span class="token number">22.3</span>.1 from D:<span class="token punctuation">\</span>Program Files <span class="token punctuation">(</span>x86<span class="token punctuation">)</span><span class="token punctuation">\</span>Python311<span class="token punctuation">\</span>Lib<span class="token punctuation">\</span>site-packages<span class="token punctuation">\</span>pip <span class="token punctuation">(</span>python <span class="token number">3.11</span><span class="token punctuation">)</span>

<span class="token comment"># 使用pip help命令可以显示所有pip的相关命令 和 功能说明</span>
pip <span class="token builtin class-name">help</span>
PS E:<span class="token punctuation">\</span>Desktop<span class="token operator">&gt;</span> pip <span class="token builtin class-name">help</span>
Usage:
  pip <span class="token operator">&lt;</span>command<span class="token operator">&gt;</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span>
Commands:
  <span class="token function">install</span>                     Install packages.
  download                    Download packages.
  uninstall                   Uninstall packages.
  freeze                      Output installed packages <span class="token keyword">in</span> requirements format.
  inspect                     Inspect the python environment.
  list                        List installed packages.
  show                        Show information about installed packages.
  check                       Verify installed packages have compatible dependencies.
  config                      Manage <span class="token builtin class-name">local</span> and global configuration.
  search                      Search PyPI <span class="token keyword">for</span> packages.
  cache                       Inspect and manage pip's wheel cache.
  index                       Inspect information available from package indexes.
  wheel                       Build wheels from your requirements.
  <span class="token builtin class-name">hash</span>                        Compute hashes of package archives.
  completion                  A helper <span class="token builtin class-name">command</span> used <span class="token keyword">for</span> <span class="token builtin class-name">command</span> completion.
  debug                       Show information useful <span class="token keyword">for</span> debugging.
  <span class="token builtin class-name">help</span>                        Show <span class="token builtin class-name">help</span> <span class="token keyword">for</span> commands.
  <span class="token punctuation">..</span>.
</code></pre> 
<h3><a id="WebDriver_110"></a>二、安装WebDriver驱动</h3> 
<blockquote> 
 <p>WebDriver给Python、Ruby、Java、C#等高级语言提供的很多API，支持开发人员使用自己喜欢的编程语言来操作浏览器，尤其是用在自动化测试上，了解更多<a href="https://www.selenium.dev/zh-cn/documentation/webdriver/" rel="nofollow">WebDriver</a>。</p> 
 <p>现在一般主流浏览器都有对应的WebDriver浏览器驱动，根据自己的需求下载即可。</p> 
</blockquote> 
<h5><a id="1WebDriver_116"></a>1、下载WebDriver</h5> 
<ul><li> <p>Chrome浏览器驱动下载地址：<a href="https://chromedriver.storage.googleapis.com/index.html" rel="nofollow">https://chromedriver.storage.googleapis.com/index.html</a></p> </li><li> <p>Edge浏览器驱动下载地址：<a href="https://developer.microsoft.com/zh-cn/microsoft-edge/tools/webdriver" rel="nofollow">https://developer.microsoft.com/zh-cn/microsoft-edge/tools/webdriver)</a> 或 <a href="https://msedgewebdriverstorage.z22.web.core.windows.net" rel="nofollow">https://msedgewebdriverstorage.z22.web.core.windows.net</a></p> </li><li> <p>Mozilla浏览器驱动下载地址：<a href="https://github.com/mozilla/geckodriver/tags">https://github.com/mozilla/geckodriver/tags</a></p> </li><li> <p>Opera浏览器驱动下载地址：<a href="https://github.com/operasoftware/operachromiumdriver/tags">https://github.com/operasoftware/operachromiumdriver/tags</a></p> </li><li> <p>Safari浏览器驱动下载地址：<a href="https://webkit.org/blog/6900/webdriver-support-in-safari-10" rel="nofollow">https://webkit.org/blog/6900/webdriver-support-in-safari-10</a></p> </li></ul> 
<p>可根据自己的需求，选择对应类型版本的驱动即可，这里以微软的Edge WebDriver为例（其他也是同样的操作），进入下载页面后，根据对应浏览器版本号，然后下载对应的WebDriver驱动文件。</p> 
<p><strong>注：WebDriver驱动版本号 一定要和 Web浏览器版本号 对应！！<br> 注：WebDriver驱动版本号 一定要和 Web浏览器版本号 对应！！</strong></p> 
<p><img src="https://images2.imgbox.com/73/87/pXdpHFHT_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="2WebDriver_132"></a>2、安装WebDriver</h5> 
<p>将下载好的developer.exe驱动文件解压后，复制移动到Python解释器所在的文件夹（就是Python的安装目录，和python.exe同级目录）就完成安装了。</p> 
<p><img src="https://images2.imgbox.com/d0/dc/ycNX2KxL_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="PyCharm__139"></a>三、安装PyCharm 开发环境</h3> 
<blockquote> 
 <p>PyCharm 是一个强大的面向专业开发者的Python IDE（Python集成开发环境、代码编辑器），PyCharm完全理解代码的每个面向。 依靠它的智能代码补全、 实时错误检查和快速修复功能，轻松进行项目导航 等众多辅助功能。</p> 
</blockquote> 
<h5><a id="1PyCharm_144"></a>1、下载PyCharm</h5> 
<p><a href="https://www.jetbrains.com.cn/pycharm" rel="nofollow">PyCharm下载地址：https://www.jetbrains.com.cn/pycharm</a></p> 
<p>根据自己的需求，选择对应操作系统下的试用收费版（【免费试用30天】比免费版支持开发语言更多、功能更齐全） 或 免费版（纯Python开发）。</p> 
<p><img src="https://images2.imgbox.com/fb/7c/rTRAnaLV_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="2PyCharm_155"></a>2、安装PyCharm</h5> 
<p>点击下载好的pycharm-community-2023.1.exe可执行文件，进入PyCharm安装对话界面，配置安装路径（这里同样也选择安装在D盘的Program Files (x86)目录下），然后选择各安装项如：创建桌面快捷方式、添加环境变量、右键菜单等（一般全都选上），Next 直到安装结束。</p> 
<p><img src="https://images2.imgbox.com/ff/ef/D7ew2QRt_o.png" alt="在这里插入图片描述"></p> 
<p>待PyCharm安装完成后，自动会在桌面创建快捷方式，双击PyCharm图标打开如下界面，到此PyCharm就装完成功啦，可根据自己的需要，新建项目、打开项目、从Get拉取代码等操作。</p> 
<p><img src="https://images2.imgbox.com/64/c7/NFd3LLU1_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="3PyCharm_165"></a>3、汉化PyCharm</h5> 
<p>默认情况下PyCharm编辑器是英文界面，如果想要显示中文界面，只需安装一个汉化插件即可。</p> 
<p><strong>Pycharm插件方法：</strong></p> 
<p>首先，打开PyCharm编辑器，点击左上角的主菜单按扭，选择“ file ”选项，然后点击“ setting ”，在打开后的界面中，点击“ plugins ”选项，输入“ Chinese ”找到中文安装包，点击“ Install ”，在安装完成后，点击“ restart IDE ”重启程序 或 关闭重新启动软件就变成中文界面啦。<br> <img src="https://images2.imgbox.com/34/d1/0T1giQid_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="4Pycharm_172"></a>4、其他Pycharm插件</h5> 
<p>PyCharm提供了许多好用的插件，可帮助提高开发效率，可根据自己的需要来进行安装，以下列出了一些常用的插件。<br> 注：部公插件在安装后需要关闭Pycharm再重新打开才生效哦！</p> 
<table><thead><tr><th>插件名称</th><th>功能用途</th></tr></thead><tbody><tr><td>Rainbow Brackets</td><td>把括号的内层和外层用不同的颜色显示</td></tr><tr><td>Indent Rainbow</td><td>对不同层级缩进的空格标注不同的颜色</td></tr><tr><td>Rainbow csv</td><td>对CSV文件当中的不同的行都可以用不同的颜色标出</td></tr><tr><td>Tabnine</td><td>自动填充代码插件</td></tr><tr><td>CodeGlance</td><td>快速预览(在编辑器右侧生成预览区，拖到可快捷的定位所要寻找的代码位置)</td></tr><tr><td>JSON Parser</td><td>JSON美化插件</td></tr><tr><td>Markdown Navigator</td><td>可实时的预览和编辑Markdown文件</td></tr><tr><td>Translation</td><td>翻译插件</td></tr><tr><td>Regex Tester</td><td>正则表达式测试插件</td></tr><tr><td>Key Promoter X</td><td>提供快捷键提示，以快速地掌握PyCharm的快捷键</td></tr></tbody></table> 
<h3><a id="Selenium_188"></a>四、安装Selenium框架</h3> 
<blockquote> 
 <p>Selenium是一个用于Web应用程序测试的自动化集成测试操作框架。由thoughtworks 公司推出，它可以直接在浏览器中运行，模拟真实用户直接在浏览器中模拟用户操作。在自动化测试中，可用于单元测试、冒烟测试、集成测试、回归测试、系统测试等，并且可以运行在不同类型的浏览器和操作系统上。利用Selenium，可以驱动浏览器执行特定的动作，比如：点击、下拉等等，还可以获取浏览器当前呈现的页面的源代码。支持包括Microsoft Edge(IE之后)、Google Chrome、Opera、Mozilla Firefox、Apple Safari、等浏览器。</p> 
</blockquote> 
<p><a href="https://www.selenium.dev/zh-cn" rel="nofollow">Selenium 官网：https://www.selenium.dev</a></p> 
<p><a href="https://github.com/SeleniumHQ/selenium">Selenium GitHub地址：https://github.com/SeleniumHQ/selenium</a></p> 
<p><a href="https://www.selenium.dev/selenium/docs/api/py" rel="nofollow">Selenium API文档：https://www.selenium.dev/selenium/docs/api/py</a></p> 
<h5><a id="1_199"></a>1、全局安装</h5> 
<p>要查看全局安装的selenium包存放路径（一般同Python的安装路径） 如：D:\Program Files (x86)\Python311\lib\site-packages\selenium</p> 
<pre><code class="prism language-sh"><span class="token comment"># 格式 pip install 要安装的包名</span>
pip <span class="token function">install</span> selenium
    
    
<span class="token comment"># 或（-U 安装或升级）</span>
pip <span class="token function">install</span> <span class="token parameter variable">-U</span> selenium


<span class="token comment"># 如果要安装指定的selenium版本（安装其他包的操作也相同）</span>
<span class="token comment"># 格式 pip install 要安装的包名 == 要指定安装的版本号</span>
pip <span class="token function">install</span> selenium <span class="token operator">==</span> <span class="token number">4.8</span>.0


<span class="token comment"># 在输入pip install selenium命令后 按回车确认键，就开始显示以下安装过程</span>
PS E:<span class="token punctuation">\</span>AutoTest<span class="token operator">&gt;</span> pip <span class="token function">install</span> selenium
Defaulting to user installation because normal site-packages is not writeable
Collecting selenium
Downloading selenium-4.8.3-py3-none-any.whl <span class="token punctuation">(</span><span class="token number">6.5</span> MB<span class="token punctuation">)</span>
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╸━━━━ <span class="token number">5.8</span>/6.5 MB <span class="token number">86.6</span> kB/s eta <span class="token number">0</span>:00:16 
</code></pre> 
<h5><a id="2_225"></a>2、局部安装</h5> 
<p>局部安装需要指定安装目录，可通过–target参数来指定</p> 
<pre><code class="prism language-sh"><span class="token comment"># 格式：</span>
pip <span class="token function">install</span> <span class="token parameter variable">--target</span><span class="token operator">=</span>path_name package_name <span class="token comment"># path_name表示安装的路径， package_name表示安装包名</span>

<span class="token comment"># 例如</span>
pip <span class="token function">install</span> <span class="token parameter variable">--target</span><span class="token operator">=</span>./lib selenium <span class="token comment"># 表示将selenium包安装在，当前目录下的lib文件夹中（./表示当前目录）</span>
</code></pre> 
<h5><a id="3_237"></a>3、查看与卸载</h5> 
<h6><a id="1_238"></a>（1）、查看包的版本号</h6> 
<p>安装完成后，想要查看某个包的版本号，可在命令行工具中输入pip show 包名 来进行查看</p> 
<pre><code class="prism language-powershell">pip show selenium

<span class="token comment"># 如在输入pip show selenium命令后 按回车确认键，会显示出selenium包的版本号、安装路径等相关信息！</span>
<span class="token function">PS</span> E:\AutoTest&gt; pip show selenium
Name: selenium
Version: 4<span class="token punctuation">.</span>8<span class="token punctuation">.</span>3
Summary:
Home-page: https:<span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>dev
Author:
Author-email:
License: Apache 2<span class="token punctuation">.</span>0
Location: C:\Users\MuGuiLin\AppData\Roaming\Python\Python311\site-packages
Requires: certifi<span class="token punctuation">,</span> trio<span class="token punctuation">,</span> trio-websocket<span class="token punctuation">,</span> urllib3
Required-by:
</code></pre> 
<h6><a id="2_256"></a>（2）、卸载已安装好的包</h6> 
<p>如果想要删除已安装好的包，可在命令行工具中输入 pip uninstall 包名 来进行卸载删除</p> 
<pre><code class="prism language-powershell">pip uninstall selenium

<span class="token comment"># 在输入pip uninstall selenium命令后 按回车确认键，会显提示Proceed (Y/n)? 输入Y表示确认删除！</span>
<span class="token function">PS</span> E:\AutoTest&gt; pip uninstall selenium
Found existing installation: selenium 4<span class="token punctuation">.</span>8<span class="token punctuation">.</span>3
Uninstalling selenium-4<span class="token punctuation">.</span>8<span class="token punctuation">.</span>3:
  Would remove:
    c:\users\muguilin\appdata\roaming\python\python311\site-packages\selenium-4<span class="token punctuation">.</span>8<span class="token punctuation">.</span>3<span class="token punctuation">.</span>dist-info\<span class="token operator">*</span>
    c:\users\muguilin\appdata\roaming\python\python311\site-packages\selenium\<span class="token operator">*</span>
Proceed <span class="token punctuation">(</span>Y/n<span class="token punctuation">)</span>?
</code></pre> 
<h3><a id="_270"></a>五、自动化测试实例</h3> 
<h5><a id="1_272"></a>1、创建实例项目</h5> 
<p>打开PyCharm编辑器，根据如下图所示创建自动化测试项目实例。<br> <img src="https://images2.imgbox.com/d9/82/fsRr0BLv_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="2_276"></a>2、编写实例代码</h5> 
<p>项目创建完成后，新建一个python测试文件，用于编写测试代码，具体步骤：在左侧项目AutoTest文件夹上，鼠标点击右键 -&gt; new 新建 -&gt; python文件，输入文件名为test.py，操作实例如下图所示：<br> <img src="https://images2.imgbox.com/af/81/OUCXLjuD_o.png" alt="在这里插入图片描述"><br> <strong>test.py文件内容如下</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># -*- coding: UTF-8 -*-</span>

<span class="token comment"># 导入selenium框架</span>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By
<span class="token keyword">import</span> time

<span class="token comment"># 开启浏览器测试会话</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Edge<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 注：如果不在PyCharm编辑器中运行代码，侧需要指定Edge WebDriver驱动路径</span>
<span class="token comment"># driver = webdriver.Edge(r'D:/Program Files (x86)/Python311/msedgedriver.exe')</span>

<span class="token comment"># 指定加载浏览器RUL（要测试的网址）</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://www.muguilin.com"</span><span class="token punctuation">)</span>

<span class="token comment"># 最大化浏览器窗口</span>
driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 强制延时等待1分钟</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span>

<span class="token comment"># 退出测试会话</span>
driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="3_307"></a>3、运行实例代码</h5> 
<h6><a id="1PyCharm_308"></a>(1)、在PyCharm编辑器中运行代码</h6> 
<p>直接点击上方工具栏中的运行按扭（默认运行main.py文件），或 左侧左侧项目目录中的xxx.py文件上右击 -&gt; Run运行(U) ，双或者 在左侧项目目录中选择好要运行的xxx.py文件，用快捷键同时按下Ctrl+Shift+F10来运行当前选中的文件 。<br> <img src="https://images2.imgbox.com/4f/5b/jHFp5qCJ_o.jpg" alt="在这里插入图片描述"></p> 
<h6><a id="2Dos_312"></a>(2)、在Dos命令行工具中运行代码</h6> 
<p>进入要运行代码的目录，按住Shift键不放，鼠标在空白处右击 -&gt; 在此处打开PowerShell命令窗口(S)，输入python test.py 回车便启动运行啦！</p> 
<pre><code class="prism language-sh">python test.py
<span class="token comment"># 或</span>
py test.py
</code></pre> 
<p><img src="https://images2.imgbox.com/c5/41/aC7eZ07P_o.jpg" alt="在这里插入图片描述"></p> 
<p>命令执行后会自动打开浏览器，并跳转到测试实例代码中指定的网址，实例效果如下：</p> 
<p><img src="https://images2.imgbox.com/d8/92/x0Ijg2Uh_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="3Git__Pycharm_324"></a>(3)、从Git上 或者 是从其他地方复制过的代码，在Pycharm中打开项目运行。</h6> 
<p>在Pycharm中打开项目后，在运行时可能报selenium不存在、找不到selenium模块，selenium和webdriver上下有红色波浪线，左下角也提示：unresolved reference ‘webdriver’，导致无法运行。</p> 
<p><strong>原因：</strong> 在Pycharm打开新打开 或 新建项目时，会自动设置(可也以指定)运行环境为虚拟环境。此如一来，即便是之前你在操作系统中安装了selenium模块，但是这个新打开 或 新建项目的venv虚拟环境中是没有selenium 模块，所以才会提示在Pycharm 找不到selenium模块导致的这个错误。</p> 
<p>**解决办法：**就是在项目的venv虚拟环境目录中安装selenium<br> 1、在Pycharm中打在命令行工具<br> 2、进入venv虚拟环境目录：cd venv<br> 3、进入python虚拟环境：Scripts\activate<br> 4、安装selenium模块包：pip install selenium<br> <img src="https://images2.imgbox.com/fb/29/EGA2rQJI_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_338"></a>六、扩展</h3> 
<blockquote> 
 <p>想了解更多Selenium框架的使用方法，可去这里查看 <a href="https://selenium-python.readthedocs.io/api.html" rel="nofollow">https://selenium-python.readthedocs.io/api.html</a></p> 
</blockquote> 
<pre><code class="prism language-python"><span class="token comment"># 引入selenium操作框架</span>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token comment"># 开启浏览器会话</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Edge<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 显示driver对象提供的所有方法关键字</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'driver对象中的关键字：'</span><span class="token punctuation">,</span> <span class="token builtin">dir</span><span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 在下面的各个关键字前 加上 driver. 就可以访问对应的方法和常量了，如：driver.get_window_size()</span>

<span class="token string">'__abstractmethods__'</span><span class="token punctuation">,</span> <span class="token string">'__class__'</span><span class="token punctuation">,</span> <span class="token string">'__delattr__'</span><span class="token punctuation">,</span> <span class="token string">'__dict__'</span><span class="token punctuation">,</span> <span class="token string">'__dir__'</span><span class="token punctuation">,</span> <span class="token string">'__doc__'</span><span class="token punctuation">,</span> <span class="token string">'__enter__'</span><span class="token punctuation">,</span> <span class="token string">'__eq__'</span><span class="token punctuation">,</span> <span class="token string">'__exit__'</span><span class="token punctuation">,</span> <span class="token string">'__format__'</span><span class="token punctuation">,</span> <span class="token string">'__ge__'</span><span class="token punctuation">,</span> <span class="token string">'__getattribute__'</span><span class="token punctuation">,</span> <span class="token string">'__gt__'</span><span class="token punctuation">,</span> <span class="token string">'__hash__'</span><span class="token punctuation">,</span> <span class="token string">'__init__'</span><span class="token punctuation">,</span> <span class="token string">'__init_subclass__'</span><span class="token punctuation">,</span> <span class="token string">'__le__'</span><span class="token punctuation">,</span> <span class="token string">'__lt__'</span><span class="token punctuation">,</span> <span class="token string">'__module__'</span><span class="token punctuation">,</span> <span class="token string">'__ne__'</span><span class="token punctuation">,</span> <span class="token string">'__new__'</span><span class="token punctuation">,</span> <span class="token string">'__reduce__'</span><span class="token punctuation">,</span> <span class="token string">'__reduce_ex__'</span><span class="token punctuation">,</span> <span class="token string">'__repr__'</span><span class="token punctuation">,</span> <span class="token string">'__setattr__'</span><span class="token punctuation">,</span> <span class="token string">'__sizeof__'</span><span class="token punctuation">,</span> <span class="token string">'__str__'</span><span class="token punctuation">,</span> <span class="token string">'__subclasshook__'</span><span class="token punctuation">,</span> <span class="token string">'__weakref__'</span><span class="token punctuation">,</span> <span class="token string">'_abc_impl'</span><span class="token punctuation">,</span> <span class="token string">'_authenticator_id'</span><span class="token punctuation">,</span> <span class="token string">'_file_detector'</span><span class="token punctuation">,</span> <span class="token string">'_get_cdp_details'</span><span class="token punctuation">,</span> <span class="token string">'_is_remote'</span><span class="token punctuation">,</span> <span class="token string">'_mobile'</span><span class="token punctuation">,</span> <span class="token string">'_shadowroot_cls'</span><span class="token punctuation">,</span> <span class="token string">'_switch_to'</span><span class="token punctuation">,</span> <span class="token string">'_unwrap_value'</span><span class="token punctuation">,</span> <span class="token string">'_web_element_cls'</span><span class="token punctuation">,</span> <span class="token string">'_wrap_value'</span><span class="token punctuation">,</span> <span class="token string">'add_cookie'</span><span class="token punctuation">,</span> <span class="token string">'add_credential'</span><span class="token punctuation">,</span> <span class="token string">'add_virtual_authenticator'</span><span class="token punctuation">,</span> <span class="token string">'application_cache'</span><span class="token punctuation">,</span> <span class="token string">'back'</span><span class="token punctuation">,</span> <span class="token string">'bidi_connection'</span><span class="token punctuation">,</span> <span class="token string">'capabilities'</span><span class="token punctuation">,</span> <span class="token string">'caps'</span><span class="token punctuation">,</span> <span class="token string">'close'</span><span class="token punctuation">,</span> <span class="token string">'command_executor'</span><span class="token punctuation">,</span> <span class="token string">'create_options'</span><span class="token punctuation">,</span> <span class="token string">'create_web_element'</span><span class="token punctuation">,</span> <span class="token string">'current_url'</span><span class="token punctuation">,</span> <span class="token string">'current_window_handle'</span><span class="token punctuation">,</span> <span class="token string">'delete_all_cookies'</span><span class="token punctuation">,</span> <span class="token string">'delete_cookie'</span><span class="token punctuation">,</span> <span class="token string">'delete_network_conditions'</span><span class="token punctuation">,</span> <span class="token string">'desired_capabilities'</span><span class="token punctuation">,</span> <span class="token string">'error_handler'</span><span class="token punctuation">,</span> <span class="token string">'execute'</span><span class="token punctuation">,</span> <span class="token string">'execute_async_script'</span><span class="token punctuation">,</span> <span class="token string">'execute_cdp_cmd'</span><span class="token punctuation">,</span> <span class="token string">'execute_script'</span><span class="token punctuation">,</span> <span class="token string">'file_detector'</span><span class="token punctuation">,</span> <span class="token string">'file_detector_context'</span><span class="token punctuation">,</span> <span class="token string">'find_element'</span><span class="token punctuation">,</span> <span class="token string">'find_elements'</span><span class="token punctuation">,</span> <span class="token string">'forward'</span><span class="token punctuation">,</span> <span class="token string">'fullscreen_window'</span><span class="token punctuation">,</span> <span class="token string">'get'</span><span class="token punctuation">,</span> <span class="token string">'get_cookie'</span><span class="token punctuation">,</span> <span class="token string">'get_cookies'</span><span class="token punctuation">,</span> <span class="token string">'get_credentials'</span><span class="token punctuation">,</span> <span class="token string">'get_issue_message'</span><span class="token punctuation">,</span> <span class="token string">'get_log'</span><span class="token punctuation">,</span> <span class="token string">'get_network_conditions'</span><span class="token punctuation">,</span> <span class="token string">'get_pinned_scripts'</span><span class="token punctuation">,</span> <span class="token string">'get_screenshot_as_base64'</span><span class="token punctuation">,</span> <span class="token string">'get_screenshot_as_file'</span><span class="token punctuation">,</span> <span class="token string">'get_screenshot_as_png'</span><span class="token punctuation">,</span> <span class="token string">'get_sinks'</span><span class="token punctuation">,</span> <span class="token string">'get_window_position'</span><span class="token punctuation">,</span> <span class="token string">'get_window_rect'</span><span class="token punctuation">,</span> <span class="token string">'get_window_size'</span><span class="token punctuation">,</span> <span class="token string">'implicitly_wait'</span><span class="token punctuation">,</span> <span class="token string">'launch_app'</span><span class="token punctuation">,</span> <span class="token string">'log_types'</span><span class="token punctuation">,</span> <span class="token string">'maximize_window'</span><span class="token punctuation">,</span> <span class="token string">'minimize_window'</span><span class="token punctuation">,</span> <span class="token string">'mobile'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'orientation'</span><span class="token punctuation">,</span> <span class="token string">'page_source'</span><span class="token punctuation">,</span> <span class="token string">'pin_script'</span><span class="token punctuation">,</span> <span class="token string">'pinned_scripts'</span><span class="token punctuation">,</span> <span class="token string">'port'</span><span class="token punctuation">,</span> <span class="token string">'print_page'</span><span class="token punctuation">,</span> <span class="token string">'quit'</span><span class="token punctuation">,</span> <span class="token string">'refresh'</span><span class="token punctuation">,</span> <span class="token string">'remove_all_credentials'</span><span class="token punctuation">,</span> <span class="token string">'remove_credential'</span><span class="token punctuation">,</span> <span class="token string">'remove_virtual_authenticator'</span><span class="token punctuation">,</span> <span class="token string">'save_screenshot'</span><span class="token punctuation">,</span> <span class="token string">'service'</span><span class="token punctuation">,</span> <span class="token string">'session_id'</span><span class="token punctuation">,</span> <span class="token string">'set_network_conditions'</span><span class="token punctuation">,</span> <span class="token string">'set_page_load_timeout'</span><span class="token punctuation">,</span> <span class="token string">'set_permissions'</span><span class="token punctuation">,</span> <span class="token string">'set_script_timeout'</span><span class="token punctuation">,</span> <span class="token string">'set_sink_to_use'</span><span class="token punctuation">,</span> <span class="token string">'set_user_verified'</span><span class="token punctuation">,</span> <span class="token string">'set_window_position'</span><span class="token punctuation">,</span> <span class="token string">'set_window_rect'</span><span class="token punctuation">,</span> <span class="token string">'set_window_size'</span><span class="token punctuation">,</span> <span class="token string">'start_client'</span><span class="token punctuation">,</span> <span class="token string">'start_desktop_mirroring'</span><span class="token punctuation">,</span> <span class="token string">'start_session'</span><span class="token punctuation">,</span> <span class="token string">'start_tab_mirroring'</span><span class="token punctuation">,</span> <span class="token string">'stop_casting'</span><span class="token punctuation">,</span> <span class="token string">'stop_client'</span><span class="token punctuation">,</span> <span class="token string">'switch_to'</span><span class="token punctuation">,</span> <span class="token string">'timeouts'</span><span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">,</span> <span class="token string">'unpin'</span><span class="token punctuation">,</span> <span class="token string">'vendor_prefix'</span><span class="token punctuation">,</span> <span class="token string">'virtual_authenticator_id'</span><span class="token punctuation">,</span> <span class="token string">'window_handles'</span>

</code></pre> 
<h5><a id="1SeleniumAPI_358"></a>1、Selenium常用的浏览器操作API</h5> 
<pre><code class="prism language-python"><span class="token comment"># 引入selenium操作框架</span>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

<span class="token comment"># 开启浏览器会话</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># driver = webdriver.Edge()</span>

<span class="token comment"># 指定加载浏览器RUL</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://www.muguilin.com"</span><span class="token punctuation">)</span>

<span class="token comment"># 打开新页面</span>
driver<span class="token punctuation">.</span>navigate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span><span class="token string">"http://www.muguilin.com/blog"</span><span class="token punctuation">)</span>

<span class="token comment"># 最大化窗口（有时候执行某些按扭、事件等无效时，就是没有最大化浏览器窗口【不在可视区】导致的！）</span>
driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 最小化窗口</span>
driver<span class="token punctuation">.</span>minimize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 保存屏幕截图</span>
driver<span class="token punctuation">.</span>save_screenshot<span class="token punctuation">(</span><span class="token string">'fileName'</span><span class="token punctuation">)</span>

<span class="token comment"># 获取当前浏览器窗口可视区宽高</span>
driver<span class="token punctuation">.</span>get_window_size<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 获取当前窗口坐标</span>
driver<span class="token punctuation">.</span>get_window_position<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 设置窗口大小</span>
driver<span class="token punctuation">.</span>set_window_size<span class="token punctuation">(</span><span class="token number">1920</span><span class="token punctuation">,</span> <span class="token number">1080</span><span class="token punctuation">)</span>

<span class="token comment"># 刷新页面</span>
driver<span class="token punctuation">.</span>refresh<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 前进页面</span>
driver<span class="token punctuation">.</span>forward<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 后退页面</span>
driver<span class="token punctuation">.</span>back<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 关闭窗口</span>
driver<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 关闭浏览器会话（关闭session等）</span>
driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<h5><a id="2Selenium_410"></a>2、Selenium常用的元素选择器（元素定位）</h5> 
<pre><code class="prism language-python"><span class="token comment"># 引入selenium操作框架</span>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

<span class="token comment"># 开启浏览器会话</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 其他浏览器会话方法</span>
<span class="token comment"># webdriver.Firefox()</span>
<span class="token comment"># webdriver.FirefoxProfile()</span>
<span class="token comment"># webdriver.FirefoxOptions()</span>
<span class="token comment"># webdriver.Chrome()</span>
<span class="token comment"># webdriver.ChromeOptions()</span>
<span class="token comment"># webdriver.Ie()</span>
<span class="token comment"># webdriver.IeOptions()</span>
<span class="token comment"># webdriver.Edge()</span>
<span class="token comment"># webdriver.ChromiumEdge()</span>
<span class="token comment"># webdriver.EdgeOptions()</span>
<span class="token comment"># webdriver.Safari()</span>
<span class="token comment"># webdriver.WebKitGTK()</span>
<span class="token comment"># webdriver.WebKitGTKOptions()</span>
<span class="token comment"># webdriver.WPEWebKit()</span>
<span class="token comment"># webdriver.WPEWebKitOptions()</span>
<span class="token comment"># webdriver.Remote()</span>
<span class="token comment"># webdriver.DesiredCapabilities()</span>
<span class="token comment"># webdriver.ActionChains()</span>
<span class="token comment"># webdriver.Proxy()</span>
<span class="token comment"># webdriver.Keys()</span>

<span class="token comment"># 最大化窗口</span>
driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>  

<span class="token comment"># 指定加载浏览器RUL</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://www.muguilin.com"</span><span class="token punctuation">)</span>

<span class="token comment"># 选择input元素并设置值</span>
username <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>by<span class="token operator">=</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token string">'username'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">)</span>
passwerd <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>by<span class="token operator">=</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token string">'passwerd'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">'123456'</span><span class="token punctuation">)</span>

<span class="token comment"># 选择button元素并模拟点击事件</span>
driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>by<span class="token operator">=</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token string">'login-button'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 设置取username输入框文本内容</span>
username<span class="token punctuation">.</span>sendKeys<span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span>

<span class="token comment"># 获取username输入框文本内容</span>
username<span class="token punctuation">.</span>getText<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 清空username输入框文本内容</span>
username<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># driver.find_element(By.ID, 'xxxid') // 单个DOM元素选择器方法</span>
<span class="token comment"># driver.find_elements(By.CLASS_NAME, 'xxxClassName') // 多个DOM元素选择器方法</span>

<span class="token comment"># 其他DOM元素选择器方法</span>
<span class="token comment"># ID = "id"</span>
<span class="token comment"># NAME = "name"</span>
<span class="token comment"># TAG_NAME = "tag name"</span>
<span class="token comment"># CLASS_NAME = "class name"</span>
<span class="token comment"># LINK_TEXT = "link text"</span>
<span class="token comment"># PARTIAL_LINK_TEXT = "partial link text"</span>
<span class="token comment"># XPATH = "xpath"</span>
<span class="token comment"># CSS_SELECTOR = "css selector"</span>

<span class="token comment"># 关闭浏览器会话</span>
driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<h5><a id="3SeleniumActionChains_482"></a>3、Selenium鼠标模拟操作（ActionChains类）</h5> 
<p>Selenium框架中的ActionChains类供了很多，如：右击，双击，悬停，滑动、以及拖放等鼠标模拟操作。</p> 
<h6><a id="1ActionChains_484"></a>(1)、ActionChains类</h6> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""The ActionChains implementation,"""</span>

<span class="token keyword">class</span> <span class="token class-name">ActionChains</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> driver<span class="token punctuation">,</span> duration<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">perform</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span>
       
    <span class="token keyword">def</span> <span class="token function">reset_actions</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">click</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> on_element<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">click_and_hold</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> on_element<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">context_click</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> on_element<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
       
    <span class="token keyword">def</span> <span class="token function">double_click</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> on_element<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
       
    <span class="token keyword">def</span> <span class="token function">drag_and_drop</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> source<span class="token punctuation">,</span> target<span class="token punctuation">)</span>
       
    <span class="token keyword">def</span> <span class="token function">drag_and_drop_by_offset</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> source<span class="token punctuation">,</span> xoffset<span class="token punctuation">,</span> yoffset<span class="token punctuation">)</span>
      
    <span class="token keyword">def</span> <span class="token function">key_down</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">,</span> element<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
       
    <span class="token keyword">def</span> <span class="token function">key_up</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">,</span> element<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">move_by_offset</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> xoffset<span class="token punctuation">,</span> yoffset<span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">move_to_element</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> to_element<span class="token punctuation">)</span>
       
    <span class="token keyword">def</span> <span class="token function">move_to_element_with_offset</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> to_element<span class="token punctuation">,</span> xoffset<span class="token punctuation">,</span> yoffset<span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">pause</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> seconds<span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">release</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> on_element<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">send_keys</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>keys_to_send<span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">send_keys_to_element</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> element<span class="token punctuation">,</span> <span class="token operator">*</span>keys_to_send<span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">scroll_to_element</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> element<span class="token punctuation">:</span> WebElement<span class="token punctuation">)</span>
     
    <span class="token keyword">def</span> <span class="token function">scroll_by_amount</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> delta_x<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> delta_y<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span>
       
    <span class="token keyword">def</span> <span class="token function">scroll_from_origin</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> scroll_origin<span class="token punctuation">:</span> ScrollOrigin<span class="token punctuation">,</span> delta_x<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> delta_y<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span>
       
    <span class="token keyword">def</span> <span class="token function">scroll</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> delta_x<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> delta_y<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> duration<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> origin<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">"viewport"</span><span class="token punctuation">)</span>
       
    <span class="token keyword">def</span> <span class="token function">__enter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">__exit__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> _type<span class="token punctuation">,</span> _value<span class="token punctuation">,</span> _traceback<span class="token punctuation">)</span>
    
</code></pre> 
<h6><a id="2ActionChains_539"></a>(2)、ActionChains类的基本使用</h6> 
<p>在使用前，需要先导入ActionChains类，通过ActionChains类提供的相关方法来模拟鼠标操作，在调用ActionChains的方法时，并不是立即执行的，而是把所有的操作，按顺序存放在一个队列里，当调用perform()方法时，队列中的事件会依次执行。</p> 
<pre><code class="prism language-python"><span class="token comment"># 引入selenium操作框架</span>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver <span class="token keyword">import</span> ActionChains
<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep

<span class="token comment"># 开启浏览器会话</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 指定加载浏览器RUL</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://www.baidu.com"</span><span class="token punctuation">)</span>

<span class="token comment"># 装载ActionChains类</span>
action <span class="token operator">=</span> ActionChains<span class="token punctuation">(</span>driver<span class="token punctuation">)</span>

sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># 模拟右键点击</span>
action<span class="token punctuation">.</span>context_click<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 在选择ID为kw的input元素上 模拟右键点击</span>
element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>by<span class="token operator">=</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token string">'kw'</span><span class="token punctuation">)</span>
action<span class="token punctuation">.</span>context_click<span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span>

sleep<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>

</code></pre> 
<h5><a id="4SeleniumKeys_571"></a>4、Selenium键盘模拟操作（Keys类）</h5> 
<p>在自动化测试开发过程中，除了模拟鼠标操作以外，有时还需要借助模拟键盘操作一起来配合使用，Selenium的Keys类供了很多复制、粘贴、全选，以及触发回车键、删除键甚至组合式快捷键等。</p> 
<h6><a id="1Keys_574"></a>(1)、Keys类</h6> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""The Keys implementation."""</span>
<span class="token keyword">class</span> <span class="token class-name">Keys</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Set of special keys codes."""</span>

    NULL <span class="token operator">=</span> <span class="token string">"\ue000"</span>
    CANCEL <span class="token operator">=</span> <span class="token string">"\ue001"</span>  <span class="token comment"># ^break</span>
    HELP <span class="token operator">=</span> <span class="token string">"\ue002"</span>
    BACKSPACE <span class="token operator">=</span> <span class="token string">"\ue003"</span>
    BACK_SPACE <span class="token operator">=</span> BACKSPACE
    TAB <span class="token operator">=</span> <span class="token string">"\ue004"</span>
    CLEAR <span class="token operator">=</span> <span class="token string">"\ue005"</span>
    RETURN <span class="token operator">=</span> <span class="token string">"\ue006"</span>
    ENTER <span class="token operator">=</span> <span class="token string">"\ue007"</span>
    SHIFT <span class="token operator">=</span> <span class="token string">"\ue008"</span>
    LEFT_SHIFT <span class="token operator">=</span> SHIFT
    CONTROL <span class="token operator">=</span> <span class="token string">"\ue009"</span>
    LEFT_CONTROL <span class="token operator">=</span> CONTROL
    ALT <span class="token operator">=</span> <span class="token string">"\ue00a"</span>
    LEFT_ALT <span class="token operator">=</span> ALT
    PAUSE <span class="token operator">=</span> <span class="token string">"\ue00b"</span>
    ESCAPE <span class="token operator">=</span> <span class="token string">"\ue00c"</span>
    SPACE <span class="token operator">=</span> <span class="token string">"\ue00d"</span>
    PAGE_UP <span class="token operator">=</span> <span class="token string">"\ue00e"</span>
    PAGE_DOWN <span class="token operator">=</span> <span class="token string">"\ue00f"</span>
    END <span class="token operator">=</span> <span class="token string">"\ue010"</span>
    HOME <span class="token operator">=</span> <span class="token string">"\ue011"</span>
    LEFT <span class="token operator">=</span> <span class="token string">"\ue012"</span>
    ARROW_LEFT <span class="token operator">=</span> LEFT
    UP <span class="token operator">=</span> <span class="token string">"\ue013"</span>
    ARROW_UP <span class="token operator">=</span> UP
    RIGHT <span class="token operator">=</span> <span class="token string">"\ue014"</span>
    ARROW_RIGHT <span class="token operator">=</span> RIGHT
    DOWN <span class="token operator">=</span> <span class="token string">"\ue015"</span>
    ARROW_DOWN <span class="token operator">=</span> DOWN
    INSERT <span class="token operator">=</span> <span class="token string">"\ue016"</span>
    DELETE <span class="token operator">=</span> <span class="token string">"\ue017"</span>
    SEMICOLON <span class="token operator">=</span> <span class="token string">"\ue018"</span>
    EQUALS <span class="token operator">=</span> <span class="token string">"\ue019"</span>

    NUMPAD0 <span class="token operator">=</span> <span class="token string">"\ue01a"</span>  <span class="token comment"># number pad keys</span>
    NUMPAD1 <span class="token operator">=</span> <span class="token string">"\ue01b"</span>
    NUMPAD2 <span class="token operator">=</span> <span class="token string">"\ue01c"</span>
    NUMPAD3 <span class="token operator">=</span> <span class="token string">"\ue01d"</span>
    NUMPAD4 <span class="token operator">=</span> <span class="token string">"\ue01e"</span>
    NUMPAD5 <span class="token operator">=</span> <span class="token string">"\ue01f"</span>
    NUMPAD6 <span class="token operator">=</span> <span class="token string">"\ue020"</span>
    NUMPAD7 <span class="token operator">=</span> <span class="token string">"\ue021"</span>
    NUMPAD8 <span class="token operator">=</span> <span class="token string">"\ue022"</span>
    NUMPAD9 <span class="token operator">=</span> <span class="token string">"\ue023"</span>
    MULTIPLY <span class="token operator">=</span> <span class="token string">"\ue024"</span>
    ADD <span class="token operator">=</span> <span class="token string">"\ue025"</span>
    SEPARATOR <span class="token operator">=</span> <span class="token string">"\ue026"</span>
    SUBTRACT <span class="token operator">=</span> <span class="token string">"\ue027"</span>
    DECIMAL <span class="token operator">=</span> <span class="token string">"\ue028"</span>
    DIVIDE <span class="token operator">=</span> <span class="token string">"\ue029"</span>

    F1 <span class="token operator">=</span> <span class="token string">"\ue031"</span>  <span class="token comment"># function  keys</span>
    F2 <span class="token operator">=</span> <span class="token string">"\ue032"</span>
    F3 <span class="token operator">=</span> <span class="token string">"\ue033"</span>
    F4 <span class="token operator">=</span> <span class="token string">"\ue034"</span>
    F5 <span class="token operator">=</span> <span class="token string">"\ue035"</span>
    F6 <span class="token operator">=</span> <span class="token string">"\ue036"</span>
    F7 <span class="token operator">=</span> <span class="token string">"\ue037"</span>
    F8 <span class="token operator">=</span> <span class="token string">"\ue038"</span>
    F9 <span class="token operator">=</span> <span class="token string">"\ue039"</span>
    F10 <span class="token operator">=</span> <span class="token string">"\ue03a"</span>
    F11 <span class="token operator">=</span> <span class="token string">"\ue03b"</span>
    F12 <span class="token operator">=</span> <span class="token string">"\ue03c"</span>

    META <span class="token operator">=</span> <span class="token string">"\ue03d"</span>
    COMMAND <span class="token operator">=</span> <span class="token string">"\ue03d"</span>
    ZENKAKU_HANKAKU <span class="token operator">=</span> <span class="token string">"\ue040"</span>
    
</code></pre> 
<h6><a id="2Keys_651"></a>(2)、Keys类的基本使用</h6> 
<p>在使用前，需要先导入Keys类，在选择好DOM元素后，配合send_keys()方法一起模拟键盘操作</p> 
<pre><code class="prism language-python"><span class="token comment"># 引入selenium操作框架</span>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>keys <span class="token keyword">import</span> Keys
<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep

<span class="token comment"># 开启浏览器会话</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 指定加载浏览器RUL</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://www.baidu.com"</span><span class="token punctuation">)</span>

sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># 在选择ID为kw的input元素上 模拟按回车键</span>
driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>by<span class="token operator">=</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token string">'kw'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">'沐枫'</span><span class="token punctuation">,</span> Keys<span class="token punctuation">.</span>ENTER<span class="token punctuation">)</span> <span class="token comment"># 回车键(ENTER)</span>
<span class="token comment">#driver.switch_to.active_element.send_keys(Keys.ENTER)</span>

sleep<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">"""
单个键 模拟
element.send_keys(Keys.F1)				# 键盘F1
element.send_keys(Keys.F5)				# 键盘F5(页面刷新)
element.send_keys(Keys.F12)				# 键盘F2(页面调试)
element.send_keys(Keys.TAB)				# 制表键(TAB)
element.send_keys(Keys.BACK_SPACE)		# 退格键(BackSpace)
element.send_keys(Keys.DELETE)		    # 删除键(DELETE)
element.send_keys(Keys.ENTER)			# 回车键(ENTER)
element.send_keys(Keys.SPACE)			# 空格键(SPACE)
"""</span>

<span class="token triple-quoted-string string">"""
组合键 模拟
element.send_keys(Keys.CONTROL,'a')		# 全选(Ctrl+A)
element.send_keys(Keys.CONTROL,'x')		# 剪切(Ctrl+X)
element.send_keys(Keys.CONTROL,'c')		# 复制(Ctrl+C)
element.send_keys(Keys.CONTROL,'s')		# 保存(Ctrl+S)
element.send_keys(Keys.CONTROL,'v')		# 粘贴(Ctrl+V)
"""</span>

</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/55f69db81ad5752990189a300795cb8d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">5分钟AI自动生成小说推文漫画视频-100%原创</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/08e02fd39b54238cf199b409b1977d25/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">打造专业级ChatGPT风格聊天界面：SpringBoot与Vue实现动态打字机效果，附完整前后端源码</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>