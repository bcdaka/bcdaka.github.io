<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title># Kafka_深入探秘者（1）：初识 kafka - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/05f1f86c807434f12c39f01cd32660b1/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="# Kafka_深入探秘者（1）：初识 kafka">
  <meta property="og:description" content="Kafka_深入探秘者（1）：初识 kafka 一、kafka 特性 1、Kafka ：最初是由 Linkedln 公司采用 Scala 语言开发的一个多分区、多副本并且基于 ZooKeeper 协调的分布式消息系统，现在已经捐献给了 Apache 基金会。目前 Kafka 已经定位为一个分布式流式处理平台，它以高吞吐、可持久化、可水平扩展、支持流处理等多种特性而被广泛应用。 2、Apache Kafka 是一个分布式的发布-订阅消,息系统，能够支撑海量数据的数据传递。在离线和实时的消息处理业务系统中，Kafka 都有广泛的应用。Kafka 将消息持久化到磁盘中，并对消息创建了备份保证了数据的安全。Kafka 在保证了较高的处理速度的同时，又能保证数据处理的低延迟和数据的零丢失。 3、示例图： 4、kafka 特性 (1)高吞吐量、低延迟: kafka 每秒可以处理几十万条消息，它的延迟最低只有几毫秒，每个主题可以分多个分区,消费组对分区进行消费操作;
(2)可扩展性: kafka 集群支持热扩展;
(3)持久性、可靠性: 消息被持久化到本地磁盘，并且支持数据备份防止数据丢失;
(4)容错性: 允许集群中节点失败(若副本数量为n,则允许n-1个节点失败);
(5)高并发: 支持数千个客户端同时读写;
5、kafka 使用场景 (1)日志收集: 一个公司可以用 Kafka 可以收集各种服务的 l0g，通过kafka以统一接口服务的方式开放给各种 consumer，例如 Hadoop、Hbase、Solr 等;
(2)消息系统: 解耦和生产者和消费者、缓存消息等:
(3)用户活动跟踪: Kafka经常被用来记录web用户或者app用户的各种活动，如浏览网页、搜索、点击等活动,这些活动信息被各个服务器发布到 kafka 的 topic 中，然后订阅者通过订阅这些 topic 来做实时的监控分析，或者装载到 Hadoop、数据仓库中做离线分析和挖掘;
(4)运营指标: Kafka 也经常用来记录运营监控数据。包括收集各种分布式应用的数据，生产各种操作的集中反馈，比如报警和报告。
(5)流式处理: 比如 spark streaming 和 storm。
6、技术优势 1）可伸缩性: Kafka 的两个重要特性造就了它的可伸缩性。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-24T11:30:26+08:00">
    <meta property="article:modified_time" content="2024-06-24T11:30:26+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title"># Kafka_深入探秘者（1）：初识 kafka</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Kafka_1_kafka_0"></a>Kafka_深入探秘者（1）：初识 kafka</h2> 
<h3><a id="kafka__2"></a>一、kafka 特性</h3> 
<h4><a id="1Kafka__Linkedln__Scala__ZooKeeper__Apache__Kafka__4"></a>1、Kafka ：最初是由 Linkedln 公司采用 Scala 语言开发的一个多分区、多副本并且基于 ZooKeeper 协调的分布式消息系统，现在已经捐献给了 Apache 基金会。目前 Kafka 已经定位为一个分布式流式处理平台，它以高吞吐、可持久化、可水平扩展、支持流处理等多种特性而被广泛应用。</h4> 
<h4><a id="2Apache_Kafka_Kafka_Kafka_Kafka__6"></a>2、Apache Kafka 是一个分布式的发布-订阅消,息系统，能够支撑海量数据的数据传递。在离线和实时的消息处理业务系统中，Kafka 都有广泛的应用。Kafka 将消息持久化到磁盘中，并对消息创建了备份保证了数据的安全。Kafka 在保证了较高的处理速度的同时，又能保证数据处理的低延迟和数据的零丢失。</h4> 
<h4><a id="3_8"></a>3、示例图：</h4> 
<p><img src="https://images2.imgbox.com/63/51/b0ZVpDIP_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="4kafka__16"></a>4、kafka 特性</h4> 
<ul><li> <p>(1)高吞吐量、低延迟: kafka 每秒可以处理几十万条消息，它的延迟最低只有几毫秒，每个主题可以分多个分区,消费组对分区进行消费操作;</p> </li><li> <p>(2)可扩展性: kafka 集群支持热扩展;</p> </li><li> <p>(3)持久性、可靠性: 消息被持久化到本地磁盘，并且支持数据备份防止数据丢失;</p> </li><li> <p>(4)容错性: 允许集群中节点失败(若副本数量为n,则允许n-1个节点失败);</p> </li><li> <p>(5)高并发: 支持数千个客户端同时读写;</p> </li></ul> 
<h4><a id="5kafka__28"></a>5、kafka 使用场景</h4> 
<ul><li>(1)日志收集:</li></ul> 
<p>一个公司可以用 Kafka 可以收集各种服务的 l0g，通过kafka以统一接口服务的方式开放给各种 consumer，例如 Hadoop、Hbase、Solr 等;</p> 
<ul><li>(2)消息系统:</li></ul> 
<p>解耦和生产者和消费者、缓存消息等:</p> 
<ul><li>(3)用户活动跟踪:</li></ul> 
<p>Kafka经常被用来记录web用户或者app用户的各种活动，如浏览网页、搜索、点击等活动,这些活动信息被各个服务器发布到 kafka 的 topic 中，然后订阅者通过订阅这些 topic 来做实时的监控分析，或者装载到 Hadoop、数据仓库中做离线分析和挖掘;</p> 
<ul><li>(4)运营指标:</li></ul> 
<p>Kafka 也经常用来记录运营监控数据。包括收集各种分布式应用的数据，生产各种操作的集中反馈，比如报警和报告。</p> 
<ul><li>(5)流式处理:</li></ul> 
<p>比如 spark streaming 和 storm。</p> 
<h4><a id="6_50"></a>6、技术优势</h4> 
<p>1）可伸缩性: Kafka 的两个重要特性造就了它的可伸缩性。</p> 
<ul><li>1、Kafka 集群在运行期间可以轻松地扩展或收缩(可以添加或删除代理)，而不会宕机。</li><li>2、可以扩展一个 Kafka 主题来包含更多的分区。由于一个分区无法扩展到多个代理，所以它的容量受到代理磁盘空间的限制。能够增加分区和代理的数量意味着单个主题可以存储的数据量是没有限制的。</li></ul> 
<p>2）容错性和可靠性:</p> 
<p>Kafka 的设计方式使某个代理的故障能够被集群中的其他代理检测到。由于每个主题都可以在多个代理上复制，所以集群可以在不中断服务的情况下从此类故障中恢复并继续运行。</p> 
<p>3）吞吐量: 代理能够以超快的速度有效地存储和检索数据</p> 
<h3><a id="kafka__64"></a>二、kafka 概念详解</h3> 
<h4><a id="1kafka__httpskafkaapacheorg_66"></a>1、kafka 官网： https://kafka.apache.org/</h4> 
<h4><a id="2kafka___68"></a>2、kafka 概念 流程图：</h4> 
<p><img src="https://images2.imgbox.com/06/34/FkvCWmkj_o.png" alt="2.png"></p> 
<h4><a id="3Producer_73"></a>3、Producer</h4> 
<p>生产者即数据的发布者，该角色将消息发布到 Kafka 的 topic 中。broker 接收到生产者发送的消息后，broker 将该消息追加到当前用于追加数据的 segment 文件中。生产者发送的消息，存储到一个 partition 中，生产者也可以指定数据存储的 partition。</p> 
<h4><a id="4Consumer_77"></a>4、Consumer</h4> 
<p>消费者可以从 broker 中读取数据。消费者可以消费多个 topic 中的数据。</p> 
<h4><a id="5Topic_81"></a>5、Topic</h4> 
<p>在 Kafka 中，使用一个类别属性来划分数据的所属类，划分数据的这个类称为 topic。如果把Kafka看做为一个数据库，topic 可以理解为数据库中的一张表，topic 的名字即为表名。</p> 
<h4><a id="6Partition_85"></a>6、Partition</h4> 
<p>topic 中的数据分割为一个或多个 partition。每个 topic 至少有一个 partition。每个 partition 中的数据使用多个 segment 文件存储。partition 中的数据是有序的，partition 间的数据丢失了数据的顺序。如果 topic 有多个 partition，消费数据时就不能保证数据的顺序。在需要严格保证消息的消费顺序的场景下，需要将 partition 数目设为 1。</p> 
<h4><a id="7Partition_offset_89"></a>7、Partition offset</h4> 
<p>每条消息都有一个当前 Partition 下唯一的64字节的 offset，它指明了这条消息的起始位置。</p> 
<h4><a id="8Replicas_of_partition_93"></a>8、Replicas of partition</h4> 
<p>副本是一个分区的备份。副本不会被消费者消费，副本只用于防止数据丢失，即消费者不从为 folower 的 partition 中消费数据，而是从为 leader 的 partition 中读取数据。副本之间是一主多从的关系。</p> 
<h4><a id="9Broker_97"></a>9、Broker</h4> 
<p>Kafka 集群包含一个或多个服务器，服务器节点称为 broker。broker 存储 topic 的数据。如果某 topic 有N个 partition，集群有N个 broker，那么每个 broker 存储该 topic 的一个 partition。如果某 topic 有N个 partition，集群有(N+M)个 broker，那么其中有N个 broker 存储该 topic 的一个 partition，剩下的M个 broker 不存储该 topic 的 partition 数据。如果某 topic 有N个 partition，集群中 broker 数目少于N个，那么一个 broker 存储该 topic 的一个或多个 partition。在实际生产环境中，尽量避免这种情况的发生，这种情况容易导致 Kafka 集群数据不均衡。</p> 
<h4><a id="10Leader_101"></a>10、Leader</h4> 
<p>每个 partition 有多个副本，其中有且仅有一个作为 Leader，Leader 是当前负责数据的读写的 partition。</p> 
<h4><a id="11Follower_105"></a>11、Follower</h4> 
<p>Follower 跟随 Leader，所有写请求都通过 Leader 路由，数据变更会广播给所有 Follower，Follower 与 Leader 保持数据同步。如果 Leader 失效，则从 Follower 中选举出一个新的Leader。当 Follower 与 Leader 挂掉、卡住或者同步太慢，leader 会把这个 follower 从 “in syncreplicas"(ISR) 列表中删除，重新创建一个 Follower。</p> 
<h4><a id="12Zookeeper_109"></a>12、Zookeeper</h4> 
<p>Zookeeper 负责维护和协调 broker。当 Kafka 系统中新增了 broker 或者某个 broker 发生故障失效时，由 ZooKeeper 通知生产者和消费者。生产者和消费者依据 Zookeeper 的 broker 状态信息与 broker 协调数据的发布和订阅任务。</p> 
<h4><a id="13ARAssigned_Replicas_113"></a>13、AR(Assigned Replicas)</h4> 
<p>分区中所有的副本统称为 AR。</p> 
<h4><a id="14ISRInSync_Replicas_117"></a>14、ISR(In-Sync Replicas)</h4> 
<p>所有与 Leader 部分保持一定程度的副(包括 Leader 副本在内)本组成 ISR。</p> 
<h4><a id="15OSROutofSyncReplicas_121"></a>15、OSR(Out-of-Sync-Replicas)</h4> 
<p>与 Leader 副本同步滞后过多的副本。</p> 
<h4><a id="16HWHigh_Watermark_125"></a>16、HW(High Watermark)</h4> 
<p>高水位，标识了一个特定的 offset，消费者只能拉取到这个 offset 之前的消息。</p> 
<h4><a id="17LEOLog_End_offset_129"></a>17、LEO(Log End offset)</h4> 
<p>即日志末端位移(log end offset)，记录了该副本底层日志(l0g)中下一条消息的位移值。注意是下一条消息!也就是说，如果 LEO=10，那么表示该副本保存了10条消息，位移值范围是[0,9]。</p> 
<p><img src="https://images2.imgbox.com/a7/42/DtTrmGvM_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="kafka__jdkzookeeper__135"></a>三、kafka 环境配置 jdk、zookeeper 下载安装</h3> 
<h4><a id="1_jdk12__137"></a>1、 jdk-12 下载安装</h4> 
<p>Oracle官网下载JDK</p> 
<p>https://www.oracle.com/technetwork/java/javase/downloads/jdk12-downloads-5295953.html</p> 
<p>Java 开发工具包_JDK 各个版本 下载：</p> 
<p>jdk.java.net<br> http://jdk.java.net/</p> 
<p>Oracle 官网：<br> https://www.oracle.com/java/technologies/javase-downloads.html</p> 
<ol><li> <p>JDK-7 下载：<br> http://jdk.java.net/java-se-ri/7</p> </li><li> <p>JDK-8 下载：<br> https://jdk.java.net/java-se-ri/8-MR5</p> </li><li> <p>JDK-9 下载：<br> http://jdk.java.net/java-se-ri/9</p> </li></ol> 
<p>Java 平台标准版 9 参考实现<br> 为Java SE 9（官方参考实现JSR 379）仅在从现有的开源代码是基于JDK 9项目在OpenJDK的社区。</p> 
<ol start="4"><li> <p>JDK-10 下载：<br> http://jdk.java.net/java-se-ri/10</p> </li><li> <p>JDK-11 下载：<br> http://jdk.java.net/java-se-ri/11</p> </li><li> <p>JDK-12 下载：<br> http://jdk.java.net/java-se-ri/12</p> </li><li> <p>JDK-13 下载：<br> http://jdk.java.net/java-se-ri/13</p> </li><li> <p>JDK-14 下载：<br> http://jdk.java.net/java-se-ri/14</p> </li><li> <p>JDK-15 下载：<br> http://jdk.java.net/java-se-ri/15</p> </li><li> <p>JDK-16 下载：<br> http://jdk.java.net/java-se-ri/16</p> </li></ol> 
<h4><a id="2jdk12__184"></a>2、jdk-12 环境变量配置</h4> 
<pre><code class="prism language-java">
sudo vim <span class="token operator">/</span>etc<span class="token operator">/</span>profile 

# 添加 jdk 环境变量配置
export <span class="token constant">JAVA_HOME</span><span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>java<span class="token operator">/</span>jdk<span class="token operator">-</span><span class="token number">12.0</span><span class="token number">.1</span>
export <span class="token constant">JRE_HOME</span><span class="token operator">-</span>$<span class="token punctuation">{<!-- --></span><span class="token constant">JAVA_HOME</span><span class="token punctuation">}</span><span class="token operator">/</span>jre
#export <span class="token constant">MAVEN_HOME</span><span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>maven<span class="token operator">/</span>apache<span class="token operator">-</span>maven<span class="token operator">-</span><span class="token number">3.5</span><span class="token number">.0</span>
export <span class="token constant">CLASSPATH</span><span class="token operator">=</span><span class="token punctuation">.</span><span class="token punctuation">:</span>$<span class="token punctuation">{<!-- --></span><span class="token constant">JAVA_HOME</span><span class="token punctuation">}</span><span class="token operator">/</span>lib<span class="token operator">:</span>$<span class="token punctuation">{<!-- --></span><span class="token constant">JRE_HOME</span><span class="token punctuation">}</span><span class="token operator">/</span>lib
#export <span class="token constant">PATH</span><span class="token operator">=</span><span class="token class-name">S</span><span class="token punctuation">{<!-- --></span><span class="token constant">JAVA_HOME</span><span class="token punctuation">}</span><span class="token operator">/</span>bin<span class="token operator">:</span>$<span class="token punctuation">{<!-- --></span><span class="token constant">MAVEN_HOME</span><span class="token punctuation">}</span><span class="token operator">/</span>bin<span class="token operator">:</span>$<span class="token constant">PATH</span>
export <span class="token constant">PATH</span><span class="token operator">=</span><span class="token class-name">S</span><span class="token punctuation">{<!-- --></span><span class="token constant">JAVA_HOME</span><span class="token punctuation">}</span><span class="token operator">/</span>bin<span class="token operator">:</span>$<span class="token constant">PATH</span>

# 或者简单配置
export <span class="token constant">JAVA_HOME</span><span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>java<span class="token operator">/</span>jdk<span class="token operator">-</span><span class="token number">12</span>
export <span class="token constant">PATH</span><span class="token operator">=</span>$<span class="token punctuation">{<!-- --></span><span class="token constant">JAVA_HOME</span><span class="token punctuation">}</span><span class="token operator">/</span>bin<span class="token operator">:</span>$<span class="token constant">PATH</span>

# 配置完 <span class="token constant">JDK</span> 记得断开连接重新连接 或者重启系统。

# 测试 jdk 是否安装配置成功
java <span class="token operator">-</span>version

</code></pre> 
<h4><a id="3zookeeper__209"></a>3、zookeeper 下载安装</h4> 
<p>1）Zookeeper 是安装 Kafka 集群的必要组件，Kafka 通过 Zookeeper 来实施对元数据信息的管理，包括集群、主题分区等内容。</p> 
<p>2）同样在官网下载安装包到指定目录解压缩，步骤如下:</p> 
<p>ZooKeeper 官网: http://zookeeper.apache.org<br> https://github.com/apache/zookeeper/tags?after=release-3.8.0-1</p> 
<p>3）把 zookeeper 上传至服务器，并解压</p> 
<pre><code class="prism language-java">
# 切换目录：
cd <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>zookeeper<span class="token operator">/</span>
# 解压即安装
tar <span class="token operator">-</span>zxvf apache<span class="token operator">-</span>zookeeper<span class="token operator">-</span><span class="token number">3.6</span><span class="token number">.3</span><span class="token operator">-</span>bin<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">-</span><span class="token class-name">C</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>zookeeper<span class="token operator">/</span>

</code></pre> 
<p>4）修改 Zookeeper 的配置文件，首先进入安装路径 conf 目录，并将 zoo_sample.cfg 文件修改为 zoo.cfg，并对核心参数进行配置。文件内容如下:</p> 
<pre><code class="prism language-java">
# 切换目录
cd <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>zookeeper<span class="token operator">/</span>apache<span class="token operator">-</span>zookeeper<span class="token operator">-</span><span class="token number">3.6</span><span class="token number">.3</span><span class="token operator">-</span>bin<span class="token operator">/</span>conf<span class="token operator">/</span>

# 将 zoo_sample<span class="token punctuation">.</span>cfg 文件修改为 zoo<span class="token punctuation">.</span>cfg
mv zoo_sample<span class="token punctuation">.</span>cfg zoo<span class="token punctuation">.</span>cfg

# 对核心参数进行配置
vim zoo<span class="token punctuation">.</span>cfg


# <span class="token class-name">The</span> number of milliseconds of each tick
#zk服务器的心跳时间
tickTime<span class="token operator">-</span><span class="token number">2080</span>
# <span class="token class-name">The</span> number of ticks that the initial
#synchronization phase can take
#投票选举新<span class="token class-name">Leader</span>的初始化时间
initlimit<span class="token operator">=</span><span class="token number">10</span>
# <span class="token class-name">The</span> number of ticks that can pass between
# sendidg a request and getting an acknowledgementsyncLimit<span class="token operator">-</span><span class="token number">5</span>
# the directory where the snapshot is stored<span class="token punctuation">.</span>
# <span class="token keyword">do</span> not use <span class="token operator">/</span>tmp <span class="token keyword">for</span> storage<span class="token punctuation">,</span> <span class="token operator">/</span>tmp here is just
# example sakes<span class="token punctuation">.</span>

# 数据目录<span class="token punctuation">(</span>需要新建此目录<span class="token punctuation">)</span>
dataDir<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>zookeeper<span class="token operator">/</span>apache<span class="token operator">-</span>zookeeper<span class="token operator">-</span><span class="token number">3.6</span><span class="token number">.3</span><span class="token operator">-</span>bin<span class="token operator">/</span>data

# 日志目录
dataLogDir<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>zookeeper<span class="token operator">/</span>apache<span class="token operator">-</span>zookeeper<span class="token operator">-</span><span class="token number">3.6</span><span class="token number">.3</span><span class="token operator">-</span>bin<span class="token operator">/</span>log

# the port at which the clients will connect
#<span class="token class-name">Zookeeper</span>对外服务端口，保持默认
clientPort<span class="token operator">-</span><span class="token number">2181</span>

</code></pre> 
<h4><a id="4_Zookeeper__binzkServersh_start_268"></a>4、启动 Zookeeper 命令: bin/zkServer.sh start</h4> 
<pre><code class="prism language-java">
# 切换目录
cd <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>zookeeper<span class="token operator">/</span>apache<span class="token operator">-</span>zookeeper<span class="token operator">-</span><span class="token number">3.6</span><span class="token number">.3</span><span class="token operator">-</span>bin<span class="token operator">/</span>
# 启动 <span class="token class-name">Zookeeper</span>
bin<span class="token operator">/</span>zkServer<span class="token punctuation">.</span>sh start
# 查询 zookeeper 是否启动成功
ps <span class="token operator">-</span>ef <span class="token operator">|</span> grep zookeeper 
# 或者 
jps <span class="token operator">-</span>l
</code></pre> 
<h3><a id="kafka__kafka__282"></a>四、kafka 环境配置 kafka 下载安装</h3> 
<h4><a id="1__kafka_284"></a>1、 下载安装解压 kafka</h4> 
<p>官网下载地址： https://kafka.apache.org/downloads</p> 
<pre><code class="prism language-java">
# 切换目录
cd <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>kafka<span class="token operator">/</span>

# 解压即安装
tar <span class="token operator">-</span>zxvf kafka<span class="token operator">-</span><span class="token number">2.12</span><span class="token number">.2</span><span class="token number">.8</span><span class="token number">.0</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">-</span><span class="token class-name">C</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>kafka<span class="token operator">/</span>

</code></pre> 
<h4><a id="2_kafka__298"></a>2、配置 kafka 参数</h4> 
<pre><code class="prism language-java">
# 切换目录
cd <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>kafka<span class="token operator">/</span>kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">2.8</span><span class="token number">.0</span><span class="token operator">/</span>

# 修改 kafka 配置参数：
vim config<span class="token operator">/</span>server<span class="token punctuation">.</span>properties

# server<span class="token punctuation">.</span>properties 配置中需要关注以下几个参数<span class="token operator">:</span>

# 表示 broker 的编号，如果集群中有多个 broker，则每个 broker 的编号需要设置的不同
broker<span class="token punctuation">.</span>id<span class="token operator">=</span><span class="token number">0</span> 

# brokder 对外提供的服务入口地址（ kafka 监听地址：你的虚拟机 <span class="token constant">IP</span> 地址）
# listeners<span class="token operator">=</span><span class="token constant">PLAINTEXT</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">9092</span> 
listeners<span class="token operator">=</span><span class="token constant">PLAINTEXT</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">172.18</span><span class="token number">.30</span><span class="token number">.110</span><span class="token operator">:</span><span class="token number">9092</span> 

# 设置存放消息日志文件的地址
log<span class="token punctuation">.</span>dirs<span class="token operator">=</span><span class="token operator">/</span>tmp<span class="token operator">/</span>kafka<span class="token operator">/</span>log 

# <span class="token class-name">Kafka</span> 所需 <span class="token class-name">Zookeeper</span> 集群地址
zookeeper<span class="token punctuation">.</span>connect<span class="token operator">=</span>lolalhost<span class="token operator">:</span><span class="token number">2181</span> 

</code></pre> 
<h4><a id="3_kafka_327"></a>3、启动 kafka</h4> 
<pre><code class="prism language-java">
# 切换目录
cd <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>kafka<span class="token operator">/</span>kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">2.8</span><span class="token number">.0</span><span class="token operator">/</span>

# 启动 kafka
bin<span class="token operator">/</span>kafka<span class="token operator">-</span>server<span class="token operator">-</span>start<span class="token punctuation">.</span>sh config<span class="token operator">/</span>server<span class="token punctuation">.</span>properties

</code></pre> 
<h4><a id="4_kafka__340"></a>4、查询 kafka 是否启动成功：</h4> 
<pre><code class="prism language-java">
# 重新打开一个终端

# 切换目录
cd <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>kafka<span class="token operator">/</span>kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">2.8</span><span class="token number">.0</span><span class="token operator">/</span>

# 查询 kafka 是否启动成功
ps <span class="token operator">-</span>ef <span class="token operator">|</span> grep kafka 
# 或者 
jps <span class="token operator">-</span>l
</code></pre> 
<h3><a id="kafka__356"></a>五、kafka 消息的生产与消费</h3> 
<h4><a id="1_358"></a>1、创建一个主题</h4> 
<p>1）命令： bin/kafka-topics.sh --zookeeper localhost:2181 --create --topic heima --partitions 2 --replication-factor 1</p> 
<p>2）参数说明：</p> 
<p>–zookeeper ：指定了 kafka 所连接的 zookeeper 服务地址。<br> –topic : 指定了所要创建主题的名称<br> –partitions : 指定了分区个数<br> –replication-factor : 指定了副本因子<br> –create : 创建主题的动作指令。</p> 
<pre><code class="prism language-java">
# 切换目录
cd <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>kafka<span class="token operator">/</span>kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">2.8</span><span class="token number">.0</span><span class="token operator">/</span>

# 创建一个名为 heima 的 主题
bin<span class="token operator">/</span>kafka<span class="token operator">-</span>topics<span class="token punctuation">.</span>sh <span class="token operator">--</span>zookeeper localhost<span class="token operator">:</span><span class="token number">2181</span> <span class="token operator">--</span>create <span class="token operator">--</span>topic heima <span class="token operator">--</span>partitions <span class="token number">2</span> <span class="token operator">--</span>replication<span class="token operator">-</span>factor <span class="token number">1</span>

# 或者把 localhost 换成 填写你的 虚拟机 <span class="token constant">IP</span> 地址（如：<span class="token number">172.18</span><span class="token number">.30</span><span class="token number">.110</span>）：
bin<span class="token operator">/</span>kafka<span class="token operator">-</span>topics<span class="token punctuation">.</span>sh <span class="token operator">--</span>zookeeper <span class="token number">172.18</span><span class="token number">.30</span><span class="token number">.110</span><span class="token operator">:</span><span class="token number">2181</span> <span class="token operator">--</span>create <span class="token operator">--</span>topic heima <span class="token operator">--</span>partitions <span class="token number">2</span> <span class="token operator">--</span>replication<span class="token operator">-</span>factor <span class="token number">1</span>

</code></pre> 
<h4><a id="2_383"></a>2、展示出当前所有主题</h4> 
<pre><code class="prism language-java">
# 切换目录
cd <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>kafka<span class="token operator">/</span>kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">2.8</span><span class="token number">.0</span><span class="token operator">/</span>

# 展示出当前所有主题
bin<span class="token operator">/</span>kafka<span class="token operator">-</span>topics<span class="token punctuation">.</span>sh <span class="token operator">--</span>zookeeper <span class="token number">1</span>ocalhost<span class="token operator">:</span><span class="token number">2181</span> <span class="token operator">--</span><span class="token number">1</span>ist

# 或者把 localhost 换成 填写你的 虚拟机 <span class="token constant">IP</span> 地址（如：<span class="token number">172.18</span><span class="token number">.30</span><span class="token number">.110</span>）：
bin<span class="token operator">/</span>kafka<span class="token operator">-</span>topics<span class="token punctuation">.</span>sh <span class="token operator">--</span>zookeeper <span class="token number">172.18</span><span class="token number">.30</span><span class="token number">.110</span><span class="token operator">:</span><span class="token number">2181</span> <span class="token operator">--</span><span class="token number">1</span>ist

</code></pre> 
<h4><a id="3__398"></a>3、 查看主题详情：</h4> 
<pre><code class="prism language-java">
# 切换目录
cd <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>kafka<span class="token operator">/</span>kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">2.8</span><span class="token number">.0</span><span class="token operator">/</span>

# 查看主题详情
bin<span class="token operator">/</span>kafka<span class="token operator">-</span>topics<span class="token punctuation">.</span>sh <span class="token operator">--</span>zookeeper localhost<span class="token operator">:</span><span class="token number">2181</span> <span class="token operator">--</span>describe <span class="token operator">--</span>topic heima

# 或者把 localhost 换成 填写你的 虚拟机 <span class="token constant">IP</span> 地址（如：<span class="token number">172.18</span><span class="token number">.30</span><span class="token number">.110</span>）：
bin<span class="token operator">/</span>kafka<span class="token operator">-</span>topics<span class="token punctuation">.</span>sh <span class="token operator">--</span>zookeeper <span class="token number">172.18</span><span class="token number">.30</span><span class="token number">.110</span><span class="token operator">:</span><span class="token number">2181</span> <span class="token operator">--</span>describe <span class="token operator">--</span>topic heima
</code></pre> 
<h4><a id="4_412"></a>4、启动消费端接收消息：</h4> 
<p>命令: bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic heima</p> 
<p>参数说明：<br> –bootstrap-server 指定了连接 Kafka 集群的地址<br> –topic 指定了消费端订阅的主题</p> 
<pre><code class="prism language-java">
# 重新打开一个终端：

# 切换目录
cd <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>kafka<span class="token operator">/</span>kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">2.8</span><span class="token number">.0</span><span class="token operator">/</span>

# 启动消费端接收消息
bin<span class="token operator">/</span>kafka<span class="token operator">-</span>console<span class="token operator">-</span>consumer<span class="token punctuation">.</span>sh <span class="token operator">--</span>bootstrap<span class="token operator">-</span>server localhost<span class="token operator">:</span><span class="token number">9092</span> <span class="token operator">--</span>topic heima

# 或者把 localhost 换成 填写你的 虚拟机 <span class="token constant">IP</span> 地址（如：<span class="token number">172.18</span><span class="token number">.30</span><span class="token number">.110</span>）：
bin<span class="token operator">/</span>kafka<span class="token operator">-</span>console<span class="token operator">-</span>consumer<span class="token punctuation">.</span>sh <span class="token operator">--</span>bootstrap<span class="token operator">-</span>server <span class="token number">172.18</span><span class="token number">.30</span><span class="token number">.110</span><span class="token operator">:</span><span class="token number">9092</span> <span class="token operator">--</span>topic heima
</code></pre> 
<h4><a id="5_434"></a>5、生产端发送消息</h4> 
<p>命令: bin/kafka-console-producer.sh --broker-list localhost:9092 --topic heima</p> 
<p>参数说明：<br> –broker-list 指定了连接的 Kafka 集群的地址<br> –topic 指定了发送消息时的主题</p> 
<pre><code class="prism language-java">
# 重新打开一个终端：

# 切换目录
cd <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>kafka<span class="token operator">/</span>kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">2.8</span><span class="token number">.0</span><span class="token operator">/</span>

# 生产端发送消息
bin<span class="token operator">/</span>kafka<span class="token operator">-</span>console<span class="token operator">-</span>producer<span class="token punctuation">.</span>sh <span class="token operator">--</span>broker<span class="token operator">-</span>list localhost<span class="token operator">:</span><span class="token number">9092</span> <span class="token operator">--</span>topic heima

# 或者把 localhost 换成 填写你的 虚拟机 <span class="token constant">IP</span> 地址（如：<span class="token number">172.18</span><span class="token number">.30</span><span class="token number">.110</span>）：
bin<span class="token operator">/</span>kafka<span class="token operator">-</span>console<span class="token operator">-</span>producer<span class="token punctuation">.</span>sh <span class="token operator">--</span>broker<span class="token operator">-</span>list <span class="token number">172.18</span><span class="token number">.30</span><span class="token number">.110</span><span class="token operator">:</span><span class="token number">9092</span> <span class="token operator">--</span>topic heima
</code></pre> 
<p><img src="https://images2.imgbox.com/3a/85/uAhJ3eD1_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/eb/0a/uFSoHA2M_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="kafka_java__001_462"></a>六、kafka java 第一个程序 001</h3> 
<h4><a id="1_idea__artifactId__kafka_learn__maven__463"></a>1、打开 idea 创建 artifactId 名为 kafka_learn 的 maven 工程。</h4> 
<pre><code class="prism language-java">
	<span class="token operator">--</span><span class="token operator">&gt;</span> idea <span class="token operator">--</span><span class="token operator">&gt;</span> <span class="token class-name">File</span> 
	<span class="token operator">--</span><span class="token operator">&gt;</span> <span class="token class-name">New</span> <span class="token operator">--</span><span class="token operator">&gt;</span> <span class="token class-name">Project</span> 
	<span class="token operator">--</span><span class="token operator">&gt;</span> <span class="token class-name">Maven</span> 
		<span class="token class-name">Project</span> <span class="token constant">SDK</span><span class="token operator">:</span> <span class="token punctuation">(</span> <span class="token number">1.</span><span class="token function">8</span><span class="token punctuation">(</span>java version <span class="token string">"1.8.0_131"</span> <span class="token punctuation">)</span> 
	<span class="token operator">--</span><span class="token operator">&gt;</span> <span class="token class-name">Next</span> 
	<span class="token operator">--</span><span class="token operator">&gt;</span> <span class="token class-name">Groupld</span> <span class="token operator">:</span> <span class="token punctuation">(</span> djh<span class="token punctuation">.</span>it <span class="token punctuation">)</span>
		<span class="token class-name">Artifactld</span> <span class="token operator">:</span> <span class="token punctuation">(</span> kafka_learn <span class="token punctuation">)</span>
		<span class="token class-name">Version</span> <span class="token operator">:</span> <span class="token number">1.0</span><span class="token operator">-</span><span class="token constant">SNAPSHOT</span>
	<span class="token operator">--</span><span class="token operator">&gt;</span> <span class="token class-name">Name</span><span class="token operator">:</span> <span class="token punctuation">(</span> kafka_learn <span class="token punctuation">)</span>
		<span class="token class-name">Location</span><span class="token operator">:</span> <span class="token punctuation">(</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\kafka_learn\ <span class="token punctuation">)</span>	
	<span class="token operator">--</span><span class="token operator">&gt;</span> <span class="token class-name">Finish</span>
	
</code></pre> 
<h4><a id="2_kafka_learn__pomxml__482"></a>2、在 kafka_learn 工程的 pom.xml 文件中导入依赖坐标。</h4> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">?</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>project xmlns<span class="token operator">=</span><span class="token string">"http://maven.apache.org/POM/4.0.0"</span>
         xmlns<span class="token operator">:</span>xsi<span class="token operator">=</span><span class="token string">"http://www.w3.org/2001/XMLSchema-instance"</span>
         xsi<span class="token operator">:</span>schemaLocation<span class="token operator">=</span><span class="token string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>modelVersion<span class="token punctuation">&gt;</span></span><span class="token number">4.0</span><span class="token number">.0</span><span class="token operator">&lt;</span><span class="token operator">/</span>modelVersion<span class="token operator">&gt;</span>

    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>djh<span class="token punctuation">.</span>it<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>kafka_learn<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1.0</span><span class="token operator">-</span><span class="token constant">SNAPSHOT</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>name<span class="token punctuation">&gt;</span></span>kafka_learn<span class="token operator">&lt;</span><span class="token operator">/</span>name<span class="token operator">&gt;</span>

    <span class="token generics"><span class="token punctuation">&lt;</span>parent<span class="token punctuation">&gt;</span></span>
        <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">-</span>parent<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">2.1</span><span class="token number">.8</span><span class="token punctuation">.</span><span class="token constant">RELEASE</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>relativePath<span class="token punctuation">&gt;</span></span><span class="token operator">&lt;</span><span class="token operator">/</span>relativePath<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>parent<span class="token operator">&gt;</span>

    <span class="token generics"><span class="token punctuation">&lt;</span>properties<span class="token punctuation">&gt;</span></span>
        <span class="token generics"><span class="token punctuation">&lt;</span>java<span class="token punctuation">.</span>version<span class="token punctuation">&gt;</span></span><span class="token number">8</span><span class="token operator">&lt;</span><span class="token operator">/</span>java<span class="token punctuation">.</span>version<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>        <span class="token generics"><span class="token punctuation">&lt;</span>scala<span class="token punctuation">.</span>version<span class="token punctuation">&gt;</span></span><span class="token number">2.11</span><span class="token operator">&lt;</span><span class="token operator">/</span>scala<span class="token punctuation">.</span>version<span class="token operator">&gt;</span><span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>scala<span class="token punctuation">.</span>version<span class="token punctuation">&gt;</span></span><span class="token number">2.12</span><span class="token operator">&lt;</span><span class="token operator">/</span>scala<span class="token punctuation">.</span>version<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>slf4j<span class="token punctuation">.</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1.7</span><span class="token number">.21</span><span class="token operator">&lt;</span><span class="token operator">/</span>slf4j<span class="token punctuation">.</span>version<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>        <span class="token generics"><span class="token punctuation">&lt;</span>kafka<span class="token punctuation">.</span>version<span class="token punctuation">&gt;</span></span><span class="token number">2.0</span><span class="token number">.0</span><span class="token operator">&lt;</span><span class="token operator">/</span>kafka<span class="token punctuation">.</span>version<span class="token operator">&gt;</span><span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>kafka<span class="token punctuation">.</span>version<span class="token punctuation">&gt;</span></span><span class="token number">2.8</span><span class="token number">.0</span><span class="token operator">&lt;</span><span class="token operator">/</span>kafka<span class="token punctuation">.</span>version<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>lombok<span class="token punctuation">.</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1.18</span><span class="token number">.8</span><span class="token operator">&lt;</span><span class="token operator">/</span>lombok<span class="token punctuation">.</span>version<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>junit<span class="token punctuation">.</span>version<span class="token punctuation">&gt;</span></span><span class="token number">4.11</span><span class="token operator">&lt;</span><span class="token operator">/</span>junit<span class="token punctuation">.</span>version<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>gson<span class="token punctuation">.</span>version<span class="token punctuation">&gt;</span></span><span class="token number">2.2</span><span class="token number">.4</span><span class="token operator">&lt;</span><span class="token operator">/</span>gson<span class="token punctuation">.</span>version<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>protobuff<span class="token punctuation">.</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1.5</span><span class="token number">.4</span><span class="token operator">&lt;</span><span class="token operator">/</span>protobuff<span class="token punctuation">.</span>version<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>        <span class="token generics"><span class="token punctuation">&lt;</span>spark<span class="token punctuation">.</span>version<span class="token punctuation">&gt;</span></span><span class="token number">2.3</span><span class="token number">.1</span><span class="token operator">&lt;</span><span class="token operator">/</span>spark<span class="token punctuation">.</span>version<span class="token operator">&gt;</span><span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>spark<span class="token punctuation">.</span>version<span class="token punctuation">&gt;</span></span><span class="token number">2.4</span><span class="token number">.8</span><span class="token operator">&lt;</span><span class="token operator">/</span>spark<span class="token punctuation">.</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>properties<span class="token operator">&gt;</span>

    <span class="token generics"><span class="token punctuation">&lt;</span>dependencies<span class="token punctuation">&gt;</span></span>
        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">-</span>web<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">-</span>test<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>kafka<span class="token operator">-</span>clients<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span>$<span class="token punctuation">{<!-- --></span>kafka<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>

        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>kafka_$<span class="token punctuation">{<!-- --></span>scala<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span>$<span class="token punctuation">{<!-- --></span>kafka<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>exclusions<span class="token punctuation">&gt;</span></span>
                <span class="token generics"><span class="token punctuation">&lt;</span>exclusion<span class="token punctuation">&gt;</span></span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>zookeeper<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>zookeeper<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>exclusion<span class="token operator">&gt;</span>
                <span class="token generics"><span class="token punctuation">&lt;</span>exclusion<span class="token punctuation">&gt;</span></span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>slf4j<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>slf4j<span class="token operator">-</span>log4j12<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>exclusion<span class="token operator">&gt;</span>
                <span class="token generics"><span class="token punctuation">&lt;</span>exclusion<span class="token punctuation">&gt;</span></span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>log4j<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>log4j<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>exclusion<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>exclusions<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>

        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>slf4j<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>slf4j<span class="token operator">-</span>log4j12<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span>$<span class="token punctuation">{<!-- --></span>slf4j<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>

        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>code<span class="token punctuation">.</span>gson<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>gson<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span>$<span class="token punctuation">{<!-- --></span>gson<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>

        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>junit<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>junit<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span>$<span class="token punctuation">{<!-- --></span>junit<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>

        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>projectlombok<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>lombok<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span>$<span class="token punctuation">{<!-- --></span>lombok<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>scope<span class="token punctuation">&gt;</span></span>provided<span class="token operator">&lt;</span><span class="token operator">/</span>scope<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>

        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>io<span class="token punctuation">.</span>protostuff<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>protostuff<span class="token operator">-</span>core<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span>$<span class="token punctuation">{<!-- --></span>protobuff<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>

        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>io<span class="token punctuation">.</span>protostuff<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>protostuff<span class="token operator">-</span>runtime<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span>$<span class="token punctuation">{<!-- --></span>protobuff<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>

        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>core<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>jackson<span class="token operator">-</span>core<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">2.9</span><span class="token number">.4</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>

        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span><span class="token keyword">module</span><span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>jackson<span class="token operator">-</span><span class="token keyword">module</span><span class="token operator">-</span>scala_2<span class="token punctuation">.</span><span class="token number">11</span><span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">2.9</span><span class="token number">.5</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>

        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spark<span class="token operator">-</span>core_$<span class="token punctuation">{<!-- --></span>scala<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span>$<span class="token punctuation">{<!-- --></span>spark<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>exclusions<span class="token punctuation">&gt;</span></span>
                <span class="token generics"><span class="token punctuation">&lt;</span>exclusion<span class="token punctuation">&gt;</span></span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>zookeeper<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>zookeeper<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>exclusion<span class="token operator">&gt;</span>
                <span class="token generics"><span class="token punctuation">&lt;</span>exclusion<span class="token punctuation">&gt;</span></span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>slf4j<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>slf4j<span class="token operator">-</span>log4j12<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>exclusion<span class="token operator">&gt;</span>
                <span class="token generics"><span class="token punctuation">&lt;</span>exclusion<span class="token punctuation">&gt;</span></span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>log4j<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>log4j<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>exclusion<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>exclusions<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>

        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spark<span class="token operator">-</span>streaming_$<span class="token punctuation">{<!-- --></span>scala<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span>$<span class="token punctuation">{<!-- --></span>spark<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spark<span class="token operator">-</span>streaming<span class="token operator">-</span>kafka<span class="token operator">-</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">10_</span>$<span class="token punctuation">{<!-- --></span>scala<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span>$<span class="token punctuation">{<!-- --></span>spark<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spark<span class="token operator">-</span>sql_$<span class="token punctuation">{<!-- --></span>scala<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span>$<span class="token punctuation">{<!-- --></span>spark<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spark<span class="token operator">-</span>sql<span class="token operator">-</span>kafka<span class="token operator">-</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">10_</span>$<span class="token punctuation">{<!-- --></span>scala<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span>$<span class="token punctuation">{<!-- --></span>spark<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependencies<span class="token operator">&gt;</span>

    <span class="token generics"><span class="token punctuation">&lt;</span>build<span class="token punctuation">&gt;</span></span>
        <span class="token generics"><span class="token punctuation">&lt;</span>plugins<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>plugin<span class="token punctuation">&gt;</span></span>
                <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
                <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>maven<span class="token operator">-</span>plugin<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>plugin<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>plugins<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>build<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>project<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> kafka_learn\pom<span class="token punctuation">.</span>xml <span class="token operator">--</span><span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="3_kafka_learn___ProducerFastStartjava__657"></a>3、在 kafka_learn 工程中，创建 生产者 ProducerFastStart.java 类</h4> 
<pre><code class="prism language-java"><span class="token comment">/**
 *  kafka_learn\src\main\java\djh\it\kafka\learn\chapter1\ProducerFastStart.java
 *
 *  2024-6-21 创建 生产者 ProducerFastStart.java 类
 */</span>
<span class="token keyword">package</span> <span class="token namespace">djh<span class="token punctuation">.</span>it<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>learn<span class="token punctuation">.</span>chapter1</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>protostuff<span class="token punctuation">.</span></span><span class="token class-name">StringSerializer</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>producer<span class="token punctuation">.</span></span><span class="token class-name">KafkaProducer</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>producer<span class="token punctuation">.</span></span><span class="token class-name">ProducerConfig</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>producer<span class="token punctuation">.</span></span><span class="token class-name">ProducerRecord</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Properties</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProducerFastStart</span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">//private static final String brokerList = "localhost:9092";</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> brokerList <span class="token operator">=</span> <span class="token string">"172.18.30.110:9092"</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> topic <span class="token operator">=</span> <span class="token string">"heima"</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Properties</span> properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//1）设置 key 序列化器</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"key.serializer"</span><span class="token punctuation">,</span> <span class="token string">"org.apache.kafka.common.serialization.StringSerializer"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//properties.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());</span>

        <span class="token comment">//2)设置重试次数</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span><span class="token constant">RETRIES_CONFIG</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//3)设置值序列化器</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"value.serializer"</span><span class="token punctuation">,</span> <span class="token string">"org.apache.kafka.common.serialization.StringSerializer"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//properties.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());</span>

        <span class="token comment">//4)设置集群地址</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"bootstrap.servers"</span><span class="token punctuation">,</span> brokerList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//properties.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, brokerList);</span>

        <span class="token class-name">KafkaProducer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> producer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KafkaProducer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ProducerRecord</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> record <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProducerRecord</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>topic<span class="token punctuation">,</span> <span class="token string">"kafka-demo"</span><span class="token punctuation">,</span> <span class="token string">"hello-kafka-test!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span><span class="token punctuation">{<!-- --></span>
            producer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        producer<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/a5/67/ufwsQK05_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="kafka_java__002_717"></a>七、kafka java 第一个程序 002</h3> 
<h4><a id="1_kafka_learn___ConsumerFastStartjava__718"></a>1、在 kafka_learn 工程中，创建 消费者 ConsumerFastStart.java 类</h4> 
<pre><code class="prism language-java">
<span class="token comment">/**
 *  kafka_learn\src\main\java\djh\it\kafka\learn\chapter1\ConsumerFastStart.java
 *
 *  2024-6-21 创建 消费者 ConsumerFastStart.java 类
 */</span>
<span class="token keyword">package</span> <span class="token namespace">djh<span class="token punctuation">.</span>it<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>learn<span class="token punctuation">.</span>chapter1</span><span class="token punctuation">;</span>


<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>consumer<span class="token punctuation">.</span></span><span class="token class-name">ConsumerRecord</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>consumer<span class="token punctuation">.</span></span><span class="token class-name">ConsumerRecords</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>consumer<span class="token punctuation">.</span></span><span class="token class-name">KafkaConsumer</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">Duration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Collections</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Properties</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConsumerFastStart</span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">//private static final String brokerList = "localhost:9092";</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> brokerList <span class="token operator">=</span> <span class="token string">"172.18.30.110:9092"</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> topic <span class="token operator">=</span> <span class="token string">"heima"</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> groupId <span class="token operator">=</span> <span class="token string">"group.demo"</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Properties</span> properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//1）设置 key 序列化器</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"key.deserializer"</span><span class="token punctuation">,</span> <span class="token string">"org.apache.kafka.common.serialization.StringDeserializer"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//2)设置值序列化器</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"value.deserializer"</span><span class="token punctuation">,</span> <span class="token string">"org.apache.kafka.common.serialization.StringDeserializer"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//3)设置集群地址</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"bootstrap.servers"</span><span class="token punctuation">,</span> brokerList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"group.id"</span><span class="token punctuation">,</span> groupId<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">KafkaConsumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> consumer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KafkaConsumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
        consumer<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">singletonList</span><span class="token punctuation">(</span>topic<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">ConsumerRecords</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> records <span class="token operator">=</span> consumer<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofMillis</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">ConsumerRecord</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> record <span class="token operator">:</span> records<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>record<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h4><a id="2_kafka_learn___ConsumerFastStartjava____ProducerFastStartjava__773"></a>2、在 kafka_learn 工程中，启动 消费者 ConsumerFastStart.java 类 和 生产者 ProducerFastStart.java 类，进行测试。会发现，消费者这边接收到，生产者发送的消费。</h4> 
<p><img src="https://images2.imgbox.com/a7/f4/DEvuwkKl_o.png" alt="消费者接收消息.png"></p> 
<h3><a id="kafka__779"></a>八、kafka 优化与总结</h3> 
<h4><a id="1_kafka_learn___ProducerFastStartjava___780"></a>1、在 kafka_learn 工程中，修改 生产者 ProducerFastStart.java 类 ，进行优化代码。</h4> 
<pre><code class="prism language-java">
<span class="token comment">/**
 *  kafka_learn\src\main\java\djh\it\kafka\learn\chapter1\ProducerFastStart.java
 *
 *  2024-6-21 创建 生产者 ProducerFastStart.java 类
 */</span>
<span class="token keyword">package</span> <span class="token namespace">djh<span class="token punctuation">.</span>it<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>learn<span class="token punctuation">.</span>chapter1</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>producer<span class="token punctuation">.</span></span><span class="token class-name">KafkaProducer</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>producer<span class="token punctuation">.</span></span><span class="token class-name">ProducerConfig</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>producer<span class="token punctuation">.</span></span><span class="token class-name">ProducerRecord</span></span><span class="token punctuation">;</span>
<span class="token comment">//注意导包，一定要导成 kafka 的序列化包</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>common<span class="token punctuation">.</span>serialization<span class="token punctuation">.</span></span><span class="token class-name">StringSerializer</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Properties</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProducerFastStart</span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">//private static final String brokerList = "localhost:9092";</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> brokerList <span class="token operator">=</span> <span class="token string">"172.18.30.110:9092"</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> topic <span class="token operator">=</span> <span class="token string">"heima"</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

        <span class="token class-name">Properties</span> properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//1）设置 key 序列化器 -- 优化代码</span>
        <span class="token comment">//properties.put("key.serializer", "org.apache.kafka.common.serialization.StringSerializer");</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span><span class="token constant">KEY_SERIALIZER_CLASS_CONFIG</span><span class="token punctuation">,</span> <span class="token class-name">StringSerializer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//2)设置重试次数 -- 优化代码</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span><span class="token constant">RETRIES_CONFIG</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//3)设置值序列化器 -- 优化代码</span>
        <span class="token comment">//properties.put("value.serializer", "org.apache.kafka.common.serialization.StringSerializer");</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span><span class="token constant">VALUE_SERIALIZER_CLASS_CONFIG</span><span class="token punctuation">,</span> <span class="token class-name">StringSerializer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//4)设置集群地址 -- 优化代码</span>
        <span class="token comment">//properties.put("bootstrap.servers", brokerList);</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span><span class="token constant">BOOTSTRAP_SERVERS_CONFIG</span><span class="token punctuation">,</span> brokerList<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">KafkaProducer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> producer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KafkaProducer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ProducerRecord</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> record <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProducerRecord</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>topic<span class="token punctuation">,</span> <span class="token string">"kafka-demo"</span><span class="token punctuation">,</span> <span class="token string">"优化-2024-6-21-kafka-test!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span><span class="token punctuation">{<!-- --></span>
            producer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        producer<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h4><a id="2_kafka_learn___ConsumerFastStartjava__837"></a>2、在 kafka_learn 工程中，修改 消费者 ConsumerFastStart.java 类，进行优化代码。</h4> 
<pre><code class="prism language-java">
<span class="token comment">/**
 *  kafka_learn\src\main\java\djh\it\kafka\learn\chapter1\ConsumerFastStart.java
 *
 *  2024-6-21 创建 消费者 ConsumerFastStart.java 类
 */</span>
<span class="token keyword">package</span> <span class="token namespace">djh<span class="token punctuation">.</span>it<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>learn<span class="token punctuation">.</span>chapter1</span><span class="token punctuation">;</span>


<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>consumer<span class="token punctuation">.</span></span><span class="token class-name">ConsumerConfig</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>consumer<span class="token punctuation">.</span></span><span class="token class-name">ConsumerRecord</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>consumer<span class="token punctuation">.</span></span><span class="token class-name">ConsumerRecords</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>consumer<span class="token punctuation">.</span></span><span class="token class-name">KafkaConsumer</span></span><span class="token punctuation">;</span>
<span class="token comment">//注意导包，一定要导成 kafka 的序列化包</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>common<span class="token punctuation">.</span>serialization<span class="token punctuation">.</span></span><span class="token class-name">StringDeserializer</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">Duration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Collections</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Properties</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConsumerFastStart</span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">//private static final String brokerList = "localhost:9092";</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> brokerList <span class="token operator">=</span> <span class="token string">"172.18.30.110:9092"</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> topic <span class="token operator">=</span> <span class="token string">"heima"</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> groupId <span class="token operator">=</span> <span class="token string">"group.demo"</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Properties</span> properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//1）设置 key 序列化器 -- 优化代码</span>
        <span class="token comment">//properties.put("key.deserializer", "org.apache.kafka.common.serialization.StringDeserializer");</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span><span class="token constant">KEY_DESERIALIZER_CLASS_CONFIG</span><span class="token punctuation">,</span> <span class="token class-name">StringDeserializer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//2)设置值序列化器 -- 优化代码</span>
        <span class="token comment">//properties.put("value.deserializer", "org.apache.kafka.common.serialization.StringDeserializer");</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span><span class="token constant">VALUE_DESERIALIZER_CLASS_CONFIG</span><span class="token punctuation">,</span> <span class="token class-name">StringDeserializer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//3)设置集群地址 -- 优化代码</span>
        <span class="token comment">//properties.put("bootstrap.servers", brokerList);</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span><span class="token constant">BOOTSTRAP_SERVERS_CONFIG</span><span class="token punctuation">,</span> brokerList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//properties.put("group.id", groupId);</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span><span class="token constant">GROUP_ID_CONFIG</span><span class="token punctuation">,</span> groupId<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">KafkaConsumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> consumer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KafkaConsumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
        consumer<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">singletonList</span><span class="token punctuation">(</span>topic<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">ConsumerRecords</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> records <span class="token operator">=</span> consumer<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofMillis</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">ConsumerRecord</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> record <span class="token operator">:</span> records<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>record<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/5c/65/au0St69u_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="3_kafka__903"></a>3、初识 kafka 总结：</h4> 
<p>kafka 启动前，在进行配置 kafka 参数时，即修改 kafka/kafka_2.12-2.8.0/config/server.properties 配置文件时，需要注意以下几点：</p> 
<ul><li>1） zookeeper.connect</li></ul> 
<p>指明 Zookeeper 主机地址，如果 zookeeper 是集群则以逗号隔开，如:172.6.14.61:2181,172.6.14.62:2181,172.6.14.63:21B1</p> 
<ul><li>2） listeners 监听列表 配置：</li></ul> 
<p>broker 对外提供服务时绑定的 IP 和端口。多个以逗号隔开，如果监听器名称不是一个安全的协议,listener.security.protocol.map 也必须设置。主机名称设置 0.0.0.0 绑定所有的接口，主机名称为空则绑定默认的接口。如:PLAINTEXT://myhost:9092,SSL:/1:9091 CLIENT://0.0.0.0:9092,REPLICATION://localhost:9093</p> 
<ul><li>3） broker.id</li></ul> 
<p>broker 的唯一标识符，如果不配置则自动生成，建议配置且一定要保证集群中必须唯一，默认-11.4.4</p> 
<ul><li>4） log.dirs</li></ul> 
<p>日志数据存放的目录，如果没有配置则使用 log.dir，建议此项配置。</p> 
<ul><li>5） message.max.bytes</li></ul> 
<p>服务器接受单个消息的最大大小，默认 1000012 约等于 976.6KB。</p> 
<pre><code class="prism language-java">
# 切换目录
cd <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>kafka<span class="token operator">/</span>kafka_2<span class="token punctuation">.</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">2.8</span><span class="token number">.0</span><span class="token operator">/</span>

# 修改 kafka 配置参数：
vim config<span class="token operator">/</span>server<span class="token punctuation">.</span>properties

# server<span class="token punctuation">.</span>properties 配置中需要关注以下几个参数<span class="token operator">:</span>

# <span class="token number">1</span>）<span class="token class-name">Kafka</span> 所需 <span class="token class-name">Zookeeper</span> 集群地址
zookeeper<span class="token punctuation">.</span>connect<span class="token operator">=</span>lolalhost<span class="token operator">:</span><span class="token number">2181</span> 

# <span class="token number">2</span>）listeners 监听列表 配置：brokder 对外提供的服务入口地址（ kafka 监听地址：你的虚拟机 <span class="token constant">IP</span> 地址）
# listeners<span class="token operator">=</span><span class="token constant">PLAINTEXT</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">9092</span> 
listeners<span class="token operator">=</span><span class="token constant">PLAINTEXT</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">172.18</span><span class="token number">.30</span><span class="token number">.110</span><span class="token operator">:</span><span class="token number">9092</span> 

# <span class="token number">3</span>）表示 broker 的编号，如果集群中有多个 broker，则每个 broker 的编号需要设置的不同
broker<span class="token punctuation">.</span>id<span class="token operator">=</span><span class="token number">0</span> 

# <span class="token number">4</span>）log<span class="token punctuation">.</span>dirs 设置存放消息日志文件的地址
log<span class="token punctuation">.</span>dirs<span class="token operator">=</span><span class="token operator">/</span>tmp<span class="token operator">/</span>kafka<span class="token operator">/</span>log 


</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d8eb147bc5feedf442daca7bfe17809f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">什么野指针（c&#43;&#43;）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0e9ea39525743e3eecba20d825265299/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【C语言】函数执行背后的秘密：函数栈帧的创建和销毁超详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>