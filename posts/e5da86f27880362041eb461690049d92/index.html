<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>58-DOS与DDOS分析（正常TCP会话与SYN Flood攻击、ICMP Flood 攻击、SNMP放大攻击等） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/e5da86f27880362041eb461690049d92/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="58-DOS与DDOS分析（正常TCP会话与SYN Flood攻击、ICMP Flood 攻击、SNMP放大攻击等）">
  <meta property="og:description" content="目录
正常 TCP 会话与 SYN Flood 攻击
1、正常的三次握手过程：
2、 SYN Flood 攻击
一、攻击windows系统：
二、攻击web网站 ：
拒绝服务攻击工具-Hping3-Syn Flood 攻击
拒绝服务攻击工具--Hping3--ICMP Flood 攻击
sockstress攻击
Sockstress防范
DNS放大攻击
产生大流量的攻击方法
DNS协议放大效果
攻击原理 SNMP放大攻击
简单网络管理协议
攻击原理
应用层DoS
正常 TCP 会话与 SYN Flood 攻击 1、正常的三次握手过程： 第一次握手：客户端--请求（发送请求SYN&#43;数据包当前序列号seq，无需应答）
客户端创建传输控制块TCB，进入监听LISTEN状态。
设置SYN=1，表示这是握手报文，并发送给服务器
设置发送的数据包序列号seq=x
此时客户端处于同步已发送SYN-SENT状态
第二次握手：服务器--确认（发送应答ACK&#43;请求SYN&#43;确认收到上一个数据包的确认号ack&#43; 当前数据包序列号seq）
设置ACK=1，表示确认应答。
设置ack=x&#43;1，表示已收到客户端x之前的数据，希望下次数据从x&#43;1开始
设置SYN=1，表示握手报文，并发送给客户端
设置发送的数据包序列号seq=y
此时服务器处于同步已接收SYN-RCVD状态
第三次握手：客户端--确认服务器的确认（发送应答ACK&#43;确认收到上一个数据包的确认号ack&#43; 当前数据包序列号seq ，连接已建立，无需请求）
设置ACK=1，表示确认应答。
设置ack=y&#43;1，表示收到服务器发来的序列号为seq=y的数据包，希望下次数据从y&#43;1开始
设置seq=x&#43;1，表示接着上一个数据包seq=x继续发送
至此三次握手结束，连接建立
2、 SYN Flood 攻击 SYN Flood（半开放攻击）是一种拒绝服务（DDoS）攻击，其目的是通过消耗所有可用的服务器资源使服务器不可用于合法流量。通过重复发送初始连接请求（SYN）数据包，攻击者能够压倒目标服务器机器上的所有可用端口，导致目标设备根本不响应合法流量。（通过利用TCP连接的握手过程，SYN Flood攻击工作）
SYN攻击判断 看网卡状态：每秒大于1000以上的接收包。
看连接状态：netstat –na，看到大量SYN_RECEIVED状态的连接。
用冰盾DDoS监控器查看：SYN&gt;100">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-21T21:20:39+08:00">
    <meta property="article:modified_time" content="2024-06-21T21:20:39+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">58-DOS与DDOS分析（正常TCP会话与SYN Flood攻击、ICMP Flood 攻击、SNMP放大攻击等）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E6%AD%A3%E5%B8%B8%20TCP%20%E4%BC%9A%E8%AF%9D%E4%B8%8E%20SYN%20Flood%20%E6%94%BB%E5%87%BB-toc" style="margin-left:0px;"><a href="#%E6%AD%A3%E5%B8%B8%20TCP%20%E4%BC%9A%E8%AF%9D%E4%B8%8E%20SYN%20Flood%20%E6%94%BB%E5%87%BB" rel="nofollow">正常 TCP 会话与 SYN Flood 攻击</a></p> 
<p id="1%E3%80%81%E6%AD%A3%E5%B8%B8%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E8%BF%87%E7%A8%8B%EF%BC%9A-toc" style="margin-left:40px;"><a href="#1%E3%80%81%E6%AD%A3%E5%B8%B8%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E8%BF%87%E7%A8%8B%EF%BC%9A" rel="nofollow">1、正常的三次握手过程：</a></p> 
<p id="2%E3%80%81%20SYN%20Flood%20%E6%94%BB%E5%87%BB-toc" style="margin-left:40px;"><a href="#2%E3%80%81%20SYN%20Flood%20%E6%94%BB%E5%87%BB" rel="nofollow">2、 SYN Flood 攻击</a></p> 
<p id="%E4%B8%80%E3%80%81%E6%94%BB%E5%87%BBwindows%E7%B3%BB%E7%BB%9F%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E4%B8%80%E3%80%81%E6%94%BB%E5%87%BBwindows%E7%B3%BB%E7%BB%9F%EF%BC%9A" rel="nofollow">一、攻击windows系统：</a></p> 
<p id="%E4%BA%8C%E3%80%81%E6%94%BB%E5%87%BBweb%E7%BD%91%E7%AB%99%20%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E4%BA%8C%E3%80%81%E6%94%BB%E5%87%BBweb%E7%BD%91%E7%AB%99%20%EF%BC%9A" rel="nofollow">二、攻击web网站 ：</a></p> 
<p id="%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB%E5%B7%A5%E5%85%B7-Hping3-Syn%20Flood%20%E6%94%BB%E5%87%BB-toc" style="margin-left:0px;"><a href="#%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB%E5%B7%A5%E5%85%B7-Hping3-Syn%20Flood%20%E6%94%BB%E5%87%BB" rel="nofollow">拒绝服务攻击工具-Hping3-Syn Flood 攻击</a></p> 
<p id="%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB%E5%B7%A5%E5%85%B7--Hping3--ICMP%20Flood%20%E6%94%BB%E5%87%BB-toc" style="margin-left:0px;"><a href="#%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB%E5%B7%A5%E5%85%B7--Hping3--ICMP%20Flood%20%E6%94%BB%E5%87%BB" rel="nofollow">拒绝服务攻击工具--Hping3--ICMP Flood 攻击</a></p> 
<p id="%C2%A0sockstress%E6%94%BB%E5%87%BB-toc" style="margin-left:0px;"><a href="#%C2%A0sockstress%E6%94%BB%E5%87%BB" rel="nofollow"> sockstress攻击</a></p> 
<p id="Sockstress%E9%98%B2%E8%8C%83-toc" style="margin-left:40px;"><a href="#Sockstress%E9%98%B2%E8%8C%83" rel="nofollow">Sockstress防范</a></p> 
<p id="%C2%A0DNS%E6%94%BE%E5%A4%A7%E6%94%BB%E5%87%BB-toc" style="margin-left:0px;"><a href="#%C2%A0DNS%E6%94%BE%E5%A4%A7%E6%94%BB%E5%87%BB" rel="nofollow"> DNS放大攻击</a></p> 
<p id="%E4%BA%A7%E7%94%9F%E5%A4%A7%E6%B5%81%E9%87%8F%E7%9A%84%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95-toc" style="margin-left:40px;"><a href="#%E4%BA%A7%E7%94%9F%E5%A4%A7%E6%B5%81%E9%87%8F%E7%9A%84%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95" rel="nofollow">产生大流量的攻击方法</a></p> 
<p id="DNS%E5%8D%8F%E8%AE%AE%E6%94%BE%E5%A4%A7%E6%95%88%E6%9E%9C-toc" style="margin-left:40px;"><a href="#DNS%E5%8D%8F%E8%AE%AE%E6%94%BE%E5%A4%A7%E6%95%88%E6%9E%9C" rel="nofollow">DNS协议放大效果</a></p> 
<p id="%E6%94%BB%E5%87%BB%E5%8E%9F%E7%90%86%C2%A0-toc" style="margin-left:40px;"><a href="#%E6%94%BB%E5%87%BB%E5%8E%9F%E7%90%86%C2%A0" rel="nofollow">攻击原理 </a></p> 
<p id="SNMP%E6%94%BE%E5%A4%A7%E6%94%BB%E5%87%BB-toc" style="margin-left:0px;"><a href="#SNMP%E6%94%BE%E5%A4%A7%E6%94%BB%E5%87%BB" rel="nofollow">SNMP放大攻击</a></p> 
<p id="%E7%AE%80%E5%8D%95%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86%E5%8D%8F%E8%AE%AE-toc" style="margin-left:40px;"><a href="#%E7%AE%80%E5%8D%95%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86%E5%8D%8F%E8%AE%AE" rel="nofollow">简单网络管理协议</a></p> 
<p id="%E6%94%BB%E5%87%BB%E5%8E%9F%E7%90%86-toc" style="margin-left:40px;"><a href="#%E6%94%BB%E5%87%BB%E5%8E%9F%E7%90%86" rel="nofollow">攻击原理</a></p> 
<p id="%E5%BA%94%E7%94%A8%E5%B1%82DoS-toc" style="margin-left:0px;"><a href="#%E5%BA%94%E7%94%A8%E5%B1%82DoS" rel="nofollow">应用层DoS</a></p> 
<hr> 
<p></p> 
<h2 id="%E6%AD%A3%E5%B8%B8%20TCP%20%E4%BC%9A%E8%AF%9D%E4%B8%8E%20SYN%20Flood%20%E6%94%BB%E5%87%BB" style="background-color:transparent;">正常 TCP 会话与 SYN Flood 攻击</h2> 
<p></p> 
<h3 id="1%E3%80%81%E6%AD%A3%E5%B8%B8%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E8%BF%87%E7%A8%8B%EF%BC%9A"><strong>1、正常的三次握手过程：</strong></h3> 
<p><span style="color:#fe2c24;"><strong>第一次握手：客户端--请求</strong></span><strong>（发送请求SYN+数据包当前序列号seq，无需应答）</strong><br> 客户端创建传输控制块TCB，进入监听LISTEN状态。<br> 设置SYN=1，表示这是握手报文，并发送给服务器<br> 设置发送的数据包序列号seq=x<br> 此时客户端处于同步已发送SYN-SENT状态</p> 
<p><span style="color:#fe2c24;"><strong>第二次握手：服务器--确认</strong></span>（<strong>发送应答ACK+请求SYN+确认收到上一个数据包的确认号ack+ 当前数据包序列号seq）</strong><br> 设置ACK=1，表示确认应答。<br> 设置ack=x+1，表示已收到客户端x之前的数据，希望下次数据从x+1开始<br> 设置SYN=1，表示握手报文，并发送给客户端<br> 设置发送的数据包序列号seq=y<br> 此时服务器处于同步已接收SYN-RCVD状态</p> 
<p><span style="color:#fe2c24;"><strong>第三次握手：客户端--确认服务器的确认</strong></span><strong>（发送应答ACK+确认收到上一个数据包的确认号ack+ 当前数据包序列号seq ，连接已建立，无需请求）</strong><br> 设置ACK=1，表示确认应答。<br> 设置ack=y+1，表示收到服务器发来的序列号为seq=y的数据包，希望下次数据从y+1开始<br> 设置seq=x+1，表示接着上一个数据包seq=x继续发送<br> 至此三次握手结束，连接建立</p> 
<p><img alt="" height="367" src="https://images2.imgbox.com/85/6e/xljEeBx9_o.png" width="1200"></p> 
<hr> 
<h3 id="2%E3%80%81%20SYN%20Flood%20%E6%94%BB%E5%87%BB" style="background-color:transparent;">2、 SYN Flood 攻击</h3> 
<p>SYN Flood（半开放攻击）是一种拒绝服务（DDoS）攻击，其目的是<strong>通过消耗所有可用的服务器资源使服务器不可用于合法流量</strong>。<strong>通过重复发送初始连接请求（SYN）数据包，攻击者能够压倒目标服务器机器上的所有可用端口，导致目标设备根本不响应合法流量</strong>。（通过利用TCP连接的握手过程，SYN Flood攻击工作）</p> 
<p><img alt="" height="538" src="https://images2.imgbox.com/5a/11/2X8lEIKs_o.png" width="1200"></p> 
<p><strong>SYN攻击判断 </strong></p> 
<blockquote> 
 <p>看网卡状态：每秒大于1000以上的接收包。</p> 
 <p>看连接状态：netstat –na，看到大量SYN_RECEIVED状态的连接。</p> 
 <p>用冰盾DDoS监控器查看：SYN&gt;100</p> 
 <p>被攻击的直接感受： Ping主机不通或丢包严重。 即便没有开放端口，CPU占用很高甚至100%</p> 
</blockquote> 
<p></p> 
<p> 演示过程：</p> 
<h4 id="%E4%B8%80%E3%80%81%E6%94%BB%E5%87%BBwindows%E7%B3%BB%E7%BB%9F%EF%BC%9A" style="background-color:transparent;">一、攻击windows系统：</h4> 
<p>打开win2003改为桥接模式；模拟真实环境。（ip：192.168.13.200)；打开kali2022（xshell连接）</p> 
<p><img alt="" height="517" src="https://images2.imgbox.com/d3/c1/2sTCHWBX_o.png" width="1200"></p> 
<p><img alt="" height="309" src="https://images2.imgbox.com/25/4b/c4EV759K_o.png" width="1145"></p> 
<p> 2、如攻击远程连接端口3389；目标主机打开远程桌面（计算机-右击属性）</p> 
<p><img alt="" height="487" src="https://images2.imgbox.com/6e/c7/KMHR7RvO_o.png" width="577"></p> 
<p> 尝试远程连接；可以远程；</p> 
<p><img alt="" height="448" src="https://images2.imgbox.com/c4/8e/lgAuA2Uz_o.png" width="733"></p> 
<p><img alt="" height="492" src="https://images2.imgbox.com/c4/79/RkLlKZpQ_o.png" width="792"></p> 
<p>3、Windows系统使用 【FastSend.exe】工具进行攻击（端口攻击）:</p> 
<p><img alt="" height="469" src="https://images2.imgbox.com/08/46/0V4St5e3_o.png" width="674"></p> 
<p> 4、大量SYN会话请求占用导致无法正常连接，关闭攻击即恢复。</p> 
<p><img alt="" height="685" src="https://images2.imgbox.com/be/70/d4EIVTKo_o.png" width="1200"></p> 
<h4 id="%E4%BA%8C%E3%80%81%E6%94%BB%E5%87%BBweb%E7%BD%91%E7%AB%99%20%EF%BC%9A" style="background-color:transparent;">二、攻击web网站 ：</h4> 
<p>1、打开phpstudy2016  dvwa靶场</p> 
<pre><code class="language-bash">http://192.168.13.200:90/dvwa/login.php</code></pre> 
<p><img alt="" height="764" src="https://images2.imgbox.com/ad/58/vnV7giQa_o.png" width="1200"></p> 
<p>2、 同windows使用 【FastSend.exe】工具进行攻击（端口攻击）：</p> 
<p><img alt="" height="477" src="https://images2.imgbox.com/ac/9d/WeZ9iMVF_o.png" width="670"></p> 
<p>3、开始攻击：</p> 
<p>网站将会无法访问，停止攻击即可恢复；最大四分钟内会话被是否，被释放也可访问</p> 
<p> <img alt="" height="923" src="https://images2.imgbox.com/35/b4/2sosZ4AV_o.png" width="1200"></p> 
<p>看连接状态：netstat –na，看到大量<strong>SYN_RECEIVED</strong>状态的连接</p> 
<pre><code class="hljs">netstat -an</code></pre> 
<p><img alt="" height="599" src="https://images2.imgbox.com/85/c5/nQqi8kmy_o.png" width="627"> </p> 
<p> 目标主机的cpu使用率有明显提升：</p> 
<p><img alt="" height="444" src="https://images2.imgbox.com/e7/0e/vnOteWMN_o.png" width="496"></p> 
<hr> 
<p>发一个包释放一个连接，这种达不到攻击郊果。要构成攻击效果可以通过iptables限止发送RST包。这样就可以达到攻击郊果。iptables写法如下：</p> 
<pre><code class="language-cs">iptables -F  #清除iptables规则

iptables -L  #查看iptables防火墙规则

iptables -A OUTPUT -p tcp --tcp-flags RST RST -d 192.168.13.200 -j DROP  #添加iptables防火墙规则</code></pre> 
<blockquote> 
 <p><strong>这条命令的目的是阻止所有从本机出发、目标为<code>192.168.13.200</code>且TCP标志仅设置为<code>RST</code>的TCP数据包:</strong></p> 
 <ul><li> <p><code>iptables</code>: 这是Linux系统中用于配置和管理Netfilter防火墙规则的命令行工具。</p> </li><li> <p><code>-A OUTPUT</code>: <code>-A</code> 表示追加一条新规则到指定的规则链末尾，<code>OUTPUT</code> 是数据包流出本机（即作为响应或本机发起的连接）时经过的链。</p> </li><li> <p><code>-p tcp</code>: 指定该规则只应用于TCP协议的数据包。</p> </li><li> <p><code>--tcp-flags RST RST</code>: 这个选项指定了TCP标志位的匹配条件。在这里，要求数据包的TCP标志位中必须且只能包含<code>RST</code>标志。TCP的RST标志用于复位连接，通常在异常终止连接或响应不存在的连接时使用。</p> </li><li> <p><code>-d 192.168.13.200</code>: 指定目标IP地址为<code>192.168.13.200</code>，即这条规则只影响发往该地址的数据包。</p> </li><li> <p><code>-j DROP</code>: <code>-j</code> 是“jump”的缩写，用于指定匹配到规则后的动作。<code>DROP</code> 动作意味着任何符合上述条件的数据包都将被防火墙静默丢弃，既不响应也不通知发送方。</p> </li></ul> 
 <p></p> 
</blockquote> 
<p><img alt="" height="351" src="https://images2.imgbox.com/bf/02/rfIr38Qk_o.png" width="960"></p> 
<p> kali打开流量分析【Wireshark】工具：</p> 
<p>嗅探/欺骗--&gt;Wireshark</p> 
<p><img alt="" height="891" src="https://images2.imgbox.com/69/88/KICq4gCJ_o.png" width="1047"></p> 
<p><img alt="" height="602" src="https://images2.imgbox.com/78/4b/S1jGrsBp_o.png" width="1183"></p> 
<blockquote> 
 <p>623255    25.906866889    216.93.6.102    192.168.13.200    TCP    174    37500 → 90 [SYN] Seq=0 Win=64 Len=120</p> 
</blockquote> 
<h2 id="%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB%E5%B7%A5%E5%85%B7-Hping3-Syn%20Flood%20%E6%94%BB%E5%87%BB">拒绝服务攻击工具-Hping3-Syn Flood 攻击</h2> 
<p>Hping3 -几乎可以定制发送任何TCP/IP数据包，用于测试FW、端口扫描、性能测试</p> 
<p>Syn Flood 攻击</p> 
<p>hping3 -c 1000 -d 120 -S -w 64 -p 90 --flood --rand-source 192.168.13.200</p> 
<p>hping3 -S -P -U -p 80 --flood --rand-source 192.168.13.200</p> 
<p>hping3 -SARFUP -p 80 --flood --rand-source 192.168.13.200 (TCP Flood)</p> 
<p></p> 
<p><img alt="" height="814" src="https://images2.imgbox.com/39/6b/fuLcLBso_o.png" width="1200"></p> 
<p>syn攻击特征：攻击者为随机IP、长度相同、目标主机cpu及网络应用占用明显。</p> 
<p><img alt="" height="532" src="https://images2.imgbox.com/00/e0/IG9ekR2f_o.png" width="1110"> <img alt="" height="126" src="https://images2.imgbox.com/25/e1/IuFeooTS_o.png" width="499"></p> 
<p><img alt="" height="151" src="https://images2.imgbox.com/f4/b7/NTcRwgoO_o.png" width="493"></p> 
<p>指定任意ip（可指定使用代理池）进行攻击：</p> 
<pre><code class="language-cs">hping3 -c 1000 -d 120 -S -w 64 -p 90 -a 1.1.1.1 --flood 192.168.13.200 </code></pre> 
<p><img alt="" height="105" src="https://images2.imgbox.com/3d/59/LmLO7mmz_o.png" width="880"></p> 
<p><img alt="" height="344" src="https://images2.imgbox.com/b5/6f/YXlq7l8z_o.png" width="1200"></p> 
<hr> 
<p> </p> 
<h2 id="%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB%E5%B7%A5%E5%85%B7--Hping3--ICMP%20Flood%20%E6%94%BB%E5%87%BB">拒绝服务攻击工具--Hping3--ICMP Flood 攻击</h2> 
<pre><code class="language-cs">hping3 -q -n -a 1.1.1.1 --icmp -d 56 --flood 192.168.13.200</code></pre> 
<blockquote> 
 <ul><li><code>-q</code>：安静模式，不显示每个数据包的发送反馈。</li><li><code>-n</code>：不进行DNS反向解析，以IP地址而非主机名显示。</li><li><code>-a</code>：设置源IP地址为<code>1.1.1.1</code>，这通常是用于模拟特定源IP的测试。</li><li><code>--icmp</code>：指定使用ICMP协议，而不是默认的TCP或UDP。</li><li><code>-d 56</code>：设置ICMP数据包的载荷大小为56字节。</li><li><code>--flood</code>：快速连续发送数据包，不等待响应，模拟洪水攻击或压力测试。</li><li><code>192.168.13.200</code>：目标IP地址，这里是发送ICMP请求的目标。</li></ul> 
</blockquote> 
<p><img alt="" height="737" src="https://images2.imgbox.com/df/f2/ufj845nP_o.png" width="1200"> <img alt="" height="729" src="https://images2.imgbox.com/90/e3/98dWESUG_o.png" width="1200"><img alt="" height="386" src="https://images2.imgbox.com/68/c9/mSzEV4ji_o.png" width="1200"></p> 
<p> ICMP攻击特征：目标主机卡顿、挂机；目标主机cpu及网络应用占用明显、没有端口号。</p> 
<hr> 
<h2 id="%C2%A0sockstress%E6%94%BB%E5%87%BB" style="background-color:transparent;"> sockstress攻击</h2> 
<p>2008年由 Jack C. Louis 发现，针对TCP服务的拒绝服务攻击</p> 
<p>1、消耗被攻击目标系统资源 -与攻击目标建立大量socket链接</p> 
<p>2、完成三次握手，最后的ACK包window大小为0 (客户端不接收数据）；攻击者资源消耗小（CPU、内存、带宽） ；</p> 
<p>3、异步攻击，单机可拒绝服务高配资源服务器；</p> 
<p>4、Window窗-实现的TCP流控</p> 
<p></p> 
<p><strong>防火墙规则设置：</strong></p> 
<pre><code class="language-cs">iptables -F  #清除iptables规则

iptables -L  #查看iptables防火墙规则

iptables -A OUTPUT -p TCP --tcp-flags rst rst -d 1.1.1.1 -j DROP #增加iptables防火墙规则</code></pre> 
<p> 把sockstress工具上传到kali；切换到工具目录；执行攻击语句：</p> 
<pre><code class="language-cs">./sockstress 192.168.13.200:90 eth0 -p payloads/http -d 10</code></pre> 
<blockquote> 
 <p> </p> 
 <ul><li> <p><code>./sockstress</code>：表示执行当前目录下的<code>sockstress</code>可执行文件。<code>sockstress</code>是一种曾经被用于测试系统TCP栈稳定性和抗压能力的工具，也可能被滥用于发起DoS攻击。</p> </li><li> <p><code>192.168.13.200:90</code>：指定目标IP地址和端口号，这里是针对IP地址为<code>192.168.13.200</code>，端口为<code>90</code>的服务进行操作。</p> </li><li> <p><code>eth0</code>：指定本地使用的网络接口，这里是<code>eth0</code>，表示将通过这个网络接口发送数据包。</p> </li><li> <p><code>-p payloads/http</code>：此参数可能指定了使用的payload类型或模式，<code>http</code>可能意味着使用HTTP协议的特定数据或头信息作为payload来构造TCP连接请求，这取决于<code>sockstress</code>工具的具体实现。</p> </li><li> <p><code>-d 10</code>：<code>-d是微秒内指定，默认为1000000  改成10之后并发带度更快。</code></p> </li></ul> 
</blockquote> 
<p>未攻击前可正常访问： </p> 
<p><img alt="" height="674" src="https://images2.imgbox.com/aa/61/GzLIZkgD_o.png" width="1200"></p> 
<p> 攻击中：web网站无法访问</p> 
<p><img alt="" height="215" src="https://images2.imgbox.com/11/24/LNFZpVnL_o.png" width="836"> </p> 
<p><img alt="" height="923" src="https://images2.imgbox.com/c3/02/Eld4GH9Y_o.png" width="1200"></p> 
<p> 流量特征：完成三次握手、win=0、Window窗(TCP ZeroWindow)、只有请求头没有响应包</p> 
<p><img alt="" height="399" src="https://images2.imgbox.com/fb/4b/yL1xCp7E_o.png" width="1200"></p> 
<p><img alt="" height="468" src="https://images2.imgbox.com/b7/2a/nwuVTDwQ_o.png" width="965"></p> 
<h3 id="Sockstress%E9%98%B2%E8%8C%83" style="background-color:transparent;">Sockstress防范</h3> 
<p>防御措施</p> 
<blockquote> 
 <p>直到今天sockstress攻击仍然是一种很有效的DoS攻击方式 -甶于建立完整的TCP三步握手，因此使用syn cookie防御无效 -根本的防御方法是采用白名单（不实际）</p> 
 <p><strong>折中对策</strong>：限制单位时间内每IP建的TCP连接数</p> 
 <p>■封杀每30秒与80端口建立连接超过10个的IP地址</p> 
 <p>■iptables -I INPUT -p tcp --dport 80 -m state --state NEW -m recent --set</p> 
 <p>■iptables -I INPUT -p tcp --dport 80 -m state --state NEW -m recent --update --seconds 30 --hitcount 10 -j DROP</p> 
 <p>■以上规则对DDoS攻击无效 </p> 
</blockquote> 
<p> </p> 
<hr> 
<h2 id="%C2%A0DNS%E6%94%BE%E5%A4%A7%E6%94%BB%E5%87%BB" style="background-color:transparent;"> DNS放大攻击</h2> 
<h3 id="%E4%BA%A7%E7%94%9F%E5%A4%A7%E6%B5%81%E9%87%8F%E7%9A%84%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95"><strong>产生大流量的攻击方法</strong></h3> 
<blockquote> 
 <p>-单机的带宽优势</p> 
 <p>-巨大单机数量形成的流量汇聚</p> 
 <p>-利用协议特性实现放大效果的流量</p> 
</blockquote> 
<h3 id="DNS%E5%8D%8F%E8%AE%AE%E6%94%BE%E5%A4%A7%E6%95%88%E6%9E%9C" style="background-color:transparent;"><strong>DNS协议放大效果</strong></h3> 
<blockquote> 
 <p>-查询请求流量小，但响应流量可能非常巨大</p> 
 <p>-digANYhp.com @202.106.0.20 (流量放大约8倍</p> 
</blockquote> 
<pre><code class="language-cs">dig ANY hp.com @202.106.0.20</code></pre> 
<blockquote> 
 <p><code>dig</code>：是DNS查询工具</p> 
 <p><code>ANY hp.com</code>：这是查询的部分，其中：</p> 
 <ul><li><code>ANY</code> 是查询类型，表示请求DNS服务器返回该域名所有类型的记录</li><li><code>hp.com</code> 是你要查询的域名，这里是惠普公司的官方网站域名</li></ul> 
 <p><code>@202.106.0.20</code>：指定了DNS解析查询应该发送给的DNS服务器地址</p> 
</blockquote> 
<p> <img alt="" height="1125" src="https://images2.imgbox.com/0e/4c/Ymr9FcYb_o.png" width="1200"></p> 
<h3 id="%E6%94%BB%E5%87%BB%E5%8E%9F%E7%90%86%C2%A0"><strong>攻击原理 </strong></h3> 
<blockquote> 
 <p>-伪造源地址为被攻击目标地址，向递归域名查询服务器发起查询</p> 
 <p>-DNS服务器成为流量放大和实施攻击者，大量DNS服务器实现DDoS</p> 
</blockquote> 
<h2 id="SNMP%E6%94%BE%E5%A4%A7%E6%94%BB%E5%87%BB" style="background-color:transparent;">SNMP放大攻击</h2> 
<h3 id="%E7%AE%80%E5%8D%95%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86%E5%8D%8F%E8%AE%AE"><strong>简单网络管理协议</strong></h3> 
<blockquote> 
 <p>-Simple Network Management Protocol</p> 
 <p>-服务端UDP 161 / 162</p> 
 <p>-管理站（manager /客户端）、被管理设备（agent /服务端）</p> 
 <p>-管理信息数据库（MIB）是一个信息存储库，包含管理代理中的有关配置和性能 的数据，按照不同分类，包含分属不同组的多个数据对象</p> 
 <p>-每一个节点都有一个对象标识符（OID)来唯一的标识</p> 
 <p>-IETF定义便准的MIB库/厂家自定义MIB库</p> 
</blockquote> 
<h3 id="%E6%94%BB%E5%87%BB%E5%8E%9F%E7%90%86"><strong>攻击原理</strong></h3> 
<blockquote> 
 <p>-请求流量小，查询结果返回流量大 -结合伪造源地址实现攻击</p> 
</blockquote> 
<h2 id="%E5%BA%94%E7%94%A8%E5%B1%82DoS" style="background-color:transparent;">应用层DoS</h2> 
<h3><strong>应用服务漏洞</strong></h3> 
<blockquote> 
 <p>-服务代码存在漏洞，遇异常提交数据时程序崩溃</p> 
 <p>-应用处理大量并发请求能力有限，被拒绝的是应用或OS</p> 
</blockquote> 
<h3><strong>缓冲区溢出漏洞</strong></h3> 
<blockquote> 
 <p>-向目标函数随机提交数据，特定情况下数据覆盖临近寄存器或内存</p> 
 <p>-影响：远程代码执行、DoS</p> 
 <p>-利用模糊测试方法发现缓冲区溢出漏洞</p> 
</blockquote> 
<h3><strong>CesarFTP 0.99 服务漏洞</strong></h3> 
<blockquote> 
 <p>-ftp_fuzz.py # MKD/RMD</p> 
 <p>MS12-020远程桌面协议DoS漏洞</p> 
</blockquote> 
<p></p> 
<h3><strong>Slowhttptest (源自google)</strong></h3> 
<blockquote> 
 <p>-低带宽应用层慢速DoS攻击（相对于CC等快速攻击而言的慢速)</p> 
 <p>-最早由Python编写，跨平台支持（Linux、win、Cygwin、OSX)</p> 
 <p>-尤其擅长攻击apache、tomcat (几乎百发百中)</p> 
</blockquote> 
<h4><strong>攻击方法</strong></h4> 
<p>Slowloris、Slow HTTP POST 攻击</p> 
<h4><strong>原理</strong></h4> 
<p>耗尽应用的并发连接池，类似于Http层的Syn flood HTTP协议默认在服务器全部接收请求之后才开始处理，若客户端发送速度缓慢或不完整，服务器时钟为其保留连接资源池占用，此类大量并发将导致DoS Slowloris:完整的http请求结尾是\r\n\r\n，攻击发\r\n......     Slow POST: HTTP头content-length声明长度，但body部分缓慢发送</p> 
<p><img alt="" height="768" src="https://images2.imgbox.com/0f/27/LEKz4Nid_o.png" width="1024"></p> 
<hr> 
<p><strong>声明：</strong></p> 
<ul><li>此文章只做技术研究，谨遵守国家相关法律法规，请勿用于违法用途，如果您对文章内容有疑问，可以尝试留言私信，如有侵权请联系小编处理。</li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d106bf162a7f0d21e6e98bf53ba45f91/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">逻辑回归（Logistic Regression）及其在机器学习中的应用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/69b29c525f48b93f6ed59acdc885b1df/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Python】成功解决TypeError: missing 1 required positional argument</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>