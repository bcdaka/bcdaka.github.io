<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Configuring the Cisco IOS XE DHCP Relay Agent - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/6d1f1897a4fe5dd08c3d85776d312170/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Configuring the Cisco IOS XE DHCP Relay Agent">
  <meta property="og:description" content="Cisco routers running Cisco IOS XE software include Dynamic Host Configuration Protocol (DHCP) server and relay agent software. A DHCP relay agent is any host that forwards DHCP packets between clients and servers. This module describes the concepts and tasks needed to configure the Cisco IOS XE DHCP relay agent. Specifying the Packet Forwarding Address Perform this task to configure the DHCP relay agent to forward packets to a DHCP server.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-17T16:30:52+08:00">
    <meta property="article:modified_time" content="2024-08-17T16:30:52+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Configuring the Cisco IOS XE DHCP Relay Agent</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h5>Cisco routers running Cisco IOS XE software include Dynamic Host Configuration Protocol (DHCP) server and relay agent software. A DHCP relay agent is any host that forwards DHCP packets between clients and servers. This module describes the concepts and tasks needed to configure the Cisco IOS XE DHCP relay agent.</h5> 
<h4 id="GUID-68BC7D5E-7854-47E7-8BD9-91057C7BA2A2__GUID-28604D18-72B0-408C-A6A1-FAF9F17B4A53">Specifying the Packet Forwarding Address</h4> 
<p>Perform this task to configure the DHCP relay agent to forward packets to a DHCP server.</p> 
<h4>SUMMARY STEPS</h4> 
<ol id="GUID-68BC7D5E-7854-47E7-8BD9-91057C7BA2A2__GUID-F99CB407-2028-4972-8AC6-78964268C8DA"><li>enable</li><li>configure terminal</li><li>interface type number</li><li>ip helper-address address</li></ol> 
<h4>DETAILED STEPS</h4> 
<table><thead><tr><th></th><th>Command or Action</th><th>Purpose</th></tr></thead><tbody><tr><td id="GUID-68BC7D5E-7854-47E7-8BD9-91057C7BA2A2__step_65A9139FBFDF40ED9AB61DA8B1E07EF7" style="vertical-align:top;"><strong>Step 1</strong></td><td style="vertical-align:top;"> <p>enable</p> <h5>Example:</h5> <pre><code>
Device&gt; enable</code></pre> </td><td style="vertical-align:top;"> <p>Enables privileged EXEC mode.</p> 
    <ul id="GUID-68BC7D5E-7854-47E7-8BD9-91057C7BA2A2__GUID-2CFA7465-5AAC-46CD-8BB5-F53473054AE7"><li id="GUID-68BC7D5E-7854-47E7-8BD9-91057C7BA2A2__li_F6CC4613EE4F45FDBB2F9996438DD6E3"> <p>Enter your password if prompted.</p> </li></ul></td></tr><tr><td style="vertical-align:top;"><strong>Step 2</strong></td><td style="vertical-align:top;"> <p>configure terminal</p> <h5>Example:</h5> <pre><code>
Device# configure terminal</code></pre> </td><td style="vertical-align:top;"> <p>Enters global configuration mode.</p> </td></tr><tr><td style="vertical-align:top;"><strong>Step 3</strong></td><td style="vertical-align:top;"> <p>interface type number</p> <h5>Example:</h5> <pre><code>
Device(config)# interface GigabitEthernet0/0/0</code></pre> </td><td style="vertical-align:top;"> <p>Configures an interface and enters interface configuration mode.</p> </td></tr><tr><td style="vertical-align:top;"><strong>Step 4</strong></td><td style="vertical-align:top;"> <p>ip helper-address address</p> <h5>Example:</h5> <pre><code>
Device(config-if)# ip helper-address 172.16.1.2</code></pre> </td><td style="vertical-align:top;"> <p>Forwards UPD broadcasts, including BOOTP and DHCP.</p> 
    <ul id="GUID-68BC7D5E-7854-47E7-8BD9-91057C7BA2A2__GUID-142DCAB7-72C5-4E95-9113-E481CB1BAABB"><li> <p>The address argument can be a specific DHCP server address, or it can be the network address if other DHCP servers are on the destination network segment. Using the network address enables other servers to respond to DHCP requests.</p> </li><li> <p>If you have multiple servers, you can configure one helper address for each server.</p> </li></ul> 
    <table border="0"><tbody><tr><td><strong>Note</strong> </td><td> <p>If Intelligent Wireless Access Gateway (IWAG) router is relaying DHCP packets to external DHCP server, it requires to configure DHCP relay pool instead of ip helper address under subscriber interface to be stateful.</p> ip dhcp pool DHCP_Relay_pool_name <pre><code>
ip dhcp pool relay_pool1
relay source 10.56.151.76
relay destination 10.48.155.76
</code></pre> </td></tr></tbody></table></td></tr></tbody></table> 
<h4 id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__GUID-C80EBA3F-4122-47AB-8665-82C8C1800B9E">Configuring Relay Agent Information Option Support</h4> 
<p>Perform this task to enable support for the DHCP relay agent information option.</p> 
<table border="0"><tbody><tr><td> <p class="img-center"><img alt="" height="25" src="https://images2.imgbox.com/99/9d/nGT2auRm_o.gif" width="28"></p> <strong>Note</strong></td><td> 
    <hr> 
    <ul id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__GUID-2D12F07E-87CE-44E4-BFE8-92DB7E836404"><li id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__LI_FFCBF378F7E44EF4AF8D0ED49E379456">If an ip dhcp relay information command is configured in global configuration mode but not configured in interface configuration mode, the global configuration is applied to all interfaces.</li><li id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__LI_3D3A149C1DA44FCCB0823267EE08C0EF">If an ip dhcp relay information command is configured in both global configuration mode and interface configuration mode, the interface configuration command takes precedence over the global configuration command. However, the global configuration is applied to interfaces without the interface configuration.</li><li id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__LI_763DCCFD6F884F639C26B71E57829922">If an ip dhcp relay information command is not configured in global configuration mode but is configured in interface configuration mode, only the interface with the configuration option applied is affected. All other interfaces are not impacted by the configuration.</li></ul> See the "Configuring Relay Agent Information Option Support per Interface" section for more information on per-interface support for the relay agent information option. &gt; 
    <hr></td></tr></tbody></table> 
<h4>SUMMARY STEPS</h4> 
<ol id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__GUID-8FE400F4-98A6-4D68-B9A9-ED04DD16377D"><li>enable</li><li>configure terminal</li><li>ip dhcp relay information option</li><li>ip dhcp relay information check</li><li>ip dhcp relay information policy {drop | keep | replace }</li><li>ip dhcp relay information trust-all</li><li>end</li><li>show ip dhcp relay information trusted-sources</li></ol> 
<h4>DETAILED STEPS</h4> 
<table><thead><tr><th></th><th>Command or Action</th><th>Purpose</th></tr></thead><tbody><tr><td id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__STEP_9F57E582BA37466BA555B8846E0EA016" style="vertical-align:top;"><strong>Step 1</strong></td><td style="vertical-align:top;"> <p>enable</p> <h5>Example:</h5> <pre><code>
Router&gt; enable</code></pre> </td><td style="vertical-align:top;"> <p>Enables privileged EXEC mode.</p> 
    <ul id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__GUID-E458D9BE-B3EA-4A2B-A4A1-0844D7DB989A"><li id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__LI_E197DF5BB1214BC587B941DB1A480A45"> <p>Enter your password if prompted.</p> </li></ul></td></tr><tr><td id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__STEP_A351FE1E6BDB47DBB4A47004BC85928A" style="vertical-align:top;"><strong>Step 2</strong></td><td style="vertical-align:top;"> <p>configure terminal</p> <h5>Example:</h5> <pre><code>
Router# configure terminal</code></pre> </td><td style="vertical-align:top;"> <p>Enters global configuration mode.</p> </td></tr><tr><td id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__STEP_C99101A065D24DB0B46C96068496A340" style="vertical-align:top;"><strong>Step 3</strong></td><td style="vertical-align:top;"> <p>ip dhcp relay information option</p> <h5>Example:</h5> <pre><code>
Router(config)# ip dhcp relay information option</code></pre> </td><td style="vertical-align:top;"> <p>Enables the system to insert the DHCP relay agent information option (option-82 field) in forwarded BOOTREQUEST messages to a DHCP server.</p> 
    <ul id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__GUID-5F2ECA7B-E55C-43BB-BA5F-828AD9BE1E94"><li id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__LI_AA16CAC520FE48778AC0DBC16B084F97"> <p>This function is disabled by default.</p> </li></ul></td></tr><tr><td id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__STEP_4281FF39DA0649098F78E2005963FB3A" style="vertical-align:top;"><strong>Step 4</strong></td><td style="vertical-align:top;"> <p>ip dhcp relay information check</p> <h5>Example:</h5> <pre><code>
Router(config)# ip dhcp relay information check</code></pre> </td><td style="vertical-align:top;"> <p>(Optional) Configures DHCP to check that the relay agent information option in forwarded BOOTREPLY messages is valid.</p> 
    <ul id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__GUID-14E3FB68-6652-4EBB-AE04-4C84498D969E"><li id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__LI_57283BB002714C92BA7C0899DD0AFAD4"> <p>By default, DHCP checks that the option-82 field in DHCP reply packets it receives from the DHCP server is valid. If an invalid message is received, the relay agent drops it. If a valid message is received, the relay agent removes the option-82 field and forwards the packet. Use the ip dhcp relay information check command to reenable this functionality if it has been disabled.</p> </li></ul></td></tr><tr><td id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__STEP_B92D6AB0B0244C999BAD0B2E2BCCDB1B" style="vertical-align:top;"><strong>Step 5</strong></td><td style="vertical-align:top;"> <p>ip dhcp relay information policy {drop | keep | replace }</p> <h5>Example:</h5> <pre><code>
Router(config)# ip dhcp relay information policy replace</code></pre> </td><td style="vertical-align:top;"> <p>(Optional) Configures the reforwarding policy for a DHCP relay agent (what a relay agent should do if a message already contains relay information).</p> 
    <ul id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__GUID-5A28019B-FD42-4B44-97F8-332A841226E2"><li id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__LI_C0E8D363736843C88051817428310C55"> <p>See the "Relay Agent Information Reforwarding Policy" section for more information.</p> </li></ul></td></tr><tr><td id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__STEP_12AD0DF992D24DDFAD7DF1388EEE21C9" style="vertical-align:top;"><strong>Step 6</strong></td><td style="vertical-align:top;"> <p>ip dhcp relay information trust-all</p> <h5>Example:</h5> <pre><code>
Router(config)# ip dhcp relay information trust-all</code></pre> </td><td style="vertical-align:top;"> <p>(Optional) Configures all interfaces on a router as trusted sources of the DHCP relay information option.</p> 
    <ul id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__GUID-8A51C0F5-B61E-429D-B567-DF9125E3410F"><li id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__LI_0369ECC73475406CAB8FD0F3032C56C2"> <p>By default, if the gateway address is set to all zeros in the DHCP packet and the relay agent information option is already present in the packet, the DHCP relay agent will discard the packet. Use the ip dhcp relay information trust-all command to override this behavior and accept the packets.</p> </li><li id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__LI_9AC268BF4D464089BA5918DA492A1071"> <p>This command is useful if there is a switch in between the client and the relay agent that may insert option 82. Use this command to ensure that these packets do not get dropped.</p> </li><li id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__LI_EB4CF73B521E43E28066CCED7663745C"> <p>You can configure an individual interface as a trusted source of the DHCP relay information option by using the ip dhcp relay information trusted interface configuration mode command.</p> </li></ul></td></tr><tr><td id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__STEP_A6BDFB1C739247CA9755FCD04FC2B0D8" style="vertical-align:top;"><strong>Step 7</strong></td><td style="vertical-align:top;"> <p>end</p> <h5>Example:</h5> <pre><code>
Router(config)# end</code></pre> </td><td style="vertical-align:top;"> <p>Returns to privileged EXEC mode.</p> </td></tr><tr><td id="GUID-4BB98DF9-7364-4FFA-B7A3-4AA88BC36307__STEP_626F30FC6979434E86EFD8484A8D679B" style="vertical-align:top;"><strong>Step 8</strong></td><td style="vertical-align:top;"> <p>show ip dhcp relay information trusted-sources</p> <h5>Example:</h5> <pre><code>
Router# show ip dhcp relay information trusted-sources</code></pre> </td><td style="vertical-align:top;"> <p>(Optional) Displays all interfaces configured to be a trusted source for the DHCP relay information option.</p> </td></tr></tbody></table> 
<h4 id="GUID-7380D6BC-B53C-425E-8BD4-224CD83BBE2C__GUID-ADFB5FAC-9258-4173-89E7-A2784AA418DB">Configuring Relay Agent Information Option Support per Interface</h4> 
<p>Perform this task to enable support for the DHCP relay agent information option (option 82) on a per interface basis.</p> 
<p>The interface configuration allows the subscribers with different DHCP option 82 requirements on different interfaces to be reached from one Cisco router.</p> 
<h5>Before you begin</h5> 
<p>Read the “Restrictions” and "Relay Agent Information Reforwarding Policy" sections to understand how DHCP processes the relay agent information option for global configurations.</p> 
<table border="0"><tbody><tr><td> <p class="img-center"><img alt="" height="25" src="https://images2.imgbox.com/3b/52/yLzj99yd_o.gif" width="28"></p> <strong>Note</strong></td><td> 
    <hr> 
    <ul id="GUID-7380D6BC-B53C-425E-8BD4-224CD83BBE2C__GUID-141E00DE-0CD2-4DC3-A588-6C41F3D8A74D"><li id="GUID-7380D6BC-B53C-425E-8BD4-224CD83BBE2C__LI_E5A9E91FAAF34E1EA1F252FCD8A8481A">If an ip dhcp relay information command is configured in global configuration mode but not configured in interface configuration mode, the global configuration is applied to all interfaces.</li><li id="GUID-7380D6BC-B53C-425E-8BD4-224CD83BBE2C__LI_EA932368024A4810AE3D707FC4E8EDED">If an ip dhcp relay information command is configured in both global configuration mode and interface configuration mode, the interface configuration command takes precedence over the global configuration command. However, the global configuration is applied to interfaces without the interface configuration.</li><li id="GUID-7380D6BC-B53C-425E-8BD4-224CD83BBE2C__LI_4D0E101E96A7478796317FCD8C48B40D">If an ip dhcp relay information command is not configured in global configuration mode but is configured in interface configuration mode, only the interface with the configuration option applied is affected. All other interfaces are not impacted by the configuration.</li></ul> &gt; 
    <hr></td></tr></tbody></table> 
<h4>SUMMARY STEPS</h4> 
<ol id="GUID-7380D6BC-B53C-425E-8BD4-224CD83BBE2C__GUID-401E678F-2522-4B31-8D76-6724B20567F2"><li>enable</li><li>configure terminal</li><li>interface type number</li><li>ip dhcp relay information option-insert [none ]</li><li>ip dhcp relay information check-reply [none ]</li><li>ip dhcp relay information policy-action {drop | keep | replace }</li><li>exit</li><li>Repeat Steps 3 through 7 to configure relay agent information settings on different interfaces.</li></ol> 
<h4>DETAILED STEPS</h4> 
<table><thead><tr><th></th><th>Command or Action</th><th>Purpose</th></tr></thead><tbody><tr><td id="GUID-7380D6BC-B53C-425E-8BD4-224CD83BBE2C__STEP_5E871ED672054B37A5830F6591E176DA" style="vertical-align:top;"><strong>Step 1</strong></td><td style="vertical-align:top;"> <p>enable</p> <h5>Example:</h5> <pre><code>
Router&gt; enable</code></pre> </td><td style="vertical-align:top;"> <p>Enables privileged EXEC mode.</p> 
    <ul id="GUID-7380D6BC-B53C-425E-8BD4-224CD83BBE2C__GUID-DAA6A45B-5776-4ED2-8674-CC9989CF7B23"><li id="GUID-7380D6BC-B53C-425E-8BD4-224CD83BBE2C__LI_8ED746EABC274DDA969CD572A586A198"> <p>Enter your password if prompted.</p> </li></ul></td></tr><tr><td id="GUID-7380D6BC-B53C-425E-8BD4-224CD83BBE2C__STEP_F0380BBB4AA0480B85CD83178CD4E5AE" style="vertical-align:top;"><strong>Step 2</strong></td><td style="vertical-align:top;"> <p>configure terminal</p> <h5>Example:</h5> <pre><code>
Router# configure terminal</code></pre> </td><td style="vertical-align:top;"> <p>Enters global configuration mode.</p> </td></tr><tr><td id="GUID-7380D6BC-B53C-425E-8BD4-224CD83BBE2C__STEP_4E33E893D8474929B87E3785979B4D86" style="vertical-align:top;"><strong>Step 3</strong></td><td style="vertical-align:top;"> <p>interface type number</p> <h5>Example:</h5> <pre><code>
Router(config)# interface GigabitEthernet0/0/0</code></pre> </td><td style="vertical-align:top;"> <p>Configures an interface and enters interface configuration mode.</p> </td></tr><tr><td id="GUID-7380D6BC-B53C-425E-8BD4-224CD83BBE2C__STEP_464D1B7E43F24E75B0156B6C21D2C981" style="vertical-align:top;"><strong>Step 4</strong></td><td style="vertical-align:top;"> <p>ip dhcp relay information option-insert [none ]</p> <h5>Example:</h5> <pre><code>
Router(config-if)# ip dhcp relay information option-insert</code></pre> </td><td style="vertical-align:top;"> <p>Enables the system to insert the DHCP relay agent information option (option-82 field) in forwarded BOOTREQUEST messages to a DHCP server.</p> 
    <ul id="GUID-7380D6BC-B53C-425E-8BD4-224CD83BBE2C__GUID-93874625-F65F-4DB7-9510-FC46DEF3B5DA"><li id="GUID-7380D6BC-B53C-425E-8BD4-224CD83BBE2C__LI_B454D8B61C4F4057ACEB861D69AE97F2"> <p>This function is disabled by default. However, if support for the relay agent information option is configured in global configuration mode, but not in interface configuration mode, the interface inherits the global configuration.</p> </li><li id="GUID-7380D6BC-B53C-425E-8BD4-224CD83BBE2C__LI_39A9C7ACBAE349E394EA30AD0F497CAC"> <p>The ip dhcp relay information option-insert none interface configuration command is saved in the running configuration. This command takes precedence over any global relay agent information configuration.</p> </li></ul></td></tr><tr><td id="GUID-7380D6BC-B53C-425E-8BD4-224CD83BBE2C__STEP_0F09106C91F747A0BB80D7837F39D65C" style="vertical-align:top;"><strong>Step 5</strong></td><td style="vertical-align:top;"> <p>ip dhcp relay information check-reply [none ]</p> <h5>Example:</h5> <pre><code>
Router(config-if)# ip dhcp relay information check-reply</code></pre> </td><td style="vertical-align:top;"> <p>Configures a DHCP server to validate the relay information option in forwarded BOOTREPLY messages.</p> 
    <ul id="GUID-7380D6BC-B53C-425E-8BD4-224CD83BBE2C__GUID-FCEE9C15-4835-4F2D-A819-2B0FE7ED0E75"><li id="GUID-7380D6BC-B53C-425E-8BD4-224CD83BBE2C__LI_EDF49C26E5BE48A6AD86316AE381F562"> <p>By default, DHCP checks that the option-82 field in DHCP reply packets it receives from the DHCP server is valid. If an invalid message is received, the relay agent drops it. If a valid message is received, the relay agent removes the option-82 field and forwards the packet. Use the ip dhcp relay information check-reply command to reenable this functionality if it has been disabled.</p> </li><li id="GUID-7380D6BC-B53C-425E-8BD4-224CD83BBE2C__LI_B98DAF4DC17C420E9FDF54F9A9334B9E"> <p>The ip dhcp relay information check-reply none interface configuration command option is saved in the running configuration. This command takes precedence over any global relay agent information configuration.</p> </li></ul></td></tr><tr><td id="GUID-7380D6BC-B53C-425E-8BD4-224CD83BBE2C__STEP_40511113C5C34AF8B4F26B11CDE0D00C" style="vertical-align:top;"><strong>Step 6</strong></td><td style="vertical-align:top;"> <p>ip dhcp relay information policy-action {drop | keep | replace }</p> <h5>Example:</h5> <pre><code>
Router(config-if)# ip dhcp relay information policy-action replace</code></pre> </td><td style="vertical-align:top;"> <p>Configures the information reforwarding policy for a DHCP relay agent (what a relay agent should do if a message already contains relay information).</p> </td></tr><tr><td id="GUID-7380D6BC-B53C-425E-8BD4-224CD83BBE2C__STEP_02FE1853231E44B9B48B619E17EF1B8E" style="vertical-align:top;"><strong>Step 7</strong></td><td style="vertical-align:top;"> <p>exit</p> <h5>Example:</h5> <pre><code>
Router(config-if)# exit</code></pre> </td><td style="vertical-align:top;"> <p>Exits interface configuration mode.</p> </td></tr><tr><td id="GUID-7380D6BC-B53C-425E-8BD4-224CD83BBE2C__STEP_EB2248CA51BB4C018433A82BD3AAA91D" style="vertical-align:top;"><strong>Step 8</strong></td><td style="vertical-align:top;"> <p>Repeat Steps 3 through 7 to configure relay agent information settings on different interfaces.</p> </td><td style="vertical-align:top;"> <p>(Optional)</p> </td></tr></tbody></table> 
<h4 id="GUID-296DEC63-80D0-46C5-A54D-B7E41BBC4F6B__GUID-E33D0CDC-EFF4-4B87-8BAE-4C2C609EBF0F">Configuring the Subscriber Identifier Suboption of the Relay Agent Information Option</h4> 
<p>Perform this task to enable an Internet service provider (ISP) to add a unique identifier to the subscriber-identifier suboption of the relay agent information option.</p> 
<p>The unique identifier enables an ISP to identify a subscriber, to assign specific actions to that subscriber (for example, assignment of host IP address, subnet mask, and domain name system DNS), and to trigger accounting.</p> 
<p>Before the introduction of this feature, if a subscriber moved, each ISP had to be informed of the change and all ISPs had to reconfigure the DHCP settings for the affected customers at the same time. Even if the service was not changed, every move involved administrative changes in the ISP environment. With the introduction of this feature, if a subscriber moves from one Network Access Server to another, there is no need for a change in the configuration on the part of the DHCP server or ISP.</p> 
<h5>Before you begin</h5> 
<p>You should configure the unique identifier for each subscriber.</p> 
<p>The new configurable subscriber-identifier option should be configured on the interface connected to the client. When a subscriber moves from one interface to the other, the interface configuration should also be changed.</p> 
<p>The server should be able to recognize the new suboption.</p> 
<h4>SUMMARY STEPS</h4> 
<ol id="GUID-296DEC63-80D0-46C5-A54D-B7E41BBC4F6B__GUID-CA1134F3-C413-4C45-8C61-5C61604FC210"><li>enable</li><li>configure terminal</li><li>ip dhcp relay information option</li><li>interface type number</li><li>ip dhcp relay information option subscriber-id string</li></ol> 
<h4>DETAILED STEPS</h4> 
<table><thead><tr><th></th><th>Command or Action</th><th>Purpose</th></tr></thead><tbody><tr><td id="GUID-296DEC63-80D0-46C5-A54D-B7E41BBC4F6B__step_7CB24A029539492F9B4A579207754DBE" style="vertical-align:top;"><strong>Step 1</strong></td><td style="vertical-align:top;"> <p>enable</p> <h5>Example:</h5> <pre><code>
Device&gt; enable</code></pre> </td><td style="vertical-align:top;"> <p>Enables privileged EXEC mode.</p> 
    <ul id="GUID-296DEC63-80D0-46C5-A54D-B7E41BBC4F6B__GUID-17107BEF-8169-4115-8C86-21C89660E345"><li id="GUID-296DEC63-80D0-46C5-A54D-B7E41BBC4F6B__li_FFCA808ED0C54E899A127FD8B728884D"> <p>Enter your password if prompted.</p> </li></ul></td></tr><tr><td style="vertical-align:top;"><strong>Step 2</strong></td><td style="vertical-align:top;"> <p>configure terminal</p> <h5>Example:</h5> <pre><code>
Device# configure terminal</code></pre> </td><td style="vertical-align:top;"> <p>Enters global configuration mode.</p> </td></tr><tr><td style="vertical-align:top;"><strong>Step 3</strong></td><td style="vertical-align:top;"> <p>ip dhcp relay information option</p> <h5>Example:</h5> <pre><code>
Device(config)# ip dhcp relay information option</code></pre> </td><td style="vertical-align:top;"> <p>Enables the system to insert the DHCP relay agent information option (option-82 field) in forwarded BOOTREQUEST messages to a DHCP server.</p> 
    <ul id="GUID-296DEC63-80D0-46C5-A54D-B7E41BBC4F6B__GUID-1415DDFA-9CC9-4F10-81B3-DF6FFE390631"><li> <p>This function is disabled by default.</p> </li></ul></td></tr><tr><td style="vertical-align:top;"><strong>Step 4</strong></td><td style="vertical-align:top;"> <p>interface type number</p> <h5>Example:</h5> <pre><code>
Device(config)# interface atm4/0/0</code></pre> </td><td style="vertical-align:top;"> <p>Configures an interface and enters interface configuration mode.</p> </td></tr><tr><td style="vertical-align:top;"><strong>Step 5</strong></td><td style="vertical-align:top;"> <p>ip dhcp relay information option subscriber-id string</p> <h5>Example:</h5> <pre><code>
Device(config-if)# ip dhcp relay information option subscriber-id newsubscriber123</code></pre> </td><td style="vertical-align:top;"> <p>Specifies that a DHCP relay agent add a subscriber identifier suboption to the relay information option.</p> 
    <ul id="GUID-296DEC63-80D0-46C5-A54D-B7E41BBC4F6B__GUID-D6FCC2D7-B17D-45E6-A24C-293A5BD91969"><li> <p>The string argument can be up to a maximum of 50 characters and can be alphanumeric.</p> </li></ul> 
    <table border="0"><tbody><tr><td><strong>Note</strong> </td><td> <p>If more than 50 characters are configured, the string is truncated.</p> </td></tr></tbody></table> 
    <table border="0"><tbody><tr><td><strong>Note</strong> </td><td> <p>The ip dhcp relay information option subscriber-id command is disabled by default to ensure backward capability.</p> </td></tr></tbody></table></td></tr></tbody></table> 
<h4 id="GUID-308C632E-CA79-484A-98CF-318ECCEC9659__GUID-23E6F974-A0EA-4C12-8F43-1C26ACD45467">Configuring DHCP Relay Agent Support for MPLS VPNs</h4> 
<p>Perform this task to configure DHCP relay agent support for MPLS VPNs.</p> 
<h5>Before you begin</h5> 
<p>Before configuring DHCP relay support for MPLS VPNs, you must configure standard MPLS VPNs.</p> 
<h4>SUMMARY STEPS</h4> 
<ol id="GUID-308C632E-CA79-484A-98CF-318ECCEC9659__GUID-D396D00D-89AC-4906-8D53-6E342586D34F"><li>enable</li><li>configure terminal</li><li>ip dhcp relay information option vpn</li><li>interface type number</li><li>ip helper-address vrf name [global ] address</li></ol> 
<h4>DETAILED STEPS</h4> 
<table><thead><tr><th></th><th>Command or Action</th><th>Purpose</th></tr></thead><tbody><tr><td id="GUID-308C632E-CA79-484A-98CF-318ECCEC9659__step_4613E8F9DE2C45FEB3243B919738EC73" style="vertical-align:top;"><strong>Step 1</strong></td><td style="vertical-align:top;"> <p>enable</p> <h5>Example:</h5> <pre><code>
Device&gt; enable</code></pre> </td><td style="vertical-align:top;"> <p>Enables privileged EXEC mode.</p> 
    <ul id="GUID-308C632E-CA79-484A-98CF-318ECCEC9659__GUID-36C45589-5CC6-4182-B305-7FEE93C6CCA2"><li id="GUID-308C632E-CA79-484A-98CF-318ECCEC9659__li_3C44E2A132FD4C49A24837D7164920BC"> <p>Enter your password if prompted.</p> </li></ul></td></tr><tr><td style="vertical-align:top;"><strong>Step 2</strong></td><td style="vertical-align:top;"> <p>configure terminal</p> <h5>Example:</h5> <pre><code>
Device# configure terminal</code></pre> </td><td style="vertical-align:top;"> <p>Enters global configuration mode.</p> </td></tr><tr><td style="vertical-align:top;"><strong>Step 3</strong></td><td style="vertical-align:top;"> <p>ip dhcp relay information option vpn</p> <h5>Example:</h5> <pre><code>
Device(config)# ip dhcp relay information option vpn</code></pre> </td><td style="vertical-align:top;"> <p>Enables the system to insert VPN suboptions into the DHCP relay agent information option in forwarded BOOTREQUEST messages to a DHCP server and sets the gateway address to the outgoing interface toward the DHCP server.</p> 
    <ul id="GUID-308C632E-CA79-484A-98CF-318ECCEC9659__GUID-C45E75F3-5AA2-451C-A580-2B5740875A20"><li> <p>The VPN suboptions are also added to the BOOTP broadcast packets when the command is configured.</p> </li></ul></td></tr><tr><td style="vertical-align:top;"><strong>Step 4</strong></td><td style="vertical-align:top;"> <p>interface type number</p> <h5>Example:</h5> <pre><code>
Device(config)# interface GigabitEthernet0/0/0</code></pre> </td><td style="vertical-align:top;"> <p>Configures an interface and enters interface configuration mode.</p> </td></tr><tr><td style="vertical-align:top;"><strong>Step 5</strong></td><td style="vertical-align:top;"> <p>ip helper-address vrf name [global ] address</p> <h5>Example:</h5> <pre><code>
Device(config-if)# ip helper-address vrf blue 172.27.180.232</code></pre> </td><td style="vertical-align:top;"> <p>Forwards UDP broadcasts, including BOOTP, received on an interface.</p> 
    <ul id="GUID-308C632E-CA79-484A-98CF-318ECCEC9659__GUID-5AC9F7C9-7A4D-407A-BA6B-9C19AF2F55F7"><li> <p>If the DHCP server resides in a different VPN or global space that is different from the VPN, then the vrf name or global options allow you to specify the name of the VRF or global space in which the DHCP server resides.</p> </li></ul></td></tr></tbody></table> 
<h4 id="GUID-AA420F95-DE5F-4996-B1E8-164A11D08698__GUID-C787FC92-8FAE-4E6B-A96E-F9C7B7881EEC">Setting the Gateway Address of the DHCP Broadcast to a Secondary Address Using Smart Relay Agent Forwarding</h4> 
<p>You only need to configure helper addresses on the interface where the UDP broadcasts that you want to forward to the DHCP server are being received. You only need to configure the ip dhcp smart-relay command if you have secondary addresses on that interface and you want the device to step through each IP network when forwarding DHCP requests. If smart relay agent forwarding is not configured, all requests are forwarded using the primary IP address on the interface.</p> 
<p>If the ip dhcp smart-relay command is configured, the relay agent counts the number of times that the client retries sending a request to the DHCP server when there is no DHCPOFFER message from the DHCP server. After three retries, the relay agent sets the gateway address to the secondary address. If the DHCP server still does not respond after three more retries, then the next secondary address is used as the gateway address.</p> 
<p>This functionality is useful when the DHCP server cannot be configured to use secondary pools.</p> 
<h4>SUMMARY STEPS</h4> 
<ol id="GUID-AA420F95-DE5F-4996-B1E8-164A11D08698__GUID-2226D088-DDD2-422B-9FFA-69E64DE0A92E"><li>enable</li><li>configure terminal</li><li>ip dhcp smart-relay</li><li>exit</li></ol> 
<h4>DETAILED STEPS</h4> 
<table><thead><tr><th></th><th>Command or Action</th><th>Purpose</th></tr></thead><tbody><tr><td id="GUID-AA420F95-DE5F-4996-B1E8-164A11D08698__STEP_A3F2F03ECDDF4AE9A625AE7E78775659" style="vertical-align:top;"><strong>Step 1</strong></td><td style="vertical-align:top;"> <p>enable</p> <h5>Example:</h5> <pre><code>
Device&gt; enable</code></pre> </td><td style="vertical-align:top;"> <p>Enables privileged EXEC mode.</p> 
    <ul id="GUID-AA420F95-DE5F-4996-B1E8-164A11D08698__GUID-0202BC97-968F-41A4-BA43-2D3478B29E13"><li id="GUID-AA420F95-DE5F-4996-B1E8-164A11D08698__LI_C282F156D2DE4EEC88751FA0D88EDCD0"> <p>Enter your password if prompted.</p> </li></ul></td></tr><tr><td id="GUID-AA420F95-DE5F-4996-B1E8-164A11D08698__STEP_3027749FD6644EC6B8ED03781E378240" style="vertical-align:top;"><strong>Step 2</strong></td><td style="vertical-align:top;"> <p>configure terminal</p> <h5>Example:</h5> <pre><code>
Device# configure terminal</code></pre> </td><td style="vertical-align:top;"> <p>Enters global configuration mode.</p> </td></tr><tr><td id="GUID-AA420F95-DE5F-4996-B1E8-164A11D08698__STEP_39F7F82D5D7640D4BE5D5F39F6F23528" style="vertical-align:top;"><strong>Step 3</strong></td><td style="vertical-align:top;"> <p>ip dhcp smart-relay</p> <h5>Example:</h5> <pre><code>
Device(config)# ip dhcp smart-relay</code></pre> </td><td style="vertical-align:top;"> <p>Allows the DHCP relay agent to switch the gateway address (giaddr field of a DHCP packet) to a secondary address when there is no DHCPOFFER message from a DHCP server.</p> </td></tr><tr><td id="GUID-AA420F95-DE5F-4996-B1E8-164A11D08698__STEP_8622FD4AAF8E409F963512A0DA0AA27F" style="vertical-align:top;"><strong>Step 4</strong></td><td style="vertical-align:top;"> <p>exit</p> <h5>Example:</h5> <pre><code>
Device(config)# exit</code></pre> </td><td style="vertical-align:top;"> <p>Returns to privileged EXEC mode.</p> </td></tr></tbody></table> 
<h4 id="GUID-55A2BB45-2AC2-4F48-A51C-9D9D2C2A12AB__GUID-A4B3F4DE-2151-405D-B331-70B6592856E6">Configuring Relay Agent Information Option Encapsulation Support</h4> 
<p>Perform this task to enable support for the encapsulation of the DHCP relay agent information option (option 82).</p> 
<h4>SUMMARY STEPS</h4> 
<ol id="GUID-55A2BB45-2AC2-4F48-A51C-9D9D2C2A12AB__GUID-D9ED2B8F-0583-4F04-B469-6D0975995086"><li>enable</li><li>configure terminal</li><li>ip dhcp relay information option</li><li>ip dhcp relay information option vpn</li><li>ip dhcp relay information policy encapsulate</li><li>interface type number</li><li>ip dhcp relay information policy-action encapsulate</li></ol> 
<h4>DETAILED STEPS</h4> 
<table><thead><tr><th></th><th>Command or Action</th><th>Purpose</th></tr></thead><tbody><tr><td style="vertical-align:top;"><strong>Step 1</strong></td><td style="vertical-align:top;"> <p>enable</p> <h5>Example:</h5> <pre><code>
Router&gt; enable</code></pre> </td><td style="vertical-align:top;"> <p>Enables privileged EXEC mode.</p> 
    <ul id="GUID-55A2BB45-2AC2-4F48-A51C-9D9D2C2A12AB__GUID-1768A75D-7EDC-419B-9FF6-E3EB1E5419C6"><li> <p>Enter your password if prompted.</p> </li></ul></td></tr><tr><td style="vertical-align:top;"><strong>Step 2</strong></td><td style="vertical-align:top;"> <p>configure terminal</p> <h5>Example:</h5> <pre><code>
Router# configure terminal</code></pre> </td><td style="vertical-align:top;"> <p>Enters global configuration mode.</p> </td></tr><tr><td style="vertical-align:top;"><strong>Step 3</strong></td><td style="vertical-align:top;"> <p>ip dhcp relay information option</p> <h5>Example:</h5> <pre><code>
Router(config)# ip dhcp relay information option</code></pre> </td><td style="vertical-align:top;"> <p>Enables the system to insert the DHCP relay agent information option (option-82 field) in forwarded BOOTREQUEST messages to a DHCP server.</p> 
    <ul id="GUID-55A2BB45-2AC2-4F48-A51C-9D9D2C2A12AB__GUID-78CCE52F-3374-4F6B-8985-CA813A051A9B"><li> <p>This function is disabled by default.</p> </li></ul></td></tr><tr><td style="vertical-align:top;"><strong>Step 4</strong></td><td style="vertical-align:top;"> <p>ip dhcp relay information option vpn</p> <h5>Example:</h5> <pre><code>
Router(config)# ip dhcp relay information option vpn</code></pre> </td><td style="vertical-align:top;"> <p>(Optional) Enables the system to insert VPN suboptions into the DHCP relay agent information option in forwarded BOOTREQUEST messages to a DHCP server and sets the gateway address to the outgoing interface toward the DHCP server.</p> 
    <ul id="GUID-55A2BB45-2AC2-4F48-A51C-9D9D2C2A12AB__GUID-E785624E-44D5-4BE1-B93C-00C5F8776AE6"><li> <p>The VPN suboptions are also added to the BOOTP broadcast packets when the command is configured.</p> </li></ul></td></tr><tr><td style="vertical-align:top;"><strong>Step 5</strong></td><td style="vertical-align:top;"> <p>ip dhcp relay information policy encapsulate</p> <h5>Example:</h5> <pre><code>
Router(config)# ip dhcp relay information policy encapsulate
</code></pre> </td><td style="vertical-align:top;"> <p>Enables the system to encapsulate the DHCP relay agent information option (option-82 field) received from a prior relay agent in forwarded BOOTREQUEST messages to a DHCP server.</p> 
    <ul id="GUID-55A2BB45-2AC2-4F48-A51C-9D9D2C2A12AB__GUID-C8C7BB6C-FD06-41A5-9F61-26BA2AEABB62"><li> <p>Option 82 information from both relay agents will be forwarded to the DHCP server.</p> </li></ul></td></tr><tr><td style="vertical-align:top;"><strong>Step 6</strong></td><td style="vertical-align:top;"> <p>interface type number</p> <h5>Example:</h5> <pre><code>
Router(config)# interface FastEthernet0/0</code></pre> </td><td style="vertical-align:top;"> <p>(Optional) Configures an interface and enters interface configuration mode.</p> 
    <ul id="GUID-55A2BB45-2AC2-4F48-A51C-9D9D2C2A12AB__GUID-7953896C-6905-438B-85E9-05694AA53AF6"><li> <p>If you configure the ip dhcp relay information command in global configuration mode, there is no need to configure the command in interface configuration mode unless you want a different configuration to apply on specific interfaces.</p> </li></ul></td></tr><tr><td style="vertical-align:top;"><strong>Step 7</strong></td><td style="vertical-align:top;"> <p>ip dhcp relay information policy-action encapsulate</p> <h5>Example:</h5> <pre><code>
Router(config-if)# ip dhcp relay information policy-action encapsulate
</code></pre> </td><td style="vertical-align:top;"> <p>(Optional) Enables the system to encapsulate the DHCP relay agent information option (option-82 field) received on an interface from a prior relay agent in forwarded BOOTREQUEST messages to a DHCP server on an interface.</p> 
    <ul id="GUID-55A2BB45-2AC2-4F48-A51C-9D9D2C2A12AB__GUID-75437079-12FF-4F80-8FD9-FE1C1A2325DC"><li> <p>This function is disabled by default. This command has precedence over any global configuration. However, if support for the relay agent information option encapsulation support is configured in global configuration mode, but not in interface configuration mode, the interface inherits the global configuration.</p> </li></ul></td></tr></tbody></table> 
<h4 id="GUID-6E1DD0C3-20A2-42BB-B6D0-8EDE987B9B10__GUID-2F46CDAD-C660-48DB-BA2B-C90A8308BB9C">Troubleshooting the DHCP Relay Agent</h4> 
<p>Perform this task to troubleshoot the DHCP relay agent.</p> 
<p>The show ip route dhcp command is useful to help you understand any problems with the DHCP relay agent adding routes to clients from unnumbered interfaces. All routes added to the routing table by the DHCP server and relay agent are displayed.</p> 
<h4>SUMMARY STEPS</h4> 
<ol id="GUID-6E1DD0C3-20A2-42BB-B6D0-8EDE987B9B10__GUID-C33F2412-761F-41C7-9212-12BD611A272B"><li>enable</li><li>show ip route dhcp</li><li>show ip route dhcp ip-address</li><li>show ip route vrf vrf-name dhcp</li><li>clear ip route [vrf vrf-name ] dhcp [ip-address ]</li></ol> 
<h4>DETAILED STEPS</h4> 
<table><thead><tr><th></th><th>Command or Action</th><th>Purpose</th></tr></thead><tbody><tr><td id="GUID-6E1DD0C3-20A2-42BB-B6D0-8EDE987B9B10__step_AD323DC548CB4BCF8B97A13E387DB017" style="vertical-align:top;"><strong>Step 1</strong></td><td style="vertical-align:top;"> <p>enable</p> <h5>Example:</h5> <pre><code>
Device&gt; enable</code></pre> </td><td style="vertical-align:top;"> <p>Enables privileged EXEC mode.</p> 
    <ul id="GUID-6E1DD0C3-20A2-42BB-B6D0-8EDE987B9B10__GUID-3E05EAB4-4535-4D48-9F63-FCAC65A14296"><li id="GUID-6E1DD0C3-20A2-42BB-B6D0-8EDE987B9B10__li_15F2440635024FD695E6CBE1A9E0D1ED"> <p>Enter your password if prompted.</p> </li></ul></td></tr><tr><td id="GUID-6E1DD0C3-20A2-42BB-B6D0-8EDE987B9B10__step_27E38BF7C9894699ADD50632C87A7BAC" style="vertical-align:top;"><strong>Step 2</strong></td><td style="vertical-align:top;"> <p>show ip route dhcp</p> <h5>Example:</h5> <pre><code>
Device# show ip route dhcp</code></pre> </td><td style="vertical-align:top;"> <p>Displays all routes added by the DHCP server and relay agent.</p> </td></tr><tr><td style="vertical-align:top;"><strong>Step 3</strong></td><td style="vertical-align:top;"> <p>show ip route dhcp ip-address</p> <h5>Example:</h5> <pre><code>
Device# show ip route dhcp 172.16.1.3</code></pre> </td><td style="vertical-align:top;"> <p>Displays all routes added by the DHCP server and relay agent associated with an IP address.</p> </td></tr><tr><td style="vertical-align:top;"><strong>Step 4</strong></td><td style="vertical-align:top;"> <p>show ip route vrf vrf-name dhcp</p> <h5>Example:</h5> <pre><code>
Device# show ip route vrf red dhcp </code></pre> </td><td style="vertical-align:top;"> <p>Displays all routes added by the DHCP server and relay agent associated with the named VRF.</p> </td></tr><tr><td style="vertical-align:top;"><strong>Step 5</strong></td><td style="vertical-align:top;"> <p>clear ip route [vrf vrf-name ] dhcp [ip-address ]</p> <h5>Example:</h5> <pre><code>
Device# clear ip route dhcp</code></pre> </td><td style="vertical-align:top;"> <p>Removes routes from the routing table added by the DHCP server and relay agent for the DHCP clients on unnumbered interfaces.</p> </td></tr></tbody></table> 
<h3 id="GUID-7F00A9D8-3BB7-4339-AC17-0985DA568C36__GUID-6F1DF032-3AAF-4BC2-8E7F-6F1803C837A2">Configuration Examples for the DHCP Relay Agent</h3> 
<ul><li><a href="https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/ipaddr_dhcp/configuration/xe-16-12/dhcp-xe-16-12-book/dhcp-relay-agent-xe.html#GUID-E2F71A8D-69D9-4DC8-9145-A7E1444BCD6A" rel="nofollow" title="Example Configuring the DHCP Relay Agent and Relay Agent Information Option Support">Example Configuring the DHCP Relay Agent and Relay Agent Information Option Support</a></li><li><a href="https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/ipaddr_dhcp/configuration/xe-16-12/dhcp-xe-16-12-book/dhcp-relay-agent-xe.html#GUID-8D293137-94E3-44A5-8E9E-0D98546C4C82" rel="nofollow" title="Example Configuring the DHCP Relay Agent and Relay Agent Information Option Support per Interface">Example Configuring the DHCP Relay Agent and Relay Agent Information Option Support per Interface</a></li><li><a href="https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/ipaddr_dhcp/configuration/xe-16-12/dhcp-xe-16-12-book/dhcp-relay-agent-xe.html#GUID-3DA452BA-4389-45FC-B5F8-A715DA8B2781" rel="nofollow" title="Example Configuring the Subscriber Identifier Suboption">Example Configuring the Subscriber Identifier Suboption</a></li><li><a href="https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/ipaddr_dhcp/configuration/xe-16-12/dhcp-xe-16-12-book/dhcp-relay-agent-xe.html#GUID-958FDEA5-7A53-4E1A-9937-839B8D2A7B33" rel="nofollow" title="Example Configuring DHCP Relay Agent Support for MPLS VPNs">Example Configuring DHCP Relay Agent Support for MPLS VPNs</a></li><li><a href="https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/ipaddr_dhcp/configuration/xe-16-12/dhcp-xe-16-12-book/dhcp-relay-agent-xe.html#GUID-07CEF5CE-81D2-4ADD-9BDB-656423E9D250" rel="nofollow" title="Example Configuring DHCP Smart Relay Agent Forwarding">Example Configuring DHCP Smart Relay Agent Forwarding</a></li></ul> 
<h4 id="GUID-E2F71A8D-69D9-4DC8-9145-A7E1444BCD6A__GUID-16711199-B91E-4526-BF78-177D0023993C">Example Configuring the DHCP Relay Agent and Relay Agent Information Option Support</h4> 
<p>The following example shows how to enable the DHCP server, the relay agent, and the insertion and removal of the DHCP relay information option (option 82). Note that the Cisco IOS XE DHCP server is enabled by default. In this example, the DHCP server was disabled:</p> 
<pre><code>
!reenables the DHCP server
service dhcp
ip dhcp relay information option
!
interface GigabitEthernet 0/0/0
 ip address 192.168.100.1 255.255.255.0
 ip helper-address 10.55.11.3</code></pre> 
<h4 id="GUID-8D293137-94E3-44A5-8E9E-0D98546C4C82__GUID-518E8CF7-DCA3-4144-840D-398EB857481C">Example Configuring the DHCP Relay Agent and Relay Agent Information Option Support per Interface</h4> 
<p>The following example shows that for subscribers being serviced by the same aggregation router, the relay agent information option needs to be processed differently for Asynchronous Transfer Mode (ATM) subscribers than for Gigabit Ethernet digital subscribers. For ATM subscribers, the relay agent information option is configured to be removed from the packet by the relay agent before forwarding to the client. For Gigabit Ethernet subscribers, the connected device provides the relay agent information option, and it is configured to remain in the packet and be forwarded to the client.</p> 
<pre><code>
ip dhcp relay information trust-all
interface Loopback0
 ip address 10.16.0.1 255.255.255.0
!
interface ATM 3/0/0
 no ip address
!
interface ATM 3/0/0
 ip helper-address 10.16.1.2
 ip unnumbered loopback0
 ip dhcp relay information option-insert
!
interface Loopback1
 ip address 10.18.0.1 255.255.255.0
!
interface GigabitEthernet0/0/0
 no ip address
!
interface GigabitEthernet 0/0/1
 encap dot1q 123
 ip unnumbered loopback1
 ip helper-address 10.18.1.2
 ip dhcp relay information policy-action keep</code></pre> 
<h4 id="GUID-3DA452BA-4389-45FC-B5F8-A715DA8B2781__GUID-DE775BB4-5397-4F39-883B-9E87D27A50A7">Example Configuring the Subscriber Identifier Suboption</h4> 
<p>The following example shows how to add a unique identifier to the subscriber-identifier suboption of the relay agent information option.</p> 
<pre><code>
ip dhcp relay information option
!
interface Loopback0 
 ip address 10.1.1.129 255.255.255.192 
!
interface ATM 4/0/0 
 no ip address 
!
interface ATM 4/0/1 point-to-point
 ip helper-address 10.16.1.2
 ip unnumbered Loopback0
 ip dhcp relay information option subscriber-id newperson123
 atm route-bridged ip
 pvc 88/800
 encapsulation aal5snap</code></pre> 
<h4 id="GUID-958FDEA5-7A53-4E1A-9937-839B8D2A7B33__GUID-A8D84658-8F59-4DCD-BD12-31003B892FCA">Example Configuring DHCP Relay Agent Support for MPLS VPNs</h4> 
<p>In the following example, the DHCP relay agent receives a DHCP request on Gigabit Ethernet interface 0/0/0 and sends the request to the DHCP server located at IP helper address 10.44.23.7, which is associated with the VRF named red:</p> 
<pre><code>
ip dhcp relay information option vpn
!
interface GigabitEthernet 0/0/0
 ip helper-address vrf red 10.44.23.7
!</code></pre> 
<h4 id="GUID-07CEF5CE-81D2-4ADD-9BDB-656423E9D250__GUID-F102B99D-7DE0-4A46-BF9E-63BD7760ACC4">Example Configuring DHCP Smart Relay Agent Forwarding</h4> 
<p>In the following example, the router will forward the DHCP broadcast received on Gigabit Ethernet interface 0/0 to the DHCP server (10.55.11.3), inserting 192.168.100.1 in the giaddr field of the DHCP packet. If the DHCP server has a scope or pool configured for the 192.168.100.0/24 network, it will respond; otherwise it will not respond.</p> 
<p>Because the ip dhcp smart-relay global configuration command is configured, if the router sends three requests using 192.168.100.1 in the giaddr field, and doesn't get a response, it will move on and start using 172.16.31.254 in the giaddr field instead. Without the smart relay functionality, the route only uses 192.168.100.1 in the giaddr field.</p> 
<pre><code>
ip dhcp smart-relay
!
interface GigabitEthernet0/0/0
 ip address 192.168.100.1 255.255.255.0
 ip address 172.16.31.254 255.255.255.0
 ip helper-address 10.55.11.3
!</code></pre> 
<h3 id="GUID-E47966E4-BC91-4148-8729-542C3E6A934A__GUID-B11AB8EB-6697-40D5-B7CD-5D34864A0AB7">Additional References</h3> 
<h4>Related Documents</h4> 
<table border="1" id="GUID-E47966E4-BC91-4148-8729-542C3E6A934A__GUID-7FA2DDA2-B564-4E5C-A5E4-B77ECB580347"><caption></caption><thead><tr><th id="GUID-E47966E4-BC91-4148-8729-542C3E6A934A__GUID-7FA2DDA2-B564-4E5C-A5E4-B77ECB580347__entry__1"> <p>Related Topic</p> </th><th id="GUID-E47966E4-BC91-4148-8729-542C3E6A934A__GUID-7FA2DDA2-B564-4E5C-A5E4-B77ECB580347__entry__2"> <p>Document Title</p> </th></tr></thead><tbody><tr><td> <p>Cisco IOS commands</p> </td><td> <p><a href="http://www.cisco.com/en/US/docs/ios/mcl/allreleasemcl/all_book.html" rel="nofollow" title="Cisco IOS Master Commands List, All Releases">Cisco IOS Master Commands List, All Releases</a></p> </td></tr><tr><td> <p>DHCP commands: complete command syntax, command modes, command history, defaults, usage guidelines, and examples</p> </td><td> <p><em>Cisco IOS IP Addressing Services Command Reference</em></p> </td></tr><tr><td> <p>DHCP conceptual information</p> </td><td> <p>“DHCP Overview” module</p> </td></tr><tr><td> <p>DHCP server configuration</p> </td><td> <p>“Configuring the Cisco IOS XE DHCP Server” module</p> </td></tr><tr><td> <p>DHCP client configuration</p> </td><td> <p>“Configuring the Cisco IOS XE DHCP Client” module</p> </td></tr><tr><td> <p>DHCP server on-demand address pool manager configuration</p> </td><td> <p>“Configuring the DHCP Server On-Demand Address Pool Manager” module</p> </td></tr><tr><td> <p>DHCP advanced features</p> </td><td> <p>“Configuring DHCP Services for Accounting and Security” module</p> </td></tr></tbody></table> 
<h4>Standards</h4> 
<table border="1" id="GUID-E47966E4-BC91-4148-8729-542C3E6A934A__GUID-BE2DBEDF-FD83-4E0A-9956-C6CA9EC6B727"><caption></caption><thead><tr><th id="GUID-E47966E4-BC91-4148-8729-542C3E6A934A__GUID-BE2DBEDF-FD83-4E0A-9956-C6CA9EC6B727__entry__1"> <p>Standards</p> </th><th id="GUID-E47966E4-BC91-4148-8729-542C3E6A934A__GUID-BE2DBEDF-FD83-4E0A-9956-C6CA9EC6B727__entry__2"> <p>Title</p> </th></tr></thead><tbody><tr><td> <p>No new or modified standards are supported by this functionality.</p> </td><td> <p>--</p> </td></tr></tbody></table> 
<h4>MIBs</h4> 
<table border="1" id="GUID-E47966E4-BC91-4148-8729-542C3E6A934A__GUID-E1E8995D-F9A1-4A44-8333-CAD8AB1F5E64"><caption></caption><thead><tr><th id="GUID-E47966E4-BC91-4148-8729-542C3E6A934A__GUID-E1E8995D-F9A1-4A44-8333-CAD8AB1F5E64__entry__1"> <p>MIBs</p> </th><th id="GUID-E47966E4-BC91-4148-8729-542C3E6A934A__GUID-E1E8995D-F9A1-4A44-8333-CAD8AB1F5E64__entry__2"> <p>MIBs Link</p> </th></tr></thead><tbody><tr><td> <p>No new or modified MIBs are supported, and support for existing MIBs has not been modified.</p> </td><td> <p>To locate and download MIBs for selected platforms, Cisco software releases, and feature sets, use Cisco MIB Locator found at the following URL:</p> <p><a href="http://www.cisco.com/go/mibs" rel="nofollow" title="http://www.cisco.com/go/mibs">http://www.cisco.com/go/mibs</a></p> </td></tr></tbody></table> 
<h4>RFCs</h4> 
<table border="1" id="GUID-E47966E4-BC91-4148-8729-542C3E6A934A__GUID-C180691C-2013-4955-BB38-6B092B7C614A"><caption></caption><thead><tr><th id="GUID-E47966E4-BC91-4148-8729-542C3E6A934A__GUID-C180691C-2013-4955-BB38-6B092B7C614A__entry__1"> <p>RFCs</p> </th><th id="GUID-E47966E4-BC91-4148-8729-542C3E6A934A__GUID-C180691C-2013-4955-BB38-6B092B7C614A__entry__2"> <p>Title</p> </th></tr></thead><tbody><tr><td> <p>RFC 951</p> </td><td> <p><em>Bootstrap Protocol (BOOTP)</em></p> </td></tr><tr><td> <p>RFC 1542</p> </td><td> <p><em>Clarifications and Extensions for the Bootstrap Protocol</em></p> </td></tr><tr><td> <p>RFC 2131</p> </td><td> <p><em>Dynamic Host Configuration Protocol</em></p> </td></tr><tr><td> <p>RFC 2685</p> </td><td> <p><em>Virtual Private Networks Identifier</em></p> </td></tr><tr><td> <p>RFC 3046</p> </td><td> <p><em>DHCP Relay Information Option</em></p> </td></tr></tbody></table> 
<h3 id="GUID-F39CC45E-3499-43EA-A56E-C422E43B8FDB__GUID-C0BB6749-ACFD-437D-ADEC-69440EB46ABD">Technical Assistance</h3> 
<table border="1" id="GUID-F39CC45E-3499-43EA-A56E-C422E43B8FDB__GUID-2ADD2428-392B-462E-99B2-EC3D462F7AD0"><caption></caption><thead><tr><th id="GUID-F39CC45E-3499-43EA-A56E-C422E43B8FDB__GUID-2ADD2428-392B-462E-99B2-EC3D462F7AD0__entry__1"> <p>Description</p> </th><th id="GUID-F39CC45E-3499-43EA-A56E-C422E43B8FDB__GUID-2ADD2428-392B-462E-99B2-EC3D462F7AD0__entry__2"> <p>Link</p> </th></tr></thead><tbody><tr><td> <p>The Cisco Support website provides extensive online resources, including documentation and tools for troubleshooting and resolving technical issues with Cisco products and technologies.</p> <p>To receive security and technical information about your products, you can subscribe to various services, such as the Product Alert Tool (accessed from Field Notices), the Cisco Technical Services Newsletter, and Really Simple Syndication (RSS) Feeds.</p> <p>Access to most tools on the Cisco Support website requires a Cisco.com user ID and password.</p> </td><td> <p><a href="http://www.cisco.com/cisco/web/support/index.html" rel="nofollow" title="Support - Cisco Support and Downloads – Documentation, Tools, Cases - Cisco">Support - Cisco Support and Downloads – Documentation, Tools, Cases - Cisco</a></p> </td></tr></tbody></table> 
<h3 id="GUID-CB460F67-23A4-45B5-A35D-E7DAE92AF4D4__GUID-2CF9C71C-DF24-4717-9288-A73777030258">Feature Information for the Cisco IOS XE DHCP Relay Agent</h3> 
<p>The following table provides release information about the feature or features described in this module. This table lists only the software release that introduced support for a given feature in a given software release train. Unless noted otherwise, subsequent releases of that software release train also support that feature.</p> 
<p>Use Cisco Feature Navigator to find information about platform support and Cisco software image support. To access Cisco Feature Navigator, go to <a href="http://www.cisco.com/go/cfn" rel="nofollow" title="www.cisco.com/go/cfn">www.cisco.com/go/cfn</a>. An account on Cisco.com is not required.</p> 
<table border="1" id="GUID-CB460F67-23A4-45B5-A35D-E7DAE92AF4D4__GUID-365DB7B6-1C5E-4E05-8F60-F8FFA80A11249"><caption>
   Table 1. Feature Information for the Cisco IOS XE DHCP Relay Agent 
 </caption><thead><tr><th id="GUID-CB460F67-23A4-45B5-A35D-E7DAE92AF4D4__GUID-365DB7B6-1C5E-4E05-8F60-F8FFA80A11249__entry__1"> <p>Feature Name</p> </th><th id="GUID-CB460F67-23A4-45B5-A35D-E7DAE92AF4D4__GUID-365DB7B6-1C5E-4E05-8F60-F8FFA80A11249__entry__2"> <p>Releases</p> </th><th id="GUID-CB460F67-23A4-45B5-A35D-E7DAE92AF4D4__GUID-365DB7B6-1C5E-4E05-8F60-F8FFA80A11249__entry__3"> <p>Feature Configuration Information</p> </th></tr></thead><tbody><tr><td> <p>DHCP Relay Option 82 per Interface Support</p> </td><td> <p>Cisco IOS XE Release 2.1</p> <p>Cisco IOS XE Release 3.9S</p> </td><td> <p>This feature enables support for the DHCP relay agent information option (option 82) on a per interface basis. The interface configuration allows different DHCP servers, with different DHCP option 82 requirements to be reached from one Cisco router.</p> <p>The following commands were introduced by this feature: ip dhcp relay information check-reply , ip dhcp relay information option-insert , ip dhcp relay information policy-action .</p> </td></tr><tr><td> <p>DHCP Subscriber Identifier Suboption of Option 82</p> </td><td> <p>Cisco IOS XE Release 2.1</p> </td><td> <p>This feature enables an ISP to add a unique identifier to the subscriber-identifier suboption of the relay agent information option.</p> <p>The following command was introduced by this feature: ip dhcp relay information option subscriber-id .</p> </td></tr><tr><td> <p>DHCP Relay MPLS VPN Support</p> </td><td> <p>Cisco IOS XE Release 2.1</p> <p>Cisco IOS XE Release 3.9S</p> </td><td> <p>DHCP relay support for MPLS VPNs enables a network administrator to conserve address space by allowing overlapping addresses. The relay agent can support multiple clients on different VPNs, and many of these clients from different VPNs can share the same IP address.</p> <p>The following commands were modified by this feature: ip dhcp relay information option , ip helper address .</p> </td></tr><tr><td> <p>DHCP Relay Agent Support for Unnumbered Interfaces</p> </td><td> <p>Cisco IOS XE Release 2.1</p> <p>Cisco IOS XE Release 3.9S</p> </td><td> <p>The Cisco IOS XE DHCP relay agent supports the use of unnumbered interfaces.</p> </td></tr><tr><td> <p>DHCP Relay Option 82 Encapsulation</p> </td><td> <p>Cisco IOS XE Release 3.1S</p> </td><td> <p>This feature allows a second DHCP relay agent to encapsulate the relay agent information option (option 82) from a prior relay agent, add its own option 82, and forward the packet to the DHCP server. The DHCP server can use the VPN information from the second relay agent along with the option 82 information from the first relay agent to send correct address assignments and other configuration parameters for the client devices based on the VRF, option 60, and encapsulated option 82.</p> <p>The following commands were added or modified by this feature: ip dhcp relay information policy , ip dhcp relay information policy-action .</p> </td></tr></tbody></table> 
<h3 id="GUID-84FAE181-C0A1-4091-8D46-59057DC9488F__GUID-70884D6A-10FB-487A-8DCF-EDD60A3EBE60">Glossary</h3> 
<p>client --A host trying to configure its interface (obtain an IP address) using DHCP or BOOTP protocols.</p> 
<p>DHCP --Dynamic Host Configuration Protocol.</p> 
<p>giaddr --Gateway IP address. The giaddr field of the DHCP message provides the DHCP server with information about the IP address subnet on which the client is to reside. It also provides the DHCP server with an IP address where the response messages are to be sent.</p> 
<p>MPLS --Multiprotocol Label Switching. Emerging industry standard upon which tag switching is based.</p> 
<p>relay agent --A device that forwards DHCP and BOOTP messages between a server and a client on different subnets.</p> 
<p>server --DHCP or BOOTP server.</p> 
<p>VPN --Virtual Private Network. Enables IP traffic to use tunneling to travel securely over a public TCP/IP network.</p> 
<p>VRF --VPN routing and forwarding instance. A VRF consists of an IP routing table, a derived forwarding table, a set of interfaces that use the forwarding table, and a set of rules and routing protocols that determine what goes into the forwarding table. In general, a VRF includes the routing information that defines a customer VPN site that is attached to a PE device. Each VPN instantiated on the PE device has its own VRF.</p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b6e943c7aec89c2b0f06898ecfe53084/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">防止内存泄漏的神兵利器 — 智能指针</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1b3cc6ac3dbdc56825499873e37f426f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">AI作画提示词（Prompts）工程：指南与实践技巧</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>