<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>[安洵杯 2019]crackMe - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/226da7eab950e1fe963f98f7c2389996/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="[安洵杯 2019]crackMe">
  <meta property="og:description" content="大佬wp:
[安洵杯 2019]crackMe - Moominn - 博客园 (cnblogs.com)
首先肯定是运行
(运行这个耗费了我好久,一直说我缺失什么文件,我giao,最后是问学长要的dll文件)
输入类型,然后提醒我hook
没搞懂,先分析吧
F12找到right,reverse--从结果来推
cmp str2= 1UTAOIkpyOSWGv/mOYFY4R!!
上调找到这里
再换表 对base64的表进行了移位处理
这里我也没看懂,看wp才知道,这里是说对不足的补全为!(之前是补全为=)
输入字符两两swap SM4 base64表大小写转换 这是我们逆向推出来的流程
我们现在重新来理一下
首先是base64被换表了----输入字符移动----输入字符swap---SM4加密---base64表大小写转换---base64加密为str2
import base64 ans1=&#39;1UTAOIkpyOSWGv/mOYFY4R!!&#39; ans=&#39;&#39; for i in range(0,len(ans1),2): ans&#43;=ans1[i&#43;1] ans&#43;=ans1[i]#这里先把最后一步的字符转换给完成了 table=&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#43;/&#39; #大小写转换 new_table=&#39;&#39; for i in table: tmp=ord(i) if 97 &lt;= tmp &lt;= 122: new_table &#43;= chr(tmp - 32) elif 65 &lt;= tmp &lt;= 90: new_table &#43;= chr(tmp &#43; 32) else: new_table&#43;=chr(tmp) print(new_table) renew_table=&#39;&#39; renew_table=new_table[24:]&#43;new_table[:24] print(renew_table) #得到新表 arr=[] for i in range(len(ans)-2): arr.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-11T19:12:48+08:00">
    <meta property="article:modified_time" content="2024-07-11T19:12:48+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">[安洵杯 2019]crackMe</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>大佬wp:</p> 
<p><a href="https://www.cnblogs.com/Moomin/p/15824028.html" rel="nofollow" title="[安洵杯 2019]crackMe - Moominn - 博客园 (cnblogs.com)">[安洵杯 2019]crackMe - Moominn - 博客园 (cnblogs.com)</a></p> 
<p></p> 
<p><img alt="" height="635" src="https://images2.imgbox.com/85/0a/1xvj33RY_o.png" width="1129"></p> 
<p> 首先肯定是运行</p> 
<p>(运行这个耗费了我好久,一直说我缺失什么文件,我giao,最后是问学长要的dll文件)</p> 
<p>输入类型,然后提醒我hook</p> 
<p></p> 
<p>没搞懂,先分析吧</p> 
<p><img alt="" height="143" src="https://images2.imgbox.com/53/bd/7Sj9eAnq_o.png" width="790"></p> 
<p>F12找到right,reverse--从结果来推</p> 
<h3 style="background-color:transparent;">cmp</h3> 
<p><img alt="" height="222" src="https://images2.imgbox.com/56/52/kaNUAxyL_o.png" width="580"></p> 
<p>str2= 1UTAOIkpyOSWGv/mOYFY4R!!</p> 
<p><img alt="" height="461" src="https://images2.imgbox.com/ec/28/l02OKviz_o.png" width="809"></p> 
<p>上调找到这里</p> 
<p><img alt="" height="488" src="https://images2.imgbox.com/a9/ea/vprW68bi_o.png" width="628"></p> 
<p><img alt="" height="592" src="https://images2.imgbox.com/d0/f0/ryZjqsIP_o.png" width="858"></p> 
<h3>再换表</h3> 
<p>对base64的表进行了移位处理</p> 
<p><img alt="" height="146" src="https://images2.imgbox.com/67/d6/41fqH2Td_o.png" width="487"></p> 
<p></p> 
<p><img alt="" height="362" src="https://images2.imgbox.com/aa/e0/ywDSqcW3_o.png" width="791"></p> 
<p>这里我也没看懂,看wp才知道,这里是说对不足的补全为!(之前是补全为=)</p> 
<h3 style="background-color:transparent;">输入字符两两swap</h3> 
<p><img alt="" height="435" src="https://images2.imgbox.com/ac/8f/7qXyk9Fm_o.png" width="648"></p> 
<h3>SM4</h3> 
<p><img alt="" height="216" src="https://images2.imgbox.com/5c/1a/B3qVxSKa_o.png" width="709"></p> 
<p><img alt="" height="520" src="https://images2.imgbox.com/db/fc/YfjvecsC_o.png" width="1131"></p> 
<h3>base64表大小写转换</h3> 
<p><img alt="" height="307" src="https://images2.imgbox.com/2c/e3/FeVfLeIV_o.png" width="697"></p> 
<p> 这是我们逆向推出来的流程</p> 
<p>我们现在重新来理一下</p> 
<p>首先是base64被换表了----输入字符移动----输入字符swap---SM4加密---base64表大小写转换---base64加密为str2</p> 
<pre><code class="language-python">import base64
ans1='1UTAOIkpyOSWGv/mOYFY4R!!'
ans=''
for i in range(0,len(ans1),2):
    ans+=ans1[i+1]
    ans+=ans1[i]#这里先把最后一步的字符转换给完成了
table='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
#大小写转换
new_table=''
for i in table:
    tmp=ord(i)
    if 97 &lt;= tmp &lt;= 122:
        new_table += chr(tmp - 32)
    elif 65 &lt;= tmp &lt;= 90:
        new_table += chr(tmp + 32)
    else:
        new_table+=chr(tmp)
print(new_table)
renew_table=''
renew_table=new_table[24:]+new_table[:24]
print(renew_table)
#得到新表
arr=[]
for i in range(len(ans)-2):
    arr.append(renew_table.find(ans[i]))#这一步要了解base64具体过程,这是找到在base表里面的对应下标,即明文的前三位数字
enc=''
for i in arr:
    enc+=table[i]#这里又回到正常的base64,因为这里!!不好操作,我们换回原来的base64加上==,这样方便操作
enc+='=='
print(enc)
tes=base64.b64decode(enc)
print(list(map(hex,tes)))#记住吧,我也不会,哈哈
a=['0x59', '0xd0', '0x95', '0x29', '0xd', '0xf2', '0x40', '0x6', '0x14', '0xf4', '0x8d', '0x27', '0x69', '0x6', '0x87', '0x4e']
for i in a:
    print(hex(int(i,16)),end=',')
key='where_are_u_now?'
#剩下交给厨子了,sm4加解密我是真的不是很了解</code></pre> 
<p><img alt="" height="958" src="https://images2.imgbox.com/04/e0/jM65FwXS_o.png" width="1200"></p> 
<p> SM4foRExcepioN?!</p> 
<p></p> 
<p>至于讲的什么VSH,SEH,UEH,我感觉不出来,哈哈,应该是太菜了</p> 
<p>我就慢慢回调就写完了</p> 
<p><a href="https://blog.csdn.net/2302_79135465/article/details/139169495?spm=1001.2101.3001.6650.3&amp;utm_medium=distribute.pc_relevant.none-task-blog-2~default~YuanLiJiHua~Position-3-139169495-blog-125494055.235%5Ev43%5Epc_blog_bottom_relevance_base3&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~YuanLiJiHua~Position-3-139169495-blog-125494055.235%5Ev43%5Epc_blog_bottom_relevance_base3" title="[安洵杯 2019]crackMe-CSDN博客">[安洵杯 2019]crackMe-CSDN博客</a></p> 
<p>这篇博客有个这个图</p> 
<p><img alt="" height="488" src="https://images2.imgbox.com/d5/f1/AdAoZ0dG_o.png" width="890"></p> 
<p> 我也理解不到,记住吧</p> 
<p>下一题!</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d09b13e6ba7cb67712e81902eeffe738/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">测试移动电源IC IP5306、IP5407</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9823adf108e1b5d0b69eef9614ee537c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Spring Boot】Spring原理：Bean的作用域和生命周期</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>