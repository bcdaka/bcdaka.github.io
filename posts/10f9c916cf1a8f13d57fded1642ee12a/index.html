<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【乐吾乐2D可视化组态编辑器】事件 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/10f9c916cf1a8f13d57fded1642ee12a/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【乐吾乐2D可视化组态编辑器】事件">
  <meta property="og:description" content="事件 乐吾乐2D可视化组态编辑器demo：https://2d.le5le.com/ 仅当画布锁定后(meta2d.store.data.locked = 1 or 2)，触发事件。否则，干扰编辑。
定义 图元下的events属性为事件列表。
const pen = { name: &#34;rectangle&#34;, text: &#34;矩形&#34;, x: 100, y: 100, width: 100, height: 100, events: [ { name: &#34;click&#34;, action: EventAction.Link, // 执行动作 where: { type:&#39;comparison&#39;, key: &#34;text&#34;, comparison: &#34;==&#34;, value: &#34;矩形&#34; }, // 触发条件 value: &#34;2d.le5le.com&#34;, }, ], }; Copy
events对象说明
name - 事件类型action - 事件行为value - 事件附属数据params - 事件参数where - 触发条件 事件类型 事件类型name值如下：
鼠标进入 enter鼠标离开 leave选中 active取消选中 inactive单击 click双击 dblclick鼠标按下 mousedown鼠标抬起 mouseup值变化 valueUpdate const pen = { name: &#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-17T10:05:23+08:00">
    <meta property="article:modified_time" content="2024-07-17T10:05:23+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【乐吾乐2D可视化组态编辑器】事件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>事件</h2> 
<p>乐吾乐2D可视化组态编辑器demo：<a href="https://2d.le5le.com/" rel="nofollow" title="https://2d.le5le.com/ ">https://2d.le5le.com/ </a> </p> 
<p>仅当画布锁定后(meta2d.store.data.locked = 1 or 2)，触发事件。否则，干扰编辑。</p> 
<h2 id="0">定义</h2> 
<p>图元下的events属性为事件列表。</p> 
<pre><code>const pen = {
  name: "rectangle",
  text: "矩形",
  x: 100,
  y: 100,
  width: 100,
  height: 100,
  events: [
    {
      name: "click",
      action: EventAction.Link, // 执行动作
      where: { type:'comparison',  key: "text", comparison: "==", value: "矩形" }, // 触发条件
      value: "2d.le5le.com",
    },
  ],
};</code></pre> 
<p>Copy</p> 
<p><strong>events对象说明</strong></p> 
<ul><li>name - 事件类型</li><li>action - 事件行为</li><li>value - 事件附属数据</li><li>params - 事件参数</li><li>where - 触发条件</li></ul> 
<h3 id="1">事件类型</h3> 
<p>事件类型name值如下：</p> 
<ul><li>鼠标进入 enter</li><li>鼠标离开 leave</li><li>选中 active</li><li>取消选中 inactive</li><li>单击 click</li><li>双击 dblclick</li><li>鼠标按下 mousedown</li><li>鼠标抬起 mouseup</li><li>值变化 valueUpdate</li></ul> 
<pre><code>const pen = {
  name: "rectangle",
  text: "矩形",
  x: 100,
  y: 100,
  width: 100,
  height: 100,
  events: [
    {
      name: "click",
      action: EventAction.Link, // 执行动作
      where: { type:'comparison',  key: "text", comparison: "==", value: "矩形" }, // 触发条件
      value: "2d.le5le.com",
    },
  ],
};
meta2d.addPen(pen);</code></pre> 
<p></p> 
<h3 id="2">事件行为</h3> 
<p>事件行为action为一个枚举值：</p> 
<pre><code>enum EventAction {
  Link,           // 打开链接  
  SetProps,       // 更改属性
  StartAnimate,   // 执行动画
  PauseAnimate,   // 暂停动画
  StopAnimate,    // 停止动画
  JS,             // 执行JS代码
  GlobalFn,       // 执行全局函数
  Emit,           // 发送消息
  StartVideo,     // 播放视频
  PauseVideo,     // 暂停视频
  StopVideo,      // 停止视频
  SendPropData,   // 发送图元数据
  SendVarData,    // 发送绑定变量
}</code></pre> 
<p></p> 
<h4 id="3">打开链接</h4> 
<pre><code>const pen = {
  name: "rectangle",
  text: "矩形",
  x: 100,
  y: 100,
  width: 100,
  height: 100,
  events: [
    {
      name: "click",
      action: EventAction.Link,
      value: "2d.le5le.com",
    },
  ],
};</code></pre> 
<p></p> 
<h4 id="4">更改属性</h4> 
<pre><code>const pen = {
  name: "rectangle",
  text: "矩形",
  x: 100,
  y: 100,
  width: 100,
  height: 100,
  events: [
    {
      name: "click",
      action: EventAction.SetProps,
      params:'id/tag',//目标图元，你要更改属性的图元的id/tag
      value: {
        color:'red',
        text:'le5le'
        //...需要更改的其他属性
      },
    },
  ],
};</code></pre> 
<p></p> 
<p></p> 
<h4 id="5">动画执行/暂停/停止</h4> 
<pre><code>const pen = {
  name: "rectangle",
  text: "矩形",
  x: 100,
  y: 100,
  width: 100,
  height: 100,
  events: [
    {
      name: "click",
      action: EventAction.StartAnimate,//PauseAnimate StopAnimate
      value:'id/tag'//目标图元，要执行/暂停/停止动画的图元的id/tag
    },
  ],
};</code></pre> 
<p></p> 
<h4 id="6">执行JS代码</h4> 
<pre><code>const pen = {
  name: "rectangle",
  text: "矩形",
  x: 100,
  y: 100,
  width: 100,
  height: 100,
  events: [
    {
      name: "click",
      action: EventAction.JS,
      params: "我是参数",//传递到代码块的参数
      value:`console.log('arguments',arguments);
              console.log('当前点击的图元', pen);
              console.log('参数',params);
              console.log('上下文',context);`//代码块
    },
  ],
};

//请求接口示例
//value:"fetch('/api/device/data?mock=1').then((e) =&gt; {e.text().then(data=&gt;{console.log(data)});})"
</code></pre> 
<p></p> 
<p></p> 
<h4 id="7">执行全局函数</h4> 
<pre><code>globalThis.le5leFn= (pen,params) =&gt;{
  console.log('当前图元：',pen,'参数：',params);
};

const pen = {
  name: "rectangle",
  text: "矩形",
  x: 100,
  y: 100,
  width: 100,
  height: 100,
  events: [
    {
      name: "click",
      action: EventAction.GlobalFn,
      params: "我是参数",//传到代码块的参数
      value:"le5leFn" //全局函数名
    },
  ],
};</code></pre> 
<p></p> 
<p></p> 
<h4 id="8">发送消息</h4> 
<pre><code>//meta2d监听该消息
meta2d.on('le5le-emit',(e)=&gt;{console.log(e)});

const pen = {
  name: "rectangle",
  text: "矩形",
  x: 100,
  y: 100,
  width: 100,
  height: 100,
  events: [
    {
      name: "click",
      action: EventAction.Emit,
      params: "我是参数",//传到代码块的参数
      value:"le5le-emit" //消息名
    },
  ],
};</code></pre> 
<p></p> 
<p></p> 
<h4 id="9">视频播放/暂停/停止</h4> 
<pre><code>const pen = {
  name: "rectangle",
  text: "矩形",
  x: 100,
  y: 100,
  width: 100,
  height: 100,
  events: [
    {
      name: "click",
      action: EventAction.StartVideo,//PauseVideo StopVideo
      value:'id/tag'//目标图元，要播放/暂停/停止视频图元的id/tag
    },
  ],
};</code></pre> 
<p></p> 
<p></p> 
<h4 id="10">发送图元数据</h4> 
<pre><code>const pen = {
  name: "rectangle",
  text: "矩形",
  x: 100,
  y: 100,
  width: 100,
  height: 100,
  events: [
    {
      name: "click",
      action: EventAction.SendPropData,
      params:'id/tag',//目标图元的id/tag，你要发送哪个图元的数据
      value: {
        color:'red', //有值发送该值
        text:'' //为空会从拿到目标图元的属性值
        //发送的数据
      },
      extend: "topic1,topic2"//建立mqtt通信时填写该参数，表示你发送数据到哪几个topic
    },
  ],
};</code></pre> 
<p></p> 
<h4 id="11">发送绑定变量</h4> 
<pre><code>const pen = {
  name: "rectangle",
  text: "矩形",
  x: 100,
  y: 100,
  width: 100,
  height: 100,
  events: [
    {
      name: "click",
      action: EventAction.SendVarData,
      params:'id/tag',//目标图元的id/tag，你要发送哪个图元的数据
      value: {
        bindId:'value' //绑定的变量及值，值为空则从目标图元中拿到绑定变量对应属性的值
      },
      extend: "topic1,topic2"//建立mqtt通信时填写该参数，表示你发送数据到哪几个topic
    },
  ],
};</code></pre> 
<p></p> 
<h3 id="12">条件触发</h3> 
<p>条件触发是指满足指定条件才触发事件。</p> 
<pre><code>const pen = {
  name: "rectangle",
  text: "矩形",
  x: 100,
  y: 100,
  width: 100,
  height: 100,
  events: [
    {
      name: "click",
      // 执行动作
      action: EventAction.Link, 
      // 运算符触发条件。text属性值 == “矩形” 触发
      where: { type:'comparison', key: "text", comparison: "==", value: "矩形" }, 
      value: "2d.le5le.com",
    },
    {
      name: "click",
      action: EventAction.Link, 
      // 通过自定义条件函数返回值触发条件
      where: { type: "fn", fn:()=&gt;{return bool;} },  
      value: "2d.le5le.com",
    },
    {
      name: "click",
      action: EventAction.Link, 
      // 通过js代码返回值触发条件。
      where: { type: "温度过高", fnJs:"伪代码;return bool;" },  
      value: "2d.le5le.com",
    },
    {
      name: "click",
      action: EventAction.Link, 
      // 通过js代码返回值触发条件。
      where: { type: "电流过高", fnJs:"伪代码;return bool;" },  
      value: "2d.le5le.com",
    },
  ],
};
meta2d.addPen(pen);</code></pre> 
<p></p> 
<h4 id="13">数据结构</h4> 
<p>where数据属性结构如下：</p> 
<ul><li><strong>type</strong> - 任意值，推荐使用条件的功能名称方便阅读。为空时，表示没有触发条件。</li><li><strong>fn</strong> - 条件函数，返回一个bool值。最高优先级。</li><li><strong>fnJs </strong>- 条件的js代码文本，可获取'pen'和 'context'参数，返回一个bool值。高优先级。</li><li><strong>key </strong>- 通过属性名进行条件比较。低优先级。</li><li><strong>comparison</strong> - 属性比较条件，配合key使用。 
  <ul><li>“&gt;” - 大于</li><li>“&gt;=” - 大于等于</li><li>“&lt;” - 小于</li><li>“&lt;=” - 小于等于</li><li>“=” - 等于</li><li>“!=” - 不等于</li><li>“[)” - 介于，与数学上相同，例如：[0, 100) 0~100，包含0不包含100； [0,100] 0~100,包含0和100</li><li>“![)” - 不介于，“介于”以外的</li><li>“[]” - 属于,集合，例如：[1,20,30..50,65] ，1.0.48版本后支持字符串，例如 [1,20,aaa,值1]</li><li>“![]” - 不属于，上述集合以外的</li></ul></li><li><strong>value</strong> - 属性比较值，配合key使用。</li></ul> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7fd5c0969a0b7b8f662dd868c227db78/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">半监督学习概念与算法精讲</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b132f08ee7de60fbd283514ce2c10000/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java与mysql连接 使用mysql-connector-java连接msql</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>