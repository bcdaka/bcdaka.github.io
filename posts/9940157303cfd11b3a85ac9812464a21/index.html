<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【Python・统计学】卡方检验（原理及代码） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/9940157303cfd11b3a85ac9812464a21/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【Python・统计学】卡方检验（原理及代码）">
  <meta property="og:description" content="前言 自学笔记，分享给对统计学原理不太清楚但需要在论文中用到的小伙伴，欢迎大佬们补充或绕道。ps：本文不涉及公式讲解（文科生小白友好体质）～（部分定义等来源于知乎）
本文重点：卡方检验（非参数检验的一种）
【1.卡方检验的简单原理和前提条件】
【2.卡方检验的数据实例】
【3.卡方检验代码以及残差分析】
关于“参数检验”和“非参数检验”的不同，请参考以下文章。【统计学】参数检验和非参数检验的区别和基本统计学
1.卡方检验的简单原理和前提条件 卡方检验就是统计样本的实际观测值与理论推断值之间的偏离程度，实际观测值与理论推断值之间的偏离程度就决定卡方值的大小，如果卡方值越大，二者偏差程度越大；反之，二者偏差越小；若两个值完全相等时，卡方值就为0，表明理论值完全符合。
注意：卡方检验针对分类变量 分类变量(Categorical Variable),也称为定性变量(Qualitative Variable),是一种用于描述个体特征或属性的变量,其取值是有限个且通常没有数值意义的类别或群组。与连续变量(如身高、体重)不同,分类变量的值之间没有大小顺序或数量关系。
分类变量可分为两类:
名义变量(Nominal Variable):名义变量的类别之间没有任何自然顺序或等级关系。例如: 性别(男、女)血型(A型、B型、AB型、O型)婚姻状况(未婚、已婚、离异、丧偶)民族(汉族、满族、回族等) 有序变量(Ordinal Variable):有序变量的类别之间存在自然顺序或等级关系,但类别之间的差距没有数值意义。例如: 教育程度(小学、初中、高中、大学、研究生)问卷调查中的满意度(非常不满意、不满意、一般、满意、非常满意)产品质量等级(差、中、良、优)社会阶层(下层、中下层、中层、中上层、上层) 前提条件: 随机抽样:样本必须是从总体中随机抽取的,以确保样本具有代表性。独立性:每个观察值必须独立于其他观察值,一个观察值的分类不应影响另一个观察值的分类。样本量足够大:期望频数不应过小,一般要求每个单元格的期望频数不小于5。如果不满足这一条件,可以考虑使用Fisher精确检验或者进行单元格合并。分类变量:所有变量都应该是分类变量,即由两个或多个类别组成。互斥且穷尽:每个观察值只能属于一个类别,并且所有类别加起来应该包括所有可能的情况。 2.卡方检验的数据实例 探索【吸烟】和【肺癌】的关系 患有肺癌不患肺癌合计吸烟60140200不吸烟10190200合计70330400 步骤1:计算观察频数和期望频数之差的平方除以期望频数,得到每个单元格的卡方值。 期望频数的计算公式为:(行合计 × 列合计) ÷ 总合计
例如,吸烟且患有肺癌的期望频数为:(200 × 70) ÷ 400 = 35
患有肺癌不患肺癌吸烟(60 - 35)^2 ÷ 35 = 17.86(140 - 165)^2 ÷ 165 = 3.79不吸烟(10 - 35)^2 ÷ 35 = 17.86(190 - 165)^2 ÷ 165 = 3.79 步骤2:将所有单元格的卡方值相加,得到总卡方值。 总卡方值 = 17.86 &#43; 3.79 &#43; 17.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-09T22:28:07+08:00">
    <meta property="article:modified_time" content="2024-04-09T22:28:07+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Python・统计学】卡方检验（原理及代码）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>前言</h2> 
<p>自学笔记，分享给对<u><strong>统计学原理不太清楚</strong></u>但需要<u><strong>在论文中用到</strong></u>的小伙伴，欢迎大佬们补充或绕道。ps：本文不涉及公式讲解（文科生小白友好体质）～（部分定义等来源于知乎）</p> 
<p>本文重点：卡方检验（非参数检验的一种）</p> 
<p>【1.<u><strong>卡方检验的简单原理和前提条件</strong></u>】</p> 
<p><strong>【<u>2.卡方检验的数据实例</u>】</strong></p> 
<p><strong>【<u>3.卡方检验代码以及残差分析</u>】</strong></p> 
<p>关于“参数检验”和“非参数检验”的不同，请参考以下文章。<a href="https://mp.csdn.net/mp_blog/creation/editor/137423304" title="【统计学】参数检验和非参数检验的区别和基本统计学">【统计学】参数检验和非参数检验的区别和基本统计学</a></p> 
<h2>1.<strong>卡方检验的简单原理和前提条件</strong></h2> 
<p>  卡方检验就是统计样本的<u><strong>实际观测值</strong></u>与<u><strong>理论推断值</strong></u>之间的偏离程度，实际观测值与理论推断值之间的偏离程度就决定卡方值的大小，如果卡方值越大，二者偏差程度越大；反之，二者偏差越小；若两个值完全相等时，卡方值就为0，表明理论值完全符合。</p> 
<h5>注意：卡方检验针对<u><strong>分类变量</strong></u></h5> 
<p>   分类变量(Categorical Variable),也称为定性变量(Qualitative Variable),是一种用于描述个体特征或属性的变量,其取值是有限个且通常没有数值意义的类别或群组。与连续变量(如身高、体重)不同,分类变量的值之间没有大小顺序或数量关系。</p> 
<p>   分类变量可分为两类:</p> 
<ol><li> <h6>名义变量(Nominal Variable):名义变量的类别之间没有任何自然顺序或等级关系。例如:</h6> 
  <ul><li>性别(男、女)</li><li>血型(A型、B型、AB型、O型)</li><li>婚姻状况(未婚、已婚、离异、丧偶)</li><li>民族(汉族、满族、回族等)</li></ul></li><li> <h6>有序变量(Ordinal Variable):有序变量的类别之间存在自然顺序或等级关系,但类别之间的差距没有数值意义。例如:</h6> 
  <ul><li>教育程度(小学、初中、高中、大学、研究生)</li><li>问卷调查中的满意度(非常不满意、不满意、一般、满意、非常满意)</li><li>产品质量等级(差、中、良、优)</li><li>社会阶层(下层、中下层、中层、中上层、上层)</li></ul></li></ol> 
<h5>前提条件:</h5> 
<ol><li>随机抽样:样本必须是从总体中随机抽取的,以确保样本具有代表性。</li><li>独立性:每个观察值必须独立于其他观察值,一个观察值的分类不应影响另一个观察值的分类。</li><li>样本量足够大:期望频数不应过小,一般要求每个单元格的期望频数不小于5。如果不满足这一条件,可以考虑使用Fisher精确检验或者进行单元格合并。</li><li>分类变量:所有变量都应该是分类变量,即由两个或多个类别组成。</li><li>互斥且穷尽:每个观察值只能属于一个类别,并且所有类别加起来应该包括所有可能的情况。</li></ol> 
<h2>2.<strong>卡方检验的数据实例</strong></h2> 
<h5>探索【吸烟】和【肺癌】的关系</h5> 
<table><thead><tr><th>患有肺癌</th><th>不患肺癌</th><th>合计</th></tr></thead><tbody><tr><td>吸烟</td><td>60</td><td>140</td><td>200</td></tr><tr><td>不吸烟</td><td>10</td><td>190</td><td>200</td></tr><tr><td>合计</td><td>70</td><td>330</td><td>400</td></tr></tbody></table> 
<h6><strong>步骤1:计算观察频数和期望频数之差的平方除以期望频数,得到每个单元格的卡方值。</strong></h6> 
<p>期望频数的计算公式为:(行合计 × 列合计) ÷ 总合计</p> 
<p>例如,吸烟且患有肺癌的期望频数为:(200 × 70) ÷ 400 = 35</p> 
<table><thead><tr><th></th><th>患有肺癌</th><th>不患肺癌</th></tr></thead><tbody><tr><td>吸烟</td><td>(60 - 35)^2 ÷ 35 = 17.86</td><td>(140 - 165)^2 ÷ 165 = 3.79</td></tr><tr><td>不吸烟</td><td>(10 - 35)^2 ÷ 35 = 17.86</td><td>(190 - 165)^2 ÷ 165 = 3.79</td></tr></tbody></table> 
<h6>步骤2:将所有单元格的卡方值相加,得到总卡方值。</h6> 
<p>总卡方值 = 17.86 + 3.79 + 17.86 + 3.79 = 43.30</p> 
<h6>步骤3:根据自由度和显著性水平,查找临界卡方值。</h6> 
<p>自由度 = (行数 - 1) × (列数 - 1) = (2 - 1) × (2 - 1) = 1</p> 
<p>假设显著性水平为0.05,查表得临界卡方值为3.84。</p> 
<p>以下是卡方检验的临界值表,包含了不同自由度和常用显著性水平(0.10, 0.05, 0.01, 0.001)下的临界卡方值:</p> 
<table><thead><tr><th>自由度</th><th>0.10</th><th>0.05</th><th>0.01</th><th>0.001</th></tr></thead><tbody><tr><td>1</td><td>2.71</td><td>3.84</td><td>6.63</td><td>10.83</td></tr><tr><td>2</td><td>4.61</td><td>5.99</td><td>9.21</td><td>13.82</td></tr><tr><td>3</td><td>6.25</td><td>7.81</td><td>11.34</td><td>16.27</td></tr><tr><td>4</td><td>7.78</td><td>9.49</td><td>13.28</td><td>18.47</td></tr><tr><td>5</td><td>9.24</td><td>11.07</td><td>15.09</td><td>20.52</td></tr><tr><td>6</td><td>10.64</td><td>12.59</td><td>16.81</td><td>22.46</td></tr><tr><td>7</td><td>12.02</td><td>14.07</td><td>18.48</td><td>24.32</td></tr><tr><td>8</td><td>13.36</td><td>15.51</td><td>20.09</td><td>26.12</td></tr><tr><td>9</td><td>14.68</td><td>16.92</td><td>21.67</td><td>27.88</td></tr><tr><td>10</td><td>15.99</td><td>18.31</td><td>23.21</td><td>29.59</td></tr><tr><td>11</td><td>17.28</td><td>19.68</td><td>24.72</td><td>31.26</td></tr><tr><td>12</td><td>18.55</td><td>21.03</td><td>26.22</td><td>32.91</td></tr><tr><td>13</td><td>19.81</td><td>22.36</td><td>27.69</td><td>34.53</td></tr><tr><td>14</td><td>21.06</td><td>23.68</td><td>29.14</td><td>36.12</td></tr><tr><td>15</td><td>22.31</td><td>25.00</td><td>30.58</td><td>37.70</td></tr><tr><td>16</td><td>23.54</td><td>26.30</td><td>32.00</td><td>39.25</td></tr><tr><td>17</td><td>24.77</td><td>27.59</td><td>33.41</td><td>40.79</td></tr><tr><td>18</td><td>25.99</td><td>28.87</td><td>34.81</td><td>42.31</td></tr><tr><td>19</td><td>27.20</td><td>30.14</td><td>36.19</td><td>43.82</td></tr><tr><td>20</td><td>28.41</td><td>31.41</td><td>37.57</td><td>45.32</td></tr></tbody></table> 
<h6>步骤4:比较总卡方值和临界卡方值,如果总卡方值大于临界值,则拒绝原假设,认为变量之间存在关联。</h6> 
<p>总卡方值(43.30) &gt; 临界卡方值(3.84),因此拒绝原假设,认为吸烟与肺癌存在关联。</p> 
<p>这个例子说明了如何使用卡方检验来判断两个分类变量(吸烟情况和肺癌)之间是否存在关联性。通过计算观察频数与期望频数的差异,并将差异归一化后求和,得到总卡方值。将总卡方值与临界值比较,可以决定是否拒绝无关联的原假设。</p> 
<h2><strong>3.卡方检验代码以及残差分析</strong></h2> 
<p></p> 
<p>残差(Residual)：指在统计模型中,观察值与模型预测值之间的差异。在卡方检验中,残差表示观察频数与期望频数之间的差异。残差可以帮助我们识别哪些单元格对卡方值贡献最大,即哪些单元格的观察频数与期望频数差异最大。</p> 
<pre><code class="hljs">import numpy as np
import scipy.stats as stats

# 观察频数
observed = np.array([[60, 140], [10, 190]])

# 计算期望频数
row_totals = observed.sum(axis=1)
col_totals = observed.sum(axis=0)
total = observed.sum()
expected = np.outer(row_totals, col_totals) / total

# 计算卡方值和p值
chi2, p, dof, expected_freq = stats.chi2_contingency(observed)

# 计算标准化残差
residuals = (observed - expected) / np.sqrt(expected)

# 结果
print("观察频数:")
print(observed)
print("\n期望频数:")
print(expected)
print(f"\n卡方值: {chi2:.2f}")
print(f"p值: {p:.4f}")
print(f"自由度: {dof}")
print("\n标准化残差:")
print(residuals)

# 残差分析
print("\n残差分析:")
for i in range(residuals.shape[0]):
    for j in range(residuals.shape[1]):
        if abs(residuals[i, j]) &gt; 1.96:
            print(f"单元格({i+1}, {j+1})的标准化残差为{residuals[i, j]:.2f},超过1.96,有显著差异。")
        else:
            print(f"单元格({i+1}, {j+1})的标准化残差为{residuals[i, j]:.2f},未超过1.96,无显著差异。")</code></pre> 
<pre><code class="hljs">观察频数:
[[ 60 140]
 [ 10 190]]

期望频数:
[[35. 165.]
 [35. 165.]]

卡方值: 43.30
p值: 0.0000
自由度: 1

标准化残差:
[[ 4.23 -1.95]
 [-4.23  1.95]]

残差分析:
单元格(1, 1)的标准化残差为4.23,超过1.96,有显著差异。
单元格(1, 2)的标准化残差为-1.95,未超过1.96,无显著差异。
单元格(2, 1)的标准化残差为-4.23,超过1.96,有显著差异。
单元格(2, 2)的标准化残差为1.95,未超过1.96,无显著差异。</code></pre> 
<p>  标准化残差的绝对值大于1.96表示该单元格的观察频数与期望频数有显著差异。在这个例子中,单元格(1, 1)和(2, 1)的标准化残差超过1.96,表明吸烟者患肺癌和不吸烟者不患肺癌的观察频数显著高于期望频数。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/966cdd6cf3c8cce63a3257a44490d284/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Python requests 模块</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/23669e3b7c919a3890099c6ce06d17de/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">web期末作业网页设计（网页源码）大学生网页设计制作作业实例代码 (全网最全,建议收藏) HTML&#43;CSS&#43;JS</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>