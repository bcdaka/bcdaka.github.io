<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>用MATLAB编写牛拉法潮流计算(电力系统稳态分析) - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/1fb28d82d57d1a4e4ddd860a77f0d92f/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="用MATLAB编写牛拉法潮流计算(电力系统稳态分析)">
  <meta property="og:description" content="系列文章目录 用MATLAB形成节点导纳矩阵
文章目录 系列文章目录前言一、程序二、输入原始数据三、所求潮流计算总结 前言 本文通过编写m语言实现牛拉法求潮流计算，所用电力网络图是《用MATLAB形成节点导纳矩阵》中的第一张图。
在这里不讲解牛拉法原理，只贴出代码和相关步骤。
一、程序 n=input(&#39;n=&#39;); nl=input(&#39;nl=&#39;); isb=input(&#39;isb=&#39;); pr=input(&#39;pr=&#39;); B1=input(&#39;B1=&#39;); B2=input(&#39;B2=&#39;); X=input(&#39;X=&#39;); Y=zeros(n);e=zeros(1,n);f=zeros(1,n);V=zeros(1,n);O=zeros(1,n);S1=zeros(nl); for i=1:n if X(i,2)~=0; p=X(i,1); Y(p,p)=1./X(i,2); end end for i=1:nl if B1(i,6)==0 p=B1(i,1);q=B1(i,2); else p=B1(i,2);q=B1(i,1); end Y(p,q)=Y(p,q)-1./(B1(i,3)*B1(i,5)); Y(q,p)=Y(p,q); Y(q,q)=Y(q,q)&#43;1./(B1(i,3)*B1(i,5)^2)&#43;B1(i,4)./2; Y(p,p)=Y(p,p)&#43;1./B1(i,3)&#43;B1(i,4)./2; end G=real(Y);B=imag(Y); for i=1:n e(i)=real(B2(i,3)); f(i)=imag(B2(i,3)); V(i)=B2(i,4); end for i=1:n S(i)=B2(i,1)-B2(i,2); B(i,i)=B(i,i)&#43;B2(i,5); end P=real(S);Q=imag(S); ICT1=0;IT2=1;N0=2*n;N=N0&#43;1;a=0; while IT2~=0 IT2=0;a=a&#43;1; for i=1:n if i~=isb C(i)=0; D(i)=0; for j1=1:n C(i)=C(i)&#43;G(i,j1)*e(j1)-B(i,j1)*f(j1); D(i)=D(i)&#43;G(i,j1)*f(j1)&#43;B(i,j1)*e(j1); end P1=C(i)*e(i)&#43;f(i)*D(i); Q1=f(i)*C(i)-D(i)*e(i); V2=e(i)^2&#43;f(i)^2; if B2(i,6)~=3 DP=P(i)-P1; DQ=Q(i)-Q1; for j1=1:n if j1~=isb&amp;j1~=i X1=-G(i,j1)*e(i)-B(i,j1)*f(i); X2=B(i,j1)*e(i)-G(i,j1)*f(i); X3=X2; X4=-X1; p=2*i-1;q=2*j1-1;J(p,q)=X3;J(p,N)=DQ;m=p&#43;1; J(m,q)=X1;J(m,N)=DP;q=q&#43;1;J(p,q)=X4;J(m,q)=X2; elseif j1==i&amp;j1~=isb X1=-C(i)-G(i,i)*e(i)-B(i,i)*f(i); X2=-D(i)&#43;B(i,i)*e(i)-G(i,i)*f(i); X3=D(i)&#43;B(i,i)*e(i)-G(i,i)*f(i); X4=-C(i)&#43;G(i,i)*e(i)&#43;B(i,i)*f(i); p=2*i-1;q=2*j1-1;J(p,q)=X3;J(p,N)=DQ;m=p&#43;1; J(m,q)=X1;J(m,N)=DP;q=q&#43;1;J(p,q)=X4;J(m,q)=X2; end end else DP=P(i)-P1; DV=V(i)^2-V2; for j1=1:n if j1~=isb&amp;j1~=i X1=-G(i,j1)*e(i)-B(i,j1)*f(i); X2=B(i,j1)*e(i)-G(i,j1)*f(i); X5=0; X6=0; p=2*i-1;q=2*j1-1;J(p,q)=X5;J(p,N)=DV;m=p&#43;1; J(m,q)=X1;J(m,N)=DP;q=q&#43;1;J(p,q)=X6;J(m,q)=X2; elseif j1==i&amp;j1~=isb X1=-C(i)-G(i,i)*e(i)-B(i,i)*f(i); X2=-D(i)&#43;B(i,i)*e(i)-G(i,i)*f(i); X5=-2*e(i); X6=-2*f(i); p=2*i-1;q=2*j1-1;J(p,q)=X5;J(p,N)=DV;m=p&#43;1; J(m,q)=X1;J(m,N)=DP;q=q&#43;1;J(p,q)=X6;J(m,q)=X2; end end end end end for k=3:N0 k1=k&#43;1;N1=N; for k2=k1:N1 J(k,k2)=J(k,k2).">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-28T22:31:43+08:00">
    <meta property="article:modified_time" content="2024-06-28T22:31:43+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">用MATLAB编写牛拉法潮流计算(电力系统稳态分析)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>系列文章目录</h2> 
<p><a href="https://blog.csdn.net/m0_68747151/article/details/134722326">用MATLAB形成节点导纳矩阵</a></p> 
<hr> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_0" rel="nofollow">系列文章目录</a></li><li><a href="#_11" rel="nofollow">前言</a></li><li><a href="#_19" rel="nofollow">一、程序</a></li><li><a href="#_224" rel="nofollow">二、输入原始数据</a></li><li><a href="#_241" rel="nofollow">三、所求潮流计算</a></li><li><a href="#_250" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_11"></a>前言</h2> 
<p>本文通过编写m语言实现牛拉法求潮流计算，所用电力网络图是《<a href="https://blog.csdn.net/m0_68747151/article/details/134722326">用MATLAB形成节点导纳矩阵</a>》中的第一张图。<br> 在这里不讲解牛拉法原理，只贴出代码和相关步骤。</p> 
<hr> 
<h2><a id="_19"></a>一、程序</h2> 
<pre><code class="prism language-matlab">n<span class="token operator">=</span><span class="token function">input</span><span class="token punctuation">(</span><span class="token string">'n='</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
nl<span class="token operator">=</span><span class="token function">input</span><span class="token punctuation">(</span><span class="token string">'nl='</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
isb<span class="token operator">=</span><span class="token function">input</span><span class="token punctuation">(</span><span class="token string">'isb='</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pr<span class="token operator">=</span><span class="token function">input</span><span class="token punctuation">(</span><span class="token string">'pr='</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
B1<span class="token operator">=</span><span class="token function">input</span><span class="token punctuation">(</span><span class="token string">'B1='</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
B2<span class="token operator">=</span><span class="token function">input</span><span class="token punctuation">(</span><span class="token string">'B2='</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
X<span class="token operator">=</span><span class="token function">input</span><span class="token punctuation">(</span><span class="token string">'X='</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Y<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>e<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>f<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>V<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>O<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>S1<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>nl<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n
    <span class="token keyword">if</span> <span class="token function">X</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">~=</span><span class="token number">0</span><span class="token punctuation">;</span>
        p<span class="token operator">=</span><span class="token function">X</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">Y</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1.</span><span class="token operator">/</span><span class="token function">X</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>nl
    <span class="token keyword">if</span> <span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span>
        p<span class="token operator">=</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> p<span class="token operator">=</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span>
    <span class="token function">Y</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">Y</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1.</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">Y</span><span class="token punctuation">(</span>q<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">Y</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">Y</span><span class="token punctuation">(</span>q<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">Y</span><span class="token punctuation">(</span>q<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1.</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">./</span><span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token function">Y</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">Y</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1.</span><span class="token operator">/</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">./</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">end</span> 
G<span class="token operator">=</span><span class="token function">real</span><span class="token punctuation">(</span>Y<span class="token punctuation">)</span><span class="token punctuation">;</span>B<span class="token operator">=</span><span class="token function">imag</span><span class="token punctuation">(</span>Y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n
    <span class="token function">e</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">real</span><span class="token punctuation">(</span><span class="token function">B2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">f</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">imag</span><span class="token punctuation">(</span><span class="token function">B2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">V</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">B2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n
    <span class="token function">S</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">B2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">B2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">B</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">B</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">B2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>
P<span class="token operator">=</span><span class="token function">real</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span>Q<span class="token operator">=</span><span class="token function">imag</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span>
ICT1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>IT2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>N0<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>n<span class="token punctuation">;</span>N<span class="token operator">=</span>N0<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>a<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> IT2<span class="token operator">~=</span><span class="token number">0</span>
    IT2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>a<span class="token operator">=</span>a<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n
        <span class="token keyword">if</span> <span class="token number">i</span><span class="token operator">~=</span>isb
            <span class="token function">C</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token function">D</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> j1<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n
                <span class="token function">C</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">C</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">G</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span>j1<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">e</span><span class="token punctuation">(</span>j1<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">B</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span>j1<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">f</span><span class="token punctuation">(</span>j1<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">D</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">D</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">G</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span>j1<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">f</span><span class="token punctuation">(</span>j1<span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">B</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span>j1<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">e</span><span class="token punctuation">(</span>j1<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>
            P1<span class="token operator">=</span><span class="token function">C</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">D</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Q1<span class="token operator">=</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">C</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">D</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            V2<span class="token operator">=</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token function">B2</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">~=</span><span class="token number">3</span>
                DP<span class="token operator">=</span><span class="token function">P</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span>P1<span class="token punctuation">;</span>
                DQ<span class="token operator">=</span><span class="token function">Q</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span>Q1<span class="token punctuation">;</span>
                <span class="token keyword">for</span> j1<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n
                    <span class="token keyword">if</span> j1<span class="token operator">~=</span>isb<span class="token operator">&amp;</span>j1<span class="token operator">~=</span><span class="token number">i</span>
                        X1<span class="token operator">=</span><span class="token operator">-</span><span class="token function">G</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span>j1<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">B</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span>j1<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        X2<span class="token operator">=</span><span class="token function">B</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span>j1<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">G</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span>j1<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        X3<span class="token operator">=</span>X2<span class="token punctuation">;</span>
                        X4<span class="token operator">=</span><span class="token operator">-</span>X1<span class="token punctuation">;</span>
                        p<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span><span class="token number">i</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>j1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token function">J</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token operator">=</span>X3<span class="token punctuation">;</span><span class="token function">J</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token operator">=</span>DQ<span class="token punctuation">;</span>m<span class="token operator">=</span>p<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
                        <span class="token function">J</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token operator">=</span>X1<span class="token punctuation">;</span><span class="token function">J</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token operator">=</span>DP<span class="token punctuation">;</span>q<span class="token operator">=</span>q<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token function">J</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token operator">=</span>X4<span class="token punctuation">;</span><span class="token function">J</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token operator">=</span>X2<span class="token punctuation">;</span>
                    <span class="token keyword">elseif</span> j1<span class="token operator">==</span><span class="token number">i</span><span class="token operator">&amp;</span>j1<span class="token operator">~=</span>isb
                        X1<span class="token operator">=</span><span class="token operator">-</span><span class="token function">C</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">G</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">B</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        X2<span class="token operator">=</span><span class="token operator">-</span><span class="token function">D</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">B</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">G</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        X3<span class="token operator">=</span><span class="token function">D</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">B</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">G</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        X4<span class="token operator">=</span><span class="token operator">-</span><span class="token function">C</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">G</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">B</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        p<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span><span class="token number">i</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>j1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token function">J</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token operator">=</span>X3<span class="token punctuation">;</span><span class="token function">J</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token operator">=</span>DQ<span class="token punctuation">;</span>m<span class="token operator">=</span>p<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
                        <span class="token function">J</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token operator">=</span>X1<span class="token punctuation">;</span><span class="token function">J</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token operator">=</span>DP<span class="token punctuation">;</span>q<span class="token operator">=</span>q<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token function">J</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token operator">=</span>X4<span class="token punctuation">;</span><span class="token function">J</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token operator">=</span>X2<span class="token punctuation">;</span>
                    <span class="token keyword">end</span>
                <span class="token keyword">end</span>
            <span class="token keyword">else</span>
            DP<span class="token operator">=</span><span class="token function">P</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span>P1<span class="token punctuation">;</span>
            DV<span class="token operator">=</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">-</span>V2<span class="token punctuation">;</span>
            <span class="token keyword">for</span> j1<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n
                <span class="token keyword">if</span> j1<span class="token operator">~=</span>isb<span class="token operator">&amp;</span>j1<span class="token operator">~=</span><span class="token number">i</span>
                    X1<span class="token operator">=</span><span class="token operator">-</span><span class="token function">G</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span>j1<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">B</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span>j1<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    X2<span class="token operator">=</span><span class="token function">B</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span>j1<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">G</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span>j1<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    X5<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
                    X6<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
                    p<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span><span class="token number">i</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>j1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token function">J</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token operator">=</span>X5<span class="token punctuation">;</span><span class="token function">J</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token operator">=</span>DV<span class="token punctuation">;</span>m<span class="token operator">=</span>p<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
                    <span class="token function">J</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token operator">=</span>X1<span class="token punctuation">;</span><span class="token function">J</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token operator">=</span>DP<span class="token punctuation">;</span>q<span class="token operator">=</span>q<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token function">J</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token operator">=</span>X6<span class="token punctuation">;</span><span class="token function">J</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token operator">=</span>X2<span class="token punctuation">;</span>
                    <span class="token keyword">elseif</span> j1<span class="token operator">==</span><span class="token number">i</span><span class="token operator">&amp;</span>j1<span class="token operator">~=</span>isb
                       X1<span class="token operator">=</span><span class="token operator">-</span><span class="token function">C</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">G</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">B</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                       X2<span class="token operator">=</span><span class="token operator">-</span><span class="token function">D</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">B</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">G</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                       X5<span class="token operator">=</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                       X6<span class="token operator">=</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                       p<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span><span class="token number">i</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>j1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token function">J</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token operator">=</span>X5<span class="token punctuation">;</span><span class="token function">J</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token operator">=</span>DV<span class="token punctuation">;</span>m<span class="token operator">=</span>p<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
                       <span class="token function">J</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token operator">=</span>X1<span class="token punctuation">;</span><span class="token function">J</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token operator">=</span>DP<span class="token punctuation">;</span>q<span class="token operator">=</span>q<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token function">J</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token operator">=</span>X6<span class="token punctuation">;</span><span class="token function">J</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token operator">=</span>X2<span class="token punctuation">;</span>
                <span class="token keyword">end</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span class="token keyword">for</span> k<span class="token operator">=</span><span class="token number">3</span><span class="token operator">:</span>N0
    k1<span class="token operator">=</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>N1<span class="token operator">=</span>N<span class="token punctuation">;</span>
    <span class="token keyword">for</span> k2<span class="token operator">=</span>k1<span class="token operator">:</span>N1
        <span class="token function">J</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span>k2<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">J</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span>k2<span class="token punctuation">)</span><span class="token operator">./</span><span class="token function">J</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span>
    <span class="token function">J</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> k<span class="token operator">~=</span><span class="token number">3</span>
        k4<span class="token operator">=</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> k3<span class="token operator">=</span><span class="token number">3</span><span class="token operator">:</span>k4
            <span class="token keyword">for</span> k2<span class="token operator">=</span>k1<span class="token operator">:</span>N1
                <span class="token function">J</span><span class="token punctuation">(</span>k3<span class="token punctuation">,</span>k2<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">J</span><span class="token punctuation">(</span>k3<span class="token punctuation">,</span>k2<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">J</span><span class="token punctuation">(</span>k3<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">J</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span>k2<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>
            <span class="token function">J</span><span class="token punctuation">(</span>k3<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
        <span class="token keyword">if</span> k<span class="token operator">==</span>N0<span class="token punctuation">,</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">end</span>
        <span class="token keyword">for</span> k3<span class="token operator">=</span>k1<span class="token operator">:</span>N0
            <span class="token keyword">for</span> k2<span class="token operator">=</span>k1<span class="token operator">:</span>N1
                <span class="token function">J</span><span class="token punctuation">(</span>k3<span class="token punctuation">,</span>k2<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">J</span><span class="token punctuation">(</span>k3<span class="token punctuation">,</span>k2<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">J</span><span class="token punctuation">(</span>k3<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">J</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span>k2<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>
            <span class="token function">J</span><span class="token punctuation">(</span>k3<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
    <span class="token keyword">else</span>
        <span class="token keyword">for</span> k3<span class="token operator">=</span>k1<span class="token operator">:</span>N0
            <span class="token keyword">for</span> k2<span class="token operator">=</span>k1<span class="token operator">:</span>N1
                <span class="token function">J</span><span class="token punctuation">(</span>k3<span class="token punctuation">,</span>k2<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">J</span><span class="token punctuation">(</span>k3<span class="token punctuation">,</span>k2<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">J</span><span class="token punctuation">(</span>k3<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">J</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span>k2<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>
            <span class="token function">J</span><span class="token punctuation">(</span>k3<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span class="token keyword">for</span> k<span class="token operator">=</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">2</span><span class="token operator">:</span>N0<span class="token operator">-</span><span class="token number">1</span>
    L<span class="token operator">=</span><span class="token punctuation">(</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">./</span><span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token function">e</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">e</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">J</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>
    k1<span class="token operator">=</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token function">f</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">f</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">J</span><span class="token punctuation">(</span>k1<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>
<span class="token keyword">for</span> k<span class="token operator">=</span><span class="token number">3</span><span class="token operator">:</span>N0
    DET<span class="token operator">=</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">J</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> DET<span class="token operator">&gt;=</span>pr
        IT2<span class="token operator">=</span>IT2<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span class="token function">ICT2</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">=</span>IT2<span class="token punctuation">;</span>
ICT1<span class="token operator">=</span>ICT1<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> k<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n
    <span class="token function">dy</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token function">e</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span><span class="token function">f</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n
    <span class="token function">Dy</span><span class="token punctuation">(</span>ICT1<span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">dy</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>
<span class="token keyword">end</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'迭代次数'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">disp</span><span class="token punctuation">(</span>ICT1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'没有达到精度要求的个数'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">disp</span><span class="token punctuation">(</span>ICT2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> k<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n
    <span class="token function">V</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token function">e</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span><span class="token function">f</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">O</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">atan</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">./</span><span class="token function">e</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">180.</span><span class="token operator">/</span><span class="token keyword">pi</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>
E<span class="token operator">=</span>e<span class="token operator">+</span>f<span class="token operator">*</span><span class="token number">j</span><span class="token punctuation">;</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'各节点的实际电压标幺值E为（节点号从小到大排列）：'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">disp</span><span class="token punctuation">(</span>E<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'各节点的电压大小V为（节点后从小到大排列）：'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">disp</span><span class="token punctuation">(</span>V<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'各节点的电压相角O为（节点号从小到大排列）：'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">disp</span><span class="token punctuation">(</span>O<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> p<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n
    <span class="token function">C</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> q<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n
        <span class="token function">C</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">C</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">conj</span><span class="token punctuation">(</span><span class="token function">Y</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">conj</span><span class="token punctuation">(</span><span class="token function">E</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span>
    <span class="token function">S</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">E</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">C</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'各节点的功率S为（节点号从小到大排列）:'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">disp</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'各条支路的首端功率Si为（顺序同您输入B1时一样）：'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>nl
    <span class="token keyword">if</span> <span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span>
        p<span class="token operator">=</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> p<span class="token operator">=</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span>
    <span class="token function">Si</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">E</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">conj</span><span class="token punctuation">(</span><span class="token function">E</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">conj</span><span class="token punctuation">(</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">./</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token function">conj</span><span class="token punctuation">(</span><span class="token function">E</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">conj</span><span class="token punctuation">(</span><span class="token function">E</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">conj</span><span class="token punctuation">(</span><span class="token number">1.</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">Si</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'各条支路的末端功率Sj为(顺序同您输入B1时一样):'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>nl
    <span class="token keyword">if</span> <span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span>
        p<span class="token operator">=</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> p<span class="token operator">=</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span>
    <span class="token function">Sj</span><span class="token punctuation">(</span>q<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">E</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">conj</span><span class="token punctuation">(</span><span class="token function">E</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">conj</span><span class="token punctuation">(</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">./</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token function">conj</span><span class="token punctuation">(</span><span class="token function">E</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token operator">./</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">conj</span><span class="token punctuation">(</span><span class="token function">E</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">conj</span><span class="token punctuation">(</span><span class="token number">1.</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">Sj</span><span class="token punctuation">(</span>q<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'各条支路的功率损耗DS为（顺序同您输入B1时一样）:'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>nl
    <span class="token keyword">if</span> <span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span>
        p<span class="token operator">=</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> p<span class="token operator">=</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token function">B1</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span>
    <span class="token function">DS</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">Si</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">Sj</span><span class="token punctuation">(</span>q<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">disp</span><span class="token punctuation">(</span><span class="token function">DS</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>ICT1
    <span class="token function">Cs</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">i</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'这是每次迭代后各节点的电压值(如图所示)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>Cs<span class="token punctuation">,</span>Dy<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'迭代次数'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'电压'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'电压迭代次数曲线'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<h2><a id="_224"></a>二、输入原始数据</h2> 
<p>1）节点数<mark>n=5</mark>；<br> 2）支路数<mark>nl=5</mark>；<br> 3）支路参数矩阵<mark>B1=[1,2,0.03i,0,1.05,0;2,3,0.08i+0.3i,0.5i,1,1;2,4,0.1+0.35i,0,1,1;3,4,0.04+0.25i,0.5i,1,1;3,5,0.015i,0,1.05,1]</mark><br> 它包括六个数据[i,j,z,b,t,it],i,j为支路两端节点号,z为支路的阻抗，b为线路电纳,t为变比,it为高低压侧标志（高为1，低为0）。<br> 4）初始给定值矩阵<mark>B2=[0,0,1.05,1.05,0,1;0,3.7+1.3i,1,1.05,0,2;0,2+1i,1,1.05,0,2;0,1.6+0.8i,1,1.05,0,2;5,0,1.05,1.05,0,3]</mark><br> ①节点所接发电机功率SG<br> ②节点负荷功率SL<br> ③节点电压的初始值<br> ④PV节点电压的给定值<br> ⑤节点所接无功补偿设备的容量<br> ⑥节点编号igl<br> 平衡节点为1，PQ节点为2，PV节点为3<br> 5）节点对地阻抗矩阵<mark>X=[1,0;2,0;3,0;4,0;5,0]</mark>（由节点号与接地阻抗构成）。<br> 6）收敛精度 pr=1e-6（一般来说工程上是1e-6到1e-7）</p> 
<p><img src="https://images2.imgbox.com/af/3c/UJj31G25_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_241"></a>三、所求潮流计算</h2> 
<p><img src="https://images2.imgbox.com/94/d6/b1XduR2H_o.png" alt="在这里插入图片描述"><br> 每次迭代后各节点电压值<br> <img src="https://images2.imgbox.com/00/37/YGY6nxxU_o.png" alt=""></p> 
<hr> 
<h2><a id="_250"></a>总结</h2> 
<p>通过不断迭代，牛拉法可以得到电力系统潮流的准确解。它是一种常用且有效的方法，可用于计算电力系统的稳态运行状态。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6fc1d9e6973f20b03176fbd9816f036a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">开源C&#43;&#43;智能语音识别库whisper.cpp开发使用入门</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e095e06a25b5a2e6b63fb3f1ba046b8e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">昇思25天学习打卡营第3天|数据集全攻略：加载、操作与自定义</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>