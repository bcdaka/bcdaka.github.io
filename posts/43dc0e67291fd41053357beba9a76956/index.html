<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>YOLOv8åˆ¶ä½œè‡ªå·±çš„å®ä¾‹åˆ†å‰²æ•°æ®é›†ä¿å§†çº§æ•™ç¨‹ï¼ˆåŒ…å«jsonè½¬txtï¼‰ - ç¼–ç¨‹å¤§å’–</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/43dc0e67291fd41053357beba9a76956/">
  <meta property="og:site_name" content="ç¼–ç¨‹å¤§å’–">
  <meta property="og:title" content="YOLOv8åˆ¶ä½œè‡ªå·±çš„å®ä¾‹åˆ†å‰²æ•°æ®é›†ä¿å§†çº§æ•™ç¨‹ï¼ˆåŒ…å«jsonè½¬txtï¼‰">
  <meta property="og:description" content="1.æ•°æ®å‡†å¤‡ é¦–å…ˆå¯¹åŸå§‹æ•°æ®é›†è¿›è¡Œæ•´ç†ï¼Œå°†æ ‡æ³¨å¥½çš„å›¾åƒå’Œæ ‡ç­¾åˆ†åˆ«æ”¾åœ¨ä¸¤ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼ŒåŒæ—¶é¢å¤–æ–°å»ºä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œç”¨äºå­˜æ”¾è½¬æ¢å®Œçš„æ ‡ç­¾ä¸åˆ’åˆ†åçš„æ•°æ®é›†ã€‚
1.1å°†jsonæ ¼å¼æ–‡ä»¶è½¬æ¢ä¸ºtxtæ ¼å¼ æ–°å»ºjson2txt.pyæ–‡ä»¶ï¼Œå°†ä»£ç ä¸­çš„æ–‡ä»¶è·¯å¾„ä¿®æ”¹ä¸ºè‡ªå·±çš„è·¯å¾„ã€‚
â—â—â—ä»£ç ä¸­ç¬¬43è¡Œçš„classesä¸­å­˜æ”¾çš„æ˜¯è‡ªå·±æ•°æ®é›†çš„åˆ†ç±»æ ‡ç­¾ï¼Œè®°å¾—ä¿®æ”¹æˆè‡ªå·±çš„ã€‚
import json import os from tqdm import tqdm def convert_label(json_dir, save_dir, classes): json_paths = os.listdir(json_dir) classes = classes.split(&#39;,&#39;) for json_path in tqdm(json_paths): path = os.path.join(json_dir, json_path) with open(path, &#39;r&#39;) as load_f: json_dict = json.load(load_f) h, w = json_dict[&#39;imageHeight&#39;], json_dict[&#39;imageWidth&#39;] # save txt path txt_path = os.path.join(save_dir, json_path.replace(&#39;json&#39;, &#39;txt&#39;)) txt_file = open(txt_path, &#39;w&#39;) for shape_dict in json_dict[&#39;shapes&#39;]: label = shape_dict[&#39;label&#39;] label_index = classes.index(label) points = shape_dict[&#39;points&#39;] points_nor_list = [] for point in points: points_nor_list.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-24T11:03:34+08:00">
    <meta property="article:modified_time" content="2024-05-24T11:03:34+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§å’–" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§å’–</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">YOLOv8åˆ¶ä½œè‡ªå·±çš„å®ä¾‹åˆ†å‰²æ•°æ®é›†ä¿å§†çº§æ•™ç¨‹ï¼ˆåŒ…å«jsonè½¬txtï¼‰</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>1.æ•°æ®å‡†å¤‡</h2> 
<p>é¦–å…ˆå¯¹åŸå§‹æ•°æ®é›†è¿›è¡Œæ•´ç†ï¼Œå°†æ ‡æ³¨å¥½çš„å›¾åƒå’Œæ ‡ç­¾åˆ†åˆ«æ”¾åœ¨ä¸¤ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼ŒåŒæ—¶é¢å¤–æ–°å»ºä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œç”¨äºå­˜æ”¾è½¬æ¢å®Œçš„æ ‡ç­¾ä¸åˆ’åˆ†åçš„æ•°æ®é›†ã€‚</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/ac/1a/pyEXjd2d_o.png"></p> 
<h3>1.1å°†jsonæ ¼å¼æ–‡ä»¶è½¬æ¢ä¸ºtxtæ ¼å¼</h3> 
<p>æ–°å»ºjson2txt.pyæ–‡ä»¶ï¼Œå°†ä»£ç ä¸­çš„æ–‡ä»¶è·¯å¾„ä¿®æ”¹ä¸ºè‡ªå·±çš„è·¯å¾„ã€‚</p> 
<p>â—â—â—ä»£ç ä¸­ç¬¬43è¡Œçš„classesä¸­å­˜æ”¾çš„æ˜¯è‡ªå·±æ•°æ®é›†çš„åˆ†ç±»æ ‡ç­¾ï¼Œè®°å¾—ä¿®æ”¹æˆè‡ªå·±çš„ã€‚</p> 
<pre><code class="language-python">import json
import os
from tqdm import tqdm


def convert_label(json_dir, save_dir, classes):
    json_paths = os.listdir(json_dir)
    classes = classes.split(',')

    for json_path in tqdm(json_paths):

        path = os.path.join(json_dir, json_path)
        with open(path, 'r') as load_f:
            json_dict = json.load(load_f)
        h, w = json_dict['imageHeight'], json_dict['imageWidth']

        # save txt path
        txt_path = os.path.join(save_dir, json_path.replace('json', 'txt'))
        txt_file = open(txt_path, 'w')

        for shape_dict in json_dict['shapes']:
            label = shape_dict['label']
            label_index = classes.index(label)
            points = shape_dict['points']

            points_nor_list = []

            for point in points:
                points_nor_list.append(point[0] / w)
                points_nor_list.append(point[1] / h)

            points_nor_list = list(map(lambda x: str(x), points_nor_list))
            points_nor_str = ' '.join(points_nor_list)

            label_str = str(label_index) + ' ' + points_nor_str + '\n'
            txt_file.writelines(label_str)


if __name__ == "__main__":

    json_dir = 'E:/segmentation_dataset/json'
    save_dir = 'E:/segmentation_dataset/txt'
    classes = 'material,inner_material,hole'

    convert_label(json_dir, save_dir, classes)
</code></pre> 
<h3>1.2åˆ’åˆ†æ•°æ®é›†</h3> 
<p>æ–°å»ºsplitDataset.pyï¼Œå°†ä»£ç ä¸­çš„æ–‡ä»¶è·¯å¾„ä¿®æ”¹ä¸ºè‡ªå·±çš„è·¯å¾„ã€‚</p> 
<p>æ•°æ®é›†çš„åˆ’åˆ†æ¯”ä¾‹å¯ä»¥æŒ‰è‡ªå·±çš„éœ€æ±‚ä¿®æ”¹ã€‚</p> 
<pre><code class="language-python">import shutil
import random
import os


# æ£€æŸ¥æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨
def mkdir(path):
    if not os.path.exists(path):
        os.makedirs(path)


def split(image_dir, txt_dir, save_dir):
    # åˆ›å»ºæ–‡ä»¶å¤¹
    mkdir(save_dir)
    images_dir = os.path.join(save_dir, 'images')
    labels_dir = os.path.join(save_dir, 'labels')

    img_train_path = os.path.join(images_dir, 'train')
    img_test_path = os.path.join(images_dir, 'test')
    img_val_path = os.path.join(images_dir, 'val')

    label_train_path = os.path.join(labels_dir, 'train')
    label_test_path = os.path.join(labels_dir, 'test')
    label_val_path = os.path.join(labels_dir, 'val')

    mkdir(images_dir)
    mkdir(labels_dir)
    mkdir(img_train_path)
    mkdir(img_test_path)
    mkdir(img_val_path)
    mkdir(label_train_path)
    mkdir(label_test_path)
    mkdir(label_val_path)

    # æ•°æ®é›†åˆ’åˆ†æ¯”ä¾‹ï¼Œè®­ç»ƒé›†75%ï¼ŒéªŒè¯é›†15%ï¼Œæµ‹è¯•é›†15%ï¼ŒæŒ‰éœ€ä¿®æ”¹
    train_percent = 0.8
    val_percent = 0.1
    test_percent = 0.1

    total_txt = os.listdir(txt_dir)
    num_txt = len(total_txt)
    list_all_txt = range(num_txt)  # èŒƒå›´ range(0, num)

    num_train = int(num_txt * train_percent)
    num_val = int(num_txt * val_percent)
    num_test = num_txt - num_train - num_val

    train = random.sample(list_all_txt, num_train)
    # åœ¨å…¨éƒ¨æ•°æ®é›†ä¸­å–å‡ºtrain
    val_test = [i for i in list_all_txt if not i in train]
    # å†ä»val_testå–å‡ºnum_valä¸ªå…ƒç´ ï¼Œval_testå‰©ä¸‹çš„å…ƒç´ å°±æ˜¯test
    val = random.sample(val_test, num_val)

    print("è®­ç»ƒé›†æ•°ç›®ï¼š{}, éªŒè¯é›†æ•°ç›®ï¼š{},æµ‹è¯•é›†æ•°ç›®ï¼š{}".format(len(train), len(val), len(val_test) - len(val)))
    for i in list_all_txt:
        name = total_txt[i][:-4]

        srcImage = os.path.join(image_dir, name + '.jpg')
        srcLabel = os.path.join(txt_dir, name + '.txt')

        if i in train:
            dst_train_Image = os.path.join(img_train_path, name + '.jpg')
            dst_train_Label = os.path.join(label_train_path, name + '.txt')
            shutil.copyfile(srcImage, dst_train_Image)
            shutil.copyfile(srcLabel, dst_train_Label)
        elif i in val:
            dst_val_Image = os.path.join(img_val_path, name + '.jpg')
            dst_val_Label = os.path.join(label_val_path, name + '.txt')
            shutil.copyfile(srcImage, dst_val_Image)
            shutil.copyfile(srcLabel, dst_val_Label)
        else:
            dst_test_Image = os.path.join(img_test_path, name + '.jpg')
            dst_test_Label = os.path.join(label_test_path, name + '.txt')
            shutil.copyfile(srcImage, dst_test_Image)
            shutil.copyfile(srcLabel, dst_test_Label)


if __name__ == '__main__':

    image_dir = 'E:/segmentation_dataset/images'
    txt_dir = 'E:/segmentation_dataset/txt'
    save_dir = 'E:/segmentation_dataset/dataset'

    split(image_dir, txt_dir, save_dir)
</code></pre> 
<p><strong>è¿è¡Œå®Œåå¾—åˆ°å¦‚ä¸‹æ–‡ä»¶ï¼š</strong></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/a5/4f/XP861zFJ_o.png"></p> 
<p>datasetä¸­åˆ†åˆ«å­˜æ”¾æœ‰åˆ’åˆ†å¥½çš„å›¾ç‰‡æ•°æ®å’Œæ ‡æ³¨æ•°æ®ã€‚</p> 
<p><strong>åˆ°æ­¤ï¼Œæ•°æ®é›†åˆ¶ä½œå®Œæ¯•ï¼Â </strong></p> 
<h2><strong>2.</strong>è®­ç»ƒè®¾ç½®</h2> 
<h3>2.1æ–°å»ºsegmentation.yamlæ–‡ä»¶</h3> 
<p>Â æŒ‰ç…§å¦‚ä¸‹æ ¼å¼åœ¨yolov8å·¥ç¨‹çš„datasetsæ–‡ä»¶å¤¹ä¸‹è¿›è¡Œæ–°å»ºï¼Œè·¯å¾„ä¿®æ”¹ä¸ºè‡ªå·±çš„è·¯å¾„ï¼Œå¯¹åº”çš„åˆ†ç±»æ ‡ç­¾ä¹Ÿä¿®æ”¹ä¸ºè‡ªå·±çš„ã€‚</p> 
<pre><code class="language-python">train: E:\segmentation_dataset\dataset\images\train  # train images (relative to 'path') 128 images
val: E:\segmentation_dataset\dataset\images\val  # val images (relative to 'path') 128 images
test: E:\segmentation_dataset\dataset\images\test  # test images (optional)

# Classes
names:
  0: material
  1: inner_material
  2: hole
</code></pre> 
<h3>2.2è®­ç»ƒå‚æ•°è®¾ç½®Â </h3> 
<p>é…ç½®å‚æ•°å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p> 
<h3><img alt="" src="https://images2.imgbox.com/64/3d/UwFc9XiP_o.png"></h3> 
<p>Â ä»¥ä¸Šå¸¸ç”¨å‚æ•°è§£é‡Šå¦‚ä¸‹ï¼š</p> 
<p>ğŸ“Œtaskï¼šé€‰æ‹©ä»»åŠ¡ç±»å‹ï¼Œå¯é€‰['detect', 'segment', 'classify', 'pose']ã€‚</p> 
<p>ğŸ“Œmode: é€‰æ‹©æ˜¯è®­ç»ƒã€éªŒè¯ã€é¢„æµ‹å’Œå¯¼å‡ºæ¨¡å‹ç­‰ï¼Œå¯é€‰['train', 'val', 'predict', 'export', 'track', 'benchmark']ã€‚</p> 
<p>ğŸ“Œmodel: é€‰æ‹©yolov8ä¸åŒçš„æ¨¡å‹é…ç½®æ–‡ä»¶ï¼Œå¯é€‰yolov8s-seg.ptã€yolov8m-seg.ptã€yolov8x-seg.ptç­‰ï¼ˆæä¾›äº†nã€sã€mã€lã€xç‰ˆæœ¬ï¼Œéšç€æ¶æ„çš„å¢å¤§ï¼Œè®­ç»ƒæ—¶é—´ä¹Ÿæ˜¯é€æ¸å¢å¤§ï¼Œéœ€è¦æ ¹æ®è‡ªèº«è®¾å¤‡ç¡¬ä»¶é…ç½®åˆç†é€‰æ‹©ï¼‰ã€‚</p> 
<p>â—â—â—æ³¨æ„modelæœ€å¥½å»githubä¸Šæå‰ä¸‹è½½å¥½ï¼Œæ”¾åœ¨å¦‚å›¾æ‰€ç¤ºçš„æŒ‡å®šä½ç½®ï¼Œå¦‚æœæ²¡æå‰ä¸‹è½½è¿è¡Œæ—¶ä¼šè‡ªåŠ¨ä¸‹è½½ï¼Œä½†æ˜¯ä¸‹è½½é€Ÿåº¦å¯èƒ½éå¸¸éå¸¸æ…¢ã€‚</p> 
<p>yolov8å®˜æ–¹æƒé‡ä¸‹è½½åœ°å€ï¼š</p> 
<p><a class="link-info has-card" href="https://github.com/ultralytics/ultralytics?tab=readme-ov-file" title="https://github.com/ultralytics/ultralytics?tab=readme-ov-file"><span class="link-card-box"><span class="link-title">https://github.com/ultralytics/ultralytics?tab=readme-ov-file</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/be/4e/XGcfcoK0_o.png" alt="icon-default.png?t=N7T8">https://github.com/ultralytics/ultralytics?tab=readme-ov-file</span></span></a></p> 
<p>ğŸ“Œdata: é€‰æ‹©ç”Ÿæˆçš„æ•°æ®é›†é…ç½®æ–‡ä»¶ã€‚</p> 
<p>ğŸ“Œepochsï¼šè®­ç»ƒè¿‡ç¨‹ä¸­æ•´ä¸ªæ•°æ®é›†çš„è¿­ä»£æ¬¡æ•°ã€‚</p> 
<p>ğŸ“Œbatchï¼šä¸€æ¬¡çœ‹å®Œå¤šå°‘å¼ å›¾ç‰‡æ‰è¿›è¡Œæƒé‡æ›´æ–°ï¼Œæ¢¯åº¦ä¸‹é™çš„mini-batchï¼Œæç¤ºçˆ†æ˜¾å­˜å°±éœ€è¦è°ƒå°ä¸€ç‚¹ã€‚</p> 
<p>ğŸ“Œimgszï¼šè¾“å…¥å›¾ç‰‡çš„å°ºå¯¸å¤§å°ã€‚</p> 
<p>ğŸ“Œworkersï¼šç”¨äºæ•°æ®åŠ è½½çš„å·¥ä½œçº¿ç¨‹æ•°ã€‚</p> 
<p>ğŸ“Œprojectï¼šè®­ç»ƒå·¥ç¨‹åç§°ã€‚</p> 
<p>ğŸ“Œnameï¼šä¿å­˜è®­ç»ƒç»“æœçš„æ–‡ä»¶å¤¹åç§°ã€‚</p> 
<p>ğŸ“Œresumeï¼šä»æœ€åä¸€ä¸ªæ£€æŸ¥ç‚¹æ¢å¤è®­ç»ƒï¼Œå³æ¨¡å‹è®­ç»ƒçš„æ–­ç‚¹æ¥ç»­ï¼Œå¯é€‰Falseæˆ–Trueã€‚</p> 
<p><strong>å®Œæˆé…ç½®åï¼Œå¼€å§‹è¿›è¡Œè®­ç»ƒå³å¯ï¼</strong></p> 
<p><span style="color:#fe2c24;"><strong>å¦å¤–ï¼Œå¦‚æœæœ‰æƒ³äº†è§£yolov8ç›®æ ‡æ£€æµ‹æ•°æ®é›†åˆ¶ä½œä»¥åŠYOLOv8ç›®æ ‡æ£€æµ‹ opencvæ¨¡å‹éƒ¨ç½²çš„å°ä¼™ä¼´å¯ä»¥ç§»æ­¥æˆ‘çš„å…¶ä»–æ–‡ç« </strong></span></p> 
<p id="articleContentId"><strong><a class="link-info has-card" href="https://blog.csdn.net/m0_57010556/article/details/135460191?spm=1001.2014.3001.5502" title="YOLOv8åˆ¶ä½œè‡ªå·±çš„ç›®æ ‡æ£€æµ‹æ•°æ®é›†ä¿å§†çº§æ•™ç¨‹ï¼ˆåŒ…å«jsonè½¬xmlè½¬txtï¼‰"><span class="link-card-box"><span class="link-title">YOLOv8åˆ¶ä½œè‡ªå·±çš„ç›®æ ‡æ£€æµ‹æ•°æ®é›†ä¿å§†çº§æ•™ç¨‹ï¼ˆåŒ…å«jsonè½¬xmlè½¬txtï¼‰</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/7d/52/hc08jExk_o.png" alt="icon-default.png?t=N7T8">https://blog.csdn.net/m0_57010556/article/details/135460191?spm=1001.2014.3001.5502</span></span></a></strong></p> 
<p><a class="link-info has-card" href="https://blog.csdn.net/m0_57010556/article/details/139109317?spm=1001.2014.3001.5502" title="YOLOv8ç›®æ ‡æ£€æµ‹ opencvæ¨¡å‹éƒ¨ç½²ä¿å§†çº§æ•™ç¨‹ï¼ˆåŒ…å«opencvç¯å¢ƒé…ç½®ï¼‰"><span class="link-card-box"><span class="link-title">YOLOv8ç›®æ ‡æ£€æµ‹ opencvæ¨¡å‹éƒ¨ç½²ä¿å§†çº§æ•™ç¨‹ï¼ˆåŒ…å«opencvç¯å¢ƒé…ç½®ï¼‰</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/c8/5f/2FpVQHPT_o.png" alt="icon-default.png?t=N7T8">https://blog.csdn.net/m0_57010556/article/details/139109317?spm=1001.2014.3001.5502</span></span></a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/41db53590e5e8f0fb9769f568c11c247/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">å‰ç«¯é¡¹ç›®éƒ¨ç½²è‡ªåŠ¨æ£€æµ‹æ›´æ–°åé€šçŸ¥ç”¨æˆ·åˆ·æ–°é¡µé¢ï¼ˆå‰ç«¯å®ç°ï¼ŒæŠ€æœ¯æ¡†æ¶vueã€jsã€webpackï¼‰â€”â€”æ–¹æ¡ˆäºŒï¼šè½®è¯¢å»åˆ¤æ–­æœåŠ¡ç«¯çš„index.htmlæ˜¯å¦è·Ÿå½“å‰çš„index.htmlçš„è„šæœ¬hashå€¼ä¸€æ ·</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9d2cded2e4413803d95c574019f0dfb3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">C/C&#43;&#43;è¿è¡Œæ—¶åº“å’ŒUCRTç³»ç»Ÿé€šç”¨è¿è¡Œæ—¶åº“æ€»ç»“åŠé—®é¢˜å®ä¾‹åˆ†äº«</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§å’–.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>