<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于python的网络爬虫爬取天气数据及可视化分析（Matplotlib、sk-learn等，包括ppt，视频） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/91708876904cf15e28078b55d5c97228/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="基于python的网络爬虫爬取天气数据及可视化分析（Matplotlib、sk-learn等，包括ppt，视频）">
  <meta property="og:description" content="基于Python爬取天气数据信息与可视化分析（文末完整源码） 基于python的网络爬虫爬取天气数据及可视化分析
可以看看演示视频。 摘要 基于Python爬取天气数据信息与可视化分析
本论文旨在利用Python编程语言实现天气数据信息的爬取和可视化分析。天气数据对于人们的生活和各个领域都有着重要的影响，因此准确获取和有效分析天气数据对于气象预测、农业、旅游等方面至关重要。
在本文中，我们首先介绍了Python编程语言的基本原理和相关库的使用。Python作为一种简单易学且功能强大的编程语言，被广泛应用于数据处理和分析领域。通过使用Python，我们可以方便地进行网页爬取和数据处理。详细介绍了如何使用Python编写网络爬虫程序来获取天气数据。我们选择了一些知名的气象网站作为数据源，并通过分析网页结构和标签，准确提取所需的天气信息。通过编写自动化的爬虫程序，可以快速获取大量的天气数据。
我们介绍了如何使用Python的数据处理和分析库对获取的天气数据进行清理和整理。我们使用Pandas和NumPy等工具，去除重复数据、处理缺失值，并进行格式转换，确保数据的准确性和一致性。
最后，我们展示了如何使用Python的可视化库对清理后的天气数据进行可视化分析。我们使用Matplotlib库，绘制折线图、散点图等，展示不同时间段内的温度变化、湿度分布等。通过这些可视化图表，我们可以更直观地观察和分析天气数据，揭示其潜在的趋势和规律。
通过使用Python编程语言，我们可以快速获取和分析大量的天气数据，并通过可视化手段展示其特征和规律。这将有助于人们更好地理解和应用天气数据，从而做出更准确的决策和规划。
关键词：天气数据信息；处理数据信息；数据可视化分析；模型构建
第1章 引言 1.1 选题背景与意义 天气数据是人们日常生活中非常重要的信息之一，对于气象学、农业、城市规划、交通运输等领域都有着重要的影响。随着科技的发展，越来越多的天气数据可以通过互联网获取，而通过Python爬取天气数据并进行可视化分析就成为了一个热门的研究方向。
数据获取与处理：通过Python爬取天气数据，可以方便地获取到各种天气参数，如温度、湿度、降水量等。这些数据对于研究天气变化、分析气候模式、进行气象预测具有重要意义。
数据分析与模式识别：通过对爬取的天气数据进行统计分析和模式识别，可以揭示天气现象的规律性和周期性。这有助于理解天气变化的趋势和模式，为气象预测和应对天气变化提供参考。
可视化分析：通过将天气数据进行可视化分析，可以更直观地展示天气变化的趋势和模式。这有助于决策者更好地理解和利用天气信息，例如用于城市规划、交通运输等方面的决策制定。
因此，基于Python爬取天气数据并进行可视化分析作为本文选题具有重要的背景和意义，对于提高天气数据的利用价值以及相关领域的研究和应用都具有积极的推动作用。
1.3 本文的研究内容与主要工作 本文涵盖了气象数据的获取、处理与分析，以及基于历史天气数据进行的气候变化研究、预测模型建立等方面。在数据获取方面，使用各种方法从气象局、科研机构或第三方数据提供商获取历史天气数据。同时，也有研究对获取的数据进行清洗、整合和格式化处理，确保数据的可靠性和完整性。同时使用Python编程语言中的数据分析库（如pandas、numpy）和可视化库（如matplotlib）来进行历史天气数据的分析和可视化。这些工具可以帮助更好地理解数据中的规律和趋势，并生成直观的可视化图表。并且可以利用历史天气数据来研究气候变化趋势，包括全球范围的气候变化、特定地区的气候特征变化等。通过分析历史天气数据，可以发现气候变化的规律，并探讨其对生态环境、农业生产等方面的影响。除了纯粹的数据分析和可视化，还有建立气象数据的预测模型，以实现对未来天气情况的预测。这些模型通常基于历史气象数据和机器学习算法，能够为气象预报提供更准确的参考。
1.4 本文的论文结构与章节安排 本文共分为5章，章节内容安排如下：
第1章：引言第2章：历史天气网站数据的获取第3章：数据可视化分析与处理第4章：模型预测第5章：总结与展望 第2章 历史天气网站数据的获取 2.1 天气网站数据来源 数据来源:查看天气网网址：http://www.tianqi.com.cn。访问广东省东莞市的天气网址：https://lishi.tianqi.com/dongguan/index.html，利用Python的爬虫技术从网站上爬取东莞市2018-2023年天气数据信息。
2.2 利用Python进行数据爬取与数据处理 首先查看中国天气网的网址：https://lishi.tianqi.com/dongguan/index.html。访问广东省东莞市的天气信息，我们主要访问的是2023年中国天气网的天气数据，对东莞2023年1-11月份数据进行爬取。采用requests.get方法，请求网页，运行后显示成功访问，则得到的是网页的所有字符串文本。这就是请求过程。
采用xpath库对获取的字符串进行数据提取：首先对网页进行检查，找到需要获取数据的标签（截图举例说明）采用lxml解析HTML、XPath提取数据，通过循环调用getWeather函数,找到需要获取数据的标签，提取标签的数据值，保存到对应列表并进行切片处理。
2.3 数据存储与数据标准化处理 数据存储：将爬取的数据存储在CSV文件中，对数据进行了结构化处理,每个样本包含日期、最高气温、最低气温、天气状况、风向、风速6个特征数据。
数据标准化处理：对读取存储的CSV数据文件对数据进行格式化、清洗,去掉无效行等将数据转换为字典的格式,即每个字典代表一天的数据，字典的键和爬虫部分一致，但是值都转换为合适的类型，例如日期转换为datetime对象，温度转换为浮点数等，方便后续处理数据分析与可视化。
第3章 数据可视化分析与处理 3.1 利用matplotlib库绘制图像 折线图：采用matplotlib中plt.plot()方法分别制作出每月的温度变化曲线图，并用plt.plot()方法点出最高温和最低温，并分别画出最高温度线、最低温度线。
散点图：使用plt.scatter()方法将日期和时间为横坐标、温度为纵坐标，每天气温情况在图中绘制出来，展示相关数据。
饼状图：使用plt.pie()方法对每月天气状况进行了饼状图绘制，并且根据5个等级的不同。相应饼柱状图的颜色各异，更直观的显示天气状况。
热力图：使用plt.imshow()方法将日期和时间为横坐标、温度范围为纵坐标，整合最高温度和最低温度数据。
3D立体图：使用ax.plot_trisurf和ax.grid方法绘制月最高温和最低温3D曲面图。
（说明，这里本来要做抓取12个月 每个月份生成一张对应的可视化图，再将这些可视化图合作一个GIF动态图，达到类似轮播图的效果。直到我刚好看见一个动态图，有了新的想法。。。）
3.2 生成静态词云与动态词语图 使用wordcloud库，创建WordCloud对象，设置参数生成词云图，使用一个热门表情包作为遮罩图片，使词云图更具特色，增强观感，吸引注意力，添加趣味性。并将词云图保存到指定的路径。
最后，我们需要制作词云动图，包括：
分解GIF帧：用opencv读取热门表情包的GIF图片，保存每一帧为图片，作为遮罩图片的序列。生成词云：对每张遮罩图片调用词云生成函数， 生成对应的词云图片，作为词云图片的序列。拼接GIF：用imageio库将词云图片的序列顺序拼接成GIF图片，并保存到指定的路径。
第4章 模型预测 4.1 构建和训练模型的设计 构建模型：使用sklearn库构建一个线性回归模型，设置参数。
训练模型：将训练集的X和Y传入，训练模型，得到模型的参数。预测模型：使用predict()方法，将测试集的X传入，得到预测Y，与测试集的真实Y进行比较，评估模型的性能。
4.2 绘制散点图一元回归线图 绘制散点图：使用matplotlib库绘制散点图，展示东莞市每一天的日期和平均温度的关系，用不同的颜色区分训练集和测试集。绘制回归线：使用matplotlib库绘制回归线，展示模型的分析结果，用不同的颜色区分训练集和测试集。设置图表：设置合适的标题、图例、坐标轴标签等，使图表清晰易懂。并将图表保存到指定的路径。
第5章 总结与展望 5.1 工作总结 在文中，我们旨在利用爬取的历史天气数据进行可视化分析。首先，我们选择了一个可靠的数据源，并使用Python编程语言和BeautifulSoup库实现了数据的爬取。接着，我们对原始数据进行了清洗和处理，包括缺失值的处理和数据格式转换。然后，我们采用了Matplotlib可视化工具，设计了多种图表类型，如折线图、柱状图和热力图，以展示历史天气数据的趋势和变化。通过分析结果，我们发现了不同时间段内温度、天气状况等指标的变化情况，并与历史数据进行了比较。总的来说，本次研究通过爬取历史天气数据并进行可视化分析，为相关领域的研究提供了有益的参考和启示。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-12-21T15:25:03+08:00">
    <meta property="article:modified_time" content="2023-12-21T15:25:03+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于python的网络爬虫爬取天气数据及可视化分析（Matplotlib、sk-learn等，包括ppt，视频）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Python_0"></a>基于Python爬取天气数据信息与可视化分析（文末完整源码）</h2> 
<p></p> 
<div class="csdn-video-box"> 
 <iframe id="c2W6Un0f-1703141859323" frameborder="0" src="https://live.csdn.net/v/embed/353496" allowfullscreen="true" data-mediaembed="csdn"></iframe> 
 <p>基于python的网络爬虫爬取天气数据及可视化分析</p> 
</div> 
<br> 可以看看演示视频。 
<p></p> 
<h3><a id="_6"></a>摘要</h3> 
<p>基于Python爬取天气数据信息与可视化分析</p> 
<p>本论文旨在利用Python编程语言实现天气数据信息的爬取和可视化分析。天气数据对于人们的生活和各个领域都有着重要的影响，因此准确获取和有效分析天气数据对于气象预测、农业、旅游等方面至关重要。</p> 
<p>在本文中，我们首先介绍了Python编程语言的基本原理和相关库的使用。Python作为一种简单易学且功能强大的编程语言，被广泛应用于数据处理和分析领域。通过使用Python，我们可以方便地进行网页爬取和数据处理。详细介绍了如何使用Python编写网络爬虫程序来获取天气数据。我们选择了一些知名的气象网站作为数据源，并通过分析网页结构和标签，准确提取所需的天气信息。通过编写自动化的爬虫程序，可以快速获取大量的天气数据。</p> 
<p>我们介绍了如何使用Python的数据处理和分析库对获取的天气数据进行清理和整理。我们使用Pandas和NumPy等工具，去除重复数据、处理缺失值，并进行格式转换，确保数据的准确性和一致性。</p> 
<p>最后，我们展示了如何使用Python的可视化库对清理后的天气数据进行可视化分析。我们使用Matplotlib库，绘制折线图、散点图等，展示不同时间段内的温度变化、湿度分布等。通过这些可视化图表，我们可以更直观地观察和分析天气数据，揭示其潜在的趋势和规律。</p> 
<p>通过使用Python编程语言，我们可以快速获取和分析大量的天气数据，并通过可视化手段展示其特征和规律。这将有助于人们更好地理解和应用天气数据，从而做出更准确的决策和规划。</p> 
<p>关键词：天气数据信息；处理数据信息；数据可视化分析；模型构建</p> 
<h3><a id="1__23"></a>第1章 引言</h3> 
<h4><a id="11__26"></a>1.1 选题背景与意义</h4> 
<p>天气数据是人们日常生活中非常重要的信息之一，对于气象学、农业、城市规划、交通运输等领域都有着重要的影响。随着科技的发展，越来越多的天气数据可以通过互联网获取，而通过Python爬取天气数据并进行可视化分析就成为了一个热门的研究方向。</p> 
<p>数据获取与处理：通过Python爬取天气数据，可以方便地获取到各种天气参数，如温度、湿度、降水量等。这些数据对于研究天气变化、分析气候模式、进行气象预测具有重要意义。</p> 
<p>数据分析与模式识别：通过对爬取的天气数据进行统计分析和模式识别，可以揭示天气现象的规律性和周期性。这有助于理解天气变化的趋势和模式，为气象预测和应对天气变化提供参考。</p> 
<p>可视化分析：通过将天气数据进行可视化分析，可以更直观地展示天气变化的趋势和模式。这有助于决策者更好地理解和利用天气信息，例如用于城市规划、交通运输等方面的决策制定。</p> 
<p>因此，基于Python爬取天气数据并进行可视化分析作为本文选题具有重要的背景和意义，对于提高天气数据的利用价值以及相关领域的研究和应用都具有积极的推动作用。</p> 
<h4><a id="13__38"></a>1.3 本文的研究内容与主要工作</h4> 
<p>本文涵盖了气象数据的获取、处理与分析，以及基于历史天气数据进行的气候变化研究、预测模型建立等方面。在数据获取方面，使用各种方法从气象局、科研机构或第三方数据提供商获取历史天气数据。同时，也有研究对获取的数据进行清洗、整合和格式化处理，确保数据的可靠性和完整性。同时使用Python编程语言中的数据分析库（如pandas、numpy）和可视化库（如matplotlib）来进行历史天气数据的分析和可视化。这些工具可以帮助更好地理解数据中的规律和趋势，并生成直观的可视化图表。并且可以利用历史天气数据来研究气候变化趋势，包括全球范围的气候变化、特定地区的气候特征变化等。通过分析历史天气数据，可以发现气候变化的规律，并探讨其对生态环境、农业生产等方面的影响。除了纯粹的数据分析和可视化，还有建立气象数据的预测模型，以实现对未来天气情况的预测。这些模型通常基于历史气象数据和机器学习算法，能够为气象预报提供更准确的参考。</p> 
<h4><a id="14__42"></a>1.4 本文的论文结构与章节安排</h4> 
<p>本文共分为5章，章节内容安排如下：</p> 
<ul><li>第1章：引言</li><li>第2章：历史天气网站数据的获取</li><li>第3章：数据可视化分析与处理</li><li>第4章：模型预测</li><li>第5章：总结与展望</li></ul> 
<h3><a id="2__52"></a>第2章 历史天气网站数据的获取</h3> 
<h4><a id="21__55"></a>2.1 天气网站数据来源</h4> 
<p>数据来源:查看天气网网址：<a href="http://www.tianqi.com.cn" rel="nofollow">http://www.tianqi.com.cn</a>。访问广东省东莞市的天气网址：<a href="https://lishi.tianqi.com/dongguan/index.html" rel="nofollow">https://lishi.tianqi.com/dongguan/index.html</a>，利用Python的爬虫技术从网站上爬取东莞市2018-2023年天气数据信息。</p> 
<h4><a id="22_Python_59"></a>2.2 利用Python进行数据爬取与数据处理</h4> 
<p>首先查看中国天气网的网址：<a href="https://lishi.tianqi.com/dongguan/index.html" rel="nofollow">https://lishi.tianqi.com/dongguan/index.html</a>。访问广东省东莞市的天气信息，我们主要访问的是2023年中国天气网的天气数据，对东莞2023年1-11月份数据进行爬取。采用requests.get方法，请求网页，运行后显示成功访问，则得到的是网页的所有字符串文本。这就是请求过程。<br> <img src="https://images2.imgbox.com/f7/53/5bxgopUQ_o.png" alt="在这里插入图片描述"><br> 采用xpath库对获取的字符串进行数据提取：首先对网页进行检查，找到需要获取数据的标签（截图举例说明）采用lxml解析HTML、XPath提取数据，通过循环调用getWeather函数,找到需要获取数据的标签，提取标签的数据值，保存到对应列表并进行切片处理。<br> <img src="https://images2.imgbox.com/da/c8/YRbVeDue_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="23__66"></a>2.3 数据存储与数据标准化处理</h4> 
<p>数据存储：将爬取的数据存储在CSV文件中，对数据进行了结构化处理,每个样本包含日期、最高气温、最低气温、天气状况、风向、风速6个特征数据。<br> <img src="https://images2.imgbox.com/bb/e1/4uyDr5vR_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/ab/a0/eLK0tdM7_o.png" alt="在这里插入图片描述"></p> 
<p>数据标准化处理：对读取存储的CSV数据文件对数据进行格式化、清洗,去掉无效行等将数据转换为字典的格式,即每个字典代表一天的数据，字典的键和爬虫部分一致，但是值都转换为合适的类型，例如日期转换为datetime对象，温度转换为浮点数等，方便后续处理数据分析与可视化。<br> <img src="https://images2.imgbox.com/b8/7a/Cost1yKe_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3__75"></a>第3章 数据可视化分析与处理</h3> 
<h4><a id="31_matplotlib_78"></a>3.1 利用matplotlib库绘制图像</h4> 
<p>折线图：采用matplotlib中plt.plot()方法分别制作出每月的温度变化曲线图，并用plt.plot()方法点出最高温和最低温，并分别画出最高温度线、最低温度线。<br> <img src="https://images2.imgbox.com/c6/d5/2ItgC3Ni_o.jpg" alt="示例"></p> 
<p>散点图：使用plt.scatter()方法将日期和时间为横坐标、温度为纵坐标，每天气温情况在图中绘制出来，展示相关数据。<br> <img src="https://images2.imgbox.com/54/63/jbnNNql5_o.jpg" alt="在这里插入图片描述"></p> 
<p>饼状图：使用plt.pie()方法对每月天气状况进行了饼状图绘制，并且根据5个等级的不同。相应饼柱状图的颜色各异，更直观的显示天气状况。<br> <img src="https://images2.imgbox.com/15/2e/ZhTEK5MS_o.jpg" alt="在这里插入图片描述"></p> 
<p>热力图：使用plt.imshow()方法将日期和时间为横坐标、温度范围为纵坐标，整合最高温度和最低温度数据。<br> <img src="https://images2.imgbox.com/2c/cc/I9P11r7N_o.jpg" alt="在这里插入图片描述"></p> 
<p>3D立体图：使用ax.plot_trisurf和ax.grid方法绘制月最高温和最低温3D曲面图。<br> <img src="https://images2.imgbox.com/93/09/fSjb8M7p_o.jpg" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/ec/1d/4PvnecWJ_o.jpg" alt="在这里插入图片描述"><br> <s><em>（说明，这里本来要做抓取12个月 每个月份生成一张对应的可视化图，再将这些可视化图合作一个GIF动态图，达到类似轮播图的效果。直到我刚好看见一个动态图，有了新的想法。。。）</em></s></p> 
<h4><a id="32__95"></a>3.2 生成静态词云与动态词语图</h4> 
<p>使用wordcloud库，创建WordCloud对象，设置参数生成词云图，使用一个<strong>热门表情包</strong>作为遮罩图片，使词云图更具特色，<strong>增强观感，吸引注意力，添加趣味性</strong>。并将词云图保存到指定的路径。<br> <img src="https://images2.imgbox.com/50/a0/zeAhKS66_o.jpg" alt="在这里插入图片描述"></p> 
<p>最后，我们需要制作词云动图，包括：</p> 
<ul><li>分解GIF帧：用opencv读取热门表情包的GIF图片，保存每一帧为图片，作为遮罩图片的序列。</li><li>生成词云：对每张遮罩图片调用词云生成函数， 生成对应的词云图片，作为词云图片的序列。</li><li>拼接GIF：用imageio库将词云图片的序列顺序拼接成GIF图片，并保存到指定的路径。<br> <img src="https://images2.imgbox.com/4f/83/ZpkLlcBv_o.gif" alt="在这里插入图片描述"></li></ul> 
<h3><a id="4__107"></a>第4章 模型预测</h3> 
<h4><a id="41__110"></a>4.1 构建和训练模型的设计</h4> 
<p>构建模型：使用sklearn库构建一个线性回归模型，设置参数。</p> 
<ul><li>训练模型：将训练集的X和Y传入，训练模型，得到模型的参数。</li><li>预测模型：使用predict()方法，将测试集的X传入，得到预测Y，与测试集的真实Y进行比较，评估模型的性能。<br> <img src="https://images2.imgbox.com/d5/91/PqojkocH_o.png" alt="在这里插入图片描述"></li></ul> 
<h4><a id="42__118"></a>4.2 绘制散点图一元回归线图</h4> 
<ul><li>绘制散点图：使用matplotlib库绘制散点图，展示东莞市每一天的日期和平均温度的关系，用不同的颜色区分训练集和测试集。</li><li>绘制回归线：使用matplotlib库绘制回归线，展示模型的分析结果，用不同的颜色区分训练集和测试集。</li><li>设置图表：设置合适的标题、图例、坐标轴标签等，使图表清晰易懂。并将图表保存到指定的路径。<br> <img src="https://images2.imgbox.com/49/9f/1jVZJp0I_o.png" alt="在这里插入图片描述"></li></ul> 
<h3><a id="5__125"></a>第5章 总结与展望</h3> 
<h4><a id="51__128"></a>5.1 工作总结</h4> 
<p>在文中，我们旨在利用爬取的历史天气数据进行可视化分析。首先，我们选择了一个可靠的数据源，并使用Python编程语言和BeautifulSoup库实现了数据的爬取。接着，我们对原始数据进行了清洗和处理，包括缺失值的处理和数据格式转换。然后，我们采用了Matplotlib可视化工具，设计了多种图表类型，如折线图、柱状图和热力图，以展示历史天气数据的趋势和变化。通过分析结果，我们发现了不同时间段内温度、天气状况等指标的变化情况，并与历史数据进行了比较。总的来说，本次研究通过爬取历史天气数据并进行可视化分析，为相关领域的研究提供了有益的参考和启示。</p> 
<p>一些参考链接<br> [1]python Matplotlib库:根据excel生成各种柱状图：https://mp.weixin.qq.com/s/lhOB8XO2zhjLRQZVqQe9sg<br> [2]踏入数据可视化的世界：Matplotlib库的完整学习指南：https://mp.weixin.qq.com/s/uUWQti7lXuS2CE7SU2FnjQ<br> [3]使用Python可视化CSV文件数据：https://mp.weixin.qq.com/s/iKxP-8FIdGyi8F6kRCCouA<br> [4]Python数据可视化-词云：https://mp.weixin.qq.com/s/kz9zBYwN3HDm9vESJ5VqgQ<br> [5]Python 实现图片转字符画，静态图、GIF 都能转：https://mp.weixin.qq.com/s/bzgpstD5_u6z75FvXYhVQg<br> [6]【python】4行代码实现将多张图片合成gif动图（imageio）：https://mp.weixin.qq.com/s/LIlX8eu6MOhwa32ZS19kIQ<br> [7] Python基础教程:强大的Pandas数据分析库: http://www.poycode.cn/coding/python/python-basic-tutorial-18/<br> [8]Python基础教程:sklearn机器学习入门：https://mp.weixin.qq.com/s/8PoPxaR2R25krNt7H44zZA<br> [9]学习 Scikit-learn，从这 5 个步骤开始：https://mp.weixin.qq.com/s/QTacqEFJcdUoQsrwe3jjUw<br> [10] sklearn: https://scikit-learn.org/stable/index.html</p> 
<p>**<br> 说明：这只是一个学了十一二周python的课程大作业，<br> 并不是真的毕业论文，只是学校要求按照毕业论文的格式写。</p> 
<h3><a id="_148"></a><strong>完整代码如下</strong></h3> 
<p>各部分懒得封装了，使用jupyter依次运行即可。<br> 加了一些注释，方便阅读。<br> **</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests  
<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree  
<span class="token keyword">import</span> csv  
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np  
<span class="token keyword">from</span> collections <span class="token keyword">import</span> defaultdict 
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime  
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt  
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> font_manager  
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> rcParams  
<span class="token keyword">from</span> mpl_toolkits<span class="token punctuation">.</span>mplot3d <span class="token keyword">import</span> Axes3D  用于创建3D图形
<span class="token keyword">import</span> imageio<span class="token punctuation">.</span>v2 <span class="token keyword">as</span> imageio  
<span class="token keyword">from</span> IPython<span class="token punctuation">.</span>display <span class="token keyword">import</span> Image<span class="token punctuation">,</span> display 
<span class="token keyword">from</span> wordcloud <span class="token keyword">import</span> WordCloud  
<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image
<span class="token comment"># 设置字体为支持减号的字体，例如"SimHei"</span>
rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span>
font <span class="token operator">=</span> font_manager<span class="token punctuation">.</span>FontProperties<span class="token punctuation">(</span>fname<span class="token operator">=</span><span class="token string">"C:/Windows/Fonts/simsun.ttc"</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>  <span class="token comment"># 请将路径替换为你的字体文件路径</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>  <span class="token comment"># 解决保存图像时负号'-'显示为方块的问题</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">getWeather</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 请求头信息:浏览器版本型号,接收数据的编码格式</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment"># 必填,不填拿不到数据</span>
            <span class="token comment"># 'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.1 (KHTML, like Gecko) Chrome/14.0.835.163 Safari/535.1',</span>
            <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36'</span>
        <span class="token punctuation">}</span>
        <span class="token comment"># 请求 接收到了响应数据</span>
    resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>    
     
    <span class="token comment"># 使用lxml解析HTML    </span>
    tree <span class="token operator">=</span> lxml<span class="token punctuation">.</span>html<span class="token punctuation">.</span>fromstring<span class="token punctuation">(</span>resp<span class="token punctuation">.</span>text<span class="token punctuation">)</span>      
    resp_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">"//ul[@class='thrui']/li"</span><span class="token punctuation">)</span>  
      
    <span class="token comment"># for循环迭代遍历  </span>
    day_weather_info <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> li <span class="token keyword">in</span> resp_list<span class="token punctuation">:</span>        
        dates <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'.//div[@class="th200"]/text()'</span><span class="token punctuation">)</span>  <span class="token comment"># 提取日期        </span>
        max_temperatures <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'.//div[@class="th140"]/text()'</span><span class="token punctuation">)</span>  <span class="token comment"># 提取最高气温        </span>
        min_temperatures <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'.//div[@class="th140"][2]/text()'</span><span class="token punctuation">)</span>  <span class="token comment"># 提取最低气温        </span>
        weather_conditions <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'.//div[@class="th140"][3]/text()'</span><span class="token punctuation">)</span>  <span class="token comment"># 提取天气情况   </span>
        wind_directions <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'.//div[@class="th140"][4]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># 提取风向        </span>
        wind_speeds <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'.//div[@class="th140"][4]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment"># 提取风速    </span>
          
        <span class="token comment"># 将提取的信息存储到day_weather_info列表中  </span>
        day_weather_info<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>  
            <span class="token string">"日期"</span><span class="token punctuation">:</span> dates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  
            <span class="token string">"最高气温"</span><span class="token punctuation">:</span> max_temperatures<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  
            <span class="token string">"最低气温"</span><span class="token punctuation">:</span> min_temperatures<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  
            <span class="token string">"天气情况"</span><span class="token punctuation">:</span> weather_conditions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  
            <span class="token string">"风向"</span><span class="token punctuation">:</span> wind_directions<span class="token punctuation">,</span>  
            <span class="token string">"风速"</span><span class="token punctuation">:</span> wind_speeds  
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> day_weather_info

</code></pre> 
<pre><code class="prism language-python">weathers <span class="token operator">=</span> <span class="token punctuation">[</span>getWeather<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'https://lishi.tianqi.com/dongguan/2023</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token builtin">str</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">.html'</span></span><span class="token punctuation">)</span> <span class="token keyword">for</span> month <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>weathers<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 数据写入(一次性写入)</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"test01_weather.csv"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">,</span>newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">as</span> csvfile<span class="token punctuation">:</span>
    writer <span class="token operator">=</span> csv<span class="token punctuation">.</span>writer<span class="token punctuation">(</span>csvfile<span class="token punctuation">)</span>
    <span class="token comment"># 先写入列名:columns_name 日期 最高气温 最低气温  天气</span>
    writer<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"日期"</span><span class="token punctuation">,</span> <span class="token string">"最高气温"</span><span class="token punctuation">,</span> <span class="token string">"最低气温"</span><span class="token punctuation">,</span> <span class="token string">'天气'</span><span class="token punctuation">,</span><span class="token string">"风向"</span><span class="token punctuation">,</span><span class="token string">"风速"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># 一次写入多行用writerows(写入的数据类型是列表,一个列表对应一行)</span>
    writer<span class="token punctuation">.</span>writerows<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">list</span><span class="token punctuation">(</span>day_weather_dict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> month_weather <span class="token keyword">in</span> weathers <span class="token keyword">for</span> day_weather_dict <span class="token keyword">in</span> month_weather<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"写入成功！"</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 读取数据</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"weather.csv"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">as</span> csvfile<span class="token punctuation">:</span>
<span class="token comment"># with open("weather_test.csv", "r", newline='') as csvfile:</span>
    reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>csvfile<span class="token punctuation">)</span>
    <span class="token comment"># 跳过列名</span>
    <span class="token comment"># next(reader)</span>
    <span class="token comment"># 逐行读取数据</span>
    read <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token comment"># for row in reader:</span>
    <span class="token comment">#     if row:  # 检查行是否为空</span>
    <span class="token comment">#         read.append(row)</span>
    read <span class="token operator">=</span> <span class="token punctuation">[</span>
        row <span class="token keyword">for</span> row <span class="token keyword">in</span> reader <span class="token comment"># 检查行是否为空</span>
        <span class="token keyword">if</span> <span class="token builtin">any</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> cell <span class="token keyword">in</span> row<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"读取成功!"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>read<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 数据标准化处理</span>
original_data <span class="token operator">=</span> read

<span class="token comment"># 初始化一个空列表来存储处理后的数据</span>
formatted_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token comment"># 遍历原始数据</span>
<span class="token keyword">for</span> item <span class="token keyword">in</span> original_data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>  <span class="token comment"># 从第二行开始，因为第一行是表头</span>
    formatted_item <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'日期时间'</span><span class="token punctuation">:</span> item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'最高温度'</span><span class="token punctuation">:</span> item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'最低温度'</span><span class="token punctuation">:</span> item<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'天气状况'</span><span class="token punctuation">:</span> item<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    formatted_data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>formatted_item<span class="token punctuation">)</span>
<span class="token comment"># 打印处理后的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>formatted_data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>date_time<span class="token punctuation">,</span>high_temp<span class="token punctuation">,</span>low_temp<span class="token punctuation">,</span>weather<span class="token punctuation">)</span><span class="token punctuation">:</span>

<span class="token comment"># 绘制折线图</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>date_time<span class="token punctuation">,</span> high_temp<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'最高温度'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>date_time<span class="token punctuation">,</span> low_temp<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'最低温度'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'日期时间'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'温度'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'月最高温度和最低温度折线图'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'./show/plot_'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'.jpg'</span><span class="token punctuation">)</span>  <span class="token comment"># 将图片保存</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># print('plot_'+str(month)+'.jpg保存成功！')</span>

<span class="token comment"># 使用scatter()函数绘制散点图</span>
    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>date_time<span class="token punctuation">,</span> high_temp<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'最高温度'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>date_time<span class="token punctuation">,</span> low_temp<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'最低温度'</span><span class="token punctuation">)</span>
    <span class="token comment"># 添加颜色条</span>
    cbar <span class="token operator">=</span> plt<span class="token punctuation">.</span>colorbar<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cbar<span class="token punctuation">.</span>set_label<span class="token punctuation">(</span><span class="token string">'Color Intensity'</span><span class="token punctuation">)</span>
    <span class="token comment"># 设置标题和标签</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'月最高温度和最低温度散点图'</span><span class="token punctuation">)</span>
    <span class="token comment"># 设置x轴和y轴的标签</span>
    plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'日期时间'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'温度'</span><span class="token punctuation">)</span>
    <span class="token comment"># 添加图例</span>
    plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'./show/scatter_'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'.jpg'</span><span class="token punctuation">)</span>  <span class="token comment"># 将图片保存</span>
    <span class="token comment"># 显示图形</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># print('scatter_'+str(month)+'.jpg保存成功！')</span>

<span class="token comment"># 绘制饼状图</span>
    <span class="token comment"># 提取数据</span>
    weather <span class="token operator">=</span> <span class="token punctuation">[</span>item<span class="token punctuation">[</span><span class="token string">'天气状况'</span><span class="token punctuation">]</span> <span class="token keyword">for</span> item <span class="token keyword">in</span> monthly_data<span class="token punctuation">[</span>month<span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token comment"># 计算每个天气状况的数量</span>
    weather_counts <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>weather_type<span class="token punctuation">:</span> weather<span class="token punctuation">.</span>count<span class="token punctuation">(</span>weather_type<span class="token punctuation">)</span> <span class="token keyword">for</span> weather_type <span class="token keyword">in</span> <span class="token builtin">set</span><span class="token punctuation">(</span>weather<span class="token punctuation">)</span><span class="token punctuation">}</span>
    plt<span class="token punctuation">.</span>pie<span class="token punctuation">(</span>weather_counts<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> labels<span class="token operator">=</span>weather_counts<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> autopct<span class="token operator">=</span><span class="token string">'%1.1f%%'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'月天气状况分布饼状图'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'./show/pie_'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'.jpg'</span><span class="token punctuation">)</span>  <span class="token comment"># 将图片保存</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># print('pie_'+str(month)+'.jpg保存成功！')</span>
    
<span class="token comment"># 绘制热力图</span>
    <span class="token comment"># 整合最高温度和最低温度数据</span>
    temp_range <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>high <span class="token operator">-</span> low <span class="token keyword">for</span> high<span class="token punctuation">,</span> low <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>high_temp<span class="token punctuation">,</span> low_temp<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># 创建一个新的图形</span>
    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
   
    plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>temp_range<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'hot'</span><span class="token punctuation">,</span> aspect<span class="token operator">=</span><span class="token string">'auto'</span><span class="token punctuation">)</span>
    <span class="token comment"># 设置x轴和y轴的标签</span>
    plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'日期时间'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'温度范围'</span><span class="token punctuation">)</span>
    <span class="token comment"># 添加颜色条</span>
    plt<span class="token punctuation">.</span>colorbar<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">'温度差'</span><span class="token punctuation">)</span>
    <span class="token comment"># 添加标题</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'月最高温度和最低温度热力图'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'./show/hot_'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'.jpg'</span><span class="token punctuation">)</span>  <span class="token comment"># 将图片保存</span>
    <span class="token comment"># 显示图形</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># print('hot_'+str(month)+'.jpg保存成功！')</span>

<span class="token comment">#3D曲面图</span>
    <span class="token comment"># 创建一个新的图形</span>
    fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dpi<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
    ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">,</span> projection<span class="token operator">=</span><span class="token string">'3d'</span><span class="token punctuation">)</span>
    <span class="token comment"># 提取数据</span>
    X <span class="token operator">=</span> <span class="token punctuation">[</span>item<span class="token punctuation">[</span><span class="token string">'日期时间'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token keyword">for</span> item <span class="token keyword">in</span> monthly_data<span class="token punctuation">[</span>month<span class="token punctuation">]</span><span class="token punctuation">]</span>
    Y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token string">'最高温度'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> item <span class="token keyword">in</span> monthly_data<span class="token punctuation">[</span>month<span class="token punctuation">]</span><span class="token punctuation">]</span>
    Z <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token string">'最低温度'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> item <span class="token keyword">in</span> monthly_data<span class="token punctuation">[</span>month<span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token comment"># 绘制带有网格线的曲面图</span>
    ax<span class="token punctuation">.</span>plot_trisurf<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> Z<span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'viridis'</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">'none'</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'月最高温度和最低温度3D曲面图'</span><span class="token punctuation">)</span>
    <span class="token comment"># 设置x轴和y轴的标签</span>
    ax<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">'日期时间'</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">'最高温度'</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_zlabel<span class="token punctuation">(</span><span class="token string">'最低温度'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'./show/3D_'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'.jpg'</span><span class="token punctuation">)</span>  <span class="token comment"># 将图片保存</span>
    <span class="token comment"># 显示图形</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># print('3D_'+str(month)+'.jpg保存成功！')</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 初始化 monthly_data 字典</span>
monthly_data <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">)</span>
<span class="token comment"># 遍历 formatted_data，将日期时间字符串转换为月份并添加到 monthly_data 字典中</span>
<span class="token keyword">for</span> item <span class="token keyword">in</span> formatted_data<span class="token punctuation">:</span>
    month <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token string">'日期时间'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>month
    <span class="token keyword">if</span> <span class="token number">1</span> <span class="token operator">&lt;=</span> month <span class="token operator">&lt;=</span> <span class="token number">12</span><span class="token punctuation">:</span>
        monthly_data<span class="token punctuation">[</span>month<span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>item<span class="token punctuation">)</span>

<span class="token comment"># 提取数据</span>
<span class="token keyword">for</span> month <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    date_time <span class="token operator">=</span> <span class="token punctuation">[</span>item<span class="token punctuation">[</span><span class="token string">'日期时间'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token keyword">for</span> item <span class="token keyword">in</span> monthly_data<span class="token punctuation">[</span>month<span class="token punctuation">]</span><span class="token punctuation">]</span>
    high_temp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token string">'最高温度'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> item <span class="token keyword">in</span> monthly_data<span class="token punctuation">[</span>month<span class="token punctuation">]</span><span class="token punctuation">]</span>
    low_temp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token string">'最低温度'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> item <span class="token keyword">in</span> monthly_data<span class="token punctuation">[</span>month<span class="token punctuation">]</span><span class="token punctuation">]</span>
    weather <span class="token operator">=</span> <span class="token punctuation">[</span>item<span class="token punctuation">[</span><span class="token string">'天气状况'</span><span class="token punctuation">]</span> <span class="token keyword">for</span> item <span class="token keyword">in</span> monthly_data<span class="token punctuation">[</span>month<span class="token punctuation">]</span><span class="token punctuation">]</span>

    <span class="token comment"># 调用 show() 函数绘制折线图、散点图、饼状图和热力图、3D曲面图</span>
    show<span class="token punctuation">(</span>date_time<span class="token punctuation">,</span> high_temp<span class="token punctuation">,</span> low_temp<span class="token punctuation">,</span> weather<span class="token punctuation">)</span>

</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image
<span class="token keyword">from</span> wordcloud <span class="token keyword">import</span> WordCloud
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token comment"># 制作静态词云图方法</span>
<span class="token keyword">def</span> <span class="token function">generate_wordcloud</span><span class="token punctuation">(</span>image_path<span class="token punctuation">,</span> font_path<span class="token punctuation">,</span> weather_data<span class="token punctuation">,</span> save_path<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 读取字图片文件，生成轮廓</span>
    mask_array <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>image_path<span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 从formatted_data变量中提取天气状况数据，将其转换为字符串</span>
    weather <span class="token operator">=</span> weather_data
    weather_str <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>weather<span class="token punctuation">)</span>
    
    <span class="token comment"># 生成词云图，并显示出来</span>
    wordcloud <span class="token operator">=</span> WordCloud<span class="token punctuation">(</span>background_color<span class="token operator">=</span><span class="token string">'white'</span><span class="token punctuation">,</span> 
                          font_path<span class="token operator">=</span>font_path<span class="token punctuation">,</span> 
                          mask<span class="token operator">=</span>mask_array<span class="token punctuation">,</span>
                          max_words<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>weather_str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>generate<span class="token punctuation">(</span>weather_str<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>wordcloud<span class="token punctuation">,</span> interpolation<span class="token operator">=</span><span class="token string">'bilinear'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 如果提供了保存路径，则保存词云图</span>
    <span class="token keyword">if</span> save_path<span class="token punctuation">:</span>
        plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span>save_path<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"词云图已保存至"</span><span class="token operator">+</span>save_path<span class="token punctuation">)</span>
    <span class="token comment"># else:</span>
    <span class="token comment">#     plt.show()</span>

</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 示例用法</span>
<span class="token comment"># 生成静态词云图</span>
image_path <span class="token operator">=</span> <span class="token string">"./sucai/basketball.jpg"</span>
font_path <span class="token operator">=</span> <span class="token string">'simhei.ttf'</span>

weather_data <span class="token operator">=</span> <span class="token punctuation">[</span>item<span class="token punctuation">[</span><span class="token string">'天气状况'</span><span class="token punctuation">]</span> <span class="token keyword">for</span> item <span class="token keyword">in</span> formatted_data<span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">2</span>

<span class="token comment"># 调用函数时提供保存路径，将保存词云图为指定路径的文件</span>
save_path <span class="token operator">=</span> <span class="token string">"./sucai/basketball2.jpg"</span>
generate_wordcloud<span class="token punctuation">(</span>image_path<span class="token punctuation">,</span> font_path<span class="token punctuation">,</span> weather_data<span class="token punctuation">,</span> save_path<span class="token punctuation">)</span>
display<span class="token punctuation">(</span>Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>image_path<span class="token punctuation">)</span><span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 把GIF逐帧分解保存</span>
<span class="token keyword">import</span> cv2
<span class="token keyword">def</span> <span class="token function">process_gif_to_jpg</span><span class="token punctuation">(</span>gif_path<span class="token punctuation">,</span> output_folder<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 读取GIF图像</span>
    gif <span class="token operator">=</span> cv2<span class="token punctuation">.</span>VideoCapture<span class="token punctuation">(</span>gif_path<span class="token punctuation">)</span>
    <span class="token comment"># 检查是否成功打开GIF文件</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> gif<span class="token punctuation">.</span>isOpened<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"无法打开GIF文件"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token comment"># 获取GIF的帧数</span>
    frame_count <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>gif<span class="token punctuation">.</span>get<span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>CAP_PROP_FRAME_COUNT<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># 遍历每一帧</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>frame_count<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 读取当前帧</span>
        ret<span class="token punctuation">,</span> frame <span class="token operator">=</span> gif<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 检查是否成功读取帧</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> ret<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"无法读取帧"</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
        <span class="token comment"># 构建输出文件名</span>
        output_file <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>output_folder<span class="token punctuation">}</span></span><span class="token string">/frame_</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>i<span class="token punctuation">}</span></span><span class="token string">.jpg"</span></span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>output_file<span class="token punctuation">)</span>
        <span class="token comment"># 保存当前帧为jpg图</span>
        cv2<span class="token punctuation">.</span>imwrite<span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> frame<span class="token punctuation">)</span>
    <span class="token comment"># 释放GIF资源</span>
    gif<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 使用示例</span>
gif_path <span class="token operator">=</span> <span class="token string">r'./sucai/basketball.gif'</span>
output_folder <span class="token operator">=</span> <span class="token string">r'./sucai/tmp'</span>
process_gif_to_jpg<span class="token punctuation">(</span>gif_path<span class="token punctuation">,</span> output_folder<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 生成动态词云图</span>
<span class="token keyword">import</span> imageio
<span class="token keyword">from</span> IPython<span class="token punctuation">.</span>display <span class="token keyword">import</span> Image<span class="token punctuation">,</span> display
<span class="token keyword">from</span> imageio <span class="token keyword">import</span> imread<span class="token punctuation">,</span> mimsave

<span class="token keyword">def</span> <span class="token function">create_gif</span><span class="token punctuation">(</span>image_files<span class="token punctuation">,</span> output_file<span class="token punctuation">,</span> fps<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    
    images <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    
    <span class="token keyword">for</span> image_file <span class="token keyword">in</span> image_files<span class="token punctuation">:</span>    
        images<span class="token punctuation">.</span>append<span class="token punctuation">(</span>imread<span class="token punctuation">(</span>image_file<span class="token punctuation">)</span><span class="token punctuation">)</span>    
    mimsave<span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> images<span class="token punctuation">,</span> fps<span class="token operator">=</span>fps<span class="token punctuation">)</span>    
    display<span class="token punctuation">(</span>Image<span class="token punctuation">(</span>filename<span class="token operator">=</span>output_file<span class="token punctuation">)</span><span class="token punctuation">)</span>

    
<span class="token comment"># 使用函数的方式创建GIF    </span>
images_path <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'./sucai/tmp2/jitu_{}.jpg'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">160</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    
output_path<span class="token operator">=</span><span class="token string">'./sucai/dance.gif'</span>
create_gif<span class="token punctuation">(</span>images_path<span class="token punctuation">,</span> output_path<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 打开文件，准备获取入近6年天气数据</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"6years_weather.csv"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">as</span> csvfile<span class="token punctuation">:</span>
    writer <span class="token operator">=</span> csv<span class="token punctuation">.</span>writer<span class="token punctuation">(</span>csvfile<span class="token punctuation">)</span>
    <span class="token comment"># 先写入列名:columns_name 日期 最高气温 最低气温  天气</span>
    writer<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"日期"</span><span class="token punctuation">,</span> <span class="token string">"最高气温"</span><span class="token punctuation">,</span> <span class="token string">"最低气温"</span><span class="token punctuation">,</span> <span class="token string">'天气'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token comment"># for循环生成</span>
    <span class="token keyword">for</span> year <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2018</span><span class="token punctuation">,</span> <span class="token number">2024</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        yearly_weather <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment"># 创建一个新的列表来存储每年的天气数据</span>
        <span class="token keyword">for</span> month <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 获取某一月的天气信息</span>
            <span class="token comment"># 三元表达式</span>
            weather_time <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token string">'0'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span> <span class="token keyword">if</span> month <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token keyword">else</span> <span class="token builtin">str</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>weather_time<span class="token punctuation">)</span>
            url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'https://lishi.tianqi.com/dongguan/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>weather_time<span class="token punctuation">}</span></span><span class="token string">.html'</span></span>
            <span class="token comment"># 爬虫获取这个月的天气信息</span>
            weather <span class="token operator">=</span> getWeather<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
            <span class="token comment"># 将这个月的天气数据添加到年度天气数据列表中</span>
            yearly_weather<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">list</span><span class="token punctuation">(</span>day_weather_dict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> day_weather_dict <span class="token keyword">in</span> weather<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token comment"># 一次写入一年的天气数据</span>
        writer<span class="token punctuation">.</span>writerows<span class="token punctuation">(</span>yearly_weather<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"年数据存入完成。"</span><span class="token punctuation">)</span>
        <span class="token comment"># 清空年度天气数据列表，以便于存储下一年的数据</span>
        yearly_weather<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"6年数据写入成功！"</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 读取数据</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"6years_weather.csv"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">as</span> csvfile<span class="token punctuation">:</span>
    reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>csvfile<span class="token punctuation">)</span>
    read <span class="token operator">=</span> <span class="token punctuation">[</span>
        row <span class="token keyword">for</span> row <span class="token keyword">in</span> reader <span class="token comment"># 检查行是否为空</span>
        <span class="token keyword">if</span> <span class="token builtin">any</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> cell <span class="token keyword">in</span> row<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"6年数据读取成功!"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>read<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LinearRegression
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> metrics
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment"># 嵌套列表</span>
data <span class="token operator">=</span> read
<span class="token comment"># 转换为DataFrame</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 划分数据集</span>
X <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'最高气温'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">)</span>  <span class="token comment"># 特征变量</span>
y <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'最低气温'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">)</span>  <span class="token comment"># 目标变量</span>
<span class="token comment"># 划分训练集和测试集</span>
X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>  

<span class="token comment"># 训练模型</span>
model <span class="token operator">=</span> LinearRegression<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 创建线性回归模型</span>
model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>  <span class="token comment"># 使用训练集训练模型</span>

<span class="token comment"># 预测</span>
y_pred <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>  <span class="token comment"># 使用模型对测试集进行预测</span>

<span class="token comment"># 绘制散点图和回归线</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'最高气温与最低气温的线性回归模型'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'最高气温'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'最低气温'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/992c80271ac0369e44121a8089314417/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Qwen-14B Ai新手部署开源模型安装到本地</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4989c0315cab9953d345f3e21fc6c492/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">数据仓库命名规范详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>