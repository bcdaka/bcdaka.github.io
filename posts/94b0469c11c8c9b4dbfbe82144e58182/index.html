<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python 因果推断（下） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/94b0469c11c8c9b4dbfbe82144e58182/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Python 因果推断（下）">
  <meta property="og:description" content="六、2007-2009 年大衰退期间加拿大就业市场上白人女性名字的溢价 原文：causal-methods.github.io/Book/6%29_The_Premium_of_Having_a_White_Female_Name_in_the_Canadian_Job_Market_During_the_Great_Recession_2007_2009.html
译者：飞龙
协议：CC BY-NC-SA 4.0
Vitor Kamada
电子邮件：econometrics.methods@gmail.com
最近更新：2020 年 9 月 15 日
我重新分析了 Oreopoulos（2011）的实验数据，并发现在 2007-2009 年大萧条期间，在加拿大的就业市场中，拥有白人女性名字是有优势的。白人女性在 2009 年 2 月至 9 月之间的回电率比白人男性高出 8%。考虑到白人男性在不同的回归规范下的回电率约为 10%，这一效应的幅度是相当高的。
Oreopoulos（2011）发现，英文名字的回电率为 15.7%，而印度、巴基斯坦、中国和希腊名字的回电率为 6%。我认为他的主要发现在很大程度上是由白人女性驱动的。我发现，在 2009 年 2 月至 9 月的大萧条最严重时期，拥有白人男性名字与印度、中国和希腊男性名字相比，并没有太多优势。
我使用了 Oreopoulos（2011）的数据集。每一行是发送给多个多伦多和蒙特利尔地区职业的简历。
import numpy as np import pandas as pd pd.set_option(&#39;precision&#39;, 3) # Data from Oreopoulos (2011) path = &#34;https://github.com/causal-methods/Data/raw/master/&#34; df = pd.read_stata(path &#43; &#34;oreopoulos.dta&#34;) df.head(5) 公司 ID职业类型name_ethnicity额外证书名字语言技能资格认证参考法律列出的资格认证…说话技能社交能力写作能力秋季数据中国人印度人英国人巴基斯坦人中加人相同经验0-3行政加拿大0.0JillWilson0.00.00.00.00.0…70.050.067.02.0NaNNaNNaNNaNNaNNaN1-3行政印度0.0PanavSingh0.00.00.00.00.0…70.050.067.02.0NaNNaNNaNNaNNaNNaN2-3行政印度0.0RahulKaur0.00.00.01.01.0…70.050.067.02.0NaNNaNNaNNaNNaNNaN3-3行政中国0.0雷丽0.01.01.00.01.0…70.050.067.02.0NaNNaNNaNNaNNaNNaN4-4行政印度0.0MayaKumar1.00.00.00.00.0…80.070.065.02.0NaNNaNNaNNaNNaNNaN 5 行×31 列
# Transform the variable of interest in % df[&#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-30T23:08:37+08:00">
    <meta property="article:modified_time" content="2024-01-30T23:08:37+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python 因果推断（下）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="20072009__2"></a>六、2007-2009 年大衰退期间加拿大就业市场上白人女性名字的溢价</h2> 
<blockquote> 
 <p>原文：<a href="https://causal-methods.github.io/Book/6%29_The_Premium_of_Having_a_White_Female_Name_in_the_Canadian_Job_Market_During_the_Great_Recession_2007_2009.html" rel="nofollow"><code>causal-methods.github.io/Book/6%29_The_Premium_of_Having_a_White_Female_Name_in_the_Canadian_Job_Market_During_the_Great_Recession_2007_2009.html</code></a></p> 
 <p>译者：<a href="https://github.com/wizardforcel">飞龙</a></p> 
 <p>协议：<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" rel="nofollow">CC BY-NC-SA 4.0</a></p> 
</blockquote> 
<p><a href="https://www.linkedin.com/in/vitor-kamada-1b73a078" rel="nofollow">Vitor Kamada</a></p> 
<p>电子邮件：econometrics.methods@gmail.com</p> 
<p>最近更新：2020 年 9 月 15 日</p> 
<p>我重新分析了 Oreopoulos（2011）的实验数据，并发现在 2007-2009 年大萧条期间，在加拿大的就业市场中，拥有白人女性名字是有优势的。白人女性在 2009 年 2 月至 9 月之间的回电率比白人男性高出 8%。考虑到白人男性在不同的回归规范下的回电率约为 10%，这一效应的幅度是相当高的。</p> 
<p>Oreopoulos（2011）发现，英文名字的回电率为 15.7%，而印度、巴基斯坦、中国和希腊名字的回电率为 6%。我认为他的主要发现在很大程度上是由白人女性驱动的。我发现，在 2009 年 2 月至 9 月的大萧条最严重时期，拥有白人男性名字与印度、中国和希腊男性名字相比，并没有太多优势。</p> 
<p>我使用了 Oreopoulos（2011）的数据集。每一行是发送给多个多伦多和蒙特利尔地区职业的简历。</p> 
<pre><code class="prism language-py"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'precision'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>

<span class="token comment"># Data from Oreopoulos (2011)</span>
path <span class="token operator">=</span> <span class="token string">"https://github.com/causal-methods/Data/raw/master/"</span> 
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_stata<span class="token punctuation">(</span>path <span class="token operator">+</span> <span class="token string">"oreopoulos.dta"</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> 
</code></pre> 
<table><thead><tr><th></th><th>公司 ID</th><th>职业类型</th><th>name_ethnicity</th><th>额外证书</th><th>名字</th><th>语言技能</th><th>资格认证</th><th>参考</th><th>法律</th><th>列出的资格认证</th><th>…</th><th>说话技能</th><th>社交能力</th><th>写作能力</th><th>秋季数据</th><th>中国人</th><th>印度人</th><th>英国人</th><th>巴基斯坦人</th><th>中加人</th><th>相同经验</th></tr></thead><tbody><tr><td>0</td><td>-3</td><td>行政</td><td>加拿大</td><td>0.0</td><td>JillWilson</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>…</td><td>70.0</td><td>50.0</td><td>67.0</td><td>2.0</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><td>1</td><td>-3</td><td>行政</td><td>印度</td><td>0.0</td><td>PanavSingh</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>…</td><td>70.0</td><td>50.0</td><td>67.0</td><td>2.0</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><td>2</td><td>-3</td><td>行政</td><td>印度</td><td>0.0</td><td>RahulKaur</td><td>0.0</td><td>0.0</td><td>0.0</td><td>1.0</td><td>1.0</td><td>…</td><td>70.0</td><td>50.0</td><td>67.0</td><td>2.0</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><td>3</td><td>-3</td><td>行政</td><td>中国</td><td>0.0</td><td>雷丽</td><td>0.0</td><td>1.0</td><td>1.0</td><td>0.0</td><td>1.0</td><td>…</td><td>70.0</td><td>50.0</td><td>67.0</td><td>2.0</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><td>4</td><td>-4</td><td>行政</td><td>印度</td><td>0.0</td><td>MayaKumar</td><td>1.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>…</td><td>80.0</td><td>70.0</td><td>65.0</td><td>2.0</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr></tbody></table> 
<p>5 行×31 列</p> 
<pre><code class="prism language-py"><span class="token comment"># Transform the variable of interest in % </span>
df<span class="token punctuation">[</span><span class="token string">"callback"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">100</span><span class="token operator">*</span>df<span class="token punctuation">[</span><span class="token string">"callback"</span><span class="token punctuation">]</span> 
</code></pre> 
<p>Oreopoulos（2011）收集的第一批实验数据是在 2008 年 4 月至 8 月之间。这是大萧条的“起始期”。</p> 
<pre><code class="prism language-py"><span class="token comment"># Restrict data to April and August 2008</span>
df0 <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>fall_data <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">]</span> 
</code></pre> 
<p>回电率对工作面试的比例对于加拿大名字（15.84%）要比中国和印度名字（9.23%和 9.53%）高得多。名族是随机的。不可能争辩说加拿大人有更多的教育或经验来证明大约 5%的差异。所有的简历在质量上都是一样的，除了申请人的名字。因此，我们可以得出结论，对移民的歧视是一个真实的现象。</p> 
<pre><code class="prism language-py">mean <span class="token operator">=</span> df0<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'name_ethnicity'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">,</span> np<span class="token punctuation">.</span>size<span class="token punctuation">]</span><span class="token punctuation">)</span>
mean<span class="token punctuation">[</span><span class="token string">"callback"</span><span class="token punctuation">]</span> 
</code></pre> 
<table><thead><tr><th></th><th>平均值</th><th>大小</th></tr></thead><tbody><tr><td>name_ethnicity</td><td></td><td></td></tr><tr><td>—</td><td>—</td><td>—</td></tr><tr><td>加拿大</td><td>15.845</td><td>953.0</td></tr><tr><td>中国</td><td>9.231</td><td>1430.0</td></tr><tr><td>印度</td><td>9.534</td><td>1416.0</td></tr></tbody></table> 
<p>在 2008 年 4 月至 8 月的样本中，女性名字似乎比男性名字稍微有一些优势，但可以忽略不计，以获得工作面试。这一结果支持了 Oreopoulos（2011）的发现。在他的论文中，女性的系数在大部分回归中都不具有统计学显著性。</p> 
<pre><code class="prism language-py">prop <span class="token operator">=</span> pd<span class="token punctuation">.</span>crosstab<span class="token punctuation">(</span>index<span class="token operator">=</span> df0<span class="token punctuation">[</span><span class="token string">'name_ethnicity'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span>df0<span class="token punctuation">[</span><span class="token string">'female'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
            values<span class="token operator">=</span>df0<span class="token punctuation">[</span><span class="token string">'callback'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> aggfunc<span class="token operator">=</span><span class="token string">'mean'</span><span class="token punctuation">)</span>
prop 
</code></pre> 
<table><thead><tr><th>女性</th><th>0.0</th><th>1.0</th></tr></thead><tbody><tr><td>name_ethnicity</td><td></td><td></td></tr><tr><td>—</td><td>—</td><td>—</td></tr><tr><td>加拿大</td><td>15.551</td><td>16.122</td></tr><tr><td>中国</td><td>9.065</td><td>9.392</td></tr><tr><td>印度</td><td>9.490</td><td>9.577</td></tr></tbody></table> 
<p>Oreopoulos（2011）收集的第三波实验数据是在 2009 年 2 月至 9 月之间进行的。这是大萧条的最糟糕时期。</p> 
<pre><code class="prism language-py"><span class="token comment"># Restrict data to February and September 2009</span>
df2 <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>fall_data <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span> 
</code></pre> 
<p>加拿大名字的回电率为 14％，而中国名字为 8.96％，英文名和中国姓氏为 7.13％，希腊为 10.11％，印度为 7.9％。</p> 
<p>请注意，总体上，这第三波样本中的回电率略低于第一波样本，对于两个样本中的常见种族来说。</p> 
<pre><code class="prism language-py">mean <span class="token operator">=</span> df2<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'name_ethnicity'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">,</span> np<span class="token punctuation">.</span>size<span class="token punctuation">]</span><span class="token punctuation">)</span>
mean<span class="token punctuation">[</span><span class="token string">"callback"</span><span class="token punctuation">]</span> 
</code></pre> 
<table><thead><tr><th></th><th>平均</th><th>大小</th></tr></thead><tbody><tr><td>名字种族</td><td></td><td></td></tr><tr><td>—</td><td>—</td><td>—</td></tr><tr><td>加拿大</td><td>14.080</td><td>1044.0</td></tr><tr><td>中国</td><td>8.956</td><td>1418.0</td></tr><tr><td>中国-加拿大</td><td>7.128</td><td>491.0</td></tr><tr><td>希腊</td><td>10.109</td><td>366.0</td></tr><tr><td>印度</td><td>7.899</td><td>1937.0</td></tr></tbody></table> 
<pre><code class="prism language-py"><span class="token keyword">import</span> plotly<span class="token punctuation">.</span>express <span class="token keyword">as</span> px

y <span class="token operator">=</span> mean<span class="token punctuation">[</span><span class="token string">"callback"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
x <span class="token operator">=</span> mean<span class="token punctuation">[</span><span class="token string">"callback"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>index

fig <span class="token operator">=</span> px<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>df2<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> color <span class="token operator">=</span> x<span class="token punctuation">,</span>
             title<span class="token operator">=</span><span class="token string">"Callback Rate for Interview by Name Ethnicity"</span><span class="token punctuation">,</span>
             labels<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> <span class="token string">"y"</span><span class="token punctuation">:</span> <span class="token string">"Callback Rate (%)"</span><span class="token punctuation">,</span>
                      <span class="token string">"x"</span><span class="token punctuation">:</span> <span class="token string">"Name Ethnicity"</span><span class="token punctuation">,</span>                 
                      <span class="token string">"color"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">}</span> <span class="token punctuation">)</span>

fig<span class="token punctuation">.</span>update_layout<span class="token punctuation">(</span>font_size <span class="token operator">=</span> <span class="token number">17</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span> 
</code></pre> 
<p>在 2009 年 2 月至 9 月的样本中，白人女性的名字回电率为 18.3％，而白人男性的名字回电率为 10.17％。我们没有看到其丨他种族有这么大的差异。事实上，对于希腊名字来说，效果是相反的。希腊男性的名字回电率为 10.71％，而希腊女性的名字回电率为 9.6％。白人男性的名字比中国和印度男性的名字有优势，但幅度不像白人男性与白人女性之间的差异那么大。</p> 
<pre><code class="prism language-py">prop <span class="token operator">=</span> pd<span class="token punctuation">.</span>crosstab<span class="token punctuation">(</span>index<span class="token operator">=</span> df2<span class="token punctuation">[</span><span class="token string">'name_ethnicity'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span>df2<span class="token punctuation">[</span><span class="token string">'female'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
            values<span class="token operator">=</span>df2<span class="token punctuation">[</span><span class="token string">'callback'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> aggfunc<span class="token operator">=</span><span class="token string">'mean'</span><span class="token punctuation">)</span>
prop 
</code></pre> 
<table><thead><tr><th>女性</th><th>0.0</th><th>1.0</th></tr></thead><tbody><tr><td>名字种族</td><td></td><td></td></tr><tr><td>—</td><td>—</td><td>—</td></tr><tr><td>加拿大</td><td>10.169</td><td>18.129</td></tr><tr><td>中国</td><td>8.715</td><td>9.177</td></tr><tr><td>中国-加拿大</td><td>6.410</td><td>7.782</td></tr><tr><td>希腊</td><td>10.714</td><td>9.596</td></tr><tr><td>印度</td><td>7.252</td><td>8.559</td></tr></tbody></table> 
<pre><code class="prism language-py"><span class="token keyword">import</span> plotly<span class="token punctuation">.</span>graph_objects <span class="token keyword">as</span> go

ethnicity <span class="token operator">=</span> prop<span class="token punctuation">.</span>index
male <span class="token operator">=</span> prop<span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
female <span class="token operator">=</span> prop<span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>

fig <span class="token operator">=</span> go<span class="token punctuation">.</span>Figure<span class="token punctuation">(</span>data<span class="token operator">=</span><span class="token punctuation">[</span>
         go<span class="token punctuation">.</span>Bar<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'Male'</span><span class="token punctuation">,</span> x <span class="token operator">=</span> ethnicity<span class="token punctuation">,</span> y <span class="token operator">=</span> male<span class="token punctuation">)</span><span class="token punctuation">,</span>
         go<span class="token punctuation">.</span>Bar<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'Female'</span><span class="token punctuation">,</span> x <span class="token operator">=</span> ethnicity<span class="token punctuation">,</span> y <span class="token operator">=</span> female<span class="token punctuation">)</span> <span class="token punctuation">]</span><span class="token punctuation">)</span>

fig<span class="token punctuation">.</span>update_layout<span class="token punctuation">(</span>barmode<span class="token operator">=</span><span class="token string">'group'</span><span class="token punctuation">,</span> font_size <span class="token operator">=</span> <span class="token number">17</span><span class="token punctuation">,</span>
      title <span class="token operator">=</span> <span class="token string">"Callback Rate for Interview by Gender"</span><span class="token punctuation">,</span>
      yaxis <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'Callback Rate (%)'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      xaxis <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'Name Ethnicity'</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>

fig<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span> 
</code></pre> 
<p>有人可能会争辩说，有一些混杂因素导致了观察到的差异。例如，有人可能会说，在现实世界中，女性比男性更受教育和更合格。请记住，这是实验数据，所有简历都是人为构造的，所有相关维度都是由 Oreopoulos（2011）随机化的。控制变量表明，女性和男性彼此相似。</p> 
<pre><code class="prism language-py">control <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'additional_credential'</span><span class="token punctuation">,</span> <span class="token string">'ba_quality'</span><span class="token punctuation">,</span>
           <span class="token string">'extracurricular_skills'</span><span class="token punctuation">,</span> <span class="token string">'language_skills'</span><span class="token punctuation">,</span>
           <span class="token string">'certificate'</span><span class="token punctuation">,</span> <span class="token string">'ma'</span><span class="token punctuation">,</span> <span class="token string">'same_exp'</span><span class="token punctuation">,</span> <span class="token string">'exp_highquality'</span><span class="token punctuation">,</span>
           <span class="token string">'skillspeaking'</span><span class="token punctuation">,</span> <span class="token string">'skillsocialper'</span><span class="token punctuation">,</span> <span class="token string">'skillwriting'</span><span class="token punctuation">]</span>

df2<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'female'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span>control<span class="token punctuation">]</span> 
</code></pre> 
<table><thead><tr><th></th><th>附加证书</th><th>学士质量</th><th>课外技能</th><th>语言技能</th><th>证书</th><th>硕士</th><th>相同经验</th><th>经验高质量</th><th>说话技能</th><th>社交能力</th><th>写作技能</th></tr></thead><tbody><tr><td></td><td>平均</td><td>平均</td><td>平均</td><td>平均</td><td>平均</td><td>平均</td><td>平均</td><td>平均</td><td>平均</td><td>平均</td><td>平均</td></tr><tr><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td></tr><tr><td>女性</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td></tr><tr><td>0.0</td><td>0.059</td><td>0.640</td><td>0.598</td><td>0.306</td><td>0.007</td><td>0.170</td><td>NaN</td><td>0.197</td><td>70.757</td><td>59.654</td><td>64.286</td></tr><tr><td>1.0</td><td>0.054</td><td>0.655</td><td>0.595</td><td>0.322</td><td>0.008</td><td>0.185</td><td>NaN</td><td>0.169</td><td>70.524</td><td>59.777</td><td>64.216</td></tr></tbody></table> 
<p>敏锐的读者可能会争辩说，仅仅表明男性和女性相互之间相似是不够的，以支持我关于白人女性溢价的论点。我必须表明样本中的平均白人女性与平均白人男性相似。对于某些变量，白人女性看起来略微更合格，但对于其丨他变量，略微不太合格。许多数据维度都是随机的，观察到的差异看起来是抽样变异的产物。总的来说，白人男性和女性看起来很相似。我们可以在回归框架中严格控制所有这些因素。我看到种族之间的变化比性别之间的变化更大。种族之间的变化看起来对实验来说过多。因此，我将按种族分解回归分析，并控制几个因素。</p> 
<pre><code class="prism language-py">df2<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'female'</span><span class="token punctuation">,</span> <span class="token string">'name_ethnicity'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span>control<span class="token punctuation">]</span> 
</code></pre> 
<table><thead><tr><th></th><th></th><th>附加证书</th><th>学士质量</th><th>课外技能</th><th>语言技能</th><th>证书</th><th>硕士</th><th>相同经验</th><th>经验高质量</th><th>说话技能</th><th>社交能力</th><th>写作技能</th></tr></thead><tbody><tr><td></td><td></td><td>平均</td><td>平均</td><td>平均</td><td>平均</td><td>平均</td><td>平均</td><td>平均</td><td>平均</td><td>平均</td><td>平均</td><td></td></tr><tr><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td></tr><tr><td>女性</td><td>名字种族</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td></tr><tr><td>0.0</td><td>加拿大</td><td>0.056</td><td>0.746</td><td>0.623</td><td>0.343</td><td>0.004</td><td>0.209</td><td>NaN</td><td>0.190</td><td>70.422</td><td>59.070</td><td>63.546</td></tr><tr><td>中国人</td><td>0.062</td><td>0.607</td><td>0.592</td><td>0.326</td><td>0.007</td><td>0.165</td><td>NaN</td><td>0.183</td><td>70.702</td><td>59.850</td><td>64.312</td><td></td></tr><tr><td>中-加</td><td>0.068</td><td>0.628</td><td>0.538</td><td>0.282</td><td>0.013</td><td>0.154</td><td>NaN</td><td>0.214</td><td>71.141</td><td>59.513</td><td>63.979</td><td></td></tr><tr><td>希腊人</td><td>0.065</td><td>0.774</td><td>0.631</td><td>0.321</td><td>0.012</td><td>0.214</td><td>NaN</td><td>0.232</td><td>70.976</td><td>59.696</td><td>65.220</td><td></td></tr><tr><td>印度人</td><td>0.055</td><td>0.586</td><td>0.596</td><td>0.276</td><td>0.006</td><td>0.147</td><td>NaN</td><td>0.200</td><td>70.846</td><td>59.862</td><td>64.582</td><td></td></tr><tr><td>1.0</td><td>加拿大</td><td>0.055</td><td>0.789</td><td>0.577</td><td>0.327</td><td>0.004</td><td>0.228</td><td>NaN</td><td>0.177</td><td>70.146</td><td>60.041</td><td>64.179</td></tr><tr><td>中国人</td><td>0.055</td><td>0.590</td><td>0.596</td><td>0.300</td><td>0.011</td><td>0.189</td><td>NaN</td><td>0.179</td><td>70.799</td><td>59.607</td><td>64.349</td><td></td></tr><tr><td>中-加</td><td>0.047</td><td>0.638</td><td>0.638</td><td>0.346</td><td>0.004</td><td>0.113</td><td>NaN</td><td>0.171</td><td>70.000</td><td>59.506</td><td>63.233</td><td></td></tr><tr><td>希腊人</td><td>0.045</td><td>0.808</td><td>0.566</td><td>0.308</td><td>0.010</td><td>0.217</td><td>NaN</td><td>0.136</td><td>71.258</td><td>60.662</td><td>64.894</td><td></td></tr><tr><td>印度人</td><td>0.055</td><td>0.608</td><td>0.599</td><td>0.334</td><td>0.008</td><td>0.172</td><td>NaN</td><td>0.163</td><td>70.503</td><td>59.657</td><td>64.257</td><td></td></tr></tbody></table> 
<p>让<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          y 
         
         
         
           r 
          
         
           j 
          
         
           t 
          
         
        
       
      
        y_{rjt} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">r</span><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span></span>是一个虚拟变量，如果简历<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         r 
        
       
      
        r 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span></span></span></span></span>发送到工作<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         j 
        
       
      
        j 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0572em;">j</span></span></span></span></span>在时间<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         t 
        
       
      
        t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span>收到回电，则为 1；否则为 0。感兴趣的变量是“女性”虚拟变量和与“简历类型”的交互。</p> 
<p>有五种“简历类型”：0) 英文名，加拿大教育和经验；1) 外国名字，加拿大教育和经验；2) 外国名字和教育，加拿大经验；3) 外国名字和教育，混合经验；和 4) 外国名字，教育和经验。</p> 
<p>以下的线性概率模型是首选的规范：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           y 
          
          
          
            r 
           
          
            j 
           
          
            t 
           
          
         
        
          = 
         
        
          β 
         
        
          F 
         
        
          e 
         
        
          m 
         
        
          a 
         
        
          l 
         
         
         
           e 
          
          
          
            r 
           
          
            j 
           
          
            t 
           
          
         
        
          + 
         
        
          γ 
         
        
          R 
         
        
          e 
         
        
          s 
         
        
          u 
         
        
          m 
         
        
          e 
         
        
            
         
        
          T 
         
        
          y 
         
        
          p 
         
        
          e 
         
         
         
           s 
          
          
          
            r 
           
          
            j 
           
          
            t 
           
          
         
        
          + 
         
        
          δ 
         
        
          F 
         
        
          e 
         
        
          m 
         
        
          a 
         
        
          l 
         
         
         
           e 
          
          
          
            r 
           
          
            j 
           
          
            t 
           
          
         
        
          ⋅ 
         
        
          R 
         
        
          e 
         
        
          s 
         
        
          u 
         
        
          m 
         
        
          e 
         
        
            
         
        
          T 
         
        
          y 
         
        
          p 
         
        
          e 
         
         
         
           s 
          
          
          
            r 
           
          
            j 
           
          
            t 
           
          
         
        
          + 
         
        
          α 
         
        
          X 
         
        
          + 
         
         
         
           ϵ 
          
          
          
            r 
           
          
            j 
           
          
            t 
           
          
         
        
       
         y_{rjt}= \beta Female_{rjt}+\gamma Resume\ Types_{rjt}+ \delta Female_{rjt} \cdot Resume\ Types_{rjt} + \alpha X + \epsilon_{rjt} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">r</span><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">βF</span><span class="mord mathnormal">e</span><span class="mord mathnormal">ma</span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">r</span><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;"></span><span class="mord mathnormal" style="margin-right: 0.0556em;">γ</span><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="mord mathnormal">es</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mord mathnormal">p</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">r</span><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;"></span><span class="mord mathnormal" style="margin-right: 0.0379em;">δ</span><span class="mord mathnormal" style="margin-right: 0.1389em;">F</span><span class="mord mathnormal">e</span><span class="mord mathnormal">ma</span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">r</span><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;"></span><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="mord mathnormal">es</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mord mathnormal">p</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">r</span><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">r</span><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>其中<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         X 
        
       
      
        X 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span></span></span></span></span>是控制变量的向量，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          ϵ 
         
         
         
           r 
          
         
           j 
          
         
           t 
          
         
        
       
      
        \epsilon_{rjt} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">r</span><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span></span>是通常的误差项。所有回归都呈现了对异方差性的稳健标准误差。</p> 
<p>对于表 1、2 和 3，我们呈现了 4 个回归，以比较“加拿大人”与特定种族。逻辑是保持一个同质样本，避免可能混淆结果的种族变化。</p> 
<p>表 1 呈现了没有交互作用和控制变量的结果。作为女性的优势范围从增加 3.64%到 5.97%的回电率，相对于男性。白人男性的回电率，基准（类型 0），范围从 11.14%到 12.29%。Oreopoulos（2011）提出的类型 0 的估计值从 15.4%到 16%不等，但他的估计捕捉了英文名字的影响，而没有孤立地考虑性别影响。</p> 
<p>我们看到一个模式，类型 1、2、3 和 4 的系数都是负数，并且随着“外国”的程度绝对值增加。一个人在名字、教育和经验方面越“外国”，回电率就越低。但仅仅一个外国名字就足以使回电率比英文名字低 3.38%到 5.11%。总体而言，结果在 1%的显著水平上是统计学显著的。一个例外是类型 1 的系数，用于英文名和中国姓氏的回归（3）。这里描述的模式与 Oreopoulos（2011）报告的主要发现相匹配。</p> 
<pre><code class="prism language-py"><span class="token keyword">import</span> statsmodels<span class="token punctuation">.</span>formula<span class="token punctuation">.</span>api <span class="token keyword">as</span> smf

<span class="token comment"># Sample Restriction based on name ethnicity</span>
Canada <span class="token operator">=</span> df2<span class="token punctuation">.</span>name_ethnicity <span class="token operator">==</span> <span class="token string">"Canada"</span>
Indian <span class="token operator">=</span> df2<span class="token punctuation">[</span><span class="token punctuation">(</span>Canada<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>df2<span class="token punctuation">.</span>name_ethnicity <span class="token operator">==</span> <span class="token string">"Indian"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
Chinese <span class="token operator">=</span> df2<span class="token punctuation">[</span><span class="token punctuation">(</span>Canada<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>df2<span class="token punctuation">.</span>name_ethnicity <span class="token operator">==</span> <span class="token string">"Chinese"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
Chn_Cdn <span class="token operator">=</span> df2<span class="token punctuation">[</span><span class="token punctuation">(</span>Canada<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>df2<span class="token punctuation">.</span>name_ethnicity <span class="token operator">==</span> <span class="token string">"Chn-Cdn"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
Greek <span class="token operator">=</span> df2<span class="token punctuation">[</span><span class="token punctuation">(</span>Canada<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>df2<span class="token punctuation">.</span>name_ethnicity <span class="token operator">==</span> <span class="token string">"Greek"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

sample <span class="token operator">=</span> <span class="token punctuation">[</span>Indian<span class="token punctuation">,</span> Chinese<span class="token punctuation">,</span> Chn_Cdn<span class="token punctuation">,</span> Greek<span class="token punctuation">]</span>

<span class="token comment">#  Run the simple model for each ethnicity</span>
<span class="token comment"># and save the results</span>
model1 <span class="token operator">=</span> <span class="token string">"callback ~ female + C(type)"</span>

result1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> data <span class="token keyword">in</span> sample<span class="token punctuation">:</span>
   ols <span class="token operator">=</span> smf<span class="token punctuation">.</span>ols<span class="token punctuation">(</span>model1<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>cov_type<span class="token operator">=</span><span class="token string">'HC1'</span><span class="token punctuation">)</span>
   result1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ols<span class="token punctuation">)</span> 
</code></pre> 
<pre><code class="prism language-py">C<span class="token punctuation">:</span>\Anaconda\envs\textbook\lib\site<span class="token operator">-</span>packages\statsmodels\tools\_testing<span class="token punctuation">.</span>py<span class="token punctuation">:</span><span class="token number">19</span><span class="token punctuation">:</span> FutureWarning<span class="token punctuation">:</span>

pandas<span class="token punctuation">.</span>util<span class="token punctuation">.</span>testing <span class="token keyword">is</span> deprecated<span class="token punctuation">.</span> Use the functions <span class="token keyword">in</span> the public API at pandas<span class="token punctuation">.</span>testing instead<span class="token punctuation">.</span> 
</code></pre> 
<pre><code class="prism language-py"><span class="token comment">#  Library to print professional publication</span>
<span class="token comment"># tables in Latex, HTML, etc.</span>
!pip install stargazer 
</code></pre> 
<pre><code class="prism language-py">Requirement already satisfied<span class="token punctuation">:</span> stargazer <span class="token keyword">in</span> c<span class="token punctuation">:</span>\anaconda\envs\textbook\lib\site<span class="token operator">-</span>packages <span class="token punctuation">(</span><span class="token number">0.0</span><span class="token number">.5</span><span class="token punctuation">)</span> 
</code></pre> 
<pre><code class="prism language-py">WARNING<span class="token punctuation">:</span> Error parsing requirements <span class="token keyword">for</span> numpy<span class="token punctuation">:</span> <span class="token punctuation">[</span>Errno <span class="token number">2</span><span class="token punctuation">]</span> No such <span class="token builtin">file</span> <span class="token keyword">or</span> directory<span class="token punctuation">:</span> <span class="token string">'c:\\anaconda\\envs\\textbook\\lib\\site-packages\\numpy-1.19.2.dist-info\\METADATA'</span> 
</code></pre> 
<pre><code class="prism language-py"><span class="token comment"># Settings for a nice table</span>
<span class="token keyword">from</span> stargazer<span class="token punctuation">.</span>stargazer <span class="token keyword">import</span> Stargazer
stargazer <span class="token operator">=</span> Stargazer<span class="token punctuation">(</span>result1<span class="token punctuation">)</span>

stargazer<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Table 1 - Callback Rates by Resume Type'</span><span class="token punctuation">)</span>

names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Indian'</span><span class="token punctuation">,</span> <span class="token string">'Chinese'</span><span class="token punctuation">,</span> <span class="token string">'Chn_Cdn'</span><span class="token punctuation">,</span> <span class="token string">'Greek'</span><span class="token punctuation">]</span>
stargazer<span class="token punctuation">.</span>custom_columns<span class="token punctuation">(</span>names<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

order <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'female'</span><span class="token punctuation">,</span> <span class="token string">'Intercept'</span><span class="token punctuation">,</span> <span class="token string">'C(type)[T.1.0]'</span><span class="token punctuation">,</span>
         <span class="token string">'C(type)[T.2.0]'</span><span class="token punctuation">,</span> <span class="token string">'C(type)[T.3.0]'</span><span class="token punctuation">,</span>
         <span class="token string">'C(type)[T.4.0]'</span><span class="token punctuation">]</span>     
stargazer<span class="token punctuation">.</span>covariate_order<span class="token punctuation">(</span>order<span class="token punctuation">)</span>

dict1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'C(type)[T.1.0]'</span><span class="token punctuation">:</span> <span class="token string">'1) Foreign Name, Cdn Educ and Exp'</span><span class="token punctuation">,</span>
         <span class="token string">'C(type)[T.2.0]'</span><span class="token punctuation">:</span> <span class="token string">'2) Foreign Name and Educ, Cdn exp'</span><span class="token punctuation">,</span>
         <span class="token string">'C(type)[T.3.0]'</span><span class="token punctuation">:</span> <span class="token string">'3) Foreign Name and Educ, Mixed Exp'</span><span class="token punctuation">,</span>
         <span class="token string">'C(type)[T.4.0]'</span><span class="token punctuation">:</span> <span class="token string">'4) All Foreign (Name, Educ, and Exp)'</span><span class="token punctuation">,</span>
              <span class="token string">'Intercept'</span><span class="token punctuation">:</span> <span class="token string">'0) English Name, Cdn Educ and Exp'</span><span class="token punctuation">,</span>
                 <span class="token string">'female'</span><span class="token punctuation">:</span> <span class="token string">'Female'</span><span class="token punctuation">}</span>
stargazer<span class="token punctuation">.</span>rename_covariates<span class="token punctuation">(</span>dict1<span class="token punctuation">)</span>

stargazer 
</code></pre> 
<p>表 1 - 简历类型的回电率</p> 
<table><thead><tr><th></th></tr></thead><tbody><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td>女性</td></tr><tr><td></td></tr><tr><td>0) 英文名，加拿大教育和经验</td></tr><tr><td></td></tr><tr><td>1) 外国名字，加拿大教育和经验</td></tr><tr><td></td></tr><tr><td>2) 外国名字和教育，加拿大经验</td></tr><tr><td></td></tr><tr><td>3) 外国名字和教育，混合经验</td></tr><tr><td></td></tr><tr><td>4) 所有外国人（姓名，教育和经验）</td></tr><tr><td></td></tr><tr><td></td></tr><tr><td>观察</td></tr><tr><td>R²</td></tr><tr><td>调整后的 R²</td></tr><tr><td>残差标准误差</td></tr><tr><td>F 统计量</td></tr><tr><td></td></tr><tr><td>注：</td></tr></tbody></table> 
<p>表 2 添加了女性和简历类型的交互项。女性的系数仅捕捉了白人女性的影响，因为外国女性是由女性和类型之间的交互项捕捉的。与白人男性（10.17%的基线）相比，白人女性的回访率增加了 7.96%。</p> 
<p>交互项的系数在绝对值上为负，但并非全部统计上显着。这种模式表明，外国女性的回访率与白人女性相比非常低。</p> 
<p>有趣的是，类型 1、2、3 和 4 的系数在幅度上较低，并且与表 1 相比在统计上不太显着。这种模式表明，白人男性比印度人和中国姓氏的人有优势，但不包括希腊人或中国人（名字和姓氏）。这两个最后一组的系数在统计上不显着。</p> 
<pre><code class="prism language-py">model2 <span class="token operator">=</span> <span class="token string">"callback ~ female*C(type)"</span>

result2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> data <span class="token keyword">in</span> sample<span class="token punctuation">:</span>
   ols <span class="token operator">=</span> smf<span class="token punctuation">.</span>ols<span class="token punctuation">(</span>model2<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>cov_type<span class="token operator">=</span><span class="token string">'HC1'</span><span class="token punctuation">)</span>
   result2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ols<span class="token punctuation">)</span> 
</code></pre> 
<pre><code class="prism language-py">stargazer <span class="token operator">=</span> Stargazer<span class="token punctuation">(</span>result2<span class="token punctuation">)</span>

stargazer<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Table 2 - Callback Rates by Resume Type and Gender'</span><span class="token punctuation">)</span>

stargazer<span class="token punctuation">.</span>custom_columns<span class="token punctuation">(</span>names<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

dict2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'female:C(type)[T.1.0]'</span><span class="token punctuation">:</span><span class="token string">'[Female]x[1]'</span><span class="token punctuation">,</span>
         <span class="token string">'female:C(type)[T.2.0]'</span><span class="token punctuation">:</span><span class="token string">'[Female]x[2]'</span><span class="token punctuation">,</span>
         <span class="token string">'female:C(type)[T.3.0]'</span><span class="token punctuation">:</span><span class="token string">'[Female]x[3]'</span><span class="token punctuation">,</span>
         <span class="token string">'female:C(type)[T.4.0]'</span><span class="token punctuation">:</span><span class="token string">'[Female]x[4]'</span><span class="token punctuation">}</span>

list2 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>dict2<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

dict2<span class="token punctuation">.</span>update<span class="token punctuation">(</span>dict1<span class="token punctuation">)</span>
stargazer<span class="token punctuation">.</span>rename_covariates<span class="token punctuation">(</span>dict2<span class="token punctuation">)</span>

list2 <span class="token operator">=</span> order <span class="token operator">+</span> list2
stargazer<span class="token punctuation">.</span>covariate_order<span class="token punctuation">(</span>list2<span class="token punctuation">)</span>

stargazer 
</code></pre> 
<p>表 2 - 简历类型和性别的回访率</p> 
<table><thead><tr><th></th></tr></thead><tbody><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td>女性</td></tr><tr><td></td></tr><tr><td>0) 英文名，加拿大教育和经验</td></tr><tr><td></td></tr><tr><td>1) 外国名字，加拿大教育和经验</td></tr><tr><td></td></tr><tr><td>2) 外国名字和教育，加拿大经验</td></tr><tr><td></td></tr><tr><td>3) 外国名字和教育，混合经验</td></tr><tr><td></td></tr><tr><td>4) 所有外国人（姓名，教育和经验）</td></tr><tr><td></td></tr><tr><td>[女性]x[1]</td></tr><tr><td></td></tr><tr><td>[女性]x[2]</td></tr><tr><td></td></tr><tr><td>[女性]x[3]</td></tr><tr><td></td></tr><tr><td>[女性]x[4]</td></tr><tr><td></td></tr><tr><td></td></tr><tr><td>观察</td></tr><tr><td>R²</td></tr><tr><td>调整后的 R²</td></tr><tr><td>残差标准误差</td></tr><tr><td>F 统计量</td></tr><tr><td></td></tr><tr><td>注：</td></tr></tbody></table> 
<p>表 3 添加了控制变量作为鲁棒性检查。总体结果与表 2 相似。与表 2 相比，白人女性的影响甚至略有增加。白人女性的巨大溢价仍然超过所有其丨他类别。白人女性的溢价优于来自世界排名前 200 的大学的学士学位，大型公司的经验，课外活动，流利的法语和其丨他语言以及加拿大硕士学位的累积影响。</p> 
<p>请注意，对于类型 1，只有印度回归的系数在统计上显着。白人男性的名字与中国，中国加拿大和希腊名字没有优势。</p> 
<pre><code class="prism language-py">control1 <span class="token operator">=</span> <span class="token string">"+ ba_quality + extracurricular_skills + language_skills"</span>
control2 <span class="token operator">=</span> <span class="token string">"+ ma + exp_highquality"</span>
model3 <span class="token operator">=</span> <span class="token string">"callback ~ female*C(type)"</span> <span class="token operator">+</span> control1 <span class="token operator">+</span> control2

result3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> data <span class="token keyword">in</span> sample<span class="token punctuation">:</span>
   ols <span class="token operator">=</span> smf<span class="token punctuation">.</span>ols<span class="token punctuation">(</span>model3<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>cov_type<span class="token operator">=</span><span class="token string">'HC1'</span><span class="token punctuation">)</span>
   result3<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ols<span class="token punctuation">)</span> 
</code></pre> 
<pre><code class="prism language-py">stargazer <span class="token operator">=</span> Stargazer<span class="token punctuation">(</span>result3<span class="token punctuation">)</span>

stargazer<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Table 3 - Callback Rates and Robustness Checks'</span><span class="token punctuation">)</span>

stargazer<span class="token punctuation">.</span>custom_columns<span class="token punctuation">(</span>names<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

dict3 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'ba_quality'</span><span class="token punctuation">:</span><span class="token string">'Top 200 world ranking university'</span><span class="token punctuation">,</span>
         <span class="token string">'exp_highquality'</span><span class="token punctuation">:</span><span class="token string">'High quality work experience'</span><span class="token punctuation">,</span>
         <span class="token string">'extracurricular_skills'</span>	<span class="token punctuation">:</span><span class="token string">'List extra-curricular activities'</span><span class="token punctuation">,</span>
         <span class="token string">'language_skills'</span><span class="token punctuation">:</span><span class="token string">'Fluent in French and other languages'</span><span class="token punctuation">,</span>
         <span class="token string">'ma'</span><span class="token punctuation">:</span><span class="token string">'Canadian master’s degree'</span><span class="token punctuation">}</span>

list3 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>dict3<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

dict3<span class="token punctuation">.</span>update<span class="token punctuation">(</span>dict2<span class="token punctuation">)</span>
stargazer<span class="token punctuation">.</span>rename_covariates<span class="token punctuation">(</span>dict3<span class="token punctuation">)</span>

list3 <span class="token operator">=</span> list2 <span class="token operator">+</span> list3
stargazer<span class="token punctuation">.</span>covariate_order<span class="token punctuation">(</span>list3<span class="token punctuation">)</span>

stargazer 
</code></pre> 
<p>表 3 - 回访率和鲁棒性检查</p> 
<table><thead><tr><th></th></tr></thead><tbody><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td>女性</td></tr><tr><td></td></tr><tr><td>0) 英文名字，加拿大教育和经验</td></tr><tr><td></td></tr><tr><td>1) 外国名字，加拿大教育和经验</td></tr><tr><td></td></tr><tr><td>2) 外国名字和教育，加拿大经验</td></tr><tr><td></td></tr><tr><td>3) 外国名字和教育，混合经验</td></tr><tr><td></td></tr><tr><td>4) 所有外国人（姓名，教育和经验）</td></tr><tr><td></td></tr><tr><td>[女性]x[1]</td></tr><tr><td></td></tr><tr><td>[女性]x[2]</td></tr><tr><td></td></tr><tr><td>[女性]x[3]</td></tr><tr><td></td></tr><tr><td>[女性]x[4]</td></tr><tr><td></td></tr><tr><td>世界排名前 200 的大学</td></tr><tr><td></td></tr><tr><td>高质量的工作经验</td></tr><tr><td></td></tr><tr><td>列出课外活动</td></tr><tr><td></td></tr><tr><td>流利的法语和其丨他语言</td></tr><tr><td></td></tr><tr><td>加拿大硕士学位</td></tr><tr><td></td></tr><tr><td></td></tr><tr><td>观察</td></tr><tr><td>R²</td></tr><tr><td>调整后的 R²</td></tr><tr><td>残差标准误差</td></tr><tr><td>F 统计量</td></tr><tr><td></td></tr><tr><td>注：</td></tr></tbody></table> 
<h3><a id="_486"></a>练习</h3> 
<p>1）为什么白人女性的溢价出现在 2009 年 2 月至 9 月的大衰退期间，而在 2008 年 4 月和 8 月之前没有出现？推测。</p> 
<p>2）招聘人员可能更愿意与白人女性丨交谈，但不一定会雇佣她们。我如何能确定更高的回电率是否反映在更多的工作提供中。例如，我如何获取数据来检查这种关系？</p> 
<p>3）你能从下表推断出什么？你有什么见解要分享吗？</p> 
<pre><code class="prism language-py">pd<span class="token punctuation">.</span>crosstab<span class="token punctuation">(</span>index<span class="token operator">=</span> <span class="token punctuation">[</span>df2<span class="token punctuation">[</span><span class="token string">'name_ethnicity'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df2<span class="token punctuation">[</span><span class="token string">'female'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                           df2<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span>df2<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                         values<span class="token operator">=</span>df2<span class="token punctuation">[</span><span class="token string">'callback'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> aggfunc<span class="token operator">=</span><span class="token string">'mean'</span><span class="token punctuation">)</span> 
</code></pre> 
<table><thead><tr><th></th><th></th><th>类型</th><th>0.0</th><th>1.0</th><th>2.0</th><th>3.0</th><th>4.0</th></tr></thead><tbody><tr><td>名字 _ 种族</td><td>女性</td><td>名字</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td></tr><tr><td>加拿大</td><td>0.0</td><td>格雷格·约翰逊</td><td>11.561</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><td>约翰·马丁</td><td>8.235</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td></td><td></td></tr><tr><td>马修·威尔逊</td><td>10.638</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td></td><td></td></tr><tr><td>1.0</td><td>艾莉森·约翰逊</td><td>18.675</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td></td></tr><tr><td>凯丽·马丁</td><td>20.455</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td></td><td></td></tr><tr><td>吉尔·威尔逊</td><td>15.205</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td></td><td></td></tr><tr><td>中国人</td><td>0.0</td><td>刘东</td><td>NaN</td><td>10.870</td><td>3.390</td><td>13.158</td><td>2.381</td></tr><tr><td>李蕾</td><td>NaN</td><td>14.062</td><td>9.756</td><td>8.065</td><td>11.364</td><td></td><td></td></tr><tr><td>张勇</td><td>NaN</td><td>10.227</td><td>7.407</td><td>3.509</td><td>8.333</td><td></td><td></td></tr><tr><td>1.0</td><td>刘敏</td><td>NaN</td><td>8.235</td><td>5.357</td><td>11.321</td><td>15.556</td><td></td></tr><tr><td>李娜</td><td>NaN</td><td>10.127</td><td>12.698</td><td>5.556</td><td>2.703</td><td></td><td></td></tr><tr><td>张秀英</td><td>NaN</td><td>11.927</td><td>6.780</td><td>9.091</td><td>7.018</td><td></td><td></td></tr><tr><td>中国-加拿大</td><td>0.0</td><td>王艾瑞克</td><td>NaN</td><td>9.677</td><td>3.390</td><td>8.889</td><td>0.000</td></tr><tr><td>1.0</td><td>王美琪</td><td>NaN</td><td>12.500</td><td>6.780</td><td>4.348</td><td>3.571</td><td></td></tr><tr><td>希腊</td><td>0.0</td><td>鲁卡斯·米诺普洛斯</td><td>NaN</td><td>10.714</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><td>1.0</td><td>NicoleMinsopoulos</td><td>NaN</td><td>9.596</td><td>NaN</td><td>NaN</td><td>NaN</td><td></td></tr><tr><td>印度人</td><td>0.0</td><td>阿尔琼·库马尔</td><td>NaN</td><td>8.642</td><td>8.333</td><td>3.125</td><td>4.762</td></tr><tr><td>帕纳夫·辛格</td><td>NaN</td><td>1.333</td><td>15.942</td><td>7.317</td><td>2.500</td><td></td><td></td></tr><tr><td>拉胡尔·考尔</td><td>NaN</td><td>8.571</td><td>10.769</td><td>5.455</td><td>7.317</td><td></td><td></td></tr><tr><td>萨米尔·夏尔马</td><td>NaN</td><td>5.814</td><td>6.897</td><td>10.256</td><td>6.522</td><td></td><td></td></tr><tr><td>1.0</td><td>MayaKumar</td><td>NaN</td><td>14.286</td><td>6.944</td><td>3.448</td><td>5.263</td><td></td></tr><tr><td>PriyankaKaur</td><td>NaN</td><td>6.481</td><td>14.815</td><td>3.636</td><td>5.128</td><td></td><td></td></tr><tr><td>ShreyaSharma</td><td>NaN</td><td>13.158</td><td>8.772</td><td>4.651</td><td>5.128</td><td></td><td></td></tr><tr><td>TaraSingh</td><td>NaN</td><td>14.286</td><td>8.065</td><td>9.091</td><td>4.444</td><td></td><td></td></tr></tbody></table> 
<p>4）你能从下表推断出什么？你有什么见解要分享吗？</p> 
<pre><code class="prism language-py">pd<span class="token punctuation">.</span>crosstab<span class="token punctuation">(</span>index<span class="token operator">=</span> df2<span class="token punctuation">[</span><span class="token string">'occupation_type'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   columns<span class="token operator">=</span><span class="token punctuation">[</span>df2<span class="token punctuation">[</span><span class="token string">'name_ethnicity'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df2<span class="token punctuation">[</span><span class="token string">'female'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                   values<span class="token operator">=</span>df2<span class="token punctuation">[</span><span class="token string">'callback'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> aggfunc<span class="token operator">=</span><span class="token string">'mean'</span><span class="token punctuation">)</span> 
</code></pre> 
<table><thead><tr><th>姓名种族</th><th>加拿大</th><th>中国</th><th>中国-加拿大</th><th>希腊</th><th>印度</th></tr></thead><tbody><tr><td>女性</td><td>0.0</td><td>1.0</td><td>0.0</td><td>1.0</td><td>0.0</td></tr><tr><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td></tr><tr><td>职业类型</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td><td>—</td></tr><tr><td>会计</td><td>2.703</td><td>8.929</td><td>5.769</td><td>6.780</td><td>0.000</td></tr><tr><td>行政</td><td>7.895</td><td>23.288</td><td>10.112</td><td>8.036</td><td>6.897</td></tr><tr><td>土木工程师</td><td>5.556</td><td>50.000</td><td>6.250</td><td>6.250</td><td>0.000</td></tr><tr><td>文书工作</td><td>4.444</td><td>8.140</td><td>5.172</td><td>6.000</td><td>0.000</td></tr><tr><td>电子商务</td><td>0.000</td><td>0.000</td><td>9.091</td><td>0.000</td><td>0.000</td></tr><tr><td>电气工程师</td><td>6.250</td><td>28.571</td><td>7.143</td><td>8.333</td><td>14.286</td></tr><tr><td>行政助丨理</td><td>23.077</td><td>17.647</td><td>5.263</td><td>16.000</td><td>16.667</td></tr><tr><td>金融</td><td>16.667</td><td>26.316</td><td>5.000</td><td>12.195</td><td>0.000</td></tr><tr><td>餐饮服务经理</td><td>16.667</td><td>16.667</td><td>0.000</td><td>8.333</td><td>20.000</td></tr><tr><td>人力资源工资</td><td>20.000</td><td>18.182</td><td>0.000</td><td>0.000</td><td>0.000</td></tr><tr><td>保险</td><td>53.846</td><td>40.000</td><td>14.286</td><td>13.636</td><td>28.571</td></tr><tr><td>市场营销和销丨售</td><td>12.791</td><td>22.222</td><td>12.409</td><td>11.966</td><td>9.091</td></tr><tr><td>生产</td><td>0.000</td><td>0.000</td><td>0.000</td><td>4.762</td><td>0.000</td></tr><tr><td>程序员</td><td>10.256</td><td>17.391</td><td>13.462</td><td>10.526</td><td>0.000</td></tr><tr><td>零售</td><td>19.048</td><td>21.622</td><td>14.545</td><td>17.647</td><td>22.727</td></tr><tr><td>技术</td><td>0.000</td><td>16.667</td><td>3.226</td><td>4.000</td><td>0.000</td></tr></tbody></table> 
<p>5）解释表 4 的结果。重点关注固定效应（职业，姓名和城市）的添加。</p> 
<pre><code class="prism language-py">FE <span class="token operator">=</span> <span class="token string">"+ C(occupation_type) + C(city) + C(name)"</span>
model4 <span class="token operator">=</span> <span class="token string">"callback ~ female*C(type) "</span> <span class="token operator">+</span> control1 <span class="token operator">+</span> control2 <span class="token operator">+</span> FE

result4 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> data <span class="token keyword">in</span> sample<span class="token punctuation">:</span>
   ols <span class="token operator">=</span> smf<span class="token punctuation">.</span>ols<span class="token punctuation">(</span>model4<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>cov_type<span class="token operator">=</span><span class="token string">'HC1'</span><span class="token punctuation">)</span>
   result4<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ols<span class="token punctuation">)</span> 
</code></pre> 
<pre><code class="prism language-py">stargazer <span class="token operator">=</span> Stargazer<span class="token punctuation">(</span>result4<span class="token punctuation">)</span>

stargazer<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Table 4 - Callback Rates and Fixed Effects'</span><span class="token punctuation">)</span>
stargazer<span class="token punctuation">.</span>custom_columns<span class="token punctuation">(</span>names<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
stargazer<span class="token punctuation">.</span>rename_covariates<span class="token punctuation">(</span>dict3<span class="token punctuation">)</span>
stargazer<span class="token punctuation">.</span>covariate_order<span class="token punctuation">(</span>list3<span class="token punctuation">)</span>

stargazer<span class="token punctuation">.</span>add_line<span class="token punctuation">(</span><span class="token string">'Fixed Effects'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
stargazer<span class="token punctuation">.</span>add_line<span class="token punctuation">(</span><span class="token string">'Occupation'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
stargazer<span class="token punctuation">.</span>add_line<span class="token punctuation">(</span><span class="token string">'Name'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
stargazer<span class="token punctuation">.</span>add_line<span class="token punctuation">(</span><span class="token string">'City'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

stargazer 
</code></pre> 
<pre><code class="prism language-py">C<span class="token punctuation">:</span>\Anaconda\envs\textbook\lib\site<span class="token operator">-</span>packages\statsmodels\base\model<span class="token punctuation">.</span>py<span class="token punctuation">:</span><span class="token number">1752</span><span class="token punctuation">:</span> ValueWarning<span class="token punctuation">:</span>

covariance of constraints does <span class="token keyword">not</span> have full rank<span class="token punctuation">.</span> The number of constraints <span class="token keyword">is</span> <span class="token number">43</span><span class="token punctuation">,</span> but rank <span class="token keyword">is</span> <span class="token number">1</span>

C<span class="token punctuation">:</span>\Anaconda\envs\textbook\lib\site<span class="token operator">-</span>packages\statsmodels\base\model<span class="token punctuation">.</span>py<span class="token punctuation">:</span><span class="token number">1752</span><span class="token punctuation">:</span> ValueWarning<span class="token punctuation">:</span>

covariance of constraints does <span class="token keyword">not</span> have full rank<span class="token punctuation">.</span> The number of constraints <span class="token keyword">is</span> <span class="token number">41</span><span class="token punctuation">,</span> but rank <span class="token keyword">is</span> <span class="token number">39</span>

C<span class="token punctuation">:</span>\Anaconda\envs\textbook\lib\site<span class="token operator">-</span>packages\statsmodels\base\model<span class="token punctuation">.</span>py<span class="token punctuation">:</span><span class="token number">1752</span><span class="token punctuation">:</span> ValueWarning<span class="token punctuation">:</span>

covariance of constraints does <span class="token keyword">not</span> have full rank<span class="token punctuation">.</span> The number of constraints <span class="token keyword">is</span> <span class="token number">37</span><span class="token punctuation">,</span> but rank <span class="token keyword">is</span> <span class="token number">35</span>

C<span class="token punctuation">:</span>\Anaconda\envs\textbook\lib\site<span class="token operator">-</span>packages\statsmodels\base\model<span class="token punctuation">.</span>py<span class="token punctuation">:</span><span class="token number">1752</span><span class="token punctuation">:</span> ValueWarning<span class="token punctuation">:</span>

covariance of constraints does <span class="token keyword">not</span> have full rank<span class="token punctuation">.</span> The number of constraints <span class="token keyword">is</span> <span class="token number">31</span><span class="token punctuation">,</span> but rank <span class="token keyword">is</span> <span class="token number">29</span> 
</code></pre> 
<p>表 4 - 回拨率和固定效应</p> 
<table><thead><tr><th></th></tr></thead><tbody><tr><td></td></tr><tr><td></td></tr><tr><td>印度</td></tr><tr><td></td></tr><tr><td></td></tr><tr><td>女性</td></tr><tr><td></td></tr><tr><td>0) 英文姓名，加拿大教育和经验</td></tr><tr><td></td></tr><tr><td>1) 外国姓名，加拿大教育和经验</td></tr><tr><td></td></tr><tr><td>2) 外国姓名和教育，加拿大经验</td></tr><tr><td></td></tr><tr><td>3) 外国姓名和教育，混合经验</td></tr><tr><td></td></tr><tr><td>4) 所有外国（姓名，教育和经验）</td></tr><tr><td></td></tr><tr><td>[女性]x[1]</td></tr><tr><td></td></tr><tr><td>[女性]x[2]</td></tr><tr><td></td></tr><tr><td>[女性]x[3]</td></tr><tr><td></td></tr><tr><td>[女性]x[4]</td></tr><tr><td></td></tr><tr><td>世界排名前 200 的大学</td></tr><tr><td></td></tr><tr><td>高质量工作经验</td></tr><tr><td></td></tr><tr><td>列出课外活动</td></tr><tr><td></td></tr><tr><td>流利的法语和其丨他语言</td></tr><tr><td></td></tr><tr><td>加拿大硕士学位</td></tr><tr><td></td></tr><tr><td>固定效应</td></tr><tr><td>职业</td></tr><tr><td>名字</td></tr><tr><td>城市</td></tr><tr><td></td></tr><tr><td>观察</td></tr><tr><td>R²</td></tr><tr><td>调整后的 R²</td></tr><tr><td>残差标准误差</td></tr><tr><td>F 统计量</td></tr><tr><td></td></tr><tr><td>注：</td></tr></tbody></table> 
<p>6）Oreopoulos (2011)收集的第二波实验数据是在 2008 年 9 月至 11 月之间。使用这些数据来调查在加拿大就业市场中是否拥有白人女性姓名会有额外的优势。只生成一张专业出版表，并解释主要结果。</p> 
<p>7）对于这个问题，要像 Bertrand &amp; Mullainathan (2004)和 Oreopoulos (2011)一样打破常规思维。一些研究认为身高较高的人赚更多钱并不是因为身高的直接影响，而是通过自尊心的间接影响。提出一个可行的研究设计来测丨试以下因果关系：</p> 
<p>a) 身高和薪水。</p> 
<p>b) 身高和自尊心。</p> 
<p>c) 自尊心和薪水。</p> 
<h3><a id="_668"></a>参考</h3> 
<p>Bertrand, Marianne, and Sendhil Mullainathan. (2004). <a href="https://github.com/causal-methods/Papers/raw/master/Are%20Emily%20and%20Greg%20More%20Employable%20than%20Lakisha%20and%20Jamal.pdf">Are Emily and Greg More Employable Than Lakisha and Jamal? A Field Experiment on Labor Market Discrimination</a>. American Economic Review, 94 (4): 991-1013.</p> 
<p>Oreopoulos, Philip. (2011). <a href="https://github.com/causal-methods/Papers/raw/master/Oreopoulos/Why%20Do%20Skilled%20Immigrants%20Struggle%20in%20the%20Labor%20Market.pdf">Why Do Skilled Immigrants Struggle in the Labor Market? A Field Experiment with Thirteen Thousand Resumes</a>. American Economic Journal: Economic Policy, 3 (4): 148-71.</p> 
<h2><a id="_675"></a>七、卖丨淫合法化对犯罪的影响</h2> 
<blockquote> 
 <p>原文：<a href="https://causal-methods.github.io/Book/7%29_The_Impact_of_Legalizing_Prostitution_on_Crime.html" rel="nofollow"><code>causal-methods.github.io/Book/7%29_The_Impact_of_Legalizing_Prostitution_on_Crime.html</code></a></p> 
 <p>译者：<a href="https://github.com/wizardforcel">飞龙</a></p> 
 <p>协议：<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" rel="nofollow">CC BY-NC-SA 4.0</a></p> 
</blockquote> 
<p><a href="https://www.linkedin.com/in/vitor-kamada-1b73a078" rel="nofollow">Vitor Kamada</a></p> 
<p>电子邮件：econometrics.methods@gmail.com</p> 
<p>最近更新：2020 年 11 月 2 日</p> 
<p>在荷兰，有法定的卖丨淫区，荷兰称之为 tippelzones。Bisschop 等人（2017）报告称，tippelzone 的开放可以减少大约 30-40%的性丨虐丨待和强丨奸案件。</p> 
<p>让我们打开 Bisschop 等人的数据集。每一行是荷兰的一个城市。同一个城市在 1994 年至 2011 年之间被观察到。</p> 
<pre><code class="prism language-py"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'precision'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>

<span class="token comment"># Data from Bisschop et al. (2017)</span>
path <span class="token operator">=</span> <span class="token string">"https://github.com/causal-methods/Data/raw/master/"</span> 
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_stata<span class="token punctuation">(</span>path <span class="token operator">+</span> <span class="token string">"CBSregist2015.dta"</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> 
</code></pre> 
<table><thead><tr><th></th><th>城市</th><th>年份</th><th>开放</th><th>关闭</th><th>城市 1</th><th>logpopdens</th><th>openingReg</th><th>mayorCDA</th><th>mayorCU</th><th>mayorD66</th><th>…</th><th>相似盗窃率</th><th>聚合盗窃率</th><th>相似盗窃率的自然对数</th><th>聚合盗窃率的自然对数</th><th>盗窃率</th><th>盗窃率的自然对数</th><th>职务侵犯率</th><th>职务暴力率</th><th>职务侵犯率的自然对数</th><th>职务暴力率的自然对数</th></tr></thead><tbody><tr><td>0</td><td>阿姆斯特丹</td><td>1994-01-01</td><td>0.0</td><td>0.0</td><td>1.0</td><td>8.381</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>…</td><td>59.246</td><td>57.934</td><td>8.364</td><td>8.342</td><td>117.181</td><td>9.046</td><td>7.596</td><td>5.110</td><td>6.310</td><td>5.914</td></tr><tr><td>1</td><td>阿姆斯特丹</td><td>1995-01-01</td><td>0.0</td><td>0.0</td><td>1.0</td><td>8.379</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>…</td><td>50.815</td><td>43.823</td><td>8.208</td><td>8.060</td><td>94.637</td><td>8.830</td><td>7.061</td><td>4.361</td><td>6.234</td><td>5.753</td></tr><tr><td>2</td><td>阿姆斯特丹</td><td>1996-01-01</td><td>1.0</td><td>0.0</td><td>1.0</td><td>8.373</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>…</td><td>42.333</td><td>37.111</td><td>8.020</td><td>7.888</td><td>79.444</td><td>8.649</td><td>7.520</td><td>5.431</td><td>6.292</td><td>5.966</td></tr><tr><td>3</td><td>阿姆斯特丹</td><td>1997-01-01</td><td>1.0</td><td>0.0</td><td>1.0</td><td>8.369</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>…</td><td>46.843</td><td>32.860</td><td>8.117</td><td>7.762</td><td>79.704</td><td>8.648</td><td>6.852</td><td>4.195</td><td>6.194</td><td>5.704</td></tr><tr><td>4</td><td>阿姆斯特丹</td><td>1998-01-01</td><td>1.0</td><td>0.0</td><td>1.0</td><td>8.373</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>…</td><td>45.255</td><td>33.907</td><td>8.086</td><td>7.798</td><td>79.162</td><td>8.646</td><td>6.127</td><td>4.595</td><td>6.087</td><td>5.799</td></tr></tbody></table> 
<p>5 行×65 列</p> 
<p>让我们将城市分成 3 组。大城市和中等城市至少在某一年有 tippelzone，而样本中的其丨他城市没有 tippelzone。</p> 
<pre><code class="prism language-py">big_cities <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Amsterdam"</span><span class="token punctuation">,</span> <span class="token string">"Rotterdam"</span><span class="token punctuation">,</span> <span class="token string">"Den Haag"</span><span class="token punctuation">]</span>
medium_cities <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Utrecht"</span><span class="token punctuation">,</span> <span class="token string">"Nijmegen"</span><span class="token punctuation">,</span> <span class="token string">"Groningen"</span><span class="token punctuation">,</span>
                 <span class="token string">"Heerlen"</span><span class="token punctuation">,</span> <span class="token string">"Eindhoven"</span><span class="token punctuation">,</span> <span class="token string">"Arnhem"</span><span class="token punctuation">]</span>

<span class="token comment"># Classify cities</span>
<span class="token keyword">def</span> <span class="token function">classify</span><span class="token punctuation">(</span>var<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> var <span class="token keyword">in</span> big_cities<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">"Big Cities"</span>
    <span class="token keyword">elif</span> var <span class="token keyword">in</span> medium_cities<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">"Medium Cities"</span>    
    <span class="token keyword">else</span><span class="token punctuation">:</span>   
        <span class="token keyword">return</span> <span class="token string">"No tippelzone"</span>

df<span class="token punctuation">[</span><span class="token string">'group'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">"city"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>classify<span class="token punctuation">)</span> 
</code></pre> 
<p>以下是每 10,000 名居民的年度犯罪报告。总体而言，大城市的犯罪率更高。唯一的例外是与毒丨品有关的犯罪。</p> 
<pre><code class="prism language-py">outcome <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'sexassaultpcN'</span><span class="token punctuation">,</span> <span class="token string">'rapepcN'</span><span class="token punctuation">,</span> 
	<span class="token string">'drugspcN'</span><span class="token punctuation">,</span> <span class="token string">'maltreatpcN'</span><span class="token punctuation">,</span> <span class="token string">'weaponspcN'</span><span class="token punctuation">]</span>

df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'group'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>outcome<span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T 
</code></pre> 
<table><thead><tr><th>组</th><th>大城市</th><th>中等城市</th><th>无 tippelzone</th></tr></thead><tbody><tr><td>性丨侵犯率</td><td>0.775</td><td>0.626</td><td>0.664</td></tr><tr><td>强丨奸率</td><td>1.032</td><td>0.846</td><td>0.691</td></tr><tr><td>毒丨品犯罪率</td><td>14.921</td><td>15.599</td><td>12.779</td></tr><tr><td>maltreatpcN</td><td>21.259</td><td>18.665</td><td>17.864</td></tr><tr><td>weaponspcN</td><td>5.635</td><td>4.385</td><td>4.207</td></tr></tbody></table> 
<p>tippelzones 城市的人口和人口密度比没有 tippelzones 的城市更多。平均家庭收入（以 1,000 欧元计）在 3 个组中相似。tippelzones 城市也有受过较高教育的个体。移民比例在大城市中更高（11.4%）。社丨会保险福利（“insurWWAO_pc”）的份额与 3 个组相似。</p> 
<pre><code class="prism language-py">demographics <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'popul_100'</span><span class="token punctuation">,</span> <span class="token string">'pop_dens_100'</span><span class="token punctuation">,</span> <span class="token string">'popmale1565_100'</span><span class="token punctuation">,</span>
            <span class="token string">'inkhh'</span><span class="token punctuation">,</span> <span class="token string">'educhpc'</span><span class="token punctuation">,</span> <span class="token string">'nondutchpc'</span><span class="token punctuation">,</span> <span class="token string">'insurWWAO_pc'</span><span class="token punctuation">]</span>

df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'group'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>demographics<span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T 
</code></pre> 
<table><thead><tr><th>组</th><th>大城市</th><th>中等城市</th><th>无 tippelzone</th></tr></thead><tbody><tr><td>popul_100</td><td>5974.886</td><td>1724.191</td><td>1131.138</td></tr><tr><td>pop_dens_100</td><td>43.258</td><td>22.977</td><td>19.560</td></tr><tr><td>popmale1565_100</td><td>2101.446</td><td>617.019</td><td>392.255</td></tr><tr><td>inkhh</td><td>29.052</td><td>28.989</td><td>30.502</td></tr><tr><td>educhpc</td><td>0.300</td><td>0.317</td><td>0.245</td></tr><tr><td>非荷兰人比例</td><td>0.114</td><td>0.059</td><td>0.052</td></tr><tr><td>insurWWAO_pc</td><td>0.074</td><td>0.081</td><td>0.078</td></tr></tbody></table> 
<p>基丨督丨教联盟在没有 tippelzone 的城市中拥有更多的市长（31%）。值得一提的是，该党反对开放 tippelzone。</p> 
<pre><code class="prism language-py">political_party <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'mayorSoc'</span><span class="token punctuation">,</span> <span class="token string">'mayorLib'</span><span class="token punctuation">,</span> <span class="token string">'mayorChr'</span><span class="token punctuation">]</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'group'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>political_party<span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T 
</code></pre> 
<table><thead><tr><th>组</th><th>大城市</th><th>中等城市</th><th>无 tippelzone</th></tr></thead><tbody><tr><td>mayorSoc</td><td>0.481</td><td>0.556</td><td>0.410</td></tr><tr><td>mayorLib</td><td>0.259</td><td>0.324</td><td>0.278</td></tr><tr><td>mayorChr</td><td>0.259</td><td>0.120</td><td>0.312</td></tr></tbody></table> 
<p>数据集是平衡的面板数据。有必要按顺序声明指数：分析单位和时间单位。</p> 
<pre><code class="prism language-py">df<span class="token punctuation">[</span><span class="token string">'year'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>DatetimeIndex<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'year'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>year
df<span class="token punctuation">[</span><span class="token string">'Dyear'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>Categorical<span class="token punctuation">(</span>df<span class="token punctuation">.</span>year<span class="token punctuation">)</span>

<span class="token comment"># Set Panel Data</span>
<span class="token comment"># Set city as the unit of analysis</span>
df25 <span class="token operator">=</span> df<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'city1'</span><span class="token punctuation">,</span> <span class="token string">'year'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
</code></pre> 
<p>设<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          Y 
         
         
         
           c 
          
         
           t 
          
         
        
       
      
        Y_{ct} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.2222em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>为城市<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         c 
        
       
      
        c 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span>在年份<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         t 
        
       
      
        t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span>的犯罪率。设<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          D 
         
         
         
           c 
          
         
           t 
          
         
        
       
      
        D_{ct} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> = 1，如果城市<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         c 
        
       
      
        c 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span>在年份<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         t 
        
       
      
        t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span>有开放的 tippelzone；否则为 0。让我们估计以下模型：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          l 
         
        
          n 
         
        
          ( 
         
         
         
           Y 
          
          
          
            c 
           
          
            t 
           
          
         
        
          ) 
         
        
          = 
         
         
         
           α 
          
         
           c 
          
         
        
          + 
         
        
          ρ 
         
         
         
           D 
          
          
          
            c 
           
          
            t 
           
          
         
        
          + 
         
        
          β 
         
         
         
           X 
          
          
          
            c 
           
          
            t 
           
          
         
        
          + 
         
         
         
           γ 
          
         
           t 
          
         
        
          + 
         
         
         
           ϵ 
          
          
          
            c 
           
          
            t 
           
          
         
        
       
         ln(Y_{ct})=\alpha_c+\rho D_{ct}+\beta X_{ct}+\gamma_t + \epsilon_{ct} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.2222em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">ρ</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0528em;">β</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7778em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.0556em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>其中<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          α 
         
        
          c 
         
        
       
      
        \alpha_c 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>是城市固定效应，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          X 
         
         
         
           c 
          
         
           t 
          
         
        
       
      
        X_{ct} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>是控制变量向量，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          γ 
         
        
          t 
         
        
       
      
        \gamma_t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.0556em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>是年固定效应，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          ϵ 
         
         
         
           c 
          
         
           t 
          
         
        
       
      
        \epsilon_{ct} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>是通常的误差项。</p> 
<pre><code class="prism language-py"><span class="token keyword">import</span> statsmodels<span class="token punctuation">.</span>formula<span class="token punctuation">.</span>api <span class="token keyword">as</span> smf

Ys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"lnsexassaultN"</span><span class="token punctuation">,</span> <span class="token string">"lnrapeN"</span><span class="token punctuation">,</span> <span class="token string">"lndrugsN"</span><span class="token punctuation">,</span>
      <span class="token string">"lnweaponsN"</span><span class="token punctuation">,</span> <span class="token string">"lnmaltreatN"</span><span class="token punctuation">]</span>

base <span class="token operator">=</span> <span class="token string">"~ 1 + opening"</span>
fe <span class="token operator">=</span> <span class="token string">"+ C(city) + C(Dyear)"</span>

controls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'logpopmale1565'</span><span class="token punctuation">,</span> <span class="token string">'logpopdens'</span><span class="token punctuation">,</span> <span class="token string">'inkhh'</span><span class="token punctuation">,</span> 
	<span class="token string">'educhpc'</span><span class="token punctuation">,</span> <span class="token string">'nondutchpc'</span><span class="token punctuation">,</span> <span class="token string">'insurWWAO'</span><span class="token punctuation">,</span> <span class="token string">'mayorCDA'</span><span class="token punctuation">,</span>
  <span class="token string">'mayorCU'</span><span class="token punctuation">,</span> <span class="token string">'mayorD66'</span><span class="token punctuation">,</span> <span class="token string">'mayorVVD'</span><span class="token punctuation">]</span>

Xs <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">for</span> var <span class="token keyword">in</span> controls<span class="token punctuation">:</span>
    Xs <span class="token operator">=</span> Xs <span class="token operator">+</span> <span class="token string">'+'</span> <span class="token operator">+</span> var

columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> Y <span class="token keyword">in</span> Ys<span class="token punctuation">:</span>
  result <span class="token operator">=</span> smf<span class="token punctuation">.</span>ols<span class="token punctuation">(</span>Y <span class="token operator">+</span> base <span class="token operator">+</span> fe <span class="token operator">+</span> Xs<span class="token punctuation">,</span> df25<span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>cov_type<span class="token operator">=</span><span class="token string">'cluster'</span><span class="token punctuation">,</span>
                cov_kwds<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'groups'</span><span class="token punctuation">:</span> df25<span class="token punctuation">[</span><span class="token string">'city'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  columns<span class="token punctuation">.</span>append<span class="token punctuation">(</span>result<span class="token punctuation">)</span> 
</code></pre> 
<pre><code class="prism language-py">C<span class="token punctuation">:</span>\Anaconda\envs\textbook\lib\site<span class="token operator">-</span>packages\statsmodels\tools\_testing<span class="token punctuation">.</span>py<span class="token punctuation">:</span><span class="token number">19</span><span class="token punctuation">:</span> FutureWarning<span class="token punctuation">:</span> pandas<span class="token punctuation">.</span>util<span class="token punctuation">.</span>testing <span class="token keyword">is</span> deprecated<span class="token punctuation">.</span> Use the functions <span class="token keyword">in</span> the public API at pandas<span class="token punctuation">.</span>testing instead<span class="token punctuation">.</span>
  <span class="token keyword">import</span> pandas<span class="token punctuation">.</span>util<span class="token punctuation">.</span>testing <span class="token keyword">as</span> tm 
</code></pre> 
<pre><code class="prism language-py"><span class="token comment">#  Library to print professional publication</span>
<span class="token comment"># tables in Latex, HTML, etc.</span>
!pip install stargazer 
</code></pre> 
<pre><code class="prism language-py">Requirement already satisfied<span class="token punctuation">:</span> stargazer <span class="token keyword">in</span> c<span class="token punctuation">:</span>\anaconda\envs\textbook\lib\site<span class="token operator">-</span>packages <span class="token punctuation">(</span><span class="token number">0.0</span><span class="token number">.5</span><span class="token punctuation">)</span> 
</code></pre> 
<pre><code class="prism language-py">WARNING<span class="token punctuation">:</span> Error parsing requirements <span class="token keyword">for</span> numpy<span class="token punctuation">:</span> <span class="token punctuation">[</span>Errno <span class="token number">2</span><span class="token punctuation">]</span> No such <span class="token builtin">file</span> <span class="token keyword">or</span> directory<span class="token punctuation">:</span> <span class="token string">'c:\\anaconda\\envs\\textbook\\lib\\site-packages\\numpy-1.19.2.dist-info\\METADATA'</span> 
</code></pre> 
<p>第 1 列表明开放 tippelzone 将性丨虐丨待减少 26%（<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          e 
         
         
         
           − 
          
         
           0.302 
          
         
        
       
         − 
        
       
         1 
        
       
      
        e^{-0.302}-1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8974em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">0.302</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>）。在其丨他列中，tippelzone 的系数在统计上不显著。看起来合法化卖丨淫会减少性丨虐丨待，但不会减少其丨他犯罪，如强丨奸、攻击、非法武器和毒丨品相关犯罪。</p> 
<pre><code class="prism language-py"><span class="token comment"># Settings for a nice table</span>
<span class="token keyword">from</span> stargazer<span class="token punctuation">.</span>stargazer <span class="token keyword">import</span> Stargazer
stargazer <span class="token operator">=</span> Stargazer<span class="token punctuation">(</span>columns<span class="token punctuation">)</span>

stargazer<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'The Impact of Tippelzone on Crime'</span><span class="token punctuation">)</span>

names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Sex Abuse'</span><span class="token punctuation">,</span> <span class="token string">'Rape'</span><span class="token punctuation">,</span> <span class="token string">'Drugs'</span><span class="token punctuation">,</span> <span class="token string">'Weapons'</span><span class="token punctuation">,</span> <span class="token string">'Assault'</span><span class="token punctuation">]</span>
stargazer<span class="token punctuation">.</span>custom_columns<span class="token punctuation">(</span>names<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

stargazer<span class="token punctuation">.</span>covariate_order<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'opening'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

stargazer<span class="token punctuation">.</span>add_line<span class="token punctuation">(</span><span class="token string">'Covariates'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

stargazer<span class="token punctuation">.</span>add_line<span class="token punctuation">(</span><span class="token string">'City Fixed Effects'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
stargazer<span class="token punctuation">.</span>add_line<span class="token punctuation">(</span><span class="token string">'Year Fixed Effects'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

stargazer 
</code></pre> 
<pre><code class="prism language-py">C<span class="token punctuation">:</span>\Anaconda\envs\textbook\lib\site<span class="token operator">-</span>packages\statsmodels\base\model<span class="token punctuation">.</span>py<span class="token punctuation">:</span><span class="token number">1752</span><span class="token punctuation">:</span> ValueWarning<span class="token punctuation">:</span> covariance of constraints does <span class="token keyword">not</span> have full rank<span class="token punctuation">.</span> The number of constraints <span class="token keyword">is</span> <span class="token number">52</span><span class="token punctuation">,</span> but rank <span class="token keyword">is</span> <span class="token number">24</span>
  <span class="token string">'rank is %d'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>J<span class="token punctuation">,</span> J_<span class="token punctuation">)</span><span class="token punctuation">,</span> ValueWarning<span class="token punctuation">)</span>
C<span class="token punctuation">:</span>\Anaconda\envs\textbook\lib\site<span class="token operator">-</span>packages\statsmodels\base\model<span class="token punctuation">.</span>py<span class="token punctuation">:</span><span class="token number">1752</span><span class="token punctuation">:</span> ValueWarning<span class="token punctuation">:</span> covariance of constraints does <span class="token keyword">not</span> have full rank<span class="token punctuation">.</span> The number of constraints <span class="token keyword">is</span> <span class="token number">52</span><span class="token punctuation">,</span> but rank <span class="token keyword">is</span> <span class="token number">24</span>
  <span class="token string">'rank is %d'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>J<span class="token punctuation">,</span> J_<span class="token punctuation">)</span><span class="token punctuation">,</span> ValueWarning<span class="token punctuation">)</span>
C<span class="token punctuation">:</span>\Anaconda\envs\textbook\lib\site<span class="token operator">-</span>packages\statsmodels\base\model<span class="token punctuation">.</span>py<span class="token punctuation">:</span><span class="token number">1752</span><span class="token punctuation">:</span> ValueWarning<span class="token punctuation">:</span> covariance of constraints does <span class="token keyword">not</span> have full rank<span class="token punctuation">.</span> The number of constraints <span class="token keyword">is</span> <span class="token number">52</span><span class="token punctuation">,</span> but rank <span class="token keyword">is</span> <span class="token number">24</span>
  <span class="token string">'rank is %d'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>J<span class="token punctuation">,</span> J_<span class="token punctuation">)</span><span class="token punctuation">,</span> ValueWarning<span class="token punctuation">)</span>
C<span class="token punctuation">:</span>\Anaconda\envs\textbook\lib\site<span class="token operator">-</span>packages\statsmodels\base\model<span class="token punctuation">.</span>py<span class="token punctuation">:</span><span class="token number">1752</span><span class="token punctuation">:</span> ValueWarning<span class="token punctuation">:</span> covariance of constraints does <span class="token keyword">not</span> have full rank<span class="token punctuation">.</span> The number of constraints <span class="token keyword">is</span> <span class="token number">52</span><span class="token punctuation">,</span> but rank <span class="token keyword">is</span> <span class="token number">24</span>
  <span class="token string">'rank is %d'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>J<span class="token punctuation">,</span> J_<span class="token punctuation">)</span><span class="token punctuation">,</span> ValueWarning<span class="token punctuation">)</span>
C<span class="token punctuation">:</span>\Anaconda\envs\textbook\lib\site<span class="token operator">-</span>packages\statsmodels\base\model<span class="token punctuation">.</span>py<span class="token punctuation">:</span><span class="token number">1752</span><span class="token punctuation">:</span> ValueWarning<span class="token punctuation">:</span> covariance of constraints does <span class="token keyword">not</span> have full rank<span class="token punctuation">.</span> The number of constraints <span class="token keyword">is</span> <span class="token number">52</span><span class="token punctuation">,</span> but rank <span class="token keyword">is</span> <span class="token number">24</span>
  <span class="token string">'rank is %d'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>J<span class="token punctuation">,</span> J_<span class="token punctuation">)</span><span class="token punctuation">,</span> ValueWarning<span class="token punctuation">)</span> 
</code></pre> 
<p>Tippelzone 对犯罪的影响</p> 
<table><thead><tr><th></th></tr></thead><tbody><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td>开放</td></tr><tr><td></td></tr><tr><td>协变量</td></tr><tr><td>城市固定效应</td></tr><tr><td>年固定效应</td></tr><tr><td></td></tr><tr><td>观察</td></tr><tr><td>R²</td></tr><tr><td>调整 R²</td></tr><tr><td>残差标准误差</td></tr><tr><td>F 统计量</td></tr><tr><td></td></tr><tr><td>注意：</td></tr></tbody></table> 
<pre><code class="prism language-py"><span class="token keyword">import</span> math
math<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.302</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> 
</code></pre> 
<pre><code class="prism language-py"><span class="token operator">-</span><span class="token number">0.2606619351104681</span> 
</code></pre> 
<h3><a id="_909"></a>练习</h3> 
<p>1）在论文的引言部分，Bisschop 等人（2017: 29）表示：“我们的研究是第一个提供卖丨淫监丨管与犯罪之间关联的因果证据之一。”在讨论部分，Bisschop 等人（2017:44）表示：“开放 tippelzone，无论是否有许可制度，都与性丨虐丨待和强丨奸的短期减少 30-40%相关，并且结果在不同规范下都是稳健的。”为什么 Bisschop 等人（2017）在引言部分使用“因果”一词，在讨论部分使用“相关”一词？您是否认为 Bisschop 等人（2017）的主要结果是“因果”还是“相关”？请解释。</p> 
<p>2）Bisschop 等人（2017: 29）表示：“我们进行了几项实证测丨试，以评估 tippelzone 开放周围的内生犯罪趋势。”他们为什么这样做？这其中的逻辑是什么？是否存在内生犯罪趋势？请解释并具体说明您的答案。</p> 
<p>3）Bisschop 等人（2017: 36）表示：“…时间趋势<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          μ 
         
        
          t 
         
        
       
      
        \mu_t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>是使用年固定效应来建模的。”模拟时间趋势的其丨他方法是什么？编写不同假设下创建时间趋势的代码片段。提示：记住这是面板数据。在横截面数据中有效的代码将在面板数据结构中创建错误的变量。</p> 
<p>4）Bisschop 等人（2017: 36）表示：“我们使用差异中的差异规范来研究 tippelzone 存在对各种犯罪的影响。”部署差异中的差异估计器的关键假设是什么？</p> 
<p>5）复制表格“Tippelzone 对犯罪的影响”，不包括阿姆斯特丹、鹿特丹和海牙。此外，用以下四个变量替换变量“opening”：</p> 
<p>i) “everopenNoReg”: 如果城市<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         c 
        
       
      
        c 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span>在年份<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         t 
        
       
      
        t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span>之前曾开放过没有许可证的 tippelzone，则为 1，否则为 0。</p> 
<p>ii) “openingRegP”: 如果城市<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         c 
        
       
      
        c 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span>在年份<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         t 
        
       
      
        t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span>之前开放了 tippelzone 并引入了事后许可证，则为 1，否则为 0。</p> 
<p>iii) “openingRegA”: 如果城市<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         c 
        
       
      
        c 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span>在年份<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         t 
        
       
      
        t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span>之前曾开放过带有许可证的 tippelzone，则为 1，否则为 0。</p> 
<p>iv) “closing”: 如果城市<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         c 
        
       
      
        c 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span>在年份<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         t 
        
       
      
        t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span>之前关闭 tippelzone，则为 1，否则为 0。</p> 
<p>解释结果。</p> 
<h3><a id="_931"></a>参考</h3> 
<p>Bisschop, Paul, Stephen Kastoryano, and Bas van der Klaauw. (2017). <a href="https://github.com/causal-methods/Papers/raw/master/Street%20Prostitution%20Zones%20and%20Crime.pdf">街头卖丨淫区和犯罪</a>. 美丨国经济学杂志：经济政策，9 (4): 28-63.</p> 
<h2><a id="Airbnb__936"></a>八、Airbnb 的主人是否歧视黑人客人？</h2> 
<blockquote> 
 <p>原文：<a href="https://causal-methods.github.io/Book/8%29_Do_Hosts_Discriminate_against_Black_Guests_in_Airbnb.html" rel="nofollow"><code>causal-methods.github.io/Book/8%29_Do_Hosts_Discriminate_against_Black_Guests_in_Airbnb.html</code></a></p> 
 <p>译者：<a href="https://github.com/wizardforcel">飞龙</a></p> 
 <p>协议：<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" rel="nofollow">CC BY-NC-SA 4.0</a></p> 
</blockquote> 
<p><a href="https://www.linkedin.com/in/vitor-kamada-1b73a078" rel="nofollow">Vitor Kamada</a></p> 
<p>电子邮件：econometrics.methods@gmail.com</p> 
<p>最后更新时间：11-1-2020</p> 
<p>Edelman et al.（2017）发现，黑人名字听起来比白人名字听起来更不可能被 Airbnb 接受为客人，减少了 16%。这个结果不仅仅是相关性。种族变量是随机的。黑人和白人之间唯一的区别是名字。除此之外，黑人和白人客人是一样的。</p> 
<p>让我们打开 Edelman 等人（2017）的数据集。每一行是 2015 年 7 月 Airbnb 的一处物业。样本由巴尔的摩、达拉斯、洛杉矶、圣路丨易斯和华丨盛丨顿特区的所有物业组成。</p> 
<pre><code class="prism language-py"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'precision'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>

<span class="token comment"># Data from Edelman et al. (2017)</span>
path <span class="token operator">=</span> <span class="token string">"https://github.com/causal-methods/Data/raw/master/"</span> 
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>path <span class="token operator">+</span> <span class="token string">"Airbnb.csv"</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> 
</code></pre> 
<table><thead><tr><th></th><th>主人回应</th><th>回应日期</th><th>消息数量</th><th>自动编码</th><th>纬度</th><th>经度</th><th>床类型</th><th>物业类型</th><th>取消政策</th><th>客人数量</th><th>…</th><th>洛杉矶</th><th>圣路丨易斯</th><th>华丨盛丨顿特区</th><th>总客人</th><th>原始黑人</th><th>物业黑人</th><th>任何黑人</th><th>过去客人合并</th><th>九月填充</th><th>pr 填充</th></tr></thead><tbody><tr><td>0</td><td>是</td><td>2015-07-19 08:26:17</td><td>2.0</td><td>1.0</td><td>34.081</td><td>-118.270</td><td>真正的床</td><td>房子</td><td>灵活</td><td>3.0</td><td>…</td><td>1</td><td>0</td><td>0</td><td>11.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>匹配（3）</td><td>1</td><td>0.412</td></tr><tr><td>1</td><td>否或不可用</td><td>2015-07-14 14:13:39</td><td>NaN</td><td>1.0</td><td>38.911</td><td>-77.020</td><td>NaN</td><td>房子</td><td>中等</td><td>2.0</td><td>…</td><td>0</td><td>0</td><td>1</td><td>167.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>匹配（3）</td><td>1</td><td>0.686</td></tr><tr><td>2</td><td>请求更多信息（你能验证吗？有多少…</td><td>2015-07-20 16:24:08</td><td>2.0</td><td>0.0</td><td>34.005</td><td>-118.481</td><td>拉出沙发</td><td>公寓</td><td>严格</td><td>1.0</td><td>…</td><td>1</td><td>0</td><td>0</td><td>19.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>匹配（3）</td><td>0</td><td>0.331</td></tr><tr><td>3</td><td>我会回复你</td><td>2015-07-20 06:47:38</td><td>NaN</td><td>0.0</td><td>34.092</td><td>-118.282</td><td>NaN</td><td>房子</td><td>严格</td><td>8.0</td><td>…</td><td>1</td><td>0</td><td>0</td><td>41.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>匹配（3）</td><td>0</td><td>0.536</td></tr><tr><td>4</td><td>未发送消息</td><td>.</td><td>NaN</td><td>1.0</td><td>38.830</td><td>-76.897</td><td>真正的床</td><td>房子</td><td>严格</td><td>2.0</td><td>…</td><td>0</td><td>0</td><td>1</td><td>28.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>匹配（3）</td><td>1</td><td>0.555</td></tr></tbody></table> 
<p>5 行×104 列</p> 
<p>下面的图表显示，黑人客人收到的“是”的回应比白人客人少。有人可能会争辩说 Edelman 等人（2017）的结果是由主人回应的差异驱动的，比如有条件的或非回应。例如，你可以争辩说黑人更有可能有被归类为垃丨圾邮件的假账户。然而，请注意，歧视结果是由“是”和“否”驱动的，而不是由中间回应驱动的。</p> 
<pre><code class="prism language-py"><span class="token comment"># Data for bar chart</span>
count <span class="token operator">=</span> pd<span class="token punctuation">.</span>crosstab<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">"graph_bins"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">"guest_black"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">import</span> plotly<span class="token punctuation">.</span>graph_objects <span class="token keyword">as</span> go

node <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Conditional No'</span><span class="token punctuation">,</span> <span class="token string">'Conditional Yes'</span><span class="token punctuation">,</span> <span class="token string">'No'</span><span class="token punctuation">,</span>
        <span class="token string">'No Response'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">]</span>
fig <span class="token operator">=</span> go<span class="token punctuation">.</span>Figure<span class="token punctuation">(</span>data<span class="token operator">=</span><span class="token punctuation">[</span>
    go<span class="token punctuation">.</span>Bar<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'Guest is white'</span><span class="token punctuation">,</span> x<span class="token operator">=</span>node<span class="token punctuation">,</span> y<span class="token operator">=</span>count<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    go<span class="token punctuation">.</span>Bar<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'Guest is African American'</span><span class="token punctuation">,</span> x<span class="token operator">=</span>node<span class="token punctuation">,</span> y<span class="token operator">=</span>count<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">]</span><span class="token punctuation">)</span>

fig<span class="token punctuation">.</span>update_layout<span class="token punctuation">(</span>barmode<span class="token operator">=</span><span class="token string">'group'</span><span class="token punctuation">,</span>
  title_text <span class="token operator">=</span> <span class="token string">'Host Responses by Race'</span><span class="token punctuation">,</span>
  font<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token number">18</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>

fig<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span> 
</code></pre> 
<p>让我们复制 Edelman 等人（2017）的主要结果。</p> 
<pre><code class="prism language-py"><span class="token keyword">import</span> statsmodels<span class="token punctuation">.</span>api <span class="token keyword">as</span> sm

df<span class="token punctuation">[</span><span class="token string">'const'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span> 

<span class="token comment"># Column 1</span>
<span class="token comment">#  The default missing ='drop' of statsmodels doesn't apply</span>
<span class="token comment"># to the cluster variable. Therefore, it is necessary to drop</span>
<span class="token comment"># the missing values like below to get the clustered standard </span>
<span class="token comment"># errors.</span>
df1 <span class="token operator">=</span> df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'yes'</span><span class="token punctuation">,</span> <span class="token string">'guest_black'</span><span class="token punctuation">,</span> <span class="token string">'name_by_city'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
reg1 <span class="token operator">=</span> sm<span class="token punctuation">.</span>OLS<span class="token punctuation">(</span>df1<span class="token punctuation">[</span><span class="token string">'yes'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df1<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'const'</span><span class="token punctuation">,</span> <span class="token string">'guest_black'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
res1 <span class="token operator">=</span> reg1<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>cov_type<span class="token operator">=</span><span class="token string">'cluster'</span><span class="token punctuation">,</span>
                cov_kwds<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'groups'</span><span class="token punctuation">:</span> df1<span class="token punctuation">[</span><span class="token string">'name_by_city'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment"># Column 2</span>
vars2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'yes'</span><span class="token punctuation">,</span> <span class="token string">'guest_black'</span><span class="token punctuation">,</span> <span class="token string">'name_by_city'</span><span class="token punctuation">,</span> 
        <span class="token string">'host_race_black'</span><span class="token punctuation">,</span> <span class="token string">'host_gender_M'</span><span class="token punctuation">]</span>
df2 <span class="token operator">=</span> df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>subset <span class="token operator">=</span> vars2<span class="token punctuation">)</span>
reg2 <span class="token operator">=</span> sm<span class="token punctuation">.</span>OLS<span class="token punctuation">(</span>df2<span class="token punctuation">[</span><span class="token string">'yes'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df2<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'const'</span><span class="token punctuation">,</span> <span class="token string">'guest_black'</span><span class="token punctuation">,</span>
                    <span class="token string">'host_race_black'</span><span class="token punctuation">,</span> <span class="token string">'host_gender_M'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
res2 <span class="token operator">=</span> reg2<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>cov_type<span class="token operator">=</span><span class="token string">'cluster'</span><span class="token punctuation">,</span>
                cov_kwds<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'groups'</span><span class="token punctuation">:</span> df2<span class="token punctuation">[</span><span class="token string">'name_by_city'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment"># Column 3</span>
vars3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'yes'</span><span class="token punctuation">,</span> <span class="token string">'guest_black'</span><span class="token punctuation">,</span> <span class="token string">'name_by_city'</span><span class="token punctuation">,</span> 
         <span class="token string">'host_race_black'</span><span class="token punctuation">,</span> <span class="token string">'host_gender_M'</span><span class="token punctuation">,</span>
         <span class="token string">'multiple_listings'</span><span class="token punctuation">,</span> <span class="token string">'shared_property'</span><span class="token punctuation">,</span>
         <span class="token string">'ten_reviews'</span><span class="token punctuation">,</span> <span class="token string">'log_price'</span><span class="token punctuation">]</span>
df3 <span class="token operator">=</span> df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>subset <span class="token operator">=</span> vars3<span class="token punctuation">)</span>
reg3 <span class="token operator">=</span> sm<span class="token punctuation">.</span>OLS<span class="token punctuation">(</span>df3<span class="token punctuation">[</span><span class="token string">'yes'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df3<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'const'</span><span class="token punctuation">,</span> <span class="token string">'guest_black'</span><span class="token punctuation">,</span>
                    <span class="token string">'host_race_black'</span><span class="token punctuation">,</span> <span class="token string">'host_gender_M'</span><span class="token punctuation">,</span>
                    <span class="token string">'multiple_listings'</span><span class="token punctuation">,</span> <span class="token string">'shared_property'</span><span class="token punctuation">,</span>
                    <span class="token string">'ten_reviews'</span><span class="token punctuation">,</span> <span class="token string">'log_price'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
res3 <span class="token operator">=</span> reg3<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>cov_type<span class="token operator">=</span><span class="token string">'cluster'</span><span class="token punctuation">,</span>
                cov_kwds<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'groups'</span><span class="token punctuation">:</span> df3<span class="token punctuation">[</span><span class="token string">'name_by_city'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

columns <span class="token operator">=</span><span class="token punctuation">[</span>res1<span class="token punctuation">,</span> res2<span class="token punctuation">,</span> res3<span class="token punctuation">]</span> 
</code></pre> 
<pre><code class="prism language-py">C<span class="token punctuation">:</span>\Anaconda\envs\textbook\lib\site<span class="token operator">-</span>packages\statsmodels\tools\_testing<span class="token punctuation">.</span>py<span class="token punctuation">:</span><span class="token number">19</span><span class="token punctuation">:</span> FutureWarning<span class="token punctuation">:</span>

pandas<span class="token punctuation">.</span>util<span class="token punctuation">.</span>testing <span class="token keyword">is</span> deprecated<span class="token punctuation">.</span> Use the functions <span class="token keyword">in</span> the public API at pandas<span class="token punctuation">.</span>testing instead<span class="token punctuation">.</span> 
</code></pre> 
<pre><code class="prism language-py"><span class="token comment">#  Library to print professional publication</span>
<span class="token comment"># tables in Latex, HTML, etc.</span>
!pip install stargazer 
</code></pre> 
<pre><code class="prism language-py">Requirement already satisfied<span class="token punctuation">:</span> stargazer <span class="token keyword">in</span> c<span class="token punctuation">:</span>\anaconda\envs\textbook\lib\site<span class="token operator">-</span>packages <span class="token punctuation">(</span><span class="token number">0.0</span><span class="token number">.5</span><span class="token punctuation">)</span> 
</code></pre> 
<pre><code class="prism language-py">WARNING<span class="token punctuation">:</span> Error parsing requirements <span class="token keyword">for</span> numpy<span class="token punctuation">:</span> <span class="token punctuation">[</span>Errno <span class="token number">2</span><span class="token punctuation">]</span> No such <span class="token builtin">file</span> <span class="token keyword">or</span> directory<span class="token punctuation">:</span> <span class="token string">'c:\\anaconda\\envs\\textbook\\lib\\site-packages\\numpy-1.19.2.dist-info\\METADATA'</span> 
</code></pre> 
<p>在第一列中，听起来像白人的名字被接受的概率为 49%；而听起来像黑人的名字被接受的概率大约为 41%。因此，黑人名字带来了 8%的惩罚。这个结果在第 2 列和第 3 列的一组控制变量中非常稳健。</p> 
<pre><code class="prism language-py"><span class="token comment"># Settings for a nice table</span>
<span class="token keyword">from</span> stargazer<span class="token punctuation">.</span>stargazer <span class="token keyword">import</span> Stargazer
stargazer <span class="token operator">=</span> Stargazer<span class="token punctuation">(</span>columns<span class="token punctuation">)</span>
stargazer<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'The Impact of Race on Likelihood of Acceptance'</span><span class="token punctuation">)</span>
stargazer 
</code></pre> 
<p>种族对接受可能性的影响</p> 
<table><thead><tr><th></th></tr></thead><tbody><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td>常数</td></tr><tr><td></td></tr><tr><td>黑人客人</td></tr><tr><td></td></tr><tr><td>主人性别 M</td></tr><tr><td></td></tr><tr><td>主人种族黑人</td></tr><tr><td></td></tr><tr><td>对数价丨格</td></tr><tr><td></td></tr><tr><td>多个列表</td></tr><tr><td></td></tr><tr><td>共享物业</td></tr><tr><td></td></tr><tr><td>十次评论</td></tr><tr><td></td></tr><tr><td></td></tr><tr><td>观察</td></tr><tr><td>R²</td></tr><tr><td>调整后的 R²</td></tr><tr><td>残差标准误差</td></tr><tr><td>F 统计量</td></tr><tr><td></td></tr><tr><td>注：</td></tr></tbody></table> 
<p>下表显示了有关主人和房产的摘要统计信息。在实验中，控制变量的平均值与分组实验和对照组的平均值相同。</p> 
<pre><code class="prism language-py">control <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'host_race_white'</span><span class="token punctuation">,</span> <span class="token string">'host_race_black'</span><span class="token punctuation">,</span> <span class="token string">'host_gender_F'</span><span class="token punctuation">,</span> 
	<span class="token string">'host_gender_M'</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">,</span> <span class="token string">'bedrooms'</span><span class="token punctuation">,</span> <span class="token string">'bathrooms'</span><span class="token punctuation">,</span> <span class="token string">'number_of_reviews'</span><span class="token punctuation">,</span> 
	<span class="token string">'multiple_listings'</span><span class="token punctuation">,</span> <span class="token string">'any_black'</span><span class="token punctuation">,</span> <span class="token string">'tract_listings'</span><span class="token punctuation">,</span> <span class="token string">'black_proportion'</span><span class="token punctuation">]</span>

df<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>control<span class="token punctuation">]</span><span class="token punctuation">.</span>T 
</code></pre> 
<table><thead><tr><th></th><th>计数</th><th>平均值</th><th>标准差</th><th>最小值</th><th>25%</th><th>50%</th><th>75%</th><th>最大值</th></tr></thead><tbody><tr><td>host_race_white</td><td>6392.0</td><td>0.634</td><td>0.482</td><td>0.0</td><td>0.00</td><td>1.00</td><td>1.000</td><td>1.000</td></tr><tr><td>host_race_black</td><td>6392.0</td><td>0.078</td><td>0.269</td><td>0.0</td><td>0.00</td><td>0.00</td><td>0.000</td><td>1.000</td></tr><tr><td>host_gender_F</td><td>6392.0</td><td>0.376</td><td>0.485</td><td>0.0</td><td>0.00</td><td>0.00</td><td>1.000</td><td>1.000</td></tr><tr><td>host_gender_M</td><td>6392.0</td><td>0.298</td><td>0.457</td><td>0.0</td><td>0.00</td><td>0.00</td><td>1.000</td><td>1.000</td></tr><tr><td>价丨格</td><td>6302.0</td><td>181.108</td><td>1280.228</td><td>10.0</td><td>75.00</td><td>109.00</td><td>175.000</td><td>100000.000</td></tr><tr><td>卧室</td><td>6242.0</td><td>3.177</td><td>2.265</td><td>1.0</td><td>2.00</td><td>2.00</td><td>4.000</td><td>16.000</td></tr><tr><td>浴室</td><td>6285.0</td><td>3.169</td><td>2.264</td><td>1.0</td><td>2.00</td><td>2.00</td><td>4.000</td><td>16.000</td></tr><tr><td>评论数量</td><td>6390.0</td><td>30.869</td><td>72.505</td><td>0.0</td><td>2.00</td><td>9.00</td><td>29.000</td><td>1208.000</td></tr><tr><td>多个列表</td><td>6392.0</td><td>0.326</td><td>0.469</td><td>0.0</td><td>0.00</td><td>0.00</td><td>1.000</td><td>1.000</td></tr><tr><td>任何黑人</td><td>6390.0</td><td>0.282</td><td>0.450</td><td>0.0</td><td>0.00</td><td>0.00</td><td>1.000</td><td>1.000</td></tr><tr><td>地域列表</td><td>6392.0</td><td>9.514</td><td>9.277</td><td>1.0</td><td>2.00</td><td>6.00</td><td>14.000</td><td>53.000</td></tr><tr><td>黑人比例</td><td>6378.0</td><td>0.140</td><td>0.203</td><td>0.0</td><td>0.03</td><td>0.05</td><td>0.142</td><td>0.984</td></tr></tbody></table> 
<p>平衡处理测丨试(t 检验)显示黑人和白人客人是相同的。</p> 
<pre><code class="prism language-py">result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> var <span class="token keyword">in</span> control<span class="token punctuation">:</span>
    <span class="token comment"># Do the T-test and save the p-value</span>
    pvalue <span class="token operator">=</span> sm<span class="token punctuation">.</span>OLS<span class="token punctuation">(</span>df<span class="token punctuation">[</span>var<span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'const'</span><span class="token punctuation">,</span> <span class="token string">'guest_black'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
               missing <span class="token operator">=</span> <span class="token string">'drop'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>pvalues<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>pvalue<span class="token punctuation">)</span> 
</code></pre> 
<pre><code class="prism language-py">ttest <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'guest_black'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span>control<span class="token punctuation">]</span><span class="token punctuation">.</span>T
ttest<span class="token punctuation">[</span><span class="token string">'p-value'</span><span class="token punctuation">]</span> <span class="token operator">=</span> result
ttest 
</code></pre> 
<table><thead><tr><th></th><th>黑人客人</th><th>0.0</th><th>1.0</th><th>p 值</th></tr></thead><tbody><tr><td>host_race_white</td><td>平均值</td><td>0.643</td><td>0.626</td><td>0.154</td></tr><tr><td>host_race_black</td><td>平均值</td><td>0.078</td><td>0.078</td><td>0.972</td></tr><tr><td>host_gender_F</td><td>平均值</td><td>0.381</td><td>0.372</td><td>0.439</td></tr><tr><td>host_gender_M</td><td>平均值</td><td>0.298</td><td>0.299</td><td>0.896</td></tr><tr><td>价丨格</td><td>平均值</td><td>166.429</td><td>195.815</td><td>0.362</td></tr><tr><td>卧室</td><td>平均值</td><td>3.178</td><td>3.176</td><td>0.962</td></tr><tr><td>浴室</td><td>平均值</td><td>3.172</td><td>3.167</td><td>0.927</td></tr><tr><td>评论数量</td><td>平均值</td><td>30.709</td><td>31.030</td><td>0.860</td></tr><tr><td>多个列表</td><td>平均值</td><td>0.321</td><td>0.330</td><td>0.451</td></tr><tr><td>任何黑人</td><td>平均值</td><td>0.287</td><td>0.277</td><td>0.382</td></tr><tr><td>地域列表</td><td>平均值</td><td>9.494</td><td>9.538</td><td>0.848</td></tr><tr><td>黑人比例</td><td>平均值</td><td>0.141</td><td>0.140</td><td>0.919</td></tr></tbody></table> 
<h3><a id="_1160"></a>练习</h3> 
<p>1）据我所知，关于种族歧视的文献中最重要的三篇实证论文是 Bertrand &amp; Mullainathan (2004), Oreopoulos (2011), 和 Edelman et al. (2017)。这三篇论文都使用了实地实验来捕捉因果关系并排除混杂因素。在互联网上搜索并返回一份关于种族歧视的实验论文的参考列表。</p> 
<p>2）告诉我一个你热衷的话题。返回一个关于你的话题的实验论文的参考列表。</p> 
<p>3）有人认为特定的名字驱动了 Edelman 等人(2017)的结果。在下面的表格中，你可以看到代表黑人和白人的名字并不多。如何反驳这个批评？你可以做什么来证明结果不是由特定的名字驱动的？</p> 
<pre><code class="prism language-py">female <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'guest_gender'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'female'</span>
df<span class="token punctuation">[</span>female<span class="token punctuation">]</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'guest_race'</span><span class="token punctuation">,</span> <span class="token string">'guest_first_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'yes'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> 
</code></pre> 
<pre><code class="prism language-py">guest_race  guest_first_name
black       Lakisha             <span class="token number">0.433</span>
            Latonya             <span class="token number">0.370</span>
            Latoya              <span class="token number">0.442</span>
            Tamika              <span class="token number">0.482</span>
            Tanisha             <span class="token number">0.413</span>
white       Allison             <span class="token number">0.500</span>
            Anne                <span class="token number">0.567</span>
            Kristen             <span class="token number">0.486</span>
            Laurie              <span class="token number">0.508</span>
            Meredith            <span class="token number">0.498</span>
Name<span class="token punctuation">:</span> yes<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> float64 
</code></pre> 
<pre><code class="prism language-py">male <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'guest_gender'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'male'</span>
df<span class="token punctuation">[</span>male<span class="token punctuation">]</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'guest_race'</span><span class="token punctuation">,</span> <span class="token string">'guest_first_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'yes'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> 
</code></pre> 
<pre><code class="prism language-py">guest_race  guest_first_name
black       Darnell             <span class="token number">0.412</span>
            Jamal               <span class="token number">0.354</span>
            Jermaine            <span class="token number">0.379</span>
            Kareem              <span class="token number">0.436</span>
            Leroy               <span class="token number">0.371</span>
            Rasheed             <span class="token number">0.409</span>
            Tyrone              <span class="token number">0.377</span>
white       Brad                <span class="token number">0.419</span>
            Brent               <span class="token number">0.494</span>
            Brett               <span class="token number">0.466</span>
            Greg                <span class="token number">0.467</span>
            Jay                 <span class="token number">0.581</span>
            Todd                <span class="token number">0.448</span>
Name<span class="token punctuation">:</span> yes<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> float64 
</code></pre> 
<p>4）根据下表，是否有任何潜在的研究问题可以探讨？请证明。</p> 
<pre><code class="prism language-py">pd<span class="token punctuation">.</span>crosstab<span class="token punctuation">(</span>index<span class="token operator">=</span> <span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'host_gender_F'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">'host_race'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            columns<span class="token operator">=</span><span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'guest_gender'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">'guest_race'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
            values<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">'yes'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> aggfunc<span class="token operator">=</span><span class="token string">'mean'</span><span class="token punctuation">)</span> 
</code></pre> 
<table><thead><tr><th></th><th>客人性别</th><th>女性</th><th>男性</th></tr></thead><tbody><tr><td></td><td>客人种族</td><td>黑人</td><td>白人</td></tr><tr><td>—</td><td>—</td><td>—</td><td>—</td></tr><tr><td>host_gender_F</td><td>host_race</td><td></td><td></td></tr><tr><td>—</td><td>—</td><td>—</td><td>—</td></tr><tr><td>0</td><td>UU</td><td>0.400</td><td>0.542</td></tr><tr><td>亚裔</td><td>0.319</td><td>0.378</td><td>0.474</td></tr><tr><td>黑人</td><td>0.444</td><td>0.643</td><td>0.419</td></tr><tr><td>西班牙裔</td><td>0.464</td><td>0.571</td><td>0.375</td></tr><tr><td>多</td><td>0.568</td><td>0.727</td><td>0.408</td></tr><tr><td>不明确</td><td>0.444</td><td>0.500</td><td>0.444</td></tr><tr><td>不明确的三票</td><td>0.476</td><td>0.392</td><td>0.368</td></tr><tr><td>白人</td><td>0.383</td><td>0.514</td><td>0.386</td></tr><tr><td>1</td><td>UU</td><td>0.444</td><td>0.250</td></tr><tr><td>亚裔</td><td>0.429</td><td>0.607</td><td>0.436</td></tr><tr><td>黑人</td><td>0.603</td><td>0.537</td><td>0.397</td></tr><tr><td>西班牙裔</td><td>0.391</td><td>0.667</td><td>0.292</td></tr><tr><td>不明确</td><td>0.600</td><td>0.556</td><td>0.125</td></tr><tr><td>不明确的三票</td><td>0.387</td><td>0.583</td><td>0.312</td></tr><tr><td>白人</td><td>0.450</td><td>0.494</td><td>0.370</td></tr></tbody></table> 
<p>5）在 Edelman 等人（2017 年）中，变量“name_by_city”被用来对标准误差进行聚类。变量“name_by_city”是如何基于其丨他变量创建的？展示代码。</p> 
<p>6）使用 Edelman 等人（2017 年）的数据来测丨试同族偏好假设，即主人可能更喜欢相同种族的客人。使用 Stargazer 库生成一个漂亮的表格。解释结果。</p> 
<p>7）总的来说，人们知道社丨会经济地位与种族有关。Fryer＆Levitt（2004 年）表明，独特的非洲裔美丨国人名字与较低的社丨会经济地位相关。Edelman 等人（2017 年：17）明确表示：“我们的发现无法确定歧视是基于种族，社丨会经济地位，还是这两者的结合。”提出一个实验设计来分离种族和社丨会经济地位的影响。解释您的假设并详细描述程序。</p> 
<h3><a id="_1247"></a>参考</h3> 
<p>Bertrand，Marianne 和 Sendhil Mullainathan。 （2004）。<a href="https://github.com/causal-methods/Papers/raw/master/Are%20Emily%20and%20Greg%20More%20Employable%20than%20Lakisha%20and%20Jamal.pdf">艾米丽和格雷格比拉基莎和贾迈尔更受雇用吗？劳动市场歧视的实地实验</a>。《美丨国经济评论》，94（4）：991-1013。</p> 
<p>Edelman，Benjamin，Michael Luca 和 Dan Svirsky。 （2017）。<a href="https://github.com/causal-methods/Papers/raw/master/Racial%20Discrimination%20in%20the%20Sharing%20Economy.pdf">共享经济中的种族歧视：来自实地实验的证据</a>。《美丨国经济学杂志：应用经济学》，9（2）：1-22。</p> 
<p>Fryer，Roland G. Jr.和 Steven D. Levitt。 （2004）。Distinctively Black Names 的原因和后果。《经济学季刊》，119（3）：767–805。</p> 
<p>Oreopoulos，Philip。 （2011）。<a href="https://github.com/causal-methods/Papers/raw/master/Oreopoulos/Why%20Do%20Skilled%20Immigrants%20Struggle%20in%20the%20Labor%20Market.pdf">为什么技术移民在劳动市场上挣扎？一项涉及一万三千份简历的实地实验</a>。《美丨国经济学杂志：经济政策》，3（4）：148-71。</p> 
<h2><a id="_1258"></a>九、股票市场如何缓解以巴冲突？</h2> 
<blockquote> 
 <p>原文：<a href="https://causal-methods.github.io/Book/9%29_How_Can_Stock_Market_Mitigate_the_Israeli_Palestinian_Conflict.html" rel="nofollow"><code>causal-methods.github.io/Book/9%29_How_Can_Stock_Market_Mitigate_the_Israeli_Palestinian_Conflict.html</code></a></p> 
 <p>译者：<a href="https://github.com/wizardforcel">飞龙</a></p> 
 <p>协议：<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" rel="nofollow">CC BY-NC-SA 4.0</a></p> 
</blockquote> 
<p><a href="https://www.linkedin.com/in/vitor-kamada-1b73a078" rel="nofollow">Vitor Kamada</a></p> 
<p>电子邮件：econometrics.methods@gmail.com</p> 
<p>最近更新：11-5-2020</p> 
<p>“商业是最具破丨坏性偏见的良药。”（孟德斯鸠，1748 年：第 II 卷，第一章）</p> 
<p>Jha &amp; Shayo（2019）随机将 1345 名犹太以色列选民分为金融资产治疗组和对照组。他们报告称，接触股票市场会增加 4-6%的可能性，投票支持主张和平解决冲突的政党。让我们打开 Jha &amp; Shayo（2019）的数据集。每一行都是以色列公民。</p> 
<pre><code class="prism language-py"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'precision'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>

<span class="token comment"># Data from Jha &amp; Shayo (2019)</span>
path <span class="token operator">=</span> <span class="token string">"https://github.com/causal-methods/Data/raw/master/"</span> 
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_stata<span class="token punctuation">(</span>path <span class="token operator">+</span> <span class="token string">"replicationdata.dta"</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> 
</code></pre> 
<pre><code class="prism language-py">C<span class="token punctuation">:</span>\Anaconda\envs\textbook\lib\site<span class="token operator">-</span>packages\pandas\io\stata<span class="token punctuation">.</span>py<span class="token punctuation">:</span><span class="token number">1433</span><span class="token punctuation">:</span> UnicodeWarning<span class="token punctuation">:</span> 
One <span class="token keyword">or</span> more strings <span class="token keyword">in</span> the dta <span class="token builtin">file</span> could <span class="token keyword">not</span> be decoded using utf<span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token keyword">and</span>
so the fallback encoding of latin<span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">is</span> being used<span class="token punctuation">.</span>  This can happen when a <span class="token builtin">file</span>
has been incorrectly encoded by Stata <span class="token keyword">or</span> some other software<span class="token punctuation">.</span> You should verify
the string values returned are correct<span class="token punctuation">.</span>
  warnings<span class="token punctuation">.</span>warn<span class="token punctuation">(</span>msg<span class="token punctuation">,</span> UnicodeWarning<span class="token punctuation">)</span> 
</code></pre> 
<table><thead><tr><th></th><th>统计</th><th>tradestock6</th><th>愿意承担 1 到 10 的风险</th><th>用户 ID</th><th>男性</th><th>关系</th><th>关系 ID</th><th>nafa</th><th>教育</th><th>ses</th><th>…</th><th>tradetot_m4</th><th>pricechange_m4</th><th>bought_bm4</th><th>sold_bm4</th><th>active_bm4</th><th>资产类型</th><th>上周</th><th>过去 3 年</th><th>下周</th><th>facts_0_m4</th></tr></thead><tbody><tr><td>0</td><td>完成</td><td>NaN</td><td>3</td><td>60814.0</td><td>0.0</td><td>犹太教</td><td>世俗</td><td>耶路撒冷</td><td>硕士</td><td>平均以下</td><td>…</td><td>3.0</td><td>-0.673</td><td>0.0</td><td>0.0</td><td>0.0</td><td>1.0</td><td>0.0</td><td>0.0</td><td>1.0</td><td>2.0</td></tr><tr><td>1</td><td>完成</td><td>1.0</td><td>2</td><td>60824.0</td><td>0.0</td><td>犹太教</td><td>世俗</td><td>特拉维夫</td><td>文学士</td><td>平均以上</td><td>…</td><td>3.0</td><td>5.323</td><td>2.0</td><td>0.0</td><td>2.0</td><td>1.0</td><td>1.0</td><td>1.0</td><td>0.0</td><td>3.0</td></tr><tr><td>2</td><td>完成</td><td>0.0</td><td>3</td><td>61067.0</td><td>1.0</td><td>犹太教</td><td>世俗</td><td>中心</td><td>博士</td><td>平均以上</td><td>…</td><td>3.0</td><td>0.000</td><td>2.0</td><td>1.0</td><td>3.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td></tr><tr><td>3</td><td>完成</td><td>NaN</td><td>4</td><td>61095.0</td><td>1.0</td><td>犹太教</td><td>世俗</td><td>海法</td><td>文学士学生</td><td>平均以下</td><td>…</td><td>3.0</td><td>5.323</td><td>3.0</td><td>2.0</td><td>3.0</td><td>0.0</td><td>0.0</td><td>1.0</td><td>0.0</td><td>1.0</td></tr><tr><td>4</td><td>完成</td><td>0.0</td><td>4</td><td>61198.0</td><td>1.0</td><td>犹太教</td><td>世俗</td><td>北部</td><td>硕士</td><td>平均以下</td><td>…</td><td>3.0</td><td>0.000</td><td>0.0</td><td>0.0</td><td>0.0</td><td>1.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>1.0</td></tr></tbody></table> 
<p>5 行×526 列</p> 
<pre><code class="prism language-py"><span class="token comment"># Drop missing values</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'left_s3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
</code></pre> 
<p>图 1 显示，2013 年选举中，对照组和治疗组的投票情况相似。但在 2015 年，左翼党派在对照组中获得了 24.8%的选票，而在治疗组中获得了 30.9%。相反，右翼党派在对照组中获得了 35.8%的选票，而在治疗组中获得了 31.2%。根据 Jha &amp; Shayo（2019）的说法，右翼和左翼党派在经济政策方面是相似的。主要区别在于左翼党派支持和平进程，而右翼党派认为任何为和平做出的让步都会对以色列国家构成风险。</p> 
<pre><code class="prism language-py"><span class="token comment"># Data: Vote Share by year</span>
v2013 <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'assettreat'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'left_2013'</span><span class="token punctuation">,</span> <span class="token string">'right_2013'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T
v2015 <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'assettreat'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'left_s3'</span><span class="token punctuation">,</span> <span class="token string">'right_s3'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T
prop <span class="token operator">=</span> v2013<span class="token punctuation">.</span>append<span class="token punctuation">(</span>v2015<span class="token punctuation">)</span>

<span class="token comment"># Plot Bar Chart</span>
<span class="token keyword">import</span> plotly<span class="token punctuation">.</span>graph_objects <span class="token keyword">as</span> go
node <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Left 2013'</span><span class="token punctuation">,</span> <span class="token string">'Right 2013'</span><span class="token punctuation">,</span> <span class="token string">'Left 2015'</span><span class="token punctuation">,</span> <span class="token string">'Right 2015'</span><span class="token punctuation">]</span>

fig <span class="token operator">=</span> go<span class="token punctuation">.</span>Figure<span class="token punctuation">(</span>data<span class="token operator">=</span><span class="token punctuation">[</span>             
    go<span class="token punctuation">.</span>Bar<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'Control'</span><span class="token punctuation">,</span> x<span class="token operator">=</span>node<span class="token punctuation">,</span> y <span class="token operator">=</span> prop<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    go<span class="token punctuation">.</span>Bar<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'Treatment'</span><span class="token punctuation">,</span> x<span class="token operator">=</span>node<span class="token punctuation">,</span> y <span class="token operator">=</span> prop<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">]</span><span class="token punctuation">)</span>

fig<span class="token punctuation">.</span>update_layout<span class="token punctuation">(</span>barmode<span class="token operator">=</span><span class="token string">'group'</span><span class="token punctuation">,</span>
  title_text <span class="token operator">=</span> <span class="token string">'Graphic 1 - Elections: 2013 vs 2015 '</span><span class="token punctuation">,</span>
  font<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token number">18</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>

fig<span class="token punctuation">.</span>update_yaxes<span class="token punctuation">(</span>title_text <span class="token operator">=</span> <span class="token string">"Vote Share"</span><span class="token punctuation">)</span>

fig<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span> 
</code></pre> 
<pre><code class="prism language-py">C<span class="token punctuation">:</span>\Anaconda\envs\textbook\lib\site<span class="token operator">-</span>packages\ipykernel_launcher<span class="token punctuation">.</span>py<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span> FutureWarning<span class="token punctuation">:</span> Indexing <span class="token keyword">with</span> multiple keys <span class="token punctuation">(</span>implicitly converted to a <span class="token builtin">tuple</span> of keys<span class="token punctuation">)</span> will be deprecated<span class="token punctuation">,</span> use a <span class="token builtin">list</span> instead<span class="token punctuation">.</span>

C<span class="token punctuation">:</span>\Anaconda\envs\textbook\lib\site<span class="token operator">-</span>packages\ipykernel_launcher<span class="token punctuation">.</span>py<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span> FutureWarning<span class="token punctuation">:</span> Indexing <span class="token keyword">with</span> multiple keys <span class="token punctuation">(</span>implicitly converted to a <span class="token builtin">tuple</span> of keys<span class="token punctuation">)</span> will be deprecated<span class="token punctuation">,</span> use a <span class="token builtin">list</span> instead<span class="token punctuation">.</span>
  This <span class="token keyword">is</span> separate <span class="token keyword">from</span> the ipykernel package so we can avoid doing imports until 
</code></pre> 
<p>下表显示，治疗组与对照组相似。例外情况是年龄和愿意承担风险。治疗组的以色列人比对照组年轻（39.3 岁对 41.5 岁）。治疗组在愿意承担风险方面也更偏好，评估指数从 1 到 10 变化（4.7 对 4.3）。</p> 
<p>我们根据 OLS 回归和分层固定效应计算 p 值。</p> 
<pre><code class="prism language-py">control <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'right_2013'</span><span class="token punctuation">,</span> <span class="token string">'left_2013'</span><span class="token punctuation">,</span> <span class="token string">'p_index_s1'</span><span class="token punctuation">,</span> <span class="token string">'e_index_init'</span><span class="token punctuation">,</span>
    <span class="token string">'tradestock6all'</span><span class="token punctuation">,</span> <span class="token string">'male'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'postsecondary'</span><span class="token punctuation">,</span> <span class="token string">'BA_student'</span><span class="token punctuation">,</span>
	  <span class="token string">'college_grad'</span><span class="token punctuation">,</span> <span class="token string">'married'</span><span class="token punctuation">,</span> <span class="token string">'r_sec'</span><span class="token punctuation">,</span>  <span class="token string">'r_trad'</span><span class="token punctuation">,</span> <span class="token string">'r_relig'</span><span class="token punctuation">,</span> <span class="token string">'r_ultra'</span><span class="token punctuation">,</span> 
		<span class="token string">'g_jerusalem'</span><span class="token punctuation">,</span> <span class="token string">'g_north'</span><span class="token punctuation">,</span> <span class="token string">'g_haifa'</span><span class="token punctuation">,</span> <span class="token string">'g_center'</span><span class="token punctuation">,</span> <span class="token string">'g_telaviv'</span><span class="token punctuation">,</span> <span class="token string">'g_south'</span><span class="token punctuation">,</span>
    <span class="token string">'g_wb'</span><span class="token punctuation">,</span> <span class="token string">'faminc'</span><span class="token punctuation">,</span> <span class="token string">'willingrisk1to10'</span><span class="token punctuation">,</span> <span class="token string">'patient'</span><span class="token punctuation">,</span> <span class="token string">'plitscore'</span><span class="token punctuation">]</span> 
</code></pre> 
<pre><code class="prism language-py"><span class="token keyword">import</span> statsmodels<span class="token punctuation">.</span>formula<span class="token punctuation">.</span>api <span class="token keyword">as</span> smf

result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> var <span class="token keyword">in</span> control<span class="token punctuation">:</span>
    <span class="token comment"># OLS with 104 randomization strata fixed effects</span>
    reg <span class="token operator">=</span> smf<span class="token punctuation">.</span>ols<span class="token punctuation">(</span>var <span class="token operator">+</span> <span class="token string">"~ 1 + assettreat + C(block13)"</span><span class="token punctuation">,</span> df<span class="token punctuation">)</span>
    <span class="token comment"># 104 is the last variable: the coefficient of assettreat</span>
    pvalue <span class="token operator">=</span> reg<span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>pvalues<span class="token punctuation">[</span><span class="token number">104</span><span class="token punctuation">]</span>
    result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>pvalue<span class="token punctuation">)</span> 
</code></pre> 
<pre><code class="prism language-py">C<span class="token punctuation">:</span>\Anaconda\envs\textbook\lib\site<span class="token operator">-</span>packages\statsmodels\tools\_testing<span class="token punctuation">.</span>py<span class="token punctuation">:</span><span class="token number">19</span><span class="token punctuation">:</span> FutureWarning<span class="token punctuation">:</span>

pandas<span class="token punctuation">.</span>util<span class="token punctuation">.</span>testing <span class="token keyword">is</span> deprecated<span class="token punctuation">.</span> Use the functions <span class="token keyword">in</span> the public API at pandas<span class="token punctuation">.</span>testing instead<span class="token punctuation">.</span> 
</code></pre> 
<pre><code class="prism language-py">table <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'assettreat'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>control<span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T  
table<span class="token punctuation">[</span><span class="token string">'p-value'</span><span class="token punctuation">]</span> <span class="token operator">=</span> result
table 
</code></pre> 
<table><thead><tr><th>资产治疗</th><th>0.0</th><th>1.0</th><th>p 值</th></tr></thead><tbody><tr><td>right_2013</td><td>0.245</td><td>0.241</td><td>0.964</td></tr><tr><td>left_2013</td><td>0.126</td><td>0.137</td><td>0.213</td></tr><tr><td>p_index_s1</td><td>0.004</td><td>0.051</td><td>0.399</td></tr><tr><td>e_index_init</td><td>-0.005</td><td>0.007</td><td>0.752</td></tr><tr><td>tradestock6all</td><td>0.368</td><td>0.355</td><td>0.290</td></tr><tr><td>男性</td><td>0.513</td><td>0.521</td><td>0.470</td></tr><tr><td>年龄</td><td>41.530</td><td>39.289</td><td>0.011</td></tr><tr><td>高中后教育</td><td>0.232</td><td>0.230</td><td>0.953</td></tr><tr><td>文学士学生</td><td>0.152</td><td>0.148</td><td>0.834</td></tr><tr><td>大学毕业</td><td>0.427</td><td>0.426</td><td>0.860</td></tr><tr><td>已婚</td><td>0.629</td><td>0.598</td><td>0.295</td></tr><tr><td>r_sec</td><td>0.636</td><td>0.627</td><td>0.582</td></tr><tr><td>r_trad</td><td>0.172</td><td>0.164</td><td>0.823</td></tr><tr><td>r_relig</td><td>0.119</td><td>0.124</td><td>0.780</td></tr><tr><td>r_ultra</td><td>0.073</td><td>0.085</td><td>0.222</td></tr><tr><td>g_jerusalem</td><td>0.096</td><td>0.091</td><td>0.800</td></tr><tr><td>g_north</td><td>0.089</td><td>0.097</td><td>0.595</td></tr><tr><td>g_haifa</td><td>0.123</td><td>0.142</td><td>0.290</td></tr><tr><td>g_center</td><td>0.298</td><td>0.290</td><td>0.766</td></tr><tr><td>g_telaviv</td><td>0.212</td><td>0.194</td><td>0.276</td></tr><tr><td>g_south</td><td>0.116</td><td>0.104</td><td>0.596</td></tr><tr><td>g_wb</td><td>0.066</td><td>0.081</td><td>0.341</td></tr><tr><td>家庭收入</td><td>11162.162</td><td>10996.970</td><td>0.511</td></tr><tr><td>愿意承担风险 1 到 10</td><td>4.344</td><td>4.716</td><td>0.009</td></tr><tr><td>患者</td><td>0.642</td><td>0.657</td><td>0.645</td></tr><tr><td>plitscore</td><td>69.726</td><td>70.664</td><td>0.550</td></tr></tbody></table> 
<pre><code class="prism language-py"><span class="token comment">#  Library to print professional publication</span>
<span class="token comment"># tables in Latex, HTML, etc.</span>
!pip install stargazer 
</code></pre> 
<pre><code class="prism language-py">Requirement already satisfied<span class="token punctuation">:</span> stargazer <span class="token keyword">in</span> c<span class="token punctuation">:</span>\anaconda\envs\textbook\lib\site<span class="token operator">-</span>packages <span class="token punctuation">(</span><span class="token number">0.0</span><span class="token number">.5</span><span class="token punctuation">)</span> 
</code></pre> 
<pre><code class="prism language-py">WARNING<span class="token punctuation">:</span> Error parsing requirements <span class="token keyword">for</span> numpy<span class="token punctuation">:</span> <span class="token punctuation">[</span>Errno <span class="token number">2</span><span class="token punctuation">]</span> No such <span class="token builtin">file</span> <span class="token keyword">or</span> directory<span class="token punctuation">:</span> <span class="token string">'c:\\anaconda\\envs\\textbook\\lib\\site-packages\\numpy-1.19.2.dist-info\\METADATA'</span> 
</code></pre> 
<p>表 1 的第 1 列显示了意向治疗（ITT）的估计值为 6.1%。值得一提的是，这种类型的实验很少有完全的遵从。通常，在需要随时间跟踪个体时，控制组和治疗组都会有一定的流失率。</p> 
<p>第 2 列显示 ITT 效应对控制变量和分层固定效应的鲁棒性。</p> 
<p>第 3 列使用变量“vote_wgt”作为权重呈现了加权最小二乘法（WLS）。Jha &amp; Shayo（2019）提取了一个随机样本，其中非正统中心选民被过度抽样。逻辑是增加对最有趣的群体：摇摆选民的精度。使用权重可以在不过度抽样的情况下重现结果。</p> 
<p>第 4 列显示结果是由接受以色列股票（“isrstock”）和投资券（“cash”）的治疗组个体驱动的。要小心得出巴勒斯坦股票没有影响的结论。在实验期间，以色列股票价丨格上涨，但巴勒斯坦股票下跌。</p> 
<pre><code class="prism language-py">ITT1 <span class="token operator">=</span> smf<span class="token punctuation">.</span>ols<span class="token punctuation">(</span><span class="token string">"left_s3 ~ 1 + assettreat"</span><span class="token punctuation">,</span>
                 df<span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token punctuation">)</span>

Xs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'right_2013'</span><span class="token punctuation">,</span> <span class="token string">'left_2013'</span><span class="token punctuation">,</span> <span class="token string">'male'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'age2'</span><span class="token punctuation">,</span>
      <span class="token string">'postsecondary'</span><span class="token punctuation">,</span> <span class="token string">'BA_student'</span><span class="token punctuation">,</span> <span class="token string">'college_grad'</span><span class="token punctuation">,</span>
      <span class="token string">'married'</span><span class="token punctuation">,</span> <span class="token string">'tradestock6all'</span><span class="token punctuation">,</span> <span class="token string">'r_trad'</span><span class="token punctuation">,</span> <span class="token string">'r_relig'</span><span class="token punctuation">,</span>
      <span class="token string">'r_ultra'</span><span class="token punctuation">,</span> <span class="token string">'g_jerusalem'</span><span class="token punctuation">,</span> <span class="token string">'g_north'</span><span class="token punctuation">,</span> <span class="token string">'g_haifa'</span><span class="token punctuation">,</span>
      <span class="token string">'g_telaviv'</span><span class="token punctuation">,</span> <span class="token string">'g_south'</span><span class="token punctuation">,</span> <span class="token string">'g_wb'</span><span class="token punctuation">,</span> <span class="token string">'C(newses)'</span><span class="token punctuation">,</span>
      <span class="token string">'willingrisk1to10'</span><span class="token punctuation">,</span> <span class="token string">'patient'</span><span class="token punctuation">,</span> <span class="token string">'plitscore'</span><span class="token punctuation">]</span>

controls <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">for</span> X <span class="token keyword">in</span> Xs<span class="token punctuation">:</span>
    controls <span class="token operator">=</span> controls <span class="token operator">+</span> <span class="token string">'+'</span> <span class="token operator">+</span> X      

ITT2 <span class="token operator">=</span> smf<span class="token punctuation">.</span>ols<span class="token punctuation">(</span><span class="token string">"left_s3 ~ 1 + assettreat"</span> <span class="token operator">+</span> controls <span class="token operator">+</span>
                 <span class="token string">"+C(block13)"</span><span class="token punctuation">,</span> df<span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token punctuation">)</span>

WLS <span class="token operator">=</span> smf<span class="token punctuation">.</span>wls<span class="token punctuation">(</span><span class="token string">"left_s3 ~ 1 + assettreat"</span> <span class="token operator">+</span> controls <span class="token operator">+</span>
       <span class="token string">"+C(block13)"</span><span class="token punctuation">,</span> df<span class="token punctuation">,</span> weights<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">'vote_wgt'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token punctuation">)</span>

treatments <span class="token operator">=</span> <span class="token string">"+ isrstock + palstock + cash"</span>    
WLS2 <span class="token operator">=</span> smf<span class="token punctuation">.</span>wls<span class="token punctuation">(</span><span class="token string">"left_s3 ~ 1"</span> <span class="token operator">+</span> treatments <span class="token operator">+</span> controls <span class="token operator">+</span>
       <span class="token string">"+C(block13)"</span><span class="token punctuation">,</span> df<span class="token punctuation">,</span> weights<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">'vote_wgt'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token punctuation">)</span> 
</code></pre> 
<pre><code class="prism language-py"><span class="token comment"># Settings for a nice table</span>
<span class="token keyword">from</span> stargazer<span class="token punctuation">.</span>stargazer <span class="token keyword">import</span> Stargazer
stargazer <span class="token operator">=</span> Stargazer<span class="token punctuation">(</span><span class="token punctuation">[</span>ITT1<span class="token punctuation">,</span> ITT2<span class="token punctuation">,</span> WLS<span class="token punctuation">,</span> WLS2<span class="token punctuation">]</span><span class="token punctuation">)</span>

stargazer<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Table 1 - Intent to Treat Estimates of Stock'</span>
   <span class="token operator">+</span> <span class="token string">' Exposure on Voting for a Left Party'</span><span class="token punctuation">)</span>

names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'ITT'</span><span class="token punctuation">,</span> <span class="token string">'ITT'</span><span class="token punctuation">,</span> <span class="token string">'WLS'</span><span class="token punctuation">,</span> <span class="token string">'WLS'</span><span class="token punctuation">]</span>
stargazer<span class="token punctuation">.</span>custom_columns<span class="token punctuation">(</span>names<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

stargazer<span class="token punctuation">.</span>covariate_order<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'assettreat'</span><span class="token punctuation">,</span> <span class="token string">'isrstock'</span><span class="token punctuation">,</span>
                           <span class="token string">'palstock'</span><span class="token punctuation">,</span> <span class="token string">'cash'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

stargazer<span class="token punctuation">.</span>add_line<span class="token punctuation">(</span><span class="token string">'Strata Fixed Effects'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'No'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">,</span>
                                            <span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
stargazer<span class="token punctuation">.</span>add_line<span class="token punctuation">(</span><span class="token string">'Covariates'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'No'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

stargazer 
</code></pre> 
<p>表 1 - 对左翼党投票的意向治疗估计股票暴露</p> 
<table><thead><tr><th></th></tr></thead><tbody><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td>资产处理</td></tr><tr><td></td></tr><tr><td>isrstock</td></tr><tr><td></td></tr><tr><td>palstock</td></tr><tr><td></td></tr><tr><td>现金</td></tr><tr><td></td></tr><tr><td>分层固定效应</td></tr><tr><td>协变量</td></tr><tr><td></td></tr><tr><td>观察</td></tr><tr><td>R²</td></tr><tr><td>调整后的 R²</td></tr><tr><td>残差标准误差</td></tr><tr><td>F 统计量</td></tr><tr><td></td></tr><tr><td>注：</td></tr></tbody></table> 
<p>表 2 的第 1 列呈现了第一阶段回归。ITT（“资产处理”）是符合分配（“资产 _comp”）的工具变量（IV）。变量“资产 _comp”表示谁实际完成了实验。在控制了几个协变量和分层固定效应之后，ITT 的系数在统计上是显著的。变量“资产处理”是一个完美的 IV。这个变量是随机的。因此，它与误差项不相关。</p> 
<p>第 2 列显示了控制函数方法（CF）的结果。对待处理的治疗效应（TOT）估计为 7.3%。接受治疗的个体投票给左翼党的概率增加了 7.3%。在这个框架中，CF 等同于 2SLS。在 CF 中，我们使用第一阶段的残差（<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          u 
         
        
          ^ 
         
        
       
      
        \hat{u} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6944em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal">u</span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.2222em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span></span>）来控制第二阶段的内生性。注意残差在统计上是显著的。因此，需要进行修正。我们可以得出结论，表 1 低估了金融资产暴露对左翼党投票的影响。</p> 
<pre><code class="prism language-py"><span class="token comment"># Fist Stage</span>
FS <span class="token operator">=</span> smf<span class="token punctuation">.</span>ols<span class="token punctuation">(</span><span class="token string">"asset_comp ~ 1 + assettreat"</span> <span class="token operator">+</span> controls <span class="token operator">+</span>
                 <span class="token string">"+C(block13)"</span><span class="token punctuation">,</span> df<span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Control Function Approach</span>
df<span class="token punctuation">[</span><span class="token string">'resid'</span><span class="token punctuation">]</span> <span class="token operator">=</span> FS<span class="token punctuation">.</span>resid
CF <span class="token operator">=</span> smf<span class="token punctuation">.</span>ols<span class="token punctuation">(</span><span class="token string">"left_s3 ~ 1 + asset_comp + resid"</span> <span class="token operator">+</span> controls <span class="token operator">+</span>
                 <span class="token string">"+C(block13)"</span><span class="token punctuation">,</span> df<span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token punctuation">)</span> 
</code></pre> 
<pre><code class="prism language-py"><span class="token comment"># Settings for a nice table</span>
stargazer <span class="token operator">=</span> Stargazer<span class="token punctuation">(</span><span class="token punctuation">[</span>FS<span class="token punctuation">,</span> CF<span class="token punctuation">]</span><span class="token punctuation">)</span>

stargazer<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Table 2 - Impact of Stock Exposure'</span>
 <span class="token string">' on Voting for a Left Party'</span><span class="token punctuation">)</span>

names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'First Stage'</span><span class="token punctuation">,</span> <span class="token string">'Control Function'</span><span class="token punctuation">]</span>
stargazer<span class="token punctuation">.</span>custom_columns<span class="token punctuation">(</span>names<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

stargazer<span class="token punctuation">.</span>covariate_order<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'assettreat'</span><span class="token punctuation">,</span> <span class="token string">'asset_comp'</span><span class="token punctuation">,</span> <span class="token string">'resid'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

stargazer<span class="token punctuation">.</span>add_line<span class="token punctuation">(</span><span class="token string">'Strata Fixed Effects'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
stargazer<span class="token punctuation">.</span>add_line<span class="token punctuation">(</span><span class="token string">'Covariates'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Yes'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

stargazer 
</code></pre> 
<p>表 2 - 股票暴露对左翼党投票的影响</p> 
<table><thead><tr><th></th></tr></thead><tbody><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr><tr><td>资产处理</td></tr><tr><td></td></tr><tr><td>资产 _comp</td></tr><tr><td></td></tr><tr><td>残差</td></tr><tr><td></td></tr><tr><td>分层固定效应</td></tr><tr><td>协变量</td></tr><tr><td></td></tr><tr><td>观察</td></tr><tr><td>R²</td></tr><tr><td>调整后的 R²</td></tr><tr><td>残差标准误差</td></tr><tr><td>F 统计量</td></tr><tr><td></td></tr><tr><td>注：</td></tr></tbody></table> 
<h3><a id="_1564"></a>练习</h3> 
<p>1）Jha＆Shayo（2019）的样本由以色列选民组成。推测在巴勒斯坦选民的情况下，结果是否会在质量上相同。证明你的理由。</p> 
<p>2）从 Jha＆Shayo（2019）出发，有什么有前途的研究问题？</p> 
<p>3）什么是社丨会期望偏差？描述 Jha＆Shayo（2019）为减轻社丨会期望偏差所做的工作。</p> 
<p>4）使用 2SLS 而不是控制函数方法复制表 2 的结果。不要使用库“linearmodels”。使用库“statsmodels”手动进行 2SLS。</p> 
<p>5）暴露于巴勒斯坦股票是否会降低投票右翼政党的概率？运行一些回归来证明你的立场。</p> 
<h3><a id="_1576"></a>参考</h3> 
<p>Jha，S.和 Shayo，M.（2019）。<a href="https://github.com/causal-methods/Papers/raw/master/Valuing%20Peace.pdf">估价和平：金融市场暴露对选票和政丨治态度的影响</a>。计量经济学，87：1561-1588。</p> 
<p>蒙特斯基耶，C.（1748）。<a href="https://oll.libertyfund.org/titles/montesquieu-complete-works-vol-1-the-spirit-of-laws" rel="nofollow">法律精神</a>。伦敦：T. Evans，1777 年，4 卷。第 2 卷。在线自由图书馆。</p> 
<h2><a id="_1583"></a>参考书目</h2> 
<blockquote> 
 <p>原文：<a href="https://causal-methods.github.io/Book/Bibliography.html" rel="nofollow"><code>causal-methods.github.io/Book/Bibliography.html</code></a></p> 
 <p>译者：<a href="https://github.com/wizardforcel">飞龙</a></p> 
 <p>协议：<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" rel="nofollow">CC BY-NC-SA 4.0</a></p> 
</blockquote> 
<p>作者：<a href="https://www.linkedin.com/in/vitor-kamada-1b73a078" rel="nofollow">Vitor Kamada</a></p> 
<p>电子邮件：econometrics.methods@gmail.com</p> 
<p>最后更新日期 11-6-2020</p> 
<p><strong>书中使用的论文和数据</strong>：<a href="https://causal-methods.github.io/Book" rel="nofollow">Python 因果推断</a>。</p> 
<blockquote> 
 <p>巴斯滕，克里斯托夫和弗兰克贝茨（2013）。<a href="https://github.com/causal-methods/Papers/raw/master/Beyond-Work-Ethic/Beyond%20Work%20Ethic.pdf">超越职业道德：宗丨教，个人和政丨治偏好</a>。《美丨国经济学杂志：经济政策》，5（3）：67-91。<a href="https://github.com/causal-methods/Papers/raw/master/Beyond-Work-Ethic/2011-0231_app.pdf">在线附录</a>。<a href="https://github.com/causal-methods/Data/raw/master/finaldata.dta">finaldata.dta</a></p> 
 <p>贝克尔，萨沙 O.，和 Ludger Woessmann。 （2009）。韦伯错了吗？新教经济史的人力资本理论。《季度经济学杂志》124（2）：531-96。</p> 
 <p>Bertrand，Marianne 和 Sendhil Mullainathan。 （2004）。<a href="https://github.com/causal-methods/Papers/raw/master/Are%20Emily%20and%20Greg%20More%20Employable%20than%20Lakisha%20and%20Jamal.pdf">艾米丽和格雷格比拉基莎和贾迈尔更受雇用吗？</a>。劳动力市场歧视的实地实验。《美丨国经济评论》，94（4）：991-1013。<a href="https://github.com/causal-methods/Data/raw/master/lakisha_aer.dta">lakisha_aer.dta</a></p> 
 <p>Bisschop，Paul，Stephen Kastoryano 和 Bas van der Klaauw。 （2017）。<a href="https://github.com/causal-methods/Papers/raw/master/Street%20Prostitution%20Zones%20and%20Crime.pdf">街头卖丨淫区和犯罪</a>。《美丨国经济学杂志：经济政策》，9（4）：28-63。<a href="https://github.com/causal-methods/Data/raw/master/CBSregist2015.dta%22">CBSregist2015.dta</a></p> 
 <p>Edelman，Benjamin，Michael Luca 和 Dan Svirsky。 （2017）。<a href="https://github.com/causal-methods/Papers/raw/master/Racial%20Discrimination%20in%20the%20Sharing%20Economy.pdf">共享经济中的种族歧视：来自实地实验的证据</a>。《美丨国经济学杂志：应用经济学》，9（2）：1-22。<a href="https://github.com/causal-methods/Data/raw/master/Airbnb.csv%22">Airbnb.csv</a></p> 
 <p>Fey，Mark，Richard D. McKelvey 和 Thomas R. Palfrey。 （1996）。恒定总和蜈蚣游戏的实验研究。《国际博弈理论杂志》，25（3）：269-87。</p> 
 <p>弗莱尔，罗兰 G.，朱尼尔和史蒂文 D.莱维特。 （2004）。独特的黑人名字的原因和后果。《季度经济学杂志》119（3）：767-805。</p> 
 <p>Imbens，G.，&amp; Kalyanaraman，K.（2012）。回归断点估计器的最佳带宽选择。《经济研究评论》，79（3），933-959。</p> 
 <p>Jha，S.和 Shayo，M.（2019）。<a href="https://github.com/causal-methods/Papers/raw/master/Valuing%20Peace.pdf">和平的价值：金融市场暴露对选票和政丨治态度的影响</a>。计量经济学，87：1561-1588。<a href="https://github.com/causal-methods/Data/raw/master/replicationdata.dta">replicationdata.dta</a></p> 
 <p>凯恩斯，约翰梅纳德。 （1936）。<a href="https://www.marxists.org/reference/subject/economics/keynes/general-theory/" rel="nofollow">就业，利息和货币的一般理论</a>。美丨国哈考特，布雷斯和公司出版，并由美丨国纽约波利图形公司印刷。</p> 
 <p>梅耶森，埃里克。 （2014）。<a href="https://github.com/causal-methods/Papers/raw/master/Islamic%20Rule%20and%20the%20Empowerment%20of%20the%20Poor%20and%20Pious.pdf">伊丨斯丨兰统治与穷人和虔诚者的赋权</a>。计量经济学，82（1），229-269。<a href="https://github.com/causal-methods/Data/raw/master/regdata0.dta">regdata0.dta</a></p> 
 <p>Montesquieu，C.（1748）。<a href="https://oll.libertyfund.org/titles/montesquieu-complete-works-vol-1-the-spirit-of-laws" rel="nofollow">法的精神</a>。伦敦：T. Evans，1777 年，4 卷。第 2 卷。在线自由图书馆。</p> 
 <p>Oreopoulos, Philip. (2011). <a href="https://github.com/causal-methods/Papers/raw/master/Oreopoulos/Why%20Do%20Skilled%20Immigrants%20Struggle%20in%20the%20Labor%20Market.pdf">为什么技术移民在劳动市场上遇到困难？一项涉及一万三千份简历的实地实验</a>. 美丨国经济学杂志：经济政策, 3 (4): 148-71. <a href="https://github.com/causal-methods/Data/raw/master/oreopoulos.dta">oreopoulos.dta</a></p> 
 <p>Palacios-Huerta, Ignacio, and Oscar Volij. (2009). <a href="https://github.com/causal-methods/Papers/raw/master/Centipedes/Field%20Centipedes.pdf">野外蜈蚣</a>. 美丨国经济评论, 99 (4): 1619-35. <a href="https://github.com/causal-methods/Data/raw/master/Chess.xls">Chess.xls</a></p> 
 <p>Richardson, Gary, and William Troost. (2009). <a href="https://github.com/causal-methods/Papers/raw/master/richardson_troost_2009_jpe.pdf">货币干预缓解了大萧条期间的银行恐慌：来自联邦储备区域边界的准实验证据，1929-1933</a>. 政丨治经济学杂志 117 (6): 1031-73。</p> 
 <p>Weber, Max. (1930). <a href="https://www.marxists.org/reference/archive/weber/protestant-ethic/" rel="nofollow">《新教伦理与资本主丨义精神》</a>。纽约：斯克里布纳，（原始出版于 1905 年）。</p> 
 <p>Ziebarth, Nicolas L. (2013). <a href="https://github.com/causal-methods/Papers/raw/master/Identifying%20the%20Effects%20of%20Bank%20Failures.pdf">从密西西比州大萧条期间的自然实验中识别银行倒闭的影响</a>. 美丨国经济学杂志：宏观经济学, 5 (1): 81-101. <a href="https://github.com/causal-methods/Data/raw/master/MS_data_all_years_regs.dta">MS_data_all_years_regs.dta</a></p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ef4b33e6a49076f3b00bd427821262e6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Java-JDK】JDK 的安装与环境变量的配置：Windows &amp; Linux</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b99777c9b3e34b20cde999282f800480/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Node.js身份验证实践：Express-JWT和JSON Web Token的用法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>