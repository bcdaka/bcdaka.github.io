<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python轴承故障诊断 (一)短时傅里叶变换STFT - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/2910a591dd170ec7074e812695e08e99/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Python轴承故障诊断 (一)短时傅里叶变换STFT">
  <meta property="og:description" content="目录
前言
1 短时傅里叶变换STFT原理介绍
1.1 傅里叶变换的本质
1.2 STFT概述
1.3 STFT的原理和过程
1.3.1 时间分割
1.3.2 傅里叶变换
1.3.3 时频图：
1.4 公式表示
2 基于Python的STFT实现与参数对比
2.1 代码示例
2.2 参数选择和对比
2.2.1 nperseg（窗口长度）：
2.2.2 noverlap（重叠长度）：
2.2.3 选择策略：
2.3 凯斯西储大学轴承数据的加载
2.4 STFT与参数选择
2.4.1 基于重叠比例为0.5，选择内圈数据比较 STFT 的不同尺度：16、32 、64、128
2.4.1 根据正常数据和三种故障数据，对比不同尺度的辨识度
3 基于时频图像的轴承故障诊断分类
3.1 生成时频图像数据集
3.2 定义数据加载器和VGG网络模型
3.3 设置参数，训练模型
往期精彩内容： Python-凯斯西储大学（CWRU）轴承数据解读与分类处理
Python轴承故障诊断 (一)短时傅里叶变换STFT
Python轴承故障诊断 (二)连续小波变换CWT_pyts 小波变换 故障-CSDN博客
Python轴承故障诊断 (三)经验模态分解EMD_轴承诊断 pytorch-CSDN博客
Pytorch-LSTM轴承故障一维信号分类(一)_cwru数据集pytorch训练-CSDN博客
Pytorch-CNN轴承故障一维信号分类(二)-CSDN博客
Pytorch-Transformer轴承故障一维信号分类(三)-CSDN博客
Python轴承故障诊断 (四)基于EMD-CNN的故障分类-CSDN博客
Python轴承故障诊断 (五)基于EMD-LSTM的故障分类-CSDN博客
Python轴承故障诊断 (六)基于EMD-Transformer的故障分类-CSDN博客">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-08T20:04:53+08:00">
    <meta property="article:modified_time" content="2024-04-08T20:04:53+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python轴承故障诊断 (一)短时傅里叶变换STFT</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E5%89%8D%E8%A8%80-toc" style="margin-left:0px;"><a href="#%E5%89%8D%E8%A8%80" rel="nofollow">前言</a></p> 
<p id="1%20%E7%9F%AD%E6%97%B6%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2STFT%E5%8E%9F%E7%90%86%E4%BB%8B%E7%BB%8D-toc" style="margin-left:0px;"><a href="#1%20%E7%9F%AD%E6%97%B6%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2STFT%E5%8E%9F%E7%90%86%E4%BB%8B%E7%BB%8D" rel="nofollow">1 短时傅里叶变换STFT原理介绍</a></p> 
<p id="1.1%20%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2%E7%9A%84%E6%9C%AC%E8%B4%A8-toc" style="margin-left:40px;"><a href="#1.1%20%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2%E7%9A%84%E6%9C%AC%E8%B4%A8" rel="nofollow">1.1 傅里叶变换的本质</a></p> 
<p id="1.2%20STFT%E6%A6%82%E8%BF%B0-toc" style="margin-left:40px;"><a href="#1.2%20STFT%E6%A6%82%E8%BF%B0" rel="nofollow">1.2 STFT概述</a></p> 
<p id="1.3%20STFT%E7%9A%84%E5%8E%9F%E7%90%86%E5%92%8C%E8%BF%87%E7%A8%8B-toc" style="margin-left:40px;"><a href="#1.3%20STFT%E7%9A%84%E5%8E%9F%E7%90%86%E5%92%8C%E8%BF%87%E7%A8%8B" rel="nofollow">1.3 STFT的原理和过程</a></p> 
<p id="1.3.1%20%E6%97%B6%E9%97%B4%E5%88%86%E5%89%B2-toc" style="margin-left:80px;"><a href="#1.3.1%20%E6%97%B6%E9%97%B4%E5%88%86%E5%89%B2" rel="nofollow">1.3.1 时间分割</a></p> 
<p id="1.3.2%20%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2-toc" style="margin-left:80px;"><a href="#1.3.2%20%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2" rel="nofollow">1.3.2 傅里叶变换</a></p> 
<p id="1.3.3%20%E6%97%B6%E9%A2%91%E5%9B%BE%EF%BC%9A-toc" style="margin-left:80px;"><a href="#1.3.3%20%E6%97%B6%E9%A2%91%E5%9B%BE%EF%BC%9A" rel="nofollow">1.3.3 时频图：</a></p> 
<p id="1.4%20%E5%85%AC%E5%BC%8F%E8%A1%A8%E7%A4%BA-toc" style="margin-left:40px;"><a href="#1.4%20%E5%85%AC%E5%BC%8F%E8%A1%A8%E7%A4%BA" rel="nofollow">1.4 公式表示</a></p> 
<p id="2%20%E5%9F%BA%E4%BA%8EPython%E7%9A%84STFT%E5%AE%9E%E7%8E%B0%E4%B8%8E%E5%8F%82%E6%95%B0%E5%AF%B9%E6%AF%94-toc" style="margin-left:0px;"><a href="#2%20%E5%9F%BA%E4%BA%8EPython%E7%9A%84STFT%E5%AE%9E%E7%8E%B0%E4%B8%8E%E5%8F%82%E6%95%B0%E5%AF%B9%E6%AF%94" rel="nofollow">2 基于Python的STFT实现与参数对比</a></p> 
<p id="2.1%20%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B-toc" style="margin-left:40px;"><a href="#2.1%20%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B" rel="nofollow">2.1 代码示例</a></p> 
<p id="2.2%20%E5%8F%82%E6%95%B0%E9%80%89%E6%8B%A9%E5%92%8C%E5%AF%B9%E6%AF%94-toc" style="margin-left:40px;"><a href="#2.2%20%E5%8F%82%E6%95%B0%E9%80%89%E6%8B%A9%E5%92%8C%E5%AF%B9%E6%AF%94" rel="nofollow">2.2 参数选择和对比</a></p> 
<p id="2.2.1%20nperseg%EF%BC%88%E7%AA%97%E5%8F%A3%E9%95%BF%E5%BA%A6%EF%BC%89%EF%BC%9A-toc" style="margin-left:80px;"><a href="#2.2.1%20nperseg%EF%BC%88%E7%AA%97%E5%8F%A3%E9%95%BF%E5%BA%A6%EF%BC%89%EF%BC%9A" rel="nofollow">2.2.1 nperseg（窗口长度）：</a></p> 
<p id="2.2.2%20noverlap%EF%BC%88%E9%87%8D%E5%8F%A0%E9%95%BF%E5%BA%A6%EF%BC%89%EF%BC%9A-toc" style="margin-left:80px;"><a href="#2.2.2%20noverlap%EF%BC%88%E9%87%8D%E5%8F%A0%E9%95%BF%E5%BA%A6%EF%BC%89%EF%BC%9A" rel="nofollow">2.2.2 noverlap（重叠长度）：</a></p> 
<p id="2.2.3%20%E9%80%89%E6%8B%A9%E7%AD%96%E7%95%A5%EF%BC%9A-toc" style="margin-left:80px;"><a href="#2.2.3%20%E9%80%89%E6%8B%A9%E7%AD%96%E7%95%A5%EF%BC%9A" rel="nofollow">2.2.3 选择策略：</a></p> 
<p id="2.3%20%E5%87%AF%E6%96%AF%E8%A5%BF%E5%82%A8%E5%A4%A7%E5%AD%A6%E8%BD%B4%E6%89%BF%E6%95%B0%E6%8D%AE%E7%9A%84%E5%8A%A0%E8%BD%BD-toc" style="margin-left:40px;"><a href="#2.3%20%E5%87%AF%E6%96%AF%E8%A5%BF%E5%82%A8%E5%A4%A7%E5%AD%A6%E8%BD%B4%E6%89%BF%E6%95%B0%E6%8D%AE%E7%9A%84%E5%8A%A0%E8%BD%BD" rel="nofollow">2.3 凯斯西储大学轴承数据的加载</a></p> 
<p id="2.4%20STFT%E4%B8%8E%E5%8F%82%E6%95%B0%E9%80%89%E6%8B%A9-toc" style="margin-left:40px;"><a href="#2.4%20STFT%E4%B8%8E%E5%8F%82%E6%95%B0%E9%80%89%E6%8B%A9" rel="nofollow">2.4 STFT与参数选择</a></p> 
<p id="2.4.1%20%E5%9F%BA%E4%BA%8E%E9%87%8D%E5%8F%A0%E6%AF%94%E4%BE%8B%E4%B8%BA0.5%EF%BC%8C%E9%80%89%E6%8B%A9%E5%86%85%E5%9C%88%E6%95%B0%E6%8D%AE%E6%AF%94%E8%BE%83%20STFT%20%E7%9A%84%E4%B8%8D%E5%90%8C%E5%B0%BA%E5%BA%A6%EF%BC%9A16%E3%80%8132%20%E3%80%8164%E3%80%81128-toc" style="margin-left:80px;"><a href="#2.4.1%20%E5%9F%BA%E4%BA%8E%E9%87%8D%E5%8F%A0%E6%AF%94%E4%BE%8B%E4%B8%BA0.5%EF%BC%8C%E9%80%89%E6%8B%A9%E5%86%85%E5%9C%88%E6%95%B0%E6%8D%AE%E6%AF%94%E8%BE%83%20STFT%20%E7%9A%84%E4%B8%8D%E5%90%8C%E5%B0%BA%E5%BA%A6%EF%BC%9A16%E3%80%8132%20%E3%80%8164%E3%80%81128" rel="nofollow">2.4.1 基于重叠比例为0.5，选择内圈数据比较 STFT 的不同尺度：16、32 、64、128</a></p> 
<p id="2.4.1%20%E6%A0%B9%E6%8D%AE%E6%AD%A3%E5%B8%B8%E6%95%B0%E6%8D%AE%E5%92%8C%E4%B8%89%E7%A7%8D%E6%95%85%E9%9A%9C%E6%95%B0%E6%8D%AE%EF%BC%8C%E5%AF%B9%E6%AF%94%E4%B8%8D%E5%90%8C%E5%B0%BA%E5%BA%A6%E7%9A%84%E8%BE%A8%E8%AF%86%E5%BA%A6-toc" style="margin-left:80px;"><a href="#2.4.1%20%E6%A0%B9%E6%8D%AE%E6%AD%A3%E5%B8%B8%E6%95%B0%E6%8D%AE%E5%92%8C%E4%B8%89%E7%A7%8D%E6%95%85%E9%9A%9C%E6%95%B0%E6%8D%AE%EF%BC%8C%E5%AF%B9%E6%AF%94%E4%B8%8D%E5%90%8C%E5%B0%BA%E5%BA%A6%E7%9A%84%E8%BE%A8%E8%AF%86%E5%BA%A6" rel="nofollow">2.4.1 根据正常数据和三种故障数据，对比不同尺度的辨识度</a></p> 
<p id="3%20%E5%9F%BA%E4%BA%8E%E6%97%B6%E9%A2%91%E5%9B%BE%E5%83%8F%E7%9A%84%E8%BD%B4%E6%89%BF%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E5%88%86%E7%B1%BB-toc" style="margin-left:0px;"><a href="#3%20%E5%9F%BA%E4%BA%8E%E6%97%B6%E9%A2%91%E5%9B%BE%E5%83%8F%E7%9A%84%E8%BD%B4%E6%89%BF%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E5%88%86%E7%B1%BB" rel="nofollow">3 基于时频图像的轴承故障诊断分类</a></p> 
<p id="3.1%20%E7%94%9F%E6%88%90%E6%97%B6%E9%A2%91%E5%9B%BE%E5%83%8F%E6%95%B0%E6%8D%AE%E9%9B%86-toc" style="margin-left:40px;"><a href="#3.1%20%E7%94%9F%E6%88%90%E6%97%B6%E9%A2%91%E5%9B%BE%E5%83%8F%E6%95%B0%E6%8D%AE%E9%9B%86" rel="nofollow">3.1 生成时频图像数据集</a></p> 
<p id="3.2%20%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%E5%99%A8%E5%92%8CVGG%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%9E%8B-toc" style="margin-left:40px;"><a href="#3.2%20%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%E5%99%A8%E5%92%8CVGG%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%9E%8B" rel="nofollow">3.2 定义数据加载器和VGG网络模型</a></p> 
<p id="3.3%20%E8%AE%BE%E7%BD%AE%E5%8F%82%E6%95%B0%EF%BC%8C%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B-toc" style="margin-left:80px;"><a href="#3.3%20%E8%AE%BE%E7%BD%AE%E5%8F%82%E6%95%B0%EF%BC%8C%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B" rel="nofollow">3.3 设置参数，训练模型</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h3 id="%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E7%BC%96%E8%BE%91" style="text-align:center;"><img alt="" src="https://images2.imgbox.com/23/c0/ePJn5cAl_o.png"></h3> 
<h2 id="%E5%BE%80%E6%9C%9F%E7%B2%BE%E5%BD%A9%E5%86%85%E5%AE%B9%EF%BC%9A"><strong> 往期精彩内容：</strong></h2> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/134495407?spm=1001.2014.3001.5502" title="Python-凯斯西储大学（CWRU）轴承数据解读与分类处理">Python-凯斯西储大学（CWRU）轴承数据解读与分类处理</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/134744920?spm=1001.2014.3001.5502" title="Python轴承故障诊断 (一)短时傅里叶变换STFT">Python轴承故障诊断 (一)短时傅里叶变换STFT</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/134758611?spm=1001.2014.3001.5502" title="Python轴承故障诊断 (二)连续小波变换CWT_pyts 小波变换 故障-CSDN博客">Python轴承故障诊断 (二)连续小波变换CWT_pyts 小波变换 故障-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/134770900?spm=1001.2014.3001.5502" title="Python轴承故障诊断 (三)经验模态分解EMD_轴承诊断 pytorch-CSDN博客">Python轴承故障诊断 (三)经验模态分解EMD_轴承诊断 pytorch-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/134863657?spm=1001.2014.3001.5502" title="Pytorch-LSTM轴承故障一维信号分类(一)_cwru数据集pytorch训练-CSDN博客">Pytorch-LSTM轴承故障一维信号分类(一)_cwru数据集pytorch训练-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/134885503?spm=1001.2014.3001.5502" title="Pytorch-CNN轴承故障一维信号分类(二)-CSDN博客">Pytorch-CNN轴承故障一维信号分类(二)-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/134894317?spm=1001.2014.3001.5502" title="Pytorch-Transformer轴承故障一维信号分类(三)-CSDN博客">Pytorch-Transformer轴承故障一维信号分类(三)-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/134808308?spm=1001.2014.3001.5502" title="Python轴承故障诊断 (四)基于EMD-CNN的故障分类-CSDN博客">Python轴承故障诊断 (四)基于EMD-CNN的故障分类-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/134838832?spm=1001.2014.3001.5502" title="Python轴承故障诊断 (五)基于EMD-LSTM的故障分类-CSDN博客">Python轴承故障诊断 (五)基于EMD-LSTM的故障分类-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/134913585?spm=1001.2014.3001.5502" title="Python轴承故障诊断 (六)基于EMD-Transformer的故障分类-CSDN博客">Python轴承故障诊断 (六)基于EMD-Transformer的故障分类-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/135023821?spm=1001.2014.3001.5502" title="Python轴承故障诊断 (七)基于EMD-CNN-LSTM的故障分类-CSDN博客">Python轴承故障诊断 (七)基于EMD-CNN-LSTM的故障分类-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/135025051?spm=1001.2014.3001.5502" title="Python轴承故障诊断 (八)基于EMD-CNN-GRU并行模型的故障分类-CSDN博客">Python轴承故障诊断 (八)基于EMD-CNN-GRU并行模型的故障分类-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/135251000?spm=1001.2014.3001.5502" title="基于FFT + CNN - BiGRU-Attention 时域、频域特征注意力融合的轴承故障识别模型-CSDN博客">基于FFT + CNN - BiGRU-Attention 时域、频域特征注意力融合的轴承故障识别模型-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/135314544?spm=1001.2014.3001.5502" title="基于FFT + CNN - Transformer 时域、频域特征融合的轴承故障识别模型-CSDN博客">基于FFT + CNN - Transformer 时域、频域特征融合的轴承故障识别模型-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/135328492?spm=1001.2014.3001.5502" title="大甩卖-（CWRU）轴承故障诊数据集和代码全家桶-CSDN博客">大甩卖-（CWRU）轴承故障诊数据集和代码全家桶-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/135350483?spm=1001.2014.3001.5502" title="Python轴承故障诊断 (九)基于VMD+CNN-BiLSTM的故障分类-CSDN博客">Python轴承故障诊断 (九)基于VMD+CNN-BiLSTM的故障分类-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/135467444?spm=1001.2014.3001.5502" title="Python轴承故障诊断 (十)基于VMD+CNN-Transfromer的故障分类-CSDN博客">Python轴承故障诊断 (十)基于VMD+CNN-Transfromer的故障分类-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/135580556?spm=1001.2014.3001.5502" title="Python轴承故障诊断 (11)基于VMD+CNN-BiGRU-Attenion的故障分类-CSDN博客">Python轴承故障诊断 (11)基于VMD+CNN-BiGRU-Attenion的故障分类-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/135636837?spm=1001.2014.3001.5502" title="交叉注意力融合时域、频域特征的FFT + CNN -BiLSTM-CrossAttention轴承故障识别模型-CSDN博客">交叉注意力融合时域、频域特征的FFT + CNN -BiLSTM-CrossAttention轴承故障识别模型-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/135888473?spm=1001.2014.3001.5502" title="交叉注意力融合时域、频域特征的FFT + CNN-Transformer-CrossAttention轴承故障识别模型-CSDN博客">交叉注意力融合时域、频域特征的FFT + CNN-Transformer-CrossAttention轴承故障识别模型-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/135977614?spm=1001.2014.3001.5502" title="轴承故障诊断 (12)基于交叉注意力特征融合的VMD+CNN-BiLSTM-CrossAttention故障识别模型-CSDN博客">轴承故障诊断 (12)基于交叉注意力特征融合的VMD+CNN-BiLSTM-CrossAttention故障识别模型-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/136043277?spm=1001.2014.3001.5502" title="Python轴承故障诊断入门教学-CSDN博客">Python轴承故障诊断入门教学-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/136103013?spm=1001.2014.3001.5501" title="Python轴承故障诊断 (13)基于故障信号特征提取的超强机器学习识别模型-CSDN博客">Python轴承故障诊断 (13)基于故障信号特征提取的超强机器学习识别模型-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/136332377?spm=1001.2014.3001.5502" title="Python轴承故障诊断 (14)高创新故障识别模型-CSDN博客">Python轴承故障诊断 (14)高创新故障识别模型-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/136355669?spm=1001.2014.3001.5502" title="Python轴承故障诊断 (15)基于CNN-Transformer的一维故障信号识别模型-CSDN博客">Python轴承故障诊断 (15)基于CNN-Transformer的一维故障信号识别模型-CSDN博客</a></p> 
<p></p> 
<h2 id="%E5%89%8D%E8%A8%80">前言</h2> 
<p>本文基于凯斯西储大学（CWRU）轴承数据，进行短时傅里叶变换的介绍与参数选择，最后通过Python实现对故障数据的时频图像分类。凯斯西储大学（CWRU）轴承数据的详细介绍可以参考下文：</p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/134495407?spm=1001.2014.3001.5502" title="Python-凯斯西储大学（CWRU）轴承数据解读与分类处理_cwru轴承数据集-CSDN博客">Python-凯斯西储大学（CWRU）轴承数据解读与分类处理_cwru轴承数据集-CSDN博客</a></p> 
<p></p> 
<h2 id="1%20%E7%9F%AD%E6%97%B6%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2STFT%E5%8E%9F%E7%90%86%E4%BB%8B%E7%BB%8D">1 短时傅里叶变换STFT原理介绍</h2> 
<h3 id="1.1%20%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2%E7%9A%84%E6%9C%AC%E8%B4%A8">1.1 傅里叶变换的本质</h3> 
<p>傅里叶变换的基本思想：</p> 
<ul><li> <p>将信号分解成一系列不同频率的连续正弦波的叠加；</p> </li><li> <p>或者说，将信号从时间域转换到频率域。</p> </li></ul> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/95/d1/CA59n9xi_o.png"></p> 
<p></p> 
<p>由于傅里叶变换是对整个信号进行变换，将整个信号从时域转换到频域，得到一个整体的频谱；丢掉了时间信息，无法根据傅立叶变换的结果判断一个特定信号在什么时候发生；所以傅里叶变换缺乏时频分析能力、多分辨率分析能力，难以分析非平稳信号。</p> 
<h4></h4> 
<h3 id="1.2%20STFT%E6%A6%82%E8%BF%B0">1.2 STFT概述</h3> 
<p>短时傅里叶变换（Short-Time Fourier Transform，STFT）是一种将信号分解为时域和频域信息的时频分析方法。它通过将信号分成短时段，并在每个短时段上应用傅里叶变换来捕捉信号的瞬时频率。即采用中心位于时间α的时间窗g(t-α)在时域信号上滑动，在时间窗g(t-α)限定的范围内进行傅里叶变换，这样就使短时傅里叶变换具有了时间和频率的局部化能力，兼顾了时间和频率的分析[1]。</p> 
<ul><li> <p>使用窄窗，时间分辨率提高而频率分辨率降低；</p> </li><li> <p>使用宽窗，频率分辨率提高而时间分辨率降低。</p> </li></ul> 
<p></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/5a/1e/PjTXvsBL_o.png"></p> 
<p>比如用利用高斯窗STFT对非平稳信号进行分析：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/6e/3c/eqh49MYz_o.png"></p> 
<p></p> 
<h3 id="1.3%20STFT%E7%9A%84%E5%8E%9F%E7%90%86%E5%92%8C%E8%BF%87%E7%A8%8B">1.3 STFT的原理和过程</h3> 
<h4 id="1.3.1%20%E6%97%B6%E9%97%B4%E5%88%86%E5%89%B2">1.3.1 时间分割</h4> 
<p>在短时傅里叶变换（STFT）中，首先将信号分割成短时段。这个过程通常通过使用窗口函数来实现，窗口函数是一个在有限时间内非零，而在其他时间上为零的函数。常见的窗口函数有矩形窗、汉明窗、汉宁窗等。通过将窗口函数应用于信号，可以将信号分成许多短时段。</p> 
<h4></h4> 
<h4 id="1.3.2%20%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2">1.3.2 傅里叶变换</h4> 
<p>对于每个短时段，都会进行傅里叶变换。傅里叶变换是一种将信号从时域（时间域）转换为频域（频率域）的方法。在这个上下文中，它用于分析每个短时段内信号的频率成分。傅里叶变换将信号表示为不同频率的正弦和余弦函数的组合。</p> 
<h4></h4> 
<h4 id="1.3.3%20%E6%97%B6%E9%A2%91%E5%9B%BE%EF%BC%9A">1.3.3 时频图：</h4> 
<p>将每个短时段的傅里叶变换结果排列成一个矩阵，构成了时频图。时频图的横轴表示时间，纵轴表示频率，而每个点的强度表示对应频率在对应时刻的幅度。时频图提供了一种直观的方式来观察信号在时间和频率上的变化。</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/12/2b/dHaZehKl_o.png"></p> 
<p></p> 
<h3 id="1.4%20%E5%85%AC%E5%BC%8F%E8%A1%A8%E7%A4%BA">1.4 公式表示</h3> 
<p>STFT的数学表达式如下：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/35/c8/CKUbXMCj_o.png"></p> 
<p></p> 
<p>其中，</p> 
<p></p> 
<h3 id="%E2%80%8B%E7%BC%96%E8%BE%91" style="text-align:center;"><img alt="" src="https://images2.imgbox.com/c0/71/JXDVGjaH_o.png"></h3> 
<h2></h2> 
<h2 id="2%20%E5%9F%BA%E4%BA%8EPython%E7%9A%84STFT%E5%AE%9E%E7%8E%B0%E4%B8%8E%E5%8F%82%E6%95%B0%E5%AF%B9%E6%AF%94">2 基于Python的STFT实现与参数对比</h2> 
<p>在 Python 中，使用 scipy 库来实现短时傅里叶变换（STFT）</p> 
<h3 id="2.1%20%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B">2.1 代码示例</h3> 
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.signal import stft
# 生成三个不同频率成分的信号
fs = 1000  # 采样率
t = np.linspace(0, 1, fs, endpoint=False)  # 时间

# 第一个频率成分
signal1 = np.sin(2 * np.pi * 50 * t)
# 第二个频率成分
signal2 = np.sin(2 * np.pi * 120 * t)
# 第三个频率成分
signal3 = np.sin(2 * np.pi * 300 * t)

# 合并三个信号
signal = np.concatenate((signal1, signal2, signal3))

# 进行短时傅里叶变换  
f, t, spectrum = stft(signal, fs, nperseg=100, noverlap=50)
# 绘制时频图
plt.pcolormesh(t, f, np.abs(spectrum), shading='gouraud')
plt.title('STFT Magnitude')
plt.ylabel('Frequency [Hz]')
plt.xlabel('Time [sec]')
plt.show()</code></pre> 
<p>参数解释</p> 
<ul><li> <p>nperseg：表示每个段的长度，即窗口大小</p> </li><li> <p>noverlap：表示相邻段的重叠部分</p> </li><li> <p>f：是频率数组，表示频谱的频率分量</p> </li><li> <p>t：是时间数组，表示每个时间段的起始时间</p> </li><li> <p>spectrum：是频谱矩阵，spectrum[f, t] 表示在频率 f 处于时间 t 时的频谱强度</p> </li></ul> 
<p>可以使用 np.abs(spectrum) 获取频谱的幅度，表示在不同频率和时间上的信号强度</p> 
<p></p> 
<h4 style="text-align:center;"><img alt="" src="https://images2.imgbox.com/e5/8e/5m1S8nEI_o.png"></h4> 
<h3 id="2.2%20%E5%8F%82%E6%95%B0%E9%80%89%E6%8B%A9%E5%92%8C%E5%AF%B9%E6%AF%94">2.2 参数选择和对比</h3> 
<h4 id="2.2.1%20nperseg%EF%BC%88%E7%AA%97%E5%8F%A3%E9%95%BF%E5%BA%A6%EF%BC%89%EF%BC%9A">2.2.1 nperseg（窗口长度）：</h4> 
<ul><li> <p>nperseg 定义了每个时间段内的信号长度，也就是说，它规定了窗口的大小。</p> </li><li> <p>较小的 nperseg 可以提供更高的时间分辨率，因为窗口更短，可以捕捉到信号的更快变化。但频率分辨率较差。</p> </li><li> <p>较大的 nperseg 提供更高的频率分辨率，但可能失去对信号快速变化的捕捉。</p> </li><li> <p>选择适当的窗口长度要根据信号特性，如频率变化的速率和信号长度等。</p> </li></ul> 
<h4></h4> 
<h4 id="2.2.2%20noverlap%EF%BC%88%E9%87%8D%E5%8F%A0%E9%95%BF%E5%BA%A6%EF%BC%89%EF%BC%9A">2.2.2 noverlap（重叠长度）：</h4> 
<ul><li> <p>noverlap 定义了相邻时间段之间的重叠部分。</p> </li><li> <p>较大的 noverlap 可以提高时间分辨率，因为相邻时间段之间有更多的共享信息。但可能导致频谱图中的泄漏（leakage）。</p> </li><li> <p>较小的 noverlap 可以提高频率分辨率，减少泄漏，但时间分辨率可能下降。</p> </li></ul> 
<h4 id="2.2.3%20%E9%80%89%E6%8B%A9%E7%AD%96%E7%95%A5%EF%BC%9A">2.2.3 选择策略：</h4> 
<p>参数的选择需要考虑到对信号分析的具体需求，平衡时间和频率分辨率，尝试不同的 nperseg 和 noverlap 值，观察结果的变化。</p> 
<ul><li> <p>对于 nperseg，选择较小的值可能需要根据信号的特定频率内容进行调整。确保窗口足够短，以捕捉到频率变化。</p> </li><li> <p>对于 noverlap，通常选择 50% 的重叠是一个常见的起点</p> </li></ul> 
<p></p> 
<h3 id="2.3%20%E5%87%AF%E6%96%AF%E8%A5%BF%E5%82%A8%E5%A4%A7%E5%AD%A6%E8%BD%B4%E6%89%BF%E6%95%B0%E6%8D%AE%E7%9A%84%E5%8A%A0%E8%BD%BD">2.3 凯斯西储大学轴承数据的加载</h3> 
<p>选择正常信号和 0.021英寸内圈、滚珠、外圈故障信号数据来做对比</p> 
<p>第一步，导入包，读取数据</p> 
<pre><code class="language-python">import numpy as np
from scipy.io import loadmat
import numpy as np
from scipy.signal import stft
import matplotlib.pyplot as plt
import matplotlib
matplotlib.rc("font", family='Microsoft YaHei')

# 读取MAT文件  
data1 = loadmat('0_0.mat')  # 正常信号
data2 = loadmat('21_1.mat') # 0.021英寸 内圈
data3 = loadmat('21_2.mat') # 0.021英寸 滚珠
data4 = loadmat('21_3.mat') # 0.021英寸 外圈
# 注意，读取出来的data是字典格式，可以通过函数type(data)查看。</code></pre> 
<p>第二步，数据集中统一读取 驱动端加速度数据，取一个长度为1024的信号进行后续观察和实验</p> 
<pre><code class="language-python"># DE - drive end accelerometer data 驱动端加速度数据
data_list1 = data1['X097_DE_time'].reshape(-1)
data_list2 = data2['X209_DE_time'].reshape(-1)  
data_list3 = data3['X222_DE_time'].reshape(-1)
data_list4 = data4['X234_DE_time'].reshape(-1)
# 划窗取值（大多数窗口大小为1024）
data_list1 = data_list1[0:1024]
data_list2 = data_list2[0:1024]
data_list3 = data_list3[0:1024]
data_list4 = data_list4[0:1024]</code></pre> 
<p>第三步，进行数据可视化</p> 
<pre><code class="language-python">plt.figure(figsize=(20,10))

plt.subplot(2,2,1)
plt.plot(data_list1)
plt.title('正常')
plt.subplot(2,2,2)
plt.plot(data_list2)
plt.title('内圈')
plt.subplot(2,2,3)
plt.plot(data_list3)
plt.title('滚珠')
plt.subplot(2,2,4)
plt.plot(data_list4)
plt.title('外圈')

plt.show()</code></pre> 
<p></p> 
<h4 style="text-align:center;"><img alt="" src="https://images2.imgbox.com/e9/ce/7vI2NtwF_o.png"></h4> 
<h3 id="2.4%20STFT%E4%B8%8E%E5%8F%82%E6%95%B0%E9%80%89%E6%8B%A9">2.4 STFT与参数选择</h3> 
<h4 id="2.4.1%20%E5%9F%BA%E4%BA%8E%E9%87%8D%E5%8F%A0%E6%AF%94%E4%BE%8B%E4%B8%BA0.5%EF%BC%8C%E9%80%89%E6%8B%A9%E5%86%85%E5%9C%88%E6%95%B0%E6%8D%AE%E6%AF%94%E8%BE%83%20STFT%20%E7%9A%84%E4%B8%8D%E5%90%8C%E5%B0%BA%E5%BA%A6%EF%BC%9A16%E3%80%8132%20%E3%80%8164%E3%80%81128">2.4.1 基于重叠比例为0.5，选择内圈数据比较 STFT 的不同尺度：16、32 、64、128</h4> 
<pre><code class="language-python">from scipy.signal import stft

# 设置STFT参数
window_size = 32  # 窗口大小
overlap = 0.5  # 重叠比例
# 计算重叠的样本数
overlap_samples = int(window_size * overlap)
frequencies1, times1, magnitude1 = stft(data_list2, nperseg=window_size, noverlap=overlap_samples)

# 设置STFT参数
window_size = 64  # 窗口大小
overlap = 0.5  # 重叠比例
# 计算重叠的样本数
overlap_samples = int(window_size * overlap)
frequencies2, times2, magnitude2 = stft(data_list2, nperseg=window_size, noverlap=overlap_samples)

# 设置STFT参数
window_size = 128  # 窗口大小
overlap = 0.5  # 重叠比例
# 计算重叠的样本数
overlap_samples = int(window_size * overlap)
frequencies3, times3, magnitude3 = stft(data_list2, nperseg=window_size, noverlap=overlap_samples)

# 设置STFT参数
window_size = 256  # 窗口大小
overlap = 0.5  # 重叠比例
# 计算重叠的样本数
overlap_samples = int(window_size * overlap)
frequencies4, times4, magnitude4 = stft(data_list2, nperseg=window_size, noverlap=overlap_samples</code></pre> 
<p>数据可视化</p> 
<pre><code class="language-python">plt.figure(figsize=(20,10), dpi=100)
plt.subplot(2,2,1)
plt.pcolormesh(times1, frequencies1, np.abs(magnitude1), shading='gouraud')
plt.title('尺度 16-内圈')
plt.subplot(2,2,2)
plt.pcolormesh(times2, frequencies2, np.abs(magnitude2), shading='gouraud')
plt.title('尺度 32-内圈')
plt.subplot(2,2,3)
plt.pcolormesh(times3, frequencies3, np.abs(magnitude3), shading='gouraud')
plt.title('尺度 64-内圈')
plt.subplot(2,2,4)
plt.pcolormesh(times4, frequencies4, np.abs(magnitude4), shading='gouraud')
plt.title('尺度 128-内圈')
plt.show()</code></pre> 
<p></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/e5/ce/cLZE3DPP_o.png"></p> 
<p>对比不同尺度的变化，大尺度有着较高的频率分辨率，小的尺度有着较高的时间分辨率，要权衡故障的分类辨识度，需要进一步做对比。</p> 
<h4></h4> 
<h4 id="2.4.1%20%E6%A0%B9%E6%8D%AE%E6%AD%A3%E5%B8%B8%E6%95%B0%E6%8D%AE%E5%92%8C%E4%B8%89%E7%A7%8D%E6%95%85%E9%9A%9C%E6%95%B0%E6%8D%AE%EF%BC%8C%E5%AF%B9%E6%AF%94%E4%B8%8D%E5%90%8C%E5%B0%BA%E5%BA%A6%E7%9A%84%E8%BE%A8%E8%AF%86%E5%BA%A6">2.4.1 根据正常数据和三种故障数据，对比不同尺度的辨识度</h4> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/91/83/riadhbLe_o.png"></p> 
<p></p> 
<p></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/98/de/GlJXbiU1_o.png"></p> 
<p>综合考虑频率分辨率和时间分辨率，选择尺度为32。</p> 
<p></p> 
<h2 id="3%20%E5%9F%BA%E4%BA%8E%E6%97%B6%E9%A2%91%E5%9B%BE%E5%83%8F%E7%9A%84%E8%BD%B4%E6%89%BF%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E5%88%86%E7%B1%BB">3 基于时频图像的轴承故障诊断分类</h2> 
<p>下面以短时傅里叶变换（Short Time Fourier Transform，STFT）作为轴承故障数据的处理方法进行讲解：</p> 
<p>数据介绍，凯斯西储大学（CWRU）轴承数据10分类数据集</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/2b/bf/AzuCSJGx_o.png"></p> 
<p></p> 
<p>train_set、val_set、test_set 均为按照7：2：1划分训练集、验证集、测试集，最后保存数据</p> 
<h3 id="3.1%20%E7%94%9F%E6%88%90%E6%97%B6%E9%A2%91%E5%9B%BE%E5%83%8F%E6%95%B0%E6%8D%AE%E9%9B%86">3.1 生成时频图像数据集</h3> 
<p></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/52/d7/z7YU33fg_o.png"></p> 
<p>如图所示为生成的时频图像数据集</p> 
<p></p> 
<h4 style="text-align:center;"><img alt="" src="https://images2.imgbox.com/22/ca/PHeAcEXu_o.png"></h4> 
<h3 id="3.2%20%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%E5%99%A8%E5%92%8CVGG%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%9E%8B">3.2 定义数据加载器和VGG网络模型</h3> 
<p>制作数据标签，保存数据</p> 
<p><img alt="" src="https://images2.imgbox.com/8e/e5/ioReRHa3_o.png"></p> 
<p></p> 
<p>定义VGG网络模型</p> 
<p></p> 
<h4 style="text-align:center;"><img alt="" src="https://images2.imgbox.com/8e/1e/jNU63jFs_o.png"></h4> 
<h4 id="3.3%20%E8%AE%BE%E7%BD%AE%E5%8F%82%E6%95%B0%EF%BC%8C%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B">3.3 设置参数，训练模型</h4> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/86/f3/Y0yEpXG6_o.png"></p> 
<p></p> 
<p>100个epoch，准确率将近92%，继续调参可以进一步提高分类准确率</p> 
<h2>代码、数据如下：</h2> 
<p>对数据集和代码感兴趣的，可以关注最后一行</p> 
<pre><code class="language-python"># 加载数据
import torch
from joblib import dump, load
import torch.utils.data as Data
import numpy as np
import pandas as pd
import torch
import torch.nn as nn
# 参数与配置
torch.manual_seed(100)  # 设置随机种子，以使实验结果具有可重复性
device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
 
#代码和数据集：https://mbd.pub/o/bread/ZZeXm5tv</code></pre> 
<p></p> 
<p>参考文献</p> 
<p>[1]《小波分析及其工程应用》.机械工业出版社</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/27/ad/1fnuz27d_o.png"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0f14646ede3806390f2ba8baca5083fb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">在线视频教育平台|基于Springboot的在线视频教育平台系统设计与实现(源码&#43;数据库&#43;文档)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/431c70dc2a1133d54a06ab1a834a046c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">YOLOv5实战记录06 Gradio搭建Web GUI</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>