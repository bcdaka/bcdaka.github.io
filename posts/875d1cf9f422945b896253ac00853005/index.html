<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>在python中使用openpyxl库读写Excel.xlsx文件详解（有参考列程） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/875d1cf9f422945b896253ac00853005/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="在python中使用openpyxl库读写Excel.xlsx文件详解（有参考列程）">
  <meta property="og:description" content="Python中，读写.xlsx文件（即Excel 2007及以后版本的文件）常用的库有openpyxl和pandas。openpyxl提供了对Excel工作簿、工作表、单元格等的底层操作，而pandas则提供了更高级的数据处理和分析功能，同时支持读写Excel文件。
如果列程没有看懂，文章后半部分有详细教程
读取.xlsx文件 import openpyxl # 打开Excel文件 workbook = openpyxl.load_workbook(&#39;example.xlsx&#39;) # 获取活动工作表（通常是第一个工作表） sheet = workbook.active # 读取单元格数据 cell_value = sheet[&#39;A1&#39;].value print(cell_value) # 读取整行或整列数据 row_values = [cell.value for cell in sheet[1]] # 第一行数据 column_values = [sheet[f&#39;A{i}&#39;].value for i in range(1, sheet.max_row &#43; 1)] # A列数据 # 遍历所有单元格数据 for row in sheet.iter_rows(values_only=True): print(row) 写入.xlsx文件 import openpyxl # 创建一个新的Excel工作簿 workbook = openpyxl.Workbook() # 获取活动工作表 sheet = workbook.active # 写入单元格数据 sheet[&#39;A1&#39;] = &#39;Hello&#39; sheet[&#39;B1&#39;] = &#39;World&#39; # 保存Excel文件 workbook.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-09T13:41:39+08:00">
    <meta property="article:modified_time" content="2024-04-09T13:41:39+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">在python中使用openpyxl库读写Excel.xlsx文件详解（有参考列程）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>Python中，读写<code>.xlsx</code>文件（即Excel 2007及以后版本的文件）常用的库有<code>openpyxl</code>和<code>pandas</code>。<code>openpyxl</code>提供了对Excel工作簿、工作表、单元格等的底层操作，而<code>pandas</code>则提供了更高级的数据处理和分析功能，同时支持读写Excel文件。</p> 
<p><strong>如果列程没有看懂，文章后半部分有详细教程</strong></p> 
<h5><strong>读取<code>.xlsx</code>文件</strong></h5> 
<pre><code class="language-python">import openpyxl  
  
# 打开Excel文件  
workbook = openpyxl.load_workbook('example.xlsx')  
  
# 获取活动工作表（通常是第一个工作表）  
sheet = workbook.active  
  
# 读取单元格数据  
cell_value = sheet['A1'].value  
print(cell_value)  
  
# 读取整行或整列数据  
row_values = [cell.value for cell in sheet[1]]  # 第一行数据  
column_values = [sheet[f'A{i}'].value for i in range(1, sheet.max_row + 1)]  # A列数据  
  
# 遍历所有单元格数据  
for row in sheet.iter_rows(values_only=True):  
    print(row)</code></pre> 
<h5><strong>写入<code>.xlsx</code>文件</strong></h5> 
<pre><code class="language-python">import openpyxl  
  
# 创建一个新的Excel工作簿  
workbook = openpyxl.Workbook()  
  
# 获取活动工作表  
sheet = workbook.active  
  
# 写入单元格数据  
sheet['A1'] = 'Hello'  
sheet['B1'] = 'World'  
  
# 保存Excel文件  
workbook.save('output.xlsx')</code></pre> 
<p><strong>使用<code>openpyxl</code>来更新一个已经存在的<code>.xlsx</code>文件中的单个单元格，而不改变其他</strong></p> 
<pre><code class="language-python">import openpyxl  
  
# 加载现有的Excel文件  
workbook = openpyxl.load_workbook('existing_file.xlsx')  
  
# 选择要修改的工作表，这里假设是第一个工作表  
sheet = workbook.worksheets[0]  
  
# 找到并修改特定的单元格，这里以A1为例  
cell = sheet['A1']  
cell.value = '新的值'  
  
# 保存修改后的工作簿，这里会覆盖原文件，如果需要保留原文件，请另存为新文件  
workbook.save('existing_file.xlsx')</code></pre> 
<p></p> 
<p></p> 
<p><strong>综合应用：</strong>时刻数值记录，每天生成个excel文件，以当天的时间命名文件的名字，每隔2s在excel文档中记录一个数字，每次记录不覆盖原始的数据</p> 
<pre><code class="language-python">import openpyxl
import time
import os
import random

current_time = time.strftime('%Y-%m-%d')
# 文件路径
file_path = str(str(current_time)+".xlsx")
# 判断文件是否存在
if os.path.exists(file_path):
    print(f"{file_path} 文件存在")
    # workbook = openpyxl.load_workbook('AA.xlsx')  # 加载已存在的工作簿
    workbook = openpyxl.load_workbook(file_path)
else:
    print(f"{file_path} 文件不存在")
    workbook = openpyxl.Workbook()  # 创建一个新的工作簿



# 获取活动工作表
sheet = workbook.active
print(sheet['AA1'].value)
if sheet['AA1'].value == None:
    start_row = 1
else:
    start_row = sheet['AA1'].value+1

while True:
    # 获取当前时间并格式化
    current_time = time.strftime('%H:%M:%S')
    # %Y - %m - %d
    content = random.randint(1, 999)
    # 将时间和内容写入工作表
    sheet.cell(row=start_row, column=1, value=current_time)
    sheet.cell(row=start_row, column=2, value=content)
    sheet['AA1'].value = start_row
    workbook.save(file_path)    # 保存工作簿
    start_row += 1              # 更新起始行以便下次写入新行
    time.sleep(2)
    column_values = [str(sheet[f'A{i}'].value)+"-"+ str(sheet[f'B{i}'].value) for i in range(start_row-5 , start_row)]
    print(column_values)

</code></pre> 
<p>程序运行后会在程序所在的文件夹产生一个excel的表格，记录每隔2s产生的随机数<img alt="" height="616" src="https://images2.imgbox.com/63/f1/ZCZladCC_o.png" width="1039"></p> 
<p></p> 
<p></p> 
<p><strong>Python读写xlsx文件详解</strong></p> 
<p>在数据处理和分析的过程中，Excel文件由于其直观的表格形式以及易操作的特点，被广泛应用于各个行业和领域。而Python作为一种强大的编程语言，自然也提供了多种处理Excel文件的库。其中，<code>openpyxl</code>库就是专门用于读写<code>.xlsx</code>文件的Python库。本文将详细介绍如何使用<code>openpyxl</code>库来读写xlsx文件。</p> 
<p><strong>一、安装openpyxl库</strong></p> 
<p>在使用<code>openpyxl</code>库之前，首先需要确保已经安装了这个库。可以使用pip来安装：</p> 
<pre><code class="language-python">pip install openpyxl</code></pre> 
<p><strong>二、读取xlsx文件</strong></p> 
<p><strong>加载工作簿</strong></p> 
<p>使用<code>openpyxl.load_workbook()</code>函数来加载一个已经存在的xlsx文件：</p> 
<pre><code class="language-python">from openpyxl import load_workbook  
  
workbook = load_workbook('example.xlsx')</code></pre> 
<p><strong>获取工作表</strong></p> 
<p>一个Excel文件可以包含多个工作表（Sheet），通过<code>workbook.sheetnames</code>可以获取所有工作表的名称列表，通过<code>workbook[sheet_name]</code>或<code>workbook.active</code>可以获取对应的工作表对象。</p> 
<pre><code class="language-python">sheet_names = workbook.sheetnames  # 获取所有工作表名称  
sheet = workbook['Sheet1']  # 获取名为'Sheet1'的工作表  
# 或者使用active属性获取活动工作表  
active_sheet = workbook.active</code></pre> 
<p><strong>读取单元格数据</strong></p> 
<p>通过工作表的<code>cell()</code>方法或直接使用单元格坐标，可以读取单元格的数据。</p> 
<pre><code class="language-python"># 使用cell()方法  
cell_value = sheet.cell(row=1, column=1).value  # 读取第一行第一列的数据  
  
# 使用单元格坐标  
cell_value = sheet['A1'].value  # 同样读取第一行第一列的数据</code></pre> 
<p><strong>遍历工作表数据</strong></p> 
<p>如果需要遍历整个工作表的数据，可以使用<code>iter_rows()</code>或<code>iter_cols()</code>方法。</p> 
<pre><code class="language-python">for row in sheet.iter_rows(values_only=True):  
    print(row)  # 打印每一行的数据</code></pre> 
<p><strong>三、写入xlsx文件</strong></p> 
<p><strong>创建工作簿和工作表</strong></p> 
<p>使用<code>openpyxl.Workbook()</code>可以创建一个新的工作簿，并默认创建一个活动工作表。</p> 
<pre><code class="language-python">from openpyxl import Workbook  
  
workbook = Workbook()  
sheet = workbook.active</code></pre> 
<p><strong>写入单元数据</strong></p> 
<p>与读取单元格数据类似，可以使用<code>cell()</code>方法或直接使用单元格坐标来写入数据。</p> 
<pre><code class="language-python">sheet['A1'] = 'Hello'  # 在第一行第一列写入'Hello'  
sheet.cell(row=2, column=2, value='World')  # 在第二行第二列写入'World'</code></pre> 
<p><strong>保存工作簿</strong></p> 
<p>使用<code>workbook.save()</code>方法将修改后的工作簿保存到文件。</p> 
<pre><code class="language-python">workbook.save('output.xlsx')  # 将工作簿保存为output.xlsx文件</code></pre> 
<p><strong>四、注意事项</strong></p> 
<ul><li>在读取和写入xlsx文件时，注意文件的路径和名称是否正确。</li><li>如果需要处理大量数据，建议使用pandas库来处理Excel文件，它提供了更强大和灵活的数据处理能力。</li><li><code>openpyxl</code>库主要用于处理<code>.xlsx</code>格式的文件，如果需要处理<code>.xls</code>格式的文件，可以使用<code>xlrd</code>和<code>xlwt</code>库。</li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4b65b4f2cbb103b521fe05a26a42afdc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【MySQL学习】MySQL的慢查询日志和错误日志</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/860fdfbd4e4233ab781c4fae40bb16fb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">three.js零基础入门超全超细的教程整理（一）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>