<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C语言全网最全sscanf函数用法，没有的评论区提，随时更新 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/ee99fca0b5a0caaa356973b8b43ddf64/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="C语言全网最全sscanf函数用法，没有的评论区提，随时更新">
  <meta property="og:description" content="本教程分初级、进阶、实战用例，有基础的直接跳到后面吧。本文主要拿AT指令做例子。写得不好别喷，合理的要求可以提出来我尽力改。 本教程应该足以面对大部分的解析。
最后部分主要是实战为主。各位有想解析的字符串可以放到评论区，比较经典的我会放到文章里。
一、函数原型解析 直接看以下：
#include &lt;stdio.h&gt; /* 引用这个标准的头文件 */ /** * @function: sscanf * @brief C语言格式化输入函数，可用作解析字符串中的参数。 * @param {char} *str: 源字符串，也就是要被解析的字符串。 * @param {char} *format: 解析格式。 * @param {...} 要取出的值，要取几个？要取什么类型的？排好队，一个一个来 * @return {int} 返回int类型，返回值代表解析了几个值。 */ int sscanf(const char *str, const char *format, ...); 二、初级用法 这里包含了最基础的%s, %d, %f的用法。你想取出什么类型的值就用什么类型的方法。新手一定一定要注意格式！
1. 取字符串 %s 这里会把你输入的 AT&#43;COM= 过滤掉，取出后面的所有字符串。
/* * @Author: Troubadour 2276791354@qq.com * @Date: 2024-04-20 19:47:51 * @LastEditors: Troubadour 2276791354@qq.com * @LastEditTime: 2024-04-20 20:10:09 * @Version: * @Description: */ #include &lt;stdio.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-14T11:19:09+08:00">
    <meta property="article:modified_time" content="2024-05-14T11:19:09+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C语言全网最全sscanf函数用法，没有的评论区提，随时更新</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p></p> 
<p>        本教程分初级、进阶、实战用例，有基础的直接跳到后面吧。本文主要拿AT指令做例子。写得不好别喷，合理的要求可以提出来我尽力改。 本教程应该足以面对大部分的解析。</p> 
<p>        最后部分主要是实战为主。各位有想解析的字符串可以放到评论区，比较经典的我会放到文章里。</p> 
<h2>一、函数原型解析</h2> 
<p>        直接看以下：</p> 
<pre><code class="language-cpp">#include &lt;stdio.h&gt;  /* 引用这个标准的头文件 */

/**
 * @function: sscanf
 * @brief C语言格式化输入函数，可用作解析字符串中的参数。
 * @param {char} *str: 源字符串，也就是要被解析的字符串。
 * @param {char} *format: 解析格式。
 * @param {...} 要取出的值，要取几个？要取什么类型的？排好队，一个一个来
 * @return {int} 返回int类型，返回值代表解析了几个值。
 */
int sscanf(const char *str, const char *format, ...);</code></pre> 
<p></p> 
<h2>二、初级用法</h2> 
<p>        这里包含了最基础的%s, %d, %f的用法。你想取出什么类型的值就用什么类型的方法。新手一定一定要注意格式！</p> 
<h5>1. 取字符串 %s</h5> 
<p>        这里会把你输入的   AT+COM=  过滤掉，取出后面的所有字符串。</p> 
<pre><code class="language-cpp">/*
 * @Author: Troubadour 2276791354@qq.com
 * @Date: 2024-04-20 19:47:51
 * @LastEditors: Troubadour 2276791354@qq.com
 * @LastEditTime: 2024-04-20 20:10:09
 * @Version:
 * @Description:
 */

#include &lt;stdio.h&gt;

#define STR     "AT+COM=aabbcc"

void main(void)
{
    int result = 0;
    char str_para1[50] = {0};

    result = sscanf(STR, "AT+COM=%s", str_para1);
    printf("result------&gt; %d \r\n", result);
    printf("parameter1--&gt; %s \r\n", str_para1);
}
</code></pre> 
<p>        输出：</p> 
<pre><code class="language-cpp">result------&gt; 1 
parameter1--&gt; aabbcc</code></pre> 
<p>        如果你想只取指定数量的字符串，比如3个两个字符串：</p> 
<pre><code class="language-cpp">sscanf("AT+COM=aabbcc", "AT+COM=%3s", str_para1);</code></pre> 
<p>        输出：</p> 
<pre><code class="language-cpp">result------&gt; 1 
parameter1--&gt; aab</code></pre> 
<h5></h5> 
<h5>2. 取整形 %d  或者  %ld。</h5> 
<p>        这里会把你输入的   AT+COM=  过滤掉，取出后面的整形。</p> 
<p>        注意！整形和浮点型这种不是类型的要加取地址符 ‘&amp;’，因为要给你的参数赋值。另外，如果你想取出来的值放在非int类型的变量上，比如单片机常用的uint8_t    uint16_t  uint32_t 这种，不要直接读，程序容易跑飞！</p> 
<pre><code class="language-cpp">/*
 * @Author: Troubadour 2276791354@qq.com
 * @Date: 2024-04-20 19:47:51
 * @LastEditors: Troubadour 2276791354@qq.com
 * @LastEditTime: 2024-04-20 20:10:09
 * @Version:
 * @Description:
 */

#include &lt;stdio.h&gt;

#define STR     "AT+COM=123456,111222333"

void main(void)
{
    int result = 0;
    int para1 = 0;
    long long para2 = 0;

    result = sscanf(STR, "AT+COM=%d,%ld", &amp;para1, &amp;para2);
    printf("result------&gt; %d \r\n", result);
    printf("parameter1--&gt; %d \r\n", para1);
    printf("parameter2--&gt; %ld \r\n", para2);
}
</code></pre> 
<p>输出：</p> 
<pre><code class="language-cpp">result------&gt; 2 
parameter1--&gt; 123456 
parameter2--&gt; 111222333</code></pre> 
<p>        <strong>其它整形类型变量读取方法：</strong></p> 
<pre><code class="language-cpp">/*
 * @Author: Troubadour 2276791354@qq.com
 * @Date: 2024-04-20 19:47:51
 * @LastEditors: Troubadour 2276791354@qq.com
 * @LastEditTime: 2024-04-20 20:35:41
 * @Version:
 * @Description:
 */

#include &lt;stdio.h&gt;

#define STR     "AT+COM=11,22"
typedef unsigned char		uint8_t;
typedef unsigned short		uint16_t;

void main(void)
{
    int result = 0;
    int para1 = 0;
    int para2 = 0;
    uint8_t value1 = 0;
    uint16_t value2 = 0;

    result = sscanf(STR, "AT+COM=%d,%ld", &amp;para1, &amp;para2);

    value1 = (uint8_t)para1;
    value2 = (uint16_t)para2;

    printf("result------&gt; %d \r\n", result);
    printf("parameter1--&gt; %d \r\n", para1);
    printf("parameter2--&gt; %ld \r\n", para2);
    printf("value1------&gt; %d \r\n", value1);
    printf("value2------&gt; %ld \r\n", value2);
}
</code></pre> 
<p>输出：</p> 
<pre><code class="language-cpp">result------&gt; 2 
parameter1--&gt; 11
parameter2--&gt; 22
value1------&gt; 11
value2------&gt; 22</code></pre> 
<h4></h4> 
<h5>3. 取浮点型形 %f，建议用%lf。</h5> 
<p>        这里会把你输入的   AT+COM=  过滤掉，取出后面的浮点型。</p> 
<p>        不建议使用float，原因精度差，不信且看例子。非要用或者某些原因限制，那你把值读出来再强制类型转成float，比如将下面para2强制类型转换成float：para1 = (float)para2;</p> 
<pre><code class="language-cpp">/*
 * @Author: Troubadour 2276791354@qq.com
 * @Date: 2024-04-20 19:47:51
 * @LastEditors: Troubadour 2276791354@qq.com
 * @LastEditTime: 2024-04-20 20:20:31
 * @Version:
 * @Description:
 */

#include &lt;stdio.h&gt;

#define STR     "AT+COM=1234.123456,222333.444555666"

void main(void)
{
    int result = 0;
    float para1 = 0;    /* 精度差，建议用 double */
    double para2 = 0;

    result = sscanf(STR, "AT+COM=%f,%lf", &amp;para1, &amp;para2);
    printf("result------&gt; %d \r\n", result);
    printf("parameter1--&gt; %f \r\n", para1);
    printf("parameter2--&gt; %.10f \r\n", para2);
}
</code></pre> 
<p>输出：</p> 
<pre><code class="language-cpp">result------&gt; 2 
parameter1--&gt; 1234.123413       
parameter2--&gt; 222333.4445556660</code></pre> 
<h5>4. 其它格式：</h5> 
<pre><code class="language-cpp">%c 一个单一的字符  
%d 一个十进制整数  
%i 一个整数  
%e, %f, %g 一个浮点数  
%o 一个八进制数  
%s 一个字符串  
%x 一个十六进制数  
%p 一个指针  
%n 一个等于读取字符数量的整数  
%u 一个无符号整数  
%[ ] 一个字符集 （正则就使用这个，而且仅支持贪婪模式，能匹配个多少就匹配多少个） 
%% 一个精度符</code></pre> 
<p></p> 
<h2>三、进阶用法字符集： %[]</h2> 
<h4>1. 字符串取值限定用法</h4> 
<p>        懂点基础了可以看点稍微复杂点的了。现在开始使用一些特殊符号。先来个  %[^,] 用法。</p> 
<ul><li>%：读取一个或多个。</li><li>[]：表示开始一个扫描集（scan set）。扫描集用于匹配一系列字符中的任何一个字符。</li><li>^：表示在扫描集中，^字符用作否定前缀。例如: <span style="color:#ad720d;">[^A]</span> 表示匹配直到遇见字符A停止（匹配出来的字符串不包字符A）。又例如:<span style="color:#b95514;"> [^,] </span>表示匹配直到遇见逗号,停止（匹配出来的字符串不包逗号,）。</li></ul> 
<p>        例如，现在有这么一串字符串，取出后面的所有值。</p> 
<pre><code class="language-cpp">AT+COM=aabbcc,1234,12.34</code></pre> 
<pre><code class="language-cpp">/* 输入 */
sscanf("AT+COM=aabbcc,1234,12.34", "AT+COM=%[^,],%d,%lf", para1, &amp;para2, &amp;para3);
/* 输出 */
aabbcc
1234
12.340000</code></pre> 
<p>如果是空格作为间隔，则使用：</p> 
<pre><code class="language-cpp">/* 输入 */
sscanf("AT+COM=aabbcc 1234 12.34", "AT+COM=%[^ ] %d %lf", para1, &amp;para2, &amp;para3);
/* 输出 */
aabbcc
1234
12.340000</code></pre> 
<p><strong>为什么不能用%s，以下错误示范！！！</strong></p> 
<pre><code class="language-cpp">/* 输入 */
sscanf("AT+COM=aabbcc,1234,12.34", "AT+COM=%s,%d,%lf", para1, &amp;para2, &amp;para3);
/* 输出 */
aabbcc,1234,12.34
0
0.000000</code></pre> 
<h4>2. 使用 * 号忽略某个值或者忽略某种类型</h4> 
<p>        取值时把%[^,]改成%*[^,]可以忽略这个字符串，这时输出只有整形和浮点型</p> 
<pre><code class="language-cpp">/* 输入 */
sscanf("AT+COM=aabbcc,1234,12.34", "AT+COM=%*[^,],%d,%lf", &amp;para2, &amp;para3);
/* 输出 */
1234
12.340000</code></pre> 
<p>         把%d改成%*d可以再忽略一个整形，这时输出只有浮点型</p> 
<pre><code class="language-cpp">/* 输入 */
sscanf("AT+COM=aabbcc,1234,12.34", "AT+COM=%*[^,],%*d,%lf", &amp;para3);
/* 输出 */
12.340000</code></pre> 
<h4>3. 取出限定的字符</h4> 
<p>        在中括号 [] 放入想要匹配的几个字符，符合条件就会读取。</p> 
<pre><code class="language-cpp">/* 输入 */
sscanf("AT+COM=abc,1234,12.34", "AT+COM=%[abcdef],%d,%lf", para1, &amp;para2, &amp;para3);
/* 输出 */
abc 
1234 
12.340000</code></pre> 
<p>         匹配所有的小写字母%[a-z]</p> 
<pre><code class="language-cpp">/* 输入 */
sscanf("AT+COM=abcuehwiuh,1234,12.34", "AT+COM=%[a-z],%d,%lf", para1, &amp;para2, &amp;para3);
/* 输出 */
abcuehwiuh
1234
12.340000</code></pre> 
<p>          加上A-Z可以匹配所有的大小写字母。</p> 
<pre><code class="language-cpp">/* 输入 */
sscanf("AT+COM=AAabcuehwiuh,1234,12.34", "AT+COM=%[a-zA-Z],%d,%lf", para1, &amp;para2, &amp;para3);
/* 输出 */
AAabcuehwiuh 
1234 
12.340000</code></pre> 
<p>        匹配所有的数字%[0-9]。注意，这里匹配出来的是还是字符串，不是整形！</p> 
<pre><code class="language-cpp">/* 输入 */
sscanf("AT+COM=01238889,1234,12.34", "AT+COM=%[0-9],%d,%lf", para1, &amp;para2, &amp;para3);
/* 输出 */
01238889 
1234 
12.340000</code></pre> 
<p>        三种其实可以整合到一起，取出不含特殊符号的字符串</p> 
<pre><code class="language-cpp">/* 输入 */
sscanf("AT+COM=AAabcuehwiuh123,1234,12.34", "AT+COM=%[a-zA-Z0-9],%d,%lf", para1, &amp;para2, &amp;para3);
/* 输出 */
AAabcuehwiuh123 
1234
12.340000</code></pre> 
<p>         匹配一些含特殊符号的字符串，这里注意，如果你想匹配符号 - 需要放到最后面，不然就出错匹配不了，这是一个非常特殊的符号。</p> 
<pre><code class="language-cpp">/* 输入 */
sscanf("AT+COM=***+-{}##$$,1234,12.34", "AT+COM=%[*+{}$# -],%d,%lf", para1, &amp;para2, &amp;para3);
/* 输出 */
***+-{}##$$ 
1234 
12.340000</code></pre> 
<h2>四、高阶用法：</h2> 
<p>        这里主要是实战为主。</p> 
<h4>1. 解析时间日期</h4> 
<pre><code class="language-cpp">/* 输入 */
result = sscanf("2024-04-20 Sat 22:00:01", "%d-%d-%d %3[^ ] %d:%d:%d",
        &amp;year, &amp;mon, &amp;day, week, &amp;hour, &amp;min, &amp;sec);
/* 输出 */
result------&gt; 7 
2024 
4
20
Sat
22
0
1</code></pre> 
<h4>2.前面带乱码的情况下过滤并读取</h4> 
<p>        主要使用%*[^A]的方法一个一个过滤，如果一般过滤到第3个也就差不多了。</p> 
<pre><code class="language-cpp">/* 输入 */
result = sscanf("xxxLuanMaxxxA  AT+COM=Time,12:20:53\r\n",
                "%*[^A]%*[^T]%*[^+]+COM=%10[^,],%d:%d:%d",
                type, &amp;hour, &amp;min, &amp;sec);
/* 输出 */
result------&gt; 4 
Time 
12
20
53</code></pre> 
<p></p> 
<p>如果你有复杂解析不了的字符串，欢迎评论区发出来，我会挑一些经典的放进文章。</p> 
<p>持续更新.............</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9e26db1815d6a7f66f00128569c3279a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Spring AI项目Open AI绘画开发指导</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f8526d498508caf96f7576939b25ed4f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Android 高德地图 添加 天地图 卫星瓦片图片（解决高德地图部分地区放大后无卫星图片问题）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>