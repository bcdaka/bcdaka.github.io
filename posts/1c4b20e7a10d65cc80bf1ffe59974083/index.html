<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【Python】—— 文本分析 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/1c4b20e7a10d65cc80bf1ffe59974083/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【Python】—— 文本分析">
  <meta property="og:description" content="🌟欢迎来到 我的博客 —— 探索技术的无限可能！
🌟博客的简介（文章目录）
文本分析 相关知识1. 文本数据处理2. 文本可视化3. Python编程4. 词频统计5. 人名提取6. 自然段划分7. 人物出现频率分布分析8. 词云生成 实验内容数据下载地址1.对纯英文小说进行分析。2.对中文小说进行分析。 问题与解决附录1.对纯英文小说进行分析。2.对中文小说进行分析。 相关知识 当涉及到文本数据处理和可视化的任务时，我们可以通过了解下面的知识和使用Python的一些主要库和工具来完成这些任务。
1. 文本数据处理 包括读取文本文件、对文本进行分词、去除停用词等基本文本处理步骤。
读取文本文件：在Python中，我们使用open函数打开文件，指定文件名、打开模式（这里是’r’表示读取）、以及字符编码（通常是’utf-8’）。 with open(&#39;filename.txt&#39;, &#39;r&#39;, encoding=&#39;utf-8&#39;) as file: text_data = file.read() 分词和去除停用词：使用Natural Language Toolkit（NLTK）库进行分词和去除停用词。分词是将文本拆分成单词的过程，而停用词是指那些在文本中频繁出现但没有实际含义的词汇，可以通过NLTK提供的停用词列表进行去除。 from nltk.corpus import stopwords from nltk.tokenize import word_tokenize stop_words = set(stopwords.words(&#39;english&#39;)) words = word_tokenize(text_data) filtered_words = [word.lower() for word in words if word.isalpha() and word.lower() not in stop_words] 2. 文本可视化 通过词云制作实现文本数据的可视化呈现。
使用wordcloud生成词云图：WordCloud是一个用于生成词云图的库，它根据文本中单词的频率生成具有可视化效果的图形。在示例代码中，我们通过WordCloud生成词云图，并使用matplotlib展示。 from wordcloud import WordCloud import matplotlib.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-07T18:13:19+08:00">
    <meta property="article:modified_time" content="2024-05-07T18:13:19+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Python】—— 文本分析</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p><font size="4"> 🌟<strong>欢迎来到</strong> <strong><a href="https://blog.csdn.net/m0_53054984?type=blog">我的博客</a></strong> —— 探索技术的无限可能！</font></p> 
 <br> 
 <p>🌟<font size="3"><a href="https://blog.csdn.net/m0_53054984/article/details/135387479?spm=1001.2014.3001.5502">博客的简介（文章目录）</a></font></p> 
</blockquote> 
<p></p> 
<div class="toc"> 
 <h4>文本分析</h4> 
 <ul><li><a href="#_8" rel="nofollow">相关知识</a></li><li><ul><li><a href="#1__10" rel="nofollow">1. 文本数据处理</a></li><li><a href="#2__32" rel="nofollow">2. 文本可视化</a></li><li><a href="#3_Python_106" rel="nofollow">3. Python编程</a></li><li><a href="#4__110" rel="nofollow">4. 词频统计</a></li><li><a href="#5__120" rel="nofollow">5. 人名提取</a></li><li><a href="#6__135" rel="nofollow">6. 自然段划分</a></li><li><a href="#7__147" rel="nofollow">7. 人物出现频率分布分析</a></li><li><a href="#8__156" rel="nofollow">8. 词云生成</a></li></ul> 
  </li><li><a href="#_170" rel="nofollow">实验内容</a></li><li><ul><li><a href="#_171" rel="nofollow">数据下载地址</a></li><li><a href="#1_173" rel="nofollow">1.对纯英文小说进行分析。</a></li><li><a href="#2_194" rel="nofollow">2.对中文小说进行分析。</a></li></ul> 
  </li><li><a href="#_236" rel="nofollow">问题与解决</a></li><li><a href="#_257" rel="nofollow">附录</a></li><li><ul><li><a href="#1_259" rel="nofollow">1.对纯英文小说进行分析。</a></li><li><a href="#2_302" rel="nofollow">2.对中文小说进行分析。</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_8"></a>相关知识</h2> 
<p>      当涉及到文本数据处理和可视化的任务时，我们可以通过了解下面的知识和使用Python的一些主要库和工具来完成这些任务。</p> 
<h3><a id="1__10"></a>1. 文本数据处理</h3> 
<p>      包括读取文本文件、对文本进行分词、去除停用词等基本文本处理步骤。</p> 
<ul><li>读取文本文件：</li><li>在Python中，我们使用open函数打开文件，指定文件名、打开模式（这里是’r’表示读取）、以及字符编码（通常是’utf-8’）。</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'filename.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
    text_data <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>分词和去除停用词：</li><li>使用Natural Language Toolkit（NLTK）库进行分词和去除停用词。分词是将文本拆分成单词的过程，而停用词是指那些在文本中频繁出现但没有实际含义的词汇，可以通过NLTK提供的停用词列表进行去除。</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">from</span> nltk<span class="token punctuation">.</span>corpus <span class="token keyword">import</span> stopwords
<span class="token keyword">from</span> nltk<span class="token punctuation">.</span>tokenize <span class="token keyword">import</span> word_tokenize

stop_words <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span>stopwords<span class="token punctuation">.</span>words<span class="token punctuation">(</span><span class="token string">'english'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

words <span class="token operator">=</span> word_tokenize<span class="token punctuation">(</span>text_data<span class="token punctuation">)</span>
filtered_words <span class="token operator">=</span> <span class="token punctuation">[</span>word<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> word <span class="token keyword">in</span> words <span class="token keyword">if</span> word<span class="token punctuation">.</span>isalpha<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">and</span> word<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">not</span> <span class="token keyword">in</span> stop_words<span class="token punctuation">]</span>
</code></pre> 
<h3><a id="2__32"></a>2. 文本可视化</h3> 
<p>      通过词云制作实现文本数据的可视化呈现。</p> 
<ul><li>使用wordcloud生成词云图：</li><li>WordCloud是一个用于生成词云图的库，它根据文本中单词的频率生成具有可视化效果的图形。在示例代码中，我们通过WordCloud生成词云图，并使用matplotlib展示。</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">from</span> wordcloud <span class="token keyword">import</span> WordCloud
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

wordcloud <span class="token operator">=</span> WordCloud<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>generate<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>filtered_words<span class="token punctuation">)</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>wordcloud<span class="token punctuation">,</span> interpolation<span class="token operator">=</span><span class="token string">'bilinear'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">"off"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<hr> 
<p>使用 <code>wordcloud</code> 库生成词云图的过程主要分为以下几个步骤：</p> 
<ol><li> <p>安装 <code>wordcloud</code> 库：<br>       在命令行或终端中运行以下命令安装 <code>wordcloud</code>：</p> <pre><code class="prism language-bash">pip <span class="token function">install</span> wordcloud
</code></pre> </li><li> <p>导入库：</p> <pre><code class="prism language-python"><span class="token keyword">from</span> wordcloud <span class="token keyword">import</span> WordCloud
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
</code></pre> </li><li> <p>准备文本数据：<br>       获取需要生成词云的文本数据，确保文本数据是字符串形式。</p> </li><li> <p>创建 <code>WordCloud</code> 对象并生成词云：</p> <pre><code class="prism language-python">wordcloud <span class="token operator">=</span> WordCloud<span class="token punctuation">(</span>width<span class="token operator">=</span><span class="token number">800</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">,</span> background_color<span class="token operator">=</span><span class="token string">'white'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>generate<span class="token punctuation">(</span>text_data<span class="token punctuation">)</span>
</code></pre> <p>      在这里，我们创建了一个 <code>WordCloud</code> 对象，指定了词云的宽度、高度和背景颜色。可以根据需要调整其他参数，比如字体、最大词汇量等。</p> </li><li> <p>可选步骤 - 自定义词云形状：<br>       如果你想要词云的形状为特定图形，可以使用自定义形状的图片。首先，你需要准备一张形状的图片，然后使用 <code>WordCloud</code> 的 <code>mask</code> 参数指定该图片。</p> <pre><code class="prism language-python"><span class="token keyword">from</span> wordcloud <span class="token keyword">import</span> WordCloud<span class="token punctuation">,</span> STOPWORDS<span class="token punctuation">,</span> ImageColorGenerator
<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image

<span class="token comment"># 读取形状图片</span>
mask <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"your_shape_image.png"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 使用形状图片生成词云</span>
wordcloud <span class="token operator">=</span> WordCloud<span class="token punctuation">(</span>mask<span class="token operator">=</span>mask<span class="token punctuation">,</span> background_color<span class="token operator">=</span><span class="token string">"white"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>generate<span class="token punctuation">(</span>text_data<span class="token punctuation">)</span>
</code></pre> </li><li> <p>显示或保存词云图：</p> <pre><code class="prism language-python">plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>wordcloud<span class="token punctuation">,</span> interpolation<span class="token operator">=</span><span class="token string">'bilinear'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">"off"</span><span class="token punctuation">)</span>

<span class="token comment"># 显示词云图</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 或保存词云图</span>
wordcloud<span class="token punctuation">.</span>to_file<span class="token punctuation">(</span><span class="token string">"wordcloud_output.png"</span><span class="token punctuation">)</span>
</code></pre> <p>      使用 <code>plt.show()</code> 可以在运行脚本时显示词云图，而 <code>to_file</code> 方法可以保存词云图为图片文件。<br>       总体来说，使用 <code>wordcloud</code> 库生成词云图是一个相对简单的过程，主要涉及创建 <code>WordCloud</code> 对象并调整相关参数，然后通过 <code>imshow</code> 方法显示或通过 <code>to_file</code> 方法保存生成的词云图。</p> </li></ol> 
<hr> 
<h3><a id="3_Python_106"></a>3. Python编程</h3> 
<p>      可看<a href="https://blog.csdn.net/m0_53054984/category_12524883.html">Python专栏</a><br>       要求通过Python实现上述功能，因此需要熟悉Python编程语言及其相关库和模块。</p> 
<h3><a id="4__110"></a>4. 词频统计</h3> 
<p>      对文本中各个词汇的出现频率进行统计分析。</p> 
<ul><li>使用Counter进行词频统计：</li><li>Counter是Python的一个内置库，用于统计可哈希对象的出现次数。在这里，我们使用Counter来统计文本中单词的出现频率。</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">from</span> collections <span class="token keyword">import</span> Counter
word_freq <span class="token operator">=</span> Counter<span class="token punctuation">(</span>filtered_words<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="5__120"></a>5. 人名提取</h3> 
<p>      从文本中提取人物名称，这可能需要使用一些自然语言处理（NLP）的技术或者规则来实现。</p> 
<ul><li>使用spaCy进行实体识别：</li><li>spaCy是一个自然语言处理库，它提供了实体识别功能，可以用于从文本中提取人名等实体。在示例代码中，我们加载了英文的spaCy模型，并使用它来获取文本中的人物名称。</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">import</span> spacy

nlp <span class="token operator">=</span> spacy<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">'en_core_web_sm'</span><span class="token punctuation">)</span>
doc <span class="token operator">=</span> nlp<span class="token punctuation">(</span>text_data<span class="token punctuation">)</span>

person_names <span class="token operator">=</span> <span class="token punctuation">[</span>ent<span class="token punctuation">.</span>text <span class="token keyword">for</span> ent <span class="token keyword">in</span> doc<span class="token punctuation">.</span>ents <span class="token keyword">if</span> ent<span class="token punctuation">.</span>label_ <span class="token operator">==</span> <span class="token string">'PERSON'</span><span class="token punctuation">]</span>
</code></pre> 
<h3><a id="6__135"></a>6. 自然段划分</h3> 
<p>      将文本划分成自然段，可能涉及到对文本的分段或分句处理。</p> 
<ul><li>使用正则表达式进行自然段划分：</li><li>正则表达式是一种强大的文本匹配工具，可以根据特定的模式来划分文本。在这里，我们使用\n\n来划分自然段，表示两个换行符之间的文本。</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">import</span> re

paragraphs <span class="token operator">=</span> re<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n\n'</span><span class="token punctuation">,</span> text_data<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="7__147"></a>7. 人物出现频率分布分析</h3> 
<p>      分析文本中人物出现的频率分布情况，可以通过统计每个人物在文本中出现的次数来实现。</p> 
<ul><li>统计人物出现频率：</li><li>通过使用Counter，我们可以轻松地统计从文本中提取的人物名称的出现频率，从而进行人物出现频率分布分析。</li></ul> 
<pre><code class="prism language-python">character_freq <span class="token operator">=</span> Counter<span class="token punctuation">(</span>person_names<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="8__156"></a>8. 词云生成</h3> 
<p>      使用wordcloud模块生成词云图，这需要将词频等信息传递给词云模块，并对生成的图像进行一定的定制。<br> 综合来看，这涉及到文本处理、数据统计、可视化和一定的自然语言处理方面的知识和技能。</p> 
<ul><li>定制词云图：</li><li>在生成词云图时，可以通过调整WordCloud的参数来定制图形的外观，包括图像的大小、背景颜色等。示例代码中展示了如何设置词云的宽度、高度和背景颜色。</li></ul> 
<pre><code class="prism language-python">wordcloud <span class="token operator">=</span> WordCloud<span class="token punctuation">(</span>width<span class="token operator">=</span><span class="token number">800</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">,</span> background_color<span class="token operator">=</span><span class="token string">'white'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>generate_from_frequencies<span class="token punctuation">(</span>word_freq<span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>wordcloud<span class="token punctuation">,</span> interpolation<span class="token operator">=</span><span class="token string">'bilinear'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">"off"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="_170"></a>实验内容</h2> 
<h3><a id="_171"></a>数据下载地址</h3> 
<p>       <a href="https://download.csdn.net/download/m0_53054984/88629430">文本分析所用小说（数据）</a></p> 
<h3><a id="1_173"></a>1.对纯英文小说进行分析。</h3> 
<p>主要步骤如下：<br>       下载一篇纯英文小说，保存为txt文档。<br>       打开小说文件，通过对字符串的处理（注意统计中要去掉各种标点符号，除英文以外的内容。），统计小说中所有英文单词的使用频次，结果保存在一个字典中。<br>       对字典中的数据进行排序，按照使用频次从高到低进行排序，并把统计结果写到一个文本文件中。<br>       把单词的使用频次的信息用词云的方式显示出来。</p> 
<p>小说文件截图（处理小说源文件）：<br> <img src="https://images2.imgbox.com/29/27/F0pLyZzj_o.png" alt="在这里插入图片描述"></p> 
<p>代码截图：<br> <img src="https://images2.imgbox.com/c8/32/32A5xKQf_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/01/6c/JRNoqqPy_o.png" alt="在这里插入图片描述"><br> 运行结果（词云）：<br> <img src="https://images2.imgbox.com/e9/66/FjDZEo1B_o.png" alt="在这里插入图片描述"></p> 
<p>生成词典并排序截图：<br> <img src="https://images2.imgbox.com/9e/83/SIm4dKsV_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2_194"></a>2.对中文小说进行分析。</h3> 
<p>      对于中文小说的词频统计、人名提取、自然段划分和人物出现频率分布分析，并利用wordcloud模块生成词云图。</p> 
<p>主要步骤如下：<br>       下载一篇中文小说，字数在十万字以上。使用中文分词库进行分词。统计使用最多的人名和中文词汇并输出。<br>       列出小说中的主要人物，包括主人公，以及另外相关人物5人或以上。<br>       把小说分段，分析出小说一共有多少自然段。并统计出上面列出的人物共在多少个自然段中出现。并用某种输出模式体现出这种分布情况，例如在第一段出现，输出一个字符，在第二段没有出现，输出一个空格。可以直观的看出人物出现的位置和频率。<br>       分析主人公以及其他相关人物之间的亲密度，两个人在同一个自然段同时出现亲密度加1，最后得到统计结果。<br>       把词频的统计结果用词云的方式显示出来。</p> 
<p>小说原文件截图(处理小说源文件）：</p> 
<p><img src="https://images2.imgbox.com/e7/1e/D7eykC2G_o.png" alt="在这里插入图片描述"><br> 代码截图：<br> <img src="https://images2.imgbox.com/45/e9/8DtZjBZp_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/7e/4e/D7m2FZCE_o.png" alt="在这里插入图片描述"><br> 运行结果（词云）：<br> <img src="https://images2.imgbox.com/97/99/pJ25CY9o_o.png" alt="在这里插入图片描述"><br> 段落数截图：<br> <img src="https://images2.imgbox.com/b4/38/0GzG4nu1_o.png" alt="在这里插入图片描述"><br> 细节：<br> 人物出现频率截图<br> 主角（阿龙纳斯）：<br> <img src="https://images2.imgbox.com/5e/bc/K9SAsvhx_o.png" alt="在这里插入图片描述"></p> 
<p>配角1（康赛尔）：<br> <img src="https://images2.imgbox.com/71/15/qiogzokv_o.png" alt="在这里插入图片描述"></p> 
<p>配角2（尼德•兰）：<br> <img src="https://images2.imgbox.com/98/76/SnW47DwM_o.png" alt="在这里插入图片描述"></p> 
<p>配角3（尼摩船长）：<br> <img src="https://images2.imgbox.com/d5/41/2dg1jy08_o.png" alt="在这里插入图片描述"></p> 
<p>配角4（何伯逊敬启）：<br> <img src="https://images2.imgbox.com/ec/e2/Txwrw9yV_o.png" alt="在这里插入图片描述"></p> 
<p>配角5（教授）：<br> <img src="https://images2.imgbox.com/3a/75/c5MJ4hwp_o.png" alt="在这里插入图片描述"></p> 
<p>亲密度：<br> <img src="https://images2.imgbox.com/04/81/23tjhNQB_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_236"></a>问题与解决</h2> 
<p>操作异常：在使用中文分词库<code>jieba</code>时，可能会遇到编码问题，导致分词不准确。<br> 解决方案：在打开和处理文件时，使用正确的编码格式进行操作。可以尝试使用UTF-8编码，因为它在处理中文文本时通常表现良好。</p> 
<p>操作异常：在使用<code>wordcloud</code>模块时，可能由于依赖 <abbr title="Matplotlib是一个Python中广泛使用的绘图库，可以用于创建各种类型的静态、动态或交互式图表和可视化。它提供了一系列函数和工具，使得用户可以很方便地对数据进行处理和分析，并将其以图形化的方式呈现出来。">matplotlib</abbr> 和 <abbr title="NumPy（Numeric Python）提供了许多高级的数值编程工具，如：矩阵数据类型、矢量处理，以及精密的运算库。专为进行严格的数字处理而产生。">NumPy</abbr> 的安装问题而导致出现ImportError。</p> 
<p>解决方案：可以尝试重新安装<code>matplotlib</code>和<code>numpy</code>模块，或者在虚拟环境中安装这些模块，以解决依赖库安装问题。</p> 
<p>异常问题：处理中文小说时候，因为没有安装Python和jieba分词库代码无法运行。<br> 解决方案：使用以下命令安装jieba：<code>pip install jieba</code></p> 
<p>异常问题：在处理英文小说时，代码中使用了nltk库和wordcloud库，但是用户没有提前安装这两个库，导致代码运行时报错。<br> 解决方案：用户在运行代码前应该使用以下命令安装所需的库：<code>pip install nltk</code>和<code>pip install wordcloud</code></p> 
<p>操作异常：因为没有设置中文字体路径词云图无法读出中文。<br> 解决方案：下载该文件并加入代码<code>font_path = 'zitiaozichangyinghedianshan.ttf # 设置中文字体路径</code></p> 
<h2><a id="_257"></a>附录</h2> 
<h3><a id="1_259"></a>1.对纯英文小说进行分析。</h3> 
<pre><code class="prism language-python"><span class="token comment">#英文小说单词使用频次统计和词云制作：</span>
<span class="token comment"># 导入需要的库</span>
<span class="token keyword">from</span> wordcloud <span class="token keyword">import</span> WordCloud
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> string

<span class="token comment"># 读取小说文件</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'H:/其他/小说/after twenty years.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span> <span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    novel <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 去除标点符号和数字</span>
translator <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">.</span>maketrans<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> string<span class="token punctuation">.</span>punctuation <span class="token operator">+</span> string<span class="token punctuation">.</span>digits<span class="token punctuation">)</span>
novel <span class="token operator">=</span> novel<span class="token punctuation">.</span>translate<span class="token punctuation">(</span>translator<span class="token punctuation">)</span>

<span class="token comment"># 将小说中的单词转换为小写，并按照空格分割成列表</span>
words <span class="token operator">=</span> novel<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 统计单词出现频次</span>
word_freq <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token keyword">for</span> word <span class="token keyword">in</span> words<span class="token punctuation">:</span>
    <span class="token keyword">if</span> word <span class="token keyword">in</span> word_freq<span class="token punctuation">:</span>
        word_freq<span class="token punctuation">[</span>word<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        word_freq<span class="token punctuation">[</span>word<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>

<span class="token comment"># 按照单词出现频次从高到低排序</span>
sorted_word_freq <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>word_freq<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># 将排序结果写入文件</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'H:/其他/小说/word_after twenty years.txt'</span><span class="token punctuation">,</span> <span class="token string">'w'</span> <span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    <span class="token keyword">for</span> word<span class="token punctuation">,</span> freq <span class="token keyword">in</span> sorted_word_freq<span class="token punctuation">:</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>word<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>freq<span class="token punctuation">}</span></span><span class="token string">\n'</span></span><span class="token punctuation">)</span>

<span class="token comment"># 生成词云</span>
wordcloud <span class="token operator">=</span> WordCloud<span class="token punctuation">(</span>width<span class="token operator">=</span><span class="token number">800</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">800</span><span class="token punctuation">,</span> background_color<span class="token operator">=</span><span class="token string">'white'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>generate_from_frequencies<span class="token punctuation">(</span>word_freq<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> facecolor<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>wordcloud<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span>pad<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="2_302"></a>2.对中文小说进行分析。</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> wordcloud <span class="token keyword">import</span> WordCloud
<span class="token keyword">import</span> jieba
<span class="token keyword">from</span> collections <span class="token keyword">import</span> Counter
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment"># 设置中文字体路径</span>
font_path <span class="token operator">=</span> <span class="token string">'zitiaozichangyinghedianshan.ttf'</span>

<span class="token comment"># 读取中文小说文件</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'H:/其他/小说/海底两万里.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
    chinese_novel_text <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 中文分词</span>
seg_list <span class="token operator">=</span> jieba<span class="token punctuation">.</span>lcut<span class="token punctuation">(</span>chinese_novel_text<span class="token punctuation">)</span>

<span class="token comment"># 统计词频</span>
word_counts <span class="token operator">=</span> Counter<span class="token punctuation">(</span>seg_list<span class="token punctuation">)</span>

<span class="token comment"># 将词频字典转换为单个字符串</span>
wordcloud_text <span class="token operator">=</span> <span class="token string">' '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>seg_list<span class="token punctuation">)</span>

<span class="token comment"># 生成词云</span>
wordcloud <span class="token operator">=</span> WordCloud<span class="token punctuation">(</span>width<span class="token operator">=</span><span class="token number">800</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">,</span> background_color<span class="token operator">=</span><span class="token string">'white'</span><span class="token punctuation">,</span> font_path<span class="token operator">=</span>font_path<span class="token punctuation">)</span><span class="token punctuation">.</span>generate<span class="token punctuation">(</span>wordcloud_text<span class="token punctuation">)</span>

<span class="token comment"># 显示词云图像</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>wordcloud<span class="token punctuation">,</span> interpolation<span class="token operator">=</span><span class="token string">'bilinear'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 填入小说中的主要人物，包括主人公和其他相关人物5人或以上</span>
main_characters <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"阿龙纳斯"</span><span class="token punctuation">,</span> <span class="token string">"康赛尔"</span><span class="token punctuation">,</span> <span class="token string">"尼德•兰"</span><span class="token punctuation">,</span> <span class="token string">"尼摩船长"</span><span class="token punctuation">,</span> <span class="token string">"何伯逊敬启"</span><span class="token punctuation">,</span> <span class="token string">"教授"</span><span class="token punctuation">]</span>

<span class="token comment"># 分析小说自然段</span>
paragraphs <span class="token operator">=</span> chinese_novel_text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"小说一共有{}自然段。"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>paragraphs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 列出主要人物在每个自然段的出现情况</span>
character_occurrence <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>char<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>paragraphs<span class="token punctuation">)</span> <span class="token keyword">for</span> char <span class="token keyword">in</span> main_characters<span class="token punctuation">}</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span> paragraph <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>paragraphs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> char <span class="token keyword">in</span> main_characters<span class="token punctuation">:</span>
        <span class="token keyword">if</span> char <span class="token keyword">in</span> paragraph<span class="token punctuation">:</span>
            character_occurrence<span class="token punctuation">[</span>char<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>

<span class="token comment"># 输出人物在自然段中的出现情况</span>
<span class="token keyword">for</span> char <span class="token keyword">in</span> main_characters<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{}在各自然段的出现情况："</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span><span class="token punctuation">,</span> character_occurrence<span class="token punctuation">[</span>char<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 统计主要人物之间的亲密度</span>
intimacy_matrix <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>main_characters<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>main_characters<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>main_characters<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>main_characters<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>paragraphs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> character_occurrence<span class="token punctuation">[</span>main_characters<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token keyword">and</span> character_occurrence<span class="token punctuation">[</span>main_characters<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">:</span>
                intimacy_matrix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>

<span class="token comment"># 输出亲密度矩阵</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"人物亲密度矩阵："</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> intimacy_matrix<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>

</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/508278c78ff50e3df62c6e485bc85433/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">开源模型应用落地-CodeQwen模型小试-SQL专家测试（二）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3e4837d3b1958652c3cc7e8e2b226cae/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">国内首篇！所有AI大模型一文概括！</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>