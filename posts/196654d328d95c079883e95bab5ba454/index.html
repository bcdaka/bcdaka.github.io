<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python酷库之旅-第三方库Pandas(070) - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/196654d328d95c079883e95bab5ba454/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Python酷库之旅-第三方库Pandas(070)">
  <meta property="og:description" content="目录
一、用法精讲
281、pandas.Series.dt.daysinmonth属性
281-1、语法
281-2、参数
281-3、功能
281-4、返回值
281-5、说明
281-6、用法
281-6-1、数据准备
281-6-2、代码示例
281-6-3、结果输出
282、pandas.Series.dt.tz属性
282-1、语法
282-2、参数
282-3、功能
282-4、返回值
282-5、说明
282-6、用法
282-6-1、数据准备
282-6-2、代码示例
282-6-3、结果输出
283、pandas.Series.dt.freq属性
283-1、语法
283-2、参数
283-3、功能
283-4、返回值
283-5、说明
283-6、用法
283-6-1、数据准备
283-6-2、代码示例
283-6-3、结果输出
284、pandas.Series.dt.isocalendar属性
284-1、语法
284-2、参数
284-3、功能
284-4、返回值
284-5、说明
284-6、用法
284-6-1、数据准备
284-6-2、代码示例
284-6-3、结果输出
285、pandas.Series.dt.to_period方法
285-1、语法
285-2、参数
285-3、功能
285-4、返回值
285-5、说明
285-6、用法
285-6-1、数据准备
285-6-2、代码示例
285-6-3、结果输出
二、推荐阅读
1、Python筑基之旅
2、Python函数之旅
3、Python算法之旅
4、Python魔法之旅
5、博客个人主页
一、用法精讲 281、pandas.Series.dt.daysinmonth属性 281-1、语法 # 281、pandas.Series.dt.daysinmonth属性 pandas.Series.dt.daysinmonth The number of days in the month.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-07T08:00:00+08:00">
    <meta property="article:modified_time" content="2024-08-07T08:00:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python酷库之旅-第三方库Pandas(070)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><span style="color:#1a439c;"><strong>目录</strong></span></p> 
<p id="%E4%B8%80%E3%80%81%E7%94%A8%E6%B3%95%E7%B2%BE%E8%AE%B2-toc" style="margin-left:80px;"><strong><a href="#%E4%B8%80%E3%80%81%E7%94%A8%E6%B3%95%E7%B2%BE%E8%AE%B2" rel="nofollow"><span style="color:#1a439c;">一、用法精讲</span></a></strong></p> 
<p id="5%E3%80%81pandas.DataFrame.to_csv%E5%87%BD%E6%95%B0-toc" style="margin-left:120px;"><strong><a href="#5%E3%80%81pandas.DataFrame.to_csv%E5%87%BD%E6%95%B0" rel="nofollow"><span style="color:#1a439c;">281、pandas.Series.dt.daysinmonth属性</span></a></strong></p> 
<p id="5-1%E3%80%81%E8%AF%AD%E6%B3%95-toc" style="margin-left:160px;"><strong><a href="#5-1%E3%80%81%E8%AF%AD%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">281-1、语法</span></a></strong></p> 
<p id="5-2%E3%80%81%E5%8F%82%E6%95%B0-toc" style="margin-left:160px;"><strong><a href="#5-2%E3%80%81%E5%8F%82%E6%95%B0" rel="nofollow"><span style="color:#1a439c;">281-2、参数</span></a></strong></p> 
<p id="5-3%E3%80%81%E5%8A%9F%E8%83%BD-toc" style="margin-left:160px;"><strong><a href="#5-3%E3%80%81%E5%8A%9F%E8%83%BD" rel="nofollow"><span style="color:#1a439c;">281-3、功能</span></a></strong></p> 
<p id="5-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC-toc" style="margin-left:160px;"><strong><a href="#5-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC" rel="nofollow"><span style="color:#1a439c;">281-4、返回值</span></a></strong></p> 
<p id="5-5%E3%80%81%E8%AF%B4%E6%98%8E-toc" style="margin-left:160px;"><strong><a href="#5-5%E3%80%81%E8%AF%B4%E6%98%8E" rel="nofollow"><span style="color:#1a439c;">281-5、说明</span></a></strong></p> 
<p id="241-6%E3%80%81%E7%94%A8%E6%B3%95-toc" style="margin-left:160px;"><strong><a href="#241-6%E3%80%81%E7%94%A8%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">281-6、用法</span></a></strong></p> 
<p id="10-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87-toc" style="margin-left:200px;"><strong><a href="#10-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87" rel="nofollow"><span style="color:#1a439c;">281-6-1、数据准备</span></a></strong></p> 
<p id="5-6-1%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B-toc" style="margin-left:200px;"><strong><a href="#5-6-1%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B" rel="nofollow"><span style="color:#1a439c;">281-6-2、代码示例</span></a></strong></p> 
<p id="5-6-2%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA-toc" style="margin-left:200px;"><strong><a href="#5-6-2%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA" rel="nofollow"><span style="color:#1a439c;">281-6-3、结果输出</span></a></strong></p> 
<p id="282%E3%80%81pandas.Series.dt.tz%E5%B1%9E%E6%80%A7-toc" style="margin-left:120px;"><strong><a href="#282%E3%80%81pandas.Series.dt.tz%E5%B1%9E%E6%80%A7" rel="nofollow"><span style="color:#1a439c;">282、pandas.Series.dt.tz属性</span></a></strong></p> 
<p id="282-1%E3%80%81%E8%AF%AD%E6%B3%95-toc" style="margin-left:160px;"><strong><a href="#282-1%E3%80%81%E8%AF%AD%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">282-1、语法</span></a></strong></p> 
<p id="282-2%E3%80%81%E5%8F%82%E6%95%B0-toc" style="margin-left:160px;"><strong><a href="#282-2%E3%80%81%E5%8F%82%E6%95%B0" rel="nofollow"><span style="color:#1a439c;">282-2、参数</span></a></strong></p> 
<p id="282-3%E3%80%81%E5%8A%9F%E8%83%BD-toc" style="margin-left:160px;"><strong><a href="#282-3%E3%80%81%E5%8A%9F%E8%83%BD" rel="nofollow"><span style="color:#1a439c;">282-3、功能</span></a></strong></p> 
<p id="282-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC-toc" style="margin-left:160px;"><strong><a href="#282-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC" rel="nofollow"><span style="color:#1a439c;">282-4、返回值</span></a></strong></p> 
<p id="282-5%E3%80%81%E8%AF%B4%E6%98%8E-toc" style="margin-left:160px;"><strong><a href="#282-5%E3%80%81%E8%AF%B4%E6%98%8E" rel="nofollow"><span style="color:#1a439c;">282-5、说明</span></a></strong></p> 
<p id="282-6%E3%80%81%E7%94%A8%E6%B3%95-toc" style="margin-left:160px;"><strong><a href="#282-6%E3%80%81%E7%94%A8%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">282-6、用法</span></a></strong></p> 
<p id="282-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87-toc" style="margin-left:200px;"><strong><a href="#282-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87" rel="nofollow"><span style="color:#1a439c;">282-6-1、数据准备</span></a></strong></p> 
<p id="282-6-2%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B-toc" style="margin-left:200px;"><strong><a href="#282-6-2%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B" rel="nofollow"><span style="color:#1a439c;">282-6-2、代码示例</span></a></strong></p> 
<p id="282-6-3%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA-toc" style="margin-left:200px;"><strong><a href="#282-6-3%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA" rel="nofollow"><span style="color:#1a439c;">282-6-3、结果输出</span></a></strong></p> 
<p id="283%E3%80%81pandas.Series.dt.freq%E5%B1%9E%E6%80%A7-toc" style="margin-left:120px;"><strong><a href="#283%E3%80%81pandas.Series.dt.freq%E5%B1%9E%E6%80%A7" rel="nofollow"><span style="color:#1a439c;">283、pandas.Series.dt.freq属性</span></a></strong></p> 
<p id="283-1%E3%80%81%E8%AF%AD%E6%B3%95-toc" style="margin-left:160px;"><strong><a href="#283-1%E3%80%81%E8%AF%AD%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">283-1、语法</span></a></strong></p> 
<p id="283-2%E3%80%81%E5%8F%82%E6%95%B0-toc" style="margin-left:160px;"><strong><a href="#283-2%E3%80%81%E5%8F%82%E6%95%B0" rel="nofollow"><span style="color:#1a439c;">283-2、参数</span></a></strong></p> 
<p id="283-3%E3%80%81%E5%8A%9F%E8%83%BD-toc" style="margin-left:160px;"><strong><a href="#283-3%E3%80%81%E5%8A%9F%E8%83%BD" rel="nofollow"><span style="color:#1a439c;">283-3、功能</span></a></strong></p> 
<p id="283-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC-toc" style="margin-left:160px;"><strong><a href="#283-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC" rel="nofollow"><span style="color:#1a439c;">283-4、返回值</span></a></strong></p> 
<p id="283-5%E3%80%81%E8%AF%B4%E6%98%8E-toc" style="margin-left:160px;"><strong><a href="#283-5%E3%80%81%E8%AF%B4%E6%98%8E" rel="nofollow"><span style="color:#1a439c;">283-5、说明</span></a></strong></p> 
<p id="283-6%E3%80%81%E7%94%A8%E6%B3%95-toc" style="margin-left:160px;"><strong><a href="#283-6%E3%80%81%E7%94%A8%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">283-6、用法</span></a></strong></p> 
<p id="283-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87-toc" style="margin-left:200px;"><strong><a href="#283-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87" rel="nofollow"><span style="color:#1a439c;">283-6-1、数据准备</span></a></strong></p> 
<p id="283-6-2%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B-toc" style="margin-left:200px;"><strong><a href="#283-6-2%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B" rel="nofollow"><span style="color:#1a439c;">283-6-2、代码示例</span></a></strong></p> 
<p id="283-6-3%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA-toc" style="margin-left:200px;"><strong><a href="#283-6-3%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA" rel="nofollow"><span style="color:#1a439c;">283-6-3、结果输出</span></a></strong></p> 
<p id="284%E3%80%81pandas.Series.dt.isocalendar%E5%B1%9E%E6%80%A7-toc" style="margin-left:120px;"><strong><a href="#284%E3%80%81pandas.Series.dt.isocalendar%E5%B1%9E%E6%80%A7" rel="nofollow"><span style="color:#1a439c;">284、pandas.Series.dt.isocalendar属性</span></a></strong></p> 
<p id="284-1%E3%80%81%E8%AF%AD%E6%B3%95-toc" style="margin-left:160px;"><strong><a href="#284-1%E3%80%81%E8%AF%AD%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">284-1、语法</span></a></strong></p> 
<p id="284-2%E3%80%81%E5%8F%82%E6%95%B0-toc" style="margin-left:160px;"><strong><a href="#284-2%E3%80%81%E5%8F%82%E6%95%B0" rel="nofollow"><span style="color:#1a439c;">284-2、参数</span></a></strong></p> 
<p id="284-3%E3%80%81%E5%8A%9F%E8%83%BD-toc" style="margin-left:160px;"><strong><a href="#284-3%E3%80%81%E5%8A%9F%E8%83%BD" rel="nofollow"><span style="color:#1a439c;">284-3、功能</span></a></strong></p> 
<p id="284-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC-toc" style="margin-left:160px;"><strong><a href="#284-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC" rel="nofollow"><span style="color:#1a439c;">284-4、返回值</span></a></strong></p> 
<p id="284-5%E3%80%81%E8%AF%B4%E6%98%8E-toc" style="margin-left:160px;"><strong><a href="#284-5%E3%80%81%E8%AF%B4%E6%98%8E" rel="nofollow"><span style="color:#1a439c;">284-5、说明</span></a></strong></p> 
<p id="284-6%E3%80%81%E7%94%A8%E6%B3%95-toc" style="margin-left:160px;"><strong><a href="#284-6%E3%80%81%E7%94%A8%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">284-6、用法</span></a></strong></p> 
<p id="284-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87-toc" style="margin-left:200px;"><strong><a href="#284-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87" rel="nofollow"><span style="color:#1a439c;">284-6-1、数据准备</span></a></strong></p> 
<p id="284-6-2%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B-toc" style="margin-left:200px;"><strong><a href="#284-6-2%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B" rel="nofollow"><span style="color:#1a439c;">284-6-2、代码示例</span></a></strong></p> 
<p id="284-6-3%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA-toc" style="margin-left:200px;"><strong><a href="#284-6-3%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA" rel="nofollow"><span style="color:#1a439c;">284-6-3、结果输出</span></a></strong></p> 
<p id="285%E3%80%81pandas.Series.dt.to_period%E6%96%B9%E6%B3%95-toc" style="margin-left:120px;"><strong><a href="#285%E3%80%81pandas.Series.dt.to_period%E6%96%B9%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">285、pandas.Series.dt.to_period方法</span></a></strong></p> 
<p id="285-1%E3%80%81%E8%AF%AD%E6%B3%95-toc" style="margin-left:160px;"><strong><a href="#285-1%E3%80%81%E8%AF%AD%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">285-1、语法</span></a></strong></p> 
<p id="285-2%E3%80%81%E5%8F%82%E6%95%B0-toc" style="margin-left:160px;"><strong><a href="#285-2%E3%80%81%E5%8F%82%E6%95%B0" rel="nofollow"><span style="color:#1a439c;">285-2、参数</span></a></strong></p> 
<p id="285-3%E3%80%81%E5%8A%9F%E8%83%BD-toc" style="margin-left:160px;"><strong><a href="#285-3%E3%80%81%E5%8A%9F%E8%83%BD" rel="nofollow"><span style="color:#1a439c;">285-3、功能</span></a></strong></p> 
<p id="285-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC-toc" style="margin-left:160px;"><strong><a href="#285-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC" rel="nofollow"><span style="color:#1a439c;">285-4、返回值</span></a></strong></p> 
<p id="285-5%E3%80%81%E8%AF%B4%E6%98%8E-toc" style="margin-left:160px;"><strong><a href="#285-5%E3%80%81%E8%AF%B4%E6%98%8E" rel="nofollow"><span style="color:#1a439c;">285-5、说明</span></a></strong></p> 
<p id="285-6%E3%80%81%E7%94%A8%E6%B3%95-toc" style="margin-left:160px;"><strong><a href="#285-6%E3%80%81%E7%94%A8%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">285-6、用法</span></a></strong></p> 
<p id="285-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87-toc" style="margin-left:200px;"><strong><a href="#285-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87" rel="nofollow"><span style="color:#1a439c;">285-6-1、数据准备</span></a></strong></p> 
<p id="285-6-2%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B-toc" style="margin-left:200px;"><strong><a href="#285-6-2%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B" rel="nofollow"><span style="color:#1a439c;">285-6-2、代码示例</span></a></strong></p> 
<p id="285-6-3%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA-toc" style="margin-left:200px;"><strong><a href="#285-6-3%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA" rel="nofollow"><span style="color:#1a439c;">285-6-3、结果输出</span></a></strong></p> 
<p id="%E4%BA%94%E3%80%81%E6%8E%A8%E8%8D%90%E9%98%85%E8%AF%BB-toc" style="margin-left:80px;"><strong><a href="#%E4%BA%94%E3%80%81%E6%8E%A8%E8%8D%90%E9%98%85%E8%AF%BB" rel="nofollow"><span style="color:#1a439c;">二、推荐阅读</span></a></strong></p> 
<p id="1%E3%80%81-toc" style="margin-left:120px;"><strong><a href="#1%E3%80%81" rel="nofollow"><span style="color:#1a439c;">1、Python筑基之旅</span></a></strong></p> 
<p id="2%E3%80%81-toc" style="margin-left:120px;"><strong><a href="#2%E3%80%81" rel="nofollow"><span style="color:#1a439c;">2、Python函数之旅</span></a></strong></p> 
<p id="3%E3%80%81-toc" style="margin-left:120px;"><strong><a href="#3%E3%80%81" rel="nofollow"><span style="color:#1a439c;">3、Python算法之旅</span></a></strong></p> 
<p id="4%E3%80%81-toc" style="margin-left:120px;"><strong><a href="#4%E3%80%81" rel="nofollow"><span style="color:#1a439c;">4、Python魔法之旅</span></a></strong></p> 
<p id="5%E3%80%81%C2%A0-toc" style="margin-left:120px;"><strong><a href="#5%E3%80%81%C2%A0" rel="nofollow"><span style="color:#1a439c;">5、博客个人主页</span></a></strong></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/66/42/JQPmIV1I_o.gif"></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/8b/3e/VmToVvLi_o.png"></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/93/17/ofvx3zzI_o.gif"></p> 
<h4 id="%E4%B8%80%E3%80%81%E7%94%A8%E6%B3%95%E7%B2%BE%E8%AE%B2">一、用法精讲</h4> 
<h5 id="5%E3%80%81pandas.DataFrame.to_csv%E5%87%BD%E6%95%B0">281、<span style="color:#fe2c24;">pandas.Series.dt.daysinmonth</span>属性</h5> 
<h6 id="5-1%E3%80%81%E8%AF%AD%E6%B3%95">281-1、语法</h6> 
<pre><code class="language-python"># 281、pandas.Series.dt.daysinmonth属性
pandas.Series.dt.daysinmonth
The number of days in the month.</code></pre> 
<h6 id="5-2%E3%80%81%E5%8F%82%E6%95%B0">281-2、参数</h6> 
<p>        无</p> 
<h6 id="5-3%E3%80%81%E5%8A%9F%E8%83%BD">281-3、功能</h6> 
<p>        用于返回一个包含每个日期对应月份的天数的序列，这在时间序列分析中尤其有用，比如需要计算每个月的总天数时，或在处理日期数据时，需要知道某个月有多少天来进行一些特定的操作或分析，具备同样功能的还有<span style="color:#fe2c24;"><strong>pandas.Series.dt.days_in_month</strong></span>属性。</p> 
<h6 id="5-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC">281-4、返回值</h6> 
<p>        返回每个时间戳所对应月份的天数，其返回值是一个包含每个时间戳所在月份天数的整数系列(Series)。</p> 
<h6 id="5-5%E3%80%81%E8%AF%B4%E6%98%8E">281-5、说明</h6> 
<p>        使用场景：</p> 
<p><strong>281-5-1、财务分析：</strong>确定每个月的天数对月末结算、预算编制和财务预测非常重要。例如，财务团队需要知道每个月的天数以便准确计算月度预算和实际开销。</p> 
<p><strong>281-5-2、数据完整性检查：</strong>在处理时间序列数据时，例如销售数据或传感器数据，可以使用daysinmonth确认每个月的数据是否完整，如果某个月的数据少于应有天数，可能需要进一步调查和处理。</p> 
<p><strong>281-5-3、平均日值计算：</strong>在数据分析中，经常需要将月度数据转换为平均日值。例如，在分析气象数据时，需要计算每月的平均日气温或降雨量。</p> 
<p><strong>281-5-4、时间序列转换：</strong>在某些情况下，可能需要将时间序列数据从月度转换为季度或年度数据，在这种转换过程中，需要知道每个月的天数以进行适当的加权计算。</p> 
<p><strong>281-5-5、资源规划和调度：</strong>在项目管理和资源规划中，了解每个月的天数可以帮助更好地进行资源分配和调度。例如，在人员管理中，根据每个月的天数合理分配工作量。</p> 
<p><strong>281-5-6、时间序列模拟：</strong>在模拟时间序列数据时，可以根据每个月的天数生成更为真实和合理的数据。例如，模拟每日销售数据时，可以根据每个月的天数生成月度数据。</p> 
<p><strong>281-5-7、时间序列分析：</strong>在进行季节性和周期性分析时，每个月的天数是一个重要的参考因素。例如，在分析股票市场的月度回报率时，可以考虑每个月的天数来计算加权平均值。</p> 
<h6 id="241-6%E3%80%81%E7%94%A8%E6%B3%95">281-6、用法</h6> 
<h6 id="10-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87">281-6-1、数据准备</h6> 
<pre><code class="language-python">无</code></pre> 
<h6 id="5-6-1%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B">281-6-2、代码示例</h6> 
<pre><code class="language-python"># 281、pandas.Series.dt.daysinmonth属性
# 281-1、财务分析-月末结算和预算编制
import pandas as pd
# 创建一个日期序列
date_series = pd.date_range(start='2023-01-01', end='2023-12-31', freq='MS')
# 假设每个月的开销（单位：美元）
monthly_expenses = pd.Series([3000, 2800, 3200, 3100, 2900, 2700, 3500, 3300, 3400, 3600, 3800, 3700], index=date_series)
# 计算每月的天数
days_in_month = date_series.daysinmonth
# 计算每月的平均日开销
daily_expenses = monthly_expenses / days_in_month
print(daily_expenses, end='\n\n')

# 281-2、数据完整性检查-验证数据完整性
import pandas as pd
# 假设一个日期序列和对应的数据
date_series = pd.date_range(start='2023-01-01', end='2023-12-31')
data = pd.Series(range(len(date_series)), index=date_series)
# 计算每个月的数据点
expected_days = date_series.to_series().dt.daysinmonth
actual_days = data.groupby(data.index.month).size()
# 检查是否有缺失的数据
missing_data = expected_days - actual_days
print(missing_data, end='\n\n')

# 281-3、平均日值计算-计算每月的平均日气温
import pandas as pd
# 创建一个日期序列
date_series = pd.date_range(start='2023-01-01', end='2023-12-31', freq='MS')
# 假设每个月的平均气温（单位：摄氏度）
monthly_temperature = pd.Series([2.5, 3.0, 5.5, 10.0, 15.0, 20.0, 25.0, 24.0, 20.0, 15.0, 8.0, 3.0], index=date_series)
# 计算每月的天数
days_in_month = date_series.daysinmonth
# 计算每月的平均日气温
average_daily_temperature = monthly_temperature / days_in_month
print(average_daily_temperature, end='\n\n')

# 281-4、时间序列转换-将月度数据转换为季度数据
import pandas as pd
# 创建一个日期序列
date_series = pd.date_range(start='2023-01-01', end='2023-12-31', freq='ME')
# 假设每个月的某项数据（单位：任意）
monthly_data = pd.Series([100, 120, 110, 130, 140, 150, 160, 170, 180, 190, 200, 210], index=date_series)
# 计算每月的天数
days_in_month = date_series.daysinmonth
# 将月度数据转换为季度数据
quarterly_data = monthly_data.resample('QE').sum() / date_series.to_series().dt.daysinmonth.groupby(pd.Grouper(freq='QE')).sum()
print(quarterly_data, end='\n\n')

# 281-5、资源规划和调度-根据每个月的天数规划人力资源
import pandas as pd
# 创建一个日期序列
date_series = pd.date_range(start='2023-01-01', end='2023-12-31', freq='ME')
# 假设总工作量（单位：小时）
total_workload = 1200
# 创建一个包含日期的Series
date_series = pd.Series(date_series)
# 计算每月的天数
days_in_month = date_series.dt.daysinmonth
# 根据每个月的天数规划人力资源
workload_per_day = total_workload / days_in_month.sum()
print(workload_per_day, end='\n\n')

# 281-6、时间序列模拟-生成模拟的每日销售数据
import pandas as pd
# 创建一个日期序列
date_series = pd.date_range(start='2023-01-01', end='2023-12-31', freq='ME')
# 假设每个月的销售数据（单位：任意）
monthly_sales = pd.Series([3000, 3200, 3100, 3300, 3400, 3500, 3600, 3700, 3800, 3900, 4000, 4100], index=date_series)
# 计算每月的天数
days_in_month = date_series.daysinmonth
# 生成模拟的每日销售数据
simulated_daily_sales = monthly_sales / days_in_month
print(simulated_daily_sales, end='\n\n')

# 281-7、时间序列分析-计算加权平均回报率
import pandas as pd
from pandas.tseries.offsets import MonthEnd
# 创建一个日期序列，表示每个月的月末
date_series = pd.date_range(start='2023-01-01', end='2023-12-31', freq=MonthEnd())
# 假设每个月的回报率（单位：百分比），注意这里转换为小数形式
monthly_return = pd.Series([0.02, 0.015, 0.025, 0.03, 0.028, 0.031, 0.029, 0.032, 0.035, 0.038, 0.04, 0.037],
                           index=date_series)
# 初始化一个列表来存储每个月的天数
days_in_month = []
# 计算每个月的天数
for i in range(len(date_series) - 1):
    start_date = date_series[i]
    end_date = date_series[i + 1]
    # 由于freq='ME'，end_date实际上是下个月的月末，所以我们用end_date - MonthEnd()来获取本月最后一天
    last_day_of_month = end_date - MonthEnd(1)
    # 计算这个月有多少天
    days_in_month.append((last_day_of_month - start_date).days + 1)
# 转换为pandas Series以便进行索引和计算
days_in_month = pd.Series(days_in_month, index=date_series[:-1])  # 去掉最后一个月末的日期，因为它不包含数据
# 计算加权平均回报率
# 注意：我们需要将days_in_month向前移动一个月，以便与monthly_return的索引对齐
weighted_return = (monthly_return * days_in_month.shift(1)).sum() / days_in_month.sum()
# 由于我们使用了shift(1)，所以第一个月的回报率没有被计算在内（因为没有前一个月的天数）
# 如果我们希望包含整个年份的回报率，我们可以选择忽略第一个月或者使用一个默认值
# 但在这里，我们假设数据是从第二个月开始有效的，或者简单地忽略这个细节
# 打印加权平均回报率
print(weighted_return)</code></pre> 
<h6 id="5-6-2%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA">281-6-3、结果输出</h6> 
<pre><code class="language-python"># 281、pandas.Series.dt.daysinmonth属性
# 281-1、财务分析-月末结算和预算编制
# 2023-01-01     96.774194
# 2023-02-01    100.000000
# 2023-03-01    103.225806
# 2023-04-01    103.333333
# 2023-05-01     93.548387
# 2023-06-01     90.000000
# 2023-07-01    112.903226
# 2023-08-01    106.451613
# 2023-09-01    113.333333
# 2023-10-01    116.129032
# 2023-11-01    126.666667
# 2023-12-01    119.354839
# Freq: MS, dtype: float64

# 281-2、数据完整性检查-验证数据完整性
# 2023-01-01 00:00:00   NaN
# 2023-01-02 00:00:00   NaN
# 2023-01-03 00:00:00   NaN
# 2023-01-04 00:00:00   NaN
# 2023-01-05 00:00:00   NaN
#                        ..
# 8                     NaN
# 9                     NaN
# 10                    NaN
# 11                    NaN
# 12                    NaN
# Length: 377, dtype: float64

# 281-3、平均日值计算-计算每月的平均日气温
# 2023-01-01    0.080645
# 2023-02-01    0.107143
# 2023-03-01    0.177419
# 2023-04-01    0.333333
# 2023-05-01    0.483871
# 2023-06-01    0.666667
# 2023-07-01    0.806452
# 2023-08-01    0.774194
# 2023-09-01    0.666667
# 2023-10-01    0.483871
# 2023-11-01    0.266667
# 2023-12-01    0.096774
# Freq: MS, dtype: float64

# 281-4、时间序列转换-将月度数据转换为季度数据
# 2023-03-31    3.666667
# 2023-06-30    4.615385
# 2023-09-30    5.543478
# 2023-12-31    6.521739
# Freq: QE-DEC, dtype: float64

# 281-5、资源规划和调度-根据每个月的天数规划人力资源
# 3.287671232876712

# 281-6、时间序列模拟-生成模拟的每日销售数据
# 2023-01-31     96.774194
# 2023-02-28    114.285714
# 2023-03-31    100.000000
# 2023-04-30    110.000000
# 2023-05-31    109.677419
# 2023-06-30    116.666667
# 2023-07-31    116.129032
# 2023-08-31    119.354839
# 2023-09-30    126.666667
# 2023-10-31    125.806452
# 2023-11-30    133.333333
# 2023-12-31    132.258065
# Freq: ME, dtype: float64

# 281-7、时间序列分析-计算加权平均回报率
# 0.027545454545454543</code></pre> 
<h5 id="282%E3%80%81pandas.Series.dt.tz%E5%B1%9E%E6%80%A7">282、<span style="color:#fe2c24;">pandas.Series.dt.tz</span>属性</h5> 
<h6 id="282-1%E3%80%81%E8%AF%AD%E6%B3%95">282-1、语法</h6> 
<pre><code class="language-python"># 282、pandas.Series.dt.tz属性
pandas.Series.dt.tz
Return the timezone.

Returns:
datetime.tzinfo, pytz.tzinfo.BaseTZInfo, dateutil.tz.tz.tzfile, or None
Returns None when the array is tz-naive.</code></pre> 
<h6 id="282-2%E3%80%81%E5%8F%82%E6%95%B0">282-2、参数</h6> 
<p>        无</p> 
<h6 id="282-3%E3%80%81%E5%8A%9F%E8%83%BD">282-3、功能</h6> 
<p>        用于获取或设置pandas.Series对象中时间戳的时区信息。</p> 
<h6 id="282-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC">282-4、返回值</h6> 
<p>        如果pandas.Series中的时间戳带有时区信息，则dt.tz返回pytz库中的tzinfo对象，表示时间戳的时区。例如，&lt;UTC&gt;表示协调世界时(UTC)；如果pandas.Series中的时间戳没有时区信息，则dt.tz返回None。</p> 
<h6 id="282-5%E3%80%81%E8%AF%B4%E6%98%8E">282-5、说明</h6> 
<p>        无</p> 
<h6 id="282-6%E3%80%81%E7%94%A8%E6%B3%95">282-6、用法</h6> 
<h6 id="282-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87">282-6-1、数据准备</h6> 
<pre><code class="language-python">无</code></pre> 
<h6 id="282-6-2%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B">282-6-2、代码示例</h6> 
<pre><code class="language-python"># 282、pandas.Series.dt.tz属性
import pandas as pd
# 创建一个带有UTC时区的时间戳Series对象
timestamps_with_tz = pd.Series(pd.date_range('2024-01-01', periods=3, freq='D', tz='UTC'))
# 获取时区信息
timezone_info = timestamps_with_tz.dt.tz
print(timezone_info)
# 创建一个没有时区的时间戳Series对象
timestamps_no_tz = pd.Series(pd.date_range('2024-01-01', periods=3, freq='D'))
# 获取时区信息
timezone_info_no_tz = timestamps_no_tz.dt.tz
print(timezone_info_no_tz)</code></pre> 
<h6 id="282-6-3%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA">282-6-3、结果输出</h6> 
<pre><code class="language-python"># 282、pandas.Series.dt.tz属性
# UTC
# None</code></pre> 
<h5 id="283%E3%80%81pandas.Series.dt.freq%E5%B1%9E%E6%80%A7">283、<span style="color:#fe2c24;">pandas.Series.dt.freq</span>属性</h5> 
<h6 id="283-1%E3%80%81%E8%AF%AD%E6%B3%95">283-1、语法</h6> 
<pre><code class="language-python"># 283、pandas.Series.dt.freq属性
pandas.Series.dt.freq</code></pre> 
<h6 id="283-2%E3%80%81%E5%8F%82%E6%95%B0">283-2、参数</h6> 
<p>        无</p> 
<h6 id="283-3%E3%80%81%E5%8A%9F%E8%83%BD">283-3、功能</h6> 
<p>        用于返回时间序列数据的频率信息，它提供了时间序列索引的频率属性，可以帮助你确定数据的时间间隔，这对于时间序列数据的处理和分析非常重要，特别是在需要进行<strong><span style="color:#fe2c24;">频率转换、重采样或预测</span></strong>等操作时。</p> 
<h6 id="283-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC">283-4、返回值</h6> 
<p>         返回一个pandas.tseries.offsets.DateOffset对象，代表时间序列的频率。如果时间序列不规则(即没有固定频率)，则返回None。</p> 
<h6 id="283-5%E3%80%81%E8%AF%B4%E6%98%8E">283-5、说明</h6> 
<p>        使用场景：</p> 
<p><strong>283-5-1、频率检测与验证：</strong></p> 
<p><strong>283-5-1-1、检测时间序列的规律性</strong>：在处理时间序列数据时，了解数据的频率有助于确定其是否规律。例如，检测数据是否为日频、月频等，以便选择合适的分析方法。</p> 
<p><strong>283-5-1-2、验证数据的完整性</strong>：通过检测频率，可以识别数据中是否存在缺失值或异常点。例如，日频数据中可能存在缺少某几天的数据，通过dt.freq可以帮助发现这些问题。</p> 
<p><strong>283-5-2、重采样操作：</strong></p> 
<p><strong>283-5-2-1、频率转换</strong>：在重采样操作中，需要将数据从一种频率转换为另一种频率，例如从日频转换为月频，dt.freq可以帮助确定当前数据的频率，从而选择合适的重采样规则。</p> 
<p><strong>283-5-2-2、聚合与降采样</strong>：在降采样时(例如，从分钟频率降到小时频率)，了解原始数据的频率有助于正确地聚合数据。</p> 
<p><strong>283-5-3、时间序列的绘图：</strong>在时间序列的可视化中，频率信息可以帮助设置合适的时间刻度，使得图表更加清晰易读。例如，在月频数据的图表中，可以设置每个月为一个刻度。</p> 
<p><strong>283-5-4、异常检测：</strong>当时间序列数据不规则时，dt.freq会返回None，这种情况下，可以进一步分析数据的异常点或缺失值。</p> 
<h6 id="283-6%E3%80%81%E7%94%A8%E6%B3%95">283-6、用法</h6> 
<h6 id="283-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87">283-6-1、数据准备</h6> 
<pre><code class="language-python">无</code></pre> 
<h6 id="283-6-2%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B">283-6-2、代码示例</h6> 
<pre><code class="language-python"># 283、pandas.Series.dt.freq属性
# 283-1、检测频率与验证数据完整性
import pandas as pd
# 创建一个日频率的时间序列数据
date_range = pd.date_range(start='2024-01-01', periods=10, freq='D')
data = pd.Series(range(10), index=date_range)
print("时间序列的频率:", data.index.freq)
# 检查是否有缺失日期
expected_dates = pd.date_range(start='2024-01-01', end='2024-01-10', freq='D')
missing_dates = expected_dates.difference(data.index)
if len(missing_dates) &gt; 0:
    print("缺失的日期:", missing_dates)
else:
    print("没有缺失的日期", end='\n\n')

# 283-2、重采样操作
import pandas as pd
# 创建一个小时频率的时间序列数据
hourly_range = pd.date_range(start='2024-01-01', periods=24, freq='h')
hourly_data = pd.Series(range(24), index=hourly_range)
print("原始数据的频率:", hourly_data.index.freq)
# 将小时频率的数据重采样为日频
daily_data = hourly_data.resample('D').sum()
print("重采样后的频率:", daily_data.index.freq)
print(daily_data, end='\n\n')

# 283-3、时间序列的绘图
import pandas as pd
import matplotlib.pyplot as plt
import matplotlib
# 配置字体，确保中文字符正常显示
matplotlib.rcParams['font.sans-serif'] = ['Microsoft YaHei']
# 创建一个月频率的时间序列数据
date_range = pd.date_range(start='2023-01-01', periods=12, freq='ME')
data = pd.Series(range(12), index=date_range)
print("时间序列的频率:", data.index.freq)
# 绘制时间序列图
plt.figure(figsize=(10, 5))
plt.plot(data.index, data, marker='o')
plt.title('时间序列图')
plt.xlabel('日期')
plt.ylabel('值')
plt.grid(True)
plt.show()

# 283-4、异常检测
import pandas as pd
# 创建一个不规则的时间序列数据
irregular_range = pd.to_datetime(['2024-01-01', '2024-01-02', '2024-01-04'])
irregular_data = pd.Series([1, 2, 3], index=irregular_range)
print("不规则时间序列的频率:", irregular_data.index.freq)
# 检查不规则时间序列的缺失日期
expected_dates = pd.date_range(start='2024-01-01', end='2024-01-04', freq='D')
missing_dates = expected_dates.difference(irregular_data.index)
if len(missing_dates) &gt; 0:
    print("缺失的日期:", missing_dates)
else:
    print("没有缺失的日期")</code></pre> 
<h6 id="283-6-3%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA">283-6-3、结果输出</h6> 
<pre><code class="language-python"># 283、pandas.Series.dt.freq属性
# 283-1、检测频率与验证数据完整性
# 时间序列的频率: &lt;Day&gt;
# 没有缺失的日期

# 283-2、重采样操作
# 原始数据的频率: &lt;Hour&gt;
# 重采样后的频率: &lt;Day&gt;
# 2024-01-01    276
# Freq: D, dtype: int64

# 283-3、时间序列的绘图
# 见图1

# 283-4、异常检测
# 时间序列的频率: &lt;MonthEnd&gt;
# 不规则时间序列的频率: None
# 缺失的日期: DatetimeIndex(['2024-01-03'], dtype='datetime64[ns]', freq='D')</code></pre> 
<p>图1：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/b5/b0/TBz2rP5S_o.png"> </p> 
<h5 id="284%E3%80%81pandas.Series.dt.isocalendar%E5%B1%9E%E6%80%A7">284、<span style="color:#fe2c24;">pandas.Series.dt.isocalendar</span>属性</h5> 
<h6 id="284-1%E3%80%81%E8%AF%AD%E6%B3%95">284-1、语法</h6> 
<pre><code class="language-python"># 284、pandas.Series.dt.isocalendar属性
pandas.Series.dt.isocalendar()
Calculate year, week, and day according to the ISO 8601 standard.

Returns:
DataFrame
With columns year, week and day.</code></pre> 
<h6 id="284-2%E3%80%81%E5%8F%82%E6%95%B0">284-2、参数</h6> 
<p>        无</p> 
<h6 id="284-3%E3%80%81%E5%8A%9F%E8%83%BD">284-3、功能</h6> 
<p>        可以从日期时间对象中提取ISO年、ISO周和ISO星期几的信息。</p> 
<h6 id="284-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC">284-4、返回值</h6> 
<p>        返回一个DataFrame，其中包含三列：year、week和day。</p> 
<h6 id="284-5%E3%80%81%E8%AF%B4%E6%98%8E">284-5、说明</h6> 
<p>        使用场景：</p> 
<p><strong>284-5-1、财务分析：</strong>在财务分析中，经常需要基于周、月或季度来汇总数据，使用ISO周数可以确保所有数据按照一致的周次进行汇总和分析。例如，比较每周的销售数据，分析季节性趋势。</p> 
<p><strong>284-5-2、周报和计划安排：</strong>ISO周数用于生成周报，确保每个报告周期的数据准确，特别是在计划和项目管理中。例如，生成项目进度周报、员工工作计划。</p> 
<p><strong>284-5-3、周期性数据分析：</strong>在时间序列分析中，识别和分析周期性趋势或季节性波动是常见任务，使用ISO周数有助于准确定位每周的数据点。例如，分析周度流量、评估季节性商品销售。</p> 
<p><strong>284-5-4、数据清理和对齐：</strong>在处理来自不同时间区域的数据时，使用ISO日历可以帮助标准化日期，以便更好地合并和对齐数据。例如，合并不同来源的时间序列数据。</p> 
<p><strong>284-5-5、国际化业务：</strong>ISO周数在国际化业务中尤其重要，因为它避免了由于不同地区采用不同的周定义(如周一或周日为一周开始)而产生的日期混淆。例如，跨国公司的全球报告系统。</p> 
<h6 id="284-6%E3%80%81%E7%94%A8%E6%B3%95">284-6、用法</h6> 
<h6 id="284-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87">284-6-1、数据准备</h6> 
<pre><code class="language-python">无</code></pre> 
<h6 id="284-6-2%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B">284-6-2、代码示例</h6> 
<pre><code class="language-python"># 284、pandas.Series.dt.isocalendar属性
# 284-1、财务分析
import pandas as pd
# 创建一个销售数据DataFrame
data = {
    'date': pd.date_range('2024-07-01', periods=10, freq='D'),
    'sales': [100, 150, 200, 250, 300, 350, 400, 450, 500, 550]
}
df = pd.DataFrame(data)
# 提取ISO年和周数
df['iso_year'] = df['date'].dt.isocalendar().year
df['iso_week'] = df['date'].dt.isocalendar().week
# 按ISO周汇总销售数据
weekly_sales = df.groupby(['iso_year', 'iso_week'])['sales'].sum().reset_index()
print(weekly_sales, end='\n\n')

# 284-2、周报和计划安排
import pandas as pd
# 创建一个项目进度DataFrame
data = {
    'task': ['Task A', 'Task B', 'Task C', 'Task D'],
    'start_date': pd.to_datetime(['2024-01-02', '2024-01-05', '2024-01-08', '2024-01-11']),
    'end_date': pd.to_datetime(['2024-01-06', '2024-01-09', '2024-01-12', '2024-01-15'])
}
df = pd.DataFrame(data)
# 提取ISO年和周数
df['start_week'] = df['start_date'].dt.isocalendar().week
df['end_week'] = df['end_date'].dt.isocalendar().week
# 输出结果
print(df, end='\n\n')

# 284-3、周期性数据分析
import pandas as pd
import matplotlib.pyplot as plt
# 创建一个流量数据 DataFrame
data = {
    'date': pd.date_range('2024-07-01', periods=30, freq='D'),
    'traffic': [500, 600, 700, 800, 900, 1000, 1100,
                1200, 1300, 1400, 1500, 1600, 1700, 1800,
                1900, 2000, 2100, 2200, 2300, 2400, 2500,
                2600, 2700, 2800, 2900, 3000, 3100, 3200,
                3300, 3400]
}
df = pd.DataFrame(data)
# 提取ISO周数
df['iso_week'] = df['date'].dt.isocalendar().week
# 按周汇总流量数据
weekly_traffic = df.groupby('iso_week')['traffic'].sum()
# 绘制流量趋势图
plt.plot(weekly_traffic.index, weekly_traffic.values)
plt.xlabel('ISO Week')
plt.ylabel('Traffic')
plt.title('Weekly Traffic Analysis')
plt.grid(True)
plt.show()

# 284-4、数据清理和对齐
import pandas as pd
# 创建两个来源的数据
data1 = {
    'date': pd.to_datetime(['2024-01-01', '2024-01-02', '2024-01-03']),
    'value': [10, 20, 30]
}
data2 = {
    'date': pd.to_datetime(['2024-01-04', '2024-01-05', '2024-01-06']),
    'value': [40, 50, 60]
}
df1 = pd.DataFrame(data1)
df2 = pd.DataFrame(data2)
# 提取ISO年和周数
df1['iso_week'] = df1['date'].dt.isocalendar().week
df2['iso_week'] = df2['date'].dt.isocalendar().week
# 合并数据
merged_data = pd.concat([df1, df2]).reset_index(drop=True)
# 输出结果
print(merged_data, end='\n\n')

# 284-5、国际化业务
import pandas as pd
# 创建一个国际化日期数据DataFrame
data = {
    'region': ['US', 'EU', 'Asia'],
    'date': pd.to_datetime(['2024-01-01', '2024-01-02', '2024-01-03'])
}
df = pd.DataFrame(data)
# 提取 ISO 年和周数
df['iso_week'] = df['date'].dt.isocalendar().week
# 输出结果
print(df)</code></pre> 
<h6 id="284-6-3%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA">284-6-3、结果输出</h6> 
<pre><code class="language-python"># 284、pandas.Series.dt.isocalendar属性
# 284-1、财务分析
#    iso_year  iso_week  sales
# 0      2024        27   1750
# 1      2024        28   1500

# 284-2、周报和计划安排
#      task start_date   end_date  start_week  end_week
# 0  Task A 2024-01-02 2024-01-06           1         1
# 1  Task B 2024-01-05 2024-01-09           1         2
# 2  Task C 2024-01-08 2024-01-12           2         2
# 3  Task D 2024-01-11 2024-01-15           2         3

# 284-3、周期性数据分析
# 见图2

# 284-4、数据清理和对齐
#         date  value  iso_week
# 0 2024-01-01     10         1
# 1 2024-01-02     20         1
# 2 2024-01-03     30         1
# 3 2024-01-04     40         1
# 4 2024-01-05     50         1
# 5 2024-01-06     60         1

# 284-5、国际化业务
#   region       date  iso_week
# 0     US 2024-01-01         1
# 1     EU 2024-01-02         1
# 2   Asia 2024-01-03         1</code></pre> 
<p>图2：</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/74/96/yUQofP5h_o.png"></p> 
<p> </p> 
<h5 id="285%E3%80%81pandas.Series.dt.to_period%E6%96%B9%E6%B3%95">285、<span style="color:#fe2c24;">pandas.Series.dt.to_period</span>方法</h5> 
<h6 id="285-1%E3%80%81%E8%AF%AD%E6%B3%95">285-1、语法</h6> 
<pre><code class="language-python"># 285、pandas.Series.dt.to_period方法
pandas.Series.dt.to_period(*args, **kwargs)
Cast to PeriodArray/PeriodIndex at a particular frequency.

Converts DatetimeArray/Index to PeriodArray/PeriodIndex.

Parameters:
freq
str or Period, optional
One of pandas’ period aliases or an Period object. Will be inferred by default.

Returns:
PeriodArray/PeriodIndex
Raises:
ValueError
When converting a DatetimeArray/Index with non-regular values, so that a frequency cannot be inferred.</code></pre> 
<h6 id="285-2%E3%80%81%E5%8F%82%E6%95%B0">285-2、参数</h6> 
<p><span style="color:#fe2c24;"><strong>285-2-1、*args</strong></span><span style="color:#956fe7;"><strong>(可选)</strong></span><span style="color:#fe2c24;"><strong>：</strong></span>其他位置参数，为后续扩展功能做预留。</p> 
<p><span style="color:#fe2c24;"><strong>285-2-2、**kwargs</strong></span><span style="color:#956fe7;"><strong>(可选)</strong></span><span style="color:#fe2c24;"><strong>：</strong></span>其他关键字参数，为后续扩展功能做预留。</p> 
<h6 id="285-3%E3%80%81%E5%8A%9F%E8%83%BD">285-3、功能</h6> 
<p>        将Series对象中的日期时间数据转换为周期数据，这对于时间序列分析非常有用，例如，按月、按季度或按年汇总数据；通过指定不同的频率，可以将日期时间数据转换为不同的周期类型。</p> 
<h6 id="285-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC">285-4、返回值</h6> 
<p>        返回一个新的Series对象，其中包含Period对象，Period是一个表示时间段的对象，例如一个月、一季度或一年等。</p> 
<h6 id="285-5%E3%80%81%E8%AF%B4%E6%98%8E">285-5、说明</h6> 
<p>        使用场景：</p> 
<p><strong>285-5-1、数据汇总：</strong>将高频数据(如每日数据)汇总到较低频率的数据(如月度、季度或年度)，以便于统计分析和报告。例如，将每日销售数据汇总为月度销售数据；将每小时的温度记录汇总为每月的平均温度。</p> 
<p><strong>285-5-2、时间序列分析：</strong>按不同周期对数据进行分析，观察和比较不同周期的趋势和变化。例如，比较不同季度的销售额增长趋势；分析年度的气候变化模式。</p> 
<p><strong>285-5-3、数据对齐：</strong>在处理多个时间序列时，确保数据对齐到同一周期，以便进行进一步的比较和分析。例如，将两个不同频率的时间序列(如每日和每周数据)对齐到同一周期(如每月)。</p> 
<p><strong>285-5-4、绘制周期图表：</strong>将时间序列数据按指定周期进行绘制，以便更直观地展示数据趋势和变化。例如，绘制每月的销售额变化图；绘制每季度的气温变化图。</p> 
<p><strong>285-5-5、数据过滤：</strong>按指定周期过滤数据，以便仅分析和处理特定时间段的数据。例如，过滤出特定月份的数据；只处理特定年份的数据。</p> 
<h6 id="285-6%E3%80%81%E7%94%A8%E6%B3%95">285-6、用法</h6> 
<h6 id="285-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87">285-6-1、数据准备</h6> 
<pre><code class="language-python">无</code></pre> 
<h6 id="285-6-2%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B">285-6-2、代码示例</h6> 
<pre><code class="language-python"># 285、pandas.Series.dt.to_period方法
# 285-1、数据汇总
import pandas as pd
# 创建包含每日销售数据的Series
date_series = pd.Series([100, 200, 150, 300, 250], index=pd.date_range("2024-01-01", periods=5, freq="D"))
# 转换为月度周期
period_series_month = date_series.resample('ME').sum()
print(period_series_month, end='\n\n')

# 285-2、时间序列分析
import pandas as pd
# 创建包含每日销售数据的Series
date_series = pd.Series([100, 200, 150, 300, 250, 400, 350, 450, 500, 600], index=pd.date_range("2024-01-01", periods=10, freq="D"))
# 转换为季度周期
period_series_quarter = date_series.to_period('Q').groupby(level=0).sum()
print(period_series_quarter, end='\n\n')

# 285-3、数据对齐
import pandas as pd
# 创建包含每日销售数据的Series
date_series_daily = pd.Series([100, 200, 150, 300, 250], index=pd.date_range("2024-01-01", periods=5, freq="D"))
# 创建包含每周销售数据的Series
date_series_weekly = pd.Series([700, 800], index=pd.date_range("2024-01-01", periods=2, freq="W"))
# 转换为月度周期并对齐
period_series_daily_month = date_series_daily.to_period('M').groupby(level=0).sum()
period_series_weekly_month = date_series_weekly.to_period('M').groupby(level=0).sum()
aligned_series = period_series_daily_month.add(period_series_weekly_month, fill_value=0)
print(aligned_series, end='\n\n')

# 285-4、绘制周期图表
import matplotlib.pyplot as plt
# 创建包含每日销售数据的Series
date_series = pd.Series([100, 200, 150, 300, 250, 400, 350, 450, 500, 600], index=pd.date_range("2024-01-01", periods=10, freq="D"))
# 转换为月度周期
period_series_month = date_series.to_period('M').groupby(level=0).sum()
# 绘制图表
period_series_month.plot(kind='bar')
plt.title('Monthly Sales')
plt.xlabel('Month')
plt.ylabel('Sales')
plt.show()

# 285-5、数据过滤
import pandas as pd
# 创建包含每日销售数据的Series
date_series = pd.Series([100, 200, 150, 300, 250, 400, 350, 450, 500, 600], index=pd.date_range("2024-01-01", periods=10, freq="D"))
# 转换为月度周期
period_series_month = date_series.to_period('M')
# 过滤出2024年1月份的数据
filtered_series = period_series_month[period_series_month.index == '2024-01']
print(filtered_series)</code></pre> 
<h6 id="285-6-3%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA">285-6-3、结果输出</h6> 
<pre><code class="language-python"># 285、pandas.Series.dt.to_period方法
# 285-1、数据汇总
# 2024-01-31    1000
# Freq: ME, dtype: int64

# 285-2、时间序列分析
# 2024Q1    3300
# Freq: Q-DEC, dtype: int64

# 285-3、数据对齐
# 2024-01    2500
# Freq: M, dtype: int64

# 285-4、绘制周期图表
# 见图3

# 285-5、数据过滤
# 2024-01    100
# 2024-01    200
# 2024-01    150
# 2024-01    300
# 2024-01    250
# 2024-01    400
# 2024-01    350
# 2024-01    450
# 2024-01    500
# 2024-01    600
# Freq: M, dtype: int64</code></pre> 
<p>图3：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/d5/c5/Bh2AdQcJ_o.png"> </p> 
<h4 id="%E4%BA%94%E3%80%81%E6%8E%A8%E8%8D%90%E9%98%85%E8%AF%BB">二、推荐阅读</h4> 
<h5 id="1%E3%80%81">1、<a href="https://myelsa1024.blog.csdn.net/article/details/139241094?spm=1001.2014.3001.5502" rel="nofollow" title="Python筑基之旅">Python筑基之旅</a></h5> 
<h5 id="2%E3%80%81">2、<a href="https://myelsa1024.blog.csdn.net/article/details/138916144?spm=1001.2014.3001.5502" rel="nofollow" title="Python函数之旅">Python函数之旅</a></h5> 
<h5 id="3%E3%80%81">3、<a href="https://blog.csdn.net/ygb_1024/article/details/136889623?spm=1001.2014.3001.5501" title="Python算法之旅">Python算法之旅</a></h5> 
<h5 id="4%E3%80%81">4、<a href="https://myelsa1024.blog.csdn.net/article/details/139555733" rel="nofollow" title="Python魔法之旅">Python魔法之旅</a></h5> 
<h5 id="5%E3%80%81%C2%A0">5、<a href="https://blog.csdn.net/ygb_1024?spm=1010.2135.3001.5421" title="博客个人主页">博客个人主页</a></h5>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a799d60ff6618696c6bd429b3ba5708e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Redis 支持的数据类型、应用详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b7547b03c492244782f01a588e0efd3f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【链表OJ】常见面试题 2</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>