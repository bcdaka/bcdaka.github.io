<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>计算机组成课设-设计并实现LA32R架构的模型机硬件系统 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/db80cb4b9f7cb3756989aedc7f2d02ab/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="计算机组成课设-设计并实现LA32R架构的模型机硬件系统">
  <meta property="og:description" content="一、课程设计题目 1.课程设计任务与要求 本次课程设计的任务是：设计并实现LA32R架构的模型机硬件系统。该模型机的指令系统包括以下6条指令：
序号
类型
指令
功能
说明
1
1RI20
LU12I.W rd,si20
GR[rd] ⟵si20 || 12’b0
①GR[rd]的高20位为si20，低12位为0
②符号||表示拼接
2
3R
ADD.W rd, rj, rk
GR[rd]⟵GR[rj]&#43;GR[rk]
加法
3
3R
SLT rd, rj, rk
if (GR[rj]&lt;GR[rk]) GR[rd]⟵1 else GR[rd]⟵0
带符号数的大小比较
4
3R
SLTU rd, rj, rk
if (GR[rj]&lt;GR[rk]) GR[rd]⟵1 else GR[rd]⟵0
无符号数的大小比较
5
2RI12
LD.W rd ,rj,si12
Addr⟵GR[rj] &#43; SignExtend (si12) ,GR[rd] ⟵M[Addr]
①将内存Addr单元的值取出后存入R[rd]
②si12是12位立即数，进行符号位扩展后与GR[rj]相加后得到内存单元的地址Addr
6
2RI12
ST.W rd, rj, si12">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-16T19:18:10+08:00">
    <meta property="article:modified_time" content="2024-01-16T19:18:10+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">计算机组成课设-设计并实现LA32R架构的模型机硬件系统</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 style="margin-left:0px;">一、课程设计题目</h2> 
<h3 style="margin-left:0px;text-align:justify;">1.课程设计任务与要求</h3> 
<p style="margin-left:0;text-align:justify;">本次课程设计的任务是：设计并实现LA32R架构的模型机硬件系统。该模型机的指令系统包括以下6条指令：</p> 
<table align="center" border="1" cellspacing="0"><tbody><tr><td style="border-color:#000000;"> <p style="text-align:center;">序号</p> </td><td style="border-color:#000000;"> <p style="text-align:center;">类型</p> </td><td style="border-color:#000000;"> <p style="text-align:center;">指令</p> </td><td style="border-color:#000000;"> <p style="text-align:center;">功能</p> </td><td> <p style="text-align:center;">说明</p> </td></tr><tr><td style="background-color:#FFFFFF;"> <p style="text-align:center;"><span style="color:#000000;">1</span></p> </td><td style="background-color:#FFFFFF;"> <p style="text-align:center;"><span style="color:#000000;">1RI20</span></p> </td><td style="background-color:#FFFFFF;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">LU12I.W rd,si20</span></p> </td><td style="background-color:#FFFFFF;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">GR[rd] ⟵si20 || 12’b0</span></p> </td><td style="background-color:#FFFFFF;"> <p style="margin-left:0;text-align:left;"><span style="color:#000000;">①</span><span style="color:#000000;">GR[rd]</span><span style="color:#000000;">的高</span><span style="color:#000000;">20</span><span style="color:#000000;">位为</span><span style="color:#000000;">si20</span><span style="color:#000000;">，低</span><span style="color:#000000;">12</span><span style="color:#000000;">位为</span><span style="color:#000000;">0</span></p> <p style="margin-left:0;text-align:left;"><span style="color:#000000;">②</span><span style="color:#000000;">符号</span><span style="color:#000000;">||</span><span style="color:#000000;">表示拼接</span></p> </td></tr><tr><td style="background-color:#FFFFFF;"> <p style="text-align:center;"><span style="color:#000000;">2</span></p> </td><td style="background-color:#FFFFFF;"> <p style="text-align:center;"><span style="color:#000000;">3R</span></p> </td><td style="background-color:#FFFFFF;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">ADD.W rd, rj, rk</span></p> </td><td style="background-color:#FFFFFF;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">GR[rd]⟵GR[rj]+GR[rk]</span></p> </td><td style="background-color:#FFFFFF;"> <p style="margin-left:0;text-align:left;"><span style="color:#000000;">加法</span></p> </td></tr><tr><td style="background-color:#FFFFFF;"> <p style="text-align:center;"><span style="color:#000000;">3</span></p> </td><td style="background-color:#FFFFFF;"> <p style="text-align:center;"><span style="color:#000000;">3R</span></p> </td><td style="background-color:#FFFFFF;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">SLT rd, rj, rk</span></p> </td><td style="background-color:#FFFFFF;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">if (GR[rj]&lt;GR[rk]) GR[rd]⟵1 else GR[rd]⟵0</span></p> </td><td style="background-color:#FFFFFF;"> <p style="margin-left:0;text-align:left;"><span style="color:#000000;">带符号数的大小比较</span></p> </td></tr><tr><td style="background-color:#FFFFFF;"> <p style="text-align:center;"><span style="color:#000000;">4</span></p> </td><td style="background-color:#FFFFFF;"> <p style="text-align:center;"><span style="color:#000000;">3R</span></p> </td><td style="background-color:#FFFFFF;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">SLTU rd, rj, rk</span></p> </td><td style="background-color:#FFFFFF;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">if (GR[rj]&lt;GR[rk]) GR[rd]⟵1 else GR[rd]⟵0</span></p> </td><td style="background-color:#FFFFFF;"> <p style="margin-left:0;text-align:left;"><span style="color:#000000;">无符号数的大小比较</span></p> </td></tr><tr><td style="background-color:#FFFFFF;"> <p style="text-align:center;"><span style="color:#000000;">5</span></p> </td><td style="background-color:#FFFFFF;"> <p style="text-align:center;"><span style="color:#000000;">2RI12</span></p> </td><td style="background-color:#FFFFFF;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">LD.W rd ,rj,si12</span></p> </td><td style="background-color:#FFFFFF;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">Addr⟵GR[rj] + SignExtend (si12) ,GR[rd] ⟵M[Addr]</span></p> </td><td style="background-color:#FFFFFF;"> <p style="margin-left:0;text-align:left;"><span style="color:#000000;">①</span><span style="color:#000000;">将内存</span><span style="color:#000000;">Addr</span><span style="color:#000000;">单元的值取出后存入</span><span style="color:#000000;">R[rd]</span></p> <p style="margin-left:0;text-align:left;"><span style="color:#000000;">②</span><span style="color:#000000;">si12</span><span style="color:#000000;">是</span><span style="color:#000000;">12</span><span style="color:#000000;">位立即数，进行符号位扩展后与</span><span style="color:#000000;">GR[rj]</span><span style="color:#000000;">相加后得到内存单元的地址</span><span style="color:#000000;">Addr</span></p> </td></tr><tr><td style="background-color:#FFFFFF;"> <p style="text-align:center;"><span style="color:#000000;">6</span></p> </td><td style="background-color:#FFFFFF;"> <p style="text-align:center;"><span style="color:#000000;">2RI12</span></p> </td><td style="background-color:#FFFFFF;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">ST.W rd, rj, si12</span></p> </td><td style="background-color:#FFFFFF;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">Addr⟵GR[rj] + SignExtend (si12) , M[Addr]⟵GR[rd]</span></p> </td><td style="background-color:#FFFFFF;"> <p style="margin-left:0;text-align:left;"><span style="color:#000000;">①</span><span style="color:#000000;">把</span><span style="color:#000000;">GR[rd]</span><span style="color:#000000;">的值存入内存</span><span style="color:#000000;">Addr</span><span style="color:#000000;">单元</span></p> <p style="margin-left:0;text-align:left;"><span style="color:#000000;">②</span><span style="color:#000000;">内存单元的地址</span><span style="color:#000000;">Addr</span><span style="color:#000000;">的计算方法与</span><span style="color:#000000;">LD.W</span><span style="color:#000000;">指令相同</span></p> </td></tr></tbody></table> 
<h3 style="margin-left:0px;text-align:justify;">2. 课程设计完成条件</h3> 
<p style="margin-left:0;text-align:justify;">一台安装了EDA工具软件（Vivado）的计算机。</p> 
<h3 style="margin-left:0px;text-align:justify;">3.设计思路与方案</h3> 
<ol><li style="text-align:justify;">设计思路 
  <ol><li style="text-align:justify;">逐条分析要实现的LA32R指令的格式与功能。</li><li style="text-align:justify;">设计取指令、执行指令所需的执行部件，并逐一进行仿真测试，完成功能验证。</li><li style="text-align:justify;">按指令功能，设计各指令的数据通路，将执行部件进行互连，并进行仿真测试，完成功能验证。</li><li style="text-align:justify;">设计控制部件，并进行仿真测试，实现指令译码功能验证。</li><li style="text-align:justify;">将执行部件与控制部件进行互连，完成模型机的设计，并进行仿真测试，通过分析测试程序的运行结果，完成模型机功能的验证。</li></ol></li><li style="text-align:justify;">设计方案</li></ol> 
<p style="margin-left:0;">本次设计的模型机电路如图1所示。该模型机是总线结构，数据总线32位，地址总线32位。该电路包括运算器、存储器、控制器和通用寄存器等模块。其中，运算器可以完成加法、减法、与、或、或非、带符号比较、无符号比较以及直通功能。存储器可以完成数据存入读出功能，容量是256KB。控制器是采用存储逻辑实现的微程序控制器。有1个通用寄存器，可以存储32位数据。</p> 
<p style="margin-left:0;text-align:center;"><img alt="" height="465" src="https://images2.imgbox.com/60/da/DhWHD1UT_o.png" width="865"></p> 
<p style="margin-left:0;text-align:center;">图1模型机电路框图</p> 
<p style="margin-left:0;text-align:left;">图1中各功能器件上标注的控制信号的功能说明见下表。</p> 
<p style="margin-left:0;text-align:center;">表1微操作信号说明</p> 
<table align="center" border="1" cellspacing="0"><tbody><tr><td style="border-color:#000000;vertical-align:top;width:67.7pt;"> <p style="margin-left:0;text-align:center;">信号名称</p> </td><td style="vertical-align:top;width:333.15pt;"> <p style="margin-left:0;text-align:center;">信号功能说明</p> </td></tr><tr><td style="width:67.7pt;"> <p style="margin-left:0;text-align:center;">RegWr</p> </td><td style="width:333.15pt;"> <p style="margin-left:0;text-align:left;">Register写使能控制信号，clk上升沿时刻，若RegWr为1，则busW上的数据被存入Rw指定的寄存器中</p> </td></tr><tr><td style="width:67.7pt;"> <p style="margin-left:0;text-align:center;">AluCtrl</p> </td><td style="width:333.15pt;"> <p style="margin-left:0;text-align:left;">ALU运算类型选择输入</p> </td></tr><tr><td style="width:67.7pt;"> <p style="margin-left:0;text-align:center;">ALUBSrc</p> </td><td style="width:333.15pt;"> <p style="margin-left:0;text-align:left;">二选一模块控制信号</p> </td></tr><tr><td style="width:67.7pt;"> <p style="margin-left:0;text-align:center;">ExtOp</p> </td><td style="width:333.15pt;"> <p style="margin-left:0;text-align:left;">Ext扩展方式选择信号</p> </td></tr><tr><td style="width:67.7pt;"> <p style="margin-left:0;text-align:center;">MemWrEn</p> </td><td style="width:333.15pt;"> <p style="margin-left:0;text-align:left;">RAM写使能信号。</p> <p style="margin-left:0;text-align:left;">当MemWrEn为0时，数据从addr地址端口指定的内存单元读出。</p> <p style="margin-left:0;text-align:left;">当MemWrEn为1时，配合clk时钟信号工作，在clk上升沿，数据存入由addr地址端口指定的内存单元。</p> </td></tr><tr><td style="width:67.7pt;"> <p style="margin-left:0;text-align:center;">MemToReg</p> </td><td style="width:333.15pt;"> <p style="margin-left:0;text-align:left;">二选一模块控制信号</p> </td></tr><tr><td style="width:67.7pt;"> <p style="margin-left:0;text-align:center;">srcReg</p> </td><td style="vertical-align:top;width:333.15pt;"> <p style="margin-left:0;text-align:left;">二选一模块控制信号</p> </td></tr><tr><td style="width:67.7pt;"> <p style="margin-left:0;text-align:center;">Br</p> </td><td rowspan="2" style="vertical-align:top;width:333.15pt;"> <p style="margin-left:0;text-align:left;">Br_E_L与Br信号共同确定PC自增控制信号，与clk上升沿配合工作。</p> <p style="margin-left:0;text-align:left;">在clk上升沿时刻，当pc_inc=1时，PCdata =原PCdata +1；当pc_inc=0时，PCdata =原PCdata +offset。</p> </td></tr><tr><td style="width:67.7pt;"> <p style="margin-left:0;text-align:center;">Br_E_L</p> </td></tr><tr><td style="width:67.7pt;"> <p style="margin-left:0;text-align:center;">clk</p> </td><td style="vertical-align:top;width:333.15pt;"> <p style="margin-left:0;text-align:left;">时钟信号</p> </td></tr><tr><td style="width:67.7pt;"> <p style="margin-left:0;text-align:center;">oe</p> </td><td style="vertical-align:top;width:333.15pt;"> <p style="margin-left:0;text-align:left;">ROM使能信号</p> </td></tr><tr><td style="width:67.7pt;"> <p style="margin-left:0;text-align:center;">rst</p> </td><td style="width:333.15pt;"> <p style="margin-left:0;text-align:left;">PC异步清零信号，高电平有效，即：rst为1时，PCdata =0</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;">3.设计原理与内容</p> 
<h4 style="text-align:justify;">(1) 通用寄存器堆（register）</h4> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="240" src="https://images2.imgbox.com/04/07/sCBcGmat_o.png" width="483"></p> 
<p style="margin-left:0;text-align:justify;">通用寄存器堆包含32个寄存器，记为：r0~r31。每个寄存器的位宽都是：32位。其中，r0的值恒为0。其电路原理图如下：</p> 
<p style="margin-left:0;text-align:justify;">该模块的功能及引脚信号说明如下：</p> 
<table align="left" cellspacing="0" style="margin-left:6.75pt;"><tbody><tr><td style="width:78pt;"> <p style="margin-left:0;text-align:center;">信号名称</p> </td><td style="width:474.85pt;"> <p style="margin-left:0;text-align:center;">功能说明</p> </td></tr><tr><td style="width:78pt;"> <p style="margin-left:0;text-align:right;">busA和busB</p> </td><td style="width:474.85pt;"> <p style="margin-left:0;text-align:left;">两路32位数据输出信号</p> </td></tr><tr><td style="width:78pt;"> <p style="margin-left:0;text-align:right;">Ra(5位)</p> </td><td style="width:474.85pt;"> <p style="margin-left:0;text-align:left;">读寄存器编号输入信号，该编号指定的寄存器的值经过“取数延迟”后，输出到busA</p> </td></tr><tr><td style="width:78pt;"> <p style="margin-left:0;text-align:right;">Rb(5位)</p> </td><td style="width:474.85pt;"> <p style="margin-left:0;text-align:left;">读寄存器编号输入信号，该编号指定的寄存器的值经过“取数延迟”后，输出到busB</p> </td></tr><tr><td style="width:78pt;"> <p style="margin-left:0;text-align:right;">Rw(5位)</p> </td><td style="width:474.85pt;"> <p style="margin-left:0;text-align:left;">写寄存器编号输入信号，该编号指定的数据要写入哪个寄存器</p> </td></tr><tr><td style="width:78pt;"> <p style="margin-left:0;text-align:right;">busW</p> </td><td style="width:474.85pt;"> <p style="margin-left:0;text-align:left;">32位数据输入信号</p> </td></tr><tr><td style="width:78pt;"> <p style="margin-left:0;text-align:right;">clk</p> </td><td style="width:474.85pt;"> <p style="margin-left:0;text-align:left;">写操作时钟控制信号，上升沿有效</p> </td></tr><tr><td style="width:78pt;"> <p style="margin-left:0;text-align:right;">RegWr</p> </td><td style="width:474.85pt;"> <p style="margin-left:0;text-align:left;">写使能控制信号，clk上升沿时刻，若RegWr为1，则busW上的数据被存入Rw指定的寄存器中</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">注：</p> 
<ul><li style="text-align:justify;">寄存器堆的读操作不受clk控制；</li><li style="text-align:justify;">0号寄存器的值恒为0，不受写操作的影响。</li></ul> 
<p style="margin-left:0;text-align:justify;"><a name="_Hlk138085060">该模块</a>的Verilog HDL代码设计如下：</p> 
<pre><code class="hljs">module Registers(busA, busB, Ra, Rb, Rw, busW, clk, RegWr);

input [31:0]busW;

input clk;

input RegWr;

input [4:0]Rw;

input [4:0]Ra;

input [4:0]Rb;

output [31:0]busA;

output [31:0]busB;

reg [31:0] regs [0:32];

reg [31:0] busA;

reg [31:0] busB;

integer i;

always@(*)begin

    regs[0]=0;

    busA = regs[Ra];

    busB = regs[Rb];

end

always@(posedge clk)begin

    if(RegWr == 1)begin

        if(Rw == 0)begin

            regs[Rw] = 0;

        end

        else begin

            regs[Rw] = busW;

        end

    end

end

endmodule</code></pre> 
<h4 style="text-align:justify;">(2)立即数扩展模块(Ext)</h4> 
<p style="margin-left:0;text-align:justify;">一个立即数扩展模块Ext，该模块实现下表所示的4种方式的立即数扩展与拼接操作，以得到一个新的32位数。</p> 
<table align="center" border="1" cellspacing="0"><tbody><tr><td style="border-color:#000000;width:37.4pt;"> <p style="margin-left:0;text-align:center;">Extop</p> </td><td style="border-color:#000000;width:224.1pt;"> <p style="margin-left:0;text-align:center;">功能</p> </td><td style="width:164.6pt;"> <p style="margin-left:0;text-align:center;">说明</p> </td></tr><tr><td style="width:37.4pt;"> <p style="margin-left:0;text-align:center;">0</p> </td><td style="width:224.1pt;"> <p style="margin-left:0;text-align:center;">Dataout←SignExtend(DataIn[21:10])</p> </td><td style="width:164.6pt;"> <p style="margin-left:0;text-align:left;">把DataIn[21:10]进行符号位扩展</p> </td></tr><tr><td style="width:37.4pt;"> <p style="margin-left:0;text-align:center;">1</p> </td><td style="width:224.1pt;"> <p style="margin-left:0;text-align:center;">Dataout←SignExtend(DataIn[25:10] || 2’b0)</p> </td><td style="width:164.6pt;"> <p style="margin-left:0;text-align:left;">把DataIn[25:10]低位补2bit0后，进行符号位扩展</p> </td></tr><tr><td style="width:37.4pt;"> <p style="margin-left:0;text-align:center;">2</p> </td><td style="width:224.1pt;"> <p style="margin-left:0;text-align:center;">Dataout←DataIn[24:5] || 12’b0</p> </td><td style="width:164.6pt;"> <p style="margin-left:0;text-align:left;">把DataIn[24:5]低位补12bit0</p> </td></tr><tr><td style="width:37.4pt;"> <p style="margin-left:0;text-align:center;">3</p> </td><td style="width:224.1pt;"> <p style="margin-left:0;text-align:center;">Dataout←SignExtend(DataIn[9:0] || DataIn[25:10] || 2’b0)</p> </td><td style="width:164.6pt;"> <p style="margin-left:0;text-align:left;">把DataIn[9:0]和 DataIn[25:10] 进行拼接，然后低位补2个0，再进行符号位扩展</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;">该模块的参考电路框图如下：</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="168" src="https://images2.imgbox.com/03/13/dPjtuUDI_o.png" width="399"></p> 
<p style="margin-left:0;text-align:justify;">该模块的功能及引脚信号说明如下：</p> 
<table cellspacing="0" style="margin-left:51.5pt;"><tbody><tr><td style="vertical-align:top;width:60.95pt;"> <p style="margin-left:0;text-align:center;">信号名称</p> </td><td style="vertical-align:top;width:251.75pt;"> <p style="margin-left:0;text-align:center;">功能说明</p> </td></tr><tr><td style="width:60.95pt;"> <p style="margin-left:0;text-align:center;">Datain</p> </td><td style="width:251.75pt;"> <p style="margin-left:0;text-align:center;">32位的数据输入信号</p> </td></tr><tr><td style="width:60.95pt;"> <p style="margin-left:0;text-align:center;">Extop</p> </td><td style="width:251.75pt;"> <p style="margin-left:0;text-align:center;">扩展方式选择信号</p> </td></tr><tr><td style="width:60.95pt;"> <p style="margin-left:0;text-align:center;">Dataout</p> </td><td style="width:251.75pt;"> <p style="margin-left:0;text-align:center;">32位的数据输出信号</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;">该模块的Verilog HDL代码设计如下：</p> 
<pre><code class="hljs">module Ext(input[31:0] DataIn, input[1:0]ExtOp,

             output[31:0]Dataout);

    wire [31:0]imm12;

    wire [31:0]imm16;

    wire [31:0]imm20;

    wire [31:0]imm26;

    //对ADDI.W, LD.W, ST.W指令中的12位立即数进行符号位扩展

    assign imm12= {<!-- -->{20{DataIn[21]}},DataIn[21:10]};

    //对BEQ,BLT指令中的立即数进行符号位扩展及其他部分的拼接

    assign imm16={<!-- -->{14{DataIn[25]}} , {DataIn[25:10], 2'b0}};

    // 对LUI12I.W指令中的20位立即数,低12位补0

    assign imm20={DataIn[24:5], 12'b0};

    //对B指令中的立即数进行符号位扩展及其他部分的拼接

    assign imm26={<!-- -->{4{DataIn[25]}}, DataIn[9:0] , {DataIn[25:10] , 2'b0}};

    reg [31:0]Dataout;

    always @(*)

    begin

        case(ExtOp)

        2'b00: Dataout &lt;= imm12;

        2'b01: Dataout &lt;= imm16;

        2'b10: Dataout &lt;= imm20;

        2'b11: Dataout &lt;= imm26;

    default: Dataout &lt;= imm26;

        endcase

    end

   

endmodule</code></pre> 
<h4>(3)程序计数器PC</h4> 
<p style="margin-left:0;text-align:justify;">该模块的参考电路框图如下：</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="124" src="https://images2.imgbox.com/15/4e/Y2h66I18_o.png" width="391"></p> 
<p style="margin-left:0;text-align:justify;">该模块的功能及引脚信号说明如下：</p> 
<table align="center" cellspacing="0"><tbody><tr><td style="width:3cm;"> <p style="margin-left:0;text-align:center;">信号名称</p> </td><td style="width:375.65pt;"> <p style="margin-left:0;text-align:center;">功能说明</p> </td></tr><tr><td style="width:3cm;"> <p style="margin-left:0;text-align:center;">rst</p> </td><td style="width:375.65pt;"> <p style="margin-left:0;text-align:left;">PC异步清零信号，高电平有效，即：rst为1时，PCdata =0</p> </td></tr><tr><td style="width:3cm;"> <p style="margin-left:0;text-align:center;">clk</p> </td><td style="width:375.65pt;"> <p style="margin-left:0;text-align:left;">时钟信号</p> </td></tr><tr><td style="width:3cm;"> <p style="margin-left:0;text-align:center;">offset</p> </td><td style="width:375.65pt;"> <p style="margin-left:0;text-align:left;">32位偏移量</p> </td></tr><tr><td style="vertical-align:top;width:3cm;"> <p style="margin-left:0;text-align:center;">pc_inc</p> </td><td style="vertical-align:top;width:375.65pt;"> <p style="margin-left:0;text-align:left;">自增控制信号，与clk上升沿配合工作。</p> <p style="margin-left:0;text-align:left;">在clk上升沿时刻，当pc_inc=1时，PCdata =原PCdata +1；当pc_inc=0时，PCdata =原PCdata +offset。</p> </td></tr><tr><td style="width:3cm;"> <p style="margin-left:0;text-align:center;">PCdata</p> </td><td style="width:375.65pt;"> <p style="margin-left:0;text-align:left;">32位数据输出信号</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;">该模块的Verilog HDL代码设计如下：</p> 
<pre><code class="hljs">module PC(rst, clk, offset, pc_inc, PCdata);

input rst;

input clk;

input [31:0]offset;

input pc_inc;

output [31:0]PCdata;

reg [31:0]PCdata;

always@(posedge clk)begin

    if(rst==1)begin

        PCdata = 0;

    end

    else begin

         if(pc_inc == 1)begin

            PCdata = PCdata + 4;

         end

         else begin

            PCdata = PCdata + offset;

         end

    end

end

endmodule</code></pre> 
<p style="text-align:justify;"></p> 
<h4 style="text-align:justify;">(4)算术逻辑运算单元ALU</h4> 
<p style="margin-left:0;text-align:justify;">该模块的参考电路框图如下：</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="242" src="https://images2.imgbox.com/76/97/4j79t2Hq_o.png" width="390"></p> 
<p style="margin-left:0;text-align:justify;">该模块的功能及引脚信号说明如下：</p> 
<table cellspacing="0" style="margin-left:35.45pt;"><tbody><tr><td style="vertical-align:top;width:3cm;"> <p style="margin-left:0;text-align:center;">信号名称</p> </td><td style="vertical-align:top;width:375.65pt;"> <p style="margin-left:0;text-align:center;">功能说明</p> </td></tr><tr><td style="width:3cm;"> <p style="margin-left:0;text-align:center;">a, b</p> </td><td style="width:375.65pt;"> <p style="margin-left:0;text-align:center;">两个32位的数据输入</p> </td></tr><tr><td style="width:3cm;"> <p style="margin-left:0;text-align:center;">op</p> </td><td style="width:375.65pt;"> <p style="margin-left:0;text-align:center;">运算类型选择输入</p> </td></tr><tr><td style="width:3cm;"> <p style="margin-left:0;text-align:center;">AddResult</p> </td><td style="width:375.65pt;"> <p style="margin-left:0;text-align:center;">运算结果输出</p> </td></tr><tr><td style="width:3cm;"> <p style="margin-left:0;text-align:center;">Zero</p> </td><td style="width:375.65pt;"> <p style="margin-left:0;text-align:center;">0标志位输出。运算结果AddResult为0时，Zero=1；否则Zero=0</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">该模块的Verilog HDL代码设计如下：</p> 
<pre><code class="hljs">module ALU(input[31:0] a, input[31:0] b, input[2:0] op, output[31:0] AddResult, output Zero, output LT);

    wire [31:0]m;

    wire [31:0]n;

    wire [31:0]p;

    wire [31:0]q;

    assign m = a &amp; 32'h80000000;

    assign n = b &amp; 32'h80000000;

    assign p = a &amp; 32'h7fffffff;

    assign q = b &amp; 32'h7fffffff;

    reg [31:0]AddResult;

    always @(*)

    begin

        case(op)

        3'b000:AddResult &lt;= a + b;

        3'b001:AddResult &lt;= a - b;

        3'b010:AddResult &lt;= a &amp; b;

        3'b011:AddResult &lt;= a | b;

        3'b100:AddResult &lt;= ~(a | b);

        3'b101:if(m == 32'h00000000 &amp;&amp; n== 32'h00000000)begin

                    if(p&gt;q)begin

                        AddResult &lt;= 1;

                    end

                    else begin

                        AddResult &lt;= 0;

                    end

                end

                else if (m == 32'h00000000 &amp;&amp; n== 32'h80000000)begin

                    AddResult &lt;= 0;

                end

                else if (m == 32'h80000000 &amp;&amp; n== 32'h80000000)begin

                    if (p&gt;q)begin

                        AddResult &lt;= 1;

                    end

                    else begin

                        AddResult &lt;= 0;

                    end

                end

                else begin

                    AddResult &lt;= 1;

                end

        3'b110: if (a&lt;b)begin

                    AddResult &lt;= 1;

                end

                else begin

                    AddResult &lt;= 0;

                end

        3'b111:AddResult &lt;= b;

        default:AddResult &lt;= b;

            endcase

        end

    reg Zero; 

    reg LT;

    always @(*)

    begin

        if (AddResult==0)begin

            Zero &lt;= 1;

            LT &lt;= 1;

        end

        else begin

            LT &lt;= 0;

        end

    end

endmodule</code></pre> 
<h4 style="text-align:justify;">(5) 数据存储器(RAM)</h4> 
<p style="margin-left:0;text-align:justify;">该模块的参考电路框图如下：</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="206" src="https://images2.imgbox.com/53/57/DsK1ew1S_o.png" width="343"></p> 
<p style="margin-left:0;text-align:justify;">图中信号说明如下：</p> 
<table align="left" cellspacing="0" style="margin-left:6.75pt;"><tbody><tr><td style="width:78pt;"> <p style="margin-left:0;text-align:center;">信号名称</p> </td><td style="width:474.85pt;"> <p style="margin-left:0;text-align:center;">功能说明</p> </td></tr><tr><td style="width:78pt;"> <p style="margin-left:0;text-align:right;">addr</p> </td><td style="width:474.85pt;"> <p style="margin-left:0;text-align:left;">32位地址总线，用于传送地址，以便按地址访问存储单元。</p> </td></tr><tr><td style="width:78pt;"> <p style="margin-left:0;text-align:right;">data_in</p> </td><td style="width:474.85pt;"> <p style="margin-left:0;text-align:left;">32位数据输入总线</p> </td></tr><tr><td style="width:78pt;"> <p style="margin-left:0;text-align:right;">data_out</p> </td><td style="width:474.85pt;"> <p style="margin-left:0;text-align:left;">32位数据输出总线</p> </td></tr><tr><td style="width:78pt;"> <p style="margin-left:0;text-align:right;">clk</p> </td><td style="width:474.85pt;"> <p style="margin-left:0;text-align:left;">时钟信号，上升沿有效</p> </td></tr><tr><td style="vertical-align:top;width:78pt;"> <p style="margin-left:0;text-align:right;">MemWrEn</p> </td><td style="width:474.85pt;"> <p style="margin-left:0;text-align:left;">写使能信号。</p> <p style="margin-left:0;text-align:left;">当MemWrEn为0时，数据从addr地址端口指定的内存单元读出。</p> <p style="margin-left:0;text-align:left;">当MemWrEn为1时，配合clk时钟信号工作，在clk上升沿，数据存入由addr地址端口指定的内存单元。</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">该模块的Verilog HDL代码设计如下：</p> 
<pre><code class="hljs">module RAM(clk, MemWrEn, addr, data_in, data_out);

input clk;

input MemWrEn;

input [31:0] addr;

input [31:0] data_in;

output [31:0]data_out;

reg [31:0] regs [0:65535];

reg [31:0] data_out;

always@(*)begin

    if(MemWrEn == 0)begin

        data_out = regs[addr];

    end

end

always@(posedge clk)begin

    if(MemWrEn == 1)begin

            regs[addr] = data_in;

    end

end

endmodule</code></pre> 
<h4 style="text-align:justify;">(6) 指令存储器(ROM)</h4> 
<p style="margin-left:0;text-align:justify;">该模块的参考电路框图如下：</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="114" src="https://images2.imgbox.com/dd/c1/xJEphutr_o.png" width="298"></p> 
<p style="margin-left:0;text-align:justify;">图中信号说明如下：</p> 
<table cellspacing="0" style="margin-left:-47.4pt;"><tbody><tr><td style="width:208px;"> <p style="margin-left:0;text-align:center;">                             信号名称</p> </td><td style="width:527px;"> <p style="margin-left:0;text-align:center;">功能说明</p> </td></tr><tr><td style="width:208px;"> <p style="margin-left:0;text-align:right;">addr</p> </td><td style="width:527px;"> <p style="margin-left:0;text-align:left;">32位地址总线，用于传送地址，以便按地址访问存储单元。</p> </td></tr><tr><td style="width:208px;"> <p style="margin-left:0;text-align:right;">data_out</p> </td><td style="width:527px;"> <p style="margin-left:0;text-align:left;">32位数据输出总线</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;">该模块的Verilog HDL代码设计如下：</p> 
<pre><code class="hljs">module ROM(address, oe,dataRomOut);

input [31:0]address;//地址

input oe;//oe 为输出允许

output [31:0]dataRomOut;//数据输出

reg [31:0]RomOut;  

always @(*)     //任何信号（电平）发生改变模块都执行

    begin

        if (oe)

            case(address[6:2])

                5'b00000:RomOut &lt;= 32'b000101_0_0000_0000_0000_0000_0001_00001;

                5'b00001:RomOut &lt;= 32'b000101_0_0000_0000_0000_0000_0010_00010;

                5'b00010:RomOut &lt;= 32'b000101_0_1111_1111_1111_1111_1111_00011;

                5'b00011:RomOut &lt;= 32'b000101_0_1111_1111_1111_1111_1110_00100;

                5'b00100:RomOut &lt;= 32'b000000_0000_01_00000_00010_00001_00101;

                5'b00101:RomOut &lt;= 32'b000000_0000_01_00100_00100_00011_00110;

                5'b00110:RomOut &lt;= 32'b000000_0000_01_00100_00011_00100_00111;

                5'b00111:RomOut &lt;= 32'b000000_0000_01_00101_00101_00001_01000;

                5'b01000:RomOut &lt;= 32'b000000_0000_01_00101_00001_00101_01001;

                5'b01001:RomOut &lt;= 32'b001010_0110_0000_0000_1010_00010_00101;

                5'b01010:RomOut &lt;= 32'b001010_0010_0000_0000_1010_00010_01010;

                5'b01011:RomOut &lt;= 32'b001010_0010_0000_0000_1010_00010_01010;

                5'b01100:RomOut &lt;= 32'b001010_0010_0000_0000_1010_00010_01010;

                5'b01101:RomOut &lt;= 32'b001010_0010_0000_0000_1010_00010_01010;

                5'b01110:RomOut &lt;= 32'b001010_0010_0000_0000_1010_00010_01010;

                5'b01111:RomOut &lt;= 32'b001010_0010_0000_0000_1010_00010_01010;

                default: RomOut &lt;= 32'h0;         

            endcase

        else RomOut &lt;= 32'hzz;      

    end

    assign dataRomOut=RomOut;   

endmodule</code></pre> 
<p style="text-align:justify;"></p> 
<h4 style="text-align:justify;">(7) 控制器(control)</h4> 
<p style="margin-left:0;text-align:justify;">该电路的参考结构图如下：</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="244" src="https://images2.imgbox.com/f7/7d/vOFYekV4_o.png" width="447"></p> 
<p style="margin-left:0;text-align:justify;">图中输入信号Instr[31:15]为要执行的指令字的部分字段，输出信号RegWr, AluCtrl, ALUBSrc, ExtOp, MemWrEn,MemToReg和srcReg为控制器根据不同指令所产生的控制信号。</p> 
<p style="margin-left:0;text-align:justify;">该模块的Verilog HDL代码设计如下：</p> 
<pre><code class="hljs">module Control(input [16:0]Instr, input Zero, input LT, output RegWr, output [2:0]AluCtrl, output ALUBSrc, output [1:0]ExtOp, output MemWrEn, output MemToReg, output srcReg, output Br, output Br_E_L);

    reg RegWr;

    reg [2:0]AluCtrl;

    reg ALUBSrc;

    reg [1:0]ExtOp;

    reg MemWrEn;

    reg MemToReg;

    reg srcReg;

    reg Br;

    reg Br_E_L;

    always@(*)begin

        if(Instr==17'b00000000000100000)begin

            RegWr = 1;

            AluCtrl = 0;

            ALUBSrc = 0;

            ExtOp = 0;

            MemWrEn = 0;

            MemToReg = 0;

            srcReg = 0;

            Br = 0;

            Br_E_L = 0;

        end

        else if (Instr==17'b00000000000100100)begin

            RegWr = 1;

            AluCtrl = 3'b101;

            ALUBSrc = 0;

            ExtOp = 0;

            MemWrEn = 0;

            MemToReg = 0;

            srcReg = 0;

            Br = 0;

            Br_E_L = 0;

        end

        else if (Instr==17'b00000000000100101)begin

            RegWr = 1;

            AluCtrl = 3'b110;

            ALUBSrc = 0;

            ExtOp = 0;

            MemWrEn = 0;

            MemToReg = 0;

            srcReg = 0;

            Br = 0;

            Br_E_L = 0;

        end

        else if (Instr[16:10]==7'b0001010)begin

            RegWr = 1;

            AluCtrl = 111;

            ALUBSrc = 1;

            ExtOp = 2'b10;

            MemWrEn = 0;

            MemToReg = 0;

            srcReg = 0;

            Br = 0;

            Br_E_L = 0;

        end

        else if(Instr[16:7]==10'b0010100010)begin

            RegWr = 1;

            AluCtrl = 0;

            ALUBSrc = 1;

            ExtOp = 0;

            MemWrEn = 0;

            MemToReg = 1;

            srcReg = 0;

            Br = 0;

            Br_E_L = 0;

        end

        else if(Instr[16:7]==10'b0010100110)begin

            RegWr = 0;

            AluCtrl = 0;

            ALUBSrc = 1;

            ExtOp = 0;

            MemWrEn = 1;

            MemToReg = 0;

            srcReg = 1;

            Br = 0;

            Br_E_L = 0;

        end

        else begin

            RegWr = 1;

            AluCtrl = 0;

            ALUBSrc = 0;

            ExtOp = 0;

            MemWrEn = 0;

            MemToReg = 0;

            srcReg = 0;

            Br = 0;

            Br_E_L = 0;

        end

    end

endmodule</code></pre> 
<p style="margin-left:0;text-align:justify;"></p> 
<h4 style="text-align:justify;">(8) 单周期LA32R CPU电路</h4> 
<p style="margin-left:0;text-align:justify;">该电路的参考结构图如下：</p> 
<p style="margin-left:0px;text-align:center;"><img alt="" src="https://images2.imgbox.com/17/e4/d6ADH7JO_o.jpg"></p> 
<p style="margin-left:0;text-align:justify;">该模块的Verilog HDL代码设计如下：</p> 
<pre><code class="hljs">module CPU(input clk, input rst, input oe);

    wire [31:0]L1;

    wire [31:0]L2;

    wire [31:0]L3;

    wire [4:0]L4;

    wire [31:0]L5;

    wire [31:0]L6;

    wire [31:0]L7;

    wire [31:0]L8;

    wire L10;

    wire [31:0]L11;

    wire RegWr;

    wire [2:0]AluCtrl;

    wire ALUBSrc;

    wire [1:0]ExtOp;

    wire MemWrEn;

    wire MemToReg;

    wire srcReg;

    wire Br;

    wire Br_E_L;

    wire Zero;

    wire LT;

    wire [31:0]Instr;

    Ext Ext_Top(.DataIn(Instr), .ExtOp(ExtOp), .Dataout(L1));

    PC PC_Top(.rst(rst), .clk(clk), .offset(L1), .pc_inc(L10), .PCdata(L11));

    PC_inc PC_inc_Top(.Br(Br),.Br_E_L(Br_E_L),.pc_inc(L10));

    Control Control_Top(.Instr(Instr[31:15]), .Zero(Zero), .LT(LT), .RegWr(RegWr), .AluCtrl(AluCtrl), .ALUBSrc(ALUBSrc), .ExtOp(ExtOp), .MemWrEn(MemWrEn), .MemToReg(MemToReg), .srcReg(srcReg), .Br(Br), .Br_E_L(Br_E_L));

    ROM ROM_Top(.address(L11), .oe(oe),.dataRomOut(Instr));

    MUX_a MUXa_Top(.data_a(Instr[4:0]), .data_b(Instr[14:10]), .flag(srcReg), .data_out(L4));

    Registers Register_Top(.busA(L2), .busB(L3), .Ra(Instr[9:5]), .Rb(L4), .Rw(Instr[4:0]), .busW(L5), .clk(clk), .RegWr(RegWr));

    MUX_b MUXb_Top(.data_a(L1), .data_b(L3), .flag(ALUBSrc), .data_out(L6));

    ALU ALU_Top(.a(L2), .b(L6), .op(AluCtrl), .AddResult(L7), .Zero(Zero), .LT(LT));

    RAM RAM_Top(.clk(clk), .MemWrEn(MemWrEn), .addr(L7), .data_in(L3), .data_out(L8));

    MUX_c MUXc_Top(.data_a(L8), .data_b(L7), .flag(MemToReg), .data_out(L5));

endmodule</code></pre> 
<p style="margin-left:0;text-align:justify;"></p> 
<h3 style="margin-left:0px;text-align:justify;">4.设计调试与结果</h3> 
<h4 style="margin-left:0px;text-align:justify;">(1)通用寄存器堆register</h4> 
<p style="margin-left:0;text-align:justify;">在Vivado环境中，输入Verilog HDL设计代码，保存为.v文件。检查无误后，系统生成的RTL原理图如下：</p> 
<p><img alt="" height="587" src="https://images2.imgbox.com/1f/2e/6gNAw80C_o.png" width="811"></p> 
<p style="margin-left:0;text-align:justify;">激励文件如下：</p> 
<table border="1" cellspacing="0"><tbody><tr><td style="border-color:#000000;vertical-align:top;width:426.1pt;"> <p style="margin-left:0;text-align:justify;">`timescale 1ns / 1ps</p> <p style="margin-left:0;text-align:justify;">module sim4Registers();</p> <p style="margin-left:0;text-align:justify;">reg [31:0]busW;</p> <p style="margin-left:0;text-align:justify;">reg clk;</p> <p style="margin-left:0;text-align:justify;">reg RegWr;</p> <p style="margin-left:0;text-align:justify;">reg [4:0]Rw;</p> <p style="margin-left:0;text-align:justify;">reg [4:0]Ra;</p> <p style="margin-left:0;text-align:justify;">reg [4:0]Rb;</p> <p style="margin-left:0;text-align:justify;">wire [31:0]busA;</p> <p style="margin-left:0;text-align:justify;">wire [31:0]busB;</p> <p style="margin-left:0;text-align:justify;">Registers uut(.busA(busA), .busB(busB), .Ra(Ra), .Rb(Rb), .Rw(Rw), .busW(busW), .clk(clk), .RegWr(RegWr));</p> <p style="margin-left:0;text-align:justify;">initial begin</p> <p style="margin-left:0;text-align:justify;">    clk = 0;</p> <p style="margin-left:0;text-align:justify;">    forever begin</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 0;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 1;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 2;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 3;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 4;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 5;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 6;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 7;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 8;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 9;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 10;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 11;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 12;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 13;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 14;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 15;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 16;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 17;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 18;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 19;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 20;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 21;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 22;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 23;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 24;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 25;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 26;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 27;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 28;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 29;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 30;RegWr = 1;busW = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;Rw = 31;RegWr = 1;busW = 32'h00000000;   </p> <p style="margin-left:0;text-align:justify;">        #100;Ra = 0;Rb = 1;Rw = 1;RegWr = 1;busW = 32'h11111111;</p> <p style="margin-left:0;text-align:justify;">        #100;Ra = 1;Rb = 2;Rw = 2;RegWr = 1;busW = 32'h22222222;</p> <p style="margin-left:0;text-align:justify;">        #100;Ra = 2;Rb = 3;Rw = 3;RegWr = 1;busW = 32'h33333333;</p> <p style="margin-left:0;text-align:justify;">        #100;Ra = 3;Rb = 4;Rw = 4;RegWr = 1;busW = 32'h44444444;</p> <p style="margin-left:0;text-align:justify;">        #100;Ra = 4;Rb = 5;Rw = 5;RegWr = 1;busW = 32'h55555555;</p> <p style="margin-left:0;text-align:justify;">        #100;Ra = 5;Rb = 6;Rw = 6;RegWr = 1;busW = 32'h66666666;</p> <p style="margin-left:0;text-align:justify;">        #100;Ra = 6;Rb = 7;Rw = 7;RegWr = 1;busW = 32'h77777777;</p> <p style="margin-left:0;text-align:justify;">        #100;Ra = 7;Rb = 8;Rw = 8;RegWr = 1;busW = 32'h88888888;</p> <p style="margin-left:0;text-align:justify;">        #100;Ra = 8;Rb = 9;Rw = 9;RegWr = 1;busW = 32'h99999999;</p> <p style="margin-left:0;text-align:justify;">        #100;Ra = 9;Rb = 0;Rw = 0;RegWr = 1;busW = 32'haaaaaaaa;</p> <p style="margin-left:0;text-align:justify;">        #100;Ra = 0;Rb = 0;Rw = 0;RegWr = 0;busW = 32'h33333333;</p> <p style="margin-left:0;text-align:justify;">    end</p> <p style="margin-left:0;text-align:justify;">end</p> <p style="margin-left:0;text-align:justify;">always #40 clk=~clk;</p> <p style="margin-left:0;text-align:justify;">endmodule</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;">运行结果如下：</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="305" src="https://images2.imgbox.com/b8/99/r5DBIJge_o.png" width="865"></p> 
<h4 style="margin-left:0px;text-align:justify;">(2)立即数扩展模块Ext</h4> 
<p style="margin-left:0;text-align:justify;">在Vivado环境中，输入Verilog HDL设计代码，保存为.v文件。检查无误后，系统生成的RTL原理图如下：</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p><img alt="" height="286" src="https://images2.imgbox.com/70/a6/aocwO8MT_o.png" width="747"></p> 
<p style="margin-left:0;text-align:justify;">激励文件如下：</p> 
<table border="1" cellspacing="0"><tbody><tr><td style="border-color:#000000;vertical-align:top;width:426.1pt;"> <p style="margin-left:0;text-align:justify;">`timescale 1ns / 1ps</p> <p style="margin-left:0;text-align:justify;"></p> <p style="margin-left:0;text-align:justify;">module sim4Ext();</p> <p style="margin-left:0;text-align:justify;">    reg [31:0]DataIn;</p> <p style="margin-left:0;text-align:justify;">    reg [1:0]ExtOp;</p> <p style="margin-left:0;text-align:justify;">    wire [31:0]Dataout;</p> <p style="margin-left:0;text-align:justify;">        Ext uut(.DataIn(DataIn),.ExtOp(ExtOp),.Dataout(Dataout));</p> <p style="margin-left:0;text-align:justify;">            always begin</p> <p style="margin-left:0;text-align:justify;">        DataIn = 32'b00000000000000000001000000000001;ExtOp = 2'b00;#100;</p> <p style="margin-left:0;text-align:justify;">        DataIn = 32'h12345678;ExtOp = 2'b01;#100;</p> <p style="margin-left:0;text-align:justify;">        DataIn = 32'h12345678;ExtOp = 2'b10;#100;    </p> <p style="margin-left:0;text-align:justify;">        DataIn = 32'h12345678;ExtOp = 2'b11;#100;</p> <p style="margin-left:0;text-align:justify;">        end</p> <p style="margin-left:0;text-align:justify;">endmodule</p> <p style="margin-left:0;text-align:justify;"></p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">运行结果如下：</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="167" src="https://images2.imgbox.com/68/24/vRD6vS4k_o.png" width="864"></p> 
<h4 style="margin-left:0px;text-align:justify;">(3)程序计数器PC</h4> 
<p style="margin-left:0;text-align:justify;">在Vivado环境中，输入Verilog HDL设计代码，保存为.v文件。检查无误后，系统生成的RTL原理图如下：</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="244" src="https://images2.imgbox.com/97/4f/385ZVVmT_o.png" width="865"></p> 
<p style="margin-left:0;text-align:justify;">测试代码如下：</p> 
<table border="1" cellspacing="0"><tbody><tr><td style="border-color:#000000;vertical-align:top;width:426.1pt;"> <p style="margin-left:0;text-align:justify;">`timescale 1ns / 1ps</p> <p style="margin-left:0;text-align:justify;">module sim4PC();</p> <p style="margin-left:0;text-align:justify;">reg rst;</p> <p style="margin-left:0;text-align:justify;">reg clk;</p> <p style="margin-left:0;text-align:justify;">reg [31:0]offset;</p> <p style="margin-left:0;text-align:justify;">reg pc_inc;</p> <p style="margin-left:0;text-align:justify;">wire [31:0]PCdata;</p> <p style="margin-left:0;text-align:justify;">PC uut(.rst(rst), .clk(clk), .offset(offset), .pc_inc(pc_inc),.PCdata(PCdata));</p> <p style="margin-left:0;text-align:justify;">initial begin</p> <p style="margin-left:0;text-align:justify;">    clk = 0;</p> <p style="margin-left:0;text-align:justify;">    rst = 1;</p> <p style="margin-left:0;text-align:justify;">    pc_inc = 1;</p> <p style="margin-left:0;text-align:justify;">    forever begin</p> <p style="margin-left:0;text-align:justify;">        #50 rst = 0;pc_inc = 1;</p> <p style="margin-left:0;text-align:justify;">        #50 rst = 0;pc_inc = 0;offset = 32'h12345678;</p> <p style="margin-left:0;text-align:justify;">        #50 rst = 0;pc_inc = 1;</p> <p style="margin-left:0;text-align:justify;">        #50 rst = 0;pc_inc = 1;</p> <p style="margin-left:0;text-align:justify;">        #50 rst = 0;pc_inc = 1;</p> <p style="margin-left:0;text-align:justify;">        #50 rst = 0;pc_inc = 1;</p> <p style="margin-left:0;text-align:justify;">        #50 rst = 1;pc_inc = 1;</p> <p style="margin-left:0;text-align:justify;">    end</p> <p style="margin-left:0;text-align:justify;">end</p> <p style="margin-left:0;text-align:justify;">always #20 clk=~clk;</p> <p style="margin-left:0;text-align:justify;">endmodule</p> <p style="margin-left:0;text-align:justify;"></p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;">运行结果如下：</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="278" src="https://images2.imgbox.com/20/61/ooWZ8fdh_o.png" width="864"></p> 
<h4 style="margin-left:0px;text-align:justify;">(4)算术逻辑运算单元ALU</h4> 
<p style="margin-left:0;text-align:justify;">在Vivado环境中，输入Verilog HDL设计代码，保存为.v文件。检查无误后，系统生成的RTL原理图如下：</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="400" src="https://images2.imgbox.com/09/10/oA33CBRM_o.png" width="864"></p> 
<p style="margin-left:0;text-align:justify;">代码如下：</p> 
<table border="1" cellspacing="0"><tbody><tr><td style="border-color:#000000;vertical-align:top;width:426.1pt;"> <p style="margin-left:0;text-align:justify;">`timescale 1ns / 1ps</p> <p style="margin-left:0;text-align:justify;">module sim4Ext();</p> <p style="margin-left:0;text-align:justify;">    reg [31:0]a;</p> <p style="margin-left:0;text-align:justify;">    reg [31:0]b;</p> <p style="margin-left:0;text-align:justify;">    reg [2:0]op;</p> <p style="margin-left:0;text-align:justify;">    wire [31:0]AddResult;</p> <p style="margin-left:0;text-align:justify;">    wire Zero;</p> <p style="margin-left:0;text-align:justify;">        ALU uut(.a(a),.b(b),.op(op),.AddResult(AddResult),.Zero(Zero));</p> <p style="margin-left:0;text-align:justify;">            always begin</p> <p style="margin-left:0;text-align:justify;">        a = 32'h10000078;b = 32'h00000123;op = 3'b000;#100;</p> <p style="margin-left:0;text-align:justify;">        a = 32'h12345678;b = 32'h00000123;op = 3'b001;#100;      </p> <p style="margin-left:0;text-align:justify;">        a = 32'h12345678;b = 32'h00000123;op = 3'b010;#100;</p> <p style="margin-left:0;text-align:justify;">        a = 32'h10000078;b = 32'h00000123;op = 3'b011;#100;</p> <p style="margin-left:0;text-align:justify;">        a = 32'h12345678;b = 32'h00000123;op = 3'b100;#100;      </p> <p style="margin-left:0;text-align:justify;">        a = 32'h12345678;b = 32'h00000123;op = 3'b101;#100;</p> <p style="margin-left:0;text-align:justify;">        a = 32'h12345678;b = 32'h00000123;op = 3'b110;#100;      </p> <p style="margin-left:0;text-align:justify;">        a = 32'h12345678;b = 32'h00000123;op = 3'b111;#100;</p> <p style="margin-left:0;text-align:justify;">        end</p> <p style="margin-left:0;text-align:justify;">endmodule</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;">运行结果如下：</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="289" src="https://images2.imgbox.com/62/ac/xLVleNJe_o.png" width="864"></p> 
<h4 style="margin-left:0px;text-align:justify;">(5)数据存储器RAM</h4> 
<p style="margin-left:0;text-align:justify;">在Vivado环境中，输入Verilog HDL设计代码，保存为.v文件。检查无误后，系统生成的RTL原理图如下：</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="366" src="https://images2.imgbox.com/ab/a5/TIamf1qr_o.png" width="764"></p> 
<p style="margin-left:0;text-align:justify;">激励文件如下：</p> 
<table border="1" cellspacing="0"><tbody><tr><td style="border-color:#000000;vertical-align:top;width:426.1pt;"> <p style="margin-left:0;text-align:justify;">`timescale 1ns / 1ps</p> <p style="margin-left:0;text-align:justify;">module sim4RAM();</p> <p style="margin-left:0;text-align:justify;">reg clk;</p> <p style="margin-left:0;text-align:justify;">reg MemWrEn;</p> <p style="margin-left:0;text-align:justify;">reg [31:0]addr;</p> <p style="margin-left:0;text-align:justify;">reg [31:0]data_in;</p> <p style="margin-left:0;text-align:justify;">wire [31:0]data_out;</p> <p style="margin-left:0;text-align:justify;">reg [0:31] i;</p> <p style="margin-left:0;text-align:justify;">RAM uut(.clk(clk), .MemWrEn(MemWrEn), .addr(addr), .data_in(data_in), .data_out(data_out));</p> <p style="margin-left:0;text-align:justify;">initial begin</p> <p style="margin-left:0;text-align:justify;">    clk = 0;</p> <p style="margin-left:0;text-align:justify;">    i = 0;</p> <p style="margin-left:0;text-align:justify;">    forever begin</p> <p style="margin-left:0;text-align:justify;">        for(i = 0; i &lt; 32; i = i + 1 )begin</p> <p style="margin-left:0;text-align:justify;">            #100;MemWrEn=1;addr=i;data_in = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        end</p> <p style="margin-left:0;text-align:justify;">        #100;MemWrEn=0;addr=0;data_in = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;MemWrEn=1;addr=0;data_in = 32'h11111111;</p> <p style="margin-left:0;text-align:justify;">        #100;MemWrEn=0;addr=0;data_in = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;MemWrEn=0;addr=1;data_in = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;MemWrEn=1;addr=1;data_in = 32'h22222222;</p> <p style="margin-left:0;text-align:justify;">        #100;MemWrEn=0;addr=1;data_in = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;MemWrEn=0;addr=2;data_in = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;MemWrEn=1;addr=2;data_in = 32'h33333333;</p> <p style="margin-left:0;text-align:justify;">        #100;MemWrEn=0;addr=2;data_in = 32'h00000000;</p> <p style="margin-left:0;text-align:justify;">        #100;MemWrEn=0;addr=3;data_in = 32'h44444444;</p> <p style="margin-left:0;text-align:justify;">        #100;MemWrEn=1;addr=3;data_in = 32'h44444444;</p> <p style="margin-left:0;text-align:justify;">        #100;MemWrEn=0;addr=3;data_in = 32'h44444444;      </p> <p style="margin-left:0;text-align:justify;">    end</p> <p style="margin-left:0;text-align:justify;">end</p> <p style="margin-left:0;text-align:justify;">always #40 clk=~clk;</p> <p style="margin-left:0;text-align:justify;">endmodule</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;">运行结果如下：</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="214" src="https://images2.imgbox.com/fc/b6/elvJtYhl_o.png" width="865"></p> 
<h4 style="margin-left:0px;text-align:justify;">(6)指令存储器ROM</h4> 
<p style="margin-left:0;text-align:justify;">在Vivado环境中，输入Verilog HDL设计代码，保存为.v文件。检查无误后，系统生成的RTL原理图如下：</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="235" src="https://images2.imgbox.com/a1/ea/WA2Zlflq_o.png" width="865"></p> 
<p style="margin-left:0;text-align:justify;">激励文件如下：</p> 
<table border="1" cellspacing="0"><tbody><tr><td style="border-color:#000000;vertical-align:top;width:426.1pt;"> <p style="margin-left:0;text-align:justify;">`timescale 1ns / 1ps</p> <p style="margin-left:0;text-align:justify;"></p> <p style="margin-left:0;text-align:justify;">module sim4ROM();</p> <p style="margin-left:0;text-align:justify;">    reg[31:0]address;//地址</p> <p style="margin-left:0;text-align:justify;">    reg oe;//oe 为输出允许</p> <p style="margin-left:0;text-align:justify;">    wire [31:0]dataRomOut;//数据输出</p> <p style="margin-left:0;text-align:justify;">    ROM uut(.address(address), .oe(oe),.dataRomOut(dataRomOut));</p> <p style="margin-left:0;text-align:justify;">    initial begin</p> <p style="margin-left:0;text-align:justify;">    #40; address = 32'h00000000; oe = 1;//0000000</p> <p style="margin-left:0;text-align:justify;">    #40; address = 32'h00000004; oe = 1;//0000100</p> <p style="margin-left:0;text-align:justify;">    #40; address = 32'h00000008; oe = 1;//0001000</p> <p style="margin-left:0;text-align:justify;">    #40; address = 32'h0000000c; oe = 1;//0001100</p> <p style="margin-left:0;text-align:justify;">    #40; address = 32'h00000010; oe = 1;//0010000</p> <p style="margin-left:0;text-align:justify;">    #40; address = 32'h00000014; oe = 1;//0010100</p> <p style="margin-left:0;text-align:justify;">    #40; address = 32'h00000018; oe = 1;//0011000</p> <p style="margin-left:0;text-align:justify;">    #40; address = 32'h0000001c; oe = 1;//0011100</p> <p style="margin-left:0;text-align:justify;">    #40; address = 32'h00000020; oe = 1;//0100000</p> <p style="margin-left:0;text-align:justify;">    #40; address = 32'h00000024; oe = 1;//0100100</p> <p style="margin-left:0;text-align:justify;">    #40; address = 32'h00000028; oe = 1;//0101000</p> <p style="margin-left:0;text-align:justify;">    #40; address = 32'h0000002c; oe = 1;//0101100</p> <p style="margin-left:0;text-align:justify;">    #40; address = 32'h00000030; oe = 1;//0110000</p> <p style="margin-left:0;text-align:justify;">    #40; address = 32'h00000034; oe = 1;//0110100</p> <p style="margin-left:0;text-align:justify;">    #40; address = 32'h00000038; oe = 1;//0111000</p> <p style="margin-left:0;text-align:justify;">    #40; address = 32'h0000003c; oe = 1;//0111100</p> <p style="margin-left:0;text-align:justify;">    $stop;  </p> <p style="margin-left:0;text-align:justify;">    end</p> <p style="margin-left:0;text-align:justify;">endmodule</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;">运行结果如下：</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="214" src="https://images2.imgbox.com/1a/a1/6fSf2XR4_o.png" width="865"></p> 
<h4 style="margin-left:0px;text-align:justify;">(7)控制器control</h4> 
<p style="margin-left:0;text-align:justify;"><a name="_Hlk138084981">在</a>Vivado环境中，输入Verilog HDL设计代码，保存为.v文件。检查无误后，系统生成的RTL原理图如下：</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="408" src="https://images2.imgbox.com/ff/9d/ePjcy7KM_o.png" width="864"></p> 
<p style="margin-left:0;text-align:justify;">激励文件如下：</p> 
<table border="1" cellspacing="0"><tbody><tr><td style="border-color:#000000;vertical-align:top;width:426.1pt;"> <p style="margin-left:0;text-align:justify;">`timescale 1ns / 1ps</p> <p style="margin-left:0;text-align:justify;">module sim4Control( );</p> <p style="margin-left:0;text-align:justify;">    reg [16:0]Instr;</p> <p style="margin-left:0;text-align:justify;">    wire RegWr;</p> <p style="margin-left:0;text-align:justify;">    wire [2:0]AluCtrl;</p> <p style="margin-left:0;text-align:justify;">    wire ALUBSrc;</p> <p style="margin-left:0;text-align:justify;">    wire [1:0]ExtOp;</p> <p style="margin-left:0;text-align:justify;">    wire MemWrEn;</p> <p style="margin-left:0;text-align:justify;">    wire MemToReg;</p> <p style="margin-left:0;text-align:justify;">    wire srcReg;</p> <p style="margin-left:0;text-align:justify;">    Control uut(.Instr(Instr), .RegWr(RegWr), .AluCtrl(AluCtrl), .ALUBSrc(ALUBSrc), .ExtOp(ExtOp),</p> <p style="margin-left:0;text-align:justify;">                 .MemWrEn(MemWrEn), .MemToReg(MemToReg), .srcReg(srcReg));</p> <p style="margin-left:0;text-align:justify;">        always begin</p> <p style="margin-left:0;text-align:justify;">        #100; Instr=17'b00010101111111111;// LU12I.W</p> <p style="margin-left:0;text-align:justify;">        #100; Instr=17'b00000000000100000;// ADD.W</p> <p style="margin-left:0;text-align:justify;">        #100; Instr=17'b00000000000100100;//SLT</p> <p style="margin-left:0;text-align:justify;">        #100; Instr=17'b00000000000100101;//SLTU</p> <p style="margin-left:0;text-align:justify;">        #100; Instr=17'b00101001100000000;//ST.W</p> <p style="margin-left:0;text-align:justify;">        #100; Instr=17'b00101000100000000;//LD.W</p> <p style="margin-left:0;text-align:justify;">        end</p> <p style="margin-left:0;text-align:justify;">endmodule</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;">运行如下：</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="253" src="https://images2.imgbox.com/e9/e6/gUXcRwU1_o.png" width="864"></p> 
<h4 style="margin-left:0px;text-align:justify;">(8)单周期LA32R CPU电路</h4> 
<p>a）控制信号的取指分析</p> 
<p style="margin-left:0;">本次设计的指令系统包括6条指令，控制信号的取值分析如下：</p> 
<table border="1" cellspacing="0" style="width:502.85pt;"><tbody><tr><td style="border-color:#000000;vertical-align:top;width:26.8pt;"> <p style="margin-left:0;text-align:center;"></p> </td><td colspan="2" style="border-color:#000000;vertical-align:top;width:62.45pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">输入</span></p> </td><td colspan="9" style="vertical-align:top;width:413.6pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">输出</span></p> </td></tr><tr><td style="vertical-align:top;width:26.8pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">指令</span></p> </td><td style="vertical-align:top;width:27.2pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">oe</span></p> </td><td style="vertical-align:top;width:35.25pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">rst</span></p> </td><td style="width:35.15pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">srcReg</span></p> </td><td style="width:46.85pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">ExtOp</span></p> </td><td style="width:45.75pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">ALUBSrc</span></p> </td><td style="width:53.7pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">AluCtrl</span></p> </td><td style="width:55.75pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">MemWrEn</span></p> </td><td style="width:58.85pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">MemToReg</span></p> </td><td style="width:35.8pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">RegWr</span></p> </td><td style="vertical-align:top;width:36.6pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">Br</span></p> </td><td style="vertical-align:top;width:45.15pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">Br_E_L</span></p> </td></tr><tr><td style="width:26.8pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">add</span></p> </td><td style="vertical-align:top;width:27.2pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">1</span></p> </td><td style="vertical-align:top;width:35.25pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:35.15pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:46.85pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">2’b00</span></p> </td><td style="vertical-align:top;width:45.75pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:53.7pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">3’b000</span></p> </td><td style="vertical-align:top;width:55.75pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:58.85pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:35.8pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">1</span></p> </td><td style="vertical-align:top;width:36.6pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:45.15pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td></tr><tr><td style="width:26.8pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">slt</span></p> </td><td style="vertical-align:top;width:27.2pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">1</span></p> </td><td style="vertical-align:top;width:35.25pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:35.15pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:46.85pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">2’b00</span></p> </td><td style="vertical-align:top;width:45.75pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:53.7pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">3’b101</span></p> </td><td style="vertical-align:top;width:55.75pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:58.85pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:35.8pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">1</span></p> </td><td style="vertical-align:top;width:36.6pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:45.15pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td></tr><tr><td style="width:26.8pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">sltu</span></p> </td><td style="vertical-align:top;width:27.2pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">1</span></p> </td><td style="vertical-align:top;width:35.25pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:35.15pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:46.85pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">2’b00</span></p> </td><td style="vertical-align:top;width:45.75pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:53.7pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">3’b110</span></p> </td><td style="vertical-align:top;width:55.75pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:58.85pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:35.8pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">1</span></p> </td><td style="vertical-align:top;width:36.6pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:45.15pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td></tr><tr><td style="width:26.8pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">lu12i</span></p> </td><td style="vertical-align:top;width:27.2pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">1</span></p> </td><td style="vertical-align:top;width:35.25pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:35.15pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:46.85pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">2’b10</span></p> </td><td style="vertical-align:top;width:45.75pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">1</span></p> </td><td style="vertical-align:top;width:53.7pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">3’b111</span></p> </td><td style="vertical-align:top;width:55.75pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:58.85pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:35.8pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">1</span></p> </td><td style="vertical-align:top;width:36.6pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:45.15pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td></tr><tr><td style="width:26.8pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">st</span></p> </td><td style="vertical-align:top;width:27.2pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">1</span></p> </td><td style="vertical-align:top;width:35.25pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:35.15pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">1</span></p> </td><td style="vertical-align:top;width:46.85pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">2’b00</span></p> </td><td style="vertical-align:top;width:45.75pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">1</span></p> </td><td style="vertical-align:top;width:53.7pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">3’b000</span></p> </td><td style="vertical-align:top;width:55.75pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">1</span></p> </td><td style="vertical-align:top;width:58.85pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:35.8pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:36.6pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:45.15pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td></tr><tr><td style="width:26.8pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">ld</span></p> </td><td style="vertical-align:top;width:27.2pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">1</span></p> </td><td style="vertical-align:top;width:35.25pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:35.15pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:46.85pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">2’b00</span></p> </td><td style="vertical-align:top;width:45.75pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">1</span></p> </td><td style="vertical-align:top;width:53.7pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">3’b000</span></p> </td><td style="vertical-align:top;width:55.75pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:58.85pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">1</span></p> </td><td style="vertical-align:top;width:35.8pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">1</span></p> </td><td style="vertical-align:top;width:36.6pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td><td style="vertical-align:top;width:45.15pt;"> <p style="margin-left:0;text-align:center;"><span style="color:#000000;">0</span></p> </td></tr></tbody></table> 
<p> </p> 
<p><span style="text-align:justify;">应用程序</span></p> 
<p style="margin-left:0;text-align:justify;">用所设计的6条指令编写的应用程序如下，该测试程序完成寄存器存储、加法、无符号比较、带符号比较、寄存器与内部存储器数据交换共六个功能。</p> 
<table align="center" border="1" cellspacing="0"><tbody><tr><td style="border-color:#000000;vertical-align:top;width:192.75pt;"> <p style="margin-left:0;text-align:center;">应用程序助记符代码</p> </td><td style="border-color:#000000;vertical-align:top;width:233.35pt;"> <p style="margin-left:0;text-align:center;">应用程序机器代码</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:192.75pt;"> <p style="margin-left:0;text-align:center;">Lu12i</p> </td><td style="vertical-align:top;width:233.35pt;"> <p style="margin-left:0;text-align:center;">32'h14000021;</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:192.75pt;"> <p style="margin-left:0;text-align:center;">Lu12i</p> </td><td style="vertical-align:top;width:233.35pt;"> <p style="margin-left:0;text-align:center;">32'h14000042;</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:192.75pt;"> <p style="margin-left:0;text-align:center;">Lu12i</p> </td><td style="vertical-align:top;width:233.35pt;"> <p style="margin-left:0;text-align:center;">32'h15ffffe3;</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:192.75pt;"> <p style="margin-left:0;text-align:center;">Lu12i</p> </td><td style="vertical-align:top;width:233.35pt;"> <p style="margin-left:0;text-align:center;">32'h15ffffc4;</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:192.75pt;"> <p style="margin-left:0;text-align:center;">Add</p> </td><td style="vertical-align:top;width:233.35pt;"> <p style="margin-left:0;text-align:center;">32’h00100825</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:192.75pt;"> <p style="margin-left:0;text-align:center;">Slt</p> </td><td style="vertical-align:top;width:233.35pt;"> <p style="margin-left:0;text-align:center;">32’h00121066</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:192.75pt;"> <p style="margin-left:0;text-align:center;">Slt</p> </td><td style="vertical-align:top;width:233.35pt;"> <p style="margin-left:0;text-align:center;">32’h00120c87</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:192.75pt;"> <p style="margin-left:0;text-align:center;">Sltu</p> </td><td style="vertical-align:top;width:233.35pt;"> <p style="margin-left:0;text-align:center;">32’h00129428</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:192.75pt;"> <p style="margin-left:0;text-align:center;">Sltu</p> </td><td style="vertical-align:top;width:233.35pt;"> <p style="margin-left:0;text-align:center;">32’h001284a9</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:192.75pt;"> <p style="margin-left:0;text-align:center;">St</p> </td><td style="vertical-align:top;width:233.35pt;"> <p style="margin-left:0;text-align:center;">32’h29802845</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:192.75pt;"> <p style="margin-left:0;text-align:center;">ld</p> </td><td style="vertical-align:top;width:233.35pt;"> <p style="margin-left:0;text-align:center;">32’h2880284a</p> </td></tr></tbody></table> 
<ol><li style="text-align:justify;">应用程序与模型机联调过程及结果</li></ol> 
<p style="margin-left:0;text-align:justify;">i.本模型机使用ROM存储器存储应用程序，所编写的仿真测试激励文件就是给出几个输入信号的初始值以及clk信号，将由PC程序计数器来控制执行的指令。仿真波形结果的输入信号是rst （PC异步清零信号，高电平有效，即：rst为1时，PCdata =0），oe （ROM使能信号）和clk（时钟信号）。得到的输出是指令执行的结果。运行结果与应用程序预计的结果相一致。</p> 
<p style="margin-left:0;text-align:justify;">仿真激励文件如下：</p> 
<table border="1" cellspacing="0" style="margin-left:42pt;"><tbody><tr><td style="border-color:#000000;vertical-align:top;width:384.1pt;"> <p style="margin-left:0;text-align:justify;">`timescale 1ns / 1ps</p> <p style="margin-left:0;text-align:justify;">module sim4CPU();</p> <p style="margin-left:0;text-align:justify;">    wire [31:0]L1;</p> <p style="margin-left:0;text-align:justify;">    wire [31:0]L2;</p> <p style="margin-left:0;text-align:justify;">    wire [31:0]L3;</p> <p style="margin-left:0;text-align:justify;">    wire [4:0]L4;</p> <p style="margin-left:0;text-align:justify;">    wire [31:0]L5;</p> <p style="margin-left:0;text-align:justify;">    wire [31:0]L6;</p> <p style="margin-left:0;text-align:justify;">    wire [31:0]L7;</p> <p style="margin-left:0;text-align:justify;">    wire [31:0]L8;</p> <p style="margin-left:0;text-align:justify;">    wire L10;</p> <p style="margin-left:0;text-align:justify;">    wire [31:0]L11;</p> <p style="margin-left:0;text-align:justify;">    wire RegWr;</p> <p style="margin-left:0;text-align:justify;">    wire [2:0]AluCtrl;</p> <p style="margin-left:0;text-align:justify;">    wire ALUBSrc;</p> <p style="margin-left:0;text-align:justify;">    wire [1:0]ExtOp;</p> <p style="margin-left:0;text-align:justify;">    wire MemWrEn;</p> <p style="margin-left:0;text-align:justify;">    wire MemToReg;</p> <p style="margin-left:0;text-align:justify;">    wire srcReg;</p> <p style="margin-left:0;text-align:justify;">    wire Br;</p> <p style="margin-left:0;text-align:justify;">    wire Br_E_L;</p> <p style="margin-left:0;text-align:justify;">    wire Zero;</p> <p style="margin-left:0;text-align:justify;">    wire LT;</p> <p style="margin-left:0;text-align:justify;">    wire [31:0]Instr;</p> <p style="margin-left:0;text-align:justify;">    reg clk;</p> <p style="margin-left:0;text-align:justify;">    reg rst;</p> <p style="margin-left:0;text-align:justify;">    reg oe;</p> <p style="margin-left:0;text-align:justify;">    Ext Ext_Top(.DataIn(Instr), .ExtOp(ExtOp), .Dataout(L1));</p> <p style="margin-left:0;text-align:justify;">    PC PC_Top(.rst(rst), .clk(clk), .offset(L1), .pc_inc(L10), .PCdata(L11));</p> <p style="margin-left:0;text-align:justify;">    PC_inc PC_inc_Top(.Br(Br),.Br_E_L(Br_E_L),.pc_inc(L10));</p> <p style="margin-left:0;text-align:justify;">    Control Control_Top(.Instr(Instr[31:15]), .Zero(Zero), .LT(LT), .RegWr(RegWr), .AluCtrl(AluCtrl), .ALUBSrc(ALUBSrc), .ExtOp(ExtOp),</p> <p style="margin-left:0;text-align:justify;">                 .MemWrEn(MemWrEn), .MemToReg(MemToReg), .srcReg(srcReg), .Br(Br), .Br_E_L(Br_E_L));</p> <p style="margin-left:0;text-align:justify;">    ROM ROM_Top(.address(L11), .oe(oe),.dataRomOut(Instr));</p> <p style="margin-left:0;text-align:justify;">    MUX_a MUXa_Top(.data_a(Instr[4:0]), .data_b(Instr[14:10]), .flag(srcReg), .data_out(L4));</p> <p style="margin-left:0;text-align:justify;">    Registers Register_Top(.busA(L2), .busB(L3), .Ra(Instr[9:5]), .Rb(L4), .Rw(Instr[4:0]), .busW(L5), .clk(clk), .RegWr(RegWr));</p> <p style="margin-left:0;text-align:justify;">    MUX_b MUXb_Top(.data_a(L1), .data_b(L3), .flag(ALUBSrc), .data_out(L6));</p> <p style="margin-left:0;text-align:justify;">    ALU ALU_Top(.a(L2), .b(L6), .op(AluCtrl), .AddResult(L7), .Zero(Zero), .LT(LT));</p> <p style="margin-left:0;text-align:justify;">    RAM RAM_Top(.clk(clk), .MemWrEn(MemWrEn), .addr(L7), .data_in(L3), .data_out(L8));</p> <p style="margin-left:0;text-align:justify;">    MUX_c MUXc_Top(.data_a(L8), .data_b(L7), .flag(MemToReg), .data_out(L5));</p> <p style="margin-left:0;text-align:justify;">    CPU uut(.clk(clk), .rst(rst), .oe(oe));</p> <p style="margin-left:0;text-align:justify;">    initial begin</p> <p style="margin-left:0;text-align:justify;">        clk = 0;</p> <p style="margin-left:0;text-align:justify;">        rst = 1;</p> <p style="margin-left:0;text-align:justify;">        oe = 1;</p> <p style="margin-left:0;text-align:justify;">        #40;</p> <p style="margin-left:0;text-align:justify;">        rst = 0;</p> <p style="margin-left:0;text-align:justify;">        #40;</p> <p style="margin-left:0;text-align:justify;">    end</p> <p style="margin-left:0;text-align:justify;">    always begin</p> <p style="margin-left:0;text-align:justify;">        #20 clk = ~clk;</p> <p style="margin-left:0;text-align:justify;">    end  </p> <p style="margin-left:0;text-align:justify;">endmodule</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;">在Vivado环境中，输入Verilog HDL设计代码，保存为.v文件。检查无误后，系统生成的RTL原理图如下：</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="273" src="https://images2.imgbox.com/32/16/6fVsfQCa_o.png" width="865"></p> 
<p style="margin-left:0;text-align:justify;">ii.模型机的仿真波形截图如下。如下图，其中的L5为busW的值，可以观测到数据计算结果，通过计算可得运行结果与应用程序预计的结果相一致。</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="442" src="https://images2.imgbox.com/e6/ea/dIHMjD1C_o.png" width="865"></p> 
<h2 style="text-align:justify;">二、参考文献</h2> 
<p style="margin-left:0;"><strong>[1]龙芯架构32位精简版参考手册:V1.02，龙芯中科技术股份有限公司.</strong></p> 
<p style="margin-left:0;"><strong>[2]白中英, 戴志涛. 计算机组成原理.第六版立体化教材[M]. 科学出版社, 2019.</strong></p> 
<p style="margin-left:0;"><strong>[3]计算机组成原理课程设计指导书.LoongArch之LA32R版，南通大学信息科学技术学院计算机组成原理课程组</strong></p> 
<p style="margin-left:0;text-align:justify;"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/33379fc36062c7794e883de9d9638bbd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Hive数据导出的四种方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1ca97a3dd4af10f260f4b76f55efcca8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">大数据基础-测试过程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>