<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>小程序Taro框架 自定义底部Tabbar，处理自定义Tab栏切换卡顿、闪烁 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/2947e493c6afe7bfda6976f5bd32736b/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="小程序Taro框架 自定义底部Tabbar，处理自定义Tab栏切换卡顿、闪烁">
  <meta property="og:description" content="最终效果 最近在用Taro框架开发一个小程序，有一个自定义底部Tabbar的需求，最终效果如下
起步 这页是我第一次接触自定义小程序底部Tabbar，所有第一选择必然是相看官方文档：微信小程序自定义 Tabbar | Taro 文档 （如果第一次做，请一定要仔细看这个文档）
按照文档正常配置app.config.js app.config.js
export default { tabBar: { custom: true, color: &#39;#000000&#39;, selectedColor: &#39;#000000&#39;, backgroundColor: &#39;#000000&#39;, list: [ { pagePath: &#39;page/home/index&#39;, text: &#39;组件&#39;, }, { pagePath: &#39;page/cart/index&#39;, text: &#39;接口&#39;, }, ], }, } 配置tab页面usingComponents page/home/index.config.js
export default { navigationBarTitleText: &#39;教材&#39;, usingComponents: {}, } page/cart/index.config.js
export default { navigationBarTitleText: &#39;购物车&#39;, usingComponents: {}, } 开发 custom-tab-bar 设置 custom-tab-bar 组件 &#34;component&#34;: true Demo
import { Component, useState } from &#39;react&#39;; import { CoverImage, CoverView } from &#39;@tarojs/components&#39; import clx from &#39;classnames&#39; import Taro from &#39;@tarojs/taro&#39;; import { View } from &#39;@tarojs/components&#39;; import ic_book from &#39;@/static/images/ic_book@2x.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-05T16:51:07+08:00">
    <meta property="article:modified_time" content="2024-03-05T16:51:07+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">小程序Taro框架 自定义底部Tabbar，处理自定义Tab栏切换卡顿、闪烁</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>最终效果</h3> 
<p>最近在用Taro框架开发一个小程序，有一个自定义底部Tabbar的需求，最终效果如下</p> 
<p><img alt="" height="677" src="https://images2.imgbox.com/64/b9/ggCgOPTI_o.png" width="392"></p> 
<h3>起步</h3> 
<p> 这页是我第一次接触自定义小程序底部Tabbar，所有第一选择必然是相看官方文档：<a href="https://nervjs.github.io/taro-docs/docs/custom-tabbar/" rel="nofollow" title="微信小程序自定义 Tabbar | Taro 文档">微信小程序自定义 Tabbar | Taro 文档</a> （<strong>如果第一次做，请一定要仔细看这个文档</strong>）</p> 
<p></p> 
<h4>按照文档正常配置app.config.js</h4> 
<p>app.config.js</p> 
<pre><code>export default {
  tabBar: {
    custom: true,
    color: '#000000',
    selectedColor: '#000000',
    backgroundColor: '#000000',
    list: [
      {
        pagePath: 'page/home/index',
        text: '组件',
      },
      {
        pagePath: 'page/cart/index',
        text: '接口',
      },
    ],
  },
}
</code></pre> 
<h4>配置tab页面usingComponents</h4> 
<p>page/home/index.config.js</p> 
<pre><code>export default {
  navigationBarTitleText: '教材',
  usingComponents: {},
}
</code></pre> 
<p></p> 
<p>page/cart/index.config.js</p> 
<pre><code>export default {
  navigationBarTitleText: '购物车',
  usingComponents: {},
}</code></pre> 
<h3> 开发 custom-tab-bar</h3> 
<h4>设置 custom-tab-bar 组件</h4> 
<blockquote> 
 <p>"component": true </p> 
</blockquote> 
<p> Demo</p> 
<pre><code>import { Component, useState } from 'react';
import { CoverImage, CoverView } from '@tarojs/components'
import clx from 'classnames'
import Taro from '@tarojs/taro';
import { View } from '@tarojs/components';
import ic_book from '@/static/images/ic_book@2x.png';
import ic_car from '@/static/images/ic_car@2x.png';
import ic_bookHover from '@/static/images/ic_book_hover@2x.png';
import ic_carHover from '@/static/images/ic_car_hover@2x.png';
import './index.scss';
function CustomTabBar() {
  const [tab, setTab] = useState({
    color: '#000000',
    selectedColor: '#DC143C',
    list: [
      {
        pagePath: '/pages/home/index',
        text: '教材',
        iconPath: ic_book,
        selectedIconPath: ic_bookHover
      },
      {
        pagePath: '/pages/shopping-cart/index',
        text: '购物车',
        iconPath: ic_car,
        selectedIconPath: ic_carHover
      }
    ]
  });
  function switchTab(index, url) {
    nx.$patch('app/setTabIndex', index);
    Taro.switchTab({ url });
  }

  return (
    &lt;CoverView
      className="tab-bar"
      style={<!-- -->{ height: nx.$get('app.tabHeight') + 'px' }}&gt;
      &lt;CoverView className="tab-bar-border"&gt;&lt;/CoverView&gt;
      {tab.list.map((item, index) =&gt; {
        return (
          &lt;CoverView
            key={index}
            className="tab-bar-item"
            onClick={() =&gt; switchTab(index, item.pagePath)}&gt;
            &lt;CoverView className="ra"&gt;
              &lt;CoverImage
                className="cover-image"
                src={
                  nx.$use('app.tabIndex') === index
                    ? item.selectedIconPath
                    : item.iconPath
                }
              /&gt;
              {index === 1 &amp;&amp; (
                &lt;CoverView className={clx('null-dot', {
                  'dot': nx.$use('cart.count'),
                })}&gt;{nx.$use('cart.count')}&lt;/CoverView&gt;
              )}
            &lt;/CoverView&gt;

            &lt;CoverView
              className="cover-view"
              style={<!-- -->{
                color:
                  nx.$use('app.tabIndex') === index
                    ? tab.selectedColor
                    : tab.color
              }}&gt;
              {item.text}
            &lt;/CoverView&gt;
          &lt;/CoverView&gt;
        );
      })}
    &lt;/CoverView&gt;
  );
}
export default CustomTabBar;
</code></pre> 
<h4>注意点：</h4> 
<ol><li>上述代码中出现的nx是我同事基于Redux Toolkit 封装的一个语法糖，你可以忽略，直接理解为你自己全局状态的使用</li></ol> 
<h3>修复自定义tab点击卡顿、闪烁</h3> 
<p>请在每个tab页面中调用如下代码，更新tab</p> 
<p>home</p> 
<pre><code> const page = useMemo(() =&gt; Taro.getCurrentInstance().page, []);

 useDidShow(() =&gt; {const tabbar = Taro.getTabBar&lt;any&gt;(page);

 tabbar?.setSelected(0); 
 });

 </code></pre> 
<p>cart</p> 
<pre><code> const page = useMemo(() =&gt; Taro.getCurrentInstance().page, []);

 useDidShow(() =&gt; {const tabbar = Taro.getTabBar&lt;any&gt;(page);

 tabbar?.setSelected(1); 
 });

 </code></pre> 
<p>以上就是我自定义tab的大致过程，详细细节还需要你自己去看文档，官方有相关示例，只要有耐心，你一定可以做的更好</p> 
<h3>已下是Taro官方的示例 </h3> 
<p>react: </p> 
<p><a href="https://github.com/NervJS/taro/tree/main/examples/custom-tabbar-react" title="https://github.com/NervJS/taro/tree/main/examples/custom-tabbar-react">https://github.com/NervJS/taro/tree/main/examples/custom-tabbar-react</a></p> 
<p>vue </p> 
<p><a href="https://github.com/NervJS/taro/tree/main/examples/custom-tabbar-vue3" title="https://github.com/NervJS/taro/tree/main/examples/custom-tabbar-vue3">https://github.com/NervJS/taro/tree/main/examples/custom-tabbar-vue3</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ce9c54356f3b3336c518fd7d8f6a6f5d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【数据库】关系模式规范化（设计范式）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7fcd43aeb5a34d0f180ba68cffdc80f7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Jenkins 任意文件读取(CVE-2024-23897)&#43;后台用户密码提取哈希破解&#43;反弹Shell 一条龙</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>