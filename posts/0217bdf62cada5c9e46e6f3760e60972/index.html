<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Vue 3获取DOM元素的大小以及相对于视口的位置的getBoundingClientRect属性 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/0217bdf62cada5c9e46e6f3760e60972/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Vue 3获取DOM元素的大小以及相对于视口的位置的getBoundingClientRect属性">
  <meta property="og:description" content="在Vue 3中，可以使用ref来获取DOM元素的getBoundingClientRect属性。
如果元素已挂载，我们使用 getBoundingClientRect 方法来获取元素的位置和大小信息。这个方法返回一个对象，其中包含了 left、top、right、bottom 等属性，这些属性表示元素相对于其最近的滚动祖先（通常是视口）的位置。
这里是一个简单的例子：
&lt;template&gt; &lt;div ref=&#34;boxRef&#34;&gt;Hello World&lt;/div&gt; &lt;/template&gt; &lt;script setup&gt; import { ref, onMounted } from &#39;vue&#39;; const boxRef = ref(null); //创建一个响应式引用boxRef，它将指向div元素 //在onMounted钩子中，我们确保当组件挂载后获取这个元素的getBoundingClientRect属性。这个属性包含了元素的大小以及相对于视口的位置。 onMounted(() =&gt; { if (boxRef.value) { const rect = boxRef.value.getBoundingClientRect(); console.log(rect); } }); &lt;/script&gt; 如果你想要监听元素上的右键点击事件，并获取该元素的位置，你可以使用@contextmenu.prevent来监听右键点击事件，并使用getBoundingClientRect方法来获取元素的位置。
这里是如何实现的一个例子：
&lt;template&gt; &lt;div ref=&#34;myElement&#34; @contextmenu.prevent=&#34;handleRightClick&#34;&gt; 右键点击我 &lt;/div&gt; &lt;/template&gt; &lt;script setup&gt; import { ref } from &#39;vue&#39;; const myElement = ref(null); function handleRightClick(event) { if (myElement.value) { //获取了元素的位置信息rect，它包含了元素相对于视口的位置和大小。 //使用event.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-13T14:51:31+08:00">
    <meta property="article:modified_time" content="2024-06-13T14:51:31+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Vue 3获取DOM元素的大小以及相对于视口的位置的getBoundingClientRect属性</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>在Vue 3中，可以使用ref来获取DOM元素的getBoundingClientRect属性。<br> 如果元素已挂载，我们使用 getBoundingClientRect 方法来获取元素的位置和大小信息。这个方法返回一个对象，其中包含了 left、top、right、bottom 等属性，这些属性表示元素相对于其最近的滚动祖先（通常是视口）的位置。<br> 这里是一个简单的例子：</p> 
<pre><code class="prism language-cpp"><span class="token operator">&lt;</span><span class="token keyword">template</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div ref<span class="token operator">=</span><span class="token string">"boxRef"</span><span class="token operator">&gt;</span>Hello World<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">template</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> ref<span class="token punctuation">,</span> onMounted <span class="token punctuation">}</span> from <span class="token char">'vue'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> boxRef <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建一个响应式引用boxRef，它将指向div元素</span>
  <span class="token comment">//在onMounted钩子中，我们确保当组件挂载后获取这个元素的getBoundingClientRect属性。这个属性包含了元素的大小以及相对于视口的位置。</span>
<span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>boxRef<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> rect <span class="token operator">=</span> boxRef<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rect<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> 
<p><mark>如果你想要监听元素上的右键点击事件，并获取该元素的位置，你可以使用@contextmenu.prevent来监听右键点击事件，并使用getBoundingClientRect方法来获取元素的位置。</mark><br> 这里是如何实现的一个例子：</p> 
<pre><code class="prism language-cpp"><span class="token operator">&lt;</span><span class="token keyword">template</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div ref<span class="token operator">=</span><span class="token string">"myElement"</span> @contextmenu<span class="token punctuation">.</span>prevent<span class="token operator">=</span><span class="token string">"handleRightClick"</span><span class="token operator">&gt;</span>
    右键点击我
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">template</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> ref <span class="token punctuation">}</span> from <span class="token char">'vue'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> myElement <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span>

function <span class="token function">handleRightClick</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>myElement<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">//获取了元素的位置信息rect，它包含了元素相对于视口的位置和大小。</span>
  <span class="token comment">//使用event.clientX和event.clientY来获取鼠标指针相对于浏览器视口的位置，并从中减去元素的位置，从而得到鼠标指针相对于元素左上角的位置。</span>
    <span class="token keyword">const</span> rect <span class="token operator">=</span> myElement<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> x <span class="token operator">=</span> event<span class="token punctuation">.</span>clientX <span class="token operator">-</span> rect<span class="token punctuation">.</span>left<span class="token punctuation">;</span>
    <span class="token keyword">const</span> y <span class="token operator">=</span> event<span class="token punctuation">.</span>clientY <span class="token operator">-</span> rect<span class="token punctuation">.</span>top<span class="token punctuation">;</span>
    
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token char">'元素位置:'</span><span class="token punctuation">,</span> rect<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token char">'相对于元素的点击位置:'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 阻止浏览器默认上下文菜单显示</span>
    event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//额外例子 如果你获取offsetWidth值 如下：</span>
 <span class="token keyword">const</span> offsetWidth <span class="token operator">=</span> myElement<span class="token punctuation">.</span>value<span class="token punctuation">.</span>offsetWidth<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token char">'元素的offsetWidth:'</span><span class="token punctuation">,</span> offsetWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> 
<p>请注意，getBoundingClientRect返回的位置是相对于视口的，而不是相对于文档的。如果你需要相对于整个文档的位置，你需要将视口滚动偏移量考虑进去。这通常涉及到使用window.scrollX和window.scrollY（或者document.documentElement.scrollLeft和document.documentElement.scrollTop）来获取这些值，并将它们加到rect.left和rect.top上。</p> 
<p><mark>在Vue 3中，如果你有一个通过v-for循环渲染的元素列表，并且 你想要在右键点击这些元素时获取它们的位置，你可以为每个元素添加一个唯一的引用，并在事件处理函数中通过该引用获取元素的位置。</mark></p> 
<p>以下是一个示例，展示了如何为循环渲染的元素添加右键点击事件，并获取它们的位置：</p> 
<pre><code class="prism language-cpp"><span class="token operator">&lt;</span><span class="token keyword">template</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div
      v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item, index) in items"</span>
      <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"item.id"</span>
      <span class="token operator">:</span>ref<span class="token operator">=</span><span class="token string">"`itemRef${index}`"</span>
      @contextmenu<span class="token punctuation">.</span>prevent<span class="token operator">=</span><span class="token string">"handleRightClick(index, $event)"</span>
      style<span class="token operator">=</span><span class="token string">"margin-bottom: 10px; padding: 10px; background-color: lightgray;"</span>
    <span class="token operator">&gt;</span>
      Item <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> item<span class="token punctuation">.</span>id <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">template</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> ref<span class="token punctuation">,</span> onMounted <span class="token punctuation">}</span> from <span class="token char">'vue'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> items <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{<!-- --></span> id<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span> id<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span> id<span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// ...其他项目</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> itemRefs <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 存储所有项目的引用</span>

<span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 假设你需要在组件挂载后做一些事情，比如为动态生成的ref添加事件监听器等</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

function <span class="token function">handleRightClick</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> event<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> refName <span class="token operator">=</span> `itemRef$<span class="token punctuation">{<!-- --></span>index<span class="token punctuation">}</span>`<span class="token punctuation">;</span>
  <span class="token keyword">const</span> itemElement <span class="token operator">=</span> itemRefs<span class="token punctuation">.</span>value<span class="token punctuation">[</span>refName<span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>itemElement<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> rect <span class="token operator">=</span> itemElement<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token char">'元素位置:'</span><span class="token punctuation">,</span> rect<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token char">'相对于元素的点击位置:'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
      x<span class="token operator">:</span> event<span class="token punctuation">.</span>clientX <span class="token operator">-</span> rect<span class="token punctuation">.</span>left<span class="token punctuation">,</span>
      y<span class="token operator">:</span> event<span class="token punctuation">.</span>clientY <span class="token operator">-</span> rect<span class="token punctuation">.</span>top
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> 
<p>在这个例子中，我们为每个循环渲染的元素创建了一个唯一的引用名称，通过拼接字符串"itemRef"和当前元素的索引index来实现。然后，在handleRightClick函数中，我们使用这个引用名称来获取对应的DOM元素，并调用getBoundingClientRect来获取元素的位置。</p> 
<p>请注意，itemRefs是一个响应式对象，用于存储所有动态生成的ref。当Vue渲染这些元素时，每个元素的ref都会被自动添加到itemRefs对象中，并且可以使用它们的引用名称来访问。</p> 
<p>此外，@contextmenu.prevent指令用于监听右键点击事件，并阻止默认的上下文菜单显示。$event是Vue的特殊变量，代表原生DOM事件对象，你可以用它来获取鼠标的位置等信息。</p> 
<p>如果上述循环绑定的ref还是找不到元素 ，可以试试写法<br> :ref=“el =&gt; { if (el) itemRefs.value[index] = el; }”<br> 代码如下：</p> 
<pre><code class="prism language-cpp"><span class="token operator">&lt;</span>div
      v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"(item, index) in items"</span>
      <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"item.id"</span>
      <span class="token operator">:</span>ref<span class="token operator">=</span><span class="token string">"el =&gt; { if (el) itemRefs.value[index] = el; }"</span>
      style<span class="token operator">=</span><span class="token string">"margin-bottom: 10px; padding: 10px; background-color: lightgray;"</span>
    <span class="token operator">&gt;</span>
      Item <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> item<span class="token punctuation">.</span>id <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token comment">// 使用 reactive 来创建一个响应式对象，用于存储所有元素的引用</span>
<span class="token keyword">const</span> itemRefs <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 组件挂载后，你可以访问每个元素的引用</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> index in itemRefs<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>itemRefs<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> itemRefs<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">const</span> rect <span class="token operator">=</span> itemRefs<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>`Item $<span class="token punctuation">{<!-- --></span>index<span class="token punctuation">}</span> 位置<span class="token operator">:</span>`<span class="token punctuation">,</span> rect<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>请确保你的项目已经正确设置，并且你正在使用Vue 3的Composition API语法。如果你的项目配置有所不同，可能需要进行一些调整来使这段代码正常工作。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/27e0857863133ae84ef6f2ccf7837f6f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【MySQL】索引</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3caa0f538aa66206b1e34b61c12ac6b4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Docker】Docker 配置镜像加速</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>