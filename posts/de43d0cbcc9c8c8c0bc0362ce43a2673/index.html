<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android 14 抓包、安装系统证书 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/de43d0cbcc9c8c8c0bc0362ce43a2673/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Android 14 抓包、安装系统证书">
  <meta property="og:description" content="Fiddler/Charles安卓14抓包问题解决，系统根证书安装 准备阶段Magisk 安装扩展将.cre格式证书转换为.pem格式证书提权特殊情况结语 准备阶段 一台已经 ROOT 的安卓手机手机安装 Masgisk APK MT管理器 APK(应用市场下载)电脑安装 OpenSSL，将C:\Program Files\OpenSSL-Win64\bin 配置为环境变量电脑 安装 android ADB Magisk 安装扩展 下载插件 Magisk-MoveCACerts.zip打开 Magisk -&gt; 扩展 -&gt; 从本地安装 -&gt; 选择Magisk-MoveCACerts.zip 即可安装启用插件 将.cre格式证书转换为.pem格式 如果已经导出 .PEM 文件则跳过
# 下面两个选择一个执行得到 .pem 文件即可 openssl x509 -in 你的证书名称.cer -inform DER -out 导出名称.pem -outform PEM openssl x509 -inform DER -in 你的证书名称.cer -outform PEM -out 导出名称.pem # 执行拿到文件名 openssl x509 -subject_hash_old -in 导出名称.pem # 运行上面的命令就会得到如下结果 269953fb 就是我们要的文件名 269953fb -----BEGIN CERTIFICATE----- MIIDsjCCApqgAwIBAgIQb/tq6VqiEIVHT5A/hQ0JIzANBgkqhkiG9w0BAQsFADBn MSswKQYDVQQLDCJDcmVhdGVkIGJ5IGh0dHA6Ly93d3cuZmlkZGxlcjIuY29tMRUw EwYDVQQKDAxET19OT1RfVFJVU1QxITAfBgNVBAMMGERPX05PVF9UUlVTVF9GaWRk bGVyUm9vdDAeFw0yMDExMDUyMjUwNThaFw0yNDAyMDQyMjUwNThaMGcxKzApBgNV BAsMIkNyZWF0ZWQgYnkgaHR0cDovL3d3dy5maWRkbGVyMi5jb20xFTATBgNVBAoM DERPX05PVF9UUlVTVDEhMB8GA1UEAwwYRE9fTk9UX1RSVVNUX0ZpZGRsZXJSb290 MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAr56FARMvcx5avQIUSm/5 FjSfrG&#43;5q7rSrwXXh9C7c/2Rcbl5qzybtaXLYqOml7w2hGQB4zoT2bB3hxXa/kgM 2VJOEKNRxpIp5wpbcwetC&#43;7keqPnnAAdkK8zX7fG&#43;t94GR9JQHLYQZ6rolUgpmaC zqHY3OCBbmykMXJEoM&#43;RRhNiYb4wFH6yV5XxOYrigne4wAvfrMdHpdzPpOQYcRLV AL2DvDC9XAmIMLdJGp5KebU7cX6S3r1bBj03OZkSafvyLOTgS12ABCN1fzr5azsq sU4aZiHQB3JnB66J2y4TkcxuSffaOkMeNOd060jYnaSYc1cmxH7FkC3&#43;nE/bEdb/ tQIDAQABo1owWDATBgNVHSUEDDAKBggrBgEFBQcDATASBgNVHRMBAf8ECDAGAQH/ AgEAMB0GA1UdDgQWBBQAHc9JtuJEm6bzwNIvOTR9vVcHkzAOBgNVHQ8BAf8EBAMC AQYwDQYJKoZIhvcNAQELBQADggEBAE232n06TExQDR7fsuZPrwZFL5Eqk6BhUuD6 3al5gTbcGO1opCZMz7zKqaAH1iqn0Ip3clYen6GsVVa8gEbw0u/En7A&#43;5CeMpL7y dg4tyNHv3iiubzGU1980GcG2kziBV6roNGISkOXtMbMM0IJoshzG9f4YKvWSZnmw PLnYjWpaiBBtehZ2g4OAjCQBAgqSp9IIQsm5YbYNgtEn1aBWkrVrgZ54HesZKQM5 np7Fgzcms4320f&#43;SIzY&#43;XAJ4oUYI4vHvRdRszvTdZQjmTInTcwiyBLvPpl0kawg8 MUKqgAsxI0rWIH0mc&#43;PkLmOENpfkglJO2Ko/BEWBpeIJxBg&#43;Sv8= -----END CERTIFICATE----- 通过上面的命令会拿到一个ID 269953fb">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-12T01:28:45+08:00">
    <meta property="article:modified_time" content="2024-04-12T01:28:45+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android 14 抓包、安装系统证书</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>Fiddler/Charles安卓14抓包问题解决，系统根证书安装</h4> 
 <ul><li><ul><li><a href="#_2" rel="nofollow">准备阶段</a></li><li><a href="#Magisk__9" rel="nofollow">Magisk 安装扩展</a></li><li><a href="#crepem_13" rel="nofollow">将.cre格式证书转换为.pem格式</a></li><li><a href="#_56" rel="nofollow">证书提权</a></li><li><a href="#_66" rel="nofollow">特殊情况</a></li><li><a href="#_77" rel="nofollow">结语</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_2"></a>准备阶段</h3> 
<blockquote> 
 <ol><li>一台已经 <strong>ROOT</strong> 的安卓手机</li><li>手机安装 <a href="https://github.com/topjohnwu/Magisk/releases">Masgisk APK</a> <strong>MT管理器 APK</strong>(应用市场下载)</li><li>电脑安装 <a href="https://slproweb.com/products/Win32OpenSSL.html" rel="nofollow">OpenSSL</a>，将<code>C:\Program Files\OpenSSL-Win64\bin</code> 配置为环境变量</li><li>电脑 安装 <strong>android ADB</strong></li></ol> 
</blockquote> 
<h3><a id="Magisk__9"></a>Magisk 安装扩展</h3> 
<blockquote> 
 <ol><li>下载插件 <a href="https://github.com/wjf0214/Magisk-MoveCACerts/releases/tag/V1.1.1">Magisk-MoveCACerts.zip</a></li><li>打开 <strong>Magisk -&gt; 扩展 -&gt; 从本地安装 -&gt; 选择Magisk-MoveCACerts.zip</strong> 即可安装</li><li>启用插件</li></ol> 
</blockquote> 
<h3><a id="crepem_13"></a>将.cre格式证书转换为.pem格式</h3> 
<blockquote> 
 <p><em>如果已经导出 .PEM 文件则跳过</em></p> 
</blockquote> 
<pre><code class="prism language-shell"><span class="token comment"># 下面两个选择一个执行得到 .pem 文件即可</span>
openssl x509 <span class="token parameter variable">-in</span> 你的证书名称.cer <span class="token parameter variable">-inform</span> DER <span class="token parameter variable">-out</span> 导出名称.pem <span class="token parameter variable">-outform</span> PEM
openssl x509 <span class="token parameter variable">-inform</span> DER <span class="token parameter variable">-in</span> 你的证书名称.cer  <span class="token parameter variable">-outform</span> PEM <span class="token parameter variable">-out</span> 导出名称.pem
<span class="token comment"># 执行拿到文件名</span>
openssl x509 <span class="token parameter variable">-subject_hash_old</span> <span class="token parameter variable">-in</span> 导出名称.pem
<span class="token comment"># 运行上面的命令就会得到如下结果  269953fb  就是我们要的文件名</span>
269953fb
-----BEGIN CERTIFICATE-----
MIIDsjCCApqgAwIBAgIQb/tq6VqiEIVHT5A/hQ0JIzANBgkqhkiG9w0BAQsFADBn
MSswKQYDVQQLDCJDcmVhdGVkIGJ5IGh0dHA6Ly93d3cuZmlkZGxlcjIuY29tMRUw
EwYDVQQKDAxET19OT1RfVFJVU1QxITAfBgNVBAMMGERPX05PVF9UUlVTVF9GaWRk
bGVyUm9vdDAeFw0yMDExMDUyMjUwNThaFw0yNDAyMDQyMjUwNThaMGcxKzApBgNV
BAsMIkNyZWF0ZWQgYnkgaHR0cDovL3d3dy5maWRkbGVyMi5jb20xFTATBgNVBAoM
DERPX05PVF9UUlVTVDEhMB8GA1UEAwwYRE9fTk9UX1RSVVNUX0ZpZGRsZXJSb290
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAr56FARMvcx5avQIUSm/5
FjSfrG+5q7rSrwXXh9C7c/2Rcbl5qzybtaXLYqOml7w2hGQB4zoT2bB3hxXa/kgM
2VJOEKNRxpIp5wpbcwetC+7keqPnnAAdkK8zX7fG+t94GR9JQHLYQZ6rolUgpmaC
zqHY3OCBbmykMXJEoM+RRhNiYb4wFH6yV5XxOYrigne4wAvfrMdHpdzPpOQYcRLV
AL2DvDC9XAmIMLdJGp5KebU7cX6S3r1bBj03OZkSafvyLOTgS12ABCN1fzr5azsq
sU4aZiHQB3JnB66J2y4TkcxuSffaOkMeNOd060jYnaSYc1cmxH7FkC3+nE/bEdb/
tQIDAQABo1owWDATBgNVHSUEDDAKBggrBgEFBQcDATASBgNVHRMBAf8ECDAGAQH/
AgEAMB0GA1UdDgQWBBQAHc9JtuJEm6bzwNIvOTR9vVcHkzAOBgNVHQ8BAf8EBAMC
AQYwDQYJKoZIhvcNAQELBQADggEBAE232n06TExQDR7fsuZPrwZFL5Eqk6BhUuD6
3al5gTbcGO1opCZMz7zKqaAH1iqn0Ip3clYen6GsVVa8gEbw0u/En7A+5CeMpL7y
dg4tyNHv3iiubzGU1980GcG2kziBV6roNGISkOXtMbMM0IJoshzG9f4YKvWSZnmw
PLnYjWpaiBBtehZ2g4OAjCQBAgqSp9IIQsm5YbYNgtEn1aBWkrVrgZ54HesZKQM5
np7Fgzcms4320f+SIzY+XAJ4oUYI4vHvRdRszvTdZQjmTInTcwiyBLvPpl0kawg8
MUKqgAsxI0rWIH0mc+PkLmOENpfkglJO2Ko/BEWBpeIJxBg+Sv8<span class="token operator">=</span>
-----END CERTIFICATE-----
</code></pre> 
<blockquote> 
 <p>通过上面的命令会拿到一个ID <strong>269953fb</strong><br> 注意这个 269953fb 名字会用在下面命令的 -out 后面，然后加上【.0】后缀</p> 
</blockquote> 
<pre><code class="prism language-shell"><span class="token comment"># 通过这个命令命令会拿到一个 269953fb.0 文件，不同证书的最终导出文件名不一样哦</span>
openssl x509 <span class="token parameter variable">-inform</span> PEM <span class="token parameter variable">-in</span> 导出名称.pem <span class="token parameter variable">-out</span> 269953fb.0
</code></pre> 
<h3><a id="_56"></a>证书提权</h3> 
<blockquote> 
 <ol><li>先将【269953fb.0】文件通过USB连接后手机根目录</li><li>打开 <strong>MT管理器</strong></li><li>左侧打开 <strong>269953fb.0</strong> 所在目录</li><li>右侧打开目录<code>system/etc/security/cacerts</code></li><li>手指长安 <strong>269953fb.0</strong> 文件选择 <strong>移动</strong> 操作</li><li>移动成功后长按右侧 <strong>269953fb.0</strong> 选择 <strong>属性</strong></li><li>更改权限为 <strong>664</strong></li><li>重启手机查看证书是否在<strong>系统证书</strong>下</li></ol> 
</blockquote> 
<h3><a id="_66"></a>特殊情况</h3> 
<blockquote> 
 <ol><li>如果重启后发现证书不在<strong>系统证书</strong></li><li>重复上面的步骤，将步骤4 的路径改为 <code>/data/adb/modules/MoveCACerts/system/etc/security/cacerts/</code> 即可</li></ol> 
</blockquote> 
<blockquote> 
 <p>⚠️ 注意：如果手机已经安装了模块，后续追加的证书可以直接放入<br> <code>/data/adb/modules/MoveCACerts/system/etc/security/cacerts/</code> 目录下，再重启手机即可。</p> 
</blockquote> 
<blockquote> 
 <p>如果发现连接代理后，没有网络，WIFI显示网络受限，多半还是证书原因。尝试以下方法：</p> 
 <ol><li>删除 <code>/data/adb/modules/MoveCACerts/system/etc/security/cacerts/</code> 重新导入全新的证书，因为可能有其他证书。</li><li>检查电脑代理工具配置，比如看看IOS端能否正常抓包</li></ol> 
</blockquote> 
<h3><a id="_77"></a>结语</h3> 
<blockquote> 
 <p>本文旨在帮助你把证书导入到系统跟目录。<br> 本人在使用过程中也发现了一些问题，比如电脑端设备不同，抓包工具不同，但是都能通过重新安装证书去解决，如果发现你的抓包工具无法抓包可能还是你工具配置的问题，比如 Fiddler 可能需要安装 CertMaker for iOS and Android 插件，这些问题还需要您另行百度了。</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ab3c6de0d50f9f6666de83d887c514e2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">JavaScript中GET和POST对比</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/583255541f2533784a4dd68904b2ac3a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Prometheus监控Kafka（三种方法JMX Kafka_exporter KMINION监控Kafka）_kafka exporter</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>