<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Hbase Java编程 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/87e988a9794557be209fc92dde53cebb/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Hbase Java编程">
  <meta property="og:description" content="一.准备工作 首先创建一个Maven，选择 IDEA 所 关联的 Maven 配置文件（settings.xml）。
在pom.xml文件里面插入一段代码（改成自己的hbase版本）
&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.hbase&lt;/groupId&gt; &lt;artifactId&gt;hbase-client&lt;/artifactId&gt; &lt;version&gt;2.4.11&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; 添加配置文件 hbase-site.xml到resource里面
二.操作 建表
import org.apache.hadoop.conf.Configuration; import org.apache.hadoop.hbase.HBaseConfiguration; import org.apache.hadoop.hbase.TableName; import org.apache.hadoop.hbase.client.*; import org.apache.hadoop.hbase.util.Bytes; import java.io.IOException; public class createTbale { public static void main(String[] args) throws IOException { Configuration configuration = HBaseConfiguration.create(); configuration.set(&#34;hbase.zookeeper.quorum&#34;,&#34;192.168.56.8&#34;); Connection connection = ConnectionFactory.createConnection(configuration); Admin admin = null; { try { connection = ConnectionFactory.createConnection(configuration); System.out.println(connection); admin = connection.getAdmin(); System.out.println(admin); TableName tableName = TableName.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-23T10:17:56+08:00">
    <meta property="article:modified_time" content="2024-04-23T10:17:56+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Hbase Java编程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>一.准备工作</h3> 
<p>首先创建一个Maven，<span style="color:#000000;">选择 IDEA 所 关联的 Maven 配置文件（settings.xml）。</span></p> 
<p>在pom.xml文件里面插入一段代码（改成自己的hbase版本）</p> 
<pre><code class="language-java">&lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.hbase&lt;/groupId&gt;
            &lt;artifactId&gt;hbase-client&lt;/artifactId&gt;
            &lt;version&gt;2.4.11&lt;/version&gt;
        &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre> 
<p>添加配置文件 hbase-site.xml到resource里面</p> 
<h3>二.操作</h3> 
<ol><li> <h4>建表<br>  </h4> 
  <blockquote> 
   <pre><code class="language-java">import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.hbase.HBaseConfiguration;
import org.apache.hadoop.hbase.TableName;
import org.apache.hadoop.hbase.client.*;
import org.apache.hadoop.hbase.util.Bytes;
import java.io.IOException;


public class createTbale {
    public static void main(String[] args) throws IOException {
        Configuration configuration = HBaseConfiguration.create();
        configuration.set("hbase.zookeeper.quorum","192.168.56.8");
        Connection connection = ConnectionFactory.createConnection(configuration);
          Admin admin = null;
        {
            try {
                connection = ConnectionFactory.createConnection(configuration);
                System.out.println(connection);
                admin = connection.getAdmin();
                System.out.println(admin);
                TableName tableName = TableName.valueOf("WATER_BILL");
                // 2 构建表描述构建器
                TableDescriptorBuilder tableDescriptorBuilder = TableDescriptorBuilder.newBuilder(tableName);
                // 3 构建列簇描述构建器
                ColumnFamilyDescriptorBuilder columnFamilyDescriptorBuilder = ColumnFamilyDescriptorBuilder.newBuilder(Bytes.toBytes("C1"));
                // 4 构建列蔟描述
                ColumnFamilyDescriptor columnFamilyDescriptor = columnFamilyDescriptorBuilder.build();
                // 5 构建表描述
                tableDescriptorBuilder.setColumnFamily(columnFamilyDescriptor);
                // 5)定义表描述对象  添加列蔟
                TableDescriptor tableDescriptor = tableDescriptorBuilder.build();
                // 6)创建表
                admin.createTable(tableDescriptor);
            } catch (IOException e) {
                e.printStackTrace();
            } finally {
                assert admin != null;
                admin.close();
                connection.close();
            }
        }
    }
}</code></pre> 
  </blockquote> <p></p> </li><li> <h4>添加数据<br>  </h4> <pre><code class="language-java">public class addTable {
    public static void putTable(Connection connection,String tableName,String C1,String columnFamily,String column,String value) throws IOException {

        Table table=connection.getTable(TableName.valueOf(tableName));
        Put put=new Put(Bytes.toBytes(C1));
        put.addColumn(Bytes.toBytes(columnFamily),Bytes.toBytes(column),Bytes.toBytes(value));
        table.put(put);
        table.close();
    }</code></pre> <p></p> </li><li> <h4>添加多个数据<br>  </h4> <pre><code class="language-java"> public static void addListData() throws IOException{
        Configuration configuration = HBaseConfiguration.create();
        configuration.set("hbase.zookeeper.quorum","192.168.56.8");
        Connection connection = ConnectionFactory.createConnection(configuration);
        List&lt;Put&gt; puts=new ArrayList&lt;Put&gt;();
        Put haha=new Put(Bytes.toBytes("1"));
        haha.addColumn(Bytes.toBytes("C1"),Bytes.toBytes("ADDRESS"),Bytes.toBytes("贵州省铜仁市德江县7单元267室"));
        haha.addColumn(Bytes.toBytes("C1"),Bytes.toBytes("SEX"),Bytes.toBytes("男"));
        haha.addColumn(Bytes.toBytes("C1"),Bytes.toBytes("PAY_DATE"),Bytes.toBytes("2020-05-10"));
        haha.addColumn(Bytes.toBytes("C1"),Bytes.toBytes("NUM_CURRENT"),Bytes.toBytes("308.1"));
        haha.addColumn(Bytes.toBytes("C1"),Bytes.toBytes("NUM_PREVIOUS"),Bytes.toBytes("283.1"));
        haha.addColumn(Bytes.toBytes("C1"),Bytes.toBytes("NUM_USAGE"),Bytes.toBytes("25"));
        puts.add(haha);
        Table table=connection.getTable(TableName.valueOf("WATER_BILL"));
        table.put(puts);
    }</code></pre> <p></p> </li><li> <h4>打印数据<br>  </h4> <pre><code class="language-java">public static void printData() throws IOException {
          Configuration configuration = HBaseConfiguration.create();
          configuration.set("hbase.zookeeper.quorum","192.168.56.8");
          Connection connection = ConnectionFactory.createConnection(configuration);
          TableName waterBillTableName = TableName.valueOf("WATER_BILL");
          Table waterBilltable = connection.getTable(waterBillTableName);
          Get get = new Get(Bytes.toBytes("1"));
          Result result = waterBilltable.get(get);
          List&lt;Cell&gt; cellList = result.listCells();
          System.out.println("rowkey =&gt; " + Bytes.toString(result.getRow()));
          for (Cell cell : cellList) {
              // 打印列蔟名
              System.out.print(Bytes.toString(cell.getQualifierArray(),
                      cell.getQualifierOffset(), cell.getQualifierLength()));
              System.out.println(" =&gt; " + Bytes.toString(cell.getValueArray(),
                      cell.getValueOffset(), cell.getValueLength()));
          }
          waterBilltable.close();
      }</code></pre> <p></p> </li><li> <h4>删除数据<br>  </h4> <pre><code class="language-java">     public static void deleteData() throws IOException {
          Configuration configuration = HBaseConfiguration.create();
          configuration.set("hbase.zookeeper.quorum","192.168.56.8");
          Connection connection = ConnectionFactory.createConnection(configuration);
          Table waterBillTable = connection.getTable(TableName.valueOf("WATER_BILL"));
          Delete delete = new Delete(Bytes.toBytes("1"));
          waterBillTable.delete(delete);
          waterBillTable.close();
      }</code></pre> <p></p> </li><li> <h4>删除表<br>  </h4> <pre><code class="language-java"> public static boolean deleTable() throws IOException{
          Configuration configuration = HBaseConfiguration.create();
          configuration.set("hbase.zookeeper.quorum","192.168.56.8");
          Connection connection = ConnectionFactory.createConnection(configuration);
          TableName tableName = TableName.valueOf("WATER_BILL");
          Admin admin =connection.getAdmin();
          if (admin.tableExists(tableName)){
              admin.disableTable(tableName);
              admin.deleteTable(tableName);
              return true;
          }else {
              return false;
          }
      }</code></pre> <p></p> </li><li> <h4>主函数 <br>  </h4> <pre><code class="language-java">public static void main(String[] args) throws IOException {
          boolean result=deleTable();
          if (result){
              System.out.println("删除成功");
          }else
              System.out.println("表不存在");
          //删除数据
       deleteData();
        //打印数据
        printData();
        //添加多列数据
        addListData();
        Configuration configuration = HBaseConfiguration.create();
        configuration.set("hbase.zookeeper.quorum","192.168.56.8");
        Connection connection = ConnectionFactory.createConnection(configuration);
        Admin admin =connection.getAdmin();
        //添加单个数据
        putTable(admin.getConnection(),"WATER_BILL","1","C1","NAME","zhangsan");
        admin.close();

    }</code></pre> <p></p> </li></ol> 
<h2>三.遇到的问题 </h2> 
<h3>1.运行时间过长</h3> 
<p>解决措施</p> 
<p>在/etc/hostname下面更改主机名和IP地址的映射关系</p> 
<h3>2. org.apache.hadoop.hbase.MasterNotRunningException</h3> 
<p style="margin-left:.0001pt;text-align:justify;">解决措施：打开C:\Windows\System32\drivers\etc目录，按住win+x，选择命令提示符（管理员），输入notepad，将打开记事本，选择文件下的打开，点击选择文件类型为所有文件类型，打开host文件，添加自己hadoop集群的IP地址和master信息，然后重新运行即可。</p> 
<p></p> 
<h2>此代码都是建立在伪分布的系统上运行。 </h2>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ae538eb4d3cd62e1d8a13eae24ddc268/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">在Mac M1笔记本上跑大语言模型llama3的4个步骤？（install、pull、run、ask）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bed33520b6fbff8b24f99eecec52df4c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">智能优化算法的原理分类，为什么要用最新的算法？为什么要掌握多种算法？（附2023/2024最新智能优化算法合集matlab代码）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>