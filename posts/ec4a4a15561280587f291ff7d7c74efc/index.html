<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>RabbitMQçš„åŸºæœ¬ä½¿ç”¨&amp;å…¥é—¨ - ç¼–ç¨‹å¤§å’–</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/ec4a4a15561280587f291ff7d7c74efc/">
  <meta property="og:site_name" content="ç¼–ç¨‹å¤§å’–">
  <meta property="og:title" content="RabbitMQçš„åŸºæœ¬ä½¿ç”¨&å…¥é—¨">
  <meta property="og:description" content="å‰è¨€ RabbitMQæ˜¯ä¸€ä¸ªå¼€æºçš„æ¶ˆæ¯ä»£ç†è½¯ä»¶ï¼Œç”¨äºå¤„ç†åº”ç”¨ç¨‹åºä¹‹é—´çš„æ¶ˆæ¯ä¼ é€’ã€‚å®ƒå®ç°äº†é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®ï¼ˆAMQPï¼‰ï¼Œæ˜¯ä¸€ä¸ªå¯é ä¸”çµæ´»çš„æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå¹¿æ³›ç”¨äºæ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿã€å¾®æœåŠ¡æ¶æ„ä»¥åŠå¼‚æ„ç³»ç»Ÿä¹‹é—´çš„é€šä¿¡Â ï¼Œæœ¬æœŸæ–‡ç« å°†ä¸ºå¤§å®¶å¸¦æ¥RabbitMQçš„åŸºæœ¬ä½¿ç”¨åŠå…¥é—¨
ä¸€.RabbitMQåŸºæœ¬ä»‹ç» RabbitMQå¯ä»¥å®ç°å¯é çš„å¼‚æ­¥é€šä¿¡ï¼Œè§£è€¦ç³»ç»Ÿä¸­çš„ç»„ä»¶ï¼Œä»¥åŠå¤„ç†é«˜å¹¶å‘å’Œå¤§è§„æ¨¡çš„æ¶ˆæ¯æµã€‚å®ƒåœ¨è®¸å¤šé¢†åŸŸï¼Œå¦‚å¾®æœåŠ¡æ¶æ„ã€æ—¥å¿—å¤„ç†ã€ä»»åŠ¡è°ƒåº¦ç­‰æ–¹é¢éƒ½æœ‰å¹¿æ³›çš„åº”ç”¨
æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessage Queueï¼‰ï¼š RabbitMQä½œä¸ºæ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå®ƒå…è®¸åº”ç”¨ç¨‹åºä¹‹é—´é€šè¿‡æ¶ˆæ¯è¿›è¡Œé€šä¿¡ã€‚æ¶ˆæ¯è¢«å‘é€åˆ°é˜Ÿåˆ—ä¸­ï¼Œç„¶åç”±æ¶ˆè´¹è€…ä»é˜Ÿåˆ—ä¸­æ¥æ”¶å¹¶å¤„ç†ã€‚
ç”Ÿäº§è€…ï¼ˆProducerï¼‰ï¼š ç”Ÿäº§è€…æ˜¯å°†æ¶ˆæ¯å‘é€åˆ°RabbitMQçš„åº”ç”¨ç¨‹åºã€‚å®ƒå°†æ¶ˆæ¯å‘å¸ƒåˆ°ä¸€ä¸ªæˆ–å¤šä¸ªé˜Ÿåˆ—ã€‚
æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰ï¼š æ¶ˆè´¹è€…æ˜¯ä»RabbitMQæ¥æ”¶æ¶ˆæ¯å¹¶è¿›è¡Œå¤„ç†çš„åº”ç”¨ç¨‹åºã€‚ä¸€ä¸ªé˜Ÿåˆ—å¯ä»¥æœ‰å¤šä¸ªæ¶ˆè´¹è€…ï¼Œä½†æ¯æ¡æ¶ˆæ¯åªä¼šè¢«ä¸€ä¸ªæ¶ˆè´¹è€…å¤„ç†ã€‚
äº¤æ¢æœºï¼ˆExchangeï¼‰ï¼š äº¤æ¢æœºè´Ÿè´£å°†æ¶ˆæ¯è·¯ç”±åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªé˜Ÿåˆ—ã€‚ç”Ÿäº§è€…å°†æ¶ˆæ¯å‘é€åˆ°äº¤æ¢æœºï¼Œè€Œäº¤æ¢æœºåˆ™å°†æ¶ˆæ¯è·¯ç”±åˆ°ç›¸å…³çš„é˜Ÿåˆ—ã€‚
é˜Ÿåˆ—ï¼ˆQueueï¼‰ï¼š é˜Ÿåˆ—æ˜¯å­˜å‚¨æ¶ˆæ¯çš„åœ°æ–¹ï¼Œå®ƒæ˜¯æ¶ˆæ¯çš„ç»ˆç‚¹ã€‚æ¶ˆè´¹è€…ä»é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯å¹¶è¿›è¡Œå¤„ç†ã€‚
ç»‘å®šï¼ˆBindingï¼‰ï¼š ç»‘å®šæ˜¯äº¤æ¢æœºå’Œé˜Ÿåˆ—ä¹‹é—´çš„å…³ç³»ï¼Œå®ƒå®šä¹‰äº†å¦‚ä½•å°†æ¶ˆæ¯ä»äº¤æ¢æœºè·¯ç”±åˆ°é˜Ÿåˆ—ã€‚
æŒä¹…æ€§ï¼ˆDurableï¼‰ï¼š RabbitMQæ”¯æŒå°†é˜Ÿåˆ—å’Œæ¶ˆæ¯æ ‡è®°ä¸ºæŒä¹…æ€§ï¼Œä»¥ç¡®ä¿åœ¨æœåŠ¡å™¨é‡å¯æ—¶æ•°æ®ä¸ä¼šä¸¢å¤±ã€‚
è™šæ‹Ÿä¸»æœºï¼ˆVirtual Hostï¼‰ï¼š è™šæ‹Ÿä¸»æœºæ˜¯RabbitMQä¸­æ¶ˆæ¯éš”ç¦»çš„å•ä½ï¼Œå…è®¸åœ¨åŒä¸€RabbitMQæœåŠ¡å™¨ä¸Šåˆ›å»ºå¤šä¸ªç‹¬ç«‹çš„æ¶ˆæ¯ä»£ç†ã€‚
ACKï¼ˆAcknowledgmentï¼‰ï¼š æ¶ˆè´¹è€…åœ¨å¤„ç†å®Œæ¶ˆæ¯åå‘é€ACKï¼Œé€šçŸ¥RabbitMQè¯¥æ¶ˆæ¯å·²è¢«æˆåŠŸå¤„ç†ã€‚è¿™ç¡®ä¿æ¶ˆæ¯ä¸ä¼šåœ¨å¤„ç†å¤±è´¥æ—¶ä¸¢å¤±ã€‚
æ’ä»¶ç³»ç»Ÿï¼š RabbitMQå…·æœ‰ä¸°å¯Œçš„æ’ä»¶ç³»ç»Ÿï¼Œå…è®¸æ‰©å±•å’Œå®šåˆ¶å…¶åŠŸèƒ½
1.å¸¸è§æ¶ˆæ¯é˜Ÿåˆ— 2.Dockerå®‰è£…éƒ¨ç½²RabbitMQ 1.æ‹‰å–é•œåƒ docker pull rabbitmq:management 2.åˆ›å»ºå®¹å™¨ å‘½ä»¤è¯¦è§£ï¼š
åœ¨åå°è¿è¡Œä¸€ä¸ªRabbitMQå®¹å™¨ï¼Œé€šè¿‡ä¸»æœºçš„5672ç«¯å£å¯ä»¥è®¿é—®RabbitMQçš„AMQPæœåŠ¡ï¼Œé€šè¿‡ä¸»æœºçš„15672ç«¯å£å¯ä»¥è®¿é—®RabbitMQçš„ç®¡ç†ç•Œé¢ã€‚RabbitMQçš„é»˜è®¤è™šæ‹Ÿä¸»æœºä¸º&#34;my_vhost&#34;ï¼Œé»˜è®¤ç”¨æˆ·åå’Œå¯†ç ä¸º&#34;admin&#34;ã€‚å®¹å™¨çš„ä¸»æœºåè¢«è®¾ç½®ä¸º&#34;my-rabbitmq-host&#34;ã€‚å®¹å™¨å°†åœ¨å®ˆæŠ¤è¿›ç¨‹å¯åŠ¨æ—¶è‡ªåŠ¨é‡æ–°å¯åŠ¨
åœ¨è™šæ‹Ÿæœºä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤Â docker run -d \ --name my-rabbitmq \ -p 5672:5672 -p 15672:15672 \ --hostname my-rabbitmq-host \ -e RABBITMQ_DEFAULT_VHOST=my_vhost \ -e RABBITMQ_DEFAULT_USER=admin \ -e RABBITMQ_DEFAULT_PASS=admin \ --restart=always \ rabbitmq:management å¼€æ”¾ç«¯å£
firewall-cmd --zone=public --add-port=15672/tcp --permanent firewall-cmd --zone=public --add-port=5672/tcp --permanent å®¹å™¨åˆ›å»ºè¿è¡Œå®Œæˆåæˆ‘ä»¬å¯ä»¥åœ¨è‡ªå·±çš„ä¸»æœºä¸Šé€šè¿‡IP:15672è¿›å…¥åˆ°ç®¡ç†å‘˜ç•Œé¢ï¼Œè´¦å·å¯†ç ä¸ºæˆ‘ä»¬ä¸Šé¢å‘½ä»¤æŒ‡å®šçš„adminï¼Œç™»å½•å³å¯">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-19T20:41:07+08:00">
    <meta property="article:modified_time" content="2024-01-19T20:41:07+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§å’–" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§å’–</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">RabbitMQçš„åŸºæœ¬ä½¿ç”¨&amp;å…¥é—¨</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>å‰è¨€</h2> 
<p>RabbitMQæ˜¯ä¸€ä¸ªå¼€æºçš„æ¶ˆæ¯ä»£ç†è½¯ä»¶ï¼Œç”¨äºå¤„ç†åº”ç”¨ç¨‹åºä¹‹é—´çš„æ¶ˆæ¯ä¼ é€’ã€‚å®ƒå®ç°äº†é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®ï¼ˆAMQPï¼‰ï¼Œæ˜¯ä¸€ä¸ªå¯é ä¸”çµæ´»çš„æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå¹¿æ³›ç”¨äºæ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿã€å¾®æœåŠ¡æ¶æ„ä»¥åŠå¼‚æ„ç³»ç»Ÿä¹‹é—´çš„é€šä¿¡Â ï¼Œæœ¬æœŸæ–‡ç« å°†ä¸ºå¤§å®¶å¸¦æ¥RabbitMQçš„åŸºæœ¬ä½¿ç”¨åŠå…¥é—¨</p> 
<p><img alt="" height="448" src="https://images2.imgbox.com/a0/08/ZdMkKOfA_o.png" width="1200"></p> 
<h2>Â ä¸€.RabbitMQåŸºæœ¬ä»‹ç»</h2> 
<p>RabbitMQå¯ä»¥å®ç°å¯é çš„å¼‚æ­¥é€šä¿¡ï¼Œè§£è€¦ç³»ç»Ÿä¸­çš„ç»„ä»¶ï¼Œä»¥åŠå¤„ç†é«˜å¹¶å‘å’Œå¤§è§„æ¨¡çš„æ¶ˆæ¯æµã€‚å®ƒåœ¨è®¸å¤šé¢†åŸŸï¼Œå¦‚å¾®æœåŠ¡æ¶æ„ã€æ—¥å¿—å¤„ç†ã€ä»»åŠ¡è°ƒåº¦ç­‰æ–¹é¢éƒ½æœ‰å¹¿æ³›çš„åº”ç”¨</p> 
<p><strong>æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessage Queueï¼‰ï¼š</strong> RabbitMQä½œä¸ºæ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå®ƒå…è®¸åº”ç”¨ç¨‹åºä¹‹é—´é€šè¿‡æ¶ˆæ¯è¿›è¡Œé€šä¿¡ã€‚æ¶ˆæ¯è¢«å‘é€åˆ°é˜Ÿåˆ—ä¸­ï¼Œç„¶åç”±æ¶ˆè´¹è€…ä»é˜Ÿåˆ—ä¸­æ¥æ”¶å¹¶å¤„ç†ã€‚</p> 
<p><strong>ç”Ÿäº§è€…ï¼ˆProducerï¼‰ï¼š</strong> ç”Ÿäº§è€…æ˜¯å°†æ¶ˆæ¯å‘é€åˆ°RabbitMQçš„åº”ç”¨ç¨‹åºã€‚å®ƒå°†æ¶ˆæ¯å‘å¸ƒåˆ°ä¸€ä¸ªæˆ–å¤šä¸ªé˜Ÿåˆ—ã€‚</p> 
<p><strong>æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰ï¼š</strong> æ¶ˆè´¹è€…æ˜¯ä»RabbitMQæ¥æ”¶æ¶ˆæ¯å¹¶è¿›è¡Œå¤„ç†çš„åº”ç”¨ç¨‹åºã€‚ä¸€ä¸ªé˜Ÿåˆ—å¯ä»¥æœ‰å¤šä¸ªæ¶ˆè´¹è€…ï¼Œä½†æ¯æ¡æ¶ˆæ¯åªä¼šè¢«ä¸€ä¸ªæ¶ˆè´¹è€…å¤„ç†ã€‚</p> 
<p><img alt="" height="262" src="https://images2.imgbox.com/67/d1/xXPuAdX0_o.png" width="1200"></p> 
<p><strong>äº¤æ¢æœºï¼ˆExchangeï¼‰ï¼š</strong> äº¤æ¢æœºè´Ÿè´£å°†æ¶ˆæ¯è·¯ç”±åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªé˜Ÿåˆ—ã€‚ç”Ÿäº§è€…å°†æ¶ˆæ¯å‘é€åˆ°äº¤æ¢æœºï¼Œè€Œäº¤æ¢æœºåˆ™å°†æ¶ˆæ¯è·¯ç”±åˆ°ç›¸å…³çš„é˜Ÿåˆ—ã€‚</p> 
<p><strong>é˜Ÿåˆ—ï¼ˆQueueï¼‰ï¼š</strong> é˜Ÿåˆ—æ˜¯å­˜å‚¨æ¶ˆæ¯çš„åœ°æ–¹ï¼Œå®ƒæ˜¯æ¶ˆæ¯çš„ç»ˆç‚¹ã€‚æ¶ˆè´¹è€…ä»é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯å¹¶è¿›è¡Œå¤„ç†ã€‚</p> 
<p><strong>ç»‘å®šï¼ˆBindingï¼‰ï¼š</strong> ç»‘å®šæ˜¯äº¤æ¢æœºå’Œé˜Ÿåˆ—ä¹‹é—´çš„å…³ç³»ï¼Œå®ƒå®šä¹‰äº†å¦‚ä½•å°†æ¶ˆæ¯ä»äº¤æ¢æœºè·¯ç”±åˆ°é˜Ÿåˆ—ã€‚</p> 
<ol><li> <p><strong>æŒä¹…æ€§ï¼ˆDurableï¼‰ï¼š</strong> RabbitMQæ”¯æŒå°†é˜Ÿåˆ—å’Œæ¶ˆæ¯æ ‡è®°ä¸ºæŒä¹…æ€§ï¼Œä»¥ç¡®ä¿åœ¨æœåŠ¡å™¨é‡å¯æ—¶æ•°æ®ä¸ä¼šä¸¢å¤±ã€‚</p> </li><li> <p><strong>è™šæ‹Ÿä¸»æœºï¼ˆVirtual Hostï¼‰ï¼š</strong> è™šæ‹Ÿä¸»æœºæ˜¯RabbitMQä¸­æ¶ˆæ¯éš”ç¦»çš„å•ä½ï¼Œå…è®¸åœ¨åŒä¸€RabbitMQæœåŠ¡å™¨ä¸Šåˆ›å»ºå¤šä¸ªç‹¬ç«‹çš„æ¶ˆæ¯ä»£ç†ã€‚</p> </li><li> <p><strong>ACKï¼ˆAcknowledgmentï¼‰ï¼š</strong> æ¶ˆè´¹è€…åœ¨å¤„ç†å®Œæ¶ˆæ¯åå‘é€ACKï¼Œé€šçŸ¥RabbitMQè¯¥æ¶ˆæ¯å·²è¢«æˆåŠŸå¤„ç†ã€‚è¿™ç¡®ä¿æ¶ˆæ¯ä¸ä¼šåœ¨å¤„ç†å¤±è´¥æ—¶ä¸¢å¤±ã€‚</p> </li><li> <p><strong>æ’ä»¶ç³»ç»Ÿï¼š</strong> RabbitMQå…·æœ‰ä¸°å¯Œçš„æ’ä»¶ç³»ç»Ÿï¼Œå…è®¸æ‰©å±•å’Œå®šåˆ¶å…¶åŠŸèƒ½</p> </li></ol> 
<h3 style="background-color:transparent;">1.å¸¸è§æ¶ˆæ¯é˜Ÿåˆ—</h3> 
<p><img alt="" height="697" src="https://images2.imgbox.com/be/19/ZnFdWwLx_o.png" width="1200"></p> 
<h3 style="background-color:transparent;">2.Dockerå®‰è£…éƒ¨ç½²RabbitMQ</h3> 
<h4 style="background-color:transparent;">1.æ‹‰å–é•œåƒ</h4> 
<pre><code class="hljs">docker pull  rabbitmq:management</code></pre> 
<h4 style="background-color:transparent;">2.åˆ›å»ºå®¹å™¨</h4> 
<blockquote> 
 <p>å‘½ä»¤è¯¦è§£ï¼š</p> 
 <p>åœ¨åå°è¿è¡Œä¸€ä¸ªRabbitMQå®¹å™¨ï¼Œé€šè¿‡ä¸»æœºçš„5672ç«¯å£å¯ä»¥è®¿é—®RabbitMQçš„AMQPæœåŠ¡ï¼Œé€šè¿‡ä¸»æœºçš„15672ç«¯å£å¯ä»¥è®¿é—®RabbitMQçš„ç®¡ç†ç•Œé¢ã€‚RabbitMQçš„é»˜è®¤è™šæ‹Ÿä¸»æœºä¸º"my_vhost"ï¼Œé»˜è®¤ç”¨æˆ·åå’Œå¯†ç ä¸º"admin"ã€‚å®¹å™¨çš„ä¸»æœºåè¢«è®¾ç½®ä¸º"my-rabbitmq-host"ã€‚å®¹å™¨å°†åœ¨å®ˆæŠ¤è¿›ç¨‹å¯åŠ¨æ—¶è‡ªåŠ¨é‡æ–°å¯åŠ¨</p> 
</blockquote> 
<p>åœ¨è™šæ‹Ÿæœºä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤Â </p> 
<pre><code class="hljs">docker run -d \
--name my-rabbitmq \
-p 5672:5672 -p 15672:15672 \
--hostname my-rabbitmq-host \
-e RABBITMQ_DEFAULT_VHOST=my_vhost \
-e RABBITMQ_DEFAULT_USER=admin \
-e RABBITMQ_DEFAULT_PASS=admin \
--restart=always \
rabbitmq:management</code></pre> 
<p>å¼€æ”¾ç«¯å£</p> 
<pre><code class="hljs">firewall-cmd --zone=public --add-port=15672/tcp --permanent
firewall-cmd --zone=public --add-port=5672/tcp --permanent</code></pre> 
<p>å®¹å™¨åˆ›å»ºè¿è¡Œå®Œæˆåæˆ‘ä»¬å¯ä»¥åœ¨è‡ªå·±çš„ä¸»æœºä¸Šé€šè¿‡IP:15672è¿›å…¥åˆ°ç®¡ç†å‘˜ç•Œé¢ï¼Œè´¦å·å¯†ç ä¸ºæˆ‘ä»¬ä¸Šé¢å‘½ä»¤æŒ‡å®šçš„adminï¼Œç™»å½•å³å¯</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/1e/32/k1OlaNFP_o.png" width="1200"></p> 
<h4>3.æ·»åŠ ç”¨æˆ·</h4> 
<p><img alt="" height="946" src="https://images2.imgbox.com/83/3f/PM0ayHPb_o.png" width="1200">Â æ·»åŠ ç”¨æˆ·è¾“å…¥è´¦æˆ·åå’Œå¯†ç æŒ‡å®šå½“å‰ç”¨æˆ·èº«ä»½</p> 
<h4>4.åˆ†é…æ“ä½œè™šæ‹Ÿä¸»æœº</h4> 
<p>åˆšåˆ›å»ºå®Œçš„ç”¨æˆ·è¿˜ä¸èƒ½è¿›è¡Œä¸€ä¸ªç™»å½•ï¼Œéœ€è¦ç»™å®ƒåˆ†é…ä¸€ä¸ªèƒ½å¤Ÿæ“ä½œçš„è™šæ‹Ÿä¸»æœº</p> 
<p><img alt="" height="772" src="https://images2.imgbox.com/97/33/hLIR7Oqz_o.png" width="1200">Â Virtal Hostæ˜¯å¯ä»¥åˆ†é…çš„è™šæ‹Ÿä¸»æœºï¼ŒSet permissionå¯ä»¥å¯¹å…¶è¿›è¡Œåˆ†é…</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/92/de/MLv6oYNK_o.png" width="1200"></p> 
<p>Â åˆ†é…å®Œæˆåçš„ç”¨æˆ·å°±å¯ä»¥å¯¹å½“å‰è™šæ‹Ÿä¸»æœºè¿›è¡Œç™»å½•ç­‰æ“ä½œäº†</p> 
<h2>äºŒ.RabbitMQå®ç°ç®€å•é˜Ÿåˆ—</h2> 
<h3 style="background-color:transparent;">1.é¡¹ç›®åˆ›å»º</h3> 
<p>æˆ‘ä»¬ä»¥ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„å½¢å¼åˆ›å»ºSpringBooté¡¹ç›®</p> 
<p>Â <img alt="" height="269" src="https://images2.imgbox.com/ec/0a/17bDHgBS_o.png" width="543"></p> 
<p>åˆ›å»ºæ—¶éœ€è¦æ³¨æ„ï¼Œä»¥SpringBooté¡¹ç›®ä¸ºä¾‹åœ¨å‹¾é€‰ä¾èµ–æ—¶ï¼Œè¦å°†Spring for Rabbitå‹¾é€‰</p> 
<p><img alt="" height="400" src="https://images2.imgbox.com/24/cf/gQIpoz2h_o.png" width="309"></p> 
<h3>2.å¯¹ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…è¿›è¡Œé…ç½®</h3> 
<p>ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„é…ç½®æ–‡ä»¶éƒ½éœ€è¦æ›´æ”¹</p> 
<blockquote> 
 <p>æ³¨æ„ï¼šç«¯å£ä¸èƒ½ç›¸åŒé˜²æ­¢ç«¯å£å†²çªï¼Œè¦å°†ipä¿®æ”¹ä¸ºè‡ªå·±çš„ä¸»æœºipä»¥åŠç”¨æˆ·åå’Œå¯†ç </p> 
</blockquote> 
<pre><code class="hljs">server:
    port: 8888
spring:
    rabbitmq:
        host: Rabbitæ‰€åœ¨ä¸»æœºçš„ip
        username: YU
        password: 123456
        port: 5672
        virtual-host: my_vhost</code></pre> 
<h3 style="background-color:transparent;">3.åˆ›å»ºRabbitMQé˜Ÿåˆ—çš„Springé…ç½®ç±»</h3> 
<p>é€šè¿‡<strong><span style="color:#fe2c24;"><code>@Bean</code></span></strong>æ³¨è§£ï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ªåä¸º<span style="color:#fe2c24;"><strong><code>firstQueue</code></strong></span>çš„Beanï¼Œè¯¥Beanæ˜¯ä¸€ä¸ª<strong><span style="color:#fe2c24;"><code>Queue</code></span></strong>å®ä¾‹ï¼Œä»£è¡¨äº†ä¸€ä¸ªåä¸º"<span style="color:#fe2c24;"><strong>firstQueue</strong></span>"çš„RabbitMQé˜Ÿåˆ—ã€‚è¿™æ ·çš„é…ç½®å…è®¸åº”ç”¨ç¨‹åºä½¿ç”¨è¯¥é˜Ÿåˆ—è¿›è¡Œæ¶ˆæ¯çš„ç”Ÿäº§å’Œæ¶ˆè´¹</p> 
<pre><code class="language-java">package com.yu.publisher;

import org.springframework.amqp.core.Queue;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
@SuppressWarnings("all")
public class RabbitConfig {
@Bean
    public Queue firstQueue() {
        return new Queue("firstQueue");
    }
}</code></pre> 
<h3>4.åˆ›å»ºæ§åˆ¶å±‚è¿›è¡Œè®¿é—®æµ‹è¯•</h3> 
<h4>1.ç”Ÿäº§è€…</h4> 
<p>æˆ‘ä»¬é€šè¿‡å¯¼å…¥Spring AMQPæ¡†æ¶ä¸­ç”¨äºå‘é€æ¶ˆæ¯çš„<code>AmqpTemplate</code>æ¥å£ï¼Œè°ƒç”¨<code>amqpTemplate</code>çš„<code>convertAndSend</code>æ–¹æ³•å‘åä¸º"firstQueue"çš„RabbitMQé˜Ÿåˆ—å‘é€æ¶ˆæ¯ï¼Œæ¶ˆæ¯å†…å®¹ä¸º"hello world",å‘é€æˆåŠŸåè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²"ğŸš€"ï¼Œä½œä¸ºHTTPå“åº”ä½“ã€‚</p> 
<pre><code class="language-java">package com.yu.publisher;

import org.springframework.amqp.core.AmqpTemplate;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class TestController {
    @Autowired
    private AmqpTemplate amqpTemplate;

    @RequestMapping("send1")
    public String send1(){
        //å‘æ¶ˆæ¯é˜Ÿåˆ—å‘é€æ¶ˆæ¯
        amqpTemplate.convertAndSend("firstQueue","hello world");
        return "ğŸš€";
    }
}
</code></pre> 
<p>æµ‹è¯•é˜¶æ®µï¼š</p> 
<p>å¯åŠ¨ç”Ÿäº§è€…ï¼Œåœ¨æµè§ˆå™¨è°ƒç”¨send1ï¼ˆControllerä¸­çš„æ–¹æ³•ï¼‰è¿›è¡Œè®¿é—®æµ‹è¯•</p> 
<p><img alt="" height="168" src="https://images2.imgbox.com/86/f5/41zz4f8c_o.png" width="605"></p> 
<p>è¿™æ—¶æˆ‘ä»¬æ‰“å¼€RabbitMQæ§åˆ¶é¢æ¿ä¸­çš„æ¶ˆæ¯é˜Ÿåˆ—å°±å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åˆšåˆšå‘é€çš„æ¶ˆæ¯äº†</p> 
<p><img alt="" height="704" src="https://images2.imgbox.com/98/0b/UKS4XlGF_o.png" width="1200">Â </p> 
<h4>Â 2.æ¶ˆè´¹è€…</h4> 
<p>æˆ‘ä»¬é€šè¿‡æ³¨è§£<strong><code>@RabbitHandler</code></strong>æŒ‡å®šè¯¥ç±»ç›‘å¬åä¸º"firstQueue"çš„RabbitMQé˜Ÿåˆ—å’Œ<code>@RabbitHandler</code>æ³¨è§£æ ‡è¯†è¯¥æ–¹æ³•ä¸ºå¤„ç†RabbitMQæ¶ˆæ¯çš„æ–¹æ³•ï¼Œä½¿ç”¨Lombokç”Ÿæˆçš„æ—¥å¿—è®°å½•å™¨è®°å½•æ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼Œå°†"æ¥æ”¶åˆ°:"ä¸æ¶ˆæ¯å†…å®¹æ‹¼æ¥å¹¶è®°å½•ä¸ºè­¦å‘Šçº§åˆ«çš„æ—¥å¿—ï¼Œå½“é˜Ÿåˆ—"firstQueue"ä¸­æœ‰æ¶ˆæ¯åˆ°è¾¾æ—¶ï¼Œ<code>process</code>æ–¹æ³•ä¼šè¢«è°ƒç”¨ï¼Œå°†æ¥æ”¶åˆ°çš„æ¶ˆæ¯è®°å½•åˆ°æ—¥å¿—ä¸­</p> 
<pre><code class="language-java">package com.yu.consumer;

import lombok.extern.slf4j.Slf4j;
import org.springframework.amqp.rabbit.annotation.RabbitHandler;
import org.springframework.amqp.rabbit.annotation.RabbitListener;
import org.springframework.stereotype.Component;

@Component
@SuppressWarnings("all")
@Slf4j
@RabbitListener(queues = "firstQueue")
public class Receiver {
@RabbitHandler
public void process(String msg) {
log.warn("æ¥æ”¶åˆ°:" + msg);
}
}</code></pre> 
<p>å¯åŠ¨æ¶ˆè´¹è€…ï¼Œè¿™æ—¶ï¼Œå½“æˆ‘ä»¬å†å»è®¿é—®ç”Ÿäº§è€…æ—¶ï¼Œåœ¨æ—¥å¿—ä¿¡æ¯ä¸­å°±ä¼šè¿”å›ç”Ÿäº§è€…æ‰€å‘é€çš„æ¶ˆæ¯</p> 
<p><img alt="" height="130" src="https://images2.imgbox.com/fb/bd/2n3Ygl9V_o.png" width="911"></p> 
<h3>5.é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—å‘é€å¯¹è±¡</h3> 
<p>Â åœ¨RabbitMQä¸­å‘é€å¯¹è±¡é€šå¸¸éœ€è¦è¿›è¡Œå¯¹è±¡çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œä»¥ä¾¿å°†å¯¹è±¡è½¬æ¢ä¸ºæ¶ˆæ¯ä½“å‘é€åˆ°é˜Ÿåˆ—ï¼Œç„¶åä»é˜Ÿåˆ—æ¥æ”¶æ¶ˆæ¯å¹¶è¿˜åŸä¸ºå¯¹è±¡</p> 
<h4>1.åœ¨ç”Ÿäº§è€…ä¸­åˆ›å»ºå®ä½“User</h4> 
<p>å®ç°åºåˆ—åŒ–æ¥å£</p> 
<pre><code class="language-java">package com.yu.publisher;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

import java.io.Serializable;

@SuppressWarnings("all")
@Data
@AllArgsConstructor
@NoArgsConstructor
public class User implements Serializable {
private String username;
private String userpwd;
}</code></pre> 
<h4>2.é…ç½®RabbitMQçš„Queneå®ä¾‹</h4> 
<pre><code class="language-java">package com.yu.publisher;

import org.springframework.amqp.core.Queue;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
@SuppressWarnings("all")
public class RabbitConfig {
    @Bean
    public Queue secondQueue() {
        return new Queue("secondQueue");
    }

}</code></pre> 
<h4>3.åˆ›å»ºå‘é€ä¿¡æ¯æ–¹æ³•</h4> 
<p>ä½¿ç”¨<code>ObjectMapper</code>å°†å…¶åºåˆ—åŒ–ä¸ºJSONå­—ç¬¦ä¸²ï¼Œç„¶åé€šè¿‡<code>amqpTemplate.convertAndSend</code>å°†è¿™ä¸ªJSONå­—ç¬¦ä¸²å‘é€åˆ°åä¸º"secondQueue"çš„RabbitMQé˜Ÿåˆ—</p> 
<pre><code class="language-java">package com.yu.publisher;

import com.fasterxml.jackson.databind.ObjectMapper;
import org.springframework.amqp.core.AmqpTemplate;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class TestController {
    @Autowired
    private AmqpTemplate amqpTemplate;
    @Autowired
    private ObjectMapper objectMapper;

    @RequestMapping("send2")
    public String send2() throws Exception{
        User user = new User("YU","123");
        String YU = objectMapper.writeValueAsString(user);
        //å‘æ¶ˆæ¯é˜Ÿåˆ—å‘é€æ¶ˆæ¯
        amqpTemplate.convertAndSend("secondQueue",YU);
        return "ğŸš€";
    }
}
</code></pre> 
<h4>4.åˆ›å»ºæ¥å—ä¿¡æ¯æ–¹æ³•</h4> 
<p>å£°æ˜ä¸€ä¸ªæ–¹æ³•ä½œä¸ºæ¶ˆæ¯å¤„ç†å™¨ï¼Œæ ‡è®°æ–¹æ³•ç”¨äºå¤„ç†ä»RabbitMQé˜Ÿåˆ—æ¥æ”¶åˆ°çš„æ¶ˆæ¯,å¤„ç†æ¶ˆæ¯çš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ¥æ”¶ä¸€ä¸ªJSONå­—ç¬¦ä¸²å‚æ•°ä½¿ç”¨<code>ObjectMapper</code>å°†JSONå­—ç¬¦ä¸²è½¬æ¢ä¸º<code>User</code>å¯¹è±¡ï¼Œä½¿ç”¨Slf4jæ—¥å¿—æ¡†æ¶è®°å½•æ¥æ”¶åˆ°çš„<code>User</code>å¯¹è±¡ï¼Œè¿™é‡Œä½¿ç”¨<code>warn</code>çº§åˆ«ï¼Œæ¥æ”¶å¹¶å¤„ç†ä»"secondQueue"é˜Ÿåˆ—ä¸­æ¥æ”¶åˆ°çš„æ¶ˆæ¯</p> 
<pre><code class="language-java">package com.yu.consumer;

import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;
import lombok.extern.slf4j.Slf4j;
import org.springframework.amqp.rabbit.annotation.RabbitHandler;
import org.springframework.amqp.rabbit.annotation.RabbitListener;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

@Component
@SuppressWarnings("all")
@Slf4j
@RabbitListener(queues = "secondQueue")
public class PojoReceiver {

    @Autowired
    private ObjectMapper objectMapper;
    @RabbitHandler
    public void process(String json) throws Exception {
        User user = objectMapper.readValue(json, User.class);
        log.warn("æ¥æ”¶åˆ°:" + user);
    }
}</code></pre> 
<p>æµ‹è¯•é˜¶æ®µï¼š</p> 
<p><img alt="" height="135" src="https://images2.imgbox.com/83/1b/BSTGKXaO_o.png" width="486"></p> 
<p>å½“æˆ‘ä»¬å‘æ¶ˆæ¯é˜Ÿåˆ—ä¸­å‘é€ä¸€ä¸ªå¯¹è±¡ï¼Œæ¶ˆè´¹è€…å†è¿›è¡Œæ¥æ”¶</p> 
<p><img alt="" height="90" src="https://images2.imgbox.com/ef/6c/1nUGXI2R_o.png" width="1200"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8c6beaaa0f971a83a98e0a0abe7a5625/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">å‰ç«¯å›¾ç‰‡è½¬base64 æ–¹æ³•</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/48b1ac49ee1d1aa4909e26ba4beb3850/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">æ•°è¯´CS | å¤ä»¤è¥ä¸ºä¸»ï¼å¤æ—¦å¤§å­¦å¤§æ•°æ®å­¦é™¢ä¿ç ”å½¢åŠ¿å¦‚ä½•ï¼Ÿ</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§å’–.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>