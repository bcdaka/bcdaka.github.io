<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>自动化一些操作 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/11f96d20e249517a5819cc1e3aa07deb/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="自动化一些操作">
  <meta property="og:description" content="下拉选择框 from selenium import webdriver from time import sleep # 导包 from selenium.webdriver.support.select import Select driver = webdriver.Edge() driver.get(r&#34;D:\WORK\ww\web自动化_day01_课件&#43;笔记&#43;资料&#43;代码\web自动化_day01_课件&#43;笔记&#43;资料&#43;代码\02_其他资料\注册A.html&#34;) driver.maximize_window() driver.implicitly_wait(30) # 匿名 # Select(element).select_by_index() # Select(element).select_by_value() # Select(element).select_by_visible_text() # 实名 # select = Select(element) element 只能是select标签 Select(driver.find_element_by_css_selector(&#34;#selectA&#34;)).select_by_value(&#34;bj&#34;) sleep(2) Select(driver.find_element_by_css_selector(&#34;#selectA&#34;)).select_by_index(1) sleep(2) Select(driver.find_element_by_css_selector(&#34;#selectA&#34;)).select_by_visible_text(&#34;A广州&#34;) sleep(2) #通过css driver.find_element_by_css_selector(&#34;[value = &#39;cq&#39;]&#34;).click() sleep(2) driver.quit() 弹出框 from selenium import webdriver from time import sleep driver = webdriver.Edge() driver.get(r&#34;D:\WORK\ww\web自动化_day01_课件&#43;笔记&#43;资料&#43;代码\web自动化_day01_课件&#43;笔记&#43;资料&#43;代码\02_其他资料\注册A.html&#34;) driver.find_element_by_css_selector(&#34;#alerta&#34;).click() # 切换 处理 # driver.switch_to.alert.accept() # driver.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-02T14:23:49+08:00">
    <meta property="article:modified_time" content="2024-07-02T14:23:49+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">自动化一些操作</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>下拉选择框</h3> 
<p><img alt="" height="724" src="https://images2.imgbox.com/5e/40/lKYR9MM3_o.png" width="875"></p> 
<pre><code class="hljs">from selenium import webdriver
from time import sleep
# 导包
from selenium.webdriver.support.select import Select
driver = webdriver.Edge()
driver.get(r"D:\WORK\ww\web自动化_day01_课件+笔记+资料+代码\web自动化_day01_课件+笔记+资料+代码\02_其他资料\注册A.html")

driver.maximize_window()

driver.implicitly_wait(30)
# 匿名
# Select(element).select_by_index()
# Select(element).select_by_value()
# Select(element).select_by_visible_text()
# 实名
# select = Select(element) element 只能是select标签

Select(driver.find_element_by_css_selector("#selectA")).select_by_value("bj")
sleep(2)
Select(driver.find_element_by_css_selector("#selectA")).select_by_index(1)
sleep(2)
Select(driver.find_element_by_css_selector("#selectA")).select_by_visible_text("A广州")
sleep(2)
#通过css
driver.find_element_by_css_selector("[value = 'cq']").click()
sleep(2)

driver.quit()</code></pre> 
<p><img alt="" height="274" src="https://images2.imgbox.com/d0/49/Sf5RFIg3_o.png" width="875"></p> 
<h3>弹出框</h3> 
<p><img alt="" height="455" src="https://images2.imgbox.com/ea/93/D3VUBGlq_o.png" width="675"></p> 
<p><img alt="" height="887" src="https://images2.imgbox.com/3a/26/8OxyC6nt_o.png" width="862"></p> 
<p><img alt="" height="244" src="https://images2.imgbox.com/59/0e/XZxFR8OT_o.png" width="879"></p> 
<p><img alt="" height="676" src="https://images2.imgbox.com/ab/b1/LuqRODle_o.png" width="910"></p> 
<p><img alt="" height="489" src="https://images2.imgbox.com/59/cf/KBSXuwuG_o.png" width="873"></p> 
<pre><code class="language-python">from selenium import webdriver
from time import sleep

driver = webdriver.Edge()
driver.get(r"D:\WORK\ww\web自动化_day01_课件+笔记+资料+代码\web自动化_day01_课件+笔记+资料+代码\02_其他资料\注册A.html")

driver.find_element_by_css_selector("#alerta").click()
# 切换 处理
# driver.switch_to.alert.accept()
# driver.switch_to.alert.dismiss()
print(driver.switch_to.alert.text) # 这个之后还是得处理同意或取消 不然会报错
# 我被被点击啦！
driver.switch_to.alert.dismiss()
sleep(2)
driver.find_element_by_css_selector("#userA").send_keys("admin")
sleep(2)
driver.quit()</code></pre> 
<p><img alt="" height="116" src="https://images2.imgbox.com/e0/36/xUOegqAc_o.png" width="889"></p> 
<pre><code class="language-python">at = driver.switch_to.alert
# 切换 处理
# at.accept()
print(at.text) # 这个之后还是得处理同意或取消 不然会报错
# 我被被点击啦！
at.dismiss()</code></pre> 
<h3>滚动条操作</h3> 
<p><img alt="" height="650" src="https://images2.imgbox.com/9b/62/5tXsjPmz_o.png" width="886">一个水平滑动条 一个垂直滑动条</p> 
<p><img alt="" height="207" src="https://images2.imgbox.com/13/f5/WEuzbcZ1_o.png" width="866"></p> 
<pre><code class="language-python">from selenium import webdriver
from time import sleep

driver = webdriver.Edge()
driver.get(r"D:\WORK\ww\web自动化_day01_课件+笔记+资料+代码\web自动化_day01_课件+笔记+资料+代码\02_其他资料\注册A.html")

sleep(2)
js = "window.scrollTo(0,10000)"

driver.execute_script(js)

sleep(2)
driver.quit()</code></pre> 
<h3>frame表单切换</h3> 
<p><img alt="" height="648" src="https://images2.imgbox.com/cd/13/ECeQqmNL_o.png" width="885"></p> 
<p> <img alt="" height="315" src="https://images2.imgbox.com/38/f5/EJxTI2A0_o.png" width="869"></p> 
<p>首先在注册实例 切换到注册A</p> 
<p>恢复默认页面 再切换到注册B</p> 
<p>因为在注册A的源代码中是没有iframe的</p> 
<p></p> 
<pre><code class="language-python">from selenium import webdriver
from time import sleep

driver = webdriver.Edge()
driver.get(r"D:\WORK\ww\web自动化_day01_课件+笔记+资料+代码\web自动化_day01_课件+笔记+资料+代码\02_其他资料\注册实例.html")

driver.find_element_by_css_selector("#user").send_keys("admin")
driver.find_element_by_css_selector("#password").send_keys("123456")
driver.find_element_by_css_selector(".tel").send_keys("123451432")
driver.find_element_by_css_selector("#email").send_keys("ww@qq.com")
# 通过id进行切换
driver.switch_to_frame("idframe1")
driver.find_element_by_css_selector("#userA").send_keys("admin")
driver.find_element_by_css_selector("#passwordA").send_keys("123456")
driver.find_element_by_css_selector(".telA").send_keys("123451432")
driver.find_element_by_css_selector("#emailA").send_keys("ww@qq.com")

sleep(2)
# 切换到默认页面
driver.switch_to_default_content()
# 通过name进行切换
# driver.switch_to_frame("myframe2")
# 通过元素定位
driver.switch_to_frame(driver.find_element_by_css_selector("[name = 'myframe2']"))
driver.find_element_by_css_selector("#userB").send_keys("admin")
driver.find_element_by_css_selector("#passwordB").send_keys("123456")
driver.find_element_by_css_selector(".telB").send_keys("123451432")
driver.find_element_by_css_selector("#emailB").send_keys("ww@qq.com")

sleep(2)
driver.quit()</code></pre> 
<p><img alt="" height="263" src="https://images2.imgbox.com/c4/e2/XPg3XJiv_o.png" width="892"></p> 
<h3>多窗口切换</h3> 
<p><img alt="" height="644" src="https://images2.imgbox.com/3a/63/n5kCoBMM_o.png" width="907"></p> 
<p>_blank 跳转到新窗口打开</p> 
<p>所以需要切换窗口</p> 
<p><img alt="" height="377" src="https://images2.imgbox.com/1a/f5/3lzxDxAh_o.png" width="883"></p> 
<pre><code class="language-python">from selenium import webdriver
from time import sleep

driver = webdriver.Edge()
driver.get(r"D:\WORK\ww\web自动化_day01_课件+笔记+资料+代码\web自动化_day01_课件+笔记+资料+代码\02_其他资料\注册实例.html")

cur = driver.current_window_handle
print("当前窗口句柄", cur)

driver.find_element_by_partial_link_text("注册A网页").click()
handles = driver.window_handles  # 获取所有的
# 当前窗口句柄 764CA7D94866BF4B7633F4F42D931775
# 764CA7D94866BF4B7633F4F42D931775
# 58B964F25D36A08C1004B1C0504248F4

for handle in handles:
    print(handle)
    if handle != cur:
        # 切换
        driver.switch_to.window(handle)

sleep(2)
driver.find_element_by_css_selector("#userA").send_keys("admin")
driver.find_element_by_css_selector("#passwordA").send_keys("123456")
driver.find_element_by_css_selector(".telA").send_keys("123451432")
driver.find_element_by_css_selector("#emailA").send_keys("ww@qq.com")

sleep(2)
driver.quit()</code></pre> 
<p><img alt="" height="173" src="https://images2.imgbox.com/01/9b/s0NlQrl8_o.png" width="865"></p> 
<h3>窗口截图、验证码处理</h3> 
<p><img alt="" height="616" src="https://images2.imgbox.com/83/59/rRB6wMT1_o.png" width="874"></p> 
<p> </p> 
<pre><code class="language-python">from selenium import webdriver
from time import sleep
import time
driver = webdriver.Edge()
driver.get(r"D:\WORK\ww\web自动化_day01_课件+笔记+资料+代码\web自动化_day01_课件+笔记+资料+代码\02_其他资料\注册实例.html")

driver.find_element_by_css_selector("#user").send_keys("admin")
driver.find_element_by_css_selector("#password").send_keys("123456")
driver.find_element_by_css_selector(".tel").send_keys("123451432")
driver.find_element_by_css_selector("#email").send_keys("ww@qq.com")

sleep(2)
# 截图方式 时间戳
# driver.get_screenshot_as_file("./image/info_1.png")
driver.get_screenshot_as_file("./image/%s.png"%(time.strftime("%Y_%m_%d %H_%M_%S")))
# s.png s.jpg 都行
driver.quit()</code></pre> 
<p><img alt="" height="174" src="https://images2.imgbox.com/e9/93/5usfkKUo_o.png" width="583"><img alt="" height="715" src="https://images2.imgbox.com/8e/f2/O4ib9AgE_o.png" width="846"></p> 
<p> <img alt="" height="615" src="https://images2.imgbox.com/18/e1/1g623CKW_o.png" width="868"></p> 
<p><img alt="" height="438" src="https://images2.imgbox.com/57/68/UJz2qW9K_o.png" width="845"></p> 
<p><img alt="" height="260" src="https://images2.imgbox.com/d3/06/0mC8qtH0_o.png" width="872"></p> 
<p> get_cookie(name)的底层为get_cookies()</p> 
<p><img alt="" height="396" src="https://images2.imgbox.com/1e/3d/A6yJOu2H_o.png" width="851"></p> 
<p> 对于百度网址来说 cookie的键名BDUSS 对应的值 登录的时候抓包</p> 
<p><img alt="" height="300" src="https://images2.imgbox.com/f9/f8/bn7WjJ3j_o.png" width="884"></p> 
<pre><code class="language-python">from selenium import webdriver
from time import sleep
import time

driver = webdriver.Edge()
# 先请求网址
driver.get(r"https://www.baidu.com/")

# 再设置cookie
driver.add_cookie({"name": "BDUSS",
                   "value": ""})

sleep(2)
# 一定要刷新
driver.refresh()
sleep(2)
driver.quit()</code></pre> 
<p><img alt="" height="188" src="https://images2.imgbox.com/f8/0a/a25YeGOT_o.png" width="846"></p> 
<pre><code class="language-python">cookies = driver.get_cookies()
for co in cookies:
    print("内容为", co)</code></pre> 
<p><img alt="" height="451" src="https://images2.imgbox.com/b4/2e/tZaOITT1_o.png" width="873"></p> 
<pre><code class="language-python">cookies = driver.get_cookies()
for co in cookies:
    print(co.get('name'))</code></pre> 
<p><img alt="" height="514" src="https://images2.imgbox.com/6f/18/jYAQA0Pi_o.png" width="371"></p> 
<p>底层原理：</p> 
<p><img alt="" height="344" src="https://images2.imgbox.com/87/a1/JvZQuuVq_o.png" width="880"></p> 
<pre><code class="language-python">cookies = driver.get_cookies()
for co in cookies:
    if co.get('name') == 'BDUSS':
        print(co.get('value'))
        </code></pre> 
<p><img alt="" height="680" src="https://images2.imgbox.com/58/64/tdNr0Oh0_o.png" width="882"></p> 
<p><img alt="" height="496" src="https://images2.imgbox.com/eb/76/TatN3Tkg_o.png" width="847"></p> 
<p>弹出框 frame表单切换 多窗口切换</p> 
<h3>cookie</h3> 
<p>cookie就是能实现绕过验证码的功能 感觉就是不用用户自己重复登录</p> 
<p>用户第一次通过输入用户名 密码 验证码给服务器进行登录</p> 
<p>服务器验证通过生成cookie 一串字符串 将其标为验证成功 登录成功</p> 
<p>响应时把这个cookie一并给浏览器 浏览器以后就可以自行设置</p> 
<p>浏览器就自己设置好了并保存</p> 
<p>然后后续当我们再次用这个浏览器访问这个网页时</p> 
<p>浏览器网页自己将保存的cookie给服务器 然后就是自动登录了 显示登录成功的状态</p> 
<p></p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a5b0beadedffdb266bf1caecbe9b8cf7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MySQL 9.0 风云再起：全面解析最新创新版发布！</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/38892e1ee2c376d0a9d56e749cadd25d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">最新AI大模型系统源码，ChatGPT商业运营版系统源（详细图文搭建部署教程）&#43;AI绘画系统，DALL-E3文生图， Whisper &amp; TTS 语音识别，文档分析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>