<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【02数据库与小模型篇】0到1打造基于文心大模型和飞桨小模型的智能在线编辑器 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/46972cb11b39a8aabc8a945ab394e226/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【02数据库与小模型篇】0到1打造基于文心大模型和飞桨小模型的智能在线编辑器">
  <meta property="og:description" content="三、数据库 1、简介 数据库简称 DB，是按照数据结构来组织、存储和管理数据的仓库，用户可以对文件的数据进行增加、删除、修改、查找等操作。
区分一下，数据库管理系统简称DBMS，是一种操纵和管理数据库的大型软件，是用于建立、使用和维护数据库（DB）。它对数据库进行统一的管理和控制，以保证数据库的安全性和完整性。
2、为什么要用数据库 数据库可以存储大量的数据信息，方便用户进行有效的访问。数据库还可以对数据进行分类保存，并且能够提供快速的查询。数据库可以满足应用的共享和安全方面的要求，把数据放在数据库中在很多情况下也是出于安全的考虑。数据库技术能够方便智能化地分析，产生新的有用信息。 3、数据库的分类 ①、关系型数据库
采用了关系模型来组织数据的数据库，其以行和列的形式存储数据，以便于用户理解，关系型数据库这一系列的行和列被称为表，一组表组成了数据库。下面是常见的一些关系型数据库：
MySQL:
免费的数据库系统。被广泛用于中小型应用系统。体积小、速度快、总体拥有成本低，开放源代码。
SQL Server :
是由微软公司开发的一种关系型数据库管理系统（RDBMS），用于存储和检索数据。它提供了一个可扩展的、安全的和可靠的数据存储和管理解决方案。
Oracle：
是目前比较成功的关系型数据库管理系统。运行稳定、功能齐全、性能超群、技术领先。主要应用在大型的企业数据库领域。
4、MySQL基本操作详解 上一篇教程已经安装好了MySQL还有phpMyAdmin，直接在这里进行操作。
右上角点击数据库工具-&gt;打开-&gt;选择phpMyAdmin，打开网页,账号和密码都是root，登录进去。
直接选择SQL，就可以在这里编写SQL语句进行测试了。
4.1、数据库操作 ①、查看MySQL服务器下所有数据库
SHOW DATABASES; information_schema数据库是MySQL服务器的数据字典（保存所有数据表和库的结构信息）
performance_schema数据库是MySQL服务器的性能字典（保存全局变量等的设置）
mysql 主要负责MySQL服务器自己需要使用的控制和管理信息（用户的权限关系等）
sys是系统数据库，包括了存储过程，自定义函数等信息
这4个数据库是MySQL安装时自动创建的，建议不要随意的删除和修改这些数据库，避免造成服务器故障。
②、查看指定数据库的创建信息
SHOW CREATE DATABASE 数据库名称; 显示sys数据库的SQL语句，以及数据库的默认字符集
③、选择数据库并查看当前数据库
切记：在输入当前数据库查询的SQL语句前，必须先选择数据库。
先选择editdata数据库,执行如下语句：
USE EditData 接着查看当前数据库：
SELECT DATABASE(); ④、创建数据库
CREATE DATABASE IF NOT EXISTS userinfo; ⑤、选择数据库
USE userinfo; 也可以点击左侧的数据库列表进行数据库的选择。
⑥、删除数据库
DROP DATABASE IF EXISTS userinfo; 删除数据库，清除数据库中的所有数据，回收为分配的存储空间。在执行DROP DATABASE 删除数据库时，若待删除的数据库不存在，MySQL服务器会报错。若想避免上述的情况，在进行删除数据库操作时，使用IF EXISTS来进行规避待删除的数据库不存在报错情况。 4.2、数据表操作 ①、创建数据表">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-07T10:37:43+08:00">
    <meta property="article:modified_time" content="2024-06-07T10:37:43+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【02数据库与小模型篇】0到1打造基于文心大模型和飞桨小模型的智能在线编辑器</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>三、数据库</h3> 
<h4><a id="1_1"></a>1、简介</h4> 
<p>数据库简称 DB，是按照数据结构来组织、存储和管理数据的仓库，用户可以对文件的数据进行增加、删除、修改、查找等操作。<br> 区分一下，<a href="https://so.csdn.net/so/search?q=%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F&amp;spm=1001.2101.3001.7020">数据库管理系统</a>简称DBMS，是一种操纵和管理数据库的大型软件，是用于建立、使用和维护数据库（DB）。它对数据库进行统一的管理和控制，以保证数据库的安全性和完整性。</p> 
<h4><a id="2_4"></a>2、为什么要用数据库</h4> 
<ol><li>数据库可以存储大量的数据信息，方便用户进行有效的访问。数据库还可以对数据进行分类保存，并且能够提供快速的查询。</li><li>数据库可以满足应用的共享和安全方面的要求，把数据放在数据库中在很多情况下也是出于安全的考虑。</li><li>数据库技术能够方便智能化地分析，产生新的有用信息。</li></ol> 
<h4><a id="3_9"></a>3、数据库的分类</h4> 
<p><strong>①、关系型数据库</strong><br> 采用了关系模型来组织数据的数据库，其以行和列的形式存储数据，以便于用户理解，关系型数据库这一系列的行和列被称为表，一组表组成了数据库。下面是常见的一些关系型数据库：<br> <strong>MySQL:</strong><br> 免费的数据库系统。被广泛用于<strong>中小型应用系统。体积小、速度快、总体拥有成本低，开放源代码</strong>。<br> <img src="https://images2.imgbox.com/be/43/986LzhkO_o.png" alt="image.png"></p> 
<p><strong>SQL Server :</strong><br> 是由微软公司开发的一种<a href="https://so.csdn.net/so/search?q=%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93&amp;spm=1001.2101.3001.7020">关系型数据库</a>管理系统（RDBMS），用于存储和检索数据。它提供了一个可扩展的、安全的和可靠的数据存储和管理解决方案。<br> <img src="https://images2.imgbox.com/cd/3f/96GRhjiG_o.png" alt="image.png"><br> <strong>Oracle：</strong><br> 是目前比较成功的关系型数据库管理系统。运行稳定、功能齐全、性能超群、技术领先。主要应用在大型的企业数据库领域。<br> <img src="https://images2.imgbox.com/ec/ce/eaR4QrhQ_o.png" alt="image.png"></p> 
<h4><a id="4MySQL_22"></a>4、MySQL基本操作详解</h4> 
<p>上一篇教程已经安装好了MySQL还有phpMyAdmin，直接在这里进行操作。<br> <img src="https://images2.imgbox.com/43/22/KZNufKHZ_o.png" alt="image.png"><br> 右上角点击数据库工具-&gt;打开-&gt;选择phpMyAdmin，打开网页,账号和密码都是root，登录进去。<br> <img src="https://images2.imgbox.com/fc/5a/pPBRdD6D_o.png" alt="image.png"><br> 直接选择SQL，就可以在这里编写SQL语句进行测试了。<img src="https://images2.imgbox.com/82/7a/NsueUhmO_o.png" alt="image.png"></p> 
<h5><a id="41_28"></a>4.1、数据库操作</h5> 
<p>①、查看MySQL服务器下所有数据库</p> 
<pre><code class="prism language-sql"><span class="token keyword">SHOW</span> <span class="token keyword">DATABASES</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/54/08/j5qJLHCG_o.png" alt="image.png"><br> <img src="https://images2.imgbox.com/cb/d6/6TaoiARJ_o.png" alt="image.png"></p> 
<blockquote> 
 <p>information_schema数据库是MySQL服务器的数据字典（保存所有数据表和库的结构信息）<br> performance_schema数据库是MySQL服务器的性能字典（保存全局变量等的设置）<br> mysql 主要负责MySQL服务器自己需要使用的控制和管理信息（用户的权限关系等）<br> sys是系统数据库，包括了存储过程，自定义函数等信息<br> 这4个数据库是MySQL安装时自动创建的，建议不要随意的删除和修改这些数据库，避免造成服务器故障。</p> 
</blockquote> 
<p>②、查看指定数据库的创建信息</p> 
<pre><code class="prism language-sql"><span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> 数据库名称<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/2a/50/BCkl8vnv_o.png" alt="image.png"></p> 
<blockquote> 
 <p>显示sys数据库的SQL语句，以及数据库的默认字符集</p> 
</blockquote> 
<p>③、选择数据库并查看当前数据库<br> <strong>切记</strong>：在输入当前数据库查询的SQL语句前，必须先选择数据库。<br> 先选择editdata数据库,执行如下语句：</p> 
<pre><code class="prism language-sql"><span class="token keyword">USE</span> EditData
</code></pre> 
<p>接着查看当前数据库：</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">DATABASE</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e6/9b/GrjxNVNJ_o.png" alt="image.png"><br> ④、创建数据库</p> 
<pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> userinfo<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f4/cc/cs7QRW91_o.png" alt="image.png"><br> ⑤、选择数据库</p> 
<pre><code class="prism language-sql"><span class="token keyword">USE</span> userinfo<span class="token punctuation">;</span>
</code></pre> 
<p>也可以点击左侧的数据库列表进行数据库的选择。<br> ⑥、删除数据库</p> 
<pre><code class="prism language-sql"><span class="token keyword">DROP</span> <span class="token keyword">DATABASE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> userinfo<span class="token punctuation">;</span>
</code></pre> 
<ul><li>删除数据库，清除数据库中的所有数据，回收为分配的存储空间。</li><li>在执行DROP DATABASE 删除数据库时，若待删除的数据库不存在，MySQL服务器会报错。</li><li>若想避免上述的情况，在进行删除数据库操作时，使用IF EXISTS来进行规避待删除的数据库不存在报错情况。</li></ul> 
<h5><a id="42_77"></a>4.2、数据表操作</h5> 
<p>①、创建数据表</p> 
<pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token punctuation">[</span><span class="token keyword">TEMPORARY</span><span class="token punctuation">]</span> <span class="token keyword">TABLE</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> 表名<span class="token punctuation">(</span> 
    字段<span class="token number">1</span> 字段<span class="token number">1</span>类型 <span class="token punctuation">[</span>字段属性<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> 字段<span class="token number">1</span>注释 <span class="token punctuation">]</span><span class="token punctuation">,</span> 
    字段<span class="token number">2</span> 字段<span class="token number">2</span>类型 <span class="token punctuation">[</span>字段属性<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> 字段<span class="token number">2</span>注释 <span class="token punctuation">]</span><span class="token punctuation">,</span> 
    字段<span class="token number">3</span> 字段<span class="token number">3</span>类型 <span class="token punctuation">[</span>字段属性<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> 字段<span class="token number">3</span>注释 <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> 
    字段n 字段n类型 <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> 字段n注释 <span class="token punctuation">]</span> 
<span class="token punctuation">)</span> <span class="token punctuation">[</span>表属性<span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token keyword">COMMENT</span> 表注释 <span class="token punctuation">]</span> <span class="token punctuation">;</span>
</code></pre> 
<p>例子，创建一个user的表，存储用户的用户名和密码。</p> 
<pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>userinfo<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span> <span class="token punctuation">(</span> 
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">INT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token punctuation">,</span> 
  <span class="token identifier"><span class="token punctuation">`</span>username<span class="token punctuation">`</span></span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>password<span class="token punctuation">`</span></span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token punctuation">,</span> 
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> MyISAM<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d9/a9/0t7nGByE_o.png" alt="image.png"><br> <img src="https://images2.imgbox.com/b0/3d/mDdTPMcG_o.png" alt="image.png"><br> ②、查看数据表</p> 
<pre><code class="prism language-sql"><span class="token keyword">SHOW</span> <span class="token keyword">TABLES</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/6d/1a/XYXw4s3d_o.png" alt="image.png"><br> ③、查看数据表的相关信息</p> 
<pre><code class="prism language-sql"><span class="token keyword">SHOW</span> <span class="token keyword">TABLE</span> <span class="token keyword">STATUS</span> <span class="token keyword">FROM</span> 数据库名<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/0d/54/v46FnQBb_o.png" alt="image.png"><br> ④、查看表结构</p> 
<pre><code class="prism language-sql">{<!-- --><span class="token keyword">DESCRIBE</span><span class="token operator">|</span><span class="token keyword">DESC</span>} 数据表名<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8f/ed/NRpxvqHx_o.png" alt="image.png"><br> ⑤、修改数据表名称</p> 
<pre><code class="prism language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 旧表名 <span class="token keyword">RENAME</span> <span class="token punctuation">[</span><span class="token keyword">TO</span><span class="token operator">|</span><span class="token keyword">AS</span><span class="token punctuation">]</span> 新表名<span class="token punctuation">;</span>
</code></pre> 
<p>例如:</p> 
<pre><code class="prism language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token keyword">user</span> <span class="token keyword">RENAME</span> <span class="token keyword">AS</span> users<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/71/a6/365nO6z1_o.png" alt="image.png"><br> ⑥、删除数据表</p> 
<pre><code class="prism language-sql"><span class="token keyword">DROP</span> <span class="token punctuation">[</span><span class="token keyword">TEMPORARY</span><span class="token punctuation">]</span> <span class="token keyword">TABLE</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> 数据表<span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> 
<p>例如:</p> 
<pre><code class="prism language-sql"><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> users<span class="token punctuation">;</span>
</code></pre> 
<p>就成功删除了</p> 
<h5><a id="43_131"></a>4.3、数据操作</h5> 
<p>①、增加数据<br> 为了方便操作，这里重新加上刚删除的表。</p> 
<pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>userinfo<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span> <span class="token punctuation">(</span> 
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">INT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token punctuation">,</span> 
  <span class="token identifier"><span class="token punctuation">`</span>username<span class="token punctuation">`</span></span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>password<span class="token punctuation">`</span></span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token punctuation">,</span> 
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> MyISAM<span class="token punctuation">;</span>
</code></pre> 
<p>可以为部分字段添加数据，模板：</p> 
<pre><code class="prism language-sql"><span class="token keyword">INSERT</span> <span class="token punctuation">[</span><span class="token keyword">INTO</span><span class="token punctuation">]</span> 数据表名<span class="token punctuation">(</span>字段名<span class="token number">1</span><span class="token punctuation">,</span>字段名<span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>字段名n<span class="token punctuation">)</span> {<!-- --><span class="token keyword">VALUES</span><span class="token operator">|</span><span class="token keyword">VALUE</span>} <span class="token punctuation">(</span>值<span class="token number">1</span><span class="token punctuation">,</span>值<span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>值n<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>例如：</p> 
<pre><code class="prism language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token keyword">user</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>username<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>password<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">,</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/33/46/OO0Nn3Tq_o.png" alt="image.png"><br> 也可以用下面的方式:</p> 
<pre><code class="prism language-sql"><span class="token keyword">INSERT</span> <span class="token punctuation">[</span><span class="token keyword">INTO</span><span class="token punctuation">]</span> 数据表名 <span class="token keyword">SET</span> 字段名<span class="token number">1</span> <span class="token operator">=</span> 值<span class="token number">1</span> <span class="token punctuation">[</span><span class="token punctuation">,</span>字段名<span class="token number">2</span> <span class="token operator">=</span> 值<span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>字段名n <span class="token operator">=</span> 值n<span class="token punctuation">]</span>
</code></pre> 
<p>例如:</p> 
<pre><code class="prism language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token keyword">user</span> <span class="token keyword">SET</span> <span class="token identifier"><span class="token punctuation">`</span>username<span class="token punctuation">`</span></span> <span class="token operator">=</span><span class="token string">"1234"</span> <span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>password<span class="token punctuation">`</span></span><span class="token operator">=</span><span class="token string">"1234"</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b9/65/wt3KvyUN_o.png" alt="image.png"><br> 为所有字段添加数据。</p> 
<pre><code class="prism language-sql"><span class="token keyword">INSERT</span> <span class="token punctuation">[</span><span class="token keyword">INTO</span><span class="token punctuation">]</span> 数据表名 {<!-- --><span class="token keyword">VALUES</span><span class="token operator">|</span><span class="token keyword">VALUE</span>} <span class="token punctuation">(</span>值<span class="token number">1</span><span class="token punctuation">,</span>值<span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>值n<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>例如:</p> 
<pre><code class="prism language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token keyword">user</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">"3"</span><span class="token punctuation">,</span><span class="token string">"12345"</span><span class="token punctuation">,</span><span class="token string">"12345"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/22/b3/RBR95v4u_o.png" alt="image.png"><br> 在为所有字段添加数据时，可以省略字段名称，严格按照数据表结构（字段的位置）插入对应的值。<br> INTO 为可选择项；VALUE 和VALUES可以任选一种，通常情况下使用VALUES；值列表中值之间用逗号隔开。<br> 在插入数据时，插入的数据顺序必须与创建数据表时对应的字段位置顺序相同，不可搞乱顺序，规避数据顺序错误情况。<br> ②、查询数据<br> <strong>查询全部数据</strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> 数据表名<span class="token punctuation">;</span>
</code></pre> 
<p>例如查询user所有的数据：</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre> 
<p>可以查询出所有内容。<br> <img src="https://images2.imgbox.com/91/c7/3Gb2Pyy4_o.png" alt="image.png"><br> <strong>查询表子部分字段</strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> {字段名<span class="token number">1</span><span class="token punctuation">,</span>字段名<span class="token number">2</span><span class="token punctuation">,</span>字段名<span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>字段名n} <span class="token keyword">FROM</span> 数据表名<span class="token punctuation">;</span>
</code></pre> 
<p>例如只查询用户名可以这样写:</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> username <span class="token keyword">FROM</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/2e/a3/pJ0Aoy4t_o.png" alt="image.png"><br> <strong>简单条件查询数据</strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> 数据表名 <span class="token keyword">WHERE</span> 条件表达式<span class="token punctuation">;</span>
</code></pre> 
<p>例如:</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span>  <span class="token keyword">FROM</span> <span class="token keyword">user</span> <span class="token keyword">WHERE</span> <span class="token identifier"><span class="token punctuation">`</span>username<span class="token punctuation">`</span></span> <span class="token operator">=</span> <span class="token string">"123"</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/cc/c4/o1qxMaKU_o.png" alt="image.png"></p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span>  <span class="token keyword">FROM</span> <span class="token keyword">user</span> <span class="token keyword">WHERE</span> <span class="token identifier"><span class="token punctuation">`</span>username<span class="token punctuation">`</span></span> <span class="token operator">=</span> <span class="token string">"123"</span> <span class="token operator">and</span> <span class="token identifier"><span class="token punctuation">`</span>password<span class="token punctuation">`</span></span><span class="token operator">=</span><span class="token string">"123"</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/59/b0/1XZyWx6c_o.png" alt="image.png"><br> ③、更新数据</p> 
<pre><code class="prism language-sql"><span class="token keyword">UPDATE</span> 数据表名 <span class="token keyword">SET</span> 字段名<span class="token number">1</span> <span class="token operator">=</span> 值<span class="token number">1</span> <span class="token punctuation">[</span><span class="token punctuation">,</span>字段名<span class="token number">2</span> <span class="token operator">=</span> 值<span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">WHERE</span> 条件表达式<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> 
<p>例如:</p> 
<pre><code class="prism language-sql"><span class="token keyword">UPDATE</span> <span class="token keyword">user</span> <span class="token keyword">SET</span> <span class="token identifier"><span class="token punctuation">`</span>username<span class="token punctuation">`</span></span> <span class="token operator">=</span> <span class="token string">"666"</span> <span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>password<span class="token punctuation">`</span></span> <span class="token operator">=</span><span class="token string">"666"</span> <span class="token keyword">WHERE</span> <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token operator">=</span><span class="token string">"1"</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/21/24/rrlYVHIl_o.png" alt="image.png"><br> <img src="https://images2.imgbox.com/12/de/xGDeLmL2_o.png" alt="image.png"><br> ④、删除数据</p> 
<pre><code class="prism language-sql"><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> 数据表名 <span class="token punctuation">[</span><span class="token keyword">WHERE</span> 条件表达式<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> 
<p>例如：</p> 
<pre><code class="prism language-sql"><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> <span class="token keyword">user</span> <span class="token keyword">WHERE</span> <span class="token identifier"><span class="token punctuation">`</span>username<span class="token punctuation">`</span></span><span class="token operator">=</span><span class="token string">"1234"</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/68/0f/7YrgiPzb_o.png" alt="image.png"></p> 
<h4><a id="5pymysql_223"></a>5、pymysql基本操作</h4> 
<h5><a id="51pymysql_224"></a>5.1、pymysql介绍</h5> 
<p>PyMySQL是一个Python编写的MySQL驱动程序,让我们可以用Python语言操作MySQL数据库。</p> 
<h5><a id="52_226"></a>5.2、数据操作</h5> 
<p>首先创建好数据库，userinfo在上面练习过程中创建好了，以这个为例。<br> 接着编写测试函数进行数据操作的增删改查，在之前的后端项目创建一个test.py文件进行测试。<br> ①、增加数据</p> 
<pre><code class="prism language-sql"><span class="token keyword">import</span> pymysql

def adduser<span class="token punctuation">(</span><span class="token punctuation">)</span>:
    conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span><span class="token keyword">connect</span><span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span> <span class="token keyword">user</span><span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> <span class="token keyword">charset</span><span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span> <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token keyword">cursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">execute</span><span class="token punctuation">(</span><span class="token string">'use userinfo'</span><span class="token punctuation">)</span>
    username<span class="token operator">=</span><span class="token string">"555"</span>
    password<span class="token operator">=</span><span class="token string">"555"</span>
    <span class="token keyword">sql</span> <span class="token operator">=</span> <span class="token string">"insert into user (`username`, `password`)values('"</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"','"</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>password<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"');"</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token keyword">sql</span><span class="token punctuation">)</span>

    count <span class="token operator">=</span> <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">execute</span><span class="token punctuation">(</span><span class="token keyword">sql</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">"success"</span>


<span class="token keyword">if</span> __name__ <span class="token operator">=</span><span class="token operator">=</span> <span class="token string">'__main__'</span>:
    adduser<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/e5/be/1OljwpwP_o.png" alt="image.png"><br> <img src="https://images2.imgbox.com/8d/ea/pLAZU1ig_o.png" alt="image.png"><br> ②、查询所有数据</p> 
<pre><code class="prism language-sql"><span class="token keyword">import</span> pymysql

def adduser<span class="token punctuation">(</span><span class="token punctuation">)</span>:
    conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span><span class="token keyword">connect</span><span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span> <span class="token keyword">user</span><span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> <span class="token keyword">charset</span><span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span> <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token keyword">cursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">execute</span><span class="token punctuation">(</span><span class="token string">'use userinfo'</span><span class="token punctuation">)</span>
    username<span class="token operator">=</span><span class="token string">"555"</span>
    password<span class="token operator">=</span><span class="token string">"555"</span>
    <span class="token keyword">sql</span> <span class="token operator">=</span> <span class="token string">"insert into user (`username`, `password`)values('"</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"','"</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>password<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"');"</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token keyword">sql</span><span class="token punctuation">)</span>

    count <span class="token operator">=</span> <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">execute</span><span class="token punctuation">(</span><span class="token keyword">sql</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">"success"</span>

def serchall<span class="token punctuation">(</span><span class="token punctuation">)</span>:
    conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span><span class="token keyword">connect</span><span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span> <span class="token keyword">user</span><span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> <span class="token keyword">charset</span><span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span> <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token keyword">cursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">execute</span><span class="token punctuation">(</span><span class="token string">'use userinfo'</span><span class="token punctuation">)</span>
    <span class="token keyword">sql</span> <span class="token operator">=</span> <span class="token string">"select * from user;"</span>
    count <span class="token operator">=</span> <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">execute</span><span class="token punctuation">(</span><span class="token keyword">sql</span><span class="token punctuation">)</span>
    <span class="token keyword">data</span> <span class="token operator">=</span> <span class="token keyword">cursor</span><span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># cursor.fetchall()</span>
    tableData <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token operator">in</span> range<span class="token punctuation">(</span>count<span class="token punctuation">)</span>:
        datai <span class="token operator">=</span> <span class="token keyword">data</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        dataiJson <span class="token operator">=</span> {<!-- --><span class="token string">"id"</span>: datai<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"username"</span>: datai<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"password"</span>: datai<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>}
        tableData<span class="token punctuation">.</span>append<span class="token punctuation">(</span>dataiJson<span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> tableData


<span class="token keyword">if</span> __name__ <span class="token operator">=</span><span class="token operator">=</span> <span class="token string">'__main__'</span>:
    tableData<span class="token operator">=</span>serchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>tableData<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/01/42/9LcB8pHg_o.png" alt="image.png"><br> ③、删除数据</p> 
<pre><code class="prism language-sql"><span class="token keyword">import</span> pymysql

def adduser<span class="token punctuation">(</span><span class="token punctuation">)</span>:
    conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span><span class="token keyword">connect</span><span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span> <span class="token keyword">user</span><span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> <span class="token keyword">charset</span><span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span> <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token keyword">cursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">execute</span><span class="token punctuation">(</span><span class="token string">'use userinfo'</span><span class="token punctuation">)</span>
    username<span class="token operator">=</span><span class="token string">"555"</span>
    password<span class="token operator">=</span><span class="token string">"555"</span>
    <span class="token keyword">sql</span> <span class="token operator">=</span> <span class="token string">"insert into user (`username`, `password`)values('"</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"','"</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>password<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"');"</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token keyword">sql</span><span class="token punctuation">)</span>

    count <span class="token operator">=</span> <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">execute</span><span class="token punctuation">(</span><span class="token keyword">sql</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">"success"</span>

def serchall<span class="token punctuation">(</span><span class="token punctuation">)</span>:
    conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span><span class="token keyword">connect</span><span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span> <span class="token keyword">user</span><span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> <span class="token keyword">charset</span><span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span> <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token keyword">cursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">execute</span><span class="token punctuation">(</span><span class="token string">'use userinfo'</span><span class="token punctuation">)</span>
    <span class="token keyword">sql</span> <span class="token operator">=</span> <span class="token string">"select * from user;"</span>
    count <span class="token operator">=</span> <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">execute</span><span class="token punctuation">(</span><span class="token keyword">sql</span><span class="token punctuation">)</span>
    <span class="token keyword">data</span> <span class="token operator">=</span> <span class="token keyword">cursor</span><span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># cursor.fetchall()</span>
    tableData <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token operator">in</span> range<span class="token punctuation">(</span>count<span class="token punctuation">)</span>:
        datai <span class="token operator">=</span> <span class="token keyword">data</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        dataiJson <span class="token operator">=</span> {<!-- --><span class="token string">"id"</span>: datai<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"username"</span>: datai<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"password"</span>: datai<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>}
        tableData<span class="token punctuation">.</span>append<span class="token punctuation">(</span>dataiJson<span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> tableData

def deletedata<span class="token punctuation">(</span><span class="token punctuation">)</span>:
    conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span><span class="token keyword">connect</span><span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span> <span class="token keyword">user</span><span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> <span class="token keyword">charset</span><span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span> <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token keyword">cursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">execute</span><span class="token punctuation">(</span><span class="token string">'use userinfo'</span><span class="token punctuation">)</span>
    username<span class="token operator">=</span><span class="token string">"555"</span>
    <span class="token keyword">sql</span><span class="token operator">=</span> <span class="token string">"delete from user where username='"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"';"</span>
    count<span class="token operator">=</span><span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">execute</span><span class="token punctuation">(</span><span class="token keyword">sql</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">"success"</span>


<span class="token keyword">if</span> __name__ <span class="token operator">=</span><span class="token operator">=</span> <span class="token string">'__main__'</span>:
    deletedata<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/84/a6/FT77m6CE_o.png" alt="image.png"><br> ④、修改数据</p> 
<pre><code class="prism language-sql"><span class="token keyword">import</span> pymysql

def adduser<span class="token punctuation">(</span><span class="token punctuation">)</span>:
    conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span><span class="token keyword">connect</span><span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span> <span class="token keyword">user</span><span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> <span class="token keyword">charset</span><span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span> <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token keyword">cursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">execute</span><span class="token punctuation">(</span><span class="token string">'use userinfo'</span><span class="token punctuation">)</span>
    username<span class="token operator">=</span><span class="token string">"555"</span>
    password<span class="token operator">=</span><span class="token string">"555"</span>
    <span class="token keyword">sql</span> <span class="token operator">=</span> <span class="token string">"insert into user (`username`, `password`)values('"</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"','"</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>password<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"');"</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token keyword">sql</span><span class="token punctuation">)</span>

    count <span class="token operator">=</span> <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">execute</span><span class="token punctuation">(</span><span class="token keyword">sql</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">"success"</span>

def serchall<span class="token punctuation">(</span><span class="token punctuation">)</span>:
    conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span><span class="token keyword">connect</span><span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span> <span class="token keyword">user</span><span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> <span class="token keyword">charset</span><span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span> <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token keyword">cursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">execute</span><span class="token punctuation">(</span><span class="token string">'use userinfo'</span><span class="token punctuation">)</span>
    <span class="token keyword">sql</span> <span class="token operator">=</span> <span class="token string">"select * from user;"</span>
    count <span class="token operator">=</span> <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">execute</span><span class="token punctuation">(</span><span class="token keyword">sql</span><span class="token punctuation">)</span>
    <span class="token keyword">data</span> <span class="token operator">=</span> <span class="token keyword">cursor</span><span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># cursor.fetchall()</span>
    tableData <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token operator">in</span> range<span class="token punctuation">(</span>count<span class="token punctuation">)</span>:
        datai <span class="token operator">=</span> <span class="token keyword">data</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        dataiJson <span class="token operator">=</span> {<!-- --><span class="token string">"id"</span>: datai<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"username"</span>: datai<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"password"</span>: datai<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>}
        tableData<span class="token punctuation">.</span>append<span class="token punctuation">(</span>dataiJson<span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> tableData

def deletedata<span class="token punctuation">(</span><span class="token punctuation">)</span>:
    conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span><span class="token keyword">connect</span><span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span> <span class="token keyword">user</span><span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> <span class="token keyword">charset</span><span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span> <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token keyword">cursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">execute</span><span class="token punctuation">(</span><span class="token string">'use userinfo'</span><span class="token punctuation">)</span>
    username<span class="token operator">=</span><span class="token string">"555"</span>
    <span class="token keyword">sql</span><span class="token operator">=</span> <span class="token string">"delete from user where username='"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"';"</span>
    count<span class="token operator">=</span><span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">execute</span><span class="token punctuation">(</span><span class="token keyword">sql</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">"success"</span>
def <span class="token keyword">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>:
    conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span><span class="token keyword">connect</span><span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span> <span class="token keyword">user</span><span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> <span class="token keyword">charset</span><span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span> <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token keyword">cursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">execute</span><span class="token punctuation">(</span><span class="token string">'use userinfo'</span><span class="token punctuation">)</span>
    psd<span class="token operator">=</span><span class="token string">"789"</span>
    <span class="token keyword">sql</span><span class="token operator">=</span> <span class="token string">"""
    update user set `username`='"""</span><span class="token operator">+</span>str<span class="token punctuation">(</span><span class="token string">"789"</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"', `password`='"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>psd<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"' where `username`='"</span><span class="token operator">+</span>str<span class="token punctuation">(</span><span class="token string">"12345"</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"';"</span>
    count<span class="token operator">=</span><span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">execute</span><span class="token punctuation">(</span><span class="token keyword">sql</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">cursor</span><span class="token punctuation">.</span><span class="token keyword">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span><span class="token keyword">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">"success"</span>

<span class="token keyword">if</span> __name__ <span class="token operator">=</span><span class="token operator">=</span> <span class="token string">'__main__'</span>:
    <span class="token keyword">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/2b/49/r4PWnkSg_o.png" alt="image.png"></p> 
<h3><a id="OCR_431"></a>四、OCR识别</h3> 
<p>OCR识别，是一种通过扫描、拍照等光学输入方式将各种票据、报刊、书籍、文稿及其他印刷品的文字转化为图像信息，再利用文字识别技术将图像信息转化为可以编辑和检索的文本的技术。OCR识别技术在现代社会中发挥着重要作用，它极大地提高了数据输入的效率和准确性，为文档处理和信息管理提供了高效的解决方案。本章节将详细阐述如何结合PaddlePaddle框架，实现前后端协同工作以完成输入图像中的文字识别任务。</p> 
<h4><a id="1_433"></a>1、图片上传</h4> 
<p>为了进行OCR操作，首先需要实现让用户在前端上传图片，这里使用Elemet-Plus的Upload组件进行实现。<br> <img src="https://images2.imgbox.com/68/25/ve4pJC6a_o.png" alt="image.png"><br> 先简单调整一下前端样式，打开src/style.css,修改#app样式如下:</p> 
<pre><code class="prism language-css"><span class="token selector">#app</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">max-width</span><span class="token punctuation">:</span> 1280px<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 2rem<span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在HomePage/index.vue中进行测试，修改代码如下。</p> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div class="mainbody"&gt;
    &lt;h1 class="headtitle"&gt;首页&lt;/h1&gt;
    &lt;div&gt;
      &lt;h2 class=""&gt;{<!-- -->{ demoStore.helloPinia}}&lt;/h2&gt;
    &lt;/div&gt;
    
    &lt;div class="uploadimage"&gt;
      &lt;p class="commodity_img"&gt;
            &lt;!-- 上传图片
              :class="boxdisplay"
             --&gt;
            &lt;el-upload
              :on-success="handleSuccess"
              list-type="picture-card"
              :auto-upload="false"
              :on-change="handleChanges"
              :before-remove="beforeRemove"
              :on-preview="handlePictureCardPreview"
              :file-list="fileList "
              multiple
              limit="1"
              name="img"
            &gt;
              &lt;el-icon class="avatar-uploader-icon"&gt;
                &lt;Plus /&gt;
              &lt;/el-icon&gt;
            &lt;/el-upload&gt;
        &lt;/p&gt;

    &lt;el-dialog v-model="dialogVisible"&gt;
      &lt;img w-full class="imageshow" :src="dialogImageUrl" alt="Preview Image" /&gt;
    &lt;/el-dialog&gt;
  &lt;/div&gt;
  &lt;el-button type="primary" @click="uploadimg"&gt;上传图片&lt;/el-button&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script setup lang="ts"&gt;
  import { mainStore} from '../../store/index'
  /* 引入storeToRefs */
  import { storeToRefs } from 'pinia'

  //storeToRefs只会关注sotre中数据，不会对方法进行ref包裹

  /* 得到countStore */
  const demoStore =mainStore()

  import axios from 'axios'
  //进行测试接口调用
  const adduser=()=&gt;{
    let formData = new FormData();
    formData.append("username","12345");
    formData.append("password","54321");
    let url = 'http://127.0.0.1:5000/adduser' //访问后端接口的url
    let method = 'post'
    axios({
      method,
      url,
      data: formData,
    }).then(res =&gt; {
      // alert(res.data)
      console.log("你好")
    });
  }
  adduser()

  import { ref } from 'vue'
  import { ElMessage } from 'element-plus';
  import { Delete, Download, Plus, ZoomIn } from '@element-plus/icons-vue'

  import type { UploadFile } from 'element-plus'

  const dialogImageUrl = ref('')
  const dialogVisible = ref(false)
  const disabled = ref(false)

  const handleRemove = (file: UploadFile) =&gt; {
    file.url = '';
    file=null;
  }

  const handlePictureCardPreview = (file: UploadFile) =&gt; {
    dialogImageUrl.value = file.url!
    dialogVisible.value = true
  }

  const handleDownload = (file: UploadFile) =&gt; {
   
  }

  const boxdisplay = ref("show_box");

  const upload_btn = ref(false);
  const fileList = ref([]);
  const handleSuccess = () =&gt; {
    // 上传成功后，隐藏上传按钮
    upload_btn.value = true;
  };
  const handleChanges = img =&gt; {
    fileList.value.push(img);
    boxdisplay.value = "hide_box";
  };
  import {ElMessageBox} from 'element-plus'
  // 删除
  const beforeRemove = () =&gt; {
    const result = new Promise((resolve, reject) =&gt; {
      ElMessageBox.confirm("此操作将删除该图片, 是否继续?", "提示", {
        confirmButtonText: "确定",
        cancelButtonText: "取消",
        type: "warning"
      })
        .then(() =&gt; {
          boxdisplay.value = "show_box";
          resolve();
          fileList.value = [];
          upload_btn.value = false;
        })
        .catch(() =&gt; {
          reject(false);
        });
    });
    return result;
  };
  const uploadimg = () =&gt; {
    // alert("上传图片")
    let formData = new FormData();
      // 遍历fileList，为每个文件创建一个新的表单字段 
    formData.append("username","12345");
    fileList.value.forEach((file, index) =&gt; {  
      // 假设后端期望的文件字段名为 'file[]' 以支持多文件上传  
      // 如果后端只期望单个文件，则字段名可能只是 'file'  
      // formData.append(`file[${index}]`, file.raw);  
      formData.append("file",file.raw);
      console.log(file.raw)
    });  

    let url = 'http://127.0.0.1:5000/uploadimages' //访问后端接口的url
    let method = 'post'
    axios({
        method,  
        url,  
        data: formData,  
        headers: {  
          'Content-Type': 'multipart/form-data' // 确保设置了正确的Content-Type  
        }  
    }).then(res =&gt; {
        const result = new Promise((resolve, reject) =&gt; {
                resolve();
                fileList.value = [];
                upload_btn.value = false;
                ElMessage({ message: '图片上传成功', type: 'success' });  
              })
              .catch(() =&gt; {
                reject(false);
              });
          });
  }
&lt;/script&gt;

&lt;style scoped&gt;
.mainbody {
  position: relative;
  width:100vw;
  height: 100vh;
  display: block;
}
.headtitle {
  filter: drop-shadow(0 0 2em #646cffaa);
  margin: 0;
}
&lt;/style&gt;
&lt;style lang="scss" scoped&gt;
/* #在此处编写代码 */
.mainbody{
  background: #76cfe5;
}
&lt;/style&gt;
&lt;style scoped&gt;
.hide_box  {
  display: none;
}
.show_box{
  display: inline-flex;
}
.imageshow{
  width: 100%;  
  height: 100%;  
  object-fit: fill; 
}
&lt;/style&gt;
</code></pre> 
<h4><a id="2_638"></a>2、后端接收并保存图片</h4> 
<p>在后端项目文件夹创建static/images文件夹，用户上传的图片可以存储在此处。<br> <img src="https://images2.imgbox.com/0c/1f/dfkcoS2b_o.png" alt="image.png"><br> 首先，在终端执行下面安装语句安装opencv-python:</p> 
<pre><code class="prism language-bash">pip <span class="token function">install</span> opencv-python <span class="token parameter variable">-i</span> https://pypi.tuna.tsinghua.edu.cn/simple
</code></pre> 
<p><img src="https://images2.imgbox.com/59/4f/Bt7L0W5S_o.png" alt="image.png"><br> 需要编写后端接口接收uploadimages前端传过来的图像:</p> 
<pre><code class="prism language-vue">from flask import Flask, json, request, jsonify
from flask_cors import CORS
import pymysql
import cv2
import numpy as np
import os
DEBUG = True
app = Flask(__name__)
app.config.from_object(__name__)
CORS(app, resource={r'/*': {'origins': '*'}})

@app.route('/adduser', methods=['get', 'post'])
def adduser():
    username = request.form.get("username")
    password = request.form.get("password")
    print(username)
    print(password)
    return "已接收用户信息"

@app.route('/uploadimages', methods=['get', 'post'])
def uploadimages():
    username = request.form.get("username")
    img = request.files['file']
    picname=img.filename
    file = img.read()

    file = cv2.imdecode(np.frombuffer(file, np.uint8), cv2.IMREAD_COLOR)  # 解码为ndarray
    imgfile1_path = "./static/images/"+username+"/"
    if not os.path.exists(imgfile1_path):
        os.makedirs(imgfile1_path)
    img1_path = os.path.join(imgfile1_path, picname)
    cv2.imwrite(filename=img1_path, img=file)
    url = "http://127.0.0.1:5000/static/images/"+username+"/" + picname
    print(url)

    tempmap = {"url": url}
    return jsonify(tempmap)

    return "已接收用户图片信息"

if __name__ == '__main__':
    app.run(host="127.0.0.1", port=5000, debug=True)
</code></pre> 
<p>在前端进行上传，发现能够传输到后端并且能进行存储，并返回图片链接。<br> <img src="https://images2.imgbox.com/3c/28/I1ugCmAW_o.png" alt="image.png"><br> <img src="https://images2.imgbox.com/0f/90/zpSBqrIe_o.png" alt="image.png"><br> <img src="https://images2.imgbox.com/1e/59/rHraS34Y_o.png" alt="image.png"><br> 访问链接可发现能够访问到上传的图像。<br> <img src="https://images2.imgbox.com/43/4b/UGMFDVHY_o.png" alt="image.png"></p> 
<h4><a id="3_697"></a>3、数据库存储图片信息</h4> 
<p>存储图片信息可以为存Base64编码，但是比较吃资源，这里实现存储图片在本地，存储图片路径，用户通过路径访问服务器的图片从而实现存储功能。上一步骤已经生成了图像的链接，接下来把这部分存储到数据库当中。<br> 在之前配置好的Phpstudy的PhpMyAdmin中创建数据库EditData。<br> <img src="https://images2.imgbox.com/69/84/SIO6qdKr_o.png" alt="image.png"><br> 接着创建一个imgpath的数据表，并设计几个字段。<br> 创建包含四个字段的imgpath数据表。<br> <img src="https://images2.imgbox.com/d7/14/QtLMwJbv_o.png" alt="image.png"><br> 进行字段的定义，<br> <img src="https://images2.imgbox.com/92/02/ZTVSf78U_o.png" alt="image.png"><br> <img src="https://images2.imgbox.com/e9/a2/3D4YNwCd_o.png" alt="image.png"><br> <img src="https://images2.imgbox.com/5c/b8/lDoQTaCT_o.png" alt="image.png"><br> 后端编写存储数据库的代码，完整的main.py代码如下:</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> json<span class="token punctuation">,</span> request<span class="token punctuation">,</span> jsonify
<span class="token keyword">from</span> flask_cors <span class="token keyword">import</span> CORS
<span class="token keyword">import</span> pymysql
<span class="token keyword">import</span> cv2
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> os
DEBUG <span class="token operator">=</span> <span class="token boolean">True</span>
app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">.</span>from_object<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
CORS<span class="token punctuation">(</span>app<span class="token punctuation">,</span> resource<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">r'/*'</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token string">'origins'</span><span class="token punctuation">:</span> <span class="token string">'*'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/adduser'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'get'</span><span class="token punctuation">,</span> <span class="token string">'post'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">adduser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    username <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span>
    password <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">"已接收用户信息"</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/uploadimages'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'get'</span><span class="token punctuation">,</span> <span class="token string">'post'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">uploadimages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    username <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span>
    img <span class="token operator">=</span> request<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span>
    picname<span class="token operator">=</span>img<span class="token punctuation">.</span>filename
    <span class="token builtin">file</span> <span class="token operator">=</span> img<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token builtin">file</span> <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imdecode<span class="token punctuation">(</span>np<span class="token punctuation">.</span>frombuffer<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>IMREAD_COLOR<span class="token punctuation">)</span>  <span class="token comment"># 解码为ndarray</span>
    imgfile1_path <span class="token operator">=</span> <span class="token string">"./static/images/"</span><span class="token operator">+</span>username<span class="token operator">+</span><span class="token string">"/"</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>imgfile1_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
        os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>imgfile1_path<span class="token punctuation">)</span>
    img1_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>imgfile1_path<span class="token punctuation">,</span> picname<span class="token punctuation">)</span>
    cv2<span class="token punctuation">.</span>imwrite<span class="token punctuation">(</span>filename<span class="token operator">=</span>img1_path<span class="token punctuation">,</span> img<span class="token operator">=</span><span class="token builtin">file</span><span class="token punctuation">)</span>
    url <span class="token operator">=</span> <span class="token string">"http://127.0.0.1:5000/static/images/"</span><span class="token operator">+</span>username<span class="token operator">+</span><span class="token string">"/"</span> <span class="token operator">+</span> picname
    <span class="token keyword">print</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span> user<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> charset<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
    cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'use editdata'</span><span class="token punctuation">)</span>
    sql <span class="token operator">=</span> <span class="token string">"INSERT INTO  `imgpath` (`username`,`url`,`picname`) VALUES('"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"','"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"','"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>picname<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"');"</span>
    <span class="token string">""</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    count <span class="token operator">=</span> cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    <span class="token comment"># print(count)</span>
    conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cursor<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

    tempmap <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"url"</span><span class="token punctuation">:</span> url<span class="token punctuation">}</span>
    <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span>tempmap<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token string">"已接收用户图片信息"</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

</code></pre> 
<p>前端上传图像，后端接收对应的数据，保存在本地后生成链接，存入地址信息至数据库。测试后发现，可以存储到数据库当中了。<br> <img src="https://images2.imgbox.com/34/68/vV4Q4dem_o.png" alt="image.png"></p> 
<h4><a id="4OCR_768"></a>4、OCR项目在线体验</h4> 
<p>登录<a href="https://aistudio.baidu.com/projectdetail/507159?channelType=0&amp;channel=0" rel="nofollow">Aistudio</a>平台。<br> <img src="https://images2.imgbox.com/75/1d/FJyaAEeY_o.png" alt="image.png"><br> 找到示例项目。<br> <img src="https://images2.imgbox.com/73/bf/OEv72Dml_o.png" alt="image.png"><br> 可以根据项目的说明在线体验一下。<br> <img src="https://images2.imgbox.com/d7/35/XiVUtb5E_o.png" alt="image.png"></p> 
<h4><a id="5OCR_776"></a>5、OCR项目本地部署</h4> 
<h5><a id="51PaddleOCR_777"></a>5.1、PaddleOCR准备</h5> 
<p>除了之前准备的PaddlePaddle环境，还需要PaddleOCR环境。<br> PaddleOCR码云地址：<a href="https://gitee.com/paddlepaddle/PaddleOCR" rel="nofollow">https://gitee.com/paddlepaddle/PaddleOCR</a><br> 模型地址:<a href="https://github.com/PaddlePaddle/PaddleOCR/blob/static/doc/doc_ch/algorithm_overview.md">https://github.com/PaddlePaddle/PaddleOCR/blob/static/doc/doc_ch/algorithm_overview.md</a><br> 快速开始:<a href="https://gitee.com/paddlepaddle/PaddleOCR/blob/main/doc/doc_ch/quickstart.md" rel="nofollow">https://gitee.com/paddlepaddle/PaddleOCR/blob/main/doc/doc_ch/quickstart.md</a><br> 先安装PaddleOCR whl包，执行如下指令:</p> 
<pre><code class="prism language-python">pip install <span class="token string">"paddleocr&gt;=2.0.1"</span> <span class="token operator">-</span>i https<span class="token punctuation">:</span><span class="token operator">//</span>pypi<span class="token punctuation">.</span>tuna<span class="token punctuation">.</span>tsinghua<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>simple <span class="token operator">-</span><span class="token operator">-</span>user  <span class="token comment"># 推荐使用2.0.1+版本</span>
</code></pre> 
<p>python终端执行:<br> <img src="https://images2.imgbox.com/f5/9e/FnTSLW9D_o.png" alt="image.png"><br> 安装完成后，上传一张需要识别的测试图片在test.py相同路径下，修改test.py代码进行测试。<br> <img src="https://images2.imgbox.com/a2/d0/ufuixJw4_o.png" alt="image.png"></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> paddle

<span class="token keyword">print</span><span class="token punctuation">(</span>paddle<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
paddle<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>run_check<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">from</span> paddleocr <span class="token keyword">import</span> PaddleOCR<span class="token punctuation">,</span> draw_ocr

<span class="token comment"># Paddleocr目前支持的多语言语种可以通过修改lang参数进行切换</span>
<span class="token comment"># 例如`ch`, `en`, `fr`, `german`, `korean`, `japan`</span>
ocr <span class="token operator">=</span> PaddleOCR<span class="token punctuation">(</span>use_angle_cls<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> lang<span class="token operator">=</span><span class="token string">"ch"</span><span class="token punctuation">)</span>  <span class="token comment"># need to run only once to download and load model into memory</span>
img_path <span class="token operator">=</span> <span class="token string">'./test.png'</span>
result <span class="token operator">=</span> ocr<span class="token punctuation">.</span>ocr<span class="token punctuation">(</span>img_path<span class="token punctuation">,</span> cls<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> idx <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    res <span class="token operator">=</span> result<span class="token punctuation">[</span>idx<span class="token punctuation">]</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> res<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>

<span class="token comment"># 显示结果</span>
<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image
result <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
image <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>img_path<span class="token punctuation">)</span><span class="token punctuation">.</span>convert<span class="token punctuation">(</span><span class="token string">'RGB'</span><span class="token punctuation">)</span>
boxes <span class="token operator">=</span> <span class="token punctuation">[</span>line<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> line <span class="token keyword">in</span> result<span class="token punctuation">]</span>
txts <span class="token operator">=</span> <span class="token punctuation">[</span>line<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> line <span class="token keyword">in</span> result<span class="token punctuation">]</span>
scores <span class="token operator">=</span> <span class="token punctuation">[</span>line<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">for</span> line <span class="token keyword">in</span> result<span class="token punctuation">]</span>
im_show <span class="token operator">=</span> draw_ocr<span class="token punctuation">(</span>image<span class="token punctuation">,</span> boxes<span class="token punctuation">,</span> txts<span class="token punctuation">,</span> scores<span class="token punctuation">,</span> font_path<span class="token operator">=</span><span class="token string">'./fonts/simfang.ttf'</span><span class="token punctuation">)</span>
im_show <span class="token operator">=</span> Image<span class="token punctuation">.</span>fromarray<span class="token punctuation">(</span>im_show<span class="token punctuation">)</span>
im_show<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'result.jpg'</span><span class="token punctuation">)</span>
</code></pre> 
<p>运行后，可以看到出现了result.jpg,同时有运行结果输出。<br> <img src="https://images2.imgbox.com/0d/ad/Iqn77rYs_o.png" alt="image.png"><br> result.jpg内容如下。<br> <img src="https://images2.imgbox.com/fe/a9/GTosM1bD_o.png" alt="image.png"><br> 至此，本地的环境配置完成，其他一些paddle模型本地运行也可以参考这种方式，安装对应的库，导入训练好的模型(或者自己重新训练也ok)，接着进行跑通即可在后续后端进行模型的使用。</p> 
<h5><a id="52api_824"></a>5.2、封装为api</h5> 
<p>加载模型其实比较费时，特别是加载一些比较大的模型时候，推理的时间会较少，因此，可以定义全局的模型，让flask运行时候就先加载好对应的模型，用的时候直接进行推理，能提高响应的速度，修改main.py代码如下。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> json<span class="token punctuation">,</span> request<span class="token punctuation">,</span> jsonify
<span class="token keyword">from</span> flask_cors <span class="token keyword">import</span> CORS
<span class="token keyword">import</span> pymysql
<span class="token keyword">import</span> cv2
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> os
<span class="token keyword">import</span> paddle
<span class="token keyword">from</span> paddleocr <span class="token keyword">import</span> PaddleOCR<span class="token punctuation">,</span> draw_ocr


DEBUG <span class="token operator">=</span> <span class="token boolean">True</span>
app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">.</span>from_object<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
CORS<span class="token punctuation">(</span>app<span class="token punctuation">,</span> resource<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">r'/*'</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token string">'origins'</span><span class="token punctuation">:</span> <span class="token string">'*'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
ocr <span class="token operator">=</span> PaddleOCR<span class="token punctuation">(</span>use_angle_cls<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> lang<span class="token operator">=</span><span class="token string">"ch"</span><span class="token punctuation">)</span>  <span class="token comment"># need to run only once to download and load model into memory</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/adduser'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'get'</span><span class="token punctuation">,</span> <span class="token string">'post'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">adduser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    username <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span>
    password <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">"已接收用户信息"</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/uploadimages'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'get'</span><span class="token punctuation">,</span> <span class="token string">'post'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">uploadimages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    username <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span>
    img <span class="token operator">=</span> request<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span>
    picname<span class="token operator">=</span>img<span class="token punctuation">.</span>filename
    <span class="token builtin">file</span> <span class="token operator">=</span> img<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token builtin">file</span> <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imdecode<span class="token punctuation">(</span>np<span class="token punctuation">.</span>frombuffer<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>IMREAD_COLOR<span class="token punctuation">)</span>  <span class="token comment"># 解码为ndarray</span>
    imgfile1_path <span class="token operator">=</span> <span class="token string">"./static/images/"</span><span class="token operator">+</span>username<span class="token operator">+</span><span class="token string">"/"</span>

    <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>imgfile1_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
        os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>imgfile1_path<span class="token punctuation">)</span>
    img1_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>imgfile1_path<span class="token punctuation">,</span> picname<span class="token punctuation">)</span>
    cv2<span class="token punctuation">.</span>imwrite<span class="token punctuation">(</span>filename<span class="token operator">=</span>img1_path<span class="token punctuation">,</span> img<span class="token operator">=</span><span class="token builtin">file</span><span class="token punctuation">)</span>

    img_path<span class="token operator">=</span>imgfile1_path<span class="token operator">+</span>picname
    result <span class="token operator">=</span> ocr<span class="token punctuation">.</span>ocr<span class="token punctuation">(</span>img_path<span class="token punctuation">,</span> cls<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> idx <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        res <span class="token operator">=</span> result<span class="token punctuation">[</span>idx<span class="token punctuation">]</span>
        <span class="token keyword">for</span> line <span class="token keyword">in</span> res<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>
    url <span class="token operator">=</span> <span class="token string">"http://127.0.0.1:5000/static/images/"</span><span class="token operator">+</span>username<span class="token operator">+</span><span class="token string">"/"</span> <span class="token operator">+</span> picname
    <span class="token keyword">print</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span> user<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> charset<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
    cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'use editdata'</span><span class="token punctuation">)</span>
    sql <span class="token operator">=</span> <span class="token string">"INSERT INTO  `imgpath` (`username`,`url`,`picname`) VALUES('"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"','"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"','"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>picname<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"');"</span>
    <span class="token string">""</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    count <span class="token operator">=</span> cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    <span class="token comment"># print(count)</span>
    conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cursor<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

    tempmap <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"url"</span><span class="token punctuation">:</span> url<span class="token punctuation">}</span>
    <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span>tempmap<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token string">"已接收用户图片信息"</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre> 
<p>前端上传需要识别的图片，传到后端后进行图像保存并识别文字，识别结果你可以根据自己的任务需求进行存数据库、传回前端等各种操作，至此，本地部署小模型的小模块实现完成了。</p> 
<h4><a id="6_896"></a>6、产线环境配置部署</h4> 
<p>如果本地资源不足(如无GPU算力，可以使用飞桨的模型产线功能)打开aistudio的<strong>模型产线模块。</strong><br> <img src="https://images2.imgbox.com/a6/52/NUsdZy3k_o.png" alt="image.png"><br> 创建一个新的产线，选择OCR，设置好产线名称后确认创建：<br> <img src="https://images2.imgbox.com/2c/92/w24jm5DV_o.png" alt="image.png"><br> 可以选择数据集后进行训练后再部署，也可以直接进行部署。<br> <img src="https://images2.imgbox.com/77/25/63vSomT0_o.png" alt="image.png"><br> 如果选择直接部署，选择环境之后即可进行，因为需要使用CPU或GPU资源。需要A币进行开启，推荐大家开一个小会员体验一下，送1000个A币+100万Token。<br> <img src="https://images2.imgbox.com/b9/20/sv3fjSZZ_o.png" alt="image.png"><br> 进行必须项的配置后点击开始部署。<br> <img src="https://images2.imgbox.com/42/55/3UyGtEZF_o.png" alt="image.png"><br> 即可发现部署完成了，给出了使用的示例。<br> <img src="https://images2.imgbox.com/5b/7d/3mCLnRbq_o.png" alt="image.png"><br> 在本地的test.py中编写代码测试一下,记得替换为自己的token：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> base64
<span class="token keyword">import</span> pathlib
<span class="token keyword">import</span> pprint

<span class="token keyword">import</span> requests

API_URL <span class="token operator">=</span> <span class="token string">"https://105b32tccaj145nd.aistudio-hub.baidu.com/ocr"</span>
<span class="token comment"># 请前往 https://aistudio.baidu.com/index/accessToken 查看 访问令牌 并替换</span>
TOKEN <span class="token operator">=</span> <span class="token string">"替换为您的token"</span>

<span class="token comment"># 设置鉴权信息</span>
headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"Authorization"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"token </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>TOKEN<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
    <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/json"</span>
<span class="token punctuation">}</span>

<span class="token comment"># 对本地图片进行Base64编码</span>
image_path <span class="token operator">=</span> <span class="token string">"./test.png"</span>
image_bytes <span class="token operator">=</span> pathlib<span class="token punctuation">.</span>Path<span class="token punctuation">(</span>image_path<span class="token punctuation">)</span><span class="token punctuation">.</span>read_bytes<span class="token punctuation">(</span><span class="token punctuation">)</span>
image_base64 <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>image_bytes<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'ascii'</span><span class="token punctuation">)</span>

<span class="token comment"># 设置请求体</span>
payload <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"image"</span><span class="token punctuation">:</span> image_base64  <span class="token comment"># Base64编码的文件内容或者文件链接</span>
<span class="token punctuation">}</span>

<span class="token comment"># 调用</span>
resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>API_URL<span class="token punctuation">,</span> json<span class="token operator">=</span>payload<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>

<span class="token comment"># 处理接口返回数据</span>
<span class="token keyword">assert</span> resp<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span>
result <span class="token operator">=</span> resp<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"result"</span><span class="token punctuation">]</span>
output_image_path <span class="token operator">=</span> <span class="token string">"output.jpg"</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>output_image_path<span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token string">"image"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"OCR结果图保存在 </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>output_image_path<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n文本信息:"</span><span class="token punctuation">)</span>
pprint<span class="token punctuation">.</span>pp<span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token string">"texts"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>运行后发现能够使用图像识别的功能，像本地部署一样封装为接口就可以前端调用使用了，可以让用户输入自己的接口，其他部分大家可以自行尝试。<br> <img src="https://images2.imgbox.com/2b/2f/KVspGuPq_o.png" alt="image.png"></p> 
<h2><a id="_952"></a>参考文章</h2> 
<p><a href="https://blog.csdn.net/m0_73995538/article/details/131216699">https://blog.csdn.net/m0_73995538/article/details/131216699</a><br> <a href="https://blog.csdn.net/m0_64338546/article/details/127149168">https://blog.csdn.net/m0_64338546/article/details/127149168</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/99d268d16f24c44986b27331d5dec4b8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【C&#43;&#43;】初识C&#43;&#43;</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/62b33a865f9a1410e4931295482769bd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Flink⼤状态作业调优实践指南：状态报错与启停慢篇</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>