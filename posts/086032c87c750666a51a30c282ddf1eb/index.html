<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【python】PyQt5事件机制、定时器原理分析和实战演练 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/086032c87c750666a51a30c282ddf1eb/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【python】PyQt5事件机制、定时器原理分析和实战演练">
  <meta property="og:description" content="✨✨ 欢迎大家来到景天科技苑✨✨
🎈🎈 养成好习惯，先赞后看哦~🎈🎈
🏆 作者简介：景天科技苑
🏆《头衔》：大厂架构师，华为云开发者社区专家博主，阿里云开发者社区专家博主，CSDN全栈领域优质创作者，掘金优秀博主，51CTO博客专家等。
🏆《博客》：Python全栈，前后端开发，小程序开发，云原生K8S，人工智能，js逆向，App逆向，网络系统安全，数据分析，PyQt5，tkinter，Django，fastapi，flask等框架，linux，shell脚本等实操经验，网站搭建，数据库等分享。
所属的专栏：PyQt5桌面应用开发，零基础到进阶应用实战
景天的主页：景天科技苑
文章目录 PyQt5事件机制PyQt5事件处理的APIPyQt5事件机制演练 PyQt5定时器定时器的操作方法有两种（1）利用每个对象包含的timerEvent函数（2）利用定时器模块QTimer PyQt5事件机制 PyQt为事件处理提供了两种机制：高级的信号与槽机制，以及低级的事件处理机制。信号与槽可以说是对事件处理机制的高级封装。事件机制更偏向于底层。
常见事件类型：
键盘事件：按键按下和松开。
鼠标事件：鼠标指针移动，鼠标按下和松开。
拖放事件：用鼠标进行拖放。
滚轮事件：鼠标滚轮滚动。
绘屏事件：重绘屏幕的某些部分。
定时事件：定时器到时。
焦点事件：键盘焦点移动。
进入/离开事件：鼠标指针移入Widget内，或者移出。
移动事件：Widget的位置改变。
大小改变事件：Widget的大小改变。
显示/隐藏事件：Widget显示和隐藏。
窗口事件：窗口是否为当前窗口。
PyQt提供了如下5种事件处理和过滤方法（有弱到强）：
重新实现事件函数，比如mousePressEvent(),keyPressEvent()等等。
重新实现QObject.event()。
安装时间过滤器。
在QApplication中安装事件过滤器。
重新实现QAppliction的notifiy()方法。
PyQt5事件处理的API PyQt5事件机制演练 import sys from PyQt5.Qt import * #通过继承，重新notify方法 #事件会分发给对象里面的notify方法 class App(QApplication): #notify第一个参数是控件类型（事件接收者），第二个是事件类型 def notify(self, recevier, evt): #notify会监控所有的事件，对事件进行分发。为了打印鼠标点击按钮产生的事件，我们进行了过滤 #过滤事件接收者是按钮，事件类型是鼠标按钮按下 #evt属于QEvent类型。QEvent类型里面有个type方法，用来判断事件类型 if recevier.inherits(&#34;QPushButton&#34;) and evt.type() == QEvent.MouseButtonPress: print(recevier, evt) #优先调用子类notify方法，由于我们没有写具体功能，什么也做不了，会报错，为了防止程序报错，需要将父类的notify方法返回 #这行代码就是负责分发的 return super().notify(recevier, evt) #写个子类，过滤event事件类型 class Btn(QPushButton): #事件会分发给按钮对象的event方法，event里面包含很多事件 def event(self, evt): if evt.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-03T07:15:00+08:00">
    <meta property="article:modified_time" content="2024-07-03T07:15:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【python】PyQt5事件机制、定时器原理分析和实战演练</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/1b/64/OTBdDN8y_o.jpg" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/48/07/BRK17DCk_o.png" alt="在这里插入图片描述"></p> 
<p><strong>✨✨ 欢迎大家来到景天科技苑✨✨</strong></p> 
<p><strong>🎈🎈 养成好习惯，先赞后看哦~🎈🎈</strong></p> 
<blockquote> 
 <p>🏆 作者简介：景天科技苑<br> 🏆《头衔》：大厂架构师，华为云开发者社区专家博主，阿里云开发者社区专家博主，CSDN全栈领域优质创作者，掘金优秀博主，51CTO博客专家等。<br> 🏆《博客》：Python全栈，前后端开发，小程序开发，云原生K8S，人工智能，js逆向，App逆向，网络系统安全，数据分析，PyQt5，tkinter，Django，fastapi，flask等框架，linux，shell脚本等实操经验，网站搭建，数据库等分享。</p> 
 <p><strong>所属的专栏：</strong><a href="https://blog.csdn.net/littlefun591/category_12704816.html?spm=1001.2014.3001.5482">PyQt5桌面应用开发，零基础到进阶应用实战</a><br> <strong>景天的主页：</strong><a href="https://jingtian.blog.csdn.net/" rel="nofollow">景天科技苑</a></p> 
</blockquote> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#PyQt5_22" rel="nofollow">PyQt5事件机制</a></li><li><ul><li><a href="#PyQt5API_55" rel="nofollow">PyQt5事件处理的API</a></li><li><a href="#PyQt5_60" rel="nofollow">PyQt5事件机制演练</a></li></ul> 
  </li><li><a href="#PyQt5_136" rel="nofollow">PyQt5定时器</a></li><li><ul><li><a href="#_142" rel="nofollow">定时器的操作方法有两种</a></li><li><ul><li><a href="#1timerEvent_148" rel="nofollow">（1）利用每个对象包含的timerEvent函数</a></li><li><a href="#2QTimer_259" rel="nofollow">（2）利用定时器模块QTimer</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="PyQt5_22"></a>PyQt5事件机制</h2> 
<p>PyQt为事件处理提供了两种机制：高级的信号与槽机制，以及低级的事件处理机制。信号与槽可以说是对事件处理机制的高级封装。事件机制更偏向于底层。</p> 
<p><strong>常见事件类型：</strong><br> 键盘事件：按键按下和松开。<br> 鼠标事件：鼠标指针移动，鼠标按下和松开。<br> 拖放事件：用鼠标进行拖放。<br> 滚轮事件：鼠标滚轮滚动。<br> 绘屏事件：重绘屏幕的某些部分。<br> 定时事件：定时器到时。<br> 焦点事件：键盘焦点移动。<br> 进入/离开事件：鼠标指针移入Widget内，或者移出。<br> 移动事件：Widget的位置改变。<br> 大小改变事件：Widget的大小改变。<br> 显示/隐藏事件：Widget显示和隐藏。<br> 窗口事件：窗口是否为当前窗口。<br> PyQt提供了如下5种事件处理和过滤方法（有弱到强）：</p> 
<p>重新实现事件函数，比如mousePressEvent(),keyPressEvent()等等。<br> 重新实现QObject.event()。<br> 安装时间过滤器。<br> 在QApplication中安装事件过滤器。<br> 重新实现QAppliction的notifiy()方法。</p> 
<p><img src="https://images2.imgbox.com/40/4b/OYWSSDNV_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/fb/89/PfTOU5Ml_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="PyQt5API_55"></a>PyQt5事件处理的API</h3> 
<p><img src="https://images2.imgbox.com/2d/0d/s6b5gP8f_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="PyQt5_60"></a>PyQt5事件机制演练</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sys
<span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>Qt <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token comment">#通过继承，重新notify方法</span>
<span class="token comment">#事件会分发给对象里面的notify方法</span>
<span class="token keyword">class</span> <span class="token class-name">App</span><span class="token punctuation">(</span>QApplication<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#notify第一个参数是控件类型（事件接收者），第二个是事件类型</span>
    <span class="token keyword">def</span> <span class="token function">notify</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> recevier<span class="token punctuation">,</span> evt<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#notify会监控所有的事件，对事件进行分发。为了打印鼠标点击按钮产生的事件，我们进行了过滤</span>
        <span class="token comment">#过滤事件接收者是按钮，事件类型是鼠标按钮按下</span>
        <span class="token comment">#evt属于QEvent类型。QEvent类型里面有个type方法，用来判断事件类型</span>
        <span class="token keyword">if</span> recevier<span class="token punctuation">.</span>inherits<span class="token punctuation">(</span><span class="token string">"QPushButton"</span><span class="token punctuation">)</span> <span class="token keyword">and</span> evt<span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> QEvent<span class="token punctuation">.</span>MouseButtonPress<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>recevier<span class="token punctuation">,</span> evt<span class="token punctuation">)</span>

        <span class="token comment">#优先调用子类notify方法，由于我们没有写具体功能，什么也做不了，会报错，为了防止程序报错，需要将父类的notify方法返回</span>
        <span class="token comment">#这行代码就是负责分发的</span>
        <span class="token keyword">return</span> <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>notify<span class="token punctuation">(</span>recevier<span class="token punctuation">,</span> evt<span class="token punctuation">)</span>

<span class="token comment">#写个子类，过滤event事件类型</span>
<span class="token keyword">class</span> <span class="token class-name">Btn</span><span class="token punctuation">(</span>QPushButton<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#事件会分发给按钮对象的event方法，event里面包含很多事件</span>
    <span class="token keyword">def</span> <span class="token function">event</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> evt<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> evt<span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> QEvent<span class="token punctuation">.</span>MouseButtonPress<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>evt<span class="token punctuation">)</span>
        <span class="token comment">#根据事件类型再次进行分发，根据不同事件调用不同事件函数</span>
        <span class="token keyword">return</span> <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>event<span class="token punctuation">(</span>evt<span class="token punctuation">)</span>

    <span class="token comment">#重写鼠标被按下事件函数</span>
    <span class="token keyword">def</span> <span class="token function">mousePressEvent</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"鼠标被按下了......"</span><span class="token punctuation">)</span>
        <span class="token comment">#返回父类鼠标事件函数，进而发射信号给槽，调用槽函数</span>
        <span class="token comment">#如果不返回，则不会发射信号给槽</span>
        <span class="token keyword">return</span> <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mousePressEvent<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>



app <span class="token operator">=</span> App<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span>

window <span class="token operator">=</span> QWidget<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">#设置主题</span>
window<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">"事件机制"</span><span class="token punctuation">)</span>
btn <span class="token operator">=</span> Btn<span class="token punctuation">(</span>window<span class="token punctuation">)</span>
btn<span class="token punctuation">.</span>setText<span class="token punctuation">(</span><span class="token string">"按钮"</span><span class="token punctuation">)</span>
btn<span class="token punctuation">.</span>move<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">cao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"按钮被点击了"</span><span class="token punctuation">)</span>

<span class="token comment">#按键按下</span>
btn<span class="token punctuation">.</span>pressed<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>cao<span class="token punctuation">)</span>

window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span>exec_<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>运行</p> 
<p><img src="https://images2.imgbox.com/35/22/hAyFqg7q_o.png" alt="在这里插入图片描述"></p> 
<p>点击按钮<br> 可见事件被触发<br> <img src="https://images2.imgbox.com/49/5b/iGdUY1Ct_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/df/2b/p2np0HAN_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="PyQt5_136"></a>PyQt5定时器</h2> 
<p>在基于PyQt5的应用程序开发过程中经常会遇到一些需要循环执行的任务，即定时多长时间任务循环一次。<br> 常用于数据库定时更新、界面刷新、内存清理、脚本任务运行、进度条等需要定时更新的程序段，小到某一参数的定时更新，大到整个线程任务的更新、程序段的循环定时执行。</p> 
<p>本文将详细介绍如何在PyQt5中使用定时器，包括定时器的基本原理、创建和使用定时器的方法以及一些实际应用案例。</p> 
<h3><a id="_142"></a>定时器的操作方法有两种</h3> 
<ul><li> <p>方法一：利用每个对象包含的timerEvent函数</p> </li><li> <p>方法二：利用定时器模块 需要 from PyQt5.QtCore import QTimer</p> </li></ul> 
<h4><a id="1timerEvent_148"></a>（1）利用每个对象包含的timerEvent函数</h4> 
<p>API介绍已经案例演示<br> <img src="https://images2.imgbox.com/c3/3c/5uvga5an_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># 0. 导入需要的包和模块</span>
<span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>Qt <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> sys

<span class="token comment">#自定义一个类继承QObejct</span>
<span class="token comment"># class MyObject(QObject):</span>
<span class="token comment">#     def timerEvent(self, evt): #重写对象的定时器函数</span>
<span class="token comment">#         print(evt, "1")</span>

<span class="token comment">#自定义个类继承QLabel，可以重写父类方法，尤其是timerEvent对象的定时器函数</span>
<span class="token keyword">class</span> <span class="token class-name">MyLabel</span><span class="token punctuation">(</span>QLabel<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#增加参数接收*args, **kwargs</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 当我们继承某个类时，需要调用父类构造方法</span>
        <span class="token comment">#加载父类初始化方法</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setText<span class="token punctuation">(</span><span class="token string">"10"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>move<span class="token punctuation">(</span><span class="token number">235</span><span class="token punctuation">,</span> <span class="token number">235</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setStyleSheet<span class="token punctuation">(</span><span class="token string">"font-size: 28px;"</span><span class="token punctuation">)</span>

    <span class="token comment">#设置标签上展示的初始数字</span>
    <span class="token keyword">def</span> <span class="token function">setSec</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> sec<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>setText<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>sec<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">startMyTimer</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ms<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#可以创建多个，每个startTimer返回的id不同</span>
        <span class="token comment">#每个一定的时间，就会自动执行对象中的timerEvent函数</span>
        <span class="token comment">#参数1 间隔时间，单位毫秒</span>
        self<span class="token punctuation">.</span>timer_id <span class="token operator">=</span> self<span class="token punctuation">.</span>startTimer<span class="token punctuation">(</span>ms<span class="token punctuation">,</span>timerType<span class="token operator">=</span>Qt<span class="token punctuation">.</span>PreciseTimer<span class="token punctuation">)</span> <span class="token comment">#启动对象定时器函数</span>

    <span class="token keyword">def</span> <span class="token function">timerEvent</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"倒计时进行中"</span><span class="token punctuation">)</span>
        <span class="token comment"># 1. 获取当前的标签的内容</span>
        current_sec <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        current_sec <span class="token operator">-=</span> <span class="token number">1</span>
        <span class="token comment">#将内容以字符串形式展示，整形数据没法直接放进来</span>
        self<span class="token punctuation">.</span>setText<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>current_sec<span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token comment">#当前数字减为0时，停止定时器</span>
        <span class="token keyword">if</span> current_sec <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"倒计时停止"</span><span class="token punctuation">)</span>
            <span class="token comment"># 释放对象的定时器函数</span>
            self<span class="token punctuation">.</span>killTimer<span class="token punctuation">(</span>self<span class="token punctuation">.</span>timer_id<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">MyWidget</span><span class="token punctuation">(</span>QWidget<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">startMyTimer</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ms<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#可以创建多个，每个startTimer返回的id不同</span>
        <span class="token comment">#每个一定的时间，就会自动执行对象中的timerEvent函数</span>
        <span class="token comment">#参数1 间隔时间，单位毫秒</span>
        self<span class="token punctuation">.</span>widget_id <span class="token operator">=</span> self<span class="token punctuation">.</span>startTimer<span class="token punctuation">(</span>ms<span class="token punctuation">,</span>timerType<span class="token operator">=</span>Qt<span class="token punctuation">.</span>PreciseTimer<span class="token punctuation">)</span> <span class="token comment">#启动对象定时器函数</span>

    <span class="token keyword">def</span> <span class="token function">timerEvent</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#获取当前窗口的高和宽</span>
        current_w <span class="token operator">=</span> self<span class="token punctuation">.</span>width<span class="token punctuation">(</span><span class="token punctuation">)</span>
        current_h <span class="token operator">=</span> self<span class="token punctuation">.</span>height<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">#定时器每执行一次，窗口长和高都加10</span>
        self<span class="token punctuation">.</span>resize<span class="token punctuation">(</span>current_w <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">,</span> current_h <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"当前窗口高度"</span><span class="token punctuation">,</span> current_h<span class="token punctuation">)</span>

        <span class="token comment">#设置当前窗口高度达到550时，停止定时器</span>
        <span class="token keyword">if</span> current_h <span class="token operator">==</span> <span class="token number">550</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"widget停止"</span><span class="token punctuation">)</span>
            <span class="token comment"># 释放对象的定时器函数</span>
            self<span class="token punctuation">.</span>killTimer<span class="token punctuation">(</span>self<span class="token punctuation">.</span>widget_id<span class="token punctuation">)</span>



<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>

    <span class="token comment"># 1. 创建一个应用程序对象</span>
    app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span>

    <span class="token comment"># 2. 控件的操作</span>
    <span class="token comment"># 2.1 创建控件</span>
    window <span class="token operator">=</span> MyWidget<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 2.2 设置控件</span>
    window<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">"QObject定时器的使用"</span><span class="token punctuation">)</span>
    window<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
    window<span class="token punctuation">.</span>startMyTimer<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>


    <span class="token comment">#创建第二个控件</span>
    label <span class="token operator">=</span> MyLabel<span class="token punctuation">(</span>window<span class="token punctuation">)</span>
    label<span class="token punctuation">.</span>setSec<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
    label<span class="token punctuation">.</span>startMyTimer<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>


    <span class="token comment"># 2.3 展示控件</span>
    window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 3. 应用程序的执行, 进入到消息循环</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span>exec_<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>运行<br> <img src="https://images2.imgbox.com/af/c6/Lno3PghS_o.png" alt="在这里插入图片描述"></p> 
<p>当到达临界值，定时器停止<br> <img src="https://images2.imgbox.com/c4/39/V3cWJ7GA_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2QTimer_259"></a>（2）利用定时器模块QTimer</h4> 
<p>需要导包 from PyQt5.QtCore import QTimer<br> QTimer 的事件可以通过 QTimer.timeout.connect() 信号槽绑定到对应的处理函数上。<br> 例如，在下面的示例中，定义了一个 onTimer() 函数，每当定时器时间到达时，就会执行这个函数。</p> 
<p>要启动 QTimer 定时器，需要调用 QTimer.setInterval() 方法，并传入时间间隔，单位为毫秒（ms）。<br> 例如，传入 1000 表示每隔 1000 毫秒（即 1 秒）会触发一次 operate()。需要注意的是，定时器不仅仅是触发一次，而是持续按照设定的时间间隔触发，直到调用 QTimer.stop() 方法停止。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sys

<span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>Qt <span class="token keyword">import</span> <span class="token operator">*</span>


<span class="token keyword">class</span> <span class="token class-name">win</span><span class="token punctuation">(</span>QWidget<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#创建一个类，为了集成控件</span>
    <span class="token comment"># 增加参数接收*args, **kwargs</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 当我们继承某个类时，需要调用父类构造方法</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">'定时器的使用'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>num<span class="token operator">=</span><span class="token number">0</span>
        self<span class="token punctuation">.</span>setup_ui<span class="token punctuation">(</span><span class="token punctuation">)</span>


    <span class="token keyword">def</span> <span class="token function">setup_ui</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token comment">#添加个标签，初始化标签</span>
        self<span class="token punctuation">.</span>lable <span class="token operator">=</span> QLabel<span class="token punctuation">(</span>self<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>lable<span class="token punctuation">.</span>move<span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>lable<span class="token punctuation">.</span>setStyleSheet<span class="token punctuation">(</span><span class="token string">"font-size: 28px;"</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>timer <span class="token operator">=</span> QTimer<span class="token punctuation">(</span>self<span class="token punctuation">)</span>  <span class="token comment"># 初始化一个定时器</span>
        <span class="token comment"># 设置计时间隔；单位毫秒</span>
        self<span class="token punctuation">.</span>timer<span class="token punctuation">.</span>setInterval<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>timer<span class="token punctuation">.</span>timeout<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>operate<span class="token punctuation">)</span>  <span class="token comment"># 每次计时到时间时发出信号</span>
        <span class="token comment">#启动定时器，也可以在这里设置时间间隔，例如：self.timer.start(1000) 表示每秒执行一次</span>
        self<span class="token punctuation">.</span>timer<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>


    <span class="token comment">#定时器要执行的动作</span>
    <span class="token keyword">def</span> <span class="token function">operate</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>num<span class="token operator">=</span>self<span class="token punctuation">.</span>num<span class="token operator">+</span><span class="token number">1</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>num<span class="token punctuation">)</span>
        <span class="token comment">#动态设置标签显示数字</span>
        self<span class="token punctuation">.</span>lable<span class="token punctuation">.</span>setText<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token comment">#设置定时器停止阈值</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>num <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"计时停止"</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>timer<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span>





<span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token operator">=</span>QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span>  <span class="token comment">#创建应用</span>
    window<span class="token operator">=</span>win<span class="token punctuation">(</span><span class="token punctuation">)</span>
    window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span>exec_<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>运行<br> <img src="https://images2.imgbox.com/66/a0/9iV7jxyJ_o.png" alt="在这里插入图片描述"></p> 
<p>当num数值增加到5时，定时器停止<br> <img src="https://images2.imgbox.com/e3/0d/1E9yorZ6_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c37cff045ef91a0e3d9236ffd210f97f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">一、安装Redis（win11环境下）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/80b29c207370b3c230bca55140e08e55/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vue3.0(十六)axios详解以及完整封装方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>