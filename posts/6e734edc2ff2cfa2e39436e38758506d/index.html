<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Qt实现图书管理系统(C&#43;&#43;) - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/6e734edc2ff2cfa2e39436e38758506d/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Qt实现图书管理系统(C&#43;&#43;)">
  <meta property="og:description" content="文章目录 数据库表的实现创建表将powerDesigner里面的表导出成xxx.sql脚本将SQL文件导入数据库创建表 图书管理系统思维导图创建工程开发阶段创建Dlg_login登录页面login页面样式主页页面布局主函数测试login设置logo打包程序子页面的样子将子页面放到StackedWidget里面按钮直接形成互斥效果 用属性选择器来改变样式设置user页面的标头和设置文本不可编辑 创建SqlMgr类进行SQL操作初始化数据库 登录功能login用户功能getUsers功能导入用户（导入文件里面的数据到数据库）删除用户（del）搜索用户 图书管理功能获取图书添加图书修改图书删除图书遇到的错误 借阅图书搜索图书 借阅记录管理功能获取借阅记录模糊查询记录归还图书出现的问题 清空借阅记录登录功能页面展示 数据库表的实现 创建表 创建三个表
将powerDesigner里面的表导出成xxx.sql脚本 此时就会生成文件在桌面了
将SQL文件导入数据库创建表 运行sql文件
设置主键自增
图书管理系统思维导图 创建工程 在qt上创建一个工程项目
把这个四个文件发到controller文件夹下，在创建一个dao文件夹
controller文件夹下面是一些界面类和逻辑类，dao文件夹下就是和数据库交互的
进入项目
加上这一句话
include($$PWD/controller/controller.pri)
正在右键项目执行qmake
添加一句这个以后生成的目标文件都在这里（当前文件目录的上一级创建一个bin 文件夹
开发阶段 创建Dlg_login登录页面 login页面样式 QLabel#le_title{font:38px &#39;方正姚体&#39;;} QLabel#name,QLabel#pwd{font: 18px &#39;楷体&#39;;} QLineEdit{border-radius:4px;min-height:25px;border:1px solid gray;} QPushButton{border-radius:4px;background-color:#409eff;color:white;font-size:18px;} QWidget#bg{background:white;} 主页页面布局 主函数测试login int main(int argc, char *argv[]) { QApplication a(argc, argv); //实现登录 Dlg_login dlg; int ret=dlg.exec(); if(1==ret){ Cell_main w; w.show(); return a.exec(); } if(0==ret){ exit(0); return 0; } return 0; } 实现Dlg_login函数">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-09-07T17:47:29+08:00">
    <meta property="article:modified_time" content="2023-09-07T17:47:29+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Qt实现图书管理系统(C&#43;&#43;)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_1" rel="nofollow">数据库表的实现</a></li><li><ul><li><ul><li><a href="#_4" rel="nofollow">创建表</a></li><li><a href="#powerDesignerxxxsql_11" rel="nofollow">将powerDesigner里面的表导出成xxx.sql脚本</a></li><li><a href="#SQL_18" rel="nofollow">将SQL文件导入数据库创建表</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_25" rel="nofollow">图书管理系统思维导图</a></li><li><a href="#_27" rel="nofollow">创建工程</a></li><li><a href="#_60" rel="nofollow">开发阶段</a></li><li><ul><li><ul><li><ul><li><a href="#Dlg_login_61" rel="nofollow">创建Dlg_login登录页面</a></li><li><a href="#login_65" rel="nofollow">login页面样式</a></li><li><a href="#_74" rel="nofollow">主页页面布局</a></li><li><a href="#login_81" rel="nofollow">主函数测试login</a></li><li><a href="#logo_120" rel="nofollow">设置logo</a></li><li><a href="#_128" rel="nofollow">打包程序</a></li><li><a href="#_132" rel="nofollow">子页面的样子</a></li><li><a href="#StackedWidget_136" rel="nofollow">将子页面放到StackedWidget里面</a></li><li><a href="#_224" rel="nofollow">按钮直接形成互斥效果</a></li></ul> 
    </li><li><a href="#_226" rel="nofollow">用属性选择器来改变样式</a></li><li><ul><li><a href="#user_229" rel="nofollow">设置user页面的标头和设置文本不可编辑</a></li></ul> 
   </li></ul> 
  </li></ul> 
  </li><li><a href="#SqlMgrSQL_239" rel="nofollow">创建SqlMgr类进行SQL操作</a></li><li><ul><li><ul><li><a href="#_301" rel="nofollow">初始化数据库</a></li></ul> 
   </li><li><a href="#login_325" rel="nofollow">登录功能login</a></li><li><a href="#_343" rel="nofollow">用户功能</a></li><li><ul><li><a href="#getUsers_344" rel="nofollow">getUsers功能</a></li><li><a href="#_406" rel="nofollow">导入用户（导入文件里面的数据到数据库）</a></li><li><a href="#del_483" rel="nofollow">删除用户（del）</a></li><li><a href="#_523" rel="nofollow">搜索用户</a></li></ul> 
   </li><li><a href="#_537" rel="nofollow">图书管理功能</a></li><li><ul><li><a href="#_538" rel="nofollow">获取图书</a></li><li><a href="#_618" rel="nofollow">添加图书</a></li><li><a href="#_722" rel="nofollow">修改图书</a></li><li><a href="#_824" rel="nofollow">删除图书</a></li><li><ul><li><a href="#_825" rel="nofollow">遇到的错误</a></li></ul> 
    </li><li><a href="#_859" rel="nofollow">借阅图书</a></li><li><a href="#_1039" rel="nofollow">搜索图书</a></li></ul> 
   </li><li><a href="#_1054" rel="nofollow">借阅记录管理功能</a></li><li><ul><li><a href="#_1055" rel="nofollow">获取借阅记录</a></li><li><a href="#_1116" rel="nofollow">模糊查询记录</a></li><li><a href="#_1129" rel="nofollow">归还图书</a></li><li><ul><li><a href="#_1245" rel="nofollow">出现的问题</a></li></ul> 
    </li><li><a href="#_1398" rel="nofollow">清空借阅记录</a></li><li><a href="#_1437" rel="nofollow">登录功能</a></li><li><a href="#_1481" rel="nofollow">页面展示</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>数据库表的实现</h2> 
<p><img src="https://images2.imgbox.com/28/af/sIhJtS6J_o.png" alt="使用powerdesigner工具"></p> 
<h4><a id="_4"></a>创建表</h4> 
<p><img src="https://images2.imgbox.com/42/bc/wzLtCQnK_o.png" alt="在这里插入图片描述"></p> 
<p>创建三个表<br> <img src="https://images2.imgbox.com/6c/56/yMlSrnSn_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/cb/21/7oC2Nb5C_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/5e/75/jWULW0Dm_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="powerDesignerxxxsql_11"></a>将powerDesigner里面的表导出成xxx.sql脚本</h4> 
<p><img src="https://images2.imgbox.com/bf/be/xRDycus9_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b3/43/or8lFXtb_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/8e/b2/1HEn9iH7_o.png" alt="在这里插入图片描述"><br> <strong>此时就会生成文件在桌面了</strong><br> <img src="https://images2.imgbox.com/ae/9e/Jm1qCxO1_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="SQL_18"></a>将SQL文件导入数据库创建表</h4> 
<p><img src="https://images2.imgbox.com/cf/f5/3XQlsUO9_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/27/cb/ZK9dOxTs_o.png" alt="在这里插入图片描述"><br> <strong>运行sql文件</strong><br> <img src="https://images2.imgbox.com/03/b4/LEgIVd7y_o.png" alt="在这里插入图片描述"><br> <strong>设置主键自增</strong></p> 
<h2><a id="_25"></a>图书管理系统思维导图</h2> 
<p><img src="https://images2.imgbox.com/7b/e8/PbTHOijY_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_27"></a>创建工程</h2> 
<blockquote> 
 <p><strong>在qt上创建一个工程项目</strong></p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/8f/5c/xTVTegth_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>把这个四个文件发到controller文件夹下，在创建一个dao文件夹</strong></p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/d2/5c/ofvYRn72_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>controller文件夹下面是一些界面类和逻辑类，dao文件夹下就是和数据库交互的</strong></p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/fb/dd/K7BKB4We_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>进入项目</strong></p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/83/95/DIaBMCJ0_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/59/1e/A6UoyZrW_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>加上这一句话</p> 
 <p>include($$PWD/controller/controller.pri)<br> 正在右键项目执行qmake<br> <img src="https://images2.imgbox.com/0e/0a/guBbeDgD_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/9f/cb/CqoMyCgD_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/7b/f8/lAZi1TYX_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/8a/50/oJOorhy8_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/9a/22/vAfSAms8_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>添加一句这个以后生成的目标文件都在这里（当前文件目录的上一级创建一个bin 文件夹</strong></p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/3b/1e/3Z002poG_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_60"></a>开发阶段</h2> 
<h5><a id="Dlg_login_61"></a>创建Dlg_login登录页面</h5> 
<p><img src="https://images2.imgbox.com/f9/c4/HnAH6lBL_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/c0/63/fpyE8Tyz_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="login_65"></a>login页面样式</h5> 
<pre><code class="prism language-cpp">QLabel#le_title<span class="token punctuation">{<!-- --></span>font<span class="token operator">:</span><span class="token number">38</span>px <span class="token char">'方正姚体'</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
QLabel#name<span class="token punctuation">,</span>QLabel#pwd<span class="token punctuation">{<!-- --></span>font<span class="token operator">:</span> <span class="token number">18</span>px <span class="token char">'楷体'</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
QLineEdit<span class="token punctuation">{<!-- --></span>border<span class="token operator">-</span>radius<span class="token operator">:</span><span class="token number">4</span>px<span class="token punctuation">;</span>min<span class="token operator">-</span>height<span class="token operator">:</span><span class="token number">25</span>px<span class="token punctuation">;</span>border<span class="token operator">:</span><span class="token number">1</span>px solid gray<span class="token punctuation">;</span><span class="token punctuation">}</span>
QPushButton<span class="token punctuation">{<!-- --></span>border<span class="token operator">-</span>radius<span class="token operator">:</span><span class="token number">4</span>px<span class="token punctuation">;</span>background<span class="token operator">-</span>color<span class="token operator">:</span>#<span class="token number">409</span>eff<span class="token punctuation">;</span>color<span class="token operator">:</span>white<span class="token punctuation">;</span>font<span class="token operator">-</span>size<span class="token operator">:</span><span class="token number">18</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span>
QWidget#bg<span class="token punctuation">{<!-- --></span>background<span class="token operator">:</span>white<span class="token punctuation">;</span><span class="token punctuation">}</span>
</code></pre> 
<h5><a id="_74"></a>主页页面布局</h5> 
<p><img src="https://images2.imgbox.com/84/16/8YrFq3E2_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/76/59/UVwcXqdu_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/ed/38/rHCUegfJ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/95/5e/D5TLPW8t_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c6/f7/jGeEdspp_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/af/f4/m8Hwk2jo_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="login_81"></a>主函数测试login</h5> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QApplication <span class="token function">a</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//实现登录</span>
    Dlg_login dlg<span class="token punctuation">;</span>
    <span class="token keyword">int</span> ret<span class="token operator">=</span>dlg<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">==</span>ret<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        Cell_main w<span class="token punctuation">;</span>
        w<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> a<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">==</span>ret<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> 
<p><strong>实现Dlg_login函数</strong></p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token class-name">Dlg_login</span><span class="token double-colon punctuation">::</span><span class="token function">on_btn_login_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">setResult</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token class-name">Dlg_login</span><span class="token double-colon punctuation">::</span><span class="token function">on_btn_exit_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">setResult</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<h5><a id="logo_120"></a>设置logo</h5> 
<p><img src="https://images2.imgbox.com/e3/16/wD9qLOf0_o.png" alt="在这里插入图片描述"><br> <strong>在资源文件中添加一个app.rc文件，在打开这个app.rc文件 添加一句话:</strong></p> 
<blockquote> 
 <p><strong>IDI_ICON1 ICON DISCARDABLE “tubiao.ico”</strong><br> 再把这个ico图标放到这个资源文件里</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/35/22/YQngKdXy_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_128"></a>打包程序</h5> 
<p><img src="https://images2.imgbox.com/74/46/DaNFpPyR_o.png" alt="在这里插入图片描述"><br> 如果还 运行不了，可能是有些库没有权限没靠过来，手动考<br> <img src="https://images2.imgbox.com/a8/25/OJRosuKr_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_132"></a>子页面的样子</h5> 
<p><img src="https://images2.imgbox.com/42/62/7DvGYVzc_o.png" alt="用户管理界面"><br> <img src="https://images2.imgbox.com/41/37/gDXWQ3wH_o.png" alt="图书管理页面"><br> <img src="https://images2.imgbox.com/61/b2/PzxPsvvc_o.png" alt="借阅管理"></p> 
<h5><a id="StackedWidget_136"></a>将子页面放到StackedWidget里面</h5> 
<p><img src="https://images2.imgbox.com/e5/fd/tGxwC5fq_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"cell_main.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ui_cell_main.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"dlg_login.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"QPushButton"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"QDebug"</span></span>

<span class="token class-name">Cell_main</span><span class="token double-colon punctuation">::</span><span class="token function">Cell_main</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent<span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token function">QMainWindow</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span>
    <span class="token punctuation">,</span> <span class="token function">ui</span><span class="token punctuation">(</span><span class="token keyword">new</span> Ui<span class="token double-colon punctuation">::</span>Cell_main<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">m_bookPage</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">m_recordPage</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">m_userPage</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    ui<span class="token operator">-&gt;</span><span class="token function">setupUi</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//初始化栈窗口</span>
    <span class="token function">initPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token class-name">Cell_main</span><span class="token double-colon punctuation">::</span><span class="token function">initPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    m_bookPage<span class="token operator">=</span><span class="token keyword">new</span> <span class="token function">cell_BookMgr</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m_userPage<span class="token operator">=</span><span class="token keyword">new</span> <span class="token function">cell_UserMgr</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m_recordPage<span class="token operator">=</span><span class="token keyword">new</span> <span class="token function">cell_Record</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//把页面放到栈窗口</span>
    ui<span class="token operator">-&gt;</span>stackedWidget<span class="token operator">-&gt;</span><span class="token function">addWidget</span><span class="token punctuation">(</span>m_userPage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>stackedWidget<span class="token operator">-&gt;</span><span class="token function">addWidget</span><span class="token punctuation">(</span>m_bookPage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>stackedWidget<span class="token operator">-&gt;</span><span class="token function">addWidget</span><span class="token punctuation">(</span>m_recordPage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//设置首页是用户管理</span>
    ui<span class="token operator">-&gt;</span>stackedWidget<span class="token operator">-&gt;</span><span class="token function">setCurrentIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"helloworld"</span><span class="token punctuation">;</span>

    <span class="token keyword">auto</span> l<span class="token operator">=</span>ui<span class="token operator">-&gt;</span>tool<span class="token operator">-&gt;</span><span class="token function">children</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获得子控件</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> it<span class="token operator">:</span>l<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
       <span class="token comment">//为每个页面进行绑定槽函数</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>it<span class="token operator">-&gt;</span><span class="token function">objectName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"btn"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">connect</span><span class="token punctuation">(</span><span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>QPushButton<span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>QPushButton<span class="token double-colon punctuation">::</span>clicked<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>Cell_main<span class="token double-colon punctuation">::</span>DealMenu<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//主页初始化一下</span>
   <span class="token comment">// m_userPage-&gt;initPage();</span>

<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Cell_main</span><span class="token double-colon punctuation">::</span><span class="token function">DealMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">auto</span> str<span class="token operator">=</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">objectName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//切换页面</span>
    <span class="token keyword">do</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">"btn_user"</span><span class="token operator">==</span>str<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//m_userPage-&gt;initPage();</span>
            ui<span class="token operator">-&gt;</span>stackedWidget<span class="token operator">-&gt;</span><span class="token function">setCurrentIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">"btn_book"</span><span class="token operator">==</span>str<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//m_bookPage-&gt;initPage();</span>
            ui<span class="token operator">-&gt;</span>stackedWidget<span class="token operator">-&gt;</span><span class="token function">setCurrentIndex</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">"btn_his"</span><span class="token operator">==</span>str<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//m_recordPage-&gt;initPage();</span>
            ui<span class="token operator">-&gt;</span>stackedWidget<span class="token operator">-&gt;</span><span class="token function">setCurrentIndex</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>



<span class="token class-name">Cell_main</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">Cell_main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">delete</span> ui<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


</code></pre> 
<p><strong>在添加完之后在进行切换操作，页面之间切换</strong><br> <img src="https://images2.imgbox.com/e3/03/svcL4XnD_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_224"></a>按钮直接形成互斥效果</h5> 
<p><img src="https://images2.imgbox.com/9a/15/i6IjYNLb_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_226"></a>用属性选择器来改变样式</h4> 
<p><img src="https://images2.imgbox.com/cc/4b/KzkXM9yB_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c9/97/6GZFt4wS_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="user_229"></a>设置user页面的标头和设置文本不可编辑</h5> 
<pre><code class="prism language-cpp">  ui<span class="token operator">-&gt;</span>tableView<span class="token operator">-&gt;</span><span class="token function">setSelectionBehavior</span><span class="token punctuation">(</span>QAbstractItemView<span class="token double-colon punctuation">::</span>SelectRows<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//一次选中一行</span>
    ui<span class="token operator">-&gt;</span>tableView<span class="token operator">-&gt;</span><span class="token function">setModel</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>m_model<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>tableView<span class="token operator">-&gt;</span><span class="token function">setEditTriggers</span><span class="token punctuation">(</span>QAbstractItemView<span class="token double-colon punctuation">::</span>NoEditTriggers<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设置不可编辑</span>
    m_model<span class="token punctuation">.</span><span class="token function">setHorizontalHeaderLabels</span><span class="token punctuation">(</span>QStringList<span class="token punctuation">{<!-- --></span><span class="token string">"用户id"</span><span class="token punctuation">,</span><span class="token string">"年级"</span><span class="token punctuation">,</span><span class="token string">"部门"</span><span class="token punctuation">,</span><span class="token string">"权限"</span><span class="token punctuation">,</span><span class="token string">"人物类型"</span><span class="token punctuation">,</span><span class="token string">"密码"</span><span class="token punctuation">,</span><span class="token string">"用户名"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/f9/a0/cVExWL4h_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="SqlMgrSQL_239"></a>创建SqlMgr类进行SQL操作</h2> 
<p><strong>涉及到的函数函数和变量</strong></p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">SqlMgr</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">SqlMgr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//设置单例模式</span>
    <span class="token keyword">static</span> SqlMgr<span class="token operator">*</span>  instance<span class="token punctuation">;</span>
    <span class="token keyword">static</span> SqlMgr<span class="token operator">*</span>  <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token operator">==</span>instance<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            instance<span class="token operator">=</span><span class="token keyword">new</span> <span class="token function">SqlMgr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//初始化数据库</span>


    <span class="token comment">//登录</span>
    <span class="token keyword">bool</span> <span class="token function">login</span><span class="token punctuation">(</span>QString username<span class="token punctuation">,</span>QString password<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//获取所有用户</span>
    QVector<span class="token operator">&lt;</span>QStringList<span class="token operator">&gt;</span> <span class="token function">getUsers</span><span class="token punctuation">(</span>QString StrCondition<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//添加用户</span>
    <span class="token keyword">void</span> <span class="token function">addUsers</span><span class="token punctuation">(</span>QVector<span class="token operator">&lt;</span>QStringList<span class="token operator">&gt;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//删除用户</span>
    <span class="token keyword">void</span> <span class="token function">delUser</span><span class="token punctuation">(</span>QString userId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//获取所有图书</span>
    QVector<span class="token operator">&lt;</span>QStringList<span class="token operator">&gt;</span> <span class="token function">getBooks</span><span class="token punctuation">(</span>QString StrCondition<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//添加图书</span>
    <span class="token keyword">void</span> <span class="token function">addBooks</span><span class="token punctuation">(</span>QVector<span class="token operator">&lt;</span>QStringList<span class="token operator">&gt;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//修改图书</span>
    <span class="token keyword">void</span> <span class="token function">updateBook</span><span class="token punctuation">(</span>QStringList<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//删除图书</span>
    QString <span class="token function">delBook</span><span class="token punctuation">(</span>QString bookId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//归还图书</span>
    QString <span class="token function">returnBook</span><span class="token punctuation">(</span>QString userId<span class="token punctuation">,</span>QString bookId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//图书借阅</span>
    QString <span class="token function">borrowBook</span><span class="token punctuation">(</span>QString userId<span class="token punctuation">,</span>QString bookId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//获取借阅记录</span>
    QVector <span class="token operator">&lt;</span>QStringList<span class="token operator">&gt;</span> <span class="token function">getRecord</span><span class="token punctuation">(</span>QString strCondition<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//清除借阅记录</span>
    <span class="token keyword">void</span> <span class="token function">clearRecord</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    QSqlDatabase m_db<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_301"></a>初始化数据库</h4> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    m_db<span class="token operator">=</span><span class="token class-name">QSqlDatabase</span><span class="token double-colon punctuation">::</span><span class="token function">addDatabase</span><span class="token punctuation">(</span><span class="token string">"QSQLITE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m_db<span class="token punctuation">.</span><span class="token function">setDatabaseName</span><span class="token punctuation">(</span><span class="token class-name">QCoreApplication</span><span class="token double-colon punctuation">::</span><span class="token function">applicationDirPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"/db/WpcBook.db"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>m_db<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/a4/96/0rlkUIwK_o.png" alt="在这里插入图片描述"><br> <strong>失败啦！！！</strong><br> <img src="https://images2.imgbox.com/94/2b/sWqluXcj_o.png" alt="在这里插入图片描述"><br> <strong>成功啦，失败原因是之前把一些文件打包到bin目录下了，所以就不走系统的了缺少一些文件就会报错，把bin目录下的文件删除就走系统的了</strong><br> <img src="https://images2.imgbox.com/a1/32/LnVbX5tT_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-cpp">m_db<span class="token punctuation">.</span><span class="token function">setDatabaseName</span><span class="token punctuation">(</span><span class="token class-name">QCoreApplication</span><span class="token double-colon punctuation">::</span><span class="token function">applicationDirPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>app目录是这个路径</p> 
<blockquote> 
 <p><img src="https://images2.imgbox.com/f8/15/KrBfRdSO_o.png" alt="这里是引用"></p> 
</blockquote> 
<h3><a id="login_325"></a>登录功能login</h3> 
<blockquote> 
 <p><strong>先不实现键盘输入登录功能，先测试一下，查询数据库里面是否有这个用户，有就返回true</strong></p> 
</blockquote> 
<pre><code class="prism language-cpp"><span class="token comment">//返回      true登录成功</span>
<span class="token keyword">bool</span> <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">login</span><span class="token punctuation">(</span>QString username<span class="token punctuation">,</span> QString password<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QSqlQuery <span class="token function">q</span><span class="token punctuation">(</span>m_db<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"select *from user where username='%1' and password='%2'"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">bool</span> ret<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//执行查询语句 执行成功返回true</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>q<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_343"></a>用户功能</h3> 
<h4><a id="getUsers_344"></a>getUsers功能</h4> 
<p><strong>(数据库层)SqlMgr代码:</strong></p> 
<pre><code class="prism language-cpp"><span class="token comment">//获取所有用户</span>
QVector<span class="token operator">&lt;</span>QStringList<span class="token operator">&gt;</span> <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getUsers</span><span class="token punctuation">(</span>QString StrCondition<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>

    QSqlQuery <span class="token function">q</span><span class="token punctuation">(</span>m_db<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//StrCondition里可以写模糊查询的东西</span>
    QString sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"select *from user %1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>StrCondition<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//获取到的数据可能是多行</span>
    QVector<span class="token operator">&lt;</span>QStringList<span class="token operator">&gt;</span> vec<span class="token punctuation">;</span>
    <span class="token keyword">bool</span> ret<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>q<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">//读取返回来的数据</span>
        <span class="token comment">//获取这个数据是几行</span>
        <span class="token keyword">int</span> col <span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">record</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        QStringList temp<span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//向下读</span>
            temp<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>col<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token comment">//将这一行数据转换为QString放到</span>
                temp<span class="token operator">&lt;&lt;</span>q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            vec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"sqlMgr getuser被执行"</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> vec<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> 
<p><strong>(控制层代码）cell_UserMgr:</strong></p> 
<pre><code class="prism language-cpp"><span class="token comment">//初始化用户管理页面</span>
<span class="token keyword">void</span> cell_UserMgr<span class="token double-colon punctuation">::</span><span class="token function">initPage</span><span class="token punctuation">(</span>QString strCondition<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"initUSer被执行"</span><span class="token punctuation">;</span>
    <span class="token comment">//调用数据库进行查询</span>
    QVector<span class="token operator">&lt;</span>QStringList<span class="token operator">&gt;</span>vec<span class="token operator">=</span> <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getUsers</span><span class="token punctuation">(</span>strCondition<span class="token punctuation">)</span><span class="token punctuation">;</span>
    m_model<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//在设置一次头</span>
    m_model<span class="token punctuation">.</span><span class="token function">setHorizontalHeaderLabels</span><span class="token punctuation">(</span>QStringList<span class="token punctuation">{<!-- --></span><span class="token string">"用户id"</span><span class="token punctuation">,</span><span class="token string">"年级"</span><span class="token punctuation">,</span><span class="token string">"部门"</span><span class="token punctuation">,</span><span class="token string">"权限"</span><span class="token punctuation">,</span><span class="token string">"人物类型"</span><span class="token punctuation">,</span><span class="token string">"密码"</span><span class="token punctuation">,</span><span class="token string">"用户名"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     QList <span class="token operator">&lt;</span>QStandardItem<span class="token operator">*</span><span class="token operator">&gt;</span>items<span class="token punctuation">;</span><span class="token comment">//添加到页面</span>
    <span class="token comment">//获取每一个QStringList</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>QStringList tempList<span class="token operator">:</span>vec<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
         items<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//清理</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>tempList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
             <span class="token comment">//追加每一个元素</span>
             items<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QStandardItem</span><span class="token punctuation">(</span>tempList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//追加到一行上面</span>
        m_model<span class="token punctuation">.</span><span class="token function">appendRow</span><span class="token punctuation">(</span>items<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e2/76/Iu6WRy0c_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_406"></a>导入用户（导入文件里面的数据到数据库）</h4> 
<p><strong>使用： QFileDialog::getOpenFileName(nullptr,“输入文件路径”);会出现弹窗</strong></p> 
<p>**dao代码(SqlMgr) **</p> 
<pre><code class="prism language-cpp"><span class="token comment">//导入用户（.txt类型 是GBK编码）</span>
<span class="token keyword">void</span> <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">addUsers</span><span class="token punctuation">(</span>QVector<span class="token operator">&lt;</span>QStringList<span class="token operator">&gt;</span> vec<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    QSqlQuery <span class="token function">q</span><span class="token punctuation">(</span>m_db<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//StrCondition里可以写模糊查询的东西</span>

    <span class="token comment">//一个个拿出来</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> tempList<span class="token operator">:</span>vec<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            QString sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"insert into user VALUES(NULL,'%1','%2','%3','%4','%5','%6')"</span><span class="token punctuation">)</span>
                              <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>tempList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                              <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>tempList<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                              <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>tempList<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                              <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>tempList<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                              <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>tempList<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                              <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>tempList<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">bool</span> ret<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>q<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre> 
<p><strong>控制层代码:</strong></p> 
<pre><code class="prism language-cpp"><span class="token comment">//导入用户</span>
<span class="token keyword">void</span> cell_UserMgr<span class="token double-colon punctuation">::</span><span class="token function">on_btn_UserAdd_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//会弹出页面窗口</span>
    <span class="token keyword">auto</span> strPath<span class="token operator">=</span><span class="token class-name">QFileDialog</span><span class="token double-colon punctuation">::</span><span class="token function">getOpenFileName</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token string">"输入文件路径"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    QVector<span class="token operator">&lt;</span>QStringList<span class="token operator">&gt;</span>vec<span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>strPath<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        QFile <span class="token function">f</span><span class="token punctuation">(</span>strPath<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//读这个文件</span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"路径: "</span><span class="token operator">&lt;&lt;</span>strPath<span class="token punctuation">;</span>
        f<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>QFile<span class="token double-colon punctuation">::</span>ReadOnly<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>f<span class="token punctuation">.</span><span class="token function">atEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        QByteArray bytes<span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//一次读一行</span>
        <span class="token comment">//转换为QString 里面的数据类型是 ： xxx,xxx,xxx,xxx用,分割</span>
        QString <span class="token function">str</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"str = "</span><span class="token operator">&lt;&lt;</span>str<span class="token punctuation">;</span>
        <span class="token comment">//分割</span>
        QStringList  strList<span class="token operator">=</span>str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//判断</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>strList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
             <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token string">"信息"</span><span class="token punctuation">,</span><span class="token string">"导入失败"</span><span class="token punctuation">,</span>QMessageBox<span class="token double-colon punctuation">::</span>Ok<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span>

             <span class="token comment">//把一行数据的最后的元素的最后两个字节去掉\n\r去掉</span>
       strList<span class="token punctuation">[</span>strList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>strList<span class="token punctuation">[</span>strList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">chopped</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//存</span>
         vec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>strList<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>
        <span class="token comment">//调用数据库</span>
        <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">addUsers</span><span class="token punctuation">(</span>vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
        f<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//刷新页面</span>
        <span class="token comment">//ui-&gt;le_search-&gt;clear();</span>
        <span class="token function">initPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8d/61/EHo93WFP_o.png" alt="在这里插入图片描述"><br> 先写数据层库层</p> 
<blockquote> 
 <p>效果：<br> <img src="https://images2.imgbox.com/ce/84/fBaRPiH1_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<h4><a id="del_483"></a>删除用户（del）</h4> 
<p><strong>数据库：</strong></p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">delUser</span><span class="token punctuation">(</span>QString userId<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    QSqlQuery <span class="token function">q</span><span class="token punctuation">(</span>m_db<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"delete from user where id= %1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">bool</span> ret<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>ret<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>q<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token punctuation">}</span>
</code></pre> 
<p><strong>控制层:</strong></p> 
<pre><code class="prism language-cpp"><span class="token comment">//删除用户</span>
<span class="token keyword">void</span> cell_UserMgr<span class="token double-colon punctuation">::</span><span class="token function">on_btn_UserDel_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//获取鼠标点击到的哪一行的</span>
    <span class="token comment">//第一列的数据</span>
    <span class="token keyword">int</span> r<span class="token operator">=</span>ui<span class="token operator">-&gt;</span>tableView<span class="token operator">-&gt;</span><span class="token function">currentIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取当前行号</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>r<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token string">"提示"</span><span class="token punctuation">,</span><span class="token string">"请选中一行..."</span><span class="token punctuation">,</span>QMessageBox<span class="token double-colon punctuation">::</span>Ok<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">//获取r行 的0列</span>
    <span class="token keyword">auto</span> id<span class="token operator">=</span>m_model<span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">delUser</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//刷新页面</span>
    <span class="token function">initPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h4><a id="_523"></a>搜索用户</h4> 
<p><strong>控制层:(直接调用initPage函数）</strong></p> 
<pre><code class="prism language-cpp">    <span class="token keyword">void</span> cell_UserMgr<span class="token double-colon punctuation">::</span><span class="token function">on_le_search_textChanged</span><span class="token punctuation">(</span><span class="token keyword">const</span> QString <span class="token operator">&amp;</span>arg1<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        QString sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"where username like '%%1%' or department like '%%1%'"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>arg1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
        <span class="token function">initPage</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/52/36/uyRI8JIA_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_537"></a>图书管理功能</h3> 
<h4><a id="_538"></a>获取图书</h4> 
<p><strong>数据库：</strong></p> 
<pre><code class="prism language-cpp"><span class="token comment">//获取图书</span>
QVector<span class="token operator">&lt;</span>QStringList<span class="token operator">&gt;</span> <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getBooks</span><span class="token punctuation">(</span>QString StrCondition<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QSqlQuery <span class="token function">q</span><span class="token punctuation">(</span>m_db<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"select *from book %1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>StrCondition<span class="token punctuation">)</span><span class="token punctuation">;</span>
     QVector<span class="token operator">&lt;</span>QStringList<span class="token operator">&gt;</span> vec<span class="token punctuation">;</span>
    <span class="token comment">//执行</span>
    <span class="token keyword">bool</span> ret<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>ret<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>q<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>

        QStringList strList<span class="token punctuation">;</span>

        <span class="token comment">//获取这些数据有几列</span>
        <span class="token keyword">int</span> col<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">record</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//从q里面获取数据</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            strList<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>col<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token comment">//把这一行数据放进去</span>
                strList<span class="token operator">&lt;&lt;</span>q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            vec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>strList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> vec<span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token comment">//添加图书</span>
<span class="token keyword">void</span> <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">addBooks</span><span class="token punctuation">(</span>QVector<span class="token operator">&lt;</span>QStringList<span class="token operator">&gt;</span> vec <span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">//添加图书是一次添加一本</span>

    QSqlQuery <span class="token function">q</span><span class="token punctuation">(</span>m_db<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">auto</span> data<span class="token operator">=</span> vec<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    QString sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"insert into Wbook values(null,'%1','%2','%3','%4','%5',%6,'');"</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">bool</span> ret<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//执行查询语句</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>q<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p><strong>控制层:</strong></p> 
<pre><code class="prism language-cpp"><span class="token comment">//初始化图书管理页面</span>
<span class="token keyword">void</span> cell_BookMgr<span class="token double-colon punctuation">::</span><span class="token function">initPage</span><span class="token punctuation">(</span>QString condition<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">//调用dao的getbooks</span>
    <span class="token keyword">auto</span> vec<span class="token operator">=</span><span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getBooks</span><span class="token punctuation">(</span>condition<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//拿数据显示到页面</span>
    m_model<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//在设置一次头</span>
    m_model<span class="token punctuation">.</span><span class="token function">setHorizontalHeaderLabels</span><span class="token punctuation">(</span>QStringList<span class="token punctuation">{<!-- --></span><span class="token string">"图书id"</span><span class="token punctuation">,</span><span class="token string">"图书名称"</span><span class="token punctuation">,</span><span class="token string">"价格"</span><span class="token punctuation">,</span><span class="token string">"类型1"</span><span class="token punctuation">,</span><span class="token string">"类型2"</span><span class="token punctuation">,</span><span class="token string">"类型3"</span><span class="token punctuation">,</span><span class="token string">"数量"</span><span class="token punctuation">,</span><span class="token string">"图片"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span>QStringList tlist<span class="token operator">:</span>vec<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//拿出一行QStringList</span>
        QList<span class="token operator">&lt;</span>QStandardItem<span class="token operator">*</span><span class="token operator">&gt;</span> items<span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>tlist<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//追加到items</span>
            items<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QStandardItem</span><span class="token punctuation">(</span>tlist<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"图书被调用"</span><span class="token punctuation">;</span>
        <span class="token comment">//加到model</span>
        m_model<span class="token punctuation">.</span><span class="token function">appendRow</span><span class="token punctuation">(</span>items<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="_618"></a>添加图书</h4> 
<blockquote> 
 <p><strong>添加图书要弹出一个页面Dlg_addOrUp</strong></p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/1d/f4/7AjCE5Hx_o.png" alt="在这里插入图片描述"><br> <strong>数据库层：</strong></p> 
<pre><code class="prism language-cpp"><span class="token comment">//添加图书</span>
<span class="token keyword">void</span> <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">addBooks</span><span class="token punctuation">(</span>QStringList data <span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">//添加图书是一次添加一本</span>

    QSqlQuery <span class="token function">q</span><span class="token punctuation">(</span>m_db<span class="token punctuation">)</span><span class="token punctuation">;</span>

    QString sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"insert into book values(null,'%1','%2','%3','%4','%5',%6,'');"</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">bool</span> ret<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//执行查询语句</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>q<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>控制层：</strong></p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> cell_BookMgr<span class="token double-colon punctuation">::</span><span class="token function">on_btn_bookAdd_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//调用子窗口</span>
    Dlg_addOrUp dlg<span class="token punctuation">;</span>
    dlg<span class="token punctuation">.</span><span class="token function">setFlag</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//添加就设置为-1</span>
    dlg<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



<span class="token punctuation">}</span>
</code></pre> 
<p><strong>Dlg_addOrUp类</strong></p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"dlg_addorup.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ui_dlg_addorup.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"dao/sqlmgr.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"QDebug"</span></span>
<span class="token class-name">Dlg_addOrUp</span><span class="token double-colon punctuation">::</span><span class="token function">Dlg_addOrUp</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent<span class="token punctuation">)</span> <span class="token operator">:</span>
    <span class="token function">QDialog</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">ui</span><span class="token punctuation">(</span><span class="token keyword">new</span> Ui<span class="token double-colon punctuation">::</span>Dlg_addOrUp<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    ui<span class="token operator">-&gt;</span><span class="token function">setupUi</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token class-name">Dlg_addOrUp</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">Dlg_addOrUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">delete</span> ui<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Dlg_addOrUp</span><span class="token double-colon punctuation">::</span><span class="token function">addOrUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QStringList strList<span class="token punctuation">;</span>
    <span class="token comment">//添加</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>m_flag<span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      <span class="token comment">//获取页面输入</span>
        strList<span class="token operator">&lt;&lt;</span>ui<span class="token operator">-&gt;</span>le_name<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        strList<span class="token operator">&lt;&lt;</span>ui<span class="token operator">-&gt;</span>le_press<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        strList<span class="token operator">&lt;&lt;</span>ui<span class="token operator">-&gt;</span>le_count<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        strList<span class="token operator">&lt;&lt;</span>ui<span class="token operator">-&gt;</span>cb1<span class="token operator">-&gt;</span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        strList<span class="token operator">&lt;&lt;</span>ui<span class="token operator">-&gt;</span>cb2<span class="token operator">-&gt;</span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        strList<span class="token operator">&lt;&lt;</span>ui<span class="token operator">-&gt;</span>cb3<span class="token operator">-&gt;</span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"==== "</span><span class="token operator">&lt;&lt;</span>strList<span class="token punctuation">;</span>
        <span class="token comment">//调用数据添加函数</span>
        <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">addBooks</span><span class="token punctuation">(</span>strList<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Dlg_addOrUp</span><span class="token double-colon punctuation">::</span><span class="token function">setFlag</span><span class="token punctuation">(</span><span class="token keyword">int</span> flag<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    m_flag<span class="token operator">=</span>flag<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Dlg_addOrUp</span><span class="token double-colon punctuation">::</span><span class="token function">on_btn_ok_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">addOrUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//隐藏页面</span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token class-name">Dlg_addOrUp</span><span class="token double-colon punctuation">::</span><span class="token function">on_btn_cancel_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


</code></pre> 
<blockquote> 
 <p><strong>这个Dlg_addOrUp既是添加页面又是修改页面里面m_flag=-1时是添加，非-1时是修改</strong></p> 
</blockquote> 
<h4><a id="_722"></a>修改图书</h4> 
<p><strong>dao层:</strong></p> 
<pre><code class="prism language-cpp"><span class="token comment">//修改图书</span>
<span class="token keyword">void</span> <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">updateBook</span><span class="token punctuation">(</span>QStringList data<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    QSqlQuery <span class="token function">q</span><span class="token punctuation">(</span>m_db<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"update book set"</span>
                          <span class="token string">" name='%1',press='%2',type1='%3',type2='%4',"</span>
                          <span class="token string">"type3='%5',cnt='%6' where bookid='%7';"</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">bool</span> ret<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//执行查询语句</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>q<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p><strong>控制层：</strong></p> 
<pre><code class="prism language-cpp">
<span class="token keyword">void</span> cell_BookMgr<span class="token double-colon punctuation">::</span><span class="token function">on_btn_bookUpdate_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//判断有没有选中一行将要修改的数据</span>
    <span class="token comment">//要知道鼠标点中哪一行</span>
    <span class="token keyword">int</span> r<span class="token operator">=</span>ui<span class="token operator">-&gt;</span>tableView<span class="token operator">-&gt;</span><span class="token function">currentIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>r<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token string">"信息"</span><span class="token punctuation">,</span><span class="token string">"请选中要更新的一行"</span><span class="token punctuation">,</span>QMessageBox<span class="token double-colon punctuation">::</span>Ok<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
    <span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"update被调用..."</span><span class="token punctuation">;</span>
        <span class="token comment">//获得选中的一行的id拿出来</span>
        <span class="token keyword">auto</span> it<span class="token operator">=</span> m_model<span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Dlg_addOrUp dlg<span class="token punctuation">;</span>
        dlg<span class="token punctuation">.</span><span class="token function">setFlag</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//修改</span>
        dlg<span class="token punctuation">.</span><span class="token function">showDetial</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//显示要修改的信息</span>
        dlg<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">initPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>显示到页面上信息(Dlg_addOrUp):</strong></p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token class-name">Dlg_addOrUp</span><span class="token double-colon punctuation">::</span><span class="token function">showDetial</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QString sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"where bookid= %1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//先查询信息显示到页面上</span>
    QVector<span class="token operator">&lt;</span>QStringList<span class="token operator">&gt;</span> vec <span class="token operator">=</span><span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getBooks</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QStringList data<span class="token operator">=</span>vec<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//查出来的是一条数据</span>
    ui<span class="token operator">-&gt;</span>le_name<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>le_press<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>cb1<span class="token operator">-&gt;</span><span class="token function">setCurrentText</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>cb2<span class="token operator">-&gt;</span><span class="token function">setCurrentText</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>cb3<span class="token operator">-&gt;</span><span class="token function">setCurrentText</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>le_count<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>更新：</strong></p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token class-name">Dlg_addOrUp</span><span class="token double-colon punctuation">::</span><span class="token function">addOrUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QStringList strList<span class="token punctuation">;</span>
    <span class="token comment">//添加</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>m_flag<span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      <span class="token comment">//获取页面输入</span>
        strList<span class="token operator">&lt;&lt;</span>ui<span class="token operator">-&gt;</span>le_name<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        strList<span class="token operator">&lt;&lt;</span>ui<span class="token operator">-&gt;</span>le_press<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        strList<span class="token operator">&lt;&lt;</span>ui<span class="token operator">-&gt;</span>le_count<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        strList<span class="token operator">&lt;&lt;</span>ui<span class="token operator">-&gt;</span>cb1<span class="token operator">-&gt;</span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        strList<span class="token operator">&lt;&lt;</span>ui<span class="token operator">-&gt;</span>cb2<span class="token operator">-&gt;</span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        strList<span class="token operator">&lt;&lt;</span>ui<span class="token operator">-&gt;</span>cb3<span class="token operator">-&gt;</span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"==== "</span><span class="token operator">&lt;&lt;</span>strList<span class="token punctuation">;</span>
        <span class="token comment">//调用数据添加函数</span>
        <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">addBooks</span><span class="token punctuation">(</span>strList<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span><span class="token comment">//修改</span>
        strList<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        strList<span class="token operator">&lt;&lt;</span><span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>m_flag<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//把bookid拿进去</span>
        <span class="token comment">//获取页面输入</span>
        strList<span class="token operator">&lt;&lt;</span>ui<span class="token operator">-&gt;</span>le_name<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        strList<span class="token operator">&lt;&lt;</span>ui<span class="token operator">-&gt;</span>le_press<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        strList<span class="token operator">&lt;&lt;</span>ui<span class="token operator">-&gt;</span>le_count<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        strList<span class="token operator">&lt;&lt;</span>ui<span class="token operator">-&gt;</span>cb1<span class="token operator">-&gt;</span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        strList<span class="token operator">&lt;&lt;</span>ui<span class="token operator">-&gt;</span>cb2<span class="token operator">-&gt;</span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        strList<span class="token operator">&lt;&lt;</span>ui<span class="token operator">-&gt;</span>cb3<span class="token operator">-&gt;</span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">updateBook</span><span class="token punctuation">(</span>strList<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/30/a5/pfjIJXHe_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/49/fe/5U095JYA_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_824"></a>删除图书</h4> 
<h5><a id="_825"></a>遇到的错误</h5> 
<p><img src="https://images2.imgbox.com/65/a9/uBQPrlya_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-cpp"><span class="token comment">//删除图书</span>
QString <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span> <span class="token function">delBook</span><span class="token punctuation">(</span>QString bookId<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    QSqlQuery <span class="token function">q</span><span class="token punctuation">(</span>m_db<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"delete from book where bookid= %1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>bookId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">bool</span> ret<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>ret<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>q<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"fail"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">"success"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> cell_BookMgr<span class="token double-colon punctuation">::</span><span class="token function">on_btn_bookDel_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//获取鼠标点击到哪一行了</span>
    <span class="token keyword">int</span> r<span class="token operator">=</span>ui<span class="token operator">-&gt;</span>tableView<span class="token operator">-&gt;</span><span class="token function">currentIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>r<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token string">"信息"</span><span class="token punctuation">,</span><span class="token string">"请选中要删除的一行"</span><span class="token punctuation">,</span>QMessageBox<span class="token double-colon punctuation">::</span>Ok<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">auto</span>  id <span class="token operator">=</span>m_model<span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        QString str<span class="token operator">=</span><span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">delBook</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token string">"信息"</span><span class="token punctuation">,</span>str<span class="token operator">==</span><span class="token string">"success"</span><span class="token operator">?</span><span class="token string">"删除成功"</span><span class="token operator">:</span><span class="token string">"删除失败"</span><span class="token punctuation">,</span>QMessageBox<span class="token double-colon punctuation">::</span>Ok<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">initPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h4><a id="_859"></a>借阅图书</h4> 
<p>创建一个窗口类<br> <img src="https://images2.imgbox.com/cc/eb/0UacHMzZ_o.png" alt="在这里插入图片描述"><br> Dlg_getsetbook</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"dlg_getsetbook.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ui_dlg_getsetbook.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"dao/sqlmgr.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"QMessageBox"</span></span>
<span class="token class-name">Dlg_getSetBook</span><span class="token double-colon punctuation">::</span><span class="token function">Dlg_getSetBook</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent<span class="token punctuation">)</span> <span class="token operator">:</span>
    <span class="token function">QDialog</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">ui</span><span class="token punctuation">(</span><span class="token keyword">new</span> Ui<span class="token double-colon punctuation">::</span>Dlg_getSetBook<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    ui<span class="token operator">-&gt;</span><span class="token function">setupUi</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Dlg_getSetBook</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">Dlg_getSetBook</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">delete</span> ui<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Dlg_getSetBook</span><span class="token double-colon punctuation">::</span><span class="token function">showBorrowBook</span><span class="token punctuation">(</span>QString bookName<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//在页面上显示图书</span>
    ui<span class="token operator">-&gt;</span>le_bookname<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span>bookName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Dlg_getSetBook</span><span class="token double-colon punctuation">::</span><span class="token function">setBookId</span><span class="token punctuation">(</span>QString bookid<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    m_bookid<span class="token operator">=</span>bookid<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Dlg_getSetBook</span><span class="token double-colon punctuation">::</span><span class="token function">on_btn_ok_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//点击确定之后获取页面上的数据进行调用数据库</span>
    <span class="token keyword">auto</span> userName<span class="token operator">=</span>ui<span class="token operator">-&gt;</span>le_username<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">auto</span> pwd<span class="token operator">=</span>ui<span class="token operator">-&gt;</span>le_pwd<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//判断用户是否存在</span>
   <span class="token keyword">bool</span> ret<span class="token operator">=</span><span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">login</span><span class="token punctuation">(</span>userName<span class="token punctuation">,</span>pwd<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
       <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token string">"提示"</span><span class="token punctuation">,</span><span class="token string">"该用户不存在"</span><span class="token punctuation">,</span>QMessageBox<span class="token double-colon punctuation">::</span>Ok<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token comment">//  图书借阅   QString borrowBook(QString userId,QString bookId);</span>
        <span class="token comment">//获取用户id</span>
  QString userid <span class="token operator">=</span>  <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getUserid</span><span class="token punctuation">(</span>userName<span class="token punctuation">,</span>pwd<span class="token punctuation">)</span><span class="token punctuation">;</span>
   m_userid<span class="token operator">=</span>userid<span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>m_userid<span class="token operator">==</span><span class="token string">""</span><span class="token operator">&amp;&amp;</span>m_bookid<span class="token operator">==</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token string">"提示"</span><span class="token punctuation">,</span><span class="token string">"用户id或图书id为null"</span><span class="token punctuation">,</span>QMessageBox<span class="token double-colon punctuation">::</span>Ok<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
  QString str<span class="token operator">=</span><span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">borrowBook</span><span class="token punctuation">(</span>m_userid<span class="token punctuation">,</span>m_bookid<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token string">"提示"</span><span class="token punctuation">,</span>str<span class="token operator">==</span><span class="token string">"借阅成功"</span><span class="token operator">?</span><span class="token string">"借阅成功"</span><span class="token operator">:</span><span class="token string">"借阅失败"</span><span class="token punctuation">,</span>QMessageBox<span class="token double-colon punctuation">::</span>Ok<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//隐藏窗口</span>
  <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">DLG_GETSETBOOK_H</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">DLG_GETSETBOOK_H</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QDialog&gt;</span></span>

<span class="token keyword">namespace</span> Ui <span class="token punctuation">{<!-- --></span>
<span class="token keyword">class</span> <span class="token class-name">Dlg_getSetBook</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Dlg_getSetBook</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">QDialog</span></span>
<span class="token punctuation">{<!-- --></span>
    Q_OBJECT

<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">explicit</span> <span class="token function">Dlg_getSetBook</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">Dlg_getSetBook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//显示你借的那一本书</span>
    <span class="token keyword">void</span> <span class="token function">showBorrowBook</span><span class="token punctuation">(</span>QString bookName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">setBookId</span><span class="token punctuation">(</span>QString bookid<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">private</span> slots<span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">on_btn_ok_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    Ui<span class="token double-colon punctuation">::</span>Dlg_getSetBook <span class="token operator">*</span>ui<span class="token punctuation">;</span>
    QString m_bookid<span class="token punctuation">;</span>
    QString m_userid<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// DLG_GETSETBOOK_H</span></span>


</code></pre> 
<p><strong>dao:</strong></p> 
<pre><code class="prism language-cpp"><span class="token comment">//图书借阅</span>
QString <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">borrowBook</span><span class="token punctuation">(</span>QString userId<span class="token punctuation">,</span>QString bookId<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    QSqlQuery <span class="token function">q</span><span class="token punctuation">(</span>m_db<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"update book set cnt=cnt-1 where bookid = %1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>bookId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">bool</span> ret<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//执行查询语句</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>q<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"借阅失败"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//QDateTime::currentSecsSinceEpoch()</span>
    QString start <span class="token operator">=</span><span class="token function">secondsToDateString</span><span class="token punctuation">(</span><span class="token class-name">QDateTime</span><span class="token double-colon punctuation">::</span><span class="token function">currentSecsSinceEpoch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString end <span class="token operator">=</span><span class="token function">secondsToDateString</span><span class="token punctuation">(</span><span class="token class-name">QDateTime</span><span class="token double-colon punctuation">::</span><span class="token function">currentSecsSinceEpoch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">3600</span><span class="token operator">*</span><span class="token number">24</span><span class="token operator">*</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"insert into record values(null,%1,%2,'%3','%4')"</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>bookId<span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>start<span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>end<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ret<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//执行查询语句</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>q<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"借阅失败"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">"借阅成功"</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> 
<p><strong>dao:(getuserid)</strong></p> 
<pre><code class="prism language-cpp">
QString <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getUserid</span><span class="token punctuation">(</span>QString userName<span class="token punctuation">,</span> QString pwd<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QSqlQuery <span class="token function">q</span><span class="token punctuation">(</span>m_db<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"select id from user where username = '%1' and password = '%2' "</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>userName<span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>pwd<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">bool</span> ret<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//执行查询语句</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>q<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    QString userid <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 移动到结果集中的第一条记录</span>
        userid <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> userid<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
QString <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">secondsToDateString</span><span class="token punctuation">(</span>qint64 seconds<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QDateTime dateTime <span class="token operator">=</span> <span class="token class-name">QDateTime</span><span class="token double-colon punctuation">::</span><span class="token function">fromSecsSinceEpoch</span><span class="token punctuation">(</span>seconds<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString dateString <span class="token operator">=</span> dateTime<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-dd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> dateString<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<p><strong>控制层：</strong></p> 
<pre><code class="prism language-cpp"><span class="token comment">//借阅图书</span>
<span class="token keyword">void</span> cell_BookMgr<span class="token double-colon punctuation">::</span><span class="token function">on_btn_BookRecord_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//判断点击了哪一行数据</span>
    <span class="token keyword">int</span> r<span class="token operator">=</span>ui<span class="token operator">-&gt;</span>tableView<span class="token operator">-&gt;</span><span class="token function">currentIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>r<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token string">"信息"</span><span class="token punctuation">,</span><span class="token string">"请选中要借阅的图书"</span><span class="token punctuation">,</span>QMessageBox<span class="token double-colon punctuation">::</span>Ok<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">auto</span> bookid <span class="token operator">=</span>m_model<span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//获得cnt cnt&lt;=0 库存没了不能借 r行的6列</span>
        <span class="token keyword">auto</span> cnt <span class="token operator">=</span>m_model<span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>cnt<span class="token operator">&lt;=</span><span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
           <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token string">"信息"</span><span class="token punctuation">,</span><span class="token string">"该书没有库存了,嗷了个嗷~"</span><span class="token punctuation">,</span>QMessageBox<span class="token double-colon punctuation">::</span>Ok<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//否则向下执行 要进行登记是谁借了这本书调用子页面</span>
        Dlg_getSetBook dlg<span class="token punctuation">;</span>
        <span class="token comment">//获得书的名字</span>
        <span class="token keyword">auto</span> bookName <span class="token operator">=</span>m_model<span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dlg<span class="token punctuation">.</span><span class="token function">setBookId</span><span class="token punctuation">(</span>bookid<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设置图书id</span>
        dlg<span class="token punctuation">.</span><span class="token function">showBorrowBook</span><span class="token punctuation">(</span>bookName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dlg<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">initPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

</code></pre> 
<h4><a id="_1039"></a>搜索图书</h4> 
<p><strong>控制层:(直接调用initPage函数）</strong></p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> cell_BookMgr<span class="token double-colon punctuation">::</span><span class="token function">on_le_search_textChanged</span><span class="token punctuation">(</span><span class="token keyword">const</span> QString <span class="token operator">&amp;</span>arg1<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QString sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"where name like '%%1%' or type1 = '%1' or type2 = '%1' or type3 = '%1' "</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>arg1<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">initPage</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="_1054"></a>借阅记录管理功能</h3> 
<h4><a id="_1055"></a>获取借阅记录</h4> 
<p><img src="https://images2.imgbox.com/ec/e0/gpJgmfmD_o.png" alt="在这里插入图片描述"><br> <strong>dao:</strong></p> 
<pre><code class="prism language-cpp"><span class="token comment">//获取借阅记录</span>
QVector <span class="token operator">&lt;</span>QStringList<span class="token operator">&gt;</span> <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getRecord</span><span class="token punctuation">(</span>QString strCondition<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    QSqlQuery <span class="token function">q</span><span class="token punctuation">(</span>m_db<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"select * from record %1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>strCondition<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QVector<span class="token operator">&lt;</span>QStringList<span class="token operator">&gt;</span> vec<span class="token punctuation">;</span>
    <span class="token comment">//执行</span>
    <span class="token keyword">bool</span> ret<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>ret<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>q<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>

        QStringList strList<span class="token punctuation">;</span>

        <span class="token comment">//获取这些数据有几列</span>
        <span class="token keyword">int</span> col<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">record</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//从q里面获取数据</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            strList<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>col<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token comment">//把这一行数据放进去</span>
                strList<span class="token operator">&lt;&lt;</span>q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            vec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>strList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> vec<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<p><strong>控制层:</strong></p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> cell_Record<span class="token double-colon punctuation">::</span><span class="token function">initPage</span><span class="token punctuation">(</span>QString condition<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>

    <span class="token keyword">auto</span> vec<span class="token operator">=</span><span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getRecord</span><span class="token punctuation">(</span>condition<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//拿数据显示到页面</span>
    m_model<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//在设置一次头</span>
    m_model<span class="token punctuation">.</span><span class="token function">setHorizontalHeaderLabels</span><span class="token punctuation">(</span>QStringList<span class="token punctuation">{<!-- --></span><span class="token string">"图书id"</span><span class="token punctuation">,</span><span class="token string">"图书名称"</span><span class="token punctuation">,</span><span class="token string">"价格"</span><span class="token punctuation">,</span><span class="token string">"类型1"</span><span class="token punctuation">,</span><span class="token string">"类型2"</span><span class="token punctuation">,</span><span class="token string">"类型3"</span><span class="token punctuation">,</span><span class="token string">"数量"</span><span class="token punctuation">,</span><span class="token string">"图片"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>QStringList strList<span class="token operator">:</span>vec<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        QList<span class="token operator">&lt;</span>QStandardItem<span class="token operator">*</span><span class="token operator">&gt;</span> items<span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>strList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            items<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QStandardItem</span><span class="token punctuation">(</span>strList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        m_model<span class="token punctuation">.</span><span class="token function">appendRow</span><span class="token punctuation">(</span>items<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">void</span> cell_Record<span class="token double-colon punctuation">::</span><span class="token function">on_le_search_textChanged</span><span class="token punctuation">(</span><span class="token keyword">const</span> QString <span class="token operator">&amp;</span>arg1<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QString sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"where start like '%%1%' or end like '%%1%' or userid = %1 or bookid = %1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>arg1<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">initPage</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="_1116"></a>模糊查询记录</h4> 
<blockquote> 
 <p><strong>通过开始时间和结束时间与用户名和密码进行查询</strong></p> 
</blockquote> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> cell_Record<span class="token double-colon punctuation">::</span><span class="token function">on_le_search_textChanged</span><span class="token punctuation">(</span><span class="token keyword">const</span> QString <span class="token operator">&amp;</span>arg1<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//同过开始时间和结束时间与用户名和密码进行查询</span>
    QString sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"where start like '%%1%' or end like '%%1%' or user.username = '%1' or book.name= '%1'"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>arg1<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">initPage</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="_1129"></a>归还图书</h4> 
<p><strong>数据库层:</strong></p> 
<pre><code class="prism language-cpp"><span class="token comment">//归还图书</span>
QString <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">returnBook</span><span class="token punctuation">(</span>QString userId<span class="token punctuation">,</span>QString bookId<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">//根据userid==bookid删除记录 在根据bookid为本书cnt（库存+1）</span>
    QSqlQuery <span class="token function">q</span><span class="token punctuation">(</span>m_db<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//    qDebug()&lt;&lt;"bookid= "&lt;&lt;bookId&lt;&lt;" userid = "&lt;&lt;userId;</span>
    <span class="token comment">/*
     * 假如a(id=1)借西游记(bookid=6) b(id=2)借了西游记(bookid=6)
     * 登录b还a借的书也是会成功的 b(id=2) a借的书(bookid=6)
*/</span>
    QString sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"delete from record where userid = %1 and bookid = %2"</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>bookId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">bool</span> ret<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>q<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"归还失败"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"update book set cnt = cnt+1 where bookid = %1"</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>bookId<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//    qDebug()&lt;&lt;"bookid= ======"&lt;&lt;bookId;</span>
     ret<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>q<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"归还失败"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">"归还成功"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>控制层:</strong></p> 
<pre><code class="prism language-cpp">
<span class="token comment">//归还图书</span>
<span class="token keyword">void</span> cell_Record<span class="token double-colon punctuation">::</span><span class="token function">on_btn_return_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//获取鼠标点中的哪一行</span>
    <span class="token keyword">int</span> r<span class="token operator">=</span>ui<span class="token operator">-&gt;</span>tableView<span class="token operator">-&gt;</span><span class="token function">currentIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>r<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token string">"信息"</span><span class="token punctuation">,</span><span class="token string">"请选中要归还的图书"</span><span class="token punctuation">,</span>QMessageBox<span class="token double-colon punctuation">::</span>Ok<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">//弹出子页面用户登录之后在删除</span>
        Dlg_getSetBook dlg<span class="token punctuation">;</span>
        <span class="token comment">//获得书的名字</span>
        QString tempBookid<span class="token operator">=</span>m_model<span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        QString bookName<span class="token operator">=</span><span class="token function">getBookName</span><span class="token punctuation">(</span>tempBookid<span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//获取图书id</span>
        <span class="token keyword">auto</span> bookid <span class="token operator">=</span> m_model<span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//获取userid</span>
        <span class="token keyword">auto</span> userid <span class="token operator">=</span> m_model<span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dlg<span class="token punctuation">.</span><span class="token function">setBookId</span><span class="token punctuation">(</span>bookid<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dlg<span class="token punctuation">.</span><span class="token function">setUserId</span><span class="token punctuation">(</span>userid<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dlg<span class="token punctuation">.</span><span class="token function">setFlag</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dlg<span class="token punctuation">.</span><span class="token function">showBorrowBook</span><span class="token punctuation">(</span>bookName<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设置到页面上</span>
        dlg<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">initPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

QString cell_Record<span class="token double-colon punctuation">::</span><span class="token function">getBookName</span><span class="token punctuation">(</span><span class="token keyword">int</span> bookid<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QString bookName<span class="token punctuation">;</span>
    bookName<span class="token operator">=</span><span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getBookName</span><span class="token punctuation">(</span>bookid<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> bookName<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>Dlg_setgetBook</strong></p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token class-name">Dlg_getSetBook</span><span class="token double-colon punctuation">::</span><span class="token function">on_btn_ok_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//点击确定之后获取页面上的数据进行调用数据库</span>
    <span class="token keyword">auto</span> userName<span class="token operator">=</span>ui<span class="token operator">-&gt;</span>le_username<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">auto</span> pwd<span class="token operator">=</span>ui<span class="token operator">-&gt;</span>le_pwd<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//判断用户是否存在</span>
   <span class="token keyword">bool</span> ret<span class="token operator">=</span><span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">login</span><span class="token punctuation">(</span>userName<span class="token punctuation">,</span>pwd<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
       <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token string">"提示"</span><span class="token punctuation">,</span><span class="token string">"该用户不存在"</span><span class="token punctuation">,</span>QMessageBox<span class="token double-colon punctuation">::</span>Ok<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

        <span class="token comment">//获取当前登录在Dlg_getsetbook窗口的用户id</span>
  QString CurUserid <span class="token operator">=</span>  <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getUserid</span><span class="token punctuation">(</span>userName<span class="token punctuation">,</span>pwd<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span><span class="token punctuation">(</span>m_userid<span class="token operator">==</span><span class="token string">""</span><span class="token operator">&amp;&amp;</span>m_bookid<span class="token operator">==</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token string">"提示"</span><span class="token punctuation">,</span><span class="token string">"用户id或图书id为null"</span><span class="token punctuation">,</span>QMessageBox<span class="token double-colon punctuation">::</span>Ok<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>m_flag<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//借阅</span>
        <span class="token comment">//借阅图书的时候用当前登录的用户的用户id借阅</span>
        m_userid<span class="token operator">=</span>CurUserid<span class="token punctuation">;</span>
        QString str<span class="token operator">=</span><span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">borrowBook</span><span class="token punctuation">(</span>m_userid<span class="token punctuation">,</span>m_bookid<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token string">"提示"</span><span class="token punctuation">,</span>str<span class="token operator">==</span><span class="token string">"借阅成功"</span><span class="token operator">?</span><span class="token string">"借阅成功"</span><span class="token operator">:</span><span class="token string">"借阅失败"</span><span class="token punctuation">,</span>QMessageBox<span class="token double-colon punctuation">::</span>Ok<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span><span class="token comment">//归还</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>CurUserid<span class="token operator">==</span>m_userid<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        QString str<span class="token operator">=</span><span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">returnBook</span><span class="token punctuation">(</span>m_userid<span class="token punctuation">,</span>m_bookid<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token string">"提示"</span><span class="token punctuation">,</span>str<span class="token operator">==</span><span class="token string">"归还成功"</span><span class="token operator">?</span><span class="token string">"归还成功"</span><span class="token operator">:</span><span class="token string">"归还失败"</span><span class="token punctuation">,</span>QMessageBox<span class="token double-colon punctuation">::</span>Ok<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token string">"提示"</span><span class="token punctuation">,</span><span class="token string">"用户: "</span><span class="token operator">+</span>userName<span class="token operator">+</span><span class="token string">" 未借此书"</span><span class="token punctuation">,</span>QMessageBox<span class="token double-colon punctuation">::</span>Ok<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//隐藏窗口</span>
  <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>



</code></pre> 
<h5><a id="_1245"></a>出现的问题</h5> 
<p><img src="https://images2.imgbox.com/f9/0e/VY2iSoqL_o.png" alt="在这里插入图片描述"><br> <strong>改造一下归还函数</strong></p> 
<pre><code class="prism language-cpp"><span class="token comment">//归还图书</span>
QString <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">returnBook</span><span class="token punctuation">(</span>QString userId<span class="token punctuation">,</span>QString bookId<span class="token punctuation">,</span>QString recordId<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">//根据userid==bookid删除记录 在根据bookid为本书cnt（库存+1）</span>
    QSqlQuery <span class="token function">q</span><span class="token punctuation">(</span>m_db<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//    qDebug()&lt;&lt;"bookid= "&lt;&lt;bookId&lt;&lt;" userid = "&lt;&lt;userId;</span>
    <span class="token comment">/*
     * 假如a(id=1)借西游记(bookid=6) b(id=2)借了西游记(bookid=6)
     * 登录b还a借的书也是会成功的 b(id=2) a借的书(bookid=6)
*/</span>
    QString sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"delete from record where userid = %1 and bookid = %2 and id= %3"</span><span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>bookId<span class="token punctuation">)</span>
                      <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>recordId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">bool</span> ret<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>q<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"归还失败"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"update book set cnt = cnt+1 where bookid = %1"</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>bookId<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//    qDebug()&lt;&lt;"bookid= ======"&lt;&lt;bookId;</span>
     ret<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>q<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"归还失败"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">"归还成功"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>




<span class="token comment">//转换日期格式</span>
QString <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">secondsToDateString</span><span class="token punctuation">(</span>qint64 seconds<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QDateTime dateTime <span class="token operator">=</span> <span class="token class-name">QDateTime</span><span class="token double-colon punctuation">::</span><span class="token function">fromSecsSinceEpoch</span><span class="token punctuation">(</span>seconds<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString dateString <span class="token operator">=</span> dateTime<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-dd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> dateString<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

QString <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getBookName</span><span class="token punctuation">(</span><span class="token keyword">int</span> bookid<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QSqlQuery <span class="token function">q</span><span class="token punctuation">(</span>m_db<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"select name from book where bookid = %1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>bookid<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">bool</span> ret <span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>ret<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>q<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    QString bookName<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        bookName<span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> bookName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> bookName<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>添加一下这个函数<br> <img src="https://images2.imgbox.com/dc/f1/Q7lT16BM_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/65/39/IK2z9hTQ_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"dlg_getsetbook.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ui_dlg_getsetbook.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"dao/sqlmgr.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"QMessageBox"</span></span>
<span class="token class-name">Dlg_getSetBook</span><span class="token double-colon punctuation">::</span><span class="token function">Dlg_getSetBook</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent<span class="token punctuation">)</span> <span class="token operator">:</span>
    <span class="token function">QDialog</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">ui</span><span class="token punctuation">(</span><span class="token keyword">new</span> Ui<span class="token double-colon punctuation">::</span>Dlg_getSetBook<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    ui<span class="token operator">-&gt;</span><span class="token function">setupUi</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Dlg_getSetBook</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">Dlg_getSetBook</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">delete</span> ui<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Dlg_getSetBook</span><span class="token double-colon punctuation">::</span><span class="token function">showBorrowBook</span><span class="token punctuation">(</span>QString bookName<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//在页面上显示图书</span>
    ui<span class="token operator">-&gt;</span>le_bookname<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span>bookName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Dlg_getSetBook</span><span class="token double-colon punctuation">::</span><span class="token function">setBookId</span><span class="token punctuation">(</span>QString bookid<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    m_bookid<span class="token operator">=</span>bookid<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Dlg_getSetBook</span><span class="token double-colon punctuation">::</span><span class="token function">setFlag</span><span class="token punctuation">(</span><span class="token keyword">bool</span> flag<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    m_flag<span class="token operator">=</span>flag<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Dlg_getSetBook</span><span class="token double-colon punctuation">::</span><span class="token function">setUserId</span><span class="token punctuation">(</span>QString userid<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    m_userid<span class="token operator">=</span>userid<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Dlg_getSetBook</span><span class="token double-colon punctuation">::</span><span class="token function">setRecordId</span><span class="token punctuation">(</span>QString recordid<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    m_recordid<span class="token operator">=</span>recordid<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Dlg_getSetBook</span><span class="token double-colon punctuation">::</span><span class="token function">on_btn_ok_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//点击确定之后获取页面上的数据进行调用数据库</span>
    <span class="token keyword">auto</span> userName<span class="token operator">=</span>ui<span class="token operator">-&gt;</span>le_username<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">auto</span> pwd<span class="token operator">=</span>ui<span class="token operator">-&gt;</span>le_pwd<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//判断用户是否存在</span>
   <span class="token keyword">bool</span> ret<span class="token operator">=</span><span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">login</span><span class="token punctuation">(</span>userName<span class="token punctuation">,</span>pwd<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
       <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token string">"提示"</span><span class="token punctuation">,</span><span class="token string">"该用户不存在"</span><span class="token punctuation">,</span>QMessageBox<span class="token double-colon punctuation">::</span>Ok<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

        <span class="token comment">//获取当前登录在Dlg_getsetbook窗口的用户id</span>
  QString CurUserid <span class="token operator">=</span>  <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getUserid</span><span class="token punctuation">(</span>userName<span class="token punctuation">,</span>pwd<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span><span class="token punctuation">(</span>m_userid<span class="token operator">==</span><span class="token string">""</span><span class="token operator">&amp;&amp;</span>m_bookid<span class="token operator">==</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token string">"提示"</span><span class="token punctuation">,</span><span class="token string">"用户id或图书id为null"</span><span class="token punctuation">,</span>QMessageBox<span class="token double-colon punctuation">::</span>Ok<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>m_flag<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//借阅</span>
        <span class="token comment">//借阅图书的时候用当前登录的用户的用户id借阅</span>
        m_userid<span class="token operator">=</span>CurUserid<span class="token punctuation">;</span>
        QString str<span class="token operator">=</span><span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">borrowBook</span><span class="token punctuation">(</span>m_userid<span class="token punctuation">,</span>m_bookid<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token string">"提示"</span><span class="token punctuation">,</span>str<span class="token operator">==</span><span class="token string">"借阅成功"</span><span class="token operator">?</span><span class="token string">"借阅成功"</span><span class="token operator">:</span><span class="token string">"借阅失败"</span><span class="token punctuation">,</span>QMessageBox<span class="token double-colon punctuation">::</span>Ok<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span><span class="token comment">//归还</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>CurUserid<span class="token operator">==</span>m_userid<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
         <span class="token comment">//归还的时候还要用到记录id</span>
        QString str<span class="token operator">=</span><span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">returnBook</span><span class="token punctuation">(</span>m_userid<span class="token punctuation">,</span>m_bookid<span class="token punctuation">,</span>m_recordid<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token string">"提示"</span><span class="token punctuation">,</span>str<span class="token operator">==</span><span class="token string">"归还成功"</span><span class="token operator">?</span><span class="token string">"归还成功"</span><span class="token operator">:</span><span class="token string">"归还失败"</span><span class="token punctuation">,</span>QMessageBox<span class="token double-colon punctuation">::</span>Ok<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token string">"提示"</span><span class="token punctuation">,</span><span class="token string">"用户: "</span><span class="token operator">+</span>userName<span class="token operator">+</span><span class="token string">" 未借此书"</span><span class="token punctuation">,</span>QMessageBox<span class="token double-colon punctuation">::</span>Ok<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//隐藏窗口</span>
  <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>



</code></pre> 
<h4><a id="_1398"></a>清空借阅记录</h4> 
<p><strong>dao:</strong></p> 
<pre><code class="prism language-cpp">
<span class="token keyword">void</span> <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">clearRecord</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//删除所有图书</span>
        QSqlQuery <span class="token function">q</span><span class="token punctuation">(</span>m_db<span class="token punctuation">)</span><span class="token punctuation">;</span>
        QString sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"delete from record;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">bool</span> ret<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//执行查询语句</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>q<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


        sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"delete from sqlite_sequence where name= 'record';"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ret<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//执行查询语句</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>q<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"clearRecord()成功......."</span><span class="token punctuation">;</span>


<span class="token punctuation">}</span>
</code></pre> 
<p><strong>控制层：</strong></p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> cell_Record<span class="token double-colon punctuation">::</span><span class="token function">on_btn_clear_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">clearRecord</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">initPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<h4><a id="_1437"></a>登录功能</h4> 
<p><strong>控制层：</strong></p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token class-name">Dlg_login</span><span class="token double-colon punctuation">::</span><span class="token function">on_btn_login_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">auto</span> username<span class="token operator">=</span>ui<span class="token operator">-&gt;</span>username<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">auto</span> pwd<span class="token operator">=</span>ui<span class="token operator">-&gt;</span>password<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>username<span class="token operator">==</span><span class="token string">""</span><span class="token operator">||</span>pwd<span class="token operator">==</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token string">"提示"</span><span class="token punctuation">,</span><span class="token string">"用户名或密码不能为空"</span><span class="token punctuation">,</span>QMessageBox<span class="token double-colon punctuation">::</span>Ok<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">bool</span> ret<span class="token operator">=</span><span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">login</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span>pwd<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>

        <span class="token function">setResult</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>

    <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token string">"提示"</span><span class="token punctuation">,</span><span class="token string">"用户名或密码错误"</span><span class="token punctuation">,</span>QMessageBox<span class="token double-colon punctuation">::</span>Ok<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p><strong>dao:</strong></p> 
<pre><code class="prism language-cpp"><span class="token comment">//返回      true登录成功</span>
<span class="token keyword">bool</span> <span class="token class-name">SqlMgr</span><span class="token double-colon punctuation">::</span><span class="token function">login</span><span class="token punctuation">(</span>QString username<span class="token punctuation">,</span> QString password<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QSqlQuery <span class="token function">q</span><span class="token punctuation">(</span>m_db<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString sql<span class="token operator">=</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"select *from user where username='%1' and password='%2'"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">bool</span> ret<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//执行查询语句 执行成功返回true</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>

        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>q<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//执行这个q.next()判断是否还有可以执行成功</span>
    ret<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/43/e9/ZshGOXBC_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_1481"></a>页面展示</h4> 
<p><img src="https://images2.imgbox.com/fc/ce/IajVYLsb_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c8/40/zN33GB58_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c6/03/IFiFSv4P_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7317b9240dc4aebe13bcfd6dd58035be/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">瑞芯微RK3568/RK3588平台YOLOV5实时视频算法的部署小白教程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ff91cad7558cf30bcde0f87aab117256/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">浅析目标检测入门算法：YOLOv1,SSD,YOLOv2,YOLOv3,CenterNet,EfficientDet,YOLOv4</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>