<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>axios详解，基本使用与封装 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/e15a58488f2ccf6a6715001641f2467b/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="axios详解，基本使用与封装">
  <meta property="og:description" content="axios详解，基本使用与封装 什么是Axios对比1. AJAX2. jQuery的$.ajax方法3. Axios4. XMLHttpRequest5. Fetch6. 总结 Axios的基本使用ts封装Axios为什么封装axios一次封装二次封装 如何封装第一次封装第二次封装使用 什么是Axios Axios 是一个基于 Promise 的网络请求库（类似于jQuery的Ajax，用于HTTP请求），作用于node.js 和浏览器中。
对比 1. AJAX AJAX 是一种在无需重新加载整个网页的情况下，能够更新部分网页的技术，是一个技术统称。
2. jQuery的$.ajax方法 AJAX的简化,jQuery是一个封装好的JavaScript库，所以jQuery的$.ajax方法比原生Ajax的简单
缺点：依赖 jQuery，配置繁琐，不轻量
选择建议：项目已经使用了jQuery，并且对HTTP请求没有特殊需求
3. Axios 基于 Promise的网络请求库，用于浏览器和Node.js中发送HTTP请求。axios是通过promise技术实现对ajax实现的一种封装，本身上来说axios就是ajax
缺点：可能出现跨域问题
选择建议：正在使用较新的JavaScript框架（如React、Vue等），并且需要高级HTTP功能
4. XMLHttpRequest XMLHttpRequest是一个浏览器内置的JavaScript对象，它允许开发者在页面没有刷新的情况下从服务器请求数据，并接收服务器的响应。是AJAX的基础
缺点：配置和调用方式都很繁琐
选择建议：正在开发一个需要兼容旧浏览器或需要更精细地控制HTTP请求的应用
5. Fetch Fetch API ES6 之后出现的基于 Promise 的一个JavaScript库，是一个现代的网络请求API，
缺点：新技术，部分浏览器可能不兼容
选择建议：正在开发一个不需要复杂HTTP处理功能的Web应用，并且希望使用原生的浏览器API
6. 总结 ajax是一个技术的统称，是js异步技术的术语，XMLHttpRequest 是实现 Ajax 的一种方式。jQuery的$.ajax方法是一个方法，封装了Ajaxaxios是一个库，是用于网络请求的第三方库。fetch是一个api，是es6新增的用于网络请求标准api。XHR是一个 JavaScript 对象，可以封装Ajax Axios的基本使用 get：一般用于获取数据
post：一般用于提交数据（表单提交与文件上传）
patch：更新数据（只将修改的数据推送到后端（服务端））（适合数据量比较大的更新）
put：更新数据（所有数据推送到服务端）（适合数据量比较小的更新）
delete：删除数据
// ————————axios get方法第一种写法———————— // get方法——————1.不带参数 axios.get(&#39;http://jsonplaceholder.typicode.com/posts&#39;) .then(function (response) { // 处理成功情况 console.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-18T15:09:49+08:00">
    <meta property="article:modified_time" content="2024-05-18T15:09:49+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">axios详解，基本使用与封装</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>axios详解，基本使用与封装</h4> 
 <ul><li><a href="#Axios_2" rel="nofollow">什么是Axios</a></li><li><a href="#_4" rel="nofollow">对比</a></li><li><ul><li><a href="#1_AJAX_5" rel="nofollow">1. AJAX</a></li><li><a href="#2_jQueryajax_8" rel="nofollow">2. jQuery的$.ajax方法</a></li><li><a href="#3_Axios_13" rel="nofollow">3. Axios</a></li><li><a href="#4_XMLHttpRequest_18" rel="nofollow">4. XMLHttpRequest</a></li><li><a href="#5_Fetch_22" rel="nofollow">5. Fetch</a></li><li><a href="#6__27" rel="nofollow">6. 总结</a></li></ul> 
  </li><li><a href="#Axios_34" rel="nofollow">Axios的基本使用</a></li><li><a href="#tsAxios_203" rel="nofollow">ts封装Axios</a></li><li><ul><li><a href="#axios_205" rel="nofollow">为什么封装axios</a></li><li><ul><li><a href="#_229" rel="nofollow">一次封装</a></li><li><a href="#_239" rel="nofollow">二次封装</a></li></ul> 
   </li><li><a href="#_258" rel="nofollow">如何封装</a></li><li><ul><li><a href="#_259" rel="nofollow">第一次封装</a></li><li><a href="#_370" rel="nofollow">第二次封装</a></li><li><a href="#_393" rel="nofollow">使用</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="Axios_2"></a>什么是Axios</h2> 
<p>Axios 是一个基于 Promise 的网络请求库（类似于jQuery的Ajax，用于HTTP请求），作用于node.js 和浏览器中。</p> 
<h2><a id="_4"></a>对比</h2> 
<h3><a id="1_AJAX_5"></a>1. AJAX</h3> 
<p>AJAX 是一种在无需重新加载整个网页的情况下，能够更新部分网页的技术，是一个技术统称。</p> 
<h3><a id="2_jQueryajax_8"></a>2. jQuery的$.ajax方法</h3> 
<p>AJAX的简化,jQuery是一个封装好的JavaScript库，所以jQuery的$.ajax方法比原生Ajax的简单<br> <strong>缺点：依赖 jQuery，配置繁琐，不轻量<br> 选择建议：项目已经使用了jQuery，并且对HTTP请求没有特殊需求</strong></p> 
<h3><a id="3_Axios_13"></a>3. Axios</h3> 
<p>基于 Promise的网络请求库，用于浏览器和Node.js中发送HTTP请求。axios是通过promise技术实现对ajax实现的一种封装，本身上来说axios就是ajax<br> <strong>缺点：可能出现跨域问题<br> 选择建议：正在使用较新的JavaScript框架（如React、Vue等），并且需要高级HTTP功能</strong></p> 
<h3><a id="4_XMLHttpRequest_18"></a>4. XMLHttpRequest</h3> 
<p>XMLHttpRequest是一个浏览器内置的JavaScript对象，它允许开发者在页面没有刷新的情况下从服务器请求数据，并接收服务器的响应。是AJAX的基础<br> <strong>缺点：配置和调用方式都很繁琐<br> 选择建议：正在开发一个需要兼容旧浏览器或需要更精细地控制HTTP请求的应用</strong></p> 
<h3><a id="5_Fetch_22"></a>5. Fetch</h3> 
<p>Fetch API ES6 之后出现的基于 Promise 的一个JavaScript库，是一个现代的网络请求API，<br> <strong>缺点：新技术，部分浏览器可能不兼容<br> 选择建议：正在开发一个不需要复杂HTTP处理功能的Web应用，并且希望使用原生的浏览器API</strong></p> 
<h3><a id="6__27"></a>6. 总结</h3> 
<ol><li>ajax是一个技术的统称，是js异步技术的术语，XMLHttpRequest 是实现 Ajax 的一种方式。</li><li>jQuery的$.ajax方法是一个方法，封装了Ajax</li><li>axios是一个库，是用于网络请求的第三方库。</li><li>fetch是一个api，是es6新增的用于网络请求标准api。</li><li>XHR是一个 JavaScript 对象，可以封装Ajax</li></ol> 
<h2><a id="Axios_34"></a>Axios的基本使用</h2> 
<p>get：一般用于获取数据<br> post：一般用于提交数据（表单提交与文件上传）<br> patch：更新数据（只将修改的数据推送到后端（服务端））（适合数据量比较大的更新）<br> put：更新数据（所有数据推送到服务端）（适合数据量比较小的更新）<br> delete：删除数据</p> 
<pre><code class="prism language-javascript">
<span class="token comment">// ————————axios get方法第一种写法————————</span>

<span class="token comment">// get方法——————1.不带参数</span>
axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'http://jsonplaceholder.typicode.com/posts'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 处理成功情况</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 处理错误情况</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// get方法——————2.带参数</span>

<span class="token comment">// 方式一：参数写在url中</span>
axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'http://jsonplaceholder.typicode.com/posts/2'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 处理成功情况</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 处理错误情况</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 方式二：参数写在params中</span>
axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'http://jsonplaceholder.typicode.com/posts'</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">params</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">2</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 处理成功情况</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 处理错误情况</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ————————axios get方法的第二种写法————————</span>

  <span class="token comment">// get方法——————1.不带参数</span>
    <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">method</span><span class="token operator">:</span><span class="token string">'get'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">'http://jsonplaceholder.typicode.com/posts'</span><span class="token punctuation">,</span> 
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span> 
      <span class="token punctuation">}</span><span class="token punctuation">)</span>  

  <span class="token comment">// get方法——————1.带参数</span>
      <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">method</span><span class="token operator">:</span><span class="token string">'get'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">'http://jsonplaceholder.typicode.com/posts'</span><span class="token punctuation">,</span> 
        <span class="token literal-property property">params</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">2</span>
          <span class="token punctuation">}</span> 
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span> 
        <span class="token punctuation">}</span><span class="token punctuation">)</span>   


<span class="token comment">// ————————axios post方法第一种写法————————</span>
      <span class="token comment">// post请求常用的数据请求格式有两种：</span>
      <span class="token comment">// application/json</span>
      <span class="token comment">// form-data 表单提交（图片上传、文件上传）</span>
    


      <span class="token comment">// application/json</span>
      axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">,</span> <span class="token string">"id=123&amp;name=zs"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


     axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">123</span><span class="token punctuation">,</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'zs'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">"zs"</span><span class="token punctuation">}</span>
        <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
          <span class="token literal-property property">method</span><span class="token operator">:</span><span class="token string">'post'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">'/user'</span><span class="token punctuation">,</span>
          <span class="token comment">// 与get请求使用params不同的是，post请求使用data属性</span>
          <span class="token literal-property property">data</span><span class="token operator">:</span>data<span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>

      <span class="token comment">// form-data 表单提交（图片上传、文件上传）</span>
      
        <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">"zs"</span><span class="token punctuation">}</span>
        <span class="token keyword">let</span> formData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          formData<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> data<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>formData<span class="token punctuation">)</span><span class="token punctuation">;</span>
        axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">,</span> formData<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



<span class="token comment">// ————————axios put方法————————</span>

      axios<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">"zs"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      axios<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
          <span class="token literal-property property">method</span><span class="token operator">:</span><span class="token string">'put'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">'/user'</span><span class="token punctuation">,</span>
          <span class="token comment">// 与get请求使用params不同的是，post请求使用data属性</span>
          <span class="token literal-property property">data</span><span class="token operator">:</span>data<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
          

<span class="token comment">// ————————axios patch方法————————</span>

      axios<span class="token punctuation">.</span><span class="token function">patch</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">"zs"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      axios<span class="token punctuation">.</span><span class="token function">patch</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


      <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
          <span class="token literal-property property">method</span><span class="token operator">:</span><span class="token string">'patch'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">'/user'</span><span class="token punctuation">,</span>
          <span class="token comment">// 与get请求使用params不同的是，post请求使用data属性</span>
          <span class="token literal-property property">data</span><span class="token operator">:</span>data<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>



</code></pre> 
<h2><a id="tsAxios_203"></a>ts封装Axios</h2> 
<h3><a id="axios_205"></a>为什么封装axios</h3> 
<p>观察下方的代码，我们发现只需要改变方法，请求路径，和请求返回的数据，但是每次都需要写很多东西，我们能不能只写我们需要的，其他的省略不写呢？这时候我们可以进行axios的封装</p> 
<pre><code class="prism language-javascript"> <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">method</span><span class="token operator">:</span><span class="token string">'get'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">'http://jsonplaceholder.typicode.com/posts'</span><span class="token punctuation">,</span> 
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span> 
        <span class="token punctuation">}</span><span class="token punctuation">)</span>   

 <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">method</span><span class="token operator">:</span><span class="token string">'get'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">'http://jsonplaceholder.typicode.com/posts'</span><span class="token punctuation">,</span> 
        <span class="token literal-property property">params</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">2</span>
          <span class="token punctuation">}</span> 
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span> 
        <span class="token punctuation">}</span><span class="token punctuation">)</span>   

</code></pre> 
<h4><a id="_229"></a>一次封装</h4> 
<pre><code class="prism language-javascript"><span class="token function">http</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'/api/v1/register'</span><span class="token punctuation">,</span>
		<span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>
		data<span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<p>一次封装后，我们只需要传入get或post方法，请求路径，和请求返回的数据，但是如果多个页面都需要这个请求呢，代码会不会太冗余？</p> 
<h4><a id="_239"></a>二次封装</h4> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>getInfor<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./axios/request'</span>
<span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getInfor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-javascript"><span class="token comment">//./axios/request.js</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">postRegister</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token function">http</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'/api/v1/register'</span><span class="token punctuation">,</span>
		<span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>
		data<span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre> 
<p>二次封装后我们只需要引入getInfor方法，就可以实现网络请求。</p> 
<h3><a id="_258"></a>如何封装</h3> 
<h4><a id="_259"></a>第一次封装</h4> 
<pre><code class="prism language-javascript"><span class="token comment">//http.js</span>
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">"axios"</span><span class="token punctuation">;</span>

    <span class="token comment">// 1. 创建axios实例</span>
    <span class="token keyword">const</span> instance <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">baseURL</span><span class="token operator">:</span> <span class="token string">"http://jsonplaceholder.typicode.com"</span><span class="token punctuation">,</span><span class="token comment">//请求的域名  url = baseURL + requestUrl</span>
      <span class="token literal-property property">timeout</span><span class="token operator">:</span> <span class="token number">5000</span><span class="token punctuation">,</span><span class="token comment">// 请求超时时间</span>
      <span class="token comment">// headers: { //设置请求头</span>
      <span class="token comment">//   "Content-Type": "application/x-www-form-urlencoded;charset=utf-8",</span>
      <span class="token comment">// },</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// ​2. axios拦截器的使用</span>
    <span class="token comment">/** 需要拦截请求的原因
     *   1.config中包含了某些不符合服务器要求的信息
     *   2.发送网络请求的时候需要向用户展示一些加载中的图标
     *   3.网站需要登录才能请求资源，也就是需要token才能请求资源
     */</span>

    <span class="token comment">// 2.1 添加请求拦截器</span>
    <span class="token comment">// 添加公共请求头、处理请求参数等</span>
    instance<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
      <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 在发送请求之前做些什么</span>

        <span class="token keyword">const</span> token <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>token<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			config<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>Authorization <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Bearer </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>token<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

        
        <span class="token keyword">return</span> config<span class="token punctuation">;</span> <span class="token comment">//拦截器里一定要记得将拦截的结果处理后返回，否则无法进行数据获取</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 对请求错误做些什么</span>


        <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 在请求错误的时候的逻辑处理</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    
    <span class="token comment">// 2.2 添加响应拦截器</span>
    <span class="token comment">// 修改响应信息，比如数据转换、错误处理等</span>
    instance<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
      <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 在请求成功后对响应数据做处理</span>
        <span class="token comment">// console.log(res.data);</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">return</span> res<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> 
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 对响应错误做些什么</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>response<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">switch</span> <span class="token punctuation">(</span>err<span class="token punctuation">.</span>response<span class="token punctuation">.</span>status<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">case</span> <span class="token number">400</span><span class="token operator">:</span>
                <span class="token comment">// 处理错误信息，例如抛出错误信息提示，或者跳转页面等处理方式。</span>
                  err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">"错误请求"</span><span class="token punctuation">;</span>
                  <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token number">401</span><span class="token operator">:</span>
                  err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">"未授权，请重新登录"</span><span class="token punctuation">;</span>
                  <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token number">403</span><span class="token operator">:</span>
                  err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">"拒绝访问"</span><span class="token punctuation">;</span>
                  <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token number">404</span><span class="token operator">:</span>
                  err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">"请求错误,未找到该资源!!!!"</span><span class="token punctuation">;</span>
                  <span class="token function">alert</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
                  <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token number">405</span><span class="token operator">:</span>
                  err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">"请求方法未允许"</span><span class="token punctuation">;</span>
                  <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token number">408</span><span class="token operator">:</span>
                  err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">"请求超时"</span><span class="token punctuation">;</span>
                  <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token number">500</span><span class="token operator">:</span>
                  err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">"服务器端出错"</span><span class="token punctuation">;</span>
                  <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token number">501</span><span class="token operator">:</span>
                  err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">"网络未实现"</span><span class="token punctuation">;</span>
                  <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token number">502</span><span class="token operator">:</span>
                  err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">"网络错误"</span><span class="token punctuation">;</span>
                  <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token number">503</span><span class="token operator">:</span>
                  err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">"服务不可用"</span><span class="token punctuation">;</span>
                  <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token number">504</span><span class="token operator">:</span>
                  err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">"网络超时"</span><span class="token punctuation">;</span>
                  <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token number">505</span><span class="token operator">:</span>
                  err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">"http版本不支持该请求"</span><span class="token punctuation">;</span>
                  <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">default</span><span class="token operator">:</span>
                  err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">连接错误</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>err<span class="token punctuation">.</span>response<span class="token punctuation">.</span>status<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      
        
        <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 在响应错误的时候的逻辑处理</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>



<span class="token keyword">export</span> <span class="token keyword">default</span> instance<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_370"></a>第二次封装</h4> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> http <span class="token keyword">from</span> <span class="token string">'./http'</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getInfor</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token function">http</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">method</span><span class="token operator">:</span><span class="token string">'get'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">'/posts'</span><span class="token punctuation">,</span> 
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>     

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getInforDetail</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> <span class="token function">http</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
              <span class="token literal-property property">method</span><span class="token operator">:</span><span class="token string">'get'</span><span class="token punctuation">,</span>
              <span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">'/posts'</span><span class="token punctuation">,</span> 
              params
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  
  
  
</code></pre> 
<h4><a id="_393"></a>使用</h4> 
<pre><code class="prism language-javascript">
<span class="token operator">&lt;</span>script lang<span class="token operator">=</span><span class="token string">"ts"</span> name<span class="token operator">=</span><span class="token string">""</span> setup<span class="token operator">&gt;</span>
	<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span><span class="token punctuation">;</span>
	<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>getInfor<span class="token punctuation">,</span>getInforDetail<span class="token punctuation">,</span>postInfor <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./axios/request'</span>
	
	<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  
	    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getInfor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 等待Promise解析  </span>
	    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
	    <span class="token keyword">const</span> response1 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getInforDetail</span><span class="token punctuation">(</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 等待Promise解析  </span>
	    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response1<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>  
   <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5ae8266ed6847b936162eaa41c39948f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">18个AI变现案例分享，每一个都可以作为副业赚睡后收入！</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e82288ec6a47dbfa973052823fc16355/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【数据结构】——（二叉树）堆</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>