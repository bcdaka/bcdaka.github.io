<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Linux中防火墙实战之Web服务器和ssh远程服务配置指南 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/0606d89edbc044a1dd982a9a8236b500/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Linux中防火墙实战之Web服务器和ssh远程服务配置指南">
  <meta property="og:description" content="🏡作者主页：点击！ 🐧Linux基础知识(初学)：点击！
🐧Linux高级管理防护和群集专栏：点击！
🔐Linux中firewalld防火墙：点击！
⏰️创作时间：2024年8月1日8点15分
在当今数字化时代，网络安全显得尤为重要。Linux作为一种开源操作系统，广泛应用于服务器管理和网络配置中。本篇文章将详细介绍如何配置Linux防火墙和Web服务器，确保内网与外网的安全访问。同时，我们将探讨如何通过SSH远程管理服务器，提升网络管理的灵活性和安全性。
实验环境 四台服务器
一台作为防火墙 （ens33,ens36,ens37）
一台模拟外网 (ens37)
一台web服务器 (ens36)
一台作为内网PC 访问测试(NAT模式)
实验要求
内网PC能过访问Web服务器 ICMP中不能ping Web服务器
内网PC通过SSH的1234端口来远程Web服务器
外网通过SSH的1234端口来远程防火墙
网络环境配置 防火墙网卡配置
cd /etc/sysconfig/network-scripts/ cp -p ifcfg-ens33 ifcfg-ens36 cp -p ifcfg-ens33 ifcfg-ens37 ens36网卡
ens37网卡
ens33是nat模式 这个不用介绍 你设置DHCP 或者静态都可以
查看一下ip 把内网网关指向他就行
web服务器网卡
vim /etc/sysconfig/network-scripts/ifcfg-ens33 外网网卡配置
vim /etc/sysconfig/network-scripts/ifcfg-ens33 内网PC测试网卡
vim /etc/sysconfig/network-scripts/ifcfg-ens33 防火墙
开启路由转发
vim /etc/sysctl.conf sysctl -p 刷新 net.ipv4.ip_forward = 1 测连通性 配置完成之后检测连通性
可以发现防火墙都是可以访问通的
web服务器配置 配置完成网络环境之后
开启防火墙
在web上下载httpd
yum install -y httpd echo testsmqnz &gt; /var/www/html/index.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-01T08:44:10+08:00">
    <meta property="article:modified_time" content="2024-08-01T08:44:10+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Linux中防火墙实战之Web服务器和ssh远程服务配置指南</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="text-align:center;"> <img alt="" height="80" src="https://images2.imgbox.com/0d/6a/Mfg4Js7j_o.gif" width="640"></p> 
<p style="text-align:center;"><strong>🏡作者主页：<strong><strong><strong><strong><strong><strong><strong><a href="https://blog.csdn.net/jxjdhdnd?type=blog" title="点击！">点击！</a></strong></strong></strong></strong></strong></strong></strong> </strong></p> 
<p style="text-align:center;"><strong>🐧Linux基础知识(初学)：<strong><a href="https://blog.csdn.net/jxjdhdnd/category_12527411.html?csdn_share_tail=%7B%22type%22%3A%22blog%22%2C%22rType%22%3A%22column%22%2C%22rId%22%3A%2212527411%22%2C%22source%22%3A%22jxjdhdnd%22%7D&amp;fromshare=blogcolumn" title="点击！">点击！</a></strong></strong></p> 
<p style="text-align:center;"><strong>🐧Linux高级管理防护和群集专栏：<strong><strong><strong><strong><strong><strong><strong><a href="https://blog.csdn.net/jxjdhdnd/category_12688607.html" title="点击！">点击！</a></strong></strong></strong></strong></strong></strong></strong></strong></p> 
<p style="text-align:center;"><strong>🔐Linux中firewalld防火墙：<strong><strong><strong><a href="https://blog.csdn.net/jxjdhdnd/category_12719323.html?csdn_share_tail=%7B%22type%22%3A%22blog%22%2C%22rType%22%3A%22column%22%2C%22rId%22%3A%2212719323%22%2C%22source%22%3A%22jxjdhdnd%22%7D&amp;fromshare=blogcolumn" title="点击！">点击！</a></strong></strong></strong></strong></p> 
<p style="text-align:center;"><strong>⏰️创作时间：2024年8月1日8点15分</strong></p> 
<p style="text-align:center;"><img alt="" height="80" src="https://images2.imgbox.com/7a/f8/Lj3wvdmK_o.gif" width="640"></p> 
<hr> 
<p></p> 
<p>在当今数字化时代，网络安全显得尤为重要。Linux作为一种开源操作系统，广泛应用于服务器管理和网络配置中。本篇文章将详细介绍如何配置Linux防火墙和Web服务器，确保内网与外网的安全访问。同时，我们将探讨如何通过SSH远程管理服务器，提升网络管理的灵活性和安全性。</p> 
<p></p> 
<h2 style="background-color:transparent;">实验环境<img alt="" height="416" src="https://images2.imgbox.com/70/1d/AenZQPXn_o.png" width="751"></h2> 
<p>四台服务器</p> 
<p>一台作为防火墙 （ens33,ens36,ens37）</p> 
<p>一台模拟外网 (ens37)</p> 
<p>一台web服务器 (ens36)</p> 
<p>一台作为内网PC 访问测试(NAT模式)</p> 
<p><strong>实验要求</strong></p> 
<p><strong>内网PC能过访问Web服务器 ICMP中不能ping Web服务器</strong></p> 
<p><strong>内网PC通过SSH的1234端口来远程Web服务器</strong></p> 
<p><strong>外网通过SSH的1234端口来远程防火墙</strong></p> 
<p></p> 
<h2 id="header-e660-3304" style="background-color:transparent;">网络环境配置</h2> 
<p>防火墙网卡配置</p> 
<p><img alt="" height="363" src="https://images2.imgbox.com/c3/80/Y60i18CT_o.png" width="513"></p> 
<pre><code>cd /etc/sysconfig/network-scripts/
cp -p ifcfg-ens33 ifcfg-ens36
cp -p ifcfg-ens33 ifcfg-ens37</code></pre> 
<p>ens36网卡</p> 
<p><img alt="" height="304" src="https://images2.imgbox.com/bc/28/x1t9yytA_o.png" width="523"></p> 
<p>ens37网卡</p> 
<p><img alt="" height="291" src="https://images2.imgbox.com/43/ba/qJnVVmyN_o.png" width="499"></p> 
<p>ens33是nat模式 这个不用介绍 你设置DHCP 或者静态都可以</p> 
<p>查看一下ip 把内网网关指向他就行</p> 
<p></p> 
<p>web服务器网卡</p> 
<p><img alt="" height="335" src="https://images2.imgbox.com/77/bf/3iy3GkH0_o.png" width="507"></p> 
<pre><code>vim /etc/sysconfig/network-scripts/ifcfg-ens33</code></pre> 
<p><img alt="" height="243" src="https://images2.imgbox.com/e9/25/ZEDCaPd1_o.png" width="494"></p> 
<p></p> 
<p>外网网卡配置</p> 
<p><img alt="" height="315" src="https://images2.imgbox.com/45/3f/rrLxBBKT_o.png" width="499"></p> 
<pre><code>vim /etc/sysconfig/network-scripts/ifcfg-ens33</code></pre> 
<p><img alt="" height="256" src="https://images2.imgbox.com/43/a6/bcFcYW1O_o.png" width="404"></p> 
<p></p> 
<p></p> 
<p>内网PC测试网卡</p> 
<p><img alt="" height="316" src="https://images2.imgbox.com/2e/9f/mUGyswH1_o.png" width="500"></p> 
<pre><code>vim /etc/sysconfig/network-scripts/ifcfg-ens33</code></pre> 
<p><img alt="" height="397" src="https://images2.imgbox.com/ff/04/bitjWgbV_o.png" width="724"></p> 
<p><img alt="" height="396" src="https://images2.imgbox.com/e8/b7/D9OwSFZn_o.png" width="750"></p> 
<p></p> 
<p></p> 
<pre></pre> 
<p></p> 
<p></p> 
<p>防火墙</p> 
<p>开启路由转发</p> 
<pre><code>vim /etc/sysctl.conf
sysctl -p  刷新
net.ipv4.ip_forward = 1</code></pre> 
<p><img alt="" height="315" src="https://images2.imgbox.com/f5/9c/GF1RqWRv_o.png" width="838"></p> 
<p></p> 
<p></p> 
<h4 id="header-0574-6254" style="background-color:transparent;">测连通性</h4> 
<p>配置完成之后检测连通性</p> 
<p><img alt="" height="427" src="https://images2.imgbox.com/1d/50/RYyMz9ig_o.png" width="759"><img alt="" height="219" src="https://images2.imgbox.com/af/1b/02hKzQCm_o.png" width="993"></p> 
<p>可以发现防火墙都是可以访问通的</p> 
<p></p> 
<p></p> 
<p></p> 
<h2 id="header-ff9f-bed8" style="background-color:transparent;">web服务器配置</h2> 
<p></p> 
<p>配置完成网络环境之后</p> 
<p><strong>开启防火墙</strong></p> 
<p>在web上下载httpd</p> 
<pre><code>yum install -y httpd 
echo testsmqnz &gt; /var/www/html/index.html
curl 127.0.0.1
testsmqnz</code></pre> 
<p></p> 
<p></p> 
<pre><code>配置dmz区域

firewall-cmd --zone=dmz --change-interface=ens33
firewall-cmd --zone=dmz --add-port=80/tcp --permanent
firewall-cmd --zone=dmz --add-port=443/tcp  --permanent
​
重载防火墙
firewall-cmd --reload</code></pre> 
<p>配置完成之后内网和防火墙都可以访问了</p> 
<p></p> 
<p>内网PC访问测试</p> 
<p>配置完成之后内网和防火墙都可以访问了</p> 
<p><img alt="" height="333" src="https://images2.imgbox.com/6d/2f/heExbo9G_o.png" width="766"></p> 
<p></p> 
<p><strong>防火墙配置</strong></p> 
<pre><code class="hljs">firewall-config
双击ens33
点击永久
trusted
ens36
dmz
ens37
external</code></pre> 
<p><img alt="" height="589" src="https://images2.imgbox.com/50/d7/ewglwmtn_o.png" width="608"></p> 
<p></p> 
<p>点击trusted勾上httpd https</p> 
<p><img alt="" height="708" src="https://images2.imgbox.com/0e/b5/BQPmEjdP_o.png" width="908"></p> 
<p>重新载入</p> 
<p></p> 
<p></p> 
<p>PC内网访问Web服务器</p> 
<p><img alt="" height="429" src="https://images2.imgbox.com/5e/d7/gRuWNlmx_o.png" width="892"></p> 
<p></p> 
<p>内网是可以ping Web服务器的 现在我们需要设置不可以pingWeb</p> 
<p><img alt="" height="329" src="https://images2.imgbox.com/af/de/JGQtmrQL_o.png" width="992"></p> 
<p>在Web服务器上配置</p> 
<pre><code>firewall-cmd --zone=dmz --add-icmp-block=echo-request --permanent
firewall-cmd --reload</code></pre> 
<p></p> 
<p>内网PC测试</p> 
<p><img alt="" height="450" src="https://images2.imgbox.com/cd/1a/fMJsK7LJ_o.png" width="974"></p> 
<p></p> 
<p></p> 
<p></p> 
<h2 id="header-f2a7-f054" style="background-color:transparent;">测试SSH</h2> 
<p>修改ssh的端口号为12345 内网远程web服务器</p> 
<p>首先在web上关闭ssh</p> 
<pre><code>​
firewall-cmd --zone=dmz --remove-service=ssh --permanent
firewall-cmd --reload
查看规则
firewall-cmd --list-all -zone=dmz

​</code></pre> 
<p><img alt="" height="696" src="https://images2.imgbox.com/de/82/Gb3Xlm0G_o.png" width="940"></p> 
<p></p> 
<p></p> 
<p></p> 
<h2 id="header-8178-5180" style="background-color:transparent;">修改SSH的端口号</h2> 
<p>首先关闭Selinux</p> 
<pre><code class="hljs">vim /etc/ssh/sshd_conf
Port 12345</code></pre> 
<p><img alt="" height="134" src="https://images2.imgbox.com/9e/47/j3ZD5QPA_o.png" width="319"></p> 
<pre>重启服务
</pre> 
<pre><code>systemctl restart sshd
查看服务端口号
netstat -nultp | grep sshd</code></pre> 
<p><img alt="" height="164" src="https://images2.imgbox.com/a0/a9/WINmAlRw_o.png" width="1001"></p> 
<p>添加端口</p> 
<p>ssh从12345端口访问</p> 
<pre><code>firewall-cmd --zone=dmz --add-port=12345/tcp --permanent
firewall-cmd --reload</code></pre> 
<p></p> 
<p>内网PC测试</p> 
<pre><code>ssh root@172.16.0.2 -p 12345</code></pre> 
<p></p> 
<p></p> 
<h2 id="header-65ba-483e" style="background-color:transparent;">外网远程防火墙</h2> 
<p>如何让外网访问防火墙的SSH12345端口呢？</p> 
<p></p> 
<p>如何让外网SSH防火墙呢？</p> 
<p>防火墙配置</p> 
<pre><code class="hljs">vim /etc/ssh/sshd_confg
找到port 改为 Port 12345
systemctl restart sshd</code></pre> 
<pre>​
检测端口是否成功
</pre> 
<pre><code class="hljs">[root@localhost ~]# systemctl restart sshd
[root@localhost ~]# netstat -nultp | grep sshd
tcp        0      0 0.0.0.0:12345           0.0.0.0:*               LISTEN      39693/sshd          
tcp6       0      0 :::12345                :::*                    LISTEN      39693/sshd          </code></pre> 
<p></p> 
<p></p> 
<p><img alt="" height="531" src="https://images2.imgbox.com/0b/a0/9EWNmWhD_o.png" width="980"></p> 
<p>添加访问端口</p> 
<p><img alt="" height="559" src="https://images2.imgbox.com/72/a3/ncZ1rKLa_o.png" width="928"></p> 
<p></p> 
<p>外网访问测试</p> 
<pre><code class="hljs">ssh root@100.0.0.1 -p 12345</code></pre> 
<p><img alt="" height="197" src="https://images2.imgbox.com/49/3d/HGM6qH9W_o.png" width="1003"></p> 
<p></p> 
<p></p> 
<h2 style="background-color:transparent;">总结</h2> 
<p>通过本篇文章的学习，我们不仅掌握了Linux防火墙和Web服务器的基本配置，还了解了如何实现安全的网络访问。防火墙的合理设置和SSH的安全管理是保障网络安全的关键。希望读者能够将这些知识应用到实际工作中，为构建安全的网络环境贡献力量。</p> 
<p></p> 
<blockquote> 
 <p>成功的路上没有捷径，只有不断的努力与坚持。如果你和我一样，坚信努力会带来回报，请关注我，点个赞，一起迎接更加美好的明天！你的支持是我继续前行的动力！"</p> 
 <p>"每一次创作都是一次学习的过程，文章中若有不足之处，还请大家多多包容。你的关注和点赞是对我最大的支持，也欢迎大家提出宝贵的意见和建议，让我不断进步。"</p> 
 <p></p> 
 <p style="text-align:center;"><strong>神秘泣男子</strong></p> 
 <p style="text-align:center;"><img alt="" height="331" src="https://images2.imgbox.com/cf/0a/vHTHfgce_o.jpg" width="340"></p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/cc3c9354421860c2c1a0277bb97205ad/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Flink-StarRocks详解:第二部分(第52天)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a123b046905654bb56b458dc79c06ab3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java语言程序设计——篇十一（1）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>