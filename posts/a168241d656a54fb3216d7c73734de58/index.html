<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>前端HTML转word文档，绝对有效！！！ - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/a168241d656a54fb3216d7c73734de58/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="前端HTML转word文档，绝对有效！！！">
  <meta property="og:description" content="2024.4.19 更新日志：有小伙伴私信我element-ui等ui插件等复杂样式无法转换生成，考虑到
html-docx-js本身不支持大多c3样式及标签，先提供解决方法将dom转成图片插入文档中，只需要用标签盒子 包裹住 你需要生成的dom模块，给标签盒子添加类目标识，配置项中传入 drawCanvas:[&#39; .btn&#39; ] ，就可以生成 具体效果图结尾有。
2024.3.11 更新日志 ：允许使用class标签在html模版中使用 此前只支持行内标签修改样式 过于繁琐与不便 ，配置项中加入 className: &#34;xxx&#34;, 当前模版的class类明即可识别使用
公司有业务需求 需要将前端页面一键导出word模版
后来找了半天只找到一个16年的插件html-docx-js（膜拜大神，但是已经无人维护了） ，使用后踩了许多坑，因为js版本兼容问题，运行都报错使用了with() 先版本不兼容，使用也比较繁琐，
最无法容忍的是如果是使用的在线图片还有跨域问题导致图片无法导出！！！
所以直接做了些优化处理 主要是对超时 错误图片处理 可以传入导出图片超时时间等等系列问题坑！！！已封装成傻瓜式一键导出插件，小伙伴可以放心食用，目前已投入公司项目中使用。
xh-htmlword
使用方法 npm install xh-htmlword
&lt;template&gt; &lt;div class=&#34;export-box&#34; style=&#34;width: 565pt&#34;&gt; &lt;div id=&#34;main1&#34;&gt;&lt;/div&gt; &lt;p style=&#34;text-align: center&#34;&gt; &lt;span style=&#34; font-family: 宋体; font-weight: bold; color: rgb(0, 0, 0); min-height: 16pt; font-size: 16pt; &#34; &gt;深水汴北配套管网运维日报表&lt;/span &gt; &lt;/p&gt; &lt;table style=&#34;width: 565pt; border-collapse: collapse; border: 1px solid #dddddd&#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-11T10:40:25+08:00">
    <meta property="article:modified_time" content="2024-06-11T10:40:25+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">前端HTML转word文档，绝对有效！！！</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>2024.4.19 更新日志：有小伙伴私信我element-ui等ui插件等复杂样式无法转换生成，考虑到</p> 
<p>html-docx-js本身不支持大多c3样式及标签，先提供解决方法将dom转成图片插入文档中，只需要用标签盒子 包裹住 你需要生成的dom模块，给标签盒子添加类目标识，配置项中传入 drawCanvas:[' .btn' ] ，就可以生成 具体效果图结尾有。</p> 
<hr> 
<p>2024.3.11 更新日志 ：允许使用class标签在html模版中使用 此前只支持行内标签修改样式 过于繁琐与不便 ，配置项中加入 className: "xxx", 当前模版的class类明即可识别使用</p> 
<p></p> 
<hr> 
<p>公司有业务需求 需要将前端页面一键导出word模版</p> 
<p>后来找了半天只找到一个16年的插件html-docx-js（膜拜大神，但是已经无人维护了） ，使用后踩了许多坑，因为js版本兼容问题，运行都报错使用了with() 先版本不兼容，使用也比较繁琐，</p> 
<p>最无法容忍的是如果是使用的在线图片还有跨域问题导致图片无法导出！！！</p> 
<p>所以直接做了些优化处理 主要是对超时 错误图片处理 可以传入导出图片超时时间等等系列问题坑！！！已封装成傻瓜式一键导出插件，小伙伴可以放心食用，目前已投入公司项目中使用。</p> 
<p><a class="link-info" href="https://www.npmjs.com/package/xh-htmlword" rel="nofollow" title="xh-htmlword">xh-htmlword</a></p> 
<h3>使用方法</h3> 
<blockquote> 
 <p>npm install xh-htmlword</p> 
</blockquote> 
<pre><code class="language-javascript">&lt;template&gt;
  &lt;div class="export-box" style="width: 565pt"&gt;
    &lt;div id="main1"&gt;&lt;/div&gt;
    &lt;p style="text-align: center"&gt;
      &lt;span
        style="
          font-family: 宋体;
          font-weight: bold;
          color: rgb(0, 0, 0);
          min-height: 16pt;
          font-size: 16pt;
        "
        &gt;深水汴北配套管网运维日报表&lt;/span
      &gt;
    &lt;/p&gt;
    &lt;table
      style="width: 565pt; border-collapse: collapse; border: 1px solid #dddddd"
    &gt;
      &lt;colgroup&gt;
        &lt;col style="width: 89.65pt" /&gt;
        &lt;col style="width: 44.05pt" /&gt;
        &lt;col style="width: 121.5pt" /&gt;
        &lt;col style="width: 103.85pt" /&gt;
        &lt;col style="width: 73.3pt" /&gt;
        &lt;col style="width: 106.3pt" /&gt;
      &lt;/colgroup&gt;
      &lt;!-- 头部 --&gt;
      &lt;tr
        v-for="(item, index) in data.head"
        :key="index"
        style="border: 1px solid #cccccc; height: 25.5pt"
      &gt;
        &lt;td
          v-for="(item2, index) in item"
          :key="index"
          style="padding-left: 5.4pt; border: 1px solid #cccccc"
          :style="{ width: item2.width }"
          :colspan="index % 2 == 0 ? 2 : 1"
        &gt;
          &lt;span
            style="
              font-weight: bold;
              color: #595959;
              font-size: 9pt;
              margin-right: 3pt;
            "
          &gt;
            {<!-- -->{ item2.title }}&lt;/span
          &gt;
          &lt;span style="color: #595959; font-size: 9pt"&gt;
            {<!-- -->{ item2.label }}
          &lt;/span&gt;
        &lt;/td&gt;
      &lt;/tr&gt;
      &lt;!-- 到岗人员 --&gt;
      &lt;tr style="border: 1px solid #cccccc; height: 25.5pt"&gt;
        &lt;td colspan="6" style="padding-left: 5.4pt; border: 1px solid #cccccc"&gt;
          &lt;span
            style="
              font-weight: bold;
              color: #595959;
              font-size: 9pt;
              margin-right: 3pt;
            "
          &gt;
            到岗人员：&lt;/span
          &gt;
 
          &lt;span
            v-for="(item, index) in data.personnel"
            :key="index"
            style="color: #595959; font-size: 9pt"
          &gt;
            &lt;span v-if="index !== 0"&gt; &amp;nbsp;&lt;/span&gt;
            &lt;span&gt;{<!-- -->{ item.title }}&lt;/span&gt;
            &lt;span&gt;
              {<!-- -->{ item.label }}
            &lt;/span&gt;
          &lt;/span&gt;
        &lt;/td&gt;
      &lt;/tr&gt;
      &lt;!-- 标准化执行情况 --&gt;
      &lt;tr style="border: 1px solid #cccccc; height: 25.5pt"&gt;
        &lt;td colspan="6" style="padding-left: 5.4pt; border: 1px solid #cccccc"&gt;
          &lt;span
            style="
              font-weight: bold;
              color: #595959;
              font-size: 9pt;
              margin-right: 3pt;
            "
          &gt;
            标准化执行情况：&lt;/span
          &gt;
          &lt;span
            v-for="(item, index) in executionList"
            :key="index"
            style="color: #595959; font-size: 9pt"
          &gt;
            &lt;span v-if="index !== 0"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;
            &lt;span&gt;{<!-- -->{ data.execution == index ? "√" : "□" }}&lt;/span&gt;
            &lt;span&gt;
              {<!-- -->{ item }}
            &lt;/span&gt;
          &lt;/span&gt;
        &lt;/td&gt;
      &lt;/tr&gt;
      &lt;!-- 巡检记录 --&gt;
      &lt;tr style="border: 1px solid #cccccc; height: 36pt"&gt;
        &lt;td
          colspan="6"
          style="
            text-align: center;
            border: 1px solid #cccccc;
            background-color: #f1f1f1;
            color: rgb(89, 89, 89);
            font-size: 14pt;
            letter-spacing: 1pt;
          "
        &gt;
          巡检记录
        &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td
          colspan="6"
          style="
            text-align: center;
            border: 1px solid #cccccc;
            background-color: #f1f1f1;
            color: rgb(89, 89, 89);
            font-size: 14pt;
            letter-spacing: 1pt;
          "
        &gt;
          &lt;img
            src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimage109.360doc.com%2FDownloadImg%2F2021%2F04%2F0713%2F219519055_1_20210407012803425&amp;refer=http%3A%2F%2Fimage109.360doc.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=auto?sec=1716081866&amp;t=af941e4f60f743e1081f7cda8fcfb299"
            width="565pt"
            height="200pt"
          /&gt;
        &lt;/td&gt;
      &lt;/tr&gt;
    &lt;/table&gt;
 
    &lt;div class="btn"&gt;
      &lt;el-progress :percentage="50" /&gt;
      &lt;el-progress :percentage="100" :format="format" /&gt;
      &lt;el-progress :percentage="100" status="success" /&gt;
      &lt;el-progress :percentage="100" status="warning" /&gt;
      &lt;el-progress :percentage="50" status="exception" /&gt;
 
      &lt;el-steps style="max-width: 600px" :active="0" finish-status="success"&gt;
        &lt;el-step title="Step 1" /&gt;
        &lt;el-step title="Step 2" /&gt;
        &lt;el-step title="Step 3" /&gt;
      &lt;/el-steps&gt;
    &lt;/div&gt;
  &lt;/div&gt;
 
  &lt;button @click="handleExport"&gt;导出&lt;/button&gt;
&lt;/template&gt;
 
&lt;script setup&gt;
import { onMounted, nextTick } from "vue";
import handleExportWord from "xh-htmlword";
 
// 标准化执行情况
const executionList = ["优秀", "良好", "中等", "差"];
 
// 巡检记录
const data = {
  head: [
    [
      { title: "作业日期：", label: "2024年01月25日", width: "150pt" },
      { title: "填表人：", label: "吴宇、白阳", width: "110pt" },
      {
        title: "运维单位：",
        label: "安徽中益达管道疏通有限公司",
        width: "200pt",
      },
      { title: "天气：", label: "多云（24°C）", width: "120pt" },
    ],
    [
      {
        title: "现场负责人：",
        label: "吴宇",
        width: "150pt",
      },
      {
        title: "手机号码：",
        label: "13112345678",
        width: "110pt",
      },
      {
        title: "项目负责人：",
        label: "吴宇",
        width: "205pt",
      },
      {
        title: "手机号码：",
        label: "13198765432",
        width: "120pt",
      },
    ],
  ],
  personnel: [
    {
      title: "安全员:",
      label: "1人",
    },
    {
      title: "监护人员:",
      label: "1人",
    },
    {
      title: "施工人员:",
      label: "3人",
    },
    {
      title: "巡查人员:",
      label: "2人",
    },
    {
      title: "潜水员:",
      label: "1人",
    },
    {
      title: "有限空间作业人员:",
      label: "1人",
    },
  ],
  execution: 1,
};
 
const handleExport = () =&gt; {
  // dom：需要渲染的html父盒子标签 ， 类型：string 例如 id/class
  //  fileName：文件名称 类型：string
  //  timeOut:设置导出图片加载 超时时间 默认值 5000  (5s)
  //  callBack：导出成功回调函数
  //  options:配置项  类型：object 例如可传 {left:1440,right:1440} 控制页边距
  //  defultImg: 错误或者超时图片 默认图片地址 类型：string
  //  className:当前组件的class属性名标识 类型：string  配置此项后可以在标签写入class样式
  //  drawCanvas:当当前页面有比较复杂的样式或组件（element-ui等） 页面中可以用样式标签将它包裹起来然后将标签 传入drawCanvas数组中 开启转换
  handleExportWord({
    dom: ".export-box",
    fileName: "托尔斯泰222",
    drawCanvas: [".btn"],
  });
};
&lt;/script&gt;</code></pre> 
<p>导出效果如下:</p> 
<p></p> 
<p style="text-align:center;"><img alt="" height="1016" src="https://images2.imgbox.com/b7/e2/Oqu7W4LJ_o.png" width="1109"></p> 
<p style="text-align:center;">可以看到了element UI的组件也一起导出在最下方，项目是采用的vue3+vite，实际中vue2我试了也是没问题的，插件注意事项和使用方法可以去<a href="https://www.npmjs.com/package/xh-htmlword" rel="nofollow" title="xh-htmlword">xh-htmlword</a>查看，如果有使用疑惑或问题可以加我QQ:1031945252 交流联系，共同进步</p> 
<p>注意：如果是使用的vue2版本，报了以下错误：</p> 
<p><img alt="" height="199" src="https://images2.imgbox.com/0b/cd/lj4HKrL9_o.png" width="1200"></p> 
<p>一定要在vue.config.js中加上配置项：</p> 
<p><img alt="" height="237" src="https://images2.imgbox.com/54/45/vxRAmrIX_o.png" width="801"></p> 
<p>会转译node_modules中的包，解决报错！</p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/714e8dc821afc64a1695c5d2e3d46e42/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C&#43;&#43;第二十六弹---stack和queue的基本操作详解与模拟实现</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e666878e73e2c567b0d5642ebd07c755/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">AI绘画ComfyUI-插件-面部修复，快速入门安装使用！</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>