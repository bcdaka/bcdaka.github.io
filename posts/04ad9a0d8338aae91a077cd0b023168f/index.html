<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Mysql中(基于GTID方式)实现主从复制,单主复制详细教程 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/04ad9a0d8338aae91a077cd0b023168f/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Mysql中(基于GTID方式)实现主从复制,单主复制详细教程">
  <meta property="og:description" content="🏡作者主页：点击！ 🐧Linux基础知识(初学)：点击！
🐧Linux高级管理防护和群集专栏：点击！
🔐Linux中firewalld防火墙：点击！
⏰️创作时间：2024年7月24日16点28分
🀄️文章质量：93分
目录
1. 单主复制
1.1 主服务器配置
修改MySQL配置文件
重启MySQL服务
1.2 创建具有复制权限的用户
1.3 从服务器配置
修改MySQL配置文件
重启MySQL服务
1.4 配置从服务器的复制
1.5 启动从服务
1.6 查看从服务器状态
测试主从复制
在主服务器上测试
在从服务器上验证
总结
在分布式数据库系统中，主从复制是实现高可用性和数据冗余的重要手段。基于GTID（Global Transaction Identifier）的复制模式可以提供更强的复制一致性和简化故障转移过程。本文将详细介绍如何配置单主复制的GTID模式，以便在MySQL数据库中实现稳定可靠的数据复制。
1. 单主复制 1.1 主服务器配置 首先，我们需要配置主服务器的MySQL，使其支持GTID模式。
修改MySQL配置文件 使用以下命令编辑MySQL配置文件：
vim /etc/my.cnf 在配置文件中添加以下内容：
server-id = 100 log_bin = mysql-bin gtid_mode = ON enforce_gtid_consistency = true 这些配置选项的作用如下：
server-id: 唯一标识MySQL实例的ID。log_bin: 启用二进制日志记录。gtid_mode: 开启GTID模式。enforce_gtid_consistency: 强制GTID一致性，确保每个事务都有一个唯一的GTID。 重启MySQL服务 应用配置更改后，需要重启MySQL服务：
systemctl restart mysqld 1.2 创建具有复制权限的用户 接下来，在主服务器上创建一个专门用于复制的用户，并授予其相应的权限：
grant replication slave on *.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-24T16:29:08+08:00">
    <meta property="article:modified_time" content="2024-07-24T16:29:08+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Mysql中(基于GTID方式)实现主从复制,单主复制详细教程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="text-align:center;"><img alt="" height="80" src="https://images2.imgbox.com/b6/c3/ibF1MakI_o.gif" width="640"></p> 
<p style="text-align:center;"><strong>🏡作者主页：<strong><strong><strong><strong><strong><strong><strong><a href="https://blog.csdn.net/jxjdhdnd?type=blog" title="点击！">点击！</a></strong></strong></strong></strong></strong></strong></strong> </strong></p> 
<p style="text-align:center;"><strong>🐧Linux基础知识(初学)：<strong><a href="https://blog.csdn.net/jxjdhdnd/category_12527411.html?csdn_share_tail=%7B%22type%22%3A%22blog%22%2C%22rType%22%3A%22column%22%2C%22rId%22%3A%2212527411%22%2C%22source%22%3A%22jxjdhdnd%22%7D&amp;fromshare=blogcolumn" title="点击！">点击！</a></strong></strong></p> 
<p style="text-align:center;"><strong>🐧Linux高级管理防护和群集专栏：<strong><strong><strong><strong><strong><strong><strong><a href="https://blog.csdn.net/jxjdhdnd/category_12688607.html" title="点击！">点击！</a></strong></strong></strong></strong></strong></strong></strong></strong></p> 
<p style="text-align:center;"><strong>🔐Linux中firewalld防火墙：<strong><strong><strong><a href="https://blog.csdn.net/jxjdhdnd/category_12719323.html?csdn_share_tail=%7B%22type%22%3A%22blog%22%2C%22rType%22%3A%22column%22%2C%22rId%22%3A%2212719323%22%2C%22source%22%3A%22jxjdhdnd%22%7D&amp;fromshare=blogcolumn" title="点击！">点击！</a></strong></strong></strong></strong></p> 
<p style="text-align:center;"><strong>⏰️创作时间：2024年7月24日16点28分</strong></p> 
<p style="text-align:center;"><strong>🀄️文章质量：93分</strong></p> 
<p style="text-align:center;"><img alt="" height="80" src="https://images2.imgbox.com/a3/b3/EeQWFOcK_o.gif" width="640"></p> 
<p></p> 
<hr> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="-toc" style="margin-left:40px;"></p> 
<p id="1.%20%E5%8D%95%E4%B8%BB%E5%A4%8D%E5%88%B6-toc" style="margin-left:40px;"><a href="#1.%20%E5%8D%95%E4%B8%BB%E5%A4%8D%E5%88%B6" rel="nofollow">1. 单主复制</a></p> 
<p id="1.1%20%E4%B8%BB%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE-toc" style="margin-left:80px;"><a href="#1.1%20%E4%B8%BB%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE" rel="nofollow">1.1 主服务器配置</a></p> 
<p id="%E4%BF%AE%E6%94%B9MySQL%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-toc" style="margin-left:120px;"><a href="#%E4%BF%AE%E6%94%B9MySQL%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6" rel="nofollow">修改MySQL配置文件</a></p> 
<p id="%E9%87%8D%E5%90%AFMySQL%E6%9C%8D%E5%8A%A1-toc" style="margin-left:120px;"><a href="#%E9%87%8D%E5%90%AFMySQL%E6%9C%8D%E5%8A%A1" rel="nofollow">重启MySQL服务</a></p> 
<p id="1.2%20%E5%88%9B%E5%BB%BA%E5%85%B7%E6%9C%89%E5%A4%8D%E5%88%B6%E6%9D%83%E9%99%90%E7%9A%84%E7%94%A8%E6%88%B7-toc" style="margin-left:80px;"><a href="#1.2%20%E5%88%9B%E5%BB%BA%E5%85%B7%E6%9C%89%E5%A4%8D%E5%88%B6%E6%9D%83%E9%99%90%E7%9A%84%E7%94%A8%E6%88%B7" rel="nofollow">1.2 创建具有复制权限的用户</a></p> 
<p id="1.3%20%E4%BB%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE-toc" style="margin-left:80px;"><a href="#1.3%20%E4%BB%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE" rel="nofollow">1.3 从服务器配置</a></p> 
<p id="%E4%BF%AE%E6%94%B9MySQL%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-toc" style="margin-left:120px;"><a href="#%E4%BF%AE%E6%94%B9MySQL%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6" rel="nofollow">修改MySQL配置文件</a></p> 
<p id="%E9%87%8D%E5%90%AFMySQL%E6%9C%8D%E5%8A%A1-toc" style="margin-left:120px;"><a href="#%E9%87%8D%E5%90%AFMySQL%E6%9C%8D%E5%8A%A1" rel="nofollow">重启MySQL服务</a></p> 
<p id="1.4%20%E9%85%8D%E7%BD%AE%E4%BB%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E5%A4%8D%E5%88%B6-toc" style="margin-left:80px;"><a href="#1.4%20%E9%85%8D%E7%BD%AE%E4%BB%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E5%A4%8D%E5%88%B6" rel="nofollow">1.4 配置从服务器的复制</a></p> 
<p id="1.5%20%E5%90%AF%E5%8A%A8%E4%BB%8E%E6%9C%8D%E5%8A%A1-toc" style="margin-left:80px;"><a href="#1.5%20%E5%90%AF%E5%8A%A8%E4%BB%8E%E6%9C%8D%E5%8A%A1" rel="nofollow">1.5 启动从服务</a></p> 
<p id="1.6%20%E6%9F%A5%E7%9C%8B%E4%BB%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%8A%B6%E6%80%81-toc" style="margin-left:80px;"><a href="#1.6%20%E6%9F%A5%E7%9C%8B%E4%BB%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%8A%B6%E6%80%81" rel="nofollow">1.6 查看从服务器状态</a></p> 
<p id="%E2%80%8B%E7%BC%96%E8%BE%91-toc" style="margin-left:40px;"></p> 
<p id="%E6%B5%8B%E8%AF%95%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6-toc" style="margin-left:40px;"><a href="#%E6%B5%8B%E8%AF%95%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6" rel="nofollow">测试主从复制</a></p> 
<p id="%E5%9C%A8%E4%B8%BB%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E6%B5%8B%E8%AF%95-toc" style="margin-left:80px;"><a href="#%E5%9C%A8%E4%B8%BB%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E6%B5%8B%E8%AF%95" rel="nofollow">在主服务器上测试</a></p> 
<p id="%E5%9C%A8%E4%BB%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%AA%8C%E8%AF%81-toc" style="margin-left:80px;"><a href="#%E5%9C%A8%E4%BB%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%AA%8C%E8%AF%81" rel="nofollow">在从服务器上验证</a></p> 
<p id="%E6%80%BB%E7%BB%93-toc" style="margin-left:40px;"><a href="#%E6%80%BB%E7%BB%93" rel="nofollow">总结</a></p> 
<hr id="hr-toc"> 
<p></p> 
<p>在分布式数据库系统中，主从复制是实现高可用性和数据冗余的重要手段。<span style="color:#fe2c24;"><strong>基于GTID</strong></span>（Global Transaction Identifier）的复制模式可以提供更强的复制一致性和简化故障转移过程。<span style="color:#fe2c24;"><strong>本文将详细介绍如何配置单主复制的GTID模式</strong></span>，以便在MySQL数据库中实现稳定可靠的数据复制。</p> 
<h3></h3> 
<h3 id="1.%20%E5%8D%95%E4%B8%BB%E5%A4%8D%E5%88%B6" style="background-color:transparent;">1. 单主复制</h3> 
<h4 id="1.1%20%E4%B8%BB%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE">1.1 主服务器配置</h4> 
<p>首先，我们需要配置主服务器的MySQL，使其支持GTID模式。</p> 
<h5 id="%E4%BF%AE%E6%94%B9MySQL%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">修改MySQL配置文件</h5> 
<p>使用以下命令编辑MySQL配置文件：</p> 
<pre><code>vim /etc/my.cnf
</code></pre> 
<p>在配置文件中添加以下内容：</p> 
<pre><code>server-id = 100
log_bin = mysql-bin
gtid_mode = ON
enforce_gtid_consistency = true
</code></pre> 
<p>这些配置选项的作用如下：</p> 
<ul><li><code>server-id</code>: 唯一标识MySQL实例的ID。</li><li><code>log_bin</code>: 启用二进制日志记录。</li><li><code>gtid_mode</code>: 开启GTID模式。</li><li><code>enforce_gtid_consistency</code>: 强制GTID一致性，确保每个事务都有一个唯一的GTID。</li></ul> 
<h5 id="%E9%87%8D%E5%90%AFMySQL%E6%9C%8D%E5%8A%A1">重启MySQL服务</h5> 
<p>应用配置更改后，需要重启MySQL服务：</p> 
<pre><code>systemctl restart mysqld
</code></pre> 
<h4 id="1.2%20%E5%88%9B%E5%BB%BA%E5%85%B7%E6%9C%89%E5%A4%8D%E5%88%B6%E6%9D%83%E9%99%90%E7%9A%84%E7%94%A8%E6%88%B7">1.2 创建具有复制权限的用户</h4> 
<p>接下来，在主服务器上创建一个专门用于复制的用户，并授予其相应的权限：</p> 
<pre><code>grant replication slave on *.* to 'repluser'@'192.168.192.%' identified by 'Abc-1234';
flush privileges;
show master status\G;
</code></pre> 
<ul><li><code>grant replication slave</code>: 授予复制权限。</li><li><code>flush privileges</code>: 刷新权限，使其立即生效。</li><li><code>show master status</code>: 查看主服务器的当前状态。</li></ul> 
<p></p> 
<p class="img-center"><img alt="" height="394" src="https://images2.imgbox.com/aa/f6/6AMPjZdy_o.png" width="700"></p> 
<p></p> 
<p></p> 
<h4 id="1.3%20%E4%BB%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE">1.3 从服务器配置</h4> 
<p>在从服务器上进行类似的配置，使其能够与主服务器同步。</p> 
<h5>修改MySQL配置文件</h5> 
<p>使用以下命令编辑从服务器的MySQL配置文件：</p> 
<pre><code>vim /etc/my.cnf
</code></pre> 
<p>在配置文件中添加以下内容：</p> 
<pre><code>server-id = 110
gtid_mode = ON
enforce_gtid_consistency = true
</code></pre> 
<p>这些配置与主服务器类似，只是<code>server-id</code>需要不同于主服务器。</p> 
<h5>重启MySQL服务</h5> 
<p>应用配置更改后，重启从服务器的MySQL服务：</p> 
<pre><code>systemctl restart mysqld
</code></pre> 
<h4 id="1.4%20%E9%85%8D%E7%BD%AE%E4%BB%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E5%A4%8D%E5%88%B6">1.4 配置从服务器的复制</h4> 
<p>在从服务器上执行以下命令，配置与主服务器的复制关系：</p> 
<pre><code>mysql -uroot -pABCabc-123
</code></pre> 
<pre><code>change master to
master_host="192.168.180.50",
master_user="repluser",
master_password="ABCabc-123",
master_auto_position=1;
</code></pre> 
<p>这些命令的作用如下：</p> 
<ul><li><code>master_host</code>: 主服务器的IP地址。</li><li><code>master_user</code>: 用于复制的用户名。</li><li><code>master_password</code>: 用户的密码。</li><li><code>master_auto_position</code>: 自动位置调整，确保使用GTID模式。</li></ul> 
<h4 id="1.5%20%E5%90%AF%E5%8A%A8%E4%BB%8E%E6%9C%8D%E5%8A%A1">1.5 启动从服务</h4> 
<p>配置完成后，启动从服务器的复制服务：</p> 
<pre><code>start slave;
</code></pre> 
<h4 id="1.6%20%E6%9F%A5%E7%9C%8B%E4%BB%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%8A%B6%E6%80%81" style="background-color:transparent;">1.6 查看从服务器状态</h4> 
<p>使用以下命令查看从服务器的状态，以确保复制正常运行：</p> 
<pre><code>show slave status\G;
</code></pre> 
<h3 id="%E2%80%8B%E7%BC%96%E8%BE%91"><img alt="" height="489" src="https://images2.imgbox.com/26/0f/IqtcmmKv_o.png" width="1000"></h3> 
<h3></h3> 
<h3></h3> 
<h3 id="%E6%B5%8B%E8%AF%95%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6">测试主从复制</h3> 
<p>最后，进行测试以验证主从复制是否正常工作。</p> 
<h4 id="%E5%9C%A8%E4%B8%BB%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E6%B5%8B%E8%AF%95">在主服务器上测试</h4> 
<pre><code>mysql&gt; create database smqnz;          // 创建数据库
Query OK, 1 row affected (0.00 sec)

mysql&gt; use smqnz;                      // 进入smqnz数据库
Database changed

mysql&gt; create table test(age int);     // 创建一个表
Query OK, 0 rows affected (0.01 sec)

mysql&gt; insert into test values(1);     // 插入数据
Query OK, 1 row affected (0.04 sec)

mysql&gt; select * from test;             // 查询数据
+------+
| age  |
+------+
|    1 |
+------+
</code></pre> 
<h4 id="%E5%9C%A8%E4%BB%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%AA%8C%E8%AF%81" style="background-color:transparent;">在从服务器上验证</h4> 
<pre><code class="language-sql">mysql&gt; select * from smqnz.test;
+------+
| age  |
+------+
|    1 |
+------+
1 row in set (0.00 sec)</code></pre> 
<p></p> 
<h3 id="%E6%80%BB%E7%BB%93" style="background-color:transparent;">总结</h3> 
<p>本文介绍了如何在MySQL中配置单主复制的GTID模式，包括主服务器和从服务器的配置步骤、创建复制用户及测试主从复制的过程，以实现高可用性和数据冗余。</p> 
<p class="img-center"><img alt="" height="394" src="https://images2.imgbox.com/e6/c2/j6mB81Ag_o.png" width="700"></p> 
<p></p> 
<blockquote> 
 <p><strong> 成功的路上没有捷径，只有不断的努力与坚持。如果你和我一样，坚信努力会带来回报，请关注我，点个赞，一起迎接更加美好的明天！你的支持是我继续前行的动力！"</strong></p> 
 <p></p> 
 <p>"每一次创作都是一次学习的过程，文章中若有不足之处，还请大家多多包容。你的关注和点赞是对我最大的支持，也欢迎大家提出宝贵的意见和建议，让我不断进步。"</p> 
 <p></p> 
 <p style="text-align:center;"><strong>神秘泣男子</strong></p> 
 <p style="text-align:center;"><img alt="" height="289" src="https://images2.imgbox.com/ad/b0/BA7zqnUL_o.png" width="296"></p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a0a4e80d1073eadef04ae0436dff00f4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Python研究生毕业设计，数据挖掘、情感分析、机器学习</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b3fe8cfcd1fda769d51e62af74ff4b2b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SpringBoot整合AES&#43;RSA加密（含前端代码）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>