<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>RabbitMQ 中的 VirtualHost 该如何理解 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/26004bebb9b654dd6721ff738b411bcf/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="RabbitMQ 中的 VirtualHost 该如何理解">
  <meta property="og:description" content="《一线大厂Java面试题解析&#43;核心总结学习笔记&#43;最新讲解视频&#43;实战项目源码》，点击传送门，即可获取！
登录成功后，在 admin 选项卡可以查看所有用户：
可以看到，每个用户都有一个 Can access virtual hosts 属性，这个属性是啥意思呢？
今天松哥来和大家稍微捋一捋。
1. 多租户
RabbitMQ 中有一个概念叫做多租户，怎么理解呢？
我们安装一个 RabbitMQ 服务器，每一个 RabbitMQ 服务器都能创建出许多虚拟的消息服务器，这些虚拟的消息服务器就是我们所说的虚拟主机（virtual host），一般简称为 vhost。
本质上，每一个 vhost 都是一个独立的小型 RabbitMQ 服务器，这个 vhost 中会有自己的消息队列、消息交换机以及相应的绑定关系等等，并且拥有自己独立的权限，不同的 vhost 中的队列和交换机不能互相绑定，这样技能保证运行安全又能避免命名冲突。
我们并不需要特别的去看待 vhost，他就跟普通的物理 RabbitMQ 一样，不同的 vhost 能够提供逻辑上的分离，确保不同的应用消息队列能够安全独立运行。
要我来说，我们该怎么看待 vhost 和 RabbitMQ 的关系呢？RabbitMQ 相当于一个 Excel 文件，而 vhost 则是 Excel 文件中的一个个 sheet，我们所有的操作都是在某一个 sheet 上进行操作。
本质上来说，vhost 算是 AMQP 协议中的概念。
2. 命令行创建 vhost
先来看看如何通过命令行创建 vhost。
因为松哥这里的 RabbitMQ 是用 docker 安装的，所以我们首先进入到 docker 容器中：
docker exec -it some-rabbit /bin/bash">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-02T18:49:50+08:00">
    <meta property="article:modified_time" content="2024-05-02T18:49:50+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">RabbitMQ 中的 VirtualHost 该如何理解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><strong>《一线大厂Java面试题解析+核心总结学习笔记+最新讲解视频+实战项目源码》</strong>，<strong><a href="https://bbs.csdn.net/topics/618164986">点击传送门</a>，即可获取！</strong></p> 
<p>登录成功后，在 admin 选项卡可以查看所有用户：</p> 
<p><img src="https://images2.imgbox.com/96/11/YN7aELeG_o.png" alt=""></p> 
<p>可以看到，每个用户都有一个 <code>Can access virtual hosts</code> 属性，这个属性是啥意思呢？</p> 
<p>今天松哥来和大家稍微捋一捋。</p> 
<p>1. 多租户</p> 
<hr> 
<p>RabbitMQ 中有一个概念叫做多租户，怎么理解呢？</p> 
<p>我们安装一个 RabbitMQ 服务器，每一个 RabbitMQ 服务器都能创建出许多虚拟的消息服务器，这些虚拟的消息服务器就是我们所说的虚拟主机（virtual host），一般简称为 vhost。</p> 
<p>本质上，每一个 vhost 都是一个独立的小型 RabbitMQ 服务器，这个 vhost 中会有自己的消息队列、消息交换机以及相应的绑定关系等等，并且拥有自己独立的权限，不同的 vhost 中的队列和交换机不能互相绑定，这样技能保证运行安全又能避免命名冲突。</p> 
<p>我们并不需要特别的去看待 vhost，他就跟普通的物理 RabbitMQ 一样，不同的 vhost 能够提供逻辑上的分离，确保不同的应用消息队列能够安全独立运行。</p> 
<p>要我来说，我们该怎么看待 vhost 和 RabbitMQ 的关系呢？RabbitMQ 相当于一个 Excel 文件，而 vhost 则是 Excel 文件中的一个个 sheet，我们所有的操作都是在某一个 sheet 上进行操作。</p> 
<blockquote> 
 <p>本质上来说，vhost 算是 AMQP 协议中的概念。</p> 
</blockquote> 
<p>2. 命令行创建 vhost</p> 
<hr> 
<p>先来看看如何通过命令行创建 vhost。</p> 
<p>因为松哥这里的 RabbitMQ 是用 docker 安装的，所以我们首先进入到 docker 容器中：</p> 
<p>docker exec -it some-rabbit /bin/bash</p> 
<p>然后执行如下命令创建一个名为 <code>/myvh</code> 的 vhost：</p> 
<p>rabbitmqctl add_vhost myvh</p> 
<p>最终执行结果如下：</p> 
<p><img src="https://images2.imgbox.com/f3/03/5NpzyQmm_o.png" alt=""></p> 
<p>然后通过如下命令可以查看已有的 vhost：</p> 
<p>rabbitmqctl list_vhosts</p> 
<p><img src="https://images2.imgbox.com/db/0d/v8tbPOuH_o.png" alt=""></p> 
<p>当然这个命令也可以添加两个选项 name 和 tracing，name 表示 vhost 的名称，tracing 则表示是否使用了 tracing 功能（tracing 可以帮助追踪 RabbitMQ 中消息的流入流出情况），如下图：</p> 
<p><img src="https://images2.imgbox.com/e4/ca/y2wvwWv7_o.png" alt=""></p> 
<p>可以通过如下命令删除一个 vhost：</p> 
<p>rabbitmqctl delete_vhost myvh</p> 
<p><img src="https://images2.imgbox.com/fc/36/oVKWr4wl_o.png" alt=""></p> 
<p>当删除一个 vhost 的时候，与这个 vhost 相关的消息队列、交换机以及绑定关系等，统统都会被删除。</p> 
<p>给一个用户设置 vhost：</p> 
<p>rabbitmqctl set_permissions -p myvh guest “.<em>" ".</em>” “.*”</p> 
<p><img src="https://images2.imgbox.com/03/d0/hs3119QZ_o.png" alt=""></p> 
<p>前面参数都好说，最后面三个 <code>".*"</code> 含义分别如下：</p> 
<ul><li> <p>用户在所有资源上都拥有可配置权限（创建/删除消息队列、创建/删除交换机等）。</p> </li><li> <p>用户在所有资源上都拥有写权限（发消息）。</p> </li><li> <p>用户在所有资源上都拥有读权限（消息消费，清空队列等）。</p> </li></ul> 
<p>禁止一个用户访问某个 vhost：</p> 
<p>rabbitmqctl clear_permissions -p myvh guest</p> 
<p><img src="https://images2.imgbox.com/84/7d/xZA8bF1l_o.png" alt=""></p> 
<p>3. 管理页面创建 vhost</p> 
<hr> 
<p>当然我们也可以在网页端管理 vhost：</p> 
<p>在 admin 选项卡中，点击右边的 Virtual Hosts，如下：</p> 
<p><img src="https://images2.imgbox.com/aa/05/glF0hwAM_o.png" alt=""></p> 
<p>然后点击下边的 Add a new virtual host ，可以添加一个新的 vhost：</p> 
<p><img src="https://images2.imgbox.com/22/c2/9iNA1Dme_o.png" alt=""></p> 
<p>进入到某一个 vhost 之后，可以修改其权限以及删除一个 vhost，如下图：</p> 
<p><img src="https://images2.imgbox.com/07/7d/PjSMuwQD_o.png" alt=""></p> 
<p>4. 用户管理</p> 
<hr> 
<h2><a id="_232"></a><strong>最后</strong></h2> 
<p><strong>最后，强调几点：</strong></p> 
<ul><li>1. 一定要谨慎对待写在简历上的东西，一定要对简历上的东西非常熟悉。因为一般情况下，面试官都是会根据你的简历来问的； 能有一个上得了台面的项目也非常重要，这很可能是面试官会大量发问的地方，所以在面试之前好好回顾一下自己所做的项目；</li><li>2. 和面试官聊基础知识比如设计模式的使用、多线程的使用等等，可以结合具体的项目场景或者是自己在平时是如何使用的；</li><li>3. 注意自己开源的Github项目，面试官可能会挖你的Github项目提问；</li></ul> 
<p>我个人觉得面试也像是一场全新的征程，失败和胜利都是平常之事。所以，劝各位不要因为面试失败而灰心、丧失斗志。也不要因为面试通过而沾沾自喜，等待你的将是更美好的未来，继续加油！</p> 
<blockquote> 
 <p><strong>以上面试专题的答小编案整理成面试文档了，文档里有答案详解，以及其他一些大厂面试题目。</strong></p> 
</blockquote> 
<h2><a id="_244"></a><strong>面试答案</strong></h2> 
<p><img src="https://images2.imgbox.com/fa/d8/KB2g6bpc_o.png" alt="三面头条+四面阿里+五面腾讯拿offer分享面经总结，最终入职阿里"></p> 
<p><img src="https://images2.imgbox.com/99/1d/Pn1pXJk6_o.png" alt="三面头条+四面阿里+五面腾讯拿offer分享面经总结，最终入职阿里"></p> 
<p><img src="https://images2.imgbox.com/0a/ab/dC52yZNs_o.png" alt="三面头条+四面阿里+五面腾讯拿offer分享面经总结，最终入职阿里"></p> 
<p><strong>《一线大厂Java面试题解析+核心总结学习笔记+最新讲解视频+实战项目源码》</strong>，<strong><a href="https://bbs.csdn.net/topics/618164986">点击传送门</a>，即可获取！</strong><br> 。**</p> 
<h2><a id="_255"></a><strong>面试答案</strong></h2> 
<p>[外链图片转存中…(img-Gi5aXxqe-1714646972454)]</p> 
<p>[外链图片转存中…(img-UbUJ4vXw-1714646972454)]</p> 
<p>[外链图片转存中…(img-RO4mB5Ww-1714646972455)]</p> 
<p><strong>《一线大厂Java面试题解析+核心总结学习笔记+最新讲解视频+实战项目源码》</strong>，<strong><a href="https://bbs.csdn.net/topics/618164986">点击传送门</a>，即可获取！</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/376a45adffe98eefe56c04e4d3d7d606/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">在autodl平台使用llama-factory微调Qwen1.5-7B</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c380d11055987014b378b7615e3116f2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C&#43;&#43;：map和set的封装</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>