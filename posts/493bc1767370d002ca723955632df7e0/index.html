<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C# XML编程全攻略：深度解析创建、读取、更新与删除操作 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/493bc1767370d002ca723955632df7e0/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="C# XML编程全攻略：深度解析创建、读取、更新与删除操作">
  <meta property="og:description" content="在C#中，XML文件常被用于存储配置数据、交换数据或作为轻量级的数据持久化方案。以下是关于C#中如何使用XML文件的详细说明，包括创建、读取、更新和删除XML数据的代码示例，以及详尽的注释解释。
1. 创建XML文件 使用XmlDocument创建 Csharp
using System; using System.Xml; namespace CSharpXMLExample { class Program { static void Main(string[] args) { // 创建一个新的XML文档对象 XmlDocument xmlDoc = new XmlDocument(); // 创建XML声明 XmlDeclaration xmlDecl = xmlDoc.CreateXmlDeclaration(&#34;1.0&#34;, &#34;UTF-8&#34;, null); xmlDoc.AppendChild(xmlDecl); // 创建根元素 XmlElement rootElement = xmlDoc.CreateElement(&#34;Root&#34;); xmlDoc.AppendChild(rootElement); // 在根元素下创建子元素并设置属性 XmlElement childElement = xmlDoc.CreateElement(&#34;Child&#34;); childElement.SetAttribute(&#34;attributeName&#34;, &#34;AttributeValue&#34;); childElement.InnerText = &#34;Element Text&#34;; rootElement.AppendChild(childElement); // 保存到文件 xmlDoc.Save(&#34;example.xml&#34;); Console.WriteLine(&#34;XML file created successfully.&#34;); } } } 注释：
XmlDocument是.NET框架中用于表示整个XML文档的对象。CreateXmlDeclaration用于创建XML声明，指定版本、编码和独立性。CreateElement用于创建XML元素，可以设置其名称。SetAttribute用于给元素添加属性。InnerText用于设置元素的文本内容。AppendChild用于将元素添加到父元素下。最后使用Save方法将XML文档保存到指定文件。 使用XElement（LINQ to XML）创建 Csharp">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-20T11:48:39+08:00">
    <meta property="article:modified_time" content="2024-04-20T11:48:39+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C# XML编程全攻略：深度解析创建、读取、更新与删除操作</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>在C#中，XML文件常被用于存储配置数据、交换数据或作为轻量级的数据持久化方案。以下是关于C#中如何使用XML文件的详细说明，包括创建、读取、更新和删除XML数据的代码示例，以及详尽的注释解释。</p> 
<h4>1. <strong>创建XML文件</strong></h4> 
<h5><strong>使用<code>XmlDocument</code>创建</strong></h5> 
<pre></pre> 
<p>Csharp</p> 
<pre><code>using System;
using System.Xml;

namespace CSharpXMLExample
{
    class Program
    {
        static void Main(string[] args)
        {
            // 创建一个新的XML文档对象
            XmlDocument xmlDoc = new XmlDocument();

            // 创建XML声明
            XmlDeclaration xmlDecl = xmlDoc.CreateXmlDeclaration("1.0", "UTF-8", null);
            xmlDoc.AppendChild(xmlDecl);

            // 创建根元素
            XmlElement rootElement = xmlDoc.CreateElement("Root");
            xmlDoc.AppendChild(rootElement);

            // 在根元素下创建子元素并设置属性
            XmlElement childElement = xmlDoc.CreateElement("Child");
            childElement.SetAttribute("attributeName", "AttributeValue");
            childElement.InnerText = "Element Text";
            rootElement.AppendChild(childElement);

            // 保存到文件
            xmlDoc.Save("example.xml");
            Console.WriteLine("XML file created successfully.");
        }
    }
}</code></pre> 
<p>注释：</p> 
<ul><li><code>XmlDocument</code>是.NET框架中用于表示整个XML文档的对象。</li><li><code>CreateXmlDeclaration</code>用于创建XML声明，指定版本、编码和独立性。</li><li><code>CreateElement</code>用于创建XML元素，可以设置其名称。</li><li><code>SetAttribute</code>用于给元素添加属性。</li><li><code>InnerText</code>用于设置元素的文本内容。</li><li><code>AppendChild</code>用于将元素添加到父元素下。</li><li>最后使用<code>Save</code>方法将XML文档保存到指定文件。</li></ul> 
<h5><strong>使用<code>XElement</code>（LINQ to XML）创建</strong></h5> 
<pre></pre> 
<p>Csharp</p> 
<pre><code>using System;
using System.Xml.Linq;

namespace CSharpXMLExample
{
    class Program
    {
        static void Main(string[] args)
        {
            // 使用LINQ to XML创建XML文档
            XElement root = new XElement("Root",
                new XElement("Child",
                    new XAttribute("attributeName", "AttributeValue"),
                    "Element Text"));

            // 保存到文件
            root.Save("example.xml");
            Console.WriteLine("XML file created successfully using LINQ to XML.");
        }
    }
}</code></pre> 
<p>注释：</p> 
<ul><li><code>XElement</code>是LINQ to XML中用于表示XML元素的对象，创建时直接指定元素名及子元素或文本内容。</li><li><code>XAttribute</code>用于创建XML属性，与对应的元素一起构造。</li><li>使用<code>Save</code>方法将<code>XElement</code>作为根元素保存到文件。</li></ul> 
<h4>2. <strong>读取XML文件</strong></h4> 
<h5><strong>使用<code>XmlDocument</code>读取</strong></h5> 
<pre></pre> 
<p>Csharp</p> 
<pre><code>using System;
using System.Xml;

namespace CSharpXMLExample
{
    class Program
    {
        static void Main(string[] args)
        {
            XmlDocument xmlDoc = new XmlDocument();
            xmlDoc.Load("example.xml");

            // 获取根元素
            XmlElement rootElement = xmlDoc.DocumentElement;

            // 遍历子元素
            foreach (XmlElement child in rootElement.ChildNodes)
            {
                Console.WriteLine($"Element Name: {child.Name}");
                Console.WriteLine($"Attribute Value: {child.GetAttribute("attributeName")}");
                Console.WriteLine($"Element Text: {child.InnerText}");
                Console.WriteLine();
            }
        }
    }
}</code></pre> 
<p>注释：</p> 
<ul><li><code>Load</code>方法用于从文件加载XML文档。</li><li><code>DocumentElement</code>属性返回XML文档的根元素。</li><li><code>ChildNodes</code>属性包含根元素的所有子节点，遍历这些节点并打印元素名称、属性值和文本内容。</li></ul> 
<h5><strong>使用<code>XDocument</code>（LINQ to XML）读取</strong></h5> 
<pre></pre> 
<p>Csharp</p> 
<pre><code>using System;
using System.Xml.Linq;

namespace CSharpXMLExample
{
    class Program
    {
        static void Main(string[] args)
        {
            XDocument doc = XDocument.Load("example.xml");

            // 查询XML文档，提取所需信息
            var children = from child in doc.Root.Elements("Child")
                           select new
                           {
                               ElementName = child.Name.LocalName,
                               AttributeValue = child.Attribute("attributeName").Value,
                               TextContent = child.Value
                           };

            foreach (var child in children)
            {
                Console.WriteLine($"Element Name: {child.ElementName}");
                Console.WriteLine($"Attribute Value: {child.AttributeValue}");
                Console.WriteLine($"Element Text: {child.TextContent}");
                Console.WriteLine();
            }
        }
    }
}</code></pre> 
<p>注释：</p> 
<ul><li><code>XDocument</code>是LINQ to XML中表示整个XML文档的对象，使用<code>Load</code>方法加载文件。</li><li><code>Elements</code>方法用于获取根元素下的所有指定名称的子元素。</li><li>使用LINQ查询表达式提取元素名称、属性值和文本内容，并循环打印。</li></ul> 
<h4>3. <strong>更新XML文件</strong></h4> 
<h5><strong>使用<code>XmlDocument</code>更新</strong></h5> 
<pre></pre> 
<p>Csharp</p> 
<pre><code>using System;
using System.Xml;

namespace CSharpXMLExample
{
    class Program
    {
        static void Main(string[] args)
        {
            XmlDocument xmlDoc = new XmlDocument();
            xmlDoc.Load("example.xml");

            // 查找要更新的元素
            XmlNode targetNode = xmlDoc.SelectSingleNode("//Child[@attributeName='AttributeValue']");
            if (targetNode != null)
            {
                // 更新属性值
                targetNode.Attributes["attributeName"].Value = "NewAttributeValue";
                targetNode.InnerText = "Updated Text";

                // 保存更改到文件
                xmlDoc.Save("example.xml");
                Console.WriteLine("XML file updated successfully.");
            }
            else
            {
                Console.WriteLine("Target element not found.");
            }
        }
    }
}</code></pre> 
<p>注释：</p> 
<ul><li>使用<code>SelectSingleNode</code>方法通过XPath表达式定位要更新的元素。</li><li>直接修改找到的元素的属性值和文本内容。</li><li>保存更改到文件。</li></ul> 
<h5><strong>使用<code>XDocument</code>（LINQ to XML）更新</strong></h5> 
<pre></pre> 
<p>Csharp</p> 
<pre><code>using System;
using System.Xml.Linq;

namespace CSharpXMLExample
{
    class Program
    {
        static void Main(string[] args)
        {
            XDocument doc = XDocument.Load("example.xml");

            // 查询并更新元素
            var child = doc.Descendants("Child")
                           .FirstOrDefault(c =&gt; (string)c.Attribute("attributeName") == "AttributeValue");

            if (child != null)
            {
                child.SetAttributeValue("attributeName", "NewAttributeValue");
                child.Value = "Updated Text";

                doc.Save("example.xml");
                Console.WriteLine("XML file updated successfully using LINQ to XML.");
            }
            else
            {
                Console.WriteLine("Target element not found.");
            }
        }
    }
}</code></pre> 
<p>注释：</p> 
<ul><li>使用<code>Descendants</code>方法查找所有名为“Child”的后代元素，并通过LINQ条件筛选出目标元素。</li><li>使用<code>SetAttributeValue</code>方法更新属性值。</li><li>直接修改元素的<code>Value</code>属性以更新文本内容。</li><li>保存更改到文件。</li></ul> 
<h4>4. <strong>删除XML文件中的元素</strong></h4> 
<h5><strong>使用<code>XmlDocument</code>删除</strong></h5> 
<pre></pre> 
<p>Csharp</p> 
<pre><code>    using System;
using System.Xml;

namespace CSharpXMLExample
{
    class Program
    {
        static void Main(string[] args)
        {
            XmlDocument xmlDoc = new XmlDocument();
            xmlDoc.Load("example.xml");

            // 查找并删除元素
            XmlNode targetNode = xmlDoc.SelectSingleNode("//Child[@attributeName='AttributeValue']");
            if (targetNode != null)
            {
                targetNode.ParentNode.RemoveChild(targetNode);

                // 保存更改到文件
                xmlDoc.Save("example.xml");
                Console.WriteLine("XML file updated successfully (element deleted).");
            }
            else
            {
                Console.WriteLine("Target element not found.");
            }
        }
    }
}</code></pre> 
<p>注释：</p> 
<ul><li>使用<code>SelectSingleNode</code>方法通过XPath表达式定位要删除的元素。</li><li>调用<code>RemoveChild</code>方法从其父节点移除该元素。</li><li>保存更改到文件。</li></ul> 
<h5><strong>使用<code>XDocument</code>（LINQ to XML）删除</strong></h5> 
<pre></pre> 
<p>Csharp</p> 
<pre><code>using System;
using System.Xml.Linq;

namespace CSharpXMLExample
{
    class Program
    {
        static void Main(string[] args)
        {
            XDocument doc = XDocument.Load("example.xml");

            // 查询并删除元素
            var childToRemove = doc.Descendants("Child")
                                   .FirstOrDefault(c =&gt; (string)c.Attribute("attributeName") == "AttributeValue");

            if (childToRemove != null)
            {
                childToRemove.Remove();

                doc.Save("example.xml");
                Console.WriteLine("XML file updated successfully (element deleted) using LINQ to XML.");
            }
            else
            {
                Console.WriteLine("Target element not found.");
            }
        }
    }
}</code></pre> 
<p>注释：</p> 
<ul><li>使用<code>Descendants</code>方法查找所有名为“Child”的后代元素，并通过LINQ条件筛选出目标元素。</li><li>直接调用<code>Remove</code>方法删除找到的元素。</li><li>保存更改到文件。</li></ul> 
<p>以上代码示例详细展示了如何在C#中使用<code>XmlDocument</code>和<code>XDocument</code>（LINQ to XML）来创建、读取、更新和删除XML文件。每段代码都附有详尽的注释，以便您理解和应用到实际项目中。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/39953b97593763c00a17075c6b3e677b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">理解Python的链表ListNode</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1d8e132fe1d73e45b01e5ff3612adf5a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Anaconda 中更新当前环境的 Python 版本</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>