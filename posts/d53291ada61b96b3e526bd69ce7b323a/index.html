<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vue 前端excel表格导入和导出,Element &#43; xlsx 组件 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/d53291ada61b96b3e526bd69ce7b323a/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="vue 前端excel表格导入和导出,Element &#43; xlsx 组件">
  <meta property="og:description" content="前端需要导入表格进行数据匹配，并进行表格导出，感谢很多大佬的文章分享，有不对的地方欢迎大家指正。 Element &#43; xlsx 安装命令 npm install xlsx 页面引入 import XLSX from &#39;xlsx&#39; 一、excel表格导入到表格 &lt;template&gt; &lt;div class=&#34;main&#34;&gt; &lt;div class=&#34;main_title&#34;&gt;工具&lt;/div&gt; &lt;div class=&#34;main_content main_bg&#34;&gt; &lt;div class=&#34;table_title&#34; &gt; &lt;div class=&#34;fl left_tbl&#34;&gt; &lt;div&gt; &lt;el-upload class=&#34;fl upload-demo&#34; action=&#34;&#34; ref=&#34;upload&#34; accept=&#34;.xls,.xlsx&#34; :file-list=&#34;fileList&#34; :on-change=&#34;handleChange&#34; :show-file-list=&#34;false&#34; :auto-upload=&#34;false&#34;&gt; &lt;el-button type=&#34;success&#34;&gt;导入数据&lt;/el-button&gt; &lt;/el-upload&gt; &lt;div class=&#34;fl filename&#34; &gt;{{formName}}&lt;/div&gt; &lt;div class=&#34;cf&#34;&gt;&lt;/div&gt; &lt;/div&gt; &lt;div class=&#34;left_tbl_1&#34;&gt; &lt;el-table :data=&#34;tableData&#34; border style=&#34;width: 100%&#34; class=&#34;tb-edit&#34; height=&#34;450&#34; @cell-click=&#34;clickCell&#34; :row-class-name=&#34;rowClass&#34;&gt; &lt;el-table-column label=&#34;序号&#34; type=&#34;index&#34; width=&#34;50&#34; v-if=&#34;tableData.length&gt;0&#34; align=&#34;center&#34;&gt;&lt;/el-table-column&gt; &lt;template v-for=&#34;(item,index) in dataName&#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-09T11:00:56+08:00">
    <meta property="article:modified_time" content="2024-03-09T11:00:56+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vue 前端excel表格导入和导出,Element &#43; xlsx 组件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>前端需要导入表格进行数据匹配，并进行表格导出，感谢很多大佬的文章分享，有不对的地方欢迎大家指正。</h4> 
<h4><span style="color:#fe2c24;">Element  + xlsx </span></h4> 
<h5>安装命令  npm install xlsx </h5> 
<h5>页面引入  import XLSX from 'xlsx'</h5> 
<h3>一、excel表格导入到表格</h3> 
<pre><code class="hljs">&lt;template&gt;
  &lt;div class="main"&gt;
    &lt;div class="main_title"&gt;工具&lt;/div&gt;
		&lt;div class="main_content main_bg"&gt;
      &lt;div class="table_title" &gt;
        &lt;div class="fl left_tbl"&gt;
          &lt;div&gt;
            &lt;el-upload
              class="fl upload-demo" action="" ref="upload" accept=".xls,.xlsx"
                :file-list="fileList" :on-change="handleChange" :show-file-list="false" :auto-upload="false"&gt;
              &lt;el-button type="success"&gt;导入数据&lt;/el-button&gt;
            &lt;/el-upload&gt;
            &lt;div class="fl filename" &gt;{<!-- -->{formName}}&lt;/div&gt;
            &lt;div class="cf"&gt;&lt;/div&gt;
          &lt;/div&gt;
          &lt;div class="left_tbl_1"&gt;
            &lt;el-table :data="tableData" border style="width: 100%" class="tb-edit" height="450"  @cell-click="clickCell" :row-class-name="rowClass"&gt;
              &lt;el-table-column label="序号" type="index"  width="50" v-if="tableData.length&gt;0" align="center"&gt;&lt;/el-table-column&gt;
              &lt;template v-for="(item,index) in dataName" v-if="tableData.length&gt;0" align="center"&gt;
                &lt;el-table-column :label="item" :prop="item" align="center" :key="index"&gt;&lt;/el-table-column&gt;
              &lt;/template&gt;
            &lt;/el-table&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
import XLSX from 'xlsx'
export default {
    data(){
      return {
        // 表格
        fileList:[],
        tableData: [],
        dataName:[],//表格header
        formName:'',//导入的表格名
      }
    },
    created(){

    },

    methods:{
      
      // 导入表格数据
      handleChange(file) {
        const _this = this
        _this.tableData = []
        _this.fileName = file.name;
        _this.formName = file.name;
        const reader = new FileReader();
        //提取excel中文件内容
        reader.readAsArrayBuffer(file.raw);
        reader.onload = function () {
            const buffer = reader.result;
            const bytes = new Uint8Array(buffer);
            const length = bytes.byteLength;
            let binary = "";
            for (let i = 0; i &lt; length; i++) {
                binary += String.fromCharCode(bytes[i]);
            }
            const XLSX = require("xlsx");
            const wb = XLSX.read(binary, {
                type: "binary",
            });
            const outdata = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]]);
            outdata.forEach((i) =&gt; {
                _this.tableData.push(i);
            });
            _this.dataName = Object.keys(_this.tableData[0]);//获取抬头
        };
      },
      
}
&lt;/script&gt;
&lt;style &gt;

&lt;/style&gt;
</code></pre> 
<h3>二、表格数据导出成excel</h3> 
<p>此处参考<a href="https://blog.csdn.net/albert_xjf/article/details/131162925" title="Vue中如何进行数据导出与Excel导出？_vue导出excel文件-CSDN博客">Vue中如何进行数据导出与Excel导出？_vue导出excel文件-CSDN博客</a>；</p> 
<p><span style="color:#fe2c24;">中间一定更要记得引xlsx；</span></p> 
<p><span style="color:#fe2c24;">这边的数据是固定的，如果想改成动态的，可以自己写循环替代map方法；</span></p> 
<pre><code class="hljs">&lt;template&gt;
  &lt;div&gt;
    &lt;button @click="exportData"&gt;导出数据&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import XLSX from 'xlsx'

export default {
  data() {
    return {
      tableData: [
        { name: '张三', age: 18, gender: '男' },
        { name: '李四', age: 20, gender: '女' },
        { name: '王五', age: 22, gender: '男' }
      ]
    }
  },
  methods: {
    exportData() {
      const XLSX = require("xlsx");
      const headers = ['姓名', '年龄', '性别']
      const data = this.tableData.map(item =&gt; [item.name, item.age, item.gender])
      const worksheet = XLSX.utils.aoa_to_sheet([headers, ...data])
      const workbook = XLSX.utils.book_new()
      XLSX.utils.book_append_sheet(workbook, worksheet, 'Sheet1')
      XLSX.writeFile(workbook, 'data.xlsx')
    }
  }
}
&lt;/script&gt;
</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fb1a6ce29cb82e6cfb777112020f9386/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">项目设计：基于Qt和百度AI的车牌识别系统(嵌入式ARM)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/225e590cb088f3e1b7604f53106c4d07/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux之MySQL的数据备份</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>