<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>.NET数据交互之生成和读取YAML文件 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/a3ded2311e171008d355d750e6362fd0/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content=".NET数据交互之生成和读取YAML文件">
  <meta property="og:description" content="最近在项目中，业务上需要与Python进行交互，而Python程序用的配置文件主要是YAML，程序以命令行形式运行，前端页面由C#通过WPF开发完成。现在需要通过C#生成YAML配置文件，并经过Python读取和修改后，再次由C#进行读取。在C#开发程序中，主要用的配置文件主要是XML，JSON，INI等，很少用到YAML，今天以一个简单的小例子，简述如何通过C#程序，进行YAML文件的读取和写入，仅供学习和参考使用，如有不足之前，还请指正。
什么要YAML？ YAML 是 &#34;YAML Ain&#39;t Markup Language&#34;（YAML 不是一种标记语言）的递归缩写。在开发的这种语言时，YAML 的意思其实是：&#34;Yet Another Markup Language&#34;（仍是一种标记语言）。YAML以数据为中心，使用空白，缩进，分行组织数据，从而使得表示更加简洁易读。
YAML的基本特点 YAML吸收了XML，JSON，INI等格式文件的优点，主要有以下几种特点：
大小写敏感使用缩进表示层级关系缩进时不允许使用Tab键，只允许使用空格。缩进的空格数目不重要，只要相同层级的元素左侧对齐即可#表示注释字符串无需加引号，如果要加，单引号会被转义，双引号不会不转义key: value key和value之间有空格 YAML支持的数据类型 YAML以数据为中心，支持的数据类型主要有以下几种：
纯量（scalars）：单个的、不可再分的值，数据最小的单位，不可以再分割。类似于Python中单个变量数组：一组按次序排列的值，又称为序列（sequence） / 列表（list），与Python的list数组结构类似，数组元素使用“-”开头，也可以根据缩进进行数组嵌套。对象：键值对的集合，又称为映射（mapping）/ 哈希（hashes） / 字典（dictionary），对象的一组键值对，使用冒号结构表示。类似Python中的字典数据结构。 YAML数据示例 1. 列表示例 列表获数组，与Python的list数组结构类似，数组元素使用“-”开头，也可以根据缩进进行数组嵌套。如下所示：
#行内写法： k: [v1,v2,v3] #或者 k: - v1 - v2 - v3 2. 对象示例 对象【map，hash，set，object】表示一组键值对，使用冒号结构表示。类似Python中的字典数据结构。
platformName: Android platformVersion: 6.0.1 注意：冒号后面一定要有空格！
YamlDotNet安装 在本示例中，主要通过YamlDotNet库进行Yaml文件的读取的和写入，即对象的序列化和反序列化。在VS中，点击项目右键，打开Nuget包管理器，然后搜索YamlDotNet库[当前版本为15.1.6]进行安装，如下所示：
YamlDotNet对应的GitHup地址为：GitHub - aaubry/YamlDotNet: YamlDotNet is a .NET library for YAML
创建Yaml帮助类 Yaml帮助类主要包括读取和写入Yaml文件两个功能。
1. 读取 从Yaml文件中读，并反序列化，主要通过DeserializerBuilder类进行构建反序列号接口，然后再反序列化，如下所示：
public static T ReadYaml&lt;T&gt;(string file) { var target = DeserializeFromFile&lt;T&gt;(file); return target; } public static T Deserialize&lt;T&gt;(string yaml) { IDeserializer _deserializer = new DeserializerBuilder().">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-31T22:08:48+08:00">
    <meta property="article:modified_time" content="2024-05-31T22:08:48+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">.NET数据交互之生成和读取YAML文件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>最近在项目中，业务上需要与Python进行交互，而Python程序用的配置文件主要是YAML，程序以命令行形式运行，前端页面由C#通过WPF开发完成。现在需要通过C#生成YAML配置文件，并经过Python读取和修改后，再次由C#进行读取。在C#开发程序中，主要用的配置文件主要是XML，JSON，INI等，很少用到YAML，今天以一个简单的小例子，简述如何通过C#程序，进行YAML文件的读取和写入，仅供学习和参考使用，如有不足之前，还请指正。</p> 
<p></p> 
<p class="img-center"><img alt="" height="318" src="https://images2.imgbox.com/a1/9c/aVGwyQvE_o.png" width="968"></p> 
<p></p> 
<h2>什么要YAML？</h2> 
<p></p> 
<p>YAML 是 "YAML Ain't Markup Language"（YAML 不是一种标记语言）的递归缩写。在开发的这种语言时，YAML 的意思其实是："Yet Another Markup Language"（仍是一种标记语言）。YAML以数据为中心，使用空白，缩进，分行组织数据，从而使得表示更加简洁易读。</p> 
<p></p> 
<h2>YAML的基本特点</h2> 
<p></p> 
<p>YAML吸收了XML，JSON，INI等格式文件的优点，主要有以下几种特点：</p> 
<ol><li>大小写敏感</li><li>使用缩进表示层级关系</li><li>缩进时不允许使用Tab键，只允许使用空格。</li><li>缩进的空格数目不重要，只要相同层级的元素左侧对齐即可</li><li>#表示注释</li><li>字符串无需加引号，如果要加，单引号会被转义，双引号不会不转义</li><li>key: value   key和value之间有空格</li></ol> 
<p></p> 
<h2>YAML支持的数据类型</h2> 
<p></p> 
<p>YAML以数据为中心，支持的数据类型主要有以下几种：</p> 
<ol><li>纯量（scalars）：单个的、不可再分的值，数据最小的单位，不可以再分割。类似于Python中单个变量</li><li>数组：一组按次序排列的值，又称为序列（sequence） / 列表（list），与Python的list数组结构类似，数组元素使用“-”开头，也可以根据缩进进行数组嵌套。</li><li>对象：键值对的集合，又称为映射（mapping）/ 哈希（hashes） / 字典（dictionary），对象的一组键值对，使用冒号结构表示。类似Python中的字典数据结构。</li></ol> 
<p></p> 
<h2>YAML数据示例</h2> 
<p></p> 
<h3>1. 列表示例</h3> 
<p></p> 
<p>列表获数组，与Python的list数组结构类似，数组元素使用“-”开头，也可以根据缩进进行数组嵌套。如下所示：</p> 
<pre><code class="hljs">#行内写法： 
k: [v1,v2,v3]
#或者
k:
 - v1
 - v2
 - v3</code></pre> 
<p>  </p> 
<p></p> 
<h3>2. 对象示例</h3> 
<p></p> 
<p>对象【map，hash，set，object】表示一组键值对，使用冒号结构表示。类似Python中的字典数据结构。</p> 
<pre><code class="hljs">platformName: Android
platformVersion: 6.0.1</code></pre> 
<p>  </p> 
<p> 注意：冒号后面一定要有空格！</p> 
<p></p> 
<h2>YamlDotNet安装</h2> 
<p></p> 
<p>在本示例中，主要通过YamlDotNet库进行Yaml文件的读取的和写入，即对象的序列化和反序列化。在VS中，点击项目右键，打开Nuget包管理器，然后搜索YamlDotNet库[当前版本为15.1.6]进行安装，如下所示：</p> 
<p></p> 
<p class="img-center"><img alt="" height="568" src="https://images2.imgbox.com/01/5e/yQEo5vY0_o.png" width="1200"></p> 
<p>YamlDotNet对应的GitHup地址为：GitHub - aaubry/YamlDotNet: YamlDotNet is a .NET library for YAML</p> 
<p></p> 
<p class="img-center"><img alt="" height="614" src="https://images2.imgbox.com/e0/d0/K2bHcRgm_o.png" width="890"></p> 
<p></p> 
<h2>创建Yaml帮助类</h2> 
<p></p> 
<p>Yaml帮助类主要包括读取和写入Yaml文件两个功能。</p> 
<p></p> 
<h3>1. 读取</h3> 
<p></p> 
<p>从Yaml文件中读，并反序列化，主要通过DeserializerBuilder类进行构建反序列号接口，然后再反序列化，如下所示：</p> 
<pre><code class="language-cs">public static T ReadYaml&lt;T&gt;(string file)
{
	var target = DeserializeFromFile&lt;T&gt;(file);
	return target;
}
 
public static T Deserialize&lt;T&gt;(string yaml)
{
	IDeserializer _deserializer = new DeserializerBuilder().WithNamingConvention(UnderscoredNamingConvention.Instance).Build();
	return _deserializer.Deserialize&lt;T&gt;(yaml);
}
 
public static T DeserializeFromFile&lt;T&gt;(string filePath)
{
	var yaml = File.ReadAllText(filePath, Encoding.UTF8);
	return Deserialize&lt;T&gt;(yaml);
}</code></pre> 
<p>  </p> 
<p></p> 
<h3>2. 写入</h3> 
<p></p> 
<p>向Yaml文件写入或者创建Yaml文件，主要通过SerializerBuilder构造序列化接口，然后再执行序列号操作，如下所示：</p> 
<pre><code class="language-cs">public static bool WriteToYaml&lt;T&gt;(string file, T obj)
{
	return SerializeToFile(file, obj);
}
 
public static string Serialize&lt;T&gt;(T target)
{
	var _serializer = new SerializerBuilder().WithNamingConvention(CamelCaseNamingConvention.Instance).Build();
	return _serializer.Serialize(target);
}
 
public static bool SerializeToFile&lt;T&gt;(string filePath, T target)
{
	var content = Serialize(target);
	File.WriteAllText(filePath, content, Encoding.UTF8);
	return true;
}</code></pre> 
<p>  </p> 
<p></p> 
<h2>测试验证</h2> 
<p></p> 
<h3>1. 首先创建Test类</h3> 
<p></p> 
<p>Test类型主要用于验证，包含数字,字符串，数组，字典等数据类型，如下所示：</p> 
<p></p> 
<pre><code class="language-cs">public class Test
{
	public string[] A1 { get; set; }
 
	public string A2 { get; set; }
 
	public int A3 { get; set; }
 
	public Dictionary&lt;string, string&gt; A4 { get; set; }
 
}</code></pre> 
<p></p> 
<h3>2. 构造数据并调用YAML帮助类</h3> 
<p></p> 
<p> 构造数据并调用YAML帮助类，生成Yaml文件，如下所示：</p> 
<pre><code class="language-cs">var test = new Test();
test.A1 = new string[] { "ABC", "BCD", "123" };
test.A2 = "这是测试";
test.A3 = 5;
test.A4 = new Dictionary&lt;string, string&gt;();
test.A4.Add("KEY1", "VAL1");
test.A4.Add("KEY2", "VAL2");
test.A4.Add("KEY3", "VAL3");
YamlHelper.WriteToYaml&lt;Test&gt;("test.yaml", test);</code></pre> 
<p>  </p> 
<p>生成的Yaml文件，如下所示：</p> 
<pre><code class="language-cs">a1:
- ABC
- BCD
- 123
a2: 这是测试
a3: 5
a4:
  KEY1: VAL1
  KEY2: VAL2
  KEY3: VAL3</code></pre> 
<p>  </p> 
<p></p> 
<h3>3. 读取Yaml文件</h3> 
<p></p> 
<p>读取Yaml文件，并反序列化为对应对象，如下所示：</p> 
<pre><code class="language-cs">var test = YamlHelper.ReadYaml&lt;Test&gt;("test.yaml");
Console.WriteLine(String.Join(',', test.A1));
Console.WriteLine(test.A2);
Console.WriteLine(test.A3);
Console.WriteLine(test.A4.Count);</code></pre> 
<p>  </p> 
<p></p> 
<p> 以上就是【.NET数据交互之生成和读取YAML文件】的全部内容，希望可以一起学习，共同进步。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1bf551392f13db424b0a191a155fe61f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">数据结构的快速排序（c语言版）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5d1f8a01a85cc8d81fd9b56501550961/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">有三台机器A,B,C ,A和B分别处于一个局域网内，C是一个允许Linux的公网服务器,如果通过ssh命令让A通过C访问B的指定端口?</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>