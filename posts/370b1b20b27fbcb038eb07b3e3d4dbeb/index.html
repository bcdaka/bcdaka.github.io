<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Shire 编码智能体语言：打造你的专属 AI 编程助手 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/370b1b20b27fbcb038eb07b3e3d4dbeb/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Shire 编码智能体语言：打造你的专属 AI 编程助手">
  <meta property="og:description" content="TL;DR：
Shire 提供了一种简便 AI 编码智能体语言，能够让大型语言模型（LLM）与控制集成开发环境（IDE）之间自由对话，以实现自动化编程。
在 Intellij Marketplace 上搜索 Shire，或者在 GitHub 上下载与安装最新版本。
GitHub：https://github.com/phodal/shire
文档：https://shire.phodal.com/
PS：由于，当前版本（0.4.2）支持本地的自定义 RAG 能力，内置本地的 embedding 模型，因此还需要 Onnx Runtime、HF Tokenizer，因此在体积上会比较大。
为什么需要 Shire 智能体语言？ 在 AutoDev 中，我们提供了一系列丰富的自定义能力，以支持开发人员自定义自己的指令，但是受限于框架限制，开发人员的自定义能力还是不够。同时，我们还引入了 DevIns 语言，以支持开发人员更好地自定义自己的 AI 指令。而随后，我们会发现仅仅是这样， 还不足以满足开发人员的日常需求。
1. 辅助研发需求的多样性 AI 软件研发效能提升并不是一件容易的事情，在过去的一年多里，我们做了非常多的尝试。从端到端 AI 辅助研发的开源 Unit Mesh 方案，再到目前 国内最好的开源 AI 驱动编程插件 AutoDev。在这个过程中，我们发现了一些非常有意思的点，诸如于，开发人员需要一个适合自己合适的 AI IDE， 而不是一个通用的 AI IDE。
特别领域代码生成。你需要结合 RAG 来生成包含领域知识的代码，而非简单的补充。
文档实时更新。你需要 AI 来帮你更好生成整个项目的文档，而不仅仅是当前的代码片段注释。
辅助架构分析。你需要结合代码库的 AST 来生成更好的架构分析报告，而不是自己去分析。
还有大量的其它类似的需求，通过现有的 AI IDE 是无法满足的。
2. 文本数据的多样性 在完成自定义任务时，我们所需要的文本数据是丰富多样的。如在 AutoDev 中，用户可以从 IDE 中获取当前的文件、当前的代码片段、当前的选择、当前的光标位置等等。但是依旧存在一些问题：">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-10T15:40:55+08:00">
    <meta property="article:modified_time" content="2024-07-10T15:40:55+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Shire 编码智能体语言：打造你的专属 AI 编程助手</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="js_content"> 
 <p>TL;DR：</p> 
 <blockquote> 
  <p>Shire 提供了一种简便 AI 编码智能体语言，能够让大型语言模型（LLM）与控制集成开发环境（IDE）之间自由对话，以实现自动化编程。</p> 
 </blockquote> 
 <p>在 Intellij Marketplace 上搜索 Shire，或者在 GitHub 上下载与安装最新版本。</p> 
 <ul><li><p>GitHub：<strong>https://github.com/phodal/shire</strong></p></li><li><p>文档：<strong>https://shire.phodal.com/</strong></p></li></ul> 
 <p>PS：由于，当前版本（0.4.2）支持本地的自定义 RAG 能力，内置本地的 embedding 模型，因此还需要 Onnx Runtime、HF Tokenizer，因此在体积上会比较大。</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/49/a5/L2Gt5LiG_o.png" alt="0620ad9f0dcc40bce9b84a99aff2dc3a.png"></p> 
 <h3>为什么需要 Shire 智能体语言？</h3> 
 <p>在 AutoDev 中，我们提供了一系列丰富的自定义能力，以支持开发人员自定义自己的指令，但是受限于框架限制，开发人员的自定义能力还是不够。同时，我们还引入了 DevIns 语言，以支持开发人员更好地自定义自己的 AI 指令。而随后，我们会发现仅仅是这样， 还不足以满足开发人员的日常需求。</p> 
 <h4>1. 辅助研发需求的多样性</h4> 
 <p>AI 软件研发效能提升并不是一件容易的事情，在过去的一年多里，我们做了非常多的尝试。从端到端 AI 辅助研发的开源 Unit Mesh 方案，再到目前 国内最好的开源 AI 驱动编程插件 AutoDev。在这个过程中，我们发现了一些非常有意思的点，诸如于，开发人员需要一个适合自己合适的 AI IDE， 而不是一个通用的 AI IDE。</p> 
 <ul><li><p><strong>特别领域代码生成。</strong>你需要结合 RAG 来生成包含领域知识的代码，而非简单的补充。</p></li><li><p><strong>文档实时更新</strong>。你需要 AI 来帮你更好生成整个项目的文档，而不仅仅是当前的代码片段注释。</p></li><li><p><strong>辅助架构分析</strong>。你需要结合代码库的 AST 来生成更好的架构分析报告，而不是自己去分析。</p></li></ul> 
 <p>还有大量的其它类似的需求，通过现有的 AI IDE 是无法满足的。</p> 
 <h4>2. 文本数据的多样性</h4> 
 <p>在完成自定义任务时，我们所需要的文本数据是丰富多样的。如在 AutoDev 中，用户可以从 IDE 中获取当前的文件、当前的代码片段、当前的选择、当前的光标位置等等。但是依旧存在一些问题：</p> 
 <ul><li><p><strong>缺少简单的文本处理逻辑</strong>。你可能只需要数据的一部分，而不是整个代码段或者文件作为上下文。</p></li><li><p><strong>更多的数据信息</strong>。你并不能获取到更多的数据，比如，你无法获取到当前的文件的 AST、你无法获取到当前的文件的语法树、你无法获取到当前的文件的类型等等。</p></li><li><p><strong>知识检索以提取关键信息</strong>。甚至于，由于你的代码库太大，生成单个 prompt 容易超过上下文，你需要做一些检索，以获取到你所需要的数据。这些都是当前 IDE 所不能满足的。</p></li></ul> 
 <p>如何通过一些简单的方式，以让用户能处理这些文本是我们所需要解决的问题。</p> 
 <h4>3. 数据获取的复杂性</h4> 
 <p>虽然，你可能有更种强烈的需求，但是你的 IDE 接口知识限制了你的能力。哪怕现在的生成式 AI 能力非常强大，但是你提不到一个好的问题，你也无法得到一个好的答案。 </p> 
 <p>诸如于，你不知道 IDE 领域的知识，RAG 无法发挥作用，需要大量的对话来增强你的知识库。然后，你还需要去开发一个 IDE 插件，去获取所需的文本数据，然后再去调用 AI 模型，这个过程是非常复杂的。</p> 
 <p>那么，我们能不能简化这个过程呢？</p> 
 <h4>4. 其它</h4> 
 <p>其实上面都不重要，重点是，我手痒，想写一个新的东西。</p> 
 <h3>Shire 编码智能体语言</h3> 
 <blockquote> 
  <p>Shire 提供了一种简便 AI 编码智能体语言，能够让大型语言模型（LLM）与控制集成开发环境（IDE）之间自由对话，以实现自动化编程。</p> 
 </blockquote> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/48/27/RgrzrDTb_o.png" alt="2fe98dc5109873f31067c8df3f27b92c.png"></p> 
 <p>简单来说，你可以通过 Shire 去：</p> 
 <ul><li><p>调用封装的 IDE API，以生成 prompt 所需的数据。在 Shire 中，数据在 prompt 中以变量的形式存在。</p></li><li><p>定义在 IDE 中的行为，如何触发、如何执行，以及如何处理结果。</p></li><li><p>定义简单的数据流处理，如何处理数据、如何存储数据。</p></li></ul> 
 <p>因此，你可以通过 Shire 作为中间语言，访问自己的 IDE 数据，生成与 AI 模型对话的 prompt，以实现自动化编程。</p> 
 <h4>Shire 设计原则</h4> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/bd/f7/CApI6UoO_o.png" alt="56153117cf5fa0e7c326eb486c69c43f.png"></p> 
 <p>结合先前的 AutoDev 开发经验，为了让开发人员更好地使用 AI IDE，我们定义了一些设计原则：</p> 
 <ul><li><p>原则 1：IDE 即上下文环境。围绕这一原则，去分解 IDE 的能力，对应有三个实现：上下文感知变量化、模式-动作上下文构建、AST 查询语言。</p></li><li><p>原则 2：语言即抽象接口。我们使用领域特定语言（DSL）来让开发人员定义 IDE 交互，同时自然语言作为 LLM 接口使用。</p></li><li><p>原则 3：原子功能单元。即将复杂系统分解为独立且功能明确的最小操作单元。这种设计原则受到 Linux 设计思想的启发，强调模块化、独立性和简洁性。</p></li></ul> 
 <p>详细的设计原则说明见：https://shire.phodal.com/design-principle.html</p> 
 <h4>Shire 示例</h4> 
 <p>先让我们再看一个简单的代码示例：</p> 
 <pre class="has"><code class="language-go">---
name: "On Streaming Done 文档更新"
actionLocation: ContextMenu
interaction: RunPanel
onStreamingEnd: { saveFile("docs/lifecycle/on-streaming-done.md")  }
---
根据如下当前的最新代码，更新现有的文档：
/file:ContextVariable.kt</code></pre> 
 <p>在这个示例中，我们定义了一个 AI 指令，以用于更新文档。在这个 AI 指令中，我们将通过 <code>file</code> 指令来获取当前的文件，然后转换为 LLM 的 prompt， 再交由 AI 模型来生成文档。最后，我们在 <code>onStreamingEnd</code> 里定义了，将文档保存到 <code>docs/lifecycle/on-streaming-done.md</code> 文件中。</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/c0/bd/eWGTrBBW_o.png" alt="8243d5452e18823db3c1bfd17a786d4e.png"></p> 
 <figcaption>
   Shire Doc Sample 
 </figcaption> 
 <p>当然了，你还可以定义更多复杂的 AI 指令，诸如于：</p> 
 <ul><li><p>定义 <code>selectionStrategy</code>，定义如何选择当前的代码片段。</p></li><li><p>定义触发条件 <code>when</code>，以定义何时在菜单上显示。</p></li><li><p>定义 <code>afterStreaming</code>，以在当前任务结束后，执行任务的决策，路由到不同的任务。</p></li></ul> 
 <p>详细参考：https://shire.phodal.com/shire/shire-hobbit-hole.html</p> 
 <h3>Shire 将如何帮助你设计专属 AI IDE 呢？</h3> 
 <h4>1. AI 武装的 IDE</h4> 
 <p>通过上面的示例，你可以看到 Shire 的基本能力，通过编写 Shire 代码，你可以结合 IDE 定义自己的 AI 指令。并将它们组织到一起，如下目录所示：</p> 
 <pre class="has"><code class="language-go">.shire
├── autotest.shire
├── commit-message.shire
├── javadoc.shire
├── quick-input.shire
├── refactoring-code.shire
├── search
│   └── TextSearch.shire
├── terminal.shire
├── workflow
│   ├── custom-agent.shire
│   └── lifecycle-streaming-end.shire
└── write-doc.shire</code></pre> 
 <p>在 <code>.shire</code> 目录中，你可以管理你的所有 AI 指令，以及定义它们的行为。</p> 
 <p>更详细的信息，可以参考我们的示例项目：https://github.com/shire-lang/shire-spring-java-demo</p> 
 <h4>2. 结合研发 AI Agent 打造端到端自动化</h4> 
 <p>与 AutoDev 相似，我们在 Shire 中也提供了 AI Agent 的能力。你只需要在项目中创建一个 <code>xxx.shireCustomAgent.json</code>，就可以在 Shire 代码中 调用它。</p> 
 <pre class="has"><code class="language-go">[
  {
    "name": "内部 API 集成",
    "description": "生成 API 信息",
    "url": "http://127.0.0.1:8765/api/agent/api-market",
    "responseAction": "Direct"
  }
]</code></pre> 
 <p>通过结合 AI Agent，你可以实现更多的自动化任务，如：自动化编写需求，自动化生成文档，自动化生成代码等等。同时，结合 Shire 的能力，你可以在执行 完当前 Shire 任务后，再执行新的 Shire 任务。</p> 
 <pre class="has"><code class="language-go">---
afterStreaming: {
    condition {
      "error"       { output.length &lt; 1 }
      "json-result" { jsonpath("${'$'}.store.*") }
    }
    case condition {
      "error"       { notify("Failed to Generate JSON") }
      "json-result" { execute("sample.shire") } /* go to execute sample.shire */
      default       { notify("Failed to Generate JSON") /* mean nothing */ }
    }
  }
---</code></pre> 
 <p>更详细的文档可以参考：https://shire.phodal.com/workflow/remote-ai-agent.html</p> 
 <h4>3. 本地 RAG</h4> 
 <p>在 Shire 中，我们提供了本地 RAG 的能力，你可以通过简单的配置，来使用本地的 RAG 模型，作为问答知识库的一部分。示例如下：</p> 
 <pre class="has"><code class="language-go">---
name: "Search"
variables:
  "testTemplate": /.*.java/ { caching("disk") | splitting | embedding | searching("comment") }
---
根据如下的代码，回答用户的问题：博客创建的流程
$testTemplate</code></pre> 
 <p>在这个示例中，我们定义了一个变量 <code>testTemplate</code>，它的值是从所有 <code>*.java</code> 文件中检索 <code>comment</code> 的结果。在这个定义中，我们使用了一系列的操作符， 如 <code>caching</code>、 <code>splitting</code>、 <code>embedding</code>、 <code>searching</code>，最后我们将结果返回给用户。</p> 
 <p>除了代码外，你还可以将文本文件、pdf、docx 等文件作为输入，以获取更多的信息。更详细的文档可以参考：https://shire.phodal.com/examples/search.html 。</p> 
 <h3>总结</h3> 
 <p>GitHub：https://github.com/phodal/shire</p> 
 <blockquote> 
  <p>Shire 智能体语言通过简便的 DSL 和设计原则，为开发人员提供了强大的自定义能力，使得大型语言模型（LLM）能够与控制集成开发环境（IDE）之间自由对话， 实现了自动化编程。Shire 的设计初衷是为了满足多样化的研发需求、处理复杂的数据获取以及简化开发流程。通过 Shire，开发人员可以设计专属的 AI IDE，实现端到端的自动化，提升研发效能。Shire 将成为你打造高效、智能化开发环境的得力助手。</p> 
 </blockquote> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/13cf7a959c9f324ba7d8ea6126e834ca/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">uniapp适配解决方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c559a60cc7a54b9859ad65af02b1857e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">构建未来对话：从零开始实现基于Vue 3的AI聊天页面</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>