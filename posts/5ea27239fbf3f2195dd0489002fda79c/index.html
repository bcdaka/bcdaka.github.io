<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>通过升级tomcat完美解决服务器的tomcat漏洞 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/5ea27239fbf3f2195dd0489002fda79c/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="通过升级tomcat完美解决服务器的tomcat漏洞">
  <meta property="og:description" content="目录 引言1 安全评估报告服务器漏洞的说明1.1 tomcat漏洞概况1.2 部分tomcat漏洞详情 2 针对漏洞的分析3 Tomcat 升级步骤步骤 1：下载最新的 Tomcat 版本步骤 2：解压 Tomcat 文件步骤 3：停止旧版本的 Tomcat步骤 4：备份旧的 Tomcat 配置（可选）步骤 5：替换文件夹步骤 6：启动新版本的 Tomcat步骤 7：查看 Tomcat 版本步骤 8：完成 Tomcat 升级 总结 引言 软件开发完成并交付给客户，过了一段时间，客户的上级部门要求对服务器进行安全检测，通过漏洞扫描，对服务器的漏洞情况进行通报，要求限期完成漏洞修补。客户一般没有技术能力，就找到软件开发公司，帮助其解决服务器的安全问题。我们做为软件开发人员，也会帮忙解决一些服务器安全方面的问题。
1 安全评估报告服务器漏洞的说明 首先看一下安全评估报告，报告中对服务器的漏洞，漏洞概况是一个所有漏洞的列表，这里仅选取tomcat漏洞。
1.1 tomcat漏洞概况 端口协议服务漏洞2201TCPwwwApache Tomcat 信息泄露漏洞(CVE-2020-17527) Apache Tomcat 输入验证错误漏洞(CVE-2023-46589) Apache Tomcat 环境问题漏洞(CVE-2022-42252) Apache Tomcat 拒绝服务漏洞(CVE-2023-24998) Apache Tomcat 安全漏洞(CVE-2021-25122) HTTP/2拒绝服务漏洞（CVE-2023-44487） Apache Tomcat 安全漏洞(CVE-2021-25329) Apache Tomcat 拒绝服务漏洞(CVE-2021-41079) Apache Tomcat 权限许可和访问控制问题漏洞(CVE-2022-23181) Apache Tomcat 代码问题漏洞(CVE-2022-29885) Apache Tomcat 代码问题漏洞(CVE-2022-25762) Alibaba Druid 未授权访问【原理扫描】 Apache Tomcat 信息泄露漏洞(CVE-2021-24122) Apache Tomcat 环境问题漏洞(CVE-2021-33037) Apache Tomcat 访问控制错误漏洞(CVE-2021-30640) Apache Tomcat 跨站脚本漏洞(CVE-2022-34305) Apache Tomcat文件包含漏洞(CVE-2023-28708) Apache Tomcat 输入验证错误漏洞(CVE-2023-41080) Apache Tomcat 安全漏洞(CVE-2023-42795) Apache Tomcat 输入验证错误漏洞(CVE-2023-45648) Apache Tomcat 安全漏洞(CVE-2024-23672) Apache Tomcat信息泄露漏洞(CVE-2024-21733) Apache Tomcat 输入验证错误漏洞(CVE-2024-24549)">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-03T08:31:38+08:00">
    <meta property="article:modified_time" content="2024-07-03T08:31:38+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">通过升级tomcat完美解决服务器的tomcat漏洞</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#_3" rel="nofollow">引言</a></li><li><a href="#1__7" rel="nofollow">1 安全评估报告服务器漏洞的说明</a></li><li><ul><li><a href="#11_tomcat_11" rel="nofollow">1.1 tomcat漏洞概况</a></li><li><a href="#12_tomcat_17" rel="nofollow">1.2 部分tomcat漏洞详情</a></li></ul> 
  </li><li><a href="#2__77" rel="nofollow">2 针对漏洞的分析</a></li><li><a href="#3_Tomcat__86" rel="nofollow">3 Tomcat 升级步骤</a></li><li><ul><li><a href="#_1_Tomcat__90" rel="nofollow">步骤 1：下载最新的 Tomcat 版本</a></li><li><a href="#_2_Tomcat__98" rel="nofollow">步骤 2：解压 Tomcat 文件</a></li><li><a href="#_3_Tomcat_106" rel="nofollow">步骤 3：停止旧版本的 Tomcat</a></li><li><a href="#_4_Tomcat__115" rel="nofollow">步骤 4：备份旧的 Tomcat 配置（可选）</a></li><li><a href="#_5_123" rel="nofollow">步骤 5：替换文件夹</a></li><li><a href="#_6_Tomcat_132" rel="nofollow">步骤 6：启动新版本的 Tomcat</a></li><li><a href="#_7_Tomcat__141" rel="nofollow">步骤 7：查看 Tomcat 版本</a></li><li><a href="#_8_Tomcat__155" rel="nofollow">步骤 8：完成 Tomcat 升级</a></li></ul> 
  </li><li><a href="#_160" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_3"></a>引言</h2> 
<p>软件开发完成并交付给客户，过了一段时间，客户的上级部门要求对服务器进行安全检测，通过漏洞扫描，对服务器的漏洞情况进行通报，要求限期完成漏洞修补。客户一般没有技术能力，就找到软件开发公司，帮助其解决服务器的安全问题。我们做为软件开发人员，也会帮忙解决一些服务器安全方面的问题。</p> 
<h2><a id="1__7"></a>1 安全评估报告服务器漏洞的说明</h2> 
<p>首先看一下安全评估报告，报告中对服务器的漏洞，漏洞概况是一个所有漏洞的列表，这里仅选取tomcat漏洞。</p> 
<h3><a id="11_tomcat_11"></a>1.1 tomcat漏洞概况</h3> 
<table><thead><tr><th>端口</th><th>协议</th><th>服务</th><th>漏洞</th></tr></thead><tbody><tr><td>2201</td><td>TCP</td><td>www</td><td>Apache Tomcat 信息泄露漏洞(CVE-2020-17527) <br> Apache Tomcat 输入验证错误漏洞(CVE-2023-46589) <br> Apache Tomcat 环境问题漏洞(CVE-2022-42252) <br> Apache Tomcat 拒绝服务漏洞(CVE-2023-24998) <br>Apache Tomcat 安全漏洞(CVE-2021-25122) <br> HTTP/2拒绝服务漏洞（CVE-2023-44487） <br> Apache Tomcat 安全漏洞(CVE-2021-25329) <br> Apache Tomcat 拒绝服务漏洞(CVE-2021-41079) <br> Apache Tomcat 权限许可和访问控制问题漏洞(CVE-2022-23181) <br> Apache Tomcat 代码问题漏洞(CVE-2022-29885) <br> Apache Tomcat 代码问题漏洞(CVE-2022-25762) <br> Alibaba Druid 未授权访问【原理扫描】 <br> Apache Tomcat 信息泄露漏洞(CVE-2021-24122) <br> Apache Tomcat 环境问题漏洞(CVE-2021-33037) <br> Apache Tomcat 访问控制错误漏洞(CVE-2021-30640) <br> Apache Tomcat 跨站脚本漏洞(CVE-2022-34305) <br> Apache Tomcat文件包含漏洞(CVE-2023-28708) <br> Apache Tomcat 输入验证错误漏洞(CVE-2023-41080) <br> Apache Tomcat 安全漏洞(CVE-2023-42795) <br> Apache Tomcat 输入验证错误漏洞(CVE-2023-45648) <br> Apache Tomcat 安全漏洞(CVE-2024-23672) <br> Apache Tomcat信息泄露漏洞(CVE-2024-21733) <br> Apache Tomcat 输入验证错误漏洞(CVE-2024-24549)<br>Apache Tomcat 竞争条件问题漏洞(CVE-2021-43980)</td></tr></tbody></table> 
<h3><a id="12_tomcat_17"></a>1.2 部分tomcat漏洞详情</h3> 
<p>然后针对每个漏洞的说明，如下是一个tomcat严重漏洞的详细信息</p> 
<table><thead><tr><th>漏洞名称</th><th>Apache Tomcat 输入验证错误漏洞(CVE-2023-46589)</th></tr></thead><tbody><tr><td>详细描述</td><td>Apache Tomcat是美国阿帕奇（Apache）基金会的一款轻量级Web应用服务器。该程序实现了对Servlet和JavaServer Page（JSP）的支持。 Apache Tomcat存在输入验证错误漏洞，该漏洞源于存在不正确的输入验证漏洞，可能会导致将单个请求视为多个请求，从而在反向代理后面出现请求走私。</td></tr><tr><td>解决办法</td><td>厂商补丁: 目前厂商已发布升级补丁以修复漏洞，补丁获取链接: https://lists.apache.org/thread/0rqq6ktozqc42ro8hhxdmmdjm1k1tpxr</td></tr><tr><td>威胁分值</td><td>7.5</td></tr><tr><td>危险插件</td><td>否</td></tr><tr><td>发现日期</td><td>2023-11-28</td></tr><tr><td>CVE编号</td><td>CVE-2023-46589</td></tr><tr><td>CNNVD编号</td><td>CNNVD-202311-2168</td></tr><tr><td>CNCVE编号</td><td>CNCVE-202346589</td></tr></tbody></table> 
<table><thead><tr><th>漏洞名称</th><th>Apache Tomcat 环境问题漏洞(CVE-2022-42252)</th></tr></thead><tbody><tr><td>详细描述</td><td>Apache Tomcat是美国阿帕奇（Apache）基金会的一款轻量级Web应用服务器。该程序实现了对Servlet和JavaServer Page（JSP）的支持。 Apache Tomcat 存在环境问题漏洞，该漏洞源于当 rejectIllegalHeader 设置为 false 时，Tomcat 可能存在请求走私问题（Request Smuggling）。</td></tr><tr><td>解决办法</td><td>厂商补丁: 目前厂商已发布升级补丁以修复漏洞，详情请关注厂商主页： https://tomcat.apache.org/security-8.html https://tomcat.apache.org/security-9.html https://tomcat.apache.org/security-10.html</td></tr><tr><td>威胁分值</td><td>7.5</td></tr><tr><td>危险插件</td><td>否</td></tr><tr><td>发现日期</td><td>2022-10-31</td></tr><tr><td>CVE编号</td><td>CVE-2022-42252</td></tr><tr><td>CNNVD编号</td><td>CNNVD-202210-2602</td></tr><tr><td>CNCVE编号</td><td>CNCVE-202242252</td></tr></tbody></table> 
<table><thead><tr><th>漏洞名称</th><th>Apache Tomcat 拒绝服务漏洞(CVE-2023-24998)</th></tr></thead><tbody><tr><td>详细描述</td><td>Apache Tomcat是美国阿帕奇（Apache）基金会的一款轻量级Web应用服务器。该程序实现了对Servlet和JavaServer Page（JSP）的支持。 Apache Tomcat使用Apache Commons FileUpload的打包重命名副本来提供Jakarta Servlet规范中定义的文件上传功能。因此，Apache Tomcat也容易受到Apache Commons FileUpload漏洞CVE-2023-24998的攻击，因为处理的请求部分数量没有限制。这导致攻击者有可能通过恶意上传或一系列上传触发DoS。</td></tr><tr><td>解决办法</td><td>厂商补丁: 目前厂商已发布升级补丁以修复漏洞，补丁获取链接： https://tomcat.apache.org/security-9.html</td></tr><tr><td>威胁分值</td><td>7.5</td></tr><tr><td>危险插件</td><td>否</td></tr><tr><td>发现日期</td><td>2023-02-20</td></tr><tr><td>CVE编号</td><td>CVE-2023-24998</td></tr><tr><td>CNNVD编号</td><td>CNNVD-202302-1610</td></tr><tr><td>CNCVE编号</td><td>CNCVE-202324998</td></tr><tr><td>CNVD编号</td><td>CNVD-2023-23552</td></tr></tbody></table> 
<table><thead><tr><th>漏洞名称</th><th>Apache Tomcat 安全漏洞(CVE-2021-25122)</th></tr></thead><tbody><tr><td>详细描述</td><td>当响应新的h2c连接请求时，Apache Tomcat可以将请求标头和数量有限的请求主体从一个请求复制到另一个请求，这将导致用户A和用户B都可以看到用户A的请求结果。</td></tr><tr><td>解决办法</td><td>厂商补丁： Apache Tomcat ----------- 厂商已发布了漏洞修复程序，请及时关注更新： https://tomcat.apache.org/security-10.html</td></tr><tr><td>威胁分值</td><td>7.5</td></tr><tr><td>危险插件</td><td>否</td></tr><tr><td>发现日期</td><td>2021-03-02</td></tr><tr><td>CVE编号</td><td>CVE-2021-25122</td></tr><tr><td>CNNVD编号</td><td>CNNVD-202103-008</td></tr><tr><td>CNCVE编号</td><td>CNCVE-202125122</td></tr><tr><td>CVSS评分</td><td>5</td></tr></tbody></table> 
<p>下面是报告中tomcat的版本信息</p> 
<table><thead><tr><th>软件名称</th><th>版本号</th></tr></thead><tbody><tr><td>Tomcat</td><td>8.5.58</td></tr></tbody></table> 
<h2><a id="2__77"></a>2 针对漏洞的分析</h2> 
<p>通过查看漏洞详细信息，可以看到tomcat厂商已经发布升级补丁，能够修复漏洞。几乎所有的tomcat漏洞详细信息中，都有类似的解决办法描述。也就是通过升级tomcat就可以解决问题。</p> 
<p>解决办法中，都有补丁的链接，因为是针对特定补丁的链接，如果我们对每个漏洞都挨个打补丁，工作量会非常大，我们分析，tomcat软件碰到漏洞后，他们就会发布补丁，同时在他们的新版本中肯定会解决这个问题，随着版本的升高，漏洞就会越来越少。</p> 
<p>所以，我们采取的策略就是将tomcat升级到最新版本，这里的最新版本指的是小版本的最新版本，比如报告中tomcat版本是8.5.58，我们查阅tomcat官网，选取8.5这个版本的最新版本，我们查阅tomcat官网，tomcat8.5.100是8.5的最新版本，我们最终采用8.5.100做为升级的版本，这个版本能够解决已知的所有tomcat漏洞。</p> 
<h2><a id="3_Tomcat__86"></a>3 Tomcat 升级步骤</h2> 
<p>升级 Tomcat 的过程中，需要下载新版本、停止旧版本、替换相关文件夹并重新启动。以下是详细的步骤和具体的 shell 命令：</p> 
<h3><a id="_1_Tomcat__90"></a>步骤 1：下载最新的 Tomcat 版本</h3> 
<p>首先，从 Apache Tomcat 的官方网站下载最新的 Tomcat 版本。例如，下载 <code>tomcat-8.5.100</code>。</p> 
<pre><code class="prism language-bash"><span class="token function">wget</span> https://downloads.apache.org/tomcat/tomcat-8/v8.5.100/bin/apache-tomcat-8.5.100.tar.gz
</code></pre> 
<h3><a id="_2_Tomcat__98"></a>步骤 2：解压 Tomcat 文件</h3> 
<p>将下载的 tar.gz 文件解压到所需的目录中。</p> 
<pre><code class="prism language-bash"><span class="token function">tar</span> <span class="token parameter variable">-xzvf</span> apache-tomcat-8.5.100.tar.gz <span class="token parameter variable">-C</span> /path/to/desired/location
</code></pre> 
<h3><a id="_3_Tomcat_106"></a>步骤 3：停止旧版本的 Tomcat</h3> 
<p>进入旧版本 Tomcat 的 <code>bin</code> 目录并执行停止命令。</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">cd</span> /path/tomcat-8.5.58/bin
./shutdown.sh
</code></pre> 
<h3><a id="_4_Tomcat__115"></a>步骤 4：备份旧的 Tomcat 配置（可选）</h3> 
<p>为了安全起见，可以备份旧版本的 <code>conf</code> 文件夹，以防升级过程中出现问题。</p> 
<pre><code class="prism language-bash"><span class="token function">cp</span> <span class="token parameter variable">-r</span> /path/tomcat-8.5.58/conf /path/backup/location
</code></pre> 
<h3><a id="_5_123"></a>步骤 5：替换文件夹</h3> 
<p>将新版本 Tomcat 的 <code>bin</code> 和 <code>lib</code> 文件夹替换旧版本的相应文件夹。</p> 
<pre><code class="prism language-bash"><span class="token function">cp</span> <span class="token parameter variable">-r</span> /path/apache-tomcat-8.5.100/bin /path/tomcat-8.5.58/
<span class="token function">cp</span> <span class="token parameter variable">-r</span> /path/apache-tomcat-8.5.100/lib /path/tomcat-8.5.58/
</code></pre> 
<h3><a id="_6_Tomcat_132"></a>步骤 6：启动新版本的 Tomcat</h3> 
<p>进入新版本 Tomcat 的 <code>bin</code> 目录并执行启动命令。</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">cd</span> /path/tomcat-8.5.58/bin
./startup.sh
</code></pre> 
<h3><a id="_7_Tomcat__141"></a>步骤 7：查看 Tomcat 版本</h3> 
<p>启动 Tomcat 后，检查 Tomcat 的版本以确保升级成功。</p> 
<pre><code class="prism language-bash"><span class="token function">curl</span> http://localhost:8080
</code></pre> 
<p>或者，查看日志文件以确认版本信息。</p> 
<pre><code class="prism language-bash"><span class="token function">tail</span> <span class="token parameter variable">-n</span> <span class="token number">100</span> /path/tomcat-8.5.58/logs/catalina.out <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"Server version"</span>
</code></pre> 
<h3><a id="_8_Tomcat__155"></a>步骤 8：完成 Tomcat 升级</h3> 
<p>如果上述步骤都顺利完成，并且确认新版本 Tomcat 已经成功启动，则表示 Tomcat 升级完成。</p> 
<h2><a id="_160"></a>总结</h2> 
<p>为了修补 Tomcat 的漏洞，可以通过升级到最新的小版本来解决。升级过程相对简单，只需要将新版本的 <code>bin</code> 和 <code>lib</code> 文件夹替换旧版本中的相应文件夹即可。这种方法能够确保系统快速、安全地应用最新的安全补丁，提升 Tomcat 的整体稳定性和安全性。具体步骤包括下载最新的小版本 Tomcat，解压后替换旧版本的 <code>bin</code> 和 <code>lib</code> 文件夹，最后重启 Tomcat 服务即可完成升级。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f854e4959eafb6125c03c75d9e5a8458/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Oracle HTTP Server（OHS）与Oracle数据库的紧密绑定</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bc6e483f81d0b264c5ef166ba11fc994/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Spark性能优化（第22天）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>