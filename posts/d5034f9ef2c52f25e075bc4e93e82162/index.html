<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ã€Linuxã€‘Centos7 shellå®ç°MySQL5.7 tar ä¸€é”®å®‰è£… - ç¼–ç¨‹å¤§å’–</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/d5034f9ef2c52f25e075bc4e93e82162/">
  <meta property="og:site_name" content="ç¼–ç¨‹å¤§å’–">
  <meta property="og:title" content="ã€Linuxã€‘Centos7 shellå®ç°MySQL5.7 tar ä¸€é”®å®‰è£…">
  <meta property="og:description" content="ğŸ¦„ ä¸ªäººä¸»é¡µâ€”â€”ğŸä¸ªäººä¸»é¡µ ğŸâœ¨ğŸ
ğŸªğŸğŸªğŸğŸªğŸğŸªğŸ æ„Ÿè°¢ç‚¹èµå’Œå…³æ³¨ ï¼Œæ¯å¤©è¿›æ­¥ä¸€ç‚¹ç‚¹ï¼åŠ æ²¹ï¼ğŸªğŸğŸªğŸğŸªğŸğŸªğŸ
ç›®å½•
ä¸€ã€å®‰è£…ä¸‹è½½
äºŒã€æ‰§è¡Œå®‰è£…
ä¸€ã€å®‰è£…ä¸‹è½½ ä¸‹è½½åœ°å€ï¼š
https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.44-el7-x86_64.tar.gz
è„šæœ¬å’ŒtaråŒ…ç»“æ„
my.cnf é…ç½®æ–‡ä»¶
[root@windp-aio opt]# cat config/my.cnf [mysql] socket=/var/lib/mysql/mysql.sock # set mysql client default chararter default-character-set=utf8 [mysqld] socket=/var/lib/mysql/mysql.sock # set mysql server port port = 3306 # set mysql install base dir basedir=/usr/local/mysql # set the data store dir datadir=/usr/local/mysql/data # set the number of allow max connnection max_connections=200 # set server charactre default encoding character-set-server=utf8 # the storage engine default-storage-engine=INNODB lower_case_table_names=1 max_allowed_packet=16M explicit_defaults_for_timestamp=true [mysql.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-11-11T16:57:10+08:00">
    <meta property="article:modified_time" content="2023-11-11T16:57:10+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§å’–" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§å’–</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ã€Linuxã€‘Centos7 shellå®ç°MySQL5.7 tar ä¸€é”®å®‰è£…</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p class="img-center"><img alt="" height="534" id="z0IQC" src="https://images2.imgbox.com/36/80/i68NggrR_o.png" width="950"></p> 
<h3 id="H3dQk"></h3> 
<blockquote> 
 <p id="u5d85d1e0" style="text-align:center;">ğŸ¦„ <strong>ä¸ªäººä¸»é¡µâ€”â€”ğŸ</strong><a href="https://blog.csdn.net/qq_35995514?type=blog" title="ä¸ªäººä¸»é¡µ">ä¸ªäººä¸»é¡µ</a> ğŸâœ¨ğŸ</p> 
 <p id="u61d52a22" style="text-align:center;"><strong>ğŸªğŸğŸªğŸğŸªğŸğŸªğŸ æ„Ÿè°¢ç‚¹èµå’Œå…³æ³¨ ï¼Œæ¯å¤©è¿›æ­¥ä¸€ç‚¹ç‚¹ï¼åŠ æ²¹ï¼ğŸªğŸğŸªğŸğŸªğŸğŸªğŸ</strong></p> 
</blockquote> 
<p id="main-toc"><strong>ç›®å½•</strong></p> 
<p id="lXsWR-toc" style="margin-left:40px;"><a href="#lXsWR" rel="nofollow">ä¸€ã€å®‰è£…ä¸‹è½½</a></p> 
<p id="JUViq-toc" style="margin-left:40px;"><a href="#JUViq" rel="nofollow">äºŒã€æ‰§è¡Œå®‰è£…</a></p> 
<hr id="hr-toc"> 
<h3><span style="color:#956fe7;">ä¸€ã€å®‰è£…ä¸‹è½½</span></h3> 
<hr id="hb2li"> 
<p id="ue308fe9c"></p> 
<p class="img-center"><img alt="" height="337" id="ud25ec624" src="https://images2.imgbox.com/dd/e0/jnypmA2i_o.png" width="1189"></p> 
<p id="u697b04fb">ä¸‹è½½åœ°å€ï¼š</p> 
<p id="ufbe9a604"><a href="https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.44-el7-x86_64.tar.gz" rel="nofollow" title="https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.44-el7-x86_64.tar.gz">https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.44-el7-x86_64.tar.gz</a></p> 
<p id="uce08077f"><strong>è„šæœ¬å’ŒtaråŒ…ç»“æ„</strong></p> 
<p id="u93fac07b"></p> 
<p class="img-center"><img alt="" height="372" id="u8e2d80a7" src="https://images2.imgbox.com/a6/f3/AOoeuWlQ_o.png" width="966"></p> 
<p id="u2598bb15"><strong>my.cnf é…ç½®æ–‡ä»¶</strong></p> 
<pre id="tdy9U"><code class="language-cs">[root@windp-aio opt]# cat config/my.cnf 
[mysql]
socket=/var/lib/mysql/mysql.sock
# set mysql client default chararter
default-character-set=utf8

[mysqld]
socket=/var/lib/mysql/mysql.sock
# set mysql server port  
port = 3306
# set mysql install base dir
basedir=/usr/local/mysql
# set the data store dir
datadir=/usr/local/mysql/data
# set the number of allow max connnection
max_connections=200
# set server charactre default encoding
character-set-server=utf8
# the storage engine
default-storage-engine=INNODB
lower_case_table_names=1
max_allowed_packet=16M
explicit_defaults_for_timestamp=true
[mysql.server]
user=mysql
basedir=/usr/local/mysql
</code></pre> 
<hr id="GUue7"> 
<h3 id="JUViq"><span style="color:#956fe7;">äºŒã€æ‰§è¡Œå®‰è£…</span></h3> 
<hr id="NAHzy"> 
<p id="u3d349266"><strong>install_mysql.sh å®‰è£…è„šæœ¬</strong></p> 
<pre id="Fe41l"><code class="language-bash">#! /bin/bash
#
# Author: kangll
# CreateTime: 2023-11-10
# Desc: install mysql5.7.44
#
echo "******** INSTALL MYSQL *********"

BASEDIR=$(cd "$(dirname "$0")"; pwd)

# å¸è½½åŸæœ‰çš„mariadb
OLD_MYSQL=`rpm -qa|grep mariadb`
profile=/etc/profile
for mariadb in $OLD_MYSQL
do
	rpm -e --nodeps $mariadb
done

# åˆ é™¤åŸæœ‰çš„my.cnf
rm -rf /etc/my.cnf

#æ·»åŠ ç”¨æˆ·ç»„ ç”¨æˆ·
groupadd mysql
useradd -g mysql mysql

#è§£å‹mysqlåŒ…å¹¶ä¿®æ”¹åç§°
tar -zxvf  $BASEDIR/mysql-5.7.44-el7-x86_64.tar.gz -C /usr/local
mv /usr/local/mysql-5.7.44-el7-x86_64 /usr/local/mysql

#æ›´æ”¹æ‰€å±çš„ç»„å’Œç”¨æˆ·
chown -R mysql /usr/local/mysql
chgrp -R mysql /usr/local/mysql

mkdir -p /usr/local/mysql/data
mkdir -p /usr/local/mysql/log
chown -R mysql:mysql /usr/local/mysql/data

#ç²˜è´´é…ç½®æ–‡ä»¶my.cnf å†…å®¹è§å…« ä¸­çš„ my.cnf
cp $BASEDIR/config/my.cnf /usr/local/mysql/

# å®‰è£…mysql
/usr/local/mysql/bin/mysql_install_db --user=mysql --basedir=/usr/local/mysql/ --datadir=/usr/local/mysql/data/

# è®¾ç½®æ–‡ä»¶åŠç›®å½•æƒé™ï¼š
cp /usr/local/mysql/support-files/mysql.server /etc/init.d/mysqld
chown 777 /usr/local/mysql/my.cnf
chmod +x /etc/init.d/mysqld

mkdir /var/lib/mysql
chmod 777  /var/lib/mysql

# å¯åŠ¨mysql
/etc/init.d/mysqld start

# è®¾ç½®å¼€æœºå¯åŠ¨
chkconfig --level 35 mysqld on
chmod +x /etc/rc.d/init.d/mysqld
chkconfig --add mysqld

# ä¿®æ”¹ç¯å¢ƒå˜é‡ 
ln -s /usr/local/mysql/bin/mysql /usr/bin
ln -s /var/lib/mysql/mysql.sock   /tmp/
cat &gt; /etc/profile.d/mysql.sh&lt;&lt;EOF
  export PATH=$PATH:/usr/local/mysql/bin
EOF
mysqlPw=`sed -n 2p /root/.mysql_secret`
mysqlPwTMP=`sed -n 2p /root/.mysql_secret`1
mysqlNewPw=Winner001
hostname=`"hostname"`
#ssh $hostname "source /etc/profile;java -version"
ssh $hostname "source /etc/profile;mysqladmin -h127.0.0.1 -uroot -p'$mysqlPw' password '$mysqlPwTMP';mysqladmin -h127.0.0.1 -uroot -p'$mysqlPwTMP' password '$mysqlNewPw';exit"


echo "******** MYSQL installation completed *******</code></pre> 
<p id="u2c67b389">æ‰§è¡Œå®Œè„šæœ¬ æˆåŠŸç™»å½•</p> 
<p class="img-center"><img alt="" height="820" id="u29a9549c" src="https://images2.imgbox.com/30/a7/lvvSbHJa_o.png" width="1102"></p> 
<p id="u35ed0948">ssh æ“ä½œéœ€è¦å…å¯† é™„ä¸Š æœ¬æœºå…å¯†è„šæœ¬ ssh_keygen.sh</p> 
<pre id="d3hQE"><code class="language-bash">#! /bin/bash
#
#Author: kangll
#CreateTime: 2023-11-10
#Desc: æœ¬æœºå…å¯†
#
set -x
# get ip 
ip=$(ip addr show | grep -E 'inet [0-9]' | awk '{print $2}' | awk -F '/' '{print $1}' | sed -n '$p')
ssh_hosts=${ip}
ssh_networkname=(windp-aio)
ssh_passwd=winner@001
 
# å®šä¹‰ä¿®æ”¹/etc/hostsæ–‡ä»¶çš„æ–¹æ³•
#echo "å¼€å§‹ä¿®æ”¹åœ°å€æ˜ å°„"
 
#for ((i=0;i&lt;${#ssh_hosts[*]};i++));do
#    sed -i '/^'"${ssh_hosts[$i]}"'/d' /etc/hosts
#	echo "å°è¯•è¿æ¥: ${ssh_networkname[$i]}"
#	timeout 5 ssh root@${ssh_networkname[$i]} "echo ${ssh_networkname[$i]}: 'This is success!'"
#	if [[ $? -ne 0 ]];then
#		echo "æ·»åŠ åœ°å€æ˜ å°„:${ssh_hosts[$i]} ${ssh_networkname[$i]}"
#		echo "${ssh_hosts[$i]} ${ssh_networkname[$i]}" &gt;&gt; /etc/hosts
#	fi
#done
 
expect -v
if [ `echo $?` -ne 0 ];then
	echo "å®‰è£…expectå‘½ä»¤"
	yum install -y expect
fi 
################################
#
################################
create_ssh_pub(){
	echo "ç”Ÿæˆæœ¬åœ°sshå…¬é’¥"
	/usr/bin/expect &lt;&lt; eof
	# è®¾ç½®æ•è·å­—ç¬¦ä¸²åï¼ŒæœŸå¾…å›å¤çš„è¶…æ—¶æ—¶é—´
	set timeout 30
	 
	spawn ssh-keygen -t rsa -b 1024
	 
	## å¼€å§‹è¿›è¿ç»­æ•è·
	expect	{
		".ssh/id_rsa)"      { send "\n";  exp_continue }
		"Overwrite (y/n)?"  { send "y\n"; exp_continue }
		"no passphrase):"   { send "\n";  exp_continue }
		"passphrase again:" { send "\n";  exp_continue }
	}
eof
}
if [ ! -f /root/.ssh/id_rsa.pub ];then
	create_ssh_pub
fi
 
#################################
# å®šä¹‰å¤åˆ¶sshå…¬é’¥æ–¹æ³•
#################################
config_copy_ssh(){
	echo "å¤åˆ¶å…¬é’¥åˆ°å¯¹åº”çš„ä¸»æœºä¸Š"
	/usr/bin/expect &lt;&lt; eof
	# è®¾ç½®æ•è·å­—ç¬¦ä¸²åï¼ŒæœŸå¾…å›å¤çš„è¶…æ—¶æ—¶é—´
	set timeout 30
	 
	spawn ssh-copy-id -i /root/.ssh/id_rsa.pub $1@$2
	 
	## å¼€å§‹è¿›è¿ç»­æ•è·
	expect	{
		"connecting (yes/no)?" { send "yes\n";  exp_continue }
		"s password:"          { send "${ssh_passwd}\n"; exp_continue }
	}
eof
}
for name in ${ssh_networkname[*]};do
	timeout 5 ssh root@${name} "echo ${name}: 'This is success!'"
	if [[ $? -ne 0 ]];then
		echo "å¤åˆ¶æ–‡ä»¶åˆ°: ${name}"
		config_copy_ssh root ${name} &gt; /dev/null
	fi
	
done</code></pre> 
<p>å‚è€ƒé“¾æ¥ï¼š<a href="https://blog.csdn.net/jzy3711/article/details/106262750" title="ansible å®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²ambariï¼ˆçº¯ç¦»çº¿ï¼‰_ansible ambari-CSDNåšå®¢">ansible å®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²ambariï¼ˆçº¯ç¦»çº¿ï¼‰_ansible ambari-CSDNåšå®¢</a>Â </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5b86e48e55a061cf86685107a918d871/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">C/C&#43;&#43;æ•°æ®ç»“æ„ä¹‹é“¾è¡¨é¢˜ç›®ç­”æ¡ˆä¸è§£æ</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1dbdab9449d99a28846105ce0401f20c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">2024ï¼ˆ20å±Šï¼‰æ•°æ®ç§‘å­¦ä¸å¤§æ•°æ®ä¸“ä¸šæ¯•ä¸šè®¾è®¡é€‰é¢˜åˆé›†</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§å’–.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>