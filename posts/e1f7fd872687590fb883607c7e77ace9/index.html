<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>OpenVINO2024.2 - 三行代码完成生成式AI部署 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/e1f7fd872687590fb883607c7e77ace9/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="OpenVINO2024.2 - 三行代码完成生成式AI部署">
  <meta property="og:description" content="英特尔边缘计算创新大使 贾志刚
OpenVINO介绍 OpenVINO2024.2版本跟之前版本最大的不同是OpenVINO2024.2分为两个安装包分别是基础包与生成式AI支持包，新发布的GenAI开发包支持C&#43;&#43;与Python语言接口调用，支持多种LLM加载与推理部署能力，实现了OpenVINO对CNN网络、生成式模型、LLM网络主流模型的全面推理支持。安装包下载地址如下：
https://docs.openvino.ai/install
OpenVINO生成式AI支持 OpenVINO2024版本支持大量文本、图像、音频生成模型，如 Llama 2、MPT、OPT、Stable Diffusion、Stable Diffusion XL。这样可以开发多模式应用程序，从而实现一次写入、随处部署的功能。OpenVINO支持的生成式AI方式主要包括以下三种方式分别是：
Hugging Face：通过 Optimum Intel 扩展，使用 OpenVINO 作为 Hugging Face 框架（转换器、扩散器）的后端。
OpenVINO GenAI 风格:使用 OpenVINO 生成式AI的APIs (Python and C&#43;&#43;)
基础 OpenVINO：OpenVINO 原生 API（Python 和 C&#43;&#43;）与自定义管道代码一起使用
三种部署方式好处与不同： Hugging Face API 易于学习，提供简单的界面，并隐藏了模型初始化和文本生成的复杂性，以获得更好的开发人员体验。但是，它具有更多的依赖项、更少的自定义项，并且无法移植到 C/C&#43;&#43;。
OpenVINO GenAI Flavor 通过自动管理文本生成循环、标记化和调度等基本任务来降低 LLM 实现的复杂性。原生 OpenVINO API 提供了更多的实践体验，需要手动设置这些功能。这两种方法都旨在最大程度地减少依赖关系和整体应用程序占用空间，并允许在 C&#43;&#43; 应用程序中使用生成模型。
建议从拥抱脸框架开始，尝试不同的模型和场景。然后，如果需要进一步优化，该模型可以与 OpenVINO API 一起使用。Optimum Intel 提供的接口支持使用神经网络压缩框架 （NNCF） 进行模型优化（权重压缩），并将模型导出为 OpenVINO 模型格式，以便在原生 API 应用程序中使用。
LLM推理支持 像 GPT 这样的大型语言模型 （LLM） 是变革性的深度学习网络，能够完成从文本生成到语言翻译的广泛自然语言任务。OpenVINO2024优化了这些模型的部署，增强了它们的性能并集成到各种应用中。下面的代码展示了如何将 LLM 与 OpenVINO20204 结合使用，从模型加载和转换到高级用例">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-12T14:55:02+08:00">
    <meta property="article:modified_time" content="2024-07-12T14:55:02+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">OpenVINO2024.2 - 三行代码完成生成式AI部署</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:0;text-align:justify;"><span style="background-color:#FFFFFF;"><span style="color:#000000;">英特尔边缘计算创新大使</span></span> <span style="background-color:#FFFFFF;"><span style="color:#000000;">贾志刚</span></span></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<h2 style="margin-left:0px;text-align:justify;">OpenVINO介绍</h2> 
<p style="margin-left:0;text-align:left;"><img alt="" height="515" src="https://images2.imgbox.com/a4/f4/CKQHK1Ev_o.png" width="1004"></p> 
<p style="margin-left:0;text-align:justify;">OpenVINO2024.2版本跟之前版本最大的不同是OpenVINO2024.2分为两个安装包分别是基础包与生成式AI支持包，新发布的GenAI开发包支持C++与Python语言接口调用，支持多种LLM加载与推理部署能力，实现了OpenVINO对CNN网络、生成式模型、LLM网络主流模型的全面推理支持。安装包下载地址如下：</p> 
<p style="margin-left:0;text-align:justify;">https://docs.openvino.ai/install</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="436" src="https://images2.imgbox.com/4b/c0/NtMUDC6j_o.png" width="994"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<h2 style="margin-left:0px;text-align:justify;">OpenVINO生成式AI支持</h2> 
<p style="margin-left:0;text-align:justify;">OpenVINO2024版本支持大量文本、图像、音频生成模型，如 Llama 2、MPT、OPT、Stable Diffusion、Stable Diffusion XL。这样可以开发多模式应用程序，从而实现一次写入、随处部署的功能。OpenVINO支持的生成式AI方式主要包括以下三种方式分别是：</p> 
<p style="margin-left:0;text-align:justify;">Hugging Face：通过 Optimum Intel 扩展，使用 OpenVINO 作为 Hugging Face 框架（转换器、扩散器）的后端。</p> 
<p style="margin-left:0;text-align:justify;">OpenVINO GenAI 风格:使用 OpenVINO 生成式AI的APIs (Python and C++)</p> 
<p style="margin-left:0;text-align:justify;">基础 OpenVINO：OpenVINO 原生 API（Python 和 C++）与自定义管道代码一起使用</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<h2 style="margin-left:0px;text-align:justify;">三种部署方式好处与不同：</h2> 
<p style="margin-left:0;text-align:justify;">Hugging Face API 易于学习，提供简单的界面，并隐藏了模型初始化和文本生成的复杂性，以获得更好的开发人员体验。但是，它具有更多的依赖项、更少的自定义项，并且无法移植到 C/C++。</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">OpenVINO GenAI Flavor 通过自动管理文本生成循环、标记化和调度等基本任务来降低 LLM 实现的复杂性。原生 OpenVINO API 提供了更多的实践体验，需要手动设置这些功能。这两种方法都旨在最大程度地减少依赖关系和整体应用程序占用空间，并允许在 C++ 应用程序中使用生成模型。</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">建议从拥抱脸框架开始，尝试不同的模型和场景。然后，如果需要进一步优化，该模型可以与 OpenVINO API 一起使用。Optimum Intel 提供的接口支持使用神经网络压缩框架 （NNCF） 进行模型优化（权重压缩），并将模型导出为 OpenVINO 模型格式，以便在原生 API 应用程序中使用。</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="767" src="https://images2.imgbox.com/4f/b0/BFsFI2QH_o.png" width="921"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<h2 style="margin-left:0px;text-align:justify;">LLM推理支持</h2> 
<p style="margin-left:0;text-align:justify;">像 GPT 这样的大型语言模型 （LLM） 是变革性的深度学习网络，能够完成从文本生成到语言翻译的广泛自然语言任务。OpenVINO2024优化了这些模型的部署，增强了它们的性能并集成到各种应用中。下面的代码展示了如何将 LLM 与 OpenVINO20204 结合使用，从模型加载和转换到高级用例</p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="315" src="https://images2.imgbox.com/0c/d2/LaZiHh5p_o.png" width="772"></p> 
<p style="margin-left:0;text-align:left;"></p> 
<p style="margin-left:0;text-align:left;">Python版本开发包安装</p> 
<pre><code class="hljs">​
pip install openvino-genai==2024.2.0

pip install optimum-intel -i Simple Index

​</code></pre> 
<p style="margin-left:0;text-align:justify;">安装optimum</p> 
<pre><code class="hljs">pip install -i https://pypi.tuna.tsinghua.edu.cn/simple optimum auto-gptq

pip install openvino-tokenizers</code></pre> 
<p style="margin-left:0;text-align:left;"></p> 
<p style="margin-left:0;text-align:left;">OpenVINO加速支持</p> 
<pre><code class="hljs">pip install --upgrade-strategy eager optimum[openvino,nncf]

export HF_ENDPOINT=https://hf-mirror.com



optimum-cli export openvino --model "TinyLlama/TinyLlama-1.1B-Chat-v1.0" --weight-format fp16 --trust-remote-code output</code></pre> 
<p style="margin-left:0;text-align:left;"><img alt="" height="366" src="https://images2.imgbox.com/a7/5e/CzxfBPFy_o.png" width="1200"></p> 
<p style="margin-left:0;text-align:left;"></p> 
<p style="margin-left:0;text-align:left;">需要注意一下版本匹配问题，因为我之前安装了optimum版本较低导致无法生成分词得OpenVINO文件，所以直接推理挂，然后更新到最新版本就好，相关支持依赖包支持版本（亲测有效）</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="147" src="https://images2.imgbox.com/02/d5/MwLdw6uj_o.png" width="390"></p> 
<p style="margin-left:0;text-align:justify;">如您所见，只需要几行代码就能建立一个LLM生成的流水线。这是因为从 Hugging Face Optimum-Intel 导出模型后，它已经存储了执行所需的所有信息包括分词器/反分词器和生成配置，从而能够获得与 Hugging Face 生成匹配的结果。我们提供 C++ 和 Python API 来运行 LLM、最少的依赖项列表和对应用程序的添加。</p> 
<p style="margin-left:0;text-align:justify;">Python语言测试代码：</p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="197" src="https://images2.imgbox.com/67/fb/D6hqgNVi_o.png" width="790"></p> 
<p style="margin-left:0;text-align:left;"></p> 
<p style="margin-left:0;text-align:left;">C++语言测试代码</p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="337" src="https://images2.imgbox.com/65/2c/o4xZYDwW_o.png" width="1049"></p> 
<p style="margin-left:0;text-align:left;"></p> 
<p style="margin-left:0;text-align:left;">C++里面跑出来得结果：</p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="639" src="https://images2.imgbox.com/41/53/9JyFM66F_o.png" width="1200"></p> 
<p style="margin-left:0;text-align:left;"></p> 
<p style="margin-left:0;text-align:justify;">更多参考这里：</p> 
<p style="margin-left:0;text-align:justify;">https://docs.openvino.ai/2024/learn-openvino/llm_inference_guide/genai-guide.html</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">optimum-cli export openvino --model "TinyLlama/TinyLlama-1.1B-Chat-v1.0" --weight-format int4 --trust-remote-code output</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7f5cff16d23a76779e0ee070173ed088/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">零门槛用AI，302.AI让人工智能变得简单易用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3b746a8d122b521b343024b350badefc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">设计模式大白话之适配器模式</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>