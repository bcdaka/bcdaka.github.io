<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>torch报错AssertionError: Torch not compiled with CUDA enabled解决方法 torch适配CUDA降版本、选择gpu版本最终方案 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/afd2c02dc262d60455d8ae70bd9814a0/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="torch报错AssertionError: Torch not compiled with CUDA enabled解决方法 torch适配CUDA降版本、选择gpu版本最终方案">
  <meta property="og:description" content="报错情况 报错一 在任意python文件下运行这几行命令
print(&#34;是否可用：&#34;, torch.cuda.is_available()) # 查看GPU是否可用 print(&#34;GPU数量：&#34;, torch.cuda.device_count()) # 查看GPU数量 print(&#34;torch方法查看CUDA版本：&#34;, torch.version.cuda) # torch方法查看CUDA版本 print(&#34;GPU索引号：&#34;, torch.cuda.current_device()) # 查看GPU索引号 print(&#34;GPU名称：&#34;, torch.cuda.get_device_name(1)) # 根据索引号得到GPU名称 输出、报错如下：
是否可用： True ... RuntimeError: The NVIDIA driver on your system is too old (found version 10020). 然后在尝试降版本后出现第二个报错：
报错二 同样的命令
print(&#34;是否可用：&#34;, torch.cuda.is_available()) # 查看GPU是否可用 print(&#34;GPU数量：&#34;, torch.cuda.device_count()) # 查看GPU数量 print(&#34;torch方法查看CUDA版本：&#34;, torch.version.cuda) # torch方法查看CUDA版本 print(&#34;GPU索引号：&#34;, torch.cuda.current_device()) # 查看GPU索引号 print(&#34;GPU名称：&#34;, torch.cuda.get_device_name(1)) # 根据索引号得到GPU名称 输出结果：
是否可用： False ... AssertionError: Torch not compiled with CUDA enabled 解决办法 首先命令行输入nvidia-smi，查看CUDA版本：">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-02-27T17:07:55+08:00">
    <meta property="article:modified_time" content="2023-02-27T17:07:55+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">torch报错AssertionError: Torch not compiled with CUDA enabled解决方法 torch适配CUDA降版本、选择gpu版本最终方案</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="kdocs-document"> 
 <h2 style="">报错情况</h2> 
 <h3 style="">报错一</h3> 
 <p style="">在任意python文件下运行这几行命令</p> 
 <pre class="kdocs-python"><code class="language-python">print("是否可用：", torch.cuda.is_available())        # 查看GPU是否可用
print("GPU数量：", torch.cuda.device_count())        # 查看GPU数量
print("torch方法查看CUDA版本：", torch.version.cuda)  # torch方法查看CUDA版本
print("GPU索引号：", torch.cuda.current_device())    # 查看GPU索引号
print("GPU名称：", torch.cuda.get_device_name(1))    # 根据索引号得到GPU名称</code></pre> 
 <p style="">输出、报错如下：</p> 
 <pre class="kdocs-python"><code class="language-python">是否可用： True
...
RuntimeError: The NVIDIA driver on your system is too old (found version 10020).</code></pre> 
 <p style="">然后在尝试降版本后出现第二个报错：</p> 
 <h3 style="">报错二</h3> 
 <p style="">同样的命令</p> 
 <pre class="kdocs-bash"><code class="language-bash">print("是否可用：", torch.cuda.is_available())        # 查看GPU是否可用
print("GPU数量：", torch.cuda.device_count())        # 查看GPU数量
print("torch方法查看CUDA版本：", torch.version.cuda)  # torch方法查看CUDA版本
print("GPU索引号：", torch.cuda.current_device())    # 查看GPU索引号
print("GPU名称：", torch.cuda.get_device_name(1))    # 根据索引号得到GPU名称</code></pre> 
 <p style="">输出结果：</p> 
 <pre class="kdocs-python"><code class="language-python">是否可用： False
...
AssertionError: Torch not compiled with CUDA enabled</code></pre> 
 <p style="text-align:left;"></p> 
 <h2 style="">解决办法</h2> 
 <p style="">首先命令行输入nvidia-smi，查看CUDA版本：</p> 
 <pre class="kdocs-bash"><code class="language-bash">nvidia-smi</code></pre> 
 <p style="text-align:left;">查看得到结果：</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:566px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:56.183746%;height:0;"> 
    <img src="https://images2.imgbox.com/e5/aa/6ttJcqki_o.png" style="margin-left:;display:block;width:566px;margin-top:-56.183746%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">得到服务器的CUDA版本为10.2.</p> 
 <p style="text-align:left;">然后去torch官网中查看老版本CUDA适配的torch版本：</p> 
 <p style="text-align:left;"><a class="kdocs-link" style="color:#0A6CFF;" href="https://pytorch.org/get-started/previous-versions/" rel="nofollow noopener noreferrer" target="_blank">https://pytorch.org/get-started/previous-versions/</a></p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:951px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:62.881176%;height:0;"> 
    <img src="https://images2.imgbox.com/58/80/PcUMJk4h_o.png" style="margin-left:;display:block;width:951px;margin-top:-62.881176%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">下面就要在镜像源中找到这样的torch版本：1.12.1以及<span class="kdocs-bold" style="font-weight:bold;">适配gpu</span></p> 
 <p style="">比如我们在北外的torch镜像源中找：</p> 
 <p style=""><a class="kdocs-link" style="color:#0A6CFF;" href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/" rel="nofollow noopener noreferrer" target="_blank">https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/</a></p> 
 <p style="">我们是linux版本，就选linux：</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:1928px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:54.771782%;height:0;"> 
    <img src="https://images2.imgbox.com/91/e3/IgOoiF6J_o.png" style="margin-left:;display:block;width:1928px;margin-top:-54.771782%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">看到了如下的：</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:1928px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:54.771782%;height:0;"> 
    <img src="https://images2.imgbox.com/4f/16/3J492iwR_o.png" style="margin-left:;display:block;width:1928px;margin-top:-54.771782%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">这就是我们要找的。右键点击蓝字，'右键'-'复制链接地址'，得到下载链接，直接用这个包安装pytorch：</p> 
 <pre class="kdocs-bash"><code class="language-bash">conda install https://mirrors.bfsu.edu.cn/anaconda/cloud/pytorch/linux-64/pytorch-1.12.1-py3.8_cuda10.2_cudnn7.6.5_0.tar.bz2</code></pre> 
 <p style="">然后用以下命令，自动安装适配的依赖包：</p> 
 <pre class="kdocs-bash"><code class="language-bash">conda install pytorch</code></pre> 
 <p style="">这样就安装成功了，再次调用以上python命令测试CUDA：</p> 
 <pre class="kdocs-python"><code class="language-python">print("是否可用：", torch.cuda.is_available())        # 查看GPU是否可用
print("GPU数量：", torch.cuda.device_count())        # 查看GPU数量
print("torch方法查看CUDA版本：", torch.version.cuda)  # torch方法查看CUDA版本
print("GPU索引号：", torch.cuda.current_device())    # 查看GPU索引号
print("GPU名称：", torch.cuda.get_device_name(1))    # 根据索引号得到GPU名称</code></pre> 
 <p style="">得到结果：</p> 
 <pre class="kdocs-python"><code class="language-python">True
2
10.2
0
Tesla T4</code></pre> 
 <p style="">torchvision也是同理：</p> 
 <pre class="kdocs-bash"><code class="language-bash">conda install https://mirrors.bfsu.edu.cn/anaconda/cloud/pytorch/linux-64/torchvision-0.13.1-py38_cu102.tar.bz2
conda install torchvision</code></pre> 
 <p style=""></p> 
 <p style=""></p> 
 <p style="">然后具体介绍一下这几个报错，这样也把我一路摸着石头过河的经历给复述一下。</p> 
 <h2 style="">报错RuntimeError: The NVIDIA driver on your system is too old (found version 10020).的原因</h2> 
 <p style=""><span class="kdocs-bold" style="font-weight:bold;">你安装的torch和你的CUDA版本不匹配</span>。</p> 
 <p style="">比如我的环境中就是10.2的CUDA和1.13.0（或者1.13.1，反正是1.13版本）的pytorch冲突了。</p> 
 <h2 style=""><span class="kdocs-bold" style="font-weight:bold;">NVIDIA too old解决办法</span></h2> 
 <ol start="1"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p><span class="kdocs-bold" style="font-weight:bold;">降低pytorch版本</span>。</p></li></ol> 
 <ol start="2"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>升级CUDA。</p></li></ol> 
 <p style="">解决办法很多，可以参考网上其他文章。本文重点在第二个报错Torch和CUDA的编译(compile)问题，因为我自己是使用学校的机房，没权限升级CUDA，所以介绍一下我尝试过的第一个办法，降低pytorch版本：</p> 
 <p style="">你在看这一段时，会发现前面和我最终的解决方法是一样的，但后面不同的方法让我走了弯路。</p> 
 <p style="">首先确定你的CUDA版本，在Linux命令行终端中输入nvidia-smi：</p> 
 <pre class="kdocs-bash"><code class="language-bash">nvidia-smi</code></pre> 
 <p style="">查看得到结果：</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:566px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:56.183746%;height:0;"> 
    <img src="https://images2.imgbox.com/0c/45/LcQkkA8o_o.png" style="margin-left:;display:block;width:566px;margin-top:-56.183746%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">得到服务器的CUDA版本为10.2.</p> 
 <p style="">然后去torch官网中查看老版本CUDA适配的torch版本：</p> 
 <p style=""><a class="kdocs-link" style="color:#0A6CFF;" href="https://pytorch.org/get-started/previous-versions/" rel="nofollow noopener noreferrer" target="_blank">https://pytorch.org/get-started/previous-versions/</a></p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:951px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:62.881176%;height:0;"> 
    <img src="https://images2.imgbox.com/c9/a8/RQxka9RT_o.png" style="margin-left:;display:block;width:951px;margin-top:-62.881176%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">好了，到这一步，你可能就会按照它上面的操作，安装这几个版本的库了。</p> 
 <pre class="kdocs-python"><code class="language-python">conda install pytorch==1.12.1 torchvision==0.13.1 torchaudio==0.12.1 cudatoolkit=10.2 -c pytorch</code></pre> 
 <p style="">不过你可能会碰到的问题有：</p> 
 <ol start="1"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>某个包版本不匹配当前python版本</p></li></ol> 
 <ol start="2"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>某个包版本和其他包冲突</p></li></ol> 
 <ol start="3"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p><span class="kdocs-bold" style="font-weight:bold;">某个包安装的版本和CUDA版本不匹配</span></p></li></ol> 
 <p style="">可能你改进了第一、二个问题，终于把整套pytorch、torchvision下下来了，但你还是要面对第三个问题，就是继而报错AssertionError: Torch not compiled with CUDA enabled，不过我一步步介绍我的经历，先看看如何面对第一和第二个问题的：</p> 
 <p style="">自己调试去安装，我试过，最后还是选择了使用如下命令：</p> 
 <pre class="kdocs-bash"><code class="language-bash">conda install --override-channels -c https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/ pytorch torchvision cudatoolkit=10.2</code></pre> 
 <p style="text-align:left;">这条命令是说，指定使用镜像源<a class="kdocs-link" style="color:#0A6CFF;" href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/" rel="nofollow noopener noreferrer" target="_blank">https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/</a>，指定cudatoolkit版本适配10.2的CUDA，然后根据这个适配，下载pytorch包和torchvision包。</p> 
 <p style="">下载好了，尝试代码，你会得到：</p> 
 <pre class="kdocs-python"><code class="language-python">print("是否可用：", torch.cuda.is_available())        # 查看GPU是否可用
print("GPU数量：", torch.cuda.device_count())        # 查看GPU数量
print("torch方法查看CUDA版本：", torch.version.cuda)  # torch方法查看CUDA版本
print("GPU索引号：", torch.cuda.current_device())    # 查看GPU索引号
print("GPU名称：", torch.cuda.get_device_name(1))    # 根据索引号得到GPU名称

（输出结果：）
是否可用： False
...
AssertionError: Torch not compiled with CUDA enabled</code></pre> 
 <p style="text-align:left;">这就是第二个报错了。</p> 
 <h2 style="">报错AssertionError: Torch not compiled with CUDA enabled的原因</h2> 
 <p style=""><span class="kdocs-bold" style="font-weight:bold;">而第二个报错则是因为你安装的torch是cpu版本的</span>。比如你可以在你的conda环境下查找torch版本：</p> 
 <pre class="kdocs-bash"><code class="language-bash">conda list | grep torch</code></pre> 
 <p style="">结果如下：</p> 
 <pre class="kdocs-bash"><code class="language-bash">(base) weinz@dlp01:~$ conda list | grep torch
（正常使用命令无法看到下面注释的一行，为了直观显示，我粘贴过来了）
# Name                    Version                   Build  Channel
pytorch                   1.12.1          cpu_py38he8d8e81_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
torchvision               0.13.1          cpu_py38h164cc8f_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main</code></pre> 
 <p style="">其中包版本号Version后面的Build列，就能看到torch适配的是cpu版本。</p> 
 <p style="">发现问题后，改成gpu版本的就可以了。</p> 
 <p style="">具体方法就接上我最终的解决方案了：</p> 
 <h2 style="">具体解决方法</h2> 
 <p style="">首先回顾一下我们需要的torch版本：</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:951px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:62.881176%;height:0;"> 
    <img src="https://images2.imgbox.com/7c/6b/c1aYDJYc_o.png" style="margin-left:;display:block;width:951px;margin-top:-62.881176%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">在镜像源中找到1.12.1以及<span class="kdocs-bold" style="font-weight:bold;">适配gpu</span>的pytorch、torchvision</p> 
 <p style="text-align:left;">进入镜像源<a class="kdocs-link" style="color:#0A6CFF;" href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/" rel="nofollow noopener noreferrer" target="_blank">https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/</a></p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:1928px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:54.771782%;height:0;"> 
    <img src="https://images2.imgbox.com/7a/d9/Yky1bR2q_o.png" style="margin-left:;display:block;width:1928px;margin-top:-54.771782%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">这就是我们要找的。右键-复制链接地址，直接用这个包安装pytorch：</p> 
 <pre class="kdocs-bash"><code class="language-bash">conda install https://mirrors.bfsu.edu.cn/anaconda/cloud/pytorch/linux-64/pytorch-1.12.1-py3.8_cuda10.2_cudnn7.6.5_0.tar.bz2</code></pre> 
 <p style="">可以查看一下，这样下载的是否是gpu版本的。输入查找命令：</p> 
 <pre class="kdocs-python"><code class="language-python">conda list | grep torch</code></pre> 
 <p style="">得到结果：</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:1130px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:7.079646%;height:0;"> 
    <img src="https://images2.imgbox.com/bb/dc/HiIw7ogs_o.png" style="margin-left:;display:block;width:1130px;margin-top:-7.079646%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">可以看到，显示的是cuda，这个就是gpu版本的了。</p> 
 <p style="text-align:left;">然后用以下命令，自动安装适配的依赖包：</p> 
 <pre class="kdocs-bash"><code class="language-bash">conda install pytorch</code></pre> 
 <p style="text-align:left;">这样就安装成功了，再次调用以上python命令测试CUDA：</p> 
 <pre class="kdocs-python"><code class="language-python">print("是否可用：", torch.cuda.is_available())        # 查看GPU是否可用
print("GPU数量：", torch.cuda.device_count())        # 查看GPU数量
print("torch方法查看CUDA版本：", torch.version.cuda)  # torch方法查看CUDA版本
print("GPU索引号：", torch.cuda.current_device())    # 查看GPU索引号
print("GPU名称：", torch.cuda.get_device_name(1))    # 根据索引号得到GPU名称</code></pre> 
 <p style="text-align:left;">得到结果：</p> 
 <pre class="kdocs-python"><code class="language-python">True
2
10.2
0
Tesla T4</code></pre> 
 <p style="text-align:left;">torchvision也是同理：</p> 
 <pre class="kdocs-bash"><code class="language-bash">conda install https://mirrors.bfsu.edu.cn/anaconda/cloud/pytorch/linux-64/torchvision-0.13.1-py38_cu102.tar.bz2
conda install torchvision</code></pre> 
 <h2 style="text-align:left;">总结</h2> 
 <p style="">看着网上的文章，还有问chatGPT，一步步解决了这个问题，还是值得的。</p> 
 <p style="">有的方法在选择gpu版本的时候，选择这样：</p> 
 <pre class="kdocs-python"><code class="language-python">conda install -c 镜像源 后面调试版本
conda install -c 'http...' pytorch=1.12.1 torchvision=0.13.0 cudatoolkit=10.2
conda install -c 'http...' pytorch=1.9.1 torchvision=0.8.0 cudatoolkit=10.2
...</code></pre> 
 <p style="">一步步调版本，我在调的时候发现太搞了，而且试出来下好配套的了，可能下的也是cpu版本的。</p> 
 <p style="">具体可参考这篇文章：</p> 
 <p style=""><a class="kdocs-link" style="color:#0A6CFF;" href="https://blog.csdn.net/u013468614/article/details/125910538" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/u013468614/article/details/125910538</a></p> 
 <p style="">可能更了解镜像源内部选择的方式，会有更好的解决方法。不过在此之前，这种直接下载你需要的版本然后让镜像源给你补依赖包才是最高效的方法。</p> 
 <p style=""></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c9ec8eac9ded19a6493a9082333ce8cd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">史上最全的大数据开发八股文【自己的吐血总结】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fddec9f9f88504b94f4abdff8d7408e9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">TCP/IP协议</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>