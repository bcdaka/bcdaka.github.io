<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>宽带信号处理实现DOA估计（ISM算法、MUSIC、MVDR、CBF） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/06b4853c0eec41970a130dbf4da7b697/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="宽带信号处理实现DOA估计（ISM算法、MUSIC、MVDR、CBF）">
  <meta property="og:description" content="%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% %%%%%%%%%%%%%%%%%%% 宽带信号DOA估计算法：ISM 算法%%%%%%%%%%%%%%%%%%%%%%%%%%% %%%%%%%% Developed by HHU&#39;s Boya (河海大学_信息与通信工程_李蓉) %%%%%%%%%%%%% %%%%%%%%%%%%%%%%%%% EMAIL:15006120517@163.com %%%%%%%%%%%%%%%%%%%%%%%%%%%%% %%%%%%%%%%%%%%%%%%%%%%%%% MUSIC \ CBF \ MVDR %%%%%%%%%%%%%%%%%%%%%%%%%%%%%% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% clc; clear all; close all; %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 参数定义 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% M=12; %阵元数 N=200; %快拍数 X=2; %信源数 ts=0.01; %时域采样间隔 fl=80; %入射信号最低频率 fh=120; %入射信号最高频率 fm=(fl&#43;fh)/2; %入射信号中心频率 c=1500; %声速 lambda=c/fm; %波长 d=lambda/2; %阵元间距 SNR=15; %信噪比 ang2rad = pi/180; %角度转弧度系数 theta1=30*ang2rad; %入射信号波束角1 theta2=-45*ang2rad; %入射信号波束角2 n=ts:ts:N*ts; %采样时间矢量 theta=[theta1,theta2]; %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% produce signal %%%%%%%%%%%%%%%%%%%%%%%%%%%% s1=chirp(n,fl,1,fh); %生成线性调频信号1； s1=awgn(s1,SNR,&#39;measured&#39;); %在信号中添加高斯噪声 s1_fft=fft(s1); %进行FFT变换;Y = fft(X,n) 返回 n 点 DFT。如果未指定任何值，则 Y 的大小与 X 相同 s2=chirp(n&#43;0.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-12-19T17:27:29+08:00">
    <meta property="article:modified_time" content="2023-12-19T17:27:29+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">宽带信号处理实现DOA估计（ISM算法、MUSIC、MVDR、CBF）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <pre><code class="language-Matlab">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%% 宽带信号DOA估计算法：ISM  算法%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%%%%%% Developed by HHU's Boya (河海大学_信息与通信工程_李蓉) %%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%% EMAIL:15006120517@163.com %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%% MUSIC \ CBF \ MVDR %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

clc; 
clear all;
close all;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 参数定义 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
M=12;                                     %阵元数 
N=200;                                    %快拍数 
X=2;                                      %信源数
ts=0.01;                                  %时域采样间隔   
fl=80;                                    %入射信号最低频率 
fh=120;                                   %入射信号最高频率 
fm=(fl+fh)/2;                             %入射信号中心频率 
c=1500;                                   %声速 
lambda=c/fm;                              %波长 
d=lambda/2;                               %阵元间距 
SNR=15;                                   %信噪比
ang2rad = pi/180;                         %角度转弧度系数
theta1=30*ang2rad;                        %入射信号波束角1 
theta2=-45*ang2rad;                       %入射信号波束角2 
n=ts:ts:N*ts;                             %采样时间矢量                           
theta=[theta1,theta2]; 
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% produce signal %%%%%%%%%%%%%%%%%%%%%%%%%%%% 
 
s1=chirp(n,fl,1,fh);                     %生成线性调频信号1；
s1=awgn(s1,SNR,'measured');              %在信号中添加高斯噪声
s1_fft=fft(s1);                          %进行FFT变换;Y = fft(X,n) 返回 n 点 DFT。如果未指定任何值，则 Y 的大小与 X 相同
s2=chirp(n+0.100,fh,1,fl);               %生成线性调频信号2 
s2=awgn(s2,SNR,'measured');              %在信号中添加高斯噪声
s2_fft=fft(s2);                          %进行FFT变换 
  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% ISM算法 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%构造接收信号、协方差矩阵
sump_music=zeros(1,361);       %角度功率谱初始化
sump_mvdr= zeros(1,361);       %角度功率谱初始化
sump_cbf = zeros(1,361);       %角度功率谱初始化
for i=1:N                      %遍历各频点
    f=80+(i-1)*1.0;            %具体频点   +1
    s_music=[s1_fft(i) s2_fft(i)]';                %2个声源信号的频域快拍_MUSIC\后续考虑增加快拍数\目前是1%%
    s_mvdr=[s1_fft;s2_fft];                        %MVDR200个快拍一起
    s_cbf=[s1_fft;s2_fft];                         %CBF200个快拍一起
    %接收矢量阵
    a = exp(-1j*2*pi*f*d/c*(0:M-1)'*sin(theta));   %方向矢量矩阵M*2  M为阵元数 2为声源数目 
    %%协方差矩阵music
    Xmusic=a*s_music;          %接收信号快拍矩阵 Xn 12*1维   12*1 = 12*2 * 2*1
    R_music=Xmusic*Xmusic';    %快拍信号的协方差矩阵
    %%协方差矩阵mvdr
    Xmvdr=a*s_mvdr;            %接收信号快拍矩阵
    R_mvdr=Xmvdr*Xmvdr'/N;     %快拍信号的协方差矩阵
    %%协方差矩阵cbf
    Xcbf=a*s_cbf;              %接收信号快拍矩阵
    R_cbf=Xcbf*Xcbf'/N;        %快拍信号的协方差矩阵
    
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%% ISM_MUSIC 算法 %%%%%%%%%%%%%%%%%%%%%%%%%
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%% ISM_MVDR算法 %%%%%%%%%%%%%%%%%%%%%%%%%%%
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%% ISM_CBF算法 %%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %%噪声子空间En
    [Ev,D] = eig(R_music);     % 特征值分解 D：特征值的对角矩阵 Ev：右特征列向量组成的矩阵
    EVA = diag(D)';            % 将特征值提取为1行 
    [EVA,I] = sort(EVA);       % 对特征值排序,从小到大。其中I为索引向量
    EV = fliplr(Ev(:,I));      % 按照索引I对顺序特征矢量排序得到Ev,再fliplr水平颠倒列向量得到特征值从大到小分布的特征列向量组成的矩阵EV
    En = EV(:,X+1:M);          % 取特征向量矩阵的第X+1到M列特征向量组成噪声子空间En
    
    % 遍历所有角度，计算空间谱
    for i = 1:361
        angle(i) = (i-181)/2;           % 映射到-90度到90度
        theta_m = angle(i)*ang2rad;
        a_theta = exp(-1j*2*pi*f/c*d*(0:M-1)'*sin(theta_m));    %导向矢量M*1
        p_music(i) = abs(1/(a_theta'*En*En'*a_theta));          %MUSIC算法功率谱
        p_mvdr(i)=1/abs(a_theta'*inv(R_mvdr)*a_theta);          %MVDR算法功率谱
        p_cbf(i)=abs(a_theta'*R_cbf*a_theta);                   %CBF算法功率谱
        
    end
    sump_music=sump_music+p_music;                              %累加各频点功率谱
    sump_mvdr=sump_mvdr+p_mvdr;                                 %累加各频点功率谱
    sump_cbf=sump_cbf+p_cbf;                                    %累加各频点功率谱
end 

%%%%%%%%%%%%%%%%%%%%%%%%%%%% 归一化处理、作图 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%ISM_MUSIC
p_music_max = max(sump_music);
sump_music = 10*log10(sump_music/p_music_max); 

%%ISM_MVDR
p_mvdr_max = max(sump_mvdr);
sump_mvdr = 10*log10(sump_mvdr/p_mvdr_max); 

%%ISM_CBF
p_cbf_max=max(sump_cbf);
sump_cbf=10*log10(sump_cbf/p_cbf_max);

%%作图ISM_MUSIC \ MVDR \ CBF
%%ISM——MUSIC
figure(1);
subplot(3,1,1); 
plot(angle,sump_music,'b-');
title('ISM——MUSIC空间谱');
xlabel('入射角/度'); 
ylabel('空间谱/dB');
%%ISM——MVDR
subplot(3,1,2); 
plot(angle,sump_mvdr,'r-');
title('ISM——MVDR空间谱');
xlabel('入射角/度'); 
ylabel('空间谱/dB');
%%ISM——CBF
subplot(3,1,3); 
plot(angle,sump_cbf,'g-');
title('ISM——CBF空间谱');
xlabel('入射角/度'); 
ylabel('空间谱/dB');

%%ISM——MUSIC
figure(2);
plot(angle,sump_music,'b-');
title('ISM——MUSIC空间谱');
xlabel('入射角/度'); 
ylabel('空间谱/dB');

%%ISM——MVDR
figure(3);
plot(angle,sump_mvdr,'r-');
title('ISM——MVDR空间谱');
xlabel('入射角/度'); 
ylabel('空间谱/dB');

%%ISM——CBF
figure(4);
plot(angle,sump_cbf,'g-');
title('ISM——CBF空间谱');
xlabel('入射角/度'); 
ylabel('空间谱/dB');




</code></pre> 
<h3>1 常规波束形成算法(CBF)</h3> 
<p><strong>功率谱：</strong>                             <img alt="P_{CBF}(\theta)=a^{H}(\theta)Ra(\theta)" class="mathcode" src="https://images2.imgbox.com/08/04/zfWZoPe1_o.png"><img alt="_{_{}}" class="mathcode" src="https://images2.imgbox.com/61/e3/5rK5JxjU_o.png"></p> 
<h3>2 MVDR算法</h3> 
<p><strong>功率谱：</strong>                             <img alt="P_{MVDR}(\theta)=\frac{1}{​{a(\theta)}^H{R^{-1}}{a(\theta)}}" class="mathcode" src="https://images2.imgbox.com/02/aa/RUXrk8sN_o.png"></p> 
<h3>3 多重信号分类法(MUSIC)</h3> 
<p><strong>功率谱：</strong>                            <img alt="P_{MUSIC}(\theta)=\frac{1}{​{a(\theta)}^H{U_{N}}{​{U_{N}}^{H}}{a(\theta)}}" class="mathcode" src="https://images2.imgbox.com/d1/5c/YdUZSNNF_o.png"></p> 
<p>       <strong>由快拍信号 <img alt="X_{n}" class="mathcode" src="https://images2.imgbox.com/4f/01/OZqvRZAP_o.png"> 计算协方差矩阵 <img alt="R" class="mathcode" src="https://images2.imgbox.com/0c/f5/MTwc0FkN_o.png"> ,其中 <img alt="R=\frac{X_{n}*{X_{n}}^{'}}{N}" class="mathcode" src="https://images2.imgbox.com/63/0a/sxagG612_o.png"> ，<img alt="N" class="mathcode" src="https://images2.imgbox.com/5d/f6/XB9I5dPI_o.png">为快拍长度；对上述的空间谱公式遍历各个角度，计算对应角度的导向矢量<img alt="a(\theta )" class="mathcode" src="https://images2.imgbox.com/9b/2f/ukyZQCyD_o.png">，带入空间谱计算公式得到各个角度的功率值，遍历预想的全部角度以后就得到各种方法的空间谱啦；</strong></p> 
<p><strong>       代码中使用了MUSIC算法，也使用了CBF和MVDR算法，效果并不是很完美；代码存在瑕疵，请多多包涵或自行修改，取代码请关注博主吧，唯一小要求；</strong></p> 
<p><strong>注：其中  <img alt="a(\theta )" class="mathcode" src="https://images2.imgbox.com/72/03/4MNdJUSR_o.png"> 为导向矢量，<img alt="R" class="mathcode" src="https://images2.imgbox.com/6b/07/pzJkAcoY_o.png"> 为快拍信号的协方差矩阵，<img alt="U_{N}" class="mathcode" src="https://images2.imgbox.com/34/a9/BWPXuUNN_o.png"> 为协方差矩阵 <img alt="R" class="mathcode" src="https://images2.imgbox.com/60/fd/07ULgRcE_o.png"> 特征值分解得到的噪声子空间矩阵；</strong><strong>   </strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8b1d337fd10eb1e1692c6dc3aa5d8aab/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">JDK21 WARNING: A Java agent has been loaded dynamically</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cc14a86d58973ffd28f8dc0c34904e5c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java 数据结构篇-实现堆的核心方法与堆的应用（实现 TOP-K 问题：最小 k 个数）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>