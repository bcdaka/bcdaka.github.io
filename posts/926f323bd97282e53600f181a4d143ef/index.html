<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>æ·±å…¥æ¢è®¨åˆ†å¸ƒå¼IDç”Ÿæˆæ–¹æ¡ˆ - ç¼–ç¨‹å¤§å’–</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/926f323bd97282e53600f181a4d143ef/">
  <meta property="og:site_name" content="ç¼–ç¨‹å¤§å’–">
  <meta property="og:title" content="æ·±å…¥æ¢è®¨åˆ†å¸ƒå¼IDç”Ÿæˆæ–¹æ¡ˆ">
  <meta property="og:description" content="âœ¨âœ¨è°¢è°¢å¤§å®¶æ§åœºï¼Œç¥å±å¹•å‰çš„å°ä¼™ä¼´ä»¬æ¯å¤©éƒ½æœ‰å¥½è¿ç›¸ä¼´å·¦å³ï¼Œä¸€å®šè¦å¤©å¤©å¼€å¿ƒå“¦ï¼âœ¨âœ¨Â ğŸˆğŸˆä½œè€…ä¸»é¡µï¼š å–”çš„å˜›å‘€ğŸˆğŸˆ âœ¨âœ¨ å¸…å“¥ç¾å¥³ä»¬ï¼Œæˆ‘ä»¬å…±åŒåŠ æ²¹ï¼ä¸€èµ·è¿›æ­¥ï¼âœ¨âœ¨Â ç›®å½•
å¼•è¨€
ä¸€. UUIDï¼ˆUniversally Unique Identifierï¼‰
äºŒã€æ•°æ®åº“è‡ªå¢ID
ä¸‰. åŸºäºRedisçš„æ–¹æ¡ˆ
å››. Twitterçš„snowflakeç®—æ³•
äº”ã€ç™¾åº¦UidGenerator
ç»“è¯­
å¼•è¨€ åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç”Ÿæˆå”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆIDï¼‰æ˜¯ä¸€ä¸ªå¸¸è§çš„éœ€æ±‚ã€‚åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»å‡ ç§å¸¸è§çš„åˆ†å¸ƒå¼IDç”Ÿæˆæ–¹æ¡ˆï¼ŒåŒ…æ‹¬UUIDã€Snowflakeç®—æ³•ã€åŸºäºæ•°æ®åº“çš„æ–¹æ¡ˆå’ŒåŸºäºRedisçš„æ–¹æ¡ˆã€‚æˆ‘ä»¬å°†æ·±å…¥æ¢è®¨æ¯ç§æ–¹æ¡ˆçš„åŸç†ã€ä¼˜ç¼ºç‚¹ï¼Œå¹¶æä¾›ç›¸åº”çš„ä»£ç ç¤ºä¾‹ã€‚
ä¸€. UUIDï¼ˆUniversally Unique Identifierï¼‰ UUIDï¼ˆUniversally Unique Identifierï¼‰æ˜¯ä¸€ç§æ ‡å‡†åŒ–çš„128ä½æ•°å­—ï¼ˆ16å­—èŠ‚ï¼‰æ ¼å¼ï¼Œé€šå¸¸ç”¨32ä¸ªåå…­è¿›åˆ¶æ•°å­—è¡¨ç¤ºã€‚UUIDçš„ç›®çš„æ˜¯è®©åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¤šä¸ªèŠ‚ç‚¹ç”Ÿæˆçš„æ ‡è¯†ç¬¦åœ¨æ—¶é—´å’Œç©ºé—´ä¸Šéƒ½æ˜¯å”¯ä¸€çš„ã€‚
UUIDé€šå¸¸ç”±ä»¥ä¸‹å‡ éƒ¨åˆ†ç»„æˆï¼š
æ—¶é—´æˆ³ï¼šå æ®å‰32ä½ï¼Œè¡¨ç¤ºç”ŸæˆUUIDçš„æ—¶é—´æˆ³ã€‚æ—¶é’Ÿåºåˆ—å·ï¼šå æ®æ¥ä¸‹æ¥çš„16ä½ï¼Œä¿è¯åœ¨åŒä¸€æ—¶åˆ»ç”Ÿæˆçš„UUIDçš„å”¯ä¸€æ€§ã€‚å…¨å±€å”¯ä¸€çš„èŠ‚ç‚¹æ ‡è¯†ç¬¦ï¼šå æ®æœ€åçš„48ä½ï¼Œé€šå¸¸æ˜¯æœºå™¨çš„MACåœ°å€ã€‚ UUIDçš„ç”Ÿæˆæ–¹æ³•æœ‰å¤šç§ï¼Œå…¶ä¸­æ¯”è¾ƒå¸¸è§çš„æ˜¯åŸºäºå½“å‰æ—¶é—´æˆ³å’Œéšæœºæ•°ç”Ÿæˆã€‚Javaä¸­å¯ä»¥ä½¿ç”¨java.util.UUIDç±»æ¥ç”ŸæˆUUIDï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š
import java.util.UUID; public class UUIDGenerator { public static void main(String[] args) { UUID uuid = UUID.randomUUID(); System.out.println(&#34;Generated UUID: &#34; &#43; uuid.toString()); } } è¿™æ®µä»£ç å°†ç”Ÿæˆä¸€ä¸ªç±»ä¼¼äº550e8400-e29b-41d4-a716-446655440000çš„UUIDã€‚ç”±äºUUIDçš„å”¯ä¸€æ€§å’Œéšæœºæ€§ï¼Œé€šå¸¸ç”¨äºåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œä¾‹å¦‚ä½œä¸ºæ•°æ®åº“è¡¨çš„ä¸»é”®ã€‚Â äºŒã€æ•°æ®åº“è‡ªå¢ID ä½¿ç”¨æ•°æ®åº“çš„idè‡ªå¢ç­–ç•¥ï¼Œå¦‚ MySQL çš„ auto_incrementã€‚å¹¶ä¸”å¯ä»¥ä½¿ç”¨ä¸¤å°æ•°æ®åº“åˆ†åˆ«è®¾ç½®ä¸åŒ
æ­¥é•¿ï¼Œç”Ÿæˆä¸é‡å¤IDçš„ç­–ç•¥æ¥å®ç°é«˜å¯ç”¨ã€‚
ä¼˜ç‚¹ï¼šæ•°æ®åº“ç”Ÿæˆçš„IDç»å¯¹æœ‰åºï¼Œé«˜å¯ç”¨å®ç°æ–¹å¼ç®€å•
ç¼ºç‚¹ï¼šéœ€è¦ç‹¬ç«‹éƒ¨ç½²æ•°æ®åº“å®ä¾‹ï¼Œæˆæœ¬é«˜ï¼Œæœ‰æ€§èƒ½ç“¶é¢ˆ
åœ¨è®¸å¤šå…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œè‡ªå¢IDæ˜¯ä¸€ç§å¸¸è§çš„ç”¨äºå”¯ä¸€æ ‡è¯†è¡¨ä¸­è®°å½•çš„æ–¹å¼ã€‚ä¸‹é¢æˆ‘å°†ä»¥MySQLä¸ºä¾‹ï¼Œä»‹ç»å¦‚ä½•åœ¨æ•°æ®åº“ä¸­ä½¿ç”¨è‡ªå¢IDã€‚
é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªå¸¦æœ‰è‡ªå¢IDçš„è¡¨ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹è¡¨çš„åˆ›å»ºè¯­å¥ï¼š
CREATE TABLE users ( id INT AUTO_INCREMENT PRIMARY KEY, name VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL ); åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œid åˆ—è¢«å®šä¹‰ä¸ºè‡ªå¢åˆ—ï¼Œå¹¶ä¸”è¢«æŒ‡å®šä¸ºä¸»é”®ã€‚æ¯æ¬¡å‘è¡¨ä¸­æ’å…¥ä¸€æ¡è®°å½•æ—¶ï¼Œid åˆ—éƒ½ä¼šè‡ªåŠ¨é€’å¢ï¼Œç¡®ä¿æ¯ä¸ªè®°å½•éƒ½æœ‰å”¯ä¸€çš„IDã€‚">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-04T22:51:29+08:00">
    <meta property="article:modified_time" content="2024-06-04T22:51:29+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§å’–" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§å’–</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">æ·±å…¥æ¢è®¨åˆ†å¸ƒå¼IDç”Ÿæˆæ–¹æ¡ˆ</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p></p> 
<figure class="image"> 
 <img alt="" height="600" src="https://images2.imgbox.com/ac/06/dcPbeAAW_o.jpg" width="1125"> 
 <figcaption> 
  <br> âœ¨âœ¨è°¢è°¢å¤§å®¶æ§åœºï¼Œç¥å±å¹•å‰çš„å°ä¼™ä¼´ä»¬æ¯å¤©éƒ½æœ‰å¥½è¿ç›¸ä¼´å·¦å³ï¼Œä¸€å®šè¦å¤©å¤©å¼€å¿ƒå“¦ï¼âœ¨âœ¨Â  
  <br> ğŸˆğŸˆä½œè€…ä¸»é¡µï¼š 
  <a href="https://blog.csdn.net/2201_75809246?spm=1011.2266.3001.5343" title="å–”çš„å˜›å‘€">å–”çš„å˜›å‘€</a>ğŸˆğŸˆ 
  <br> âœ¨âœ¨ 
  <a href="#%E5%B8%85%E5%93%A5%E7%BE%8E%E5%A5%B3%E4%BB%AC%EF%BC%8C%E6%88%91%E4%BB%AC%E5%85%B1%E5%90%8C%E5%8A%A0%E6%B2%B9%EF%BC%81%E4%B8%80%E8%B5%B7%E8%BF%9B%E6%AD%A5%EF%BC%81" rel="nofollow">å¸…å“¥ç¾å¥³ä»¬ï¼Œæˆ‘ä»¬å…±åŒåŠ æ²¹ï¼ä¸€èµ·è¿›æ­¥ï¼</a>âœ¨âœ¨Â  
 </figcaption> 
</figure> 
<p></p> 
<p id="main-toc"><strong>ç›®å½•</strong></p> 
<p id="%E5%BC%95%E8%A8%80-toc"><a href="#%E5%BC%95%E8%A8%80" rel="nofollow">å¼•è¨€</a></p> 
<p id="%E4%B8%80.%20UUID%EF%BC%88Universally%20Unique%20Identifier%EF%BC%89-toc"><a href="#%E4%B8%80.%20UUID%EF%BC%88Universally%20Unique%20Identifier%EF%BC%89" rel="nofollow">ä¸€. UUIDï¼ˆUniversally Unique Identifierï¼‰</a></p> 
<p id="%E4%BA%8C%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E8%87%AA%E5%A2%9EID-toc"><a href="#%E4%BA%8C%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E8%87%AA%E5%A2%9EID" rel="nofollow">äºŒã€æ•°æ®åº“è‡ªå¢ID</a></p> 
<p id="%E4%B8%89.%20%E5%9F%BA%E4%BA%8ERedis%E7%9A%84%E6%96%B9%E6%A1%88-toc"><a href="#%E4%B8%89.%20%E5%9F%BA%E4%BA%8ERedis%E7%9A%84%E6%96%B9%E6%A1%88" rel="nofollow">ä¸‰. åŸºäºRedisçš„æ–¹æ¡ˆ</a></p> 
<p id="%E5%9B%9B.%20Twitter%E7%9A%84snowflake%E7%AE%97%E6%B3%95-toc"><a href="#%E5%9B%9B.%20Twitter%E7%9A%84snowflake%E7%AE%97%E6%B3%95" rel="nofollow">å››. Twitterçš„snowflakeç®—æ³•</a></p> 
<p id="%E4%BA%94%E3%80%81%E7%99%BE%E5%BA%A6UidGenerator-toc"><a href="#%E4%BA%94%E3%80%81%E7%99%BE%E5%BA%A6UidGenerator" rel="nofollow">äº”ã€ç™¾åº¦UidGenerator</a></p> 
<p id="%E7%BB%93%E8%AF%AD-toc"><a href="#%E7%BB%93%E8%AF%AD" rel="nofollow">ç»“è¯­</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="%E5%BC%95%E8%A8%80">å¼•è¨€</h2> 
<p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç”Ÿæˆå”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆIDï¼‰æ˜¯ä¸€ä¸ªå¸¸è§çš„éœ€æ±‚ã€‚åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»å‡ ç§å¸¸è§çš„åˆ†å¸ƒå¼IDç”Ÿæˆæ–¹æ¡ˆï¼ŒåŒ…æ‹¬UUIDã€Snowflakeç®—æ³•ã€åŸºäºæ•°æ®åº“çš„æ–¹æ¡ˆå’ŒåŸºäºRedisçš„æ–¹æ¡ˆã€‚æˆ‘ä»¬å°†æ·±å…¥æ¢è®¨æ¯ç§æ–¹æ¡ˆçš„åŸç†ã€ä¼˜ç¼ºç‚¹ï¼Œå¹¶æä¾›ç›¸åº”çš„ä»£ç ç¤ºä¾‹ã€‚</p> 
<h2 id="%E4%B8%80.%20UUID%EF%BC%88Universally%20Unique%20Identifier%EF%BC%89">ä¸€. UUIDï¼ˆUniversally Unique Identifierï¼‰</h2> 
<p>UUIDï¼ˆUniversally Unique Identifierï¼‰æ˜¯ä¸€ç§æ ‡å‡†åŒ–çš„128ä½æ•°å­—ï¼ˆ16å­—èŠ‚ï¼‰æ ¼å¼ï¼Œé€šå¸¸ç”¨32ä¸ªåå…­è¿›åˆ¶æ•°å­—è¡¨ç¤ºã€‚UUIDçš„ç›®çš„æ˜¯è®©åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¤šä¸ªèŠ‚ç‚¹ç”Ÿæˆçš„æ ‡è¯†ç¬¦åœ¨æ—¶é—´å’Œç©ºé—´ä¸Šéƒ½æ˜¯å”¯ä¸€çš„ã€‚</p> 
<p>UUIDé€šå¸¸ç”±ä»¥ä¸‹å‡ éƒ¨åˆ†ç»„æˆï¼š</p> 
<ol><li><strong>æ—¶é—´æˆ³</strong>ï¼šå æ®å‰32ä½ï¼Œè¡¨ç¤ºç”ŸæˆUUIDçš„æ—¶é—´æˆ³ã€‚</li><li><strong>æ—¶é’Ÿåºåˆ—å·</strong>ï¼šå æ®æ¥ä¸‹æ¥çš„16ä½ï¼Œä¿è¯åœ¨åŒä¸€æ—¶åˆ»ç”Ÿæˆçš„UUIDçš„å”¯ä¸€æ€§ã€‚</li><li><strong>å…¨å±€å”¯ä¸€çš„èŠ‚ç‚¹æ ‡è¯†ç¬¦</strong>ï¼šå æ®æœ€åçš„48ä½ï¼Œé€šå¸¸æ˜¯æœºå™¨çš„MACåœ°å€ã€‚</li></ol> 
<p>UUIDçš„ç”Ÿæˆæ–¹æ³•æœ‰å¤šç§ï¼Œå…¶ä¸­æ¯”è¾ƒå¸¸è§çš„æ˜¯åŸºäºå½“å‰æ—¶é—´æˆ³å’Œéšæœºæ•°ç”Ÿæˆã€‚Javaä¸­å¯ä»¥ä½¿ç”¨<code>java.util.UUID</code>ç±»æ¥ç”ŸæˆUUIDï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p> 
<pre><code>import java.util.UUID;

public class UUIDGenerator {
    public static void main(String[] args) {
        UUID uuid = UUID.randomUUID();
        System.out.println("Generated UUID: " + uuid.toString());
    }
}
</code></pre> 
<p>è¿™æ®µä»£ç å°†ç”Ÿæˆä¸€ä¸ªç±»ä¼¼äº<code>550e8400-e29b-41d4-a716-446655440000</code>çš„UUIDã€‚ç”±äºUUIDçš„å”¯ä¸€æ€§å’Œéšæœºæ€§ï¼Œé€šå¸¸ç”¨äºåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œä¾‹å¦‚ä½œä¸ºæ•°æ®åº“è¡¨çš„ä¸»é”®ã€‚Â </p> 
<h2 id="%E4%BA%8C%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E8%87%AA%E5%A2%9EID">äºŒã€æ•°æ®åº“è‡ªå¢ID</h2> 
<p><br> ä½¿ç”¨æ•°æ®åº“çš„idè‡ªå¢ç­–ç•¥ï¼Œå¦‚ MySQL çš„ auto_incrementã€‚å¹¶ä¸”å¯ä»¥ä½¿ç”¨ä¸¤å°æ•°æ®åº“åˆ†åˆ«è®¾ç½®ä¸åŒ<br> æ­¥é•¿ï¼Œç”Ÿæˆä¸é‡å¤IDçš„ç­–ç•¥æ¥å®ç°é«˜å¯ç”¨ã€‚<br> ä¼˜ç‚¹ï¼šæ•°æ®åº“ç”Ÿæˆçš„IDç»å¯¹æœ‰åºï¼Œé«˜å¯ç”¨å®ç°æ–¹å¼ç®€å•<br> ç¼ºç‚¹ï¼šéœ€è¦ç‹¬ç«‹éƒ¨ç½²æ•°æ®åº“å®ä¾‹ï¼Œæˆæœ¬é«˜ï¼Œæœ‰æ€§èƒ½ç“¶é¢ˆ</p> 
<p>åœ¨è®¸å¤šå…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œè‡ªå¢IDæ˜¯ä¸€ç§å¸¸è§çš„ç”¨äºå”¯ä¸€æ ‡è¯†è¡¨ä¸­è®°å½•çš„æ–¹å¼ã€‚ä¸‹é¢æˆ‘å°†ä»¥MySQLä¸ºä¾‹ï¼Œä»‹ç»å¦‚ä½•åœ¨æ•°æ®åº“ä¸­ä½¿ç”¨è‡ªå¢IDã€‚</p> 
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªå¸¦æœ‰è‡ªå¢IDçš„è¡¨ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹è¡¨çš„åˆ›å»ºè¯­å¥ï¼š</p> 
<pre><code>CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50) NOT NULL,
    email VARCHAR(100) NOT NULL
);
</code></pre> 
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>id</code> åˆ—è¢«å®šä¹‰ä¸ºè‡ªå¢åˆ—ï¼Œå¹¶ä¸”è¢«æŒ‡å®šä¸ºä¸»é”®ã€‚æ¯æ¬¡å‘è¡¨ä¸­æ’å…¥ä¸€æ¡è®°å½•æ—¶ï¼Œ<code>id</code> åˆ—éƒ½ä¼šè‡ªåŠ¨é€’å¢ï¼Œç¡®ä¿æ¯ä¸ªè®°å½•éƒ½æœ‰å”¯ä¸€çš„IDã€‚</p> 
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ’å…¥æ•°æ®æ¥æ¼”ç¤ºè‡ªå¢IDçš„å·¥ä½œåŸç†ï¼š</p> 
<pre><code>INSERT INTO users (name, email) VALUES ('Alice', 'alice@example.com');
INSERT INTO users (name, email) VALUES ('Bob', 'bob@example.com');
INSERT INTO users (name, email) VALUES ('Charlie', 'charlie@example.com');
</code></pre> 
<p>æŸ¥è¯¢è¡¨ä¸­çš„æ•°æ®ï¼š</p> 
<pre><code>SELECT * FROM users;
</code></pre> 
<p>è¾“å‡ºåº”è¯¥ç±»ä¼¼äºï¼š</p> 
<pre><code>+----+---------+------------------+
| id | name    | email            |
+----+---------+------------------+
| 1  | Alice   | alice@example.com|
| 2  | Bob     | bob@example.com  |
| 3  | Charlie | charlie@example.com|
+----+---------+------------------+
</code></pre> 
<p>æ¯æ¬¡æ’å…¥ä¸€æ¡è®°å½•æ—¶ï¼Œ<code>id</code> åˆ—éƒ½ä¼šè‡ªåŠ¨é€’å¢ã€‚è¿™å°±æ˜¯è‡ªå¢IDçš„åŸºæœ¬å·¥ä½œåŸç†ã€‚</p> 
<p></p> 
<h2 id="%E4%B8%89.%20%E5%9F%BA%E4%BA%8ERedis%E7%9A%84%E6%96%B9%E6%A1%88">ä¸‰. åŸºäºRedisçš„æ–¹æ¡ˆ</h2> 
<p>Redisçš„æ‰€æœ‰å‘½ä»¤æ“ä½œéƒ½æ˜¯å•çº¿ç¨‹çš„ï¼Œæœ¬èº«æä¾›åƒ incr å’Œ increby è¿™æ ·çš„è‡ªå¢åŸå­å‘½ä»¤ï¼Œæ‰€ä»¥èƒ½ä¿<br> è¯ç”Ÿæˆçš„ ID è‚¯å®šæ˜¯å”¯ä¸€æœ‰åºçš„ã€‚<br><strong>ä¼˜ç‚¹</strong>ï¼šä¸ä¾èµ–äºæ•°æ®åº“ï¼Œçµæ´»æ–¹ä¾¿ï¼Œä¸”æ€§èƒ½ä¼˜äºæ•°æ®åº“ï¼›æ•°å­—IDå¤©ç„¶æ’åºï¼Œå¯¹åˆ†é¡µæˆ–è€…éœ€è¦æ’<br> åºçš„ç»“æœå¾ˆæœ‰å¸®åŠ©ã€‚<br><strong>ç¼ºç‚¹</strong>ï¼šå¦‚æœç³»ç»Ÿä¸­æ²¡æœ‰Redisï¼Œè¿˜éœ€è¦å¼•å…¥æ–°çš„ç»„ä»¶ï¼Œå¢åŠ ç³»ç»Ÿå¤æ‚åº¦ï¼›éœ€è¦ç¼–ç å’Œé…ç½®çš„å·¥ä½œ<br> é‡æ¯”è¾ƒå¤§ã€‚<br> è€ƒè™‘åˆ°å•èŠ‚ç‚¹çš„æ€§èƒ½ç“¶é¢ˆï¼Œå¯ä»¥ä½¿ç”¨ Redis é›†ç¾¤æ¥è·å–æ›´é«˜çš„ååé‡ã€‚å‡å¦‚ä¸€ä¸ªé›†ç¾¤ä¸­æœ‰5å°<br> Redisã€‚å¯ä»¥åˆå§‹åŒ–æ¯å° Redis çš„å€¼åˆ†åˆ«æ˜¯1, 2, 3, 4, 5ï¼Œç„¶åæ­¥é•¿éƒ½æ˜¯ 5ã€‚</p> 
<p></p> 
<p>åœ¨ Redis ä¸­ç”Ÿæˆè‡ªå¢ ID é€šå¸¸å¯ä»¥é€šè¿‡ä½¿ç”¨ <code>INCR</code> å‘½ä»¤å®ç°ã€‚<code>INCR</code> å‘½ä»¤ä¼šå°†å­˜å‚¨åœ¨æŒ‡å®šé”®ä¸­çš„æ•°å­—é€’å¢ 1ï¼Œå¹¶è¿”å›é€’å¢åçš„å€¼ã€‚ä½ å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§æ¥å®ç°ä¸€ä¸ªç®€å•çš„è‡ªå¢ ID ç”Ÿæˆå™¨ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªåŸºæœ¬çš„ç¤ºä¾‹ï¼š</p> 
<pre><code>import redis.clients.jedis.Jedis;

public class RedisIdGenerator {
    private Jedis jedis;

    public RedisIdGenerator() {
        this.jedis = new Jedis("localhost");
    }

    public long getNextId(String key) {
        return jedis.incr(key);
    }

    public static void main(String[] args) {
        RedisIdGenerator idGenerator = new RedisIdGenerator();
        String key = "my_id_counter";

        // ä½¿ç”¨ç¤ºä¾‹
        for (int i = 0; i &lt; 5; i++) {
            long id = idGenerator.getNextId(key);
            System.out.println("Generated ID: " + id);
        }
    }
}
</code></pre> 
<p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ª <code>RedisIdGenerator</code> ç±»ï¼Œè¯¥ç±»åŒ…å«ä¸€ä¸ª <code>getNextId</code> æ–¹æ³•ï¼Œç”¨äºç”Ÿæˆä¸‹ä¸€ä¸ªè‡ªå¢ IDã€‚åœ¨ <code>main</code> æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶è¿ç»­è°ƒç”¨ <code>getNextId</code> æ–¹æ³•æ¥ç”Ÿæˆ IDã€‚</p> 
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™åªæ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½éœ€è¦è€ƒè™‘å¹¶å‘è®¿é—®æ—¶çš„çº¿ç¨‹å®‰å…¨æ€§ï¼Œä»¥åŠå¦‚ä½•å¤„ç† Redis è¿æ¥çš„åˆ›å»ºå’Œå…³é—­ç­‰é—®é¢˜ã€‚</p> 
<h2 id="%E5%9B%9B.%20Twitter%E7%9A%84snowflake%E7%AE%97%E6%B3%95">å››. Twitterçš„snowflakeç®—æ³•</h2> 
<p>Twitterçš„Snowflakeç®—æ³•æ˜¯ä¸€ç§ç”¨äºç”Ÿæˆåˆ†å¸ƒå¼å”¯ä¸€IDçš„ç®—æ³•ï¼Œå®ƒå¯ä»¥åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ç”Ÿæˆå…¨å±€å”¯ä¸€çš„IDã€‚Snowflakeç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†ä¸€ä¸ª64ä½çš„longå‹çš„IDåˆ†æˆå¤šä¸ªéƒ¨åˆ†ï¼ŒåŒ…æ‹¬æ—¶é—´æˆ³ã€æœºå™¨IDå’Œåºåˆ—å·ã€‚å…·ä½“æ¥è¯´ï¼ŒSnowflakeç®—æ³•çš„IDç»“æ„å¦‚ä¸‹ï¼š</p> 
<pre><code> 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| unused |   timestamp   |   worker ID  | sequence
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre> 
<ul><li>ä½è¡¨ç¤ºæœªä½¿ç”¨çš„ä½ï¼Œå¯æ ¹æ®éœ€è¦ä¿ç•™æˆ–ç”¨äºå…¶ä»–ç”¨é€”ã€‚</li><li>41ä½è¡¨ç¤ºæ—¶é—´æˆ³ï¼Œå¯ä»¥è¡¨ç¤ºçš„æ—¶é—´èŒƒå›´ä¸º2^41 / 1000 / 60 / 60 / 24 = 69å¹´å·¦å³ã€‚</li><li>10ä½è¡¨ç¤ºæœºå™¨IDï¼Œå¯ä»¥ç”¨æ¥åŒºåˆ†ä¸åŒçš„æœºå™¨ã€‚</li><li>12ä½è¡¨ç¤ºåºåˆ—å·ï¼Œå¯ä»¥ç”¨æ¥åŒºåˆ†åŒä¸€æœºå™¨åŒä¸€æ—¶é—´æˆ³å†…ç”Ÿæˆçš„ä¸åŒIDã€‚</li></ul> 
<p>Snowflakeç®—æ³•ç”ŸæˆIDçš„è¿‡ç¨‹å¦‚ä¸‹ï¼š</p> 
<ol><li>è·å–å½“å‰æ—¶é—´æˆ³ï¼Œå•ä½æ˜¯æ¯«ç§’ã€‚</li><li>ä½¿ç”¨é…ç½®çš„æœºå™¨IDã€‚</li><li>å¦‚æœå½“å‰æ—¶é—´æˆ³ä¸ä¸Šä¸€æ¬¡ç”ŸæˆIDçš„æ—¶é—´æˆ³ç›¸åŒï¼Œåˆ™ä½¿ç”¨åºåˆ—å·åŠ 1ï¼›å¦åˆ™åºåˆ—å·é‡ç½®ä¸º0ã€‚</li><li>å°†æ—¶é—´æˆ³ã€æœºå™¨IDå’Œåºåˆ—å·åˆå¹¶ç”Ÿæˆæœ€ç»ˆçš„IDã€‚</li></ol> 
<p>Snowflakeç®—æ³•çš„ä¼˜ç‚¹æ˜¯ç”Ÿæˆçš„IDæ˜¯é€’å¢çš„ã€è¶‹åŠ¿é€’å¢çš„ï¼Œå¹¶ä¸”å¯ä»¥æ ¹æ®éœ€è¦æå–å‡ºç”ŸæˆIDçš„æ—¶é—´æˆ³å’Œæœºå™¨IDã€‚ç„¶è€Œï¼ŒSnowflakeç®—æ³•ä¹Ÿæœ‰ä¸€äº›ç¼ºç‚¹ï¼Œä¾‹å¦‚åœ¨é«˜å¹¶å‘æƒ…å†µä¸‹å¯èƒ½ä¼šå‡ºç°IDé‡å¤çš„æƒ…å†µï¼Œéœ€è¦é€‚å½“çš„æªæ–½æ¥é¿å…è¿™ç§æƒ…å†µçš„å‘ç”Ÿã€‚</p> 
<p>Snowflake ç®—æ³•æ˜¯ Twitter å¼€æºçš„ä¸€ç§åˆ†å¸ƒå¼å”¯ä¸€ ID ç”Ÿæˆç®—æ³•ï¼Œç”¨äºç”Ÿæˆå…¨å±€å”¯ä¸€çš„ IDã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯å°† ID åˆ†ä¸ºä¸åŒçš„éƒ¨åˆ†ï¼ŒåŒ…æ‹¬æ—¶é—´æˆ³ã€æœºå™¨ ID å’Œåºåˆ—å·ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªè¯¦ç»†çš„å®ç°ï¼š</p> 
<pre><code>public class SnowflakeIdGenerator {
    private final long twepoch = 1288834974657L; // èµ·å§‹æ—¶é—´æˆ³ï¼Œå¯ä»¥æ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´
    private final long workerIdBits = 5L; // æœºå™¨ ID çš„ä½æ•°
    private final long datacenterIdBits = 5L; // æ•°æ®ä¸­å¿ƒ ID çš„ä½æ•°
    private final long maxWorkerId = -1L ^ (-1L &lt;&lt; workerIdBits); // æœ€å¤§æœºå™¨ ID
    private final long maxDatacenterId = -1L ^ (-1L &lt;&lt; datacenterIdBits); // æœ€å¤§æ•°æ®ä¸­å¿ƒ ID
    private final long sequenceBits = 12L; // åºåˆ—å·çš„ä½æ•°
    private final long workerIdShift = sequenceBits; // æœºå™¨ ID å·¦ç§»ä½æ•°
    private final long datacenterIdShift = sequenceBits + workerIdBits; // æ•°æ®ä¸­å¿ƒ ID å·¦ç§»ä½æ•°
    private final long timestampLeftShift = sequenceBits + workerIdBits + datacenterIdBits; // æ—¶é—´æˆ³å·¦ç§»ä½æ•°
    private final long sequenceMask = -1L ^ (-1L &lt;&lt; sequenceBits); // åºåˆ—å·æ©ç 

    private long workerId;
    private long datacenterId;
    private long sequence = 0L;
    private long lastTimestamp = -1L;

    public SnowflakeIdGenerator(long workerId, long datacenterId) {
        if (workerId &gt; maxWorkerId || workerId &lt; 0) {
            throw new IllegalArgumentException("Worker ID å¿…é¡»ä»‹äº 0 å’Œ " + maxWorkerId + " ä¹‹é—´");
        }
        if (datacenterId &gt; maxDatacenterId || datacenterId &lt; 0) {
            throw new IllegalArgumentException("Datacenter ID å¿…é¡»ä»‹äº 0 å’Œ " + maxDatacenterId + " ä¹‹é—´");
        }
        this.workerId = workerId;
        this.datacenterId = datacenterId;
    }

    public synchronized long nextId() {
        long timestamp = timeGen();

        if (timestamp &lt; lastTimestamp) {
            throw new RuntimeException("æ—¶é’Ÿå›æ‹¨å‘ç”Ÿåœ¨ " + (lastTimestamp - timestamp) + " æ¯«ç§’å†…");
        }

        if (timestamp == lastTimestamp) {
            sequence = (sequence + 1) &amp; sequenceMask;
            if (sequence == 0) {
                timestamp = tilNextMillis(lastTimestamp);
            }
        } else {
            sequence = 0L;
        }

        lastTimestamp = timestamp;

        return ((timestamp - twepoch) &lt;&lt; timestampLeftShift)
                | (datacenterId &lt;&lt; datacenterIdShift)
                | (workerId &lt;&lt; workerIdShift)
                | sequence;
    }

    private long tilNextMillis(long lastTimestamp) {
        long timestamp = timeGen();
        while (timestamp &lt;= lastTimestamp) {
            timestamp = timeGen();
        }
        return timestamp;
    }

    private long timeGen() {
        return System.currentTimeMillis();
    }

    public static void main(String[] args) {
        SnowflakeIdGenerator idGenerator = new SnowflakeIdGenerator(1, 1);

        // ä½¿ç”¨ç¤ºä¾‹
        for (int i = 0; i &lt; 5; i++) {
            long id = idGenerator.nextId();
            System.out.println("Generated ID: " + id);
        }
    }
}
</code></pre> 
<p>åœ¨è¿™ä¸ªå®ç°ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå®šä¹‰äº† Snowflake ç®—æ³•ä¸­éœ€è¦ç”¨åˆ°çš„å„ç§å‚æ•°å’Œä½ç§»æ“ä½œã€‚ç„¶åï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ª <code>nextId</code> æ–¹æ³•æ¥ç”Ÿæˆä¸‹ä¸€ä¸ª IDã€‚åœ¨ <code>main</code> æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª <code>SnowflakeIdGenerator</code> å®ä¾‹ï¼Œå¹¶è¿ç»­è°ƒç”¨ <code>nextId</code> æ–¹æ³•æ¥ç”Ÿæˆ IDã€‚</p> 
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒSnowflake ç®—æ³•ä¸­çš„æ—¶é—´æˆ³éƒ¨åˆ†å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚è¿›è¡Œè°ƒæ•´ï¼Œä»¥ç¡®ä¿ç”Ÿæˆçš„ ID åœ¨ä¸åŒæ—¶é—´å†…ä»ç„¶æ˜¯å”¯ä¸€çš„ã€‚</p> 
<h2 id="%E4%BA%94%E3%80%81%E7%99%BE%E5%BA%A6UidGenerator">äº”ã€ç™¾åº¦UidGenerator</h2> 
<p>ç™¾åº¦çš„ UIDGenerator æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼å”¯ä¸€ ID ç”Ÿæˆå™¨ï¼Œç±»ä¼¼äº Twitter çš„ Snowflake ç®—æ³•ï¼Œä½†åœ¨ç»†èŠ‚ä¸Šæœ‰æ‰€ä¸åŒã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€åŒ–çš„å®ç°ï¼Œå±•ç¤ºäº†å…¶åŸºæœ¬åŸç†ï¼š</p> 
<pre><code>import java.util.concurrent.atomic.AtomicLong;

public class BaiduUidGenerator {
    private final long twepoch = 1288834974657L; // èµ·å§‹æ—¶é—´æˆ³ï¼Œå¯ä»¥æ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´
    private final long workerIdBits = 10L; // æœºå™¨ ID çš„ä½æ•°
    private final long sequenceBits = 12L; // åºåˆ—å·çš„ä½æ•°

    private final long workerIdShift = sequenceBits; // æœºå™¨ ID å·¦ç§»ä½æ•°
    private final long timestampLeftShift = sequenceBits + workerIdBits; // æ—¶é—´æˆ³å·¦ç§»ä½æ•°
    private final long sequenceMask = -1L ^ (-1L &lt;&lt; sequenceBits); // åºåˆ—å·æ©ç 

    private final long workerId;
    private volatile long lastTimestamp = -1L;
    private volatile long sequence = 0L;

    public BaiduUidGenerator(long workerId) {
        if (workerId &lt; 0 || workerId &gt;= (1 &lt;&lt; workerIdBits)) {
            throw new IllegalArgumentException("Worker ID å¿…é¡»ä»‹äº 0 å’Œ " + ((1 &lt;&lt; workerIdBits) - 1) + " ä¹‹é—´");
        }
        this.workerId = workerId;
    }

    public synchronized long nextId() {
        long timestamp = timeGen();

        if (timestamp &lt; lastTimestamp) {
            throw new RuntimeException("æ—¶é’Ÿå›æ‹¨å‘ç”Ÿåœ¨ " + (lastTimestamp - timestamp) + " æ¯«ç§’å†…");
        }

        if (timestamp == lastTimestamp) {
            sequence = (sequence + 1) &amp; sequenceMask;
            if (sequence == 0) {
                timestamp = tilNextMillis(lastTimestamp);
            }
        } else {
            sequence = 0L;
        }

        lastTimestamp = timestamp;

        return ((timestamp - twepoch) &lt;&lt; timestampLeftShift)
                | (workerId &lt;&lt; workerIdShift)
                | sequence;
    }

    private long tilNextMillis(long lastTimestamp) {
        long timestamp = timeGen();
        while (timestamp &lt;= lastTimestamp) {
            timestamp = timeGen();
        }
        return timestamp;
    }

    private long timeGen() {
        return System.currentTimeMillis();
    }

    public static void main(String[] args) {
        BaiduUidGenerator uidGenerator = new BaiduUidGenerator(1);

        // ä½¿ç”¨ç¤ºä¾‹
        for (int i = 0; i &lt; 5; i++) {
            long id = uidGenerator.nextId();
            System.out.println("Generated ID: " + id);
        }
    }
}
</code></pre> 
<p>åœ¨è¿™ä¸ªå®ç°ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå®šä¹‰äº† BaiduUidGenerator ç±»ï¼Œå…¶ä¸­åŒ…å«äº†ä¸ Snowflake ç®—æ³•ç±»ä¼¼çš„å‚æ•°å’Œä½ç§»æ“ä½œã€‚ç„¶åï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ª nextId æ–¹æ³•æ¥ç”Ÿæˆä¸‹ä¸€ä¸ª IDã€‚åœ¨ main æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª BaiduUidGenerator å®ä¾‹ï¼Œå¹¶è¿ç»­è°ƒç”¨ nextId æ–¹æ³•æ¥ç”Ÿæˆ IDã€‚</p> 
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™åªæ˜¯ä¸€ä¸ªç®€åŒ–çš„å®ç°ï¼Œå®é™…åº”ç”¨ä¸­å¯èƒ½éœ€è¦æ ¹æ®å…·ä½“éœ€æ±‚è¿›è¡Œè°ƒæ•´å’Œä¼˜åŒ–ã€‚</p> 
<h2 id="%E7%BB%93%E8%AF%AD">ç»“è¯­</h2> 
<p>ä»¥ä¸Šæ˜¯å‡ ç§å¸¸è§çš„åˆ†å¸ƒå¼IDç”Ÿæˆæ–¹æ¡ˆï¼Œæ¯ç§æ–¹æ¡ˆéƒ½æœ‰å…¶é€‚ç”¨çš„åœºæ™¯ï¼Œå¼€å‘äººå‘˜å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ–¹æ¡ˆã€‚</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ae242c0d5bee9cf61f5509e0f2d0db36/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">åœ¨å¤šæ”¯ä»˜æ¸ é“ä¸­è¿™ä¸ªè®¾è®¡æ¨¡å¼æ— æ•Œå¥½ç”¨ï¼</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4c280dab4e1208afb8cd44a2e3253e01/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">ã€ç®€å•ç†è§£åŒ–ã€‘ å†…å­˜å‡½æ•°åŠå®ƒçš„æ¨¡æ‹Ÿå®ç°</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§å’–.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>