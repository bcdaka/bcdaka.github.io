<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>H5内嵌到APP-实现PDF浏览功能 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/a739ccc609fac9123f5c8a4d1a88dea5/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="H5内嵌到APP-实现PDF浏览功能">
  <meta property="og:description" content="1、下载插件
npm install vue-pdf-embed vue3-pdfjs vue3-pdfjs：获取PDF文件总页数
2、页面引入并使用
&lt;template&gt; &lt;div class=&#34;vuePdfEmbed&#34;&gt; &lt;div class=&#34;wraper&#34; v-if=&#34;flagCover&#34;&gt; &lt;div class=&#34;articleTitle&#34;&gt; {{ reportDetail.title }} &lt;/div&gt; &lt;div class=&#34;articleTagBox&#34;&gt; &lt;div&gt;{{ reportDetail.createTime }}&lt;/div&gt; &lt;/div&gt; &lt;div class=&#34;articleDetailCover&#34;&gt; &lt;el-image :src=&#34;reportDetail.cover&#34; alt=&#34;&#34; lazy class=&#34;articleDetailCoverImg&#34; /&gt; &lt;/div&gt; &lt;div class=&#34;articleIntroduce&#34;&gt; {{ reportDetail.summary }} &lt;/div&gt; &lt;/div&gt; &lt;VuePdfEmbed :source=&#34;state.source&#34; :style=&#34;scaleFun&#34; class=&#34;vue-pdf-embed&#34; :page=&#34;state.pageNum&#34; lazy /&gt; &lt;div class=&#34;page-tool&#34; v-if=&#34;!bottomVisible&#34;&gt; &lt;div class=&#34;page-tool-item&#34; @click=&#34;lastPage&#34;&gt;上一页&lt;/div&gt; &lt;div class=&#34;page-tool-item&#34;&gt;{{ state.pageNum }}/{{ state.numPages }}&lt;/div&gt; &lt;div class=&#34;page-tool-item&#34; @click=&#34;nextPage&#34;&gt;下一页&lt;/div&gt; &lt;/div&gt; &lt;!-- 购买提示 --&gt; &lt;div class=&#34;bottomVisible&#34; v-if=&#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-08T10:35:02+08:00">
    <meta property="article:modified_time" content="2024-08-08T10:35:02+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">H5内嵌到APP-实现PDF浏览功能</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><img alt="" height="667" src="https://images2.imgbox.com/ca/ed/XkTKpt12_o.png" width="308"></p> 
<p>1、下载插件</p> 
<pre><code class="language-javascript">npm install vue-pdf-embed vue3-pdfjs</code></pre> 
<p>vue3-pdfjs：获取PDF文件总页数</p> 
<p>2、页面引入并使用</p> 
<pre><code class="language-javascript">&lt;template&gt;
  &lt;div class="vuePdfEmbed"&gt;
    &lt;div class="wraper" v-if="flagCover"&gt;
      &lt;div class="articleTitle"&gt;
        {<!-- -->{ reportDetail.title }}
      &lt;/div&gt;
      &lt;div class="articleTagBox"&gt;
        &lt;div&gt;{<!-- -->{ reportDetail.createTime }}&lt;/div&gt;
      &lt;/div&gt;
      &lt;div class="articleDetailCover"&gt;
        &lt;el-image :src="reportDetail.cover" alt="" lazy class="articleDetailCoverImg" /&gt;
      &lt;/div&gt;
      &lt;div class="articleIntroduce"&gt;
        {<!-- -->{ reportDetail.summary }}
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;VuePdfEmbed
      :source="state.source"
      :style="scaleFun"
      class="vue-pdf-embed"
      :page="state.pageNum"
      lazy
    /&gt;
    &lt;div class="page-tool" v-if="!bottomVisible"&gt;
      &lt;div class="page-tool-item" @click="lastPage"&gt;上一页&lt;/div&gt;
      &lt;div class="page-tool-item"&gt;{<!-- -->{ state.pageNum }}/{<!-- -->{ state.numPages }}&lt;/div&gt;
      &lt;div class="page-tool-item" @click="nextPage"&gt;下一页&lt;/div&gt;
    &lt;/div&gt;
    &lt;!-- 购买提示 --&gt;
    &lt;div class="bottomVisible" v-if="bottomVisible"&gt;
      &lt;div class="lock-box"&gt;
        &lt;img src="./img/lock.png" alt="" class="lock-box-img" /&gt;
        &lt;div&gt;购买后可继续阅读本文档&lt;/div&gt;
      &lt;/div&gt;
      &lt;div class="buy-box"&gt;
        &lt;div class="fixedBoxL"&gt;
          &lt;div class="fixedBoxLT"&gt;购买全文&lt;/div&gt;
          &lt;div class="fixedBoxLB"&gt;单篇需付费¥{<!-- -->{ apperMoney }}&lt;/div&gt;
        &lt;/div&gt;
        &lt;div class="fixedBoxR" @click="goBuyReport"&gt;
          立即购买&lt;el-icon&gt;&lt;ArrowRightBold /&gt;&lt;/el-icon&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;!-- 弹框提示 --&gt;
    &lt;el-dialog v-model="dialogVisible"&gt;
      &lt;div class="dialog-box"&gt;
        &lt;div class="dialog-text-box"&gt;
          &lt;div class="dialog-title"&gt;购买后可继续阅读本文档&lt;/div&gt;
          &lt;div class="dialog-info"&gt;单篇付费只需{<!-- -->{ apperMoney }}元&lt;/div&gt;
        &lt;/div&gt;
        &lt;div class="dialog-text-box"&gt;
          &lt;div class="dialog-btn" @click="goBuyReport"&gt;立即购买&lt;/div&gt;
          &lt;div class="dialog-close" @click="handleClose"&gt;我再想想&lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div class="dialog-close-box" @click="handleClose"&gt;&lt;/div&gt;
    &lt;/el-dialog&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script setup&gt;
import {
  LaunchApp,
  detector,
  ua,
  copy,
  supportLink,
  isAndroid,
  isIos,
  inWeixin,
  inQQ,
  inWeibo,
  inBaidu,
} from "web-launch-app";
import { getReportDetailApi } from "@/http/api";
import { ElMessage } from "element-plus";
import { useRoute, useRouter } from "vue-router";
import { reactive, onMounted, ref, onUnmounted } from "vue";
import VuePdfEmbed from "vue-pdf-embed";
import { createLoadingTask } from "vue3-pdfjs"; // 获得总页数
import { ArrowRightBold } from "@element-plus/icons-vue";
const route = useRoute();
const pdfurl = ref("");
const state = reactive({
  source: pdfurl, //预览pdf文件地址
  pageNum: 1, //当前页面
  scale: 1, // 缩放比例
  numPages: 0, // 总页数
});
const scaleFun = reactive({
  transform: "scale(" + state.scale + ")",
});
// 获取上一页
function lastPage() {
  if (state.pageNum &gt; 1) {
    state.pageNum--;
  }
}
// 获取下一页
function nextPage() {
  if (state.pageNum &lt; state.numPages) {
    state.pageNum++;
  }
}
onMounted(() =&gt; {
  getReportDetail();
});
// 获取pdf文件
// let flag = ref(false); // 下载按钮的显隐
let flagCover = ref(false); // 封面显隐
let apperMoney = ref(); // 价格
let bottomVisible = ref(false);
const reportDetail = ref({});
function getReportDetail() {
  getReportDetailApi(route.query.id).then((res) =&gt; {
    if (res.code == 200) {
      document.title = res.data.title;
      if (res.data.isFree == 1 &amp;&amp; res.data.isPurchase == 2) {
        // 付费 且 已解锁
        pdfurl.value = res.data.fileUrl;
        // flag.value = true;
        // 加载异步任务
        const loadingTask = createLoadingTask(state.source);
        // 载入pdf后获取页数
        loadingTask.promise.then((pdf) =&gt; {
          state.numPages = pdf.numPages;
        });
      } else if (res.data.isFree == 0) {
        // 免费
        pdfurl.value = res.data.fileUrl;
        // flag.value = true;
        // 加载异步任务
        const loadingTask = createLoadingTask(state.source);
        // 载入pdf后获取页数
        loadingTask.promise.then((pdf) =&gt; {
          state.numPages = pdf.numPages;
        });
      } else if (res.data.isFree == 1 &amp;&amp; res.data.isPurchase == 1) {
        // 付费 且 未解锁
        // 展示封面图 且 立即购买
        reportDetail.value = res.data;
        // flag.value = false;
        if (route.query.type == "ios") {
          apperMoney.value = res.data.appearIosAmount;
        } else {
          // 安卓现价
          apperMoney.value = res.data.appearAmount;
        }
        bottomVisible.value = true;
        flagCover.value = true;
        timer = setInterval(() =&gt; {
          dialogVisible.value = true;
        }, 2000);
      }
    } else {
      ElMessage({
        message: res.msg,
        type: "error",
        plain: true,
      });
    }
  });
}

// 弹框
const dialogVisible = ref(false);
let timer;
function handleClose() {
  dialogVisible.value = false;
  clearInterval(timer);
}
onUnmounted(() =&gt; {
  clearInterval(timer);
});

// 立即购买
function goBuyReport() {
  if (isAndroid) {
    androidCscFinanceNews.clickBuyReport(Number(route.query.id));
  } else if (isIos) {
    window.webkit.messageHandlers.clickBuyReport.postMessage([Number(route.query.id)]);
  }
}
&lt;/script&gt;
&lt;style&gt;
.vuePdfEmbed {
  flex: 1;
  display: flex;
  height: 100%;
  flex-direction: column;
}
.vuePdfEmbed {
  flex: 1;
  display: flex;
  height: 100%;
  flex-direction: column;
}
.vuePdfEmbed {
  .page-tool {
    position: fixed;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    padding-left: 15px;
    padding-right: 15px;
    display: flex;
    align-items: center;
    background: rgb(66, 66, 66);
    color: white;
    border-radius: 19px;
    z-index: 100;
    cursor: pointer;
    width: 320px;
    align-items: center;
    margin: auto;
    justify-content: space-around;
  }
  .page-tool-item {
    padding: 8px 15px;
    padding-left: 10px;
    cursor: pointer;
  }
}

.el-dialog {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  margin: 0;
  width: 270px;
  height: 270px;
  background-image: url("./img/dialog.png");
  background-size: contain;
  background-color: transparent;
  box-shadow: none;
}

.el-dialog__headerbtn {
  display: none;
}

.dialog-box {
  position: absolute;
  left: 50%;
  bottom: 0;
  transform: translateX(-50%);
  width: 100%;
  height: 60%;
  display: flex;
  justify-content: space-around;
  flex-direction: column;
  align-items: center;
}

.dialog-text-box {
  display: flex;
  flex-direction: column;
  align-items: center;
}
.dialog-title {
  font-weight: 500;
  font-size: 20px;
  color: #8b2507;
  line-height: 28px;
}

.dialog-info {
  font-weight: 400;
  font-size: 16px;
  color: #ad705e;
  line-height: 23px;
}

.dialog-btn {
  width: 154px;
  height: 47px;
  background: linear-gradient(360deg, #ff330a 0%, #fc4707 100%);
  box-shadow: 0px 2px 0px 0px #ffa073, inset 1px 5px 9px 0px rgba(255, 255, 255, 0.67);
  font-weight: 500;
  font-size: 17px;
  color: #ffffff;
  line-height: 47px;
  text-align: center;
  border-radius: 80px;
}

.dialog-close {
  font-weight: 400;
  font-size: 12px;
  color: rgba(0, 0, 0, 0.4);
  line-height: 40px;
}

.dialog-close-box {
  position: absolute;
  left: 50%;
  bottom: -60px;
  transform: translateX(-50%);
  width: 36px;
  height: 36px;
  background-image: url("./img/close.png");
  background-size: cover;
}

.lock-box {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 178px;
  background: linear-gradient(180deg, rgba(253, 250, 243, 0.97) 0%, #fef2e6 100%);
  border-radius: 4px 4px 4px 4px;
  text-align: center;
  line-height: 178px;
  font-weight: 400;
  font-size: 14px;
  color: #784122;
}

.lock-box-img {
  display: block;
  width: 13px;
  height: 16px;
  margin-right: 9px;
}

.buy-box {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
  height: 60px;
  background-image: url("./img/bottom.png");
  background-size: cover;
  margin-top: -12px;
  padding: 0 30px;
}

.fixedBoxL {
  padding-top: 10px;
}
.fixedBoxLT {
  font-size: 14px;
  line-height: 20px;
  color: rgba(255, 255, 255, 0.9);
  font-weight: 400;
}

.fixedBoxLB {
  font-size: 10px;
  line-height: 12px;
  color: rgba(255, 255, 255, 0.6);
  font-weight: 400;
}

.fixedBoxR {
  display: flex;
  align-items: center;
  font-size: 16px;
  line-height: 20px;
  color: rgba(255, 255, 255, 0.9);
  font-weight: 500;
}

.bottomVisible {
  position: fixed;
  width: 100%;
  bottom: 0;
  z-index: 2;
}
.articleTitle {
  font-size: 24px;
  color: rgba(0, 0, 0, 0.9);
  line-height: 32px;
  font-weight: 500;
}

.articleTagBox {
  display: flex;
  margin-top: 12px;
  margin-bottom: 20px;
  font-size: 12px;
  line-height: 20px;
  color: rgba(106, 106, 106, 1);
}

.articleDetailCover {
  margin-bottom: 12px;
}

.el-image__inner {
  border-radius: 4px;
}

.articleDetailCoverImg {
  display: block;
  width: 100%;
  border-radius: 4px;
}

.articleIntroduce {
  font-weight: 400;
  font-size: 12px;
  color: #6b6b6b;
  line-height: 22px;
  background: #f6f6f6;
  border-radius: 4px 4px 4px 4px;
  padding: 12px;
  margin-bottom: 12px;
}

.vue-pdf-embed__page canvas {
  width: 100% !important;
}

@media screen and (min-width: 500px) {
  .bottomVisible {
    position: relative;
  }
}
&lt;/style&gt;
</code></pre> 
<p>重点代码：</p> 
<p><img alt="" height="614" src="https://images2.imgbox.com/59/69/aDuoVhl2_o.png" width="754"><img alt="" height="1200" src="https://images2.imgbox.com/56/b8/5AaGhmjl_o.png" width="591"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/73a25758de1d2e37234008e498d2645f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">决策树算法:原理及实例应用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/423e3435800e05199a11fa03d816d594/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">“百里挑一”AI原生应用亮相，百度智能云千帆AI加速器首个Demo Day来了！</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>