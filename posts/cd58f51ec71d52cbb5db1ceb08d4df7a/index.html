<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python酷库之旅-第三方库Pandas(072) - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/cd58f51ec71d52cbb5db1ceb08d4df7a/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Python酷库之旅-第三方库Pandas(072)">
  <meta property="og:description" content="目录
一、用法精讲
291、pandas.Series.dt.round函数
291-1、语法
291-2、参数
291-3、功能
291-4、返回值
291-5、说明
291-6、用法
291-6-1、数据准备
291-6-2、代码示例
291-6-3、结果输出
292、pandas.Series.dt.floor函数
292-1、语法
292-2、参数
292-3、功能
292-4、返回值
292-5、说明
292-6、用法
292-6-1、数据准备
292-6-2、代码示例
292-6-3、结果输出
293、pandas.Series.dt.ceil函数
293-1、语法
293-2、参数
293-3、功能
293-4、返回值
293-5、说明
293-6、用法
293-6-1、数据准备
293-6-2、代码示例
293-6-3、结果输出
294、pandas.Series.dt.month_name方法
294-1、语法
294-2、参数
294-3、功能
294-4、返回值
294-5、说明
294-6、用法
294-6-1、数据准备
294-6-2、代码示例
294-6-3、结果输出
295、pandas.Series.dt.day_name方法
295-1、语法
295-2、参数
295-3、功能
295-4、返回值
295-5、说明
295-6、用法
295-6-1、数据准备
295-6-2、代码示例
295-6-3、结果输出
二、推荐阅读
1、Python筑基之旅
2、Python函数之旅
3、Python算法之旅
4、Python魔法之旅
5、博客个人主页
一、用法精讲 291、pandas.Series.dt.round函数 291-1、语法 # 291、pandas.Series.dt.round函数 pandas.Series.dt.round(*args, **kwargs) Perform round operation on the data to the specified freq.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-08T09:11:48+08:00">
    <meta property="article:modified_time" content="2024-08-08T09:11:48+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python酷库之旅-第三方库Pandas(072)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><span style="color:#1a439c;"><strong>目录</strong></span></p> 
<p id="%E4%B8%80%E3%80%81%E7%94%A8%E6%B3%95%E7%B2%BE%E8%AE%B2-toc" style="margin-left:80px;"><strong><a href="#%E4%B8%80%E3%80%81%E7%94%A8%E6%B3%95%E7%B2%BE%E8%AE%B2" rel="nofollow"><span style="color:#1a439c;">一、用法精讲</span></a></strong></p> 
<p id="5%E3%80%81pandas.DataFrame.to_csv%E5%87%BD%E6%95%B0-toc" style="margin-left:120px;"><strong><a href="#5%E3%80%81pandas.DataFrame.to_csv%E5%87%BD%E6%95%B0" rel="nofollow"><span style="color:#1a439c;">291、pandas.Series.dt.round函数</span></a></strong></p> 
<p id="5-1%E3%80%81%E8%AF%AD%E6%B3%95-toc" style="margin-left:160px;"><strong><a href="#5-1%E3%80%81%E8%AF%AD%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">291-1、语法</span></a></strong></p> 
<p id="5-2%E3%80%81%E5%8F%82%E6%95%B0-toc" style="margin-left:160px;"><strong><a href="#5-2%E3%80%81%E5%8F%82%E6%95%B0" rel="nofollow"><span style="color:#1a439c;">291-2、参数</span></a></strong></p> 
<p id="5-3%E3%80%81%E5%8A%9F%E8%83%BD-toc" style="margin-left:160px;"><strong><a href="#5-3%E3%80%81%E5%8A%9F%E8%83%BD" rel="nofollow"><span style="color:#1a439c;">291-3、功能</span></a></strong></p> 
<p id="5-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC-toc" style="margin-left:160px;"><strong><a href="#5-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC" rel="nofollow"><span style="color:#1a439c;">291-4、返回值</span></a></strong></p> 
<p id="5-5%E3%80%81%E8%AF%B4%E6%98%8E-toc" style="margin-left:160px;"><strong><a href="#5-5%E3%80%81%E8%AF%B4%E6%98%8E" rel="nofollow"><span style="color:#1a439c;">291-5、说明</span></a></strong></p> 
<p id="241-6%E3%80%81%E7%94%A8%E6%B3%95-toc" style="margin-left:160px;"><strong><a href="#241-6%E3%80%81%E7%94%A8%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">291-6、用法</span></a></strong></p> 
<p id="10-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87-toc" style="margin-left:200px;"><strong><a href="#10-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87" rel="nofollow"><span style="color:#1a439c;">291-6-1、数据准备</span></a></strong></p> 
<p id="5-6-1%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B-toc" style="margin-left:200px;"><strong><a href="#5-6-1%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B" rel="nofollow"><span style="color:#1a439c;">291-6-2、代码示例</span></a></strong></p> 
<p id="5-6-2%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA-toc" style="margin-left:200px;"><strong><a href="#5-6-2%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA" rel="nofollow"><span style="color:#1a439c;">291-6-3、结果输出</span></a></strong></p> 
<p id="292%E3%80%81pandas.Series.dt.floor%E5%87%BD%E6%95%B0-toc" style="margin-left:120px;"><strong><a href="#292%E3%80%81pandas.Series.dt.floor%E5%87%BD%E6%95%B0" rel="nofollow"><span style="color:#1a439c;">292、pandas.Series.dt.floor函数</span></a></strong></p> 
<p id="292-1%E3%80%81%E8%AF%AD%E6%B3%95-toc" style="margin-left:160px;"><strong><a href="#292-1%E3%80%81%E8%AF%AD%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">292-1、语法</span></a></strong></p> 
<p id="292-2%E3%80%81%E5%8F%82%E6%95%B0-toc" style="margin-left:160px;"><strong><a href="#292-2%E3%80%81%E5%8F%82%E6%95%B0" rel="nofollow"><span style="color:#1a439c;">292-2、参数</span></a></strong></p> 
<p id="292-3%E3%80%81%E5%8A%9F%E8%83%BD-toc" style="margin-left:160px;"><strong><a href="#292-3%E3%80%81%E5%8A%9F%E8%83%BD" rel="nofollow"><span style="color:#1a439c;">292-3、功能</span></a></strong></p> 
<p id="292-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC-toc" style="margin-left:160px;"><strong><a href="#292-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC" rel="nofollow"><span style="color:#1a439c;">292-4、返回值</span></a></strong></p> 
<p id="292-5%E3%80%81%E8%AF%B4%E6%98%8E-toc" style="margin-left:160px;"><strong><a href="#292-5%E3%80%81%E8%AF%B4%E6%98%8E" rel="nofollow"><span style="color:#1a439c;">292-5、说明</span></a></strong></p> 
<p id="292-6%E3%80%81%E7%94%A8%E6%B3%95-toc" style="margin-left:160px;"><strong><a href="#292-6%E3%80%81%E7%94%A8%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">292-6、用法</span></a></strong></p> 
<p id="292-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87-toc" style="margin-left:200px;"><strong><a href="#292-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87" rel="nofollow"><span style="color:#1a439c;">292-6-1、数据准备</span></a></strong></p> 
<p id="292-6-2%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B-toc" style="margin-left:200px;"><strong><a href="#292-6-2%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B" rel="nofollow"><span style="color:#1a439c;">292-6-2、代码示例</span></a></strong></p> 
<p id="292-6-3%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA-toc" style="margin-left:200px;"><strong><a href="#292-6-3%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA" rel="nofollow"><span style="color:#1a439c;">292-6-3、结果输出</span></a></strong></p> 
<p id="293%E3%80%81pandas.Series.dt.ceil%E5%87%BD%E6%95%B0-toc" style="margin-left:120px;"><strong><a href="#293%E3%80%81pandas.Series.dt.ceil%E5%87%BD%E6%95%B0" rel="nofollow"><span style="color:#1a439c;">293、pandas.Series.dt.ceil函数</span></a></strong></p> 
<p id="293-1%E3%80%81%E8%AF%AD%E6%B3%95-toc" style="margin-left:160px;"><strong><a href="#293-1%E3%80%81%E8%AF%AD%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">293-1、语法</span></a></strong></p> 
<p id="293-2%E3%80%81%E5%8F%82%E6%95%B0-toc" style="margin-left:160px;"><strong><a href="#293-2%E3%80%81%E5%8F%82%E6%95%B0" rel="nofollow"><span style="color:#1a439c;">293-2、参数</span></a></strong></p> 
<p id="293-3%E3%80%81%E5%8A%9F%E8%83%BD-toc" style="margin-left:160px;"><strong><a href="#293-3%E3%80%81%E5%8A%9F%E8%83%BD" rel="nofollow"><span style="color:#1a439c;">293-3、功能</span></a></strong></p> 
<p id="293-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC-toc" style="margin-left:160px;"><strong><a href="#293-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC" rel="nofollow"><span style="color:#1a439c;">293-4、返回值</span></a></strong></p> 
<p id="293-5%E3%80%81%E8%AF%B4%E6%98%8E-toc" style="margin-left:160px;"><strong><a href="#293-5%E3%80%81%E8%AF%B4%E6%98%8E" rel="nofollow"><span style="color:#1a439c;">293-5、说明</span></a></strong></p> 
<p id="293-6%E3%80%81%E7%94%A8%E6%B3%95-toc" style="margin-left:160px;"><strong><a href="#293-6%E3%80%81%E7%94%A8%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">293-6、用法</span></a></strong></p> 
<p id="293-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87-toc" style="margin-left:200px;"><strong><a href="#293-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87" rel="nofollow"><span style="color:#1a439c;">293-6-1、数据准备</span></a></strong></p> 
<p id="293-6-2%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B-toc" style="margin-left:200px;"><strong><a href="#293-6-2%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B" rel="nofollow"><span style="color:#1a439c;">293-6-2、代码示例</span></a></strong></p> 
<p id="293-6-3%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA-toc" style="margin-left:200px;"><strong><a href="#293-6-3%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA" rel="nofollow"><span style="color:#1a439c;">293-6-3、结果输出</span></a></strong></p> 
<p id="294%E3%80%81pandas.Series.dt.month_name%E6%96%B9%E6%B3%95-toc" style="margin-left:120px;"><strong><a href="#294%E3%80%81pandas.Series.dt.month_name%E6%96%B9%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">294、pandas.Series.dt.month_name方法</span></a></strong></p> 
<p id="294-1%E3%80%81%E8%AF%AD%E6%B3%95-toc" style="margin-left:160px;"><strong><a href="#294-1%E3%80%81%E8%AF%AD%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">294-1、语法</span></a></strong></p> 
<p id="294-2%E3%80%81%E5%8F%82%E6%95%B0-toc" style="margin-left:160px;"><strong><a href="#294-2%E3%80%81%E5%8F%82%E6%95%B0" rel="nofollow"><span style="color:#1a439c;">294-2、参数</span></a></strong></p> 
<p id="294-3%E3%80%81%E5%8A%9F%E8%83%BD-toc" style="margin-left:160px;"><strong><a href="#294-3%E3%80%81%E5%8A%9F%E8%83%BD" rel="nofollow"><span style="color:#1a439c;">294-3、功能</span></a></strong></p> 
<p id="294-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC-toc" style="margin-left:160px;"><strong><a href="#294-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC" rel="nofollow"><span style="color:#1a439c;">294-4、返回值</span></a></strong></p> 
<p id="294-5%E3%80%81%E8%AF%B4%E6%98%8E-toc" style="margin-left:160px;"><strong><a href="#294-5%E3%80%81%E8%AF%B4%E6%98%8E" rel="nofollow"><span style="color:#1a439c;">294-5、说明</span></a></strong></p> 
<p id="294-6%E3%80%81%E7%94%A8%E6%B3%95-toc" style="margin-left:160px;"><strong><a href="#294-6%E3%80%81%E7%94%A8%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">294-6、用法</span></a></strong></p> 
<p id="294-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87-toc" style="margin-left:200px;"><strong><a href="#294-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87" rel="nofollow"><span style="color:#1a439c;">294-6-1、数据准备</span></a></strong></p> 
<p id="294-6-2%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B-toc" style="margin-left:200px;"><strong><a href="#294-6-2%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B" rel="nofollow"><span style="color:#1a439c;">294-6-2、代码示例</span></a></strong></p> 
<p id="294-6-3%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA-toc" style="margin-left:200px;"><strong><a href="#294-6-3%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA" rel="nofollow"><span style="color:#1a439c;">294-6-3、结果输出</span></a></strong></p> 
<p id="295%E3%80%81pandas.Series.dt.day_name%E6%96%B9%E6%B3%95-toc" style="margin-left:120px;"><strong><a href="#295%E3%80%81pandas.Series.dt.day_name%E6%96%B9%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">295、pandas.Series.dt.day_name方法</span></a></strong></p> 
<p id="295-1%E3%80%81%E8%AF%AD%E6%B3%95-toc" style="margin-left:160px;"><strong><a href="#295-1%E3%80%81%E8%AF%AD%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">295-1、语法</span></a></strong></p> 
<p id="295-2%E3%80%81%E5%8F%82%E6%95%B0-toc" style="margin-left:160px;"><strong><a href="#295-2%E3%80%81%E5%8F%82%E6%95%B0" rel="nofollow"><span style="color:#1a439c;">295-2、参数</span></a></strong></p> 
<p id="295-3%E3%80%81%E5%8A%9F%E8%83%BD-toc" style="margin-left:160px;"><strong><a href="#295-3%E3%80%81%E5%8A%9F%E8%83%BD" rel="nofollow"><span style="color:#1a439c;">295-3、功能</span></a></strong></p> 
<p id="295-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC-toc" style="margin-left:160px;"><strong><a href="#295-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC" rel="nofollow"><span style="color:#1a439c;">295-4、返回值</span></a></strong></p> 
<p id="295-5%E3%80%81%E8%AF%B4%E6%98%8E-toc" style="margin-left:160px;"><strong><a href="#295-5%E3%80%81%E8%AF%B4%E6%98%8E" rel="nofollow"><span style="color:#1a439c;">295-5、说明</span></a></strong></p> 
<p id="295-6%E3%80%81%E7%94%A8%E6%B3%95-toc" style="margin-left:160px;"><strong><a href="#295-6%E3%80%81%E7%94%A8%E6%B3%95" rel="nofollow"><span style="color:#1a439c;">295-6、用法</span></a></strong></p> 
<p id="295-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87-toc" style="margin-left:200px;"><strong><a href="#295-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87" rel="nofollow"><span style="color:#1a439c;">295-6-1、数据准备</span></a></strong></p> 
<p id="295-6-2%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B-toc" style="margin-left:200px;"><strong><a href="#295-6-2%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B" rel="nofollow"><span style="color:#1a439c;">295-6-2、代码示例</span></a></strong></p> 
<p id="295-6-3%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA-toc" style="margin-left:200px;"><strong><a href="#295-6-3%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA" rel="nofollow"><span style="color:#1a439c;">295-6-3、结果输出</span></a></strong></p> 
<p id="%E4%BA%94%E3%80%81%E6%8E%A8%E8%8D%90%E9%98%85%E8%AF%BB-toc" style="margin-left:80px;"><strong><a href="#%E4%BA%94%E3%80%81%E6%8E%A8%E8%8D%90%E9%98%85%E8%AF%BB" rel="nofollow"><span style="color:#1a439c;">二、推荐阅读</span></a></strong></p> 
<p id="1%E3%80%81-toc" style="margin-left:120px;"><strong><a href="#1%E3%80%81" rel="nofollow"><span style="color:#1a439c;">1、Python筑基之旅</span></a></strong></p> 
<p id="2%E3%80%81-toc" style="margin-left:120px;"><strong><a href="#2%E3%80%81" rel="nofollow"><span style="color:#1a439c;">2、Python函数之旅</span></a></strong></p> 
<p id="3%E3%80%81-toc" style="margin-left:120px;"><strong><a href="#3%E3%80%81" rel="nofollow"><span style="color:#1a439c;">3、Python算法之旅</span></a></strong></p> 
<p id="4%E3%80%81-toc" style="margin-left:120px;"><strong><a href="#4%E3%80%81" rel="nofollow"><span style="color:#1a439c;">4、Python魔法之旅</span></a></strong></p> 
<p id="5%E3%80%81%C2%A0-toc" style="margin-left:120px;"><strong><a href="#5%E3%80%81%C2%A0" rel="nofollow"><span style="color:#1a439c;">5、博客个人主页</span></a></strong></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/ec/3c/1hzl09PU_o.gif"></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/c9/2f/QSZq5GUL_o.png"></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/38/ef/3nkF6ffy_o.gif"></p> 
<h4 id="%E4%B8%80%E3%80%81%E7%94%A8%E6%B3%95%E7%B2%BE%E8%AE%B2">一、用法精讲</h4> 
<h5 id="5%E3%80%81pandas.DataFrame.to_csv%E5%87%BD%E6%95%B0">291、<span style="color:#fe2c24;">pandas.Series.dt.round</span>函数</h5> 
<h6 id="5-1%E3%80%81%E8%AF%AD%E6%B3%95">291-1、语法</h6> 
<pre><code class="language-python"># 291、pandas.Series.dt.round函数
pandas.Series.dt.round(*args, **kwargs)
Perform round operation on the data to the specified freq.

Parameters:
freq
str or Offset
The frequency level to round the index to. Must be a fixed frequency like ‘S’ (second) not ‘ME’ (month end). See frequency aliases for a list of possible freq values.

ambiguous
‘infer’, bool-ndarray, ‘NaT’, default ‘raise’
Only relevant for DatetimeIndex:

‘infer’ will attempt to infer fall dst-transition hours based on order

bool-ndarray where True signifies a DST time, False designates a non-DST time (note that this flag is only applicable for ambiguous times)

‘NaT’ will return NaT where there are ambiguous times

‘raise’ will raise an AmbiguousTimeError if there are ambiguous times.

nonexistent
‘shift_forward’, ‘shift_backward’, ‘NaT’, timedelta, default ‘raise’
A nonexistent time does not exist in a particular timezone where clocks moved forward due to DST.

‘shift_forward’ will shift the nonexistent time forward to the closest existing time

‘shift_backward’ will shift the nonexistent time backward to the closest existing time

‘NaT’ will return NaT where there are nonexistent times

timedelta objects will shift nonexistent times by the timedelta

‘raise’ will raise an NonExistentTimeError if there are nonexistent times.

Returns:
DatetimeIndex, TimedeltaIndex, or Series
Index of the same type for a DatetimeIndex or TimedeltaIndex, or a Series with the same index for a Series.

Raises:
ValueError if the
freq
cannot be converted.
Notes

If the timestamps have a timezone, rounding will take place relative to the local (“wall”) time and re-localized to the same timezone. When rounding near daylight savings time, use nonexistent and ambiguous to control the re-localization behavior.</code></pre> 
<h6 id="5-2%E3%80%81%E5%8F%82%E6%95%B0">291-2、参数</h6> 
<p><span style="color:#fe2c24;"><strong>291-2-1、freq</strong></span><span style="color:#956fe7;"><strong>(必须)</strong></span><span style="color:#fe2c24;"><strong>：</strong></span>str or DateOffset，指定要四舍五入到的时间频率，常见的频率字符串包括：</p> 
<ul><li><strong>s：</strong>秒</li><li><strong>min：</strong>分钟</li><li><strong>h：</strong>小时</li><li><strong>D：</strong>天</li><li><strong>W：</strong>周</li><li><strong>M：</strong>月</li><li><strong>Q：</strong>季度</li><li><strong>A：</strong>年</li></ul> 
<p><span style="color:#fe2c24;"><strong>291-2-2、ambiguous</strong></span><span style="color:#956fe7;"><strong>(可选，默认值为'raise')</strong></span><span style="color:#fe2c24;"><strong>：</strong></span>用于处理夏令时转换时的模棱两可的时间。默认情况下，如果时间不明确，会引发错误。可以选择以下选项之一：</p> 
<ul><li><strong>'raise'：</strong>如果遇到不明确的时间，则引发错误。</li><li><strong>'NaT'：</strong>将不明确的时间设置为NaT。</li><li><strong>bool array：</strong>具有与时间戳相同长度的布尔数组，指示每个时间戳是否为夏令时。</li></ul> 
<p><span style="color:#fe2c24;"><strong>291-2-3、nonexistent</strong></span><span style="color:#956fe7;"><strong>(可选，默认值为'raise')</strong></span><span style="color:#fe2c24;"><strong>：</strong></span>用于处理不存在的时间，例如从夏令时到标准时间的转换。默认情况下，如果时间不存在，会引发错误。可以选择以下选项之一：</p> 
<ul><li><strong>'raise'：</strong>如果遇到不存在的时间，则引发错误。</li><li><strong>'NaT'：</strong>将不存在的时间设置为NaT。</li><li><strong>timedelta：</strong>使用给定的时间差调整不存在的时间。</li></ul> 
<h6 id="5-3%E3%80%81%E5%8A%9F%E8%83%BD">291-3、功能</h6> 
<p>        用于将datetime数据四舍五入到最近的指定频率。例如，可以将datetime数据四舍五入到最近的秒、分钟、小时等，这对于需要标准化时间戳数据或进行时间间隔计算时非常有用。</p> 
<h6 id="5-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC">291-4、返回值</h6> 
<p>        返回一个新的Series，其中包含四舍五入到指定频率的datetime数据。</p> 
<h6 id="5-5%E3%80%81%E8%AF%B4%E6%98%8E">291-5、说明</h6> 
<p>        使用场景：</p> 
<p><strong>291-5-1、数据标准化和对齐：</strong>在处理时间序列数据时，经常需要将时间戳对齐到统一的频率，以便进行进一步的分析和处理。例如，将不同时间戳对齐到最近的整点、整分或整秒，以便对不同时间序列进行比较或合并。</p> 
<p><strong>291-5-2、处理高频数据：</strong>在金融数据分析中，经常会处理高频交易数据，为了简化分析过程，可以将这些高频数据(如毫秒级别的交易数据)四舍五入到秒、分钟或小时级别，以便于观察趋势和模式。</p> 
<p><strong>291-5-3、生成时间窗口：</strong>在生成固定长度的时间窗口时，可以使用该方法将时间戳四舍五入到最近的窗口边界。例如，在生成按分钟分组的窗口时，可以将时间戳四舍五入到最近的分钟。</p> 
<p><strong>291-5-4、数据清理和预处理：</strong>在数据清理过程中，经常需要处理不精确的时间戳数据，通过将时间戳四舍五入到最近的标准时间，可以消除小的误差，使数据更加整洁和一致。</p> 
<p><strong>291-5-5、数据聚合：</strong>在对时间序列数据进行聚合操作(如计算平均值、总和等)之前，通常需要将时间戳对齐到同一频率。例如，在按小时聚合数据时，可以先将时间戳四舍五入到最近的小时。</p> 
<h6 id="241-6%E3%80%81%E7%94%A8%E6%B3%95">291-6、用法</h6> 
<h6 id="10-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87">291-6-1、数据准备</h6> 
<pre><code class="language-python">无</code></pre> 
<h6 id="5-6-1%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B">291-6-2、代码示例</h6> 
<pre><code class="language-python"># 291、pandas.Series.dt.round方法
# 291-1、天气数据分析
import pandas as pd
# 创建示例天气数据
weather_data = pd.DataFrame({
    'timestamp': pd.to_datetime([
        '2024-08-07 14:35:29', '2024-08-07 14:35:45', '2024-08-07 14:36:12'
    ]),
    'temperature': [25.3, 25.5, 25.7]
})
# 将时间戳四舍五入到最近的分钟
weather_data['rounded_timestamp'] = weather_data['timestamp'].dt.round('min')
# 按照四舍五入后的时间戳计算每分钟的平均温度
average_temperature_per_minute = weather_data.groupby('rounded_timestamp')['temperature'].mean().reset_index()
print("每分钟的平均温度:")
print(average_temperature_per_minute, end='\n\n')

# 291-2、交通流量分析
import pandas as pd
# 创建示例交通流量数据
traffic_data = pd.DataFrame({
    'timestamp': pd.to_datetime([
        '2024-08-07 08:15:12', '2024-08-07 08:16:45', '2024-08-07 08:17:59'
    ]),
    'vehicle_count': [15, 20, 25]
})
# 将时间戳四舍五入到最近的小时
traffic_data['rounded_timestamp'] = traffic_data['timestamp'].dt.round('h')
# 按照四舍五入后的时间戳计算每小时的车流量总数
vehicle_count_per_hour = traffic_data.groupby('rounded_timestamp')['vehicle_count'].sum().reset_index()
print("每小时的车流量总数:")
print(vehicle_count_per_hour, end='\n\n')

# 291-3、股票交易数据分析
import pandas as pd
# 创建示例股票交易数据
trade_data = pd.DataFrame({
    'timestamp': pd.to_datetime([
        '2024-08-07 09:00:01.123', '2024-08-07 09:00:02.456', '2024-08-07 09:00:03.789'
    ]),
    'trade_amount': [1000, 1500, 2000]
})
# 将时间戳四舍五入到最近的秒
trade_data['rounded_timestamp'] = trade_data['timestamp'].dt.round('s')
# 按照四舍五入后的时间戳计算每秒的交易总金额
trade_amount_per_second = trade_data.groupby('rounded_timestamp')['trade_amount'].sum().reset_index()
print("每秒的交易总金额:")
print(trade_amount_per_second, end='\n\n')

# 291-4、制造业生产数据分析
import pandas as pd
# 创建示例制造业生产数据
production_data = pd.DataFrame({
    'timestamp': pd.to_datetime([
        '2024-08-07 10:12:34', '2024-08-07 10:45:21', '2024-08-07 11:02:45'
    ]),
    'quantity': [100, 200, 150]
})
# 将时间戳四舍五入到最近的小时
production_data['rounded_timestamp'] = production_data['timestamp'].dt.round('h')
# 按照四舍五入后的时间戳计算每小时的生产数量
quantity_per_hour = production_data.groupby('rounded_timestamp')['quantity'].sum().reset_index()
print("每小时的生产数量:")
print(quantity_per_hour, end='\n\n')

# 291-5、网站访问数据分析
import pandas as pd
# 创建示例网站访问数据
visit_data = pd.DataFrame({
    'timestamp': pd.to_datetime([
        '2024-08-07 15:03:45', '2024-08-07 15:04:15', '2024-08-07 15:04:35'
    ]),
    'user_id': [101, 102, 103]
})
# 将时间戳四舍五入到最近的分钟
visit_data['rounded_timestamp'] = visit_data['timestamp'].dt.round('min')
# 按照四舍五入后的时间戳计算每分钟的访问量
visit_count_per_minute = visit_data.groupby('rounded_timestamp')['user_id'].count().reset_index()
print("每分钟的访问量:")
print(visit_count_per_minute, end='\n\n')

# 291-6、电力消耗数据分析
import pandas as pd
# 创建示例电力消耗数据
power_consumption_data = pd.DataFrame({
    'timestamp': pd.to_datetime([
        '2024-08-07 01:45:00', '2024-08-07 13:30:00', '2024-08-08 02:15:00'
    ]),
    'power_consumption': [120, 150, 130]
})
# 将时间戳四舍五入到最近的一天
power_consumption_data['rounded_timestamp'] = power_consumption_data['timestamp'].dt.round('D')
# 按照四舍五入后的时间戳计算每天的电力消耗总量
daily_power_consumption = power_consumption_data.groupby('rounded_timestamp')['power_consumption'].sum().reset_index()
print("每天的电力消耗总量:")
print(daily_power_consumption)</code></pre> 
<h6 id="5-6-2%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA">291-6-3、结果输出</h6> 
<pre><code class="language-python"># 291、pandas.Series.dt.round方法
# 291-1、天气数据分析
# 每分钟的平均温度:
#     rounded_timestamp  temperature
# 0 2024-08-07 14:35:00         25.3
# 1 2024-08-07 14:36:00         25.6

# 291-2、交通流量分析
# 每小时的车流量总数:
#     rounded_timestamp  vehicle_count
# 0 2024-08-07 08:00:00             60

# 291-3、股票交易数据分析
# 每秒的交易总金额:
#     rounded_timestamp  trade_amount
# 0 2024-08-07 09:00:01          1000
# 1 2024-08-07 09:00:02          1500
# 2 2024-08-07 09:00:04          2000

# 291-4、制造业生产数据分析
# 每小时的生产数量:
#     rounded_timestamp  quantity
# 0 2024-08-07 10:00:00       100
# 1 2024-08-07 11:00:00       350

# 291-5、网站访问数据分析
# 每分钟的访问量:
#     rounded_timestamp  user_id
# 0 2024-08-07 15:04:00        2
# 1 2024-08-07 15:05:00        1

# 291-6、电力消耗数据分析
# 每天的电力消耗总量:
#   rounded_timestamp  power_consumption
# 0        2024-08-07                120
# 1        2024-08-08                280</code></pre> 
<h5 id="292%E3%80%81pandas.Series.dt.floor%E5%87%BD%E6%95%B0">292、<span style="color:#fe2c24;">pandas.Series.dt.floor</span>函数</h5> 
<h6 id="292-1%E3%80%81%E8%AF%AD%E6%B3%95">292-1、语法</h6> 
<pre><code class="language-python"># 292、pandas.Series.dt.floor函数
pandas.Series.dt.floor(*args, **kwargs)
Perform floor operation on the data to the specified freq.

Parameters:
freq
str or Offset
The frequency level to floor the index to. Must be a fixed frequency like ‘S’ (second) not ‘ME’ (month end). See frequency aliases for a list of possible freq values.

ambiguous
‘infer’, bool-ndarray, ‘NaT’, default ‘raise’
Only relevant for DatetimeIndex:

‘infer’ will attempt to infer fall dst-transition hours based on order

bool-ndarray where True signifies a DST time, False designates a non-DST time (note that this flag is only applicable for ambiguous times)

‘NaT’ will return NaT where there are ambiguous times

‘raise’ will raise an AmbiguousTimeError if there are ambiguous times.

nonexistent
‘shift_forward’, ‘shift_backward’, ‘NaT’, timedelta, default ‘raise’
A nonexistent time does not exist in a particular timezone where clocks moved forward due to DST.

‘shift_forward’ will shift the nonexistent time forward to the closest existing time

‘shift_backward’ will shift the nonexistent time backward to the closest existing time

‘NaT’ will return NaT where there are nonexistent times

timedelta objects will shift nonexistent times by the timedelta

‘raise’ will raise an NonExistentTimeError if there are nonexistent times.

Returns:
DatetimeIndex, TimedeltaIndex, or Series
Index of the same type for a DatetimeIndex or TimedeltaIndex, or a Series with the same index for a Series.

Raises:
ValueError if the
freq
cannot be converted.
Notes

If the timestamps have a timezone, flooring will take place relative to the local (“wall”) time and re-localized to the same timezone. When flooring near daylight savings time, use nonexistent and ambiguous to control the re-localization behavior.</code></pre> 
<h6 id="292-2%E3%80%81%E5%8F%82%E6%95%B0">292-2、参数</h6> 
<p><span style="color:#fe2c24;"><strong>292-2-1、freq</strong></span><span style="color:#956fe7;"><strong>(必须)</strong></span><span style="color:#fe2c24;"><strong>：</strong></span>str or DateOffset，指定要四舍五入到的时间频率，常见的频率字符串包括：</p> 
<ul><li><strong>s：</strong>秒</li><li><strong>min：</strong>分钟</li><li><strong>h：</strong>小时</li><li><strong>D：</strong>天</li><li><strong>W：</strong>周</li><li><strong>M：</strong>月</li><li><strong>Q：</strong>季度</li><li><strong>A：</strong>年</li></ul> 
<p><span style="color:#fe2c24;"><strong>292-2-2、ambiguous</strong></span><span style="color:#956fe7;"><strong>(可选，默认值为'raise')</strong></span><span style="color:#fe2c24;"><strong>：</strong></span>用于处理夏令时转换时的模棱两可的时间。默认情况下，如果时间不明确，会引发错误。可以选择以下选项之一：</p> 
<ul><li><strong>'raise'：</strong>如果遇到不明确的时间，则引发错误。</li><li><strong>'NaT'：</strong>将不明确的时间设置为NaT。</li><li><strong>bool array：</strong>具有与时间戳相同长度的布尔数组，指示每个时间戳是否为夏令时。</li></ul> 
<p><span style="color:#fe2c24;"><strong>292-2-3、nonexistent</strong></span><span style="color:#956fe7;"><strong>(可选，默认值为'raise')</strong></span><span style="color:#fe2c24;"><strong>：</strong></span>用于处理不存在的时间，例如从夏令时到标准时间的转换。默认情况下，如果时间不存在，会引发错误。可以选择以下选项之一：</p> 
<ul><li><strong>'raise'：</strong>如果遇到不存在的时间，则引发错误。</li><li><strong>'NaT'：</strong>将不存在的时间设置为NaT。</li><li><strong>timedelta：</strong>使用给定的时间差调整不存在的时间。</li></ul> 
<h6 id="292-3%E3%80%81%E5%8A%9F%E8%83%BD">292-3、功能</h6> 
<p>        将每个时间戳向下取整到指定的时间频率。例如，如果我们有一系列时间戳，并希望将它们对齐到最近的小时，我们可以使用floor('h')。</p> 
<h6 id="292-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC">292-4、返回值</h6> 
<p>        返回一个新的pandas.Series对象，其中的每个时间戳都被向下取整到指定频率，原始的Series对象不会被修改。</p> 
<h6 id="292-5%E3%80%81%E8%AF%B4%E6%98%8E">292-5、说明</h6> 
<p>        使用场景：</p> 
<p><strong>292-5-1、时间对齐：</strong>在进行时间序列分析时，数据可能来自不同的源，并且时间戳不完全一致，使用floor方法可以将这些时间戳对齐到统一的时间间隔，从而简化数据的合并和比较。</p> 
<p><strong>292-5-2、数据聚合：</strong>当需要对时间序列数据进行聚合分析时，如按小时、天、周等频率计算平均值或总和，floor方法可以帮助将时间戳对齐到这些频率，之后可以使用groupby和聚合函数进行分析。</p> 
<p><strong>292-5-3、异常值处理：</strong>在处理时间序列数据时，可能会遇到一些不规则的时间戳，使用floor方法可以将这些不规则的时间戳对齐到标准的时间间隔，便于后续的异常值处理。</p> 
<p><strong>292-5-4、缺失值填充：</strong>通过将时间序列对齐到固定的时间间隔，可以方便地识别和填充缺失值。例如，可以使用reindex方法创建一个完整的时间索引，然后填充缺失的数据。</p> 
<p><strong>292-5-5、滚动窗口计算：</strong>在时间序列分析中，经常需要计算滚动窗口统计量(如滚动平均值)，floor方法可以帮助将时间对齐，从而简化滚动窗口计算的过程。</p> 
<p><strong>292-5-6、实时数据流处理：</strong>在处理实时数据流时，经常需要将数据按固定的时间间隔进行处理，floor方法可以帮助将实时数据对齐到固定的时间窗口，从而简化实时数据的处理逻辑。</p> 
<h6 id="292-6%E3%80%81%E7%94%A8%E6%B3%95">292-6、用法</h6> 
<h6 id="292-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87">292-6-1、数据准备</h6> 
<pre><code class="language-python">无</code></pre> 
<h6 id="292-6-2%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B">292-6-2、代码示例</h6> 
<pre><code class="language-python"># 292、pandas.Series.dt.floor函数
# 292-1、时间对齐
import pandas as pd
# 示例数据
timestamps = pd.Series(pd.to_datetime(['2024-08-07 10:15:30', '2024-08-07 10:45:15', '2024-08-07 11:05:45']))
floored_hours = timestamps.dt.floor('h')
print(floored_hours, end='\n\n')

# 292-2、数据聚合
import pandas as pd
# 示例数据
data = {
    'timestamp': pd.to_datetime(['2024-08-07 10:15:30', '2024-08-07 10:45:15', '2024-08-07 11:05:45']),
    'value': [10, 20, 30]
}
df = pd.DataFrame(data)
df['floored_hour'] = df['timestamp'].dt.floor('h')
aggregated = df.groupby('floored_hour')['value'].sum()
print(aggregated, end='\n\n')

# 292-3、异常值处理
import pandas as pd
# 示例数据
timestamps = pd.Series(pd.to_datetime(['2024-08-07 10:15:30', '2024-08-07 10:45:15', '2024-08-07 11:05:45']))
floored_minutes = timestamps.dt.floor('min')
print(floored_minutes, end='\n\n')

# 292-4、缺失值填充
import pandas as pd
# 示例数据
timestamps = pd.date_range('2024-08-07 10:00:00', periods=3, freq='h')
values = [10, None, 30]
df = pd.DataFrame({'timestamp': timestamps, 'value': values})
df.set_index('timestamp', inplace=True)
df = df.reindex(pd.date_range('2024-08-07 10:00:00', '2024-08-07 12:00:00', freq='h'))
df['value'].fillna(method='ffill', inplace=True)
print(df, end='\n\n')

# 292-5、滚动窗口计算
import pandas as pd
# 示例数据
data = pd.Series([10, 20, 30], index=pd.to_datetime(['2024-08-07 10:15:30', '2024-08-07 10:45:15', '2024-08-07 11:05:45']))
floored_data = data.groupby(data.index.floor('h')).sum()
rolling_mean = floored_data.rolling(window=2).mean()
print(rolling_mean, end='\n\n')

# 292-6、实时数据流处理
import pandas as pd
import numpy as np
# 模拟实时数据流
timestamps = pd.Series(pd.to_datetime(['2024-08-07 10:15:30', '2024-08-07 10:45:15', '2024-08-07 11:05:45']))
values = pd.Series(np.random.randn(len(timestamps)))
# 对齐到最近的分钟
floored_minutes = timestamps.dt.floor('min')
real_time_df = pd.DataFrame({'timestamp': floored_minutes, 'value': values})
print(real_time_df)</code></pre> 
<h6 id="292-6-3%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA">292-6-3、结果输出</h6> 
<pre><code class="language-python"># 292、pandas.Series.dt.floor函数
# 292-1、时间对齐
# 0   2024-08-07 10:00:00
# 1   2024-08-07 10:00:00
# 2   2024-08-07 11:00:00
# dtype: datetime64[ns]

# 292-2、数据聚合
# floored_hour
# 2024-08-07 10:00:00    30
# 2024-08-07 11:00:00    30
# Name: value, dtype: int64

# 292-3、异常值处理
# 0   2024-08-07 10:15:00
# 1   2024-08-07 10:45:00
# 2   2024-08-07 11:05:00
# dtype: datetime64[ns]

# 292-4、缺失值填充
#                      value
# 2024-08-07 10:00:00   10.0
# 2024-08-07 11:00:00   10.0
# 2024-08-07 12:00:00   30.0

# 292-5、滚动窗口计算
# 2024-08-07 10:00:00     NaN
# 2024-08-07 11:00:00    30.0
# dtype: float64

# 292-6、实时数据流处理
#             timestamp     value
# 0 2024-08-07 10:15:00 -1.294484
# 1 2024-08-07 10:45:00 -1.846297
# 2 2024-08-07 11:05:00 -2.314171</code></pre> 
<h5 id="293%E3%80%81pandas.Series.dt.ceil%E5%87%BD%E6%95%B0">293、<span style="color:#fe2c24;">pandas.Series.dt.ceil</span>函数</h5> 
<h6 id="293-1%E3%80%81%E8%AF%AD%E6%B3%95">293-1、语法</h6> 
<pre><code class="language-python"># 293、pandas.Series.dt.ceil函数
pandas.Series.dt.ceil(*args, **kwargs)
Perform ceil operation on the data to the specified freq.

Parameters:
freq
str or Offset
The frequency level to ceil the index to. Must be a fixed frequency like ‘S’ (second) not ‘ME’ (month end). See frequency aliases for a list of possible freq values.

ambiguous
‘infer’, bool-ndarray, ‘NaT’, default ‘raise’
Only relevant for DatetimeIndex:

‘infer’ will attempt to infer fall dst-transition hours based on order

bool-ndarray where True signifies a DST time, False designates a non-DST time (note that this flag is only applicable for ambiguous times)

‘NaT’ will return NaT where there are ambiguous times

‘raise’ will raise an AmbiguousTimeError if there are ambiguous times.

nonexistent
‘shift_forward’, ‘shift_backward’, ‘NaT’, timedelta, default ‘raise’
A nonexistent time does not exist in a particular timezone where clocks moved forward due to DST.

‘shift_forward’ will shift the nonexistent time forward to the closest existing time

‘shift_backward’ will shift the nonexistent time backward to the closest existing time

‘NaT’ will return NaT where there are nonexistent times

timedelta objects will shift nonexistent times by the timedelta

‘raise’ will raise an NonExistentTimeError if there are nonexistent times.

Returns:
DatetimeIndex, TimedeltaIndex, or Series
Index of the same type for a DatetimeIndex or TimedeltaIndex, or a Series with the same index for a Series.

Raises:
ValueError if the
freq
cannot be converted.
Notes

If the timestamps have a timezone, ceiling will take place relative to the local (“wall”) time and re-localized to the same timezone. When ceiling near daylight savings time, use nonexistent and ambiguous to control the re-localization behavior.</code></pre> 
<h6 id="293-2%E3%80%81%E5%8F%82%E6%95%B0">293-2、参数</h6> 
<p><span style="color:#fe2c24;"><strong>293-2-1、freq</strong></span><span style="color:#956fe7;"><strong>(必须)</strong></span><span style="color:#fe2c24;"><strong>：</strong></span>str or DateOffset，指定要四舍五入到的时间频率，常见的频率字符串包括：</p> 
<ul><li><strong>s：</strong>秒</li><li><strong>min：</strong>分钟</li><li><strong>h：</strong>小时</li><li><strong>D：</strong>天</li><li><strong>W：</strong>周</li><li><strong>M：</strong>月</li><li><strong>Q：</strong>季度</li><li><strong>A：</strong>年</li></ul> 
<p><span style="color:#fe2c24;"><strong>293-2-2、ambiguous</strong></span><span style="color:#956fe7;"><strong>(可选，默认值为'raise')</strong></span><span style="color:#fe2c24;"><strong>：</strong></span>用于处理夏令时转换时的模棱两可的时间。默认情况下，如果时间不明确，会引发错误。可以选择以下选项之一：</p> 
<ul><li><strong>'raise'：</strong>如果遇到不明确的时间，则引发错误。</li><li><strong>'NaT'：</strong>将不明确的时间设置为NaT。</li><li><strong>bool array：</strong>具有与时间戳相同长度的布尔数组，指示每个时间戳是否为夏令时。</li></ul> 
<p><span style="color:#fe2c24;"><strong>293-2-3、nonexistent</strong></span><span style="color:#956fe7;"><strong>(可选，默认值为'raise')</strong></span><span style="color:#fe2c24;"><strong>：</strong></span>用于处理不存在的时间，例如从夏令时到标准时间的转换。默认情况下，如果时间不存在，会引发错误。可以选择以下选项之一：</p> 
<ul><li><strong>'raise'：</strong>如果遇到不存在的时间，则引发错误。</li><li><strong>'NaT'：</strong>将不存在的时间设置为NaT。</li><li><strong>timedelta：</strong>使用给定的时间差调整不存在的时间。</li></ul> 
<h6 id="293-3%E3%80%81%E5%8A%9F%E8%83%BD">293-3、功能</h6> 
<p>        用于将时间序列中的每个时间戳向上取整到最近的指定频率。例如，如果将一个时间序列取整到小时，那么所有分钟和秒的信息都会被抹去，每个时间戳都会向上取整到下一个整点小时。</p> 
<h6 id="293-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC">293-4、返回值</h6> 
<p>        返回值是一个pandas.Series对象，包含了将原时间序列的每个时间戳向上取整到最近频率的时间戳。</p> 
<h6 id="293-5%E3%80%81%E8%AF%B4%E6%98%8E">293-5、说明</h6> 
<p>        使用场景：</p> 
<p><strong>293-5-1、数据预处理：</strong>在处理时间序列数据时，有时候需要将时间戳标准化为相同的频率，以便进行后续分析。比如，将交易数据、传感器数据等按小时或天进行汇总分析。</p> 
<p><strong>293-5-2、时间间隔对齐：</strong>在计算时间间隔时，可能需要将时间戳向上取整到最近的频率，以确保时间间隔的一致性。例如，在计算每日、每小时的平均值、总和等统计数据时，可以使用该函数将时间戳对齐到整点。</p> 
<p><strong>293-5-3、可视化：</strong>在进行时间序列数据的可视化时，将时间戳向上取整到最近的频率可以使图表更易读。例如，将数据按小时或天进行聚合后再绘图，可以减少图表的复杂度，提高可读性。</p> 
<p><strong>293-5-4、数据合并：</strong>在合并多个时间序列数据时，可能需要将时间戳对齐到相同的频率，以便进行合并和比较。例如，将不同来源的传感器数据合并到同一个时间轴上，可以使用该函数将所有时间戳对齐到最近的整点。</p> 
<h6 id="293-6%E3%80%81%E7%94%A8%E6%B3%95">293-6、用法</h6> 
<h6 id="293-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87">293-6-1、数据准备</h6> 
<pre><code class="language-python">无</code></pre> 
<h6 id="293-6-2%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B">293-6-2、代码示例</h6> 
<pre><code class="language-python"># 293、pandas.Series.dt.ceil函数
# 293-1、数据预处理
import pandas as pd
# 示例数据：传感器数据
data = {
    'timestamp': [
        '2024-08-07 08:45:00', '2024-08-07 08:50:00', '2024-08-07 09:05:00',
        '2024-08-07 09:15:00', '2024-08-07 10:05:00'
    ],
    'value': [10, 12, 13, 15, 20]
}
df = pd.DataFrame(data)
df['timestamp'] = pd.to_datetime(df['timestamp'])
# 将时间戳向上取整到最近的小时
df['rounded_timestamp'] = df['timestamp'].dt.ceil('h')
# 按小时汇总数据
hourly_summary = df.groupby('rounded_timestamp')['value'].sum().reset_index()
print(hourly_summary, end='\n\n')

# 293-2、时间间隔对齐
import pandas as pd
# 示例数据：交易数据
trade_data = {
    'trade_time': [
        '2024-08-07 10:15:25', '2024-08-07 10:15:35', '2024-08-07 10:15:45',
        '2024-08-07 10:16:00', '2024-08-07 10:16:20'
    ],
    'price': [100, 101, 102, 103, 104]
}
trade_df = pd.DataFrame(trade_data)
trade_df['trade_time'] = pd.to_datetime(trade_df['trade_time'])
# 将时间戳向上取整到最近的分钟
trade_df['aligned_time'] = trade_df['trade_time'].dt.ceil('min')
print(trade_df, end='\n\n')

# 293-3、可视化
import matplotlib.pyplot as plt
# 示例数据：网页访问数据
visit_data = {
    'visit_time': [
        '2024-08-01 12:34:56', '2024-08-01 14:22:33', '2024-08-02 09:18:45',
        '2024-08-02 10:12:34', '2024-08-03 16:45:12'
    ],
    'visits': [1, 1, 1, 1, 1]
}
visit_df = pd.DataFrame(visit_data)
visit_df['visit_time'] = pd.to_datetime(visit_df['visit_time'])
# 将时间戳向上取整到最近的天
visit_df['day'] = visit_df['visit_time'].dt.ceil('D')
# 按天汇总数据
daily_visits = visit_df.groupby('day')['visits'].sum().reset_index()
# 可视化
plt.figure(figsize=(10, 5))
plt.plot(daily_visits['day'], daily_visits['visits'], marker='o')
plt.xlabel('Date')
plt.ylabel('Number of Visits')
plt.title('Daily Web Visits')
plt.grid(True)
plt.show()

# 293-4、数据合并
import pandas as pd
# 示例数据：传感器A数据
sensor_a_data = {
    'timestamp': [
        '2024-08-07 10:15:25', '2024-08-07 10:35:12', '2024-08-07 10:55:45'
    ],
    'sensor_a_value': [0.1, 0.3, 0.5]
}
sensor_a_df = pd.DataFrame(sensor_a_data)
sensor_a_df['timestamp'] = pd.to_datetime(sensor_a_df['timestamp'])
sensor_a_df['timestamp'] = sensor_a_df['timestamp'].dt.ceil('h')
# 示例数据：传感器B数据
sensor_b_data = {
    'timestamp': [
        '2024-08-07 11:05:21', '2024-08-07 11:22:33'
    ],
    'sensor_b_value': [0.6, 0.7]
}
sensor_b_df = pd.DataFrame(sensor_b_data)
sensor_b_df['timestamp'] = pd.to_datetime(sensor_b_df['timestamp'])
sensor_b_df['timestamp'] = sensor_b_df['timestamp'].dt.ceil('h')
# 合并数据
merged_df = pd.merge(sensor_a_df, sensor_b_df, on='timestamp', how='outer')
print(merged_df, end='\n\n')</code></pre> 
<h6 id="293-6-3%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA">293-6-3、结果输出</h6> 
<pre><code class="language-python"># 293、pandas.Series.dt.ceil函数
# 293-1、数据预处理
#     rounded_timestamp  value
# 0 2024-08-07 09:00:00     22
# 1 2024-08-07 10:00:00     28
# 2 2024-08-07 11:00:00     20

# 293-2、时间间隔对齐
#            trade_time  price        aligned_time
# 0 2024-08-07 10:15:25    100 2024-08-07 10:16:00
# 1 2024-08-07 10:15:35    101 2024-08-07 10:16:00
# 2 2024-08-07 10:15:45    102 2024-08-07 10:16:00
# 3 2024-08-07 10:16:00    103 2024-08-07 10:16:00
# 4 2024-08-07 10:16:20    104 2024-08-07 10:17:00

# 293-3、可视化
# 见图1

# 293-4、数据合并
#             timestamp  sensor_a_value  sensor_b_value
# 0 2024-08-07 11:00:00             0.1             NaN
# 1 2024-08-07 11:00:00             0.3             NaN
# 2 2024-08-07 11:00:00             0.5             NaN
# 3 2024-08-07 12:00:00             NaN             0.6
# 4 2024-08-07 12:00:00             NaN             0.7</code></pre> 
<p>图1：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/f0/ed/ba9V4cR9_o.png"></p> 
<h5 id="294%E3%80%81pandas.Series.dt.month_name%E6%96%B9%E6%B3%95">294、<span style="color:#fe2c24;">pandas.Series.dt.month_name</span>方法</h5> 
<h6 id="294-1%E3%80%81%E8%AF%AD%E6%B3%95">294-1、语法</h6> 
<pre><code class="language-python"># 294、pandas.Series.dt.month_name方法
pandas.Series.dt.month_name(*args, **kwargs)
Return the month names with specified locale.

Parameters:
locale
str, optional
Locale determining the language in which to return the month name. Default is English locale ('en_US.utf8'). Use the command locale -a on your terminal on Unix systems to find your locale language code.

Returns:
Series or Index
Series or Index of month names.</code></pre> 
<h6 id="294-2%E3%80%81%E5%8F%82%E6%95%B0">294-2、参数</h6> 
<p><span style="color:#fe2c24;"><strong>294-2-1、*args</strong></span><span style="color:#956fe7;"><strong>(可选)</strong></span><span style="color:#fe2c24;"><strong>：</strong></span>其他位置参数，为后续扩展功能做预留。</p> 
<p><span style="color:#fe2c24;"><strong>294-2-2、**kwargs</strong></span><span style="color:#956fe7;"><strong>(可选)</strong></span><span style="color:#fe2c24;"><strong>：</strong></span>其他关键字参数，为后续扩展功能做预留。</p> 
<p><span style="color:#fe2c24;"><strong>294-2-2-1、locale</strong></span><span style="color:#956fe7;"><strong>(可选)</strong></span><span style="color:#fe2c24;"><strong>：</strong></span>指定返回的月份名称的语言环境。例如，“en”表示英语，“fr”表示法语。默认情况下，返回值是根据当前系统的默认语言环境生成的。</p> 
<h6 id="294-3%E3%80%81%E5%8A%9F%E8%83%BD">294-3、功能</h6> 
<p>        用于返回datetime类型的Series对象中每个日期的月份名称，且这些名称是以字符串的形式返回的，例如“January”、“February”等。</p> 
<h6 id="294-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC">294-4、返回值</h6> 
<p>        返回一个pandas.Series对象，其中包含每个日期的月份名称。</p> 
<h6 id="294-5%E3%80%81%E8%AF%B4%E6%98%8E">294-5、说明</h6> 
<p>        使用场景：</p> 
<p><strong>294-5-1、数据可视化：</strong>在绘制时间序列图或统计图时，可以使用月份名称来标签和分类数据，使图表更具可读性。例如，绘制每个月的销售额图表时，使用月份名称作为 x 轴标签。</p> 
<p><strong>294-5-2、报告和分析：</strong>在生成数据报告时，可能需要按月份分组数据。将日期转换为月份名称可以帮助更直观地展示每个月的数据汇总和趋势。</p> 
<p><strong>294-5-3、数据清洗和预处理：</strong>在数据清洗过程中，可能需要将时间戳数据转换为更易于分析的格式，将日期转换为月份名称可以帮助将数据按月份进行聚合或分析。</p> 
<p><strong>294-5-4、市场分析：</strong>对于销售数据、用户活动数据等，可以按月份进行分析，以识别季节性趋势、销售高峰期或用户行为模式。</p> 
<p><strong>294-5-5、客户和用户行为分析：</strong>分析客户行为时，月份名称可以帮助识别客户在不同月份的活动模式或趋势，进而调整营销策略或活动计划。</p> 
<p><strong>294-5-6、财务和业务计划：</strong>企业在进行财务分析和业务计划时，需要按月份跟踪和预测各种财务指标，如收入、支出和利润等。</p> 
<h6 id="294-6%E3%80%81%E7%94%A8%E6%B3%95">294-6、用法</h6> 
<h6 id="294-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87">294-6-1、数据准备</h6> 
<pre><code class="language-python">无</code></pre> 
<h6 id="294-6-2%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B">294-6-2、代码示例</h6> 
<pre><code class="language-python"># 294、pandas.Series.dt.month_name方法
# 294-1、数据可视化
import matplotlib.pyplot as plt
import pandas as pd
# 创建示例数据
data = {
    'date': pd.date_range(start='2024-01-01', periods=12, freq='ME'),
    'sales': [200, 220, 250, 270, 300, 320, 280, 310, 330, 340, 360, 380]
}
df = pd.DataFrame(data)
# 添加月份名称列
df['month'] = df['date'].dt.month_name()
# 绘制图表
plt.figure(figsize=(10, 6))
plt.plot(df['month'], df['sales'], marker='o', color='purple')
plt.xlabel('Month')
plt.ylabel('Sales')
plt.title('Monthly Sales')
plt.xticks(rotation=45)
plt.grid(True)
# 添加数据标签
for i, value in enumerate(df['sales']):
    plt.text(i, value + 5, str(value), ha='center', va='bottom', color='red', fontweight='bold')  # 在每个点上方显示标签并加粗
plt.show()

# 294-2、报告和分析
import pandas as pd
# 创建示例数据
data = {
    'date': pd.date_range(start='2024-01-01', periods=12, freq='ME'),
    'sales': [200, 220, 250, 270, 300, 320, 280, 310, 330, 340, 360, 380]
}
df = pd.DataFrame(data)
monthly_sales = df.groupby(df['date'].dt.month_name())['sales'].sum().reset_index()
monthly_sales.columns = ['Month', 'Total Sales']
print(monthly_sales, end='\n\n')

# 294-3、数据清洗和预处理
import pandas as pd
# 创建示例数据
data = {
    'date': pd.date_range(start='2024-01-01', periods=12, freq='ME'),
    'sales': [200, 220, 250, 270, 300, 320, 280, 310, 330, 340, 360, 380]
}
df = pd.DataFrame(data)
df['month_name'] = df['date'].dt.month_name()
print(df, end='\n\n')

# 294-4、市场分析
import pandas as pd
# 创建示例数据
data = {
    'date': pd.date_range(start='2024-01-01', periods=12, freq='ME'),
    'sales': [200, 220, 250, 270, 300, 320, 280, 310, 330, 340, 360, 380]
}
df = pd.DataFrame(data)
monthly_summary = df.groupby(df['date'].dt.month_name()).agg({
    'sales': ['mean', 'median', 'max']
}).reset_index()
print(monthly_summary, end='\n\n')

# 294-5、客户和用户行为分析
import pandas as pd
# 示例数据
user_data = {
    'activity_date': pd.date_range(start='2024-01-01', periods=30, freq='D'),
    'user_id': range(1, 31)
}
user_df = pd.DataFrame(user_data)
# 添加月份名称列
user_df['month'] = user_df['activity_date'].dt.month_name()
# 按月份统计用户活动次数
activity_summary = user_df.groupby('month').size().reset_index(name='activity_count')
print(activity_summary, end='\n\n')

# 294-6、财务和业务计划
import pandas as pd
# 示例财务数据
financial_data = {
    'date': pd.date_range(start='2024-01-01', periods=12, freq='ME'),
    'revenue': [1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700, 1800, 1900, 2000, 2100]
}
financial_df = pd.DataFrame(financial_data)
# 添加月份名称列
financial_df['month'] = financial_df['date'].dt.month_name()
# 按月份汇总收入
monthly_revenue = financial_df.groupby('month')['revenue'].sum().reset_index()
print(monthly_revenue)</code></pre> 
<h6 id="294-6-3%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA">294-6-3、结果输出</h6> 
<pre><code class="language-python"># 294、pandas.Series.dt.month_name方法
# 294-1、数据可视化
# 见图2

# 294-2、报告和分析
#         Month  Total Sales
# 0       April          270
# 1      August          310
# 2    December          380
# 3    February          220
# 4     January          200
# 5        July          280
# 6        June          320
# 7       March          250
# 8         May          300
# 9    November          360
# 10    October          340
# 11  September          330

# 294-3、数据清洗和预处理
#          date  sales month_name
# 0  2024-01-31    200    January
# 1  2024-02-29    220   February
# 2  2024-03-31    250      March
# 3  2024-04-30    270      April
# 4  2024-05-31    300        May
# 5  2024-06-30    320       June
# 6  2024-07-31    280       July
# 7  2024-08-31    310     August
# 8  2024-09-30    330  September
# 9  2024-10-31    340    October
# 10 2024-11-30    360   November
# 11 2024-12-31    380   December

# 294-4、市场分析
#          date  sales            
#                 mean median  max
# 0       April  270.0  270.0  270
# 1      August  310.0  310.0  310
# 2    December  380.0  380.0  380
# 3    February  220.0  220.0  220
# 4     January  200.0  200.0  200
# 5        July  280.0  280.0  280
# 6        June  320.0  320.0  320
# 7       March  250.0  250.0  250
# 8         May  300.0  300.0  300
# 9    November  360.0  360.0  360
# 10    October  340.0  340.0  340
# 11  September  330.0  330.0  330

# 294-5、客户和用户行为分析
#      month  activity_count
# 0  January              30

# 294-6、财务和业务计划
#         month  revenue
# 0       April     1300
# 1      August     1700
# 2    December     2100
# 3    February     1100
# 4     January     1000
# 5        July     1600
# 6        June     1500
# 7       March     1200
# 8         May     1400
# 9    November     2000
# 10    October     1900
# 11  September     1800</code></pre> 
<p>图2：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/4a/46/XwNl4vo0_o.png"> </p> 
<h5 id="295%E3%80%81pandas.Series.dt.day_name%E6%96%B9%E6%B3%95">295、<span style="color:#fe2c24;">pandas.Series.dt.day_name</span>方法</h5> 
<h6 id="295-1%E3%80%81%E8%AF%AD%E6%B3%95">295-1、语法</h6> 
<pre><code class="language-python"># 295、pandas.Series.dt.day_name方法
pandas.Series.dt.day_name(*args, **kwargs)
Return the day names with specified locale.

Parameters:
locale
str, optional
Locale determining the language in which to return the day name. Default is English locale ('en_US.utf8'). Use the command locale -a on your terminal on Unix systems to find your locale language code.

Returns:
Series or Index
Series or Index of day names.</code></pre> 
<h6 id="295-2%E3%80%81%E5%8F%82%E6%95%B0">295-2、参数</h6> 
<p><span style="color:#fe2c24;"><strong>295-2-1、*args</strong></span><span style="color:#956fe7;"><strong>(可选)</strong></span><span style="color:#fe2c24;"><strong>：</strong></span>其他位置参数，为后续扩展功能做预留。</p> 
<p><span style="color:#fe2c24;"><strong>295-2-2、**kwargs</strong></span><span style="color:#956fe7;"><strong>(可选)</strong></span><span style="color:#fe2c24;"><strong>：</strong></span>其他关键字参数，为后续扩展功能做预留。</p> 
<p><span style="color:#fe2c24;"><strong>295-2-2-1、locale</strong></span><span style="color:#956fe7;"><strong>(可选)</strong></span><span style="color:#fe2c24;"><strong>：</strong></span>指定返回的月份名称的语言环境。例如，“en”表示英语，“fr”表示法语。默认情况下，返回值是根据当前系统的默认语言环境生成的。</p> 
<h6 id="295-3%E3%80%81%E5%8A%9F%E8%83%BD">295-3、功能</h6> 
<p>        提取日期时间数据中的星期几名称。如，给定一个日期 2024-08-08，它会返回"Thursday"。</p> 
<h6 id="295-4%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC">295-4、返回值</h6> 
<p>        返回一个包含星期几名称的Series对象，字符串类型，例如"Monday"、"Tuesday"等。</p> 
<h6 id="295-5%E3%80%81%E8%AF%B4%E6%98%8E">295-5、说明</h6> 
<p>        使用场景：</p> 
<p><strong>295-5-1、数据分析</strong>：在进行时间序列分析时，提取星期几名称可以帮助识别数据的周期性模式。例如，销售数据可能在周末和工作日有不同的趋势。</p> 
<p><strong>295-5-2、可视化</strong>：当创建基于日期的图表时，使用星期几名称可以使图表更具可读性，便于观察不同星期几的表现。</p> 
<p><strong>295-5-3、报表生成</strong>：在生成日报或周报时，显示具体的星期几可以让读者更清晰地理解数据的上下文。</p> 
<p><strong>295-5-4、事件调度</strong>：在安排活动或任务时，了解每个日期是星期几可以帮助选择合适的时间。例如，某些活动可能更适合在周末进行。</p> 
<p><strong>295-5-5、数据清洗</strong>：在处理包含日期的原始数据时，可以通过提取星期几来过滤或标记特定日期的数据，以便后续分析。</p> 
<p><strong>295-5-6、用户行为分析</strong>：在分析用户行为时，了解用户在不同星期几的活动情况，可以帮助优化营销策略和产品推荐。</p> 
<h6 id="295-6%E3%80%81%E7%94%A8%E6%B3%95">295-6、用法</h6> 
<h6 id="295-6-1%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87">295-6-1、数据准备</h6> 
<pre><code class="language-python">无</code></pre> 
<h6 id="295-6-2%E3%80%81%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B">295-6-2、代码示例</h6> 
<pre><code class="language-python"># 295、pandas.Series.dt.day_name方法
# 295-1、数据分析
import pandas as pd
# 创建示例销售数据
data = {
    'date': pd.date_range(start='2024-08-01', periods=10),
    'sales': [200, 300, 250, 400, 500, 600, 700, 800, 900, 1000]
}
df = pd.DataFrame(data)
# 提取星期几名称
df['day_name'] = df['date'].dt.day_name()
# 按星期几汇总销售数据
sales_by_day = df.groupby('day_name')['sales'].sum().sort_index()
print(sales_by_day, end='\n\n')

# 295-2、可视化
import matplotlib.pyplot as plt
import pandas as pd
# 创建示例销售数据
data = {
    'date': pd.date_range(start='2024-08-01', periods=10),
    'sales': [200, 300, 250, 400, 500, 600, 700, 800, 900, 1000]
}
df = pd.DataFrame(data)
# 提取星期几名称
df['day_name'] = df['date'].dt.day_name()
# 使用前面的数据
sales_by_day = df.groupby('day_name')['sales'].sum().sort_index()
# 绘制柱状图
sales_by_day.plot(kind='bar',color='green')
plt.title('Sales by Day of the Week')
plt.xlabel('Day of the Week')
plt.ylabel('Total Sales')
plt.xticks(rotation=15, color='blue')
plt.show()

# 295-3、报表生成
import pandas as pd
# 创建示例销售数据
data = {
    'date': pd.date_range(start='2024-08-01', periods=10),
    'sales': [200, 300, 250, 400, 500, 600, 700, 800, 900, 1000]
}
df = pd.DataFrame(data)
# 创建日报
report = df[['date', 'sales']]
report['day_name'] = report['date'].dt.day_name()
# 打印日报
print(report, end='\n\n')

# 295-4、事件调度
import pandas as pd
# 假设我们有一组活动数据
events = {
    'event': ['Event A', 'Event B', 'Event C', 'Event D'],
    'date': pd.to_datetime(['2024-08-03', '2024-08-05', '2024-08-06', '2024-08-07'])
}
events_df = pd.DataFrame(events)
# 添加星期几名称
events_df['day_name'] = events_df['date'].dt.day_name()
# 过滤出周末的活动
weekend_events = events_df[events_df['day_name'].isin(['Saturday', 'Sunday'])]
print(weekend_events, end='\n\n')

# 295-5、数据清洗
import pandas as pd
# 假设我们有一组原始数据
raw_data = {
    'date': pd.date_range(start='2024-08-01', periods=10),
    'value': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
}
raw_df = pd.DataFrame(raw_data)
# 添加星期几名称
raw_df['day_name'] = raw_df['date'].dt.day_name()
# 添加一列标记周末
raw_df['is_weekend'] = raw_df['day_name'].isin(['Saturday', 'Sunday'])
print(raw_df, end='\n\n')

# 295-6、用户行为分析
import pandas as pd
# 假设我们有用户行为数据
user_activity = {
    'user_id': [1, 1, 2, 2, 3, 3],
    'activity_date': pd.to_datetime(['2024-08-01', '2024-08-02', '2024-08-03', '2024-08-04', '2024-08-05', '2024-08-06'])
}
activity_df = pd.DataFrame(user_activity)
# 添加星期几名称
activity_df['day_name'] = activity_df['activity_date'].dt.day_name()
# 按星期几汇总用户活动
activity_count = activity_df.groupby('day_name')['user_id'].count()
print(activity_count)</code></pre> 
<h6 id="295-6-3%E3%80%81%E7%BB%93%E6%9E%9C%E8%BE%93%E5%87%BA">295-6-3、结果输出</h6> 
<pre><code class="language-python"># 295、pandas.Series.dt.day_name方法
# 295-1、数据分析
# day_name
# Friday       1200
# Monday        500
# Saturday     1250
# Sunday        400
# Thursday     1000
# Tuesday       600
# Wednesday     700
# Name: sales, dtype: int64

# 295-2、可视化
# 见图3

# 295-3、报表生成
#         date  sales   day_name
# 0 2024-08-01    200   Thursday
# 1 2024-08-02    300     Friday
# 2 2024-08-03    250   Saturday
# 3 2024-08-04    400     Sunday
# 4 2024-08-05    500     Monday
# 5 2024-08-06    600    Tuesday
# 6 2024-08-07    700  Wednesday
# 7 2024-08-08    800   Thursday
# 8 2024-08-09    900     Friday
# 9 2024-08-10   1000   Saturday

# 295-4、事件调度
#      event       date  day_name
# 0  Event A 2024-08-03  Saturday

# 295-5、数据清洗
#         date  value   day_name  is_weekend
# 0 2024-08-01      1   Thursday       False
# 1 2024-08-02      2     Friday       False
# 2 2024-08-03      3   Saturday        True
# 3 2024-08-04      4     Sunday        True
# 4 2024-08-05      5     Monday       False
# 5 2024-08-06      6    Tuesday       False
# 6 2024-08-07      7  Wednesday       False
# 7 2024-08-08      8   Thursday       False
# 8 2024-08-09      9     Friday       False
# 9 2024-08-10     10   Saturday        True

# 295-6、用户行为分析
# day_name
# Friday      1
# Monday      1
# Saturday    1
# Sunday      1
# Thursday    1
# Tuesday     1
# Name: user_id, dtype: int64</code></pre> 
<p>图3：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/45/2e/R11c0VVi_o.png"> </p> 
<h4 id="%E4%BA%94%E3%80%81%E6%8E%A8%E8%8D%90%E9%98%85%E8%AF%BB">二、推荐阅读</h4> 
<h5 id="1%E3%80%81">1、<a href="https://myelsa1024.blog.csdn.net/article/details/139241094?spm=1001.2014.3001.5502" rel="nofollow" title="Python筑基之旅">Python筑基之旅</a></h5> 
<h5 id="2%E3%80%81">2、<a href="https://myelsa1024.blog.csdn.net/article/details/138916144?spm=1001.2014.3001.5502" rel="nofollow" title="Python函数之旅">Python函数之旅</a></h5> 
<h5 id="3%E3%80%81">3、<a href="https://blog.csdn.net/ygb_1024/article/details/136889623?spm=1001.2014.3001.5501" title="Python算法之旅">Python算法之旅</a></h5> 
<h5 id="4%E3%80%81">4、<a href="https://myelsa1024.blog.csdn.net/article/details/139555733" rel="nofollow" title="Python魔法之旅">Python魔法之旅</a></h5> 
<h5 id="5%E3%80%81%C2%A0">5、<a href="https://blog.csdn.net/ygb_1024?spm=1010.2135.3001.5421" title="博客个人主页">博客个人主页</a></h5>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/89b352bcdd9335edac2d4a274910b783/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">iOS 18（macOS 15）Vision 中新增的任意图片智能评分功能试玩</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b6f7e8f1df1c282ff4afffb7c57dcf17/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Kotlin 和 Java区别</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>