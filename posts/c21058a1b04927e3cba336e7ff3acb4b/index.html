<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【学习心得】Python调用JS的三种常用方法 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/c21058a1b04927e3cba336e7ff3acb4b/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【学习心得】Python调用JS的三种常用方法">
  <meta property="og:description" content="在做JS逆向的时候，一种情况是直接用Python代码复现JS代码的功能，达成目的。但很多时候这种方法有明显的缺点，那就是一旦JS代码逻辑发生了更改，你就得重写Python的代码逻辑非常不便。于是第二种情况就出现了，我直接得到你的JS代码片段，用Python去操作JS运行，并得到结果。这种做法的好处在于可以将JS代码看成一个黑盒子，我不关心里面是怎么写的，我只在乎是否输出了正确的结果。
方法一、用Python的pyexecjs库 pyexecjs库允许在Python环境中执行JavaScript代码，无需浏览器环境。在我的另一篇文章中详细讲了pyexecjs库的用法，大家可以去看看哦！
http://t.csdnimg.cn/Eo29Dhttp://xn--pythonpyexecjs-082ha0760esa4358l6pybfnik9rvpff4ap62eee2q
优点：
简单易用，无需启动浏览器环境即可执行JavaScript代码。在内存中执行JavaScript代码，性能相对较高。 缺点：
只能执行纯JavaScript代码，无法处理DOM操作或者利用浏览器特性的功能（如Web API、HTML5特性等）。需要系统安装支持的JavaScript运行时环境（如Node.js或Rhino等）。对于复杂或依赖特定环境的JavaScript代码支持有限。 方法二、用Python的selenium库 selenium主要用于Web自动化测试，它可以启动一个真实的浏览器（如Chrome、Firefox等）并模拟用户操作。若要执行JavaScript代码，可以利用execute_script方法。至于如何使用execute_script我这里给出一段参考的代码：
# 导入webdriver模块中的Options类（这里省略了import语句） chrome_option = Options() # 设置Chrome浏览器启动选项，使其在无头模式下运行，即不显示用户界面 chrome_option.add_argument(&#34;--headless&#34;) # 禁用GPU硬件加速，这对于某些系统在headless模式下运行时是必要的 chrome_option.add_argument(&#34;--disable-gpu&#34;) # 忽略SSL证书错误，防止因为证书问题导致的网页加载失败 chrome_option.add_argument(&#39;--ignore-certificate-errors&#39;) # 使用前面设置好的Chrome启动选项实例化一个Chrome浏览器对象 browser = webdriver.Chrome(options=chrome_option) # 定义要访问的网址，并使用浏览器打开该网址 url = &#34;替换成你想要处理的网址&#34; browser.get(url) # 在当前页面上执行一段JavaScript代码，并获取其返回结果 result = browser.execute_script(&#34;你想执行的JS代码片段&#34;) # 输出执行JavaScript后得到的结果 print(result) # 暂停程序运行10秒，确保有足够时间进行页面加载或执行后续操作 time.sleep(10) # 关闭并退出浏览器 browser.quit() 优点：
真实的模拟浏览器环境执行JavaScript代码，因此能够处理与DOM相关的操作，以及调用浏览器提供的所有Web API和HTML5特性。适用于网页自动化测试和爬虫开发等场景，对网页动态加载内容有良好的支持。 缺点：
执行速度相比直接在内存中执行JavaScript慢，因为需要启动和控制一个完整的浏览器实例。使用成本相对较高，需要配置对应的浏览器驱动程序。若只是简单的JavaScript计算任务，使用selenium显得较为笨重。 方法三、用node.js搭建一个HTTP API后台服务接口，开放给Python代码调用 首先，在Node.js中创建一个HTTP服务器，并暴露执行JavaScript功能的API。然后，在Python中调用这个HTTP API来执行JavaScript代码。下面介绍Node.js中的一个包express，他可以快速的搭建一个Web服务。
// 导入express包 const express = require(&#34;express&#34;) // 创建Web实例 const app = express() // 设置端口 const port = 3000 // 处理GET请求 app.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-14T05:00:13+08:00">
    <meta property="article:modified_time" content="2024-03-14T05:00:13+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【学习心得】Python调用JS的三种常用方法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>        在做JS逆向的时候，一种情况是直接用Python代码复现JS代码的功能，达成目的。但很多时候这种方法有明显的缺点，那就是一旦JS代码逻辑发生了更改，你就得重写Python的代码逻辑非常不便。于是第二种情况就出现了，我直接得到你的JS代码片段，用Python去操作JS运行，并得到结果。这种做法的好处在于可以将JS代码看成一个黑盒子，我不关心里面是怎么写的，我只在乎是否输出了正确的结果。</p> 
<div> 
 <div> 
  <h2 style="margin-left:0pt;text-align:left;"><strong><span style="color:#1a1a1a;">方法一、用Python的pyexecjs库</span></strong></h2> 
 </div> 
</div> 
<div> 
 <div> 
  <p style="margin-left:0;text-align:left;"><span style="color:#333333;">pyexecjs库允许在Python环境中执行JavaScript代码，无需浏览器环境。在我的另一篇文章中详细讲了pyexecjs库的用法，大家可以去看看哦！</span></p> 
  <p style="margin-left:0;text-align:left;"><a class="has-card" href="http://xn--pythonpyexecjs-082ha0760esa4358l6pybfnik9rvpff4ap62eee2q" rel="nofollow" title="http://t.csdnimg.cn/Eo29D"><span class="link-card-box"><span class="link-title">http://t.csdnimg.cn/Eo29D</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/c6/29/LFSd8MUw_o.png" alt="icon-default.png?t=N7T8">http://xn--pythonpyexecjs-082ha0760esa4358l6pybfnik9rvpff4ap62eee2q</span></span></a></p> 
  <p style="margin-left:0;text-align:left;"><strong><span style="color:#333333;">优点：</span></strong></p> 
  <ul><li style="text-align:left;"><span style="color:#fe2c24;"><strong>简单易用</strong></span><span style="color:#333333;">，无需启动浏览器环境即可执行JavaScript代码。</span></li><li style="text-align:left;"><span style="color:#333333;">在内存中执行JavaScript代码，性能相对较高。</span></li></ul> 
  <p style="margin-left:0;text-align:left;"><strong><span style="color:#333333;">缺点：</span></strong></p> 
  <ul><li style="text-align:left;"><span style="color:#333333;">只能执行纯JavaScript代码，</span><span style="color:#fe2c24;"><strong>无法处理DOM操作或者利用浏览器特性</strong></span><span style="color:#333333;">的功能（如Web API、HTML5特性等）。</span></li><li style="text-align:left;"><span style="color:#333333;">需要系统安装支持的JavaScript运行时环境（如Node.js或Rhino等）。</span></li><li style="text-align:left;"><span style="color:#333333;">对于复杂或依赖特定环境的JavaScript代码支持有限。</span></li></ul> 
  <div> 
   <div> 
    <h2 style="margin-left:0pt;text-align:left;"><strong><span style="color:#1a1a1a;">方法二、</span></strong><strong><span style="color:#1a1a1a;">用</span></strong><strong><span style="color:#1a1a1a;">Python</span></strong><strong><span style="color:#1a1a1a;">的selenium库</span></strong></h2> 
    <p style="margin-left:0;text-align:left;"><span style="color:#333333;">        selenium主要用于Web自动化测试，它可以启动一个真实的浏览器（如Chrome、Firefox等）并模拟用户操作。若要执行JavaScript代码，可以利用execute_script方法。至于如何使用execute_script我这里给出一段参考的代码：</span></p> 
    <pre><code class="language-python"># 导入webdriver模块中的Options类（这里省略了import语句）
chrome_option = Options()

# 设置Chrome浏览器启动选项，使其在无头模式下运行，即不显示用户界面
chrome_option.add_argument("--headless")

# 禁用GPU硬件加速，这对于某些系统在headless模式下运行时是必要的
chrome_option.add_argument("--disable-gpu")

# 忽略SSL证书错误，防止因为证书问题导致的网页加载失败
chrome_option.add_argument('--ignore-certificate-errors')

# 使用前面设置好的Chrome启动选项实例化一个Chrome浏览器对象
browser = webdriver.Chrome(options=chrome_option)

# 定义要访问的网址，并使用浏览器打开该网址
url = "替换成你想要处理的网址"
browser.get(url)

# 在当前页面上执行一段JavaScript代码，并获取其返回结果
result = browser.execute_script("你想执行的JS代码片段")

# 输出执行JavaScript后得到的结果
print(result)

# 暂停程序运行10秒，确保有足够时间进行页面加载或执行后续操作
time.sleep(10)

# 关闭并退出浏览器
browser.quit()</code></pre> 
    <p style="margin-left:0;text-align:left;"><strong><span style="color:#333333;">优点：</span></strong></p> 
    <ul><li style="text-align:left;"><span style="color:#fe2c24;"><strong>真实的模拟浏览器环境</strong></span><span style="color:#333333;">执行JavaScript代码，因此能够处理与DOM相关的操作，以及调用浏览器提供的所有Web API和HTML5特性。</span></li><li style="text-align:left;"><span style="color:#333333;">适用于网页自动化测试和爬虫开发等场景，对网页动态加载内容有良好的支持。</span></li></ul> 
    <p style="margin-left:0;text-align:left;"><strong><span style="color:#333333;">缺点：</span></strong></p> 
    <ul><li style="text-align:left;"><span style="color:#333333;">执行速度相比直接在内存中</span><span style="color:#fe2c24;"><strong>执行JavaScript慢</strong></span><span style="color:#333333;">，因为需要启动和控制一个完整的浏览器实例。</span></li><li style="text-align:left;"><span style="color:#333333;">使用成本相对较高，需要配置对应的浏览器驱动程序。</span></li><li style="text-align:left;"><span style="color:#333333;">若只是简单的JavaScript计算任务，使用selenium显得较为笨重。</span></li></ul> 
    <div> 
     <div> 
      <h2 style="margin-left:0pt;text-align:left;"><strong><span style="color:#1a1a1a;">方法三、用node.js搭建一个HTTP API后台服务接口，开放给Python代码调用</span></strong></h2> 
      <p style="margin-left:0;text-align:left;"><span style="background-color:#ffffff;"><span style="color:#1f2328;">        首先，在Node.js中创建一个HTTP服务器，并暴露执行JavaScript功能的API。然后，在Python中调用这个HTTP API来执行JavaScript代码</span></span><span style="background-color:#ffffff;"><span style="color:#1f2328;">。</span></span><span style="background-color:#ffffff;"><span style="color:#1f2328;">下面介绍Node.js中的一个包express，他可以快速的搭建一个Web服务。</span></span></p> 
      <pre><code class="language-javascript">// 导入express包
const express = require("express")

// 创建Web实例
const app =  express()

// 设置端口
const port = 3000


// 处理GET请求
app.get('/', function (req, res){
    // 获取请求参数
    let params = req.query   // 获得整个请求参数
    let key = req.query.key  // 获得某个请求参数，这个key是我从前端自己传入的http://localhost:3000/?key=100
    // 返回响应
    res.send(`Your query params = ${key}`)
})


// 处理POST请求
// 先设置中间件
app.use(express.json())  // 用于解析JSON格式的请求体
app.post('/', function (req, res) {
    // 获取表单数据
    let data = req.body  // 获得整个表单数据
    let name = req.body.name  // 获得某个表单数据，这个name是我自己从前端传入的{"name": "wangxin", "age": 18}
    // 返回响应
    res.send(`Your form data = ${name}`)
})


// 启动服务
app.listen(port, function (){
    console.log(`Server is running at http://localhost:${port}`)
})
</code></pre> 
      <p style="margin-left:0;text-align:left;"><span style="background-color:#ffffff;"><strong><span style="color:#1f2328;">优点：</span></strong></span></p> 
      <ul><li style="text-align:left;"><span style="background-color:#ffffff;"><span style="color:#1f2328;">提供了一种跨语言交互的解决方案，Python可以通过HTTP请求调用Node.js服务端的JavaScript代码，灵活性较强。</span></span></li><li style="text-align:left;"><span style="background-color:#ffffff;"><span style="color:#1f2328;">Node.js服务可以</span><span style="color:#fe2c24;"><strong>封装复杂的JavaScript逻辑</strong></span><span style="color:#1f2328;">，并进行优化和安全控制，提供给Python或其他客户端调用。</span></span></li><li style="text-align:left;"><span style="background-color:#ffffff;"><span style="color:#1f2328;">可以</span><span style="color:#fe2c24;"><strong>复用已有的JavaScript模块和生态系统</strong></span><span style="color:#1f2328;">。</span></span></li></ul> 
      <p style="margin-left:0;text-align:left;"><span style="background-color:#ffffff;"><strong><span style="color:#1f2328;">缺点：</span></strong></span></p> 
      <ul><li style="text-align:left;"><span style="background-color:#ffffff;"><span style="color:#1f2328;">需要额外搭建并维护一个HTTP服务，增加了系统的复杂性和部署成本。</span></span></li><li style="text-align:left;"><span style="background-color:#ffffff;"><span style="color:#1f2328;">HTTP请求存在网络延迟，</span><span style="color:#fe2c24;"><strong>不适合对响应时间要求极高的场景</strong></span><span style="color:#1f2328;">。</span></span></li><li style="text-align:left;"><span style="background-color:#ffffff;"><span style="color:#1f2328;">如果API设计不当或未做足够的安全性验证，可能带来安全风险。例如，在上述示例中直接执行用户提供的JavaScript代码是极其危险的，应避免在生产环境中这样做。</span></span></li></ul> 
     </div> 
    </div> 
   </div> 
  </div> 
 </div> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0b2976aedcb6cf24722495f83c1e02e1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【学习心得】Python好库推荐——websocket-client</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/aa26e8dda4f0e1866ca4b70ec1107e30/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">第六篇【传奇开心果系列】Python的自动化办公库技术点案例示例：大学生数据全方位分析挖掘经典案例</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>