<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Docker存储目录问题，如何修改Docker默认存储位置？（Docker存储路径、Docker空间）/etc/docker/daemon.json（docker占用、docker容量） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/4340f83ef6c514de06f85703bb19cba8/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Docker存储目录问题，如何修改Docker默认存储位置？（Docker存储路径、Docker空间）/etc/docker/daemon.json（docker占用、docker容量）">
  <meta property="og:description" content="文章目录 如何更改docker默认存储路径？版本1（我没测试，先别用！）版本2（可行）1. 停止 Docker 服务：2. 创建新的存储目录：3. 修改 Docker 配置文件：4. 移动现有的 Docker 数据：5. 重新启动 Docker 服务：6. 验证修改7. 真实验证（记录各时间点和存储占用）Thu 11 Jul 2024 01:33:57 PM CST（`/`Available 27445M）Thu 11 Jul 2024 04:04:38 PM CST（`/`Available 27444M）Fri 12 Jul 2024 01:51:59 PM CST（`/`Available 27444M） 为什么存在以上两种修改方法，有何异同？（修改`etc/systemd/system/docker.service.d/override.conf`和修改`etc/docker/daemon.json` ）20240830 另外一个，docker.service文件也可能对配置存储目录造成影响，这似乎是老版本配置 如何更改docker默认存储路径？ 版本1（我没测试，先别用！） 默认情况下，Docker 在 Linux 上安装时会将其数据（如镜像和容器）存储在 /var/lib/docker 目录下，这个目录通常位于根分区 /。如果你的根分区 / 的空间不足，你可以考虑将 Docker 的数据目录移动到其他分区，或者在安装 Docker 时直接配置它使用其他分区。
要更改 Docker 的默认存储位置，你可以通过修改 Docker 的配置文件或在启动 Docker 服务时设置环境变量来指定新的数据目录。下面是一些步骤说明如何进行配置：
停止 Docker 服务：
sudo systemctl stop docker 修改 Docker 配置文件（如果你使用的是 systemd）：">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-30T09:18:14+08:00">
    <meta property="article:modified_time" content="2024-08-30T09:18:14+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Docker存储目录问题，如何修改Docker默认存储位置？（Docker存储路径、Docker空间）/etc/docker/daemon.json（docker占用、docker容量）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#docker_1" rel="nofollow">如何更改docker默认存储路径？</a></li><li><ul><li><a href="#1_2" rel="nofollow">版本1（我没测试，先别用！）</a></li><li><a href="#2_42" rel="nofollow">版本2（可行）</a></li><li><ul><li><a href="#1__Docker__46" rel="nofollow">1. 停止 Docker 服务：</a></li><li><a href="#2__61" rel="nofollow">2. 创建新的存储目录：</a></li><li><a href="#3__Docker__67" rel="nofollow">3. 修改 Docker 配置文件：</a></li><li><a href="#4__Docker__80" rel="nofollow">4. 移动现有的 Docker 数据：</a></li><li><a href="#5__Docker__88" rel="nofollow">5. 重新启动 Docker 服务：</a></li><li><a href="#6__95" rel="nofollow">6. 验证修改</a></li><li><a href="#7__109" rel="nofollow">7. 真实验证（记录各时间点和存储占用）</a></li><li><ul><li><a href="#Thu_11_Jul_2024_013357_PM_CSTAvailable_27445M_116" rel="nofollow">Thu 11 Jul 2024 01:33:57 PM CST（`/`Available 27445M）</a></li><li><a href="#Thu_11_Jul_2024_040438_PM_CSTAvailable_27444M_153" rel="nofollow">Thu 11 Jul 2024 04:04:38 PM CST（`/`Available 27444M）</a></li><li><a href="#Fri_12_Jul_2024_015159_PM_CSTAvailable_27444M_177" rel="nofollow">Fri 12 Jul 2024 01:51:59 PM CST（`/`Available 27444M）</a></li></ul> 
   </li></ul> 
  </li></ul> 
  </li><li><a href="#etcsystemdsystemdockerservicedoverrideconfetcdockerdaemonjson__211" rel="nofollow">为什么存在以上两种修改方法，有何异同？（修改`etc/systemd/system/docker.service.d/override.conf`和修改`etc/docker/daemon.json` ）</a></li><li><a href="#20240830_dockerservice_237" rel="nofollow">20240830 另外一个，docker.service文件也可能对配置存储目录造成影响，这似乎是老版本配置</a></li></ul> 
</div> 
<p></p> 
<h2><a id="docker_1"></a>如何更改docker默认存储路径？</h2> 
<h3><a id="1_2"></a>版本1（我没测试，先别用！）</h3> 
<p>默认情况下，Docker 在 Linux 上安装时会将其数据（如镜像和容器）存储在 <code>/var/lib/docker</code> 目录下，这个目录通常位于根分区 <code>/</code>。如果你的根分区 <code>/</code> 的空间不足，你可以考虑将 Docker 的数据目录移动到其他分区，或者在安装 Docker 时直接配置它使用其他分区。</p> 
<p>要更改 Docker 的默认存储位置，你可以通过修改 Docker 的配置文件或在启动 Docker 服务时设置环境变量来指定新的数据目录。下面是一些步骤说明如何进行配置：</p> 
<ol><li> <p>停止 Docker 服务：</p> <pre><code class="prism language-bash"><span class="token function">sudo</span> systemctl stop <span class="token function">docker</span>
</code></pre> <p><img src="https://images2.imgbox.com/b1/1e/0BIa8CUd_o.png" alt="在这里插入图片描述"></p> </li><li> <p>修改 Docker 配置文件（如果你使用的是 systemd）：</p> 
  <ul><li>打开或创建 Docker 的 systemd 配置文件（一开始没有这个文件是正常的）：<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">vi</span> /etc/systemd/system/docker.service.d/override.conf
</code></pre> </li><li>添加以下内容来指定新的数据目录，假设你想将数据存储在 <code>/mnt/docker/</code>：<pre><code class="prism language-ini">[Service]
ExecStart=
ExecStart=/usr/bin/dockerd --data-root /mnt/docker -H fd:// --containerd=/run/containerd/containerd.sock
</code></pre> </li><li>保存并关闭文件。</li></ul> </li><li> <p>重新加载 systemd 配置并重新启动 Docker 服务：</p> <pre><code class="prism language-bash"><span class="token function">sudo</span> systemctl daemon-reload
<span class="token function">sudo</span> systemctl start <span class="token function">docker</span>
</code></pre> </li><li> <p>检查 Docker 是否使用新的数据目录：</p> <pre><code class="prism language-bash"><span class="token function">docker</span> info <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"Docker Root Dir"</span>
</code></pre> </li></ol> 
<p>确保新的数据目录所在的分区有足够的空间，以避免在使用 Docker 时遇到空间不足的问题。</p> 
<h3><a id="2_42"></a>版本2（可行）</h3> 
<p>要修改 Docker 的存储路径至 <code>/data/docker</code>，您可以按照以下步骤操作：</p> 
<h4><a id="1__Docker__46"></a>1. 停止 Docker 服务：</h4> 
<p>打开终端，使用以下命令停止 Docker 服务：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> systemctl stop docker.socket
<span class="token function">sudo</span> systemctl stop <span class="token function">docker</span>
</code></pre> 
<p>一开始只执行一条停不了：<br> <img src="https://images2.imgbox.com/31/f2/VvTRfZrB_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/8f/fc/WGjHf8qp_o.png" alt="在这里插入图片描述"><br> 后面两条执行就能停了：</p> 
<p><img src="https://images2.imgbox.com/0e/e8/dQKvzgWD_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2__61"></a>2. 创建新的存储目录：</h4> 
<p>如果 <code>/data/docker</code> 目录还不存在，使用以下命令创建它：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /data/docker
</code></pre> 
<h4><a id="3__Docker__67"></a>3. 修改 Docker 配置文件：</h4> 
<p>编辑 Docker 的 daemon 配置文件 <code>/etc/docker/daemon.json</code>。如果该文件不存在，您需要创建它。</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">vi</span> /etc/docker/daemon.json
</code></pre> 
<p>在文件中添加或修改以下内容：</p> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"data-root"</span><span class="token operator">:</span> <span class="token string">"/data/docker"</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>保存并关闭文件。</p> 
<h4><a id="4__Docker__80"></a>4. 移动现有的 Docker 数据：</h4> 
<p>如果您的 Docker 安装中已经有数据，并且您希望保留这些数据，可以将现有的数据移动到新的目录：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">rsync</span> <span class="token parameter variable">-aP</span> /var/lib/docker/ /data/docker
</code></pre> 
<p><img src="https://images2.imgbox.com/77/2a/sbRfAbfJ_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="5__Docker__88"></a>5. 重新启动 Docker 服务：</h4> 
<p>使用以下命令重新启动 Docker 服务：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> systemctl start docker.socket
<span class="token function">sudo</span> systemctl start <span class="token function">docker</span>
</code></pre> 
<h4><a id="6__95"></a>6. 验证修改</h4> 
<p>检查 Docker 是否正确使用新的存储路径，可以查看 Docker 信息：</p> 
<pre><code class="prism language-bash"><span class="token function">docker</span> info <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">'Docker Root Dir'</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/6e/69/qKZpjWPy_o.png" alt="在这里插入图片描述"></p> 
<p>现在 Docker 已经成功地使用 <code>/data/docker</code> 作为其根目录了。至于您看到的警告信息 “WARNING: No swap limit support”，这是一个常见的信息，指的是您的 Linux 系统上没有启用内存交换限制的支持。</p> 
<p>在 Docker 中，这种警告通常不会影响 Docker 容器的正常运行，它只意味着 Docker 无法强制限制容器的交换内存使用量。这通常与 Linux 内核的某些配置有关，特别是 cgroup 的配置。</p> 
<p>注意：如果不放心，可以执行<code>mv /var/lib/docker /var/lib/docker_old</code>备份检测下</p> 
<h4><a id="7__109"></a>7. 真实验证（记录各时间点和存储占用）</h4> 
<p>通过使用一下两条命令：</p> 
<pre><code class="prism language-python">date
df <span class="token operator">-</span>BM
</code></pre> 
<h5><a id="Thu_11_Jul_2024_013357_PM_CSTAvailable_27445M_116"></a>Thu 11 Jul 2024 01:33:57 PM CST（<code>/</code>Available 27445M）</h5> 
<pre><code class="prism language-python">root@ai<span class="token operator">-</span>video<span class="token operator">-</span>ecs<span class="token operator">-</span><span class="token number">01</span><span class="token punctuation">:</span><span class="token operator">/</span>userdata<span class="token operator">/</span>tmp<span class="token comment"># date</span>
Thu <span class="token number">11</span> Jul <span class="token number">2024</span> <span class="token number">01</span><span class="token punctuation">:</span><span class="token number">33</span><span class="token punctuation">:</span><span class="token number">57</span> PM CST
root@ai<span class="token operator">-</span>video<span class="token operator">-</span>ecs<span class="token operator">-</span><span class="token number">01</span><span class="token punctuation">:</span><span class="token operator">/</span>userdata<span class="token operator">/</span>tmp<span class="token comment">#</span>
root@ai<span class="token operator">-</span>video<span class="token operator">-</span>ecs<span class="token operator">-</span><span class="token number">01</span><span class="token punctuation">:</span><span class="token operator">/</span>userdata<span class="token operator">/</span>tmp<span class="token comment">#</span>
root@ai<span class="token operator">-</span>video<span class="token operator">-</span>ecs<span class="token operator">-</span><span class="token number">01</span><span class="token punctuation">:</span><span class="token operator">/</span>userdata<span class="token operator">/</span>tmp<span class="token comment"># df -BM</span>
Filesystem                        1M<span class="token operator">-</span>blocks  Used Available Use<span class="token operator">%</span> Mounted on
udev                                 32078M    0M    32078M   <span class="token number">0</span><span class="token operator">%</span> <span class="token operator">/</span>dev
tmpfs                                 6425M    4M     6422M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>run
<span class="token operator">/</span>dev<span class="token operator">/</span>mapper<span class="token operator">/</span>ubuntu<span class="token operator">-</span><span class="token operator">-</span>vg<span class="token operator">-</span>ubuntu<span class="token operator">-</span><span class="token operator">-</span>lv    38122M 8911M    27445M  <span class="token number">25</span><span class="token operator">%</span> <span class="token operator">/</span>
tmpfs                                32124M    0M    32124M   <span class="token number">0</span><span class="token operator">%</span> <span class="token operator">/</span>dev<span class="token operator">/</span>shm
tmpfs                                    5M    0M        5M   <span class="token number">0</span><span class="token operator">%</span> <span class="token operator">/</span>run<span class="token operator">/</span>lock
tmpfs                                32124M    0M    32124M   <span class="token number">0</span><span class="token operator">%</span> <span class="token operator">/</span>sys<span class="token operator">/</span>fs<span class="token operator">/</span>cgroup
<span class="token operator">/</span>dev<span class="token operator">/</span>loop1                              64M   64M        0M <span class="token number">100</span><span class="token operator">%</span> <span class="token operator">/</span>snap<span class="token operator">/</span>core20<span class="token operator">/</span><span class="token number">2318</span>
<span class="token operator">/</span>dev<span class="token operator">/</span>loop0                              64M   64M        0M <span class="token number">100</span><span class="token operator">%</span> <span class="token operator">/</span>snap<span class="token operator">/</span>core20<span class="token operator">/</span><span class="token number">1828</span>
<span class="token operator">/</span>dev<span class="token operator">/</span>loop2                              50M   50M        0M <span class="token number">100</span><span class="token operator">%</span> <span class="token operator">/</span>snap<span class="token operator">/</span>snapd<span class="token operator">/</span><span class="token number">18357</span>
<span class="token operator">/</span>dev<span class="token operator">/</span>loop3                              39M   39M        0M <span class="token number">100</span><span class="token operator">%</span> <span class="token operator">/</span>snap<span class="token operator">/</span>snapd<span class="token operator">/</span><span class="token number">21759</span>
<span class="token operator">/</span>dev<span class="token operator">/</span>vda2                             1946M  109M     1719M   <span class="token number">6</span><span class="token operator">%</span> <span class="token operator">/</span>boot
<span class="token operator">/</span>dev<span class="token operator">/</span>loop4                              92M   92M        0M <span class="token number">100</span><span class="token operator">%</span> <span class="token operator">/</span>snap<span class="token operator">/</span>lxd<span class="token operator">/</span><span class="token number">24061</span>
<span class="token operator">/</span>dev<span class="token operator">/</span>sda1                           749867M 4140M   707565M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>ky
<span class="token operator">/</span>dev<span class="token operator">/</span>sda2                          9401234M 2884M  8924482M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>data
tmpfs                                 6425M    0M     6425M   <span class="token number">0</span><span class="token operator">%</span> <span class="token operator">/</span>run<span class="token operator">/</span>user<span class="token operator">/</span><span class="token number">1000</span>
overlay                            9401234M 2884M  8924482M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>data<span class="token operator">/</span>docker<span class="token operator">/</span>overlay2<span class="token operator">/</span>c385332babdae4ee85601ffa1dd1ebe6c36fc1f618389ace09b2051731d5fa8c<span class="token operator">/</span>merged
overlay                            9401234M 2884M  8924482M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>data<span class="token operator">/</span>docker<span class="token operator">/</span>overlay2<span class="token operator">/</span>31a24b6f39c2ea25d700754b5c9ea78574e772589690437fd60e4b60fac15c0c<span class="token operator">/</span>merged
overlay                            9401234M 2884M  8924482M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>data<span class="token operator">/</span>docker<span class="token operator">/</span>overlay2<span class="token operator">/</span>88149e56439d9bad5b2b785f12ff77b6052c5ba369f53f9e12a38698c34615ce<span class="token operator">/</span>merged
overlay                            9401234M 2884M  8924482M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>data<span class="token operator">/</span>docker<span class="token operator">/</span>overlay2<span class="token operator">/</span>b2171ae8eaa2b4b6bf61de50165b2e885f6e2d4373d02fd1e492cc1d2158bd9b<span class="token operator">/</span>merged
overlay                            9401234M 2884M  8924482M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>data<span class="token operator">/</span>docker<span class="token operator">/</span>overlay2<span class="token operator">/</span>3e9af67e01934706a6712e2a6601292b105c26d5fecf82218f8d7ef65ca30b3d<span class="token operator">/</span>merged
overlay                            9401234M 2884M  8924482M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>data<span class="token operator">/</span>docker<span class="token operator">/</span>overlay2<span class="token operator">/</span>341e8bc8f48a17d24ee4005c45cda9e121bececd2b0fea5463b337acbce64f04<span class="token operator">/</span>merged
overlay                            9401234M 2884M  8924482M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>data<span class="token operator">/</span>docker<span class="token operator">/</span>overlay2<span class="token operator">/</span>6ee97fa0e1597535d0d70be41d5a3220c6f58ff033dba5388a53034afbeb8f5f<span class="token operator">/</span>merged
root@ai<span class="token operator">-</span>video<span class="token operator">-</span>ecs<span class="token operator">-</span><span class="token number">01</span><span class="token punctuation">:</span><span class="token operator">/</span>userdata<span class="token operator">/</span>tmp<span class="token comment">#</span>

</code></pre> 
<h5><a id="Thu_11_Jul_2024_040438_PM_CSTAvailable_27444M_153"></a>Thu 11 Jul 2024 04:04:38 PM CST（<code>/</code>Available 27444M）</h5> 
<pre><code class="prism language-python">hw@ai<span class="token operator">-</span>video<span class="token operator">-</span>ecs<span class="token operator">-</span><span class="token number">01</span><span class="token punctuation">:</span><span class="token operator">~</span>$ date
Thu <span class="token number">11</span> Jul <span class="token number">2024</span> <span class="token number">04</span><span class="token punctuation">:</span><span class="token number">04</span><span class="token punctuation">:</span><span class="token number">38</span> PM CST
hw@ai<span class="token operator">-</span>video<span class="token operator">-</span>ecs<span class="token operator">-</span><span class="token number">01</span><span class="token punctuation">:</span><span class="token operator">~</span>$
hw@ai<span class="token operator">-</span>video<span class="token operator">-</span>ecs<span class="token operator">-</span><span class="token number">01</span><span class="token punctuation">:</span><span class="token operator">~</span>$ df <span class="token operator">-</span>BM
Filesystem                        1M<span class="token operator">-</span>blocks  Used Available Use<span class="token operator">%</span> Mounted on
udev                                 32078M    0M    32078M   <span class="token number">0</span><span class="token operator">%</span> <span class="token operator">/</span>dev
tmpfs                                 6425M    4M     6422M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>run
<span class="token operator">/</span>dev<span class="token operator">/</span>mapper<span class="token operator">/</span>ubuntu<span class="token operator">-</span><span class="token operator">-</span>vg<span class="token operator">-</span>ubuntu<span class="token operator">-</span><span class="token operator">-</span>lv    38122M 8911M    27444M  <span class="token number">25</span><span class="token operator">%</span> <span class="token operator">/</span>
tmpfs                                32124M    0M    32124M   <span class="token number">0</span><span class="token operator">%</span> <span class="token operator">/</span>dev<span class="token operator">/</span>shm
tmpfs                                    5M    0M        5M   <span class="token number">0</span><span class="token operator">%</span> <span class="token operator">/</span>run<span class="token operator">/</span>lock
tmpfs                                32124M    0M    32124M   <span class="token number">0</span><span class="token operator">%</span> <span class="token operator">/</span>sys<span class="token operator">/</span>fs<span class="token operator">/</span>cgroup
<span class="token operator">/</span>dev<span class="token operator">/</span>loop1                              64M   64M        0M <span class="token number">100</span><span class="token operator">%</span> <span class="token operator">/</span>snap<span class="token operator">/</span>core20<span class="token operator">/</span><span class="token number">2318</span>
<span class="token operator">/</span>dev<span class="token operator">/</span>loop0                              64M   64M        0M <span class="token number">100</span><span class="token operator">%</span> <span class="token operator">/</span>snap<span class="token operator">/</span>core20<span class="token operator">/</span><span class="token number">1828</span>
<span class="token operator">/</span>dev<span class="token operator">/</span>loop2                              50M   50M        0M <span class="token number">100</span><span class="token operator">%</span> <span class="token operator">/</span>snap<span class="token operator">/</span>snapd<span class="token operator">/</span><span class="token number">18357</span>
<span class="token operator">/</span>dev<span class="token operator">/</span>loop3                              39M   39M        0M <span class="token number">100</span><span class="token operator">%</span> <span class="token operator">/</span>snap<span class="token operator">/</span>snapd<span class="token operator">/</span><span class="token number">21759</span>
<span class="token operator">/</span>dev<span class="token operator">/</span>vda2                             1946M  109M     1719M   <span class="token number">6</span><span class="token operator">%</span> <span class="token operator">/</span>boot
<span class="token operator">/</span>dev<span class="token operator">/</span>loop4                              92M   92M        0M <span class="token number">100</span><span class="token operator">%</span> <span class="token operator">/</span>snap<span class="token operator">/</span>lxd<span class="token operator">/</span><span class="token number">24061</span>
<span class="token operator">/</span>dev<span class="token operator">/</span>sda1                           749867M 4141M   707564M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>ky
<span class="token operator">/</span>dev<span class="token operator">/</span>sda2                          9401234M 2886M  8924479M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>data
tmpfs                                 6425M    0M     6425M   <span class="token number">0</span><span class="token operator">%</span> <span class="token operator">/</span>run<span class="token operator">/</span>user<span class="token operator">/</span><span class="token number">1000</span>
</code></pre> 
<h5><a id="Fri_12_Jul_2024_015159_PM_CSTAvailable_27444M_177"></a>Fri 12 Jul 2024 01:51:59 PM CST（<code>/</code>Available 27444M）</h5> 
<pre><code class="prism language-python">root@ai<span class="token operator">-</span>video<span class="token operator">-</span>ecs<span class="token operator">-</span><span class="token number">01</span><span class="token punctuation">:</span><span class="token operator">/</span>userdata<span class="token operator">/</span>tmp<span class="token comment"># date</span>
Fri <span class="token number">12</span> Jul <span class="token number">2024</span> <span class="token number">01</span><span class="token punctuation">:</span><span class="token number">51</span><span class="token punctuation">:</span><span class="token number">59</span> PM CST
root@ai<span class="token operator">-</span>video<span class="token operator">-</span>ecs<span class="token operator">-</span><span class="token number">01</span><span class="token punctuation">:</span><span class="token operator">/</span>userdata<span class="token operator">/</span>tmp<span class="token comment">#</span>
root@ai<span class="token operator">-</span>video<span class="token operator">-</span>ecs<span class="token operator">-</span><span class="token number">01</span><span class="token punctuation">:</span><span class="token operator">/</span>userdata<span class="token operator">/</span>tmp<span class="token comment"># df -BM</span>
Filesystem                        1M<span class="token operator">-</span>blocks  Used Available Use<span class="token operator">%</span> Mounted on
udev                                 32078M    0M    32078M   <span class="token number">0</span><span class="token operator">%</span> <span class="token operator">/</span>dev
tmpfs                                 6425M    4M     6422M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>run
<span class="token operator">/</span>dev<span class="token operator">/</span>mapper<span class="token operator">/</span>ubuntu<span class="token operator">-</span><span class="token operator">-</span>vg<span class="token operator">-</span>ubuntu<span class="token operator">-</span><span class="token operator">-</span>lv    38122M 8911M    27444M  <span class="token number">25</span><span class="token operator">%</span> <span class="token operator">/</span>
tmpfs                                32124M    0M    32124M   <span class="token number">0</span><span class="token operator">%</span> <span class="token operator">/</span>dev<span class="token operator">/</span>shm
tmpfs                                    5M    0M        5M   <span class="token number">0</span><span class="token operator">%</span> <span class="token operator">/</span>run<span class="token operator">/</span>lock
tmpfs                                32124M    0M    32124M   <span class="token number">0</span><span class="token operator">%</span> <span class="token operator">/</span>sys<span class="token operator">/</span>fs<span class="token operator">/</span>cgroup
<span class="token operator">/</span>dev<span class="token operator">/</span>loop1                              64M   64M        0M <span class="token number">100</span><span class="token operator">%</span> <span class="token operator">/</span>snap<span class="token operator">/</span>core20<span class="token operator">/</span><span class="token number">2318</span>
<span class="token operator">/</span>dev<span class="token operator">/</span>loop0                              64M   64M        0M <span class="token number">100</span><span class="token operator">%</span> <span class="token operator">/</span>snap<span class="token operator">/</span>core20<span class="token operator">/</span><span class="token number">1828</span>
<span class="token operator">/</span>dev<span class="token operator">/</span>loop2                              50M   50M        0M <span class="token number">100</span><span class="token operator">%</span> <span class="token operator">/</span>snap<span class="token operator">/</span>snapd<span class="token operator">/</span><span class="token number">18357</span>
<span class="token operator">/</span>dev<span class="token operator">/</span>loop3                              39M   39M        0M <span class="token number">100</span><span class="token operator">%</span> <span class="token operator">/</span>snap<span class="token operator">/</span>snapd<span class="token operator">/</span><span class="token number">21759</span>
<span class="token operator">/</span>dev<span class="token operator">/</span>vda2                             1946M  109M     1719M   <span class="token number">6</span><span class="token operator">%</span> <span class="token operator">/</span>boot
<span class="token operator">/</span>dev<span class="token operator">/</span>loop4                              92M   92M        0M <span class="token number">100</span><span class="token operator">%</span> <span class="token operator">/</span>snap<span class="token operator">/</span>lxd<span class="token operator">/</span><span class="token number">24061</span>
<span class="token operator">/</span>dev<span class="token operator">/</span>sda1                           749867M 4154M   707550M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>ky
<span class="token operator">/</span>dev<span class="token operator">/</span>sda2                          9401234M 2903M  8924463M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>data
tmpfs                                 6425M    0M     6425M   <span class="token number">0</span><span class="token operator">%</span> <span class="token operator">/</span>run<span class="token operator">/</span>user<span class="token operator">/</span><span class="token number">1000</span>
overlay                            9401234M 2903M  8924463M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>data<span class="token operator">/</span>docker<span class="token operator">/</span>overlay2<span class="token operator">/</span>c385332babdae4ee85601ffa1dd1ebe6c36fc1f618389ace09b2051731d5fa8c<span class="token operator">/</span>merged
overlay                            9401234M 2903M  8924463M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>data<span class="token operator">/</span>docker<span class="token operator">/</span>overlay2<span class="token operator">/</span>31a24b6f39c2ea25d700754b5c9ea78574e772589690437fd60e4b60fac15c0c<span class="token operator">/</span>merged
overlay                            9401234M 2903M  8924463M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>data<span class="token operator">/</span>docker<span class="token operator">/</span>overlay2<span class="token operator">/</span>88149e56439d9bad5b2b785f12ff77b6052c5ba369f53f9e12a38698c34615ce<span class="token operator">/</span>merged
overlay                            9401234M 2903M  8924463M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>data<span class="token operator">/</span>docker<span class="token operator">/</span>overlay2<span class="token operator">/</span>b2171ae8eaa2b4b6bf61de50165b2e885f6e2d4373d02fd1e492cc1d2158bd9b<span class="token operator">/</span>merged
overlay                            9401234M 2903M  8924463M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>data<span class="token operator">/</span>docker<span class="token operator">/</span>overlay2<span class="token operator">/</span>3e9af67e01934706a6712e2a6601292b105c26d5fecf82218f8d7ef65ca30b3d<span class="token operator">/</span>merged
overlay                            9401234M 2903M  8924463M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>data<span class="token operator">/</span>docker<span class="token operator">/</span>overlay2<span class="token operator">/</span>341e8bc8f48a17d24ee4005c45cda9e121bececd2b0fea5463b337acbce64f04<span class="token operator">/</span>merged
overlay                            9401234M 2903M  8924463M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>data<span class="token operator">/</span>docker<span class="token operator">/</span>overlay2<span class="token operator">/</span>6ee97fa0e1597535d0d70be41d5a3220c6f58ff033dba5388a53034afbeb8f5f<span class="token operator">/</span>merged
root@ai<span class="token operator">-</span>video<span class="token operator">-</span>ecs<span class="token operator">-</span><span class="token number">01</span><span class="token punctuation">:</span><span class="token operator">/</span>userdata<span class="token operator">/</span>tmp<span class="token comment">#</span>

</code></pre> 
<h2><a id="etcsystemdsystemdockerservicedoverrideconfetcdockerdaemonjson__211"></a>为什么存在以上两种修改方法，有何异同？（修改<code>etc/systemd/system/docker.service.d/override.conf</code>和修改<code>etc/docker/daemon.json</code> ）</h2> 
<p>在修改 Docker 的存储位置时，可以通过修改 <code>etc/docker/daemon.json</code> 或 <code>etc/systemd/system/docker.service.d/override.conf</code> 来实现，两种方式都是正确的，但它们有不同的用途和适用情况：</p> 
<ol><li> <p><strong>修改 <code>/etc/docker/daemon.json</code></strong>：</p> 
  <ul><li>这种方法通过 Docker 的配置文件来设置 Docker 的默认行为，包括存储位置、日志级别、网络配置等。</li><li>要修改存储位置，你可以在 <code>daemon.json</code> 文件中设置 <code>data-root</code> 属性，指向新的存储路径。例如：<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"data-root"</span><span class="token operator">:</span> <span class="token string">"/new/path/to/docker-data"</span>
<span class="token punctuation">}</span>
</code></pre> </li><li>这种方法的优点是配置简单，且直接通过 Docker 自己的配置文件进行管理，易于理解和维护。</li></ul> </li><li> <p><strong>修改 <code>/etc/systemd/system/docker.service.d/override.conf</code></strong>：</p> 
  <ul><li>这种方法适用于在使用 systemd 管理 Docker 服务的系统上。通过 systemd 的配置覆盖文件来修改 Docker 服务的启动参数。</li><li>你可以通过创建或修改 <code>override.conf</code> 文件，添加一个新的 <code>ExecStart</code> 行，指定新的存储位置。例如：<pre><code class="prism language-py"><span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
ExecStart<span class="token operator">=</span>
ExecStart<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span>dockerd <span class="token operator">-</span><span class="token operator">-</span>data<span class="token operator">-</span>root <span class="token operator">/</span>new<span class="token operator">/</span>path<span class="token operator">/</span>to<span class="token operator">/</span>docker<span class="token operator">-</span>data
</code></pre> </li><li>注意，需要先清空原有的 <code>ExecStart</code> 设置（<code>ExecStart=</code>），然后重新定义。这样可以确保使用你的自定义设置启动 Docker。</li><li>这种方法允许你对 Docker 的启动过程进行更细粒度的控制，但相对复杂，需要对 systemd 的配置有一定了解。</li></ul> </li></ol> 
<p><strong>总结</strong>：选择哪种方法取决于你的具体需求和你对系统的控制级别。如果你希望通过 Docker 自身的配置来管理，使用 <code>daemon.json</code> 是更直接的方法。如果你需要更复杂的配置或者想要控制服务的启动参数，使用 systemd 的 <code>override.conf</code> 方法会更合适。</p> 
<h2><a id="20240830_dockerservice_237"></a>20240830 另外一个，docker.service文件也可能对配置存储目录造成影响，这似乎是老版本配置</h2> 
<p><a href="https://dontla.blog.csdn.net/article/details/141594609" rel="nofollow">参考文章：KYSL算能盒子适配soc、emmc系统服务软链接问题ky-check-mounts-and-start-services.service内存不足seaweed传输失败docker.service</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ee7b63f36932b5b8431aeb8cd5aaa380/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java经典框架之MyBatis</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5843ea509f6a874b54ef93ab079e90dd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">node中如何定义中间件</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>