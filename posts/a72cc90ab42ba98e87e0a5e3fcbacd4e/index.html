<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>LabVIEW调用Matlab脚本 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/a72cc90ab42ba98e87e0a5e3fcbacd4e/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="LabVIEW调用Matlab脚本">
  <meta property="og:description" content="1. 概述 LabVIEW调用Matlab脚本通常有两种方式，使用公式节点或者COM组件。
2. Matlab公式节点方式 推荐指数：⭐⭐⭐
是否需要安装matlab完全版：需要
使用公式节点是最常用的调用matlab节点的方式，对于代码相对简单，没有子函数的matlab脚本比较适用。 2.1 使用说明 按照如下路径找到 MATLAB script 程序面板控件，放置在程序面板框图中。在matlab脚本控件中填写代码，直接填写函数体内容，不用包含函数名称。
2.1 优缺点说明 优点：
操作简单，直接使用labview自带的控件进行文本编程。 缺点：
语法与matlab不是完全兼容，对于复杂的函数，排查语法问题很难； 不能调用包含嵌套函数的脚本需要安装matlab完全体，对电脑配置要求较高；运行时会自动出现matlab命令行窗口。 2.3 官方范例 按照如下官方文档中提供的路径，打开其中一个范例程序。
如下所示，打开了范例程序，程序功能为调用了一个matlab脚本，生成了一个二位数组，并用强度图显示出来。可以看到，matlab脚本控件中直接就是函数体，没有函数名称声明等信息，还添加了一个输出数组M。
此外，使用此种方法调用matlab时，会自动调起MATLAB Command Window。如下所示。 3. COM组件方式 推荐指数：⭐⭐⭐⭐⭐
是否需要安装matlab完全版：不需要，安装matlab引擎即可 将matlab脚本封装成dll进行调用，是很实用的方式，无论是简单还是复杂代码，嵌套了多少子函数，都是可以适用的，也是我个人比较推荐的。
3.1 使用说明 3.1.1 在matlab中生成dll 首先用maltab打开一个m文件脚本，如下所示
点击工具栏切换到APP页面，点击右侧显示更多。
找到如下“Application Compiler” ，点击打开
在弹出的页面点击新建，选择&#34;Library Compiler Project&#34;
在弹出的页面中点击选择&#34;Generic COM Component&#34;
选择要封装的matlab脚本 点击&#34;Package&#34;，选择打包文件夹路径 等待打包完成
打开&#34;for_testing&#34;文件夹，找以函数命名的dll文件，就是最终生成好的dll。
3.1.2 注册dll 管理员权限打开cmd窗口，输入如下
regsvr32 &#43; dll文件路径
实际如下图所示 输入完成后，回车运行，提示成功就可以了，如下图所示
3.1.3 程序调用dll 新建vi，找到自动化打开句柄，添加到程序面板
右键自动化句柄，选择ActiveX类，浏览找到刚才注册的 &#34;sintest&#34;
选择之后，如下图勾选，选择Class1，点击OK 右键选择添加调用节点，如下图所示 选择sintest函数
给参数赋值，并且增加关闭句柄，在句柄关闭前，增加了一个延时，这样是可以在调用脚本运行后观察到matlab生成的figure，验证调用成功的效果，figure不会立刻消失，在延时之后会消失。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-22T17:38:27+08:00">
    <meta property="article:modified_time" content="2024-03-22T17:38:27+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">LabVIEW调用Matlab脚本</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>1. 概述</h2> 
<p>LabVIEW调用Matlab脚本通常有两种方式，使用<strong>公式节点</strong>或者<strong>COM组件。</strong></p> 
<hr> 
<h2 id="1.%20Matlab%E5%85%AC%E5%BC%8F%E8%8A%82%E7%82%B9%C2%A0">2. Matlab公式节点方式</h2> 
<blockquote> 
 <p id="%E6%8E%A8%E8%8D%90%E6%8C%87%E6%95%B0%EF%BC%9A%E2%AD%90%E2%AD%90%E2%AD%90">推荐指数：⭐⭐⭐</p> 
</blockquote> 
<blockquote> 
 <p>是否需要安装matlab完全版：需要</p> 
</blockquote> 
<p>使用公式节点是最常用的调用matlab节点的方式，对于代码相对简单，没有子函数的matlab脚本比较适用。 </p> 
<h3>2.1 使用说明</h3> 
<p>按照如下路径找到 MATLAB script 程序面板控件，放置在程序面板框图中。在matlab脚本控件中填写代码，直接填写函数体内容，不用包含函数名称。</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/48/c4/QmoHcRz9_o.png" width="1200"></p> 
<h3>2.1 优缺点说明 </h3> 
<blockquote> 
 <p><strong>优点：</strong></p> 
 <ul><li>操作简单，直接使用labview自带的控件进行文本编程。</li></ul> 
</blockquote> 
<blockquote> 
 <p><strong>缺点：</strong></p> 
 <ul><li>语法与matlab不是完全兼容，对于复杂的函数，排查语法问题很难； </li><li>不能调用包含嵌套函数的脚本</li><li>需要安装matlab完全体，对电脑配置要求较高；</li><li>运行时会自动出现matlab命令行窗口。</li></ul> 
</blockquote> 
<h3>2.3 官方范例</h3> 
<p>按照如下官方文档中提供的路径，打开其中一个范例程序。</p> 
<p><img alt="" height="281" src="https://images2.imgbox.com/dc/fa/1niYMQgH_o.png" width="1200"></p> 
<p>如下所示，打开了范例程序，程序功能为调用了一个matlab脚本，生成了一个二位数组，并用强度图显示出来。可以看到，matlab脚本控件中直接就是函数体，没有函数名称声明等信息，还添加了一个输出数组M。</p> 
<p class="img-center"><img alt="" height="434" src="https://images2.imgbox.com/77/5f/od2l5kRz_o.png" width="550"></p> 
<p class="img-center"><img alt="" height="329" src="https://images2.imgbox.com/64/5e/uxsWjJ4p_o.png" width="550"></p> 
<p>此外，使用此种方法调用matlab时，会自动调起MATLAB Command Window。如下所示。 </p> 
<p class="img-center"><img alt="" height="389" src="https://images2.imgbox.com/ac/2e/rQ7A2KJu_o.png" width="550"></p> 
<hr> 
<h2 id="2.%20Matlab%20dll%20%E5%B0%81%E8%A3%85">3. COM组件方式</h2> 
<blockquote> 
 <p>推荐指数：⭐⭐⭐⭐⭐</p> 
</blockquote> 
<blockquote> 
 <p>是否需要安装matlab完全版：不需要，安装matlab引擎即可 </p> 
</blockquote> 
<p>将matlab脚本封装成dll进行调用，是很实用的方式，无论是简单还是复杂代码，嵌套了多少子函数，都是可以适用的，也是我个人比较推荐的。</p> 
<h3>3.1 使用说明</h3> 
<h4 style="text-align:justify;">3.1.1 在matlab中生成dll</h4> 
<blockquote> 
 <p>首先用maltab打开一个m文件脚本，如下所示</p> 
</blockquote> 
<p class="img-center"><img alt="" height="383" src="https://images2.imgbox.com/86/02/wYyzmP5v_o.png" width="550"></p> 
<p></p> 
<blockquote> 
 <p>点击工具栏切换到APP页面，点击右侧显示更多。</p> 
</blockquote> 
<p><img alt="" height="302" src="https://images2.imgbox.com/4a/ec/F4DaXrwd_o.png" width="1200"></p> 
<p></p> 
<blockquote> 
 <p>找到如下“Application Compiler” ，点击打开</p> 
</blockquote> 
<p class="img-center"><img alt="" height="383" src="https://images2.imgbox.com/44/dd/ITGR7ym0_o.png" width="550"></p> 
<p></p> 
<blockquote> 
 <p>在弹出的页面点击新建，选择"Library Compiler Project"</p> 
</blockquote> 
<p class="img-center"><img alt="" height="349" src="https://images2.imgbox.com/be/25/1KDAh7xr_o.png" width="550"></p> 
<p></p> 
<blockquote> 
 <p>在弹出的页面中点击选择"Generic COM Component"</p> 
</blockquote> 
<p class="img-center"><img alt="" height="349" src="https://images2.imgbox.com/3c/19/VeQ7BGQw_o.png" width="550"></p> 
<p></p> 
<blockquote> 
 <p>选择要封装的matlab脚本 </p> 
</blockquote> 
<p class="img-center"><img alt="" height="382" src="https://images2.imgbox.com/72/11/XOHRy0iQ_o.png" width="550"></p> 
<p></p> 
<blockquote> 
 <p>点击"Package"，选择打包文件夹路径 </p> 
</blockquote> 
<p class="img-center"><img alt="" height="381" src="https://images2.imgbox.com/66/9a/TBSWXEOz_o.png" width="550"></p> 
<p></p> 
<blockquote> 
 <p> 等待打包完成</p> 
</blockquote> 
<p class="img-center"><img alt="" height="349" src="https://images2.imgbox.com/70/70/dCJI4zdW_o.png" width="550"></p> 
<p></p> 
<blockquote> 
 <p>打开"for_testing"文件夹，找以函数命名的dll文件，就是最终生成好的dll。</p> 
</blockquote> 
<p class="img-center"><img alt="" height="388" src="https://images2.imgbox.com/c9/b8/WSNVwixT_o.png" width="550"></p> 
<h4> 3.1.2 注册dll</h4> 
<p>管理员权限打开cmd窗口，输入如下</p> 
<blockquote> 
 <p>regsvr32 + dll文件路径</p> 
</blockquote> 
<p>实际如下图所示 </p> 
<p class="img-center"><img alt="" height="354" src="https://images2.imgbox.com/71/a0/hEw57hL2_o.png" width="550"></p> 
<p>输入完成后，回车运行，提示成功就可以了，如下图所示</p> 
<p class="img-center"><img alt="" height="360" src="https://images2.imgbox.com/9b/ae/56eMKO6k_o.png" width="550"></p> 
<h4>3.1.3 程序调用dll  </h4> 
<blockquote> 
 <p> 新建vi，找到自动化打开句柄，添加到程序面板</p> 
</blockquote> 
<p class="img-center"><img alt="" height="292" src="https://images2.imgbox.com/ea/d1/ijiRvQmM_o.png" width="550"></p> 
<blockquote> 
 <p>右键自动化句柄，选择ActiveX类，浏览找到刚才注册的 "sintest"</p> 
</blockquote> 
<p class="img-center"><img alt="" height="242" src="https://images2.imgbox.com/cb/75/7fzp1IXL_o.png" width="300"></p> 
<p class="img-center"><img alt="" height="391" src="https://images2.imgbox.com/2b/d4/fgo6PHD9_o.png" width="500"></p> 
<blockquote> 
 <p>选择之后，如下图勾选，选择Class1，点击OK </p> 
</blockquote> 
<p class="img-center"><img alt="" height="252" src="https://images2.imgbox.com/5e/c5/s0HEIOnO_o.png" width="300"></p> 
<blockquote> 
 <p>右键选择添加调用节点，如下图所示 </p> 
</blockquote> 
<p class="img-center"><img alt="" height="332" src="https://images2.imgbox.com/93/0e/7WnpM2kp_o.png" width="550"></p> 
<p class="img-center"><img alt="" height="211" src="https://images2.imgbox.com/ac/f8/1NFkEkh5_o.png" width="550"></p> 
<blockquote> 
 <p> 选择sintest函数</p> 
</blockquote> 
<p class="img-center"><img alt="" height="271" src="https://images2.imgbox.com/48/2a/De80Gs27_o.png" width="470"></p> 
<blockquote> 
 <p>给参数赋值，并且增加关闭句柄，在句柄关闭前，增加了一个延时，这样是可以在调用脚本运行后观察到matlab生成的figure，验证调用成功的效果，figure不会立刻消失，在延时之后会消失。</p> 
</blockquote> 
<p><img alt="" height="490" src="https://images2.imgbox.com/28/7a/OgIwZRzW_o.png" width="1200"></p> 
<blockquote> 
 <p>点击运行效果如下，可以看到生成了预期的figure图像，并将波形的数据存储到了txt中，说明脚本调用成功了。</p> 
</blockquote> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/f3/5e/nGnyABlv_o.png" width="1200"></p> 
<p>如下是存储的txt中的数据 </p> 
<p class="img-center"><img alt="" height="410" src="https://images2.imgbox.com/90/68/C8rea3b4_o.png" width="550"></p> 
<p></p> 
<h3>3.2 优缺点说明 </h3> 
<blockquote> 
 <p><strong>优点：</strong></p> 
 <ul><li>不用关心matlab语法，直接提供单独的mat文件进行封装即可；</li><li>可以调用包含嵌套函数的脚本，不过目前还没尝试过调用跨脚本文件的函数；</li><li>不用安装matlab完全体，只需要安装运行引擎即可，对电脑配置要求较低；</li></ul> 
</blockquote> 
<blockquote> 
 <p><strong>缺点：</strong></p> 
 <ul><li>调用dll进行句柄初始化时需要花费一定的时间，跟电脑配置和脚本复杂程度有关，不过一般只需要初始化一次即可，后面反复调用都不会再花费时间</li></ul> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/26a980433ce53e6bcaf155172347a0f1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">打包部署若依SpringBoot后端和Vue前端</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0e003851e554b5b6496cbc78ab5b1a4a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">JSqlParser的使用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>