<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>禹神：一小时快速上手Electron，前端Electron开发教程，笔记。一篇文章入门Electron - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/c64bc3fa71015768ea33733614d37008/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="禹神：一小时快速上手Electron，前端Electron开发教程，笔记。一篇文章入门Electron">
  <meta property="og:description" content="一、Electron是什么 简单的一句话，就是用html&#43;css&#43;js&#43;nodejs&#43;（Native Api）做兼容多个系统（Windows、Linux、Mac）的软件。
官网解释如下(有点像绕口令)：
Electron是一个使用 JavaScript、HTML 和 CSS 构建桌面应用程序的框架。 嵌入 Chromium 和 Node.js 到 二进制的 Electron 允许您保持一个 JavaScript 代码代码库并创建 在Windows上运行的跨平台应用 macOS和Linux——不需要本地开发 经验。
二、Elemtron流程模型 三、Electron搭建工程，若成功则输出123 3.1 准备 可参考Electron官网地址
需要node和npm，先检测是否安装。
node -v npm -v 3.2 项目初始化 命令行创建
mkdir my-electron-app &amp;&amp; cd my-electron-app npm init 或者，手动快速创建
package.json文件
{ &#34;name&#34;: &#34;my-electron-app&#34;, &#34;version&#34;: &#34;1.0.0&#34;, &#34;description&#34;: &#34;test Electron&#34;, &#34;main&#34;: &#34;main.js&#34;, &#34;author&#34;: &#34;Bin9153&#34;, &#34;license&#34;: &#34;MIT&#34; } 有几条规则需要遵循：
entry point 应为 main.js.
author 与 description 可为任意值，但对于应用打包是必填项。
3.3 安装 Electron npm install --save-dev electron //或者 npm install electron -D 3.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-16T02:39:58+08:00">
    <meta property="article:modified_time" content="2024-07-16T02:39:58+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">禹神：一小时快速上手Electron，前端Electron开发教程，笔记。一篇文章入门Electron</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Electron_0"></a>一、Electron是什么</h2> 
<p><strong>简单的一句话，就是用html+css+js+nodejs+（Native Api）做兼容多个系统（Windows、Linux、Mac）的软件。</strong></p> 
<p><strong>官网解释如下(有点像绕口令)：</strong><br> Electron是一个使用 JavaScript、HTML 和 CSS 构建桌面应用程序的框架。 嵌入 Chromium 和 Node.js 到 二进制的 Electron 允许您保持一个 JavaScript 代码代码库并创建 在Windows上运行的跨平台应用 macOS和Linux——不需要本地开发 经验。<br> <img src="https://images2.imgbox.com/87/4e/ofgWA4R6_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/8a/e9/b3OIlTcz_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="Elemtron_7"></a>二、Elemtron流程模型</h2> 
<p><img src="https://images2.imgbox.com/b2/f2/8tM7a5qz_o.jpg" alt="Electron流程模型图"></p> 
<h2><a id="Electron123_9"></a>三、Electron搭建工程，若成功则输出123</h2> 
<h3><a id="31__10"></a>3.1 准备</h3> 
<p><a href="https://www.electronjs.org/zh/docs/latest/tutorial/quick-start" rel="nofollow">可参考Electron官网地址</a><br> 需要node和npm，先检测是否安装。</p> 
<pre><code class="prism language-javascript">node <span class="token operator">-</span>v
npm <span class="token operator">-</span>v
</code></pre> 
<p><img src="https://images2.imgbox.com/88/a3/oKTO3zbs_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="32__19"></a>3.2 项目初始化</h3> 
<p>命令行创建</p> 
<pre><code class="prism language-javascript">mkdir my<span class="token operator">-</span>electron<span class="token operator">-</span>app <span class="token operator">&amp;&amp;</span> cd my<span class="token operator">-</span>electron<span class="token operator">-</span>app
npm init
</code></pre> 
<p>或者，手动快速创建<br> <img src="https://images2.imgbox.com/43/eb/qZpON9AV_o.gif" alt="在这里插入图片描述"></p> 
<p>package.json文件</p> 
<pre><code class="prism language-javascript"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"my-electron-app"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"description"</span><span class="token operator">:</span> <span class="token string">"test Electron"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"main"</span><span class="token operator">:</span> <span class="token string">"main.js"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"author"</span><span class="token operator">:</span> <span class="token string">"Bin9153"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"license"</span><span class="token operator">:</span> <span class="token string">"MIT"</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>有几条规则需要遵循：</p> 
<p>entry point 应为 main.js.<br> author 与 description 可为任意值，但对于应用打包是必填项。<br> <img src="https://images2.imgbox.com/96/09/FmO6IwZE_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="33__Electron_44"></a>3.3 安装 Electron</h3> 
<pre><code class="prism language-javascript">npm install <span class="token operator">--</span>save<span class="token operator">-</span>dev electron
<span class="token comment">//或者</span>
npm install electron <span class="token operator">-</span><span class="token constant">D</span>
</code></pre> 
<h3><a id="34__51"></a>3.4 配置并启动</h3> 
<p><strong>在 package.json配置文件中的scripts字段下增加一条start命令：</strong></p> 
<pre><code class="prism language-javascript"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"start"</span><span class="token operator">:</span> <span class="token string">"electron ."</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>这一步，完整的package.json</strong></p> 
<pre><code class="prism language-javascript"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"my-electron-app"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"main"</span><span class="token operator">:</span> <span class="token string">"main.js"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"start"</span><span class="token operator">:</span> <span class="token string">"electron ."</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"author"</span><span class="token operator">:</span> <span class="token string">"bin9153"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"license"</span><span class="token operator">:</span> <span class="token string">"ISC"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"description"</span><span class="token operator">:</span> <span class="token string">"electron test"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"electron"</span><span class="token operator">:</span> <span class="token string">"^31.2.0"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>代码解析：<br> <img src="https://images2.imgbox.com/06/11/OA102jdr_o.png" alt="package代码解析"><br> <strong>创建main.js</strong>。<br> <img src="https://images2.imgbox.com/52/3b/2ET4Lkcu_o.png" alt="在这里插入图片描述"><br> <strong>在main.js里写入</strong></p> 
<pre><code class="prism language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/99/07/HmAx9Ns1_o.png" alt="在这里插入图片描述"></p> 
<p><strong>再运行！</strong></p> 
<pre><code class="prism language-javascript">npm start
</code></pre> 
<p><strong>注意：</strong></p> 
<ol><li>先创建main.js，否则报错</li><li>如果main.js里没写输出（或其他代码）则，启动了运行窗口也不容易看出变化</li></ol> 
<p><img src="https://images2.imgbox.com/5b/05/9R8TzW4Z_o.png" alt="启动输出123"><br> <strong>成功输出123，工程搭建完成。</strong></p> 
<h2><a id="_101"></a>四、开始制作程序</h2> 
<h3><a id="41_1_102"></a>4.1 案例1：做一个简易网页程序</h3> 
<p><a href="https://www.electronjs.org/zh/docs/latest/api/browser-window" rel="nofollow">点击可以查看，browser-window配置项的开发文档</a><br> 在main.js里写入</p> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span>app<span class="token punctuation">,</span> BrowserWindow<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//当app准备好后，执行createWindow创建窗口</span>
    <span class="token keyword">const</span> win <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">800</span><span class="token punctuation">,</span><span class="token comment">//窗口宽度</span>
        <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">600</span><span class="token punctuation">,</span><span class="token comment">//窗口高度</span>
        <span class="token literal-property property">autoHideMenuBar</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//自动隐藏菜单档</span>
        <span class="token literal-property property">alwaysOnTop</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//置顶</span>
        <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token comment">//窗口位置x坐标</span>
        <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">0</span><span class="token comment">//窗口位置y坐标</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">//加载一个远程页面</span>
   win<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token string">'https://blog.csdn.net/qq_33650655/article/details/140353815'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>运行</p> 
<pre><code class="prism language-javascript"> npm start
</code></pre> 
<p><img src="https://images2.imgbox.com/52/e3/5SkoRqoz_o.png" alt="制作一个远程界面"><br> 成功显示页面。<br> <img src="https://images2.imgbox.com/8b/cd/FBtOdlEh_o.png" alt="页面成功运行"></p> 
<h3><a id="42_2_131"></a>4.2 案例2：做一个本地程序（不是远程链接页面，是自己写的页面）</h3> 
<h4><a id="421__132"></a>4.2.1 是本地程序，所以创建新的页面</h4> 
<p>新建pages目录，创建页面，这里就像写前端一样了。index.html,index.css<br> <img src="https://images2.imgbox.com/3a/e1/iTbEC7e5_o.png" alt="在这里插入图片描述"><br> index.html里</p> 
<pre><code class="prism language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
   
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>这里是index页面<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>
    这里是index里的标题
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>main.js里引入页面</p> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span>app<span class="token punctuation">,</span> BrowserWindow<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">//当app准备好后，执行createWindow创建窗口</span>
    <span class="token keyword">const</span> win <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">800</span><span class="token punctuation">,</span><span class="token comment">//窗口宽度</span>
        <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">600</span><span class="token punctuation">,</span><span class="token comment">//窗口高度</span>
        <span class="token literal-property property">autoHideMenuBar</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//自动隐藏菜单档</span>
        <span class="token literal-property property">alwaysOnTop</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//置顶</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">//引入页面</span>
    win<span class="token punctuation">.</span><span class="token function">loadFile</span><span class="token punctuation">(</span><span class="token string">'./pages/index/index.html'</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>运行</p> 
<pre><code class="prism language-javascript">npm start
</code></pre> 
<h4><a id="422__176"></a>4.2.2 解决内容安全策略</h4> 
<p>有安全提示<br> <img src="https://images2.imgbox.com/68/e9/cRrwtmOl_o.png" alt="在这里插入图片描述"><br> 在index.html里加入，如下代码，内容安全策略警告提示消失。</p> 
<pre><code class="prism language-html">//electron 提供的配置 成功运行
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Content-Security-Policy<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>default-src 'self'; script-src 'self'<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
//electron 提供的配置2 引入js后也会报错
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Content-Security-Policy<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>default-src none<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
//视频教程里的配置 会报错
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Content-Security-Policy<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>default-src 'self';style-src 'self''unsafe-inline';img-src self'data:;<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
//我自己写的组合的配置更全 加了一个script的限制,有事儿后期再改， 刚试了会报错，可能哪里没写对，先记录在这里
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Content-Security-Policy<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>default-src 'self'; script-src 'self';style-src 'self''unsafe-inline';img-src self'data:;<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a8/b6/EBEgmReE_o.png" alt="安全策略代码详解"></p> 
<p>关于CSP的详细说明：<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CSP" rel="nofollow">MDN内容安全策略详解</a> 、<a href="https://www.electronjs.org/zh/docs/latest/tutorial/security" rel="nofollow">Electron安全策略规范</a></p> 
<h4><a id="423__195"></a>4.2.3 增加多系统的兼容代码</h4> 
<p>兼容mac(完善窗口行为）<br> electron文档：<br> <a href="https://www.electronjs.org/zh/docs/latest/tutorial/quick-start#%E5%85%B3%E9%97%AD%E6%89%80%E6%9C%89%E7%AA%97%E5%8F%A3%E6%97%B6%E9%80%80%E5%87%BA%E5%BA%94%E7%94%A8-windows--linux" rel="nofollow">关闭所有窗口时退出应用 (Windows &amp; Linux)</a><br> <a href="https://www.electronjs.org/zh/docs/latest/tutorial/quick-start#%E5%A6%82%E6%9E%9C%E6%B2%A1%E6%9C%89%E7%AA%97%E5%8F%A3%E6%89%93%E5%BC%80%E5%88%99%E6%89%93%E5%BC%80%E4%B8%80%E4%B8%AA%E7%AA%97%E5%8F%A3-macos" rel="nofollow">如果没有窗口打开则打开一个窗口 (macOS)</a><br> 在main.js里写入兼容各个系统平台的代码</p> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span>app<span class="token punctuation">,</span> BrowserWindow<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">//当app准备好后，执行createWindow创建窗口</span>
    <span class="token keyword">const</span> win <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">800</span><span class="token punctuation">,</span><span class="token comment">//窗口宽度</span>
        <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">600</span><span class="token punctuation">,</span><span class="token comment">//窗口高度</span>
        <span class="token literal-property property">autoHideMenuBar</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//自动隐藏菜单档</span>
        <span class="token literal-property property">alwaysOnTop</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//置顶</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    win<span class="token punctuation">.</span><span class="token function">loadFile</span><span class="token punctuation">(</span><span class="token string">'./pages/index/index.html'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">//兼容核心代码 1</span>
    app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'activate'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>BrowserWindow<span class="token punctuation">.</span><span class="token function">getAllWindows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//兼容核心代码 2</span>
app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'window-all-closed'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>platform <span class="token operator">!==</span> <span class="token string">'darwin'</span><span class="token punctuation">)</span> app<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>代码解析<br> <img src="https://images2.imgbox.com/fa/4a/yyahv1kO_o.png" alt="在这里插入图片描述"></p> 
<p>下面两句代码相等</p> 
<pre><code class="prism language-javascript">app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
   <span class="token comment">// 写核心代码</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 或者</span>
app<span class="token punctuation">.</span><span class="token function">whenReady</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">//写核心代码</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="424__245"></a>4.2.4 配置自动重启,保存后自动热更新</h4> 
<pre><code class="prism language-javascript">npm i nodemon <span class="token operator">-</span><span class="token constant">D</span>
</code></pre> 
<p>package.json里重写start</p> 
<pre><code class="prism language-javascript"> <span class="token string-property property">"start"</span><span class="token operator">:</span> <span class="token string">"nodemon --exec electron ."</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/05/4a/4V6RjDAz_o.png" alt="重写start"></p> 
<p>这样保存main.js里的内容，就自动热更新了。<br> 但是更新index.html里的代码不能热更新，要加一个nodemon.json，需要手动添加</p> 
<pre><code class="prism language-javascript"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"ignore"</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token string">"node modules"</span><span class="token punctuation">,</span>
    <span class="token string">"dist"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">"restartable"</span><span class="token operator">:</span><span class="token string">"r"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"watch"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"*.*"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">"ext"</span><span class="token operator">:</span><span class="token string">"html,js,css"</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>增加nodemon.json,<br> <img src="https://images2.imgbox.com/a7/60/EYKIWc3D_o.png" alt="增加nodemon文件和内容"><br> 重启生效</p> 
<pre><code class="prism language-javascript">npm start
</code></pre> 
<h4><a id="425_hellotext_279"></a>4.2.5 编写页面程序(写一个应用程序，可以写入任意文字到hello.text里)</h4> 
<p>页面程序要写在页面里，那它和主进程的关系如图<br> <img src="https://images2.imgbox.com/1d/80/uY3qgGEy_o.jpg" alt="Electron流程模型图"><br> <strong>每个页面程序通过渲染和主进程通信，主进程根据需求调用Native Api来实现功能。</strong></p> 
<p><strong>实际，每个页面和主程序通信时，需要建个桥梁来管理它们的通信，preload.js(自己创建)，来管理实现通信</strong>。<br> <img src="https://images2.imgbox.com/d5/0f/BQU9wIhd_o.png" alt="在这里插入图片描述"><br> <strong>创建preload.js定义桥梁js</strong><br> <img src="https://images2.imgbox.com/ed/90/3QUdDJCl_o.png" alt="创建preloadjs"><br> 在main.js中定义preload.js为桥梁<br> <img src="https://images2.imgbox.com/e9/81/7LYt9Irg_o.png" alt="在main.js里定义桥梁"></p> 
<p>main.js代码：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span>app<span class="token punctuation">,</span> BrowserWindow<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">//当app准备好后，执行createWindow创建窗口</span>
    <span class="token keyword">const</span> win <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">800</span><span class="token punctuation">,</span><span class="token comment">//窗口宽度</span>
        <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">600</span><span class="token punctuation">,</span><span class="token comment">//窗口高度</span>
        <span class="token literal-property property">autoHideMenuBar</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//自动隐藏菜单档</span>
        <span class="token literal-property property">alwaysOnTop</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//置顶</span>
        <span class="token literal-property property">webPreferences</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>  <span class="token comment">//在main.js中定义preload.js为桥梁</span>
            <span class="token literal-property property">preload</span><span class="token operator">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'./preload.js'</span><span class="token punctuation">)</span>

        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">//引入页面</span>
    win<span class="token punctuation">.</span><span class="token function">loadFile</span><span class="token punctuation">(</span><span class="token string">'./pages/index/index.html'</span><span class="token punctuation">)</span>
    win<span class="token punctuation">.</span><span class="token function">openDevTools</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//自动打开调试窗口</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"main.js里的main.js"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">//兼容核心代码1</span>
    app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'activate'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>BrowserWindow<span class="token punctuation">.</span><span class="token function">getAllWindows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>创建渲染js</strong><br> <img src="https://images2.imgbox.com/25/db/P7eB5NEh_o.png" alt="在这里插入图片描述"><br> 定义渲染js<br> <img src="https://images2.imgbox.com/de/55/lsQiAqJ3_o.png" alt="定义渲染js"><br> 这是自己整理的，整理了前面45分钟，再这么整理下去，1000字也不够用。<br> 下面写代码不详细介绍了。会点前端的能懂一半多代码。<br> 可以看原来的教程 从45分钟开始看。<a href="https://www.bilibili.com/video/BV1sE421N7M5/?spm_id_from=333.880.my_history.page.click&amp;vd_source=a454397b4591f4f1fe0cf403e74737a0" rel="nofollow">视频教程</a><br> 直接上代码。</p> 
<blockquote> 
 <p>main.js里的代码</p> 
</blockquote> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span>app<span class="token punctuation">,</span> BrowserWindow<span class="token punctuation">,</span>ipcMain<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>

<span class="token comment">//写入文件</span>
<span class="token keyword">function</span> <span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span><span class="token string">'D:/hello.txt'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//读取文件</span>
<span class="token keyword">function</span> <span class="token function">readFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">"D:/hello.txt"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> res
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//当app准备好后，执行createWindow创建窗口</span>
    <span class="token keyword">const</span> win <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">800</span><span class="token punctuation">,</span><span class="token comment">//窗口宽度</span>
        <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">600</span><span class="token punctuation">,</span><span class="token comment">//窗口高度</span>
        <span class="token literal-property property">autoHideMenuBar</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//自动隐藏菜单档</span>
        <span class="token literal-property property">alwaysOnTop</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//置顶</span>
        <span class="token literal-property property">webPreferences</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>  <span class="token comment">//在main.js中定义preload.js为桥梁</span>
            <span class="token literal-property property">preload</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./preload.js'</span><span class="token punctuation">)</span>

        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    ipcMain<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'file-save'</span><span class="token punctuation">,</span> writeFile<span class="token punctuation">)</span>
    ipcMain<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span><span class="token string">'file-read'</span><span class="token punctuation">,</span> readFile<span class="token punctuation">)</span>
    <span class="token comment">//引入页面</span>
    win<span class="token punctuation">.</span><span class="token function">loadFile</span><span class="token punctuation">(</span><span class="token string">'./pages/index/index.html'</span><span class="token punctuation">)</span>
    win<span class="token punctuation">.</span><span class="token function">openDevTools</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//自动打开调试窗口</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"main.js里的main.js"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">//兼容核心代码1</span>
    app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'activate'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>BrowserWindow<span class="token punctuation">.</span><span class="token function">getAllWindows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<blockquote> 
 <p>preload.js里的代码</p> 
</blockquote> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span>contextBridge<span class="token punctuation">,</span> ipcRenderer<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span>
contextBridge<span class="token punctuation">.</span><span class="token function">exposeInMainWorld</span><span class="token punctuation">(</span><span class="token string">'myAPI'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">version</span><span class="token operator">:</span> process<span class="token punctuation">.</span>version<span class="token punctuation">,</span>
    <span class="token function-variable function">saveFile</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        ipcRenderer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'file-save'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">readFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> ipcRenderer<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">'file-read'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<blockquote> 
 <p>render.js里的代码</p> 
</blockquote> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> btn1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"btn1"</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> btn2 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"btn2"</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> btn3 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"btn3"</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> input <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"inp"</span><span class="token punctuation">)</span>
btn1<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">alert</span><span class="token punctuation">(</span>myAPI<span class="token punctuation">.</span>version<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
btn2<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    myAPI<span class="token punctuation">.</span><span class="token function">saveFile</span><span class="token punctuation">(</span>input<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
btn3<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> myAPI<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p>html里的代码</p> 
</blockquote> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta http<span class="token operator">-</span>equiv<span class="token operator">=</span><span class="token string">"Content-Security-Policy"</span> content<span class="token operator">=</span><span class="token string">"default-src 'self'; script-src 'self'"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>这里是index页面<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>欢迎学习Electron开发！！！<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">"btn1"</span><span class="token operator">&gt;</span>点我<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>hr<span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> id<span class="token operator">=</span><span class="token string">"inp"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">"btn2"</span><span class="token operator">&gt;</span>向<span class="token constant">D</span>盘写入hello<span class="token punctuation">.</span>txt<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>hr<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">"btn3"</span><span class="token operator">&gt;</span>读取hello<span class="token punctuation">.</span>txt的内容<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span> src<span class="token operator">=</span><span class="token string">"./render.js"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
</code></pre> 
<blockquote> 
 <p>目录结构</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/62/aa/b7Xq3qo1_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>备注</strong>：<br> 1.代码稍微有点不一样<br> 2.目录结构也有变化，功能是一样的</p> 
</blockquote> 
<h2><a id="_443"></a>五、打包</h2> 
<h3><a id="51_electronbuildergithub_444"></a>5.1 使用electron-builder打包，打包时要访问<code>github</code>需要<code>修仙术</code></h3> 
<p>1.安装electron-builder:</p> 
<pre><code class="prism language-javascript">npm install electron<span class="token operator">-</span>builder <span class="token operator">-</span><span class="token constant">D</span>
</code></pre> 
<p>2.在package.json中进行相关配置，具体配置如下：</p> 
<blockquote> 
 <p>备注：json文件不支持注释，使用时请去掉所有注释。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/08/30/WG5osvLq_o.jpg" alt="打包配置图"></p> 
<blockquote> 
 <p>package.json里的代码</p> 
</blockquote> 
<pre><code class="prism language-javascript"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"video-tools"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"main"</span><span class="token operator">:</span> <span class="token string">"main.js"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"start"</span><span class="token operator">:</span> <span class="token string">"electron ."</span><span class="token punctuation">,</span>
    <span class="token string-property property">"build"</span><span class="token operator">:</span> <span class="token string">"electron-builder"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"build"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"appId"</span><span class="token operator">:</span> <span class="token string">"com.atguigu.video"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"win"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">"icon"</span><span class="token operator">:</span> <span class="token string">"./logo.ico"</span><span class="token punctuation">,</span>
      <span class="token string-property property">"target"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
          <span class="token string-property property">"target"</span><span class="token operator">:</span> <span class="token string">"nsis"</span><span class="token punctuation">,</span>
          <span class="token string-property property">"arch"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"x64"</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">"nsis"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">"oneClick"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token string-property property">"perMachine"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token string-property property">"allowToChangeInstallationDirectory"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"devDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"electron"</span><span class="token operator">:</span> <span class="token string">"^30.0.0"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"electron-builder"</span><span class="token operator">:</span> <span class="token string">"^24.13.3"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"author"</span><span class="token operator">:</span> <span class="token string">"宝码香车"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"license"</span><span class="token operator">:</span> <span class="token string">"ISC"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"description"</span><span class="token operator">:</span> <span class="token string">"A video processing program based on Electron"</span>
<span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p>根据视频操作未能完成打包，这种方式在打包时 访问<code>github</code> 多次尝试后，决定放弃</p> 
</blockquote> 
<h3><a id="52_Electron_Forge_493"></a>5.2 使用Electron Forge进行打包（使用这种方式打包的）</h3> 
<p>Electron中文网也推荐使用这种方式。<br> Electron Forge是从建项目开始配置 的，因为项目已经写完了，所以从第五步开始。<br> <a href="https://www.electronjs.org/zh/docs/latest/tutorial/%E6%89%93%E5%8C%85%E6%95%99%E7%A8%8B" rel="nofollow">Electron Forge 从第五步开始的文档</a></p> 
<h4><a id="521__3_497"></a>5.2.1 使用3条命令，完成打包。</h4> 
<p>1、运行第1条命令</p> 
<pre><code class="prism language-javascript">npm install <span class="token operator">--</span>save<span class="token operator">-</span>dev @electron<span class="token operator">-</span>forge<span class="token operator">/</span>cli
</code></pre> 
<p>2、运行第2条命令</p> 
<pre><code class="prism language-javascript">npx electron<span class="token operator">-</span>forge <span class="token keyword">import</span>
</code></pre> 
<p>这时在packgae.json里会增加一些配置。</p> 
<p><img src="https://images2.imgbox.com/47/a7/MZQUeGQD_o.png" alt="在package里增加配置"><br> 不用管。</p> 
<p>3、直接运行第3条命令</p> 
<pre><code class="prism language-javascript">npm run make
</code></pre> 
<blockquote> 
 <p>打包完成。</p> 
</blockquote> 
<h4><a id="522_out_519"></a>5.2.2 打包后的位置,在根项目下的out文件里</h4> 
<p>打包后的文件,在根项目下的out文件夹里</p> 
<p><img src="https://images2.imgbox.com/85/53/b1f4G8OR_o.png" alt="打包后的文件"></p> 
<blockquote> 
 <p>可运行程序在 <code>my-electron-app\out\make\squirrel.windows\x64</code></p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/71/33/fBMQYA3x_o.png" alt="可运行程序"></p> 
<h4><a id="523__529"></a>5.2.3 看运行效果，终于完成了。</h4> 
<p><img src="https://images2.imgbox.com/ae/13/8dAmJbSI_o.gif" alt="完成运行效果"></p> 
<h4><a id="524_bug_532"></a>5.2.4 出现的bug</h4> 
<p>1.安装一次后再打开会报错，<br> <img src="https://images2.imgbox.com/54/5d/eXDrPqx0_o.png" alt="再次安装报错"></p> 
<p>2.直接删除软件，目录在 <code>C:\Users\Administrator\AppData\Roaming</code> 删除my_electron_app这个文件夹。然后用360安全卫士清理垃圾。然后重启即可。</p> 
<blockquote> 
 <p>其他bug<br> 1.软件有卡死的现象<br> 2.还会自动重启<br> 3.软件关闭后会自动重启<br> 4.在输入框中输入内容，写入后可能会卡死，第二次可能无法输入，但可以读取。<br> 5.启动时有点卡</p> 
</blockquote> 
<h2><a id="_547"></a>六、总结</h2> 
<p>1.后面有的bug可能与Electron Forge配置有关。有时间试试，找个解决方案。<br> 2.也有可能与main.js写法有关。<br> 3.打包时删除main.js里的 <code>win.openDevTools() //自动打开调试窗口</code> 否则软件会自动打开调试窗口。<br> 4. 代码仓库位置 <code>https://gitee.com/electron_9/my-electron-app</code></p> 
<blockquote> 
 <p>终于完成，虽然有bug,但能运行起来了。后续找个更好的解决方案。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/5b/da/kcvzq6qd_o.gif" alt="整理不易点赞关注支持宝码香车"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/eae6002ee9605af7dbb5ad64d87341bf/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">在Ubuntu 18.04上安装和保护phpMyAdmin的方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8841edf05a7a90af37c4bd76ad23684b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">基于香橙派 AIpro搭建二维码分类模型及其Flask服务—探索OPi AIpro新一代AI开发板出色性能</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>