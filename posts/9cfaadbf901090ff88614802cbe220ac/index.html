<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>实用机器学习（快速入门） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/9cfaadbf901090ff88614802cbe220ac/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="实用机器学习（快速入门）">
  <meta property="og:description" content="前言 因为需要机器学习的助力，所以（浅浅）进修了一下。现在什么东西和AI结合一下感觉就好发文章了；我看了好多学习视频，发现机器学习实际上是数学，并不是常规的去学习代码什么的（虽然代码也很简单），而是去学习原理。这其实并不合我的学习方法，所以我歪门邪道了一下，先实用，再搞原理（这样就比原先快了许多）
这里我比较推荐的唯一的一本书籍是统计学习方法（因为这本书我大概可以看懂，其他方面的书籍都不太适合纯新手）
线性模型（感知机） 直接上代码，通过代码来上手机器学习
import time import numpy as np import matplotlib.pyplot as plt from sklearn.model_selection import train_test_split from sklearn.linear_model import LinearRegression from sklearn.metrics import mean_squared_error # 使用numpy库，随机创建一个数据集 np.random.seed(int(time.time())) x = 2 * np.random.rand(100, 1) y = 4 &#43; 3 * x &#43; np.random.rand(100, 1) # 将数据集进行划分，分为训练集、测试集 X_train, X_test, y_train, y_test = train_test_split(x, y, test_size=0.2,random_state=42) # 创建线性模型，并开始拟合数据（即训练） lin_reg = LinearRegression() lin_reg.fit(X_train, y_train) print(&#34;lin_reg.coef_ &#34;,lin_reg.coef_) # 决策函数的系数 print(&#34;lin_reg.intercept_ &#34;, lin_reg.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-13T13:00:18+08:00">
    <meta property="article:modified_time" content="2024-07-13T13:00:18+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">实用机器学习（快速入门）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="_0"></a>前言</h4> 
<p>因为需要机器学习的助力，所以（浅浅）进修了一下。现在什么东西和AI结合一下感觉就好发文章了；我看了好多学习视频，发现机器学习实际上是数学，并不是常规的去学习代码什么的（虽然代码也很简单），而是去学习原理。这其实并不合我的学习方法，所以我<em><strong>歪门邪道</strong></em>了一下，先实用，再搞原理（这样就比原先快了许多）</p> 
<p>这里我比较推荐的唯一的一本书籍是统计学习方法（因为这本书我大概可以看懂，其他方面的书籍都不太适合纯新手）</p> 
<hr> 
<h4><a id="_8"></a>线性模型（感知机）</h4> 
<p>直接上代码，通过代码来上手<mark>机器学习</mark></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> time
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LinearRegression
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> mean_squared_error

<span class="token comment"># 使用numpy库，随机创建一个数据集</span>
np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
x <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> x <span class="token operator">+</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># 将数据集进行划分，分为训练集、测试集</span>
X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>
<span class="token comment"># 创建线性模型，并开始拟合数据（即训练）</span>
lin_reg <span class="token operator">=</span> LinearRegression<span class="token punctuation">(</span><span class="token punctuation">)</span>
lin_reg<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"lin_reg.coef_ "</span><span class="token punctuation">,</span>lin_reg<span class="token punctuation">.</span>coef_<span class="token punctuation">)</span> <span class="token comment"># 决策函数的系数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"lin_reg.intercept_ "</span><span class="token punctuation">,</span> lin_reg<span class="token punctuation">.</span>intercept_<span class="token punctuation">)</span> <span class="token comment"># 决策函数的截距</span>
<span class="token comment"># 开始使用训练好的模型进行预测</span>
y_pred <span class="token operator">=</span> lin_reg<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>

mse <span class="token operator">=</span> mean_squared_error<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span> <span class="token comment"># 均方误差回归损失</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Mean Squared Error: "</span><span class="token punctuation">,</span> mse<span class="token punctuation">)</span>

<span class="token comment"># 可视化</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> lin_reg<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Linear Regression"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"x"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"y"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>最终展现的如下所示，散点就是实际点。而红线就是我们训练好的模型所拟合好的线，所有的数据都可以在这个线性模型当中进行预测</p> 
<p><img src="https://images2.imgbox.com/94/e2/J3aLDvEP_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h4><a id="_52"></a>决策树</h4> 
<p>决策树其实很好理解，其实就是数据结构当中的普普通通的一棵树，通过判断分支条件最终到达叶子节点来预测结果</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> tree
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_iris
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> DecisionTreeClassifier<span class="token punctuation">,</span> export_text


<span class="token comment"># 加载并返回鸢尾花数据集（分类）</span>
iris <span class="token operator">=</span> load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 创建一个表（类似excel），列属性标注为鸢尾花的特征名称</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>iris<span class="token punctuation">.</span>data<span class="token punctuation">,</span> columns<span class="token operator">=</span>iris<span class="token punctuation">.</span>feature_names<span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span> <span class="token operator">=</span> iris<span class="token punctuation">.</span>target <span class="token comment"># 添加一列为真实值</span>

target <span class="token operator">=</span> np<span class="token punctuation">.</span>unique<span class="token punctuation">(</span>iris<span class="token punctuation">.</span>target<span class="token punctuation">)</span>
target_names <span class="token operator">=</span> np<span class="token punctuation">.</span>unique<span class="token punctuation">(</span>iris<span class="token punctuation">.</span>target_names<span class="token punctuation">)</span>
target_names_dict <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> target_names<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 迭代生成字典</span>
df<span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span>target_names_dict<span class="token punctuation">)</span> <span class="token comment"># 将表中target列数据替换为文字</span>

x <span class="token operator">=</span> df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token string">'target'</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span>
feature_names <span class="token operator">=</span> x<span class="token punctuation">.</span>columns
labels <span class="token operator">=</span> y<span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 划分训练集、测试集</span>
X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.4</span><span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>
<span class="token comment"># 决策树最大深度为3</span>
model <span class="token operator">=</span> DecisionTreeClassifier<span class="token punctuation">(</span>max_depth<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span> <span class="token comment"># 初始化模型</span>
model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span> <span class="token comment"># 训练模型</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 评估模型</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span>feature_importances_<span class="token punctuation">)</span> <span class="token comment"># 每个特征的权值</span>

r <span class="token operator">=</span> export_text<span class="token punctuation">(</span>model<span class="token punctuation">,</span> feature_names<span class="token operator">=</span>iris<span class="token punctuation">.</span>feature_names<span class="token punctuation">)</span> <span class="token comment"># 建立一个文本报告，显示决策树的规则</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token comment"># 打印文本报告</span>

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">,</span> facecolor<span class="token operator">=</span><span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token comment"># 创建画布</span>
tree<span class="token punctuation">.</span>plot_tree<span class="token punctuation">(</span>model<span class="token punctuation">,</span> feature_names<span class="token operator">=</span>feature_names<span class="token punctuation">,</span> class_names<span class="token operator">=</span>labels<span class="token punctuation">,</span>
               rounded<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> filled<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>如图所示，这就是我们所训练的决策树模型</p> 
<p><img src="https://images2.imgbox.com/c4/b6/n7VPOWMU_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h4><a id="_105"></a>神经网络</h4> 
<p>这里便不同前两个模型，该模型更为复杂了<br> 神经网络是一种模仿生物神经网络结构和功能的计算模型，由大量的人工神经元相互连接而成，具有学习、识别和决策的能力。而我们常常听到的深度学习就是更为复杂的神经网络。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn <span class="token keyword">import</span> datasets
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>neural_network <span class="token keyword">import</span> MLPClassifier

<span class="token comment"># 加载数据集</span>
iris <span class="token operator">=</span> datasets<span class="token punctuation">.</span>load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span>
x <span class="token operator">=</span> iris<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>
y <span class="token operator">=</span> iris<span class="token punctuation">.</span>target
data <span class="token operator">=</span> np<span class="token punctuation">.</span>hstack<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>y<span class="token punctuation">.</span>size<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 进行水平堆叠</span>
<span class="token comment"># 划分训练集、测试集</span>
x_train<span class="token punctuation">,</span>x_test<span class="token punctuation">,</span>y_train<span class="token punctuation">,</span>y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>test_size<span class="token operator">=</span><span class="token number">0.4</span><span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>

<span class="token comment"># 绘制样本点</span>
<span class="token keyword">def</span> <span class="token function">plot_samples</span><span class="token punctuation">(</span>ax<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    n_classes <span class="token operator">=</span> <span class="token number">3</span>
    plot_colors <span class="token operator">=</span> <span class="token string">"bry"</span>
    <span class="token keyword">for</span> i<span class="token punctuation">,</span> color <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>n_classes<span class="token punctuation">)</span><span class="token punctuation">,</span> plot_colors<span class="token punctuation">)</span><span class="token punctuation">:</span>
        idx <span class="token operator">=</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>y <span class="token operator">==</span> i<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">[</span>idx<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span>idx<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span>color<span class="token punctuation">,</span> label<span class="token operator">=</span>iris<span class="token punctuation">.</span>target_names<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 绘制等高线</span>
<span class="token keyword">def</span> <span class="token function">plot_classifier_predict_meshgrid</span><span class="token punctuation">(</span>ax<span class="token punctuation">,</span>clf<span class="token punctuation">,</span>x_min<span class="token punctuation">,</span>x_max<span class="token punctuation">,</span>y_min<span class="token punctuation">,</span>y_max<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plot_step <span class="token operator">=</span> <span class="token number">0.02</span>
    xx<span class="token punctuation">,</span> yy <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>x_min<span class="token punctuation">,</span> x_max<span class="token punctuation">,</span> plot_step<span class="token punctuation">)</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>y_min<span class="token punctuation">,</span> y_max<span class="token punctuation">,</span> plot_step<span class="token punctuation">)</span><span class="token punctuation">)</span>
    z <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>np<span class="token punctuation">.</span>c_<span class="token punctuation">[</span>xx<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> yy<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    z <span class="token operator">=</span> z<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>xx<span class="token punctuation">.</span>shape<span class="token punctuation">)</span> <span class="token comment"># 改变z的维度</span>
    ax<span class="token punctuation">.</span>contourf<span class="token punctuation">(</span>xx<span class="token punctuation">,</span> yy<span class="token punctuation">,</span> z<span class="token punctuation">)</span> <span class="token comment"># 绘制等高线</span>


<span class="token comment"># 多层感知器分类器</span>
classifier <span class="token operator">=</span> MLPClassifier<span class="token punctuation">(</span>activation<span class="token operator">=</span><span class="token string">'logistic'</span><span class="token punctuation">,</span> max_iter<span class="token operator">=</span><span class="token number">10000</span><span class="token punctuation">,</span> hidden_layer_sizes<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
classifier<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span> <span class="token comment"># 训练</span>
train_score <span class="token operator">=</span> classifier<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span> <span class="token comment"># 训练集评估分数</span>
test_score <span class="token operator">=</span> classifier<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span> <span class="token comment"># 测试集评估分数</span>

fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
x_min<span class="token punctuation">,</span> x_max <span class="token operator">=</span> x_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> x_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span>
y_min<span class="token punctuation">,</span> y_max <span class="token operator">=</span> x_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> x_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span>
plot_classifier_predict_meshgrid<span class="token punctuation">(</span>ax<span class="token punctuation">,</span>classifier<span class="token punctuation">,</span>x_min<span class="token punctuation">,</span> x_max<span class="token punctuation">,</span>y_min<span class="token punctuation">,</span>y_max<span class="token punctuation">)</span> <span class="token comment"># 绘图（预测的等高线）</span>
plot_samples<span class="token punctuation">(</span>ax<span class="token punctuation">,</span>x_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span> <span class="token comment"># 绘图（散点）</span>

ax<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'best'</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span>iris<span class="token punctuation">.</span>feature_names<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span>iris<span class="token punctuation">.</span>feature_names<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"train score:%f;test score:%f"</span><span class="token operator">%</span><span class="token punctuation">(</span>train_score<span class="token punctuation">,</span>test_score<span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a2/e5/Kz1uaXaD_o.png" alt="在这里插入图片描述"></p> 
<p>我们经常能听到的所谓调参、炼丹等等，在这里其实便可以有很好的体现，接下来我们简单的调一下参数，来查看不同参数对于准确率的影响有多大？</p> 
<hr> 
<p>接下来我们首先调整的参数是隐藏层的层数及神经元数这个参数（该参数在神经网络模型当中可谓之最重要的参数之一了）</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">for_hidden_layer_size</span><span class="token punctuation">(</span>fig<span class="token punctuation">,</span> itx<span class="token punctuation">,</span> hidden_layer_sizes<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 多层感知器分类器</span>
    classifier <span class="token operator">=</span> MLPClassifier<span class="token punctuation">(</span>activation<span class="token operator">=</span><span class="token string">'logistic'</span><span class="token punctuation">,</span> max_iter<span class="token operator">=</span><span class="token number">10000</span><span class="token punctuation">,</span> hidden_layer_sizes<span class="token operator">=</span>hidden_layer_sizes<span class="token punctuation">)</span>
    classifier<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>  <span class="token comment"># 训练</span>
    train_score <span class="token operator">=</span> classifier<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>  <span class="token comment"># 训练集评估分数</span>
    test_score <span class="token operator">=</span> classifier<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span>  <span class="token comment"># 测试集评估分数</span>
    <span class="token comment"># 开始绘图</span>
    ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> itx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
    x_min<span class="token punctuation">,</span> x_max <span class="token operator">=</span> x_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> x_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span>
    y_min<span class="token punctuation">,</span> y_max <span class="token operator">=</span> x_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> x_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span>
    plot_classifier_predict_meshgrid<span class="token punctuation">(</span>ax<span class="token punctuation">,</span> classifier<span class="token punctuation">,</span> x_min<span class="token punctuation">,</span> x_max<span class="token punctuation">,</span> y_min<span class="token punctuation">,</span> y_max<span class="token punctuation">)</span>  <span class="token comment"># 绘图（预测的等高线）</span>
    plot_samples<span class="token punctuation">(</span>ax<span class="token punctuation">,</span> x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>  <span class="token comment"># 绘图（散点）</span>
    ax<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'best'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token string">'xx-small'</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span>iris<span class="token punctuation">.</span>feature_names<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span>iris<span class="token punctuation">.</span>feature_names<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"layer_size:%s"</span> <span class="token operator">%</span> <span class="token builtin">str</span><span class="token punctuation">(</span>hidden_layer_sizes<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"layer_size:%s; train score:%.2f; test score:%.2f"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>hidden_layer_sizes<span class="token punctuation">,</span> train_score<span class="token punctuation">,</span> test_score<span class="token punctuation">)</span><span class="token punctuation">)</span>

fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
hidden_layer_sizes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> itx<span class="token punctuation">,</span> size <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>hidden_layer_sizes<span class="token punctuation">)</span><span class="token punctuation">:</span>
    for_hidden_layer_size<span class="token punctuation">(</span>fig<span class="token punctuation">,</span>itx<span class="token punctuation">,</span>size<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/37/ff/rKsPfxgu_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<p>这里我们调整<mark>激活函数</mark>这个参数，所谓的激活函数就是神经元与神经元之间传递消息的函数。换句话说，A传递给B，那么A是是依靠一个函数来判断传递给B的数据是什么，这个函数就是激活函数。</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">for_activation</span><span class="token punctuation">(</span>fig<span class="token punctuation">,</span> itx<span class="token punctuation">,</span> activation<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 多层感知器分类器</span>
    classifier <span class="token operator">=</span> MLPClassifier<span class="token punctuation">(</span>activation<span class="token operator">=</span>activation<span class="token punctuation">,</span> max_iter<span class="token operator">=</span><span class="token number">10000</span><span class="token punctuation">,</span> hidden_layer_sizes<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    classifier<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>  <span class="token comment"># 训练</span>
    train_score <span class="token operator">=</span> classifier<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>  <span class="token comment"># 训练集评估分数</span>
    test_score <span class="token operator">=</span> classifier<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span>  <span class="token comment"># 测试集评估分数</span>
    <span class="token comment"># 开始绘图</span>
    ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> itx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
    x_min<span class="token punctuation">,</span> x_max <span class="token operator">=</span> x_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> x_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span>
    y_min<span class="token punctuation">,</span> y_max <span class="token operator">=</span> x_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> x_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span>
    plot_classifier_predict_meshgrid<span class="token punctuation">(</span>ax<span class="token punctuation">,</span> classifier<span class="token punctuation">,</span> x_min<span class="token punctuation">,</span> x_max<span class="token punctuation">,</span> y_min<span class="token punctuation">,</span> y_max<span class="token punctuation">)</span>  <span class="token comment"># 绘图（预测的等高线）</span>
    plot_samples<span class="token punctuation">(</span>ax<span class="token punctuation">,</span> x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>  <span class="token comment"># 绘图（散点）</span>
    ax<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'best'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token string">'xx-small'</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span>iris<span class="token punctuation">.</span>feature_names<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span>iris<span class="token punctuation">.</span>feature_names<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"activation:%s"</span> <span class="token operator">%</span> <span class="token builtin">str</span><span class="token punctuation">(</span>activation<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"activation:%s; train score:%.2f; test score:%.2f"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>activation<span class="token punctuation">,</span> train_score<span class="token punctuation">,</span> test_score<span class="token punctuation">)</span><span class="token punctuation">)</span>

fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
ativations <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"logistic"</span><span class="token punctuation">,</span><span class="token string">"tanh"</span><span class="token punctuation">,</span><span class="token string">"relu"</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> itx<span class="token punctuation">,</span> acti <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>ativations<span class="token punctuation">)</span><span class="token punctuation">:</span>
    for_activation<span class="token punctuation">(</span>fig<span class="token punctuation">,</span> itx<span class="token punctuation">,</span> acti<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b4/b4/XWMrTPpM_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<p>而接下来这个参数，同意重要。solver参数主要是对神经元之间的权重分配的优化算法。也就是A到B之间所占整个体系（层级）的比例是多少</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">for_solvers</span><span class="token punctuation">(</span>fig<span class="token punctuation">,</span> itx<span class="token punctuation">,</span> solver<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 多层感知器分类器</span>
    classifier <span class="token operator">=</span> MLPClassifier<span class="token punctuation">(</span>activation<span class="token operator">=</span><span class="token string">'logistic'</span><span class="token punctuation">,</span> solver<span class="token operator">=</span>solver<span class="token punctuation">,</span> max_iter<span class="token operator">=</span><span class="token number">20000</span><span class="token punctuation">,</span> hidden_layer_sizes<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    classifier<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>  <span class="token comment"># 训练</span>
    train_score <span class="token operator">=</span> classifier<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>  <span class="token comment"># 训练集评估分数</span>
    test_score <span class="token operator">=</span> classifier<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span>  <span class="token comment"># 测试集评估分数</span>
    <span class="token comment"># 开始绘图</span>
    ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> itx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
    x_min<span class="token punctuation">,</span> x_max <span class="token operator">=</span> x_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> x_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span>
    y_min<span class="token punctuation">,</span> y_max <span class="token operator">=</span> x_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> x_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span>
    plot_classifier_predict_meshgrid<span class="token punctuation">(</span>ax<span class="token punctuation">,</span> classifier<span class="token punctuation">,</span> x_min<span class="token punctuation">,</span> x_max<span class="token punctuation">,</span> y_min<span class="token punctuation">,</span> y_max<span class="token punctuation">)</span>  <span class="token comment"># 绘图（预测的等高线）</span>
    plot_samples<span class="token punctuation">(</span>ax<span class="token punctuation">,</span> x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>  <span class="token comment"># 绘图（散点）</span>
    ax<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'best'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token string">'xx-small'</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span>iris<span class="token punctuation">.</span>feature_names<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span>iris<span class="token punctuation">.</span>feature_names<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"solver:%s"</span> <span class="token operator">%</span> <span class="token builtin">str</span><span class="token punctuation">(</span>solver<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"solver:%s; train score:%.2f; test score:%.2f"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>solver<span class="token punctuation">,</span> train_score<span class="token punctuation">,</span> test_score<span class="token punctuation">)</span><span class="token punctuation">)</span>

fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>set_size_inches<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token comment"># 设置图形大小</span>
solvers<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"lbfgs"</span><span class="token punctuation">,</span><span class="token string">"sgd"</span><span class="token punctuation">,</span><span class="token string">"adam"</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> itx<span class="token punctuation">,</span> sol <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>solvers<span class="token punctuation">)</span><span class="token punctuation">:</span>
    for_solvers<span class="token punctuation">(</span>fig<span class="token punctuation">,</span> itx<span class="token punctuation">,</span> sol<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a4/a3/vAYrbnMW_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h4><a id="_267"></a>支持向量机</h4> 
<p>支持向量机（Support Vector Machine，简称SVM）是一种基于统计学习理论的有监督学习模型，通过寻找特征空间上的最优超平面对样本进行分类或回归。</p> 
<p>通俗来说，上面已经学习过了<mark>线性模型</mark>，线性模型有一个特点就是超平面是直的，无法弯曲。而支持向量机模型的超平面是可以弯曲的。到这里其实引入了一个问题，它是如何弯曲的？</p> 
<p>支持向量机引入了一个核函数（所谓的核函数，就是一个将低维数据映射到高维空间当中）将空间升维，在更高的维度当中超平面出现了（高维度的超平面同样是直的，无法弯曲），于此同时将高维度中的超平面映射到低维度时，低维度的（也就是原始空间）超平面就会变的弯曲。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn <span class="token keyword">import</span> svm
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_moons
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment"># 定义绘制决策边界与支持向量的函数</span>
<span class="token keyword">def</span> <span class="token function">plot_decision_boundaries</span><span class="token punctuation">(</span>clf<span class="token punctuation">,</span> X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> h<span class="token operator">=</span><span class="token number">0.02</span><span class="token punctuation">,</span> draw_svm<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">'Hyperplane'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 绘制地图边界</span>
    x_min<span class="token punctuation">,</span> x_max <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    y_min<span class="token punctuation">,</span> y_max <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    xx<span class="token punctuation">,</span> yy <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>x_min<span class="token punctuation">,</span> x_max<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>y_min<span class="token punctuation">,</span> y_max<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># 设置绘图属性</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>title<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span>xx<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> xx<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 限制x轴的显示范围</span>
    plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span>yy<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> yy<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 移除x轴刻度标签</span>
    plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># np.c_用于按列连接数组，ravel用于将多维数组“展平”成一维数组</span>
    Z <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>np<span class="token punctuation">.</span>c_<span class="token punctuation">[</span>xx<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> yy<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    Z <span class="token operator">=</span> Z<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>xx<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
    <span class="token comment"># 绘制决策边界</span>
    plt<span class="token punctuation">.</span>contourf<span class="token punctuation">(</span>xx<span class="token punctuation">,</span> yy<span class="token punctuation">,</span> Z<span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'hot'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>

    markers <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'o'</span><span class="token punctuation">,</span> <span class="token string">'s'</span><span class="token punctuation">,</span> <span class="token string">'^'</span><span class="token punctuation">)</span> <span class="token comment"># 标记</span>
    colors <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'blue'</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'cyan'</span><span class="token punctuation">)</span> <span class="token comment"># 不同颜色用以区分</span>
    labels <span class="token operator">=</span> np<span class="token punctuation">.</span>unique<span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token comment"># 取标签可能取得的值的类型，此处为0，1</span>
    <span class="token comment"># 绘制数据点</span>
    <span class="token keyword">for</span> label <span class="token keyword">in</span> labels<span class="token punctuation">:</span>
        plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">[</span>y <span class="token operator">==</span> label<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span>y <span class="token operator">==</span> label<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment"># 散点图</span>
                    c<span class="token operator">=</span>colors<span class="token punctuation">[</span>label<span class="token punctuation">]</span><span class="token punctuation">,</span> marker<span class="token operator">=</span>markers<span class="token punctuation">[</span>label<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> draw_svm<span class="token punctuation">:</span> <span class="token comment"># 如果指定绘制支持向量，则绘制支持向量</span>
        sv <span class="token operator">=</span> clf<span class="token punctuation">.</span>support_vectors_ <span class="token comment"># support_vectors_是一个数组，包含所有支持变量</span>
        plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>sv<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sv<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'y'</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'x'</span><span class="token punctuation">)</span>

<span class="token comment"># 生产包含150个样本（月亮形数据集），噪声为0.15</span>
X<span class="token punctuation">,</span> y <span class="token operator">=</span> make_moons<span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">,</span> noise<span class="token operator">=</span><span class="token number">0.15</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>

<span class="token comment"># 初始化不同参数的SVM分类器</span>
<span class="token comment"># kernel指定算法中使用的内核类型。C为正则化参数，表示对误分类的惩罚程度。gamma定义了单个训练样本的影响达到最大的半径</span>
clf_rbf1 <span class="token operator">=</span> svm<span class="token punctuation">.</span>SVC<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">'rbf'</span><span class="token punctuation">,</span> gamma<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">,</span> C<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span>
clf_rbf2 <span class="token operator">=</span> svm<span class="token punctuation">.</span>SVC<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">'rbf'</span><span class="token punctuation">,</span> gamma<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>    C<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span>
clf_rbf3 <span class="token operator">=</span> svm<span class="token punctuation">.</span>SVC<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">'rbf'</span><span class="token punctuation">,</span> gamma<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">,</span> C<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
clf_rbf4 <span class="token operator">=</span> svm<span class="token punctuation">.</span>SVC<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">'rbf'</span><span class="token punctuation">,</span> gamma<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>    C<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
clf_rbf5 <span class="token operator">=</span> svm<span class="token punctuation">.</span>SVC<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">'rbf'</span><span class="token punctuation">,</span> gamma<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">,</span> C<span class="token operator">=</span><span class="token number">10000</span><span class="token punctuation">)</span>
clf_rbf6 <span class="token operator">=</span> svm<span class="token punctuation">.</span>SVC<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">'rbf'</span><span class="token punctuation">,</span> gamma<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>    C<span class="token operator">=</span><span class="token number">10000</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
clfs <span class="token operator">=</span> <span class="token punctuation">[</span>clf_rbf1<span class="token punctuation">,</span> clf_rbf2<span class="token punctuation">,</span> clf_rbf3<span class="token punctuation">,</span> clf_rbf4<span class="token punctuation">,</span> clf_rbf5<span class="token punctuation">,</span> clf_rbf6<span class="token punctuation">]</span>
titles <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'gamma=0.01, C=1'</span><span class="token punctuation">,</span> <span class="token string">'gamma=0.01, C=100'</span><span class="token punctuation">,</span> <span class="token string">'gamma=0.01, C=10000'</span><span class="token punctuation">,</span>
          <span class="token string">'gamma=5, C=1'</span><span class="token punctuation">,</span> <span class="token string">'gamma=5, C=100'</span><span class="token punctuation">,</span> <span class="token string">'gamma=5, C=10000'</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> clf<span class="token punctuation">,</span> i <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>clfs<span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>clfs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token comment"># 训练当前分类器</span>
    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 创建并选择当前子图</span>
    plot_decision_boundaries<span class="token punctuation">(</span>clf<span class="token punctuation">,</span> X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> title<span class="token operator">=</span>titles<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>通过分析结果，发现<mark>gamma=0.01，C=1</mark>图的决策边界平滑，模型的复杂度较低；如<mark>gamma=0.01，C=100</mark>图的决策边界同样平滑，但对噪声更加敏感；但是<mark>gamma=0.01，C=10000</mark>图的C值过大，模型非常复杂，可能存在过拟合的风险；同样的高gamma值也会出现相应的问题，都会带来过拟合的风险</p> 
<p><img src="https://images2.imgbox.com/e3/e7/85IGfPGG_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h4><a id="_341"></a>朴素贝叶斯</h4> 
<p>朴素贝叶斯（Naive Bayes，简称NB）是基于贝叶斯定理与特征条件独立假设的分类方法。其核心思想是利用已知的训练样本集，通过计算待分类样本属于各个类别的概率，并将样本归为概率最大的那个类别</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> matplotlib<span class="token punctuation">.</span>colors <span class="token keyword">import</span> ListedColormap
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_classification<span class="token punctuation">,</span> make_moons<span class="token punctuation">,</span> make_circles
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>naive_bayes <span class="token keyword">import</span> GaussianNB<span class="token punctuation">,</span> MultinomialNB<span class="token punctuation">,</span> BernoulliNB<span class="token punctuation">,</span> ComplementNB
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler

<span class="token comment"># 绘制散点图</span>
<span class="token keyword">def</span> <span class="token function">plot_scatter</span><span class="token punctuation">(</span>ax<span class="token punctuation">,</span> X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">,</span> array1<span class="token punctuation">,</span> array2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cm_bright <span class="token operator">=</span> ListedColormap<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'#FF0000'</span><span class="token punctuation">,</span> <span class="token string">'#0000FF'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span>y_train<span class="token punctuation">,</span> cmap<span class="token operator">=</span>cm_bright<span class="token punctuation">,</span> edgecolors<span class="token operator">=</span><span class="token string">'k'</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_test<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X_test<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span>y_test<span class="token punctuation">,</span> cmap<span class="token operator">=</span>cm_bright<span class="token punctuation">,</span> edgecolors<span class="token operator">=</span><span class="token string">'k'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xlim<span class="token punctuation">(</span>array1<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> array1<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_ylim<span class="token punctuation">(</span>array2<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> array2<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_yticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 创建模型</span>
<span class="token keyword">def</span> <span class="token function">model</span><span class="token punctuation">(</span>clf<span class="token punctuation">,</span> datasets<span class="token punctuation">,</span> title<span class="token punctuation">,</span> typeId<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> typeNum<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> negative<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    i <span class="token operator">=</span> typeId <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token keyword">for</span> ds_index<span class="token punctuation">,</span> ds <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>datasets<span class="token punctuation">)</span><span class="token punctuation">:</span>
        X<span class="token punctuation">,</span> y <span class="token operator">=</span> ds
        <span class="token comment"># 标准化数据集，同时划分训练集和测试集</span>
        X <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
        <span class="token comment"># 如果要求输入是非负值</span>
        <span class="token keyword">if</span> negative<span class="token punctuation">:</span>
            min_x <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            min_y <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            offset <span class="token operator">=</span> <span class="token builtin">min</span><span class="token punctuation">(</span><span class="token builtin">abs</span><span class="token punctuation">(</span>min_x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>min_y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>  <span class="token comment"># 加1确保所有值都是正的</span>
            X <span class="token operator">=</span> X <span class="token operator">-</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>min_x<span class="token punctuation">,</span> min_y<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>offset<span class="token punctuation">,</span> offset<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 进行偏移</span>
        <span class="token comment"># 划分训练集、测试集</span>
        X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.4</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>
        x_min<span class="token punctuation">,</span> x_max <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">.5</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">.5</span>
        y_min<span class="token punctuation">,</span> y_max <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">.5</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">.5</span>
        array1<span class="token punctuation">,</span> array2 <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>x_min<span class="token punctuation">,</span> x_max<span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>y_min<span class="token punctuation">,</span> y_max<span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># x，y轴坐标</span>
        ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>datasets<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span>typeNum<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token comment"># 子图</span>

        <span class="token keyword">if</span> ds_index <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">'Input Data'</span><span class="token punctuation">)</span>
        plot_scatter<span class="token punctuation">(</span>ax<span class="token punctuation">,</span> X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">,</span> array1<span class="token punctuation">,</span> array2<span class="token punctuation">)</span>
        <span class="token comment"># 开始绘制第二幅图</span>
        ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>datasets<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span>typeNum<span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>

        clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span> <span class="token comment"># 开始训练</span>
        score <span class="token operator">=</span> clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span> <span class="token comment"># 评估分数</span>
        Z <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>np<span class="token punctuation">.</span>c_<span class="token punctuation">[</span>array1<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> array2<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment"># 针对测试向量的概率估计</span>
        Z <span class="token operator">=</span> Z<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>array1<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
        ax<span class="token punctuation">.</span>contourf<span class="token punctuation">(</span>array1<span class="token punctuation">,</span> array2<span class="token punctuation">,</span> Z<span class="token punctuation">,</span> cmap<span class="token operator">=</span>plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>RdBu<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">.8</span><span class="token punctuation">)</span> <span class="token comment"># 绘制边界</span>
        plot_scatter<span class="token punctuation">(</span>ax<span class="token punctuation">,</span> X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">,</span> array1<span class="token punctuation">,</span> array2<span class="token punctuation">)</span>
        <span class="token keyword">if</span> ds_index <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span>title<span class="token punctuation">)</span>
        ax<span class="token punctuation">.</span>text<span class="token punctuation">(</span>array1<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">.3</span><span class="token punctuation">,</span> array2<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">.3</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'{:.1f}%'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>score <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span>
                horizontalalignment<span class="token operator">=</span><span class="token string">'right'</span><span class="token punctuation">)</span> <span class="token comment"># 显示测试分数</span>
        i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token punctuation">(</span>typeNum<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span>

names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Multinomial"</span><span class="token punctuation">,</span> <span class="token string">"Gaussian"</span><span class="token punctuation">,</span> <span class="token string">"Bernoulli"</span><span class="token punctuation">,</span> <span class="token string">"Complement"</span><span class="token punctuation">]</span>
<span class="token comment"># 创建分类器</span>
Classifiers <span class="token operator">=</span> <span class="token punctuation">[</span>MultinomialNB<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> GaussianNB<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BernoulliNB<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ComplementNB<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token comment"># 生成数据集。n_features特征总数，n_informative信息特征的数量，n_redundant冗余特征的数量，n_clusters_per_class每个类的簇数</span>
X<span class="token punctuation">,</span> y <span class="token operator">=</span> make_classification<span class="token punctuation">(</span>n_features<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> n_informative<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> n_redundant<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> n_clusters_per_class<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment"># 月亮形数据</span>
rng <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>RandomState<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
X <span class="token operator">+=</span> <span class="token number">2</span> <span class="token operator">*</span> rng<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span>size<span class="token operator">=</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
linearly_separable <span class="token operator">=</span> <span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
<span class="token comment"># noise加到数据中的高斯噪声的标准偏差，factor内圆和外圆之间的比例因子</span>
datasets <span class="token operator">=</span> <span class="token punctuation">[</span>make_moons<span class="token punctuation">(</span>noise<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> make_circles<span class="token punctuation">(</span>noise<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> factor<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> linearly_separable<span class="token punctuation">]</span>

figure <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># MultinomialNB与ComplementNB在训练时要求输入数据 X 中的所有特征值都必须是非负的</span>
<span class="token comment"># 使用四种朴素贝叶斯模型开始训练</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span> clf <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>Classifiers<span class="token punctuation">)</span><span class="token punctuation">:</span>
    neg <span class="token operator">=</span> <span class="token boolean">True</span> <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">or</span> i <span class="token operator">==</span> <span class="token number">3</span> <span class="token keyword">else</span> <span class="token boolean">False</span>
    model<span class="token punctuation">(</span>clf<span class="token punctuation">,</span> datasets<span class="token punctuation">,</span> names<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>Classifiers<span class="token punctuation">)</span><span class="token punctuation">,</span> negative<span class="token operator">=</span>neg<span class="token punctuation">)</span>


plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 用于自动调整子图参数，使之填充整个图像区域</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>如下图所示，这是四个模型所得出来的结果。我们可以发现在这三种数据分布下，GaussianNB模型最为出色，这其实是因为所给的测试数据较为符合它的应用场景，所以我们在针对不同场景应该选择最合适的模型（侧面说明没有最好的模型，只不过适合不适合而已）</p> 
<ol><li>MultinomialNB（多项式朴素贝叶斯）：适用于计数数据，特别是文本数据分类。常用于非常大的数据集</li><li>GaussianNB（高斯朴素贝叶斯）：算法简单、易于理解和实现。适用于连续值数据的分类</li><li>BernoulliNB（伯努利朴素贝叶斯）：可以处理多类别问题，并且可以处理噪声和不完整的数据。特别适用于二项分布数据（即特征只取0和1两种情况）的分类问题</li><li>ComplementNB（补充朴素贝叶斯）：为了修正标准多项式朴素贝叶斯分类器的“严格假设”而设计，特别适合于不平衡的数据集</li></ol> 
<p><img src="https://images2.imgbox.com/a7/8d/6AHnZvyO_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h4><a id="k_438"></a>k-近邻</h4> 
<p>k近邻（k-Nearest Neighbor，KNN）算法是一种基于实例的学习算法，其核心思想是在特征空间中，如果一个样本附近的k个最近（即特征空间中最邻近）样本的大多数属于某一个类别，则该样本也属于这个类别。这种方法通过测量不同测试样本之间的距离，并寻找最为相近的k个样本来进行分类或回归。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> matplotlib<span class="token punctuation">.</span>colors <span class="token keyword">import</span> ListedColormap
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> datasets<span class="token punctuation">,</span> neighbors

<span class="token comment"># 设置邻居数</span>
n_neighbors <span class="token operator">=</span> <span class="token number">15</span>
iris <span class="token operator">=</span> datasets<span class="token punctuation">.</span>load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span>
X <span class="token operator">=</span> iris<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token comment"># 仅取两个特征</span>
y <span class="token operator">=</span> iris<span class="token punctuation">.</span>target
h <span class="token operator">=</span> <span class="token number">.02</span> <span class="token comment"># 步长</span>

cmap_light <span class="token operator">=</span> ListedColormap<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'orange'</span><span class="token punctuation">,</span> <span class="token string">'cyan'</span><span class="token punctuation">,</span> <span class="token string">'cornflowerblue'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
cmap_bold <span class="token operator">=</span> ListedColormap<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'darkorange'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'darkblue'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 遍历两种不同的权重方式：'uniform'（等权重）和'distance'（基于距离的权重）</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span> weights <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'uniform'</span><span class="token punctuation">,</span> <span class="token string">'distance'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 创建KNN分类器实例，设置邻居数和权重方式</span>
    clf <span class="token operator">=</span> neighbors<span class="token punctuation">.</span>KNeighborsClassifier<span class="token punctuation">(</span>n_neighbors<span class="token operator">=</span>n_neighbors<span class="token punctuation">,</span> weights<span class="token operator">=</span>weights<span class="token punctuation">)</span>
    clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>

    x_min<span class="token punctuation">,</span> x_max <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    y_min<span class="token punctuation">,</span> y_max <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    xx<span class="token punctuation">,</span> yy <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>x_min<span class="token punctuation">,</span> x_max<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">,</span>
                        np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>y_min<span class="token punctuation">,</span> y_max<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">)</span>
    Z <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>np<span class="token punctuation">.</span>c_<span class="token punctuation">[</span>xx<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> yy<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    Z <span class="token operator">=</span> Z<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>xx<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
    ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token comment"># 使用pcolormesh绘制网格的分类颜色</span>
    ax<span class="token punctuation">.</span>pcolormesh<span class="token punctuation">(</span>xx<span class="token punctuation">,</span> yy<span class="token punctuation">,</span> Z<span class="token punctuation">,</span> cmap<span class="token operator">=</span>cmap_light<span class="token punctuation">)</span>
    <span class="token comment"># 绘制原始数据点的散点图，使用不同的颜色表示不同的类别</span>
    ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span>y<span class="token punctuation">,</span> cmap<span class="token operator">=</span>cmap_bold<span class="token punctuation">,</span> edgecolors<span class="token operator">=</span><span class="token string">'k'</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xlim<span class="token punctuation">(</span>xx<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> xx<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 设置坐标轴的范围</span>
    ax<span class="token punctuation">.</span>set_ylim<span class="token punctuation">(</span>yy<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> yy<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"3-Class classification (k = %i, weights = '%s')"</span>
              <span class="token operator">%</span> <span class="token punctuation">(</span>n_neighbors<span class="token punctuation">,</span> weights<span class="token punctuation">)</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>我们首先使用k-近邻分类模型，通过采用<mark>iris</mark>数据集来进行模拟，发现效果还不错</p> 
<p><img src="https://images2.imgbox.com/0b/4b/HvfmqPGE_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<p>接下来，我们将使用k-近邻回归模型来展示这一算法对于回归问题的效果</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> time
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> neighbors

np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
X <span class="token operator">=</span> np<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
T <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>newaxis<span class="token punctuation">]</span>
y <span class="token operator">=</span> np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span>
y<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">0.5</span> <span class="token operator">-</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

n_neighbors <span class="token operator">=</span> <span class="token number">5</span>

<span class="token keyword">for</span> i<span class="token punctuation">,</span> weights <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'uniform'</span><span class="token punctuation">,</span> <span class="token string">'distance'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    knn <span class="token operator">=</span> neighbors<span class="token punctuation">.</span>KNeighborsRegressor<span class="token punctuation">(</span>n_neighbors<span class="token operator">=</span>n_neighbors<span class="token punctuation">,</span> weights<span class="token operator">=</span>weights<span class="token punctuation">)</span>
    y_ <span class="token operator">=</span> knn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">.</span>predict<span class="token punctuation">(</span>T<span class="token punctuation">)</span>

    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'darkorange'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'data'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>T<span class="token punctuation">,</span> y_<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'navy'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'prediction'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'tight'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"KNeighborsRegressor (k = %i, weights = '%s')"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>n_neighbors<span class="token punctuation">,</span> weights<span class="token punctuation">)</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>这里我们采用不同的权重函数，发现<mark>distance</mark>函数对于噪声较为敏感，而<mark>uniform</mark>函数相对不敏感。这里可以看出权重函数针对同一模型的影响</p> 
<p><img src="https://images2.imgbox.com/73/1c/gVhvT6At_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h4><a id="Boost_528"></a>提升（Boost）算法（集成学习算法）</h4> 
<p>提升算法（Boosting Algorithms）是一类用于提高机器学习模型预测准确性的集成学习技术。其核心思想是通过结合多个弱学习器（weak learners，即预测准确率略高于随机猜测的模型）来构建一个强学习器（strong learner，即预测准确率较高的模型）</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_gaussian_quantiles
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> AdaBoostClassifier
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> DecisionTreeClassifier

<span class="token comment"># 生成两组高斯分位数数据</span>
x1<span class="token punctuation">,</span> y1 <span class="token operator">=</span> make_gaussian_quantiles<span class="token punctuation">(</span>cov<span class="token operator">=</span><span class="token number">2.0</span><span class="token punctuation">,</span> n_samples<span class="token operator">=</span><span class="token number">600</span><span class="token punctuation">,</span> n_features<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
                                 n_classes<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>
x2<span class="token punctuation">,</span> y2 <span class="token operator">=</span> make_gaussian_quantiles<span class="token punctuation">(</span>mean<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cov<span class="token operator">=</span><span class="token number">2.0</span><span class="token punctuation">,</span> n_samples<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">,</span> n_features<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
                                 n_classes<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>
<span class="token comment"># 将两组数据合并</span>
X <span class="token operator">=</span> np<span class="token punctuation">.</span>concatenate<span class="token punctuation">(</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span> x2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 合并特征数据</span>
y <span class="token operator">=</span> np<span class="token punctuation">.</span>concatenate<span class="token punctuation">(</span><span class="token punctuation">(</span>y1<span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">-</span>y2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 合并标签数据，注意第二组数据的标签取反以形成分类任务</span>
<span class="token comment"># 绘制合并后的数据点</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">,</span> c<span class="token operator">=</span>y<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>

<span class="token comment"># DecisionTreeClassifier决策树，max_depth树的最大深度，min_samples_split拆分内部节点所需的最少样本数，min_samples_leaf在叶节点处所需的最小样本数</span>
<span class="token comment"># 创建并训练AdaBoost模型，estimator建立增强集成的基础估计器(这里是DecisionTreeClassifier)</span>
clf <span class="token operator">=</span> AdaBoostClassifier<span class="token punctuation">(</span>estimator<span class="token operator">=</span>DecisionTreeClassifier<span class="token punctuation">(</span>max_depth<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> min_samples_split<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> min_samples_leaf<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                         algorithm<span class="token operator">=</span><span class="token string">"SAMME"</span><span class="token punctuation">,</span> n_estimators<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span> learning_rate<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">)</span>
clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token comment"># 训练模型</span>
<span class="token comment"># 绘制决策边界</span>
x_min<span class="token punctuation">,</span> x_max <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token comment"># 计算x轴的范围</span>
y_min<span class="token punctuation">,</span> y_max <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token comment"># 计算y轴的范围</span>
xx<span class="token punctuation">,</span> yy <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>x_min<span class="token punctuation">,</span> x_max<span class="token punctuation">,</span> <span class="token number">0.02</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>y_min<span class="token punctuation">,</span> y_max<span class="token punctuation">,</span> <span class="token number">0.02</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 生成网格点</span>
Z <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>np<span class="token punctuation">.</span>c_<span class="token punctuation">[</span>xx<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> yy<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 对网格点进行预测</span>
Z <span class="token operator">=</span> Z<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>xx<span class="token punctuation">.</span>shape<span class="token punctuation">)</span> <span class="token comment"># 重塑预测结果为网格形状</span>

plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>contourf<span class="token punctuation">(</span>xx<span class="token punctuation">,</span> yy<span class="token punctuation">,</span> Z<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'coolwarm'</span><span class="token punctuation">)</span> <span class="token comment"># 绘制填充等高线图，显示决策边界</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">,</span> c<span class="token operator">=</span>y<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment"># 再次绘制数据点，以便与决策边界对比</span>

plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>这里我们采用的是AdaBoost模型，同样类似的还有随机森林模型。两者之间最大的不同应该就是串行与并行的特点</p> 
<ol><li>AdaBoost模型：采用Boosting策略。Boosting通过串行训练多个弱学习器，并根据每个弱学习器的表现调整样本的权重，使得后续的学习器更加关注那些在前一轮中被错误分类的样本。</li><li>随机森林模型：采用Bagging（Bootstrap Aggregating）策略。Bagging通过并行训练多个弱学习器（通常是决策树），并将它们的预测结果进行平均或投票来得到最终预测。</li></ol> 
<p>如下图可以看到该模型最后训练出的成果。可以说这个算法所作的一件事情，就是将几个比较弱的专家（也就是垃圾的分类器或者模型）一起凑到一块做决定，来判断最终结果。说白了“三个臭皮匠顶个诸葛亮”（这句话更适用于随机森林模型）</p> 
<p><img src="https://images2.imgbox.com/e1/77/rxhNWQbV_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h4><a id="_583"></a>聚类</h4> 
<p>聚类（Clustering）是机器学习中的一种无监督学习方法，旨在将数据集中的样本划分为若干个类或簇（clusters），使得同一簇内的样本之间相似度较高，而不同簇的样本之间相似度较低。聚类不需要事先知道每个样本的类别标签，而是通过分析样本之间的特征相似性或距离来自动形成簇</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>cluster <span class="token keyword">import</span> KMeans
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_blobs

<span class="token keyword">def</span> <span class="token function">plot_scatter</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> centroid<span class="token punctuation">,</span> idx<span class="token punctuation">)</span><span class="token punctuation">:</span>
    color <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"pink"</span><span class="token punctuation">,</span> <span class="token string">"orange"</span><span class="token punctuation">,</span> <span class="token string">"gray"</span><span class="token punctuation">]</span>
    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> idx<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">[</span>y <span class="token operator">==</span> i<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span>y <span class="token operator">==</span> i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token operator">=</span>color<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token comment"># 散点图</span>
    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>centroid<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> centroid<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'x'</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">"black"</span><span class="token punctuation">)</span> <span class="token comment"># 绘制簇中心坐标</span>

<span class="token keyword">def</span> <span class="token function">train</span><span class="token punctuation">(</span>n_clusters<span class="token punctuation">,</span> X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> idx<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cluster <span class="token operator">=</span> KMeans<span class="token punctuation">(</span>n_clusters<span class="token operator">=</span>n_clusters<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment"># K-均值聚类模型</span>
    cluster<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">)</span> <span class="token comment"># 训练</span>
    centroid <span class="token operator">=</span> cluster<span class="token punctuation">.</span>cluster_centers_ <span class="token comment"># 簇中心坐标</span>
    plot_scatter<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> centroid<span class="token punctuation">,</span> idx<span class="token punctuation">)</span> <span class="token comment"># 绘制</span>

X<span class="token punctuation">,</span> y <span class="token operator">=</span> make_blobs<span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> n_features<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> centers<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 不同n_clusters参数对于模型的影响</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    train<span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">,</span> X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> i<span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>如下三幅图，不同之处仅在于<mark>n_clusters</mark>参数的不同（要形成的簇数以及要生成的质心数，也就是说分几类），可以看出中间图最为合适，过少或者过多的簇数都会影响最终的结果及判断</p> 
<p><img src="https://images2.imgbox.com/e4/27/gZ4jl39F_o.png" alt="在这里插入图片描述"></p> 
<hr>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/48665ea06f628c456dadba8c23187cf1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">前端练习小项目——方向感应名片</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cf32eb00e49b68550d3a24169111f740/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Laravel生成二维码图片</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>