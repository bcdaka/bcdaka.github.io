<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>4.2 图书借阅系统数据库设计 --MySQL - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/c8fb0865b1f2c962e3080d280e8407d6/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="4.2 图书借阅系统数据库设计 --MySQL">
  <meta property="og:description" content="本文目录 前言一、背景和需求分析1.1 背景1.2 信息需求1.3 功能需求管理员学生 1.4 数据流图 二、概念结构设计1. 抽象出系统实体2. 局部E-R图2.1 学生 E-R图2.2 借阅证 E-R图2.3 图书 E-R图2.4 管理员 E-R图2.5 公告 E-R图2.6 申请 E-R图2.7 借阅 E-R图2.8 评论 E-R图2.9 收藏 E-R图 3. 全局E-R图 三、逻辑结构设计3.1 转换规则3.2 关系模式3.2.1 按转换规则分析3.2.2 实际转换结果 3.3 表结构 四、物理结构设计与实施4.1 创建数据库4.2 创建数据表4.3 初始化数据 五、具体业务分析5.1 录入图书5.2 学生注册 &#43; 申请借阅证5.2.1 注册5.2.2 填写学生信息，申请借阅证 5.3 管理员审核借阅证通过5.4 搜索图书5.5 查看图书详情5.6 图书收藏 和 取消收藏5.6.1 收藏5.6.2 取消收藏 5.7 图书评论 和 审核评论5.7.1 评论5.7.2 审核评论 5.8 借阅 和 借阅审核5.8.1 借阅5.8.2 借阅审核5.8.3 归还 参考最后 前言 大家好，我是天罡gg，一个有十多年丰富经验的高级架构师，参与过很多系统的数据库设计，在数据库设计方面有相当丰富的经验。正赶上这篇实战专栏的数据库设计，所以今天让我们来一起做一下《图书借阅系统的数据库设计》，一篇既有理论知识，又能实战落地的数据库设计！">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-04-22T21:21:06+08:00">
    <meta property="article:modified_time" content="2023-04-22T21:21:06+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">4.2 图书借阅系统数据库设计 --MySQL</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/c9/da/hdimqskm_o.gif" alt="CSDN成就一亿技术人"></p> 
<hr> 
<p></p> 
<div class="toc"> 
 <h4>本文目录</h4> 
 <ul><li><a href="#_8" rel="nofollow">前言</a></li><li><a href="#_25" rel="nofollow">一、背景和需求分析</a></li><li><ul><li><a href="#11__29" rel="nofollow">1.1 背景</a></li><li><a href="#12__35" rel="nofollow">1.2 信息需求</a></li><li><a href="#13__44" rel="nofollow">1.3 功能需求</a></li><li><ul><li><a href="#_46" rel="nofollow">管理员</a></li><li><a href="#_71" rel="nofollow">学生</a></li></ul> 
   </li><li><a href="#14__109" rel="nofollow">1.4 数据流图</a></li></ul> 
  </li><li><a href="#_115" rel="nofollow">二、概念结构设计</a></li><li><ul><li><a href="#1__119" rel="nofollow">1. 抽象出系统实体</a></li><li><a href="#2_ER_150" rel="nofollow">2. 局部E-R图</a></li><li><ul><li><a href="#21__ER_166" rel="nofollow">2.1 学生 E-R图</a></li><li><a href="#22__ER_179" rel="nofollow">2.2 借阅证 E-R图</a></li><li><a href="#23__ER_185" rel="nofollow">2.3 图书 E-R图</a></li><li><a href="#24__ER_199" rel="nofollow">2.4 管理员 E-R图</a></li><li><a href="#25__ER_206" rel="nofollow">2.5 公告 E-R图</a></li><li><a href="#26__ER_220" rel="nofollow">2.6 申请 E-R图</a></li><li><a href="#27__ER_232" rel="nofollow">2.7 借阅 E-R图</a></li><li><a href="#28__ER_244" rel="nofollow">2.8 评论 E-R图</a></li><li><a href="#29__ER_256" rel="nofollow">2.9 收藏 E-R图</a></li></ul> 
   </li><li><a href="#3_ER_270" rel="nofollow">3. 全局E-R图</a></li></ul> 
  </li><li><a href="#_279" rel="nofollow">三、逻辑结构设计</a></li><li><ul><li><ul><li><a href="#31__283" rel="nofollow">3.1 转换规则</a></li><li><a href="#32__293" rel="nofollow">3.2 关系模式</a></li><li><ul><li><a href="#321__295" rel="nofollow">3.2.1 按转换规则分析</a></li><li><a href="#322__322" rel="nofollow">3.2.2 实际转换结果</a></li></ul> 
    </li><li><a href="#33__378" rel="nofollow">3.3 表结构</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_422" rel="nofollow">四、物理结构设计与实施</a></li><li><ul><li><ul><li><a href="#41__426" rel="nofollow">4.1 创建数据库</a></li><li><a href="#42__436" rel="nofollow">4.2 创建数据表</a></li><li><a href="#43__498" rel="nofollow">4.3 初始化数据</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_508" rel="nofollow">五、具体业务分析</a></li><li><ul><li><a href="#51__510" rel="nofollow">5.1 录入图书</a></li><li><a href="#52____521" rel="nofollow">5.2 学生注册 + 申请借阅证</a></li><li><ul><li><a href="#521__523" rel="nofollow">5.2.1 注册</a></li><li><a href="#522__529" rel="nofollow">5.2.2 填写学生信息，申请借阅证</a></li></ul> 
   </li><li><a href="#53__538" rel="nofollow">5.3 管理员审核借阅证通过</a></li><li><a href="#54__553" rel="nofollow">5.4 搜索图书</a></li><li><a href="#55__577" rel="nofollow">5.5 查看图书详情</a></li><li><a href="#56____593" rel="nofollow">5.6 图书收藏 和 取消收藏</a></li><li><ul><li><a href="#561__595" rel="nofollow">5.6.1 收藏</a></li><li><a href="#562__603" rel="nofollow">5.6.2 取消收藏</a></li></ul> 
   </li><li><a href="#57____613" rel="nofollow">5.7 图书评论 和 审核评论</a></li><li><ul><li><a href="#571__615" rel="nofollow">5.7.1 评论</a></li><li><a href="#572__623" rel="nofollow">5.7.2 审核评论</a></li></ul> 
   </li><li><a href="#58____643" rel="nofollow">5.8 借阅 和 借阅审核</a></li><li><ul><li><a href="#581__645" rel="nofollow">5.8.1 借阅</a></li><li><a href="#582__654" rel="nofollow">5.8.2 借阅审核</a></li><li><a href="#583__675" rel="nofollow">5.8.3 归还</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_696" rel="nofollow">参考</a></li><li><a href="#_702" rel="nofollow">最后</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_8"></a>前言</h2> 
<p>大家好，我是天罡gg，一个有十多年丰富经验的高级架构师，参与过很多系统的数据库设计，在数据库设计方面有相当丰富的经验。正赶上这篇实战专栏的数据库设计，所以今天让我们来一起做一下《图书借阅系统的数据库设计》，一篇既有理论知识，又能实战落地的数据库设计！<br> 本文从【需求分析】开始，到【概念结构设计】的<font face="幼圆" color="#FF3366" size="4"><strong>画ER图</strong></font>, 再到【逻辑结构设计】的<font face="幼圆" color="#FF3366" size="4"><strong>ER图转关系模型,</strong></font> 最后到【物理结构设计】的<font face="幼圆" color="#FF3366" size="4"><strong>MySQL表设计</strong></font>, 再加上【具体业务分析】的<font face="幼圆" color="#FF3366" size="4"><strong>SQL实现</strong></font>，你是不是已经怀疑真有这么齐全吗？你没看错，全文HTML统计<strong>1万3千多字</strong>，Markdown统计<strong>1万6千多字</strong>，设计图片<strong>24张</strong>，让我们拭目以待！</p> 
<blockquote> 
 <p>数据库设计的基本步骤<br> 按照规范设计的方法，考虑数据库及其应用系统开发全过程，将数据库设计分为以下6个阶段</p> 
</blockquote> 
<ol><li>需求分析：分析用户的需求，包括数据、功能和性能需求</li><li>概念结构设计：主要采用E-R模型进行设计，包括画E-R图</li><li>逻辑结构设计：通过将E-R图转换成表，实现从E-R模型到关系模型的转换</li><li>物理结构设计：主要是为所设计的数据库选择合适的存储结构和存取路径</li><li>数据库实施：包括编程、测试和试运行</li><li>数据库的运行和维护：在运行过程中不断对其进行调整、修改。</li></ol> 
<hr> 
<h2><a id="_25"></a>一、背景和需求分析</h2> 
<blockquote> 
 <p>说明：分析用户的需求，包括数据、功能和性能需求。</p> 
</blockquote> 
<h3><a id="11__29"></a>1.1 背景</h3> 
<p>图书馆作为一种信息资源的交换场所，图书和用户借阅资料繁多，包含很多数据信息的管理，因此实现图书管理的电子信息化，可以简化繁琐的工作模式，有效解决图书借阅过程中的诸多问题，给图书管理员和借阅者带来极大的便利。</p> 
<p>图书借阅系统是为了满足图书馆借阅图书的工作而设计的，它的功能主要分为数据维护和基本功能两大模块。其中数据维护模块包括图书的数据维护和借阅者的数据维护，基本功能模块包括对图书和借阅者的信息浏览、借书、还书、查询、统计等功能。</p> 
<h3><a id="12__35"></a>1.2 信息需求</h3> 
<p>图书借阅系统主要针对两种身份：<code>管理员</code>、<code>学生</code>。</p> 
<p><strong>学生：</strong> 可以在线查找自己想借的图书，能查看图书的基本信息是最低要求。为了更好的借书体验，可以查看图书的借阅次数、评论数和具体评论 以及 借阅状态。通过查看借阅次数和评论，增加对图书的兴趣，当查看图书的借阅状态是闲置中时，可以直接在线发起借阅；如果图书已经在借阅中，我们可以提供一个收藏功能，方便日后再借阅；那么当对图书有话说时，还可以发起评论，这些都是电子信息化带来的好处。</p> 
<p><strong>管理员：</strong> 主要职责是对图书进行维护，对学生进行管理。为了更好的运营，可以发布一些新闻公告、做一些新书推荐，为了更规范运作，需要拥有对学生的借阅借的审批、对学生借书的审批、对学生还书的审批登记、以及对评论的审批等工作。</p> 
<p><img src="https://images2.imgbox.com/7a/f2/pXrHAGKo_o.png" alt="图书借阅系统-业务流程图"></p> 
<h3><a id="13__44"></a>1.3 功能需求</h3> 
<h4><a id="_46"></a>管理员</h4> 
<ol><li> <p>图书管理</p> <p>包括图书录入、修改的功能，这也是必备的功能。</p> <p>图书<strong>包含</strong>字段：<strong>图书编号</strong>、<strong>图书名称</strong>、<strong>图书类型</strong>、<strong>作者</strong>、<strong>图书简介</strong>、<strong>图书封面</strong>、<strong>出版社</strong>、<strong>出版时间</strong></p> 
  <ul><li>新书推荐：有对图书进行推荐的功能，当管理员操作后，推荐的图书会展示到学生能看到的推荐区域</li><li>借阅审批：学生发起的借阅申请，需要经过管理员审批，审批通过后才可以线下领书。管理员可以根据图书和学生的情况进行审批，包括审批通过和拒绝两个功能项，拒绝需要填写拒绝原因</li><li>书评管理：学生在图书详情对图书进行评论、打分后，不会直接展示，需要经过管理员审批以后才可以公共显示，包括审批通过和删除两个功能项</li><li>确认归还：当学生将书归还后，由管理员进行确认归还的功能操作</li></ul> </li><li> <p>学生管理</p> 
  <ul><li>学生发起的借阅证申请，需要经过管理员审批，审批通过才会拥有进行图书借阅的资格。管理员根据学生情况进行审批，包括：通过和驳回两个功能项</li><li>对学生借阅资格的冻结或恢复，这是给管理员更大的权限，可以对不遵守规则的学生进行冻结，学生被冻结后将无法借书，直到管理员给恢复。</li></ul> </li><li> <p>公告管理</p> <p>此功能主要是针对一些公告信息的录入，例如寒假即将到来，图书系统即将关闭，请同学们及时借阅，假期补充知识之类的公告。</p> <p>包括新闻公告的新增、修改、删除的功能。</p> <p>公告<strong>包含</strong>字段：<strong>标题</strong>、<strong>内容</strong>、<strong>发布时间</strong></p> </li></ol> 
<h4><a id="_71"></a>学生</h4> 
<ol><li> <p>学生注册</p> <p>学生注册时需要填写<strong>用户名</strong>、<strong>密码</strong>。</p> <p>登录后，进行借阅证申请，需要填写字段：<strong>学生编号</strong>、<strong>学生姓名</strong>、<strong>学生昵称</strong>、<strong>学生所属(例如XX学院XX系XX班)</strong>、<strong>学生证照片</strong></p> </li><li> <p>首页</p> <p>可以查看管理员发布的新闻公告、新书推荐。</p> </li><li> <p>我要借阅</p> <p>借阅证申请通过后，才可以看到我要借阅的入口：</p> 
  <ul><li> <p>查找图书</p> <p><strong>图书类型</strong>进行筛选，可以通过<strong>借阅次数、出版时间</strong>分别进行排序</p> </li><li> <p>借阅</p> <p>当图书借阅状态为<strong>闲置</strong>时，才可以点击借阅。提交借阅后，会发给管理员进行审批。可以在个人借阅记录查询审批结果：通过或拒绝。</p> </li><li> <p>收藏</p> <p>对图书感兴趣，可以点击收藏，也可以取消收藏。可以在我的收藏查看。</p> </li><li> <p>评论</p> <p>对图书有话说，可以点击评论、打分，会发给管理员进行审批，审批通过后，会在图书下公共展示该评论。</p> </li></ul> </li><li> <p>个人中心</p> 
  <ul><li>个人信息展示</li><li>我的借阅</li><li>我的收藏</li><li>修改密码、密记密码</li></ul> </li></ol> 
<h3><a id="14__109"></a>1.4 数据流图</h3> 
<p>待补充</p> 
<hr> 
<h2><a id="_115"></a>二、概念结构设计</h2> 
<blockquote> 
 <p>说明：主要抽象出系统实体，并采用E-R模型进行设计</p> 
</blockquote> 
<h3><a id="1__119"></a>1. 抽象出系统实体</h3> 
<p>学生-》申请 -》借阅证，可以得出【学生】和【借阅证】两个实体，【申请】是联系。</p> 
<p>学生-》借阅 -》图书，可以得出【图书】实体，【借阅】是联系。</p> 
<p>学生-》收藏 -》图书，可以得出【收藏】是联系。</p> 
<p>学生-》评论 -》图书，可以得出【评论】是联系。</p> 
<p>管理员-》发布 -》公告，可以得出【管理员】和【公告】两个实体，【发布】是联系。</p> 
<p>管理员-》管理 -》图书，可以得出【管理】是联系。</p> 
<blockquote> 
 <p>涉及的5个实体有：</p> 
</blockquote> 
<ul><li> 
  <ol><li>. 学生</li></ol> </li><li> 
  <ol start="2"><li>. 借阅证</li></ol> </li><li> 
  <ol start="3"><li>. 图书</li></ol> </li><li> 
  <ol start="4"><li>. 管理员</li></ol> </li><li> 
  <ol start="5"><li>. 公告</li></ol> </li></ul> 
<blockquote> 
 <p>5个实体之间的联系如下：</p> 
</blockquote> 
<ul><li>1名学生，只能<code>申请</code>1个借阅证，一个借阅证也只能属于一名学生，所以是一对一的联系；</li><li>1名学生，可以<code>借阅</code>N本图书，1本图书，也可以被N名学生借阅，所以学生与图书是多对多的借阅联系；</li><li>1名学生，可以<code>收藏</code>N本图书，1本图书，也可以被N名学生收藏，所以学生与图书是多对多的收藏联系；</li><li>1名学生，可以<code>评论</code>N本图书，1本图书，也可以被N名学生评论，所以学生与图书是多对多的评论联系;</li><li>1名管理员，可以<code>发布</code>N条公告，但1条公告，只能由一名管理员发布，所以是一对多联系;</li><li>1名管理员，可以<code>管理</code>N本图书，1本图书，只能由一名管理员最后管理，所以是一对多联系。</li></ul> 
<h3><a id="2_ER_150"></a>2. 局部E-R图</h3> 
<blockquote> 
 <p>E-R图：Entity Relationship，实体关系图。</p> 
 <p>常见的有4个部分：</p> 
 <ul><li> <p>矩形框：表示实体，在框中记入实体名。</p> </li><li> <p>椭圆形框：表示属性，在框中记入属性名。</p> </li><li> <p>菱形框：表示联系，在框中记入联系名。</p> </li><li> <p>连线：用于实体与属性之间；实体与联系之间；联系与属性之间;</p> <p>并在实体与实体之间标注联系的类型（对于一对一联系，要在两个实体连线方向各写1； 对于一对多联系，要在一的一方写1，多的一方写n；对于多对多关系，则要在两个实体连线方向各写m，n。）</p> </li></ul> 
</blockquote> 
<h4><a id="21__ER_166"></a>2.1 学生 E-R图</h4> 
<p>这是一个实体。</p> 
<p>根据需求得知学生基本信息包括：<strong>学生编号</strong>、<strong>学生姓名</strong>、<strong>学生昵称</strong>、<strong>学生所属(例如XX学院XX系XX班)</strong>、<strong>学生证照片</strong></p> 
<p>因为需求中冻结的状态，所以我们增加一个属性：</p> 
<ul><li>是否冻结：代表学生的借阅状态是否冻结</li></ul> 
<p><img src="https://images2.imgbox.com/65/36/PJPygiu2_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="22__ER_179"></a>2.2 借阅证 E-R图</h4> 
<p>这是一个实体。<br> <img src="https://images2.imgbox.com/e7/9e/HjJNPu2o_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="23__ER_185"></a>2.3 图书 E-R图</h4> 
<p>这是一个实体。</p> 
<p>根据需求得知图书的基本信息包括：<strong>图书编号</strong>、<strong>图书名称</strong>、<strong>图书类型</strong>、<strong>作者</strong>、<strong>图书简介</strong>、<strong>图书封面</strong>、<strong>出版社</strong>、<strong>出版时间</strong></p> 
<p>还有2个引申出来的额外属性：</p> 
<ul><li>是否是新书推荐：这是管理员可以维护的新书推荐的标识</li><li>图书状态：闲置中或借阅中</li></ul> 
<p><img src="https://images2.imgbox.com/61/15/RVwOQWvM_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="24__ER_199"></a>2.4 管理员 E-R图</h4> 
<p>这是一个实体。</p> 
<p><img src="https://images2.imgbox.com/d6/f8/U9Zioa4a_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="25__ER_206"></a>2.5 公告 E-R图</h4> 
<p>这是一个实体。</p> 
<p>根据需求得知公告的基本信息包括：<strong>标题</strong>、<strong>内容</strong>、<strong>发布时间</strong></p> 
<p>有可能被删除，所以还有2个引申出来的额外属性：</p> 
<ul><li>是否已删除：这是管理员删除公告的标识</li><li>删除时间：这是管理员删除公告的时间</li></ul> 
<p><img src="https://images2.imgbox.com/d6/dc/Y9i4MPFH_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="26__ER_220"></a>2.6 申请 E-R图</h4> 
<p>这是一个联系，【学生】和【借阅证】之间存在着【申请】的联系。</p> 
<p><img src="https://images2.imgbox.com/c5/89/5GRvunvF_o.png" alt="在这里插入图片描述"></p> 
<p>【<code>申请</code>】需要【管理员】审批，所以包括如下属性：</p> 
<p><img src="https://images2.imgbox.com/9f/f9/OR3kjqPS_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="27__ER_232"></a>2.7 借阅 E-R图</h4> 
<p>这是一个联系，【学生】和【图书】之间存在着【借阅】的联系。</p> 
<p><img src="https://images2.imgbox.com/4d/f1/qzKppFNj_o.png" alt="在这里插入图片描述"></p> 
<p>【<code>借阅</code>】需要【管理员】审批和归还，所以包括如下属性：</p> 
<p><img src="https://images2.imgbox.com/ed/be/vWILpU0r_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="28__ER_244"></a>2.8 评论 E-R图</h4> 
<p>这是一个联系，【学生】和【图书】之间存在着【评论】的联系。</p> 
<p><img src="https://images2.imgbox.com/5c/4a/CWnBpRh7_o.png" alt="在这里插入图片描述"></p> 
<p>【<code>评论</code>】需要【管理员】审批，所以包括如下属性：</p> 
<p><img src="https://images2.imgbox.com/6d/a9/9ExnHXy8_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="29__ER_256"></a>2.9 收藏 E-R图</h4> 
<p>这是一个联系，【学生】和【图书】之间存在着【收藏】的联系。</p> 
<p><img src="https://images2.imgbox.com/1a/ad/AldbsYBV_o.png" alt="在这里插入图片描述"></p> 
<p>【<code>收藏</code>】不需要【管理员】审批，但可以【取消】，所以包括如下属性：</p> 
<p><img src="https://images2.imgbox.com/8f/63/fP21QNYA_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>公告发布和图书管理都不需要保存记录，所以没有关联的属性。</p> 
</blockquote> 
<h3><a id="3_ER_270"></a>3. 全局E-R图</h3> 
<blockquote> 
 <p>我省略了属性，带颜色的实体和联系需要自行补充属性，根据上面的局部E-R图补充，别偷懒，实际画一下你可能会有更多的领悟！</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/b2/d8/3bi2llkT_o.png" alt="图书借阅系统-全局ER图"></p> 
<hr> 
<h2><a id="_279"></a>三、逻辑结构设计</h2> 
<blockquote> 
 <p>说明：把E-R图转成关系模式。</p> 
</blockquote> 
<h4><a id="31__283"></a>3.1 转换规则</h4> 
<p>一个实体型转换为一个关系模式，有一对一、一对多、多对多的联系。不同的联系转关系模式也不同。</p> 
<ul><li> <p>一对一：两个一对一的实体可以转成两个关系模式，也可以合成成一个关系模式，它们之间的联系可以单独转成一个关系模式，也可以合并到与之关联的任一实体中记录下来。</p> </li><li> <p>一对多：每一个实体还是转成一个关系模式，可以单独把它们之间的联系转成一个关系模式，也可把联系记录到多（N）对应的实体中。</p> </li><li> <p>多对多：每一个实体还是转成一个关系模式，它们之间的联系必须转成一个关系模式。</p> </li></ul> 
<h4><a id="32__293"></a>3.2 关系模式</h4> 
<h5><a id="321__295"></a>3.2.1 按转换规则分析</h5> 
<ul><li> <p>学生-》申请 -》借阅证</p> 
  <ul><li>【<code>学生</code>】实体可以转换为一个关系模式；</li><li>【<code>申请</code>】需要保存记录，所以也可以转换为一个关系模式，<code>并增加【学生编号】属性</code>；</li><li>【学生】和【借阅证】是一对一的联系，因为需求中对【借阅证】没有其它用途，所以我们将【借阅证】合并到【学生】关系模式中，称为<code>【是否申请通过】属性</code>。当然，如果日后有新需求，我们再增加【借阅证】关系模式也不迟。</li></ul> </li><li> <p>学生-》借阅 -》图书</p> 
  <ul><li>【<code>图书</code>】实体可以转换为一个关系模式；</li><li>【<code>借阅</code>】需要保存记录，所以可以转换为一个关系模式，<code>并增加【学生编号】、【图书编号】属性</code>。</li><li>因为【借阅次数】对【图书】是非常常用的查询属性，所以【<code>图书</code>】实体<code>增加【借阅次数】属性</code>。</li></ul> </li><li> <p>学生-》收藏 -》图书</p> 
  <ul><li>【<code>收藏</code>】需要保存记录，所以可以转换为一个关系模式，<code>并增加【学生编号】、【图书编号】属性</code>。</li></ul> </li><li> <p>学生-》评论 -》图书</p> 
  <ul><li>【<code>评论</code>】需要保存记录，所以可以转换为一个关系模式，<code>并增加【学生编号】、【图书编号】属性</code>。</li><li>因为【评论数】对【图书】是非常常用的查询属性，所以【<code>图书</code>】实体<code>增加【评论数】属性</code>。</li></ul> </li><li> <p>管理员-》发布 -》公告</p> 
  <ul><li>【<code>管理员</code>】和【<code>公告</code>】两个实体可以转换为两个关系模式，因为是一对多的联系，【公告】为多的一方，所以将<code>【管理员编号】属性保存到【公告】</code>中。</li><li>【发布】不需要保存记录，所以不需要转换。</li><li><code>注意：</code>管理员和学生，都属于用户，所以我们将管理员和学生抽象成【<code>用户</code>】，并且管理员并没有属性，所以只做为【用户】的一个角色，【学生】<code>增加【用户编号】属性</code>。</li></ul> </li><li> <p>管理员-》管理 -》图书</p> 
  <ul><li>【管理】不需要保存记录，所以不需要转换。</li></ul> </li></ul> 
<h5><a id="322__322"></a>3.2.2 实际转换结果</h5> 
<blockquote> 
 <p>根据以上规则和分析得到如下<strong>8个</strong>关系模型（红色字体的属性为主码）</p> 
</blockquote> 
<ul><li><strong>用户表：</strong> <code>用户编号</code>、用户名、密码、角色(0-学生 1-管理员)</li><li><strong>学生表：</strong> <code>学生编号</code>、用户编号、学生姓名、学生昵称、学生所属、学生证图片、是否申请通过(0-未通过 1-通过)、是否冻结(0-正常 1-冻结)</li><li><strong>借阅证申请记录表：</strong> <code>申请编号</code>、学生编号、申请时间、管理员操作时间、申请状态(0-待审核 1-通过 2-驳回)、驳回原因、管理员编号</li><li><strong>图书表：</strong> <code>图书编号</code>、图书名称、图书类型、作者、图书简介、图书封面、出版社、出版时间、图书状态(0-闲置 1-借阅中)、是否是新书推荐(0-否 1-是) 、借阅次数、评论数</li><li><strong>图书借阅记录表：</strong> <code>借阅记录编号</code>、学生编号、图书编号、借阅时间、借阅状态(0-待审核 1-ok 2-拒绝 3-已还)、拒绝原因、审核时间、归还时间、管理员编号</li><li><strong>图书收藏表：</strong> <code>收藏编号</code>、学生编号、图书编号、收藏时间、是否已取消、取消时间</li><li><strong>图书评论表：</strong> <code>评论编号</code>、学生编号、图书编号、评分(1,2,3,4,5)、评论内容、评论时间、审核状态(0-待审核 1-通过 2-驳回)、管理员编号</li><li><strong>公告表：</strong> <code>公告编号</code>、标题、内容、发布时间、是否已删除、删除时间、管理员编号</li></ul> 
<p><img src="https://images2.imgbox.com/c3/0c/D50JfcFr_o.png" alt="图书借阅系统-全局类图"></p> 
<blockquote> 
 <p>对8个表之间的关系分析如下：</p> 
</blockquote> 
<ul><li><strong>学生与用户</strong></li></ul> 
<p>1名学生，即是1个用户，所以<strong>学生与用户</strong>之间是<strong>1对1</strong>(1 : 1)关系;</p> 
<ul><li><strong>[学生/管理员]与[借阅证申请记录]</strong></li></ul> 
<p>1名学生，可以发起N次借阅证申请(存在不通过再次申请的情况)，而1次借阅证申请只能由1名学生发起，所以<strong>学生与借阅证申请记录</strong>之间是<strong>1对多</strong>(1 : n)关系;</p> 
<p>1名管理员，可以对N次借阅证申请审批，而1次借阅证申请只能由1名管理员审批，所以<strong>管理员与借阅证申请记录</strong>之间是<strong>1对多</strong>(1 : n)关系;</p> 
<ul><li><strong>[学生/管理员]与[图书借阅记录]</strong></li></ul> 
<p>1名学生，可以发起N次借阅，而1次借阅只能由1名学生发起，所以<strong>学生与图书借阅记录</strong>之间是<strong>1对多</strong>(1 : n)关系;</p> 
<p>1名管理员，可以对N次借阅审批，而1次借阅只能由1名管理员审批，所以<strong>管理员与图书借阅记录</strong>之间是<strong>1对多</strong>(1 : n)关系;</p> 
<p>1本图书，可以被N次借阅，而1次借阅只能针对1本图书，所以<strong>图书与图书借阅记录</strong>之间是<strong>1对多</strong>(1 : n)关系。</p> 
<blockquote> 
 <p>注意：如果1次可以借N本图书的话，那么<strong>图书与图书借阅记录</strong>之间将是<strong>多对多</strong>(m : n)关系</p> 
</blockquote> 
<ul><li><strong>[学生/管理员]与[图书评论]</strong></li></ul> 
<p>1名学生，可以发起N条评论，而1条评论只能由1名学生发起，所以<strong>学生与评论</strong>之间是<strong>1对多</strong>(1 : n)关系;</p> 
<p>1名管理员，可以对N条评论审批，而1条评论只能由1名管理员审批，所以<strong>管理员与评论</strong>之间是<strong>1对多</strong>(1 : n)关系;</p> 
<p>1本图书，可以有N条评论，而1条评论只能针对1本图书，所以<strong>图书与评论</strong>之间是<strong>1对多</strong>(1 : n)关系;</p> 
<ul><li><strong>学生与图书收藏</strong></li></ul> 
<p>1名学生，可以收藏N本图书，而1次收藏只能属于1名学生，所以<strong>学生与收藏</strong>之间是<strong>1对多</strong>(1 : n)关系;</p> 
<p>1本图书，可以被不同学生收藏N次，而1次收藏只能针对1本图书，所以<strong>图书与图书收藏</strong>之间是<strong>1对多</strong>(1 : n)关系;</p> 
<ul><li><strong>管理员与公告</strong></li></ul> 
<p>1名管理员，可以发布N条公告，而1个公告只能由1名管理员发布，所以<strong>管理员与公告</strong>之间是<strong>1对多</strong>(1 : n)关系;</p> 
<h4><a id="33__378"></a>3.3 表结构</h4> 
<ul><li><strong>用户表：</strong></li></ul> 
<p><img src="https://images2.imgbox.com/f7/84/1vgLXGPm_o.png" alt="在这里插入图片描述"></p> 
<ul><li><strong>学生表：</strong></li></ul> 
<p><img src="https://images2.imgbox.com/b5/47/lS46yPWh_o.png" alt="在这里插入图片描述"></p> 
<ul><li><strong>图书表：</strong></li></ul> 
<p><img src="https://images2.imgbox.com/47/59/0Bobko8x_o.png" alt="在这里插入图片描述"></p> 
<ul><li><strong>公告表：</strong></li></ul> 
<p><img src="https://images2.imgbox.com/11/75/r2UjWTT6_o.png" alt="在这里插入图片描述"></p> 
<ul><li><strong>借阅证申请记录表：</strong></li></ul> 
<p><img src="https://images2.imgbox.com/46/57/V5i311uf_o.png" alt="在这里插入图片描述"></p> 
<ul><li><strong>图书借阅记录表：</strong></li></ul> 
<p><img src="https://images2.imgbox.com/3d/f0/htr9vyjt_o.png" alt="在这里插入图片描述"></p> 
<ul><li><strong>图书评论表：</strong></li></ul> 
<p><img src="https://images2.imgbox.com/b8/9a/GjcXKHo8_o.png" alt="在这里插入图片描述"></p> 
<ul><li><strong>图书收藏表：</strong></li></ul> 
<p><img src="https://images2.imgbox.com/0b/da/fpTtd7qg_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h2><a id="_422"></a>四、物理结构设计与实施</h2> 
<p>使用MySQL数据库，InnoDB存储引擎。</p> 
<h4><a id="41__426"></a>4.1 创建数据库</h4> 
<p>显示指定字符集为：utf8mb4，支持表情。</p> 
<p><code>数据库命名规则</code>：只包含小写字母和下划线，且以小写字母开头</p> 
<pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> <span class="token identifier"><span class="token punctuation">`</span>db_book<span class="token punctuation">`</span></span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> <span class="token string">'utf8mb4'</span> <span class="token keyword">COLLATE</span> <span class="token string">'utf8mb4_general_ci'</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="42__436"></a>4.2 创建数据表</h4> 
<p>显示指定字符集为：utf8mb4，支持表情。</p> 
<p><code>表和字段命名规则</code>：（参考《阿里巴巴手册 - 泰山版》）</p> 
<ul><li> <p>只包含小写字母和下划线，且以小写字母开头</p> </li><li> <p>针对不用分库分表的场景，主键命名为id，且为自增AUTO_INCREMENT</p> </li><li> <p>任何字段如果为非负数，必须是 unsigned</p> </li><li> <p>表名不使用复数名词</p> </li><li> <p>表必备三字段：id, gmt_create, gmt_modified。gmt_create 创建时间, gmt_modified 更新时间，类型均为 datetime 类型，前者现在时表示主动式创建，后者过去分词表示被动式更新</p> </li><li> <p>小数类型为 decimal，禁止使用 float 和 double</p> </li><li> <p>禁用保留字，请参考 MySQL 官方保留字</p> </li><li> <p>禁止使用外键</p> </li><li> <p>禁止使用存储过程</p> </li></ul> 
<p><img src="https://images2.imgbox.com/6e/74/Vrmz5pLY_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">SET</span> NAMES utf8mb4<span class="token punctuation">;</span>
<span class="token keyword">SET</span> FOREIGN_KEY_CHECKS <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment">-- ----------------------------</span>
<span class="token comment">-- Table structure for user</span>
<span class="token comment">-- ----------------------------</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span>  <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">UNSIGNED</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户编号'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>user_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_general_ci <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户名'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>password<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_general_ci <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'密码'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>role<span class="token punctuation">`</span></span> <span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">UNSIGNED</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'角色(0-学生 1-管理员)'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_create<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'创建时间'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_modified<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'修改时间'</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token operator">=</span> <span class="token number">3</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> <span class="token operator">=</span> utf8mb4 <span class="token keyword">COLLATE</span> <span class="token operator">=</span> utf8mb4_general_ci ROW_FORMAT <span class="token operator">=</span> Dynamic<span class="token punctuation">;</span>

<span class="token comment">-- ----------------------------</span>
<span class="token comment">-- Table structure for student</span>
<span class="token comment">-- ----------------------------</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>student<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>student<span class="token punctuation">`</span></span>  <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">UNSIGNED</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'学生编号'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">UNSIGNED</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户编号'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>student_no<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_general_ci <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'学生编号'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>student_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_general_ci <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'学生姓名'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_general_ci <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'学生昵称'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>department<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_general_ci <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'学生所属(例如XX学院XX系XX班)'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>id_card_image<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_general_ci <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span> <span class="token keyword">COMMENT</span> <span class="token string">'学生证照片'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>is_approved<span class="token punctuation">`</span></span> <span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">UNSIGNED</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span> <span class="token keyword">COMMENT</span> <span class="token string">'是否申请通过(0-未通过 1-通过)'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>is_frozen<span class="token punctuation">`</span></span> <span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">UNSIGNED</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span> <span class="token keyword">COMMENT</span> <span class="token string">'是否冻结(0-正常 1-冻结)'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_create<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'创建时间'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_modified<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'修改时间'</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> <span class="token operator">=</span> utf8mb4 <span class="token keyword">COLLATE</span> <span class="token operator">=</span> utf8mb4_general_ci ROW_FORMAT <span class="token operator">=</span> Dynamic<span class="token punctuation">;</span>

<span class="token comment">-- 剩余6张表的完整代码，请私信我、或添加文章底部微信联系我</span>

<span class="token keyword">SET</span> FOREIGN_KEY_CHECKS <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="43__498"></a>4.3 初始化数据</h4> 
<p>只需要初始化添加管理员账号用户即可。</p> 
<pre><code class="prism language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'admin'</span><span class="token punctuation">,</span><span class="token string">'2469c47aa7b758eefff3d75939b20c7b'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<hr> 
<h2><a id="_508"></a>五、具体业务分析</h2> 
<h3><a id="51__510"></a>5.1 录入图书</h3> 
<p>录入四大名著</p> 
<pre><code class="prism language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>book<span class="token punctuation">`</span></span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'ts_00001'</span><span class="token punctuation">,</span> <span class="token string">'西游记'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'吴承恩'</span><span class="token punctuation">,</span> <span class="token string">'《西游记》主要描写了孙悟空、猪八戒、沙僧三人保护唐僧西行取经，唐僧从投胎到取经归来共遇到八十一难，一路降妖伏魔，化险为夷，最后到达西天、取得真经的故事。'</span><span class="token punctuation">,</span><span class="token string">'xxx出版社'</span><span class="token punctuation">,</span><span class="token string">'1990-10-10'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'2023-04-07 00:00:10'</span><span class="token punctuation">,</span> <span class="token string">'2023-04-07 00:00:10'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>book<span class="token punctuation">`</span></span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'ts_00002'</span><span class="token punctuation">,</span> <span class="token string">'三国演义'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'罗贯中'</span><span class="token punctuation">,</span> <span class="token string">'《三国演义》可大致分为黄巾起义、董卓之乱、群雄逐鹿、三国鼎立、三国归晋五大部分，描写了从东汉末年到西晋初年之间近百年的历史风云，以描写战争为主，诉说了东汉末年的群雄割据混战和魏、蜀、吴三国之间的政治和军事斗争，最终司马炎一统三国，建立晋朝的故事。'</span><span class="token punctuation">,</span><span class="token string">'xxx出版社'</span><span class="token punctuation">,</span><span class="token string">'1993-10-10'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'2023-04-07 00:00:10'</span><span class="token punctuation">,</span> <span class="token string">'2023-04-07 00:00:10'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>book<span class="token punctuation">`</span></span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'ts_00003'</span><span class="token punctuation">,</span> <span class="token string">'水浒传'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'施耐庵'</span><span class="token punctuation">,</span> <span class="token string">'《水浒传》是第一部描写农民起义的小说，全书围绕“官逼民反”这一线索展开情节，表现了一群不堪暴政欺压的“好汉”揭杆而起，聚义水泊梁山，直至接受招安致使起义失败的全过程。'</span><span class="token punctuation">,</span><span class="token string">'xxx出版社'</span><span class="token punctuation">,</span><span class="token string">'1995-10-10'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'2023-04-07 00:00:10'</span><span class="token punctuation">,</span> <span class="token string">'2023-04-07 00:00:10'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>book<span class="token punctuation">`</span></span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'ts_00004'</span><span class="token punctuation">,</span> <span class="token string">'红楼梦'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'曹雪芹'</span><span class="token punctuation">,</span> <span class="token string">'《红楼梦》是以贾、史、王、薛四大家族的兴衰为背景，以富贵公子贾宝玉为视角，以贾宝玉与林黛玉、薛宝钗的爱情婚姻悲剧为主线，描绘了一些闺阁佳人的人生百态，展现了真正的人性美和悲剧美，是一部从各个角度展现女性美以及中国古代社会百态的史诗性著作。'</span><span class="token punctuation">,</span><span class="token string">'xxx出版社'</span><span class="token punctuation">,</span><span class="token string">'1992-10-10'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'2023-04-07 00:00:10'</span><span class="token punctuation">,</span> <span class="token string">'2023-04-07 00:00:10'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="52____521"></a>5.2 学生注册 + 申请借阅证</h3> 
<h4><a id="521__523"></a>5.2.1 注册</h4> 
<pre><code class="prism language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'1032975@qq.com'</span><span class="token punctuation">,</span> <span class="token string">'2469c47aa7b758eefff3d75939b20c7b'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="522__529"></a>5.2.2 填写学生信息，申请借阅证</h4> 
<pre><code class="prism language-sql"><span class="token comment">-- 填写学生信息</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>student<span class="token punctuation">`</span></span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'s_00001'</span><span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token string">'better man'</span><span class="token punctuation">,</span> <span class="token string">'XX学院XX系XX班'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'2023-04-08 00:00:00'</span><span class="token punctuation">,</span> <span class="token string">'2023-04-08 00:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- student_id=1的学生，申请借阅证</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>qualification<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>student_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>status<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>verify_time<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>verify_user_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>reject_reason<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>gmt_create<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>gmt_modified<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">'2023-04-08 00:00:00'</span><span class="token punctuation">,</span> <span class="token string">'2023-04-08 00:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="53__538"></a>5.3 管理员审核借阅证通过</h3> 
<pre><code class="prism language-sql"><span class="token comment">-- verify_user_id=1的管理员，审批通过 申请借阅证记录id=1的申请，status=1审批通过</span>
<span class="token keyword">update</span> qualification <span class="token keyword">set</span> <span class="token identifier"><span class="token punctuation">`</span>status<span class="token punctuation">`</span></span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> 
verify_time <span class="token operator">=</span><span class="token string">'2023-04-08 00:10:00'</span><span class="token punctuation">,</span> 
verify_user_id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> 
gmt_modified <span class="token operator">=</span> <span class="token string">'2023-04-08 00:10:00'</span> 
<span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token comment">-- 让id=1学生，拥有借阅资格，is_approved = 1为有借阅资格</span>
<span class="token keyword">update</span> student <span class="token keyword">set</span> is_approved <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> 
gmt_modified <span class="token operator">=</span> <span class="token string">'2023-04-08 00:10:00'</span> 
<span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="54__553"></a>5.4 搜索图书</h3> 
<p>例如：按图书类型和名称搜索</p> 
<p>展示字段包括：<strong>图书名称</strong>、<strong>图书封面</strong>、<strong>借阅次数</strong>、<strong>评论条数</strong></p> 
<p>按借阅次数倒序，分页从第0条开始，取10条</p> 
<pre><code>select id, book_name, cover_image, borrow_count, comment_count from book
where book_type = 1 and book_name LIKE '红%'
order by borrow_count desc
limit 0,10
</code></pre> 
<p>按出版时间正序，分页从第20条开始，取10条</p> 
<pre><code>select id, book_name, cover_image, borrow_count, comment_count from book
where book_type = 1 and book_name LIKE '三%'
order by publish_date
limit 20,10
</code></pre> 
<h3><a id="55__577"></a>5.5 查看图书详情</h3> 
<p>展示字段包括：<strong>查看图书基本信息、我是否收藏、图书评论</strong></p> 
<pre><code class="prism language-sql"><span class="token comment">-- id=1的图书基本信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> book <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token comment">-- student_id=1的学生，对book_id=1的图书，未取消收藏 的 收藏记录</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> book_favorite 
<span class="token keyword">where</span> book_id <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">and</span> student_id <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">and</span> is_cancelled <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token comment">-- student_id=1的学生，对book_id=1的图书，审核通过 的 评论，按创建时间倒序</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> book_comment 
<span class="token keyword">where</span> book_id <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">and</span> student_id <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">and</span> <span class="token identifier"><span class="token punctuation">`</span>status<span class="token punctuation">`</span></span> <span class="token operator">=</span> <span class="token number">1</span> 
<span class="token keyword">order</span> <span class="token keyword">by</span> gmt_create <span class="token keyword">desc</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="56____593"></a>5.6 图书收藏 和 取消收藏</h3> 
<h4><a id="561__595"></a>5.6.1 收藏</h4> 
<p>student_id=1的学生，收藏 book_id=1的图书</p> 
<pre><code class="prism language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> book_favorite<span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>student_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>book_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>favorite_time<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>is_cancelled<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>cancel_time<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>gmt_create<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>gmt_modified<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'2023-04-08 00:10:00'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'2023-04-08 00:10:00'</span><span class="token punctuation">,</span> <span class="token string">'2023-04-08 00:10:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="562__603"></a>5.6.2 取消收藏</h4> 
<p>student_id=1的学生，取消收藏 book_id=1的图书</p> 
<pre><code class="prism language-sql"><span class="token keyword">update</span> book_favorite 
<span class="token keyword">set</span> is_cancelled <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> cancel_time <span class="token operator">=</span> <span class="token string">'2023-04-08 02:10:00'</span>
<span class="token keyword">where</span> book_id <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">and</span> student_id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="57____613"></a>5.7 图书评论 和 审核评论</h3> 
<h4><a id="571__615"></a>5.7.1 评论</h4> 
<p>student_id=1的学生，评论 book_id=1的图书：status=0待审批</p> 
<pre><code class="prism language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>book_comment<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>student_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>book_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>score<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>comment<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>status<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>gmt_create<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>gmt_modified<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'好书值得推荐'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'2023-04-08 00:10:00'</span><span class="token punctuation">,</span> <span class="token string">'2023-04-08 00:10:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="572__623"></a>5.7.2 审核评论</h4> 
<p>verify_user_id=1的管理员，审核id=1的评论： status = 1审批通过</p> 
<p><code>审批后, 图书评论次数+1</code></p> 
<pre><code class="prism language-sql"><span class="token keyword">update</span> book_comment 
<span class="token keyword">set</span> <span class="token identifier"><span class="token punctuation">`</span>status<span class="token punctuation">`</span></span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> 
verify_time <span class="token operator">=</span> <span class="token string">'2023-04-08 03:10:00'</span><span class="token punctuation">,</span>
verify_user_id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
gmt_modified <span class="token operator">=</span> <span class="token string">'2023-04-08 03:10:00'</span>
<span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token comment">-- 审批后, 图书评论次数+1</span>
<span class="token keyword">update</span> book
comment_count <span class="token operator">=</span> comment_count<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>
gmt_modified <span class="token operator">=</span> <span class="token string">'2023-04-08 03:10:00'</span>
<span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="58____643"></a>5.8 借阅 和 借阅审核</h3> 
<h4><a id="581__645"></a>5.8.1 借阅</h4> 
<p>student_id=1的学生，借阅 book_id=1的图书</p> 
<pre><code class="prism language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>book_borrowing<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>student_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>book_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>borrow_time<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>status<span class="token punctuation">`</span></span><span class="token punctuation">,</span>  <span class="token identifier"><span class="token punctuation">`</span>gmt_create<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>gmt_modified<span class="token punctuation">`</span></span><span class="token punctuation">)</span> 
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'2023-04-08 03:10:00'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'2023-04-08 03:10:00'</span><span class="token punctuation">,</span> <span class="token string">'2023-04-08 03:10:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="582__654"></a>5.8.2 借阅审核</h4> 
<p>verify_user_id=1的管理员，审核 id=1的借阅记录： status=1通过审批</p> 
<p><code>审批后, 图书借阅次数+1</code></p> 
<pre><code class="prism language-sql"><span class="token keyword">update</span> book_borrowing 
<span class="token keyword">set</span> <span class="token identifier"><span class="token punctuation">`</span>status<span class="token punctuation">`</span></span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
verify_time <span class="token operator">=</span> <span class="token string">'2023-04-08 04:10:00'</span><span class="token punctuation">,</span>
verify_user_id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
gmt_modified <span class="token operator">=</span> <span class="token string">'2023-04-08 04:10:00'</span>
<span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token comment">-- 审批后, 图书借阅次数+1，状态置为借阅中</span>
<span class="token keyword">update</span> book
<span class="token keyword">set</span> <span class="token keyword">status</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
borrow_count <span class="token operator">=</span> borrow_count<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>
gmt_modified <span class="token operator">=</span> <span class="token string">'2023-04-08 04:10:00'</span>
<span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="583__675"></a>5.8.3 归还</h4> 
<p>id=1的借阅记录，书已归还：status = 3归还</p> 
<p><code>归还后, 更新图书状态为空闲</code></p> 
<pre><code class="prism language-sql"><span class="token keyword">update</span> book_borrowing 
<span class="token keyword">set</span> <span class="token identifier"><span class="token punctuation">`</span>status<span class="token punctuation">`</span></span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span>
return_time <span class="token operator">=</span> <span class="token string">'2023-04-18 05:10:00'</span><span class="token punctuation">,</span>
gmt_modified <span class="token operator">=</span> <span class="token string">'2023-04-18 05:10:00'</span>
<span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token comment">-- 归还后, 更新图书状态为空闲</span>
<span class="token keyword">update</span> book
<span class="token keyword">set</span> <span class="token keyword">status</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
gmt_modified <span class="token operator">=</span> <span class="token string">'2023-04-18 05:10:00'</span>
<span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> 
<hr> 
<h2><a id="_696"></a>参考</h2> 
<p><a href="https://blog.csdn.net/Artificial_idiots/article/details/106830628">https://blog.csdn.net/Artificial_idiots/article/details/106830628</a><br> <a href="https://blog.csdn.net/weixin_44584292/article/details/106636642">https://blog.csdn.net/weixin_44584292/article/details/106636642</a></p> 
<hr> 
<h2><a id="_702"></a>最后</h2> 
<p>本篇数据库设计花了很长时间来润笔，另外，还征求了大学生朋友的建议，这里特别感谢<a href="https://blog.csdn.net/qq_53317005">会洗碗的CV工程师</a>为我提供了课设的相关资料，更为本文提供了很多建设性的建议，希望能在实战的同时能给大学生朋友更多的帮助，如果有任何建议和意见，也欢迎大家留言或私信，我计划将持续更新，目的只为打造精品，互相切磋，共同成长！能让大家通过这一篇数据库设计，学到<font face="幼圆" color="#FF3366" size="4"><strong>实战中设计技巧</strong></font>！当然，这只是一个小小的系统，有很多设计技巧还无法体现，一个合理的设计非常重要，可以支撑更大的业务场景，所以仅以本设计抛转引玉，后面有机会我们可以拿更多的<font face="幼圆" color="#FF3366" size="4"><strong>场景或系统</strong></font>来设计，如果你有需求，也可以找我来设计，我尽可能满足！</p> 
<p>想学习更多实战真东西的，欢迎点击链接订阅：</p> 
<p><font face="幼圆" color="#FF3366" size="4"><strong>服务端实战</strong></font> ：<a href="https://blog.csdn.net/scm_2008/category_12236048.html">SpringBoot+Vue前后端分离项目实战</a><br> <font face="幼圆" color="#FF3366" size="4"><strong>前端实战</strong></font> ：<a href="https://blog.csdn.net/xingyu_qie/category_12222258.html">Vue + SpringBoot前后端分离项目实战</a></p> 
<p>另外，别忘了关注：<a href="https://blog.csdn.net/scm_2008">天罡gg</a> ，发布新文不容易错过： https://blog.csdn.net/scm_2008</p> 
<p>老规矩，请投票给我反馈，谢谢大家的支持！</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bad5efe9e26af706f424f4921d5a372c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Stable Diffusion Lora模型训练详细教程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/314170057dd28849c3c26b3b5162406a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Android Studio初学者实例：Fragment学习--仿美团外卖界面</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>