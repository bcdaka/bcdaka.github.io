<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>[联邦学习]FedProx算法&amp;&amp;工作原理&amp;&amp;步骤 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/bec61d920006f5be432b08b8007c50f8/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="[联邦学习]FedProx算法&&工作原理&&步骤">
  <meta property="og:description" content="[联邦学习]FedProx FedProx（Federalized Proximal Algorithm）是一种在联邦学习（Federated Learning, FL）环境下设计的优化算法，旨在处理数据在不同客户端之间可能存在的不均匀分布（Non-IID Data）的问题。联邦学习是一种机器学习设置，允许多个客户端协作训练一个共享的模型，同时保持数据的隐私和安全，因为数据不需要集中存储或处理。
FedProx是Li Tian等人于2018年(论文链接)所提出的一种针对系统异构性鲁棒的联邦优化算法，发表于MLSys 2020上。它相较于FedAvg主要做出了两点改进：
采样阶段 使用了按数据集大小比例，可放回采样，并直接平均聚合（无加权）来获得无偏梯度估计
本地训练阶段 基于近端项优化的思路，魔改了本地训练的目标函数为
L &#43; μ 2 ∣ ∣ w k , i t − w g l o b a l ∣ ∣ 2 L &#43; \frac{\mu}{2}||w^t_{k,i} - w_{global}||^2 L&#43;2μ​∣∣wk,it​−wglobal​∣∣2
&#34;采样&#34;指的是服务器从参与方（客户端）的数据集中选择样本进行模型更新。因此，在FedProx中，采样是服务器在每轮迭代中从参与方的数据集中按照每个参与方数据集大小的比例进行选择的过程。具体来说，如果某个参与方的数据集更大，则它在采样中被选中的概率更高。
因此，这里的&#34;采样&#34;是指服务器在联邦学习中选择参与方的过程，而不是指参与方选择自己的数据的过程。
背景和问题 在标准的联邦学习模型中，如FedAvg（Federated Averaging），每个客户端独立地在本地数据上训练模型，然后将更新的模型发送给中央服务器。服务器将这些更新平均合并，以更新全局模型。然而，当不同客户端的数据分布差异很大时（即Non-IID），这种简单的平均可能导致模型性能下降，因为它没有考虑到各客户端更新的差异性。
FedProx的工作原理 FedProx在FedAvg的基础上增加了一个正则化项，这个正则化项惩罚模型参数与全局模型参数之间的偏差。具体来说，FedProx的目标是最小化以下目标函数：
L ( w ) = ∑ k = 1 K n k n ( F k ( w ) &#43; μ 2 ∣ w − w t ∣ 2 ) L(w) = \sum_{k=1}^K \frac{n_k}{n} \left( F_k(w) &#43; \frac{\mu}{2} |w - w^t|^2 \right) L(w)=k=1∑K​nnk​​(Fk​(w)&#43;2μ​∣w−wt∣2)">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-28T21:51:38+08:00">
    <meta property="article:modified_time" content="2024-05-28T21:51:38+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">[联邦学习]FedProx算法&amp;&amp;工作原理&amp;&amp;步骤</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="FedProx_1"></a>[联邦学习]FedProx</h2> 
<p>FedProx（Federalized Proximal Algorithm）是一种在联邦学习（Federated Learning, FL）环境下设计的优化算法，旨在处理数据在不同客户端之间可能存在的不均匀分布（Non-IID Data）的问题。联邦学习是一种机器学习设置，允许多个客户端协作训练一个共享的模型，同时保持数据的隐私和安全，因为数据不需要集中存储或处理。</p> 
<p>FedProx是Li Tian等人于2018年(论文链接)所提出的一种针对系统异构性鲁棒的联邦优化算法，发表于MLSys 2020上。它相较于FedAvg主要做出了两点改进：</p> 
<p>采样阶段 使用了按数据集大小比例，可放回采样，并直接平均聚合（无加权）来获得无偏梯度估计<br> 本地训练阶段 基于近端项优化的思路，魔改了本地训练的目标函数为</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          L 
         
        
          + 
         
         
         
           μ 
          
         
           2 
          
         
        
          ∣ 
         
        
          ∣ 
         
         
         
           w 
          
          
          
            k 
           
          
            , 
           
          
            i 
           
          
         
           t 
          
         
        
          − 
         
         
         
           w 
          
          
          
            g 
           
          
            l 
           
          
            o 
           
          
            b 
           
          
            a 
           
          
            l 
           
          
         
        
          ∣ 
         
         
         
           ∣ 
          
         
           2 
          
         
        
       
         L + \frac{\mu}{2}||w^t_{k,i} - w_{global}||^2 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.7936em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.1076em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">μ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∣∣</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8436em;"><span class="" style="top: -2.453em; margin-left: -0.0269em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3831em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.1502em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: -0.0269em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">g</span><span class="mord mathnormal mtight" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight" style="margin-right: 0.0197em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>"采样"指的是服务器从参与方（客户端）的数据集中选择样本进行模型更新。因此，在FedProx中，采样是服务器在每轮迭代中从参与方的数据集中按照每个参与方数据集大小的比例进行选择的过程。具体来说，如果某个参与方的数据集更大，则它在采样中被选中的概率更高。</p> 
<p>因此，这里的"采样"是指服务器在联邦学习中选择参与方的过程，而不是指参与方选择自己的数据的过程。</p> 
<h3><a id="_19"></a>背景和问题</h3> 
<p>在标准的联邦学习模型中，如FedAvg（Federated Averaging），每个客户端独立地在本地数据上训练模型，然后将更新的模型发送给中央服务器。服务器将这些更新平均合并，以更新全局模型。然而，当不同客户端的数据分布差异很大时（即Non-IID），这种简单的平均可能导致模型性能下降，因为它没有考虑到各客户端更新的差异性。</p> 
<h3><a id="FedProx_22"></a>FedProx的工作原理</h3> 
<p>FedProx在FedAvg的基础上增加了一个正则化项，这个正则化项惩罚模型参数与全局模型参数之间的偏差。具体来说，FedProx的目标是最小化以下目标函数：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          L 
         
        
          ( 
         
        
          w 
         
        
          ) 
         
        
          = 
         
         
         
           ∑ 
          
          
          
            k 
           
          
            = 
           
          
            1 
           
          
         
           K 
          
         
         
          
          
            n 
           
          
            k 
           
          
         
           n 
          
         
         
         
           ( 
          
          
          
            F 
           
          
            k 
           
          
         
           ( 
          
         
           w 
          
         
           ) 
          
         
           + 
          
          
          
            μ 
           
          
            2 
           
          
         
           ∣ 
          
         
           w 
          
         
           − 
          
          
          
            w 
           
          
            t 
           
          
          
          
            ∣ 
           
          
            2 
           
          
         
           ) 
          
         
        
       
         L(w) = \sum_{k=1}^K \frac{n_k}{n} \left( F_k(w) + \frac{\mu}{2} |w - w^t|^2 \right) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3.1304em; vertical-align: -1.3021em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.8283em;"><span class="" style="top: -1.8479em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0715em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.3021em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.1076em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.1076em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">μ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8436em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span></span></span></span></span></span></p> 
<p>其中：</p> 
<ul><li><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           ( 
          
         
           w 
          
         
           ) 
          
         
           是模型参数。 
          
         
        
          ( w ) 是模型参数。 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="mclose">)</span><span class="mord cjk_fallback">是模型参数。</span></span></span></span></span></span></li><li><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           ( 
          
         
           K 
          
         
           ) 
          
         
           是客户端的数量。 
          
         
        
          ( K ) 是客户端的数量。 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0715em;">K</span><span class="mclose">)</span><span class="mord cjk_fallback">是客户端的数量。</span></span></span></span></span></span></li><li><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           ( 
          
          
          
            n 
           
          
            k 
           
          
         
           ) 
          
         
           是第 
          
         
           ( 
          
         
           k 
          
         
           ) 
          
         
           个客户端的数据点数。 
          
         
        
          ( n_k ) 是第 ( k ) 个客户端的数据点数。 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mord cjk_fallback">是第</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span><span class="mclose">)</span><span class="mord cjk_fallback">个客户端的数据点数。</span></span></span></span></span></span></li><li><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           ( 
          
         
           n 
          
         
           ) 
          
         
           是所有客户端的数据点总数。 
          
         
        
          ( n ) 是所有客户端的数据点总数。 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mord cjk_fallback">是所有客户端的数据点总数。</span></span></span></span></span></span></li><li><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           ( 
          
          
          
            F 
           
          
            k 
           
          
         
           ( 
          
         
           w 
          
         
           ) 
          
         
           ) 
          
         
           是第 
          
         
           ( 
          
         
           k 
          
         
           ) 
          
         
           个客户端上的损失函数。 
          
         
        
          ( F_k(w) ) 是第 ( k ) 个客户端上的损失函数。 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="mclose">))</span><span class="mord cjk_fallback">是第</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span><span class="mclose">)</span><span class="mord cjk_fallback">个客户端上的损失函数。</span></span></span></span></span></span></li><li><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           ( 
          
         
           μ 
          
         
           ) 
          
         
           是正则化参数，控制本地更新与全局模型之间一致性的强度。 
          
         
        
          ( \mu ) 是正则化参数，控制本地更新与全局模型之间一致性的强度。 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">μ</span><span class="mclose">)</span><span class="mord cjk_fallback">是正则化参数，控制本地更新与全局模型之间一致性的强度。</span></span></span></span></span></span></li><li><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           ( 
          
          
          
            w 
           
          
            t 
           
          
         
           ) 
          
         
           是当前全局模型的参数。 
          
         
        
          ( w^t ) 是当前全局模型的参数。 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0936em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8436em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord cjk_fallback">是当前全局模型的参数。</span></span></span></span></span></span></li></ul> 
<p>目标函数的第一部分 <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          ( 
         
         
         
           ∑ 
          
          
          
            k 
           
          
            = 
           
          
            1 
           
          
         
           K 
          
         
         
         
           p 
          
         
           k 
          
         
         
         
           F 
          
         
           k 
          
         
        
          ( 
         
        
          w 
         
        
          ) 
         
        
          ) 
         
        
       
         (\sum_{k=1}^K p_k F_k(w)) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 3.1304em; vertical-align: -1.3021em;"></span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.8283em;"><span class="" style="top: -1.8479em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0715em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.3021em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="mclose">))</span></span></span></span></span></span>代表了在所有客户端上的加权平均损失，这保证了模型优化不只是在某个特定客户端上表现良好，而是在所有参与的客户端上都尽可能有效。</p> 
<p>第二部分 <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          ( 
         
         
         
           μ 
          
         
           2 
          
         
        
          ∣ 
         
        
          w 
         
        
          − 
         
         
         
           w 
          
         
           t 
          
         
         
         
           ∣ 
          
         
           2 
          
         
        
          ) 
         
        
       
         (\frac{\mu}{2} |w - w^t|^2) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.7936em; vertical-align: -0.686em;"></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.1076em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">μ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.1141em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8436em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span> 则确保了在每一轮训练中，本地更新的模型参数不会偏离过大于初始的全局模型参数<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          ( 
         
         
         
           w 
          
         
           t 
          
         
        
          ) 
         
        
       
         ( w^t ) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0936em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8436em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span>，这在通信受限或客户端数据不均匀的情况下尤其重要。</p> 
<p>通过这种方式，FedProx算法旨在改善标准联邦学习方法（如FedAvg）在处理非独立同分布（non-IID）数据或客户端之间计算能力、数据量不一致时的效率和效果。</p> 
<h3><a id="_45"></a>步骤</h3> 
<p>FedProx的核心是引入了一个正则化项，这个正则化项惩罚模型参数偏离初始全局模型参数的程度，以此来控制模型的本地更新。具体步骤如下：</p> 
<p>1.初始化模型：</p> 
<ul><li><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           中央服务器初始化全局模型参数 
          
         
           ( 
          
          
          
            w 
           
          
            0 
           
          
         
           ) 
          
         
           。 
          
         
        
          中央服务器初始化全局模型参数 ( w^0 )。 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.1141em; vertical-align: -0.25em;"></span><span class="mord cjk_fallback">中央服务器初始化全局模型参数</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord cjk_fallback">。</span></span></span></span></span></span></li></ul> 
<p>2.广播模型：</p> 
<ul><li><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           选择一部分客户端，并向这些客户端发送当前的全局模型参数 
          
         
           ( 
          
          
          
            w 
           
          
            t 
           
          
         
           ) 
          
         
           。 
          
         
        
          选择一部分客户端，并向这些客户端发送当前的全局模型参数 ( w^t )。 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0936em; vertical-align: -0.25em;"></span><span class="mord cjk_fallback">选择一部分客户端，并向这些客户端发送当前的全局模型参数</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8436em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord cjk_fallback">。</span></span></span></span></span></span></li></ul> 
<p>3.本地更新：</p> 
<ul><li> <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            每个客户端使用其本地数据集对模型进行训练。与 
           
          
            F 
           
          
            e 
           
          
            d 
           
          
            A 
           
          
            v 
           
          
            g 
           
          
            不同，训练过程中加入了正则化项 
           
          
            ( 
           
           
           
             μ 
            
           
             2 
            
           
          
            ∣ 
           
          
            w 
           
          
            − 
           
           
           
             w 
            
           
             t 
            
           
           
           
             ∣ 
            
           
             2 
            
           
          
            ) 
           
          
            ，其中 
           
          
            ( 
           
          
            w 
           
          
            ) 
           
          
            是本地更新后的模型参数， 
           
          
            ( 
           
           
           
             w 
            
           
             t 
            
           
          
            ) 
           
          
            是接收到的全局模型参数，而 
           
          
            ( 
           
          
            μ 
           
          
            ) 
           
          
            是控制本地更新与全局模型偏离程度的超参数。 
           
          
         
           每个客户端使用其本地数据集对模型进行训练。与FedAvg不同，训练过程中加入了正则化项 (\frac{\mu}{2} |w - w^t|^2)，其中 ( w ) 是本地更新后的模型参数，( w^t ) 是接收到的全局模型参数，而 ( \mu ) 是控制本地更新与全局模型偏离程度的超参数。 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.7936em; vertical-align: -0.686em;"></span><span class="mord cjk_fallback">每个客户端使用其本地数据集对模型进行训练。与</span><span class="mord mathnormal" style="margin-right: 0.1389em;">F</span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right: 0.0359em;">vg</span><span class="mord cjk_fallback">不同，训练过程中加入了正则化项</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.1076em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">μ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.1141em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8436em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord cjk_fallback">，其中</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="mclose">)</span><span class="mord cjk_fallback">是本地更新后的模型参数，</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8436em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord cjk_fallback">是接收到的全局模型参数，而</span><span class="mopen">(</span><span class="mord mathnormal">μ</span><span class="mclose">)</span><span class="mord cjk_fallback">是控制本地更新与全局模型偏离程度的超参数。</span></span></span></span></span></span></p> </li><li> <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            这个正则化项有助于控制在数据分布非常不均匀或客户端计算能力不一的情况下，模型更新的稳定性和一致性。 
           
          
         
           这个正则化项有助于控制在数据分布非常不均匀或客户端计算能力不一的情况下，模型更新的稳定性和一致性。 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback">这个正则化项有助于控制在数据分布非常不均匀或客户端计算能力不一的情况下，模型更新的稳定性和一致性。</span></span></span></span></span></span></p> </li></ul> 
<p>4.上传更新：</p> 
<ul><li><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           客户端将本地更新后的模型参数或与全局模型参数的差异发送回中央服务器。 
          
         
        
          客户端将本地更新后的模型参数或与全局模型参数的差异发送回中央服务器。 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback">客户端将本地更新后的模型参数或与全局模型参数的差异发送回中央服务器。</span></span></span></span></span></span></li></ul> 
<p>5.聚合更新（可能有加权）：</p> 
<ul><li><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           服务器根据各客户端的贡献（可能是数据量或其他指标）加权聚合这些更新，更新全局模型。 
          
         
        
          服务器根据各客户端的贡献（可能是数据量或其他指标）加权聚合这些更新，更新全局模型。 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback">服务器根据各客户端的贡献（可能是数据量或其他指标）加权聚合这些更新，更新全局模型。</span></span></span></span></span></span></li></ul> 
<p>6.重复：</p> 
<ul><li><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           重复步骤 
          
         
           2 
          
         
           到 
          
         
           5 
          
         
           ，直到模型收敛或完成足够的训练轮次。 
          
         
        
          重复步骤2到5，直到模型收敛或完成足够的训练轮次。 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback">重复步骤</span><span class="mord">2</span><span class="mord cjk_fallback">到</span><span class="mord">5</span><span class="mord cjk_fallback">，直到模型收敛或完成足够的训练轮次。</span></span></span></span></span></span></li></ul> 
<p>通过这种方式，FedProx不仅处理了数据分布问题，还通过正则化项减少了模型在训练过程中的波动，使得模型更加健壮，特别是在客户端环境多样化的情况下。这使得FedProx在实际应用中比传统的联邦学习方法更有优势。</p> 
<h3><a id="_80"></a>主要优势</h3> 
<p>FedProx的主要优势在于它能够更好地处理客户端间的数据异质性。通过引入正则化项，它鼓励客户端向全局模型更加“温和”地更新，从而减少了因数据非独立同分布（Non-IID）带来的模型波动和性能下降问题。</p> 
<h3><a id="_83"></a>应用场景</h3> 
<p>FedProx适用于数据分布极不均匀的联邦学习场景，例如医疗健康数据分析、移动设备上的个性化推荐系统等领域，这些领域中的数据隐私性要求高，同时数据分布在不同设备或组织中往往是非均匀的。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f05f68fa89e9f871fd371f620813fa77/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">QR方法求解特征值、特征向量(附Matlab、C代码)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/376c3429f774a1827bc18df28a0e3f04/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">数据结构的希尔排序（c语言版）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>