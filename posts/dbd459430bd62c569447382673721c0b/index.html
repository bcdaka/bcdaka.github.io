<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用 Python和 SQLite 打造一个简单的数据库浏览器 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/dbd459430bd62c569447382673721c0b/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="使用 Python和 SQLite 打造一个简单的数据库浏览器">
  <meta property="og:description" content="在日常开发中，我们常常需要快速查看和操作SQLite数据库中的数据。虽然有许多现成的工具可以完成这一任务，但有时你可能想要一个更为简单、可定制的解决方案。在这篇博客中，我将带你一步步构建一个简单的SQLite数据库浏览器，它可以用来列出数据库中的表名、查看表的字段名、编写SQL语句并执行查询操作，并将结果展示在网格中。我们将使用 wxPython 来创建这个图形用户界面。
C:\pythoncode\new\sqliteanalysis.py
全部代码 import wx import sqlite3 import wx.grid as gridlib class SQLiteBrowser(wx.Frame): def __init__(self, *args, **kw): super(SQLiteBrowser, self).__init__(*args, **kw) self.InitUI() self.conn = None def InitUI(self): panel = wx.Panel(self) vbox = wx.BoxSizer(wx.VERTICAL) hbox1 = wx.BoxSizer(wx.HORIZONTAL) self.btn_open = wx.Button(panel, label=&#34;Open Database&#34;) self.btn_open.Bind(wx.EVT_BUTTON, self.OnOpen) hbox1.Add(self.btn_open, flag=wx.LEFT, border=10) vbox.Add(hbox1, flag=wx.EXPAND | wx.TOP | wx.BOTTOM, border=10) hbox2 = wx.BoxSizer(wx.HORIZONTAL) self.listbox1 = wx.ListBox(panel) self.listbox1.Bind(wx.EVT_LISTBOX, self.OnTableSelected) hbox2.Add(self.listbox1, proportion=1, flag=wx.EXPAND | wx.ALL, border=10) self.listbox2 = wx.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-16T12:20:16+08:00">
    <meta property="article:modified_time" content="2024-08-16T12:20:16+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用 Python和 SQLite 打造一个简单的数据库浏览器</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>在日常开发中，我们常常需要快速查看和操作SQLite数据库中的数据。虽然有许多现成的工具可以完成这一任务，但有时你可能想要一个更为简单、可定制的解决方案。在这篇博客中，我将带你一步步构建一个简单的SQLite数据库浏览器，它可以用来列出数据库中的表名、查看表的字段名、编写SQL语句并执行查询操作，并将结果展示在网格中。我们将使用 <code>wxPython</code> 来创建这个图形用户界面。<br> C:\pythoncode\new\sqliteanalysis.py</p> 
<h2><a id="_2"></a>全部代码</h2> 
<pre><code class="prism language-python"><span class="token keyword">import</span> wx
<span class="token keyword">import</span> sqlite3
<span class="token keyword">import</span> wx<span class="token punctuation">.</span>grid <span class="token keyword">as</span> gridlib

<span class="token keyword">class</span> <span class="token class-name">SQLiteBrowser</span><span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Frame<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kw<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>SQLiteBrowser<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kw<span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>InitUI<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>conn <span class="token operator">=</span> <span class="token boolean">None</span>

    <span class="token keyword">def</span> <span class="token function">InitUI</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        panel <span class="token operator">=</span> wx<span class="token punctuation">.</span>Panel<span class="token punctuation">(</span>self<span class="token punctuation">)</span>

        vbox <span class="token operator">=</span> wx<span class="token punctuation">.</span>BoxSizer<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>VERTICAL<span class="token punctuation">)</span>

        hbox1 <span class="token operator">=</span> wx<span class="token punctuation">.</span>BoxSizer<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>HORIZONTAL<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>btn_open <span class="token operator">=</span> wx<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>panel<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"Open Database"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>btn_open<span class="token punctuation">.</span>Bind<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>EVT_BUTTON<span class="token punctuation">,</span> self<span class="token punctuation">.</span>OnOpen<span class="token punctuation">)</span>
        hbox1<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>self<span class="token punctuation">.</span>btn_open<span class="token punctuation">,</span> flag<span class="token operator">=</span>wx<span class="token punctuation">.</span>LEFT<span class="token punctuation">,</span> border<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>hbox1<span class="token punctuation">,</span> flag<span class="token operator">=</span>wx<span class="token punctuation">.</span>EXPAND <span class="token operator">|</span> wx<span class="token punctuation">.</span>TOP <span class="token operator">|</span> wx<span class="token punctuation">.</span>BOTTOM<span class="token punctuation">,</span> border<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>

        hbox2 <span class="token operator">=</span> wx<span class="token punctuation">.</span>BoxSizer<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>HORIZONTAL<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>listbox1 <span class="token operator">=</span> wx<span class="token punctuation">.</span>ListBox<span class="token punctuation">(</span>panel<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>listbox1<span class="token punctuation">.</span>Bind<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>EVT_LISTBOX<span class="token punctuation">,</span> self<span class="token punctuation">.</span>OnTableSelected<span class="token punctuation">)</span>
        hbox2<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>self<span class="token punctuation">.</span>listbox1<span class="token punctuation">,</span> proportion<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> flag<span class="token operator">=</span>wx<span class="token punctuation">.</span>EXPAND <span class="token operator">|</span> wx<span class="token punctuation">.</span>ALL<span class="token punctuation">,</span> border<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>listbox2 <span class="token operator">=</span> wx<span class="token punctuation">.</span>ListBox<span class="token punctuation">(</span>panel<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>listbox2<span class="token punctuation">.</span>Bind<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>EVT_LISTBOX<span class="token punctuation">,</span> self<span class="token punctuation">.</span>OnColumnSelected<span class="token punctuation">)</span>
        hbox2<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>self<span class="token punctuation">.</span>listbox2<span class="token punctuation">,</span> proportion<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> flag<span class="token operator">=</span>wx<span class="token punctuation">.</span>EXPAND <span class="token operator">|</span> wx<span class="token punctuation">.</span>ALL<span class="token punctuation">,</span> border<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>

        vbox<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>hbox2<span class="token punctuation">,</span> proportion<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> flag<span class="token operator">=</span>wx<span class="token punctuation">.</span>EXPAND<span class="token punctuation">)</span>

        hbox3 <span class="token operator">=</span> wx<span class="token punctuation">.</span>BoxSizer<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>HORIZONTAL<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>text_ctrl <span class="token operator">=</span> wx<span class="token punctuation">.</span>TextCtrl<span class="token punctuation">(</span>panel<span class="token punctuation">,</span> style<span class="token operator">=</span>wx<span class="token punctuation">.</span>TE_MULTILINE<span class="token punctuation">)</span>
        hbox3<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>self<span class="token punctuation">.</span>text_ctrl<span class="token punctuation">,</span> proportion<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> flag<span class="token operator">=</span>wx<span class="token punctuation">.</span>EXPAND <span class="token operator">|</span> wx<span class="token punctuation">.</span>ALL<span class="token punctuation">,</span> border<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>btn_exec <span class="token operator">=</span> wx<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>panel<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"Execute SQL"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>btn_exec<span class="token punctuation">.</span>Bind<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>EVT_BUTTON<span class="token punctuation">,</span> self<span class="token punctuation">.</span>OnExecuteSQL<span class="token punctuation">)</span>
        hbox3<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>self<span class="token punctuation">.</span>btn_exec<span class="token punctuation">,</span> flag<span class="token operator">=</span>wx<span class="token punctuation">.</span>LEFT<span class="token punctuation">,</span> border<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>

        vbox<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>hbox3<span class="token punctuation">,</span> proportion<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> flag<span class="token operator">=</span>wx<span class="token punctuation">.</span>EXPAND<span class="token punctuation">)</span>

        hbox4 <span class="token operator">=</span> wx<span class="token punctuation">.</span>BoxSizer<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>HORIZONTAL<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>grid <span class="token operator">=</span> gridlib<span class="token punctuation">.</span>Grid<span class="token punctuation">(</span>panel<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>CreateGrid<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
        hbox4<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>self<span class="token punctuation">.</span>grid<span class="token punctuation">,</span> proportion<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> flag<span class="token operator">=</span>wx<span class="token punctuation">.</span>EXPAND <span class="token operator">|</span> wx<span class="token punctuation">.</span>ALL<span class="token punctuation">,</span> border<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>

        vbox<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>hbox4<span class="token punctuation">,</span> proportion<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> flag<span class="token operator">=</span>wx<span class="token punctuation">.</span>EXPAND<span class="token punctuation">)</span>

        panel<span class="token punctuation">.</span>SetSizer<span class="token punctuation">(</span>vbox<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>SetTitle<span class="token punctuation">(</span><span class="token string">'SQLite Browser'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>Centre<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">OnOpen</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> wx<span class="token punctuation">.</span>FileDialog<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">"Open SQLite file"</span><span class="token punctuation">,</span> wildcard<span class="token operator">=</span><span class="token string">"SQLite files (*.db)|*.db"</span><span class="token punctuation">,</span>
                           style<span class="token operator">=</span>wx<span class="token punctuation">.</span>FD_OPEN <span class="token operator">|</span> wx<span class="token punctuation">.</span>FD_FILE_MUST_EXIST<span class="token punctuation">)</span> <span class="token keyword">as</span> fileDialog<span class="token punctuation">:</span>
            <span class="token keyword">if</span> fileDialog<span class="token punctuation">.</span>ShowModal<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> wx<span class="token punctuation">.</span>ID_CANCEL<span class="token punctuation">:</span>
                <span class="token keyword">return</span>

            path <span class="token operator">=</span> fileDialog<span class="token punctuation">.</span>GetPath<span class="token punctuation">(</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>conn <span class="token operator">=</span> sqlite3<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>path<span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>LoadTables<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">LoadTables</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">:</span>
            cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">"SELECT name FROM sqlite_master WHERE type='table';"</span><span class="token punctuation">)</span>
            tables <span class="token operator">=</span> <span class="token punctuation">[</span>row<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
            self<span class="token punctuation">.</span>listbox1<span class="token punctuation">.</span>Set<span class="token punctuation">(</span>tables<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">OnTableSelected</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">:</span>
        table_name <span class="token operator">=</span> self<span class="token punctuation">.</span>listbox1<span class="token punctuation">.</span>GetStringSelection<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">:</span>
            cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"PRAGMA table_info(</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>table_name<span class="token punctuation">}</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>
            columns <span class="token operator">=</span> <span class="token punctuation">[</span>row<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
            self<span class="token punctuation">.</span>listbox2<span class="token punctuation">.</span>Set<span class="token punctuation">(</span>columns<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">OnColumnSelected</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">:</span>
        column_name <span class="token operator">=</span> self<span class="token punctuation">.</span>listbox2<span class="token punctuation">.</span>GetStringSelection<span class="token punctuation">(</span><span class="token punctuation">)</span>
        current_text <span class="token operator">=</span> self<span class="token punctuation">.</span>text_ctrl<span class="token punctuation">.</span>GetValue<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> current_text<span class="token punctuation">:</span>
            current_text <span class="token operator">+=</span> <span class="token string-interpolation"><span class="token string">f", </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>column_name<span class="token punctuation">}</span></span><span class="token string">"</span></span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            current_text <span class="token operator">=</span> column_name
        self<span class="token punctuation">.</span>text_ctrl<span class="token punctuation">.</span>SetValue<span class="token punctuation">(</span>current_text<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">OnExecuteSQL</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">:</span>
        sql_query <span class="token operator">=</span> self<span class="token punctuation">.</span>text_ctrl<span class="token punctuation">.</span>GetValue<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>conn <span class="token keyword">and</span> sql_query<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql_query<span class="token punctuation">)</span>
                results <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
                self<span class="token punctuation">.</span>DisplayResults<span class="token punctuation">(</span>results<span class="token punctuation">)</span>
            <span class="token keyword">except</span> sqlite3<span class="token punctuation">.</span>Error <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                wx<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"An error occurred: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> <span class="token string">"Error"</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>OK <span class="token operator">|</span> wx<span class="token punctuation">.</span>ICON_ERROR<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">DisplayResults</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> results<span class="token punctuation">:</span>
            rows <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span>
            cols <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>results<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>ClearGrid<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> rows <span class="token operator">&gt;</span> self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>GetNumberRows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>AppendRows<span class="token punctuation">(</span>rows <span class="token operator">-</span> self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>GetNumberRows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> cols <span class="token operator">&gt;</span> self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>GetNumberCols<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>AppendCols<span class="token punctuation">(</span>cols <span class="token operator">-</span> self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>GetNumberCols<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

            <span class="token keyword">for</span> i<span class="token punctuation">,</span> row <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">for</span> j<span class="token punctuation">,</span> value <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>SetCellValue<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app <span class="token operator">=</span> wx<span class="token punctuation">.</span>App<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    frame <span class="token operator">=</span> SQLiteBrowser<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">)</span>
    frame<span class="token punctuation">.</span>Show<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    app<span class="token punctuation">.</span>MainLoop<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<h4><a id="_126"></a>环境准备</h4> 
<p>在开始之前，你需要确保已安装以下Python库：</p> 
<ol><li><strong>wxPython</strong>：用于创建桌面应用的GUI库。</li><li><strong>sqlite3</strong>：Python自带的SQLite接口模块，用于与SQLite数据库进行交互。</li></ol> 
<p>如果你尚未安装 <code>wxPython</code>，可以通过以下命令安装：</p> 
<pre><code class="prism language-bash">pip <span class="token function">install</span> wxPython
</code></pre> 
<h4><a id="_139"></a>项目目标</h4> 
<p>我们将创建一个简单的应用程序，其主要功能包括：</p> 
<ol><li><strong>选择SQLite数据库文件</strong>：通过文件选择对话框选择一个SQLite数据库文件，并与之建立连接。</li><li><strong>列出表名</strong>：在左侧列表框中列出所选数据库的所有表名。</li><li><strong>列出字段名</strong>：在中间列表框中列出所选表的所有字段名。</li><li><strong>构建SQL查询</strong>：点击字段名，自动将其追加到查询输入框中。</li><li><strong>执行SQL查询</strong>：点击执行按钮，运行输入框中的SQL查询语句，并将结果展示在网格中。</li></ol> 
<h4><a id="_149"></a>代码实现</h4> 
<p>以下是完整的Python代码，它实现了上述所有功能：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> wx
<span class="token keyword">import</span> sqlite3
<span class="token keyword">import</span> wx<span class="token punctuation">.</span>grid <span class="token keyword">as</span> gridlib

<span class="token keyword">class</span> <span class="token class-name">SQLiteBrowser</span><span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Frame<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kw<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>SQLiteBrowser<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kw<span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>InitUI<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>conn <span class="token operator">=</span> <span class="token boolean">None</span>

    <span class="token keyword">def</span> <span class="token function">InitUI</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        panel <span class="token operator">=</span> wx<span class="token punctuation">.</span>Panel<span class="token punctuation">(</span>self<span class="token punctuation">)</span>

        vbox <span class="token operator">=</span> wx<span class="token punctuation">.</span>BoxSizer<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>VERTICAL<span class="token punctuation">)</span>

        hbox1 <span class="token operator">=</span> wx<span class="token punctuation">.</span>BoxSizer<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>HORIZONTAL<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>btn_open <span class="token operator">=</span> wx<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>panel<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"Open Database"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>btn_open<span class="token punctuation">.</span>Bind<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>EVT_BUTTON<span class="token punctuation">,</span> self<span class="token punctuation">.</span>OnOpen<span class="token punctuation">)</span>
        hbox1<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>self<span class="token punctuation">.</span>btn_open<span class="token punctuation">,</span> flag<span class="token operator">=</span>wx<span class="token punctuation">.</span>LEFT<span class="token punctuation">,</span> border<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>hbox1<span class="token punctuation">,</span> flag<span class="token operator">=</span>wx<span class="token punctuation">.</span>EXPAND <span class="token operator">|</span> wx<span class="token punctuation">.</span>TOP <span class="token operator">|</span> wx<span class="token punctuation">.</span>BOTTOM<span class="token punctuation">,</span> border<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>

        hbox2 <span class="token operator">=</span> wx<span class="token punctuation">.</span>BoxSizer<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>HORIZONTAL<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>listbox1 <span class="token operator">=</span> wx<span class="token punctuation">.</span>ListBox<span class="token punctuation">(</span>panel<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>listbox1<span class="token punctuation">.</span>Bind<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>EVT_LISTBOX<span class="token punctuation">,</span> self<span class="token punctuation">.</span>OnTableSelected<span class="token punctuation">)</span>
        hbox2<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>self<span class="token punctuation">.</span>listbox1<span class="token punctuation">,</span> proportion<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> flag<span class="token operator">=</span>wx<span class="token punctuation">.</span>EXPAND <span class="token operator">|</span> wx<span class="token punctuation">.</span>ALL<span class="token punctuation">,</span> border<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>listbox2 <span class="token operator">=</span> wx<span class="token punctuation">.</span>ListBox<span class="token punctuation">(</span>panel<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>listbox2<span class="token punctuation">.</span>Bind<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>EVT_LISTBOX<span class="token punctuation">,</span> self<span class="token punctuation">.</span>OnColumnSelected<span class="token punctuation">)</span>
        hbox2<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>self<span class="token punctuation">.</span>listbox2<span class="token punctuation">,</span> proportion<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> flag<span class="token operator">=</span>wx<span class="token punctuation">.</span>EXPAND <span class="token operator">|</span> wx<span class="token punctuation">.</span>ALL<span class="token punctuation">,</span> border<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>

        vbox<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>hbox2<span class="token punctuation">,</span> proportion<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> flag<span class="token operator">=</span>wx<span class="token punctuation">.</span>EXPAND<span class="token punctuation">)</span>

        hbox3 <span class="token operator">=</span> wx<span class="token punctuation">.</span>BoxSizer<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>HORIZONTAL<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>text_ctrl <span class="token operator">=</span> wx<span class="token punctuation">.</span>TextCtrl<span class="token punctuation">(</span>panel<span class="token punctuation">,</span> style<span class="token operator">=</span>wx<span class="token punctuation">.</span>TE_MULTILINE<span class="token punctuation">)</span>
        hbox3<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>self<span class="token punctuation">.</span>text_ctrl<span class="token punctuation">,</span> proportion<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> flag<span class="token operator">=</span>wx<span class="token punctuation">.</span>EXPAND <span class="token operator">|</span> wx<span class="token punctuation">.</span>ALL<span class="token punctuation">,</span> border<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>btn_exec <span class="token operator">=</span> wx<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>panel<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"Execute SQL"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>btn_exec<span class="token punctuation">.</span>Bind<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>EVT_BUTTON<span class="token punctuation">,</span> self<span class="token punctuation">.</span>OnExecuteSQL<span class="token punctuation">)</span>
        hbox3<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>self<span class="token punctuation">.</span>btn_exec<span class="token punctuation">,</span> flag<span class="token operator">=</span>wx<span class="token punctuation">.</span>LEFT<span class="token punctuation">,</span> border<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>

        vbox<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>hbox3<span class="token punctuation">,</span> proportion<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> flag<span class="token operator">=</span>wx<span class="token punctuation">.</span>EXPAND<span class="token punctuation">)</span>

        hbox4 <span class="token operator">=</span> wx<span class="token punctuation">.</span>BoxSizer<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>HORIZONTAL<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>grid <span class="token operator">=</span> gridlib<span class="token punctuation">.</span>Grid<span class="token punctuation">(</span>panel<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>CreateGrid<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
        hbox4<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>self<span class="token punctuation">.</span>grid<span class="token punctuation">,</span> proportion<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> flag<span class="token operator">=</span>wx<span class="token punctuation">.</span>EXPAND <span class="token operator">|</span> wx<span class="token punctuation">.</span>ALL<span class="token punctuation">,</span> border<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>

        vbox<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>hbox4<span class="token punctuation">,</span> proportion<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> flag<span class="token operator">=</span>wx<span class="token punctuation">.</span>EXPAND<span class="token punctuation">)</span>

        panel<span class="token punctuation">.</span>SetSizer<span class="token punctuation">(</span>vbox<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>SetTitle<span class="token punctuation">(</span><span class="token string">'SQLite Browser'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>Centre<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">OnOpen</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> wx<span class="token punctuation">.</span>FileDialog<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">"Open SQLite file"</span><span class="token punctuation">,</span> wildcard<span class="token operator">=</span><span class="token string">"SQLite files (*.db)|*.db"</span><span class="token punctuation">,</span>
                           style<span class="token operator">=</span>wx<span class="token punctuation">.</span>FD_OPEN <span class="token operator">|</span> wx<span class="token punctuation">.</span>FD_FILE_MUST_EXIST<span class="token punctuation">)</span> <span class="token keyword">as</span> fileDialog<span class="token punctuation">:</span>
            <span class="token keyword">if</span> fileDialog<span class="token punctuation">.</span>ShowModal<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> wx<span class="token punctuation">.</span>ID_CANCEL<span class="token punctuation">:</span>
                <span class="token keyword">return</span>

            path <span class="token operator">=</span> fileDialog<span class="token punctuation">.</span>GetPath<span class="token punctuation">(</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>conn <span class="token operator">=</span> sqlite3<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>path<span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>LoadTables<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">LoadTables</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">:</span>
            cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">"SELECT name FROM sqlite_master WHERE type='table';"</span><span class="token punctuation">)</span>
            tables <span class="token operator">=</span> <span class="token punctuation">[</span>row<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
            self<span class="token punctuation">.</span>listbox1<span class="token punctuation">.</span>Set<span class="token punctuation">(</span>tables<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">OnTableSelected</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">:</span>
        table_name <span class="token operator">=</span> self<span class="token punctuation">.</span>listbox1<span class="token punctuation">.</span>GetStringSelection<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">:</span>
            cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"PRAGMA table_info(</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>table_name<span class="token punctuation">}</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>
            columns <span class="token operator">=</span> <span class="token punctuation">[</span>row<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
            self<span class="token punctuation">.</span>listbox2<span class="token punctuation">.</span>Set<span class="token punctuation">(</span>columns<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">OnColumnSelected</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">:</span>
        column_name <span class="token operator">=</span> self<span class="token punctuation">.</span>listbox2<span class="token punctuation">.</span>GetStringSelection<span class="token punctuation">(</span><span class="token punctuation">)</span>
        current_text <span class="token operator">=</span> self<span class="token punctuation">.</span>text_ctrl<span class="token punctuation">.</span>GetValue<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> current_text<span class="token punctuation">:</span>
            current_text <span class="token operator">+=</span> <span class="token string-interpolation"><span class="token string">f", </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>column_name<span class="token punctuation">}</span></span><span class="token string">"</span></span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            current_text <span class="token operator">=</span> column_name
        self<span class="token punctuation">.</span>text_ctrl<span class="token punctuation">.</span>SetValue<span class="token punctuation">(</span>current_text<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">OnExecuteSQL</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">:</span>
        sql_query <span class="token operator">=</span> self<span class="token punctuation">.</span>text_ctrl<span class="token punctuation">.</span>GetValue<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>conn <span class="token keyword">and</span> sql_query<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql_query<span class="token punctuation">)</span>
                results <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
                self<span class="token punctuation">.</span>DisplayResults<span class="token punctuation">(</span>results<span class="token punctuation">)</span>
            <span class="token keyword">except</span> sqlite3<span class="token punctuation">.</span>Error <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                wx<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"An error occurred: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> <span class="token string">"Error"</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>OK <span class="token operator">|</span> wx<span class="token punctuation">.</span>ICON_ERROR<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">DisplayResults</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> results<span class="token punctuation">:</span>
            rows <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span>
            cols <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>results<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>ClearGrid<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> rows <span class="token operator">&gt;</span> self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>GetNumberRows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>AppendRows<span class="token punctuation">(</span>rows <span class="token operator">-</span> self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>GetNumberRows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> cols <span class="token operator">&gt;</span> self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>GetNumberCols<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>AppendCols<span class="token punctuation">(</span>cols <span class="token operator">-</span> self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>GetNumberCols<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

            <span class="token keyword">for</span> i<span class="token punctuation">,</span> row <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">for</span> j<span class="token punctuation">,</span> value <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>SetCellValue<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app <span class="token operator">=</span> wx<span class="token punctuation">.</span>App<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    frame <span class="token operator">=</span> SQLiteBrowser<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">)</span>
    frame<span class="token punctuation">.</span>Show<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    app<span class="token punctuation">.</span>MainLoop<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="_274"></a>代码讲解</h4> 
<h5><a id="1__276"></a>1. 打开数据库</h5> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">OnOpen</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> wx<span class="token punctuation">.</span>FileDialog<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">"Open SQLite file"</span><span class="token punctuation">,</span> wildcard<span class="token operator">=</span><span class="token string">"SQLite files (*.db)|*.db"</span><span class="token punctuation">,</span>
                       style<span class="token operator">=</span>wx<span class="token punctuation">.</span>FD_OPEN <span class="token operator">|</span> wx<span class="token punctuation">.</span>FD_FILE_MUST_EXIST<span class="token punctuation">)</span> <span class="token keyword">as</span> fileDialog<span class="token punctuation">:</span>
        <span class="token keyword">if</span> fileDialog<span class="token punctuation">.</span>ShowModal<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> wx<span class="token punctuation">.</span>ID_CANCEL<span class="token punctuation">:</span>
            <span class="token keyword">return</span>

        path <span class="token operator">=</span> fileDialog<span class="token punctuation">.</span>GetPath<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>conn <span class="token operator">=</span> sqlite3<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>path<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>LoadTables<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>这里，我们使用 <code>wx.FileDialog</code> 来打开文件选择对话框。用户选择一个SQLite数据库文件后，我们使用 <code>sqlite3.connect()</code> 方法建立数据库连接，并调用 <code>LoadTables</code> 方法列出所有表名。</p> 
<h5><a id="2__292"></a>2. 列出表名和字段名</h5> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">LoadTables</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">:</span>
        cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">"SELECT name FROM sqlite_master WHERE type='table';"</span><span class="token punctuation">)</span>
        tables <span class="token operator">=</span> <span class="token punctuation">[</span>row<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>listbox1<span class="token punctuation">.</span>Set<span class="token punctuation">(</span>tables<span class="token punctuation">)</span>
</code></pre> 
<p><code>LoadTables</code> 方法通过执行 <code>SELECT name FROM sqlite_master WHERE type='table';</code> 查询来获取所有表名，并将其添加到左侧的 <code>ListBox</code> 中。</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">OnTableSelected</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">:</span>
    table_name <span class="token operator">=</span> self<span class="token punctuation">.</span>listbox1<span class="token punctuation">.</span>GetStringSelection<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">:</span>
        cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"PRAGMA table_info(</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>table_name<span class="token punctuation">}</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>
        columns <span class="token operator">=</span> <span class="token punctuation">[</span>row<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>listbox2<span class="token punctuation">.</span>Set<span class="token punctuation">(</span>columns<span class="token punctuation">)</span>
</code></pre> 
<p>当用户点击某个表名时，<code>OnTableSelected</code> 方法会被调用，它使用 <code>PRAGMA table_info(table_name)</code> 查询该表的所有字段名，并将其显示在中间的 <code>ListBox</code> 中。</p> 
<h5><a id="3_SQL_317"></a>3. 构建和执行SQL查询</h5> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">OnColumnSelected</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">:</span>
    column_name <span class="token operator">=</span> self<span class="token punctuation">.</span>listbox2<span class="token punctuation">.</span>GetStringSelection<span class="token punctuation">(</span><span class="token punctuation">)</span>
    current_text <span class="token operator">=</span> self<span class="token punctuation">.</span>text_ctrl<span class="token punctuation">.</span>GetValue<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> current_text<span class="token punctuation">:</span>
        current_text <span class="token operator">+=</span> <span class="token string-interpolation"><span class="token string">f", </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>column_name<span class="token punctuation">}</span></span><span class="token string">"</span></span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        current_text <span class="token operator">=</span> column_name
    self<span class="token punctuation">.</span>text_ctrl<span class="token punctuation">.</span>SetValue<span class="token punctuation">(</span>current_text<span class="token punctuation">)</span>
</code></pre> 
<p>用户点击字段名时，<code>OnColumnSelected</code> 方法会将字段名追加到右侧的SQL输入框中，帮助用户快速构建SQL查询语句。</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">OnExecuteSQL</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">:</span>
    sql_query <span class="token operator">=</span> self<span class="token punctuation">.</span>text_ctrl<span class="token punctuation">.</span>GetValue<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> self<span class="token punctuation">.</span>conn <span class="token keyword">and</span> sql_query<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql_query<span class="token punctuation">)</span>
            results <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>DisplayResults<span class="token punctuation">(</span>results<span class="token punctuation">)</span>
        <span class="token keyword">except</span> sqlite3<span class="token punctuation">.</span>Error <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            wx<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"An error occurred: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> <span class="token string">"Error"</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>OK <span class="token operator">|</span> wx<span class="token punctuation">.</span>ICON_ERROR<span class="token punctuation">)</span>
</code></pre> 
<p>点击“Execute SQL”按钮后，<code>OnExecuteSQL</code> 方法将执行输入框中的SQL语句，并调用 <code>DisplayResults</code> 方法将查询结果展示在网格里。</p> 
<h5><a id="4__346"></a>4. 显示查询结果</h5> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">DisplayResults</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> results<span class="token punctuation">:</span>
        rows <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span>
        cols <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>results<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>ClearGrid<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> rows <span class="token operator">&gt;</span> self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>GetNumberRows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>AppendRows<span class="token punctuation">(</span>rows <span class="token operator">-</span> self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>GetNumberRows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> cols <span class="token operator">&gt;</span> self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>GetNumberCols<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>AppendCols<span class="token punctuation">(</span>cols <span class="token operator">-</span> self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>GetNumberCols<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token keyword">for</span> i<span class="token punctuation">,</span> row <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> j<span class="token punctuation">,</span> value <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>grid<span class="token punctuation">.</span>SetCellValue<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><code>DisplayResults</code> 方法会根据查询结果动态调整网格的大小，并将查询结果逐个填充到网格中。</p> 
<h2><a id="_365"></a>结果如下</h2> 
<p><img src="https://images2.imgbox.com/ef/fd/iCOJ9kDt_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_369"></a>结语</h4> 
<p>通过上述代码，我们已经成功创建了一个简单的SQLite数据库浏览器，它可以帮助你快速查看和操作数据库中的数据。这个项目非常适合用作学习 <code>wxPython</code> 和 <code>sqlite3</code> 的入门项目，你可以在此基础上进一步扩展功能，如支持更多的SQL操作、增加数据编辑功能、或改进用户界面。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/41bfa5e1d2dcef730708cdd2fcfa2253/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【HarmonyOS NEXT】codelab汇总-AI</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/84cb5b166226930979f971c524c3f5eb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C&#43;&#43;：缺省参数、函数重载、引用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>