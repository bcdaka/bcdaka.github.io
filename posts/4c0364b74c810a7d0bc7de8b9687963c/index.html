<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>æ‰‹æŠŠæ‰‹å¸¦ä½ æ­å»ºä¸€ä¸ªè¯­éŸ³å¯¹è¯æœºå™¨äººï¼Œ5åˆ†é’Ÿå®šåˆ¶ä¸ªäººAIå°åŠ©æ‰‹ï¼ˆæ–°æ‰‹å…¥é—¨ç¯‡ï¼‰ - ç¼–ç¨‹å¤§å’–</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/4c0364b74c810a7d0bc7de8b9687963c/">
  <meta property="og:site_name" content="ç¼–ç¨‹å¤§å’–">
  <meta property="og:title" content="æ‰‹æŠŠæ‰‹å¸¦ä½ æ­å»ºä¸€ä¸ªè¯­éŸ³å¯¹è¯æœºå™¨äººï¼Œ5åˆ†é’Ÿå®šåˆ¶ä¸ªäººAIå°åŠ©æ‰‹ï¼ˆæ–°æ‰‹å…¥é—¨ç¯‡ï¼‰">
  <meta property="og:description" content="å†™åœ¨å‰é¢ å¦‚æœä½ çš„èº«è¾¹æœ‰ä¸€ä¸ªéšæ—¶å¾…å‘½ã€èªæ˜ç»é¡¶çš„AIå°åŠ©æ‰‹ï¼Œèƒ½å¤Ÿå¬æ‡‚ä½ çš„è¯ï¼Œç†è§£ä½ çš„éœ€æ±‚ï¼Œç”¨æ¸©æš–çš„å£°éŸ³å›åº”ä½ ï¼Œä¼šæ˜¯ä¸€ç§ä»€ä¹ˆä½“éªŒï¼Ÿ
ä»Šå¤©ï¼Œå¸¦å¤§å®¶ä»0åˆ°1æ­å»ºä¸€ä¸ªè¯­éŸ³å¯¹è¯æœºå™¨äººï¼Œåˆ†åˆ†é’Ÿæ‹¥æœ‰ä¸€ä¸ªä¸“å±çš„ä¸ªäººAIå°åŠ©æ‰‹ã€‚
æœ¬æ–‡é¢å‘æŠ€æœ¯å°ç™½ï¼Œä»¥æœ€é€šä¿—æ˜“æ‡‚çš„è¯­è¨€ï¼Œæœ€è´´å¿ƒçš„æ­¥éª¤æŒ‡å¯¼ï¼Œç¡®ä¿ä½ èƒ½å¤Ÿè½»æ¾ä¸Šæ‰‹ï¼Œå¿«é€ŸæŒæ¡ã€‚
è¯­éŸ³å¯¹è¯ç³»ç»Ÿçš„åŸºæœ¬ç»„æˆæœ‰å“ªäº›ï¼Ÿ ä¸€ä¸ªå¯ä»¥å®ç°è¯­éŸ³å¯¹è¯çš„æœºå™¨äººï¼Œé€šå¸¸éœ€è¦ç”±ç¡¬ä»¶å’Œè½¯ä»¶æ„æˆï¼Œç¡¬ä»¶å¯ä»¥ç†è§£ä¸ºæœºå™¨äººçš„èº¯ä½“ã€‚
æœ¬ç¯‡ä¸»è¦æ¥èŠèŠè¯­éŸ³å¯¹è¯æœºå™¨äººçš„è½¯ä»¶éƒ¨åˆ†ã€‚
è¯´åˆ°è½¯ä»¶éƒ¨åˆ†ï¼Œé€šå¸¸åˆå¯ä»¥æŠ½è±¡ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š
è‡ªåŠ¨è¯­éŸ³è¯†åˆ«ï¼ˆAutomatic Speech Recognition, ç®€ç§° ASRï¼‰ï¼Œç›¸å½“äº æœºå™¨äººçš„è€³æœµï¼Œç”¨äºæŠŠæˆ‘ä»¬çš„è¯­éŸ³è¯†åˆ«æˆæ–‡å­—ï¼›è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNatural Language Processing, ç®€ç§° NLPï¼‰ï¼Œç›¸å½“äº æœºå™¨äººçš„å¤§è„‘ï¼Œç†è§£ä¸Šä¸€æ­¥å¾—åˆ°çš„æ–‡å­—ä¿¡æ¯ï¼Œå¹¶è¿›è¡Œç­”å¤ï¼Œå½“å‰ä¸»æµçš„è§£å†³æ–¹æ¡ˆæ˜¯å¤§è¯­è¨€æ¨¡å‹LLMï¼›æ–‡æœ¬åˆ°è¯­éŸ³åˆæˆï¼ˆText to Speechï¼Œç®€ç§° TTSï¼‰ï¼Œç›¸å½“äº æœºå™¨äººçš„å˜´å·´ï¼ŒæŠŠä¸Šä¸€æ­¥çš„ç­”å¤ç”¨è¯­éŸ³å›ç­”å‡ºæ¥ å¦‚ä½•å¿«é€Ÿæ­å»ºè¯­éŸ³å¯¹è¯ç³»ç»Ÿï¼Ÿ ä¸ºäº†å¸®åŠ©å¤§å®¶ä»0åˆ°1å¿«é€Ÿå®Œæˆä¸€ä¸ªç³»ç»Ÿçš„æ­å»ºï¼Œæœ¬æ–‡å°†å®Œå…¨é‡‡ç”¨å¼€æºæ–¹æ¡ˆæ¥å®ç°ã€‚å…·ä½“è€Œè¨€ï¼š
ASR é‡‡ç”¨ FunASRï¼Œç›¸æ¯” OpenAI å¼€æºçš„ Whisperï¼Œä¸­æ–‡è¯†åˆ«æ•ˆæœæ›´å¥½ï¼›
NLP é‡‡ç”¨å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰æ–¹æ¡ˆï¼Œæ¯”å¦‚æˆ‘ä»¬è¿™é‡Œå¯ä»¥é‡‡ç”¨ LLaMA3-8Bï¼Œé‡‡ç”¨æœ¬åœ°çš„ GPU éƒ¨ç½²å’Œè¿è¡Œï¼Œå¦‚æœæ²¡æœ‰æœ¬åœ° GPU èµ„æºï¼Œä¹Ÿå¯ä»¥è°ƒç”¨äº‘ç«¯ API å®ç°è¿™ä¸€æ­¥ï¼›
TTS é‡‡ç”¨ æœ€æ–°å¼€æºçš„ ChatTTSï¼Œå®ƒæ˜¯ä¸“é—¨ä¸ºå¯¹è¯åœºæ™¯è®¾è®¡çš„æ–‡æœ¬è½¬è¯­éŸ³æ¨¡å‹ï¼Œæ”¯æŒè‹±æ–‡å’Œä¸­æ–‡ä¸¤ç§è¯­è¨€ï¼Œæ•ˆæœéå¸¸æƒŠè‰³ã€‚
1 è¯­éŸ³è¯†åˆ« ASR ASR é‡‡ç”¨é˜¿é‡Œå¼€æºçš„ FunASRï¼Œç›¸æ¯” OpenAI å¼€æºçš„ Whisperï¼Œä¸­æ–‡è¯†åˆ«æ•ˆæœæ›´å¥½ã€‚
GitHubåœ°å€ï¼šhttps://github.com/modelscope/FunASR
æ¨¡å‹è°ƒç”¨å‚è€ƒï¼šhttps://modelscope.cn/studios/iic/funasr_app_clipvideo/summary
é€šè¿‡å¦‚ä¸‹ä»£ç ï¼Œæˆ‘ä»¬ç®€å•æµ‹è¯•ä¸€ä¸‹è¿”å›ç»“æœå’Œæ¨¡å‹æ•ˆæœï¼š
from funasr import AutoModel # asr model funasr_model = AutoModel(model=&#34;iic/speech_seaco_paraformer_large_asr_nat-zh-cn-16k-common-vocab8404-pytorch&#34;, vad_model=&#34;damo/speech_fsmn_vad_zh-cn-16k-common-pytorch&#34;, punc_model=&#34;damo/punc_ct-transformer_zh-cn-common-vocab272727-pytorch&#34;, spk_model=&#34;damo/speech_campplus_sv_zh-cn_16k-common&#34;, ) rec_result = funasr_model.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-16T16:04:06+08:00">
    <meta property="article:modified_time" content="2024-06-16T16:04:06+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§å’–" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§å’–</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">æ‰‹æŠŠæ‰‹å¸¦ä½ æ­å»ºä¸€ä¸ªè¯­éŸ³å¯¹è¯æœºå™¨äººï¼Œ5åˆ†é’Ÿå®šåˆ¶ä¸ªäººAIå°åŠ©æ‰‹ï¼ˆæ–°æ‰‹å…¥é—¨ç¯‡ï¼‰</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_1"></a>å†™åœ¨å‰é¢</h2> 
<p>å¦‚æœä½ çš„èº«è¾¹æœ‰ä¸€ä¸ªéšæ—¶å¾…å‘½ã€èªæ˜ç»é¡¶çš„AIå°åŠ©æ‰‹ï¼Œèƒ½å¤Ÿå¬æ‡‚ä½ çš„è¯ï¼Œç†è§£ä½ çš„éœ€æ±‚ï¼Œç”¨æ¸©æš–çš„å£°éŸ³å›åº”ä½ ï¼Œä¼šæ˜¯ä¸€ç§ä»€ä¹ˆä½“éªŒï¼Ÿ</p> 
<p>ä»Šå¤©ï¼Œå¸¦å¤§å®¶ä»0åˆ°1æ­å»ºä¸€ä¸ªè¯­éŸ³å¯¹è¯æœºå™¨äººï¼Œåˆ†åˆ†é’Ÿæ‹¥æœ‰ä¸€ä¸ªä¸“å±çš„ä¸ªäººAIå°åŠ©æ‰‹ã€‚</p> 
<p>æœ¬æ–‡é¢å‘æŠ€æœ¯å°ç™½ï¼Œä»¥æœ€é€šä¿—æ˜“æ‡‚çš„è¯­è¨€ï¼Œæœ€è´´å¿ƒçš„æ­¥éª¤æŒ‡å¯¼ï¼Œç¡®ä¿ä½ èƒ½å¤Ÿè½»æ¾ä¸Šæ‰‹ï¼Œå¿«é€ŸæŒæ¡ã€‚</p> 
<h2><a id="_7"></a>è¯­éŸ³å¯¹è¯ç³»ç»Ÿçš„åŸºæœ¬ç»„æˆæœ‰å“ªäº›ï¼Ÿ</h2> 
<p>ä¸€ä¸ªå¯ä»¥å®ç°è¯­éŸ³å¯¹è¯çš„æœºå™¨äººï¼Œé€šå¸¸éœ€è¦ç”±ç¡¬ä»¶å’Œè½¯ä»¶æ„æˆï¼Œç¡¬ä»¶å¯ä»¥ç†è§£ä¸ºæœºå™¨äººçš„èº¯ä½“ã€‚</p> 
<p>æœ¬ç¯‡ä¸»è¦æ¥èŠèŠè¯­éŸ³å¯¹è¯æœºå™¨äººçš„è½¯ä»¶éƒ¨åˆ†ã€‚</p> 
<p>è¯´åˆ°è½¯ä»¶éƒ¨åˆ†ï¼Œé€šå¸¸åˆå¯ä»¥æŠ½è±¡ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š</p> 
<ul><li>è‡ªåŠ¨è¯­éŸ³è¯†åˆ«ï¼ˆAutomatic Speech Recognition, ç®€ç§° <strong>ASR</strong>ï¼‰ï¼Œç›¸å½“äº <strong>æœºå™¨äººçš„è€³æœµ</strong>ï¼Œç”¨äºæŠŠæˆ‘ä»¬çš„è¯­éŸ³è¯†åˆ«æˆæ–‡å­—ï¼›</li><li>è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNatural Language Processing, ç®€ç§° <strong>NLP</strong>ï¼‰ï¼Œç›¸å½“äº <strong>æœºå™¨äººçš„å¤§è„‘</strong>ï¼Œç†è§£ä¸Šä¸€æ­¥å¾—åˆ°çš„æ–‡å­—ä¿¡æ¯ï¼Œå¹¶è¿›è¡Œç­”å¤ï¼Œå½“å‰ä¸»æµçš„è§£å†³æ–¹æ¡ˆæ˜¯<strong>å¤§è¯­è¨€æ¨¡å‹LLM</strong>ï¼›</li><li>æ–‡æœ¬åˆ°è¯­éŸ³åˆæˆï¼ˆText to Speechï¼Œç®€ç§° <strong>TTS</strong>ï¼‰ï¼Œç›¸å½“äº <strong>æœºå™¨äººçš„å˜´å·´</strong>ï¼ŒæŠŠä¸Šä¸€æ­¥çš„ç­”å¤ç”¨è¯­éŸ³å›ç­”å‡ºæ¥</li></ul> 
<p><img src="https://images2.imgbox.com/c8/a4/pTN0xwK6_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h2><a id="_18"></a>å¦‚ä½•å¿«é€Ÿæ­å»ºè¯­éŸ³å¯¹è¯ç³»ç»Ÿï¼Ÿ</h2> 
<p>ä¸ºäº†å¸®åŠ©å¤§å®¶ä»0åˆ°1å¿«é€Ÿå®Œæˆä¸€ä¸ªç³»ç»Ÿçš„æ­å»ºï¼Œæœ¬æ–‡å°†<strong>å®Œå…¨é‡‡ç”¨å¼€æº</strong>æ–¹æ¡ˆæ¥å®ç°ã€‚å…·ä½“è€Œè¨€ï¼š</p> 
<ul><li> <p>ASR é‡‡ç”¨ FunASRï¼Œç›¸æ¯” OpenAI å¼€æºçš„ Whisperï¼Œä¸­æ–‡è¯†åˆ«æ•ˆæœæ›´å¥½ï¼›</p> </li><li> <p>NLP é‡‡ç”¨å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰æ–¹æ¡ˆï¼Œæ¯”å¦‚æˆ‘ä»¬è¿™é‡Œå¯ä»¥é‡‡ç”¨ LLaMA3-8Bï¼Œé‡‡ç”¨æœ¬åœ°çš„ GPU éƒ¨ç½²å’Œè¿è¡Œï¼Œå¦‚æœæ²¡æœ‰æœ¬åœ° GPU èµ„æºï¼Œä¹Ÿå¯ä»¥è°ƒç”¨äº‘ç«¯ API å®ç°è¿™ä¸€æ­¥ï¼›</p> </li><li> <p>TTS é‡‡ç”¨ æœ€æ–°å¼€æºçš„ ChatTTSï¼Œå®ƒæ˜¯ä¸“é—¨ä¸ºå¯¹è¯åœºæ™¯è®¾è®¡çš„æ–‡æœ¬è½¬è¯­éŸ³æ¨¡å‹ï¼Œæ”¯æŒè‹±æ–‡å’Œä¸­æ–‡ä¸¤ç§è¯­è¨€ï¼Œæ•ˆæœéå¸¸æƒŠè‰³ã€‚</p> </li></ul> 
<h3><a id="1__ASR_28"></a>1 è¯­éŸ³è¯†åˆ« ASR</h3> 
<p>ASR é‡‡ç”¨é˜¿é‡Œå¼€æºçš„ FunASRï¼Œç›¸æ¯” OpenAI å¼€æºçš„ Whisperï¼Œä¸­æ–‡è¯†åˆ«æ•ˆæœæ›´å¥½ã€‚</p> 
<blockquote> 
 <p>GitHubåœ°å€ï¼šhttps://github.com/modelscope/FunASR<br> æ¨¡å‹è°ƒç”¨å‚è€ƒï¼šhttps://modelscope.cn/studios/iic/funasr_app_clipvideo/summary</p> 
</blockquote> 
<p>é€šè¿‡å¦‚ä¸‹ä»£ç ï¼Œæˆ‘ä»¬ç®€å•æµ‹è¯•ä¸€ä¸‹è¿”å›ç»“æœå’Œæ¨¡å‹æ•ˆæœï¼š</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> funasr <span class="token keyword">import</span> AutoModel
<span class="token comment"># asr model</span>
funasr_model <span class="token operator">=</span> AutoModel<span class="token punctuation">(</span>model<span class="token operator">=</span><span class="token string">"iic/speech_seaco_paraformer_large_asr_nat-zh-cn-16k-common-vocab8404-pytorch"</span><span class="token punctuation">,</span>
                             vad_model<span class="token operator">=</span><span class="token string">"damo/speech_fsmn_vad_zh-cn-16k-common-pytorch"</span><span class="token punctuation">,</span>
                             punc_model<span class="token operator">=</span><span class="token string">"damo/punc_ct-transformer_zh-cn-common-vocab272727-pytorch"</span><span class="token punctuation">,</span>
                             spk_model<span class="token operator">=</span><span class="token string">"damo/speech_campplus_sv_zh-cn_16k-common"</span><span class="token punctuation">,</span>
                            <span class="token punctuation">)</span>
rec_result <span class="token operator">=</span> funasr_model<span class="token punctuation">.</span>generate<span class="token punctuation">(</span><span class="token string">"test.wav"</span><span class="token punctuation">,</span> return_raw_text<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> is_final<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre> 
<p>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦å°†å…¶å°è£…æˆä¸€ä¸ª API ï¼Œæ–¹ä¾¿åç»­è°ƒç”¨ã€‚æœ€ç®€å•çš„æˆ‘ä»¬å¯ä»¥é‡‡ç”¨ FastAPI æ¥å®ç°å°è£…ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-python"><span class="token comment"># å®šä¹‰asræ•°æ®æ¨¡å‹ï¼Œç”¨äºæ¥æ”¶POSTè¯·æ±‚ä¸­çš„æ•°æ®</span>
<span class="token keyword">class</span> <span class="token class-name">ASRItem</span><span class="token punctuation">(</span>BaseModel<span class="token punctuation">)</span><span class="token punctuation">:</span>
    wav <span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token comment"># è¾“å…¥éŸ³é¢‘ï¼Œbase64ç¼–ç </span>
    time_stamp <span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment"># æ—¶é—´æˆ³ï¼Œå¯é€‰ï¼Œé»˜è®¤ä¸º0</span>

app <span class="token operator">=</span> FastAPI<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>post</span><span class="token punctuation">(</span><span class="token string">"/asr"</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">asr</span><span class="token punctuation">(</span>item<span class="token punctuation">:</span> ASRItem<span class="token punctuation">)</span><span class="token punctuation">:</span>
    time_stamp <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>time_stamp<span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>item<span class="token punctuation">.</span>wav<span class="token punctuation">)</span>
        rec_result <span class="token operator">=</span> funasr_model<span class="token punctuation">.</span>generate<span class="token punctuation">(</span>data<span class="token punctuation">,</span> return_raw_text<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> is_final<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        res <span class="token operator">=</span> rec_result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'sentence_info'</span><span class="token punctuation">]</span> <span class="token keyword">if</span> time_stamp <span class="token keyword">else</span> rec_result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'text'</span><span class="token punctuation">]</span>
        result_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"code"</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"msg"</span><span class="token punctuation">:</span> <span class="token string">"ok"</span><span class="token punctuation">,</span> <span class="token string">"res"</span><span class="token punctuation">:</span> res<span class="token punctuation">}</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        result_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"code"</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"msg"</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token keyword">return</span> result_dict

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    uvicorn<span class="token punctuation">.</span>run<span class="token punctuation">(</span>app<span class="token punctuation">,</span> host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">2002</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="2_LLM_71"></a>2 å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰</h3> 
<p>ä¸ºäº†å®ç°å¯¹è¯åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨å½“å‰çš„å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ï¼Œå¯¹ä¸Šä¸€æ­¥è¯†åˆ«å‡ºæ¥çš„æ–‡å­—è¿›è¡Œç†è§£ï¼Œå¹¶ç»™å‡ºç­”å¤ã€‚</p> 
<p>æœ¬æ–‡çš„ LLM é‡‡ç”¨ LLaMA3-8Bï¼Œå¼€æºç¤¾åŒºå·²ç»å®ç°äº†å¯¹ LLaMA3-8B çš„ä¸­æ–‡æŒ‡ä»¤å¾®è°ƒï¼Œä¸ºæ­¤ä¸­æ–‡æ•ˆæœä¼šæ¯”åŸå§‹ç‰ˆæœ¬æ•ˆæœæ›´å¥½ã€‚</p> 
<blockquote> 
 <p>GitHubåœ°å€ï¼šhttps://github.com/ymcui/Chinese-LLaMA-Alpaca-3<br> æ¨¡å‹åœ°å€ï¼šhttps://modelscope.cn/models/ChineseAlpacaGroup/llama-3-chinese-8b-instruct/summary</p> 
</blockquote> 
<p>åœ¨ä¸Šè¿°çš„ GitHub ä»“åº“ä¸­ï¼Œç»™å‡ºäº†ä¸€é”®éƒ¨ç½²çš„è„šæœ¬ï¼Œéå¸¸æ–¹ä¾¿ã€‚å››æ­¥èµ°æå®šå®ƒï¼š</p> 
<ul><li>ä¸‹è½½ä»£ç </li><li>ä¸‹è½½æ¨¡å‹</li><li>å®‰è£…å¿…è¦çš„åŒ…</li><li>æœåŠ¡å¯åŠ¨</li></ul> 
<p><strong>step 1 ä¸‹è½½ä»£ç ï¼š</strong></p> 
<pre><code class="prism language-python">git clone https<span class="token punctuation">:</span><span class="token operator">//</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>ymcui<span class="token operator">/</span>Chinese<span class="token operator">-</span>LLaMA<span class="token operator">-</span>Alpaca<span class="token operator">-</span><span class="token number">3</span>
</code></pre> 
<p><strong>step 2 ä¸‹è½½æ¨¡å‹ï¼š</strong></p> 
<pre><code class="prism language-python">git clone https<span class="token punctuation">:</span><span class="token operator">//</span>www<span class="token punctuation">.</span>modelscope<span class="token punctuation">.</span>cn<span class="token operator">/</span>ChineseAlpacaGroup<span class="token operator">/</span>llama<span class="token operator">-</span><span class="token number">3</span><span class="token operator">-</span>chinese<span class="token operator">-</span>8b<span class="token operator">-</span>instruct<span class="token punctuation">.</span>git
</code></pre> 
<p><strong>step 3 å®‰è£…å¿…è¦çš„åŒ…ï¼š</strong></p> 
<pre><code class="prism language-python">pip install fastapi uvicorn shortuuid sse_starlette peft bitsandbytes
pip install flash<span class="token operator">-</span>attn <span class="token operator">-</span><span class="token operator">-</span>no<span class="token operator">-</span>build<span class="token operator">-</span>isolation <span class="token comment"># å¦‚æœè¦ä½¿ç”¨flash-attentionçš„è¯</span>
</code></pre> 
<p><strong>step 4 æœåŠ¡å¯åŠ¨ï¼š</strong><br> æœåŠ¡å¯åŠ¨çš„ä»£ç å¦‚ä¸‹ï¼Œ<code>--base_model</code> æ›¿æ¢ä¸ºè‡ªå·±çš„æ¨¡å‹è·¯å¾„ï¼Œ<code>--load_in_4bit</code> æŒ‡å®šäº†é‡‡ç”¨ 4bit é‡åŒ–ã€‚</p> 
<p><strong>æ³¨æ„ï¼šå¦‚æœé‡‡ç”¨ä¸é‡åŒ–çš„æ–¹æ¡ˆï¼Œæ˜¾å­˜å ç”¨12Gï¼Œå›å¤éå¸¸æ…¢ï¼Œæœ‰è¯·æ±‚è¿‡æ¥æ˜¾å­˜å ç”¨æœ€é«˜è¿‘14Gï¼Œè€Œé‡‡ç”¨4bit é‡åŒ–ï¼Œæ˜¾å­˜åªå ç”¨ 6Gã€‚</strong></p> 
<pre><code class="prism language-python">python scripts<span class="token operator">/</span>oai_api_demo<span class="token operator">/</span>openai_api_server<span class="token punctuation">.</span>py \
<span class="token operator">-</span><span class="token operator">-</span>base_model <span class="token operator">/</span>path<span class="token operator">/</span>to<span class="token operator">/</span>models<span class="token operator">/</span>llama<span class="token operator">-</span><span class="token number">3</span><span class="token operator">-</span>chinese<span class="token operator">-</span>8b<span class="token operator">-</span>instruct<span class="token operator">/</span> \
<span class="token operator">-</span><span class="token operator">-</span>gpus <span class="token number">2</span> \
<span class="token operator">-</span><span class="token operator">-</span>port <span class="token number">2001</span> \
<span class="token operator">-</span><span class="token operator">-</span>load_in_4bit \
<span class="token operator">-</span><span class="token operator">-</span>use_flash_attention_2 \
<span class="token operator">&gt;</span> log<span class="token punctuation">.</span>txt <span class="token number">2</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span><span class="token number">1</span> <span class="token operator">&amp;</span>
</code></pre> 
<p><strong>step 5 æœåŠ¡è°ƒç”¨ï¼š</strong><br> ä¸ºäº†å®ç° LLM çš„ä¸ªæ€§åŒ–å›ç­”ï¼Œå½“ç„¶éœ€è¦ç»™å®ƒè®¾å®šä¸€ä¸ªç‰¹å®šçš„äººè®¾å•¦ ~ ï¼Œè¿™ä¸€æ­¥å¯ä»¥é€šè¿‡<strong>äººè®¾æç¤ºè¯</strong>æ¥è½»æ¾æå®šã€‚ä¸‹é¢ç»™ä¸€ä¸ªç¤ºä¾‹ï¼š</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> openai <span class="token keyword">import</span> OpenAI

<span class="token comment"># æšä¸¾æ‰€æœ‰å¯ç”¨çš„æ¨¡å‹æœåŠ¡</span>
model_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'llama3-8b'</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'api_key'</span><span class="token punctuation">:</span> <span class="token string">'sk-xxx'</span><span class="token punctuation">,</span>
        <span class="token string">'base_url'</span><span class="token punctuation">:</span> <span class="token string">'http://10.18.32.170:2001/v1'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment"># è®¾ç½®äººè®¾æç¤ºè¯ï¼Œæ ¹æ®éœ€è¦è¿›è¡Œä¿®æ”¹</span>
prompt_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'llama3-8b'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span><span class="token string">"role"</span><span class="token punctuation">:</span> <span class="token string">"system"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> <span class="token string">"ä½ æ˜¯çŒ´å“¥çš„å…¨èƒ½å°åŠ©æ‰‹ï¼Œä¸ŠçŸ¥å¤©æ–‡ï¼Œä¸‹çŸ¥åœ°ç†ï¼Œå¯è§£å†³ç”Ÿæ´»ä¸­çš„ä¸€åˆ‡å›°æ‰°ã€‚"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">LLM_API</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> api_key<span class="token punctuation">,</span> base_url<span class="token punctuation">,</span> model<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>client <span class="token operator">=</span>  OpenAI<span class="token punctuation">(</span>
            api_key<span class="token operator">=</span>api_key<span class="token punctuation">,</span>
            base_url<span class="token operator">=</span>base_url<span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>model <span class="token operator">=</span> model
    
    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> messages<span class="token punctuation">,</span> temperature<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        completion <span class="token operator">=</span> self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>chat<span class="token punctuation">.</span>completions<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
            model<span class="token operator">=</span>self<span class="token punctuation">.</span>model<span class="token punctuation">,</span>
            messages<span class="token operator">=</span>messages<span class="token punctuation">,</span>
            temperature<span class="token operator">=</span>temperature<span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
        <span class="token keyword">return</span> completion<span class="token punctuation">.</span>choices<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>message<span class="token punctuation">.</span>content

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    model <span class="token operator">=</span> <span class="token string">'llama3-8b'</span>
    llm <span class="token operator">=</span> LLM_API<span class="token punctuation">(</span>model_dict<span class="token punctuation">[</span>model<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'api_key'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> model_dict<span class="token punctuation">[</span>model<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'base_url'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> model<span class="token punctuation">)</span>
    user_question <span class="token operator">=</span> <span class="token string">"ä½ æ˜¯è°"</span>
    messages <span class="token operator">=</span> prompt_dict<span class="token punctuation">[</span>model<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">"role"</span><span class="token punctuation">:</span> <span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> user_question<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>llm<span class="token punctuation">(</span>messages<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>å¦‚æœæœ¬åœ°æ²¡æœ‰ GPU èµ„æºéƒ¨ç½² å¤§è¯­è¨€æ¨¡å‹ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©è°ƒç”¨äº‘ç«¯ API æ¥å®ç°è¿™ä¸€æ­¥ï¼ŒçŒ´å“¥ä¸‹ä¸€ç¯‡å°±æ¥æ¢³ç†ä¸€ä¸‹ï¼š<br> <strong>æˆ‘ä»¬éƒ½å¯ä»¥è°ƒç”¨å“ªäº›å…è´¹çš„ LLM API?</strong></p> 
<p><strong>æ¬¢è¿è¿½æ›´ï¼</strong></p> 
<h3><a id="3_TTS_168"></a>3 è¯­éŸ³ç”Ÿæˆï¼ˆTTSï¼‰</h3> 
<p>ä¸ºäº†å°†å¤§æ¨¡å‹è¾“å‡ºçš„æ–‡å­—ç”Ÿæˆè¯­éŸ³è¿”å›ï¼Œè¿™é‡Œæˆ‘ä»¬é‡‡ç”¨ 2024.5 åˆšå¼€æºçš„é¡¹ç›® - ChatTTSï¼Œç”Ÿæˆæ•ˆæœéå¸¸æƒŠè‰³ã€‚å…³äº ChatTTS çš„å…·ä½“ä½¿ç”¨ï¼ŒçŒ´å“¥ä¼šå•ç‹¬å‡ºä¸€ç¯‡æ•™ç¨‹ï¼Œå¦åˆ™æœ¬æ–‡çš„ç¯‡å¹…å°±å¤ªé•¿äº†ã€‚</p> 
<p>åŒæ ·è¿˜æ˜¯é‡‡ç”¨ FastAPI æ¥å®ç°å°è£…ï¼Œå’Œéƒ¨ç½² ASR æ¨¡å‹ç±»ä¼¼ï¼Œåœ¨æ­¤ä¸å†èµ˜è¿°ã€‚</p> 
<p><strong>ï¼ˆPSï¼šéœ€è¦æºç çš„å¯åˆ°æ–‡æœ«è‡ªå–~ï¼‰</strong></p> 
<h3><a id="4_Gradio_176"></a>4 å‰ç«¯äº¤äº’å®ç°ï¼ˆGradioï¼‰</h3> 
<p>Gradioæ˜¯ä¸€ä¸ªç”¨äºå¿«é€Ÿåˆ›å»ºæœºå™¨å­¦ä¹ æ¨¡å‹çš„äº¤äº’å¼æ¼”ç¤ºçš„å¼€æºåº“ã€‚å®ƒå…è®¸å¼€å‘è€…é€šè¿‡ç®€å•çš„Pythonä»£ç å¿«é€Ÿæ„å»ºä¸€ä¸ªç”¨æˆ·ç•Œé¢ã€‚</p> 
<p>ä¸ºäº†å¿«é€Ÿæ­å»ºåº”ç”¨ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦è¯·å‡ºæˆ‘ä»¬çš„è€æœ‹å‹ - Gradioï¼Œäº¤äº’ç•Œé¢å¦‚å›¾æ‰€ç¤ºï¼š<br> <img src="https://images2.imgbox.com/4f/55/Ysyiqtxp_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>WebUI ä»£ç å¥‰ä¸Šï¼š</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> gradio <span class="token keyword">as</span> gr 
<span class="token keyword">from</span> speech_client <span class="token keyword">import</span> asr_damo_api<span class="token punctuation">,</span> tts_chat_api
<span class="token keyword">from</span> llm_client <span class="token keyword">import</span> LLM_API<span class="token punctuation">,</span> prompt_dict<span class="token punctuation">,</span> model_dict

host_avatar <span class="token operator">=</span> <span class="token string">'assets/host_image.png'</span>
user_avatar <span class="token operator">=</span> <span class="token string">'assets/user_image.png'</span>

model <span class="token operator">=</span> <span class="token string">'llama3-8b'</span>
<span class="token comment"># model = 'gpt-4'</span>
llm <span class="token operator">=</span> LLM_API<span class="token punctuation">(</span>model_dict<span class="token punctuation">[</span>model<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'api_key'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> model_dict<span class="token punctuation">[</span>model<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'base_url'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> model<span class="token punctuation">)</span>

<span class="token keyword">with</span> gr<span class="token punctuation">.</span>Blocks<span class="token punctuation">(</span>theme<span class="token operator">=</span>gr<span class="token punctuation">.</span>themes<span class="token punctuation">.</span>ThemeClass<span class="token punctuation">)</span> <span class="token keyword">as</span> demo<span class="token punctuation">:</span>
    state <span class="token operator">=</span> gr<span class="token punctuation">.</span>State<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'messages'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">with</span> gr<span class="token punctuation">.</span>Row<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> gr<span class="token punctuation">.</span>Column<span class="token punctuation">(</span>scale<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            user_chatbot <span class="token operator">=</span> gr<span class="token punctuation">.</span>Chatbot<span class="token punctuation">(</span>
                value<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">'æ¬¢è¿ä½ æ¥ï¼'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                elem_classes<span class="token operator">=</span><span class="token string">"app-chatbot"</span><span class="token punctuation">,</span>
                avatar_images<span class="token operator">=</span><span class="token punctuation">[</span>host_avatar<span class="token punctuation">,</span> user_avatar<span class="token punctuation">]</span><span class="token punctuation">,</span>
                label<span class="token operator">=</span><span class="token string">"äº¤äº’åŒº"</span><span class="token punctuation">,</span>
                show_label<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                bubble_full_width<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
                height<span class="token operator">=</span><span class="token number">800</span><span class="token punctuation">)</span>
        <span class="token keyword">with</span> gr<span class="token punctuation">.</span>Column<span class="token punctuation">(</span>scale<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            audio_user <span class="token operator">=</span> gr<span class="token punctuation">.</span>Audio<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"User Input"</span><span class="token punctuation">,</span> sources<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'microphone'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'filepath'</span><span class="token punctuation">)</span>
            user_text <span class="token operator">=</span> gr<span class="token punctuation">.</span>Textbox<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"è¯­éŸ³è¯†åˆ«å†…å®¹"</span><span class="token punctuation">)</span>
            user_submit <span class="token operator">=</span> gr<span class="token punctuation">.</span>Button<span class="token punctuation">(</span><span class="token string">"æäº¤"</span><span class="token punctuation">,</span> variant<span class="token operator">=</span><span class="token string">"primary"</span><span class="token punctuation">)</span>
            audio_bot <span class="token operator">=</span> gr<span class="token punctuation">.</span>Audio<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"Bot Output"</span><span class="token punctuation">,</span> autoplay<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'filepath'</span><span class="token punctuation">)</span>
   
    <span class="token keyword">def</span> <span class="token function">process_audio</span><span class="token punctuation">(</span>audio<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Processing audio:'</span><span class="token punctuation">,</span> audio<span class="token punctuation">)</span>
        text <span class="token operator">=</span> asr_damo_api<span class="token punctuation">(</span>audio<span class="token punctuation">,</span> time_stamp<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> srt<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>
        <span class="token keyword">return</span> text

    <span class="token keyword">def</span> <span class="token function">user_submit_handler</span><span class="token punctuation">(</span>user_text<span class="token punctuation">,</span> state<span class="token punctuation">,</span> chatbot<span class="token punctuation">)</span><span class="token punctuation">:</span>
        chatbot<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>user_text<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">yield</span> <span class="token punctuation">(</span>chatbot<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
        messages <span class="token operator">=</span> state<span class="token punctuation">[</span><span class="token string">'messages'</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>messages<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            messages <span class="token operator">=</span> prompt_dict<span class="token punctuation">[</span>model<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">"role"</span><span class="token punctuation">:</span> <span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> user_text<span class="token punctuation">}</span><span class="token punctuation">]</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            messages<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"role"</span><span class="token punctuation">:</span> <span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> user_text<span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>messages<span class="token punctuation">)</span>
        response <span class="token operator">=</span> llm<span class="token punctuation">(</span>messages<span class="token punctuation">)</span>
        chatbot<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">)</span>
        messages<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"role"</span><span class="token punctuation">:</span> <span class="token string">"assistant"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> response<span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>messages<span class="token punctuation">)</span>
        state<span class="token punctuation">[</span><span class="token string">'messages'</span><span class="token punctuation">]</span> <span class="token operator">=</span> messages
        audio <span class="token operator">=</span> tts_chat_api<span class="token punctuation">(</span>response<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>audio<span class="token punctuation">)</span>
        <span class="token keyword">yield</span> <span class="token punctuation">(</span>chatbot<span class="token punctuation">,</span> audio<span class="token punctuation">)</span>
    
    audio_user<span class="token punctuation">.</span>stop_recording<span class="token punctuation">(</span>process_audio<span class="token punctuation">,</span> inputs<span class="token operator">=</span>audio_user<span class="token punctuation">,</span> outputs<span class="token operator">=</span>user_text<span class="token punctuation">)</span>
    user_submit<span class="token punctuation">.</span>click<span class="token punctuation">(</span>user_submit_handler<span class="token punctuation">,</span> inputs<span class="token operator">=</span><span class="token punctuation">[</span>user_text<span class="token punctuation">,</span> state<span class="token punctuation">,</span> user_chatbot<span class="token punctuation">]</span><span class="token punctuation">,</span> outputs<span class="token operator">=</span><span class="token punctuation">[</span>user_chatbot<span class="token punctuation">,</span> audio_bot<span class="token punctuation">]</span><span class="token punctuation">)</span>

demo<span class="token punctuation">.</span>launch<span class="token punctuation">(</span>server_name<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> server_port<span class="token operator">=</span><span class="token number">7861</span><span class="token punctuation">)</span>
</code></pre> 
<p>æœ€åæˆ‘ä»¬æ¥çœ‹ä¸‹æ•ˆæœï¼š</p> 
<p></p> 
<div class="csdn-video-box"> 
 <iframe id="EPMLNDff-1718342864805" frameborder="0" src="https://live.csdn.net/v/embed/399092" allowfullscreen="true" data-mediaembed="csdn"></iframe> 
 <p>è¯­éŸ³å¯¹è¯æœºå™¨äºº-ä¸ªäººAIå°åŠ©æ‰‹</p> 
</div> 
<p></p> 
<h2><a id="_247"></a>æœªå®Œå¾…ç»­</h2> 
<p>è‡³æ­¤ï¼Œä¸€ä¸ªè¯­éŸ³å¯¹è¯äº¤äº’ç³»ç»Ÿå°±æ­å»ºå¥½äº†ï¼Œå½“ç„¶ç›®å‰åªæ˜¯ä¸ºäº†æ¼”ç¤ºåŸºæœ¬åŠŸèƒ½ï¼Œç•Œé¢è¿˜æ¯”è¾ƒç®€é™‹ï¼Œåœ¨æ­¤åŸºç¡€ä¸Š ï¼Œè¿˜å¯ä»¥å¢åŠ æ›´å¤šåŠŸèƒ½ï¼š</p> 
<ul><li>ASR : ç›®å‰é‡‡ç”¨çš„ FunASR æ¨¡å‹ï¼Œåœ¨æœ‰å™ªå£°æƒ…å†µä¸‹è¯†åˆ«æ•ˆæœè¿˜æœ‰å¾…å¢å¼ºï¼Œéœ€è¦æ‰¾åˆ°æ›´æœ‰æ•ˆçš„å¹³æ›¿ï¼›</li><li>LLMï¼šæ¨¡å‹æœ¬åœ°éƒ¨ç½²å¯¹å¾ˆå¤šå°ä¼™ä¼´è¿˜æ˜¯æœ‰ä¸€å®šé—¨æ§›ï¼Œéœ€è¦æ‰¾åˆ°å¹³ä»· or å…è´¹çš„äº‘ç«¯ API</li><li>TTSï¼šChatTTSçš„æ•ˆæœéå¸¸ä¸é”™ï¼Œåç»­å¯ä»¥å¢åŠ è¯´è¯äººèº«ä»½ï¼Œå®ç°æ›´ä¸°å¯Œçš„è¾“å‡ºï¼›æ”¯æŒæµå¼å¯¹è¯ï¼Œåƒ GPT-4o é‚£æ ·è‡ªç„¶æ‰“æ–­ã€‚</li></ul> 
<p>å¦‚æœæœ¬æ–‡å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿<strong>ç‚¹èµæ”¶è—</strong>å¤‡ç”¨ï¼</p> 
<p>çŒ´å“¥ä¸€ç›´åœ¨åš AI é¢†åŸŸçš„ç ”å‘å’Œæ¢ç´¢ï¼Œä¼šé™†ç»­è·Ÿå¤§å®¶åˆ†äº«è·¯ä¸Šçš„æ€è€ƒå’Œå¿ƒå¾—ã€‚</p> 
<p>æœ€è¿‘å¼€å§‹è¿è¥ä¸€ä¸ªå…¬ä¼—å·ï¼Œæ—¨åœ¨åˆ†äº«å…³äºAIæ•ˆç‡å·¥å…·ã€è‡ªåª’ä½“å‰¯ä¸šçš„ä¸€åˆ‡ã€‚ç”¨å¿ƒåšå†…å®¹ï¼Œä¸è¾œè´Ÿæ¯ä¸€ä»½å…³æ³¨ã€‚</p> 
<p>å¦‚éœ€è¦è·å–æœ¬é¡¹ç›®çš„æºç ï¼Œå¯å…³æ³¨åå°å‘é€ â€œæœºå™¨äººâ€ è·å–ğŸ‘‡ã€‚<br> <img src="https://images2.imgbox.com/d4/11/8MC4zy2x_o.png" alt=""></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e6e5d0b8398eb7134b752d69116c2b69/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">AI å®šä½ï¼GeoSpyAIä¸Šä¼ ä¸€å¼ å›¾ç‰‡åˆ†æå…·ä½“ä½ç½® ä¸å¯æ€è®®! ! !</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9999ff15583194f29125f79e1336b8df/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">spring boot3ç™»å½•å¼€å‘-é‚®ç®±ç™»å½•/æ³¨å†Œæ¥å£å®ç°</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§å’–.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>