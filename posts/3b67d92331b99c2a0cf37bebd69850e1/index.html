<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vue3前端excel导出；组件表格，自定义表格导出；Vue3 &#43; xlsx &#43; xlsx-style - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/3b67d92331b99c2a0cf37bebd69850e1/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="vue3前端excel导出；组件表格，自定义表格导出；Vue3 &#43; xlsx &#43; xlsx-style">
  <meta property="og:description" content="当画面有自定义的表格或者样式过于复杂的表格时，导出功能可以由前端实现
1. 使用的插件 ： sheet.js-xlsx 文档地址：https://docs.sheetjs.com/
中文地址：https://geekdaxue.co/read/SheetJS-docs-zh/README.md
xlsx-style：https://www.npmjs.com/package/xlsx-style
2. 安装引用 安装插件-vue3
yarn add xlsx yarn add xlsx-style-vite （有样式需求才需要安装；背景色等） 引用插件
import * as XLSX from &#39;xlsx&#39;; import * as XLSX_STYLE from &#39;xlsx-style-vite&#39; 3. 组件表格的导出(无样式) 以ant design vue 表格为例，只导出表格内容
&lt;a-table :columns=&#34;columns&#34; :dataSource=&#34;detaildata&#34; :scroll=&#34;{ x: &#39;max-content&#39;,y:700 }&#34; &gt;&lt;/table?&gt; &lt;a-button @click=&#34;exportData&#34;&gt;导出&lt;/a-button&gt; &lt;script&gt; //数据处理为数组 const transData=(columns, tableList)=&gt; { const obj = columns.reduce((acc, cur) =&gt; { if (!acc.titles &amp;&amp; !acc.keys) { acc.titles = []; acc.keys = []; } acc.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-02-20T11:02:37+08:00">
    <meta property="article:modified_time" content="2024-02-20T11:02:37+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vue3前端excel导出；组件表格，自定义表格导出；Vue3 &#43; xlsx &#43; xlsx-style</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><strong>当画面有自定义的表格或者样式过于复杂的表格时，导出功能可以由前端实现</strong></p> 
<h4><a id="1___sheetjsxlsx_1"></a>1. 使用的插件 ： sheet.js-xlsx</h4> 
<p>文档地址：<a href="https://docs.sheetjs.com/" rel="nofollow">https://docs.sheetjs.com/</a><br> 中文地址：<a href="https://geekdaxue.co/read/SheetJS-docs-zh/README.md" rel="nofollow">https://geekdaxue.co/read/SheetJS-docs-zh/README.md</a><br> xlsx-style：<a href="https://www.npmjs.com/package/xlsx-style" rel="nofollow">https://www.npmjs.com/package/xlsx-style</a><br> <img src="https://images2.imgbox.com/7a/7b/QhTuCPtl_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2__6"></a>2. 安装引用</h4> 
<p>安装插件-vue3</p> 
<pre><code class="prism language-typescript">yarn add xlsx 
yarn add xlsx<span class="token operator">-</span>style<span class="token operator">-</span>vite （有样式需求才需要安装；背景色等）
</code></pre> 
<p>引用插件</p> 
<pre><code class="prism language-typescript"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> <span class="token constant">XLSX</span> <span class="token keyword">from</span> <span class="token string">'xlsx'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> <span class="token constant">XLSX_STYLE</span> <span class="token keyword">from</span> <span class="token string">'xlsx-style-vite'</span>
</code></pre> 
<h4><a id="3__18"></a>3. 组件表格的导出(无样式)</h4> 
<p>以ant design vue 表格为例，只导出表格内容</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a-table</span> <span class="token attr-name">:columns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>columns<span class="token punctuation">"</span></span> <span class="token attr-name">:dataSource</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>detaildata<span class="token punctuation">"</span></span> <span class="token attr-name">:scroll</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{ x: 'max-content',y:700 }<span class="token punctuation">"</span></span> <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table?</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a-button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>exportData<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>导出<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a-button</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
   <span class="token comment">//数据处理为数组</span>
	<span class="token keyword">const</span> <span class="token function-variable function">transData</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token parameter">columns<span class="token punctuation">,</span> tableList</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
       <span class="token keyword">const</span> obj <span class="token operator">=</span> columns<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">acc<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>acc<span class="token punctuation">.</span>titles <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>acc<span class="token punctuation">.</span>keys<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
           acc<span class="token punctuation">.</span>titles <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
           acc<span class="token punctuation">.</span>keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         acc<span class="token punctuation">.</span>titles<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>
         acc<span class="token punctuation">.</span>keys<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>dataIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">return</span> acc<span class="token punctuation">;</span>
       <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">const</span> tableBody <span class="token operator">=</span> tableList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span>i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
         <span class="token keyword">return</span> obj<span class="token punctuation">.</span>keys<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span>index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">return</span> <span class="token punctuation">[</span> obj<span class="token punctuation">.</span>titles<span class="token punctuation">,</span> <span class="token operator">...</span>tableBody <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
     <span class="token keyword">const</span> <span class="token function-variable function">exportData</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
          <span class="token keyword">const</span> tableData <span class="token operator">=</span> <span class="token function">transData</span><span class="token punctuation">(</span>
              columns<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
              detaildata<span class="token punctuation">.</span>value
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token comment">// 将数据数组转换为工作表</span>
          <span class="token keyword">const</span> ws <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">aoa_to_sheet</span><span class="token punctuation">(</span>tableData<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token comment">// 创建 workbook</span>
          <span class="token keyword">const</span> wb <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">book_new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          ws<span class="token punctuation">[</span><span class="token string">'!ref'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">A1:AI</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>tableData<span class="token punctuation">.</span>length<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
          <span class="token comment">//设置列宽</span>
          ws<span class="token punctuation">[</span><span class="token string">"!cols"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{<!-- --></span><span class="token literal-property property">wpx</span><span class="token operator">:</span> <span class="token number">120</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
            <span class="token punctuation">{<!-- --></span><span class="token literal-property property">wpx</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span><span class="token literal-property property">wpx</span><span class="token operator">:</span> <span class="token number">110</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span><span class="token literal-property property">wpx</span><span class="token operator">:</span> <span class="token number">110</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token comment">//合并单元格</span>
          ws<span class="token punctuation">[</span><span class="token string">'!merges'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">s</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">r</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token literal-property property">e</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">r</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>
          <span class="token comment">// 将 工作表 添加到 workbook</span>
          <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">book_append_sheet</span><span class="token punctuation">(</span>wb<span class="token punctuation">,</span> ws<span class="token punctuation">,</span> <span class="token string">'Sheet1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token comment">// 将 workbook 写入文件</span>
          <span class="token constant">XLSX</span><span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>wb<span class="token punctuation">,</span> <span class="token string">'tablename.xlsx'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h4><a id="3__div_67"></a>3. 自定义表格的导出 (div拼成的表格)</h4> 
<p>比如这种前端拼成的，又附带各种样式的表格<br> <img src="https://images2.imgbox.com/41/2f/IlkNdiOD_o.png" alt="在这里插入图片描述"><br> <strong>一些常用的格式：</strong><br> （1）：合并单元格<br> （2）：列宽<br> （3）：背景色<br> （4）：字体相关-大小粗细颜色字体等<br> （5）：表格线，边框<br> 详细的格式可以参考：<br> <a href="https://www.jianshu.com/p/869375439fee" rel="nofollow">https://www.jianshu.com/p/869375439fee</a><br> <a href="https://www.npmjs.com/package/xlsx-style" rel="nofollow">https://www.npmjs.com/package/xlsx-style</a></p> 
<pre><code class="prism language-typescript">数据处理就不写了，数据处理为数组就可以了
<span class="token keyword">const</span> <span class="token function-variable function">toExcel</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
	<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">[</span>
	        <span class="token punctuation">[</span><span class="token string">'左上表头'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">'右上'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	        <span class="token punctuation">[</span><span class="token string">'标题1'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	        <span class="token punctuation">[</span><span class="token string">'标题'</span><span class="token punctuation">,</span><span class="token string">'测试合并'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	        <span class="token punctuation">[</span><span class="token string">'固定标题'</span><span class="token punctuation">,</span><span class="token string">'123'</span><span class="token punctuation">,</span><span class="token string">'123'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	        <span class="token punctuation">[</span><span class="token string">'左下表头'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">'右下'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
			<span class="token punctuation">[</span><span class="token string">'2021'</span><span class="token punctuation">,</span><span class="token string">'￥28337'</span><span class="token punctuation">,</span><span class="token string">'测试数据'</span><span class="token punctuation">,</span><span class="token string">'北京'</span><span class="token punctuation">,</span><span class="token string">'黑龙江'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
			<span class="token operator">...</span><span class="token operator">...</span>
	    <span class="token punctuation">]</span>
	<span class="token keyword">const</span> worksheet <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">aoa_to_sheet</span><span class="token punctuation">(</span><span class="token punctuation">[</span>headers<span class="token punctuation">,</span> <span class="token operator">...</span>data<span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">book_new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	worksheet<span class="token punctuation">[</span><span class="token string">'!ref'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">A1:AI</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>data<span class="token punctuation">.</span>length<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
	
	<span class="token comment">//列宽 按excel的列顺序排列，对应A列,B列, C列......</span>
	worksheet<span class="token punctuation">[</span><span class="token string">"!cols"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
	  <span class="token punctuation">{<!-- --></span>wpx<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
	  <span class="token punctuation">{<!-- --></span>wpx<span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	  <span class="token punctuation">{<!-- --></span>wpx<span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	  <span class="token punctuation">{<!-- --></span>wpx<span class="token operator">:</span> <span class="token number">110</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
	  <span class="token punctuation">{<!-- --></span>wpx<span class="token operator">:</span> <span class="token number">110</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">]</span><span class="token punctuation">;</span>
	
	<span class="token comment">/* 
	合并单元格 默认合并当前格的右侧格子
	{ s: { r: 0, c: 0 }, e: { r: 0, c: 1 } }
	A1 与 B1 合并 内容为 A1 的内容
	
	s：start 合并开始 e：end 合并结束
	r：row 行 c：col 列 
	*/</span>
	
	worksheet<span class="token punctuation">[</span><span class="token string">'!merges'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
	  <span class="token punctuation">{<!-- --></span> s<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> r<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> e<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> r<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
	  <span class="token punctuation">{<!-- --></span> s<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> r<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> e<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> r<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">5</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
	  <span class="token punctuation">{<!-- --></span> s<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> r<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> e<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> r<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
	  <span class="token operator">...</span><span class="token operator">...</span>
	<span class="token punctuation">]</span><span class="token punctuation">;</span>
	
	<span class="token comment">//表格详细样式</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> worksheet<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	   <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token string">'!ref'</span> <span class="token operator">||</span> key <span class="token operator">==</span> <span class="token string">'!merges'</span> <span class="token operator">||</span> key <span class="token operator">==</span> <span class="token string">'!cols'</span> <span class="token operator">||</span> key <span class="token operator">==</span> <span class="token string">'!rows'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	     <span class="token keyword">continue</span>
	   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token comment">//通过key值来选择筛选想要的设置样式的单元格</span>
	     <span class="token keyword">if</span> <span class="token punctuation">(</span>key<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">'1'</span><span class="token operator">||</span>key<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">'5'</span><span class="token operator">||</span> key <span class="token operator">==</span> <span class="token string">'A2'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	        worksheet<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span>s <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 设置单元格样式</span>
	            fill<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 设置背景色</span>
	              fgColor<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> rgb<span class="token operator">:</span> <span class="token string">'F2F3F7'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
	            <span class="token punctuation">}</span><span class="token punctuation">,</span>
	            font<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 设置字体</span>
	              name<span class="token operator">:</span> <span class="token string">'等线'</span><span class="token punctuation">,</span> <span class="token comment">// 字体名称</span>
	              sz<span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token comment">// 字体大小</span>
	              bold<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 字体是否加粗</span>
	              color<span class="token operator">:</span><span class="token punctuation">{<!-- --></span> <span class="token comment">//字体颜色</span>
	                    rgb<span class="token operator">:</span><span class="token string">'ed263d'</span>
	               <span class="token punctuation">}</span>
	            <span class="token punctuation">}</span><span class="token punctuation">,</span>
	            border<span class="token operator">:</span><span class="token punctuation">{<!-- --></span> <span class="token comment">//设置边框</span>
	              top<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
	                  style<span class="token operator">:</span> <span class="token string">'thin'</span><span class="token punctuation">,</span>
	                  color<span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
	                      rgb<span class="token operator">:</span><span class="token string">'e5e7eb'</span>
	                  <span class="token punctuation">}</span>
	              <span class="token punctuation">}</span><span class="token punctuation">,</span>
	              bottom<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
	                  style<span class="token operator">:</span> <span class="token string">'thin'</span><span class="token punctuation">,</span>
	                  color<span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
	                      rgb<span class="token operator">:</span><span class="token string">'e5e7eb'</span>
	                  <span class="token punctuation">}</span>
	              <span class="token punctuation">}</span>
	          <span class="token punctuation">}</span><span class="token punctuation">,</span>
	          alignment<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
	            horizontal<span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span> <span class="token comment">// 横向（向左、向右、居中）</span>
	            vertical<span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span> <span class="token comment">// 纵向（向上、向下、居中）</span>
	            wrapText<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 设置单元格自动换行，目前仅对非合并单元格生效</span>
	            indent<span class="token operator">:</span> <span class="token number">0</span> <span class="token comment">// 设置单元格缩进</span>
	          <span class="token punctuation">}</span>
	        <span class="token punctuation">}</span>
	     <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token string">'B1'</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	     	<span class="token operator">...</span><span class="token operator">...</span>
	     <span class="token punctuation">}</span>
	   <span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	
	<span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">book_append_sheet</span><span class="token punctuation">(</span>workbook<span class="token punctuation">,</span> worksheet<span class="token punctuation">,</span> <span class="token string">'Sheet1'</span><span class="token punctuation">)</span>
	<span class="token keyword">const</span> tmpDown <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
	    <span class="token function">s2ab</span><span class="token punctuation">(</span>
	    <span class="token constant">XLSX_STYLE</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>workbook<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
	        bookType<span class="token operator">:</span> <span class="token string">'xlsx'</span><span class="token punctuation">,</span>
	        bookSST<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
	        type<span class="token operator">:</span> <span class="token string">'binary'</span><span class="token punctuation">,</span>
	        cellStyles<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
	    <span class="token punctuation">}</span><span class="token punctuation">)</span>
	    <span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token function">downloadExcelFile</span><span class="token punctuation">(</span>tmpDown<span class="token punctuation">,</span> <span class="token string">'excelname'</span> <span class="token operator">+</span> <span class="token string">'.xlsx'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/*用到的方法*/</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">s2ab</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> ArrayBuffer <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> buf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayBuffer</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
    <span class="token keyword">const</span> view <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> s<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      view<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> buf
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> buf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Array</span></span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> s<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      buf<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> buf
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 使用 a 标签下载文件
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">downloadExcelFile</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> a_node <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
  a_node<span class="token punctuation">.</span>download <span class="token operator">=</span> fileName
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'msSaveOrOpenBlob'</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    window<span class="token punctuation">.</span>navigator<span class="token punctuation">.</span><span class="token function">msSaveOrOpenBlob</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
    a_node<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  a_node<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>参考文章：<a href="https://blog.csdn.net/Cai181191/article/details/131130926">https://blog.csdn.net/Cai181191/article/details/131130926</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4d6b931ddd90ec5ad4a346c22498a45b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【C#】使用代码实现龙年春晚扑克牌魔术（守岁共此时），代码实现篇</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b4b69ade719a874968f300265ba71e16/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Java】采用 Tabula 技术对 PDF 文件内表格进行数据提取</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>