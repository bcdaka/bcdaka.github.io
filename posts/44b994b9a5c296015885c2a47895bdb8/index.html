<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Hadoop 实战 | 词频统计WordCount - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/44b994b9a5c296015885c2a47895bdb8/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Hadoop 实战 | 词频统计WordCount">
  <meta property="og:description" content="词频统计 通过分析大量文本数据中的词频，可以识别常见词汇和短语，从而抽取文本的关键信息和概要，有助于识别文本中频繁出现的关键词，这对于理解文本内容和主题非常关键。同时，通过分析词在文本中的相对频率，可以帮助理解词在不同上下文中的含义和语境。
&#34;纽约时报&#34;评论数据集记录了有关《纽约时报》2017年1月至5月和2018年1月至4月发表的文章上的评论的信息。月度数据分为两个csv文件：一个用于包含发表评论的文章，另一个用于评论本身。评论的csv文件总共包含超过200万条评论，有34个特征，而文章的csv文件包含超过9000篇文章，有16个特征。
本实验需要提取其中的 articleID 和 snippet 字段进行词频统计
MapReduce 在Hadoop中，输入文件通常会通过InputFormat被分成一系列的逻辑分片，分片是输入文件的逻辑划分，每个分片由一个Mapper处理。
本实验中，WordCount通过MapReduce统计snippet 字段中每个单词出现的总次数。程序主要包括Mapper, Reducer, Driver三个部分。
自定义的Mapper和Reducer都要继承各自的父类。Mapper中的业务逻辑写在map()方法中，Reducer的业务逻辑写在reduce()方法中。整个程序还需要一个Driver来进行提交，提交的是一个描述了各种必要信息的job对象。
程序总体流程如下图所示。
Mapper Mapper的主要任务是处理输入分片并生成中间键值对，这些键值对将被传递给Reducer进行进一步处理，也就是对应的Map的过程。
在本实验中，Mapper需要将这行文本中的单词提取出来，针对每个单词输出一个&lt;word, 1&gt;的&lt;Key, Value&gt;对。之后MapReduce会对这些&lt;word,1&gt;进行排序重组，将相同的word放在一起，形成&lt;word, [1,1,1,1,1,1,1…]&gt;的&lt;Key,Value &gt;结构并传递给Reducer。
Reducer Reducer则以中间键值对为输入，将其按照键进行分组，并将每个组的值按一定规则合并成最终的输出。
注意在此阶段前，Hadoop框架会自行将中间键值对经过默认的排序分区分组，Key相同的单词会作为一组数据构成新的&lt;Key, Value&gt;对。
在本实验中，Reducer将集合里的1求和，再将单词（word）与这个和（sum）组成一个&lt;Key, Value&gt;，也就是&lt;word, sum&gt;输出。每一个输出就是一个单词和它的词频统计总和了。
Driver Driver是一个程序的主入口，负责配置和启动整个MapReduce任务。Driver类通常包含了整个MapReduce作业的配置信息、作业的输入路径、输出路径等信息，并启动MapReduce作业的执行。
总结 该程序基于Hadoop MapReduce框架实现了简单的单词计数功能，适用于大规模文本数据的并行处理。
PSEUDO-CODE 2 WordCount(词频统计)
/* Map函数，处理每一行的文本 */
1：input &lt;Key,Value&gt;； //Value使用Text类型表示文本行
2：从文本中提取文档ID和实际文本内容snippet；
3：使用空格、单引号和破折号作为分隔符，将文本snippet分词；
4：for 文本snippet中的每个单词：
5： 去除特殊字符后将&lt;word,1&gt;写入context，发射给Reducer；
6：end for
/* Reduce函数，处理相同键的所有值 */
1：input &lt;Key,Value&gt;，sum←0； //来自Map的&lt;word,[1,1,1…]&gt;
2：for Value的每个1：
3： 累加计数sum &#43;= 1；
代码 import java.io.IOException; import java.util.regex.*; import java.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-10T20:03:54+08:00">
    <meta property="article:modified_time" content="2024-01-10T20:03:54+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Hadoop 实战 | 词频统计WordCount</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3 style="margin-left:0px;text-align:justify;">词频统计</h3> 
<p style="margin-left:0;text-align:justify;">通过分析大量文本数据中的词频，可以识别常见词汇和短语，从而抽取文本的关键信息和概要，有助于识别文本中频繁出现的关键词，这对于理解文本内容和主题非常关键。同时，通过分析词在文本中的相对频率，可以帮助理解词在不同上下文中的含义和语境。</p> 
<p style="margin-left:0;text-align:justify;">"纽约时报"评论数据集记录了有关《纽约时报》2017年1月至5月和2018年1月至4月发表的文章上的评论的信息。月度数据分为两个csv文件：一个用于包含发表评论的文章，另一个用于评论本身。评论的csv文件总共包含超过200万条评论，有34个特征，而文章的csv文件包含超过9000篇文章，有16个特征。</p> 
<p style="margin-left:0;text-align:justify;">本实验需要提取其中的 articleID 和 snippet 字段进行词频统计</p> 
<h3 style="margin-left:0px;text-align:justify;">MapReduce</h3> 
<p style="margin-left:0;text-align:justify;">在Hadoop中，输入文件通常会通过InputFormat被分成一系列的逻辑分片，分片是输入文件的逻辑划分，每个分片由一个Mapper处理。</p> 
<p style="margin-left:0;text-align:justify;">本实验中，WordCount通过MapReduce统计snippet 字段中每个单词出现的总次数。程序主要包括Mapper, Reducer, Driver三个部分。</p> 
<p style="margin-left:0;text-align:justify;">自定义的Mapper和Reducer都要继承各自的父类。Mapper中的业务逻辑写在map()方法中，Reducer的业务逻辑写在reduce()方法中。整个程序还需要一个Driver来进行提交，提交的是一个描述了各种必要信息的job对象。</p> 
<p style="margin-left:0;text-align:justify;">程序总体流程如下图所示。</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<h4 style="margin-left:0;text-align:justify;"><a name="_Toc155442429">Mapper</a></h4> 
<p style="margin-left:0;text-align:justify;">Mapper的主要任务是处理输入分片并生成中间键值对，这些键值对将被传递给Reducer进行进一步处理，也就是对应的Map的过程。</p> 
<p style="margin-left:0;text-align:justify;">在本实验中，Mapper需要将这行文本中的单词提取出来，针对每个单词输出一个&lt;word, 1&gt;的&lt;Key, Value&gt;对。之后MapReduce会对这些&lt;word,1&gt;进行排序重组，将相同的word放在一起，形成&lt;word, [1,1,1,1,1,1,1…]&gt;的&lt;Key,Value &gt;结构并传递给Reducer。</p> 
<h4 style="margin-left:0;text-align:justify;"><a name="_Toc155442430">Reducer</a></h4> 
<p style="margin-left:0;text-align:justify;">Reducer则以中间键值对为输入，将其按照键进行分组，并将每个组的值按一定规则合并成最终的输出。</p> 
<p style="margin-left:0;text-align:justify;">注意在此阶段前，Hadoop框架会自行将中间键值对经过默认的排序分区分组，Key相同的单词会作为一组数据构成新的&lt;Key, Value&gt;对。</p> 
<p style="margin-left:0;text-align:justify;">在本实验中，Reducer将集合里的1求和，再将单词（word）与这个和（sum）组成一个&lt;Key, Value&gt;，也就是&lt;word, sum&gt;输出。每一个输出就是一个单词和它的词频统计总和了。</p> 
<h4 style="margin-left:0;text-align:justify;"><a name="_Toc155442431">Driver</a></h4> 
<p style="margin-left:0;text-align:justify;">Driver是一个程序的主入口，负责配置和启动整个MapReduce任务。Driver类通常包含了整个MapReduce作业的配置信息、作业的输入路径、输出路径等信息，并启动MapReduce作业的执行。</p> 
<h3 style="margin-left:0px;text-align:justify;">总结</h3> 
<p style="margin-left:0;text-align:justify;">该程序基于Hadoop MapReduce框架实现了简单的单词计数功能，适用于大规模文本数据的并行处理。</p> 
<div style="margin-left:0;text-align:center;"> 
 <hr> 
</div> 
<p style="margin-left:0;text-align:justify;"><strong>PSEUDO-CODE 2   </strong>WordCount(词频统计)</p> 
<div style="margin-left:0;text-align:center;"> 
 <hr> 
</div> 
<p style="margin-left:0;text-align:justify;"><strong>/* Map</strong><strong>函数，处理每一行的文本 */</strong></p> 
<p style="margin-left:0;text-align:justify;">1：<strong>input </strong>&lt;Key,Value&gt;；                                   //Value使用Text类型表示文本行</p> 
<p style="margin-left:0;text-align:justify;">2：从文本中提取文档ID和实际文本内容snippet；</p> 
<p style="margin-left:0;text-align:justify;">3：使用空格、单引号和破折号作为分隔符，将文本snippet分词；</p> 
<p style="margin-left:0;text-align:justify;">4：<strong>for </strong>文本snippet中的每个单词：</p> 
<p style="margin-left:0;text-align:justify;">5：     去除特殊字符后将&lt;word,1&gt;写入context，发射给Reducer；</p> 
<p style="margin-left:0;text-align:justify;">6：<strong>end for</strong></p> 
<p style="margin-left:0;text-align:justify;"><strong>/* Reduce</strong><strong>函数，处理相同键的所有值 */</strong></p> 
<p style="margin-left:0;text-align:justify;">1：<strong>input </strong>&lt;Key,<a name="_Hlk155375605">Value</a>&gt;，sum←0；             //来自Map的&lt;word,[1,1,1…]&gt;</p> 
<p style="margin-left:0;text-align:justify;">2：<strong>for </strong>Value的每个1：</p> 
<p style="margin-left:0;text-align:justify;">3：     累加计数sum += 1；</p> 
<div style="margin-left:0;text-align:center;"> 
 <hr> 
</div> 
<h3>代码</h3> 
<pre><code class="language-java">import java.io.IOException;
import java.util.regex.*;
import java.util.Iterator;
import java.util.StringTokenizer;
import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.fs.Path;
import org.apache.hadoop.io.IntWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Job;
import org.apache.hadoop.mapreduce.Mapper;
import org.apache.hadoop.mapreduce.Reducer;
import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;
import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;
import org.apache.hadoop.util.GenericOptionsParser;
public class WordCount {
    public WordCount() {
    }
     public static void main(String[] args) throws Exception {
        Configuration conf = new Configuration();
        String[] otherArgs = (new GenericOptionsParser(conf, args)).getRemainingArgs();
        if(otherArgs.length &lt; 2) {
            System.err.println("Usage: wordcount &lt;in&gt; [&lt;in&gt;...] &lt;out&gt;");
            System.exit(2);
        }
        Job job = Job.getInstance(conf, "word count");
        job.setJarByClass(WordCount.class);
        job.setMapperClass(WordCount.TokenizerMapper.class);
        job.setCombinerClass(WordCount.IntSumReducer.class);
        job.setReducerClass(WordCount.IntSumReducer.class);
        job.setOutputKeyClass(Text.class);
        job.setOutputValueClass(IntWritable.class); 
        for(int i = 0; i &lt; otherArgs.length - 1; ++i) {
            FileInputFormat.addInputPath(job, new Path(otherArgs[i]));
        }
        FileOutputFormat.setOutputPath(job, new Path(otherArgs[otherArgs.length - 1]));
        System.exit(job.waitForCompletion(true)?0:1);
    }

     public static class TokenizerMapper extends Mapper&lt;Object, Text, Text, IntWritable&gt; {
    	    private static final IntWritable one = new IntWritable(1);
    	    private Text word = new Text();

    	    public TokenizerMapper() {
    	    }

    	    public void map(Object key, Text value, Mapper&lt;Object, Text, Text, IntWritable&gt;.Context context)
    	            throws IOException, InterruptedException {
    	        // Split DocID and the actual text
    	        String DocId = value.toString().substring(0, value.toString().indexOf("\t"));
    	        String value_raw =  value.toString().substring(value.toString().indexOf("\t") + 1);
    	        
    	        // Reading input one line at a time and tokenizing by using space, "'", and "-" characters as tokenizers.
    	        StringTokenizer itr = new StringTokenizer(value_raw, " '-");
    	        
    	        // Iterating through all the words available in that line and forming the key/value pair.
    	        while (itr.hasMoreTokens()) {
    	          // Remove special characters
    	          word.set(itr.nextToken().replaceAll("[^a-zA-Z]", ""));
    	          if(word.toString() != "" &amp;&amp; !word.toString().isEmpty()){
    	        	  context.write(word, one);
    	          }
    	    }
    	}
     }
	public static class IntSumReducer extends Reducer&lt;Text, IntWritable, Text, IntWritable&gt; {
	        private IntWritable result = new IntWritable();
	        public IntSumReducer() {
	        }
	        public void reduce(Text key, Iterable&lt;IntWritable&gt; values, Reducer&lt;Text, IntWritable, Text, IntWritable&gt;.Context context) throws IOException, InterruptedException {
	            int sum = 0;
	            IntWritable val;
	            for(Iterator i$ = values.iterator(); i$.hasNext(); sum += val.get()) {
	                val = (IntWritable)i$.next();
	            }
	            this.result.set(sum);
	            context.write(key, this.result);
	        }
	    }
	}
     

</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/829cad58257935834ff4d8b300d9a9f8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">OFDM系统信道估计误码率matlab仿真,对比LS,LMMSE,LR-LMMSE三种信道估计算法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a21642be7cf6e705e636faf4691c9cd7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MySql的安装与IDEA配置Mysql数据库</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>