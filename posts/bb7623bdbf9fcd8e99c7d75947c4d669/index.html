<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【AI大模型】：结合wxauto实现智能微信聊天机器人 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/bb7623bdbf9fcd8e99c7d75947c4d669/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【AI大模型】：结合wxauto实现智能微信聊天机器人">
  <meta property="og:description" content="文章目录 🧐一、wxauto简介🎯二、wxauto的主要功能📦三、wxauto的安装与使用1. wxauto的安装2. wxauto的简单使用3. wxauto的消息对象 💻四、wxauto结合大模型实现简单的聊天机器人三、完整代码 🧐一、wxauto简介 wxauto 是我在2020年开发的一个基于 UIAutomation 的开源 Python 微信自动化库。Python 初学者也可以简单上手自动化微信操作。目前已实现很多日常的微信操作的自动化，如自动发送消息、自动添加好友、自动回复、自动获取聊天记录、图片、文件等功能，后续还会根据反馈更新更多功能。
wxauto的github链接：https://github.com/cluic/wxauto【点击跳转】
🎯二、wxauto的主要功能 消息发送：支持发送文字、图片、文件、@群好友、引用消息等功能聊天记录：可获取好友的聊天记录内容监听消息：实时获取指定监听好友（群）的新消息其他定制功能：根据需求定制自动化流程，满足各种特殊需求。 📦三、wxauto的安装与使用 1. wxauto的安装 安装 wxauto 非常简单，和其他第三方库一样在命令行输入以下命令即可：
pip install wxauto
pip install wxauto -i https://pypi.tuna.tsinghua.edu.cn/simple （换源安装）
注意： 目前wxauto只支持 Windows 10|11|Server2016&#43; 系统，苹果等电脑的系统并不支持，Python环境要求 Python：3.7&#43;（不支持3.7.6和3.8.1），注意！！！ Python版本不支持3.7.6和3.8.1，微信版本默认分支为微信3.9.11.17版本，使用前请先检查自己电脑微信是否为该版本，版本不同可能由于UI问题导致某些功能无法正常调用。
注意： 如果你的微信版本可以用的话，也不需要过多纠结这个。
2. wxauto的简单使用 注意： 在运行代码前一定要确保PC微信客户端已经登陆。
【示例1】：基于wxauto发送消息
使用场景：可以重复发送一样的内容达到消息轰炸
from wxauto import * wx = WeChat() content = &#39;hello world&#39; who = &#39;文件传输助手&#39; for i in range(15): wx.SendMsg(msg=content, who=who) 附带@好友的消息
from wxauto import * wx = WeChat() content = &#39;hello world&#39; who = &#39;文件传输助手&#39; name = &#39;文件传输助手&#39; wx.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-30T14:43:26+08:00">
    <meta property="article:modified_time" content="2024-07-30T14:43:26+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【AI大模型】：结合wxauto实现智能微信聊天机器人</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><ul><li><a href="#wxauto_2" rel="nofollow">🧐一、wxauto简介</a></li><li><a href="#wxauto_7" rel="nofollow">🎯二、wxauto的主要功能</a></li><li><a href="#wxauto_13" rel="nofollow">📦三、wxauto的安装与使用</a></li><li><ul><li><a href="#1_wxauto_14" rel="nofollow">1. wxauto的安装</a></li><li><a href="#2_wxauto_24" rel="nofollow">2. wxauto的简单使用</a></li><li><a href="#3_wxauto_143" rel="nofollow">3. wxauto的消息对象</a></li></ul> 
    </li><li><a href="#wxauto_187" rel="nofollow">💻四、wxauto结合大模型实现简单的聊天机器人</a></li><li><a href="#_206" rel="nofollow">三、完整代码</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<br> 
<img src="https://images2.imgbox.com/38/cc/3QLwOq7Q_o.png" alt="在这里插入图片描述"> 
<p></p> 
<h4><a id="wxauto_2"></a>🧐一、wxauto简介</h4> 
<p>wxauto 是我在2020年开发的一个基于 UIAutomation 的开源 Python 微信自动化库。Python 初学者也可以简单上手自动化微信操作。目前已实现很多日常的微信操作的自动化，如自动发送消息、自动添加好友、自动回复、自动获取聊天记录、图片、文件等功能，后续还会根据反馈更新更多功能。</p> 
<p><strong>wxauto的github链接</strong>：<a href="https://github.com/cluic/wxauto">https://github.com/cluic/wxauto【点击跳转】</a></p> 
<h4><a id="wxauto_7"></a>🎯二、wxauto的主要功能</h4> 
<ul><li><strong>消息发送</strong>：支持发送文字、图片、文件、@群好友、引用消息等功能</li><li><strong>聊天记录</strong>：可获取好友的聊天记录内容</li><li><strong>监听消息</strong>：实时获取指定监听好友（群）的新消息</li><li><strong>其他定制功能</strong>：根据需求定制自动化流程，满足各种特殊需求。</li></ul> 
<h4><a id="wxauto_13"></a>📦三、wxauto的安装与使用</h4> 
<h5><a id="1_wxauto_14"></a>1. wxauto的安装</h5> 
<p>安装 wxauto 非常简单，和其他第三方库一样在命令行输入以下命令即可：</p> 
<blockquote> 
 <p><strong><code>pip install wxauto</code></strong><br> <strong><code>pip install wxauto -i https://pypi.tuna.tsinghua.edu.cn/simple</code></strong> （<strong>换源安装</strong>）</p> 
</blockquote> 
<p><font color="red"><strong>注意：</strong></font> 目前<strong>wxauto</strong>只支持 <strong><code>Windows 10|11|Server2016+</code></strong> 系统，苹果等电脑的系统并不支持，Python环境要求 <strong><code>Python：3.7+（不支持3.7.6和3.8.1）</code></strong>，<font color="red"><strong>注意！！！</strong></font> <strong><code>Python版本不支持3.7.6和3.8.1</code></strong>，<strong>微信版本默认分支为微信3.9.11.17版本</strong>，使用前请先检查自己电脑微信是否为该版本，版本不同可能由于UI问题导致某些功能无法正常调用。</p> 
<p><font color="red"><strong>注意：</strong></font> 如果你的微信版本可以用的话，也不需要过多纠结这个。</p> 
<h5><a id="2_wxauto_24"></a>2. wxauto的简单使用</h5> 
<p><font color="red"><strong>注意：</strong></font> 在运行代码前一定要确保PC微信客户端已经登陆。<br> <strong>【示例1】：基于wxauto发送消息</strong><br> 使用场景：可以重复发送一样的内容达到消息轰炸</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> wxauto <span class="token keyword">import</span> <span class="token operator">*</span>
wx <span class="token operator">=</span> WeChat<span class="token punctuation">(</span><span class="token punctuation">)</span>
content <span class="token operator">=</span> <span class="token string">'hello world'</span>
who <span class="token operator">=</span> <span class="token string">'文件传输助手'</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    wx<span class="token punctuation">.</span>SendMsg<span class="token punctuation">(</span>msg<span class="token operator">=</span>content<span class="token punctuation">,</span> who<span class="token operator">=</span>who<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e1/86/g2421ety_o.png" alt="在这里插入图片描述"></p> 
<p><strong>附带@好友的消息</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> wxauto <span class="token keyword">import</span> <span class="token operator">*</span>
wx <span class="token operator">=</span> WeChat<span class="token punctuation">(</span><span class="token punctuation">)</span>
content <span class="token operator">=</span> <span class="token string">'hello world'</span>
who <span class="token operator">=</span> <span class="token string">'文件传输助手'</span>
name <span class="token operator">=</span> <span class="token string">'文件传输助手'</span>
wx<span class="token punctuation">.</span>SendMsg<span class="token punctuation">(</span>msg<span class="token operator">=</span>content<span class="token punctuation">,</span> who<span class="token operator">=</span>who<span class="token punctuation">,</span> at<span class="token operator">=</span>name<span class="token punctuation">)</span>  <span class="token comment"># 要 @ 的人</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/83/74/k88D46Od_o.png" alt="在这里插入图片描述"></p> 
<p><strong>发送图片/视频/文件消息SendFiles</strong><br> 参数说明：</p> 
<table><thead><tr><th>参数名</th><th>类型</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>filepath</td><td>str 或 list</td><td>/</td><td>指定文件路径，单个文件str，多个文件list</td></tr><tr><td>who</td><td>str</td><td>None</td><td>要发送给谁，默认则发送给当前打开的页面</td></tr></tbody></table> 
<pre><code class="prism language-python"><span class="token keyword">from</span> wxauto <span class="token keyword">import</span> <span class="token operator">*</span>
wx <span class="token operator">=</span> WeChat<span class="token punctuation">(</span><span class="token punctuation">)</span>
content <span class="token operator">=</span> <span class="token string">'hello world'</span>
who <span class="token operator">=</span> <span class="token string">'文件传输助手'</span>
<span class="token builtin">file</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">r'D:\软件\图片\荒.png'</span><span class="token punctuation">,</span>
    <span class="token string">r'D:\C语言学习资料\高质量的C-C++编程.pdf'</span>
<span class="token punctuation">]</span>
wx<span class="token punctuation">.</span>SendFiles<span class="token punctuation">(</span>filepath<span class="token operator">=</span><span class="token builtin">file</span><span class="token punctuation">,</span> who<span class="token operator">=</span>who<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/2d/46/CtumxMnO_o.png" alt="在这里插入图片描述"></p> 
<p><strong>聊天窗口消息获取</strong></p> 
<p>默认为当前聊天窗口</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> wxauto <span class="token keyword">import</span> <span class="token operator">*</span>

wx <span class="token operator">=</span> WeChat<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 获取当前聊天窗口消息</span>
msgs <span class="token operator">=</span> wx<span class="token punctuation">.</span>GetAllMessage<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 输出消息内容</span>
<span class="token keyword">for</span> msg <span class="token keyword">in</span> msgs<span class="token punctuation">:</span>
    <span class="token keyword">if</span> msg<span class="token punctuation">.</span><span class="token builtin">type</span> <span class="token operator">==</span> <span class="token string">'sys'</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'【系统消息】</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>msg<span class="token punctuation">.</span>content<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

    <span class="token keyword">elif</span> msg<span class="token punctuation">.</span><span class="token builtin">type</span> <span class="token operator">==</span> <span class="token string">'friend'</span><span class="token punctuation">:</span>
        sender <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender_remark  <span class="token comment"># 获取备注名</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>sender<span class="token punctuation">.</span>rjust<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">：</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>msg<span class="token punctuation">.</span>content<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

    <span class="token keyword">elif</span> msg<span class="token punctuation">.</span><span class="token builtin">type</span> <span class="token operator">==</span> <span class="token string">'self'</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">：</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>msg<span class="token punctuation">.</span>content<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

    <span class="token keyword">elif</span> msg<span class="token punctuation">.</span><span class="token builtin">type</span> <span class="token operator">==</span> <span class="token string">'time'</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'\n【时间消息】</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>msg<span class="token punctuation">.</span>time<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

    <span class="token keyword">elif</span> msg<span class="token punctuation">.</span><span class="token builtin">type</span> <span class="token operator">==</span> <span class="token string">'recall'</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'【撤回消息】</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>msg<span class="token punctuation">.</span>content<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/58/98/LFbr7Tx1_o.png" alt="在这里插入图片描述"><br> 另外<code>LoadMoreMessage</code>方法用于加载更多历史消息，配合<code>GetAllMessage</code>方法使用，实现获取更多历史消息。<br> <font color="red"><strong>注意：</strong></font><code>LoadMoreMessage</code>方法加载更多历史消息时，需要保证当前聊天窗口有历史消息，否则没有效果，即触发一次“查看更多消息”。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> wxauto <span class="token keyword">import</span> WeChat
wx <span class="token operator">=</span> WeChat<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 加载更多历史消息</span>
wx<span class="token punctuation">.</span>LoadMoreMessage<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 获取当前聊天窗口消息</span>
msgs <span class="token operator">=</span> wx<span class="token punctuation">.</span>GetAllMessage<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 消息处理逻辑代码。。。</span>
</code></pre> 
<p><strong>微信添加好友</strong><br> <code>AddNewFriend</code>方法用于发起好友申请。<br> <font color="red"><strong>注意：</strong></font>微信有一定的限制，如果频繁添加好友，可能会被限制添加好友的权限，请谨慎使用，切勿滥用！！！</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> wxauto <span class="token keyword">import</span> <span class="token operator">*</span>
wx <span class="token operator">=</span> WeChat<span class="token punctuation">(</span><span class="token punctuation">)</span>
keywords <span class="token operator">=</span> <span class="token string">'s15576806087'</span>  <span class="token comment"># 对方的微信号、手机号、QQ号</span>
addmsg <span class="token operator">=</span> <span class="token string">'你好，我是xxxx'</span>  <span class="token comment"># 添加好友的消息</span>
remark <span class="token operator">=</span> <span class="token string">'备注名字'</span>  <span class="token comment"># 备注名，没有则不用设置</span>
tags <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'朋友'</span><span class="token punctuation">,</span> <span class="token string">'同事'</span><span class="token punctuation">]</span>  <span class="token comment"># 标签列表</span>
<span class="token comment"># 发起好友申请</span>
wx<span class="token punctuation">.</span>AddNewFriend<span class="token punctuation">(</span>keywords<span class="token punctuation">,</span> addmsg<span class="token operator">=</span>addmsg<span class="token punctuation">,</span> remark<span class="token operator">=</span>remark<span class="token punctuation">,</span> tags<span class="token operator">=</span>tags<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/5f/7f/d1QdB0TV_o.png" alt="在这里插入图片描述"></p> 
<p><strong>获取好友信息</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> wxauto <span class="token keyword">import</span> WeChat

wx <span class="token operator">=</span> WeChat<span class="token punctuation">(</span><span class="token punctuation">)</span>

friend_infos <span class="token operator">=</span> wx<span class="token punctuation">.</span>GetAllFriends<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 获取好友信息</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>friend_infos<span class="token punctuation">)</span>
</code></pre> 
<h5><a id="3_wxauto_143"></a>3. wxauto的消息对象</h5> 
<p>这个很重要，下面结合大模型时会用到以下的消息对象。<br> <strong>好友消息</strong><br> <img src="https://images2.imgbox.com/27/a7/hHKLFq3Q_o.png" alt="在这里插入图片描述"><br> <strong>支持属性</strong>：</p> 
<table><thead><tr><th>属性名</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>type</td><td>str</td><td>消息类型，固定为<code>friend</code></td></tr><tr><td><code>content</code></td><td>str</td><td>消息内容</td></tr><tr><td>sender</td><td>str</td><td>发送者</td></tr><tr><td>sender_remark</td><td>str</td><td>发送者备注名</td></tr><tr><td>info</td><td>list</td><td>原始消息信息，包含了消息的所有信息</td></tr><tr><td>control</td><td>uiautomation.Control</td><td>该消息的uiautomation控件</td></tr><tr><td>id</td><td>str</td><td>消息id</td></tr></tbody></table> 
<pre><code class="prism language-python">msgs <span class="token operator">=</span> wx<span class="token punctuation">.</span>GetAllMessage<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> msg <span class="token keyword">in</span> msgs<span class="token punctuation">:</span>
    <span class="token keyword">if</span> msg<span class="token punctuation">.</span><span class="token builtin">type</span> <span class="token operator">==</span> <span class="token string">'friend'</span><span class="token punctuation">:</span>  <span class="token comment"># 消息类型</span>
        sender <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender_remark  <span class="token comment"># 获取备注名</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>sender<span class="token punctuation">}</span></span><span class="token string">：</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>msg<span class="token punctuation">.</span>content<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/bb/8e/2wnYm0cT_o.png" alt="在这里插入图片描述"></p> 
<p><strong>自己的消息</strong><br> <img src="https://images2.imgbox.com/4c/a7/45QE6qS6_o.png" alt="在这里插入图片描述"><br> <strong>支持属性</strong>：</p> 
<table><thead><tr><th>属性名</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>type</td><td>str</td><td>消息类型，固定为<code>self</code></td></tr><tr><td><code>content</code></td><td>str</td><td>消息内容</td></tr><tr><td>sender</td><td>str</td><td>发送者</td></tr><tr><td>sender_remark</td><td>str</td><td>发送者备注名</td></tr><tr><td>info</td><td>list</td><td>原始消息信息，包含了消息的所有信息</td></tr><tr><td>control</td><td>uiautomation.Control</td><td>该消息的uiautomation控件</td></tr><tr><td>id</td><td>str</td><td>消息id</td></tr></tbody></table> 
<pre><code class="prism language-python">msgs <span class="token operator">=</span> wx<span class="token punctuation">.</span>GetAllMessage<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> msg <span class="token keyword">in</span> msgs<span class="token punctuation">:</span>
    <span class="token keyword">if</span> msg<span class="token punctuation">.</span><span class="token builtin">type</span> <span class="token operator">==</span> <span class="token string">'self'</span><span class="token punctuation">:</span>  <span class="token comment"># 消息类型</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">}</span></span><span class="token string">：</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>msg<span class="token punctuation">.</span>content<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a4/50/tHtVyt9P_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="wxauto_187"></a>💻四、wxauto结合大模型实现简单的聊天机器人</h4> 
<p>这里选用的是百度的千帆大模型，首先登陆进去之后点击模型广场，随便选一个免费的就行。<br> <img src="https://images2.imgbox.com/34/ec/FYzzXunM_o.png" alt="在这里插入图片描述"><br> 选择好模型之后，点进去，点击那个开通付费【免费的，不要钱，放心点击】，提交订单就开通成功啦。<br> <img src="https://images2.imgbox.com/e1/ed/vYUB3Trb_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/4a/64/Xrt7Y8qw_o.png" alt="在这里插入图片描述"><br> 返回到主页，点击应用接入，记住这里的<code>API Key</code>和 <code>Secret Key</code>，点击创建应用。<br> <img src="https://images2.imgbox.com/34/d7/CEOSjOvp_o.png" alt="在这里插入图片描述"><br> 填写好应用名称和应用描述（随便填一下就好了），点击确定。<br> <img src="https://images2.imgbox.com/b2/e0/yrVnUqol_o.png" alt="在这里插入图片描述"><br> 返回主页，点击模型广场，点击你之前选择的模型，点击API文档。<br> <img src="https://images2.imgbox.com/ac/fb/2aCpHPk0_o.png" alt="在这里插入图片描述"><br> 往下翻找到对应的请求示例的Python代码，复制那段代码。<br> <img src="https://images2.imgbox.com/f3/7d/dXdUwVos_o.png" alt="在这里插入图片描述"><br> 复制好代码后，将你对应的<code>API Key</code>和 <code>Secret Key</code>给添加上去。<br> <img src="https://images2.imgbox.com/4e/18/4iysLeop_o.png" alt="在这里插入图片描述"><br> 运行一下代码可以看到，<code>result</code>就是大模型根据我们的问题给出的结果，现在我们只需要将content改成微信中好友发送过来的消息作为问题给大模型，然后将大模型给出的结果中的<code>result</code>提取出来作为内容发送给好友，这样，一个简单的微信聊天机器人就完成了。<br> <img src="https://images2.imgbox.com/f9/70/PZ2Fli79_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_206"></a>三、完整代码</h4> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> json
<span class="token keyword">from</span> wxauto <span class="token keyword">import</span> WeChat


<span class="token keyword">def</span> <span class="token function">get_access_token</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    使用 API Key，Secret Key 获取access_token，替换下列示例中的应用API Key、应用Secret Key
    """</span>

    url <span class="token operator">=</span> <span class="token string">"https://aip.baidubce.com/oauth/2.0/token?grant_type=client_credentials&amp;client_id=[应用API Key]&amp;client_secret=[应用Secret Key]"</span>

    payload <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'application/json'</span><span class="token punctuation">,</span>
        <span class="token string">'Accept'</span><span class="token punctuation">:</span> <span class="token string">'application/json'</span>
    <span class="token punctuation">}</span>

    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>request<span class="token punctuation">(</span><span class="token string">"POST"</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> data<span class="token operator">=</span>payload<span class="token punctuation">)</span>
    <span class="token keyword">return</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"access_token"</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span>wx1<span class="token punctuation">,</span> msg1<span class="token punctuation">)</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> <span class="token string">"https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-speed-128k?access_token="</span> <span class="token operator">+</span> get_access_token<span class="token punctuation">(</span><span class="token punctuation">)</span>

    payload <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token string">"messages"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token string">"role"</span><span class="token punctuation">:</span> <span class="token string">"user"</span><span class="token punctuation">,</span>
                <span class="token string">"content"</span><span class="token punctuation">:</span> msg1
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'application/json'</span>
    <span class="token punctuation">}</span>

    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>request<span class="token punctuation">(</span><span class="token string">"POST"</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> data<span class="token operator">=</span>payload<span class="token punctuation">)</span>
    json_result <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>json_result<span class="token punctuation">)</span>
    <span class="token comment"># print(response.text)</span>
    wx<span class="token punctuation">.</span>SendMsg<span class="token punctuation">(</span>msg<span class="token operator">=</span>json_result<span class="token punctuation">[</span><span class="token string">'result'</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"--此内容为AI生成"</span><span class="token punctuation">,</span> who<span class="token operator">=</span><span class="token string">"你要发送的人"</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    wx <span class="token operator">=</span> WeChat<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        msgs <span class="token operator">=</span> wx<span class="token punctuation">.</span>GetAllMessage<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> msgs<span class="token punctuation">:</span>
            <span class="token keyword">if</span> msgs<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">type</span> <span class="token operator">==</span> <span class="token string">"friend"</span><span class="token punctuation">:</span>
                main<span class="token punctuation">(</span>wx<span class="token punctuation">,</span> msgs<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>content<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a9/83/wU02X8us_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/739195c9281f65919289e942b90a2753/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Python 爬虫入门（四）：使用 pandas 处理和分析数据 「详细介绍」</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bd7f1c1a650bd251e1d3dc16ce5861fa/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">现在的Java面试都这么扯淡了吗？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>