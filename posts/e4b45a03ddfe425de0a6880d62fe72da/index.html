<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【MySQL】mysql访问 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/e4b45a03ddfe425de0a6880d62fe72da/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【MySQL】mysql访问">
  <meta property="og:description" content="mysql访问 1.引入MySQL 客户端库2.C/C&#43;&#43; 进行增删改3.查询的处理细节4.图形化界面访问数据库4.1下载MYSQL Workbench4.2MYSQL Workbench远程连接数据库 点赞👍👍收藏🌟🌟关注💖💖
你的支持是对我最大的鼓励，我们一起努力吧!😃😃
1.引入MySQL 客户端库 从开始到选择我们用的都是命令行式的mysql访问mysqld，向mysqld下达我们的指令，其实在数据库层面上，连接数据库的客户端除了现在命令行式的客户端，还有图形化界面、网页版的，当然也包括语言级别的库或者包帮我们去访问数据库。
下面我们就用C/C&#43;&#43;访问数据库。关于访问数据库我们要做两个准备工作，一是创建一个远端或者本地访问的请求也就是创建一个专门用来进行用C/C&#43;&#43;访问客户端的账号。
reate user &#39;connector&#39;@&#39;localhost&#39; identified by &#39;xxx&#39;; 然后创建一个数据库，赋予这个账号对数据库中表的所有权限。
二是安装C/C&#43;&#43;要能访问的库，这个库有两种准备，第一种是从官网下载库，
下面这个是用不同语言连接MYSQL，官方提供的库。
下载推荐的8.0
我们用的是linux，所以选择linux系统x86 64位
下载好，上传到linux，然后解压一下，mysql-connector是解压后重命名的
这是解压后的文件，最重要的就是include 头文件，还有一个lib64 库
未来头文件给我们提供连接mysql的方法，库 提供连接mysql的库函数
我们就可以根据头文件，直接调用头文件的的方法，在编译连接的时候把库连入进来。如果忘记怎么引入，在Linux哪里基础IO动静态库就有对应的方法！
但是这种方式不推荐了！之间不是下载mysql，用yum源下载吗。yum源它会给我们找到合适的服务器，客户端，甚至是开发包。所以我们直接在yum哪里去找进行了。
没下载过mysql 可以下一下如果你安装过yum对应msyql源的话，如果不会下请移步于
【MySQL】MySQL在 Linux下环境安装
yum install -y mysql-community-server 如果你下载过，你就可以看到这里有对应的头文件，未来我们主要用的就是mysql.h
如果你下载过但是找不到头文件，执行下面的命令，就可以看到了
install -y mysql-devel mysql库在系统默认安装路径下
开发环境我们有已经准备好了，接下来我们学习具体的接口。不过我们通过 mysql_get_client_info() 函数，来验证我们的引入是否成功。
#include &lt;iostream&gt; #include &lt;mysql/mysql.h&gt; using namespace std; int main() { //获取当前客户端版本信息 cout&lt;&lt;&#34;mysql client Version: &#34;&lt;&lt;mysql_get_client_info()&lt;&lt;endl; return 0; } 如果直接编译肯定会报错，说的是未定义的引用，也就是这个mysql_get_client_info()找不到。
之前基础IO就说过，你要保证这个外来库能被正确连接，gcc/g&#43;&#43;默认会选择C和C&#43;&#43;的库，虽然你的mysql在系统中，系统也会默认会去/lib64路径下去找，">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-02T18:27:30+08:00">
    <meta property="article:modified_time" content="2024-07-02T18:27:30+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【MySQL】mysql访问</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>mysql访问</h4> 
 <ul><li><a href="#1MySQL__6" rel="nofollow">1.引入MySQL 客户端库</a></li><li><a href="#2CC__112" rel="nofollow">2.C/C++ 进行增删改</a></li><li><a href="#3_526" rel="nofollow">3.查询的处理细节</a></li><li><a href="#4_1059" rel="nofollow">4.图形化界面访问数据库</a></li><li><ul><li><a href="#41MYSQL_Workbench_1069" rel="nofollow">4.1下载MYSQL Workbench</a></li><li><a href="#42MYSQL_Workbench_1091" rel="nofollow">4.2MYSQL Workbench远程连接数据库</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<p><img src="https://images2.imgbox.com/ac/53/TPlHfJ6V_o.jpg" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>点赞</strong>👍👍<strong>收藏</strong>🌟🌟<strong>关注</strong>💖💖<br> <font color="red"><strong>你的支持是对我最大的鼓励，我们一起努力吧!😃😃</strong></font></p> 
</blockquote> 
<h2><a id="1MySQL__6"></a>1.引入MySQL 客户端库</h2> 
<p>从开始到选择我们用的都是命令行式的mysql访问mysqld，向mysqld下达我们的指令，其实在数据库层面上，连接数据库的客户端除了现在命令行式的客户端，还有图形化界面、网页版的，当然也包括语言级别的库或者包帮我们去访问数据库。</p> 
<p>下面我们就用C/C++访问数据库。关于访问数据库我们要做两个准备工作，一是创建一个远端或者本地访问的请求也就是创建一个专门用来进行用C/C++访问客户端的账号。</p> 
<pre><code class="prism language-powershell">reate user <span class="token string">'connector'</span>@<span class="token string">'localhost'</span> identified by <span class="token string">'xxx'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/91/5a/LcFmhOZM_o.png" alt="在这里插入图片描述"></p> 
<p>然后创建一个数据库，赋予这个账号对数据库中表的所有权限。</p> 
<p><img src="https://images2.imgbox.com/88/03/DA3qchSP_o.png" alt="在这里插入图片描述"></p> 
<p>二是安装C/C++要能访问的库，这个库有两种准备，第一种是从<a href="https://dev.mysql.com/downloads/" rel="nofollow">官网</a>下载库，</p> 
<p>下面这个是用不同语言连接MYSQL，官方提供的库。<br> <img src="https://images2.imgbox.com/12/95/LIruEhWb_o.png" alt="在这里插入图片描述"><br> 下载推荐的8.0<br> <img src="https://images2.imgbox.com/dd/ea/YVA2MmiD_o.png" alt="在这里插入图片描述"></p> 
<p>我们用的是linux，所以选择linux系统x86 64位</p> 
<p><img src="https://images2.imgbox.com/f8/c4/awshYoDb_o.png" alt="在这里插入图片描述"></p> 
<p>下载好，上传到linux，然后解压一下，mysql-connector是解压后重命名的</p> 
<p><img src="https://images2.imgbox.com/3f/b2/hSoD6nV5_o.png" alt="在这里插入图片描述"></p> 
<p>这是解压后的文件，最重要的就是include 头文件，还有一个lib64 库</p> 
<p><img src="https://images2.imgbox.com/40/0a/iXJKEKX6_o.png" alt="在这里插入图片描述"></p> 
<p>未来头文件给我们提供连接mysql的方法，库 提供连接mysql的库函数</p> 
<p><img src="https://images2.imgbox.com/d8/54/YAAd0QB4_o.png" alt="在这里插入图片描述"></p> 
<p>我们就可以根据头文件，直接调用头文件的的方法，在编译连接的时候把库连入进来。如果忘记怎么引入，在Linux哪里基础IO动静态库就有对应的方法！</p> 
<p>但是这种方式不推荐了！之间不是下载mysql，用yum源下载吗。yum源它会给我们找到合适的服务器，客户端，甚至是开发包。所以我们直接在yum哪里去找进行了。</p> 
<p>没下载过mysql 可以下一下如果你安装过yum对应msyql源的话，如果不会下请移步于<br> <a href="https://blog.csdn.net/fight_p/article/details/138613422">【MySQL】MySQL在 Linux下环境安装</a></p> 
<pre><code class="prism language-powershell">yum install <span class="token operator">-</span>y mysql-community-server  
</code></pre> 
<p>如果你下载过，你就可以看到这里有对应的头文件，未来我们主要用的就是mysql.h</p> 
<p><img src="https://images2.imgbox.com/4c/cc/NOJEzmie_o.png" alt="在这里插入图片描述"></p> 
<p>如果你下载过但是找不到头文件，执行下面的命令，就可以看到了</p> 
<pre><code class="prism language-powershell">install <span class="token operator">-</span>y mysql-devel
</code></pre> 
<p>mysql库在系统默认安装路径下</p> 
<p><img src="https://images2.imgbox.com/ce/db/9kzzyyVT_o.png" alt="在这里插入图片描述"></p> 
<p>开发环境我们有已经准备好了，接下来我们学习具体的接口。不过我们通过 mysql_get_client_info() 函数，来验证我们的引入是否成功。</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;mysql/mysql.h&gt;</span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//获取当前客户端版本信息</span>
    cout<span class="token operator">&lt;&lt;</span><span class="token string">"mysql client Version: "</span><span class="token operator">&lt;&lt;</span><span class="token function">mysql_get_client_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>如果直接编译肯定会报错，说的是未定义的引用，也就是这个mysql_get_client_info()找不到。<br> <img src="https://images2.imgbox.com/15/7c/d2m9zegZ_o.png" alt="在这里插入图片描述"></p> 
<p>之前基础IO就说过，你要保证这个外来库能被正确连接，gcc/g++默认会选择C和C++的库，虽然你的mysql在系统中，系统也会默认会去/lib64路径下去找，</p> 
<p><img src="https://images2.imgbox.com/41/00/TasiwIFR_o.png" alt="在这里插入图片描述"></p> 
<p>但是现在的问题是我怎么知道我需要连接那个库，尽管能找到这个库，但是我怎么知道我们该连那个库呢？所以我们需要需要在编译的时候就指明需要连那个库，</p> 
<pre><code class="prism language-cpp">g<span class="token operator">++</span> <span class="token operator">-</span>o mytest test<span class="token punctuation">.</span>cc <span class="token operator">-</span>L<span class="token operator">/</span>lib64<span class="token operator">/</span>mysql <span class="token operator">-</span>lmysqlclient
</code></pre> 
<p>然后就可以打出来所有mysql客户端的版本，说明这个库就被重新引入了</p> 
<p><img src="https://images2.imgbox.com/56/bf/A3FJSVnL_o.png" alt="在这里插入图片描述"></p> 
<p>以前引入外来库不是还带上面-I选项，今天这里咋没有带。这是因为g++默认会去include里去找。然后拿着代码里的</p> 
<p><img src="https://images2.imgbox.com/08/e4/Yyfj82AO_o.png" alt="在这里插入图片描述"></p> 
<p>去找，所有不会报头文件找不到的问题。如果你非得带-I，就把前面去掉</p> 
<p><img src="https://images2.imgbox.com/40/3d/G1Yv4yRl_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-cpp">g<span class="token operator">++</span> <span class="token operator">-</span>o mytest test<span class="token punctuation">.</span>cc <span class="token operator">-</span>I<span class="token operator">/</span>usr<span class="token operator">/</span>include<span class="token operator">/</span>mysql <span class="token operator">-</span>L<span class="token operator">/</span>lib64<span class="token operator">/</span>mysql <span class="token operator">-</span>lmysqlclient
</code></pre> 
<p>接下来我们我们通过这个库它内部给我提供对应的方法来让我们连接mysqld服务端，然后进行访问。</p> 
<h2><a id="2CC__112"></a>2.C/C++ 进行增删改</h2> 
<p>接下来我们先认识mysql常用接口。<a href="https://dev.mysql.com/doc/c-api/5.7/en/c-api-function-reference.html" rel="nofollow">msyql接口介绍</a></p> 
<p><img src="https://images2.imgbox.com/9b/cf/aLd4W11M_o.png" alt="在这里插入图片描述"></p> 
<p>这里还有mysql库为了方便操作mysql，然后提前在库中给我创建很多的数据结构</p> 
<p><img src="https://images2.imgbox.com/85/09/MbQV1hWu_o.png" alt="在这里插入图片描述"></p> 
<p>msyql的是一套网络服务，就注定了实际在进行mysql操作之前比如下达sql，一定在之前要连接mysql，而在连接mysql之前，我们还要先来创建一下mysql基础数据结构。<strong>要使用库，必须先进行初始化</strong>。mysql_init()帮我们创建一个MYSQL对象</p> 
<pre><code class="prism language-cpp">MYSQL <span class="token operator">*</span><span class="token function">mysql_init</span><span class="token punctuation">(</span>MYSQL <span class="token operator">*</span>mysql<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>成功返回MYSQL对象，失败返回nullptr，用的时候必须要调用mysql_close()对应的链接。</p> 
<p><img src="https://images2.imgbox.com/01/14/2d6i8MCX_o.png" alt="在这里插入图片描述"></p> 
<p>MYSQL是 C api中一个非常重要的变量（mysql_init的返回值），里面内存非常丰富，有port,dbname,charset等连接基本参数。它也包含了一个叫 st_mysql_methods的结构体变量，该变量里面保存着很多函数指针，这些函数指针将会在数据库连接成功以后的各种数据操作中被调用。</p> 
<p>MYSQL实际上就是一个结构体里面包含连接mysql相关保存好的一些属性。这相当于FILE*，用来标识mysql客户端一些资源，我们把这些东西可以称之为句柄。</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;mysql/mysql.h&gt;</span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>

    <span class="token comment">// 1. 初始化mysql,构建mysql对象,得到mysql访问句柄</span>
    MYSQL<span class="token operator">*</span> my<span class="token operator">=</span><span class="token function">mysql_init</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>my <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"init MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token comment">// 3.用完之后close，释放资源</span>
    <span class="token function">mysql_close</span><span class="token punctuation">(</span>my<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>把数据库对应的MYSQL结构体对象创建初始化好，最终不用它了把它释放。可是要访问mysql之前要先连接数据库，连接数据库的函数。</p> 
<pre><code class="prism language-cpp">MYSQL <span class="token operator">*</span><span class="token function">mysql_real_connect</span><span class="token punctuation">(</span>MYSQL <span class="token operator">*</span>mysql<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>host<span class="token punctuation">,</span>
	<span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>user<span class="token punctuation">,</span>
	<span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>passwd<span class="token punctuation">,</span>
	<span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>db<span class="token punctuation">,</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">int</span> port<span class="token punctuation">,</span>
	<span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>unix_socket<span class="token punctuation">,</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> clientflag<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>第一个参数就是刚才创建的MYSQL对象。连接成功后把连接成功套接字信息保存到MYSQL对象中。然后要连接的mysql的主机在哪里，用户是谁，密码是多少，连接那个数据库，数据库的端口号是多少，剩下设置为nullptr，0就可以了。</p> 
<p>成功时把我们传入的MYSQL给我们返回，失败返回nullptr。</p> 
<p><img src="https://images2.imgbox.com/bd/30/otWVDQsf_o.png" alt="在这里插入图片描述"><br> 最开始创建的只允许在本地主机连接数据库的用户就用上了。</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;mysql/mysql.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">const</span> string host<span class="token operator">=</span><span class="token string">"localhost"</span><span class="token punctuation">;</span> <span class="token comment">//host="127.0.0.1" 也是可以的</span>
<span class="token keyword">const</span> string user<span class="token operator">=</span><span class="token string">"connector"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> string passwd<span class="token operator">=</span><span class="token string">"xxx"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> string db<span class="token operator">=</span><span class="token string">"conn"</span><span class="token punctuation">;</span>
<span class="token keyword">unsigned</span> <span class="token keyword">int</span> port<span class="token operator">=</span>xxx<span class="token punctuation">;</span> <span class="token comment">//自己的端口号不要暴露</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>

    <span class="token comment">// 1. 初始化mysql,构建mysql对象,得到mysql访问句柄</span>
    MYSQL<span class="token operator">*</span> my<span class="token operator">=</span><span class="token function">mysql_init</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>my <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"init MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 2.连接数据库</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">mysql_real_connect</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span>host<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>user<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>passwd<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>db<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>port<span class="token punctuation">,</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"connect MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
	cout<span class="token operator">&lt;&lt;</span><span class="token string">"connect success"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>

    <span class="token comment">// 3.用完之后close，释放资源</span>
    <span class="token function">mysql_close</span><span class="token punctuation">(</span>my<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>自此我们完成了连接mysql的第工作</p> 
<ol><li><strong>初始化mysql，构建mysql对象，得到mysql访问句柄</strong></li><li><strong>进行mysql 的connect连接</strong></li><li><strong>用完mysql之后close</strong></li></ol> 
<p>然后就可以<strong>对mysql下达sql指令</strong>了。这个下达sql指令的函数是mysql_query对数据库下达指令。第一个参数就是刚才的MYSQL对象，第二个参数就是下达的sql指令。以前我们在命令行写单sql后面会带；，但是在这里并不需要带；or \g，成功时返回0，失败时返回非0。</p> 
<p><img src="https://images2.imgbox.com/3a/01/Xp6Jlh0d_o.png" alt="在这里插入图片描述"></p> 
<p>在此之前可以自己先创建一个表</p> 
<pre><code class="prism language-powershell">create table user<span class="token punctuation">(</span>
     id bigint primary key auto_increment<span class="token punctuation">,</span>
     name varchar<span class="token punctuation">(</span>32<span class="token punctuation">)</span> not null<span class="token punctuation">,</span>
     age int not null<span class="token punctuation">,</span>
     telphone varchar<span class="token punctuation">(</span>32<span class="token punctuation">)</span> unique
     <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>之前我们学过一个sql指令，查看正在连接数据库的用户</p> 
<pre><code class="prism language-powershell">show processlist<span class="token punctuation">;</span>
</code></pre> 
<p>可以看到我们C/C++库确实连接到数据库了</p> 
<p><img src="https://images2.imgbox.com/ff/4a/o7TTEg2b_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 1. 初始化mysql,构建mysql对象,得到mysql访问句柄</span>
    MYSQL <span class="token operator">*</span>my <span class="token operator">=</span> <span class="token function">mysql_init</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>my <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"init MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 2.连接数据库</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysql_real_connect</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> host<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> passwd<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> db<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> port<span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"connect MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// cout&lt;&lt;"connect success"&lt;&lt;endl;</span>

    string sql<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">" mysql&gt; "</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">getline</span><span class="token punctuation">(</span>cin<span class="token punctuation">,</span> sql<span class="token punctuation">)</span> <span class="token operator">||</span> sql <span class="token operator">==</span> <span class="token string">"quit"</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Bye"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> sql<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            cout <span class="token operator">&lt;&lt;</span> sql <span class="token operator">&lt;&lt;</span> <span class="token string">" success"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{<!-- --></span>
            cerr <span class="token operator">&lt;&lt;</span> sql <span class="token operator">&lt;&lt;</span> <span class="token string">" error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token number">3</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 3.用完之后close，释放资源</span>
    <span class="token function">mysql_close</span><span class="token punctuation">(</span>my<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>这里名字我们先输入英文，具体原因等会说。下达的这个sql执行可带；或者不带；。然后看到我们确实把信息插入到数据库了。我们其实也可以自己搞一个mysql的客户端。但是实际上我们也不会这样做，别人自己有客户端。我们直接向数据库下达sql指令就行了。</p> 
<p><img src="https://images2.imgbox.com/3f/95/Sv6KUBFs_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>更新</strong></p> 
</blockquote> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 1. 初始化mysql,构建mysql对象,得到mysql访问句柄</span>
    MYSQL <span class="token operator">*</span>my <span class="token operator">=</span> <span class="token function">mysql_init</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>my <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"init MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 2.连接数据库</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysql_real_connect</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> host<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> passwd<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> db<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> port<span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"connect MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    string sql<span class="token operator">=</span><span class="token string">"update user set name='jim' where id=2"</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> n<span class="token operator">=</span><span class="token function">mysql_query</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span>sql<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> cout<span class="token operator">&lt;&lt;</span>sql<span class="token operator">&lt;&lt;</span><span class="token string">" success"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    <span class="token keyword">else</span> cout<span class="token operator">&lt;&lt;</span>sql<span class="token operator">&lt;&lt;</span><span class="token string">" error"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>

    <span class="token comment">// 3.用完之后close，释放资源</span>
    <span class="token function">mysql_close</span><span class="token punctuation">(</span>my<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>执行一下，看到id=2的名字确实更新为jim了。</p> 
<p><img src="https://images2.imgbox.com/69/61/yc8Q2yBR_o.png" alt="在这里插入图片描述"></p> 
<p>所以未来我们所写的任何的关于数据库方面的程序，你想使用数据库，你可以提前建好数据库账号然后赋权，并且建表。然后编写对应C/C++代码。然后就可以为你的上层进行数据层面上的支撑了。</p> 
<blockquote> 
 <p><strong>插入</strong></p> 
</blockquote> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 1. 初始化mysql,构建mysql对象,得到mysql访问句柄</span>
    MYSQL <span class="token operator">*</span>my <span class="token operator">=</span> <span class="token function">mysql_init</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>my <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"init MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 2.连接数据库</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysql_real_connect</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> host<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> passwd<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> db<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> port<span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"connect MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">//string sql="update user set name='jim' where id=2";</span>
    string sql<span class="token operator">=</span><span class="token string">"insert into user (name,age,telphone) values ('peter',19,19187654321)"</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> n<span class="token operator">=</span><span class="token function">mysql_query</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span>sql<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> cout<span class="token operator">&lt;&lt;</span>sql<span class="token operator">&lt;&lt;</span><span class="token string">" success"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    <span class="token keyword">else</span> cout<span class="token operator">&lt;&lt;</span>sql<span class="token operator">&lt;&lt;</span><span class="token string">" error"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>

    <span class="token comment">// 3.用完之后close，释放资源</span>
    <span class="token function">mysql_close</span><span class="token punctuation">(</span>my<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/cd/c4/HmaW6Fpi_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>删除</strong></p> 
</blockquote> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 1. 初始化mysql,构建mysql对象,得到mysql访问句柄</span>
    MYSQL <span class="token operator">*</span>my <span class="token operator">=</span> <span class="token function">mysql_init</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>my <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"init MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 2.连接数据库</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysql_real_connect</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> host<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> passwd<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> db<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> port<span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"connect MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">//string sql="update user set name='jim' where id=2";</span>
    <span class="token comment">//string sql="insert into user (name,age,telphone) values ('peter',19,19187654321)";</span>
    string sql<span class="token operator">=</span><span class="token string">"delete from user where id=1"</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> n<span class="token operator">=</span><span class="token function">mysql_query</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span>sql<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> cout<span class="token operator">&lt;&lt;</span>sql<span class="token operator">&lt;&lt;</span><span class="token string">" success"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    <span class="token keyword">else</span> cout<span class="token operator">&lt;&lt;</span>sql<span class="token operator">&lt;&lt;</span><span class="token string">" error"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>

    <span class="token comment">// 3.用完之后close，释放资源</span>
    <span class="token function">mysql_close</span><span class="token punctuation">(</span>my<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8b/8b/IaO9Vvg9_o.png" alt="在这里插入图片描述"></p> 
<p>单sql本身就是事务，mysql默认事务提交是自动的，所以今天你可以用一个连接访问数据库，也可以创建十个连接访问数据库，你可以用命令行方式访问数据库，也可以用C/C++访问数据库。所以数据库可以存在多个访问，因为有事务，事务有ACID能保证原子性等等。所以我们在应用层就不用担心业务代码执行时出现问题。</p> 
<p>mysql_query这个函数现在可以增删改，那查行不行呢？</p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 1. 初始化mysql,构建mysql对象,得到mysql访问句柄</span>
    MYSQL <span class="token operator">*</span>my <span class="token operator">=</span> <span class="token function">mysql_init</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>my <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"init MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 2.连接数据库</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysql_real_connect</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> host<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> passwd<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> db<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> port<span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"connect MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">//string sql="update user set name='jim' where id=2";</span>
    <span class="token comment">//string sql="insert into user (name,age,telphone) values ('peter',19,19187654321)";</span>
    <span class="token comment">//string sql="delete from user where id=1";</span>
    string sql<span class="token operator">=</span><span class="token string">"select * from user"</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> n<span class="token operator">=</span><span class="token function">mysql_query</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span>sql<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> cout<span class="token operator">&lt;&lt;</span>sql<span class="token operator">&lt;&lt;</span><span class="token string">" success"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    <span class="token keyword">else</span> cout<span class="token operator">&lt;&lt;</span>sql<span class="token operator">&lt;&lt;</span><span class="token string">" error"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>

    <span class="token comment">// 3.用完之后close，释放资源</span>
    <span class="token function">mysql_close</span><span class="token punctuation">(</span>my<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>别人告诉我成功了啊，然后呢？</p> 
<p><img src="https://images2.imgbox.com/f0/e5/5svSME3S_o.png" alt="在这里插入图片描述"></p> 
<p>在我们数据库语句中，增删改是最简单的，因为增删改只需要保证成功即可，那么增删改操作一定能完成。而select是最不好处理的，因为当成功执行select语句，只是执行完sql第一步，那select后的数据在那呢？你是不是要把数据给显示处理或者说让用户获取到，所以还需要在做后面的工作。所以select还有后序获取数据包括把数据在交给它的调用层。而不像增删改执行完就完了。</p> 
<p>还有一个问题，刚刚在插入的时候，name插入都是英文，那我们插入中文会怎么样呢？</p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 1. 初始化mysql,构建mysql对象,得到mysql访问句柄</span>
    MYSQL <span class="token operator">*</span>my <span class="token operator">=</span> <span class="token function">mysql_init</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>my <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"init MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 2.连接数据库</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysql_real_connect</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> host<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> passwd<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> db<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> port<span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"connect MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">//string sql="update user set name='jim' where id=2";</span>
    <span class="token comment">//string sql="insert into user (name,age,telphone) values ('peter',19,19187654321)";</span>
    string sql<span class="token operator">=</span><span class="token string">"insert into user (name,age,telphone) values ('张三',18,11187654321)"</span><span class="token punctuation">;</span>
    <span class="token comment">//string sql="delete from user where id=1";</span>
    <span class="token comment">//string sql="select * from user";</span>
    <span class="token keyword">int</span> n<span class="token operator">=</span><span class="token function">mysql_query</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span>sql<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> cout<span class="token operator">&lt;&lt;</span>sql<span class="token operator">&lt;&lt;</span><span class="token string">" success"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    <span class="token keyword">else</span> cout<span class="token operator">&lt;&lt;</span>sql<span class="token operator">&lt;&lt;</span><span class="token string">" error"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>

    <span class="token comment">// 3.用完之后close，释放资源</span>
    <span class="token function">mysql_close</span><span class="token punctuation">(</span>my<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>我们<strong>插入中文时乱码了</strong>！</p> 
<p><img src="https://images2.imgbox.com/1e/5d/qrX93ZDe_o.png" alt="在这里插入图片描述"></p> 
<p>乱码问题怎么解决？我们的数据库编码格式都配过是utf8的。出现乱码问题，一定是因为客户端和服务端对编码问题没有形成一致。比如说服务端用的是utf8，客户端用的是latin1。因为我们数据库编码都是utf8的，所以一定是客户端出现了问题。</p> 
<p><strong>建立好链接之后，获取英文没有问题，如果获取中文是乱码：设置链接的默认字符集是utf8，原始默认是latin1</strong></p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 1. 初始化mysql,构建mysql对象,得到mysql访问句柄</span>
    MYSQL <span class="token operator">*</span>my <span class="token operator">=</span> <span class="token function">mysql_init</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>my <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"init MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 2.连接数据库</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysql_real_connect</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> host<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> passwd<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> db<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> port<span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"connect MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 设置编码格式</span>
    <span class="token function">mysql_set_character_set</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> <span class="token string">"utf8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">//string sql="update user set name='jim' where id=2";</span>
    <span class="token comment">//string sql="insert into user (name,age,telphone) values ('peter',19,19187654321)";</span>
    string sql<span class="token operator">=</span><span class="token string">"insert into user (name,age,telphone) values ('李四',18,12187654321)"</span><span class="token punctuation">;</span>
    <span class="token comment">//string sql="delete from user where id=1";</span>
    <span class="token comment">//string sql="select * from user";</span>
    <span class="token keyword">int</span> n<span class="token operator">=</span><span class="token function">mysql_query</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span>sql<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> cout<span class="token operator">&lt;&lt;</span>sql<span class="token operator">&lt;&lt;</span><span class="token string">" success"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    <span class="token keyword">else</span> cout<span class="token operator">&lt;&lt;</span>sql<span class="token operator">&lt;&lt;</span><span class="token string">" error"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>

    <span class="token comment">// 3.用完之后close，释放资源</span>
    <span class="token function">mysql_close</span><span class="token punctuation">(</span>my<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>设置好编码，在插入中文就没问题了。</p> 
<p><img src="https://images2.imgbox.com/fa/96/iWMLwPsc_o.png" alt="在这里插入图片描述"></p> 
<p>自此我们就已经能够进行mysql对象初始化，mysql的连接，mysql的关闭，以及通过mysql_query向数据库下达对应的指令了。下面我们就解决拿到select的数据问题。</p> 
<h2><a id="3_526"></a>3.查询的处理细节</h2> 
<p>查sql本身能够被正确执行，但是执行之后怎么把查的数据交给上层返回给客户或者把它的数据显示处理呢？那在执行select的时候要把select的结果通过mysql_query查完之后把结果应该让我们怎么获取到呢？<strong>实际上mysql_query在执行select的时候会把结果保存到MYSQL这个句柄中</strong>。这个句柄是一个结构体它本身里面会包含对应的保存数据的缓存区区域。但是这部分数据依旧要被我们提取出来的。我们<strong>通过mysql_store_result这个函数来将结果进行转储</strong>。这个函数提取并且转储到结果集中。会把结果按照条目放置好。</p> 
<p><img src="https://images2.imgbox.com/da/05/WBWR4aB7_o.png" alt="在这里插入图片描述"></p> 
<p>是从MYSQL这个句柄中把结果转储到MYSQL_RES这个结构中。</p> 
<p><img src="https://images2.imgbox.com/34/20/5NWmyd7N_o.png" alt="在这里插入图片描述"></p> 
<p>把查询结果按照行为单位，全部都放进结果集中。</p> 
<p><img src="https://images2.imgbox.com/0f/4d/4T1wQM4U_o.png" alt="在这里插入图片描述"></p> 
<p>成功返回MYSQL_RES对象，失败返回nullptr。也可以采用mysql_errno和mysql_error来进行判断出错原因。</p> 
<p><img src="https://images2.imgbox.com/f0/ff/rIoDtKx0_o.png" alt="在这里插入图片描述"></p> 
<p>下面我们看看怎么用这个函数</p> 
<p>首先先将结果转储到MYSQL_RES结构体中。</p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 1. 初始化mysql,构建mysql对象,得到mysql访问句柄</span>
    MYSQL <span class="token operator">*</span>my <span class="token operator">=</span> <span class="token function">mysql_init</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>my <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"init MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 2.连接数据库</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysql_real_connect</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> host<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> passwd<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> db<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> port<span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"connect MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// cout&lt;&lt;"connect success"&lt;&lt;endl;</span>

    <span class="token comment">// 设置编码格式</span>
    <span class="token function">mysql_set_character_set</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> <span class="token string">"utf8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    string sql<span class="token operator">=</span><span class="token string">"select * from user"</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> n<span class="token operator">=</span><span class="token function">mysql_query</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span>sql<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> 
    <span class="token punctuation">{<!-- --></span>
        cout<span class="token operator">&lt;&lt;</span>sql<span class="token operator">&lt;&lt;</span><span class="token string">" success"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{<!-- --></span>
        cout<span class="token operator">&lt;&lt;</span>sql<span class="token operator">&lt;&lt;</span><span class="token string">" error"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> 

	<span class="token comment">//转储</span>
    MYSQL_RES<span class="token operator">*</span> res<span class="token operator">=</span><span class="token function">mysql_store_result</span><span class="token punctuation">(</span>my<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>res <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr<span class="token operator">&lt;&lt;</span><span class="token string">"mysql_store_result error"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token comment">// 3.用完之后close，释放资源</span>
    <span class="token function">mysql_close</span><span class="token punctuation">(</span>my<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>那MYSQL_RES这个结构体应该如何理解呢？</p> 
<p>首先我们要知道我们查出来的是一种表结构，表结构中行列关系是我们打印出来的，尤其是这些分割符，这些东西我们自己打印出来的，并不是在mysql在表中真实存在的。<br> <img src="https://images2.imgbox.com/3b/3a/RpzWZ20D_o.png" alt="在这里插入图片描述"></p> 
<p>在mysql表中其实存在两类信息，一类是存储表结构中的列属性或者列名称，还有一类是存储表中的内容。</p> 
<p><img src="https://images2.imgbox.com/02/df/MtZjkMwT_o.png" alt="在这里插入图片描述"><br> 我们先看内容，这些内容以一定格式先放到MYSQL结构体对象内部，然后在转储到MYSQL_RES结构中。转储是为了更好的便于做二次处理。</p> 
<p>在表中查出来的数据，就一定是在MYSQL内部在内存中保存这部分内容的。<strong>mysql将所有数据，读取出来的时候，全部都当作字符串。</strong> 虽然以前它们什么int，char等，但是一旦把数据读到自定义缓存区中的时候，那么它一定是把所有数据都当作字符串来看待。以前约束类型只是在插入的时候要处理，读取出来当当作字符串处理。</p> 
<p>然后MYSQL_RES要把结果归置一下，我可以把MYSQL_RES想象成一个存着char**的指针数组。数组大小代表筛选出来的数据记录有多少行。一条记录里面有多列，每一列都是字符串。</p> 
<p><img src="https://images2.imgbox.com/b7/77/0jLOku5N_o.png" alt="在这里插入图片描述"></p> 
<p>然后这个数组中每一个char** 指针都指向一个存访char<em>类型的指针数组，指向的是这个数组中首个元素的地址。char** 的指针数组大小代表的是数据记录有多少行，而每一行char</em> 的指针数组里的char* 依次指向一条记录的每一列。</p> 
<p><img src="https://images2.imgbox.com/7c/ad/uaXdOQFF_o.png" alt="在这里插入图片描述"></p> 
<p>所以未来想提取一整行，想提取一整行中的列，我可以按照行列去提取！</p> 
<p>我们可以把MYSQL_RES当作一个char**xx[]数组去理解，或者当作一个char*[][]数组去理解都可以，怎么方便怎么来。纵向去遍历每一行，横向去遍历一行中每一列。就可以找所有查询结果都找到。</p> 
<p><img src="https://images2.imgbox.com/d4/68/YUkl3dxC_o.png" alt="在这里插入图片描述"></p> 
<p>未来MYSQL_RES就以这样的方式把查询的结果保存起来。</p> 
<p>那结果最终怎么遍历呢？首先我们要知道这个转储的结果有多少行，有多少列！然后按照行列去遍历。</p> 
<p><strong>获取结果行数mysql_num_rows</strong><br> 参数是MYSQL_RES，从MYSQL_RES结果集中拿结果有多少行。</p> 
<pre><code class="prism language-cpp">my_ulonglong <span class="token function">mysql_num_rows</span><span class="token punctuation">(</span>MYSQL_RES <span class="token operator">*</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>获取结果列数mysql_num_fields</strong></p> 
<pre><code class="prism language-cpp"><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">mysql_num_fields</span><span class="token punctuation">(</span>MYSQL_RES <span class="token operator">*</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 1. 初始化mysql,构建mysql对象,得到mysql访问句柄</span>
    MYSQL <span class="token operator">*</span>my <span class="token operator">=</span> <span class="token function">mysql_init</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>my <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"init MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 2.连接数据库</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysql_real_connect</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> host<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> passwd<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> db<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> port<span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"connect MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// cout&lt;&lt;"connect success"&lt;&lt;endl;</span>

    <span class="token comment">// 设置编码格式</span>
    <span class="token function">mysql_set_character_set</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> <span class="token string">"utf8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    string sql<span class="token operator">=</span><span class="token string">"select * from user"</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> n<span class="token operator">=</span><span class="token function">mysql_query</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span>sql<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> 
    <span class="token punctuation">{<!-- --></span>
        cout<span class="token operator">&lt;&lt;</span>sql<span class="token operator">&lt;&lt;</span><span class="token string">" success"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{<!-- --></span>
        cout<span class="token operator">&lt;&lt;</span>sql<span class="token operator">&lt;&lt;</span><span class="token string">" error"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> 

    MYSQL_RES<span class="token operator">*</span> res<span class="token operator">=</span><span class="token function">mysql_store_result</span><span class="token punctuation">(</span>my<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>res <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr<span class="token operator">&lt;&lt;</span><span class="token string">"mysql_store_result error"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    my_ulonglong row<span class="token operator">=</span><span class="token function">mysql_num_rows</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    my_ulonglong col<span class="token operator">=</span><span class="token function">mysql_num_fields</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"行: "</span> <span class="token operator">&lt;&lt;</span> rows <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"列: "</span> <span class="token operator">&lt;&lt;</span> cols <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    <span class="token comment">// 3.用完之后close，释放资源</span>
    <span class="token function">mysql_close</span><span class="token punctuation">(</span>my<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>目前这个表不就是3行4列吗</p> 
<p><img src="https://images2.imgbox.com/18/c7/i0EzBC4e_o.png" alt="在这里插入图片描述"></p> 
<p>那结果怎么拿？遍历每一行每一列。一行一列的把结果都拿到。<br> mysql为了很好的支持遍历，它内部还提供一种数据结构叫做MYSQL_ROW，每次拿到一行。</p> 
<p><strong>获取结果内容mysql_fetch_row</strong></p> 
<pre><code class="prism language-cpp">MYSQL_ROW <span class="token function">mysql_fetch_row</span><span class="token punctuation">(</span>MYSQL_RES <span class="token operator">*</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>这个函数就向以前学过的迭代器，当我们第一次调用mysql_fetch_row它内部会为我们维护当前遍历的第一行，把第一行的结果集以MYSQL_ROW形式返回。当遍历第二行的时候，只需要在调用一次mysql_fetch_row，不用自己维护行下标，它会自动指向下一行。就如迭代器一样，只需要按照特定的次数进行遍历调用就会依次把元素遍历一遍，特别像迭代器。</p> 
<p>可以看到MYSQL_ROW其实就是一个char<strong>指针，因为只有char</strong>才能指向第一行第二行等等。<br> <img src="https://images2.imgbox.com/a1/12/kAS2Toe4_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 1. 初始化mysql,构建mysql对象,得到mysql访问句柄</span>
    MYSQL <span class="token operator">*</span>my <span class="token operator">=</span> <span class="token function">mysql_init</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>my <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"init MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 2.连接数据库</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysql_real_connect</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> host<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> passwd<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> db<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> port<span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"connect MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// cout&lt;&lt;"connect success"&lt;&lt;endl;</span>

    <span class="token comment">// 设置编码格式</span>
    <span class="token function">mysql_set_character_set</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> <span class="token string">"utf8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    string sql <span class="token operator">=</span> <span class="token string">"select * from user"</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> sql<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cout <span class="token operator">&lt;&lt;</span> sql <span class="token operator">&lt;&lt;</span> <span class="token string">" success"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{<!-- --></span>
        cout <span class="token operator">&lt;&lt;</span> sql <span class="token operator">&lt;&lt;</span> <span class="token string">" error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    MYSQL_RES <span class="token operator">*</span>res <span class="token operator">=</span> <span class="token function">mysql_store_result</span><span class="token punctuation">(</span>my<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"mysql_store_result error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//下面都是和结果集有关的, MYSQL_RES</span>
    my_ulonglong rows <span class="token operator">=</span> <span class="token function">mysql_num_rows</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    my_ulonglong cols <span class="token operator">=</span> <span class="token function">mysql_num_fields</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>

    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"行: "</span> <span class="token operator">&lt;&lt;</span> rows <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"列: "</span> <span class="token operator">&lt;&lt;</span> cols <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	<span class="token comment">//拿结果  </span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>rows<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        MYSQL_ROW line<span class="token operator">=</span><span class="token function">mysql_fetch_row</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>cols<span class="token punctuation">;</span><span class="token operator">++</span>j<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            cout<span class="token operator">&lt;&lt;</span>line<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token string">"\t"</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span>
        cout<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

        <span class="token comment">// 3.用完之后close，释放资源</span>
        <span class="token function">mysql_close</span><span class="token punctuation">(</span>my<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>现在我们就可以把select的结果都拿到了！</p> 
<p><img src="https://images2.imgbox.com/21/af/EKXyzK2r_o.png" alt="在这里插入图片描述"></p> 
<p>刚才说了在获取msyql表内容的时候，我们除了获取表格中内容，它的列属性我们也想获取。想知道它是那一列的，或者想知道当前查的是那张表，那个数据库。怎么办呢？我们有另一个接口。</p> 
<p><strong>获取列名mysql_fetch_fields</strong></p> 
<pre><code class="prism language-cpp">MYSQL_FIELD <span class="token operator">*</span><span class="token function">mysql_fetch_fields</span><span class="token punctuation">(</span>MYSQL_RES <span class="token operator">*</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>与mysql_fetch_fields相对的还有一个mysql_fetch_field接口，mysql_fetch_fields以数组形式返回的是所有的列属性对应的结构体。每一列属性都是一个结构体。<br> mysql_fetch_field可以让你依次遍历所有列，以列为单位，第一次是第一列，第二次是第二列，也就像迭代器。</p> 
<p><img src="https://images2.imgbox.com/32/eb/LP00qDB4_o.png" alt="在这里插入图片描述"></p> 
<p>这里我们就不麻烦了，直接一次获得所有列属性。然后可以遍历所有列把列名称打印出来。</p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 1. 初始化mysql,构建mysql对象,得到mysql访问句柄</span>
    MYSQL <span class="token operator">*</span>my <span class="token operator">=</span> <span class="token function">mysql_init</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>my <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"init MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 2.连接数据库</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysql_real_connect</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> host<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> passwd<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> db<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> port<span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"connect MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// cout&lt;&lt;"connect success"&lt;&lt;endl;</span>

    <span class="token comment">// 设置编码格式</span>
    <span class="token function">mysql_set_character_set</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> <span class="token string">"utf8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    string sql <span class="token operator">=</span> <span class="token string">"select * from user"</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> sql<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cout <span class="token operator">&lt;&lt;</span> sql <span class="token operator">&lt;&lt;</span> <span class="token string">" success"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{<!-- --></span>
        cout <span class="token operator">&lt;&lt;</span> sql <span class="token operator">&lt;&lt;</span> <span class="token string">" error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    MYSQL_RES <span class="token operator">*</span>res <span class="token operator">=</span> <span class="token function">mysql_store_result</span><span class="token punctuation">(</span>my<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"mysql_store_result error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//下面都是和结果集有关的, MYSQL_RES</span>
    my_ulonglong rows <span class="token operator">=</span> <span class="token function">mysql_num_rows</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    my_ulonglong cols <span class="token operator">=</span> <span class="token function">mysql_num_fields</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>

    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"行: "</span> <span class="token operator">&lt;&lt;</span> rows <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"列: "</span> <span class="token operator">&lt;&lt;</span> cols <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    <span class="token comment">//属性</span>
    MYSQL_FIELD<span class="token operator">*</span> fields<span class="token operator">=</span><span class="token function">mysql_fetch_fields</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>cols<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cout<span class="token operator">&lt;&lt;</span>fields<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token operator">&lt;&lt;</span><span class="token string">"\t"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    cout<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>


    <span class="token comment">//内容</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>rows<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        MYSQL_ROW line<span class="token operator">=</span><span class="token function">mysql_fetch_row</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>cols<span class="token punctuation">;</span><span class="token operator">++</span>j<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            cout<span class="token operator">&lt;&lt;</span>line<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token string">"\t"</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span>
        cout<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
    
        <span class="token comment">// 3.用完之后close，释放资源</span>
        <span class="token function">mysql_close</span><span class="token punctuation">(</span>my<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>自此列名称我们就拿到了。</p> 
<p><img src="https://images2.imgbox.com/1a/92/MhbGIkj7_o.png" alt="在这里插入图片描述"><br> 如果你将来想获取什么属性就直接去获取。</p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 1. 初始化mysql,构建mysql对象,得到mysql访问句柄</span>
    MYSQL <span class="token operator">*</span>my <span class="token operator">=</span> <span class="token function">mysql_init</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>my <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"init MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 2.连接数据库</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysql_real_connect</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> host<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> passwd<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> db<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> port<span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"connect MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// cout&lt;&lt;"connect success"&lt;&lt;endl;</span>

    <span class="token comment">// 设置编码格式</span>
    <span class="token function">mysql_set_character_set</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> <span class="token string">"utf8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    string sql <span class="token operator">=</span> <span class="token string">"select * from user"</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> sql<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cout <span class="token operator">&lt;&lt;</span> sql <span class="token operator">&lt;&lt;</span> <span class="token string">" success"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{<!-- --></span>
        cout <span class="token operator">&lt;&lt;</span> sql <span class="token operator">&lt;&lt;</span> <span class="token string">" error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    MYSQL_RES <span class="token operator">*</span>res <span class="token operator">=</span> <span class="token function">mysql_store_result</span><span class="token punctuation">(</span>my<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"mysql_store_result error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//下面都是和结果集有关的, MYSQL_RES</span>
    my_ulonglong rows <span class="token operator">=</span> <span class="token function">mysql_num_rows</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    my_ulonglong cols <span class="token operator">=</span> <span class="token function">mysql_num_fields</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>

    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"行: "</span> <span class="token operator">&lt;&lt;</span> rows <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"列: "</span> <span class="token operator">&lt;&lt;</span> cols <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    <span class="token comment">//属性</span>
    MYSQL_FIELD<span class="token operator">*</span> fields<span class="token operator">=</span><span class="token function">mysql_fetch_fields</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>cols<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cout<span class="token operator">&lt;&lt;</span>fields<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token operator">&lt;&lt;</span><span class="token string">"\t"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    cout<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>


    <span class="token comment">//内容</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>rows<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        MYSQL_ROW line<span class="token operator">=</span><span class="token function">mysql_fetch_row</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>cols<span class="token punctuation">;</span><span class="token operator">++</span>j<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            cout<span class="token operator">&lt;&lt;</span>line<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token string">"\t"</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span>
        cout<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    cout<span class="token operator">&lt;&lt;</span>fields<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>db<span class="token operator">&lt;&lt;</span><span class="token string">" "</span><span class="token operator">&lt;&lt;</span>fields<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>table<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>

    
     <span class="token comment">// 3.用完之后close，释放资源</span>
      <span class="token function">mysql_close</span><span class="token punctuation">(</span>my<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8e/60/Q79URrpB_o.png" alt="在这里插入图片描述"></p> 
<p>最终我们就把mysql的查询结果获取到，然后转储到结果集，然后从结果集中提取行列，还有其他属性和内容。现在我们对增删查改就有一个完整的认识了。</p> 
<p>但是还有一个细节mysql_store_result会把查询结果由MYSQL转储到MYSQL_RES里，MYSQL_RES一定要为我们malloc一大堆空间，所以我们一定要记的 free(result),不然是肯定会造成内存泄漏的。我们不能直接用C的free或者C++的delete，而用的是mysql库提供的这个函数，把结果集中空间释放掉。</p> 
<p><img src="https://images2.imgbox.com/91/20/USwytpIO_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b3/8c/3nk22jrt_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 1. 初始化mysql,构建mysql对象,得到mysql访问句柄</span>
    MYSQL <span class="token operator">*</span>my <span class="token operator">=</span> <span class="token function">mysql_init</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>my <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"init MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 2.连接数据库</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysql_real_connect</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> host<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> passwd<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> db<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> port<span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"connect MySQL error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// cout&lt;&lt;"connect success"&lt;&lt;endl;</span>

    <span class="token comment">// 设置编码格式</span>
    <span class="token function">mysql_set_character_set</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> <span class="token string">"utf8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    string sql <span class="token operator">=</span> <span class="token string">"select * from user"</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span>my<span class="token punctuation">,</span> sql<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cout <span class="token operator">&lt;&lt;</span> sql <span class="token operator">&lt;&lt;</span> <span class="token string">" success"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{<!-- --></span>
        cout <span class="token operator">&lt;&lt;</span> sql <span class="token operator">&lt;&lt;</span> <span class="token string">" error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    MYSQL_RES <span class="token operator">*</span>res <span class="token operator">=</span> <span class="token function">mysql_store_result</span><span class="token punctuation">(</span>my<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"mysql_store_result error"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//下面都是和结果集有关的, MYSQL_RES</span>
    my_ulonglong rows <span class="token operator">=</span> <span class="token function">mysql_num_rows</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    my_ulonglong cols <span class="token operator">=</span> <span class="token function">mysql_num_fields</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>

    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"行: "</span> <span class="token operator">&lt;&lt;</span> rows <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"列: "</span> <span class="token operator">&lt;&lt;</span> cols <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    <span class="token comment">//属性</span>
    MYSQL_FIELD<span class="token operator">*</span> fields<span class="token operator">=</span><span class="token function">mysql_fetch_fields</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>cols<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cout<span class="token operator">&lt;&lt;</span>fields<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token operator">&lt;&lt;</span><span class="token string">"\t"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    cout<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>


    <span class="token comment">//内容</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>rows<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        MYSQL_ROW line<span class="token operator">=</span><span class="token function">mysql_fetch_row</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>cols<span class="token punctuation">;</span><span class="token operator">++</span>j<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            cout<span class="token operator">&lt;&lt;</span>line<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token string">"\t"</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span>
        cout<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    cout<span class="token operator">&lt;&lt;</span>fields<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>db<span class="token operator">&lt;&lt;</span><span class="token string">" "</span><span class="token operator">&lt;&lt;</span>fields<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>table<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>

     <span class="token comment">//释放结果集</span>
     <span class="token function">mysql_free_result</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token comment">// 3.用完之后close，释放资源</span>
      <span class="token function">mysql_close</span><span class="token punctuation">(</span>my<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>可以看到对于读取的处理其实是挺麻烦的。</p> 
<p>我们常用的接口就这些，对于一般数据库读取没有任何问题。</p> 
<p>最后，mysql C api还支持事务等常用操作，大家下来自行了解:</p> 
<pre><code class="prism language-cpp">my_bool STDCALL <span class="token function">mysql_autocommit</span><span class="token punctuation">(</span>MYSQL <span class="token operator">*</span> mysql<span class="token punctuation">,</span> my_bool auto_mode<span class="token punctuation">)</span><span class="token punctuation">;</span>
my_bool STDCALL <span class="token function">mysql_commit</span><span class="token punctuation">(</span>MYSQL <span class="token operator">*</span> mysql<span class="token punctuation">)</span><span class="token punctuation">;</span>
my_bool STDCALL <span class="token function">mysql_rollback</span><span class="token punctuation">(</span>MYSQL <span class="token operator">*</span> mysql<span class="token punctuation">)</span>
</code></pre> 
<p>目前为止所有连接数据库的操作，我们已经有第二种方案。以前就是mysql命令行式的、刚刚就是mysql的C/C++的连接方案，我们还可以通过图形化界面连接数据库。</p> 
<h2><a id="4_1059"></a>4.图形化界面访问数据库</h2> 
<p>这里推荐几个好用的图形化界面。</p> 
<p><strong>Nacicat</strong>是一个桌面版的mysql数据库管理和开发工具，以图形化界面显示数据库的操作。虽然这个工具非常好用，但遗憾的是，这个软件是收费的。可以自己在网上找找它的破解版。</p> 
<p><img src="https://images2.imgbox.com/97/b1/UM4WjOYx_o.png" alt="在这里插入图片描述"><br> <strong>SQLyog</strong> 也是一个易于使用的、快速而简洁的图形化管理MYSQL数据库的工具，它能够在任何地点有效地管理你的数据库。但同样的，虽然它用起来很舒服，但它也是收费的<br> <img src="https://images2.imgbox.com/9f/f4/a4EJBKb8_o.png" alt="在这里插入图片描述"><br> <strong>MYSQL Workbench</strong>是mysql官方提供的数据库管理和开发工具，支持图形化界面。虽然它在使用上并没有上面的Navicat和SQLyog好用，但优点就是它是免费的。这里我们重点就用它。</p> 
<h3><a id="41MYSQL_Workbench_1069"></a>4.1下载MYSQL Workbench</h3> 
<p>我们可以直接去mysql官网上去找到它，然后下载。</p> 
<p><img src="https://images2.imgbox.com/ab/80/PO6aDyXf_o.png" alt="在这里插入图片描述"></p> 
<p>往下翻找到这个然后进去</p> 
<p><img src="https://images2.imgbox.com/38/56/RctfwoHm_o.png" alt="在这里插入图片描述"></p> 
<p>找到MySQL Workbench然后进去</p> 
<p><img src="https://images2.imgbox.com/76/ba/EojWReur_o.png" alt="在这里插入图片描述"></p> 
<p>选择对应的操作系统，直接下载就行了</p> 
<p><img src="https://images2.imgbox.com/fb/67/gXQnzeQp_o.png" alt="在这里插入图片描述"></p> 
<p>下好之后运行就是这个样子</p> 
<p><img src="https://images2.imgbox.com/10/11/X24VB2ro_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="42MYSQL_Workbench_1091"></a>4.2MYSQL Workbench远程连接数据库</h3> 
<p>MYSQL Workbench也是一个客户端，说白了它和我们自己写的C/C++客户端和曾经mysql对应的命令行客户端是没有任何差别的，它也要进行网络请求，也要进行登录。所以mysql一定要允许这个用户进行远程登录。</p> 
<p>因此我们在创建一个允许远程登录的账号。<br> 创建一个允许用户从任意地点登录。这个任意登录这件事情，虽然我们这样写了，一般在公司内允许那一台机器访问数据库可以把这个IP地址确定下来不用填%，今天我们用的云服务器，我们内网经过NAT路由器转发IP地址会发生改变。本地IP配上去没有任何意义，所以这里只能用%。</p> 
<pre><code class="prism language-powershell">create user <span class="token string">'workbench'</span>@<span class="token string">'%'</span> identified by <span class="token string">'xxx'</span><span class="token punctuation">;</span>
</code></pre> 
<p>然后在给新用户赋权。把conn数据库所有表的权限都给这个用户。</p> 
<pre><code class="prism language-powershell">grant all on conn<span class="token punctuation">.</span><span class="token operator">*</span> to <span class="token string">'workbench'</span>@<span class="token string">'%'</span><span class="token punctuation">;</span>
</code></pre> 
<p>然后才能远程连接，点击这里+，配置一下相关信息</p> 
<p><img src="https://images2.imgbox.com/bf/cb/9XbCuQjp_o.png" alt="在这里插入图片描述"></p> 
<p>我们主要填的就是IP地址，端口号，和用户。还可以给这个连接起个名字。</p> 
<p><img src="https://images2.imgbox.com/8a/12/Q0Neqo0d_o.png" alt="在这里插入图片描述"></p> 
<p>配置好，然后点击下面的，代表测试一下连接，它会要求输入对应的密码，直接把这个用户的密码输入就行了。</p> 
<p><img src="https://images2.imgbox.com/78/6b/qzpopzNj_o.png" alt="在这里插入图片描述"></p> 
<p>如果成功连接在点击ok就是下面这样，如果连接不上可能是你端口号没有放出来。自己放一下。如果想登录的话，点击一下这个出来的东西，然后就登录进去了。</p> 
<p><img src="https://images2.imgbox.com/ad/45/6FUgOHjX_o.png" alt="在这里插入图片描述"></p> 
<p>进去之后我们可以看到对应表结构、视图，存储过程和函数这些。我们现在只用关系表结构就可以了。表结构里面对应的列、索引、外键、触发器这些。</p> 
<p><img src="https://images2.imgbox.com/2d/5b/dxGtP8td_o.png" alt="在这里插入图片描述"></p> 
<p>列里面可以看到对应列的属性，如id列的主机和自增长</p> 
<p><img src="https://images2.imgbox.com/03/46/EnLo1uZS_o.png" alt="在这里插入图片描述"></p> 
<p>下面我们可以在框里写一些sql指令了。写完之后选中或者光标放在你写的sql这里然后点击这个闪电执行它。然后下面就可以看到对应的信息。</p> 
<p><img src="https://images2.imgbox.com/96/67/4WAnkpao_o.png" alt="在这里插入图片描述"></p> 
<p>虽然光标放在后面点击闪电也可以执行，但是它是从上到下开始执行的，如果只需要执行某一个sql指令，还是要选择它然后在去执行。</p> 
<p><img src="https://images2.imgbox.com/06/e5/bGBEhPoW_o.png" alt="在这里插入图片描述"></p> 
<p>接下来我们可以<strong>查</strong>一下这个表，可以看到这里担心数据太多，默认只把0-1000行筛选出来。</p> 
<p><img src="https://images2.imgbox.com/14/df/QJSZmYBj_o.png" alt="在这里插入图片描述"></p> 
<p>然后可以直接在这里对数据进行<strong>插入</strong>，然后再点击Apply执行一下</p> 
<p><img src="https://images2.imgbox.com/31/59/mEPUOSBj_o.png" alt="在这里插入图片描述"></p> 
<p>Apply会把刚刚在图形化界面这里做的动作变成sql的语句，然后在点Apply执行。</p> 
<p><img src="https://images2.imgbox.com/07/10/qnvkIroE_o.png" alt="在这里插入图片描述"></p> 
<p>然后在点Finsh，这个插入就算真正执行完成了</p> 
<p><img src="https://images2.imgbox.com/c5/6f/2TjHA97G_o.png" alt="在这里插入图片描述"></p> 
<p>然后我们查一下，确实看到是插入了</p> 
<p><img src="https://images2.imgbox.com/5c/29/KT9wHAUS_o.png" alt="在这里插入图片描述"></p> 
<p>接下里我们想把张三这条记录<strong>删除</strong>一下，可以直接在图形化界面删除，然后还是和上面一样的流程Apply。</p> 
<p><img src="https://images2.imgbox.com/f9/47/8lAxjefM_o.png" alt="在这里插入图片描述"></p> 
<p>然后这看到确实可以删除。</p> 
<p><img src="https://images2.imgbox.com/28/8f/lc8545co_o.png" alt="在这里插入图片描述"></p> 
<p><strong>更新</strong>也是一样在图形化界面改，然后Apply执行一下。我们把李四年龄改成90岁。</p> 
<p><img src="https://images2.imgbox.com/4d/95/aFNIy74V_o.png" alt="在这里插入图片描述"></p> 
<p>看到确实也是改了</p> 
<p><img src="https://images2.imgbox.com/a4/63/h0hBd7gp_o.png" alt="在这里插入图片描述"></p> 
<p>换言之，我们就不用自己写sql了，拿到表结构对它进行增删查改，直接在里面手改就行了。这就是图形化界面的好处。</p> 
<p>如果想把自己写的一大堆sql指令保存一下，可以ctrl+s保存。形成一个.sql文件。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/16cba50c38daacedfa8e315e05066ced/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Spring Boot】Spring AOP中的环绕通知</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/48837ff3c3e9293079a7942e34caa15c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">力扣每日一题 7/2 数学、数论、数组/双指针</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>