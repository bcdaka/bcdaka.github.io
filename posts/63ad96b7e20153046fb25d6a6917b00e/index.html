<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Laravel数据库的魔法棒：深入探索数据库迁移（Migrations） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/63ad96b7e20153046fb25d6a6917b00e/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Laravel数据库的魔法棒：深入探索数据库迁移（Migrations）">
  <meta property="og:description" content="Laravel数据库的魔法棒：深入探索数据库迁移（Migrations） 在Laravel的世界中，数据库迁移（Migrations）是一种强大的工具，它允许开发者以版本控制的方式管理数据库结构的变化。通过迁移，你可以轻松地创建、修改或删除数据库表，同时保持代码的整洁和一致性。本文将带你深入了解Laravel数据库迁移的概念、作用以及如何使用它们，并通过实际的代码示例，让你对Laravel迁移有更直观的认识。
什么是Laravel数据库迁移？ Laravel数据库迁移是一种文件，用于描述数据库表的创建、修改或删除。每个迁移文件都包含了两个方法：up()和down()。up()方法定义了如何应用迁移，而down()方法则定义了如何撤销迁移。这使得数据库结构的版本控制成为可能。
为什么使用数据库迁移？ 版本控制：迁移文件可以与代码一起进行版本控制，使得团队协作更加方便。可重复性：迁移可以被重复运行，确保在不同环境或数据库中应用相同的数据库结构。可逆性：迁移可以被撤销，使得数据库结构的修改更加安全。自动化：Laravel提供了命令行工具来自动化迁移的运行和管理。 如何创建数据库迁移？ 在Laravel中，创建迁移非常简单。首先，确保你已经安装了Laravel，并创建了一个项目。然后，使用以下命令创建一个新的迁移文件：
php artisan make:migration create_users_table 这将在database/migrations目录下创建一个新的迁移文件，文件名包含时间戳，以确保迁移的顺序。
编写迁移代码 打开创建的迁移文件，你将看到以下结构：
use Illuminate\Database\Migrations\Migration; use Illuminate\Database\Schema\Blueprint; use Illuminate\Support\Facades\Schema; class CreateUsersTable extends Migration { /** * Run the migrations. * * @return void */ public function up() { Schema::create(&#39;users&#39;, function (Blueprint $table) { $table-&gt;id(); $table-&gt;string(&#39;name&#39;); $table-&gt;string(&#39;email&#39;)-&gt;unique(); $table-&gt;timestamp(&#39;email_verified_at&#39;)-&gt;nullable(); $table-&gt;string(&#39;password&#39;); $table-&gt;rememberToken(); $table-&gt;timestamps(); }); } /** * Reverse the migrations. * * @return void */ public function down() { Schema::dropIfExists(&#39;users&#39;); } } 在这个示例中，我们创建了一个名为users的表，并定义了一些字段。up()方法用于创建表，而down()方法用于删除表。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-16T21:25:12+08:00">
    <meta property="article:modified_time" content="2024-07-16T21:25:12+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Laravel数据库的魔法棒：深入探索数据库迁移（Migrations）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="LaravelMigrations_0"></a>Laravel数据库的魔法棒：深入探索数据库迁移（Migrations）</h2> 
<p>在Laravel的世界中，数据库迁移（Migrations）是一种强大的工具，它允许开发者以版本控制的方式管理数据库结构的变化。通过迁移，你可以轻松地创建、修改或删除数据库表，同时保持代码的整洁和一致性。本文将带你深入了解Laravel数据库迁移的概念、作用以及如何使用它们，并通过实际的代码示例，让你对Laravel迁移有更直观的认识。</p> 
<h3><a id="Laravel_4"></a>什么是Laravel数据库迁移？</h3> 
<p>Laravel数据库迁移是一种文件，用于描述数据库表的创建、修改或删除。每个迁移文件都包含了两个方法：<code>up()</code>和<code>down()</code>。<code>up()</code>方法定义了如何应用迁移，而<code>down()</code>方法则定义了如何撤销迁移。这使得数据库结构的版本控制成为可能。</p> 
<h3><a id="_8"></a>为什么使用数据库迁移？</h3> 
<ol><li><strong>版本控制</strong>：迁移文件可以与代码一起进行版本控制，使得团队协作更加方便。</li><li><strong>可重复性</strong>：迁移可以被重复运行，确保在不同环境或数据库中应用相同的数据库结构。</li><li><strong>可逆性</strong>：迁移可以被撤销，使得数据库结构的修改更加安全。</li><li><strong>自动化</strong>：Laravel提供了命令行工具来自动化迁移的运行和管理。</li></ol> 
<h3><a id="_15"></a>如何创建数据库迁移？</h3> 
<p>在Laravel中，创建迁移非常简单。首先，确保你已经安装了Laravel，并创建了一个项目。然后，使用以下命令创建一个新的迁移文件：</p> 
<pre><code class="prism language-bash">php artisan make:migration create_users_table
</code></pre> 
<p>这将在<code>database/migrations</code>目录下创建一个新的迁移文件，文件名包含时间戳，以确保迁移的顺序。</p> 
<h3><a id="_25"></a>编写迁移代码</h3> 
<p>打开创建的迁移文件，你将看到以下结构：</p> 
<pre><code class="prism language-php"><span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span class="token punctuation">\</span>Migrations<span class="token punctuation">\</span>Migration</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span class="token punctuation">\</span>Schema<span class="token punctuation">\</span>Blueprint</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Schema</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">CreateUsersTable</span> <span class="token keyword">extends</span> <span class="token class-name">Migration</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">/**
     * Run the migrations.
     *
     * @return void
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">up</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name static-context">Schema</span><span class="token operator">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'users'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token class-name type-declaration">Blueprint</span> <span class="token variable">$table</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'email'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token function">timestamp</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'email_verified_at'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">nullable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token function">rememberToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token function">timestamps</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Reverse the migrations.
     *
     * @return void
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">down</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name static-context">Schema</span><span class="token operator">::</span><span class="token function">dropIfExists</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'users'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在这个示例中，我们创建了一个名为<code>users</code>的表，并定义了一些字段。<code>up()</code>方法用于创建表，而<code>down()</code>方法用于删除表。</p> 
<h3><a id="_68"></a>运行迁移</h3> 
<p>创建并编写迁移代码后，你可以使用以下命令运行迁移：</p> 
<pre><code class="prism language-bash">php artisan migrate
</code></pre> 
<p>这将执行所有未应用的迁移，更新数据库结构。</p> 
<h3><a id="_78"></a>回滚迁移</h3> 
<p>如果你需要撤销最近的迁移，可以使用以下命令：</p> 
<pre><code class="prism language-bash">php artisan migrate:rollback
</code></pre> 
<p>这将执行最近的迁移的<code>down()</code>方法，撤销数据库的更改。</p> 
<h3><a id="_88"></a>重置迁移</h3> 
<p>如果你想撤销所有迁移并重新开始，可以使用以下命令：</p> 
<pre><code class="prism language-bash">php artisan migrate:reset
</code></pre> 
<p>这将撤销所有迁移，并重置数据库结构。</p> 
<h3><a id="_98"></a>总结</h3> 
<p>Laravel数据库迁移是管理数据库结构变化的强大工具。通过本文，你应该已经了解了数据库迁移的概念、作用以及如何使用它们。希望本文能够帮助你更好地使用Laravel迁移，让你的数据库管理更加高效和安全。</p> 
<hr> 
<p>以上就是关于Laravel数据库迁移的详细介绍。如果你有任何疑问或需要进一步的指导，请随时与我们联系。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ee1a6de855782997d9940e29e08b73c9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">技术速递｜Let’s Learn .NET Aspire – 开始您的云原生之旅！</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f94eb9d6970ecc744360d25718f833cd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">[Spring] Spring Web MVC案例实战</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>