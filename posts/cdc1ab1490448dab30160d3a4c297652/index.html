<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MySQL 9.0 的两种部署模式 以及各个版本发布的新功能 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/cdc1ab1490448dab30160d3a4c297652/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="MySQL 9.0 的两种部署模式 以及各个版本发布的新功能">
  <meta property="og:description" content="MySQL 9.0 以及各个版本发布的新功能 1.MySQL 9.0 创新版发布 Oracle 每季度发布一次 MySQL 更新，2024年7月1日推出了最新的 MySQL 9.0 创新版本。
MySQL发布模型分为两个主要轨道：LTS（长期支持）和创新。所有LTS和Innovation版本都包含错误和安全修复，并被视为生产级质量。
1.1 MySQL 9.0 功能进化 1.1.1 添加或更改的功能 1.从MySQL 9.0.0开始支持将 EXPLAIN ANALYZE的JSON输出保存到用户变量中 EXPLAIN ANALYZE FORMAT=JSON INTO @variable select_stmt mysql&gt; EXPLAIN FORMAT=JSON INTO @myupdate -&gt; UPDATE a SET name2 = &#34;garcia&#34; WHERE id = 3; mysql&gt; SELECT @myupdate, @mydelete\G *************************** 1. row *************************** @myupdate: { &#34;query_block&#34;: { &#34;select_id&#34;: 1, &#34;table&#34;: { &#34;update&#34;: true, &#34;table_name&#34;: &#34;a&#34;, &#34;access_type&#34;: &#34;range&#34;, &#34;possible_keys&#34;: [ &#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-02T17:42:20+08:00">
    <meta property="article:modified_time" content="2024-07-02T17:42:20+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MySQL 9.0 的两种部署模式 以及各个版本发布的新功能</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="MySQL_90__0"></a>MySQL 9.0 以及各个版本发布的新功能</h2> 
<h3><a id="1MySQL_90__2"></a>1.MySQL 9.0 创新版发布</h3> 
<blockquote> 
 <p>Oracle 每季度发布一次 MySQL 更新，2024年7月1日推出了最新的 MySQL 9.0 创新版本。</p> 
 <p>MySQL发布模型分为两个主要轨道：LTS（长期支持）和创新。所有LTS和Innovation版本都包含错误和安全修复，并被视为生产级质量。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/ae/92/r5ZJFc32_o.png" alt="image-20240702152346542"></p> 
<h4><a id="11_MySQL_90__10"></a>1.1 MySQL 9.0 功能进化</h4> 
<h5><a id="111__12"></a>1.1.1 添加或更改的功能</h5> 
<pre><code class="prism language-bash"><span class="token number">1</span>.从MySQL <span class="token number">9.0</span>.0开始支持将
EXPLAIN ANALYZE的JSON输出保存到用户变量中

EXPLAIN ANALYZE <span class="token assign-left variable">FORMAT</span><span class="token operator">=</span>JSON INTO @variable select_stmt

mysql<span class="token operator">&gt;</span> EXPLAIN <span class="token assign-left variable">FORMAT</span><span class="token operator">=</span>JSON INTO @myupdate 
    -<span class="token operator">&gt;</span>   UPDATE a SET name2 <span class="token operator">=</span> <span class="token string">"garcia"</span> WHERE <span class="token function">id</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>              
mysql<span class="token operator">&gt;</span> SELECT @myupdate, @mydelete<span class="token punctuation">\</span>G
*************************** <span class="token number">1</span>. row ***************************
@myupdate: <span class="token punctuation">{<!-- --></span>
  <span class="token string">"query_block"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"select_id"</span><span class="token builtin class-name">:</span> <span class="token number">1</span>,
    <span class="token string">"table"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string">"update"</span><span class="token builtin class-name">:</span> true,
      <span class="token string">"table_name"</span><span class="token builtin class-name">:</span> <span class="token string">"a"</span>,
      <span class="token string">"access_type"</span><span class="token builtin class-name">:</span> <span class="token string">"range"</span>,
      <span class="token string">"possible_keys"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
        <span class="token string">"PRIMARY"</span>
      <span class="token punctuation">]</span>,
      <span class="token string">"key"</span><span class="token builtin class-name">:</span> <span class="token string">"PRIMARY"</span>,
      <span class="token string">"used_key_parts"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
        <span class="token string">"id"</span>
      <span class="token punctuation">]</span>,
      <span class="token string">"key_length"</span><span class="token builtin class-name">:</span> <span class="token string">"4"</span>,
      <span class="token string">"ref"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
        <span class="token string">"const"</span>
      <span class="token punctuation">]</span>,
      <span class="token string">"rows_examined_per_scan"</span><span class="token builtin class-name">:</span> <span class="token number">1</span>,
      <span class="token string">"filtered"</span><span class="token builtin class-name">:</span> <span class="token string">"100.00"</span>,
      <span class="token string">"attached_condition"</span><span class="token builtin class-name">:</span> <span class="token string">"(<span class="token variable"><span class="token variable">`</span>db<span class="token variable">`</span></span>.<span class="token variable"><span class="token variable">`</span>a<span class="token variable">`</span></span>.<span class="token variable"><span class="token variable">`</span><span class="token function">id</span><span class="token variable">`</span></span> = 3)"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-bash"><span class="token number">2</span>.Event DDL <span class="token keyword">in</span> prepared statements
MySQL <span class="token number">9.0</span>提供了对服务器端准备语句的支持，那有什么好处呢？
a.减少每次执行语句时解析语句的开销。
通常，数据库应用程序处理大量几乎相同的语句，
只更改子句中的文字或变量值，
如用于查询和删除的WHERE、用于更新的SET和用于插入的values。
b.防止SQL注入攻击。
参数值可以包含未加转义的SQL引号和分隔符。

--使用方法如下：
mysql<span class="token operator">&gt;</span> PREPARE stmt1 FROM <span class="token string">'SELECT SQRT(POW(?,2) + POW(?,2)) AS hypotenuse'</span><span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span> SET @a <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span> SET @b <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span> EXECUTE stmt1 USING @a, @b<span class="token punctuation">;</span>
+------------+
<span class="token operator">|</span> hypotenuse <span class="token operator">|</span>
+------------+
<span class="token operator">|</span>          <span class="token number">5</span> <span class="token operator">|</span>
+------------+
mysql<span class="token operator">&gt;</span> DEALLOCATE PREPARE stmt1<span class="token punctuation">;</span>

</code></pre> 
<pre><code class="prism language-bash"><span class="token number">3</span>.新增2个性能架构系统变量表
（1）variables_metadata表
提供了有关系统变量的一般信息。
这些信息包括MySQL服务器识别的每个系统变量的
名称、范围、类型、范围（如适用）和描述。

（2）global_variable_attributes表
提供了有关服务器分配给全局系统变量的属性值对的信息。

</code></pre> 
<h5><a id="112__86"></a>1.1.2 弃用的功能</h5> 
<pre><code class="prism language-bash">能架构variables_info表列的MIN_VALUE和MAX_VALUE列现在已被弃用，
请使用variables_metadata表中具有相同名称的列
</code></pre> 
<h5><a id="113__93"></a>1.1.3 删除的功能</h5> 
<blockquote> 
 <p>为了向后兼容，mysql_native_password在客户端上仍然可用，因此mysql 9.0客户端程序可以连接到早期版本的mysql服务器。在MySQL 9.0中，以前版本的客户端程序中内置的MySQL本地身份验证插件已转换为必须在运行时加载的插件。</p> 
</blockquote> 
<blockquote> 
 <p>其实从mysql 8.0中不推荐使用的mysql_native_password身份验证插件已被删除。<br> 服务器现在拒绝来自不具有client_PLUGIN_AUTH<br> 功能的旧客户端程序的mysql_native身份验证请求<br> 由于此更改，9.0还删除了以下服务器选项和变量：<br> –mysql本机密码服务器选项<br> –mysql本机密码代理用户服务器选项<br> –default_authentication_plugin服务器系统变量</p> 
</blockquote> 
<h4><a id="12__105"></a>1.2 二进制编译安装</h4> 
<p>下载地址：https://dev.mysql.com/downloads/mysql/</p> 
<p><img src="https://images2.imgbox.com/b4/98/ZNbObVHt_o.png" alt="image-20240702153154523"></p> 
<pre><code class="prism language-bash"><span class="token shebang important">#! /bin/bash</span>
<span class="token comment">#-----------------------------------------------------</span>
<span class="token comment">#Author:            XingYuyu</span>
<span class="token comment">#Date:              2024-07-2</span>
<span class="token comment">#Blog:              http://8.141.4.74</span>
<span class="token comment">#Filename:          install_offline_mysql9.0_for_rocky9.sh</span>
<span class="token comment">#Description:       [在Rocky 8/9离线二进制安装mysql 9.0]</span>
<span class="token comment">#-----------------------------------------------------</span>
<span class="token assign-left variable">SRC_DIR</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>

<span class="token comment">#MYSQL='mysql-8.3.0-linux-glibc2.28-x86_64.tar.xz'</span>
<span class="token comment">#MYSQL='mysql-8.4.0-linux-glibc2.28-x86_64.tar.xz'</span>
<span class="token assign-left variable">MYSQL</span><span class="token operator">=</span><span class="token string">'mysql-9.0.0-linux-glibc2.28-x86_64.tar.xz'</span>
<span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token string">'123456'</span>

<span class="token assign-left variable">COLOR</span><span class="token operator">=</span><span class="token string">'echo -e \E[01;31m'</span>
<span class="token assign-left variable">END</span><span class="token operator">=</span><span class="token string">'\E[0m'</span>

<span class="token function-name function">check</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token environment constant">$UID</span> <span class="token parameter variable">-ne</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token variable">$COLOR</span><span class="token string">"当前用户不是root, 安装失败"</span><span class="token variable">$END</span>
        <span class="token builtin class-name">exit</span> <span class="token number">1</span>
    <span class="token keyword">fi</span>

    <span class="token builtin class-name">cd</span> <span class="token variable">$SRC_DIR</span>

    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-e</span> <span class="token variable">$MYSQL</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token variable">$COLOR</span><span class="token string">"缺少<span class="token variable">${MYSQL}</span>文件"</span><span class="token variable">$END</span>
        <span class="token variable">$COLOR</span><span class="token string">"请将相关软件放在<span class="token variable">${SRC_DIR}</span>目录下"</span><span class="token variable">$END</span>
        <span class="token builtin class-name">exit</span>
    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token parameter variable">-e</span> /usr/local/mysql <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token variable">$COLOR</span><span class="token string">"数据库已存在，安装失败"</span><span class="token variable">$END</span>
        <span class="token builtin class-name">exit</span>
    <span class="token keyword">else</span>
        <span class="token builtin class-name">return</span>
    <span class="token keyword">fi</span>
<span class="token punctuation">}</span>

<span class="token function-name function">install_mysql</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token variable">$COLOR</span><span class="token string">"开始安装MySQL数据库..."</span><span class="token variable">$END</span>
    yum <span class="token parameter variable">-y</span> <span class="token parameter variable">-q</span> <span class="token function">install</span> libaio numactl-libs
    <span class="token function">tar</span> xf <span class="token variable">$MYSQL</span> <span class="token parameter variable">-C</span> /usr/local/
    <span class="token assign-left variable">MYSQL_DIR</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> $MYSQL <span class="token operator">|</span> <span class="token function">sed</span> <span class="token parameter variable">-nr</span> <span class="token string">'s/^(.*[0-9]).*/\1/p'</span><span class="token variable">)</span></span>
    <span class="token function">ln</span> <span class="token parameter variable">-s</span> /usr/local/<span class="token variable">$MYSQL_DIR</span> /usr/local/mysql
    <span class="token function">chown</span> <span class="token parameter variable">-R</span> root.root /usr/local/mysql/
    <span class="token function">id</span> mysql <span class="token operator">&amp;&gt;</span> /dev/null <span class="token operator">||</span> <span class="token function">useradd</span> <span class="token parameter variable">-s</span> /sbin/nologin <span class="token parameter variable">-r</span> mysql

    <span class="token builtin class-name">echo</span> <span class="token string">'PATH=/usr/local/mysql/bin/:$PATH'</span> <span class="token operator">&gt;</span> /etc/profile.d/mysql.sh
    <span class="token builtin class-name">.</span> /etc/profile.d/mysql.sh
    <span class="token function">ln</span> <span class="token parameter variable">-s</span> /usr/local/mysql/bin/* /usr/bin/

    <span class="token comment"># Create MySQL configuration file</span>
    <span class="token function">cat</span> <span class="token operator">&gt;</span> /etc/my.cnf <span class="token operator">&lt;&lt;-</span><span class="token string">EOF
[mysqld]
server-id=<span class="token variable"><span class="token variable">$(</span><span class="token function">hostname</span> <span class="token parameter variable">-I</span> <span class="token operator">|</span> <span class="token function">cut</span> -d. <span class="token parameter variable">-f4</span><span class="token variable">)</span></span>
log-bin
datadir=/data/mysql
socket=/data/mysql/mysql.sock
log-error=/data/mysql/mysql.log
pid-file=/data/mysql/mysql.pid
[client]
socket=/data/mysql/mysql.sock
EOF</span>

    <span class="token punctuation">[</span> <span class="token parameter variable">-d</span> /data/mysql <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /data/mysql
    <span class="token function">chown</span> <span class="token parameter variable">-R</span> mysql:mysql /data/mysql

    <span class="token comment"># Initialize MySQL Database</span>
    /usr/local/mysql/bin/mysqld --defaults-file<span class="token operator">=</span>/etc/my.cnf --initialize-insecure <span class="token parameter variable">--user</span><span class="token operator">=</span>mysql <span class="token parameter variable">--datadir</span><span class="token operator">=</span>/data/mysql

    <span class="token comment"># Create systemd service file for MySQL</span>
    <span class="token function">cat</span> <span class="token operator">&gt;</span> /etc/systemd/system/mysqld.service <span class="token operator">&lt;&lt;-</span><span class="token string">EOF
[Unit]
Description=MySQL Server
After=network.target
Wants=network.target

[Service]
User=mysql
Group=mysql
ExecStart=/usr/local/mysql/bin/mysqld --defaults-file=/etc/my.cnf --datadir=/data/mysql --socket=/data/mysql/mysql.sock
ExecStop=/usr/local/mysql/bin/mysqladmin shutdown
Restart=on-failure
LimitNOFILE=5000

[Install]
WantedBy=multi-user.target
EOF</span>

    <span class="token comment"># Reload systemd manager configuration</span>
    systemctl daemon-reload
    <span class="token comment"># Enable mysqld service to start on boot</span>
    systemctl <span class="token builtin class-name">enable</span> mysqld
    <span class="token comment"># Start mysqld service</span>
    systemctl start mysqld

    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$?</span> <span class="token parameter variable">-ne</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token variable">$COLOR</span><span class="token string">"数据库启动失败，退出!"</span><span class="token variable">$END</span>
        <span class="token builtin class-name">exit</span>
    <span class="token keyword">fi</span>

    <span class="token function">sleep</span> <span class="token number">3</span>
    /usr/local/mysql/bin/mysqladmin <span class="token parameter variable">-uroot</span> password <span class="token string">"<span class="token variable">$MYSQL_ROOT_PASSWORD</span>"</span> <span class="token operator">&amp;&gt;</span>/dev/null

    <span class="token variable">$COLOR</span><span class="token string">"数据库安装完成"</span><span class="token variable">$END</span>
<span class="token punctuation">}</span>

check
install_mysql
</code></pre> 
<pre><code class="prism language-bash"><span class="token comment"># 使用上面脚本安装 MySQL 9.0（前提：将安装包上传和脚本上传到同一目录下）</span>
<span class="token punctuation">[</span>root@Rocky9 src<span class="token punctuation">]</span><span class="token comment"># bash install_offline_mysql8.3_for_rocky9.sh</span>
开始安装MySQL数据库<span class="token punctuation">..</span>.

Upgraded:
  numactl-libs-2.0.16-3.el9.x86_64

Created symlink /etc/systemd/system/multi-user.target.wants/mysqld.service → /etc/systemd/system/mysqld.service.
数据库安装完成
<span class="token punctuation">[</span>root@Rocky9 src<span class="token punctuation">]</span><span class="token comment">#[root@Rocky9 src]# mysql -uroot -p123456</span>
mysql: <span class="token punctuation">[</span>Warning<span class="token punctuation">]</span> Using a password on the <span class="token builtin class-name">command</span> line interface can be insecure.
Welcome to the MySQL monitor.  Commands end with <span class="token punctuation">;</span> or <span class="token punctuation">\</span>g.
Your MySQL connection <span class="token function">id</span> is <span class="token number">9</span>
Server version: <span class="token number">9.0</span>.0 MySQL Community Server - GPL

Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">2000</span>, <span class="token number">2024</span>, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type <span class="token string">'help;'</span> or <span class="token string">'\h'</span> <span class="token keyword">for</span> help. Type <span class="token string">'\c'</span> to <span class="token function">clear</span> the current input statement.

mysql<span class="token operator">&gt;</span> status
--------------
mysql  Ver <span class="token number">9.0</span>.0 <span class="token keyword">for</span> Linux on x86_64 <span class="token punctuation">(</span>MySQL Community Server - GPL<span class="token punctuation">)</span>

Connection id:		<span class="token number">9</span>
Current database:
Current user:		root@localhost
SSL:			Not <span class="token keyword">in</span> use
Current pager:		stdout
Using outfile:		<span class="token string">''</span>
Using delimiter:	<span class="token punctuation">;</span>
Server version:		<span class="token number">9.0</span>.0 MySQL Community Server - GPL
Protocol version:	<span class="token number">10</span>
Connection:		Localhost via UNIX socket
Server characterset:	utf8mb4
Db     characterset:	utf8mb4
Client characterset:	utf8mb4
Conn.  characterset:	utf8mb4
UNIX socket:		/data/mysql/mysql.sock
Binary data as:		Hexadecimal
Uptime:			<span class="token number">29</span> sec

Threads: <span class="token number">2</span>  Questions: <span class="token number">10</span>  Slow queries: <span class="token number">0</span>  Opens: <span class="token number">130</span>  Flush tables: <span class="token number">3</span>  Open tables: <span class="token number">46</span>  Queries per second avg: <span class="token number">0.344</span>
--------------

mysql<span class="token operator">&gt;</span>
</code></pre> 
<h5><a id="121__275"></a>1.2.1 新增用户</h5> 
<blockquote> 
 <p>默认密码是：123456，可以在执行脚本前通过修改脚本中的变量来自定义数据库密码</p> 
 <p>MYSQL_ROOT_PASSWORD=‘123456’</p> 
</blockquote> 
<pre><code class="prism language-bash"><span class="token comment"># 修改本地用户密码</span>
alter user root@<span class="token string">'localhost'</span> identified  by <span class="token string">'xxxx'</span><span class="token punctuation">;</span>

<span class="token comment"># 刷新权限</span>
flush privileges<span class="token punctuation">;</span>

<span class="token comment"># 查询当前主机和用户</span>
 <span class="token keyword">select</span> Host,User from mysql.user<span class="token punctuation">;</span>
 
<span class="token comment"># 新增远程登录用户</span>
create user root@<span class="token string">'10.0.0.%'</span> identified by <span class="token string">'xxxx'</span><span class="token punctuation">;</span>

<span class="token comment"># 给创建的用户赋予权限</span>
grant all on *.* to root@<span class="token string">'10.0.0.%'</span> with grant option<span class="token punctuation">;</span>

flush privileges<span class="token punctuation">;</span>
</code></pre> 
<h5><a id="122__JSON__300"></a>1.2.2 向量及 JSON 体验</h5> 
<pre><code class="prism language-bash">mysql<span class="token operator">&gt;</span> create schema MyDb<span class="token punctuation">;</span>
Query OK, <span class="token number">1</span> row affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> create table vector_json <span class="token punctuation">(</span>id int primary key,json_value JSON,vector_value vector<span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK, <span class="token number">0</span> rows affected <span class="token punctuation">(</span><span class="token number">0.02</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> INSERT INTO vector_json <span class="token punctuation">(</span>id, json_value,vector_value<span class="token punctuation">)</span>
    -<span class="token operator">&gt;</span> VALUES
    -<span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token number">1</span>,
    -<span class="token operator">&gt;</span> JSON_ARRAY<span class="token punctuation">(</span><span class="token number">1.0</span>, <span class="token number">2.0</span>, <span class="token number">3.0</span>,4.0<span class="token punctuation">)</span>,
    -<span class="token operator">&gt;</span> to_vector<span class="token punctuation">(</span><span class="token string">'[1,2,3,4]'</span><span class="token punctuation">)</span>
    -<span class="token operator">&gt;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK, <span class="token number">1</span> row affected <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span>
    -<span class="token operator">&gt;</span> id,
    -<span class="token operator">&gt;</span> json_value,
    -<span class="token operator">&gt;</span> VECTOR_DIM<span class="token punctuation">(</span>vector_value<span class="token punctuation">)</span>
    -<span class="token operator">&gt;</span> from vector_json<span class="token punctuation">;</span>
+----+----------------------+--------------------------+
<span class="token operator">|</span> <span class="token function">id</span> <span class="token operator">|</span> json_value           <span class="token operator">|</span> VECTOR_DIM<span class="token punctuation">(</span>vector_value<span class="token punctuation">)</span> <span class="token operator">|</span>
+----+----------------------+--------------------------+
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token number">1.0</span>, <span class="token number">2.0</span>, <span class="token number">3.0</span>, <span class="token number">4.0</span><span class="token punctuation">]</span> <span class="token operator">|</span>                        <span class="token number">4</span> <span class="token operator">|</span>
+----+----------------------+--------------------------+
<span class="token number">1</span> row <span class="token keyword">in</span> <span class="token builtin class-name">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span>

</code></pre> 
<h5><a id="123_etcmycnf_333"></a>1.2.3 完整的/etc/my.cnf</h5> 
<pre><code class="prism language-bash">由于是二进制文件安装，数据库参数文件需要自己配置

<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> /etc/my.cnf <span class="token operator">&lt;&lt;</span> <span class="token string">"EOF"
[mysqld]
server_id = 8103306
default-storage-engine= InnoDB
basedir=/mysql/app/mysql8.1.0
datadir=/mysql/data/mysql3306/data/
socket=/mysql/data/mysql3306/socket/mysql.sock
log-error=/mysql/data/mysql3306/log/mysqld.log
pid-file=/mysql/data/mysql3306/pid/mysqld.pid
port=3306
default-time_zone='+8:00'
default_authentication_plugin=mysql_native_password # 加此参数可远程登陆
transaction_isolation=READ-COMMITTED
max_connections=1500
back_log=500
wait_timeout=1800
max_user_connections=800
innodb_buffer_pool_size=1024M
innodb_log_file_size=512M
innodb_log_buffer_size=40M
slow_query_log=ON
long_query_time=5
# log settings #
slow_query_log = ON
slow_query_log_file = /mysql/data/mysql3306/slowlog/slow3306.log
log_error = /mysql/data/mysql3306/errlog/err3306.log
log_error_verbosity = 3
log_bin = /mysql/data/mysql3306/binlog/mysql_bin
log_bin_index = /mysql/data/mysql3306/binlog/mysql_binlog.index
general_log_file = /data/mysql/mysql3306/generallog/general.log
log_queries_not_using_indexes = 1
log_slow_admin_statements = 1
expire_logs_days = 90
binlog_expire_logs_seconds = 2592000      #30d
long_query_time = 2
min_examined_row_limit = 100
log_throttle_queries_not_using_indexes = 1000
innodb_flush_log_at_trx_commit=1

EOF</span>

</code></pre> 
<h4><a id="13__yum__RPM__381"></a>1.3 通过 yum 来安装 RPM 包的方式</h4> 
<p><img src="https://images2.imgbox.com/0a/2c/MyRTatqv_o.png" alt="image-20240702161124669"></p> 
<pre><code class="prism language-bash"><span class="token comment"># 安装依赖</span>
yum <span class="token parameter variable">-y</span> <span class="token function">install</span> lrzsz <span class="token function">wget</span> perl-Digest-MD5
yum <span class="token parameter variable">-y</span> <span class="token function">install</span> numactl
yum <span class="token parameter variable">-y</span> <span class="token function">install</span> ncurses ncurses-devel openssl-devel bison gcc gcc-c++ <span class="token function">make</span>

<span class="token comment"># 添加用户、用户组</span>
<span class="token function">groupadd</span> mysql
<span class="token function">useradd</span> <span class="token parameter variable">-g</span> mysql --no-create-home <span class="token parameter variable">-s</span> /sbin/nologin mysql

<span class="token comment"># 上传安装包并解压</span>
<span class="token function">mkdir</span> /data/mysql <span class="token parameter variable">-pv</span>
<span class="token function">tar</span> <span class="token parameter variable">-xf</span> mysql-9.0.0-1.el9.x86_64.rpm-bundle.tar <span class="token parameter variable">-C</span> /data/mysql/
<span class="token builtin class-name">cd</span> /data/mysql/
<span class="token comment"># 修改所属主，所属组</span>
<span class="token punctuation">[</span>root@Rocky9 data<span class="token punctuation">]</span><span class="token comment"># chown -R mysql:mysql /data/mysql/</span>

<span class="token comment"># 安装下面四个即可</span>
<span class="token comment"># 安装顺序：包之间相互依赖，所以必须注意安装顺序</span>
✓ 先装 common 
✓ 再装 libs
✓ 再装 client
✓ 最后装 server
<span class="token function">rpm</span> <span class="token parameter variable">-ivh</span> mysql-community-common-9.0.0-1.el9.x86_64.rpm
<span class="token function">rpm</span> <span class="token parameter variable">-ivh</span> mysql-community-libs-9.0.0-1.el9.x86_64.rpm
<span class="token function">rpm</span> <span class="token parameter variable">-ivh</span> mysql-community-client-9.0.0-1.el9.x86_64.rpm
<span class="token function">rpm</span> <span class="token parameter variable">-ivh</span> mysql-community-server-9.0.0-1.el9.x86_64.rpm
</code></pre> 
<p>通过 yum 的方式来自动处理软件包的依赖关系</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@Rocky9 mysql<span class="token punctuation">]</span><span class="token comment"># yum -y install mysql-community-*</span>
Last metadata expiration check: <span class="token number">0</span>:47:48 ago on Tue 02 Jul <span class="token number">2024</span> 03:47:49 PM CST.
Dependencies resolved.
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
 Package                                                                Architecture                         Version                                            Repository                                  Size
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
Installing:
 mysql-community-client                                                 x86_64                               <span class="token number">9.0</span>.0-1.el9                                        @commandline                               <span class="token number">3.0</span> M
 mysql-community-client-debuginfo                                       x86_64                               <span class="token number">9.0</span>.0-1.el9                                        @commandline                                <span class="token number">22</span> M
 mysql-community-client-plugins                                         x86_64                               <span class="token number">9.0</span>.0-1.el9                                        @commandline                               <span class="token number">1.4</span> M
 mysql-community-client-plugins-debuginfo                               x86_64                               <span class="token number">9.0</span>.0-1.el9                                        @commandline                               <span class="token number">2.7</span> M
 mysql-community-common                                                 x86_64                               <span class="token number">9.0</span>.0-1.el9                                        @commandline                               <span class="token number">581</span> k
 mysql-community-debuginfo                                              x86_64                               <span class="token number">9.0</span>.0-1.el9                                        @commandline                               <span class="token number">8.8</span> M
 mysql-community-debugsource                                            x86_64                               <span class="token number">9.0</span>.0-1.el9                                        @commandline                                <span class="token number">17</span> M
 mysql-community-devel                                                  x86_64                               <span class="token number">9.0</span>.0-1.el9                                        @commandline                               <span class="token number">7.3</span> M
 mysql-community-icu-data-files                                         x86_64                               <span class="token number">9.0</span>.0-1.el9                                        @commandline                               <span class="token number">2.3</span> M
 mysql-community-libs                                                   x86_64                               <span class="token number">9.0</span>.0-1.el9                                        @commandline                               <span class="token number">1.5</span> M
 mysql-community-libs-compat                                            x86_64                               <span class="token number">9.0</span>.0-1.el9                                        @commandline                               <span class="token number">1.4</span> M
 mysql-community-libs-compat-debuginfo                                  x86_64                               <span class="token number">9.0</span>.0-1.el9                                        @commandline                               <span class="token number">2.5</span> M
 mysql-community-libs-debuginfo                                         x86_64                               <span class="token number">9.0</span>.0-1.el9                                        @commandline                               <span class="token number">2.6</span> M
 mysql-community-server                                                 x86_64                               <span class="token number">9.0</span>.0-1.el9                                        @commandline                                <span class="token number">50</span> M
 mysql-community-server-debug                                           x86_64                               <span class="token number">9.0</span>.0-1.el9                                        @commandline                                <span class="token number">24</span> M
 mysql-community-server-debug-debuginfo                                 x86_64                               <span class="token number">9.0</span>.0-1.el9                                        @commandline                               <span class="token number">154</span> M
 mysql-community-server-debuginfo                                       x86_64                               <span class="token number">9.0</span>.0-1.el9                                        @commandline                               <span class="token number">192</span> M
 mysql-community-test                                                   x86_64                               <span class="token number">9.0</span>.0-1.el9                                        @commandline                               <span class="token number">336</span> M
 mysql-community-test-debuginfo                                         x86_64                               <span class="token number">9.0</span>.0-1.el9                                        @commandline                                <span class="token number">23</span> M
Upgrading:

<span class="token punctuation">[</span>root@Rocky9 mysql<span class="token punctuation">]</span><span class="token comment"># rpm -qa | grep mysql</span>
mysql-community-debugsource-9.0.0-1.el9.x86_64
mysql-community-debuginfo-9.0.0-1.el9.x86_64
mysql-community-client-plugins-9.0.0-1.el9.x86_64
mysql-community-common-9.0.0-1.el9.x86_64
mysql-community-libs-9.0.0-1.el9.x86_64
mysql-community-client-9.0.0-1.el9.x86_64
mysql-community-icu-data-files-9.0.0-1.el9.x86_64
mysql-community-server-9.0.0-1.el9.x86_64
mysql-community-server-debug-9.0.0-1.el9.x86_64
mysql-community-test-9.0.0-1.el9.x86_64
mysql-community-devel-9.0.0-1.el9.x86_64
mysql-community-libs-compat-9.0.0-1.el9.x86_64
mysql-community-client-debuginfo-9.0.0-1.el9.x86_64
mysql-community-client-plugins-debuginfo-9.0.0-1.el9.x86_64
mysql-community-libs-compat-debuginfo-9.0.0-1.el9.x86_64
mysql-community-libs-debuginfo-9.0.0-1.el9.x86_64
mysql-community-server-debug-debuginfo-9.0.0-1.el9.x86_64
mysql-community-server-debuginfo-9.0.0-1.el9.x86_64
mysql-community-test-debuginfo-9.0.0-1.el9.x86_64
<span class="token punctuation">[</span>root@Rocky9 mysql<span class="token punctuation">]</span><span class="token comment">#</span>

<span class="token comment"># 启动mysql</span>
<span class="token punctuation">[</span>root@Rocky9 mysql<span class="token punctuation">]</span><span class="token comment"># systemctl enable --now mysqld</span>
<span class="token punctuation">[</span>root@Rocky9 mysql<span class="token punctuation">]</span><span class="token comment">#</span>

<span class="token comment"># 获取临时密码</span>
<span class="token punctuation">[</span>root@Rocky9 mysql<span class="token punctuation">]</span><span class="token comment"># cat /var/log/mysqld.log  | grep temporary</span>
<span class="token number">2024</span>-07-02T09:05:09.190201Z <span class="token number">6</span> <span class="token punctuation">[</span>Note<span class="token punctuation">]</span> <span class="token punctuation">[</span>MY-010454<span class="token punctuation">]</span> <span class="token punctuation">[</span>Server<span class="token punctuation">]</span> A temporary password is generated <span class="token keyword">for</span> root@localhost: <span class="token assign-left variable">J3E7ZjT8uc</span><span class="token operator">=</span>/
<span class="token punctuation">[</span>root@Rocky9 mysql<span class="token punctuation">]</span><span class="token comment"># mysql -uroot -p'J3E7ZjT8uc=/'</span>
mysql: <span class="token punctuation">[</span>Warning<span class="token punctuation">]</span> Using a password on the <span class="token builtin class-name">command</span> line interface can be insecure.
Welcome to the MySQL monitor.  Commands end with <span class="token punctuation">;</span> or <span class="token punctuation">\</span>g.
Your MySQL connection <span class="token function">id</span> is <span class="token number">9</span>
Server version: <span class="token number">9.0</span>.0

Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">2000</span>, <span class="token number">2024</span>, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type <span class="token string">'help;'</span> or <span class="token string">'\h'</span> <span class="token keyword">for</span> help. Type <span class="token string">'\c'</span> to <span class="token function">clear</span> the current input statement.

mysql<span class="token operator">&gt;</span>alter user root@<span class="token string">'localhost'</span> identified  by <span class="token string">'root'</span><span class="token punctuation">;</span>
ERROR <span class="token number">1819</span> <span class="token punctuation">(</span>HY000<span class="token punctuation">)</span>: Your password does not satisfy the current policy requirements

<span class="token comment"># 修改一下密码策略，也是不允许的，只能先改一下密码然后再修改策略</span>
mysql<span class="token operator">&gt;</span> SET GLOBAL validate_password.policy <span class="token operator">=</span> LOW<span class="token punctuation">;</span>
ERROR <span class="token number">1820</span> <span class="token punctuation">(</span>HY000<span class="token punctuation">)</span>: You must reset your password using ALTER <span class="token environment constant">USER</span> statement before executing this statement.

mysql<span class="token operator">&gt;</span> ALTER <span class="token environment constant">USER</span> <span class="token string">'root'</span>@<span class="token string">'localhost'</span> IDENTIFIED BY <span class="token string">'Root@123456'</span><span class="token punctuation">;</span>
Query OK, <span class="token number">0</span> rows affected <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> SET GLOBAL validate_password.policy <span class="token operator">=</span> LOW<span class="token punctuation">;</span>
Query OK, <span class="token number">0</span> rows affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> SET GLOBAL validate_password.length <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
Query OK, <span class="token number">0</span> rows affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> show variables like <span class="token string">'validate_password%'</span><span class="token punctuation">;</span>
+-------------------------------------------------+-------+
<span class="token operator">|</span> Variable_name                                   <span class="token operator">|</span> Value <span class="token operator">|</span>
+-------------------------------------------------+-------+
<span class="token operator">|</span> validate_password.changed_characters_percentage <span class="token operator">|</span> <span class="token number">0</span>     <span class="token operator">|</span>
<span class="token operator">|</span> validate_password.check_user_name               <span class="token operator">|</span> ON    <span class="token operator">|</span>
<span class="token operator">|</span> validate_password.dictionary_file               <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> validate_password.length                        <span class="token operator">|</span> <span class="token number">6</span>     <span class="token operator">|</span>
<span class="token operator">|</span> validate_password.mixed_case_count              <span class="token operator">|</span> <span class="token number">1</span>     <span class="token operator">|</span>
<span class="token operator">|</span> validate_password.number_count                  <span class="token operator">|</span> <span class="token number">1</span>     <span class="token operator">|</span>
<span class="token operator">|</span> validate_password.policy                        <span class="token operator">|</span> LOW   <span class="token operator">|</span>
<span class="token operator">|</span> validate_password.special_char_count            <span class="token operator">|</span> <span class="token number">1</span>     <span class="token operator">|</span>
+-------------------------------------------------+-------+
<span class="token number">8</span> rows <span class="token keyword">in</span> <span class="token builtin class-name">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="2MySQL_840_LTS__520"></a>2.MySQL 8.4.0 LTS 发布</h3> 
<blockquote> 
 <p>从 MySQL 8.4.0 开始，mysql_native_password 认证插件默认不再启用。<br> 若要启用，需要在MySQL启动的时候，添加–mysql-native-password=ON 参数；或在配置文件中设置 mysql_native_password=ON。</p> 
 <p>MySQL 8.4，还调整了与 InnoDB 存储引擎相关的多个服务器系统变量的默认值<br> 其余的一些变更，大家详细的阅读官网即可</p> 
</blockquote> 
<p>安装方式参考上面9.0.</p> 
<h3><a id="3MySQL_830__530"></a>3.MySQL 8.3.0 发布</h3> 
<h4><a id="31__GTID_532"></a>3.1 标签化 GTID</h4> 
<blockquote> 
 <p>此增强功能使为特定事务组的GTID分配唯一名称成为可能。<br> 例如，只需比较包含数据操作的事务的GTID，就可以很容易地将其与管理操作产生的事务区分开来。</p> 
 <p>管理员现在可以将SET@gtid_next=AUTOMATIC：＜TAG＞或SET@gtid_next=＜UUID＞：＜TAG＞：NUMBER的<br> 使用限制为所需的MySQL用户或角色集，以便只有与给定数据或操作域相关的用户才能提交具有指定标记的新事务。</p> 
 <p>该版本新增了TRANSACTION_GTID_TAG权限，它允许设置 GTID 值，让管理员能够控制权限分配，优化事务管理。</p> 
</blockquote> 
<h4><a id="32_JSON_EXPLAIN__542"></a>3.2 JSON EXPLAIN 格式</h4> 
<blockquote> 
 <ol><li>添加了explain_json_format_version系统变量，以确定explain format=json语句使用的json输出格式的版本。</li><li>它允许管理员在EXPLAIN FORMAT=JSON命令中，在两种不同的 JSON 输出格式之间进行选择。</li><li>这一特性保证了软件与 MySQL 优化器未来版本的兼容性，增强了长期使用的便利性</li></ol> 
</blockquote> 
<h4><a id="33__548"></a>3.3 身份验证说明</h4> 
<blockquote> 
 <p>Microsoft Windows:Windows平台现在支持执行基于sasl的ldap身份验证的服务器端authentication_ldap_sasl插件。<br> 这意味着Windows客户端程序现在可以使用GSSAPI和Kerberos，使用authentication_ldap_sasl_client插件进行身份验证。</p> 
</blockquote> 
<h4><a id="34__553"></a>3.4 可插拔身份验证</h4> 
<blockquote> 
 <p>从本版本开始，调试PAM身份验证插件时使用的 AUTHENTICATION_PAM_LOG 环境变量的行为更改如下：<br> 将AUTHENTICATION_PAM_LOG设置为任意值（除非下一项中另有说明），其诊断消息中不再包含密码。<br> 要在诊断消息中包括密码，请设置AUTHENTICATION_PAM_LOG=PAM_LOG_WITH_SECRET_INFO</p> 
</blockquote> 
<h4><a id="35__559"></a>3.5 线程池新增信息</h4> 
<blockquote> 
 <p>在MySQL性能架构中添加了额外的线程池连接信息，如下所示：<br> 添加了一个tp_connections表，其中包含有关每个线程池连接的信息。</p> 
 <p>将以下列添加到tp_thread_state表中：<br> TIME_OF_ATTACH、<br> MARKED_STALLED、<br> state、EVENT_COUNT、<br> ACCUMULATED_EVENT_TIME、<br> EXEC_COUNT和ACCUMULATED_EXEC_TIME</p> 
 <p>将以下列添加到tp_thread_group_state表中：<br> EFECTIVE_MAX_TRANSACTION_LIMIT、<br> NUM_QUERY_THREADS、<br> TIME_OF_LAST_thread_CREATION、<br> NUM_CONNECT_HANDLER_THREADD_IN_SLEEP、<br> THREADS_BOUND_to_TRANSACTION、<br> QUERY_THRADS_COUNT和TIME_OF_EARLIEST_CONN_EXPIRE</p> 
</blockquote> 
<h4><a id="36__579"></a>3.6 删减功能</h4> 
<blockquote> 
 <ol><li>一些关键的 C API 函数，比如mysql_kill()、mysql_list_fields()等，已被移除，建议采用其他方式来执行类似操作。</li><li>用于清理主机名内部缓存的FLUSH HOSTS命令（之前已经被弃用），也正式从系统中移除了。管理员现在需要通过其他方法来清理主机缓存。</li><li>还有一些复制和服务器的相关选项，例如–slave-rows-search-algorithms和–log_bin_use_v1_events也已被移除，引导管理员采用更有效、更现代的操作方法。</li></ol> 
</blockquote> 
<h3><a id="4MySQL_810__585"></a>4.MySQL 8.1.0 发布</h3> 
<h4><a id="41__587"></a>4.1 密码参数</h4> 
<blockquote> 
 <p>增加了一个新的系统参数，用于限制用户改密码时的最少替换字符数。<br> validate_password.changed_characters_percentage，该值是百分比。</p> 
</blockquote> 
<h4><a id="42__592"></a>4.2 错误日志加强</h4> 
<blockquote> 
 <p>随着 MySQL 服务器、插件和组件的启动和关闭消息的增加，关闭过程的日志记录得到了增强。这些消息现在也被记录为关闭连接。<br> 这些附加功能应该有助于故障排除和调试问题，特别是在服务器需要很长时间才能关闭的情况下。</p> 
 <p>此版本引入了一系列新的消息，这些消息会在MySQL错误日志中记录，包括以下内容：<br> MySQLserver的启动和关闭日志消息，包括使用–initialize参数启动时的日志。<br> 插件关闭阶段的启动和结束日志消息。<br> 组件关闭阶段的启动和结束日志消息。<br> 连接关闭阶段的开始和结束日志消息。<br> 在强制断开连接后仍然活动的线程数量和ID的日志消息，这些线程可能会导致等待情况。</p> 
 <p>mysql&gt; show variables like ‘log_error’;<br> ±--------------±-----------------------------------------+<br> | Variable_name | Value |<br> ±--------------±-----------------------------------------+<br> | log_error | /mysql/data/mysql3306/errlog/err3306.log |<br> ±--------------±-----------------------------------------+</p> 
</blockquote> 
<h4><a id="43__611"></a>4.3 二进制日志</h4> 
<blockquote> 
 <p>libmysqlclient.so 共享库中添加了几个函数，使开发人员能够访问 MySQL server的二进制日志：<br> mysql_binlog_open()、mysql_binlog_fetch() 和 mysql_binlog_close()。</p> 
</blockquote> 
<h4><a id="44__616"></a>4.4 审计日志</h4> 
<blockquote> 
 <p>审计日志可以指定库database存储JSON过滤表。</p> 
 <p>新增Audit_log_direct_writes系统变量，用于计算直接写入审计文件的次数。</p> 
 <p>MySQL企业审计使用临时缓冲区保存写入日志文件的查询事件数据。<br> 然而，由于server可能无法为长查询分配额外内存，审计插件已经进行了优化，在JSON格式记录日志时，不再使用临时缓冲区。</p> 
 <p>MySQL企业审计现在支持使用调度程序组件来配置和执行定期任务，以刷新内存缓存。</p> 
 <p>mysql -u root -D database_name -p &lt; audit_log_filter_linux_install.sql</p> 
</blockquote> 
<h4><a id="45__629"></a>4.5 组复制增强</h4> 
<blockquote> 
 <p>添加了一些特定于组复制插件的状态变量，这些变量可以改进对网络不稳定的诊断和故障排除，<br> 为每个组成员 (group member) 提供有关网络使用情况、控制消息和数据消息的统计信息。</p> 
 <p>作为这项工作的一部分，Performance Schema 的 replication_group_communication_information 表中添加了一个新列 MEMBER_FAILURE_SUSPICIONS_COUNT 。该列的内容被格式化为一个 JSON 数组，其键是组成员 ID，其值是该组成员被认为是可疑的次数。</p> 
</blockquote> 
<h4><a id="46__636"></a>4.6 废弃特性</h4> 
<blockquote> 
 <p>以下功能在 MySQL 8.1 中已弃用，并且可能会在未来的系列中删除。如果显示替代方案，则应更新应用程序以使用它们。<br> 1.mysqlpump<br> 由于 MySQL 提供了具有相同或额外功能的 mysqldump 和 MySQL Shell 等其他方法来执行数据库转储和备份，<br> mysqlpump 已经变得多余，现在已弃用。现在调用这个程序会产生一个警告。您应该记住，mysqlpump 可能会在 MySQL 的未来版本中被删除。</p> 
 <p>2.binlog_format<br> binlog_format 服务器系统变量现已弃用，并且可能会在 MySQL 的未来版本中删除。 与此变量关联的功能（更改二进制日志记录格式）也已被弃用。</p> 
 <p>此更改的含义是，当删除 binlog_format 时，MySQL 服务器将仅支持基于行的二进制日志记录（MySQL 8.0 中的默认设置）。 因此，新安装应仅使用基于行 (Row) 的二进制日志记录，而使用基于语句或混合日志记录格式的现有安装应迁移到基于行的格式。</p> 
 <p>系统变量 log_bin_trust_function_creators 和 log_statements_unsafe_for_binlog 仅在基于语句的日志记录上下文中有用，现在也已弃用，因此也将在 MySQL 的未来版本中删除。</p> 
 <p>现在设置或选择刚才提到的任何变量的值都会引发警告。 （WL*#13966，WL#15669）*</p> 
 <p>3.mysql_native_password<br> mysql_native_password 身份验证插件现已弃用，并可能在 MySQL 的未来版本中删除。<br> 如果帐户尝试使用 mysql_native_password 作为身份验证方法进行身份验证，<br> 他方法来执行数据库转储和备份，<br> mysqlpump 已经变得多余，现在已弃用。现在调用这个程序会产生一个警告。您应该记住，mysqlpump 可能会在 MySQL 的未来版本中被删除。</p> 
 <p>2.binlog_format<br> binlog_format 服务器系统变量现已弃用，并且可能会在 MySQL 的未来版本中删除。 与此变量关联的功能（更改二进制日志记录格式）也已被弃用。</p> 
 <p>此更改的含义是，当删除 binlog_format 时，MySQL 服务器将仅支持基于行的二进制日志记录（MySQL 8.0 中的默认设置）。 因此，新安装应仅使用基于行 (Row) 的二进制日志记录，而使用基于语句或混合日志记录格式的现有安装应迁移到基于行的格式。</p> 
 <p>系统变量 log_bin_trust_function_creators 和 log_statements_unsafe_for_binlog 仅在基于语句的日志记录上下文中有用，现在也已弃用，因此也将在 MySQL 的未来版本中删除。</p> 
 <p>现在设置或选择刚才提到的任何变量的值都会引发警告。 （WL*#13966，WL#15669）*</p> 
 <p>3.mysql_native_password<br> mysql_native_password 身份验证插件现已弃用，并可能在 MySQL 的未来版本中删除。<br> 如果帐户尝试使用 mysql_native_password 作为身份验证方法进行身份验证，<br> CREATE USER、ALTER USER 和 SET PASSWORD 操作现在会在服务器错误日志中插入弃用警告。</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/35b7956b842ee4a728cf646defb3bad8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">真的假不了，假的真不了</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7db943813b37e6121e453959ee7340a5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">网络物理隔离</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>