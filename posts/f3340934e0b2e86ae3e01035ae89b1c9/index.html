<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>从菜鸟到大厨：MySQL数据库的美味指南 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/f3340934e0b2e86ae3e01035ae89b1c9/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="从菜鸟到大厨：MySQL数据库的美味指南">
  <meta property="og:description" content="数据库的操作 创建数据库:
create database 数据库名;
​
数据库语句一般会放在文件中批量执行,但是遇到错误会无法执行,为了避免可能因为重名而造成数据库无法执行下去的情况,会在create database后面加上if not exists来避免报错
​
创建数据库的时候,可以手动指定一下字符集
character set 字符集名字/charset 字符集名字
咱们需要在数据库中保存中文,mysql默认的字符是拉丁文,不支持中文.必须要在创建数据库的时候,手动指定编码方式为支持中文的编码(GBK,UTF8)
​
查看数据库:
show databases;
列出当前mysql服务器上的数据库
选中数据库:
use 数据库名;
删除数据库:
drop database 数据库名;
MySQL表的增删改查 创建表:
create table 表名(列名 类型, 列名 类型…);
如果表名/列名是关键字,那么要用倒引号``引出来
查看所有表:
show tables;
查看当前数据库的所有表
查看指定表的结构:
desc 表名;
删除表:
drop table 表名;
新增数据:
insert into 表名 values(值,值…);
此处的值要与列相匹配
指定列插入:
insert into 表名(列名,列名…) values (值,值…);
一次插入多行记录:
insert into 表名 values (值,值…),(值,值…)…
全列查询:
select * from 表名;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-24T16:16:34+08:00">
    <meta property="article:modified_time" content="2024-05-24T16:16:34+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">从菜鸟到大厨：MySQL数据库的美味指南</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>数据库的操作</h2> 
<blockquote> 
 <p>创建数据库:</p> 
 <p>create database 数据库名;</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/8c/6c/ffPbAFOS_o.png" alt="">​</p> 
<p>数据库语句一般会放在文件中批量执行,但是遇到错误会无法执行,为了避免可能因为重名而造成数据库无法执行下去的情况,会在create database后面加上if not exists来避免报错</p> 
<p><img src="https://images2.imgbox.com/d1/1a/FQjrlrFG_o.png" alt="">​</p> 
<p>创建数据库的时候,可以手动指定一下字符集</p> 
<blockquote> 
 <p>character set 字符集名字/charset 字符集名字</p> 
</blockquote> 
<p>咱们需要在数据库中保存中文,mysql默认的字符是拉丁文,不支持中文.必须要在创建数据库的时候,手动指定编码方式为支持中文的编码(GBK,UTF8)</p> 
<p><img src="https://images2.imgbox.com/d0/e3/0vrELcgz_o.png" alt="">​</p> 
<blockquote> 
 <p>查看数据库:</p> 
 <p>show databases;</p> 
 <p>列出当前mysql服务器上的数据库</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/e2/b7/VKM2hwmO_o.png" alt=""></p> 
<blockquote> 
 <p>选中数据库:</p> 
 <p>use 数据库名;</p> 
</blockquote> 
<blockquote> 
 <p>删除数据库:</p> 
 <p>drop database 数据库名;</p> 
</blockquote> 
<h2><a id="MySQL_36"></a>MySQL表的增删改查</h2> 
<blockquote> 
 <p>创建表:</p> 
 <p>create table 表名(列名 类型, 列名 类型…);</p> 
 <p>如果表名/列名是关键字,那么要用倒引号``引出来</p> 
</blockquote> 
<blockquote> 
 <p>查看所有表:</p> 
 <p>show tables;</p> 
 <p>查看当前数据库的所有表</p> 
</blockquote> 
<blockquote> 
 <p>查看指定表的结构:</p> 
 <p>desc 表名;</p> 
</blockquote> 
<blockquote> 
 <p>删除表:</p> 
 <p>drop table 表名;</p> 
</blockquote> 
<blockquote> 
 <p>新增数据:</p> 
 <p>insert into 表名 values(值,值…);</p> 
 <p>此处的值要与列相匹配</p> 
</blockquote> 
<blockquote> 
 <p>指定列插入:</p> 
 <p>insert into 表名(列名,列名…) values (值,值…);</p> 
</blockquote> 
<blockquote> 
 <p>一次插入多行记录:</p> 
 <p>insert into 表名 values (值,值…),(值,值…)…</p> 
</blockquote> 
<blockquote> 
 <p>全列查询:</p> 
 <p>select * from 表名;</p> 
 <p>把表中所有列和所有行都查询出来</p> 
</blockquote> 
<p>datetime类型插入:</p> 
<p>固定格式字符串来表示日期</p> 
<p>‘2000-01-01 00:00:00’</p> 
<p>如果要填写当前时刻,可以使用sql提供现成的函数now()</p> 
<blockquote> 
 <p>指定列查询:</p> 
 <p>select 列名,列名… from 表名;</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/c1/de/Lvbndoic_o.png" alt="">​</p> 
<p>创建表名为exam的表,放入数据</p> 
<p><img src="https://images2.imgbox.com/d9/a9/ukFpwjiq_o.png" alt="">​</p> 
<p>我们想看class与math,English,chinese的和,但是原数据没有和,我们就可以用到查询字段为表达式</p> 
<p><img src="https://images2.imgbox.com/31/90/AufcYQgh_o.png" alt="">​</p> 
<h4><a id="_99"></a>别名</h4> 
<p>查询的时候,给列和表达式指定别名(也可以给表起别名)</p> 
<blockquote> 
 <p>select 表达式 as 别名 from 表名;</p> 
</blockquote> 
<p>把刚才的和命名为sum</p> 
<p><img src="https://images2.imgbox.com/77/5f/H30AQfVu_o.png" alt="">​</p> 
<h4><a id="_108"></a>去重</h4> 
<p>使用distinct关键字对某列数据进行去重</p> 
<h4><a id="_112"></a>排序</h4> 
<blockquote> 
 <p>select 列名 from 表名 order by 列名 [asc/desc]</p> 
</blockquote> 
<p>asc是升序,desc是降序</p> 
<p>mysql是一个客户端服务器结构化的程序</p> 
<p>客户端向服务器发出请求,服务器得到响应,得到数据,如果再对数据进行排序,</p> 
<p>排序处理的数据是临时数据,对原有的存储数据没有影响</p> 
<h4><a id="_124"></a>条件查询</h4> 
<p>会指定具体的条件,按照条件针对数据进行筛选</p> 
<blockquote> 
 <p>select 列名 from 表名 where 条件</p> 
</blockquote> 
<p>遍历表中每一行的数据,带入条件,不符号就跳过,符合会放到结果集合</p> 
<p>select在条件判断查询执行的顺序:</p> 
<p>1.遍历表中的记录</p> 
<p>2.进行条件判断进行筛选</p> 
<p>3.对于筛选后的数据进行列上表达式的计算</p> 
<p>(先进行条件判断,可以使用表达式,但是取别名在条件判断之后,所以where条件可以使用表达式,但是不能用别名)</p> 
<p>4.如果存在order by语句,对数据再进行排序</p> 
<p><img src="https://images2.imgbox.com/05/22/0H2ktPBR_o.png" alt=""></p> 
<p>between…and…是固定范围进行筛选,闭区间</p> 
<p><img src="https://images2.imgbox.com/a1/bd/j6l6hw3v_o.png" alt="">​<br> between…and…的效果和&gt;= and &lt;=一样</p> 
<p><img src="https://images2.imgbox.com/4b/bb/6heK4MAf_o.png" alt="">​<br> in(值,值…)在提供的数值中相等会被筛选到</p> 
<p><img src="https://images2.imgbox.com/75/91/o7GoTrGb_o.png" alt="">​<br> <img src="https://images2.imgbox.com/0f/06/kvKCAMEE_o.png" alt="">​</p> 
<p>如果我们要对以八开头或者结尾等条件进行筛选,不是固定的值,而是一个模糊的</p> 
<p>条件,此时就要进行模糊查询like;</p> 
<p>_可以表示一个任意字符,%可以表示任意个任意字符</p> 
<p><img src="https://images2.imgbox.com/4f/91/kSAv9fcz_o.png" alt="">​</p> 
<p><img src="https://images2.imgbox.com/58/ad/ICvi1QkI_o.png" alt="">​<br> <img src="https://images2.imgbox.com/83/5e/eOKO2PQ0_o.png" alt="">​<br> 新建一个表</p> 
<p><img src="https://images2.imgbox.com/54/cc/SzrDbrp4_o.png" alt="">​</p> 
<p>得到grades为null的行,但是用’‘=’'不安全</p> 
<p><img src="https://images2.imgbox.com/15/e0/R1CqV7VT_o.png" alt="">​</p> 
<p>却没找到,因为在匹配过程中任何与null进行运算的结果都是null,也就是false,没有,</p> 
<p>即便存在grades的值为null,返回的也是没有</p> 
<p>为了防止这样的事情发生要用&lt;=&gt;来对null进行判断</p> 
<p><img src="https://images2.imgbox.com/f3/c7/HVtc9Gb5_o.png" alt="">​<br> 也可以使用is [not] null来对null值进行筛选</p> 
<p>区别在于:&lt;=&gt;可以对多个列进行筛选,is [not] null只针对一行</p> 
<h4><a id="_186"></a>分组查询</h4> 
<p><strong>使用 <code>GROUP BY</code> 进行分组查询：</strong></p> 
<pre><code class="prism language-XML">SELECT 列名, ... FROM 表名 GROUP BY 列名, ...;
</code></pre> 
<p><strong>在分组之前先过滤数据</strong></p> 
<p>使用 <code>WHERE</code> 进行条件筛选：</p> 
<pre><code class="prism language-XML">SELECT 列名, ... FROM 表名 WHERE 条件 GROUP BY 列名, ...;
</code></pre> 
<p><strong>在分组之后进行过滤数据</strong></p> 
<p>先进行分组查询，然后使用 <code>HAVING</code> 来进行条件限制，<code>HAVING</code> 后面接要筛选的条件：</p> 
<pre><code class="prism language-XML">SELECT 列名, ... FROM 表名 GROUP BY 列名, ... HAVING 条件;
</code></pre> 
<h4><a id="_216"></a></h4> 
<h4><a id="_218"></a>分页查询</h4> 
<blockquote> 
 <p>select 列名 from 表名 limit N offset M;</p> 
</blockquote> 
<p>N表示本次查询最多查询N条记录</p> 
<p>M表示本次查询从M下标开始查询</p> 
<h4><a id="_226"></a></h4> 
<h4><a id="_228"></a>多表查询</h4> 
<p><code>SELECT 列名,... FROM 表名,... WHERE 条件;</code></p> 
<p>在多表查询中，可能不同表中会出现相同的列名，所以要在列名之前注明属于哪个表，如：<code>表名.列名</code></p> 
<ul><li>外连接：分为左外连接和右外连接。</li><li>左外连接：返回左表中的所有记录，以及右表中满足连接条件的记录。如果右表中没有匹配的记录，结果中该部分将显示为NULL。</li><li>右外连接：返回右表中的所有记录，以及左表中满足连接条件的记录。如果左表中没有匹配的记录，结果中该部分将显示为NULL。</li></ul> 
<pre><code>示例语法：
SELECT 列名,... 
FROM 表名1 
LEFT/RIGHT JOIN 表名2 
ON 条件 AND 其他条件;
</code></pre> 
<ul><li>自连接：在某些情况下，需要对同一张表的行与行之间进行比较筛选。进行自连接时，需要给该表起别名，以防止表中的列名混淆。</li></ul> 
<pre><code>示例语法：
SELECT A.列名1, B.列名2 
FROM 表名 AS A, 表名 AS B 
WHERE A.条件 = B.条件;
</code></pre> 
<h4><a id="_259"></a>子查询</h4> 
<p>子查询是一种嵌套在另一个查询中的查询，通常用于从多个表中获取数据或在单个查询中执行多个步骤。子查询可以用于提高查询效率、简化查询逻辑以及在特定条件下筛选数据。</p> 
<h4><a id="_263"></a></h4> 
<h4><a id="_265"></a>修改</h4> 
<blockquote> 
 <p>update 表名 set 修改操作 where 符合条件;</p> 
</blockquote> 
<h4><a id="_269"></a>删除</h4> 
<blockquote> 
 <p>delete from 表名 where 条件 / order by / limit</p> 
</blockquote> 
<h3><a id="_273"></a>数据库约束</h3> 
<h4><a id="NULL_275"></a>NULL约束</h4> 
<p><img src="https://images2.imgbox.com/54/13/Uqg8H7De_o.png" alt=""></p> 
<p>创建表时,约束某列不能置空</p> 
<h4><a id="UNIQUE_281"></a>UNIQUE：唯一约束</h4> 
<p>保证某列的每行必须有唯一的值</p> 
<h4><a id="DEFAULT_285"></a>DEFAULT：默认值约束</h4> 
<p>默认的默认值为NULL,可以通过default进行修改</p> 
<h4><a id="PRIMARY_KEY_289"></a>PRIMARY KEY：主键约束</h4> 
<p>NOT NULL 和 UNIQUE 的结合</p> 
<p>某列不能存储null值且唯一</p> 
<p>对于整数类型的主键一般搭配anto_increment进行使用</p> 
<p><img src="https://images2.imgbox.com/a3/ea/A8Xf1NeC_o.png" alt="">​<br> 但是此处插入null没有报错,primary key不是not null和unique的结合嘛</p> 
<p>此处插入null值,是不给值,利用anto_increment来自动生成每一个新纪录的唯一标识</p> 
<p><img src="https://images2.imgbox.com/ff/8d/krRyl5tN_o.png" alt="">​</p> 
<p>auto_increment会记录最大的标识,下一次不给值默认自动生成的话就是最大值+1并更新</p> 
<p>最大值,如果给值且给的值大于最大的标识就会更新最大标识</p> 
<p><img src="https://images2.imgbox.com/f8/56/jeja924Q_o.png" alt="">​<br> 面临数据量大,分布式处理时,保证数据唯一,分布式唯一id要结合时间戳和机房/主机编号以及</p> 
<p>随机因子来保证唯一,其中概率虽然无法保证降低为0,但在工程中可以忽略不计</p> 
<h4><a id="FOREIGN_KEY_313"></a>FOREIGN KEY：外键约束</h4> 
<p>外键约束用于确保关系型数据库中一张表中的数据参照另一张表中的数据。比如有一个学校表，里面存储了各个班级的信息，然后创建一个学生表，其中的班级信息必须与学校表中的班级信息一致。在这种情况下，学生表中的班级名信息来源于学校表，这就是外键约束。学校表称为父表，学生表则称为子表。</p> 
<p>在MySQL中，创建包含外键约束的表可以使用以下语句：</p> 
<pre><code>CREATE TABLE aaa (
    classId INT PRIMARY KEY,
    name VARCHAR(20)
);

CREATE TABLE bbb (
    studentId INT,
    name VARCHAR(20),
    classId INT,
    FOREIGN KEY (classId) REFERENCES aaa(classId)
);

</code></pre> 
<p>上述语句中，<code>aaa</code>表的<code>classId</code>列设置了主键约束，保证了<code>classId</code>列的每一行都有唯一的标识。子表<code>bbb</code>的<code>classId</code>列设置了外键约束，它引用了<code>aaa</code>表的<code>classId</code>列，这样就保证了<code>bbb</code>表中的<code>classId</code>必须对应<code>aaa</code>表中的某个<code>classId</code>。</p> 
<p>当父表（例如学校表）中的数据发生变化时，如删除一个班级，如果子表（例如学生表）中有引用该班级的记录，则数据库会阻止这个删除操作，以避免数据不一致性。如果要删除父表中的记录，需要首先删除子表中相关的引用记录，或者先删除子表，再删除父表中的记录。</p> 
<p>在电商场景中，如果电商要对某个商品进行下架处理，但该商品已经有订单，直接删除会导致订单数据不完整。这时，可以通过添加一个标记列来表示商品是否下架，而不是物理删除商品记录。在创建订单时，系统会先检查该商品是否下架。这种做法称为逻辑删除，它通过额外的列来标记记录的状态，而不是物理上删除它们。</p> 
<h2><a id="_342"></a></h2> 
<h2><a id="_344"></a>表的设计</h2> 
<p>根据实际需求，首先要确定所需实体及其属性，以及实体间的关系类型，例如一对一、一对多、多对多或没有关系。</p> 
<ul><li>一对一关系（1-to-1）通常通过使两个实体共享一个唯一标识符来建立。这意味着两个实体中的每一个都直接与对方相关联，且在这个关系中，每个实体只对应一个实例。比如，一个员工实体可以对应一个唯一的工资账单实体。</li><li>一对多关系（1-to-N）中，一个实体（“一”）可以与多个实体（“多”）相关联，但每个实体（“多”）只能与一个实体（“一”）相关联。在这种情况下，通常在“一”方实体中设置一个外键，指向“多”方实体的主键。例如，一个班级可以有多个学生，但每个学生只能属于一个班级。如果不支持数组，我们可以在学生表中为每个班级创建一个单独的条目。</li><li>多对多关系（M-to-N）需要一个关联表来实施。这个关联表通常包含两个外键，分别指向两个相关联的主键。例如，学生和课程之间可能存在多对多关系，因为一个学生可以选择多门课程，而每门课程也可以被多个学生选择。关联表可以包含学生ID和课程ID，以及可能的额外属性，如学生选择的日期或成绩。</li><li>如果两个实体之间不存在以上任何关系，那么它们之间就是没有关系。这意味着它们在逻辑上是完全独立的，没有必要在数据库中进行任何形式的联系。</li></ul> 
<h2><a id="MySQL_353"></a>MySQL索引事务</h2> 
<h3><a id="_355"></a>索引</h3> 
<p>创建索引</p> 
<pre><code>create index 索引名 on 表名(列名);
</code></pre> 
<p>查看索引</p> 
<pre><code>show index from 表名;
</code></pre> 
<p>删除索引</p> 
<pre><code>drop index 索引名 on 表名;
</code></pre> 
<p>使用 <code>PRIMARY KEY</code>、<code>FOREIGN KEY</code> 和 <code>UNIQUE</code> 修饰的列会自动加上索引。这些自动加上的索引不能被删除。<code>PRIMARY KEY</code> 和 <code>UNIQUE</code> 在创建时必须保证唯一性，因此需要进行查找并加上索引来提高效率。<code>FOREIGN KEY</code> 的删除和创建需要参考父表和子表之间的绑定关系，仍旧需要进行查找。</p> 
<p>对于查找而言，单一遍历会降低查询效率，而且在硬盘上逐行查询数据的效率也很低。因此，使用数据结构建立索引可以显著提高查询效率。</p> 
<p>线性结构不能解决问题，因为仍然需要线性遍历。使用哈希表可以进行精准查找，但无法进行范围搜索。二叉搜索树可能会出现单支树的情况，从而退化成链表。为了引入平衡策略，平衡二叉树和红黑树实现了平衡机制，但相比二叉树，多叉树的层数会更小，从而减少了I/O读取次数。因此，引入了B树。B树的一个节点包含n个数据，这个节点有n+1个分支。增加和删除操作会对节点进行分裂和合并。</p> 
<p>为了优化B树，产生了B+树。B+树的一个节点有n个数据，会有n个分支。每个数据作为其分支的最大值。叶子节点包含了所有的数据，并且叶子节点直接使用链表进行连接。对于范围搜索，可以在叶子节点上获取中间值，而不需要遍历每个数据。B+树的非叶子节点存储索引值，叶子节点存储对应行的数据。先将非叶子节点的数据缓存到内存里，然后查找到相应叶子节点，再去硬盘查询对应行的数据，从而减少I/O次数。由于数据都在叶子节点上，所以查询时间具有稳定性，不会出现查询速度忽快忽慢的情况。</p> 
<h3><a id="_389"></a>事务</h3> 
<p>在数据库操作中，事务确保了一系列操作的完整性和一致性。例如，在支付交易中，当您向某人支付金额时，该金额首先从您的账户中扣除，然后增加到接收方的账户中。如果此过程中断，事务的特性允许系统回滚到操作前的状态，避免例如扣款成功但收款失败的问题。</p> 
<pre><code>START TRANSACTION; // 开启事务

... // 中间操作

COMMIT; // 如果一切正常则提交事务

ROLLBACK; // 如果有错误发生则回滚事务
</code></pre> 
<p><strong>事务的四大特性（ACID）</strong> ：</p> 
<ol><li> <p><strong>原子性（Atomicity）</strong> ：事务被视为最小的不可分割单元，要么全部操作成功完成，要么全部失败回滚，不会结束在中间某个环节。</p> </li><li> <p><strong>一致性（Consistency）</strong> ：事务确保数据库从一个一致的状态转变到另一个一致的状态。即使在并发操作中，事务完成后也不会违反数据的完整性和业务规则。</p> </li><li> <p><strong>隔离性（Isolation）</strong> ：事务的隔离性定义了事务可见性和可能影响其他事务的级别。主要是为了防止如下几种问题：</p> 
  <ul><li><strong>脏读</strong> ：一个事务读取到另一个事务未提交的数据。</li><li><strong>不可重复读</strong> ：一个事务执行期间，另一个事务修改了数据，导致第一个事务重复读取相同的数据时得到不同的结果。</li><li><strong>幻读</strong> ：一个事务执行期间，另一个事务插入或删除了一些数据，导致第一个事务查询到了额外的行（幻行）。</li></ul> </li><li> <p><strong>持久性（Durability）</strong> ：一旦事务提交，则其所做的修改会永久保存在数据库中，即使系统发生故障也不会丢失。</p> </li></ol> 
<p><strong>事务隔离级别</strong> ：</p> 
<ol><li><strong>Read Uncommitted (读未提交)</strong> ：允许读取未提交的数据，可能导致脏读、不可重复读和幻读。</li><li><strong>Read Committed (读已提交)</strong> ：允许从事务开始后其他事务提交的更改，可避免脏读，但可能遇到不可重复读。</li><li><strong>Repeatable Read (可重复读)</strong> ：在一个事务内部多次读取相同记录的结果是一致的，避免不可重复读，但可能遇到幻读。</li><li><strong>Serializable (可串行化)</strong> ：最严格的隔离级别，通过锁定访问的数据阻止了脏读、不可重复读及幻读，确保无并发事务的干扰。</li></ol> 
<h2><a id="JDBC_423"></a>JDBC</h2> 
<p><strong>JDBC 主要的流程</strong></p> 
<p>JDBC 的主要流程如下：</p> 
<ol><li><strong>创建数据源</strong> ：使用 <code>MysqlDataSource</code> 或其他数据源类来配置数据库连接参数。</li><li><strong>建立连接</strong> ：通过数据源对象获取数据库连接。</li><li><strong>构造 SQL 语句</strong> ：创建需要执行的 SQL 语句，例如插入、更新、删除或查询。</li><li><strong>发送给服务器执行</strong> ：使用 <code>PreparedStatement</code> 对象执行 SQL 语句。</li><li><strong>关闭资源</strong> ：关闭 <code>PreparedStatement</code> 和 <code>Connection</code> 以释放资源。</li></ol> 
<p><strong>修改、删除、增加操作示例</strong></p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>jdbc2<span class="token punctuation">.</span>optional<span class="token punctuation">.</span></span><span class="token class-name">MysqlDataSource</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">DataSource</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Connection</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">PreparedStatement</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">SQLException</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 创建数据源</span>
        <span class="token class-name">MysqlDataSource</span> dataSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MysqlDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataSource<span class="token punctuation">.</span><span class="token function">setUrl</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql://127.0.0.1:3306/gh?characterEncoding=utf8&amp;useSSL=false"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataSource<span class="token punctuation">.</span><span class="token function">setUser</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataSource<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 建立连接</span>
        <span class="token class-name">Connection</span> connection <span class="token operator">=</span> dataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 构造 SQL 语句</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"INSERT INTO student VALUES (9, '1234', 'gh', '123.qq.com', 3)"</span><span class="token punctuation">;</span>
        <span class="token class-name">PreparedStatement</span> preparedStatement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 输出 SQL 语句</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"SQL: "</span> <span class="token operator">+</span> preparedStatement<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 发送给服务器执行</span>
        <span class="token keyword">int</span> rowsAffected <span class="token operator">=</span> preparedStatement<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"数据库更改了 "</span> <span class="token operator">+</span> rowsAffected <span class="token operator">+</span> <span class="token string">" 行"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 关闭资源</span>
        preparedStatement<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>读取操作示例</strong></p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>jdbc2<span class="token punctuation">.</span>optional<span class="token punctuation">.</span></span><span class="token class-name">MysqlDataSource</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">DataSource</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Connection</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">PreparedStatement</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">ResultSet</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">SQLException</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test2</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 创建数据源</span>
        <span class="token class-name">MysqlDataSource</span> dataSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MysqlDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataSource<span class="token punctuation">.</span><span class="token function">setUrl</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql://127.0.0.1:3306/gh?characterEncoding=utf8&amp;useSSL=false"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataSource<span class="token punctuation">.</span><span class="token function">setUser</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataSource<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 建立连接</span>
        <span class="token class-name">Connection</span> connection <span class="token operator">=</span> dataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 构造 SQL 语句</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM student"</span><span class="token punctuation">;</span>
        <span class="token class-name">PreparedStatement</span> statement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 执行查询并获得结果集</span>
        <span class="token class-name">ResultSet</span> resultSet <span class="token operator">=</span> statement<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 处理每一行数据</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">int</span> id <span class="token operator">=</span> resultSet<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> sn <span class="token operator">=</span> resultSet<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"sn"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> name <span class="token operator">=</span> resultSet<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> qq_mail <span class="token operator">=</span> resultSet<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"qq_mail"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> classes_id <span class="token operator">=</span> resultSet<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"classes_id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"id = "</span> <span class="token operator">+</span> id <span class="token operator">+</span> <span class="token string">" sn = "</span> <span class="token operator">+</span> sn <span class="token operator">+</span> <span class="token string">" name = "</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">" qq_mail = "</span> <span class="token operator">+</span> qq_mail <span class="token operator">+</span> <span class="token string">" classes_id = "</span> <span class="token operator">+</span> classes_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 关闭资源</span>
        resultSet<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        statement<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>​</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b2e65bea13e25fa0900157900f74a29d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">数学建模——农村公交与异构无人机协同配送优化</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2b5c90eb3085493d04c022b92b2d56bc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">通过C语言实现三种版本的快速排序</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>