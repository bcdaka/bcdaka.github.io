<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>本地idea连接Centos7kafka操作 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/eff22e72bd309ce9f0906cf883c49157/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="本地idea连接Centos7kafka操作">
  <meta property="og:description" content="搭建完kafka，一般都是使用本地来链接虚拟机的，初次链接会出现各种神奇的问题，特此记录一下。
首先，请先对生产者，消费者，topic有一个大概的认识
-----本地的工作 先在本地idea写生产者的代码
package com.example.kafkademo.demos; import org.apache.kafka.clients.producer.KafkaProducer; import org.apache.kafka.clients.producer.ProducerConfig; import org.apache.kafka.clients.producer.ProducerRecord; import java.util.Properties; public class ProducerQuickStart { public static void main(String[] args) { // Properties prop=new Properties(); //kafka链接地址 prop.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG,&#34;192.168.12.130:9092&#34;); //序列化 prop.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG,&#34;org.apache.kafka.common.serialization.StringSerializer&#34;); prop.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG,&#34;org.apache.kafka.common.serialization.StringSerializer&#34;); //创建对象 KafkaProducer&lt;String,String&gt; producer=new KafkaProducer&lt;String, String&gt;(prop); //发送 /** * topic key value */ ProducerRecord&lt;String,String&gt; kvProducerRecord =new ProducerRecord&lt;String,String&gt;(&#34;mytopic&#34;,&#34;key-001&#34;,&#34;hello kafka1&#34;); producer.send(kvProducerRecord); //必须关闭 producer.close(); } } 看不懂复制粘贴到gpt
这里可知道，我们对
192.168.12.130:9092 虚拟机kafka的发了一个(&#34;mytopic&#34;,&#34;key-001&#34;,&#34;hello kafka1&#34;); 向mytopic这个主题发送了一个ello kafka1。 -------本地防火墙的工作 我们要打开本地9092的端口来和虚拟机进行交流
具体教程站内有，有需要请移步，关键词 win防火墙 ，端口
总之
打开9092端口（kafka默认工作在9092）">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-14T15:49:35+08:00">
    <meta property="article:modified_time" content="2024-03-14T15:49:35+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">本地idea连接Centos7kafka操作</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>搭建完kafka，一般都是使用本地来链接虚拟机的，初次链接会出现各种神奇的问题，特此记录一下。</p> 
<p>首先，请先对生产者，消费者，topic有一个大概的认识</p> 
<h5>-----本地的工作</h5> 
<p>先在本地idea写生产者的代码</p> 
<pre><code class="hljs">package com.example.kafkademo.demos;

import org.apache.kafka.clients.producer.KafkaProducer;
import org.apache.kafka.clients.producer.ProducerConfig;
import org.apache.kafka.clients.producer.ProducerRecord;

import java.util.Properties;

public class ProducerQuickStart {

    public static void main(String[] args) {
        //
        Properties prop=new Properties();
        //kafka链接地址
        prop.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG,"192.168.12.130:9092");
        //序列化
        prop.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG,"org.apache.kafka.common.serialization.StringSerializer");
        prop.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG,"org.apache.kafka.common.serialization.StringSerializer");


        //创建对象
        KafkaProducer&lt;String,String&gt; producer=new KafkaProducer&lt;String, String&gt;(prop);
        //发送

        /**
         * topic key value
         */
        ProducerRecord&lt;String,String&gt; kvProducerRecord =new ProducerRecord&lt;String,String&gt;("mytopic","key-001","hello kafka1");
        producer.send(kvProducerRecord);
        //必须关闭
        producer.close();
    }
}
</code></pre> 
<p>看不懂复制粘贴到gpt</p> 
<p>这里可知道，我们对</p> 
<pre>192.168.12.130:9092 虚拟机kafka的发了一个("mytopic","key-001","hello kafka1");
向mytopic这个主题发送了一个ello kafka1。</pre> 
<h5>-------本地防火墙的工作</h5> 
<p>我们要打开本地9092的端口来和虚拟机进行交流</p> 
<p>具体教程站内有，有需要请移步，关键词               win防火墙 ，端口</p> 
<p></p> 
<p>总之</p> 
<p><img alt="" height="504" src="https://images2.imgbox.com/9c/5e/Brh60Ei9_o.png" width="579"></p> 
<p></p> 
<p>打开9092端口（kafka默认工作在9092）</p> 
<h5>--------虚拟机防火墙工作</h5> 
<p>进入到linux中，我们打开9092端口的防火墙，（默认9092）</p> 
<pre><code class="hljs">执行以下命令以开放端口 9092（假设你使用的是 firewalld 防火墙）：

firewall-cmd --zone=public --add-port=9092/tcp --permanent

这条命令会将 9092 端口添加到防火墙规则中，并持久化保存。

重新加载防火墙配置使更改生效：
firewall-cmd --reload

现在，端口 9092 应该已经被打开了。你可以通过检查防火墙规则来确认端口是否成功打开：

firewall-cmd --list-ports</code></pre> 
<ol><li></ol> 
<h5>--------看看能不能联通（有自信的可以跳过）</h5> 
<p></p> 
<p><code>接下来我们可以使用telnet来尝试一下本地能不能访问kafka</code></p> 
<p>在本地win系统下（没有可以花费30秒装一个）安装教程本站有，<a href="https://blog.csdn.net/qyj19920704/article/details/122602444?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522171039935816800225543065%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=171039935816800225543065&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-122602444-null-null.142%5Ev99%5Epc_search_result_base2&amp;utm_term=win%20telnet&amp;spm=1018.2226.3001.4187" title="【高效开发工具系列】Windows 怎么使用 telnet_windows telnet-CSDN博客">【高效开发工具系列】Windows 怎么使用 telnet_windows telnet-CSDN博客</a></p> 
<p></p> 
<p><strong>测试telnet前必须保证虚拟机的测试端口正在运行（telnet只能测试被使用的端口）</strong></p> 
<p>虚拟机启动kafka</p> 
<p><img alt="" height="197" src="https://images2.imgbox.com/09/09/zOL9PzO1_o.png" width="678"></p> 
<p>本地使用telnet</p> 
<p>telnet 192.168 .12.130 9092                                    (测试虚拟机9092端口 )</p> 
<p>联通成功可以进入telnet中，如图成功链接</p> 
<p><img alt="" height="404" src="https://images2.imgbox.com/95/9f/5T6swQrp_o.png" width="865"></p> 
<h5>---------kafka操作</h5> 
<p>还记得我们之前代码里的topic，叫做"mytopic"吗</p> 
<p>如果没有mytopic的情况下是不会自动创建topic的，我们得在kafka手动创建这个topic</p> 
<p></p> 
<p>我们到kafka的bin目录下</p> 
<p></p> 
<p>./kafka-topics.sh --list --zookeeper 192.168.12.130:2181<br> 看当前的所有topic</p> 
<p>---------------------------------</p> 
<p>./kafka-topics.sh --create --zookeeper 192.168.12.130:2181 --replication-factor 1 --partitions 1 --topic mytopic</p> 
<p>在 Kafka 中通过 ZooKeeper 创建一个名为 <code>mytopic</code> 的主题。这个命令看起来是正确的，假设你的 Kafka 集群中有一个运行 ZooKeeper 的节点，并且该节点的地址是 <code>192.168.12.130:2181</code>。</p> 
<p>执行该命令后，Kafka 将会尝试在指定的 ZooKeeper 上创建一个名为 <code>mytopic</code> 的主题，该主题将只有一个分区和一个副本。如果一切顺利，Kafka 将成功创建这个主题。</p> 
<p>---------------------------------------</p> 
<p>创建完和idea相似的代码后服务不要关闭</p> 
<h5>-----------启动idea生产者代码</h5> 
<p>10秒内肯定能执行完毕，即或不然出错了。</p> 
<p>去kafka执行</p> 
<pre><code class="hljs">./kafka-console-consumer.sh --bootstrap-server 192.168.12.130:9092 --topic test-topic --from-beginning --max-messages 10   </code></pre> 
<p>这个命令将在命令行中启动一个简单的 Kafka 消费者客户端，并连接到指定的 Kafka 服务器（broker）来消费名为 <code>test-topic</code> 的主题中的消息。该命令还设置了一些选项：</p> 
<ul><li><code>--bootstrap-server 192.168.12.130:9092</code>：指定要连接的 Kafka 服务器的地址和端口。</li><li><code>--topic test-topic</code>：指定要消费消息的主题名称，这里是 <code>test-topic</code>。</li><li><code>--from-beginning</code>：表示从该主题的起始位置开始消费消息。</li><li><code>--max-messages 10</code>：指定最大的消息数量，这里设置为 10 条。</li></ul> 
<p>一旦你执行这个命令，Kafka 将会在命令行中显示来自 <code>test-topic</code> 主题的前10条消息（如果有的话）。如果没有设置 <code>--max-messages</code> 参数，默认情况下会持续监听该主题并打印新到达的消息。<strong>也就是不会主动关闭</strong></p> 
<p>停止centos7当前进程的命令是ctrl+c</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/a8/a8/pzG8hgUB_o.png"></p> 
<p> 生产者已经注入了kafka</p> 
<p></p> 
<h5>-----------遇到了无法访问的问题怎么办</h5> 
<p>1. 请你回到上述联通的步骤，使用telnet工具</p> 
<p>2，能联通，访问不了的话，我们就把kafka集群，zookeeper所有出现“本机”的字段更改成虚拟机地址（极度不推荐，麻烦，会出现后续问题）</p> 
<p></p> 
<p>在zookeeper.properties文件中加上</p> 
<pre>clientPortAddress=192.168.12.130                 #示例</pre> 
<p>在所有kafka文件</p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#FFFFFF;"><em><span style="color:#000000;">Service-properties文件中加上</span></em></span></p> 
<p style="margin-left:0;text-align:left;"></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#0d0016;"><em>listeners=PLAINTEXT://192.168.12.130:9092</em><br><em>advertised.listeners=PLAINTEXT://192.168.12.130:9092      #改成你的虚拟机的ip和端口</em></span></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#0d0016;"><em>将原来的</em></span></p> 
<p><span style="color:#0d0016;"> #<strong>listeners</strong>=PLAINTEXT://:9092  注释掉</span></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ab751d69c619ec475ee135a0c58382a2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C&#43;&#43; 多路音频pcm混音算法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/249f1d95912abf573b6391667d905800/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Spark的reduceByKey方法使用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>