<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>头歌｜HDFS实战 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/1ac0f213965ec83b350ab56385b4e902/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="头歌｜HDFS实战">
  <meta property="og:description" content="第1关：HDFS基础命令实战 start-dfs.sh vi stu01.txt #vi#按i键进入编辑模式，左下角出现--INSERT--字符后，输入以下内容 234 5678 Hadoop #vi#按ESC 键，左下角--INSERT--字符消失后，在英文输入状态下输入 :wq ，回车保存退出文件。 hdfs dfs -mkdir /user/stu02 hdfs dfs -put stu01.txt /user/stu02 第2关：HDFS高级命令实战 start-dfs.sh vi stu01_2.txt #vi#按 i 进入编辑模式，输入内容 hadoop hive #vi#然后按 esc 键，再同时按下 shift 和冒号键，输入 wq，保存退出 hdfs dfs -mkdir /user/stu01/ hdfs dfs -moveFromLocal stu01_2.txt /user/stu01/ vi stu01.txt #vi#按i键进入编辑模式，左下角出现--INSERT--字符后，输入以下内容 234 5678 Hadoop #vi#按ESC 键，左下角--INSERT--字符消失后，在英文输入状态下输入 :wq ，回车保存退出文件。 hdfs dfs -appendToFile stu01.txt /user/stu01/stu01_2.txt hdfs dfs -get /user/stu01/stu01_2.txt . 第3关：使用JAVA API读取HDFS的数据 URI uri=URI.create(&#34;hdfs://localhost:9000/user/hadoop/task.txt&#34;); Configuration config=new Configuration(); FileSystem fs =FileSystem get(uri, config); InputStream in=null; try{ in=fs.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-29T18:16:37+08:00">
    <meta property="article:modified_time" content="2024-03-29T18:16:37+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">头歌｜HDFS实战</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>第1关：HDFS基础命令实战</h2> 
<pre><code class="language-bash">start-dfs.sh

vi stu01.txt
#vi#按i键进入编辑模式，左下角出现--INSERT--字符后，输入以下内容
234
5678
Hadoop
#vi#按ESC 键，左下角--INSERT--字符消失后，在英文输入状态下输入 :wq ，回车保存退出文件。

hdfs  dfs  -mkdir  /user/stu02
hdfs  dfs  -put  stu01.txt  /user/stu02
</code></pre> 
<h2>第2关：HDFS高级命令实战</h2> 
<pre><code class="language-bash">start-dfs.sh

vi stu01_2.txt
#vi#按 i 进入编辑模式，输入内容
hadoop
hive
#vi#然后按 esc 键，再同时按下 shift 和冒号键，输入 wq，保存退出

hdfs  dfs  -mkdir /user/stu01/
hdfs  dfs  -moveFromLocal  stu01_2.txt /user/stu01/

vi stu01.txt
#vi#按i键进入编辑模式，左下角出现--INSERT--字符后，输入以下内容
234
5678
Hadoop
#vi#按ESC 键，左下角--INSERT--字符消失后，在英文输入状态下输入 :wq ，回车保存退出文件。

hdfs  dfs  -appendToFile  stu01.txt  /user/stu01/stu01_2.txt
hdfs  dfs  -get  /user/stu01/stu01_2.txt  .</code></pre> 
<h2>第3关：使用JAVA API读取HDFS的数据</h2> 
<pre><code class="language-java">URI uri=URI.create("hdfs://localhost:9000/user/hadoop/task.txt");
Configuration config=new Configuration();
FileSystem fs =FileSystem get(uri, config);
InputStream in=null;
try{
    in=fs.open(new Path(uri));
    IOUtils. copyBytes (in, System. out, 2048, false);
} catch(Exception e){
    IOUtils. closeStream(in);
}</code></pre> 
<h2>第4关：使用JAVA API将数据写入HDFS</h2> 
<h3>代码文件:</h3> 
<pre><code class="language-java">File localPath=new File("/develop/input/hello.txt");
String hdfsPath="hdfs://localhost:9000/user/tmp/hello.txt";

InputStream in=new BufferedInputStream(new FileInputStream (localPath));
Configuration config=new Configuration();
FileSystem fs=FileSystem.get(URI.create(hdfsPath),config);

long fileSize =localPath.length()&gt;65536 ? localPath.length() / 65536 : 1;

FSDataOutputStream out =fs.create(new Path(hdfsPath),new Progressable(){
    long fileCount=0;
    public void progress){
        System.out.println("总进度"+(fileCount/fileSize)*100+"%");
        fileCount++;
    }
});
IOUtils.copyBytes(in,out,2048,true);</code></pre> 
<h3>命令行:</h3> 
<p>        首先将资源文件(在文章顶部)拖入虚拟系统</p> 
<p style="text-align:center;"><img src="https://images2.imgbox.com/8b/fd/rjIHEVyZ_o.png" alt="58f05f72f6fa4b9ebd6b7e41d812dce0.png"></p> 
<p><img src="https://images2.imgbox.com/50/39/hp9wrHKU_o.png" alt="16604c4dbe17447797dcb9a2f4e9af51.png"></p> 
<p style="text-align:center;"><img src="https://images2.imgbox.com/07/be/Q54SEyNv_o.png" alt="2f87f68d95d641a89063aefb08923241.png"></p> 
<p>之后在命令行运行代码</p> 
<pre><code class="language-java">start-dfs.sh
mkdir -p /develop/input/
mv /data/workspace/userfiles/hello.txt /develop/input/</code></pre> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/def50b1bc73261caa2f6b27aab7df296/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Hadoop之Ha高可用搭建教程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/37b49849c6f05ca9d645b4a9b559d6c3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">mac-gradle的安装和配置，掌握这些知识点再也不怕面试通不过</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>