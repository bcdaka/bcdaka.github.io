<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【卫星定位】GPS/BDS北斗卫星单点定位SPP详解（附Matlab源码） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/63b83870a610eed106ca0bd8661984f5/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【卫星定位】GPS/BDS北斗卫星单点定位SPP详解（附Matlab源码）">
  <meta property="og:description" content="Abstract 本文使用Matlab编写了支持RINEX 3.03的单点定位系统（Single Point Positioning，SPP)，目前支持GPS与北斗系统定位。具体工作如下：1）实现了RINEX格式的OBS与NAV数据解析程序，通过NAV文件得到观测卫星轨道位置与钟差，通过OBS文件得到卫星观测伪距；
2）实现了对伪距的观测与误差建模，采用最小二乘优化解算，并对HDOP值等估计参数进行了计算；
3）进行了定点基站定位与移动站定位的误差分析，最后解算结果以NMEA 0183格式输出。为贡献卫星学习社区，本文代码将开源于：https://github.com/Franky-X/SPP-Supporting-RENIX3.03-with-GPS-BDS。
Introduction 卫星单点定位系统（Single Point Positioning，SPP)是最常用且简单的定位手段之一。SPP利用接收机收到的广播星历数据解析出各卫星的轨道位置，结合卫星的伪距、钟差以及对流层、电离层误差模型，对接收机位置进行解算。本文针对RENIX
3.03格式接收机数据进行了解析，完成了支持GPS和北斗系统的定位，并分析了定位误差结果。本文的核心工作点如下：
实现了OBS与NAV数据解析程序，通过NAV文件得到观测卫星轨道位置与钟差，通过OBS文件得到卫星观测伪距；
实现了对伪距的观测与误差建模，采用最小二乘优化解算，并对HDOP值等估计参数进行了计算；
进行了定点基站定位与移动站定位的误差分析，并将代码开源至社区。
本文将就以下内容展开介绍。第2部分详细介绍了SPP的整体流程，RENIX文件的读取格式、卫星位置计算以及伪距观测与误差建模的原理。第3部分介绍了SPP算法在Matlab中的实现方式和细节。第4部分展示了GPS和BDS的定位结果与误差分析。第5部分总结了本文的工作内容。
Methods 在本小节，我们首先介绍了SPP定位的系统框架，然后对RENIX文件的NAV和OBS文件读取方法进行了分析，接着我们介绍了GPS和北斗卫星位置的解算方法。最后讨论了伪距观测与误差建模过程，介绍了最小二乘问题的构建与解算。
系统框架 如图所示，SPP定位的主要原理是利用已知的卫星位置，结合观测的伪距与对流层模型进行位置解算。
系统执行流程如图所示，首先卫星的位置及钟差由NAV文件读取获得，卫星的伪距观测由OBS文件获得。接着，将卫星的位置、钟差、观测伪距以及对流层误差模型结合，构建最小二乘问题解算，最后输出用户的位置以及相关估计参数。
RENIX文件解析 RENIX文件包括了对卫星轨道位置参数的解算和接收机伪距观测的信息提取，接下来进行详细介绍。
NAV文件解析 NAV文件分为头部解释部分和数据部分，其中头部解释Header部分的信息量有限。主要通过数据部分，结合官方RINEX手册中的广播星历解释，获取计算卫星位置和钟差所需要的轨道参数。参数解析方式可参照我的NAV解析代码https://github.com/Franky-X/Computation-of-BD-Orbit，在此不再赘述。
在读取NAV文件时需要记录卫星编号，以便后续在得到伪距观测侯寻找到与之对应的卫星位置与钟差。
OBS文件解析 OBS文件分为头部解释部分和数据部分。其中头部解释Header部分主要描述了卫星系统、接收消息的种类、接收消息的间隔与接收消息的起止时间，对于数据解析非常重要，部分重要字段如表所示。
含义字段卫星系统/参数个数/观测种类SYS / / OBS TYPES信息时间间隔INTERVAL第一次观测时刻（GPS时间）GPS TIME OF FIRST OBS最后一次观测时刻（GPS时间）GPS TIME OF LAST OBS SPP利用的是伪距进行定位，因此在数据部分我们需要提取的是伪距观测量，在OBS TYPE字段中，伪距观测的首字母为C，因此在读取卫星伪距过程中，只需要读取首字母为C，具有相同波段n的数据即可。
此外，在读取OBS文件过程中，每一个时刻读入的数据记作一个Epoch，便于后续处理。
卫星位置解算 卫星位置和钟差的解算是SPP伪距定位的基础，GPS与北斗系统的卫星系统在真实定位情况中计算有所不同，下面详细介绍GPS和北斗系统的卫星位置与钟差解算过程。
GPS卫星位置解算 计算GPS卫星运动的平均角速度 首先根据广播星历给出的参数 A \sqrt{A} A ​
计算参考时刻 t o e t_{o e} toe​ 的平均角速度 n 0 \mathrm{n}_0 n0​ :
n 0 = G M ( A ) 3 \mathrm{n}_0=\frac{\sqrt{G M}}{(\sqrt{A})^3} n0​=(A ​)3GM ​​">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-07T14:03:13+08:00">
    <meta property="article:modified_time" content="2024-01-07T14:03:13+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【卫星定位】GPS/BDS北斗卫星单点定位SPP详解（附Matlab源码）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Abstract_0"></a>Abstract</h2> 
<p>本文使用Matlab编写了支持RINEX 3.03的单点定位系统（Single Point Positioning，SPP)，目前支持GPS与北斗系统定位。具体工作如下：1）实现了RINEX格式的OBS与NAV数据解析程序，通过NAV文件得到观测卫星轨道位置与钟差，通过OBS文件得到卫星观测伪距；<br> 2）实现了对伪距的观测与误差建模，采用最小二乘优化解算，并对HDOP值等估计参数进行了计算；<br> 3）进行了定点基站定位与移动站定位的误差分析，最后解算结果以NMEA 0183格式输出。为贡献卫星学习社区，本文代码将开源于：https://github.com/Franky-X/SPP-Supporting-RENIX3.03-with-GPS-BDS。</p> 
<h2><a id="Introduction_4"></a>Introduction</h2> 
<p>卫星单点定位系统（Single Point Positioning，SPP)是最常用且简单的定位手段之一。SPP利用接收机收到的广播星历数据解析出各卫星的轨道位置，结合卫星的伪距、钟差以及对流层、电离层误差模型，对接收机位置进行解算。本文针对RENIX<br> 3.03格式接收机数据进行了解析，完成了支持GPS和北斗系统的定位，并分析了定位误差结果。本文的核心工作点如下：</p> 
<ul><li> <p>实现了OBS与NAV数据解析程序，通过NAV文件得到观测卫星轨道位置与钟差，通过OBS文件得到卫星观测伪距；</p> </li><li> <p>实现了对伪距的观测与误差建模，采用最小二乘优化解算，并对HDOP值等估计参数进行了计算；</p> </li><li> <p>进行了定点基站定位与移动站定位的误差分析，并将代码开源至社区。</p> </li></ul> 
<p>本文将就以下内容展开介绍。第2部分详细介绍了SPP的整体流程，RENIX文件的读取格式、卫星位置计算以及伪距观测与误差建模的原理。第3部分介绍了SPP算法在Matlab中的实现方式和细节。第4部分展示了GPS和BDS的定位结果与误差分析。第5部分总结了本文的工作内容。</p> 
<h2><a id="Methods_17"></a>Methods</h2> 
<p>在本小节，我们首先介绍了SPP定位的系统框架，然后对RENIX文件的NAV和OBS文件读取方法进行了分析，接着我们介绍了GPS和北斗卫星位置的解算方法。最后讨论了伪距观测与误差建模过程，介绍了最小二乘问题的构建与解算。</p> 
<h3><a id="_21"></a>系统框架</h3> 
<p>如图所示，SPP定位的主要原理是利用已知的卫星位置，结合观测的伪距与对流层模型进行位置解算。<br> <img src="https://images2.imgbox.com/57/ca/lKSshYf9_o.png" alt="SPP示意图"><br> 系统执行流程如图所示，首先卫星的位置及钟差由NAV文件读取获得，卫星的伪距观测由OBS文件获得。接着，将卫星的位置、钟差、观测伪距以及对流层误差模型结合，构建最小二乘问题解算，最后输出用户的位置以及相关估计参数。<br> <img src="https://images2.imgbox.com/4a/86/J43dWyuL_o.png" alt="系统框图"></p> 
<h3><a id="RENIX_27"></a>RENIX文件解析</h3> 
<p>RENIX文件包括了对卫星轨道位置参数的解算和接收机伪距观测的信息提取，接下来进行详细介绍。</p> 
<h4><a id="NAV_31"></a>NAV文件解析</h4> 
<p>NAV文件分为头部解释部分和数据部分，其中头部解释Header部分的信息量有限。主要通过数据部分，结合官方RINEX手册中的广播星历解释，获取计算卫星位置和钟差所需要的轨道参数。参数解析方式可参照我的NAV解析代码https://github.com/Franky-X/Computation-of-BD-Orbit，在此不再赘述。</p> 
<p>在读取NAV文件时需要记录卫星编号，以便后续在得到伪距观测侯寻找到与之对应的卫星位置与钟差。</p> 
<h4><a id="OBS_37"></a>OBS文件解析</h4> 
<p>OBS文件分为头部解释部分和数据部分。其中头部解释Header部分主要描述了卫星系统、接收消息的种类、接收消息的间隔与接收消息的起止时间，对于数据解析非常重要，部分重要字段如表所示。</p> 
<table><thead><tr><th align="center"><strong>含义</strong></th><th align="center"><strong>字段</strong></th></tr></thead><tbody><tr><td align="center">卫星系统/参数个数/观测种类</td><td align="center">SYS / / OBS TYPES</td></tr><tr><td align="center">信息时间间隔</td><td align="center">INTERVAL</td></tr><tr><td align="center">第一次观测时刻（GPS时间）</td><td align="center">GPS TIME OF FIRST OBS</td></tr><tr><td align="center">最后一次观测时刻（GPS时间）</td><td align="center">GPS TIME OF LAST OBS</td></tr></tbody></table> 
<p>SPP利用的是伪距进行定位，因此在数据部分我们需要提取的是伪距观测量，在OBS TYPE字段中，伪距观测的首字母为C，因此在读取卫星伪距过程中，只需要读取首字母为C，具有相同波段n的数据即可。<br> 此外，在读取OBS文件过程中，每一个时刻读入的数据记作一个Epoch，便于后续处理。</p> 
<h3><a id="_49"></a>卫星位置解算</h3> 
<p>卫星位置和钟差的解算是SPP伪距定位的基础，GPS与北斗系统的卫星系统在真实定位情况中计算有所不同，下面详细介绍GPS和北斗系统的卫星位置与钟差解算过程。</p> 
<h4><a id="GPS_53"></a>GPS卫星位置解算</h4> 
<p>计算GPS卫星运动的平均角速度 首先根据广播星历给出的参数 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          A 
         
        
       
      
        \sqrt{A} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.04em; vertical-align: -0.1133em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.9267em;"><span class="svg-align" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="padding-left: 0.833em;"><span class="mord mathnormal">A</span></span></span><span class="" style="top: -2.8867em;"><span class="pstrut" style="height: 3em;"></span><span class="hide-tail" style="min-width: 0.853em; height: 1.08em;"> 
           <svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"> 
            <path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path> 
           </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1133em;"><span class=""></span></span></span></span></span></span></span></span></span><br> 计算参考时刻 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          t 
         
         
         
           o 
          
         
           e 
          
         
        
       
      
        t_{o e} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7651em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">oe</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 的平均角速度 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          n 
         
        
          0 
         
        
       
      
        \mathrm{n}_0 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathrm">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> :<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           n 
          
         
           0 
          
         
        
          = 
         
         
          
           
           
             G 
            
           
             M 
            
           
          
          
          
            ( 
           
           
           
             A 
            
           
           
           
             ) 
            
           
             3 
            
           
          
         
        
       
         \mathrm{n}_0=\frac{\sqrt{G M}}{(\sqrt{A})^3} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathrm">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.6703em; vertical-align: -1.0667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6037em;"><span class="" style="top: -2.1833em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.9267em;"><span class="svg-align" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="padding-left: 0.833em;"><span class="mord mathnormal">A</span></span></span><span class="" style="top: -2.8867em;"><span class="pstrut" style="height: 3em;"></span><span class="hide-tail" style="min-width: 0.853em; height: 1.08em;"> 
                   <svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"> 
                    <path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path> 
                   </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1133em;"><span class=""></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7401em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.9267em;"><span class="svg-align" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="padding-left: 0.833em;"><span class="mord mathnormal" style="margin-right: 0.109em;">GM</span></span></span><span class="" style="top: -2.8867em;"><span class="pstrut" style="height: 3em;"></span><span class="hide-tail" style="min-width: 0.853em; height: 1.08em;"> 
                   <svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"> 
                    <path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path> 
                   </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1133em;"><span class=""></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.0667em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         G 
        
       
      
        G 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span></span> 是万有引力常数， <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         M 
        
       
      
        M 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.109em;">M</span></span></span></span></span> 是地球总质量，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         G 
        
       
         M 
        
       
         = 
        
       
         3.986005 
        
       
         × 
        
       
         1 
        
        
        
          0 
         
        
          ∧ 
         
        
       
         14 
        
       
      
        G M=3.986005 \times 10^{\wedge} 14 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.109em;">GM</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">3.986005</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7519em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7519em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∧</span></span></span></span></span></span></span></span></span><span class="mord">14</span></span></span></span></span> 。<br> 再根据广播星历中给定的摄动参数n’计算观测时刻卫星的平均角速度:<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          n 
         
        
          = 
         
         
         
           n 
          
         
           0 
          
         
        
          + 
         
        
          n 
         
        
       
         n=n_0+n 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span></span></p> 
<p>计算观测瞬间的平近点角M <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          M 
         
        
          = 
         
         
         
           M 
          
         
           0 
          
         
        
          + 
         
        
          n 
         
         
         
           ( 
          
         
           t 
          
         
           − 
          
          
          
            t 
           
           
           
             o 
            
           
             e 
            
           
          
         
           ) 
          
         
        
       
         M=M_0+n\left(t-t_{o e}\right) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.109em;">M</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.109em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.109em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">oe</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span></span></span></span></p> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         M 
        
       
         0 
        
       
      
        \mathrm{M} 0 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathrm">M</span><span class="mord">0</span></span></span></span></span> 为参考时刻 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          t 
         
         
         
           o 
          
         
           e 
          
         
        
       
      
        t_{o e} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7651em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">oe</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 的平近点角，由广播星历给出。<br> 这里用参考时刻而不用近地点时刻的原因：广播星历每两小时更新一次，将参考时刻设置在中间时刻，则外推时间间隔均小于等于1小时，如果用近地点时刻，外推可能达到6小时。简单模型也可获得精度较高的结果。</p> 
<p>计算偏近点角M： 弧度表示的开普勒方程: <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          E 
         
        
          = 
         
        
          M 
         
        
          + 
         
        
          e 
         
        
          sin 
         
        
          ⁡ 
         
        
          E 
         
        
       
         E=M+e \sin E 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0576em;">E</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;"></span><span class="mord mathnormal" style="margin-right: 0.109em;">M</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0576em;">E</span></span></span></span></span></span></p> 
<p>角度表示的开普勒方程:<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           E 
          
         
           ∘ 
          
         
        
          = 
         
         
         
           M 
          
         
           ∘ 
          
         
        
          + 
         
        
          ρ 
         
        
          ⋅ 
         
        
          e 
         
        
          sin 
         
        
          ⁡ 
         
         
         
           E 
          
         
           ∘ 
          
         
        
       
         E^{\circ}=M^{\circ}+\rho \cdot e \sin E^{\circ} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7241em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0576em;">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7241em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∘</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8074em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.109em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7241em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∘</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6389em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">ρ</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7241em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0576em;">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7241em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∘</span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>计算真近点角： <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
           
            
            
              cos 
             
            
              ⁡ 
             
            
              f 
             
            
              = 
             
             
              
              
                cos 
               
              
                ⁡ 
               
              
                E 
               
              
                − 
               
              
                e 
               
              
              
              
                1 
               
              
                − 
               
              
                e 
               
              
                cos 
               
              
                ⁡ 
               
              
                E 
               
              
             
            
           
          
         
         
          
           
            
            
              sin 
             
            
              ⁡ 
             
            
              f 
             
            
              = 
             
             
              
               
                
                
                  1 
                 
                
                  − 
                 
                 
                 
                   e 
                  
                 
                   2 
                  
                 
                
               
              
                sin 
               
              
                ⁡ 
               
              
                E 
               
              
              
              
                1 
               
              
                − 
               
              
                e 
               
              
                cos 
               
              
                ⁡ 
               
              
                E 
               
              
             
            
           
          
         
        
       
         \begin{gathered} \cos f=\frac{\cos E-e}{1-e \cos E} \\ \sin f=\frac{\sqrt{1-e^2} \sin E}{1-e \cos E} \end{gathered} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 5.0894em; vertical-align: -2.2947em;"></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.7947em;"><span class="" style="top: -5.0247em;"><span class="pstrut" style="height: 3.5904em;"></span><span class="mord"><span class="mop">cos</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3603em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0576em;">E</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop">cos</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0576em;">E</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7693em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -2.365em;"><span class="pstrut" style="height: 3.5904em;"></span><span class="mord"><span class="mop">sin</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.5904em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0576em;">E</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.9134em;"><span class="svg-align" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="padding-left: 0.833em;"><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7401em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.8734em;"><span class="pstrut" style="height: 3em;"></span><span class="hide-tail" style="min-width: 0.853em; height: 1.08em;"> 
                           <svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"> 
                            <path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path> 
                           </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1266em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0576em;">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7693em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.2947em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>e为卫星轨道的偏心率，由广播星历给出.<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          f 
         
        
          = 
         
        
          arctan 
         
        
          ⁡ 
         
         
          
           
            
            
              1 
             
            
              − 
             
             
             
               e 
              
             
               2 
              
             
            
           
          
            sin 
           
          
            ⁡ 
           
          
            E 
           
          
          
          
            cos 
           
          
            ⁡ 
           
          
            E 
           
          
            − 
           
          
            e 
           
          
         
        
       
         f=\arctan \frac{\sqrt{1-e^2} \sin E}{\cos E-e} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.3597em; vertical-align: -0.7693em;"></span><span class="mop">arctan</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.5904em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop">cos</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0576em;">E</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">e</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.9134em;"><span class="svg-align" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="padding-left: 0.833em;"><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7401em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.8734em;"><span class="pstrut" style="height: 3em;"></span><span class="hide-tail" style="min-width: 0.853em; height: 1.08em;"> 
                   <svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"> 
                    <path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path> 
                   </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1266em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0576em;">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7693em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<p>计算升交角距： <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           u 
          
         
           ′ 
          
         
        
          = 
         
        
          ω 
         
        
          + 
         
        
          f 
         
        
       
         u^{\prime}=\omega+f 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8019em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8019em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">ω</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span></span></span></span></span></span></p> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ω 
        
       
      
        \omega 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">ω</span></span></span></span></span> 为近地点角距，由广播星历给出。</p> 
<p>计算摄动改正项： 广播星历中给出了6个摄动参数:<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          C 
         
         
         
           u 
          
         
           c 
          
         
        
       
         , 
        
        
        
          C 
         
         
         
           u 
          
         
           s 
          
         
        
       
         , 
        
        
        
          C 
         
         
         
           r 
          
         
           c 
          
         
        
       
         , 
        
        
        
          C 
         
         
         
           r 
          
         
           s 
          
         
        
       
         , 
        
        
        
          C 
         
         
         
           r 
          
         
           s 
          
         
        
       
         , 
        
        
        
          C 
         
         
         
           i 
          
         
           s 
          
         
        
       
      
        C_{u c}, C_{u s}, C_{r c}, C_{r s}, C_{r s}, C_{i s} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">rc</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 可以求出由<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         J 
        
       
         2 
        
       
      
        \mathrm{J} 2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathrm">J</span><span class="mord">2</span></span></span></span></span> 项而引起的升交角距u的改正项、卫星矢径 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         r 
        
       
      
        \mathrm{r} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathrm">r</span></span></span></span></span>的改正项和卫星轨道倾角i的摄动改正项 <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
           
            
             
             
               δ 
              
             
               u 
              
             
            
              = 
             
             
             
               C 
              
              
              
                u 
               
              
                c 
               
              
             
            
              cos 
             
            
              ⁡ 
             
            
              2 
             
             
             
               u 
              
             
               ′ 
              
             
            
              + 
             
             
             
               C 
              
              
              
                u 
               
              
                s 
               
              
             
            
              sin 
             
            
              ⁡ 
             
            
              2 
             
             
             
               u 
              
             
               ′ 
              
             
            
           
          
         
         
          
           
            
             
             
               δ 
              
             
               r 
              
             
            
              = 
             
             
             
               C 
              
              
              
                r 
               
              
                c 
               
              
             
            
              cos 
             
            
              ⁡ 
             
            
              2 
             
             
             
               u 
              
             
               ′ 
              
             
            
              + 
             
             
             
               C 
              
              
              
                r 
               
              
                s 
               
              
             
            
              sin 
             
            
              ⁡ 
             
            
              2 
             
             
             
               u 
              
             
               ′ 
              
             
            
           
          
         
         
          
           
            
             
             
               δ 
              
             
               i 
              
             
            
              = 
             
             
             
               C 
              
              
              
                i 
               
              
                c 
               
              
             
            
              cos 
             
            
              ⁡ 
             
            
              2 
             
             
             
               u 
              
             
               ′ 
              
             
            
              + 
             
             
             
               C 
              
              
              
                i 
               
              
                s 
               
              
             
            
              sin 
             
            
              ⁡ 
             
            
              2 
             
             
             
               u 
              
             
               ′ 
              
             
            
           
          
         
        
       
         \begin{gathered} \delta_u=C_{u c} \cos 2 u^{\prime}+C_{u s} \sin 2 u^{\prime} \\ \delta_r=C_{r c} \cos 2 u^{\prime}+C_{r s} \sin 2 u^{\prime} \\ \delta_i=C_{i c} \cos 2 u^{\prime}+C_{i s} \sin 2 u^{\prime} \end{gathered} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 4.5em; vertical-align: -2em;"></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.5em;"><span class="" style="top: -4.66em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0379em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0379em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8019em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8019em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.16em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0379em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0379em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">rc</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8019em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">rs</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8019em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -1.66em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0379em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0379em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8019em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8019em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span> 进行摄动改正 <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
           
            
            
              u 
             
            
              = 
             
             
             
               u 
              
             
               ′ 
              
             
            
              + 
             
             
             
               δ 
              
             
               u 
              
             
            
           
          
         
         
          
           
            
            
              r 
             
            
              = 
             
             
             
               u 
              
             
               ′ 
              
             
            
              + 
             
             
             
               δ 
              
             
               r 
              
             
            
              = 
             
            
              a 
             
            
              ( 
             
            
              1 
             
            
              − 
             
            
              e 
             
            
              cos 
             
            
              ⁡ 
             
            
              E 
             
            
              ) 
             
            
              + 
             
             
             
               δ 
              
             
               r 
              
             
            
           
          
         
         
          
           
            
            
              i 
             
            
              = 
             
             
             
               i 
              
             
               0 
              
             
            
              + 
             
             
             
               δ 
              
             
               i 
              
             
            
              + 
             
             
              
              
                d 
               
              
                i 
               
              
              
              
                d 
               
              
                t 
               
              
             
             
             
               ( 
              
             
               t 
              
             
               − 
              
              
              
                t 
               
               
               
                 o 
                
               
                 e 
                
               
              
             
               ) 
              
             
            
           
          
         
        
       
         \begin{gathered} u=u^{\prime}+\delta_u \\ r=u^{\prime}+\delta_r=a(1-e \cos E)+\delta_r \\ i=i_0+\delta_i+\frac{d i}{d t}\left(t-t_{o e}\right) \end{gathered} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 5.3574em; vertical-align: -2.4287em;"></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.9287em;"><span class="" style="top: -5.4602em;"><span class="pstrut" style="height: 3.3714em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8019em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0379em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0379em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.9602em;"><span class="pstrut" style="height: 3.3714em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8019em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0379em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0379em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord mathnormal">a</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0576em;">E</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0379em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0379em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -1.9287em;"><span class="pstrut" style="height: 3.3714em;"></span><span class="mord"><span class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0379em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0379em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3714em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">oe</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.4287em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>a为卫星轨道长半径， <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         i 
        
       
         0 
        
       
      
        \mathrm{i} 0 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6679em;"></span><span class="mord mathrm">i</span><span class="mord">0</span></span></span></span></span> 为参考时刻 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          t 
         
         
         
           o 
          
         
           e 
          
         
        
       
      
        t_{o e} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7651em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">oe</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>的轨道倾角，由广播星历中的开普勒六参数给出， <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          d 
         
        
          i 
         
        
       
         / 
        
        
        
          d 
         
        
          t 
         
        
       
      
        \mathrm{di} / \mathrm{dt} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathrm">di</span></span><span class="mord">/</span><span class="mord"><span class="mord mathrm">dt</span></span></span></span></span></span><br> 为i的变化率，由广播星历中的摄动九参数给出。</p> 
<p>计算卫星在轨道面坐标系中的位置：<br> 轨道平面直角坐标系中（坐标原点位于地心，X轴指向升交点）卫星的平面直角坐标系：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
           
            
           
          
          
           
            
             
            
              x 
             
            
              = 
             
            
              r 
             
            
              cos 
             
            
              ⁡ 
             
            
              u 
             
            
           
          
         
         
          
           
            
           
          
          
           
            
             
            
              y 
             
            
              = 
             
            
              r 
             
            
              sin 
             
            
              ⁡ 
             
            
              u 
             
            
           
          
         
        
       
         \begin{aligned} &amp; \mathrm{x}=r \cos u \\ &amp; y=r \sin u \end{aligned} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 3em; vertical-align: -1.25em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.75em;"><span class="" style="top: -3.75em;"><span class="pstrut" style="height: 2.84em;"></span><span class="mord"></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.75em;"><span class="" style="top: -3.91em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathrm">x</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">u</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>计算观测瞬间升交点的经度 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         L 
        
       
      
        L 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></span>：若参考时刻 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          t 
         
         
         
           o 
          
         
           e 
          
         
        
       
      
        t_{o e} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7651em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">oe</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 时升交点赤经为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          Ω 
         
         
         
           t 
          
          
          
            o 
           
          
            e 
           
          
         
        
       
      
        \Omega_{t_{o e}} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.9334em; vertical-align: -0.2501em;"></span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1645em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">oe</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span></span></span></span></span> ，升交点对时间的变化率为 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          Ω 
         
        
          ˙ 
         
        
       
      
        \dot{\Omega} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.9202em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9202em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord">Ω</span></span><span class="" style="top: -3.2523em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1389em;"><span class="mord">˙</span></span></span></span></span></span></span></span></span></span></span><br> （从广播星历的摄动参数中给出），则观测瞬间暏升交点赤经为:<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          Ω 
         
        
          = 
         
         
         
           Ω 
          
          
          
            t 
           
           
           
             o 
            
           
             e 
            
           
          
         
        
          + 
         
         
         
           Ω 
          
         
           ˙ 
          
         
         
         
           ( 
          
         
           t 
          
         
           − 
          
          
          
            t 
           
           
           
             o 
            
           
             e 
            
           
          
         
           ) 
          
         
        
       
         \Omega=\Omega_{t_{o e}}+\dot{\Omega}\left(t-t_{o e}\right) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord">Ω</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.9334em; vertical-align: -0.2501em;"></span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1645em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">oe</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.1702em; vertical-align: -0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9202em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord">Ω</span></span><span class="" style="top: -3.2523em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1389em;"><span class="mord">˙</span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">oe</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span></span></span></span></p> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          ω 
         
        
          e 
         
        
       
         = 
        
       
         7.292115 
        
       
         × 
        
       
         1 
        
        
        
          0 
         
        
          ∧ 
         
        
       
         − 
        
       
         5 
        
        
        
          r 
         
        
          a 
         
        
          d 
         
        
       
         / 
        
       
         s 
        
       
      
        \omega_e=7.292115 \times 10^{\wedge}-5 \mathrm{rad} / \mathrm{s} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">7.292115</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8352em; vertical-align: -0.0833em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7519em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∧</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">5</span><span class="mord"><span class="mord mathrm">rad</span></span><span class="mord">/</span><span class="mord mathrm">s</span></span></span></span></span>，为地球自转速度； <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         t 
        
       
      
        \mathrm{t} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathrm">t</span></span></span></span></span> 为周内秒，假设地球自转为完全匀速，则<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
           
            
            
              L 
             
            
              = 
             
            
              Ω 
             
            
              − 
             
            
              G 
             
            
              A 
             
            
              S 
             
            
              T 
             
            
              = 
             
             
             
               Ω 
              
              
              
                t 
               
               
               
                 o 
                
               
                 e 
                
               
              
             
            
              − 
             
            
              G 
             
            
              A 
             
            
              S 
             
             
             
               T 
              
              
              
                w 
               
              
                e 
               
              
                e 
               
              
                k 
               
              
             
            
              + 
             
             
             
               Ω 
              
             
               ˙ 
              
             
             
             
               ( 
              
             
               t 
              
             
               − 
              
              
              
                t 
               
               
               
                 o 
                
               
                 e 
                
               
              
             
               ) 
              
             
            
              − 
             
             
             
               w 
              
             
               e 
              
             
            
              t 
             
            
           
          
         
         
          
           
            
            
              = 
             
             
             
               Ω 
              
             
               0 
              
             
            
              + 
             
             
             
               ( 
              
              
              
                Ω 
               
              
                ˙ 
               
              
             
               − 
              
              
              
                w 
               
              
                e 
               
              
             
               ) 
              
             
            
              t 
             
            
              − 
             
             
             
               Ω 
              
             
               ˙ 
              
             
             
             
               t 
              
              
              
                o 
               
              
                e 
               
              
             
            
           
          
         
        
       
         \begin{gathered} L=\Omega-G A S T=\Omega_{t_{o e}}-G A S T_{w e e k}+\dot{\Omega}\left(t-t_{o e}\right)-w_e t \\ =\Omega_0+\left(\dot{\Omega}-w_e\right) t-\dot{\Omega} t_{o e} \end{gathered} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 3.6802em; vertical-align: -1.5901em;"></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.0901em;"><span class="" style="top: -4.3199em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord">Ω</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">G</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right: 0.1389em;">ST</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1645em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">oe</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">G</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right: 0.0576em;">S</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0269em;">w</span><span class="mord mathnormal mtight">ee</span><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9202em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord">Ω</span></span><span class="" style="top: -3.2523em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1389em;"><span class="mord">˙</span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">oe</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0269em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathnormal">t</span></span></span><span class="" style="top: -2.5099em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9202em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord">Ω</span></span><span class="" style="top: -3.2523em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1389em;"><span class="mord">˙</span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0269em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9202em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord">Ω</span></span><span class="" style="top: -3.2523em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1389em;"><span class="mord">˙</span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">oe</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.5901em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>广播星历中给出的 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          Ω 
         
        
          0 
         
        
       
      
        \Omega_0 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> ， 即与本周开始时刻之差。</p> 
<p>计算卫星在ECEF坐标系中的位置 通过两次旋转求解 <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
           
            
             
             
               ( 
              
              
               
                
                 
                 
                   X 
                  
                 
                
               
               
                
                 
                 
                   Y 
                  
                 
                
               
               
                
                 
                 
                   Z 
                  
                 
                
               
              
             
               ) 
              
             
            
              = 
             
             
             
               R 
              
             
               z 
              
             
            
              ( 
             
            
              − 
             
            
              L 
             
            
              ) 
             
             
             
               R 
              
             
               X 
              
             
            
              ( 
             
            
              − 
             
            
              i 
             
            
              ) 
             
             
             
               ( 
              
              
               
                
                 
                 
                   x 
                  
                 
                
               
               
                
                 
                 
                   y 
                  
                 
                
               
               
                
                 
                 
                   0 
                  
                 
                
               
              
             
               ) 
              
             
            
           
          
         
         
          
           
            
            
              = 
             
             
             
               ( 
              
              
               
                
                 
                  
                  
                    x 
                   
                  
                    cos 
                   
                  
                    ⁡ 
                   
                  
                    L 
                   
                  
                    − 
                   
                  
                    y 
                   
                  
                    cos 
                   
                  
                    ⁡ 
                   
                  
                    i 
                   
                  
                    sin 
                   
                  
                    ⁡ 
                   
                  
                    L 
                   
                  
                 
                
               
               
                
                 
                  
                  
                    x 
                   
                  
                    sin 
                   
                  
                    ⁡ 
                   
                  
                    L 
                   
                  
                    + 
                   
                  
                    y 
                   
                  
                    cos 
                   
                  
                    ⁡ 
                   
                  
                    i 
                   
                  
                    cos 
                   
                  
                    ⁡ 
                   
                  
                    L 
                   
                  
                 
                
               
               
                
                 
                  
                  
                    y 
                   
                  
                    sin 
                   
                  
                    ⁡ 
                   
                  
                    i 
                   
                  
                 
                
               
              
             
               ) 
              
             
            
           
          
         
        
       
         \begin{gathered} \left(\begin{array}{l} X \\ Y \\ Z \end{array}\right)=R_z(-L) R_X(-i)\left(\begin{array}{l} x \\ y \\ 0 \end{array}\right) \\ =\left(\begin{array}{c} x \cos L-y \cos i \sin L \\ x \sin L+y \cos i \cos L \\ y \sin i \end{array}\right) \end{gathered} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 7.8em; vertical-align: -3.65em;"></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.15em;"><span class="" style="top: -6.15em;"><span class="pstrut" style="height: 4.05em;"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span class="" style="width: 0.875em; height: 3.6em;"> 
                      <svg width="0.875em" height="3.600em" viewbox="0 0 875 3600"> 
                       <path d="M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1
c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,
-36,557 l0,84c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,
949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9
c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,
-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189
l0,-92c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,
-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z"></path> 
                      </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">Z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span class="" style="width: 0.875em; height: 3.6em;"> 
                      <svg width="0.875em" height="3.600em" viewbox="0 0 875 3600"> 
                       <path d="M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,
63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5
c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,9
c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664
c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11
c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17
c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558
l0,-144c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,
-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z"></path> 
                      </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0077em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.044em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathnormal">L</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span class="" style="top: -2.55em; margin-left: -0.0077em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0785em;">X</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span class="" style="width: 0.875em; height: 3.6em;"> 
                      <svg width="0.875em" height="3.600em" viewbox="0 0 875 3600"> 
                       <path d="M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1
c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,
-36,557 l0,84c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,
949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9
c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,
-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189
l0,-92c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,
-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z"></path> 
                      </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span class="" style="width: 0.875em; height: 3.6em;"> 
                      <svg width="0.875em" height="3.600em" viewbox="0 0 875 3600"> 
                       <path d="M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,
63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5
c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,9
c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664
c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11
c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17
c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558
l0,-144c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,
-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z"></path> 
                      </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 4.05em;"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span class="" style="width: 0.875em; height: 3.6em;"> 
                      <svg width="0.875em" height="3.600em" viewbox="0 0 875 3600"> 
                       <path d="M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1
c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,
-36,557 l0,84c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,
949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9
c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,
-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189
l0,-92c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,
-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z"></path> 
                      </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">L</span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">L</span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span class="" style="width: 0.875em; height: 3.6em;"> 
                      <svg width="0.875em" height="3.600em" viewbox="0 0 875 3600"> 
                       <path d="M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,
63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5
c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,9
c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664
c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11
c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17
c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558
l0,-144c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,
-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z"></path> 
                      </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.65em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>最后，计算卫星钟差： <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
           
            
            
              Δ 
             
            
              t 
             
            
              = 
             
            
              T 
             
            
              s 
             
            
              v 
             
            
              − 
             
            
              t 
             
            
              o 
             
            
              c 
             
            
           
          
         
         
          
           
            
            
              d 
             
            
              t 
             
            
              r 
             
            
              = 
             
            
              F 
             
            
              ⋅ 
             
            
              e 
             
            
              ⋅ 
             
            
              s 
             
            
              q 
             
            
              r 
             
            
              t 
             
            
              A 
             
            
              ⋅ 
             
            
              sin 
             
            
              ⁡ 
             
            
              E 
             
            
           
          
         
         
          
           
            
            
              sat_Clk_error 
             
            
              = 
             
            
              a 
             
             
             
               f 
              
             
               2 
              
             
            
              ⋅ 
             
            
              Δ 
             
             
             
               t 
              
             
               2 
              
             
            
              + 
             
            
              a 
             
             
             
               f 
              
             
               1 
              
             
            
              ⋅ 
             
            
              Δ 
             
            
              t 
             
            
              + 
             
            
              a 
             
             
             
               f 
              
             
               0 
              
             
            
              + 
             
            
              d 
             
            
              t 
             
            
              r 
             
            
           
          
         
        
       
         \begin{gathered} \Delta t=T s v-t o c \\ d t r=F \cdot e \cdot s q r t A \cdot \sin E \\ \text {sat\_Clk\_error}=a f_2 \cdot \Delta t^2+a f_1 \cdot \Delta t+af_0+d t r \end{gathered} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 4.5241em; vertical-align: -2.0121em;"></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.5121em;"><span class="" style="top: -4.6721em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">Δ</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right: 0.0359em;">v</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">oc</span></span></span><span class="" style="top: -3.1721em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">F</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right: 0.0359em;">q</span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span><span class="mord mathnormal">t</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0576em;">E</span></span></span><span class="" style="top: -1.6479em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">sat_Clk_error</span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.1076em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.1076em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">Δ</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.1076em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.0121em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<h4><a id="_140"></a>北斗卫星位置解算</h4> 
<p>对于北斗卫星的位置解算，流程与GPS大致相同。但是，值得注意的时，北斗卫星的时间要比GPS时间快14秒，由于在NAV文件中时间基准为GPS，所以这一个时间偏移在北斗卫星位置计算中非常重要。因此，需要在计算<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          t 
         
        
          k 
         
        
       
      
        t_k 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7651em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>时，额外减去14秒的偏移，即<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          t 
         
        
          k 
         
        
          = 
         
        
          T 
         
        
          s 
         
        
          v 
         
        
          − 
         
        
          t 
         
        
          o 
         
        
          e 
         
        
          − 
         
        
          14 
         
        
       
         t k=T s v-t o e - 14 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right: 0.0359em;">v</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6984em; vertical-align: -0.0833em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">oe</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">14</span></span></span></span></span></span><br> 另外，与GPS不同的是，北斗卫星分为MEO/IGSO卫星和GEO卫星，其中MEO/IGSO卫星的计算与GPS卫星相同，但是GEO卫星的位置需要额外的变换[@b3]。GEO卫星的计算过程如下</p> 
<p>首先进行所需参数计算 <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
           
            
           
          
          
           
            
             
            
              f 
             
            
              = 
             
             
              
              
                − 
               
              
                5 
               
              
             
               180 
              
             
            
              π 
             
            
           
          
         
         
          
           
            
           
          
          
           
            
             
            
              p 
             
            
              = 
             
             
             
               Ω 
              
             
               ˙ 
              
             
            
              ⋅ 
             
            
              t 
             
            
              k 
             
            
           
          
         
        
       
         \begin{aligned} &amp; f=\frac{-5}{180} \pi \\ &amp; p= \dot \Omega \cdot t k \\ \end{aligned} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 3.8876em; vertical-align: -1.6938em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.1938em;"><span class="" style="top: -4.1938em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"></span></span><span class="" style="top: -2.2876em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.6938em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.1938em;"><span class="" style="top: -4.1938em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">180</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right: 0.0359em;">π</span></span></span><span class="" style="top: -2.2876em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9202em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord">Ω</span></span><span class="" style="top: -3.2523em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1389em;"><span class="mord">˙</span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.6938em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>然后对MEO/IGSO卫星的计算结果进行旋转变换： <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
           
            
           
          
          
           
            
             
            
              R 
             
            
              x 
             
            
              = 
             
             
             
               [ 
              
              
               
                
                 
                 
                   1 
                  
                 
                
                
                 
                 
                   0 
                  
                 
                
                
                 
                 
                   0 
                  
                 
                
               
               
                
                 
                 
                   0 
                  
                 
                
                
                 
                  
                  
                    cos 
                   
                  
                    ⁡ 
                   
                  
                    f 
                   
                  
                 
                
                
                 
                  
                  
                    sin 
                   
                  
                    ⁡ 
                   
                  
                    f 
                   
                  
                 
                
               
               
                
                 
                 
                   0 
                  
                 
                
                
                 
                  
                  
                    − 
                   
                  
                    sin 
                   
                  
                    ⁡ 
                   
                  
                    f 
                   
                  
                 
                
                
                 
                  
                  
                    cos 
                   
                  
                    ⁡ 
                   
                  
                    f 
                   
                  
                 
                
               
              
             
               ] 
              
             
            
           
          
         
         
          
           
            
           
          
          
           
            
             
            
              R 
             
            
              z 
             
            
              = 
             
             
             
               [ 
              
              
               
                
                 
                  
                  
                    cos 
                   
                  
                    ⁡ 
                   
                  
                    p 
                   
                  
                 
                
                
                 
                  
                  
                    sin 
                   
                  
                    ⁡ 
                   
                  
                    p 
                   
                  
                 
                
                
                 
                 
                   0 
                  
                 
                
               
               
                
                 
                  
                  
                    − 
                   
                  
                    sin 
                   
                  
                    ⁡ 
                   
                  
                    p 
                   
                  
                 
                
                
                 
                  
                  
                    cos 
                   
                  
                    ⁡ 
                   
                  
                    p 
                   
                  
                 
                
                
                 
                 
                   0 
                  
                 
                
               
               
                
                 
                 
                   0 
                  
                 
                
                
                 
                 
                   0 
                  
                 
                
                
                 
                 
                   1 
                  
                 
                
               
              
             
               ] 
              
             
            
           
          
         
         
          
           
            
           
          
          
           
            
             
             
              
              
                [ 
               
               
                
                 
                  
                   
                   
                     G 
                    
                   
                     E 
                    
                   
                     O 
                    
                   
                     X 
                    
                   
                  
                 
                
                
                 
                  
                   
                   
                     G 
                    
                   
                     E 
                    
                   
                     O 
                    
                   
                     Y 
                    
                   
                  
                 
                
                
                 
                  
                   
                   
                     G 
                    
                   
                     E 
                    
                   
                     O 
                    
                   
                     Z 
                    
                   
                  
                 
                
               
              
                ] 
               
              
             
               = 
              
             
               R 
              
             
               z 
              
             
               ⋅ 
              
             
               R 
              
             
               x 
              
             
               ⋅ 
              
              
              
                [ 
               
               
                
                 
                  
                  
                    X 
                   
                  
                 
                
                
                 
                  
                  
                    Y 
                   
                  
                 
                
                
                 
                  
                  
                    Z 
                   
                  
                 
                
               
              
                ] 
               
              
             
            
           
          
         
        
       
         \begin{aligned} &amp; R x=\left[\begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; \cos f &amp; \sin f \\ 0 &amp; -\sin f &amp; \cos f \end{array}\right] \\ &amp; R z=\left[\begin{array}{ccc} \cos p &amp; \sin p &amp; 0 \\ -\sin p &amp; \cos p &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{array}\right] \\ &amp; {\left[\begin{array}{l} \mathrm{GEOX} \\ \mathrm{GEOY} \\ \mathrm{GEOZ} \end{array}\right]=R z \cdot R x \cdot\left[\begin{array}{l} X \\ Y \\ Z \end{array}\right]} \end{aligned} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 11.7001em; vertical-align: -5.6em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.1em;"><span class="" style="top: -8.1em;"><span class="pstrut" style="height: 4.05em;"></span><span class="mord"></span></span><span class="" style="top: -4.2em;"><span class="pstrut" style="height: 4.05em;"></span><span class="mord"></span></span><span class="" style="top: -0.3em;"><span class="pstrut" style="height: 4.05em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.6em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.1em;"><span class="" style="top: -8.1em;"><span class="pstrut" style="height: 4.05em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span class="" style="width: 0.667em; height: 3.6em;"> 
                      <svg width="0.667em" height="3.600em" viewbox="0 0 667 3600"> 
                       <path d="M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v0 v1759 h84z"></path> 
                      </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop">cos</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">−</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop">sin</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop">cos</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span class="" style="width: 0.667em; height: 3.6em;"> 
                      <svg width="0.667em" height="3.600em" viewbox="0 0 667 3600"> 
                       <path d="M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v0 v1759 h84z"></path> 
                      </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -4.2em;"><span class="pstrut" style="height: 4.05em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span class="" style="width: 0.667em; height: 3.6em;"> 
                      <svg width="0.667em" height="3.600em" viewbox="0 0 667 3600"> 
                       <path d="M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v0 v1759 h84z"></path> 
                      </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop">cos</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">p</span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">−</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">p</span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop">sin</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">p</span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop">cos</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">p</span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span class="" style="width: 0.667em; height: 3.6em;"> 
                      <svg width="0.667em" height="3.600em" viewbox="0 0 667 3600"> 
                       <path d="M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v0 v1759 h84z"></path> 
                      </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -0.3em;"><span class="pstrut" style="height: 4.05em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span class="" style="width: 0.667em; height: 3.6em;"> 
                       <svg width="0.667em" height="3.600em" viewbox="0 0 667 3600"> 
                        <path d="M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v0 v1759 h84z"></path> 
                       </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">GEOX</span></span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathrm" style="margin-right: 0.025em;">GEOY</span></span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">GEOZ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span class="" style="width: 0.667em; height: 3.6em;"> 
                       <svg width="0.667em" height="3.600em" viewbox="0 0 667 3600"> 
                        <path d="M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v0 v1759 h84z"></path> 
                       </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span class="" style="width: 0.667em; height: 3.6em;"> 
                       <svg width="0.667em" height="3.600em" viewbox="0 0 667 3600"> 
                        <path d="M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v0 v1759 h84z"></path> 
                       </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">Z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span class="" style="width: 0.667em; height: 3.6em;"> 
                       <svg width="0.667em" height="3.600em" viewbox="0 0 667 3600"> 
                        <path d="M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v0 v1759 h84z"></path> 
                       </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.6em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<h3><a id="_173"></a>伪距观测与误差建模</h3> 
<p>SPP算法核心就是伪距的观测方程与误差建模，接下来介绍SPP最小问题的构建和相关不确定值得计算。</p> 
<h4><a id="_177"></a>最小二乘问题构建</h4> 
<p>首先，我们需要对伪距观测进行建模，单点伪距得观测如下：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
           
            
             
             
               ρ 
              
             
               ~ 
              
             
            
              = 
             
             
              
               
                
                
                  ( 
                 
                 
                 
                   X 
                  
                 
                   S 
                  
                 
                
                  − 
                 
                
                  X 
                 
                
                  ) 
                 
                
               
                 2 
                
               
              
                + 
               
               
                
                
                  ( 
                 
                 
                 
                   Y 
                  
                 
                   S 
                  
                 
                
                  − 
                 
                
                  Y 
                 
                
                  ) 
                 
                
               
                 2 
                
               
              
                + 
               
               
                
                
                  ( 
                 
                 
                 
                   Y 
                  
                 
                   S 
                  
                 
                
                  − 
                 
                
                  Y 
                 
                
                  ) 
                 
                
               
                 2 
                
               
              
             
            
           
          
         
         
          
           
            
            
              + 
             
            
              C 
             
            
              ⋅ 
             
            
              d 
             
            
              t 
             
            
              − 
             
            
              C 
             
            
              ⋅ 
             
            
              d 
             
            
              T 
             
            
              + 
             
             
             
               δ 
              
              
              
                a 
               
              
                t 
               
              
                m 
               
              
                o 
               
              
                s 
               
              
             
            
           
          
         
        
       
         \begin{gathered} \tilde{\rho}=\sqrt{\left(X^S-X\right)^2+\left(Y^S-Y\right)^2+\left(Y^S-Y\right)^2} \\ +C \cdot d t-C \cdot d T+\delta_{a t m o s} \end{gathered} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 3.64em; vertical-align: -1.57em;"></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.07em;"><span class="" style="top: -4.07em;"><span class="pstrut" style="height: 3.3945em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6679em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal">ρ</span></span><span class="" style="top: -3.35em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1667em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3945em;"><span class="svg-align" style="top: -3.8em;"><span class="pstrut" style="height: 3.8em;"></span><span class="mord" style="padding-left: 1em;"><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7673em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0576em;">S</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9713em;"><span class="" style="top: -3.2202em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7673em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0576em;">S</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9713em;"><span class="" style="top: -3.2202em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7673em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0576em;">S</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9713em;"><span class="" style="top: -3.2202em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.3545em;"><span class="pstrut" style="height: 3.8em;"></span><span class="hide-tail" style="min-width: 1.02em; height: 1.88em;"> 
                    <svg width="400em" height="1.88em" viewbox="0 0 400000 1944" preserveaspectratio="xMinYMin slice"> 
                     <path d="M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z"></path> 
                    </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4455em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -2.4845em;"><span class="pstrut" style="height: 3.3945em;"></span><span class="mord"><span class="mord">+</span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0379em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.0379em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">os</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.57em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span><br> 其中，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          ρ 
         
        
          ~ 
         
        
       
      
        \tilde{\rho} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8623em; vertical-align: -0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6679em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal">ρ</span></span><span class="" style="top: -3.35em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1667em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span></span></span></span></span>为伪距观测值，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ( 
        
        
        
          X 
         
        
          S 
         
        
       
         , 
        
        
        
          Y 
         
        
          S 
         
        
       
         , 
        
        
        
          Z 
         
        
          S 
         
        
       
         ) 
        
       
      
        \left(X^S, Y^S, Z^S\right) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.2em; vertical-align: -0.35em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8413em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0576em;">S</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8413em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0576em;">S</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8413em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0576em;">S</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></span>为卫星位置，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ( 
        
       
         X 
        
       
         , 
        
       
         Y 
        
       
         , 
        
       
         Z 
        
       
         ) 
        
       
      
        (X, Y, Z) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">Z</span><span class="mclose">)</span></span></span></span></span>为需要估计得测站坐标，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         d 
        
       
         t 
        
       
      
        d t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span></span></span></span></span>为接收机钟差，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         d 
        
       
         T 
        
       
      
        d T 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span></span></span></span></span>为卫星钟差，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          δ 
         
        
          atmos  
         
        
       
      
        \delta_{\text {atmos }} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0379em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.0379em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">atmos </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span><br> 为大气引起的误差。</p> 
<p>接下来使用泰勒公式对伪距观测进行线性化。首先我们定义：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           R 
          
         
           0 
          
         
        
          = 
         
         
          
           
            
            
              ( 
             
             
             
               X 
              
             
               S 
              
             
            
              − 
             
             
             
               X 
              
             
               0 
              
             
            
              ) 
             
            
           
             2 
            
           
          
            + 
           
           
            
            
              ( 
             
             
             
               Y 
              
             
               S 
              
             
            
              − 
             
             
             
               Y 
              
             
               0 
              
             
            
              ) 
             
            
           
             2 
            
           
          
            + 
           
           
            
            
              ( 
             
             
             
               Z 
              
             
               S 
              
             
            
              − 
             
             
             
               Z 
              
             
               0 
              
             
            
              ) 
             
            
           
             2 
            
           
          
         
        
       
         R_0= \sqrt{\left(X^S-X_0\right)^2+\left(Y^S-Y_0\right)^2+\left(Z^S-Z_0\right)^2} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0077em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.84em; vertical-align: -0.4455em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3945em;"><span class="svg-align" style="top: -3.8em;"><span class="pstrut" style="height: 3.8em;"></span><span class="mord" style="padding-left: 1em;"><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7673em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0576em;">S</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9713em;"><span class="" style="top: -3.2202em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7673em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0576em;">S</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.2222em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9713em;"><span class="" style="top: -3.2202em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7673em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0576em;">S</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9713em;"><span class="" style="top: -3.2202em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.3545em;"><span class="pstrut" style="height: 3.8em;"></span><span class="hide-tail" style="min-width: 1.02em; height: 1.88em;"> 
            <svg width="400em" height="1.88em" viewbox="0 0 400000 1944" preserveaspectratio="xMinYMin slice"> 
             <path d="M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z"></path> 
            </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4455em;"><span class=""></span></span></span></span></span></span></span></span></span></span><br> 接着，若不计大气误差，我们在初始值点对伪距观测进行近似：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
           
            
             
             
               ρ 
              
             
               ~ 
              
             
            
              ≈ 
             
             
              
               
                
                
                  ( 
                 
                 
                 
                   X 
                  
                 
                   S 
                  
                 
                
                  − 
                 
                 
                 
                   X 
                  
                 
                   0 
                  
                 
                
                  ) 
                 
                
               
                 2 
                
               
              
                + 
               
               
                
                
                  ( 
                 
                 
                 
                   Y 
                  
                 
                   S 
                  
                 
                
                  − 
                 
                 
                 
                   Y 
                  
                 
                   0 
                  
                 
                
                  ) 
                 
                
               
                 2 
                
               
              
                + 
               
               
                
                
                  ( 
                 
                 
                 
                   Z 
                  
                 
                   S 
                  
                 
                
                  − 
                 
                 
                 
                   Z 
                  
                 
                   0 
                  
                 
                
                  ) 
                 
                
               
                 2 
                
               
              
             
            
              + 
             
            
              C 
             
            
              d 
             
             
             
               t 
              
             
               0 
              
             
            
           
          
         
         
          
           
            
            
              + 
             
             
              
               
                
                
                  ∂ 
                 
                 
                 
                   ρ 
                  
                 
                   ~ 
                  
                 
                
                
                
                  ∂ 
                 
                
                  X 
                 
                
               
              
                ∣ 
               
              
              
              
                X 
               
              
                0 
               
              
             
            
              Δ 
             
            
              X 
             
            
              + 
             
             
              
               
                
                
                  ∂ 
                 
                 
                 
                   ρ 
                  
                 
                   ~ 
                  
                 
                
                
                
                  ∂ 
                 
                
                  Y 
                 
                
               
              
                ∣ 
               
              
              
              
                Y 
               
              
                0 
               
              
             
            
              Δ 
             
            
              Y 
             
            
              + 
             
             
              
               
                
                
                  ∂ 
                 
                 
                 
                   ρ 
                  
                 
                   ~ 
                  
                 
                
                
                
                  ∂ 
                 
                
                  Z 
                 
                
               
              
                ∣ 
               
              
              
              
                Z 
               
              
                0 
               
              
             
            
              Δ 
             
            
              Z 
             
            
              + 
             
             
              
              
                ∂ 
               
               
               
                 ρ 
                
               
                 ~ 
                
               
              
              
              
                ∂ 
               
              
                ( 
               
              
                C 
               
              
                d 
               
              
                t 
               
              
                ) 
               
              
             
            
              Δ 
             
            
              ( 
             
            
              C 
             
            
              d 
             
            
              t 
             
            
              ) 
             
            
           
          
         
        
       
         \begin{gathered} \tilde{\rho} \approx \sqrt{\left(X^S-X_0\right)^2+\left(Y^S-Y_0\right)^2+\left(Z^S-Z_0\right)^2}+C d t_0 \\ +\left.\frac{\partial \tilde{\rho}}{\partial X}\right|_{X_0} \Delta X+\left.\frac{\partial \tilde{\rho}}{\partial Y}\right|_{Y_0} \Delta Y+\left.\frac{\partial \tilde{\rho}}{\partial Z}\right|_{Z_0} \Delta Z+\frac{\partial \tilde{\rho}}{\partial(C d t)} \Delta(C d t) \end{gathered} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 4.9898em; vertical-align: -2.2449em;"></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.7449em;"><span class="" style="top: -4.8003em;"><span class="pstrut" style="height: 3.45em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6679em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal">ρ</span></span><span class="" style="top: -3.35em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1667em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3945em;"><span class="svg-align" style="top: -3.8em;"><span class="pstrut" style="height: 3.8em;"></span><span class="mord" style="padding-left: 1em;"><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7673em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0576em;">S</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9713em;"><span class="" style="top: -3.2202em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7673em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0576em;">S</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.2222em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9713em;"><span class="" style="top: -3.2202em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7673em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0576em;">S</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9713em;"><span class="" style="top: -3.2202em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.3545em;"><span class="pstrut" style="height: 3.8em;"></span><span class="hide-tail" style="min-width: 1.02em; height: 1.88em;"> 
                    <svg width="400em" height="1.88em" viewbox="0 0 400000 1944" preserveaspectratio="xMinYMin slice"> 
                     <path d="M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z"></path> 
                    </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4455em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -2.6049em;"><span class="pstrut" style="height: 3.45em;"></span><span class="mord"><span class="mord">+</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3714em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.0556em;">∂</span><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.0556em;">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6679em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal">ρ</span></span><span class="" style="top: -3.35em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1667em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.45em;"><span class="" style="top: -3.45em;"><span class="pstrut" style="height: 4.4em;"></span><span class="" style="width: 0.333em; height: 2.4em;"> 
                       <svg width="0.333em" height="2.400em" viewbox="0 0 333 2400"> 
                        <path d="M145 15 v585 v1200 v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v-1200 v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1200 v585 h43z"></path> 
                       </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.95em;"><span class=""></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"><span class="" style="top: -1.7003em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: -0.0785em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.0998em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="minner"><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3714em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.0556em;">∂</span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.0556em;">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6679em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal">ρ</span></span><span class="" style="top: -3.35em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1667em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.45em;"><span class="" style="top: -3.45em;"><span class="pstrut" style="height: 4.4em;"></span><span class="" style="width: 0.333em; height: 2.4em;"> 
                       <svg width="0.333em" height="2.400em" viewbox="0 0 333 2400"> 
                        <path d="M145 15 v585 v1200 v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v-1200 v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1200 v585 h43z"></path> 
                       </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.95em;"><span class=""></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"><span class="" style="top: -1.7003em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.2222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: -0.2222em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.0998em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="minner"><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3714em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.0556em;">∂</span><span class="mord mathnormal" style="margin-right: 0.0715em;">Z</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.0556em;">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6679em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal">ρ</span></span><span class="" style="top: -3.35em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1667em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.45em;"><span class="" style="top: -3.45em;"><span class="pstrut" style="height: 4.4em;"></span><span class="" style="width: 0.333em; height: 2.4em;"> 
                       <svg width="0.333em" height="2.400em" viewbox="0 0 333 2400"> 
                        <path d="M145 15 v585 v1200 v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v-1200 v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1200 v585 h43z"></path> 
                       </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.95em;"><span class=""></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"><span class="" style="top: -1.7003em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0715em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: -0.0715em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.0998em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.0715em;">Z</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3714em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.0556em;">∂</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.0556em;">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6679em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal">ρ</span></span><span class="" style="top: -3.35em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1667em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">Δ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.2449em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span> 对于每个变量的偏导数，我们记为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          l 
         
        
          = 
         
        
          − 
         
         
          
           
           
             X 
            
           
             S 
            
           
          
            − 
           
           
           
             X 
            
           
             0 
            
           
          
          
          
            R 
           
          
            0 
           
          
         
         
        
          m 
         
        
          = 
         
        
          − 
         
         
          
           
           
             Y 
            
           
             S 
            
           
          
            − 
           
           
           
             Y 
            
           
             0 
            
           
          
          
          
            R 
           
          
            0 
           
          
         
         
        
          n 
         
        
          = 
         
        
          − 
         
         
          
           
           
             Z 
            
           
             S 
            
           
          
            − 
           
           
           
             Z 
            
           
             0 
            
           
          
          
          
            R 
           
          
            0 
           
          
         
        
       
         l=-\frac{X^S-X_0}{R_0} \quad m=-\frac{Y^S-Y_0}{R_0} \quad n=-\frac{Z^S-Z_0}{R_0} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.3543em; vertical-align: -0.836em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.5183em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0077em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8413em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0576em;">S</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.3543em; vertical-align: -0.836em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.5183em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0077em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8413em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0576em;">S</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.2222em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.3543em; vertical-align: -0.836em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.5183em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0077em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8413em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0576em;">S</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span><br> 于是，伪距观测可以表示为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
          
            ρ 
           
          
            ~ 
           
          
         
           n 
          
         
        
          ≈ 
         
         
         
           R 
          
         
           0 
          
         
           n 
          
         
        
          + 
         
        
          C 
         
        
          d 
         
         
         
           t 
          
         
           0 
          
         
        
          + 
         
         
         
           l 
          
         
           n 
          
         
        
          ⋅ 
         
        
          Δ 
         
        
          X 
         
        
          + 
         
         
         
           m 
          
         
           n 
          
         
        
          ⋅ 
         
        
          Δ 
         
        
          Y 
         
        
          + 
         
         
         
           n 
          
         
           n 
          
         
        
          ⋅ 
         
        
          Δ 
         
        
          Z 
         
        
          + 
         
        
          Δ 
         
        
          ( 
         
        
          C 
         
        
          d 
         
        
          t 
         
        
          ) 
         
        
       
         \tilde{\rho}^n \approx R_0^n+C d t_0+l^n \cdot \Delta X+m^n \cdot \Delta Y+n^n \cdot \Delta Z+\Delta(C d t) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.9088em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6679em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal">ρ</span></span><span class="" style="top: -3.35em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1667em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7144em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.9614em; vertical-align: -0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.7144em;"><span class="" style="top: -2.453em; margin-left: -0.0077em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8444em; vertical-align: -0.15em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7144em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7144em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7144em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7144em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7144em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7144em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.0715em;">Z</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">Δ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span></span><br> 记伪距观测的误差为为<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           v 
          
         
           n 
          
         
        
          = 
         
         
         
           R 
          
         
           0 
          
         
         
          
         
           n 
          
         
        
          + 
         
        
          C 
         
        
          d 
         
         
         
           t 
          
         
           0 
          
         
        
          + 
         
         
         
           l 
          
         
           n 
          
         
        
          ⋅ 
         
        
          Δ 
         
        
          X 
         
        
          + 
         
         
         
           m 
          
         
           n 
          
         
        
          ⋅ 
         
        
          Δ 
         
        
          Y 
         
        
          + 
         
         
         
           n 
          
         
           n 
          
         
        
          ⋅ 
         
        
          Δ 
         
        
          Z 
         
        
          + 
         
        
          Δ 
         
        
          ( 
         
        
          C 
         
        
          d 
         
        
          t 
         
        
          ) 
         
        
          − 
         
         
          
          
            ρ 
           
          
            ~ 
           
          
         
           n 
          
         
        
       
         v_n=R_0{ }^n+C d t_0+l^n \cdot \Delta X+m^n \cdot \Delta Y+n^n \cdot \Delta Z+\Delta(C d t)-\tilde{\rho}^n 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8644em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0077em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7144em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8444em; vertical-align: -0.15em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7144em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7144em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7144em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7144em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7144em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7144em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.0715em;">Z</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">Δ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9088em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6679em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal">ρ</span></span><span class="" style="top: -3.35em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1667em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7144em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></span><br> 因此，我们可以构建如下的最小二乘问题： <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
           
            
             
             
               [ 
              
              
               
                
                 
                  
                  
                    v 
                   
                  
                    1 
                   
                  
                 
                
               
               
                
                 
                  
                  
                    v 
                   
                  
                    2 
                   
                  
                 
                
               
               
                
                 
                  
                  
                    ⋮ 
                   
                   
                    
                   
                  
                 
                
               
               
                
                 
                  
                  
                    v 
                   
                  
                    n 
                   
                  
                 
                
               
              
             
               ] 
              
             
            
              = 
             
             
             
               [ 
              
              
               
                
                 
                  
                  
                    l 
                   
                  
                    1 
                   
                  
                 
                
                
                 
                  
                  
                    m 
                   
                  
                    1 
                   
                  
                 
                
                
                 
                  
                  
                    n 
                   
                  
                    1 
                   
                  
                 
                
                
                 
                 
                   1 
                  
                 
                
               
               
                
                 
                  
                  
                    l 
                   
                  
                    2 
                   
                  
                 
                
                
                 
                  
                  
                    m 
                   
                  
                    2 
                   
                  
                 
                
                
                 
                  
                  
                    n 
                   
                  
                    2 
                   
                  
                 
                
                
                 
                 
                   1 
                  
                 
                
               
               
                
                 
                  
                 
                
                
                 
                  
                  
                    ⋮ 
                   
                   
                    
                   
                  
                 
                
                
                 
                  
                 
                
                
                 
                  
                 
                
               
               
                
                 
                  
                  
                    l 
                   
                  
                    n 
                   
                  
                 
                
                
                 
                  
                  
                    m 
                   
                  
                    n 
                   
                  
                 
                
                
                 
                  
                  
                    n 
                   
                  
                    n 
                   
                  
                 
                
                
                 
                 
                   1 
                  
                 
                
               
              
             
               ] 
              
             
             
             
               [ 
              
              
               
                
                 
                  
                  
                    Δ 
                   
                  
                    X 
                   
                  
                 
                
               
               
                
                 
                  
                  
                    Δ 
                   
                  
                    Y 
                   
                  
                 
                
               
               
                
                 
                  
                  
                    Δ 
                   
                  
                    Z 
                   
                  
                 
                
               
               
                
                 
                  
                  
                    Δ 
                   
                  
                    ( 
                   
                  
                    C 
                   
                  
                    d 
                   
                  
                    t 
                   
                  
                    ) 
                   
                  
                 
                
               
              
             
               ] 
              
             
            
           
          
         
         
          
           
            
            
              + 
             
             
             
               [ 
              
              
               
                
                 
                  
                   
                   
                     R 
                    
                   
                     0 
                    
                   
                   
                    
                   
                     1 
                    
                   
                  
                    + 
                   
                  
                    C 
                   
                  
                    d 
                   
                   
                   
                     t 
                    
                   
                     0 
                    
                   
                  
                    − 
                   
                   
                    
                    
                      ρ 
                     
                    
                      ~ 
                     
                    
                   
                     1 
                    
                   
                  
                 
                
               
               
                
                 
                  
                   
                   
                     R 
                    
                   
                     0 
                    
                   
                   
                    
                   
                     1 
                    
                   
                  
                    + 
                   
                  
                    C 
                   
                  
                    d 
                   
                   
                   
                     t 
                    
                   
                     0 
                    
                   
                  
                    − 
                   
                   
                    
                    
                      ρ 
                     
                    
                      ~ 
                     
                    
                   
                     1 
                    
                   
                  
                 
                
               
               
                
                 
                  
                  
                    ⋮ 
                   
                   
                    
                   
                  
                 
                
               
               
                
                 
                  
                   
                   
                     R 
                    
                   
                     0 
                    
                   
                   
                    
                   
                     n 
                    
                   
                  
                    + 
                   
                  
                    C 
                   
                  
                    d 
                   
                   
                   
                     t 
                    
                   
                     0 
                    
                   
                  
                    − 
                   
                   
                    
                    
                      ρ 
                     
                    
                      ~ 
                     
                    
                   
                     n 
                    
                   
                  
                 
                
               
              
             
               ] 
              
             
            
           
          
         
        
       
         \begin{gathered} \left[\begin{array}{c} v_1 \\ v_2 \\ \vdots \\ v_n \end{array}\right]=\left[\begin{array}{cccc} l^1 &amp; m^1 &amp; n^1 &amp; 1 \\ l^2 &amp; m^2 &amp; n^2 &amp; 1 \\ &amp; \vdots &amp; &amp; \\ l^n &amp; m^n &amp; n^n &amp; 1 \end{array}\right]\left[\begin{array}{c} \Delta X \\ \Delta Y \\ \Delta Z \\ \Delta(C d t) \end{array}\right] \\+\left[\begin{array}{c} R_0{ }^1+C d t_0-\tilde{\rho}^1 \\ R_0{ }^1+C d t_0-\tilde{\rho}^1 \\ \vdots \\ R_0{ }^n+C d t_0-\tilde{\rho}^n \end{array}\right] \end{gathered} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 11.52em; vertical-align: -5.51em;"></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.01em;"><span class="" style="top: -8.01em;"><span class="pstrut" style="height: 4.98em;"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 7.4em;"></span><span class="" style="width: 0.667em; height: 5.4em;"> 
                      <svg width="0.667em" height="5.400em" viewbox="0 0 667 5400"> 
                       <path d="M403 1759 V84 H666 V0 H319 V1759 v1800 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v1800 v1759 h84z"></path> 
                      </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.98em;"><span class="" style="top: -5.8275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -4.6275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -2.7675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width: 0em; border-top-width: 1.5em; bottom: 0em;"></span></span></span></span><span class="" style="top: -1.5675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.48em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 7.4em;"></span><span class="" style="width: 0.667em; height: 5.4em;"> 
                      <svg width="0.667em" height="5.400em" viewbox="0 0 667 5400"> 
                       <path d="M347 1759 V0 H0 V84 H263 V1759 v1800 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v1800 v1759 h84z"></path> 
                      </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 7.4em;"></span><span class="" style="width: 0.667em; height: 5.4em;"> 
                      <svg width="0.667em" height="5.400em" viewbox="0 0 667 5400"> 
                       <path d="M403 1759 V84 H666 V0 H319 V1759 v1800 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v1800 v1759 h84z"></path> 
                      </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.98em;"><span class="" style="top: -5.64em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -4.44em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.58em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"></span></span><span class="" style="top: -1.38em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.48em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.98em;"><span class="" style="top: -5.8275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -4.6275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.7675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width: 0em; border-top-width: 1.5em; bottom: 0em;"></span></span></span></span><span class="" style="top: -1.5675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.48em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.98em;"><span class="" style="top: -5.64em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -4.44em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.58em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"></span></span><span class="" style="top: -1.38em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.48em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.98em;"><span class="" style="top: -5.64em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -4.44em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -2.58em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"></span></span><span class="" style="top: -1.38em;"><span class="pstrut" style="height: 3.5em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.48em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 7.4em;"></span><span class="" style="width: 0.667em; height: 5.4em;"> 
                      <svg width="0.667em" height="5.400em" viewbox="0 0 667 5400"> 
                       <path d="M347 1759 V0 H0 V84 H263 V1759 v1800 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v1800 v1759 h84z"></path> 
                      </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -4.65em;"><span class="pstrut" style="height: 6.8em;"></span><span class="" style="width: 0.667em; height: 4.8em;"> 
                      <svg width="0.667em" height="4.800em" viewbox="0 0 667 4800"> 
                       <path d="M403 1759 V84 H666 V0 H319 V1759 v1200 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v1200 v1759 h84z"></path> 
                      </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -4.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span></span></span><span class="" style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right: 0.0715em;">Z</span></span></span><span class="" style="top: -1.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">Δ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -4.65em;"><span class="pstrut" style="height: 6.8em;"></span><span class="" style="width: 0.667em; height: 4.8em;"> 
                      <svg width="0.667em" height="4.800em" viewbox="0 0 667 4800"> 
                       <path d="M347 1759 V0 H0 V84 H263 V1759 v1200 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v1200 v1759 h84z"></path> 
                      </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 4.98em;"></span><span class="mord"><span class="mord">+</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 7.4em;"></span><span class="" style="width: 0.667em; height: 5.4em;"> 
                      <svg width="0.667em" height="5.400em" viewbox="0 0 667 5400"> 
                       <path d="M403 1759 V84 H666 V0 H319 V1759 v1800 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v1800 v1759 h84z"></path> 
                      </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.98em;"><span class="" style="top: -5.8275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0077em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6679em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal">ρ</span></span><span class="" style="top: -3.35em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1667em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -4.6275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0077em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6679em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal">ρ</span></span><span class="" style="top: -3.35em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1667em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.7675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width: 0em; border-top-width: 1.5em; bottom: 0em;"></span></span></span></span><span class="" style="top: -1.5675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0077em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6679em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal">ρ</span></span><span class="" style="top: -3.35em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1667em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.48em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 7.4em;"></span><span class="" style="width: 0.667em; height: 5.4em;"> 
                      <svg width="0.667em" height="5.400em" viewbox="0 0 667 5400"> 
                       <path d="M347 1759 V0 H0 V84 H263 V1759 v1800 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v1800 v1759 h84z"></path> 
                      </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.51em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span> 可记为 <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          V 
         
        
          = 
         
        
          H 
         
        
          X 
         
        
          + 
         
        
          B 
         
        
       
         \mathbf{V=HX+B} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7694em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord mathbf" style="margin-right: 0.016em;">V</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord mathbf">HX</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathbf">B</span></span></span></span></span></span></span><br> 最后只需要使用非线性最小二乘法对该问题迭代求解即可。</p> 
<h4><a id="HDOP_223"></a>HDOP值计算</h4> 
<p>在SPP中，为了评估解算不确定度，定义了精度因子指标。其中，水平精度因子HDOP反映了SPP在水平X,Y方向的估计定位精度。HDOP的计算与最小二乘的迭代方差有关，定义：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          G 
         
        
          = 
         
         
          
          
            ( 
           
           
           
             H 
            
           
             T 
            
           
          
            H 
           
          
            ) 
           
          
          
          
            − 
           
          
            1 
           
          
         
        
          = 
         
         
         
           [ 
          
          
           
            
             
              
              
                G 
               
               
               
                 x 
                
               
                 x 
                
               
              
             
            
            
             
              
              
                G 
               
               
               
                 x 
                
               
                 y 
                
               
              
             
            
            
             
              
              
                G 
               
               
               
                 x 
                
               
                 z 
                
               
              
             
            
           
           
            
             
              
              
                G 
               
               
               
                 y 
                
               
                 x 
                
               
              
             
            
            
             
              
              
                G 
               
               
               
                 y 
                
               
                 y 
                
               
              
             
            
            
             
              
              
                G 
               
               
               
                 y 
                
               
                 z 
                
               
              
             
            
           
           
            
             
              
              
                G 
               
               
               
                 z 
                
               
                 x 
                
               
              
             
            
            
             
              
              
                G 
               
               
               
                 z 
                
               
                 y 
                
               
              
             
            
            
             
              
              
                G 
               
               
               
                 z 
                
               
                 z 
                
               
              
             
            
           
          
         
           ] 
          
         
        
       
         \mathbf{G}=\left(\mathbf{H}^T \mathbf{H}\right)^{-1}=\left[\begin{array}{lll} G_{x x} &amp; G_{x y} &amp; G_{x z} \\ G_{y x} &amp; G_{y y} &amp; G_{y z} \\ G_{z x} &amp; G_{z y} &amp; G_{z z} \end{array}\right] 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf">G</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.4453em; vertical-align: -0.35em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathbf">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8913em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.1389em;">T</span></span></span></span></span></span></span></span><span class="mord mathbf">H</span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.0953em;"><span class="" style="top: -3.3442em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3.6em; vertical-align: -1.55em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span class="" style="width: 0.667em; height: 3.6em;"> 
              <svg width="0.667em" height="3.600em" viewbox="0 0 667 3600"> 
               <path d="M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v0 v1759 h84z"></path> 
              </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">xx</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">y</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.044em;">z</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">yy</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">zy</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight" style="margin-right: 0.044em;">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.044em;">yz</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.044em;">zz</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 5.6em;"></span><span class="" style="width: 0.667em; height: 3.6em;"> 
              <svg width="0.667em" height="3.600em" viewbox="0 0 667 3600"> 
               <path d="M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v0 v1759 h84z"></path> 
              </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         G 
        
       
      
        \mathbf{G} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf">G</span></span></span></span></span>实际上就表示了最小二乘迭代最后结果的方差，HDOP的定义为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           H 
          
         
           D 
          
         
           O 
          
         
           P 
          
         
        
          = 
         
         
          
           
           
             G 
            
            
            
              x 
             
            
              x 
             
            
           
          
            + 
           
           
           
             G 
            
            
            
              y 
             
            
              y 
             
            
           
          
         
        
       
         \mathrm{HDOP}=\sqrt{G_{x x}+G_{y y}} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord"><span class="mord mathrm">HDOP</span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.24em; vertical-align: -0.3075em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.9325em;"><span class="svg-align" style="top: -3.2em;"><span class="pstrut" style="height: 3.2em;"></span><span class="mord" style="padding-left: 1em;"><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">xx</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">yy</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -2.8925em;"><span class="pstrut" style="height: 3.2em;"></span><span class="hide-tail" style="min-width: 1.02em; height: 1.28em;"> 
            <svg width="400em" height="1.28em" viewbox="0 0 400000 1296" preserveaspectratio="xMinYMin slice"> 
             <path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z"></path> 
            </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3075em;"><span class=""></span></span></span></span></span></span></span></span></span></span> HDOP值的范围在[0.5, 99]之间，HDOP值越小，代表定位估计精度越高。</p> 
<h2><a id="Implementation_Details_234"></a>Implementation Details</h2> 
<p>本小节介绍了SPP算法的Matlab实现，从RINEX文件读取，最小二乘问题构建以及求解结果输出介绍了SPP的实现细节。</p> 
<h3><a id="RINEX_238"></a>RINEX文件读取</h3> 
<p>首先，对NAV文件读取需要跳过Header部分，并寻找所需卫星系统的广播星历，读取相应轨道参数，将卫星编号和摄动参数对应存储。读取NAV文件的核心代码如下：</p> 
<pre><code class="prism language-matlab">    <span class="token keyword">while</span> <span class="token operator">~</span><span class="token function">feof</span><span class="token punctuation">(</span>fileID<span class="token punctuation">)</span>
        line <span class="token operator">=</span> <span class="token function">fgets</span><span class="token punctuation">(</span>fileID<span class="token punctuation">)</span><span class="token punctuation">;</span>
        line_cnt <span class="token operator">=</span> line_cnt <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> line_cnt <span class="token operator">&gt;</span> <span class="token number">5</span>
            <span class="token keyword">if</span> <span class="token function">contains</span><span class="token punctuation">(</span>line<span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">)</span>  <span class="token comment">% C for BDS and G for GPS</span>
                readstate <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token function">index_buf</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">str2double</span><span class="token punctuation">(</span><span class="token function">line</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                tmp_data <span class="token operator">=</span> <span class="token function">str2num</span><span class="token punctuation">(</span><span class="token function">line</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>
            <span class="token keyword">if</span> readstate <span class="token operator">==</span> <span class="token number">1</span>
               eph_cnt <span class="token operator">=</span> eph_cnt <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
               tmp_data <span class="token operator">=</span> <span class="token punctuation">[</span>tmp_data <span class="token function">str2num</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
               <span class="token keyword">if</span> eph_cnt <span class="token operator">==</span> <span class="token number">8</span>
                   <span class="token function">eph_buf</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token keyword">end</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> tmp_data<span class="token punctuation">;</span>
                   readstate <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                   eph_cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
               <span class="token keyword">end</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
</code></pre> 
<p>对应NAV文件读取星历参数的数据结构如图所示。</p> 
<p><img src="https://images2.imgbox.com/11/46/YFJ6MH5V_o.png" alt="NAV数据结构"><br> 其中eph存储了卫星的广播星历参数，index存储了对应卫星的编号，由于所用NAV文件没有电离层参数信息，因此ionprm为空。<br> 对于OBS文件的读取，流程更加复杂。首先，需要从Header部分读取时间、卫星系统以及观测系统的数据格式等信息。接着，需要在数据部分读取对应卫星系统的观测，并且记录卫星编号及其对应epoch。读取OBS文件的核心代码如下所示：</p> 
<pre><code class="prism language-matlab">    <span class="token keyword">while</span> <span class="token operator">~</span><span class="token function">feof</span><span class="token punctuation">(</span>fileID<span class="token punctuation">)</span>
        line <span class="token operator">=</span> <span class="token function">fgets</span><span class="token punctuation">(</span>fileID<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token keyword">if</span> <span class="token function">contains</span><span class="token punctuation">(</span>line<span class="token punctuation">,</span> <span class="token string">'TIME OF FIRST OBS'</span><span class="token punctuation">)</span>
            dateStr <span class="token operator">=</span> <span class="token function">strtrim</span><span class="token punctuation">(</span><span class="token function">line</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token operator">-</span><span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

            date <span class="token operator">=</span> <span class="token function">str2num</span><span class="token punctuation">(</span>dateStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
        <span class="token keyword">if</span> <span class="token function">contains</span><span class="token punctuation">(</span>line<span class="token punctuation">,</span> <span class="token string">'APPROX POSITION XYZ'</span><span class="token punctuation">)</span>
            rcvpos <span class="token operator">=</span> <span class="token function">str2num</span><span class="token punctuation">(</span><span class="token function">line</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token operator">-</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
        <span class="token keyword">if</span> <span class="token function">contains</span><span class="token punctuation">(</span>line<span class="token punctuation">,</span> <span class="token string">'SYS / # / OBS TYPES'</span><span class="token punctuation">)</span>
            sysStr <span class="token operator">=</span> <span class="token function">strtrim</span><span class="token punctuation">(</span><span class="token function">line</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
            numStr <span class="token operator">=</span> <span class="token function">strtrim</span><span class="token punctuation">(</span><span class="token function">line</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            num <span class="token operator">=</span> <span class="token function">str2double</span><span class="token punctuation">(</span>numStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
            typeStr <span class="token operator">=</span> <span class="token function">strtrim</span><span class="token punctuation">(</span><span class="token function">line</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token operator">:</span><span class="token number">7</span><span class="token operator">+</span>num<span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
            cellArray <span class="token operator">=</span> <span class="token function">strsplit</span><span class="token punctuation">(</span>typeStr<span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> sysStr <span class="token operator">==</span> <span class="token string">'C'</span>  <span class="token comment">% C for BDS, G for GPS</span>
                type <span class="token operator">=</span> cellArray<span class="token operator">'</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>
        <span class="token keyword">if</span> <span class="token function">contains</span><span class="token punctuation">(</span>line<span class="token punctuation">,</span> <span class="token string">'&gt;'</span><span class="token punctuation">)</span>
            read_state <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> epoch_cnt <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span>
                epoch_cnt <span class="token operator">=</span> epoch_cnt <span class="token operator">+</span> <span class="token number">1</span>
            <span class="token keyword">else</span>
                epoch_cnt <span class="token operator">=</span> epoch_cnt <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">%v2 30</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>
        <span class="token keyword">if</span> read_state <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">~</span><span class="token function">contains</span><span class="token punctuation">(</span>line<span class="token punctuation">,</span> <span class="token string">'&gt;'</span><span class="token punctuation">)</span>
            sysStr <span class="token operator">=</span> <span class="token function">strtrim</span><span class="token punctuation">(</span><span class="token function">line</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> sysStr <span class="token operator">==</span> <span class="token string">'C'</span> 
                <span class="token function">epoch_buf</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> epoch_cnt<span class="token punctuation">;</span>
                <span class="token function">index_buf</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">str2double</span><span class="token punctuation">(</span><span class="token function">line</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       
                tmp <span class="token operator">=</span> <span class="token function">nan</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                tmp_data <span class="token operator">=</span> <span class="token function">str2num</span><span class="token punctuation">(</span><span class="token function">line</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">tmp</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">length</span><span class="token punctuation">(</span>tmp_data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> tmp_data<span class="token punctuation">;</span>
                <span class="token function">data_buf</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
    epoch <span class="token operator">=</span> epoch_buf<span class="token operator">'</span><span class="token punctuation">;</span>
    index <span class="token operator">=</span> index_buf<span class="token operator">'</span><span class="token punctuation">;</span>
    data <span class="token operator">=</span> data_buf<span class="token punctuation">;</span>
    <span class="token function">fclose</span><span class="token punctuation">(</span>fileID<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">return</span><span class="token punctuation">;</span>
</code></pre> 
<p>对应OBS文件的数据结构如图<br> <img src="https://images2.imgbox.com/ef/a2/rk9v8kzC_o.png" alt="OBS数据结构"></p> 
<p>其中date中包含了观测的时间，epoch包含每个历元所在的观测时间，type中存储了观测种类，station为测站名称，data存储了观测数据，index存储了卫星编号，rcvpos为定位估计位置。</p> 
<h3><a id="_324"></a>卫星位置与钟差解算</h3> 
<p>卫星位置与钟差解算与作业一中类似，但是针对北斗卫星，需要进行特殊处理。例如，对时钟对齐GPS的校正，卫星分类计算。为了简洁，在报告只展示了北斗卫星的位置与钟差解算，解算核心代码如下所示。</p> 
<pre><code class="prism language-matlab">    A <span class="token operator">=</span> roota<span class="token operator">*</span>roota<span class="token punctuation">;</span>
    half_week <span class="token operator">=</span> <span class="token number">302400</span><span class="token punctuation">;</span>
    tk <span class="token operator">=</span> SOW<span class="token operator">-</span>toc<span class="token operator">-</span><span class="token number">14</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> tk <span class="token operator">&gt;</span>  half_week<span class="token punctuation">,</span> tk <span class="token operator">=</span> t<span class="token operator">-</span><span class="token number">604800</span><span class="token punctuation">;</span> <span class="token keyword">end</span>
    <span class="token keyword">if</span> tk <span class="token operator">&lt;</span> <span class="token operator">-</span>half_week<span class="token punctuation">,</span> tk <span class="token operator">=</span> t<span class="token operator">+</span><span class="token number">604800</span><span class="token punctuation">;</span> <span class="token keyword">end</span>
    tcorr <span class="token operator">=</span> <span class="token punctuation">(</span>af2<span class="token operator">*</span>tk <span class="token operator">+</span> af1<span class="token punctuation">)</span><span class="token operator">*</span>tk <span class="token operator">+</span> af0<span class="token punctuation">;</span>
    n0 <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>GM<span class="token operator">/</span>A<span class="token operator">^</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    n <span class="token operator">=</span> n0<span class="token operator">+</span>deltan<span class="token punctuation">;</span>
    M <span class="token operator">=</span> M0<span class="token operator">+</span>n<span class="token operator">*</span>tk<span class="token punctuation">;</span>
    M <span class="token operator">=</span> <span class="token function">rem</span><span class="token punctuation">(</span>M<span class="token operator">+</span><span class="token number">2</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    E <span class="token operator">=</span> M<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token number">i</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span>
       E_old <span class="token operator">=</span> E<span class="token punctuation">;</span>
       sinE<span class="token operator">=</span><span class="token function">sin</span><span class="token punctuation">(</span>E<span class="token punctuation">)</span><span class="token punctuation">;</span>
       E <span class="token operator">=</span> M<span class="token operator">+</span>ecc<span class="token operator">*</span>sinE<span class="token punctuation">;</span>
       dE <span class="token operator">=</span> <span class="token function">rem</span><span class="token punctuation">(</span>E<span class="token operator">-</span>E_old<span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">if</span> <span class="token function">abs</span><span class="token punctuation">(</span>dE<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1.e-12</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
       <span class="token keyword">end</span>
    <span class="token keyword">end</span>
    E <span class="token operator">=</span> <span class="token function">rem</span><span class="token punctuation">(</span>E<span class="token operator">+</span><span class="token number">2</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cosE<span class="token operator">=</span><span class="token function">cos</span><span class="token punctuation">(</span>E<span class="token punctuation">)</span><span class="token punctuation">;</span>

    dtr <span class="token operator">=</span> F <span class="token operator">*</span> ecc <span class="token operator">*</span> roota <span class="token operator">*</span> sinE<span class="token punctuation">;</span>
    v <span class="token operator">=</span> <span class="token function">atan2</span><span class="token punctuation">(</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>ecc<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span>sinE<span class="token punctuation">,</span> cosE<span class="token operator">-</span>ecc<span class="token punctuation">)</span><span class="token punctuation">;</span>
    phi <span class="token operator">=</span> v<span class="token operator">+</span>omega<span class="token punctuation">;</span>
    phi <span class="token operator">=</span> <span class="token function">rem</span><span class="token punctuation">(</span>phi<span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    cos2phi<span class="token operator">=</span><span class="token function">cos</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>phi<span class="token punctuation">)</span><span class="token punctuation">;</span>
    sin2phi<span class="token operator">=</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>phi<span class="token punctuation">)</span><span class="token punctuation">;</span>

    u <span class="token operator">=</span> phi		         <span class="token operator">+</span> cuc<span class="token operator">*</span>cos2phi<span class="token operator">+</span>cus<span class="token operator">*</span>sin2phi<span class="token punctuation">;</span>
    r <span class="token operator">=</span> A<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>ecc<span class="token operator">*</span>cosE<span class="token punctuation">)</span> <span class="token operator">+</span> crc<span class="token operator">*</span>cos2phi<span class="token operator">+</span>crs<span class="token operator">*</span>sin2phi<span class="token punctuation">;</span>
    <span class="token number">i</span> <span class="token operator">=</span> i0<span class="token operator">+</span>idot<span class="token operator">*</span>tk	      <span class="token operator">+</span> cic<span class="token operator">*</span>cos2phi<span class="token operator">+</span>cis<span class="token operator">*</span>sin2phi<span class="token punctuation">;</span>

    x1 <span class="token operator">=</span> <span class="token function">cos</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token operator">*</span>r<span class="token punctuation">;</span>
    y1 <span class="token operator">=</span> <span class="token function">sin</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token operator">*</span>r<span class="token punctuation">;</span>
    <span class="token keyword">if</span> svprn<span class="token operator">&gt;</span><span class="token number">5</span><span class="token comment">%IGSO/MEO</span>
        Omega <span class="token operator">=</span> Omega0<span class="token operator">+</span><span class="token punctuation">(</span>Omegadot<span class="token operator">-</span>Omegae_dot<span class="token punctuation">)</span><span class="token operator">*</span>tk<span class="token operator">-</span>Omegae_dot<span class="token operator">*</span>toe<span class="token punctuation">;</span>
        dOmega <span class="token operator">=</span> Omegadot <span class="token operator">-</span> Omegae_dot<span class="token punctuation">;</span>
         Omega <span class="token operator">=</span> <span class="token function">rem</span><span class="token punctuation">(</span>Omega<span class="token operator">+</span><span class="token number">2</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">satpos</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> x1<span class="token operator">*</span><span class="token function">cos</span><span class="token punctuation">(</span>Omega<span class="token punctuation">)</span><span class="token operator">-</span>y1<span class="token operator">*</span><span class="token function">cos</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>Omega<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">satpos</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> x1<span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>Omega<span class="token punctuation">)</span><span class="token operator">+</span>y1<span class="token operator">*</span><span class="token function">cos</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">cos</span><span class="token punctuation">(</span>Omega<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">satpos</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">=</span> y1<span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
    <span class="token keyword">else</span><span class="token comment">%GEO</span>
        Omega <span class="token operator">=</span> Omega0 <span class="token operator">+</span> <span class="token punctuation">(</span>Omegadot<span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span>tk <span class="token operator">-</span> Omegae_dot<span class="token operator">*</span>toe<span class="token punctuation">;</span>
        dOmega <span class="token operator">=</span> Omegadot<span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token comment">%Reduce to between 0 and 360 deg</span>
        Omega <span class="token operator">=</span> <span class="token function">rem</span><span class="token punctuation">(</span>Omega<span class="token operator">+</span><span class="token number">2</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">% Compute satellite coordinates</span>
        x_gk <span class="token operator">=</span> x1 <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span>Omega<span class="token punctuation">)</span> <span class="token operator">-</span> y1 <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>Omega<span class="token punctuation">)</span><span class="token punctuation">;</span>
        y_gk <span class="token operator">=</span> x1 <span class="token operator">*</span> <span class="token function">sin</span><span class="token punctuation">(</span>Omega<span class="token punctuation">)</span> <span class="token operator">+</span> y1 <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">cos</span><span class="token punctuation">(</span>Omega<span class="token punctuation">)</span><span class="token punctuation">;</span>
        z_gk <span class="token operator">=</span> y1 <span class="token operator">*</span> <span class="token function">sin</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ang0<span class="token operator">=</span><span class="token operator">-</span><span class="token number">5</span><span class="token operator">/</span><span class="token number">180</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token punctuation">;</span>

        Rx<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token number">0</span> <span class="token function">cos</span><span class="token punctuation">(</span>ang0<span class="token punctuation">)</span> <span class="token function">sin</span><span class="token punctuation">(</span>ang0<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token number">0</span> <span class="token operator">-</span><span class="token function">sin</span><span class="token punctuation">(</span>ang0<span class="token punctuation">)</span> <span class="token function">cos</span><span class="token punctuation">(</span>ang0<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        Rz<span class="token operator">=</span><span class="token punctuation">[</span><span class="token function">cos</span><span class="token punctuation">(</span>Omegae_dot<span class="token operator">*</span>tk<span class="token punctuation">)</span> <span class="token function">sin</span><span class="token punctuation">(</span>Omegae_dot<span class="token operator">*</span>tk<span class="token punctuation">)</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token operator">-</span><span class="token function">sin</span><span class="token punctuation">(</span>Omegae_dot<span class="token operator">*</span>tk<span class="token punctuation">)</span> <span class="token function">cos</span><span class="token punctuation">(</span>Omegae_dot<span class="token operator">*</span>tk<span class="token punctuation">)</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        satpos<span class="token operator">=</span>Rz<span class="token operator">*</span>Rx<span class="token operator">*</span><span class="token punctuation">[</span>x_gk<span class="token punctuation">,</span>y_gk<span class="token punctuation">,</span>z_gk<span class="token punctuation">]</span><span class="token operator">'</span><span class="token punctuation">;</span>
        satpos<span class="token operator">=</span>satpos<span class="token operator">'</span><span class="token punctuation">;</span>
            
    <span class="token keyword">end</span>
    satclock<span class="token operator">=</span>tcorr<span class="token operator">+</span>dtr<span class="token operator">-</span>tgd<span class="token punctuation">;</span>
</code></pre> 
<p>首先，对于tk的计算，需要减去14秒以统一至GPS时钟基准，在最后的卫星位置解算时，需要对PRN小于5的IGSO/MEO卫星与PRN大于等于5的GEO卫星进行解算。GPS的计算相对简单，只是北斗卫星位置与钟差计算的一个部分，不需要额外的时间校正与分类计算，在此不再赘述。</p> 
<h3><a id="_399"></a>最小二乘问题构建</h3> 
<p>最小二乘问题的构建需要结合伪距观测，卫星位置以及钟差进行迭代求解。首先，在一个历元中，需要匹配OBS中的卫星编号与NAV文件中的卫星编号，代码如下所示</p> 
<pre><code class="prism language-matlab">        eph_t <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>obs<span class="token punctuation">.</span>epoch <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">% Check time        </span>
        PRN   <span class="token operator">=</span> obs<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span>eph_t<span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">% Check satellite number (PRN)</span>

        <span class="token keyword">if</span> <span class="token function">length</span><span class="token punctuation">(</span>PRN<span class="token punctuation">)</span><span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token keyword">continue</span><span class="token punctuation">;</span><span class="token keyword">end</span>
            
        <span class="token comment">% Second Of Day</span>
        SOD <span class="token operator">=</span> obs<span class="token punctuation">.</span><span class="token function">epoch</span><span class="token punctuation">(</span>eph_t<span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span>obs<span class="token punctuation">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">60</span><span class="token operator">*</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>obs<span class="token punctuation">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token operator">+</span>obs<span class="token punctuation">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">%% 2. Read pseudorange from Observation file</span>
        <span class="token comment">% Pseudorange</span>
        C1 <span class="token operator">=</span> obs<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span>eph_t<span class="token punctuation">,</span><span class="token function">ismember</span><span class="token punctuation">(</span>obs<span class="token punctuation">.</span>type<span class="token punctuation">,</span><span class="token string">'C2I'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        
        <span class="token comment">%% 3. Calculate satellite position and satellite clock bias (For loop#2)</span>
        satpos        <span class="token operator">=</span> <span class="token function">nan</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token function">length</span><span class="token punctuation">(</span>PRN<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        satclock      <span class="token operator">=</span> <span class="token function">nan</span><span class="token punctuation">(</span><span class="token function">length</span><span class="token punctuation">(</span>PRN<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> ii <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token function">length</span><span class="token punctuation">(</span>PRN<span class="token punctuation">)</span>
            <span class="token punctuation">[</span><span class="token function">satpos</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span>ii<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">satclock</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">satpos_xyz_sbias</span><span class="token punctuation">(</span><span class="token function">SOD</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
            <span class="token function">PRN</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">,</span>nav<span class="token punctuation">.</span>eph<span class="token punctuation">,</span>nav<span class="token punctuation">.</span>index<span class="token punctuation">,</span>obs<span class="token punctuation">.</span>date<span class="token punctuation">,</span><span class="token function">C1</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
            
        <span class="token keyword">if</span> <span class="token function">length</span><span class="token punctuation">(</span><span class="token function">satclock</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token function">isnan</span><span class="token punctuation">(</span>satclock<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span><span class="token keyword">continue</span><span class="token punctuation">;</span><span class="token keyword">end</span> <span class="token comment">% Check number of satellite</span>
</code></pre> 
<p>在匹配卫星后，还需要检查卫星数目是否足够，至少需要4颗卫星才能进行位置和接收机钟差解算，如果小于4颗卫星，那么直接跳过这个历元。</p> 
<p>在得到相应观测与卫星位置与钟差后，需要构建设计矩阵，在构建过程中，首先进行仰角15度的卫星进行去除，然后对伪距进行卫星钟差修正。最后构建设计矩阵，迭代求解。核心代码如下所示。</p> 
<pre><code class="prism language-matlab">    <span class="token keyword">while</span> <span class="token function">norm</span><span class="token punctuation">(</span>dx<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">10</span><span class="token operator">^</span><span class="token operator">-</span><span class="token number">4</span> <span class="token comment">% Difference of positioning</span>
        stop <span class="token operator">=</span> stop<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token keyword">if</span> stop<span class="token operator">==</span><span class="token number">30</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">end</span> <span class="token comment">% iterative divergent</span>
        <span class="token comment">% Calculate elevation angle</span>
        <span class="token punctuation">[</span>elev<span class="token punctuation">,</span><span class="token operator">~</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">calelevation</span><span class="token punctuation">(</span>satpos<span class="token punctuation">,</span>xyz0<span class="token punctuation">)</span><span class="token punctuation">;</span>
        userlla  <span class="token operator">=</span> <span class="token function">xyz2lla</span><span class="token punctuation">(</span><span class="token function">xyz0</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">xyz0</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">xyz0</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                       
        <span class="token comment">% Troposheric delay (Tropo model)</span>
        <span class="token punctuation">[</span>d_hyd<span class="token punctuation">,</span>d_wet<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">EstimateTropDalay</span><span class="token punctuation">(</span><span class="token function">userlla</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">userlla</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">str2double</span><span class="token punctuation">(</span>doy<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        delay<span class="token punctuation">.</span>tropo <span class="token operator">=</span> <span class="token punctuation">(</span>d_hyd <span class="token operator">+</span> d_wet<span class="token punctuation">)</span><span class="token operator">.*</span><span class="token punctuation">(</span><span class="token number">1.001</span><span class="token operator">./</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">0.002001</span> <span class="token operator">+</span> <span class="token function">sind</span><span class="token punctuation">(</span>elev<span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              
        <span class="token comment">% Ionospheric delay (Klobuchar model) (For loop#3)</span>
        <span class="token keyword">for</span> ii <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token function">length</span><span class="token punctuation">(</span>PRN<span class="token punctuation">)</span> 
             <span class="token function">dIon_klob</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">klobuchar_model</span><span class="token punctuation">(</span><span class="token function">userlla</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">userlla</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">elev</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">SOD</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">,</span>nav<span class="token punctuation">.</span>ionprm<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% nano sec  newklob nav.ionprm</span>
        <span class="token keyword">end</span>
        delay<span class="token punctuation">.</span>iono <span class="token operator">=</span> c<span class="token operator">.*</span>dIon_klob<span class="token punctuation">;</span>  <span class="token comment">% delay from Klobuchar model</span>

        <span class="token comment">% elevation angle cutoff 15 degree</span>
       <span class="token keyword">if</span> stop <span class="token operator">&gt;</span> <span class="token number">1</span>
            elev_m          <span class="token operator">=</span> <span class="token function">elevcut</span><span class="token punctuation">(</span>elev<span class="token operator">'</span><span class="token punctuation">,</span>elev<span class="token operator">'</span><span class="token punctuation">,</span>elev_mask<span class="token punctuation">)</span><span class="token punctuation">;</span>
            C1_m            <span class="token operator">=</span> <span class="token function">elevcut</span><span class="token punctuation">(</span>C1<span class="token operator">'</span><span class="token punctuation">,</span>elev<span class="token operator">'</span><span class="token punctuation">,</span>elev_mask<span class="token punctuation">)</span><span class="token punctuation">;</span>
            satpos_m        <span class="token operator">=</span> <span class="token function">elevcut</span><span class="token punctuation">(</span>satpos<span class="token punctuation">,</span>elev<span class="token operator">'</span><span class="token punctuation">,</span>elev_mask<span class="token punctuation">)</span><span class="token punctuation">;</span>
            sclockbias_m    <span class="token operator">=</span> <span class="token function">elevcut</span><span class="token punctuation">(</span>satclock<span class="token operator">'</span><span class="token punctuation">,</span>elev<span class="token operator">'</span><span class="token punctuation">,</span>elev_mask<span class="token punctuation">)</span><span class="token punctuation">;</span>
            d_tropo         <span class="token operator">=</span> <span class="token function">elevcut</span><span class="token punctuation">(</span>delay<span class="token punctuation">.</span>tropo<span class="token operator">'</span><span class="token punctuation">,</span>elev<span class="token operator">'</span><span class="token punctuation">,</span>elev_mask<span class="token punctuation">)</span><span class="token punctuation">;</span>
            d_iono          <span class="token operator">=</span> <span class="token function">elevcut</span><span class="token punctuation">(</span>delay<span class="token punctuation">.</span>iono<span class="token operator">'</span><span class="token punctuation">,</span>elev<span class="token operator">'</span><span class="token punctuation">,</span>elev_mask<span class="token punctuation">)</span><span class="token punctuation">;</span>
            PRN_m           <span class="token operator">=</span> <span class="token function">elevcut</span><span class="token punctuation">(</span>PRN<span class="token operator">'</span><span class="token punctuation">,</span>elev<span class="token punctuation">,</span>elev_mask<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            delay<span class="token punctuation">.</span>tropo     <span class="token operator">=</span> <span class="token number">0.</span><span class="token operator">*</span>elev<span class="token punctuation">;</span>
            delay<span class="token punctuation">.</span>iono      <span class="token operator">=</span> <span class="token number">0.</span><span class="token operator">*</span>elev<span class="token punctuation">;</span>
            elev_m          <span class="token operator">=</span> <span class="token function">elevcut</span><span class="token punctuation">(</span>elev<span class="token operator">'</span><span class="token punctuation">,</span>elev<span class="token operator">'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            C1_m            <span class="token operator">=</span> <span class="token function">elevcut</span><span class="token punctuation">(</span>C1<span class="token operator">'</span><span class="token punctuation">,</span>elev<span class="token operator">'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            satpos_m        <span class="token operator">=</span> <span class="token function">elevcut</span><span class="token punctuation">(</span>satpos<span class="token punctuation">,</span>elev<span class="token operator">'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            sclockbias_m    <span class="token operator">=</span> <span class="token function">elevcut</span><span class="token punctuation">(</span>satclock<span class="token operator">'</span><span class="token punctuation">,</span>elev<span class="token operator">'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            d_tropo         <span class="token operator">=</span> <span class="token function">elevcut</span><span class="token punctuation">(</span>delay<span class="token punctuation">.</span>tropo<span class="token operator">'</span><span class="token punctuation">,</span>elev<span class="token operator">'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            d_iono          <span class="token operator">=</span> <span class="token function">elevcut</span><span class="token punctuation">(</span>delay<span class="token punctuation">.</span>iono<span class="token operator">'</span><span class="token punctuation">,</span>elev<span class="token operator">'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            PRN_m           <span class="token operator">=</span> <span class="token function">elevcut</span><span class="token punctuation">(</span>PRN<span class="token operator">'</span><span class="token punctuation">,</span>elev<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
                
        cP1 <span class="token operator">=</span>   <span class="token function">nan</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token function">length</span><span class="token punctuation">(</span>C1_m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     
        <span class="token comment">% Pseudorange correction</span>
        <span class="token keyword">if</span> <span class="token function">length</span><span class="token punctuation">(</span>cP1<span class="token punctuation">)</span><span class="token operator">~=</span><span class="token function">length</span><span class="token punctuation">(</span>sclockbias_m<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">end</span> <span class="token comment">% Check number of satellite</span>
        <span class="token keyword">if</span> mode <span class="token operator">==</span> <span class="token number">1</span> <span class="token comment">% No atmospheric delay correction</span>
            cP1 <span class="token operator">=</span>   C1_m <span class="token operator">+</span> c<span class="token operator">.*</span>sclockbias_m<span class="token punctuation">;</span>
        <span class="token keyword">end</span>
        <span class="token keyword">if</span> mode <span class="token operator">==</span> <span class="token number">2</span> <span class="token comment">% Ionospheric delay correction</span>
            cP1 <span class="token operator">=</span>   C1_m <span class="token operator">+</span> c<span class="token operator">.*</span>sclockbias_m <span class="token operator">-</span> d_iono<span class="token punctuation">;</span>
        <span class="token keyword">end</span>
        <span class="token keyword">if</span> mode <span class="token operator">==</span> <span class="token number">3</span> <span class="token comment">% Tropospheric delay correction</span>
            cP1 <span class="token operator">=</span>   C1_m <span class="token operator">+</span> c<span class="token operator">.*</span>sclockbias_m <span class="token operator">-</span> d_tropo<span class="token punctuation">;</span>
        <span class="token keyword">end</span>
        <span class="token keyword">if</span> mode <span class="token operator">==</span> <span class="token number">4</span> <span class="token comment">% Tropospheric+Ionospheric delay correction</span>
            cP1 <span class="token operator">=</span>   C1_m <span class="token operator">+</span> c<span class="token operator">.*</span>sclockbias_m <span class="token operator">-</span> d_tropo <span class="token operator">-</span> d_iono<span class="token punctuation">;</span>
        <span class="token keyword">end</span>
        <span class="token comment">% remove outlier</span>
        ctest <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">refpos</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">ones</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token function">length</span><span class="token punctuation">(</span>satpos_m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> satpos_m<span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%Ref distance</span>
        cError <span class="token operator">=</span> cP1<span class="token operator">-</span>ctest<span class="token punctuation">;</span>
        <span class="token function">cP1</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>cError<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">satpos_m</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token function">abs</span><span class="token punctuation">(</span>cError<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token function">length</span><span class="token punctuation">(</span>satpos_m<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token operator">||</span> <span class="token function">length</span><span class="token punctuation">(</span>C1_m<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token operator">||</span> <span class="token function">length</span><span class="token punctuation">(</span>C1_m<span class="token punctuation">)</span><span class="token operator">~=</span><span class="token function">length</span><span class="token punctuation">(</span>satpos_m<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">end</span> <span class="token comment">% Check number of satellite</span>
                
        <span class="token function">length</span><span class="token punctuation">(</span>C1_m<span class="token punctuation">)</span>
        <span class="token comment">% Satellite Flight Correction with bc and clock error (SACNAG)     </span>
        satpos_cor <span class="token operator">=</span> <span class="token function">nan</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token function">length</span><span class="token punctuation">(</span>satpos_m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token keyword">for</span> iii <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token function">length</span><span class="token punctuation">(</span>satpos_m<span class="token punctuation">)</span>
            dtflight <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">cP1</span><span class="token punctuation">(</span>iii<span class="token punctuation">)</span><span class="token operator">-</span>br<span class="token punctuation">)</span><span class="token operator">/</span>c <span class="token operator">+</span> <span class="token function">sclockbias_m</span><span class="token punctuation">(</span>iii<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% + d_iono/c</span>
            <span class="token function">satpos_cor</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>iii<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">FlightTimeCorr</span><span class="token punctuation">(</span><span class="token function">satpos_m</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>iii<span class="token punctuation">)</span><span class="token punctuation">,</span>dtflight<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% REF</span>
        <span class="token keyword">end</span>   
       
        <span class="token comment">% Calculate line of sight vectors and ranges from satellite to xo</span>
        v <span class="token operator">=</span> <span class="token function">xyz0</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">ones</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token function">length</span><span class="token punctuation">(</span>satpos_cor<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> satpos_cor<span class="token punctuation">;</span>
        range <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span> <span class="token function">sum</span><span class="token punctuation">(</span>v<span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        v <span class="token operator">=</span> v<span class="token operator">./</span><span class="token punctuation">(</span><span class="token function">ones</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>range<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% line of sight unit vectors from sv to xo</span>
            
        <span class="token comment">% Calculate the a-priori range residual</span>
        prHat <span class="token operator">=</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span> <span class="token operator">+</span> br<span class="token punctuation">;</span>
        P <span class="token operator">=</span> cP1<span class="token operator">'</span> <span class="token operator">-</span> prHat<span class="token punctuation">;</span>                    <span class="token comment">% matrix P</span>
        H <span class="token operator">=</span> <span class="token punctuation">[</span>v<span class="token operator">'</span><span class="token punctuation">,</span><span class="token function">ones</span><span class="token punctuation">(</span><span class="token function">length</span><span class="token punctuation">(</span>satpos_cor<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">% matrix H</span>
        
        <span class="token comment">% LSE solution    </span>
        dx <span class="token operator">=</span> <span class="token function">inv</span><span class="token punctuation">(</span>H<span class="token operator">'</span><span class="token operator">*</span>H<span class="token punctuation">)</span><span class="token operator">*</span>H<span class="token operator">'</span><span class="token operator">*</span>P<span class="token punctuation">;</span>
        
        <span class="token comment">% update xyz0 and br</span>
        xyz0 <span class="token operator">=</span> <span class="token function">xyz0</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">dx</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        br   <span class="token operator">=</span> br<span class="token operator">+</span><span class="token function">dx</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
    <span class="token keyword">end</span>

    G <span class="token operator">=</span> <span class="token function">inv</span><span class="token punctuation">(</span>H<span class="token operator">'</span><span class="token operator">*</span>H<span class="token punctuation">)</span><span class="token punctuation">;</span>
    HDOP <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token function">G</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">G</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>在解算过程中，还加入了对流层延迟误差模型，电离层模型由于缺少参数不参与计算。在计算之前，还对明显的误差外点进行了剔除，对于距离估计大概位置过远的卫星进行了剔除。在迭代完成后，还对HDOP值进行了计算。</p> 
<h3><a id="_525"></a>求解结果输出</h3> 
<p>求解结果以标准文件NMEA 0183格式输出，NMEA格式中的GPGGA语句包含了以下核心字段：</p> 
<ul><li> <p>经纬度及半球标识符；</p> </li><li> <p>高程；</p> </li><li> <p>HDOP；</p> </li><li> <p>UTC时间；</p> </li><li> <p>定位质量（均为单点定位）；</p> </li><li> <p>使用的卫星数量；</p> </li><li> <p>校验和。</p> </li></ul> 
<p>其中校验和即对语句数据进行1的补码和运算，累加的结果再取反码即生成了检验码。将检验码放入检验和字段中。实现代码如下：</p> 
<pre><code class="prism language-matlab">    <span class="token keyword">function</span> checksum <span class="token operator">=</span> <span class="token function">calculateNMEAChecksum</span><span class="token punctuation">(</span>sentence<span class="token punctuation">)</span>
        checksum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token number">i</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">:</span><span class="token function">length</span><span class="token punctuation">(</span>sentence<span class="token punctuation">)</span> 
            checksum <span class="token operator">=</span> <span class="token function">bitxor</span><span class="token punctuation">(</span>checksum<span class="token punctuation">,</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token function">sentence</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
        checksum <span class="token operator">=</span> <span class="token function">dec2hex</span><span class="token punctuation">(</span>checksum<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token function">length</span><span class="token punctuation">(</span>checksum<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">2</span>
            checksum <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'0'</span><span class="token punctuation">,</span> checksum<span class="token punctuation">]</span><span class="token punctuation">;</span> 
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
</code></pre> 
<p>将最小二乘的结果与相应时间输出为GPGGA格式的字符串形式，并计算校验和，最后输出整段GPGGA语句。</p> 
<h2><a id="Experimental_Results_and_Discussions_560"></a>Experimental Results and Discussions</h2> 
<p>本小节进行了SPP的固定站与移动站、GPS与北斗系统定位实验，并进行了误差分析与相关讨论。</p> 
<h3><a id="_564"></a>实验系统构建</h3> 
<p>本实验采用的固定站为微电子楼楼顶天线位置，进行了24+小时观测，有利于误差分析。移动站绕电院草坪绕行，进行了15min的观测，有利于验证SPP算法的移动定位性能。固定站与移动站真值如图所示。</p> 
<p>对于GPS系统，我们使用"C1C"伪距进行观测，对于BDS系统，我们使用"C2I"伪距进行观测。</p> 
<p><img src="https://images2.imgbox.com/35/b6/pM1PGXDh_o.png" alt="真值"></p> 
<h3><a id="_571"></a>定位结果分析</h3> 
<h4><a id="_573"></a>固定站分析</h4> 
<p>对于固定站分析我们分别对所实现的GPS和BDS的SPP定位进行了结果分析。</p> 
<p><em>GPS</em>：首先，我们对GPS系统对固定站的定位结果进行了分析，图[为经过对流层误差校正的定位结果，其50%的分布误差在2.282m，符合SPP的整体定位精度量级。</p> 
<p><img src="https://images2.imgbox.com/0e/5a/dXbCRxYC_o.png" alt="GPS固定站"><br> 接着，我们对固定站定位的水平和垂直误差随时间的变化进行了分析，如图所示。总体来说水平误差比垂直误差低很多，这符合课程学习的知识。<br> <img src="https://images2.imgbox.com/4c/1a/Mo1stvX9_o.png" alt="GPS固定站垂直"><br> <img src="https://images2.imgbox.com/2f/f7/SejFHrUF_o.png" alt="随时间变化的定位误差"></p> 
<p>固定站的GPS天空图如图所示，GPS卫星数量丰富且观测条件较好。<br> <img src="https://images2.imgbox.com/08/38/wmmJLPMF_o.png" alt="GPS天空图"></p> 
<p>在6-15小时内，水平定位误差最小。进一步，我们分析了卫星在这总观测25h内的可见性。如图所示，在6-15小时内，可见的卫星数目最多，因此定位效果最好，在20个小时以后，可观测到的GPS卫星很好。因此当可见卫星越多时，GPS的定位效果越好。</p> 
<p><img src="https://images2.imgbox.com/6a/da/E93tXiRB_o.png" alt="在这里插入图片描述"></p> 
<p><em>BDS</em>：接着，我们对BDS系统对固定站的定位结果进行了分析，图为无大气误差定位结果，其50%的分布误差在12.423m，符合SPP的整体定位精度量级。相较于GPS，BDS定位精度较低，这是由于BDS的广播星历计算卫星位置不够准确且卫星观测条件较差。BDS的卫星种类与位置解算方法相比GPS非常复杂，并且在广播星历上，BDS确实没有GPS精准。本报告的算法也没有针对BDS特别进行筛星融合等处理，因此BDS卫星的定位精度较低。</p> 
<p><img src="https://images2.imgbox.com/f4/41/eObuwb4H_o.png" alt="在这里插入图片描述"></p> 
<p>接着，我们对固定站BDS定位的水平和垂直误差随时间的变化进行了分析，如图所示。总体来说水平误差比垂直误差低很多，这符合课程学习的知识。</p> 
<p><img src="https://images2.imgbox.com/7a/21/agEf0tXW_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c0/b5/AwPU4HpO_o.png" alt="在这里插入图片描述"></p> 
<p>固定站的BDS天空图如图所示，BDS卫星的观测条件较差。</p> 
<p><img src="https://images2.imgbox.com/5b/d8/kgJ3VrD4_o.png" alt="在这里插入图片描述"></p> 
<p>进一步，我们分析了卫星在这总观测25h内的可见性。如图所示，虽然BDS颗可见卫星比GPS多，但是卫星质量较差，因此定位精度较低。若想继续优化BDS定位结果，可以通过筛星等方法，提升参与定位的卫星质量。</p> 
<p><img src="https://images2.imgbox.com/9e/a4/adXMng9o_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_613"></a>移动站分析</h4> 
<p>对于移动站分析我们分别对所实现的GPS和BDS的SPP定位进行了轨迹对比及结果分析，根据要求，我们输出的轨迹为NMEA格式，本小节将NMEA格式的求解结果导入rtkplot中进行分析，而不是用rtklib求解。</p> 
<p><em>GPS</em>：首先，我们对GPS系统对移动站的定位结果进行了分析，图[为经过对流层误差校正的轨迹结果.</p> 
<p><img src="https://images2.imgbox.com/fd/fc/EbPcCBfh_o.png" alt="在这里插入图片描述"></p> 
<p>进一步，我们对GPS移动站的定位结果，NMEA格式文件导入RTKPLOT中，同时将参考真值的轨迹文件也导入RTKPLOT中进行比较。如图，GPS的移动站定位结果在水平方向上为15m左右，其中在7:10-7:13时间段，误差达到40m，在垂直方向上的定位误差在20m左右，与SPP定位精度量级一致。<br> <img src="https://images2.imgbox.com/d6/98/0fUlyzLm_o.png" alt="在这里插入图片描述"></p> 
<p>进而，我们分析了GPS的移动站可见性，如图<a href="#fig:GPS_Rover_SV" rel="nofollow">14</a>{reference-type=“ref”<br> reference=“fig:GPS_Rover_SV”}所示，移动站的GPS卫星可见性与固定站相比较差，卫星数目较少，特别在7:10-7:13时间段，卫星数目极少，导致定位漂移很大。<br> <img src="https://images2.imgbox.com/87/1d/7Izpy0Ou_o.png" alt="在这里插入图片描述"></p> 
<p><em>BDS</em>：我们对北斗系统对移动站的定位结果进行了分析，图为经过对流层误差校正的轨迹结果。</p> 
<p><img src="https://images2.imgbox.com/5e/83/gQZZGTbS_o.png" alt="在这里插入图片描述"></p> 
<p>进一步，我们对BDS移动站的定位误差，NMEA格式文件导入RTKPLOT中，同时将参考真值的轨迹文件也导入RTKPLOT中进行比较。如图，BDS的移动站定位结果在水平方向上为10m左右，在垂直方向上的定位误差在20m左右，与SPP定位精度量级一致。</p> 
<p><img src="https://images2.imgbox.com/2c/f9/Ajzmk4TG_o.png" alt="在这里插入图片描述"><br> 进而，我们分析了BDS的移动站可见性，如图所示，移动站的北斗卫星可见性相对较好，卫星数目较多，虽然北斗卫星的广播星历没有那么准确，但是可见卫星比GPS系统多，因此定位结果更加稳定。<br> <img src="https://images2.imgbox.com/0e/d8/E8klouGg_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="Conclusions_639"></a>Conclusions</h2> 
<p>本报告用Matlab实现了SPP算法，支持RINEX 3.03格式，能进行GPS和BDS系统SPP定位。报告中先介绍了SPP算法的理论，包括RINEX文件格式、卫星位置与钟差解算以及最小二乘问题构建。接着，报告详细介绍了SPP算法的实现过程与工程技巧。最后，报告开展了SPP定位算法实验，分别使用GPS和BDS系统对固定站和移动站进行了定位，并对比其解算结果并分析了误差原因。本报告及其代码将开源于卫星社区，为卫星定位的学习者们提供参考。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2c05f2be9796c3d67e259b440c40ad29/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">AndroidStudio导入程序、项目（教程）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d2dbd8cb638b7456a009e0d0fafe6c3f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">springboot整合webservice使用总结</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>