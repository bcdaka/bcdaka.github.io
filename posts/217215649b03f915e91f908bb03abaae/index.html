<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【Python】PySpark 数据处理 ② ( 安装 PySpark | PySpark 数据处理步骤 | 构建 PySpark 执行环境入口对象 ) - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/217215649b03f915e91f908bb03abaae/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【Python】PySpark 数据处理 ② ( 安装 PySpark | PySpark 数据处理步骤 | 构建 PySpark 执行环境入口对象 )">
  <meta property="og:description" content="文章目录 一、安装 PySpark1、使用 pip 安装 PySpark2、国内代理镜像3、PyCharm 中安装 PySpark 二、PySpark 数据处理步骤三、构建 PySpark 执行环境入口对象四、代码示例 一、安装 PySpark 1、使用 pip 安装 PySpark 执行 Windows &#43; R , 运行 cmd 命令行提示符 ,
在命令行提示符终端中 , 执行
pip install pyspark 命令 , 安装 PySpark , 安装过程中 , 需要下载 310 M 的安装包 , 耐心等待 ;
安装完毕 :
命令行输出 :
C:\Users\octop&gt;pip install pyspark Collecting pyspark Downloading pyspark-3.4.1.tar.gz (310.8 MB) |████████████████████████████████| 310.8 MB 126 kB/s Collecting py4j==0.10.9.7 WARNING: Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by &#39;ProtocolError(&#39;Connection aborted.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-07-29T23:21:17+08:00">
    <meta property="article:modified_time" content="2023-07-29T23:21:17+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Python】PySpark 数据处理 ② ( 安装 PySpark | PySpark 数据处理步骤 | 构建 PySpark 执行环境入口对象 )</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_PySpark_7" rel="nofollow">一、安装 PySpark</a></li><li><ul><li><a href="#1_pip__PySpark_17" rel="nofollow">1、使用 pip 安装 PySpark</a></li><li><a href="#2_67" rel="nofollow">2、国内代理镜像</a></li><li><a href="#3PyCharm__PySpark_84" rel="nofollow">3、PyCharm 中安装 PySpark</a></li></ul> 
  </li><li><a href="#PySpark__108" rel="nofollow">二、PySpark 数据处理步骤</a></li><li><a href="#_PySpark__147" rel="nofollow">三、构建 PySpark 执行环境入口对象</a></li><li><a href="#_203" rel="nofollow">四、代码示例</a></li></ul> 
</div> 
<p></p> 
<br> 
<br> 
<br> 
<br> 
<h2><a id="_PySpark_7"></a>一、安装 PySpark</h2> 
<hr> 
<br> 
<br> 
<h3><a id="1_pip__PySpark_17"></a>1、使用 pip 安装 PySpark</h3> 
<br> 
<p>执行 Windows + R , 运行 cmd 命令行提示符 ,</p> 
<p><img src="https://images2.imgbox.com/e1/27/mQFmfl88_o.png" alt="在这里插入图片描述"></p> 
<p>在命令行提示符终端中 , 执行</p> 
<pre><code class="prism language-python">pip install pyspark
</code></pre> 
<p>命令 , 安装 PySpark , 安装过程中 , 需要下载 310 M 的安装包 , 耐心等待 ;</p> 
<p><img src="https://images2.imgbox.com/6e/1f/mhb4DFLF_o.png" alt="在这里插入图片描述"></p> 
<p><strong>安装完毕 :</strong></p> 
<p><img src="https://images2.imgbox.com/d9/28/2sq1YB7T_o.png" alt="在这里插入图片描述"></p> 
<p><strong>命令行输出 :</strong></p> 
<pre><code class="prism language-python">C<span class="token punctuation">:</span>\Users\octop<span class="token operator">&gt;</span>pip install pyspark
Collecting pyspark
  Downloading pyspark<span class="token operator">-</span><span class="token number">3.4</span><span class="token number">.1</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token punctuation">(</span><span class="token number">310.8</span> MB<span class="token punctuation">)</span>
     <span class="token operator">|</span>████████████████████████████████<span class="token operator">|</span> <span class="token number">310.8</span> MB <span class="token number">126</span> kB<span class="token operator">/</span>s
Collecting py4j<span class="token operator">==</span><span class="token number">0.10</span><span class="token number">.9</span><span class="token number">.7</span>
  WARNING<span class="token punctuation">:</span> Retrying <span class="token punctuation">(</span>Retry<span class="token punctuation">(</span>total<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> connect<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> read<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> redirect<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> status<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">)</span> after connection broken by <span class="token string">'ProtocolError('</span>Connection aborted<span class="token punctuation">.</span><span class="token string">', ConnectionResetError(10054, '</span>远程主机强迫关闭了一个现有的连接。<span class="token string">', None, 10054, None))'</span><span class="token punctuation">:</span> <span class="token operator">/</span>packages<span class="token operator">/</span><span class="token number">10</span><span class="token operator">/</span><span class="token number">30</span><span class="token operator">/</span>a58b32568f1623aaad7db22aa9eafc4c6c194b429ff35bdc55ca2726da47<span class="token operator">/</span>py4j<span class="token operator">-</span><span class="token number">0.10</span><span class="token number">.9</span><span class="token number">.7</span><span class="token operator">-</span>py2<span class="token punctuation">.</span>py3<span class="token operator">-</span>none<span class="token operator">-</span><span class="token builtin">any</span><span class="token punctuation">.</span>whl
  Downloading py4j<span class="token operator">-</span><span class="token number">0.10</span><span class="token number">.9</span><span class="token number">.7</span><span class="token operator">-</span>py2<span class="token punctuation">.</span>py3<span class="token operator">-</span>none<span class="token operator">-</span><span class="token builtin">any</span><span class="token punctuation">.</span>whl <span class="token punctuation">(</span><span class="token number">200</span> kB<span class="token punctuation">)</span>
     <span class="token operator">|</span>████████████████████████████████<span class="token operator">|</span> <span class="token number">200</span> kB <span class="token number">1.1</span> MB<span class="token operator">/</span>s
Using legacy setup<span class="token punctuation">.</span>py install <span class="token keyword">for</span> pyspark<span class="token punctuation">,</span> since package <span class="token string">'wheel'</span> <span class="token keyword">is</span> <span class="token keyword">not</span> installed<span class="token punctuation">.</span>
Installing collected packages<span class="token punctuation">:</span> py4j<span class="token punctuation">,</span> pyspark
    Running setup<span class="token punctuation">.</span>py install <span class="token keyword">for</span> pyspark <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> done
Successfully installed py4j<span class="token operator">-</span><span class="token number">0.10</span><span class="token number">.9</span><span class="token number">.7</span> pyspark<span class="token operator">-</span><span class="token number">3.4</span><span class="token number">.1</span>
WARNING<span class="token punctuation">:</span> You are using pip version <span class="token number">20.1</span><span class="token number">.1</span><span class="token punctuation">;</span> however<span class="token punctuation">,</span> version <span class="token number">23.2</span><span class="token number">.1</span> <span class="token keyword">is</span> available<span class="token punctuation">.</span>
You should consider upgrading via the <span class="token string">'y:\001_developtools\015_python\python37\python.exe -m pip install --upgrade pip'</span> command<span class="token punctuation">.</span>

C<span class="token punctuation">:</span>\Users\octop<span class="token operator">&gt;</span>
</code></pre> 
<br> 
<h3><a id="2_67"></a>2、国内代理镜像</h3> 
<br> 
<p>如果使用 官方的源 下载安装 PySpark 的速度太慢 ,</p> 
<p>可以使用 国内的 镜像网站 <a href="https://pypi.tuna.tsinghua.edu.cn/simple/" rel="nofollow">https://pypi.tuna.tsinghua.edu.cn/simple/</a> ,</p> 
<p>这是清华大学提供的源 ;</p> 
<pre><code class="prism language-python">pip install <span class="token operator">-</span>i https<span class="token punctuation">:</span><span class="token operator">//</span>pypi<span class="token punctuation">.</span>tuna<span class="token punctuation">.</span>tsinghua<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>simple pyspark
</code></pre> 
<br> 
<h3><a id="3PyCharm__PySpark_84"></a>3、PyCharm 中安装 PySpark</h3> 
<br> 
<p>也可以参考 <a href="https://blog.csdn.net/shulianghan/article/details/131817730">【Python】pyecharts 模块 ② ( 命令行安装 pyecharts 模块 | PyCharm 安装 pyecharts 模块 )</a> 博客 , 在 PyCharm 中 , 安装 PySpark ;</p> 
<p>尝试导入 pyspack 模块中的类 , 如果报错 , 使用报错修复选项 , PyCharm 会自动安装 PySpark ;</p> 
<p><img src="https://images2.imgbox.com/29/63/EXOM4t2f_o.png" alt="在这里插入图片描述"></p> 
<br> 
<br> 
<br> 
<br> 
<h2><a id="PySpark__108"></a>二、PySpark 数据处理步骤</h2> 
<hr> 
<br> 
<p>PySpark 编程时 , 先要构建一个 PySpark 执行环境入口对象 , 然后开始执行数据处理操作 ;</p> 
<p><strong>数据处理的步骤如下 :</strong></p> 
<p><strong>首先 ,</strong> <strong>要进行数据输入</strong> , 需要读取要处理的原始数据 , 一般通过 SparkContext 执行环境入口对象 执行 数据读取操作 , 读取后得到 RDD 类实例对象 ;</p> 
<p><strong>然后 , 进行 数据处理计算 ,</strong> 对 RDD 类实例对象 成员方法进行各种计算处理 ;</p> 
<p><strong>最后 , 输出 处理后的结果 ,</strong> RDD 对象处理完毕后 , 写出文件 , 或者存储到内存中 ;</p> 
<p><img src="https://images2.imgbox.com/be/f4/YuMVULfd_o.png" alt="在这里插入图片描述"></p> 
<br> 
<p>数据的初始形态 , 一般是 JSON 文件 , 文本文件 , 数据库文件 ;</p> 
<p>通过 SparkContext 读取 原始文件 到 RDD 中 , 进行数据处理 ;</p> 
<p>数据处理完毕后 , 存储到 内存 / 磁盘 / 数据库 中 ;</p> 
<p><img src="https://images2.imgbox.com/2e/01/vU4lB7HR_o.png" alt="在这里插入图片描述"></p> 
<br> 
<br> 
<br> 
<br> 
<h2><a id="_PySpark__147"></a>三、构建 PySpark 执行环境入口对象</h2> 
<hr> 
<br> 
<p><strong>如果想要使用 PySpark 进行数据处理 , 必须构建一个 PySpark 执行环境入口对象 ;</strong></p> 
<p><strong>PySpark 执行环境 入口对象 是 SparkContext 类实例对象 ;</strong></p> 
<br> 
<p><strong>首先 ,</strong> 导入相关包 ;</p> 
<pre><code class="prism language-python"><span class="token comment"># 导入 PySpark 相关包</span>
<span class="token keyword">from</span> pyspark <span class="token keyword">import</span> SparkConf<span class="token punctuation">,</span> SparkContext
</code></pre> 
<p><strong>然后 ,</strong> 创建 SparkConf 实例对象 , 该对象用于配置 Spark 任务 , 各种配置可以在链式调用中设置 ;</p> 
<ul><li>调用 SparkConf#setMaster 函数 , 可以设置运行模式 , 单机模式 / 集群模式 ;</li><li>调用 SparkConf#setAppName函数 , 可以设置 Spark 程序 名字 ;</li></ul> 
<pre><code class="prism language-python"><span class="token comment"># 创建 SparkConf 实例对象 , 该对象用于配置 Spark 任务</span>
<span class="token comment"># setMaster("local[*]") 表示在单机模式下 本机运行</span>
<span class="token comment"># setAppName("hello_spark") 是给 Spark 程序起一个名字</span>
sparkConf <span class="token operator">=</span> SparkConf<span class="token punctuation">(</span><span class="token punctuation">)</span>\
    <span class="token punctuation">.</span>setMaster<span class="token punctuation">(</span><span class="token string">"local[*]"</span><span class="token punctuation">)</span>\
    <span class="token punctuation">.</span>setAppName<span class="token punctuation">(</span><span class="token string">"hello_spark"</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>再后 ,</strong> 创建 PySpark 执行环境 入口对象 ;</p> 
<pre><code class="prism language-python"><span class="token comment"># 创建 PySpark 执行环境 入口对象</span>
sparkContext <span class="token operator">=</span> SparkContext<span class="token punctuation">(</span>conf<span class="token operator">=</span>sparkConf<span class="token punctuation">)</span>
</code></pre> 
<p><strong>最后 ,</strong> 执行完 数据处理 任务后 , 调用 SparkContext#stop 方法 , 停止 Spark 程序 ;</p> 
<pre><code class="prism language-python"><span class="token comment"># 停止 PySpark 程序</span>
sparkContext<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<br> 
<br> 
<br> 
<br> 
<h2><a id="_203"></a>四、代码示例</h2> 
<hr> 
<br> 
<p><strong>代码示例 :</strong></p> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""
PySpark 数据处理
"""</span>

<span class="token comment"># 导入 PySpark 相关包</span>
<span class="token keyword">from</span> pyspark <span class="token keyword">import</span> SparkConf<span class="token punctuation">,</span> SparkContext

<span class="token comment"># 创建 SparkConf 实例对象 , 该对象用于配置 Spark 任务</span>
<span class="token comment"># setMaster("local[*]") 表示在单机模式下 本机运行</span>
<span class="token comment"># setAppName("hello_spark") 是给 Spark 程序起一个名字</span>
sparkConf <span class="token operator">=</span> SparkConf<span class="token punctuation">(</span><span class="token punctuation">)</span>\
    <span class="token punctuation">.</span>setMaster<span class="token punctuation">(</span><span class="token string">"local[*]"</span><span class="token punctuation">)</span>\
    <span class="token punctuation">.</span>setAppName<span class="token punctuation">(</span><span class="token string">"hello_spark"</span><span class="token punctuation">)</span>

<span class="token comment"># 创建 PySpark 执行环境 入口对象</span>
sparkContext <span class="token operator">=</span> SparkContext<span class="token punctuation">(</span>conf<span class="token operator">=</span>sparkConf<span class="token punctuation">)</span>

<span class="token comment"># 打印 PySpark 版本号</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sparkContext<span class="token punctuation">.</span>version<span class="token punctuation">)</span>

<span class="token comment"># 停止 PySpark 程序</span>
sparkContext<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>执行结果 :</strong></p> 
<pre><code class="prism language-python">Y<span class="token punctuation">:</span>\002_WorkSpace\PycharmProjects\pythonProject\venv\Scripts\python<span class="token punctuation">.</span>exe Y<span class="token punctuation">:</span><span class="token operator">/</span>002_WorkSpace<span class="token operator">/</span>PycharmProjects<span class="token operator">/</span>HelloPython<span class="token operator">/</span>hello<span class="token punctuation">.</span>py
<span class="token number">23</span><span class="token operator">/</span><span class="token number">07</span><span class="token operator">/</span><span class="token number">29</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token number">08</span><span class="token punctuation">:</span><span class="token number">04</span> WARN Shell<span class="token punctuation">:</span> Did <span class="token keyword">not</span> find winutils<span class="token punctuation">.</span>exe<span class="token punctuation">:</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>FileNotFoundException<span class="token punctuation">:</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>FileNotFoundException<span class="token punctuation">:</span> HADOOP_HOME <span class="token keyword">and</span> hadoop<span class="token punctuation">.</span>home<span class="token punctuation">.</span><span class="token builtin">dir</span> are unset<span class="token punctuation">.</span> <span class="token operator">-</span>see https<span class="token punctuation">:</span><span class="token operator">//</span>wiki<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>org<span class="token operator">/</span>hadoop<span class="token operator">/</span>WindowsProblems
Setting default log level to <span class="token string">"WARN"</span><span class="token punctuation">.</span>
To adjust logging level use sc<span class="token punctuation">.</span>setLogLevel<span class="token punctuation">(</span>newLevel<span class="token punctuation">)</span><span class="token punctuation">.</span> For SparkR<span class="token punctuation">,</span> use setLogLevel<span class="token punctuation">(</span>newLevel<span class="token punctuation">)</span><span class="token punctuation">.</span>
<span class="token number">23</span><span class="token operator">/</span><span class="token number">07</span><span class="token operator">/</span><span class="token number">29</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token number">08</span><span class="token punctuation">:</span><span class="token number">04</span> WARN NativeCodeLoader<span class="token punctuation">:</span> Unable to load native<span class="token operator">-</span>hadoop library <span class="token keyword">for</span> your platform<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> using builtin<span class="token operator">-</span>java classes where applicable
<span class="token number">3.4</span><span class="token number">.1</span>

Process finished <span class="token keyword">with</span> exit code <span class="token number">0</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/61/7f/BOgTtYcP_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/cb36a4739d52e309ca40f8e68e338ae9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">三行命令切换Node.js版本，如何</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/26ed9d45e0fb7dec120d852a19f1339d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">数据结构入门指南：链表（新手避坑指南）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>