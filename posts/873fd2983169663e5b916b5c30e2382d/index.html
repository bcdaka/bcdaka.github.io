<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Pandas(全网最详细攻略)（Python） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/873fd2983169663e5b916b5c30e2382d/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Pandas(全网最详细攻略)（Python）">
  <meta property="og:description" content="文章目录 前言一、简介二、安装1、Anaconda（开源、安装简单、高性能、免费的社区支持）2、Pycharm（推荐下载社区版（免费使用））3、pip 三、数据结构1、Series2、DataFrame（常用） 四、基本属性&amp;方法：1、数据筛选方法2、插入新列3、删除重复的行4、处理缺失的值5、修改列名6、修改数据类型7、连接数据表8、透视数据表9、排序10、数据分组11、处理excel 总结 前言 Pandas 最初由 AQR Capital Management 于2008年4月开发，并于2009年底开源出来。Pandas 这个名字来源于面板数据（Panel Data）与数据分析（data analysis）这两个名词的组合。在经济学中，Panel Data 是一个关于多维数据集的术语。Pandas 最初被应用于金融量化交易领域，现在它的应用领域更加广泛，涵盖了科学研究、市场营销、社交媒体、医疗保健、教育研究等众多行业。
一、简介 Pandas 是一个免费、开源的数据分析和数据处理库，它是基于 Python 编程语言的。
二、安装 首先为你的终端，下载并安装自己想要的 Python 版本。
1、Anaconda（开源、安装简单、高性能、免费的社区支持） Anaconda，是一个开源的Python发行版本，其包含了（包管理器）conda、Python等180多个科学包及其依赖项，但是还有一些没有被包含在内的包需要通过 pip 安装；为你的电脑下载并安装 Anaconda，运行安装程序，然后按照步骤操作，安装完成后重启终端。
2、Pycharm（推荐下载社区版（免费使用）） PyCharm 是一种Python IDE（Integrated Development Environment，集成开发环境），带有一整套可以帮助用户在使用Python语言开发时提高其效率的工具，比如调试、语法高亮、项目管理、代码跳转、智能提示、自动完成、单元测试、版本控制。此外，该IDE提供了一些高级功能，以用于支持Django框架下的专业Web开发；为你的电脑下载并安装 Pycharm，运行安装程序，然后按照步骤操作，最后安装完成重启终端。
3、pip pip 是 Python 的包管理工具，该工具提供了对 Python 包的查找、下载、安装、卸载的功能；目前如果你在 python.org 下载最新版本的安装包，则是已经自带了该工具。
pip install pandas 三、数据结构 1、Series 一维数组；与numpy中的一维array类似，二者与Python基本的数据结构List也很相近，以时间为索引的Series：
&#39;&#39;&#39; pandas.Series() 参数： data：Series 的数据部分，可以是列表、数组、字典、标量值等。如果不提供此参数，则创建一个空的 Series。 index：Series 的索引部分，用于对数据进行标记。可以是列表、数组、索引对象等。如果不提供此参数，则创建一个默认的整数索引。 dtype：指定 Series 的数据类型。可以是 NumPy 的数据类型，例如 np.int64、np.float64 等。如果不提供此参数，则根据数据自动推断数据类型。 name：Series 的名称，用于标识 Series 对象。如果提供了此参数，则创建的 Series 对象将具有指定的名称。 copy：是否复制数据。默认为 False，表示不复制数据。如果设置为 True，则复制输入的数据。 fastpath：是否启用快速路径。默认为 False。启用快速路径可能会在某些情况下提高性能。 &#39;&#39;&#39; &#39;&#39;&#39; 方法（1）创建Series &#39;&#39;&#39; # example import numpy as np import pandas as pd df = pd.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-01T14:06:17+08:00">
    <meta property="article:modified_time" content="2024-07-01T14:06:17+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Pandas(全网最详细攻略)（Python）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_3" rel="nofollow">前言</a></li><li><a href="#_7" rel="nofollow">一、简介</a></li><li><a href="#_9" rel="nofollow">二、安装</a></li><li><ul><li><a href="#1Anaconda_11" rel="nofollow">1、Anaconda（开源、安装简单、高性能、免费的社区支持）</a></li><li><a href="#2Pycharm_13" rel="nofollow">2、Pycharm（推荐下载社区版（免费使用））</a></li><li><a href="#3pip_15" rel="nofollow">3、pip</a></li></ul> 
  </li><li><a href="#_21" rel="nofollow">三、数据结构</a></li><li><ul><li><a href="#1Series_22" rel="nofollow">1、Series</a></li><li><a href="#2DataFrame_45" rel="nofollow">2、DataFrame（常用）</a></li></ul> 
  </li><li><a href="#_90" rel="nofollow">四、基本属性&amp;方法：</a></li><li><ul><li><a href="#1_110" rel="nofollow">1、数据筛选方法</a></li><li><a href="#2_197" rel="nofollow">2、插入新列</a></li><li><a href="#3_225" rel="nofollow">3、删除重复的行</a></li><li><a href="#4_246" rel="nofollow">4、处理缺失的值</a></li><li><a href="#5_290" rel="nofollow">5、修改列名</a></li><li><a href="#6_311" rel="nofollow">6、修改数据类型</a></li><li><a href="#7_330" rel="nofollow">7、连接数据表</a></li><li><a href="#8_393" rel="nofollow">8、透视数据表</a></li><li><a href="#9_461" rel="nofollow">9、排序</a></li><li><a href="#10_519" rel="nofollow">10、数据分组</a></li><li><a href="#11excel_555" rel="nofollow">11、处理excel</a></li></ul> 
  </li><li><a href="#_632" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_3"></a>前言</h2> 
<p>Pandas 最初由 AQR Capital Management 于2008年4月开发，并于2009年底开源出来。Pandas 这个名字来源于面板数据（Panel Data）与数据分析（data analysis）这两个名词的组合。在经济学中，Panel Data 是一个关于多维数据集的术语。Pandas 最初被应用于金融量化交易领域，现在它的应用领域更加广泛，涵盖了科学研究、市场营销、社交媒体、医疗保健、教育研究等众多行业。</p> 
<hr> 
<h2><a id="_7"></a>一、简介</h2> 
<p>Pandas 是一个免费、开源的数据分析和数据处理库，它是基于 Python 编程语言的。</p> 
<h2><a id="_9"></a>二、安装</h2> 
<p>首先为你的终端，下载并安装自己想要的 <a href="https://www.python.org/" rel="nofollow">Python</a> 版本。</p> 
<h3><a id="1Anaconda_11"></a>1、Anaconda（开源、安装简单、高性能、免费的社区支持）</h3> 
<p><a href="https://www.anaconda.com/download" rel="nofollow">Anaconda</a>，是一个开源的Python发行版本，其包含了（包管理器）conda、Python等180多个科学包及其依赖项，但是还有一些没有被包含在内的包需要通过 pip 安装；为你的电脑下载并安装 Anaconda，运行安装程序，然后按照步骤操作，安装完成后重启终端。</p> 
<h3><a id="2Pycharm_13"></a>2、Pycharm（推荐下载社区版（免费使用））</h3> 
<p><a href="https://www.jetbrains.com/pycharm/download/?section=windows#section=windows." rel="nofollow">PyCharm</a> 是一种Python IDE（Integrated Development Environment，集成开发环境），带有一整套可以帮助用户在使用Python语言开发时提高其效率的工具，比如调试、语法高亮、项目管理、代码跳转、智能提示、自动完成、单元测试、版本控制。此外，该IDE提供了一些高级功能，以用于支持Django框架下的专业Web开发；为你的电脑下载并安装 Pycharm，运行安装程序，然后按照步骤操作，最后安装完成重启终端。</p> 
<h3><a id="3pip_15"></a>3、pip</h3> 
<p><a href="https://pypi.org/project/pip/" rel="nofollow">pip</a> 是 Python 的包管理工具，该工具提供了对 Python 包的查找、下载、安装、卸载的功能；目前如果你在 python.org 下载最新版本的安装包，则是已经自带了该工具。</p> 
<pre><code class="prism language-python">pip install pandas
</code></pre> 
<hr> 
<h2><a id="_21"></a>三、数据结构</h2> 
<h3><a id="1Series_22"></a>1、Series</h3> 
<p>一维数组；与numpy中的一维array类似，二者与Python基本的数据结构List也很相近，以时间为索引的Series：</p> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
pandas.Series()
参数：
	data：Series 的数据部分，可以是列表、数组、字典、标量值等。如果不提供此参数，则创建一个空的 Series。
	index：Series 的索引部分，用于对数据进行标记。可以是列表、数组、索引对象等。如果不提供此参数，则创建一个默认的整数索引。
	dtype：指定 Series 的数据类型。可以是 NumPy 的数据类型，例如 np.int64、np.float64 等。如果不提供此参数，则根据数据自动推断数据类型。
	name：Series 的名称，用于标识 Series 对象。如果提供了此参数，则创建的 Series 对象将具有指定的名称。
	copy：是否复制数据。默认为 False，表示不复制数据。如果设置为 True，则复制输入的数据。
	fastpath：是否启用快速路径。默认为 False。启用快速路径可能会在某些情况下提高性能。
'''</span>

<span class="token triple-quoted-string string">'''
方法（1）创建Series
'''</span>
<span class="token comment"># example</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>data<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'小明'</span><span class="token punctuation">,</span> <span class="token string">'小米'</span><span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>int64<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'年龄'</span><span class="token punctuation">,</span> copy<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="2DataFrame_45"></a>2、DataFrame（常用）</h3> 
<p>二维的表格型数据结构；可以将DataFrame理解为Series的容器，可以被看做由 Series 组成的字典：</p> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
pandas.DataFrame()
参数：
	data：DataFrame 的数据部分，可以是字典、二维数组、Series、DataFrame 或其他可转换为 DataFrame 的对象。如果不提供此参数，则创建一个空的 DataFrame。
	index：DataFrame 的行索引，用于标识每行数据。可以是列表、数组、索引对象等。如果不提供此参数，则创建一个默认的整数索引。
	columns：DataFrame 的列索引，用于标识每列数据。可以是列表、数组、索引对象等。如果不提供此参数，则创建一个默认的整数索引。
	dtype：指定 DataFrame 的数据类型。可以是 NumPy 的数据类型，例如 np.int64、np.float64 等。如果不提供此参数，则根据数据自动推断数据类型。
	copy：是否复制数据。默认为 False，表示不复制数据。如果设置为 True，则复制输入的数据。
'''</span>

<span class="token triple-quoted-string string">'''
方法（1）二维列表创建DataFrame
'''</span>
<span class="token comment"># example</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">98</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'数学'</span><span class="token punctuation">,</span> <span class="token string">'线性代数'</span><span class="token punctuation">,</span> <span class="token string">'数据结构'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>int64<span class="token punctuation">,</span>
                  copy<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
              
<span class="token triple-quoted-string string">'''--------------------------------------------------------------------------------------------'''</span>

<span class="token triple-quoted-string string">'''
方法（2）：字典嵌套列表创建DataFrame
'''</span>
<span class="token comment"># example</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Tom'</span><span class="token punctuation">,</span> <span class="token string">'Jack'</span><span class="token punctuation">,</span> <span class="token string">'Steve'</span><span class="token punctuation">,</span> <span class="token string">'Ricky'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>  

<span class="token triple-quoted-string string">'''--------------------------------------------------------------------------------------------'''</span>
               
<span class="token triple-quoted-string string">'''
方法（3）：列表嵌套字典创建DataFrame
'''</span>
<span class="token comment"># example</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">'数学'</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">'语文'</span><span class="token punctuation">:</span> <span class="token number">92</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token string">'数学'</span><span class="token punctuation">:</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token string">'语文'</span><span class="token punctuation">:</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token string">'英语'</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>           
</code></pre> 
<hr> 
<h2><a id="_90"></a>四、基本属性&amp;方法：</h2> 
<table><thead><tr><th>方法</th><th>返回</th></tr></thead><tbody><tr><td>dataframe.size</td><td>查看DataFrame数组长度</td></tr><tr><td>dataframe.ndim</td><td>查看DataFrame数组维度</td></tr><tr><td>dataframe.shape</td><td>返回一个元组，如(3, 3)表示有3行和3列</td></tr><tr><td>dataframe.axes</td><td>返回一个仅以行轴标签和列轴标签为成员的列表</td></tr><tr><td>dataframe.shift()</td><td>将行或列移动指定的步幅长度</td></tr><tr><td>dataframe.head(1)</td><td>返回一个新的DataFrame，展示前1行数据，默认是前5行</td></tr><tr><td>dataframe.tail(1)</td><td>返回一个新的DataFrame，展示最后1行数据，默认是最后5行</td></tr><tr><td>dataframe.index</td><td>返回DataFrame的行索引</td></tr><tr><td>dataframe.columns</td><td>返回DataFrame的列索引列表</td></tr><tr><td>dataframe.values</td><td>返回DataFrame中所有值组成的NumPy数组</td></tr><tr><td>dataframe.info()</td><td>展示DataFrame的信息，包括每列的名称、非空值的数量等</td></tr><tr><td>dataframe.describe()</td><td>提供DataFrame中数值型列的描述性统计信息</td></tr><tr><td>dataframe.dtypes</td><td>展示DataFrame中每列的数据类型</td></tr><tr><td>dataframe.T</td><td>转置DataFrame，即行列互换</td></tr><tr><td>dataframe.index = list</td><td>修改index，必须整体全部修改</td></tr><tr><td>dataframe.columns= list</td><td>修改columns，必须整体全部修改</td></tr></tbody></table> 
<hr> 
<h3><a id="1_110"></a>1、数据筛选方法</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
方法（1）：loc（指定行或列的名称才能选择数据）
'''</span>
<span class="token comment"># example</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
class_one <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'小明'</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                          <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'小张'</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                          <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'小赵'</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                          <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'小赵'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                          <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'小钱'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                         columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
class_one <span class="token operator">=</span> class_one<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>class_one<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'小赵'</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>class_one<span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>class_one<span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''--------------------------------------------------------------------------------------------'''</span>

<span class="token triple-quoted-string string">'''
方法（2）：布尔遮罩（Boolean masking） 
	一系列 True/False 值，用于根据特定条件从另一个数据结构(如列表、数组或 DataFrame)中筛选或选择元素
'''</span>
<span class="token comment"># example</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
class_one <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'小明'</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                          <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'小张'</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                          <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'小赵'</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                          <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'小赵'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                          <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'小钱'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                         columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
one <span class="token operator">=</span> <span class="token punctuation">(</span>class_one<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'小赵'</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>class_one<span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span>
class_one <span class="token operator">=</span> class_one<span class="token punctuation">[</span>one<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>class_one<span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''--------------------------------------------------------------------------------------------'''</span>

<span class="token triple-quoted-string string">'''
方法（3）：iloc（行和列索引的整数位置，从数据集中选择和提取数据，简化数据切片和子集操作的一种方法）
'''</span>
<span class="token comment"># example</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
class_one <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'小明'</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                          <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'小张'</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                          <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'小赵'</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                          <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'小赵'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                          <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'小钱'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                         columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
result <span class="token operator">=</span> class_one<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># 选择第一行数据</span>
result <span class="token operator">=</span> class_one<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># 选择第一列数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''--------------------------------------------------------------------------------------------'''</span>

<span class="token triple-quoted-string string">'''
方法（4）：isin(values) 
	用于基于其值是否在给定集合 values 中来过滤和选择行
	~ 表示逻辑非
'''</span>
<span class="token comment"># example</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
customers <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'小张'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                          <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'小明'</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                          <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'小红'</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                          <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'小赵'</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                         columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'fee'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token string">'Int64'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'object'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
orders <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                       <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'customerId'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token string">'Int64'</span><span class="token punctuation">,</span> <span class="token string">'customerId'</span><span class="token punctuation">:</span> <span class="token string">'Int64'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
res <span class="token operator">=</span> customers<span class="token punctuation">[</span>customers<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span>orders<span class="token punctuation">[</span><span class="token string">'customerId'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token comment"># res = customers[~customers['id'].isin(orders['customerId'])]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''--------------------------------------------------------------------------------------------'''</span>

<span class="token triple-quoted-string string">'''
方法（5）：str.len()（str相关方法都可以使用）
	用于计算列中字符串的长度
'''</span>
<span class="token comment"># example</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
tweets <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'全国科技工作者日'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                       <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'把热爱变成事业，把不可能变成可能。'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'正文'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token string">'Int64'</span><span class="token punctuation">,</span> <span class="token string">'正文'</span><span class="token punctuation">:</span> <span class="token string">'object'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
tweet <span class="token operator">=</span> tweets<span class="token punctuation">[</span><span class="token string">'正文'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">15</span>
tweets <span class="token operator">=</span> tweets<span class="token punctuation">[</span>tweet<span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>tweets<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="2_197"></a>2、插入新列</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
方法（1）：可以对 DataFrame Series 中的每个单独元素执行的操作
'''</span>
<span class="token comment"># example</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
class_one <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">,</span> <span class="token string">'小明'</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">,</span> <span class="token string">'小张'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
class_one<span class="token punctuation">[</span><span class="token string">'身高'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">161</span><span class="token punctuation">,</span> <span class="token number">178</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>class_one<span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''--------------------------------------------------------------------------------------------'''</span>

<span class="token triple-quoted-string string">'''
方法（2）：DataFrame.insert()
	参数：
		loc: 插入新列位置，原来位置列向右移，类型int
    	column: 插入新列列名
    	value: 新插入列值，如果只有一个值，将所有行设置相同值
    	allow_duplicates: 默认False，检查是否有相同列名
'''</span>
<span class="token comment"># example</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
class_one <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">,</span> <span class="token string">'小明'</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">,</span> <span class="token string">'小张'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
class_one<span class="token punctuation">.</span>insert<span class="token punctuation">(</span>loc <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> column <span class="token operator">=</span> <span class="token string">'身高'</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">161</span><span class="token punctuation">,</span> <span class="token number">178</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>class_one<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="3_225"></a>3、删除重复的行</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
方法（1）：DataFrame.drop_duplicates()
	参数：
		subset：指定要考虑重复的列，默认None，表示考虑整张表的重复
		keep：指定保留哪些重复行
			first： (默认) 删除除第一个匹配项以外的重复项。
			last： 删除除最后一个匹配项之外的重复项。
		inplace：默认False，指定是否在原始 DataFrame 上进行修改
		ignore_index：默认False。如果为True，删除后的 DataFrame 将重新索引，以便索引从零开始
'''</span>
<span class="token comment"># example</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
class_one <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">,</span> <span class="token string">'小明'</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
						<span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">,</span> <span class="token string">'小张'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
						 <span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">,</span> <span class="token string">'小张'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
class_one<span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span>keep<span class="token operator">=</span><span class="token string">'last'</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> ignore_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>class_one<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="4_246"></a>4、处理缺失的值</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
方法（1）DataFrame.dropna() 删除
	参数：
		axis： 默认为0
			axis=0：删除包含缺失值的行
			axis=1：删除包含缺失值的列
		how： 默认any
			how='any'： 只要存在一个缺失值就删除整行或整列
			how='all'： 只有当整行或整列都是缺失值时才删除
		thresh： 行或列中的非缺失值数量小于等于thresh，则会被删除
		subset： 用于指定要检查缺失值的特定列名或行索引
		inplace：表示是否对原始数据进行就地修改，默认值为False
'''</span>
<span class="token comment"># example </span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
class_one <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">,</span> <span class="token string">'小明'</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">,</span> <span class="token string">'小张'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
class_one<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>class_one<span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''--------------------------------------------------------------------------------------------'''</span>

<span class="token triple-quoted-string string">'''
方法（2）DataFrame.fillna() 填充
	参数：
		value：scalar 或 dict 或 Series 或 DataFrame | optional，要替换 NaN 的值，如果指定了 dict 或 Series，则键/索引是列标签，值是填充符
		method：默认None，{'pad','ffill','backfill','bfill',None}
			pad（ffill）：用前一个非缺失值去填充该缺失值
			backfill（bfill）：用下一个非缺失值填充该缺失值
			None：指定一个值去替换缺失值
		axis：修改填充方向
			 0：index
			 1：columns
		inplace：默认False，指定是否在原始 DataFrame 上进行修改
		limit：限制填充个数
'''</span>
<span class="token comment"># example </span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
class_one <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">,</span> <span class="token string">'小明'</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">,</span> <span class="token string">'小张'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
class_one<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>class_one<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="5_290"></a>5、修改列名</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
方法（1）：DataFrame.rename()
	参数:
		mapper：与axis结合使用，表示运用到axis上的值：类字典或者函数
		axis：指定重命名的轴：0或index；1或columns；默认为0
		index：指定修改行索引，字典的键是原始索引，值是新的索引，相当于(mapper,axis=0)
		columns：指定修改列索引，字典的键是原始索引，值是新的索引，相当于(mapper,aixs=1)
		copy： 默认None，返回重命名后的副本
		inplace：默认False，指定是否在原始 DataFrame 上进行修改
		level： 用于指定需要重命名的多层索引的层级
		errors： 默认ignore，处理不存在的键的方法：{ignore, raise}
'''</span>
<span class="token comment"># example</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
class_one <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">,</span> <span class="token string">'小明'</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">,</span> <span class="token string">'小张'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'student_id'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
class_one <span class="token operator">=</span> class_one<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">"student_id"</span><span class="token punctuation">:</span> <span class="token string">"id"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>class_one<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="6_311"></a>6、修改数据类型</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
方法（1）：DataFrame.astype()
	参数:
		dtype： 一种数据类型，或列名、或数据类型的字典
		copy： 
			True：返回新分配的对象
			False：旧对象无法强制转换为所需类型的情况下，创建新对象
		errors： 默认设置为raise，控制对提供的数据类型的无效数据引发异常
'''</span>
<span class="token comment"># example</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
class_one <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">,</span> <span class="token string">'小明'</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">,</span> <span class="token string">'小张'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
class_one<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment"># class_one['id']=class_one['id'].astype(str)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>class_one<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="7_330"></a>7、连接数据表</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
方法（1）：pd.concat()
	参数：
		objs：Series，DataFrame或Panel对象的序列或映射，如果传递了dict，则排序的键将用作键参数
		axis：决定连接的方向，默认为0
			axis=0：垂直(按行)连接
			axis=1：水平(按列)连接
		join：默认为outer，处理其他轴上的索引
			inner：交集
			outer：联合
		ignore_index：默认False，是否使用并置轴上的索引值，其他轴上的索引值在连接中仍然受到尊重
			True：不使用并置轴上的索引值
			False：使用并置轴上的索引值
		keys：序列，默认None，使用传递的键作为最外层构建层次索引；如果为多索引，应该使用元组
		levels：序列列表，默认None，用于构建MultiIndex的特定级别（唯一值）；否则，它们将从键推断
		names：默认None，结果层次索引中的级别的名称，类型list
		verify_integrity：默认False，检查新连接的轴是否包含重复项，类型bool
		copy：默认False，不复制数据，类型bool
'''</span>
<span class="token comment"># example 上下连接（常用）</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
class_one <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">,</span> <span class="token string">'小明'</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">,</span> <span class="token string">'小张'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
class_two <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'李子'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
students <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>class_one<span class="token punctuation">,</span> class_two<span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>students<span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''------------------------------------------------------------------------------------------------'''</span>

<span class="token triple-quoted-string string">'''
方法（2）：pd.merge()
	参数：
		left：待拼接的左侧数据框
		right：待拼接的右侧数据框
		how：左右两个数据框的连接方式。可选left、right、outer、inner，默认为inner
		on：左右两个待拼接数据框有共同列名，且按该列拼接两个数据框时使用该参数
		left_on：拼接两个数据框时，左数据框对应连接关键字(可为列表)
		right_on：拼接两个数据框时，右数据框对应连接关键字(可为列表)
		left_index：若为True，则按左数据框的索引连接两个数据框
		right_index：若为True，则按右数据框的索引连接两个数据框
		sort：按字典顺序通过连接键对结果数据框进行排序
		suffixes：为左右数据框中重复列名定义后缀，默认加('x','y')
'''</span>
<span class="token comment"># example </span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
students <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'小张'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                         <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'小小'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                         <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'小红'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                         <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'小赵'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                         <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'小明'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'学号'</span><span class="token punctuation">,</span> <span class="token string">'姓名'</span><span class="token punctuation">,</span> <span class="token string">'班级'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'学号'</span><span class="token punctuation">:</span> <span class="token string">'Int64'</span><span class="token punctuation">,</span> <span class="token string">'姓名'</span><span class="token punctuation">:</span> <span class="token string">'str'</span><span class="token punctuation">,</span> <span class="token string">'班级'</span><span class="token punctuation">:</span> <span class="token string">'Int64'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
score <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'99'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'96'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'56'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'45'</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'60'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                     columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'学号'</span><span class="token punctuation">,</span> <span class="token string">'数学'</span><span class="token punctuation">,</span> <span class="token string">'语文'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'学号'</span><span class="token punctuation">:</span> <span class="token string">'Int64'</span><span class="token punctuation">,</span> <span class="token string">'数学'</span><span class="token punctuation">:</span> <span class="token string">'Int64'</span><span class="token punctuation">,</span> <span class="token string">'语文'</span><span class="token punctuation">:</span> <span class="token string">'Int64'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
result <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>left<span class="token operator">=</span>students<span class="token punctuation">,</span> right<span class="token operator">=</span>score<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'学号'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="8_393"></a>8、透视数据表</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
方法（1）：DataFrame.pivot()（pivot 函数不处理相同索引/列组合的重复条目）
	参数：
		index：新 DataFrame 中的行
		columns：新 DataFrame 中的列
		values：指定重塑表格时要使用的值
'''</span>
<span class="token comment"># example </span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
city <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'日期'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'2022'</span><span class="token punctuation">,</span> <span class="token string">'2023'</span><span class="token punctuation">,</span> <span class="token string">'2024'</span><span class="token punctuation">,</span> <span class="token string">'2022'</span><span class="token punctuation">,</span> <span class="token string">'2023'</span><span class="token punctuation">,</span> <span class="token string">'2024'</span><span class="token punctuation">,</span> <span class="token string">'2022'</span><span class="token punctuation">,</span> <span class="token string">'2023'</span><span class="token punctuation">,</span> <span class="token string">'2024'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                     <span class="token string">'城市'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'上海'</span><span class="token punctuation">,</span> <span class="token string">'上海'</span><span class="token punctuation">,</span> <span class="token string">'上海'</span><span class="token punctuation">,</span> <span class="token string">'北京'</span><span class="token punctuation">,</span> <span class="token string">'北京'</span><span class="token punctuation">,</span> <span class="token string">'北京'</span><span class="token punctuation">,</span> <span class="token string">'南京'</span><span class="token punctuation">,</span> <span class="token string">'南京'</span><span class="token punctuation">,</span> <span class="token string">'南京'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                     <span class="token string">'GDP(万亿)'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
city <span class="token operator">=</span> city<span class="token punctuation">.</span>pivot<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token string">'日期'</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token string">'城市'</span><span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token string">'GDP(万亿)'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>city<span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''------------------------------------------------------------------------------------------------'''</span>

<span class="token triple-quoted-string string">'''
方法（2）：DataFrame.pivot_table()
	参数：
		index：新 DataFrame 中的行
		columns：新 DataFrame 中的列
		values：指定重塑表格时要使用的值，聚合统计的值
		aggfunc：聚合的方法，默认mean
		fill_value：用于替换空值的值，默认None
		margins：类型bool, 是否生成汇总行，默认False
		dropna：如果列的所有值都是NaN，将不作为计算列，默认True
		margins_name：汇总行的命名
		observed：是否显示观测值，默认False
		sort：是否排序，默认True
'''</span>
<span class="token comment"># example</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
city <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'日期'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'2022'</span><span class="token punctuation">,</span> <span class="token string">'2022'</span><span class="token punctuation">,</span> <span class="token string">'2024'</span><span class="token punctuation">,</span> <span class="token string">'2022'</span><span class="token punctuation">,</span> <span class="token string">'2023'</span><span class="token punctuation">,</span> <span class="token string">'2024'</span><span class="token punctuation">,</span> <span class="token string">'2022'</span><span class="token punctuation">,</span> <span class="token string">'2024'</span><span class="token punctuation">,</span> <span class="token string">'2024'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                     <span class="token string">'城市'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'上海'</span><span class="token punctuation">,</span> <span class="token string">'上海'</span><span class="token punctuation">,</span> <span class="token string">'上海'</span><span class="token punctuation">,</span> <span class="token string">'北京'</span><span class="token punctuation">,</span> <span class="token string">'北京'</span><span class="token punctuation">,</span> <span class="token string">'北京'</span><span class="token punctuation">,</span> <span class="token string">'南京'</span><span class="token punctuation">,</span> <span class="token string">'南京'</span><span class="token punctuation">,</span> <span class="token string">'南京'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                     <span class="token string">'GDP(万亿)'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
city <span class="token operator">=</span> city<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token string">'日期'</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token string">'城市'</span><span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token string">'GDP(万亿)'</span><span class="token punctuation">,</span> aggfunc<span class="token operator">=</span><span class="token string">'sum'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>city<span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''------------------------------------------------------------------------------------------------'''</span>

<span class="token triple-quoted-string string">'''
方法（3）：DataFrame.melt()（将DataFrame从宽格式转换成长格式）
	参数：
		id_vars：指定了应该保持不变的列
		value_vars：指定了我们想要melt或将其整形成行的列
		var_name：存储来自 value_vars 的标头名称的新列的名称
		value_name：存储 value_vars 中的值的新列的名称
		col_level：如果列是多层索引，melt将应用于指定级别
		ignore_index：默认为True，相当于从0开始重新排序。如果为False，则保留原来的索引，索引标签将出现重复
'''</span>
<span class="token comment"># example</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
result<span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'数学'</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                     <span class="token punctuation">[</span><span class="token string">'语文'</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                     <span class="token punctuation">[</span><span class="token string">'英语'</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'课程'</span><span class="token punctuation">,</span> <span class="token string">'小张'</span><span class="token punctuation">,</span> <span class="token string">'小明'</span><span class="token punctuation">,</span> <span class="token string">'小红'</span><span class="token punctuation">,</span> <span class="token string">'小赵'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
result<span class="token operator">=</span> result<span class="token punctuation">.</span>melt<span class="token punctuation">(</span>
    id_vars<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"课程"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    value_vars<span class="token operator">=</span>result<span class="token punctuation">.</span>columns<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    var_name<span class="token operator">=</span><span class="token string">'姓名'</span><span class="token punctuation">,</span>
    value_name<span class="token operator">=</span><span class="token string">'成绩'</span>
<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="9_461"></a>9、排序</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
方法（1）：DataFrame.sort_values()
	参数：
		by：指定要进行排序的列名或索引值
		axis：默认axis=0
			axis=0 或 index：则按照指定列的数据大小排序
			axis=1 或 columns：则按照指定索引中数据大小排序
		ascending：默认为True，如果这是一个 bool 列表，则必须匹配 by 的长度
			ascending=True：则按照升序排序
			ascending=False：则按降序排序
		inplace：排序后的数据是否替换原来的数据，默认为False，即不替换
		ignore_index：是否重置索引，默认为不重置
'''</span>
<span class="token comment"># example</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
result <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'数学'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                       <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'数学'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                       <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'数学'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                       <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'数学'</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                       <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'数学'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'课程'</span><span class="token punctuation">,</span> <span class="token string">'分数'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token string">'Int64'</span><span class="token punctuation">,</span> <span class="token string">'课程'</span><span class="token punctuation">:</span> <span class="token string">'str'</span><span class="token punctuation">,</span> <span class="token string">'分数'</span><span class="token punctuation">:</span> <span class="token string">'Int64'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
result <span class="token operator">=</span> result<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'分数'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''------------------------------------------------------------------------------------------------'''</span>

<span class="token triple-quoted-string string">'''
方法（2）：DataFrame.rank()
	参数：
		axis：0或index，1或columns，默认0，沿着行或列计算排名
		method：默认average，如何对具有相同值的记录组进行排名
			average：组的平均等级
			min：组中最低的排名
			max：组中最高等级
			first：按排列顺序排列，依次排列
			dense：类似于 min，但组之间的排名始终提高1
		numeric_only：是否仅仅计算数字型的columns
		na_option：默认keep，NaN值是否参与排名及如何排名
			keep：将NaN等级分配给NaN值
			top：如果升序，则将最小等级分配给NaN值
			bottom：如果升序，则将最高等级分配给NaN值
		ascending：默认True，元素是否应该按升序排名
		pct：默认False，是否以百分比形式显示返回的排名
'''</span>
<span class="token comment"># example</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
result <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'数学'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                       <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'数学'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                       <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'数学'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                       <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'数学'</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                       <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'数学'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'课程'</span><span class="token punctuation">,</span> <span class="token string">'分数'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token string">'Int64'</span><span class="token punctuation">,</span> <span class="token string">'课程'</span><span class="token punctuation">:</span> <span class="token string">'str'</span><span class="token punctuation">,</span> <span class="token string">'分数'</span><span class="token punctuation">:</span> <span class="token string">'Int64'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
result<span class="token punctuation">[</span><span class="token string">'rank'</span><span class="token punctuation">]</span> <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token string">'分数'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rank<span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">'min'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="10_519"></a>10、数据分组</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
方法（1）：DataFrame.groupby()
	参数：
		by：指定分组依据
		axis：默认0，用于指定分割方向
			0 or index: 按行索引分割
			1 or columns： 按列索引分割
		level：指定多层索引的层级编号或层级名称
		as_index：排序方法（升序或降序）
		sort：是否对组名排序
		group_keys：是否返回组键，default True
			group_keys=True，分组的键会作为结果的索引
			group_keys=False，分组的键不会作为索引
		observed：只显示观测值或显示所有值
			True: 只显示分类分组器（groupers）的观察值（observed values），而不显示未观察到的值
			False: 则显示所有分类分组器的可能值，包括未在实际数据中观察到的值。
		dropna：用于控制 groupby 对象的行数索引是否可以包含缺失值，舍弃缺失值的动作，是在分组前完成的
			True，如果组键包含缺失值，则将缺失值与行/列一起删除
			False，保留缺失值
'''</span>
<span class="token comment"># example</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

result <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'一班'</span><span class="token punctuation">,</span> <span class="token string">'小张'</span><span class="token punctuation">,</span> <span class="token number">178</span><span class="token punctuation">,</span> <span class="token number">130</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                       <span class="token punctuation">[</span><span class="token string">'一班'</span><span class="token punctuation">,</span> <span class="token string">'小明'</span><span class="token punctuation">,</span> <span class="token number">168</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                       <span class="token punctuation">[</span><span class="token string">'一班'</span><span class="token punctuation">,</span> <span class="token string">'小红'</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                       <span class="token punctuation">[</span><span class="token string">'二班'</span><span class="token punctuation">,</span> <span class="token string">'小红'</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                       <span class="token punctuation">[</span><span class="token string">'二班'</span><span class="token punctuation">,</span> <span class="token string">'小赵'</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'班级'</span><span class="token punctuation">,</span> <span class="token string">'姓名'</span><span class="token punctuation">,</span> <span class="token string">'身高'</span><span class="token punctuation">,</span> <span class="token string">'体重'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># result = result.groupby(by='班级')['身高'].mean().reset_index()</span>
result <span class="token operator">=</span> result<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'班级'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'身高'</span><span class="token punctuation">:</span> <span class="token string">'mean'</span><span class="token punctuation">,</span> <span class="token string">'体重'</span><span class="token punctuation">:</span> <span class="token string">'mean'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="11excel_555"></a>11、处理excel</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
方法（1）：pandas.read_excel()
	参数：
		io：读取文件的绝对路径，str，Excel文件，xlrd.Book，路径对象或类似文件的对象
		sheetname：通过sheet位置或sheet名字来指定读入哪个sheet的数据，默认0，获取第一个工作表
		header：用第几行作为表头，默认header=0，即默认第一行为表头
		names：自定义表头的名称，需要传递数组参数
		index_col：指定列为索引列，默认为None，也就是索引为0的列用作DataFrame的行标签
		usecols：默认为None，解析所有列
			如果为str，则表示Excel列字母和列范围的逗号分隔列表（usecols='A,C,E'），范围全闭
			如果为int，则表示解析到第几列
			如果为int列表，则表示解析那几列
		squeeze：默认为False。如果设置squeeze=True则表示如果解析的数据只包含一列，则返回一个Series
		dtype：列的类型名称或字典，默认为None，也就是不改变数据类型
		engine：指定解析数据时使用的引擎，默认为None，pandas会自动判断数据格式进行引擎的使用
			xlrd支持旧式的Excel文件，如xls文件，pandas1.2.0发生变化，xlrd引擎现在只支持解析xls文件
			openpyxl支持较新的Excel文件格式
			odf支持OpenDocument文件格式如odf，ods，odt
			pyxlsb支持二进制Excel文件
		converters：对指定列的数据进行指定函数的处理，传入参数为列名与函数组成的字典
		true_values：将指定的文本转换为True，默认为None
		false_values：将指定的文本转换为False，默认为None，（将性别中的女转换为True，男转换为False）
		skiprows：跳过指定的行，第一行开始（skiprows=lambda x: x % 2 == 0 ；跳过偶数行）
		nrows：默认为None，指定需要读取前多少行，通常用于较大的数据文件中
		na_values：指定某些列的某些值为NaN
		na_filter：检测缺失值
		keep_default_na：导入数据时是否导入空值，默认为True，即自动识别空值并导入
		verbose：显示列表中除去数字列，NA值的数量
		parse_dates：默认值False，解析的日期
		date_parser：用于将字符串列转换为datetime实例的函数，默认使用dateutil.parser.parser进行转换
		thousands：默认值None，千分位符
		comment：设置注释符号，注释掉行的其余内容。将一个或多个字符串传递给此参数以在输入文件中指示注释
			注释字符串与当前行结尾之间的任何数据都将被忽略
		skipfooter：跳过指定的行，最后一行开始
		convert_float：默认为 True，将浮点整数转换为整数，如果为False，则所有数字数据都将作为浮点数读取
		mangle_dupe_cols：默认值True，当列名有重复时，将列名解析为‘X’, ‘X.1’, …’X.N’
			如果该参数为False，那么当列名中有重复时，前列会被后列覆盖
'''</span>
<span class="token comment"># example</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">r'excel文件路径'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''------------------------------------------------------------------------------------------------'''</span>

<span class="token triple-quoted-string string">'''
方法（2）：DataFrame.to_excel()
	参数：
		excel_writer: 用来指定写入文件的路径和文件名，路径支持相对路径和绝对路径
        sheet_name: 指定输出表格存放的工作表名称，默认为'Sheet1'
        na_rep:设置缺失数据的表示方式，默认为空字符串
        float_format: 用于格式化浮点数字符串
        columns: 设置要写入文件的列，默认为None，表示写入全部列
        header: 是否写入表头，也可重新设置表头
        	True（默认）：写入表头，保持原有表头内容不变
        	False：不写入表头，从输出文件的第一行开始就写入数据
        	字符串列表：写入表头，但将表头中的各列名称重新命名
        index: 是否写入索引列作为输出表格的第一列，默认为True，通常设置为False
        index_label: 仅当index=True时有效，设置（或重设）索引列的名称放在表头，默认为None，即保持原有列名（在读入时以index_col选项指定的索引列名，未指定则为空白）
        startrow: 用于设定写入Excel文件的起始行数（均从0开始编号）
        startcol: 用于设定写入Excel文件的起始列数（均从0开始编号）
        engine: 用于写入Excel的引擎，默认为openpyxl
        merge_cells: 是否合并单元格，默认为True
        inf_rep: 默认值为inf，它通常表示无穷大
        freeze_panes: 用于指定要冻结的最底部一行和最右边一列
        storage_options: 字典，可选，对特定存储连接（例如主机、端口、用户名、密码等）有意义的额外选项
        engine_kwargs:
'''</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'小赵'</span><span class="token punctuation">,</span> <span class="token string">'小明'</span><span class="token punctuation">,</span> <span class="token string">'小红'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
df<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span><span class="token string">'excel路径'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre> 
<hr> 
<h2><a id="_632"></a>总结</h2> 
<p>如果该篇文章有，没有涉及到的地方（Pandas相关内容），可以评论留言提醒，我会及时更新！💪<br> Pandas 官网： <a href="https://pandas.pydata.org/" rel="nofollow">https://pandas.pydata.org/</a><br> Pandas 源代码：<a href="https://github.com/pandas-dev/pandas">https://github.com/pandas-dev/pandas</a><br> Leetcode 官网：<a href="https://leetcode.cn/" rel="nofollow">https://leetcode.cn/</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/640770c7ecac52de1ba184fb1c2d1c50/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Unity】 HTFramework框架（五十二）使用 HybridCLR 热更新</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8e135565881d28ff0db5628f88731bcd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MySQL 死锁问题排查与分析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>