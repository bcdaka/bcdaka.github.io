<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【MySQL】表的增删查改 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/9607703dfa904664044d2e2842453d31/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【MySQL】表的增删查改">
  <meta property="og:description" content="表的增删查改 1.插入1.1单行数据 全列插入&#43;指定列插入1.2多行数据 全列插入&#43;指定例插入1.2插入否则更新1.4替换 2.查找2.1select 列2.2where 条件2.3结果排序2.4筛选分页结果 3.更新4.删除5.插入查询结果6.聚合函数7.分组查询 点赞👍👍收藏🌟🌟关注💖💖
你的支持是对我最大的鼓励，我们一起努力吧!😃😃
CRUD : Create(创建)， Retrieve(读取)，Update(更新)，Delete（删除）
1.插入 语法：
INSERT [INTO] table_name [(column [, column] ...)] #列字段 VALUES (value_list) [, (value_list)] ... #列字段的内容 value_list: value, [, value] ... 案例：
-- 创建一张学生表 CREATE TABLE students ( id INT UNSIGNED PRIMARY KEY AUTO_INCREMENT, sn INT NOT NULL UNIQUE COMMENT &#39;学号&#39;, name VARCHAR(20) NOT NULL, qq VARCHAR(20) ); 1.1单行数据 全列插入&#43;指定列插入 指定列插入
列字段和列字段的内容一定要一一匹配
insert into student (sn,name,qq) values (123,&#39;张飞&#39;,&#39;12345&#39;); 全列插入">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-07T09:22:19+08:00">
    <meta property="article:modified_time" content="2024-06-07T09:22:19+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【MySQL】表的增删查改</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>表的增删查改</h4> 
 <ul><li><a href="#1_8" rel="nofollow">1.插入</a></li><li><ul><li><a href="#11__31" rel="nofollow">1.1单行数据 全列插入+指定列插入</a></li><li><a href="#12__56" rel="nofollow">1.2多行数据 全列插入+指定例插入</a></li><li><a href="#12_70" rel="nofollow">1.2插入否则更新</a></li><li><a href="#14_105" rel="nofollow">1.4替换</a></li></ul> 
  </li><li><a href="#2_120" rel="nofollow">2.查找</a></li><li><ul><li><a href="#21select__157" rel="nofollow">2.1select 列</a></li><li><a href="#22where__203" rel="nofollow">2.2where 条件</a></li><li><a href="#23_419" rel="nofollow">2.3结果排序</a></li><li><a href="#24_491" rel="nofollow">2.4筛选分页结果</a></li></ul> 
  </li><li><a href="#3_554" rel="nofollow">3.更新</a></li><li><a href="#4_604" rel="nofollow">4.删除</a></li><li><a href="#5_702" rel="nofollow">5.插入查询结果</a></li><li><a href="#6_769" rel="nofollow">6.聚合函数</a></li><li><a href="#7_857" rel="nofollow">7.分组查询</a></li></ul> 
</div> 
<p></p> 
<p><img src="https://images2.imgbox.com/f4/23/YbbUtC9b_o.jpg" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>点赞</strong>👍👍<strong>收藏</strong>🌟🌟<strong>关注</strong>💖💖<br> <font color="red"><strong>你的支持是对我最大的鼓励，我们一起努力吧!😃😃</strong></font></p> 
</blockquote> 
<p>CRUD : Create(创建)， Retrieve(读取)，Update(更新)，Delete（删除）</p> 
<h2><a id="1_8"></a>1.插入</h2> 
<p>语法：</p> 
<pre><code class="prism language-cpp">INSERT <span class="token punctuation">[</span>INTO<span class="token punctuation">]</span> table_name
	<span class="token punctuation">[</span><span class="token punctuation">(</span>column <span class="token punctuation">[</span><span class="token punctuation">,</span> column<span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span> #列字段
	<span class="token function">VALUES</span> <span class="token punctuation">(</span>value_list<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>value_list<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> #列字段的内容
	
value_list<span class="token operator">:</span> value<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> value<span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> 
<p>案例：</p> 
<pre><code class="prism language-cpp"><span class="token operator">--</span> 创建一张学生表
CREATE TABLE <span class="token function">students</span> <span class="token punctuation">(</span>
	id INT UNSIGNED PRIMARY KEY AUTO_INCREMENT<span class="token punctuation">,</span>
	sn INT NOT <span class="token constant">NULL</span> UNIQUE COMMENT <span class="token char">'学号'</span><span class="token punctuation">,</span>
	name <span class="token function">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> NOT <span class="token constant">NULL</span><span class="token punctuation">,</span>
	qq <span class="token function">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="11__31"></a>1.1单行数据 全列插入+指定列插入</h3> 
<blockquote> 
 <p><strong>指定列插入</strong></p> 
</blockquote> 
<p>列字段和列字段的内容一定要一一匹配</p> 
<pre><code class="prism language-cpp">insert into <span class="token function">student</span> <span class="token punctuation">(</span>sn<span class="token punctuation">,</span>name<span class="token punctuation">,</span>qq<span class="token punctuation">)</span> <span class="token function">values</span> <span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token char">'张飞'</span><span class="token punctuation">,</span><span class="token char">'12345'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c3/74/3GYVlpzw_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>全列插入</strong></p> 
</blockquote> 
<p>全列插入有两种方式，一个是省略 valiues 左侧字段名，一个是都指定</p> 
<pre><code class="prism language-cpp">insert into students <span class="token function">values</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">124</span><span class="token punctuation">,</span><span class="token char">'关羽'</span><span class="token punctuation">,</span><span class="token char">'13245'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
insert into <span class="token function">students</span> <span class="token punctuation">(</span>id<span class="token punctuation">,</span>sn<span class="token punctuation">,</span>name<span class="token punctuation">,</span>qq<span class="token punctuation">)</span> <span class="token function">values</span> <span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">125</span><span class="token punctuation">,</span><span class="token char">'刘备'</span><span class="token punctuation">,</span><span class="token char">'14525'</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/bf/0b/QkGRhLzj_o.png" alt="在这里插入图片描述"></p> 
<p><strong>可以省略into</strong></p> 
<pre><code class="prism language-cpp">insert <span class="token function">students</span> <span class="token punctuation">(</span>sn<span class="token punctuation">,</span>name<span class="token punctuation">,</span>qq<span class="token punctuation">)</span> <span class="token function">values</span> <span class="token punctuation">(</span><span class="token number">126</span><span class="token punctuation">,</span><span class="token char">'诸葛亮'</span><span class="token punctuation">,</span><span class="token char">'12525'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e1/9b/s50ZQjMs_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="12__56"></a>1.2多行数据 全列插入+指定例插入</h3> 
<blockquote> 
 <p><strong>指定列多行插入</strong></p> 
</blockquote> 
<pre><code class="prism language-cpp"> insert <span class="token function">students</span> <span class="token punctuation">(</span>sn<span class="token punctuation">,</span>name<span class="token punctuation">,</span>qq<span class="token punctuation">)</span> <span class="token function">values</span> <span class="token punctuation">(</span><span class="token number">127</span><span class="token punctuation">,</span><span class="token char">'曹操'</span><span class="token punctuation">,</span><span class="token char">'15256'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token char">'许攸'</span><span class="token punctuation">,</span><span class="token char">'23445'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e9/36/HxRcFWOC_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>全列多行插入</strong></p> 
</blockquote> 
<pre><code class="prism language-cpp">insert students <span class="token function">values</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">129</span><span class="token punctuation">,</span><span class="token char">'孙权'</span><span class="token punctuation">,</span><span class="token char">'12256'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">130</span><span class="token punctuation">,</span><span class="token char">'吕布'</span><span class="token punctuation">,</span><span class="token char">'33445'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/88/be/6aAmfSfY_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="12_70"></a>1.2插入否则更新</h3> 
<p>由于 <strong>主键</strong> 或者 <strong>唯一键</strong> 对应的值已经存在而导致插入失败</p> 
<p><img src="https://images2.imgbox.com/3f/d2/gDhTneaM_o.png" alt="在这里插入图片描述"></p> 
<p>但是我就是想让它先确认是不是在数据库中存在，不存在就插入，存在不要拦我然后执行后面的修改语句</p> 
<p>选择性的进行同步更新操作 语法：</p> 
<pre><code class="prism language-cpp">INSERT <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> ON DUPLICATE KEY UPDATE
	column <span class="token operator">=</span> value <span class="token punctuation">[</span><span class="token punctuation">,</span> column <span class="token operator">=</span> value<span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> 
<p>如果不存在就插入，存在发生主键或者唯一键冲突不要报错就行后面的修改语句</p> 
<pre><code class="prism language-cpp">insert into students <span class="token function">values</span> <span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token char">'周瑜'</span><span class="token punctuation">,</span><span class="token char">'56321'</span><span class="token punctuation">)</span> on duplicate key update sn<span class="token operator">=</span><span class="token number">111</span><span class="token punctuation">,</span>name<span class="token operator">=</span><span class="token char">'周瑜'</span><span class="token punctuation">,</span>qq<span class="token operator">=</span><span class="token number">56321</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/56/d3/B5REEvzN_o.png" alt="在这里插入图片描述"></p> 
<p><strong>注意更新的值不能和其他的主键和唯一键冲突，否则不能更新</strong></p> 
<p><img src="https://images2.imgbox.com/f9/57/gDWYpf2F_o.png" alt="在这里插入图片描述"></p> 
<ul><li>0 row affected: 表中有冲突数据，但冲突数据的值和 update 的值相等</li><li>1 row affected: 表中没有冲突数据，数据被插入</li><li>2 row affected: 表中有冲突数据，并且数据已经被更新</li></ul> 
<p>通过 MySQL 函数获取受到影响的数据行数</p> 
<pre><code class="prism language-cpp">select <span class="token function">row_count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/42/17/hnQS8LJu_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="14_105"></a>1.4替换</h3> 
<p>主键 或者 唯一键 没有冲突，则直接插入；<br> 主键 或者 唯一键 如果冲突，则删除后再插入</p> 
<pre><code class="prism language-cpp">REPLACE INTO <span class="token function">students</span> <span class="token punctuation">(</span>sn<span class="token punctuation">,</span>name<span class="token punctuation">,</span>qq<span class="token punctuation">)</span> <span class="token function">values</span> <span class="token punctuation">(</span><span class="token number">131</span><span class="token punctuation">,</span><span class="token char">'孙悟空'</span><span class="token punctuation">,</span><span class="token char">'98752'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>1 row affected: 表中没有冲突数据，数据被插入</li><li>2 row affected: 表中有冲突数据，删除后重新插入</li></ul> 
<p><img src="https://images2.imgbox.com/2d/5b/4a8PeOKk_o.png" alt="在这里插入图片描述"></p> 
<p>这里从id就可以看到是删除后插入的，因为id是自增的，刚才是22，现在是23了</p> 
<h2><a id="2_120"></a>2.查找</h2> 
<p>语法：</p> 
<pre><code class="prism language-cpp">SELECT
	<span class="token punctuation">[</span>DISTINCT<span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span><span class="token operator">*</span> <span class="token operator">|</span> <span class="token punctuation">{<!-- --></span>column <span class="token punctuation">[</span><span class="token punctuation">,</span> column<span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
	<span class="token punctuation">[</span>FROM table_name<span class="token punctuation">]</span> # 从那个表筛选
	<span class="token punctuation">[</span>WHERE <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span> # 筛选条件
	<span class="token punctuation">[</span>ORDER BY column <span class="token punctuation">[</span>ASC <span class="token operator">|</span> DESC<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span> # 对筛选结果排序
	LIMIT <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> # 限定筛选出来的条数
</code></pre> 
<p><font color="red"><strong>distinct：对内容进行去重</strong></font><br> *：全列查询<br> column，column…：指定列查询</p> 
<p>案例：</p> 
<pre><code class="prism language-cpp"><span class="token operator">--</span> 创建表结构
CREATE TABLE <span class="token function">exam_result</span> <span class="token punctuation">(</span>
	id INT UNSIGNED PRIMARY KEY AUTO_INCREMENT<span class="token punctuation">,</span>
	name <span class="token function">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> NOT <span class="token constant">NULL</span> COMMENT <span class="token char">'同学姓名'</span><span class="token punctuation">,</span>
	chinese <span class="token keyword">float</span> DEFAULT <span class="token number">0.0</span> COMMENT <span class="token char">'语文成绩'</span><span class="token punctuation">,</span>
	math <span class="token keyword">float</span> DEFAULT <span class="token number">0.0</span> COMMENT <span class="token char">'数学成绩'</span><span class="token punctuation">,</span>
	english <span class="token keyword">float</span> DEFAULT <span class="token number">0.0</span> COMMENT <span class="token char">'英语成绩'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">--</span> 插入测试数据
INSERT INTO <span class="token function">exam_result</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> chinese<span class="token punctuation">,</span> math<span class="token punctuation">,</span> english<span class="token punctuation">)</span> <span class="token function">VALUES</span>
	<span class="token punctuation">(</span><span class="token char">'唐三藏'</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">(</span><span class="token char">'孙悟空'</span><span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">,</span> <span class="token number">77</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">(</span><span class="token char">'猪悟能'</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">(</span><span class="token char">'曹孟德'</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">(</span><span class="token char">'刘玄德'</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">(</span><span class="token char">'孙权'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">(</span><span class="token char">'宋公明'</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="21select__157"></a>2.1select 列</h3> 
<blockquote> 
 <p><strong>全列查询</strong></p> 
</blockquote> 
<p>通常情况下不建议使用 * 进行全列查询</p> 
<ul><li> 
  <ol><li>查询的列越多，意味着需要传输的数据量越大；</li></ol> </li><li> 
  <ol start="2"><li>可能会影响到索引的使用。（索引后面再说）</li></ol> </li></ul> 
<pre><code class="prism language-powershell"><span class="token function">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> exam_result<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a2/d1/A8brCES4_o.png" alt="在这里插入代码片"></p> 
<blockquote> 
 <p><strong>指定列查询</strong></p> 
</blockquote> 
<p>指定列的顺序不需要按定义表的顺序来</p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> id<span class="token punctuation">,</span>name<span class="token punctuation">,</span>chinese <span class="token keyword">from</span> exam_result<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f9/18/GpVpK1Vg_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>查询字段为表达式</strong></p> 
</blockquote> 
<p>select非常特殊，后面可以跟select 自带的子句，筛选条件等，也可以跟 <strong>表达式</strong></p> 
<p><img src="https://images2.imgbox.com/c6/74/L0Li9tDy_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>为查询结果指定别名</strong></p> 
</blockquote> 
<p>语法：</p> 
<pre><code class="prism language-powershell"><span class="token function">SELECT</span> column <span class="token namespace">[AS]</span> alias_name <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span> <span class="token keyword">FROM</span> table_name<span class="token punctuation">;</span>
</code></pre> 
<p>可带as，可不带</p> 
<p><img src="https://images2.imgbox.com/9e/f9/sQJRtT8J_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>结果去重</strong></p> 
</blockquote> 
<pre><code class="prism language-powershell"><span class="token function">select</span> distinct math <span class="token keyword">from</span> exam_result<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b1/1b/uSKwKHvt_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="22where__203"></a>2.2where 条件</h3> 
<p>刚刚是对表的整体信息做筛选，但是实际在做查询的时候一定有筛选条件。按条件筛选影响的是未来显示出来信息的条目数或者说是行数，以前是按列位单位把全部行都拿出来了。如果一列想拿那些行由where条件来决定。</p> 
<p>where是筛选子句，后面可以跟特定的比较运算符来决策我们应该如何进行筛选，<br> where就有点像C/C++里面的if语句，根据后面条件进行判断。</p> 
<p><strong>比较运算符</strong></p> 
<table><thead><tr><th align="left">运算符</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">&gt;, &gt;=, &lt;, &lt;=</td><td align="left">大于，大于等于，小于，小于等于</td></tr><tr><td align="left">=</td><td align="left">等于，NULL 不安全，例如 NULL = NULL 的结果是 NULL</td></tr><tr><td align="left">&lt;=&gt;</td><td align="left">等于，NULL 安全，例如 NULL &lt;=&gt; NULL 的结果是 TRUE(1)</td></tr><tr><td align="left">!=, &lt;&gt;</td><td align="left">不等于</td></tr><tr><td align="left">BETWEEN a0 AND a1</td><td align="left">范围匹配，[a0, a1]，如果 a0 &lt;= value &lt;= a1，返回 TRUE(1)</td></tr><tr><td align="left">IN (option, …)</td><td align="left">如果是 option 中的任意一个，返回 TRUE(1)</td></tr><tr><td align="left">IS NULL</td><td align="left">是 NULL</td></tr><tr><td align="left">IS NOT NULL</td><td align="left">不是 NULL</td></tr><tr><td align="left">LIKE</td><td align="left">模糊匹配。% 表示任意多个（包括 0 个）任意字符；_ 表示任意一个字符</td></tr></tbody></table> 
<p>&lt;,&lt;=,&gt;,&gt;= 通常用来比较整数和浮点数，判断条件是否满足</p> 
<p>= 判断字符串和数组是否相等，另外 = 判断是否等于null是不安全的，而且null和0表示的是不同含义，null真的就是null什么都没有，0就是0。</p> 
<p><img src="https://images2.imgbox.com/36/0e/SfQmnnTl_o.png" alt="在这里插入图片描述"></p> 
<p>= 时两侧进行null值比较，是不能参与运算的</p> 
<p><img src="https://images2.imgbox.com/c9/20/dvqqTRQZ_o.png" alt="在这里插入图片描述"></p> 
<p>如果想判断null是否相等 使用 &lt;=&gt;</p> 
<p><img src="https://images2.imgbox.com/80/f6/5Wqjuk59_o.png" alt="在这里插入图片描述"></p> 
<p>不过一般也不这样去判断，一般更喜欢用 IS NULL 去判断一个值是否是null</p> 
<p><img src="https://images2.imgbox.com/8b/c5/NwPah4Hx_o.png" alt="在这里插入图片描述"></p> 
<p><strong>总之： = 只能进行数字和字符串的比较，不能用数字和null或者两个null是否相等比较，判断一个值是否等于null 建议用 IS NULL</strong></p> 
<p>!= 也只能用来数字和字符串比较，不能和null进行比较，并且&lt;&gt;也是一样的，建议用 IS NOT NULL</p> 
<p><img src="https://images2.imgbox.com/00/0c/tQepy0s8_o.png" alt="在这里插入图片描述"></p> 
<p>between a0 and a1 要求范围在【a0，a1】<br> in(option，…) 要求结果必须在(option，…) 这个范围<br> like 后面具体例子再说</p> 
<p><strong>逻辑运算符</strong></p> 
<table><thead><tr><th align="left">运算符</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">AND</td><td align="left">多个条件必须都为 TRUE(1)，结果才是 TRUE(1)</td></tr><tr><td align="left">OR</td><td align="left">任意一个条件为 TRUE(1), 结果为 TRUE(1)</td></tr><tr><td align="left">NOT</td><td align="left">条件为 TRUE(1)，结果为 FALSE(0)</td></tr></tbody></table> 
<p>and 条件都要满足，or 满足一个条件就可以，not 不满足条件为真</p> 
<p>下面以具体案例熟悉上面的操作：</p> 
<p><strong>英语不及格的同学及英语成绩 ( &lt; 60 )</strong></p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> name<span class="token punctuation">,</span>english <span class="token keyword">from</span> exam_result where english&lt;60<span class="token punctuation">;</span>
</code></pre> 
<p>以前没带筛选条件直接显示一列，现在带上筛选条件显示出这列符合条件的</p> 
<p><img src="https://images2.imgbox.com/db/2f/PcuAPZdI_o.png" alt="在这里插入图片描述"></p> 
<p>可以看到select 后面跟的是要显示那些列，如果没有where子句就是把指定列所有数据全部显示出来。where条件影响的是你要拿的这些列中所匹配的所有行信息要按条件进行行筛选然后在显示。select 后面影响要那些列，where 后面影响要列中那些行。</p> 
<p><strong>语文成绩在 [80, 90] 分的同学及语文成绩</strong></p> 
<p>使用 AND 进行条件连接</p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> name<span class="token punctuation">,</span>chinese <span class="token keyword">from</span> exam_result where chinese&gt;=80 and chinese&lt;=90<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/35/84/XKDZKzOi_o.png" alt="在这里插入图片描述"></p> 
<p>使用 BETWEEN … AND … 条件</p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> name<span class="token punctuation">,</span>chinese <span class="token keyword">from</span> exam_result where chinese between 80 and 90<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/35/55/ewX4lc6b_o.png" alt="在这里插入图片描述"></p> 
<p><strong>数学成绩是 58 或者 59 或者 98 或者 99 分的同学及数学成绩</strong></p> 
<p>使用 OR 进行条件连接，满足任意一个就为真</p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> name<span class="token punctuation">,</span>math <span class="token keyword">from</span> exam_result where math=58 or math=59 or math=98 or math=99<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/83/da/Bhj83b6i_o.png" alt="在这里插入图片描述"></p> 
<p>使用 IN 条件，满足()里任意一个就为真</p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> name<span class="token punctuation">,</span>math <span class="token keyword">from</span> exam_result where math in<span class="token punctuation">(</span>58<span class="token punctuation">,</span>59<span class="token punctuation">,</span>98<span class="token punctuation">,</span>99<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/4c/a6/lGNM0IzU_o.png" alt="在这里插入图片描述"></p> 
<p><strong>姓孙的同学 及 孙某同学</strong></p> 
<p>有时候匹配并不给具体值的更细节的字段含义，可能就只给一个模糊搜索的关键字。就如上面。反正条件不给全就给一个模糊的条件。我们就可以用like 模糊匹配</p> 
<p><img src="https://images2.imgbox.com/f2/e8/lU2fMOpq_o.png" alt="在这里插入图片描述"></p> 
<p>% 匹配任意多个（包括 0 个）任意字符</p> 
<p>注意mysql可以用 ‘ ’ 或者 “ “表示字符串</p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> name <span class="token keyword">from</span> exam_result where name like <span class="token string">'孙%'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e1/6f/tHa3kwAw_o.png" alt="在这里插入图片描述"></p> 
<p>_ 匹配严格的一个任意字符</p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> name <span class="token keyword">from</span> exam_result where name like <span class="token string">'孙_'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/38/1d/hxj8fRXl_o.png" alt="在这里插入图片描述"></p> 
<p><strong>语文成绩好于英语成绩的同学</strong></p> 
<p>WHERE 条件即可以是一列和常数、一列和字符串、一列模糊匹配，一列跟另一个列比较</p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> name<span class="token punctuation">,</span>chinese<span class="token punctuation">,</span>english <span class="token keyword">from</span> exam_result where chinese&gt;english<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/63/02/3D0oM5rp_o.png" alt="在这里插入图片描述"></p> 
<p><strong>总分在 200 分以下的同学</strong></p> 
<p>可以看到where后面也有跟表达式</p> 
<p><img src="https://images2.imgbox.com/f0/eb/pKV1oWEd_o.png" alt="在这里插入图片描述"></p> 
<p>曾经不是说过可以对列进行重命名吗，那where后面还用写这么一大堆吗</p> 
<p><img src="https://images2.imgbox.com/c2/6a/2s3IV1Ba_o.png" alt="在这里插入图片描述"></p> 
<p>我们发现它报错了，未知列total，我们不是做过重命名吗。这个total不是已经有了吗，怎么这里报不知道total呢？</p> 
<p>这里我们就需要讨论一些东西了<br> 问：<strong>from这个表，where这个条件判断和select指明要显示的列，整个sql语句的执行顺序是什么？</strong></p> 
<p><img src="https://images2.imgbox.com/da/fc/WMNhhCdD_o.png" alt="在这里插入图片描述"></p> 
<p>说明一下sql这里语句执行顺序非常重要，后面还有order by、limit等，你怎么知道谁先执行呢？所以这个顺序一定要搞清楚。</p> 
<p>那这里为什么where 后面无法使用重命名的别名呢？</p> 
<p>很简单，我们一定是先执行from，在执行where，然后在执行select。</p> 
<p><img src="https://images2.imgbox.com/53/c1/8obfLNPS_o.png" alt="在这里插入图片描述"></p> 
<p><strong>因为是从1中带着2去3中筛选，也就是说你先告诉我们从那个表筛选数据，一定是先给筛选条件，然后拿着筛选条件去筛选。</strong></p> 
<p>以前没有where就不说where的话，现在有where一定是先按照这个条件然后才去筛选的。满足就保留不满足就淘汰。</p> 
<p>这里就是先执行1，在执行2，在执行3，而执行3的时候才有重命名，在执行第2的时候就没有这个别名，所以不认识。</p> 
<p>而且你在where这里重命名也是不行的，对列重命名是属于显示的范畴，相当于是临门一脚把数据都那完了，只是把列名字改一改，属于最后一步了。不能在筛选的时候就重命名，语法不支持</p> 
<p><img src="https://images2.imgbox.com/c5/ef/2uv6Z5GO_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> name<span class="token punctuation">,</span>math+chinese+english total <span class="token keyword">from</span> exam_result where math+chinese+english &lt; 200<span class="token punctuation">;</span>
</code></pre> 
<p>所以这个重命名一定是数据已经筛选出来了，列信息已经拿到了然后在对列进行重命名</p> 
<p><img src="https://images2.imgbox.com/4c/10/x4UbPTav_o.png" alt="在这里插入图片描述"></p> 
<p><strong>语文成绩 &gt; 80 并且不姓孙的同学</strong></p> 
<p>AND 与 NOT 的使用</p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> name<span class="token punctuation">,</span>chinese <span class="token keyword">from</span> exam_result where chinese&gt;80 and name not like <span class="token string">'孙%'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b1/af/XxfofXC0_o.png" alt="在这里插入图片描述"></p> 
<p><strong>孙某同学，否则要求总成绩 &gt; 200 并且 语文成绩 &lt; 数学成绩 并且 英语成绩 &gt; 80</strong></p> 
<p>要么就是孙某同学，要么就得满足后面的一堆要求，总共就两个条件，<strong>在mysql如果条件很多可以用（）把这个条件括起来，表示一个单元</strong></p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> name<span class="token punctuation">,</span>chinese<span class="token punctuation">,</span>math<span class="token punctuation">,</span>english<span class="token punctuation">,</span>chinese+math+english total <span class="token keyword">from</span> exam_result where name like <span class="token string">'孙_'</span> or <span class="token punctuation">(</span>chinese+math+english&gt;200 and chinese&lt;math and english&gt;80<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/58/75/nBFeKgyo_o.png" alt="在这里插入图片描述"></p> 
<p><strong>NULL 的查询</strong></p> 
<p><img src="https://images2.imgbox.com/da/49/eVQRp6pQ_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> name <span class="token keyword">from</span> test where name is null<span class="token punctuation">;</span>
</code></pre> 
<p>这里也可以说明 null 和 ’ ’ 不是一个东西</p> 
<p><img src="https://images2.imgbox.com/ac/03/bKgsM4bx_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> name <span class="token keyword">from</span> test where name is not null<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/cc/a2/rMHvsGqQ_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="23_419"></a>2.3结果排序</h3> 
<p>语法：</p> 
<pre><code class="prism language-powershell"><span class="token function">SELECT</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">FROM</span> table_name <span class="token namespace">[WHERE ...]</span>
	ORDER BY column <span class="token namespace">[ASC|DESC]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>ASC 为升序（从小到大）(ascending)</li><li>DESC 为降序（从大到小）(descding)</li><li>默认为 ASC</li></ul> 
<p><strong>注意：没有 ORDER BY 子句的查询，返回的顺序是未定义的，永远不要依赖这个顺序</strong></p> 
<p><strong>同学及数学成绩，按数学成绩升序显示</strong></p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> name<span class="token punctuation">,</span>math <span class="token keyword">from</span> exam_result order by math asc<span class="token punctuation">;</span>
</code></pre> 
<p>asc可以省略，默认是asc升序</p> 
<p><img src="https://images2.imgbox.com/b7/6e/r62qrQHG_o.png" alt="在这里插入图片描述"></p> 
<p><strong>NULL 视为比任何值都小，升序出现在最上面</strong></p> 
<p><img src="https://images2.imgbox.com/db/27/iiHJqA79_o.png" alt="在这里插入图片描述"></p> 
<p><strong>NULL 视为比任何值都小，降序出现在最下面</strong></p> 
<p><img src="https://images2.imgbox.com/df/81/JGKsf5BG_o.png" alt="在这里插入图片描述"></p> 
<p>最终就想说明的是<strong>NULL 视为比任何值都小</strong></p> 
<p><strong>查询同学各门成绩，依次按 数学降序，英语升序，语文升序的方式显示</strong><br> 每个同学的各门成绩都要查，首先按照数学降序排序，如果数学成绩相同就按英语升序排序，如果数学和英语成绩都相同就按语文升序排序。</p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> name<span class="token punctuation">,</span>math<span class="token punctuation">,</span>english<span class="token punctuation">,</span>chinese <span class="token keyword">from</span> exam_result order by math desc<span class="token punctuation">,</span>english<span class="token punctuation">,</span>chinese<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/54/8f/Vbp1TmWG_o.png" alt="在这里插入图片描述"></p> 
<p><strong>查询同学及总分，由高到低</strong></p> 
<p>ORDER BY 中可以使用表达式</p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> name<span class="token punctuation">,</span>chinese+math+english total <span class="token keyword">from</span> exam_result order by total desc<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a5/da/jRIMOEzg_o.png" alt="在这里插入图片描述"></p> 
<p><strong>为什么在order by这里可以使用别名进行排序，而where后面没有办法使用别名？</strong></p> 
<p>你要对表结构的数据进行排序，一定是得先有数据！有人可能说不是表结构不就天然有数据吗我直接把表结构数据全排完，然后在选行不行。当然可以了。可是数据天然没有经过筛选而直接先排序，排完序在筛，这在技术上肯定可以实现。但你会愿意这样做吗？因为你没有筛选，在排序的时候一定有大批数据其实是不需要排序的，而对这些数据排序本身就是浪费空间和时间，mysql没有这么笨！</p> 
<p>它肯定是先把你要的数据先给你，然后才进行排序。换言之未来执行的时候<br> 。<strong>在表中拿着筛选条件对表指定列筛选，然后对筛选结果进行排序。</strong></p> 
<p><img src="https://images2.imgbox.com/ca/92/GnYp7h4x_o.png" alt="在这里插入图片描述"></p> 
<p><strong>所以能不能用别名，完全是取决于当前sql中子句的执行顺序！</strong></p> 
<p><strong>查询姓孙的同学或者姓曹的同学数学成绩，结果按数学成绩由高到低显示</strong></p> 
<p>根据刚才对order by的理解，一定是先把数据筛选出来，然后再进行排序，</p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> name<span class="token punctuation">,</span>math <span class="token keyword">from</span> exam_result where name like <span class="token string">'孙%'</span> or name like <span class="token string">'曹%'</span> order by math desc<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/12/00/cexQXTVv_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="24_491"></a>2.4筛选分页结果</h3> 
<p>什么是分页呢？</p> 
<p>如果一个表中数据量太大，这个时候如果全列查询就有一大堆，这样不便于查看分析，有时候我们不想一次显示这么多，因此我们就可以对结果进行limit分页。</p> 
<p><img src="https://images2.imgbox.com/84/1d/yUM0bGKn_o.png" alt="在这里插入图片描述"></p> 
<p>所以limit可以对结果进行筛选，它本身没有筛选功能，只能按照它后面跟的数字把要显示的结果按照起始位置和步长给我们显示多条记录。</p> 
<p>语法：</p> 
<pre><code class="prism language-powershell"><span class="token operator">--</span> 起始下标为 0

<span class="token operator">--</span> 从 s 开始，筛选 n 条结果
<span class="token function">SELECT</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">FROM</span> table_name <span class="token namespace">[WHERE ...]</span> <span class="token namespace">[ORDER BY ...]</span> LIMIT s<span class="token punctuation">,</span> n

<span class="token operator">--</span> 从 0 开始，筛选 n 条结果
<span class="token function">SELECT</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">FROM</span> table_name <span class="token namespace">[WHERE ...]</span> <span class="token namespace">[ORDER BY ...]</span> LIMIT n<span class="token punctuation">;</span>


<span class="token operator">--</span> 从 s 开始，筛选 n 条结果，比第二种用法更明确，建议使用
<span class="token function">SELECT</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">FROM</span> table_name <span class="token namespace">[WHERE ...]</span> <span class="token namespace">[ORDER BY ...]</span> LIMIT n OFFSET s<span class="token punctuation">;</span>
</code></pre> 
<p><strong>建议：对未知表进行查询时，最好加一条 LIMIT 1，避免因为表中数据过大，查询全表数据导致数据库卡死</strong></p> 
<p>默认从0下标开始，筛选多条记录</p> 
<p><img src="https://images2.imgbox.com/bb/0f/1it5EXWb_o.png" alt="在这里插入图片描述"></p> 
<p>也可以指定下标开始筛选后面跟的是步长。从指定位置开始，连续读取多条记录</p> 
<p><img src="https://images2.imgbox.com/69/71/TZycBxEM_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> exam_result limit 4 offset 3<span class="token punctuation">;</span>
</code></pre> 
<p>limit 后面跟的是筛选几行，offset 后面跟的是从那行开始</p> 
<p><img src="https://images2.imgbox.com/25/80/fdhHtMyR_o.png" alt="在这里插入图片描述"></p> 
<p>limit 可以进行分页。就比如数据多就可以这样进行分页读</p> 
<p><img src="https://images2.imgbox.com/25/5c/HsnB59sq_o.png" alt="在这里插入图片描述"></p> 
<p>下面想说还是sql子句执行顺序的问题，如下面对总成绩排序后只想拿第一名同学。</p> 
<p><img src="https://images2.imgbox.com/2c/76/gqZryQdS_o.png" alt="在这里插入图片描述"></p> 
<p>也可以进行分页显示</p> 
<p><img src="https://images2.imgbox.com/3b/3f/X4kk0gBr_o.png" alt="在这里插入图片描述"></p> 
<p>我们要分清楚一件事情，我们需要有数据才能排序，只有数据准备好了，你才要显示，limit的本质功能是 ”显示“。 意思就是说你一定是要有数据才能最后显示，显示的时候limit知识告诉mysql，你给我显示的时候是从哪里开始，然后从这个开始位置显示几行。limit不是条件筛选，它的本质还是从表中拿着筛选条件对指定列进行筛选，然后排好序，再limit，所以limit的执行会更靠后。</p> 
<p><img src="https://images2.imgbox.com/cd/20/2f2H8Cfs_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/62/e7/nUKdRS4q_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="3_554"></a>3.更新</h2> 
<p>语法：</p> 
<pre><code class="prism language-powershell">UPDATE table_name <span class="token function">SET</span> column = expr <span class="token punctuation">[</span><span class="token punctuation">,</span> column = expr <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
	<span class="token namespace">[WHERE ...]</span> <span class="token namespace">[ORDER BY ...]</span> <span class="token namespace">[LIMIT ...]</span>
</code></pre> 
<p>set后面跟的是要重新设定的值，可以是多列。一般在update的时候必须采用对应where子句进行条件筛选，如果没有的话会把这个表中指定的列全部都更新，这是不合理的。</p> 
<p><strong>对查询到的结果进行列值更新</strong></p> 
<p><strong>将孙悟空同学的数学成绩变更为 80 分</strong></p> 
<pre><code class="prism language-powershell">update exam_result <span class="token function">set</span> math=80 where name=<span class="token string">'孙悟空'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/13/9e/s836kPfV_o.png" alt="在这里插入图片描述"></p> 
<p><strong>将曹孟德同学的数学成绩变更为 60 分，语文成绩变更为 70 分</strong></p> 
<pre><code class="prism language-powershell">update exam_result <span class="token function">set</span> math=60<span class="token punctuation">,</span>chinese=70 where name=<span class="token string">'曹孟德'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/58/08/Ftd1vuMI_o.png" alt="在这里插入图片描述"></p> 
<p><strong>将总成绩倒数前三的 3 位同学的数学成绩加上 30 分</strong></p> 
<p>更新值为原值基础上变更。<br> 注意据更新，不支持 math += 30 这种语法。</p> 
<pre><code class="prism language-powershell">update exam_result <span class="token function">set</span> math=math+30 order by chinese+math+english limit 3<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8b/60/kUaKJCwg_o.png" alt="在这里插入图片描述"><br> 更新之后可能后三名同学加上数学+30可能就不在后三名了。<br> <img src="https://images2.imgbox.com/38/8d/E9NaAuBB_o.png" alt="在这里插入图片描述"></p> 
<p><strong>将所有同学的语文成绩更新为原来的 2 倍</strong></p> 
<pre><code class="prism language-powershell">update exam_result <span class="token function">set</span> chinese=chinese*2<span class="token punctuation">;</span>
</code></pre> 
<p><strong>注意：更新全表的语句慎用！</strong></p> 
<p><img src="https://images2.imgbox.com/e9/46/lCwROBd6_o.png" alt="在这里插入图片描述"></p> 
<p>一定要谨慎！</p> 
<h2><a id="4_604"></a>4.删除</h2> 
<p>语法：</p> 
<pre><code class="prism language-powershell">DELETE <span class="token keyword">FROM</span> table_name <span class="token namespace">[WHERE ...]</span> <span class="token namespace">[ORDER BY ...]</span> <span class="token namespace">[LIMIT ...]</span>
</code></pre> 
<p>一般都是拿着条件去删除，不加条件就是把整表的内容删除了，不过表结构还在。删表结构drop。</p> 
<p><strong>删除孙悟空同学的考试成绩</strong></p> 
<pre><code class="prism language-powershell">delete <span class="token keyword">from</span> exam_result where name=<span class="token string">'孙悟空'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/76/b2/WyZRiDtq_o.png" alt="在这里插入图片描述"></p> 
<p><strong>删除整张表数据</strong></p> 
<p><strong>注意：删除整表操作要慎用！</strong></p> 
<p>mysql表分为表和表里面的数据，delete重点是删表里面的数据，表结构不受影响，drop才是删表结构。</p> 
<pre><code class="prism language-powershell"><span class="token operator">--</span> 准备测试表
CREATE TABLE for_delete <span class="token punctuation">(</span>
id INT PRIMARY KEY AUTO_INCREMENT<span class="token punctuation">,</span>
name VARCHAR<span class="token punctuation">(</span>20<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token operator">--</span> 插入测试数据
INSERT INTO for_delete <span class="token punctuation">(</span>name<span class="token punctuation">)</span> VALUES <span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'B'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'C'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/46/48/v2O6wAzx_o.png" alt="在这里插入图片描述"></p> 
<p>我们看到这个id设置了自增，目前已经插入三条记录了，如果在插入一条记录这个id就是4了。</p> 
<p>但我们现在不插，先删除</p> 
<pre><code class="prism language-powershell">delete <span class="token keyword">from</span> for_delete<span class="token punctuation">;</span>
</code></pre> 
<p>我们看到表的内容已经没有了，但是查看创建表结构这个语句还在，并且自增长也还在。<br> <img src="https://images2.imgbox.com/b0/70/cJXgxvgM_o.png" alt="在这里插入图片描述"></p> 
<p>当新插入一条记录时这个id是4，并且自增长已经变成下一个id值了</p> 
<p><img src="https://images2.imgbox.com/aa/3c/dqyUxDIR_o.png" alt="在这里插入图片描述"></p> 
<p>说明delete from清空表的方式不会将自增值置0。</p> 
<p>清空表还有一种做法叫做截断表。在效果和delete一模一样，但是在细节和原理是有差别的。</p> 
<p><strong>截断表</strong></p> 
<p>语法：</p> 
<pre><code class="prism language-powershell">TRUNCATE <span class="token namespace">[TABLE]</span> table_name
</code></pre> 
<p><strong>注意：这个操作慎用</strong></p> 
<ol><li>只能对整表操作，不能像 DELETE 一样针对部分数据操作；</li><li>实际上 MySQL 不对数据操作，所以比 DELETE 更快，但是TRUNCATE在删除数据的时候，并不经过真正的事物，所以无法回滚</li><li>会重置 AUTO_INCREMENT 项</li></ol> 
<pre><code class="prism language-powershell"><span class="token operator">--</span> 准备测试表
CREATE TABLE for_truncate <span class="token punctuation">(</span>
id INT PRIMARY KEY AUTO_INCREMENT<span class="token punctuation">,</span>
name VARCHAR<span class="token punctuation">(</span>20<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">--</span> 插入测试数据
INSERT INTO for_truncate <span class="token punctuation">(</span>name<span class="token punctuation">)</span> VALUES <span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'B'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'C'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8a/5e/4lOnCK0k_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-powershell"> truncate for_truncate<span class="token punctuation">;</span>
</code></pre> 
<p>可以看到表结构还在，但是内容已经被清空了。但是这里值得注意的一点是，之前自增长是4，现在truncata清空表后自增从已经没有了。</p> 
<p><img src="https://images2.imgbox.com/a8/0b/bP7ZwHpG_o.png" alt="在这里插入图片描述"></p> 
<p>然后新插一条记录，id变成1了。自增长变成2了</p> 
<p><img src="https://images2.imgbox.com/ea/b9/NeSVt0Lr_o.png" alt="在这里插入图片描述"></p> 
<p>换句话说truncate会重置自增长。而delete并不会。</p> 
<p>实际上truncate和delete还有差别，truncate对应操作的这条记录是直接把表数据清空了，它不走事务。像delete和之前的sql最终在运行的时候都要以事务的方式被包装一下然后再让mysql去运行，而turncate并不会。包不包事务有什么影响呢？mysql一般对操作信息会做记录，会用自己对应的日志来对数据做记录。mysql里重要的日志有 bin.log 、 redo.log 、undo.log。操作痕迹一般放在前两个，bin.log会把历史上操作的优化后的sql语句保存。 redo.log为了保证mysql宕机的时候数据不就丢了吗，这个时候redo.log里面的策略保证能把数据恢复出来。</p> 
<p>持久化方式，所谓持久化方式指的是为了快速把数据库的数据恢复出来。</p> 
<ol><li>记录历史sql语句</li><li>记录数据本身</li></ol> 
<p>bin.log记录的就是历史sql语句，然后可以做mysql的主从同步，可以有两个数据库，一个数据把操作做完，然后这些sql同步给另一个数据库然后两个数据就一样了。默认bin.log是被关闭的。</p> 
<p>turncate并不把自己的操作记录在日志里，而delete会把操作记录在日志里，因为turncate少做了一些事情，不把自己包装成事务，也不把操作痕迹记录在日志里，而只是单纯把数据库清空，所以truncate比较快。</p> 
<h2><a id="5_702"></a>5.插入查询结果</h2> 
<p>语法：</p> 
<pre><code class="prism language-powershell">INSERT INTO table_name <span class="token punctuation">[</span><span class="token punctuation">(</span>column <span class="token punctuation">[</span><span class="token punctuation">,</span> column <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token function">SELECT</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> 
<p>我们要插就插，要删就删，要改就改，要查就查，实际我们也可以将select和insert组合。可以把数据从其他表里面筛选出来，然后插入到另一个表里面。</p> 
<p><strong>删除表中的的重复复记录，重复的数据只能有一份</strong></p> 
<pre><code class="prism language-powershell"><span class="token operator">--</span> 创建原数据表
CREATE TABLE duplicate_table <span class="token punctuation">(</span>id int<span class="token punctuation">,</span> name varchar<span class="token punctuation">(</span>20<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token operator">--</span> 插入测试数据
INSERT INTO duplicate_table VALUES
	<span class="token punctuation">(</span>100<span class="token punctuation">,</span> <span class="token string">'aaa'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">(</span>100<span class="token punctuation">,</span> <span class="token string">'aaa'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">(</span>200<span class="token punctuation">,</span> <span class="token string">'bbb'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">(</span>200<span class="token punctuation">,</span> <span class="token string">'bbb'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">(</span>200<span class="token punctuation">,</span> <span class="token string">'bbb'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">(</span>300<span class="token punctuation">,</span> <span class="token string">'ccc'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/71/20/ymTteJFG_o.png" alt="在这里插入图片描述"></p> 
<p>可能会想到直接把重复信息delete from删除，但是你敢这样做吗，信息都是一样的，删不就删完了吗。</p> 
<p>可能还会想到前面select查的时候，不是有一个对结果进行去重复吗，对这样确实是去重，但是这是查的时候去重，但表本身没有变。</p> 
<p><img src="https://images2.imgbox.com/83/a8/bXXs8uGR_o.png" alt="在这里插入图片描述"></p> 
<p>我们的做法是，</p> 
<ol><li>创建一个和原表一样结构的空表 no_duplicate_table ，</li><li>从原始表中把去重之后的结果筛选出来插入到no_duplicate_table 这个表不就是不重复的吗，</li><li>然后对duplicate_table重命名，no_duplicate_table改名字为duplicate_table。最终不就是完成了duplicate_table去重了吗。</li></ol> 
<pre><code class="prism language-powershell">create table no_duplicate_table like duplicate_table<span class="token punctuation">;</span>
</code></pre> 
<p>创建一个完全一样的表，使用like即可</p> 
<p><img src="https://images2.imgbox.com/5b/8d/BuppevOD_o.png" alt="在这里插入图片描述"></p> 
<p>全列插入就不用指定列了</p> 
<pre><code class="prism language-powershell">insert into no_duplicate_table <span class="token function">select</span> distinct <span class="token operator">*</span> <span class="token keyword">from</span> duplicate_table<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ed/f4/0vZFAl5W_o.png" alt="在这里插入图片描述"></p> 
<p>现在有两个表，一个duplicate_table，一个no_duplicate_table。然后对这两个表做一下重命名</p> 
<p>下面两个sql语句可以写一起</p> 
<pre><code class="prism language-powershell">rename table duplicate_table to old_duplicata_table<span class="token punctuation">;</span>
rename table no_duplicate_table to duplicate_table<span class="token punctuation">;</span>
</code></pre> 
<p>当前我们就完成了去重</p> 
<p><img src="https://images2.imgbox.com/24/ae/XkutZVqN_o.png" alt="在这里插入图片描述"></p> 
<p>这里有个细节问题，<strong>为什么最后是通过rename方式进行的？</strong></p> 
<p>如果今天想把一个文件上传到linux上，比如这个文件是1G上传时间可能是10分钟，我们想把这个文件上传号之后放到一个目录下，我要求它是为原子性方式放入的。所以一般我们不能直接把文件上传到对应的目录下，因为它上传的过程一种在写入一定不是原子，它太慢了。所以我们把这个文件上传到临时目标下，全部上传之后然后再把文件move到那个目录下。直接move这个动作实际上是原子的。其实对一个文件进行重命名也是同一个道理，<strong>所以我们最后通过rename方式，就是单纯的想等一切都就绪了，然后统一放入，更新，生效等！</strong> 和冗长的其他动作相比，这个动作非常轻。</p> 
<h2><a id="6_769"></a>6.聚合函数</h2> 
<table><thead><tr><th align="left">函数</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">COUNT([DISTINCT] expr)</td><td align="left">返回查询到的数据的 数量</td></tr><tr><td align="left">SUM([DISTINCT] expr)</td><td align="left">返回查询到的数据的 总和，不是数字没有意义</td></tr><tr><td align="left">AVG([DISTINCT] expr)</td><td align="left">返回查询到的数据的 平均值，不是数字没有意义</td></tr><tr><td align="left">MAX([DISTINCT] expr)</td><td align="left">返回查询到的数据的 最大值，不是数字没有意义</td></tr><tr><td align="left">MIN([DISTINCT] expr)</td><td align="left">返回查询到的数据的 最小值，不是数字没有意义</td></tr></tbody></table> 
<p>这里是为select分组查询做准备的，聚合函数是以查出来的记录为单位帮我们进行数据聚合统计的。这种聚合统计方式通常是产出一个期望的结果，如个数、和、平均值、最大值、最小值。</p> 
<p>mysql中其实也是有函数的，这个函数可以被直接调用，我们可以在mysql直接使用聚合函数直接对一组结果进行聚合统计。</p> 
<p><strong>聚合函数（）里面可以是全列，可以是指定列。</strong></p> 
<p><strong>统计班级共有多少同学</strong></p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> count<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> exam_result<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/cd/f2/it42LfhJ_o.png" alt="在这里插入图片描述"></p> 
<p>为什么1也行呢？<br> 实际上在做select的时候，select 1 就是这个表有多少行就拼多少1，只不过只是显示1</p> 
<p><img src="https://images2.imgbox.com/5f/5a/M916ADk2_o.png" alt="在这里插入图片描述"></p> 
<p><strong>统计班级数学成绩有多少</strong></p> 
<pre><code class="prism language-powershell"> <span class="token function">select</span> count<span class="token punctuation">(</span>math<span class="token punctuation">)</span> <span class="token keyword">from</span> exam_result<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f6/5d/2EHz0MPv_o.png" alt="在这里插入图片描述"></p> 
<p><strong>统计班级去重后数学成绩有多少</strong></p> 
<p>COUNT DISTINCT (math) 是对统计的结果去重<br> COUNT(DISTINCT math) 统计的是去重成绩数量</p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> count<span class="token punctuation">(</span>distinct math<span class="token punctuation">)</span> <span class="token keyword">from</span> exam_result<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a0/9b/P70Zm751_o.png" alt="在这里插入图片描述"></p> 
<p><strong>统计数学成绩总分</strong></p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> sum<span class="token punctuation">(</span>math<span class="token punctuation">)</span> <span class="token keyword">from</span> exam_result<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/5e/c7/MCknUpFR_o.png" alt="在这里插入图片描述"></p> 
<p><strong>统计平均总分</strong></p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> avg<span class="token punctuation">(</span>math+chinese+english<span class="token punctuation">)</span> <span class="token keyword">from</span> exam_result<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/aa/fd/tO9LSlus_o.png" alt="在这里插入图片描述"></p> 
<p><strong>统计数学成绩小于60分的个数</strong></p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> count<span class="token punctuation">(</span>math<span class="token punctuation">)</span> <span class="token keyword">from</span> exam_result where math&lt;60<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/6f/d1/RaQrwg4X_o.png" alt="在这里插入图片描述"></p> 
<p><strong>返回英语最高分</strong></p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> max<span class="token punctuation">(</span>english<span class="token punctuation">)</span> <span class="token keyword">from</span> exam_result<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a2/f5/gVtvpnWo_o.png" alt="在这里插入图片描述"></p> 
<p><strong>返回 &gt; 70 分以上的数学最低分</strong></p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> min<span class="token punctuation">(</span>math<span class="token punctuation">)</span> <span class="token keyword">from</span> exam_result where math&gt;70<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/0d/78/x5aFUePi_o.png" alt="在这里插入图片描述"></p> 
<p>这里为什么不能把name带上呢？</p> 
<p><img src="https://images2.imgbox.com/4a/30/NAtMJ2BV_o.png" alt="在这里插入图片描述"></p> 
<p>聚合统计的前提条件，一定是你先把我要聚合的数据先拿出来，然后才能聚合。做聚合的时候必须保证你要显示的或者你要查询的数据列是被允许聚合的。最低成绩只有一个，但name每个人都不一样没有办法做聚合。所以你要查告诉我们要分组之后才能进行聚合。</p> 
<h2><a id="7_857"></a>7.分组查询</h2> 
<p>分组是对表中的数据进行分组，分完组之后，在对表中每一组进行相关聚合统计。而<strong>分组的目的是为了进行分组之后，方便进行聚合统计。</strong> 如班级里有男生女生，我们相对男生女生成绩分别统计，所以可以对性别进行分组然后在进行成绩的聚合统计。</p> 
<p>在select中使用group by 子句可以对指定列进行分组查询。<strong>我们也可以把数据筛选之后再进行分组然后再聚合统计。</strong></p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> column1<span class="token punctuation">,</span> column2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">from</span> table <span class="token function">group</span> by column<span class="token punctuation">;</span>
</code></pre> 
<p>准备工作，创建一个雇员信息表（来自oracle 9i的经典测试表）</p> 
<ul><li>EMP员工表</li><li>DEPT部门表</li><li>SALGRADE工资等级表</li></ul> 
<p><img src="https://images2.imgbox.com/f5/cd/hV1MhL0r_o.png" alt="在这里插入图片描述"><br> 正是因为我们表有各种不同的信息，因此我们可以对表进行分组查询。</p> 
<p><strong>如何显示每个部门的平均工资和最高工资</strong></p> 
<p>注意说的是每个部门！我们未来是要分组的，凭什么分组，是由需求来决定的。这里很明显说的是每个部门，公司员工信息全部都在员工表里，部门号不同员工一定隶属于不同部门，所以我们要显示每一个部门的平均和最高工资。</p> 
<p>以前我们找公司最高工资和平均工资。我们是把这一张表当作一个大的组，这一张表在我看来就是一个整体的组，我要统计的就是全公司最高工资和平均工资。</p> 
<p><img src="https://images2.imgbox.com/26/4b/nFB4QC3U_o.png" alt="在这里插入图片描述"></p> 
<p>但今天需求是按照组来统计的，根据的emo表中deptno列来进行分组。</p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> max<span class="token punctuation">(</span><span class="token function">sal</span><span class="token punctuation">)</span> 最高<span class="token punctuation">,</span> avg<span class="token punctuation">(</span><span class="token function">sal</span><span class="token punctuation">)</span> 平均 <span class="token keyword">from</span> emp <span class="token function">group</span> by deptno<span class="token punctuation">;</span>
</code></pre> 
<p>group by后面跟的是按什么分组。</p> 
<p><img src="https://images2.imgbox.com/69/ec/PCMc4EIq_o.png" alt="在这里插入图片描述"></p> 
<p>我现在也想看见是那个部门的最高工资和平均工资</p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> deptno<span class="token punctuation">,</span>max<span class="token punctuation">(</span><span class="token function">sal</span><span class="token punctuation">)</span> 最高<span class="token punctuation">,</span> avg<span class="token punctuation">(</span><span class="token function">sal</span><span class="token punctuation">)</span> 平均 <span class="token keyword">from</span> emp <span class="token function">group</span> by deptno<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ff/31/JhOfv71g_o.png" alt="在这里插入图片描述"></p> 
<p>首先再次强调group by不是你想用就能用，一定要结合需求。其次group by的核心作用是让我们继续分组聚合统计的，所以你要把需求分清楚然后和group by功能对上，才能用group by。</p> 
<p>我们在进行分组统计的时候，<strong>group by后面指定列名，指明我们要分组的列是谁，但实际分组是用该列的不同的行数据是否相同进行分组的！当我们分完组之后，那分组的条件（deptno），组内一定是相同的，因此可以被聚合压缩。</strong></p> 
<p>分组，不就是把一组按照条件拆分多个组，进行各组内的统计。<br> <strong>分组（" 分表 "），不就是把一张表按照条件在逻辑上拆成多个子表，然后分别对各自的子表进行聚合统计。</strong></p> 
<p>拆成各个组不就是在逻辑上拆成各个表，然后分别在每个表里做聚合统计，以前我们做的聚合统计是在一张表里进行的，换句话说，只要掌握在一张表里查询，在查询之前先做好分组，后面的工作和思路理解上和之前单表上的聚合统计是一模一样的。</p> 
<p><strong>显示每个部门的每种岗位的平均工资和最低工资</strong><br> 需求是每个部门的每种岗位，注定了一定是要分组的，而且还不是分一组，我们首先按部门来分组，然后在按岗位来分组。</p> 
<p><img src="https://images2.imgbox.com/5d/11/l8ZV7QNG_o.png" alt="在这里插入图片描述"></p> 
<p>在我看来每一张组都是独立的组，在组内做聚合也没什么问题。无非就是比以前多做一份工作，<strong>先分组，再聚合</strong>。 一张整表内做聚合和多个子表内做聚合，总之还是在一张表内聚合。</p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> avg<span class="token punctuation">(</span><span class="token function">sal</span><span class="token punctuation">)</span> 平均<span class="token punctuation">,</span>min<span class="token punctuation">(</span><span class="token function">sal</span><span class="token punctuation">)</span> 最高 <span class="token keyword">from</span> emp <span class="token function">group</span> by deptno<span class="token punctuation">,</span>job<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/03/9a/9G5iAd8d_o.png" alt="在这里插入图片描述"></p> 
<p>我想看一看分别是哪个部门的那个岗位的平均工资和最高工资</p> 
<pre><code class="prism language-powershell">lect deptno<span class="token punctuation">,</span>job<span class="token punctuation">,</span>avg<span class="token punctuation">(</span><span class="token function">sal</span><span class="token punctuation">)</span> 平均<span class="token punctuation">,</span>min<span class="token punctuation">(</span><span class="token function">sal</span><span class="token punctuation">)</span> 最高 <span class="token keyword">from</span> emp <span class="token function">group</span> by deptno<span class="token punctuation">,</span>job<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/01/cd/OuaepspX_o.png" alt="在这里插入图片描述"></p> 
<p>在想看看是哪个部门的那个岗位的谁的平均工资和最高工资</p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> ename<span class="token punctuation">,</span>deptno<span class="token punctuation">,</span>job<span class="token punctuation">,</span>avg<span class="token punctuation">(</span><span class="token function">sal</span><span class="token punctuation">)</span> 平均<span class="token punctuation">,</span>min<span class="token punctuation">(</span><span class="token function">sal</span><span class="token punctuation">)</span> 最高 <span class="token keyword">from</span> emp <span class="token function">group</span> by deptno<span class="token punctuation">,</span>job<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e8/a3/6tU8S2Cq_o.png" alt="在这里插入图片描述"></p> 
<p>故意加了一个ename，然后就报错了，说的是ename没有在分组条件内出现不属于分组条件，所以无法进行压缩和聚合。刚才我们说了分组内一定是某个相同的。走到一个组内一定是部门号相同工作总类相同。所以相同的列可以进行压缩聚合。现在出来一个名字，名字一定是人人都不同的，没有办法进行聚合，所以直接报错。</p> 
<p><strong>一般大原则，只有在group by中出现的具体的列名称，才可以在select后面具体出现，除此之外另一类可以直接出现的就是聚合函数，其余不能在select后面直接跟不是具体分组条件的列。</strong></p> 
<p><strong>显示平均工资低于2000的部门和它的平均工资</strong></p> 
<p>需求是平均工资低于2000的部门，要的是部门，和它的平均工资是多少。</p> 
<ol><li>我们统计出来每一个部门的平均工资(结果先聚合出来)</li><li>在进行判断(对聚合的结果，进行判断)</li></ol> 
<pre><code class="prism language-powershell"><span class="token function">select</span> deptno<span class="token punctuation">,</span>avg<span class="token punctuation">(</span><span class="token function">sal</span><span class="token punctuation">)</span> 平均 <span class="token keyword">from</span> emp <span class="token function">group</span> by deptno<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e5/b6/5zmIILGf_o.png" alt="在这里插入图片描述"></p> 
<p>我要的不是所有部门，我要的是平均工资低于2000的部门，此时要对聚合的结果拿出来判断。我们再说一个语法结构</p> 
<p><strong>having和group by配合使用，对group by结果进行过滤，</strong> 先要有数据然后having对这一批数据做判断，筛选出想要的。</p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> deptno<span class="token punctuation">,</span>avg<span class="token punctuation">(</span><span class="token function">sal</span><span class="token punctuation">)</span> 平均 <span class="token keyword">from</span> emp <span class="token function">group</span> by deptno having 平均&lt;2000<span class="token punctuation">;</span>
</code></pre> 
<p><strong>having经常和group by搭配使用，作用是对聚合后的统计数据，进行条件筛选，作用有些像where。</strong></p> 
<p><img src="https://images2.imgbox.com/99/c0/9ZOm7y6F_o.png" alt="在这里插入图片描述"></p> 
<p><strong>having 和 where 区别理解？执行顺序？构建对 “结果” 的理解。</strong></p> 
<p>首先having和where都是够进行条件筛选，但是它们两个是完全不同的筛选。</p> 
<p>比如说这里把having换成where就报错了，</p> 
<p><img src="https://images2.imgbox.com/87/6b/tCxeFPGt_o.png" alt="在这里插入图片描述"></p> 
<p>虽然这里可以查询出来，但是并不意外，因为having本就是分组查询的，刚开始说过对于组的理解不要死板理解上面是一张整表下面是分组，我们把分组理解成分表就可以了。我们把一个表拆成很多表，每一张表内做聚合统计，其实都是之前说的聚合统计。但是如果我们没有做分组这张表宏观上在我们看来也是一组数据。 所以having这里可以充当where。但是一般在select这里严重不推荐这样使用having。</p> 
<p><img src="https://images2.imgbox.com/f1/25/K53ORCA2_o.png" alt="在这里插入图片描述"></p> 
<p>而上面用where不行，至少说明having和where因为一些特征是无法互相取代的。</p> 
<p>再来一个需求，<strong>SMITH员工不参与统计，显示平均工资低于2000的部门和它的平均工资</strong></p> 
<p>SMITH不参与统计，首先去掉SMITH</p> 
<p><img src="https://images2.imgbox.com/d1/f3/8H9aQ2eq_o.png" alt="在这里插入图片描述"></p> 
<p>去掉之后，以前是一张表，去掉之后还是一张表，然后对现在查出来的一张表在进行分组之后在进行条件筛选。</p> 
<pre><code class="prism language-powershell"><span class="token function">select</span> deptno<span class="token punctuation">,</span>job<span class="token punctuation">,</span>avg<span class="token punctuation">(</span><span class="token function">sal</span><span class="token punctuation">)</span> 平均 <span class="token keyword">from</span> emp where ename!=<span class="token string">'SMITH'</span> <span class="token function">group</span> by deptno<span class="token punctuation">,</span>job having 平均&lt;2000<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f8/31/soN8pdxW_o.png" alt="在这里插入图片描述"></p> 
<p><strong>having 和 where 区别理解？执行顺序？构建对 “结果” 的理解</strong>。</p> 
<p>在我们看来<strong>where是对具体的任意列进行条件筛选，having对分组聚合之后的结果进行条件筛选。</strong> 它们俩的应用场景是完全不同的。换句话说where是先对原始表进行条件过滤，对过滤后的结果在进行分组。</p> 
<p>所以这条sql顺序如下：1. 先从那个表拿数据，2. 在这个表拿数据的筛选条件是什么，数据筛选之后，3. 对这些数据进行分组，4. 分组之后结果进行聚合统计以及重命名，5. 数据全都出来了然后才是对结果进行筛选</p> 
<p><img src="https://images2.imgbox.com/93/08/jU3kIh9v_o.png" alt="在这里插入图片描述"></p> 
<p>所以<strong>where和having都叫条件筛选，它们的区别在于条件筛选的阶段是不同的。执行顺序我们刚才也说了。</strong></p> 
<p><strong>构建对 “结果” 的理解（小小的建模）</strong><br> 不要单纯的认为，只有磁盘上表结构导入的mysql，真实存在的表，才叫做表。中间筛选出来的，包括最终结果，在我看来，全部都是逻辑的表。在我看来"MySQL一切皆表"，所以未来只要我们能够处理好单表的CURD，所有的sql场景，我们全部都能用统一的方式进行。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ab2ac753b50c0e0e75979d06956526b6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">实战教学！JAVA根据PDF表单模板生成PDF文件（附带模板设计）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/85a135b7edfe7e8cc9f82e6a9cbf242f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MySQL 8.0 安装、配置、启动、登录、连接、卸载教程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>