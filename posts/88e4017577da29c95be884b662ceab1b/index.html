<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>[arxiv论文解读]LlamaFactory：100&#43;语言模型统一高效微调 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/88e4017577da29c95be884b662ceab1b/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="[arxiv论文解读]LlamaFactory：100&#43;语言模型统一高效微调">
  <meta property="og:description" content="该文档是一篇关于LLAMAFACTORY的学术论文，这是一个用于高效微调大型语言模型（LLMs）的统一框架。这篇论文详细介绍了LLAMAFACTORY的设计、实现和评估，以及它在语言建模和文本生成任务中的应用。下面是对文档内容的详细解释：
摘要（Abstract） 背景：大型语言模型（LLMs）在多种应用中展现了卓越的推理能力，但需要有效的微调方法来适应下游任务。问题：现有的高效微调方法缺乏一个系统化的框架，无法统一适应不同的LLMs，并提供友好的用户定制界面。解决方案：LLAMAFACTORY提供了一个统一的框架，通过可扩展的模块整合了多种高效的微调方法，允许用户通过内置的Web UI（LLAMABOARD）灵活定制100多个LLMs的微调，无需编码。验证：通过实验验证了框架在语言建模和文本生成任务中的效率和有效性。开源：LLAMAFACTORY在GitHub上开源，并已获得超过13,000个星标和1,600个分支。 引言（Introduction） LLMs的重要性：介绍了LLMs在问答、机器翻译和信息提取等应用中的作用。微调挑战：指出了在有限资源下对大量参数进行微调的主要挑战。现有方法的局限性：社区贡献了多种高效微调方法，但缺乏一个统一的框架。 LLAMAFACTORY框架（LLAMAFACTORY Framework） 模块组成：由Model Loader、Data Worker和Trainer三个主要模块组成。功能：支持100多个预训练模型和50多个NLP数据集，提供了命令行和Web界面，用户可以轻松定制和微调LLMs。 高效微调技术（Efficient Fine-Tuning Techniques） 优化技术：包括冻结部分参数的freeze-tuning方法，梯度低秩投影（GaLore），低秩适应（LoRA）等。计算技术：包括混合精度训练、激活检查点、Flash Attention等。 LLAMAFACTORY架构（LLAMAFACTORY Architecture） Model Loader：准备各种架构进行微调，支持超过100个LLMs。Data Worker：通过设计良好的管道处理不同任务的数据，支持50多个数据集。Trainer：统一高效的微调方法，适应不同任务和数据集的模型。 实验研究（Empirical Study） 训练效率：使用PubMed数据集，比较了不同微调方法在内存使用、吞吐量和困惑度方面的效率。下游任务微调：在CNN/DM、XSum和AdGen等文本生成任务上评估了不同模型的性能。 结论和未来工作（Conclusion and Future Work） 贡献：LLAMAFACTORY作为一个统一框架，通过模块化设计，最小化了模型、数据集和训练方法之间的依赖，提供了超过100个LLMs的多样化高效微调技术。未来方向：将持续更新LLAMAFACTORY以保持与最先进的模型和微调技术的同步，并探索更先进的并行训练策略和多模态高效微调。 更广泛的影响和负责任的使用（Broader Impact and Responsible Use） 社区贡献：LLAMAFACTORY吸引了许多对LLMs感兴趣的个人，促进了开源社区的成长。许可证遵守：使用LLAMAFACTORY进行微调时，必须遵守模型许可证，以防止潜在的滥用。 附录和表格 表格1：LLAMAFACTORY中支持的高效微调技术及其兼容性。表格2：LLAMAFACTORY中的数据集结构。表格3：使用LLAMAFACTORY不同微调方法的训练效率比较。表格4：在特定任务上使用不同微调方法的性能比较。表格5：LLAMAFACTORY与现有LLM微调框架的比较。表格6：LLAMAFACTORY支持的模型列表。表格7：LLAMAFACTORY中函数调用的提示示例。 实验细节（Experiment Details） 训练效率实验：描述了实验设置，包括学习率、批次大小、优化器和硬件配置。下游任务微调实验：简要描述了用于评估不同微调方法有效性的CNN/DM、XSum和AdGen数据集。 这篇论文提供了LLAMAFACTORY框架的全面介绍，包括其设计理念、实现细节、实验验证以及与现有技术的比较。此外，它还讨论了框架的社会影响和负责任使用的重要性。
LlamaFactory：100&#43;语言模型统一高效微调 Yaowei Zheng1, Richong Zhang1, Junhao Zhang1, Yanhan Ye1, Zheyan Luo1, Yongqiang Ma2
1School of Computer Science and Engineering, Beihang University, China
2School of Software and Microelectronics, Peking University, China">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-18T14:35:57+08:00">
    <meta property="article:modified_time" content="2024-07-18T14:35:57+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">[arxiv论文解读]LlamaFactory：100&#43;语言模型统一高效微调</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>该文档是一篇关于LLAMAFACTORY的学术论文，这是一个用于高效微调大型语言模型（LLMs）的统一框架。这篇论文详细介绍了LLAMAFACTORY的设计、实现和评估，以及它在语言建模和文本生成任务中的应用。下面是对文档内容的详细解释：</p> 
<h4>摘要（Abstract）</h4> 
<ul><li><strong>背景</strong>：大型语言模型（LLMs）在多种应用中展现了卓越的推理能力，但需要有效的微调方法来适应下游任务。</li><li><strong>问题</strong>：现有的高效微调方法缺乏一个系统化的框架，无法统一适应不同的LLMs，并提供友好的用户定制界面。</li><li><strong>解决方案</strong>：LLAMAFACTORY提供了一个统一的框架，通过可扩展的模块整合了多种高效的微调方法，允许用户通过<span style="background-color:#ffd900;">内置的Web UI（LLAMA</span>BOARD）灵活定制100多个LLMs的微调，无需编码。</li><li><strong>验证</strong>：通过实验验证了框架在语言建模和文本生成任务中的效率和有效性。</li><li><strong>开源</strong>：LLAMAFACTORY在GitHub上开源，并已获得超过13,000个星标和1,600个分支。</li></ul> 
<h4>引言（Introduction）</h4> 
<ul><li><strong>LLMs的重要性</strong>：介绍了LLMs在问答、机器翻译和信息提取等应用中的作用。</li><li><strong>微调挑战</strong>：指出了在有限资源下对大量参数进行微调的主要挑战。</li><li><strong>现有方法的局限性</strong>：社区贡献了多种高效微调方法，但缺乏一个统一的框架。</li></ul> 
<h4>LLAMAFACTORY框架（LLAMAFACTORY Framework）</h4> 
<ul><li><strong>模块组成</strong>：由Model Loader、Data Worker和Trainer三个主要模块组成。</li><li><strong>功能</strong>：支持100多个预训练模型和50多个NLP数据集，提供了命令行和Web界面，用户可以轻松定制和微调LLMs。</li></ul> 
<h4>高效微调技术（Efficient Fine-Tuning Techniques）</h4> 
<ul><li><strong>优化技术</strong>：包括<span style="background-color:#ff9900;">冻结部分参数的freeze-tuning</span>方法，<span style="background-color:#a2e043;">梯度低秩投影（GaLore</span>），低秩适应（LoRA）等。</li><li><strong>计算技术</strong>：包括<span style="background-color:#a2e043;">混合精度训练、激活检查点</span>、Flash Attention等。</li></ul> 
<h4>LLAMAFACTORY架构（LLAMAFACTORY Architecture）</h4> 
<ul><li><strong>Model Loader</strong>：准备各种架构进行微调，支持超过100个LLMs。</li><li><strong>Data Worker</strong>：通过设计<span style="background-color:#ff9900;">良好的管道处理不同任务的数据</span>，支持50多个数据集。</li><li><strong>Trainer</strong>：统一高效的微调方法，<span style="background-color:#a2e043;">适应不同任务和数据集的模型</span>。</li></ul> 
<h4>实验研究（Empirical Study）</h4> 
<ul><li><strong>训练效率</strong>：使用PubMed数据集，比较了不同微调方法在内存使用、吞吐量和困惑度方面的效率。</li><li><strong>下游任务微调</strong>：在<span style="background-color:#ff9900;">CNN/DM、XSum和AdGen等</span>文本生成任务上评估了不同模型的性能。</li></ul> 
<h4>结论和未来工作（Conclusion and Future Work）</h4> 
<ul><li><strong>贡献</strong>：LLAMAFACTORY作为一个统一框架，通过模块化设计，最小化了模型、数据集和训练方法之间的依赖，提供了超过100个LLMs的多样化高效微调技术。</li><li><strong>未来方向</strong>：将持续更新LLAMAFACTORY以保持与最先进的模型和微调技术的同步，并探索更先进的并行训练策略和多模态高效微调。</li></ul> 
<h4>更广泛的影响和<span style="background-color:#f9eda6;">负责任的使用（Broader Impact</span> and Responsible Use）</h4> 
<ul><li><strong>社区贡献</strong>：LLAMAFACTORY吸引了许多对LLMs感兴趣的个人，促进了开源社区的成长。</li><li><strong>许可证遵守</strong>：使用LLAMAFACTORY进行微调时，必须遵守模型许可证，以防止潜在的滥用。</li></ul> 
<h4>附录和表格</h4> 
<ul><li><strong>表格1</strong>：LLAMAFACTORY中支持的高效微调技术及其兼容性。</li><li><strong>表格2</strong>：LLAMAFACTORY中的数据集结构。</li><li><strong>表格3</strong>：使用LLAMAFACTORY不同微调方法的训练效率比较。</li><li><strong>表格4</strong>：在特定任务上使用不同微调方法的性能比较。</li><li><strong>表格5</strong>：LLAMAFACTORY与现有LLM微调框架的比较。</li><li><strong>表格6</strong>：LLAMAFACTORY支持的模型列表。</li><li><strong>表格7</strong>：LLAMAFACTORY中函数调用的提示示例。</li></ul> 
<h4>实验细节（Experiment Details）</h4> 
<ul><li><strong>训练效率实验</strong>：描述了实验设置，包括学习率、批次大小、优化器和硬件配置。</li><li><strong>下游任务微调实验</strong>：简要描述了用于评估不同微调方法有效性的CNN/DM、XSum和AdGen数据集。</li></ul> 
<p>这篇论文提供了LLAMAFACTORY框架的全面介绍，包括其设计理念、实现细节、实验验证以及与现有技术的比较。此外，它还讨论了框架的社会影响和负责任使用的重要性。</p> 
<h2></h2> 
<h2>LlamaFactory：100+语言模型统一高效微调</h2> 
<p>Yaowei Zheng1, Richong Zhang1, Junhao Zhang1, Yanhan Ye1, Zheyan Luo1, Yongqiang Ma2<br> 1School of Computer Science and Engineering, Beihang University, China<br> 2School of Software and Microelectronics, Peking University, China<br> hiyouga@buaa.edu.cn, zhangrc@act.buaa.edu.cn, {zhang.jh,yeyanhan,akamya}@buaa.edu.cn, codingma@pku.edu.cn<br> Demonstration video: <a href="https://youtu.be/W29FgeZEpus" rel="nofollow" title="https://youtu.be/W29FgeZEpus">https://youtu.be/W29FgeZEpus</a></p> 
<h6 id="yiyi-5">摘要</h6> 
<p id="id14.id1">有效的微调对于使大语言模型适应下游任务至关重要。 然而，在不同的模型上实现这些方法需要付出很大的努力。 我们提出了LlamaFactory，一个集成了一套尖端高效训练方法的统一框架。 它允许用户通过内置的Web UI LlamaBoard灵活定制100+大语言模型的微调，而无需编码。 我们凭经验验证了我们的框架在语言建模和文本生成任务上的效率和有效性。 它已在 <a href="https://github.com/hiyouga/LLaMA-Factory" title="GitHub - hiyouga/LLaMA-Factory: Unify Efficient Fine-Tuning of 100+ LLMs">GitHub - hiyouga/LLaMA-Factory: Unify Efficient Fine-Tuning of 100+ LLMs</a> 发布，并已获得超过 13,000 个 star 和 1,600 个分叉。</p> 
<p id="p1.1">LlamaFactory：100+语言模型统一高效微调</p> 
<p></p> 
<p id="p2.1">Yaowei Zheng1, Richong Zhang1, Junhao Zhang1, Yanhan Ye1, Zheyan Luo1, Yongqiang Ma21School of Computer Science and Engineering, Beihang University, China2School of Software and Microelectronics, Peking University, Chinahiyouga@buaa.edu.cn, zhangrc@act.buaa.edu.cn, {zhang.jh,yeyanhan,akamya}@buaa.edu.cn, codingma@pku.edu.cnDemonstration video: <a href="https://youtu.be/W29FgeZEpus" rel="nofollow" title="https://youtu.be/W29FgeZEpus">https://youtu.be/W29FgeZEpus</a></p> 
<h3>1简介</h3> 
<p id="S1.p1.1">大语言模型（大语言模型）（Zhao等人，2023）呈现出卓越的推理能力，并赋能广泛的应用，例如问答（Jiang等人，2023b） t1&gt;、机器翻译(Wang 等人, 2023c; Jiao 等人, 2023a)、信息提取(Jiao 等人, 2023b)。 随后，大量的大语言模型被开发出来并通过开源社区访问。 例如，Hugging Face开放的大语言模型排行榜（Beeching等人，2023）拥有超过5000个模型，为寻求利用大语言模型力量的个人提供了便利。</p> 
<p id="S1.p2.1">用有限的资源微调极其大量的参数成为大语言模型适应下游任务的主要挑战。 一种流行的解决方案是高效的微调（Houlsby 等人，2019；Hu 等人，2022；Ben Zaken 等人，2022；Dettmers 等人，2023；Zhao 等人，2024），它可以减少大语言模型适应各种任务时的训练成本。 然而，社区提供了各种高效微调大语言模型的方法，缺乏一个系统框架来将这些方法适应和统一到不同的大语言模型，并为用户定制提供友好的界面。</p> 
<p id="S1.p3.1">为了解决上述问题，我们开发了LlamaFactory，一个使大语言模型微调民主化的框架。 它通过可扩展的模块统一了多种高效的微调方法，能够以最少的资源和高吞吐量实现数百个大语言模型的微调。 此外，它还简化了常用的训练方法，包括生成式预训练（Radford等人，2018）、监督微调（SFT）（Wei等人，2022）、基于<span style="background-color:#ffd900;">人类反馈的强化学习 (RLHF) Ouyang 等人 (2022) 和直接偏好优化 (DPO) </span>Rafailov 等人 (2023)。 用户可以利用命令行或 Web 界面来定制和配置他们的大语言模型，只需很少的编码工作或无需编码工作。</p> 
<p id="S1.p4.1">LlamaFactory由三个主要模块组成：<span style="background-color:#ff9900;">Model Loader、Data Worker和Trainer</span>。 我们最大限度地减少这些模块对特定模型和数据集的依赖，使框架能够灵活地扩展到数百个模型和数据集。 具体来说，我们首先建立一个模型<span style="background-color:#a2e043;">注册表，模型加载器</span>可以通过识别确切的层将适配器精确地附加到预训练的模型上。 然后我们开发一个数据描述规范，允许数据工作者通过对齐相应的列来收集数据集。 此外，我们提供了高效微调方法的即插即用实现，使训练器能够通过替换默认方法来激活。 我们的设计允许这些模块在不同的训练方法中重复使用，从而显着降低新方法的集成成本。</p> 
<p id="S1.p5.1">LlamaFactory 使用 PyTorch 实现(Paszke 等人, 2019) 并显着受益于 Transformers 等开源库(Wolf 等人, 2020) t2&gt;、PEFT （Mangrulkar 等人，2022） 和 TRL （von Werra 等人，2020）。 在此基础上，我们提供了一个具有更高抽象级别的开箱即用的框架。 此外，我们还使用 Gradio （Abid 等人，2019） 构建了 LlamaBoard，无需编码即可微调大语言模型。</p> 
<p id="S1.p6.1">LlamaFactory 在 Apache-2.0 许可证下开源。 它已在 GitHub 上获得超过 13,000 颗星和 1,600 个分支1，并在 Hugging Face Hub2 上的 LlamaFactory 上构建了数百个开源模型。 例如，著名的 GemSUra-7B (Nguyen 等人，2024) 是基于 LlamaFactory 构建的，它首先揭示了 Gemma 的跨语言能力（梅斯纳德等人，2024）。 此外，还有数十项研究利用我们的框架探索大语言模型的新方法，例如Wang等人(2023a)；于等人 (2023); Bhardwaj 等人 (2024)。</p> 
<h3>2高效的微调技术</h3> 
<p id="S2.p1.1">高效的大语言模型微调技术可以分为两大类：针对优化的技术和针对计算的技术。 高效优化技术的主要目标是调整大语言模型的参数，同时将成本保持在最低限度。 另一方面，高效的计算方法寻求减少大语言模型中所需计算的时间或空间。 表<a href="https://arxiv.org/html/2403.13372v2#S2.T1" rel="nofollow" title="1">1</a>列出了LlamaFactory中包含的方法。 我们将在下面的章节中介绍这些有效的微调技术，并展示通过将它们合并到我们的框架中所实现的显着效率改进。</p> 
<p>表格1：LlamaFactory 中的高效微调技术。 相互兼容的技术用✓标记，而不兼容的技术用✗标记。</p> 
<table id="S2.T1.1.1"><thead><tr id="S2.T1.1.1.2.1"><th id="S2.T1.1.1.2.1.1"></th><th id="S2.T1.1.1.2.1.2">Freeze-tuning</th><th id="S2.T1.1.1.2.1.3">GaLore</th><th id="S2.T1.1.1.2.1.4">LoRA</th><th id="S2.T1.1.1.2.1.5">DoRA</th></tr></thead><tbody><tr id="S2.T1.1.1.3.1"><th id="S2.T1.1.1.3.1.1">Mixed precision</th><td id="S2.T1.1.1.3.1.2">✓</td><td id="S2.T1.1.1.3.1.3">✓</td><td id="S2.T1.1.1.3.1.4">✓</td><td id="S2.T1.1.1.3.1.5">✓</td></tr><tr id="S2.T1.1.1.4.2"><th id="S2.T1.1.1.4.2.1">Checkpointing</th><td id="S2.T1.1.1.4.2.2">✓</td><td id="S2.T1.1.1.4.2.3">✓</td><td id="S2.T1.1.1.4.2.4">✓</td><td id="S2.T1.1.1.4.2.5">✓</td></tr><tr id="S2.T1.1.1.5.3"><th id="S2.T1.1.1.5.3.1">Flash attention</th><td id="S2.T1.1.1.5.3.2">✓</td><td id="S2.T1.1.1.5.3.3">✓</td><td id="S2.T1.1.1.5.3.4">✓</td><td id="S2.T1.1.1.5.3.5">✓</td></tr><tr id="S2.T1.1.1.1"><th id="S2.T1.1.1.1.1">S2 attention</th><td id="S2.T1.1.1.1.2">✓</td><td id="S2.T1.1.1.1.3">✓</td><td id="S2.T1.1.1.1.4">✓</td><td id="S2.T1.1.1.1.5">✓</td></tr><tr id="S2.T1.1.1.6.4"><th id="S2.T1.1.1.6.4.1">Quantization</th><td id="S2.T1.1.1.6.4.2">✗</td><td id="S2.T1.1.1.6.4.3">✗</td><td id="S2.T1.1.1.6.4.4">✓</td><td id="S2.T1.1.1.6.4.5">✓</td></tr><tr id="S2.T1.1.1.7.5"><th id="S2.T1.1.1.7.5.1">Unsloth</th><td id="S2.T1.1.1.7.5.2">✗</td><td id="S2.T1.1.1.7.5.3">✗</td><td id="S2.T1.1.1.7.5.4">✓</td><td id="S2.T1.1.1.7.5.5">✗</td></tr></tbody></table> 
<h4>2.1高效优化</h4> 
<p id="S2.SS1.p1.1">首先，我们概述了 LlamaFactory 中使用的<span style="background-color:#a2e043;">高效优化技术。 冻结调整</span>方法（Houlsby等人，2019）涉及<span style="background-color:#ff9900;">冻结大部分参数，同时微调</span><span style="background-color:#a2e043;">一小部分解码器层中的剩余参数</span>。 另一种称为<span style="background-color:#ffd900;">梯度低秩投影</span>（GaLore）（Zhao 等人，2024）的方法将梯度投影到低维空间，以<span style="background-color:#ffd900;">节省内存的方式促进全参数学习。</span> 相反，低秩适应（LoRA）（Hu等人，2022）方法冻结所有预训练的权重，并向指定层引入一对可训练的低秩矩阵。 当与<span style="background-color:#a2e043;">量化相结合时，这种方法被称为 QLoRA</span> (Dettmers 等人，2023)，它还减少了内存使用量。 权重分解低秩自适应（DoRA）（Liu等人，2024）方法将预训练的权重分解为幅度和方向分量，仅将LoRA应用于方向分量以增强精细化大语言模型的调优。 LoRA+ (Hayou 等人, 2024) 的提出是为了克服 LoRA 的次优性。</p> 
<h4>2.2高效计算</h4> 
<p id="S2.SS2.p1.1">在LlamaFactory中，我们集成了一系列高效的计算技术。 常用的技术包括混合精度训练（Micikevicius等人，2018）和激活检查点（Chen等人，2016）。 Flash Attention （Dao 等人，2022） 通过对注意力层输入输出（IO）开销的检查得出见解，引入了一种硬件友好的方法来增强注意力计算。 <span style="background-color:#ffd900;">S2注意力</span>(Chen 等人, 2024b)解决了块稀疏注意力中扩展上下文的挑战，从而减少了微调长上下文大语言模型的内存使用。 各种量化策略（Dettmers 等人，2022a；Frantar 等人，2023；Lin 等人，2023；Egiazarian 等人，2024）通过利用较低的-权重的精确表示。 然而，量化模型的微调仅限于基于适配器的技术，例如 LoRA （Hu 等人，2022）。 Unsloth (Han and Han, 2023) 结合了 <span style="background-color:#ffd900;">Triton</span> (Tillet 等人, 2019) 来实现 LoRA 的反向传播，<span style="background-color:#ff9900;">减少梯度期间的浮点运算 (FLOP)</span>下降并导致快速 LoRA 训练。</p> 
<p id="S2.SS2.p2.1">LlamaFactory有效地将这些技术组合成一个内聚的结构，大大提高了大语言模型微调的效率。 这导致混合精度（Micikevicius等人，2018）期间每个参数18个字节的内存占用减少或bfloat16训练（Le Scao等人，2022）每个参数8个字节的内存占用减少) 每个参数仅 0.6 个字节。 下一节将进一步阐述我们的框架。</p> 
<h3>3LlamaFactory框架</h3> 
<p id="S3.p1.1">LlamaFactory 由三个主要模块组成：<span style="background-color:#ff9900;">Model Loader、Data Worker 和 Trainer</span>。 模型加载器准备了各种架构进行微调，支持超过100个大语言模型。 Data Worker 通过精心设计的管道处理来自不同任务的数据，该管道支持 50 多个数据集。 Trainer 统一了高效的微调方法，使这些模型适应不同的任务和数据集，它提供了四种训练方法。 LlamaBoard为上述模块提供了友好的可视化界面，使用户能够以无代码的方式配置和启动单个大语言模型微调过程，并实时监控状态。 我们在图<a href="https://arxiv.org/html/2403.13372v2#S3.F1" rel="nofollow" title="1">1</a>中说明了LlamaFactory的整体架构。</p> 
<p>LlamaBoardArgument ConfiguratorTraining Status MonitorTrainerOptimizationApproachesLoRA+GaLoreOffloadPartitionPre-trainSFTRLHFDPOModel LoaderData WorkerInitializationPatchesQuantizationAdaptersAligningLoadingPreprocessMerging100+ Pre-Trained Models50+ NLP Datasets</p> 
<p>图1：LlamaFactory的架构。</p> 
<h4>3.1模型加载器</h4> 
<p id="S3.SS1.p1.1">本节首先介绍模型加载器中的四个组件：模型初始化、模型修补、模型量化和适配器附加，然后描述我们通过在精细时处理参数浮点精度来适应各种设备的方法。调整。</p> 
<h5 id="yiyi-76">模型初始化</h5> 
<p id="S3.SS1.SSS0.Px1.p1.1">我们使用 Transformers (Wolf 等人, 2020) 的 AutoModel API 来加载模型和初始化参数。 为了使我们的框架兼容不同的模型架构，我们建立了一个模型注册表来存储每一层的类型，从而方便更直接地利用高效的微调技术。 如果标记器的词汇量大小超过嵌入层的容量，我们会调整层的大小并使用噪声均值初始化来初始化新参数。 为了确定 RoPE 缩放（Chen 等人，2023） 的缩放因子，我们将其计算为最大输入序列长度与模型上下文长度的比率。</p> 
<h5 id="yiyi-81">模型修补</h5> 
<p id="S3.SS1.SSS0.Px2.p1.1">为了启用 <span style="background-color:#ff9900;">flash 注意力和 S2 注意力</span>，我们使用猴子补丁来代替模型的前向计算。 尽管如此，由于自 Transformers 4.34.0 起就支持 Flash Attention，因此我们使用 API 来启用 Flash Attention。 为了防止动态模块的过度划分，我们在 DeepSpeed ZeRO-3 (Rasley 等人, 2020) 下优化时将专家混合 (MoE) 块设置为叶模块。</p> 
<h5 id="yiyi-85">模型量化</h5> 
<p id="S3.SS1.SSS0.Px3.p1.1">可以通过bitsandbytes库（Dettmers，2021）使用大语言模型.int8（Dettmers等人，2022a）将模型动态量化为8位或4位。 对于 4 位量化，我们利用双量化和 4 位普通浮点作为 QLoRA (Dettmers 等人，2023)。 我们还支持对训练后量化（PTQ）方法量化的模型进行微调，包括 GPTQ (Frantar 等人, 2023)、AWQ (Lin 等人, 2023) 和 AQLM （Egiazarian 等人，2024）。 请注意，我们不能直接计算量化权重；因此，量化模型仅与基于适配器的方法兼容。</p> 
<h5 id="yiyi-90">适配器连接</h5> 
<p id="S3.SS1.SSS0.Px4.p1.1">我们使用模型注册表自动识别适当的层来附加适配器。 默认情况下，适配器附加到层的子集以节省内存，但将它们附加到所有线性层可能会产生更好的性能（Dettmers 等人，2023）。 PEFT (Mangrulkar 等人, 2022) 库提供了一种极其方便的方式来连接适配器，例如 LoRA (Hu 等人, 2022)、rsLoRA (Kalajdzievski, 2023），以及 DoRA （刘等人，2024）。 我们用 Unsloth (Han and Han, 2023) 的反向计算代替反向计算来加速 LoRA。 为了根据人类反馈（RLHF）执行强化学习，我们在模型上添加了一个值头，这是一个将每个词符的表示映射到标量的线性层。</p> 
<h5 id="yiyi-96">精准适配</h5> 
<p id="S3.SS1.SSS0.Px5.p1.1">我们根据设备的功能处理预训练模型的浮点精度。 对于 NVIDIA GPU，如果计算能力为 8.0 或更高，我们使用 bfloat16 精度。 否则，采用float16。 我们对 Ascend NPU 和 AMD GPU 使用 float16，对非 CUDA 设备使用 float32。 请注意，以 float16 精度加载 bfloat16 模型可能会导致溢出问题。 在混合精度训练中，我们将所有可训练参数设置为 float32。 尽管如此，我们在 bfloat16 训练中保留了<span style="background-color:#ffd900;">可训练参数 bfloat16 。</span></p> 
<h4>3.2数据工作者</h4> 
<p id="S3.SS2.p1.1">我们开发了一个数据处理管道，包括数据集加载、数据集对齐、数据集合并和数据集预处理。 它将不同任务的数据集标准化为统一的格式，使我们能够对各种格式的数据集进行建模。</p> 
<h5 id="yiyi-107">数据集加载</h5> 
<p id="S3.SS2.SSS0.Px1.p1.1">我们利用数据集(Lhoest 等人, 2021) 库来加载数据，它允许用户从 Hugging Face Hub 加载远程数据集或通过脚本或文件读取本地数据集。 数据集库显着减少了数据处理过程中的内存开销，并使用 Arrow （Apache，2016） 加速样本查询。 默认情况下，整个数据集下载到本地磁盘。 但是，如果数据集太大而无法存储，我们的框架会提供数据集流来迭代它而无需下载。</p> 
<p>表2：LlamaFactory 中的数据集结构。</p> 
<table id="S3.T2.3.1"><tbody><tr id="S3.T2.3.1.1.1"><th id="S3.T2.3.1.1.1.1">Plain text</th><td id="S3.T2.3.1.1.1.2"> <p id="S3.T2.3.1.1.1.2.1">[{"text": "…"}, {"text": "…"}]</p> </td></tr><tr id="S3.T2.3.1.2.2"><th id="S3.T2.3.1.2.2.1">Alpaca-like data</th><td id="S3.T2.3.1.2.2.2"> <p id="S3.T2.3.1.2.2.2.1">[{"instruction": "…", "input": "…", "output": "…"}]</p> </td></tr><tr id="S3.T2.3.1.3.3"><th id="S3.T2.3.1.3.3.1">ShareGPT-like data</th><td id="S3.T2.3.1.3.3.2"> <p id="S3.T2.3.1.3.3.2.1">[{"conversations": [{"from": "human", "value": "…"}, {"from": "gpt", "value": "…"}]}]</p> </td></tr><tr id="S3.T2.3.1.4.4"><th id="S3.T2.3.1.4.4.1">Preference data</th><td id="S3.T2.3.1.4.4.2"> <p id="S3.T2.3.1.4.4.2.1">[{"instruction": "…", "input": "…", "output": ["…", "…"]}]</p> </td></tr><tr id="S3.T2.3.1.5.5"><th id="S3.T2.3.1.5.5.1">Standardized data</th><td id="S3.T2.3.1.5.5.2"> <p id="S3.T2.3.1.5.5.2.1">{"prompt": [{"role": "…", "content": "…"}],</p> </td></tr><tr id="S3.T2.3.1.6.6"><th id="S3.T2.3.1.6.6.1"></th><td id="S3.T2.3.1.6.6.2"> <p id="S3.T2.3.1.6.6.2.1">"response": [{"role": "…", "content": "…"}],</p> </td></tr><tr id="S3.T2.3.1.7.7"><th id="S3.T2.3.1.7.7.1"></th><td id="S3.T2.3.1.7.7.2"> <p id="S3.T2.3.1.7.7.2.1">"system": "…", "tools": "…"}</p> </td></tr></tbody></table> 
<h5 id="yiyi-114">数据集对齐</h5> 
<p id="S3.SS2.SSS0.Px2.p1.1">为了统一数据集格式，我们设计了数据描述规范来表征数据集的结构。 例如，alpaca 数据集有三列：指令、输入和输出(Taori 等人, 2023)。 我们根据数据描述规范将数据集转换为兼容各种任务的标准结构。 表<a href="https://arxiv.org/html/2403.13372v2#S3.T2" rel="nofollow" title="2">2</a>中显示了数据集结构的一些示例。</p> 
<h5 id="yiyi-119">数据集合并</h5> 
<p id="S3.SS2.SSS0.Px3.p1.1">统一的数据集结构提供了合并多个数据集的有效方法。 对于非流模式下的数据集，我们只需在数据集被打乱之前将它们连接起来即可。 然而，在流模式下，简单地连接数据集会阻碍数据洗牌。 因此，我们提供了从不同数据集中交替读取数据的方法。</p> 
<h5 id="yiyi-124">数据集预处理</h5> 
<p id="S3.SS2.SSS0.Px4.p1.1">LlamaFactory 旨在<span style="background-color:#ffd900;">微调文本生成模型</span>，主要用于聊天补全。 聊天模板是这些模型中的关键组成部分，因为它与这些模型的<span style="background-color:#ff9900;">指令跟踪能力高度相</span>关。 因此，我们提供了数十种聊天模板，可以根据模型类型自动选择。 我们使用分词<span style="background-color:#ffd900;">器应用聊天模板后对句子进行编码。 </span>默认情况下，我们只计算完成时的损失，而忽略提示（Taori等人，2023）。 或者，我们可以利用序列打包 (Krell 等人, 2021) 来减少训练时间，该时间在执行生成预训练时自动启用。 附录<a href="https://arxiv.org/html/2403.13372v2#A3" rel="nofollow" title="C">C</a>显示了我们模板设计的详细信息。</p> 
<h4>3.3培训师</h4> 
<h5 id="yiyi-133">高效训练</h5> 
<p id="S3.SS3.SSS0.Px1.p1.3">我们将最先进的高效微调方法，包括 LoRA+ (Hayou 等人, 2024) 和 GaLore (Zhao 等人, 2024) 集成到训练器中通过替换默认组件。 这些训练方法独立于训练者，使它们可以轻松应用于各种任务。 我们使用 Transformers (Wolf 等人, 2020) 的训练器进行预训练和 SFT，同时采用 TRL (von Werra 等人, 2020) 的训练器进行 RLHF和 DPO。 利用定制的数据整理器来区分不同训练方法的培训师。 为了匹配偏好数据的训练器输入格式，我们在一批中构建 2⁢� 样本，其中第一个 � 样本是选择的样本，最后一个 � 样本都是被拒绝的例子。</p> 
<h5 id="yiyi-139">模型共享 RLHF</h5> 
<p id="S3.SS3.SSS0.Px2.p1.1">允许在消费设备上进行 RLHF 训练对于大语言模型微调来说是一个有用的属性。 然而，这很困难，因为 RLHF 训练需要四种不同的模型。 为了解决这一问题，我们提出了模型共享 RLHF 训练，使整个 RLHF 只需要一个以上的预训练模型。 具体来说，我们首先训练一个适配器和一个具有奖励建模目标函数的值头，使模型能够计算奖励分数。 然后我们初始化另一个适配器和值头，并使用 PPO 算法（Ouyang 等人，2022）对它们进行训练。 训练过程中，通过 PEFT (Mangrulkar 等人, 2022) 的 set_adapter 和 disable_adapter API 动态切换适配器和值头，允许预配置-训练模型同时充当政策、价值、参考和奖励模型。 据我们所知，这是第一个在消费设备上支持 RLHF 训练的方法。</p> 
<h5 id="yiyi-147">分布式训练</h5> 
<p id="S3.SS3.SSS0.Px3.p1.1">我们可以将上述训练器与 DeepSpeed (Rasley 等人, 2020) 结合起来进行分布式训练。 利用 DeepSpeed ZeRO 优化器，可以通过分区或卸载进一步减少内存消耗。</p> 
<h4>3.4实用程序</h4> 
<h5 id="yiyi-151">加速推理</h5> 
<p id="S3.SS4.SSS0.Px1.p1.1">在推理期间，我们重用数据工作者的聊天模板来构建模型输入。 我们支持使用 Transformers (Wolf 等人, 2020) 和 vLLM (Kwon 等人, 2023) 对模型输出进行采样，两者都支持流解码。 此外，我们实现了一个OpenAI风格的API，利用异步大语言模型引擎和vLLM的分页注意力来提供高吞吐量并发推理服务，方便将微调的大语言模型部署到各种应用程序中。</p> 
<h5 id="yiyi-155">综合评价</h5> 
<p id="S3.SS4.SSS0.Px2.p1.1">我们提供了多个评估大语言模型的指标，包括多项选择任务，例如 MMLU (Hendrycks 等人, 2021)、CMMLU (Li 等人, 2023a) 和C-Eval (Huang 等人, 2023)，以及计算文本相似度分数，如 BLEU-4 (Papineni 等人, 2002) 和 ROUGE (Lin ，2004）。</p> 
<h4>3.5<span style="background-color:#ffd900;">LlamaBoard</span>:LlamaFactory的统一接口</h4> 
<p id="S3.SS5.p1.1">LlamaBoard是基于Gradio（Abid等人，2019）的统一用户界面，允许用户自定义大语言模型的微调，而无需编写任何代码。 它提供了简化的模型微调和推理服务，使用户能够在实践中轻松利用100多个大语言模型和50多个数据集。 LlamaBoard具有以下显着特点：</p> 
<p id="S3.SS5.p2.1">轻松配置 LlamaBoard 允许用户通过与 Web 界面交互来自定义微调参数。 我们为大多数用户推荐的许多参数提供了默认值，从而简化了配置过程。 此外，用户可以在 Web UI 上预览数据集以检查其自定义格式。</p> 
<p id="S3.SS5.p3.1">可监控的训练 训练过程中，<span style="background-color:#ffd900;">训练日志和训练损失曲线可视化</span>并实时更新，方便用户监控训练进度。 此功能为分析微调过程提供了宝贵的见解。</p> 
<p id="S3.SS5.p4.1">灵活评估 LlamaBoard 支持计算数据集上的文本相似度分数以自动评估模型或通过与模型聊天进行人工评估。</p> 
<p id="S3.SS5.p5.1">多语言支持 <span style="background-color:#a2e043;">LlamaBoard 提供本地化文件</span>，方便集成新语言来渲染界面。 目前我们支持英语、俄语、中文三种语言，可以让更广泛的用户使用 羊驼板 用于微调大语言模型。</p> 
<h3>4实证研究</h3> 
<p>表3：LlamaFactory中使用<span style="background-color:#ffd900;">不同微调方法</span>的训练效率比较。 每个模型的 <span style="background-color:#ff9900;">GaLore、LoRA</span> 和 QLoRA 中最好的结果以粗体显示。</p> 
<table id="S4.T3.7.1"><thead><tr id="S4.T3.7.1.1.1"><th id="S4.T3.7.1.1.1.1"></th><th colspan="3" id="S4.T3.7.1.1.1.2">Gemma-2B</th><th colspan="3" id="S4.T3.7.1.1.1.3">Llama2-7B</th><th colspan="3" id="S4.T3.7.1.1.1.4">Llama2-13B</th></tr></thead><tbody><tr id="S4.T3.7.1.2.1"><th id="S4.T3.7.1.2.1.1">Method</th><td id="S4.T3.7.1.2.1.2">Memory</td><td id="S4.T3.7.1.2.1.3">Throughput</td><td id="S4.T3.7.1.2.1.4">PPL</td><td id="S4.T3.7.1.2.1.5">Memory</td><td id="S4.T3.7.1.2.1.6">Throughput</td><td id="S4.T3.7.1.2.1.7">PPL</td><td id="S4.T3.7.1.2.1.8">Memory</td><td id="S4.T3.7.1.2.1.9">Throughput</td><td id="S4.T3.7.1.2.1.10">PPL</td></tr><tr id="S4.T3.7.1.3.2"><th id="S4.T3.7.1.3.2.1"></th><td id="S4.T3.7.1.3.2.2">(GB)</td><td id="S4.T3.7.1.3.2.3">(Tokens/s)</td><td id="S4.T3.7.1.3.2.4"></td><td id="S4.T3.7.1.3.2.5">(GB)</td><td id="S4.T3.7.1.3.2.6">(Tokens/s)</td><td id="S4.T3.7.1.3.2.7"></td><td id="S4.T3.7.1.3.2.8">(GB)</td><td id="S4.T3.7.1.3.2.9">(Tokens/s)</td><td id="S4.T3.7.1.3.2.10"></td></tr><tr id="S4.T3.7.1.4.3"><th id="S4.T3.7.1.4.3.1">Baseline</th><td id="S4.T3.7.1.4.3.2">/</td><td id="S4.T3.7.1.4.3.3">/</td><td id="S4.T3.7.1.4.3.4">11.83</td><td id="S4.T3.7.1.4.3.5">/</td><td id="S4.T3.7.1.4.3.6">/</td><td id="S4.T3.7.1.4.3.7">7.53</td><td id="S4.T3.7.1.4.3.8">/</td><td id="S4.T3.7.1.4.3.9">/</td><td id="S4.T3.7.1.4.3.10">6.66</td></tr><tr id="S4.T3.7.1.5.4"><th id="S4.T3.7.1.5.4.1">Full-tuning</th><td id="S4.T3.7.1.5.4.2">17.06</td><td id="S4.T3.7.1.5.4.3">3090.42</td><td id="S4.T3.7.1.5.4.4">10.34</td><td id="S4.T3.7.1.5.4.5">38.72</td><td id="S4.T3.7.1.5.4.6">1334.72</td><td id="S4.T3.7.1.5.4.7">5.56</td><td id="S4.T3.7.1.5.4.8">/</td><td id="S4.T3.7.1.5.4.9">/</td><td id="S4.T3.7.1.5.4.10">/</td></tr><tr id="S4.T3.7.1.6.5"><th id="S4.T3.7.1.6.5.1">Freeze-tuning</th><td id="S4.T3.7.1.6.5.2">8.10</td><td id="S4.T3.7.1.6.5.3">5608.49</td><td id="S4.T3.7.1.6.5.4">11.33</td><td id="S4.T3.7.1.6.5.5">15.69</td><td id="S4.T3.7.1.6.5.6">2904.98</td><td id="S4.T3.7.1.6.5.7">6.59</td><td id="S4.T3.7.1.6.5.8">29.02</td><td id="S4.T3.7.1.6.5.9">1841.46</td><td id="S4.T3.7.1.6.5.10">6.56</td></tr><tr id="S4.T3.7.1.7.6"><th id="S4.T3.7.1.7.6.1">GaLore</th><td id="S4.T3.7.1.7.6.2">10.16</td><td id="S4.T3.7.1.7.6.3">2483.05</td><td id="S4.T3.7.1.7.6.4">10.38</td><td id="S4.T3.7.1.7.6.5">15.43</td><td id="S4.T3.7.1.7.6.6">1583.77</td><td id="S4.T3.7.1.7.6.7">5.88</td><td id="S4.T3.7.1.7.6.8">28.91</td><td id="S4.T3.7.1.7.6.9">956.39</td><td id="S4.T3.7.1.7.6.10">5.72</td></tr><tr id="S4.T3.7.1.8.7"><th id="S4.T3.7.1.8.7.1">LoRA</th><td id="S4.T3.7.1.8.7.2">7.91</td><td id="S4.T3.7.1.8.7.3">3521.05</td><td id="S4.T3.7.1.8.7.4">10.19</td><td id="S4.T3.7.1.8.7.5">16.32</td><td id="S4.T3.7.1.8.7.6">1954.07</td><td id="S4.T3.7.1.8.7.7">5.81</td><td id="S4.T3.7.1.8.7.8">30.09</td><td id="S4.T3.7.1.8.7.9">1468.19</td><td id="S4.T3.7.1.8.7.10">5.75</td></tr><tr id="S4.T3.7.1.9.8"><th id="S4.T3.7.1.9.8.1">QLoRA</th><td id="S4.T3.7.1.9.8.2">5.21</td><td id="S4.T3.7.1.9.8.3">3158.59</td><td id="S4.T3.7.1.9.8.4">10.46</td><td id="S4.T3.7.1.9.8.5">7.52</td><td id="S4.T3.7.1.9.8.6">1579.16</td><td id="S4.T3.7.1.9.8.7">5.91</td><td id="S4.T3.7.1.9.8.8">12.61</td><td id="S4.T3.7.1.9.8.9">973.53</td><td id="S4.T3.7.1.9.8.10">5.81</td></tr></tbody></table> 
<p>表4：在 LlamaFactory 中使用不同微调方法在特定任务上的性能比较（以 ROUGE 计）。 每个模型的最佳结果是下划线，每个任务的最佳结果是粗体。</p> 
<table id="S4.T4.10.1"><thead><tr id="S4.T4.10.1.1.1"><th id="S4.T4.10.1.1.1.1"></th><th colspan="5" id="S4.T4.10.1.1.1.2">CNN / DM</th><th colspan="5" id="S4.T4.10.1.1.1.3">XSum</th><th colspan="5" id="S4.T4.10.1.1.1.4">AdGen</th></tr><tr id="S4.T4.10.1.2.2"><th id="S4.T4.10.1.2.2.1">Model</th><th id="S4.T4.10.1.2.2.2">Baseline</th><th id="S4.T4.10.1.2.2.3">FT</th><th id="S4.T4.10.1.2.2.4">GaLore</th><th id="S4.T4.10.1.2.2.5">LoRA</th><th id="S4.T4.10.1.2.2.6">QLoRA</th><th id="S4.T4.10.1.2.2.7">Baseline</th><th id="S4.T4.10.1.2.2.8">FT</th><th id="S4.T4.10.1.2.2.9">GaLore</th><th id="S4.T4.10.1.2.2.10">LoRA</th><th id="S4.T4.10.1.2.2.11">QLoRA</th><th id="S4.T4.10.1.2.2.12">Baseline</th><th id="S4.T4.10.1.2.2.13">FT</th><th id="S4.T4.10.1.2.2.14">GaLore</th><th id="S4.T4.10.1.2.2.15">LoRA</th><th id="S4.T4.10.1.2.2.16">QLoRA</th></tr></thead><tbody><tr id="S4.T4.10.1.3.1"><th id="S4.T4.10.1.3.1.1">LLaMA2-7B</th><td id="S4.T4.10.1.3.1.2">12.94</td><td id="S4.T4.10.1.3.1.3">22.87</td><td id="S4.T4.10.1.3.1.4">22.40</td><td id="S4.T4.10.1.3.1.5">22.70</td><td id="S4.T4.10.1.3.1.6">22.61</td><td id="S4.T4.10.1.3.1.7">13.89</td><td id="S4.T4.10.1.3.1.8">27.69</td><td id="S4.T4.10.1.3.1.9">27.64</td><td id="S4.T4.10.1.3.1.10">28.80</td><td id="S4.T4.10.1.3.1.11">28.05</td><td id="S4.T4.10.1.3.1.12">0.61</td><td id="S4.T4.10.1.3.1.13">20.51</td><td id="S4.T4.10.1.3.1.14">19.61</td><td id="S4.T4.10.1.3.1.15">20.29</td><td id="S4.T4.10.1.3.1.16">20.45</td></tr><tr id="S4.T4.10.1.4.2"><th id="S4.T4.10.1.4.2.1">Mistral-7B</th><td id="S4.T4.10.1.4.2.2">14.39</td><td id="S4.T4.10.1.4.2.3">22.03</td><td id="S4.T4.10.1.4.2.4">22.99</td><td id="S4.T4.10.1.4.2.5">23.47</td><td id="S4.T4.10.1.4.2.6">23.28</td><td id="S4.T4.10.1.4.2.7">15.87</td><td id="S4.T4.10.1.4.2.8">23.57</td><td id="S4.T4.10.1.4.2.9">28.00</td><td id="S4.T4.10.1.4.2.10">30.41</td><td id="S4.T4.10.1.4.2.11">30.44</td><td id="S4.T4.10.1.4.2.12">7.82</td><td id="S4.T4.10.1.4.2.13">20.14</td><td id="S4.T4.10.1.4.2.14">20.90</td><td id="S4.T4.10.1.4.2.15">20.99</td><td id="S4.T4.10.1.4.2.16">20.56</td></tr><tr id="S4.T4.10.1.5.3"><th id="S4.T4.10.1.5.3.1">Gemma-7B</th><td id="S4.T4.10.1.5.3.2">15.97</td><td id="S4.T4.10.1.5.3.3">22.07</td><td id="S4.T4.10.1.5.3.4">/</td><td id="S4.T4.10.1.5.3.5">22.41</td><td id="S4.T4.10.1.5.3.6">22.44</td><td id="S4.T4.10.1.5.3.7">15.31</td><td id="S4.T4.10.1.5.3.8">25.13</td><td id="S4.T4.10.1.5.3.9">/</td><td id="S4.T4.10.1.5.3.10">28.67</td><td id="S4.T4.10.1.5.3.11">29.02</td><td id="S4.T4.10.1.5.3.12">11.57</td><td id="S4.T4.10.1.5.3.13">19.99</td><td id="S4.T4.10.1.5.3.14">/</td><td id="S4.T4.10.1.5.3.15">20.62</td><td id="S4.T4.10.1.5.3.16">19.81</td></tr><tr id="S4.T4.10.1.6.4"><th id="S4.T4.10.1.6.4.1">Qwen1.5-7B</th><td id="S4.T4.10.1.6.4.2">15.40</td><td id="S4.T4.10.1.6.4.3">22.46</td><td id="S4.T4.10.1.6.4.4">21.76</td><td id="S4.T4.10.1.6.4.5">22.71</td><td id="S4.T4.10.1.6.4.6">22.52</td><td id="S4.T4.10.1.6.4.7">19.27</td><td id="S4.T4.10.1.6.4.8">26.68</td><td id="S4.T4.10.1.6.4.9">26.64</td><td id="S4.T4.10.1.6.4.10">27.77</td><td id="S4.T4.10.1.6.4.11">27.60</td><td id="S4.T4.10.1.6.4.12">14.49</td><td id="S4.T4.10.1.6.4.13">20.42</td><td id="S4.T4.10.1.6.4.14">21.08</td><td id="S4.T4.10.1.6.4.15">21.31</td><td id="S4.T4.10.1.6.4.16">21.34</td></tr><tr id="S4.T4.10.1.7.5"><th id="S4.T4.10.1.7.5.1">Yi-6B</th><td id="S4.T4.10.1.7.5.2">16.85</td><td id="S4.T4.10.1.7.5.3">22.40</td><td id="S4.T4.10.1.7.5.4">22.68</td><td id="S4.T4.10.1.7.5.5">22.98</td><td id="S4.T4.10.1.7.5.6">22.97</td><td id="S4.T4.10.1.7.5.7">18.24</td><td id="S4.T4.10.1.7.5.8">27.09</td><td id="S4.T4.10.1.7.5.9">28.25</td><td id="S4.T4.10.1.7.5.10">28.71</td><td id="S4.T4.10.1.7.5.11">29.21</td><td id="S4.T4.10.1.7.5.12">13.34</td><td id="S4.T4.10.1.7.5.13">19.68</td><td id="S4.T4.10.1.7.5.14">20.06</td><td id="S4.T4.10.1.7.5.15">20.97</td><td id="S4.T4.10.1.7.5.16">20.31</td></tr><tr id="S4.T4.10.1.8.6"><th id="S4.T4.10.1.8.6.1">ChatGLM3-6B</th><td id="S4.T4.10.1.8.6.2">18.51</td><td id="S4.T4.10.1.8.6.3">22.00</td><td id="S4.T4.10.1.8.6.4">22.16</td><td id="S4.T4.10.1.8.6.5">21.68</td><td id="S4.T4.10.1.8.6.6">21.70</td><td id="S4.T4.10.1.8.6.7">16.14</td><td id="S4.T4.10.1.8.6.8">26.25</td><td id="S4.T4.10.1.8.6.9">26.34</td><td id="S4.T4.10.1.8.6.10">26.50</td><td id="S4.T4.10.1.8.6.11">26.78</td><td id="S4.T4.10.1.8.6.12">14.53</td><td id="S4.T4.10.1.8.6.13">19.91</td><td id="S4.T4.10.1.8.6.14">20.57</td><td id="S4.T4.10.1.8.6.15">20.47</td><td id="S4.T4.10.1.8.6.16">20.49</td></tr></tbody></table> 
<p id="S4.p1.1">我们系统地评估LlamaFactory 从两个角度来看：1）内存使用、吞吐量和困惑度方面的训练效率。 2）下游任务适应的有效性。</p> 
<h4>4.1训练效率</h4> 
<h5 id="yiyi-188">实验装置</h5> 
<p id="S4.SS1.SSS0.Px1.p1.1">我们利用 PubMed Canese 和 Weis (2013) 数据集，其中包含超过 3600 万条生物医学文献记录。 我们从文献摘要中提取了大约 400,000 个标记来构建训练示例。 我们使用生成预训练目标来构建 Gemma-2B (Mesnard 等人, 2024)、Llama2-7B 和 Llama2-13B (Touvron 等人, 2023b) 模型具有各种有效的微调方法。 我们比较了全调优、冻结调优、GaLore、LoRA 和 4 位 QLoRA 的结果。 微调后，我们计算训练示例的困惑度来评估不同方法的效率。 我们还将预训练模型的困惑度作为基线。 更多实验细节可参见附录 <a href="https://arxiv.org/html/2403.13372v2#A4.SS1" rel="nofollow" title="D.1">D.1</a>.</p> 
<h5 id="yiyi-197">结果</h5> 
<p id="S4.SS1.SSS0.Px2.p1.1">训练效率结果见表<a href="https://arxiv.org/html/2403.13372v2#S4.T3" rel="nofollow" title="3">3</a>，其中内存是指训练期间消耗的峰值内存，吞吐量计算为每秒训练的 Token 数量，PPL 表示模型在训练示例上的困惑度。 由于完全调优 Llama2-13B 会导致内存溢出，因此不会记录结果。 我们观察到 QLoRA 始终具有最低的内存占用，因为预训练的权重以较低的精度表示。 LoRA 利用 Unsloth 对 LoRA 层的优化表现出更高的吞吐量。 GaLore 在大型模型上实现了较低的 PPL，而 LoRA 在小型模型上具有优势。</p> 
<h4>4.2下游任务的微调</h4> 
<h5 id="yiyi-206">实验装置</h5> 
<p id="S4.SS2.SSS0.Px1.p1.1">为了评估不同高效微调方法的有效性，我们比较了各种模型在下游任务上微调后的性能。 我们使用来自三个代表性文本生成任务的 2,000 个示例和 1,000 个示例构建训练集和测试集，包括 CNN/DM (Nallapati 等人, 2016)、XSum (Narayan 等人, 2018 ) 和 AdGen (Shao 等人, 2019)。 我们选择了几个指令调整模型，并使用不同的微调方法按照序列到序列任务对它们进行调节。 我们比较了全调优（FT）、GaLore、LoRA 和 4 位 QLoRA 的结果。 经过微调后，我们计算每个任务的测试集上的 ROUGE 分数（Lin，2004）。 我们还将原始指令调整模型的分数作为基线。 更多实验细节可参见附录 <a href="https://arxiv.org/html/2403.13372v2#A4.SS2" rel="nofollow" title="D.2">D.2</a>.</p> 
<h5 id="yiyi-215">结果</h5> 
<p id="S4.SS2.SSS0.Px2.p1.1">下游任务评估结果如表<a href="https://arxiv.org/html/2403.13372v2#S4.T4" rel="nofollow" title="4">4</a>. 我们报告每个大语言模型和每个数据集的 ROUGE-1、ROUGE-2 和 ROUGE-L 的平均分数。 Gemma-7B 的一些结果未包含在表中，因为 GaLore 方法不适用于该模型。 结果中一个有趣的发现是，LoRA 和 QLoRA 在大多数情况下都实现了最佳性能，除了 CNN/DM 和 AdGen 数据集上的 Llama2-7B 和 ChatGLM3-6B 模型。 这一现象凸显了这些有效的微调方法在使大语言模型模型适应特定任务方面的有效性。 此外，我们观察到 Mistral-7B 模型在英语数据集上表现更好，而 Qwen1.5-7B 模型在中文数据集上取得了更高的分数。 这些结果表明，微调模型的性能也与其在特定语言上的固有功能相关。</p> 
<h3>5结论和未来的工作</h3> 
<p id="S5.p1.1">在本文中，我们演示了LlamaFactory，大语言模型高效微调的统一框架。 通过模块化设计，我们最大限度地减少了模型、数据集和训练方法之间的依赖性，并提供了超过 100 个大语言模型的集成方法以及各种高效的微调技术。 此外，我们还提供灵活的 Web UI 羊驼板，无需编码即可实现大语言模型的定制微调和评估。 我们凭经验验证了我们的框架在语言建模和文本生成任务上的效率和有效性。</p> 
<p id="S5.p2.1">未来，我们将一如既往地保留LlamaFactory 与最先进的模型和高效的微调技术同步。 我们也欢迎开源社区的贡献。 在未来的版本中，我们将探索更先进的大语言模型并行训练策略和多模态高效微调。</p> 
<h3>6更广泛的影响和负责任的使用</h3> 
<p id="S6.p1.1">骆驼工厂 吸引了大量对大语言模型感兴趣的个人探索微调自己模型的可能性。 这对开源社区的发展做出了重大贡献。 它受到越来越多的关注，并出现在《Awesome Transformers》中3 作为大语言模型高效微调框架的代表。 我们期望实践者在我们的框架上建立他们的大语言模型，为社会带来好处。 使用时必须遵守模型许可证 骆驼工厂 用于微调大语言模型，从而防止任何潜在的误用。</p> 
<h3 id="yiyi-249">参考</h3> 
<ul><li id="bib.bib1">Abid et al. (2019)Abubakar Abid, Ali Abdalla, Ali Abid, Dawood Khan, Abdulrahman Alfozan, and James Zou. 2019.<a href="http://arxiv.org/abs/1906.02569" rel="nofollow" title="Gradio: Hassle-free sharing and testing of ml models in the wild">Gradio: Hassle-free sharing and testing of ml models in the wild</a>.<em id="bib.bib1.9.1">arXiv preprint arXiv:1906.02569</em>.</li><li id="bib.bib2">AI (2023)Lightning AI. 2023.<a href="https://github.com/Lightning-AI/lit-gpt" title="Lit-GPT">Lit-GPT</a>.</li><li id="bib.bib3">Almazrouei et al. (2023)Ebtesam Almazrouei, Hamza Alobeidli, Abdulaziz Alshamsi, Alessandro Cappelli, Ruxandra Cojocaru, Mérouane Debbah, Étienne Goffinet, Daniel Hesslow, Julien Launay, Quentin Malartic, et al. 2023.<a href="http://arxiv.org/abs/2311.16867" rel="nofollow" title="The falcon series of open language models">The falcon series of open language models</a>.<em id="bib.bib3.9.1">arXiv preprint arXiv:2311.16867</em>.</li><li id="bib.bib4">Anand et al. (2023)Yuvanesh Anand, Zach Nussbaum, Brandon Duderstadt, Benjamin Schmidt, and Andriy Mulyar. 2023.<a href="https://github.com/nomic-ai/gpt4all" title="GPT4All: Training an assistant-style chatbot with large scale data distillation from GPT-3.5-turbo">GPT4All: Training an assistant-style chatbot with large scale data distillation from GPT-3.5-turbo</a>.</li><li id="bib.bib5">Apache (2016)Apache. 2016.<a href="https://github.com/apache/arrow" title="Arrow">Arrow</a>.</li><li id="bib.bib6">Bai et al. (2023)Jinze Bai, Shuai Bai, Yunfei Chu, Zeyu Cui, Kai Dang, Xiaodong Deng, Yang Fan, Wenbin Ge, Yu Han, Fei Huang, et al. 2023.<a href="http://arxiv.org/abs/2309.16609" rel="nofollow" title="Qwen technical report">Qwen technical report</a>.<em id="bib.bib6.9.1">arXiv preprint arXiv:2309.16609</em>.</li><li id="bib.bib7">Beeching et al. (2023)Edward Beeching, Clémentine Fourrier, Nathan Habib, Sheon Han, Nathan Lambert, Nazneen Rajani, Omar Sanseviero, Lewis Tunstall, and Thomas Wolf. 2023.<a href="https://huggingface.co/spaces/HuggingFaceH4/open_llm_leaderboard" rel="nofollow" title="Open LLM leaderboard">Open LLM leaderboard</a>.</li><li id="bib.bib8">Ben Zaken et al. (2022)Elad Ben Zaken, Yoav Goldberg, and Shauli Ravfogel. 2022.<a href="https://doi.org/10.18653/v1/2022.acl-short.1" rel="nofollow" title="BitFit: Simple parameter-efficient fine-tuning for transformer-based masked language-models">BitFit: Simple parameter-efficient fine-tuning for transformer-based masked language-models</a>.In <em id="bib.bib8.10.2">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 2: Short Papers)</em>, pages 1–9, Dublin, Ireland. Association for Computational Linguistics.</li><li id="bib.bib9">Bhardwaj et al. (2024)Rishabh Bhardwaj, Do Duc Anh, and Soujanya Poria. 2024.<a href="http://arxiv.org/abs/2402.11746" rel="nofollow" title="Language models are homer simpson! safety re-alignment of fine-tuned language models through task arithmetic">Language models are homer simpson! safety re-alignment of fine-tuned language models through task arithmetic</a>.<em id="bib.bib9.9.1">arXiv preprint arXiv:2402.11746</em>.</li><li id="bib.bib10">Bi et al. (2024)Xiao Bi, Deli Chen, Guanting Chen, Shanhuang Chen, Damai Dai, Chengqi Deng, Honghui Ding, Kai Dong, Qiushi Du, Zhe Fu, et al. 2024.<a href="http://arxiv.org/abs/2401.02954" rel="nofollow" title="DeepSeek LLM: Scaling open-source language models with longtermism">DeepSeek LLM: Scaling open-source language models with longtermism</a>.<em id="bib.bib10.9.1">arXiv preprint arXiv:2401.02954</em>.</li><li id="bib.bib11">Canese and Weis (2013)Kathi Canese and Sarah Weis. 2013.<a href="https://www.be-md.ncbi.nlm.nih.gov/books/NBK153385/pdf/Bookshelf_NBK153385.pdf" rel="nofollow" title="PubMed: the bibliographic database">PubMed: the bibliographic database</a>.<em id="bib.bib11.8.1">The NCBI handbook</em>, 2(1).</li><li id="bib.bib12">Chen et al. (2024a)Du Chen, Yi Huang, Xiaopu Li, Yongqiang Li, Yongqiang Liu, Haihui Pan, Leichao Xu, Dacheng Zhang, Zhipeng Zhang, and Kun Han. 2024a.<a href="http://arxiv.org/abs/2401.12246" rel="nofollow" title="Orion-14b: Open-source multilingual large language models">Orion-14b: Open-source multilingual large language models</a>.<em id="bib.bib12.9.1">arXiv preprint arXiv:2401.12246</em>.</li><li id="bib.bib13">Chen et al. (2023)Shouyuan Chen, Sherman Wong, Liangjian Chen, and Yuandong Tian. 2023.<a href="http://arxiv.org/abs/2306.15595" rel="nofollow" title="Extending context window of large language models via positional interpolation">Extending context window of large language models via positional interpolation</a>.<em id="bib.bib13.9.1">arXiv preprint arXiv:2306.15595</em>.</li><li id="bib.bib14">Chen et al. (2016)Tianqi Chen, Bing Xu, Chiyuan Zhang, and Carlos Guestrin. 2016.<a href="http://arxiv.org/abs/1604.06174" rel="nofollow" title="Training deep nets with sublinear memory cost">Training deep nets with sublinear memory cost</a>.<em id="bib.bib14.9.1">arXiv preprint arXiv:1604.06174</em>.</li><li id="bib.bib15">Chen et al. (2024b)Yukang Chen, Shengju Qian, Haotian Tang, Xin Lai, Zhijian Liu, Song Han, and Jiaya Jia. 2024b.<a href="https://openreview.net/forum?id=6PmJoRfdaK" rel="nofollow" title="LongLoRA: Efficient fine-tuning of long-context large language models">LongLoRA: Efficient fine-tuning of long-context large language models</a>.In <em id="bib.bib15.10.2">International Conference on Learning Representations</em>.</li><li id="bib.bib16">Cui et al. (2023)Yiming Cui, Ziqing Yang, and Xin Yao. 2023.<a href="http://arxiv.org/abs/2304.08177" rel="nofollow" title="Efficient and effective text encoding for chinese llama and alpaca">Efficient and effective text encoding for chinese llama and alpaca</a>.<em id="bib.bib16.9.1">arXiv preprint arXiv:2304.08177</em>.</li><li id="bib.bib17">Dai et al. (2024)Damai Dai, Chengqi Deng, Chenggang Zhao, RX Xu, Huazuo Gao, Deli Chen, Jiashi Li, Wangding Zeng, Xingkai Yu, Y Wu, et al. 2024.<a href="http://arxiv.org/abs/2401.06066" rel="nofollow" title="DeepSeekMoE: Towards ultimate expert specialization in mixture-of-experts language models">DeepSeekMoE: Towards ultimate expert specialization in mixture-of-experts language models</a>.<em id="bib.bib17.9.1">arXiv preprint arXiv:2401.06066</em>.</li><li id="bib.bib18">Dao et al. (2022)Tri Dao, Dan Fu, Stefano Ermon, Atri Rudra, and Christopher Ré. 2022.<a href="https://proceedings.neurips.cc/paper_files/paper/2022/hash/67d57c32e20fd0a7a302cb81d36e40d5-Abstract-Conference.html" rel="nofollow" title="Flashattention: Fast and memory-efficient exact attention with io-awareness">Flashattention: Fast and memory-efficient exact attention with io-awareness</a>.<em id="bib.bib18.9.1">Advances in Neural Information Processing Systems</em>, 35:16344–16359.</li><li id="bib.bib19">Dettmers (2021)Tim Dettmers. 2021.<a href="https://github.com/TimDettmers/bitsandbytes" title="Bitsandbytes">Bitsandbytes</a>.</li><li id="bib.bib20">Dettmers et al. (2022a)Tim Dettmers, Mike Lewis, Younes Belkada, and Luke Zettlemoyer. 2022a.<a href="https://proceedings.neurips.cc/paper_files/paper/2022/hash/c3ba4962c05c49636d4c6206a97e9c8a-Abstract-Conference.html" rel="nofollow" title="GPT3.int8(): 8-bit matrix multiplication for transformers at scale">GPT3.int8(): 8-bit matrix multiplication for transformers at scale</a>.<em id="bib.bib20.9.1">Advances in Neural Information Processing Systems</em>, 35:30318–30332.</li><li id="bib.bib21">Dettmers et al. (2022b)Tim Dettmers, Mike Lewis, Sam Shleifer, and Luke Zettlemoyer. 2022b.<a href="https://openreview.net/forum?id=shpkpVXzo3h" rel="nofollow" title="8-bit optimizers via block-wise quantization">8-bit optimizers via block-wise quantization</a>.In <em id="bib.bib21.11.2">International Conference on Learning Representations</em>.</li><li id="bib.bib22">Dettmers et al. (2023)Tim Dettmers, Artidoro Pagnoni, Ari Holtzman, and Luke Zettlemoyer. 2023.<a href="https://proceedings.neurips.cc/paper_files/paper/2023/hash/1feb87871436031bdc0f2beaa62a049b-Abstract-Conference.html" rel="nofollow" title="QLoRA: Efficient finetuning of quantized llms">QLoRA: Efficient finetuning of quantized llms</a>.<em id="bib.bib22.9.1">Advances in Neural Information Processing Systems</em>, 36:10088–10115.</li><li id="bib.bib23">Diao et al. (2023)Shizhe Diao, Rui Pan, Hanze Dong, Ka Shun Shum, Jipeng Zhang, Wei Xiong, and Tong Zhang. 2023.<a href="http://arxiv.org/abs/2306.12420" rel="nofollow" title="LMFlow: An extensible toolkit for finetuning and inference of large foundation models">LMFlow: An extensible toolkit for finetuning and inference of large foundation models</a>.<em id="bib.bib23.9.1">arXiv preprint arXiv:2306.12420</em>.</li><li id="bib.bib24">Du et al. (2022)Zhengxiao Du, Yujie Qian, Xiao Liu, Ming Ding, Jiezhong Qiu, Zhilin Yang, and Jie Tang. 2022.<a href="https://doi.org/10.18653/v1/2022.acl-long.26" rel="nofollow" title="GLM: General language model pretraining with autoregressive blank infilling">GLM: General language model pretraining with autoregressive blank infilling</a>.In <em id="bib.bib24.10.2">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pages 320–335, Dublin, Ireland. Association for Computational Linguistics.</li><li id="bib.bib25">Egiazarian et al. (2024)Vage Egiazarian, Andrei Panferov, Denis Kuznedelev, Elias Frantar, Artem Babenko, and Dan Alistarh. 2024.<a href="http://arxiv.org/abs/2401.06118" rel="nofollow" title="Extreme compression of large language models via additive quantization">Extreme compression of large language models via additive quantization</a>.<em id="bib.bib25.9.1">arXiv preprint arXiv:2401.06118</em>.</li><li id="bib.bib26">Frantar et al. (2023)Elias Frantar, Saleh Ashkboos, Torsten Hoefler, and Dan Alistarh. 2023.<a href="https://openreview.net/forum?id=tcbBPnfwxS" rel="nofollow" title="GPTQ: Accurate post-training quantization for generative pre-trained transformers">GPTQ: Accurate post-training quantization for generative pre-trained transformers</a>.In <em id="bib.bib26.11.2">International Conference on Learning Representations</em>.</li><li id="bib.bib27">Groeneveld et al. (2024)Dirk Groeneveld, Iz Beltagy, Pete Walsh, Akshita Bhagia, Rodney Kinney, Oyvind Tafjord, Ananya Harsh Jha, Hamish Ivison, Ian Magnusson, Yizhong Wang, et al. 2024.<a href="http://arxiv.org/abs/2402.00838" rel="nofollow" title="OLMo: Accelerating the science of language models">OLMo: Accelerating the science of language models</a>.<em id="bib.bib27.9.1">arXiv preprint arXiv:2402.00838</em>.</li><li id="bib.bib28">Guo et al. (2024)Daya Guo, Qihao Zhu, Dejian Yang, Zhenda Xie, Kai Dong, Wentao Zhang, Guanting Chen, Xiao Bi, Y Wu, YK Li, et al. 2024.<a href="http://arxiv.org/abs/2401.14196" rel="nofollow" title="DeepSeek-Coder: When the large language model meets programming – the rise of code intelligence">DeepSeek-Coder: When the large language model meets programming – the rise of code intelligence</a>.<em id="bib.bib28.9.1">arXiv preprint arXiv:2401.14196</em>.</li><li id="bib.bib29">Han and Han (2023)Daniel Han and Michael Han. 2023.<a href="https://github.com/unslothai/unsloth" title="unsloth">unsloth</a>.</li><li id="bib.bib30">Hayou et al. (2024)Soufiane Hayou, Nikhil Ghosh, and Bin Yu. 2024.<a href="http://arxiv.org/abs/2402.12354" rel="nofollow" title="LoRA+: Efficient low rank adaptation of large models">LoRA+: Efficient low rank adaptation of large models</a>.<em id="bib.bib30.9.1">arXiv preprint arXiv:2402.12354</em>.</li><li id="bib.bib31">Hendrycks et al. (2021)Dan Hendrycks, Collin Burns, Steven Basart, Andy Zou, Mantas Mazeika, Dawn Song, and Jacob Steinhardt. 2021.<a href="https://openreview.net/forum?id=d7KBjmI3GmQ" rel="nofollow" title="Measuring massive multitask language understanding">Measuring massive multitask language understanding</a>.In <em id="bib.bib31.10.2">International Conference on Learning Representations</em>.</li><li id="bib.bib32">Houlsby et al. (2019)Neil Houlsby, Andrei Giurgiu, Stanislaw Jastrzebski, Bruna Morrone, Quentin De Laroussilhe, Andrea Gesmundo, Mona Attariyan, and Sylvain Gelly. 2019.<a href="https://proceedings.mlr.press/v97/houlsby19a.html" rel="nofollow" title="Parameter-efficient transfer learning for nlp">Parameter-efficient transfer learning for nlp</a>.In <em id="bib.bib32.10.2">International conference on machine learning</em>, pages 2790–2799. PMLR.</li><li id="bib.bib33">Hu et al. (2022)Edward J Hu, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, Weizhu Chen, et al. 2022.<a href="https://openreview.net/forum?id=nZeVKeeFYf9" rel="nofollow" title="LoRA: Low-rank adaptation of large language models">LoRA: Low-rank adaptation of large language models</a>.In <em id="bib.bib33.10.2">International Conference on Learning Representations</em>.</li><li id="bib.bib34">Huang et al. (2023)Yuzhen Huang, Yuzhuo Bai, Zhihao Zhu, Junlei Zhang, Jinghan Zhang, Tangjun Su, Junteng Liu, Chuancheng Lv, Yikai Zhang, Yao Fu, et al. 2023.<a href="https://proceedings.neurips.cc/paper_files/paper/2023/hash/c6ec1844bec96d6d32ae95ae694e23d8-Abstract-Datasets_and_Benchmarks.html" rel="nofollow" title="C-Eval: A multi-level multi-discipline chinese evaluation suite for foundation models">C-Eval: A multi-level multi-discipline chinese evaluation suite for foundation models</a>.<em id="bib.bib34.9.1">Advances in Neural Information Processing Systems</em>, 36.</li><li id="bib.bib35">Jiang et al. (2023a)Albert Q Jiang, Alexandre Sablayrolles, Arthur Mensch, Chris Bamford, Devendra Singh Chaplot, Diego de las Casas, Florian Bressand, Gianna Lengyel, Guillaume Lample, Lucile Saulnier, et al. 2023a.<a href="http://arxiv.org/abs/2310.06825" rel="nofollow" title="Mistral 7b">Mistral 7b</a>.<em id="bib.bib35.9.1">arXiv preprint arXiv:2310.06825</em>.</li><li id="bib.bib36">Jiang et al. (2023b)Jinhao Jiang, Kun Zhou, Wayne Xin Zhao, Yaliang Li, and Ji-Rong Wen. 2023b.<a href="https://doi.org/10.18653/v1/2023.emnlp-main.228" rel="nofollow" title="ReasoningLM: Enabling structural subgraph reasoning in pre-trained language models for question answering over knowledge graph">ReasoningLM: Enabling structural subgraph reasoning in pre-trained language models for question answering over knowledge graph</a>.In <em id="bib.bib36.10.2">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</em>, pages 3721–3735, Singapore. Association for Computational Linguistics.</li><li id="bib.bib37">Jiao et al. (2023a)Wenxiang Jiao, Jen-tse Huang, Wenxuan Wang, Zhiwei He, Tian Liang, Xing Wang, Shuming Shi, and Zhaopeng Tu. 2023a.<a href="https://doi.org/10.18653/v1/2023.findings-emnlp.1001" rel="nofollow" title="ParroT: Translating during chat using large language models tuned with human translation and feedback">ParroT: Translating during chat using large language models tuned with human translation and feedback</a>.In <em id="bib.bib37.10.2">Findings of the Association for Computational Linguistics: EMNLP 2023</em>, pages 15009–15020, Singapore. Association for Computational Linguistics.</li><li id="bib.bib38">Jiao et al. (2023b)Yizhu Jiao, Ming Zhong, Sha Li, Ruining Zhao, Siru Ouyang, Heng Ji, and Jiawei Han. 2023b.<a href="https://doi.org/10.18653/v1/2023.emnlp-main.620" rel="nofollow" title="Instruct and extract: Instruction tuning for on-demand information extraction">Instruct and extract: Instruction tuning for on-demand information extraction</a>.In <em id="bib.bib38.10.2">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</em>, pages 10030–10051, Singapore. Association for Computational Linguistics.</li><li id="bib.bib39">Kalajdzievski (2023)Damjan Kalajdzievski. 2023.<a href="http://arxiv.org/abs/2312.03732" rel="nofollow" title="A rank stabilization scaling factor for fine-tuning with LoRA">A rank stabilization scaling factor for fine-tuning with LoRA</a>.<em id="bib.bib39.8.1">arXiv preprint arXiv:2312.03732</em>.</li><li id="bib.bib40">Kim et al. (2023)Dahyun Kim, Chanjun Park, Sanghoon Kim, Wonsung Lee, Wonho Song, Yunsu Kim, Hyeonwoo Kim, Yungi Kim, Hyeonju Lee, Jihoo Kim, et al. 2023.<a href="http://arxiv.org/abs/2312.15166" rel="nofollow" title="SOLAR 10.7B: Scaling large language models with simple yet effective depth up-scaling">SOLAR 10.7B: Scaling large language models with simple yet effective depth up-scaling</a>.<em id="bib.bib40.9.1">arXiv preprint arXiv:2312.15166</em>.</li><li id="bib.bib41">Krell et al. (2021)Mario Michael Krell, Matej Kosec, Sergio P Perez, and Andrew Fitzgibbon. 2021.<a href="http://arxiv.org/abs/2107.02027" rel="nofollow" title="Efficient sequence packing without cross-contamination: Accelerating large language models without impacting performance">Efficient sequence packing without cross-contamination: Accelerating large language models without impacting performance</a>.<em id="bib.bib41.9.1">arXiv preprint arXiv:2107.02027</em>.</li><li id="bib.bib42">Kwon et al. (2023)Woosuk Kwon, Zhuohan Li, Siyuan Zhuang, Ying Sheng, Lianmin Zheng, Cody Hao Yu, Joseph Gonzalez, Hao Zhang, and Ion Stoica. 2023.<a href="https://doi.org/10.1145/3600006.3613165" rel="nofollow" title="Efficient memory management for large language model serving with PagedAttention">Efficient memory management for large language model serving with PagedAttention</a>.In <em id="bib.bib42.10.2">Proceedings of the 29th Symposium on Operating Systems Principles</em>, pages 611–626.</li><li id="bib.bib43">Le Scao et al. (2022)Teven Le Scao, Angela Fan, Christopher Akiki, Ellie Pavlick, Suzana Ilić, Daniel Hesslow, Roman Castagné, Alexandra Sasha Luccioni, François Yvon, Matthias Gallé, et al. 2022.<a href="http://arxiv.org/abs/2211.05100" rel="nofollow" title="BLOOM: A 176b-parameter open-access multilingual language model">BLOOM: A 176b-parameter open-access multilingual language model</a>.<em id="bib.bib43.9.1">arXiv preprint arXiv:2211.05100</em>.</li><li id="bib.bib44">Lhoest et al. (2021)Quentin Lhoest, Albert Villanova del Moral, Yacine Jernite, Abhishek Thakur, Patrick von Platen, Suraj Patil, Julien Chaumond, Mariama Drame, Julien Plu, Lewis Tunstall, et al. 2021.<a href="https://doi.org/10.18653/v1/2021.emnlp-demo.21" rel="nofollow" title="Datasets: A community library for natural language processing">Datasets: A community library for natural language processing</a>.In <em id="bib.bib44.10.2">Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing: System Demonstrations</em>, pages 175–184.</li><li id="bib.bib45">Li et al. (2023a)Haonan Li, Yixuan Zhang, Fajri Koto, Yifei Yang, Hai Zhao, Yeyun Gong, Nan Duan, and Timothy Baldwin. 2023a.<a href="http://arxiv.org/abs/2306.09212" rel="nofollow" title="CMMLU: Measuring massive multitask language understanding in chinese">CMMLU: Measuring massive multitask language understanding in chinese</a>.<em id="bib.bib45.9.1">arXiv preprint arXiv:2306.09212</em>.</li><li id="bib.bib46">Li et al. (2023b)Shenggui Li, Hongxin Liu, Zhengda Bian, Jiarui Fang, Haichen Huang, Yuliang Liu, Boxiang Wang, and Yang You. 2023b.<a href="https://doi.org/10.1145/3605573.3605613" rel="nofollow" title="Colossal-AI: A unified deep learning system for large-scale parallel training">Colossal-AI: A unified deep learning system for large-scale parallel training</a>.In <em id="bib.bib46.10.2">Proceedings of the 52nd International Conference on Parallel Processing</em>, pages 766–775.</li><li id="bib.bib47">Li et al. (2023c)Yuanzhi Li, Sébastien Bubeck, Ronen Eldan, Allie Del Giorno, Suriya Gunasekar, and Yin Tat Lee. 2023c.<a href="http://arxiv.org/abs/2309.05463" rel="nofollow" title="Textbooks are all you need ii: phi-1.5 technical report">Textbooks are all you need ii: phi-1.5 technical report</a>.<em id="bib.bib47.9.1">arXiv preprint arXiv:2309.05463</em>.</li><li id="bib.bib48">Lin (2004)Chin-Yew Lin. 2004.<a href="https://aclanthology.org/W04-1013/" rel="nofollow" title="ROUGE: A package for automatic evaluation of summaries">ROUGE: A package for automatic evaluation of summaries</a>.In <em id="bib.bib48.9.2">Text Summarization Branches Out</em>, pages 74–81, Barcelona, Spain. Association for Computational Linguistics.</li><li id="bib.bib49">Lin et al. (2023)Ji Lin, Jiaming Tang, Haotian Tang, Shang Yang, Xingyu Dang, and Song Han. 2023.<a href="http://arxiv.org/abs/2306.00978" rel="nofollow" title="AWQ: Activation-aware weight quantization for llm compression and acceleration">AWQ: Activation-aware weight quantization for llm compression and acceleration</a>.<em id="bib.bib49.9.1">arXiv preprint arXiv:2306.00978</em>.</li><li id="bib.bib50">Liu et al. (2024)Shih-Yang Liu, Chien-Yi Wang, Hongxu Yin, Pavlo Molchanov, Yu-Chiang Frank Wang, Kwang-Ting Cheng, and Min-Hung Chen. 2024.<a href="http://arxiv.org/abs/2402.09353" rel="nofollow" title="DoRA: Weight-decomposed low-rank adaptation">DoRA: Weight-decomposed low-rank adaptation</a>.<em id="bib.bib50.9.1">arXiv preprint arXiv:2402.09353</em>.</li><li id="bib.bib51">Lozhkov et al. (2024)Anton Lozhkov, Raymond Li, Loubna Ben Allal, Federico Cassano, Joel Lamy-Poirier, Nouamane Tazi, Ao Tang, Dmytro Pykhtar, Jiawei Liu, Yuxiang Wei, et al. 2024.<a href="http://arxiv.org/abs/2402.19173" rel="nofollow" title="StarCoder 2 and The Stack v2: The next generation">StarCoder 2 and The Stack v2: The next generation</a>.<em id="bib.bib51.9.1">arXiv preprint arXiv:2402.19173</em>.</li><li id="bib.bib52">Mangrulkar et al. (2022)Sourab Mangrulkar, Sylvain Gugger, Lysandre Debut, Younes Belkada, Sayak Paul, and Benjamin Bossan. 2022.<a href="https://github.com/huggingface/peft" title="PEFT: State-of-the-art parameter-efficient fine-tuning methods">PEFT: State-of-the-art parameter-efficient fine-tuning methods</a>.</li><li id="bib.bib53">Mesnard et al. (2024)Thomas Mesnard, Cassidy Hardin, Robert Dadashi, Surya Bhupatiraju, Shreya Pathak, Laurent Sifre, Morgane Rivière, Mihir Sanjay Kale, Juliette Love, et al. 2024.<a href="http://arxiv.org/abs/2403.08295" rel="nofollow" title="Gemma: Open models based on gemini research and technology">Gemma: Open models based on gemini research and technology</a>.<em id="bib.bib53.9.1">arXiv preprint arXiv:2403.08295</em>.</li><li id="bib.bib54">Micikevicius et al. (2018)Paulius Micikevicius, Sharan Narang, Jonah Alben, Gregory Diamos, Erich Elsen, David Garcia, Boris Ginsburg, Michael Houston, Oleksii Kuchaiev, Ganesh Venkatesh, et al. 2018.<a href="https://openreview.net/forum?id=r1gs9JgRZ" rel="nofollow" title="Mixed precision training">Mixed precision training</a>.In <em id="bib.bib54.10.2">International Conference on Learning Representations</em>.</li><li id="bib.bib55">Nallapati et al. (2016)Ramesh Nallapati, Bowen Zhou, Cicero dos Santos, Caglar Gulcehre, and Bing Xiang. 2016.<a href="https://doi.org/10.18653/v1/K16-1028" rel="nofollow" title="Abstractive text summarization using sequence-to-sequence rnns and beyond">Abstractive text summarization using sequence-to-sequence rnns and beyond</a>.In <em id="bib.bib55.10.2">Proceedings of the 20th SIGNLL Conference on Computational Natural Language Learning</em>, pages 280–290.</li><li id="bib.bib56">Narayan et al. (2018)Shashi Narayan, Shay B. Cohen, and Mirella Lapata. 2018.<a href="https://doi.org/10.18653/v1/D18-1206" rel="nofollow" title="Don’t give me the details, just the summary! topic-aware convolutional neural networks for extreme summarization">Don’t give me the details, just the summary! topic-aware convolutional neural networks for extreme summarization</a>.In <em id="bib.bib56.10.2">Proceedings of the 2018 Conference on Empirical Methods in Natural Language Processing</em>, pages 1797–1807, Brussels, Belgium. Association for Computational Linguistics.</li><li id="bib.bib57">Nguyen et al. (2024)Duc Q. Nguyen, Sang T. Truong, Toan D. V. Nguyen, Dong D. Le, Nhi N. Truong, Tho Quan, and Sanmi Koyejo. 2024.<a href="https://huggingface.co/ura-hcmut/GemSUra-7B" rel="nofollow" title="Crossing linguistic horizons: Finetuning and comprehensive evaluation of vietnamese large language models">Crossing linguistic horizons: Finetuning and comprehensive evaluation of vietnamese large language models</a>.</li><li id="bib.bib58">Ouyang et al. (2022)Long Ouyang, Jeffrey Wu, Xu Jiang, Diogo Almeida, Carroll Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, et al. 2022.<a href="https://proceedings.neurips.cc/paper_files/paper/2022/hash/b1efde53be364a73914f58805a001731-Abstract-Conference.html" rel="nofollow" title="Training language models to follow instructions with human feedback">Training language models to follow instructions with human feedback</a>.<em id="bib.bib58.9.1">Advances in Neural Information Processing Systems</em>, 35:27730–27744.</li><li id="bib.bib59">Papineni et al. (2002)Kishore Papineni, Salim Roukos, Todd Ward, and Wei-Jing Zhu. 2002.<a href="https://aclanthology.org/P02-1040.pdf" rel="nofollow" title="BLEU: a method for automatic evaluation of machine translation">BLEU: a method for automatic evaluation of machine translation</a>.In <em id="bib.bib59.10.2">Proceedings of the 40th annual meeting of the Association for Computational Linguistics</em>, pages 311–318.</li><li id="bib.bib60">Paszke et al. (2019)Adam Paszke, Sam Gross, Francisco Massa, Adam Lerer, James Bradbury, Gregory Chanan, Trevor Killeen, Zeming Lin, Natalia Gimelshein, Luca Antiga, et al. 2019.<a href="https://proceedings.neurips.cc/paper/2019/hash/bdbca288fee7f92f2bfa9f7012727740-Abstract.html" rel="nofollow" title="PyTorch: An imperative style, high-performance deep learning library">PyTorch: An imperative style, high-performance deep learning library</a>.<em id="bib.bib60.9.1">Advances in neural information processing systems</em>, 32.</li><li id="bib.bib61">Radford et al. (2018)Alec Radford, Karthik Narasimhan, Tim Salimans, Ilya Sutskever, et al. 2018.<a href="https://cdn.openai.com/research-covers/language-unsupervised/language_understanding_paper.pdf" rel="nofollow" title="Improving language understanding by generative pre-training">Improving language understanding by generative pre-training</a>.<em id="bib.bib61.9.1">OpenAI blog</em>.</li><li id="bib.bib62">Rafailov et al. (2023)Rafael Rafailov, Archit Sharma, Eric Mitchell, Stefano Ermon, Christopher D Manning, and Chelsea Finn. 2023.<a href="https://openreview.net/forum?id=HPuSIXJaa9" rel="nofollow" title="Direct preference optimization: Your language model is secretly a reward model">Direct preference optimization: Your language model is secretly a reward model</a>.<em id="bib.bib62.9.1">Advances in Neural Information Processing Systems</em>, 37.</li><li id="bib.bib63">Rasley et al. (2020)Jeff Rasley, Samyam Rajbhandari, Olatunji Ruwase, and Yuxiong He. 2020.<a href="https://doi.org/10.1145/3394486.3406703" rel="nofollow" title="DeepSpeed: System optimizations enable training deep learning models with over 100 billion parameters">DeepSpeed: System optimizations enable training deep learning models with over 100 billion parameters</a>.In <em id="bib.bib63.10.2">Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em>, pages 3505–3506.</li><li id="bib.bib64">Shao et al. (2019)Zhihong Shao, Minlie Huang, Jiangtao Wen, Wenfei Xu, and Xiaoyan Zhu. 2019.<a href="https://doi.org/10.18653/v1/D19-1321" rel="nofollow" title="Long and diverse text generation with planning-based hierarchical variational model">Long and diverse text generation with planning-based hierarchical variational model</a>.In <em id="bib.bib64.10.2">Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP)</em>, pages 3257–3268, Hong Kong, China. Association for Computational Linguistics.</li><li id="bib.bib65">Shao et al. (2024)Zhihong Shao, Peiyi Wang, Qihao Zhu, Runxin Xu, Junxiao Song, Mingchuan Zhang, YK Li, Y Wu, and Daya Guo. 2024.<a href="http://arxiv.org/abs/2402.03300" rel="nofollow" title="DeepSeekMath: Pushing the limits of mathematical reasoning in open language models">DeepSeekMath: Pushing the limits of mathematical reasoning in open language models</a>.<em id="bib.bib65.9.1">arXiv preprint arXiv:2402.03300</em>.</li><li id="bib.bib66">Taori et al. (2023)Rohan Taori, Ishaan Gulrajani, Tianyi Zhang, Yann Dubois, Xuechen Li, Carlos Guestrin, Percy Liang, and Tatsunori B. Hashimoto. 2023.<a href="https://github.com/tatsu-lab/stanford_alpaca" title="Stanford alpaca: An instruction-following llama model">Stanford alpaca: An instruction-following llama model</a>.</li><li id="bib.bib67">Team (2023)InternLM Team. 2023.<a href="https://github.com/InternLM/InternLM-techreport/blob/main/InternLM.pdf" title="InternLM: A multilingual language model with progressively enhanced capabilities">InternLM: A multilingual language model with progressively enhanced capabilities</a>.</li><li id="bib.bib68">Tillet et al. (2019)Philippe Tillet, Hsiang-Tsung Kung, and David Cox. 2019.<a href="https://doi.org/10.1145/3315508.3329973" rel="nofollow" title="Triton: an intermediate language and compiler for tiled neural network computations">Triton: an intermediate language and compiler for tiled neural network computations</a>.In <em id="bib.bib68.10.2">Proceedings of the 3rd ACM SIGPLAN International Workshop on Machine Learning and Programming Languages</em>, pages 10–19.</li><li id="bib.bib69">Touvron et al. (2023a)Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, et al. 2023a.<a href="http://arxiv.org/abs/2302.13971" rel="nofollow" title="LLaMA: Open and efficient foundation language models">LLaMA: Open and efficient foundation language models</a>.<em id="bib.bib69.9.1">arXiv preprint arXiv:2302.13971</em>.</li><li id="bib.bib70">Touvron et al. (2023b)Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et al. 2023b.<a href="http://arxiv.org/abs/2307.09288" rel="nofollow" title="Llama 2: Open foundation and fine-tuned chat models">Llama 2: Open foundation and fine-tuned chat models</a>.<em id="bib.bib70.9.1">arXiv preprint arXiv:2307.09288</em>.</li><li id="bib.bib71">Tunstall et al. (2023)Lewis Tunstall, Edward Beeching, Nathan Lambert, Nazneen Rajani, Kashif Rasul, Younes Belkada, Shengyi Huang, Leandro von Werra, Clémentine Fourrier, Nathan Habib, et al. 2023.<a href="http://arxiv.org/abs/2310.16944" rel="nofollow" title="Zephyr: Direct distillation of LM alignment">Zephyr: Direct distillation of LM alignment</a>.<em id="bib.bib71.9.1">arXiv preprint arXiv:2310.16944</em>.</li><li id="bib.bib72">von Werra et al. (2020)Leandro von Werra, Younes Belkada, Lewis Tunstall, Edward Beeching, Tristan Thrush, Nathan Lambert, and Shengyi Huang. 2020.<a href="https://github.com/huggingface/trl" title="TRL: Transformer reinforcement learning">TRL: Transformer reinforcement learning</a>.</li><li id="bib.bib73">Wang et al. (2023a)Chenglong Wang, Hang Zhou, Yimin Hu, Yifu Huo, Bei Li, Tongran Liu, Tong Xiao, and Jingbo Zhu. 2023a.<a href="http://arxiv.org/abs/2308.02223" rel="nofollow" title="Esrl: Efficient sampling-based reinforcement learning for sequence generation">Esrl: Efficient sampling-based reinforcement learning for sequence generation</a>.<em id="bib.bib73.9.1">arXiv preprint arXiv:2308.02223</em>.</li><li id="bib.bib74">Wang et al. (2023b)Guan Wang, Sijie Cheng, Xianyuan Zhan, Xiangang Li, Sen Song, and Yang Liu. 2023b.<a href="http://arxiv.org/abs/2309.11235" rel="nofollow" title="OpenChat: Advancing open-source language models with mixed-quality data">OpenChat: Advancing open-source language models with mixed-quality data</a>.<em id="bib.bib74.9.1">arXiv preprint arXiv:2309.11235</em>.</li><li id="bib.bib75">Wang et al. (2023c)Longyue Wang, Chenyang Lyu, Tianbo Ji, Zhirui Zhang, Dian Yu, Shuming Shi, and Zhaopeng Tu. 2023c.<a href="https://doi.org/10.18653/v1/2023.emnlp-main.1036" rel="nofollow" title="Document-level machine translation with large language models">Document-level machine translation with large language models</a>.In <em id="bib.bib75.10.2">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</em>, pages 16646–16661, Singapore. Association for Computational Linguistics.</li><li id="bib.bib76">Wang et al. (2023d)Yizhong Wang, Hamish Ivison, Pradeep Dasigi, Jack Hessel, Tushar Khot, Khyathi Chandu, David Wadden, Kelsey MacMillan, Noah A Smith, Iz Beltagy, et al. 2023d.<a href="https://openreview.net/forum?id=w4zZNC4ZaV" rel="nofollow" title="How far can camels go? exploring the state of instruction tuning on open resources">How far can camels go? exploring the state of instruction tuning on open resources</a>.<em id="bib.bib76.9.1">Advances in Neural Information Processing Systems</em>, 36.</li><li id="bib.bib77">Wei et al. (2022)Jason Wei, Maarten Bosma, Vincent Zhao, Kelvin Guu, Adams Wei Yu, Brian Lester, Nan Du, Andrew M Dai, and Quoc V Le. 2022.<a href="https://openreview.net/forum?id=gEZrGCozdqR" rel="nofollow" title="Finetuned language models are zero-shot learners">Finetuned language models are zero-shot learners</a>.In <em id="bib.bib77.10.2">International Conference on Learning Representations</em>.</li><li id="bib.bib78">Wei et al. (2023)Tianwen Wei, Liang Zhao, Lichang Zhang, Bo Zhu, Lijie Wang, Haihua Yang, Biye Li, Cheng Cheng, Weiwei Lü, Rui Hu, et al. 2023.<a href="http://arxiv.org/abs/2310.19341" rel="nofollow" title="Skywork: A more open bilingual foundation model">Skywork: A more open bilingual foundation model</a>.<em id="bib.bib78.9.1">arXiv preprint arXiv:2310.19341</em>.</li><li id="bib.bib79">Wolf et al. (2020)Thomas Wolf, Lysandre Debut, Victor Sanh, Julien Chaumond, Clement Delangue, Anthony Moi, Pierric Cistac, Tim Rault, Rémi Louf, Morgan Funtowicz, Joe Davison, Sam Shleifer, Patrick von Platen, Clara Ma, Yacine Jernite, Julien Plu, Canwen Xu, Teven Le Scao, Sylvain Gugger, Mariama Drame, Quentin Lhoest, and Alexander Rush. 2020.<a href="https://doi.org/10.18653/v1/2020.emnlp-demos.6" rel="nofollow" title="Transformers: State-of-the-art natural language processing">Transformers: State-of-the-art natural language processing</a>.In <em id="bib.bib79.10.2">Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing: System Demonstrations</em>, pages 38–45, Online. Association for Computational Linguistics.</li><li id="bib.bib80">Wu et al. (2023)Shaohua Wu, Xudong Zhao, Shenling Wang, Jiangang Luo, Lingjun Li, Xi Chen, Bing Zhao, Wei Wang, Tong Yu, Rongguo Zhang, et al. 2023.<a href="http://arxiv.org/abs/2311.15786" rel="nofollow" title="YUAN 2.0: A large language model with localized filtering-based attention">YUAN 2.0: A large language model with localized filtering-based attention</a>.<em id="bib.bib80.9.1">arXiv preprint arXiv:2311.15786</em>.</li><li id="bib.bib81">Yang et al. (2023)Aiyuan Yang, Bin Xiao, Bingning Wang, Borong Zhang, Ce Bian, Chao Yin, Chenxu Lv, Da Pan, Dian Wang, Dong Yan, et al. 2023.<a href="http://arxiv.org/abs/2309.10305" rel="nofollow" title="Baichuan 2: Open large-scale language models">Baichuan 2: Open large-scale language models</a>.<em id="bib.bib81.9.1">arXiv preprint arXiv:2309.10305</em>.</li><li id="bib.bib82">Yao et al. (2023)Shunyu Yao, Jeffrey Zhao, Dian Yu, Nan Du, Izhak Shafran, Karthik R Narasimhan, and Yuan Cao. 2023.<a href="https://openreview.net/forum?id=WE_vluYUL-X" rel="nofollow" title="ReAct: Synergizing reasoning and acting in language models">ReAct: Synergizing reasoning and acting in language models</a>.In <em id="bib.bib82.10.2">International Conference on Learning Representations</em>.</li><li id="bib.bib83">Young et al. (2024)Alex Young, Bei Chen, Chao Li, Chengen Huang, Ge Zhang, Guanwei Zhang, Heng Li, Jiangcheng Zhu, Jianqun Chen, Jing Chang, et al. 2024.<a href="http://arxiv.org/abs/2403.04652" rel="nofollow" title="Yi: Open foundation models by 01.ai">Yi: Open foundation models by 01.ai</a>.<em id="bib.bib83.9.1">arXiv preprint arXiv:2403.04652</em>.</li><li id="bib.bib84">Yu et al. (2023)Hao Yu, Zachary Yang, Kellin Pelrine, Jean Francois Godbout, and Reihaneh Rabbany. 2023.<a href="http://arxiv.org/abs/2308.10092" rel="nofollow" id="yiyi-673" title="Open, closed, or small language models for text classification?">Open, closed, or small language models for text classification?</a><em id="bib.bib84.9.1">arXiv preprint arXiv:2308.10092</em>.</li><li id="bib.bib85">Zhang et al. (2022)Renrui Zhang, Jiaming Han, Aojun Zhou, Xiangfei Hu, Shilin Yan, Pan Lu, Hongsheng Li, Peng Gao, and Yu Qiao. 2022.<a href="https://openreview.net/forum?id=d4UiXAHN2W" rel="nofollow" title="LLaMA-Adapter: Efficient fine-tuning of language models with zero-init attention">LLaMA-Adapter: Efficient fine-tuning of language models with zero-init attention</a>.In <em id="bib.bib85.10.2">International Conference on Learning Representations</em>.</li><li id="bib.bib86">Zhao et al. (2024)Jiawei Zhao, Zhenyu Zhang, Beidi Chen, Zhangyang Wang, Anima Anandkumar, and Yuandong Tian. 2024.<a href="http://arxiv.org/abs/2403.03507" rel="nofollow" title="GaLore: Memory-efficient llm training by gradient low-rank projection">GaLore: Memory-efficient llm training by gradient low-rank projection</a>.<em id="bib.bib86.9.1">arXiv preprint arXiv:2403.03507</em>.</li><li id="bib.bib87">Zhao et al. (2023)Wayne Xin Zhao, Kun Zhou, Junyi Li, Tianyi Tang, Xiaolei Wang, Yupeng Hou, Yingqian Min, Beichen Zhang, Junjie Zhang, Zican Dong, Yifan Du, Chen Yang, Yushuo Chen, Zhipeng Chen, Jinhao Jiang, Ruiyang Ren, Yifan Li, Xinyu Tang, Zikang Liu, Peiyu Liu, Jian-Yun Nie, and Ji-Rong Wen. 2023.<a href="http://arxiv.org/abs/2303.18223" rel="nofollow" title="A survey of large language models">A survey of large language models</a>.<em id="bib.bib87.9.1">arXiv preprint arXiv:2303.18223</em>.</li><li id="bib.bib88">Zheng et al. (2023)Lianmin Zheng, Wei-Lin Chiang, Ying Sheng, Siyuan Zhuang, Zhanghao Wu, Yonghao Zhuang, Zi Lin, Zhuohan Li, Dacheng Li, Eric Xing, et al. 2023.<a href="https://proceedings.neurips.cc/paper_files/paper/2023/hash/91f18a1287b398d378ef22505bf41832-Abstract-Datasets_and_Benchmarks.html" rel="nofollow" title="Judging LLM-as-a-judge with mt-bench and chatbot arena">Judging LLM-as-a-judge with mt-bench and chatbot arena</a>.<em id="bib.bib88.9.1">Advances in Neural Information Processing Systems</em>, 36.</li></ul> 
<p>表5：LlamaFactory与现有大语言模型微调框架的功能比较。</p> 
<table id="A0.T5.7.1"><tbody><tr id="A0.T5.7.1.1.1"><td id="A0.T5.7.1.1.1.1">Methods</td><td id="A0.T5.7.1.1.1.2">LlamaFactory</td><td id="A0.T5.7.1.1.1.3">FastChat</td><td id="A0.T5.7.1.1.1.4">LitGPT</td><td id="A0.T5.7.1.1.1.5">LMFlow</td><td id="A0.T5.7.1.1.1.6">Open Instruct</td></tr><tr id="A0.T5.7.1.2.2"><td id="A0.T5.7.1.2.2.1">LoRA</td><td id="A0.T5.7.1.2.2.2">✓</td><td id="A0.T5.7.1.2.2.3">✓</td><td id="A0.T5.7.1.2.2.4">✓</td><td id="A0.T5.7.1.2.2.5">✓</td><td id="A0.T5.7.1.2.2.6">✓</td></tr><tr id="A0.T5.7.1.3.3"><td id="A0.T5.7.1.3.3.1">QLoRA</td><td id="A0.T5.7.1.3.3.2">✓</td><td id="A0.T5.7.1.3.3.3">✓</td><td id="A0.T5.7.1.3.3.4">✓</td><td id="A0.T5.7.1.3.3.5"></td><td id="A0.T5.7.1.3.3.6">✓</td></tr><tr id="A0.T5.7.1.4.4"><td id="A0.T5.7.1.4.4.1">LoRA+</td><td id="A0.T5.7.1.4.4.2">✓</td><td id="A0.T5.7.1.4.4.3"></td><td id="A0.T5.7.1.4.4.4"></td><td id="A0.T5.7.1.4.4.5"></td><td id="A0.T5.7.1.4.4.6"></td></tr><tr id="A0.T5.7.1.5.5"><td id="A0.T5.7.1.5.5.1">DoRA</td><td id="A0.T5.7.1.5.5.2">✓</td><td id="A0.T5.7.1.5.5.3"></td><td id="A0.T5.7.1.5.5.4"></td><td id="A0.T5.7.1.5.5.5"></td><td id="A0.T5.7.1.5.5.6"></td></tr><tr id="A0.T5.7.1.6.6"><td id="A0.T5.7.1.6.6.1">GaLore</td><td id="A0.T5.7.1.6.6.2">✓</td><td id="A0.T5.7.1.6.6.3"></td><td id="A0.T5.7.1.6.6.4"></td><td id="A0.T5.7.1.6.6.5"></td><td id="A0.T5.7.1.6.6.6"></td></tr><tr id="A0.T5.7.1.7.7"><td id="A0.T5.7.1.7.7.1">SFT</td><td id="A0.T5.7.1.7.7.2">✓</td><td id="A0.T5.7.1.7.7.3">✓</td><td id="A0.T5.7.1.7.7.4">✓</td><td id="A0.T5.7.1.7.7.5">✓</td><td id="A0.T5.7.1.7.7.6">✓</td></tr><tr id="A0.T5.7.1.8.8"><td id="A0.T5.7.1.8.8.1">RLHF</td><td id="A0.T5.7.1.8.8.2">✓</td><td id="A0.T5.7.1.8.8.3"></td><td id="A0.T5.7.1.8.8.4"></td><td id="A0.T5.7.1.8.8.5">✓</td><td id="A0.T5.7.1.8.8.6"></td></tr><tr id="A0.T5.7.1.9.9"><td id="A0.T5.7.1.9.9.1">DPO</td><td id="A0.T5.7.1.9.9.2">✓</td><td id="A0.T5.7.1.9.9.3"></td><td id="A0.T5.7.1.9.9.4"></td><td id="A0.T5.7.1.9.9.5"></td><td id="A0.T5.7.1.9.9.6">✓</td></tr><tr id="A0.T5.7.1.10.10"><td id="A0.T5.7.1.10.10.1">Flash attention</td><td id="A0.T5.7.1.10.10.2">✓</td><td id="A0.T5.7.1.10.10.3">✓</td><td id="A0.T5.7.1.10.10.4">✓</td><td id="A0.T5.7.1.10.10.5">✓</td><td id="A0.T5.7.1.10.10.6">✓</td></tr><tr id="A0.T5.7.1.11.11"><td id="A0.T5.7.1.11.11.1">Unsloth</td><td id="A0.T5.7.1.11.11.2">✓</td><td id="A0.T5.7.1.11.11.3"></td><td id="A0.T5.7.1.11.11.4"></td><td id="A0.T5.7.1.11.11.5"></td><td id="A0.T5.7.1.11.11.6"></td></tr><tr id="A0.T5.7.1.12.12"><td id="A0.T5.7.1.12.12.1">DeepSpeed</td><td id="A0.T5.7.1.12.12.2">✓</td><td id="A0.T5.7.1.12.12.3">✓</td><td id="A0.T5.7.1.12.12.4">✓</td><td id="A0.T5.7.1.12.12.5">✓</td><td id="A0.T5.7.1.12.12.6">✓</td></tr></tbody></table> 
<h3>附录A相关工作</h3> 
<p id="A1.p1.1">在本节中，我们列举了现有的用于微调大语言模型的框架，特别重点介绍了那些用于高效微调的框架。</p> 
<p id="A1.p2.1">LLaMA-Adapter (Zhang 等人, 2022) 使用零初始注意力有效地微调 Llama 模型 (Touvron 等人, 2023a) 的指令跟踪能力。 FastChat (Zheng 等人, 2023) 是一个专注于训练和评估用于聊天完成目的的大语言模型的框架。 LitGPT (AI, 2023) 提供生成模型的实现并支持各种训练方法。 Open-Instruct (Wang 等人, 2023d) 是一个支持高效微调的微调框架。 Colossal AI (Li 等人, 2023b) 采用先进的并行策略进行分布式训练。 LMFlow (Diao 等人, 2023) 是一个可扩展且高效的微调框架，支持仅解码器模型，同时支持全调优和适配器调优。 GPT4All (Anand 等人, 2023) 允许大语言模型在消费设备上运行，同时还提供微调功能。</p> 
<p id="A1.p3.1">与上面介绍的框架相比，LlamaFactory 支持更广泛的高效微调方法。 我们将我们的框架与表中的现有工作进行比较 <a href="https://arxiv.org/html/2403.13372v2#A0.T5" rel="nofollow" title="5">5</a>.</p> 
<p>表6：支持的型号列表。</p> 
<table id="A1.T6.4.1"><thead><tr id="A1.T6.4.1.1.1"><th id="A1.T6.4.1.1.1.1">Model</th><th id="A1.T6.4.1.1.1.2">Variant</th><th id="A1.T6.4.1.1.1.3">Organization</th></tr></thead><tbody><tr id="A1.T6.4.1.2.1"><td id="A1.T6.4.1.2.1.1">Llama (Touvron et al., 2023a)</td><td id="A1.T6.4.1.2.1.2">7B/13B/33B/65B</td><td id="A1.T6.4.1.2.1.3">Meta AI</td></tr><tr id="A1.T6.4.1.3.2"><td id="A1.T6.4.1.3.2.1">Llama 2 (Touvron et al., 2023b)</td><td id="A1.T6.4.1.3.2.2">7B/13B/70B</td><td id="A1.T6.4.1.3.2.3">Meta AI</td></tr><tr id="A1.T6.4.1.4.3"><td id="A1.T6.4.1.4.3.1">Baichuan Yang et al. (2023)</td><td id="A1.T6.4.1.4.3.2">7B/13B</td><td id="A1.T6.4.1.4.3.3">Baichuan Inc</td></tr><tr id="A1.T6.4.1.5.4"><td id="A1.T6.4.1.5.4.1">Baichuan2 (Yang et al., 2023)</td><td id="A1.T6.4.1.5.4.2">7B/13B</td><td id="A1.T6.4.1.5.4.3">Baichuan Inc</td></tr><tr id="A1.T6.4.1.6.5"><td id="A1.T6.4.1.6.5.1">BLOOM (Le Scao et al., 2022)</td><td id="A1.T6.4.1.6.5.2">560M/3B/7.1B</td><td id="A1.T6.4.1.6.5.3">BigScience</td></tr><tr id="A1.T6.4.1.7.6"><td id="A1.T6.4.1.7.6.1">BLOOMZ (Le Scao et al., 2022)</td><td id="A1.T6.4.1.7.6.2">560M/3B/7.1B</td><td id="A1.T6.4.1.7.6.3">BigScience</td></tr><tr id="A1.T6.4.1.8.7"><td id="A1.T6.4.1.8.7.1">ChatGLM2 (Du et al., 2022)</td><td id="A1.T6.4.1.8.7.2">6B</td><td id="A1.T6.4.1.8.7.3">THUDM</td></tr><tr id="A1.T6.4.1.9.8"><td id="A1.T6.4.1.9.8.1">ChatGLM3 (Du et al., 2022)</td><td id="A1.T6.4.1.9.8.2">6B</td><td id="A1.T6.4.1.9.8.3">THUDM</td></tr><tr id="A1.T6.4.1.10.9"><td id="A1.T6.4.1.10.9.1">ChineseLLaMA2 (Cui et al., 2023)</td><td id="A1.T6.4.1.10.9.2">3B/7B/13B</td><td id="A1.T6.4.1.10.9.3">HFL</td></tr><tr id="A1.T6.4.1.11.10"><td id="A1.T6.4.1.11.10.1">DeepSeek-LLM (Bi et al., 2024)</td><td id="A1.T6.4.1.11.10.2">7B/67B</td><td id="A1.T6.4.1.11.10.3">DeepSeek</td></tr><tr id="A1.T6.4.1.12.11"><td id="A1.T6.4.1.12.11.1">DeepSeek-Math (Shao et al., 2024)</td><td id="A1.T6.4.1.12.11.2">7B</td><td id="A1.T6.4.1.12.11.3">DeepSeek</td></tr><tr id="A1.T6.4.1.13.12"><td id="A1.T6.4.1.13.12.1">DeepSeek-MoE (Dai et al., 2024)</td><td id="A1.T6.4.1.13.12.2">16B</td><td id="A1.T6.4.1.13.12.3">DeepSeek</td></tr><tr id="A1.T6.4.1.14.13"><td id="A1.T6.4.1.14.13.1">DeepSeek-Coder (Guo et al., 2024)</td><td id="A1.T6.4.1.14.13.2">6.7B/7B/33B</td><td id="A1.T6.4.1.14.13.3">DeepSeek</td></tr><tr id="A1.T6.4.1.15.14"><td id="A1.T6.4.1.15.14.1">Falcon (Almazrouei et al., 2023)</td><td id="A1.T6.4.1.15.14.2">7B/40B/180B</td><td id="A1.T6.4.1.15.14.3">TII</td></tr><tr id="A1.T6.4.1.16.15"><td id="A1.T6.4.1.16.15.1">Gemma (Mesnard et al., 2024)</td><td id="A1.T6.4.1.16.15.2">2B/7B</td><td id="A1.T6.4.1.16.15.3">Google</td></tr><tr id="A1.T6.4.1.17.16"><td id="A1.T6.4.1.17.16.1">InternLM (Team, 2023)</td><td id="A1.T6.4.1.17.16.2">7B/20B</td><td id="A1.T6.4.1.17.16.3">Shanghai AI Lab</td></tr><tr id="A1.T6.4.1.18.17"><td id="A1.T6.4.1.18.17.1">InternLM2 (Team, 2023)</td><td id="A1.T6.4.1.18.17.2">1.8B/7B/20B</td><td id="A1.T6.4.1.18.17.3">Shanghai AI Lab</td></tr><tr id="A1.T6.4.1.19.18"><td id="A1.T6.4.1.19.18.1">Mistral (Jiang et al., 2023a)</td><td id="A1.T6.4.1.19.18.2">7B</td><td id="A1.T6.4.1.19.18.3">Mistral AI</td></tr><tr id="A1.T6.4.1.20.19"><td id="A1.T6.4.1.20.19.1">Mixtral (Jiang et al., 2023a)</td><td id="A1.T6.4.1.20.19.2">8x7B</td><td id="A1.T6.4.1.20.19.3">Mistral AI</td></tr><tr id="A1.T6.4.1.21.20"><td id="A1.T6.4.1.21.20.1">OLMo (Groeneveld et al., 2024)</td><td id="A1.T6.4.1.21.20.2">1B/7B</td><td id="A1.T6.4.1.21.20.3">Allen AI</td></tr><tr id="A1.T6.4.1.22.21"><td id="A1.T6.4.1.22.21.1">OpenChat (Wang et al., 2023b)</td><td id="A1.T6.4.1.22.21.2">7B</td><td id="A1.T6.4.1.22.21.3">OpenChat</td></tr><tr id="A1.T6.4.1.23.22"><td id="A1.T6.4.1.23.22.1">Orion (Chen et al., 2024a)</td><td id="A1.T6.4.1.23.22.2">14B</td><td id="A1.T6.4.1.23.22.3">OrionStar</td></tr><tr id="A1.T6.4.1.24.23"><td id="A1.T6.4.1.24.23.1">Phi-1.5 (Li et al., 2023c)</td><td id="A1.T6.4.1.24.23.2">1.3B</td><td id="A1.T6.4.1.24.23.3">Microsoft</td></tr><tr id="A1.T6.4.1.25.24"><td id="A1.T6.4.1.25.24.1">Phi-2 (Li et al., 2023c)</td><td id="A1.T6.4.1.25.24.2">2.7B</td><td id="A1.T6.4.1.25.24.3">Microsoft</td></tr><tr id="A1.T6.4.1.26.25"><td id="A1.T6.4.1.26.25.1">Qwen (Bai et al., 2023)</td><td id="A1.T6.4.1.26.25.2">1.8B/7B/14B/72B</td><td id="A1.T6.4.1.26.25.3">Alibaba Cloud</td></tr><tr id="A1.T6.4.1.27.26"><td id="A1.T6.4.1.27.26.1">Qwen1.5 (Bai et al., 2023)</td><td id="A1.T6.4.1.27.26.2">1.8B/7B/14B/72B</td><td id="A1.T6.4.1.27.26.3">Alibaba Cloud</td></tr><tr id="A1.T6.4.1.28.27"><td id="A1.T6.4.1.28.27.1">SOLAR (Kim et al., 2023)</td><td id="A1.T6.4.1.28.27.2">10.7B</td><td id="A1.T6.4.1.28.27.3">Upstage AI</td></tr><tr id="A1.T6.4.1.29.28"><td id="A1.T6.4.1.29.28.1">Skywork (Wei et al., 2023)</td><td id="A1.T6.4.1.29.28.2">13B</td><td id="A1.T6.4.1.29.28.3">Skywork</td></tr><tr id="A1.T6.4.1.30.29"><td id="A1.T6.4.1.30.29.1">StarCoder2 (Lozhkov et al., 2024)</td><td id="A1.T6.4.1.30.29.2">3B/7B/15B</td><td id="A1.T6.4.1.30.29.3">BigCode</td></tr><tr id="A1.T6.4.1.31.30"><td id="A1.T6.4.1.31.30.1">Vicuna1.5 (Zheng et al., 2023)</td><td id="A1.T6.4.1.31.30.2">7B/13B</td><td id="A1.T6.4.1.31.30.3">LMSYS</td></tr><tr id="A1.T6.4.1.32.31"><td id="A1.T6.4.1.32.31.1">Yi (Young et al., 2024)</td><td id="A1.T6.4.1.32.31.2">6B/9B/34B</td><td id="A1.T6.4.1.32.31.3">01.AI</td></tr><tr id="A1.T6.4.1.33.32"><td id="A1.T6.4.1.33.32.1">Yuan2 (Wu et al., 2023)</td><td id="A1.T6.4.1.33.32.2">2B/51B/102B</td><td id="A1.T6.4.1.33.32.3">IEIT</td></tr><tr id="A1.T6.4.1.34.33"><td id="A1.T6.4.1.34.33.1">Zephyr (Tunstall et al., 2023)</td><td id="A1.T6.4.1.34.33.2">7B</td><td id="A1.T6.4.1.34.33.3">Hugging Face H4</td></tr></tbody></table> 
<h3>附录BLlamaFactory 支持的模型</h3> 
<p id="A2.p1.1">我们选择了LlamaFactory支持的流行预训练模型并在表中列出<a href="https://arxiv.org/html/2403.13372v2#A1.T6" rel="nofollow" title="6">6</a>，范围从密集模型到稀疏专家混合 (MoE) 模型。</p> 
<p>表7：LlamaFactory中函数调用的提示。</p> 
<table id="A2.T7.7.1"><tbody><tr id="A2.T7.7.1.1.1"><td id="A2.T7.7.1.1.1.1"> <p id="A2.T7.7.1.1.1.1.1">You have access to the following tools:</p> </td></tr><tr id="A2.T7.7.1.2.2"><td id="A2.T7.7.1.2.2.1"> <p id="A2.T7.7.1.2.2.1.1">&gt; Tool Name: tool1</p> </td></tr><tr id="A2.T7.7.1.3.3"><td id="A2.T7.7.1.3.3.1"> <p id="A2.T7.7.1.3.3.1.1">Tool Description: the usage of tool1</p> </td></tr><tr id="A2.T7.7.1.4.4"><td id="A2.T7.7.1.4.4.1"> <p id="A2.T7.7.1.4.4.1.1">Tool Args:</p> </td></tr><tr id="A2.T7.7.1.5.5"><td id="A2.T7.7.1.5.5.1"> <p id="A2.T7.7.1.5.5.1.1">- arg1 (dtype): the usage of arg1</p> </td></tr><tr id="A2.T7.7.1.6.6"><td id="A2.T7.7.1.6.6.1"> <p id="A2.T7.7.1.6.6.1.1">Use the following format if using a tool:</p> </td></tr><tr id="A2.T7.7.1.7.7"><td id="A2.T7.7.1.7.7.1"> <p id="A2.T7.7.1.7.7.1.1">```</p> </td></tr><tr id="A2.T7.7.1.8.8"><td id="A2.T7.7.1.8.8.1"> <p id="A2.T7.7.1.8.8.1.1">Action: tool name (one of [tool1]).</p> </td></tr><tr id="A2.T7.7.1.9.9"><td id="A2.T7.7.1.9.9.1"> <p id="A2.T7.7.1.9.9.1.1">Action Input: the input to the tool, in a JSON format representing the kwargs (e.g. ```{"input": "hello world", "num_beams": 5}```).</p> </td></tr><tr id="A2.T7.7.1.10.10"><td id="A2.T7.7.1.10.10.1"> <p id="A2.T7.7.1.10.10.1.1">```</p> </td></tr></tbody></table> 
<h3>附录C聊天模板设计细节</h3> 
<p id="A3.p1.1">尽管 Transformers 4.34.0 引入了聊天模板功能，但一些模型（例如 ChatGLM 和 Qwen）具有表现出特定行为的标记器，并且无法直接对特殊标记进行编码。 因此，我们设计了一个 格式化程序 类将文本输入稳健地转换为其嵌入 ID。 具体来说，我们提供 EmptyFormatter、StringFormatter、FunctionFormatter 和 工具格式化程序。此外，LlamaFactory 支持微调模型以获得函数调用能力。 虽然 ReAct 提示 Yao 等人 (2023) 是工具使用的流行选择，但对于嵌套工具参数来说，它是不够的。 我们优化了工具提示并在表格中提供 <a href="https://arxiv.org/html/2403.13372v2#A2.T7" rel="nofollow" title="7">7</a>.</p> 
<h3>附录D实验详情</h3> 
<h4>D.1训练效率</h4> 
<p id="A4.SS1.p1.7">我们采用学习率为10−5，词符批量大小为512 使用 bfloat16 精度的 8 位 AdamW 优化器（Dettmers 等人，2022b） 来调节这些模型，并通过激活检查点来减少内存占用。 在冻结调整中，我们只调节最后一个 3 模型的解码器层。 对于 GaLore，我们将排名和规模设置为 128 和 2.0， 分别。 对于 LoRA 和 QLoRA，我们将适配器附加到所有线性层并将等级和 alpha 设置为 128 和 256， 分别。 所有实验均在单个 NVIDIA A100 40GB GPU 上进行。 我们在所有实验中启用 Flash Attention，并在 LoRA 和 QLoRA 实验中启用 Unsloth。</p> 
<h4>D.2下游任务的微调</h4> 
<p id="A4.SS2.p1.1">我们简要描述用于评估不同微调方法有效性的数据集。</p> 
<ul id="A4.I1"><li id="A4.I1.i1">•  <p id="A4.I1.i1.p1.1">CNN/DM (Nallapati 等人, 2016) 该数据集用于摘要生成任务。 英文文章摘自 CNN 和《每日邮报》。 我们使用 1.0.0 版本，其中包含超过 30 万个样本。</p> </li><li id="A4.I1.i2">•  <p id="A4.I1.i2.p1.1">XSum (Narayan 等人, 2018) 该数据集用于抽象摘要生成任务，由英文文档和一句话摘要组成，总计超过 20 万个样本。</p> </li><li id="A4.I1.i3">•  <p id="A4.I1.i3.p1.1">AdGen (Shao 等人, 2019) 该数据集是一个中文数据集，需要模型根据给定的关键字生成广告文本，总共超过 10 万个样本。</p> </li></ul> 
<p id="A4.SS2.p3.7">在本实验中，我们采用学习率为10−5。我们将批量大小设置为4，而最大输入长度为2048. 我们使用 8 位 AdamW 优化器（Dettmers 等人，2022b） 以 bfloat16 精度对模型进行操作，并通过激活检查点来减少内存占用。 对于 GaLore，我们将排名和规模设置为 128 和 2.0， 分别。 对于 LoRA 和 QLoRA，我们将适配器附加到所有线性层并将等级和 alpha 设置为 128 和 256， 分别。 所有实验结果均在启用了 Flash Attention 的 NVIDIA A100 40GB GPU 上进行。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/02ddca8b374c7079ee5a018ae257eae0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">若依（ruoyi）分离版 纯前端教程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/af51d9c3717527615c7acc019c2b4ed2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java中的XML生成</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>