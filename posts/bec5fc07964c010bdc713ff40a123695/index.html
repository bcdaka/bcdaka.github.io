<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python 设计模式(第2版) -- 第一部分（创建型模式） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/bec5fc07964c010bdc713ff40a123695/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Python 设计模式(第2版) -- 第一部分（创建型模式）">
  <meta property="og:description" content="Python 设计模式(第2版) 设计模式的主要特点如下所示：
它们是语言无关的，可以用多种语言实现。它们是动态的，随时会有新的模式引入。它们可以进行定制，因此对开发人员非常有用。 设计模式的优点如下所示：
它们可以在多个项目中重复使用。问题可以在架构级别得到解决。它们都经过了时间的验证和良好的证明，是开发人员和架构师的宝贵经验。它们具有可靠性和依赖性。 Python是一种动态语言。Python 的动态特性如下所示：
类型或类是运行时对象。变量可以根据赋值来确定类型，并且类型可以在运行时改变。动态语言在类限制方面具有更大的灵活性。例如，在 Python 中，多态性是该语言所固有的，并没有诸如 private 和 protected 之类的关键字，因为默认情况下一切都是公共的。可以使用动态语言轻松实现设计模式的用例。 设计模式是由 GoF（Gang of Four）首先提出的，根据他们的观点，设计模式就是解决特定问题的解决方案。在他们的设计模式书中讲到了 23 种设计模式，并将它们分为三大类：
创建型模式。结构型模式。行为型模式。 以下是创建型模式的性质：
它们的运行机制基于对象的创建方式。它们将对象创建的细节隔离开来。代码与所创建的对象的类型无关。 以下是结构型模式的性质：
它们致力于设计出能够通过组合获得更强大功能的对象和类的结构。重点是简化结构并识别类和对象之间的关系。它们主要关注类的继承和组合。 行为型模式具有下列性质：
它们关注对象之间的交互以及对象的响应性。对象应该能够交互，同时仍然保持松散耦合。 首先来看看创建型设计模式有哪些。
单例模式 单例模式提供了这样一个机制，即确保类有且只有一个特定类型的对象，并提供全局访问点。因此，单例模式通常用于下列情形，例如日志记录或数据库操作、打印机后台处理程序，以及其他程序——该程序运行过程中只能生成一个实例，以避免对同一资源产生相互冲突的请求。
下面是基于 Python v3.5 的单例模式实现代码，它主要完成了两件事情。
1．只允许Singleton类生成一个实例。2．如果已经有一个实例了，我们会重复提供同一个对象。
class Singleton(object): def __new__(cls): if not hasattr(cls, &#39;instance&#39;): cls.instance = super(Singleton, cls).__new__(cls) return cls.instance s = Singleton() print(&#34;Object created&#34;, s) s1 = Singleton() print(&#34;Object created&#34;, s1) 单例模式的用例之一就是懒汉式实例化。懒汉式实例化能够确保在实际需要时才创建对象。所以，懒汉式实例化是一种节约资源并仅在需要时才创建它们的方式。
class Singleton: __instance = None def __init__(self): if not Singleton.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-18T22:50:47+08:00">
    <meta property="article:modified_time" content="2024-06-18T22:50:47+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python 设计模式(第2版) -- 第一部分（创建型模式）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Python_2_0"></a>Python 设计模式(第2版)</h2> 
<p>设计模式的主要特点如下所示：</p> 
<ul><li>它们是语言无关的，可以用多种语言实现。</li><li>它们是动态的，随时会有新的模式引入。</li><li>它们可以进行定制，因此对开发人员非常有用。</li></ul> 
<p>设计模式的优点如下所示：</p> 
<ul><li>它们可以在多个项目中重复使用。</li><li>问题可以在架构级别得到解决。</li><li>它们都经过了时间的验证和良好的证明，是开发人员和架构师的宝贵经验。</li><li>它们具有可靠性和依赖性。</li></ul> 
<p>Python是一种动态语言。Python 的动态特性如下所示：</p> 
<ul><li>类型或类是运行时对象。</li><li>变量可以根据赋值来确定类型，并且类型可以在运行时改变。</li><li>动态语言在类限制方面具有更大的灵活性。</li><li>例如，在 Python 中，多态性是该语言所固有的，并没有诸如 private 和 protected 之类的关键字，因为默认情况下一切都是公共的。</li><li>可以使用动态语言轻松实现设计模式的用例。</li></ul> 
<p>设计模式是由 GoF（Gang of Four）首先提出的，根据他们的观点，设计模式就是解决特定问题的解决方案。在他们的设计模式书中讲到了 23 种设计模式，并将它们分为三大类：</p> 
<ul><li>创建型模式。</li><li>结构型模式。</li><li>行为型模式。</li></ul> 
<p>以下是创建型模式的性质：</p> 
<ul><li>它们的运行机制基于对象的创建方式。</li><li>它们将对象创建的细节隔离开来。</li><li>代码与所创建的对象的类型无关。</li></ul> 
<p>以下是结构型模式的性质：</p> 
<ul><li>它们致力于设计出能够通过组合获得更强大功能的对象和类的结构。</li><li>重点是简化结构并识别类和对象之间的关系。</li><li>它们主要关注类的继承和组合。</li></ul> 
<p>行为型模式具有下列性质：</p> 
<ul><li>它们关注对象之间的交互以及对象的响应性。</li><li>对象应该能够交互，同时仍然保持松散耦合。</li></ul> 
<p>首先来看看创建型设计模式有哪些。</p> 
<h3><a id="_48"></a>单例模式</h3> 
<p>单例模式提供了这样一个机制，即确保类有且只有一个特定类型的对象，并提供全局访问点。因此，单例模式通常用于下列情形，例如日志记录或数据库操作、打印机后台处理程序，以及其他程序——该程序运行过程中只能生成一个实例，以避免对同一资源产生相互冲突的请求。</p> 
<p>下面是基于 Python v3.5 的单例模式实现代码，它主要完成了两件事情。</p> 
<p>1．只允许Singleton类生成一个实例。2．如果已经有一个实例了，我们会重复提供同一个对象。</p> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__new__</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> <span class="token string">'instance'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            cls<span class="token punctuation">.</span>instance <span class="token operator">=</span> <span class="token builtin">super</span><span class="token punctuation">(</span>Singleton<span class="token punctuation">,</span> cls<span class="token punctuation">)</span><span class="token punctuation">.</span>__new__<span class="token punctuation">(</span>cls<span class="token punctuation">)</span>
        <span class="token keyword">return</span> cls<span class="token punctuation">.</span>instance


s <span class="token operator">=</span> Singleton<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Object created"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>

s1 <span class="token operator">=</span> Singleton<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Object created"</span><span class="token punctuation">,</span> s1<span class="token punctuation">)</span>
</code></pre> 
<p>单例模式的用例之一就是懒汉式实例化。懒汉式实例化能够确保在实际需要时才创建对象。所以，懒汉式实例化是一种节约资源并仅在需要时才创建它们的方式。</p> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">Singleton</span><span class="token punctuation">:</span>
    __instance <span class="token operator">=</span> <span class="token boolean">None</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> Singleton<span class="token punctuation">.</span>__instance<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">" __init__ method called.."</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Instance already created:"</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>getInstance<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token decorator annotation punctuation">@classmethod</span>
    <span class="token keyword">def</span> <span class="token function">getInstance</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> cls<span class="token punctuation">.</span>__instance<span class="token punctuation">:</span>
            cls<span class="token punctuation">.</span>__instance <span class="token operator">=</span> Singleton<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> cls<span class="token punctuation">.</span>__instance


s <span class="token operator">=</span> Singleton<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">## class initialized, but object not created</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Object created"</span><span class="token punctuation">,</span> Singleton<span class="token punctuation">.</span>getInstance<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># Object gets createdhere</span>
s1 <span class="token operator">=</span> Singleton<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">## instance already created</span>
</code></pre> 
<p>作为一个实际的用例，我们将通过一个数据库应用程序来展示单例的应用。这里不妨以需要对数据库进行多种读取和写入操作的云服务为例进行讲解。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sqlite3

<span class="token keyword">class</span> <span class="token class-name">MetaSingleton</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    _instances <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    
    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> cls <span class="token keyword">not</span> <span class="token keyword">in</span> cls<span class="token punctuation">.</span>_instances<span class="token punctuation">:</span>
            cls<span class="token punctuation">.</span>_instances<span class="token punctuation">[</span>cls<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">super</span><span class="token punctuation">(</span>MetaSingleton<span class="token punctuation">,</span> cls<span class="token punctuation">)</span><span class="token punctuation">.</span> __call__<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
        <span class="token keyword">return</span> cls<span class="token punctuation">.</span>_instances<span class="token punctuation">[</span>cls<span class="token punctuation">]</span>

<span class="token keyword">class</span> <span class="token class-name">Database</span><span class="token punctuation">(</span>metaclass<span class="token operator">=</span>MetaSingleton<span class="token punctuation">)</span><span class="token punctuation">:</span>

    connection <span class="token operator">=</span> <span class="token boolean">None</span>

    <span class="token keyword">def</span> <span class="token function">connect</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>connection <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>connection <span class="token operator">=</span> sqlite3<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">"db.sqlite3"</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>cursorobj <span class="token operator">=</span> self<span class="token punctuation">.</span>connection<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>cursorobj

db1 <span class="token operator">=</span> Database<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">)</span>
db2 <span class="token operator">=</span> Database<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"Database Objects DB1"</span><span class="token punctuation">,</span> db1<span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"Database Objects DB2"</span><span class="token punctuation">,</span> db2<span class="token punctuation">)</span>
</code></pre> 
<p>考虑另一种情况，即为基础设施提供运行状况监控服务（就像 Nagios 所作的那样）。首先创建了 HealthCheck 类，它作为单例实现。还要维护一个被监控的服务器列表。当一个服务器从这个列表中删除时，监控软件应该觉察到这一情况，并从被监控的服务器列表中将其删除。</p> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">HealthCheck</span><span class="token punctuation">:</span>

    _instance <span class="token operator">=</span> <span class="token boolean">None</span>

    <span class="token keyword">def</span> <span class="token function">__new__</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> HealthCheck<span class="token punctuation">.</span>_instance<span class="token punctuation">:</span>
            HealthCheck<span class="token punctuation">.</span>_instance <span class="token operator">=</span> <span class="token builtin">super</span><span class="token punctuation">(</span>HealthCheck<span class="token punctuation">,</span> cls<span class="token punctuation">)</span><span class="token punctuation">.</span> __new__<span class="token punctuation">(</span>cls<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
        <span class="token keyword">return</span> HealthCheck<span class="token punctuation">.</span>_instance

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>_servers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">addServer</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>_servers<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"Server 1"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>_servers<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"Server 2"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>_servers<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"Server 3"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>_servers<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"Server 4"</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">changeServer</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>_servers<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>_servers<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"Server 5"</span><span class="token punctuation">)</span>

hc1 <span class="token operator">=</span> HealthCheck<span class="token punctuation">(</span><span class="token punctuation">)</span>
hc2 <span class="token operator">=</span> HealthCheck<span class="token punctuation">(</span><span class="token punctuation">)</span>

hc1<span class="token punctuation">.</span>addServer<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Schedule health check for servers (1).."</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Checking "</span><span class="token punctuation">,</span> hc1<span class="token punctuation">.</span>_servers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>

hc2<span class="token punctuation">.</span>changeServer<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Schedule health check for servers (2).."</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Checking "</span><span class="token punctuation">,</span> hc2<span class="token punctuation">.</span>_servers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>单例模式的缺点：</p> 
<ul><li>全局变量可能在某处已经被误改，但是开发人员仍然认为它们没有发生变化，而该变量还在应用程序的其他位置被使用。</li><li>可能会对同一对象创建多个引用。由于单例只创建一个对象，因此这种情况下会对同一个对象创建多个引用。</li><li>所有依赖于全局变量的类都会由于一个类的改变而紧密耦合为全局数据，从而可能在无意中影响另一个类。</li></ul> 
<h3><a id="___172"></a>工厂模式 – 建立创建对象的工厂</h3> 
<p>工厂具有下列优点：</p> 
<ul><li>松耦合，即对象的创建可以独立于类的实现。</li><li>客户端无需了解创建对象的类，但是照样可以使用它来创建对象。它只需要知道需要传递的接口、方法和参数，就能够创建所需类型的对象了。这简化了客户端的实现。</li><li>可以轻松地在工厂中添加其他类来创建其他类型的对象，而这无需更改客户端代码。最简单的情况下，客户端只需要传递另一个参数就可以了。</li><li>工厂还可以重用现有对象。但是，如果客户端直接创建对象的话，总是创建一个新对象。</li></ul> 
<p>工厂模式有 3 种变体，如下所示：</p> 
<ul><li>简单工厂模式：允许接口创建对象，但不会暴露对象的创建逻辑。</li><li>工厂方法模式：允许接口创建对象，但使用哪个类来创建对象，则是交由子类决定的。</li><li>抽象工厂模式：抽象工厂是一个能够创建一系列相关的对象而无需指定/公开其具体类的接口。该模式能够提供其他工厂的对象，在其内部创建其他对象。</li></ul> 
<h4><a id="1_187"></a>1.简单工厂模式</h4> 
<p>现在，让我们借助 Python v3.5 代码示例来进一步理解简单工厂模式。首先将创建一个名为 Animal 的抽象产品。Animal 是一个抽象的基类（ABCMeta 是 Python 的特殊元类，用来生成类 Abstract），它带有方法 do_say()。我们利用 Animal 接口创建了两种产品（Cat 和 Dog），并实现了 do_say() 方法来提供这些动物的相应的叫声。ForestFactory 是一个带有 make_sound() 方法的工厂。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> abc <span class="token keyword">import</span> ABCMeta<span class="token punctuation">,</span> abstractmethod

<span class="token keyword">class</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span>metaclass <span class="token operator">=</span> ABCMeta<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token decorator annotation punctuation">@abstractmethod</span>
    <span class="token keyword">def</span> <span class="token function">do_say</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

<span class="token keyword">class</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span>Animal<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">do_say</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Bhow Bhow! ! "</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span>Animal<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">do_say</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Meow Meow! ! "</span><span class="token punctuation">)</span>

<span class="token comment">## forest factory defined</span>
<span class="token keyword">class</span> <span class="token class-name">ForestFactory</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">make_sound</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> object_type<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">eval</span><span class="token punctuation">(</span>object_type<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>do_say<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">## client code</span>
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    ff <span class="token operator">=</span> ForestFactory<span class="token punctuation">(</span><span class="token punctuation">)</span>
    animal <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Which animal should make_sound Dog or Cat? "</span><span class="token punctuation">)</span>
    ff<span class="token punctuation">.</span>make_sound<span class="token punctuation">(</span>animal<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="2_223"></a>2.工厂方法模式</h4> 
<p>通过一个现实世界的场景来理解工厂方法的实现，假设想在不同类型的社交网络（例如 LinkedIn、Facebook 等）上为个人或公司建立简介。那么，每个简介都有某些特定的组成章节。在 LinkedIn 的简介中，有一个章节是关于个人申请的专利或出版作品的。在 Facebook 上，你将在相册中看到最近度假地点的照片区。此外，在这两个简介中，都有一个个人信息的区。</p> 
<p>首先定义接口 Product，将创建一个 Section 抽象类来定义一个区是关于哪方面内容的，让它尽量保持简单，同时还提供一个抽象方法 describe()。然后，会创建多个 ConcreteProduct、PersonalSection、AlbumSection、PatentSection 和 PublicationSection 类。创建了一个名为 Profile 的抽象类Creator。Profile [Creator]抽象类提供了一个工厂方法，即 createProfile()。createProfile() 方法应该由 ConcreteClass 实现，来实际创建带有适当区的简介。创建了两个 ConcreteCreator 类，即 linkedin 和 facebook。每个类都实现 createProfile() 抽象方法。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> abc <span class="token keyword">import</span> ABCMeta<span class="token punctuation">,</span> abstractmethod


<span class="token keyword">class</span> <span class="token class-name">Section</span><span class="token punctuation">(</span>metaclass<span class="token operator">=</span>ABCMeta<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token decorator annotation punctuation">@abstractmethod</span>
    <span class="token keyword">def</span> <span class="token function">describe</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

<span class="token keyword">class</span> <span class="token class-name">PersonalSection</span><span class="token punctuation">(</span>Section<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">describe</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Personal Section"</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">AlbumSection</span><span class="token punctuation">(</span>Section<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">describe</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Album Section"</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">PatentSection</span><span class="token punctuation">(</span>Section<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">describe</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Patent Section"</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">PublicationSection</span><span class="token punctuation">(</span>Section<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    <span class="token keyword">def</span> <span class="token function">describe</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Publication Section"</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Profile</span><span class="token punctuation">(</span>metaclass<span class="token operator">=</span>ABCMeta<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>sections <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>createProfile<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token decorator annotation punctuation">@abstractmethod</span>
    <span class="token keyword">def</span> <span class="token function">createProfile</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

    <span class="token keyword">def</span> <span class="token function">getSections</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>sections
    
    <span class="token keyword">def</span> <span class="token function">addSections</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> section<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>sections<span class="token punctuation">.</span>append<span class="token punctuation">(</span>section<span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">linkedin</span><span class="token punctuation">(</span>Profile<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">createProfile</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>addSections<span class="token punctuation">(</span>PersonalSection<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>addSections<span class="token punctuation">(</span>PatentSection<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>addSections<span class="token punctuation">(</span>PublicationSection<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">facebook</span><span class="token punctuation">(</span>Profile<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">createProfile</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>addSections<span class="token punctuation">(</span>PersonalSection<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>addSections<span class="token punctuation">(</span>AlbumSection<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    profile_type <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Which Profile you'd like to create? [LinkedIn or FaceBook]"</span><span class="token punctuation">)</span>
    profile <span class="token operator">=</span> <span class="token builtin">eval</span><span class="token punctuation">(</span>profile_type<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Creating Profile.."</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>profile<span class="token punctuation">)</span><span class="token punctuation">.</span> __name__<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Profile has sections --"</span><span class="token punctuation">,</span> profile<span class="token punctuation">.</span>getSections<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>工厂方法模式的优点：</p> 
<ul><li>它具有更大的灵活性，使得代码更加通用，因为它不是单纯地实例化某个类。这样，实现哪些类取决于接口（Product），而不是 ConcreteProduct类。</li><li>它们是松耦合的，因为创建对象的代码与使用它的代码是分开的。客户端完全不需要关心要传递哪些参数以及需要实例化哪些类。由于添加新类更加容易，所以降低了维护成本。</li></ul> 
<h4><a id="3_304"></a>3.抽象工厂模式</h4> 
<p>抽象工厂模式的主要目的是提供一个接口来创建一系列相关对象，而无需指定具体的类。</p> 
<p>如何实现抽象工厂模式，讨论披萨饼店提供多种披萨饼订购的场景。加入开办了一家披萨店，供应美味的印式和美式披萨饼。为此，首先创建一个抽象基类 —— PizzaFactory。PizzaFactory 类有两个抽象方法即 createVegPizza() 和 createNonVegPizza()，它们需要通过 ConcreteFactory 实现。在这个例子中，我们创造了两个具体的工厂，分别名为 IndianPizzaFactory 和 USPizzaFactory。然后，将创建两个抽象类：VegPizza 和 NonVegPizza。再创建 DeluxVeggiePizza 和 MexicanVegPizza，并实现 prepare() 方法。接下来，我们来定义 ChickenPizza 和 HamPizza，并实现 server() 方法。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> abc <span class="token keyword">import</span> ABCMeta<span class="token punctuation">,</span> abstractmethod


<span class="token keyword">class</span> <span class="token class-name">PizzaFactory</span><span class="token punctuation">(</span>metaclass<span class="token operator">=</span>ABCMeta<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token decorator annotation punctuation">@abstractmethod</span>
    <span class="token keyword">def</span> <span class="token function">createVegPizza</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

    <span class="token decorator annotation punctuation">@abstractmethod</span>
    <span class="token keyword">def</span> <span class="token function">createNonVegPizza</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

<span class="token keyword">class</span> <span class="token class-name">IndianPizzaFactory</span><span class="token punctuation">(</span>PizzaFactory<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">createVegPizza</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> DeluxVeggiePizza<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">createNonVegPizza</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> ChickenPizza<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">USPizzaFactory</span><span class="token punctuation">(</span>PizzaFactory<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">createVegPizza</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> MexicanVegPizza<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">createNonVegPizza</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> HamPizza<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">VegPizza</span><span class="token punctuation">(</span>metaclass<span class="token operator">=</span>ABCMeta<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token decorator annotation punctuation">@abstractmethod</span>
    <span class="token keyword">def</span> <span class="token function">prepare</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> VegPizza<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

<span class="token keyword">class</span> <span class="token class-name">NonVegPizza</span><span class="token punctuation">(</span>metaclass<span class="token operator">=</span>ABCMeta<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token decorator annotation punctuation">@abstractmethod</span>
    <span class="token keyword">def</span> <span class="token function">serve</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> VegPizza<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

<span class="token keyword">class</span> <span class="token class-name">DeluxVeggiePizza</span><span class="token punctuation">(</span>VegPizza<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">prepare</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Prepare "</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">.</span> __name__<span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">ChickenPizza</span><span class="token punctuation">(</span>NonVegPizza<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">serve</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> VegPizza<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">.</span> __name__<span class="token punctuation">,</span> <span class="token string">" is served with Chicken on "</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>VegPizza<span class="token punctuation">)</span><span class="token punctuation">.</span> __name__<span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">MexicanVegPizza</span><span class="token punctuation">(</span>VegPizza<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">prepare</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Prepare "</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">.</span> __name__<span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">HamPizza</span><span class="token punctuation">(</span>NonVegPizza<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">serve</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> VegPizza<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">.</span> __name__<span class="token punctuation">,</span> <span class="token string">" is served with Ham on "</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>VegPizza<span class="token punctuation">)</span><span class="token punctuation">.</span> __name__<span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">PizzaStore</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

    <span class="token keyword">def</span> <span class="token function">makePizzas</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> factory <span class="token keyword">in</span> <span class="token punctuation">[</span>IndianPizzaFactory<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> USPizzaFactory<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>factory <span class="token operator">=</span> factory
            self<span class="token punctuation">.</span>NonVegPizza <span class="token operator">=</span> self<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>createNonVegPizza<span class="token punctuation">(</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>VegPizza <span class="token operator">=</span> self<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>createVegPizza<span class="token punctuation">(</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>VegPizza<span class="token punctuation">.</span>prepare<span class="token punctuation">(</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>NonVegPizza<span class="token punctuation">.</span>serve<span class="token punctuation">(</span>self<span class="token punctuation">.</span>VegPizza<span class="token punctuation">)</span>


pizza <span class="token operator">=</span> PizzaStore<span class="token punctuation">(</span><span class="token punctuation">)</span>
pizza<span class="token punctuation">.</span>makePizzas<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>工厂方法和抽象工厂方法比较</p> 
<table><thead><tr><th>工厂方法</th><th>抽象工厂方法</th></tr></thead><tbody><tr><td>向客户端开放了一个创建对象的方法</td><td>包含一个或多个工厂方法来创建一个系列的相关对象</td></tr><tr><td>使用继承和子类决定要创建哪个对象</td><td>使用组合将创建对象的任务委托给其他类</td></tr><tr><td>工厂方法用于创建一个产品</td><td>用于创建相关产品的系列</td></tr></tbody></table>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d35d6c89674fe5288500c99e3418d2e5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Android WebView】WebView基础</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ca1a068a6eb3b3e92bfdc4921ff81f87/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">最新Prompt预设词分享，DALL-E3文生图&#43;文档分析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>